     H/TITLE Exc Gate Adj needed?  XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSHENR
     H* Date          : 04/25/23  Time  : 14:49:55
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBGWKLDIF  E           K        DISK
      * RSQ : Order Detail              Co/Order#/Item/Whse Not
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FOPBGWKN9IF  E           K        DISK
      * RSQ : Order Detail              Co/Ord/Seqs/not Canc
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FPDJYREL2IF  E           K        DISK
      * RTV : Company Defaults Internal Active Records
      *
     FPDIHREL0IF  E           K        DISK
      * RTV : Price Method Header       Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAASREL3IF  E           K        DISK
      * RTV : Company Control           Retrieval Active Only
      *
     FOMF0CPL2IF  E           K        DISK
      * RSQ : Commodity Mrkt Price      Market Date Descending
      *
     FPDK3CPL2IF  E           K        DISK
      * RSQ : Price Change Audit Log    Co/Ord/Seq1&2/AdtSeq (D)
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FOPEXREL2IF  E           K        DISK
      * RTV : Order Types               Active order Types
      *
     FARBCREL1IF  E           K        DISK
      * RTV : A/R Summary               Retrieval index       NV
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FPDK3CPL0IF  E           K        DISK                      A
      * UPD : Price Change Audit Log    Update index
      *
     FARBCREL0UF  E           K        DISK                      A
      * UPD : A/R Summary               Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     E                    #L7         7  1
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@BGWKFW
      * Order Detail              Co/Order#/Item/Whse Not
      * Renamed input format fields
     I              OMAIC3                          WBAIC3
     I              OMC4NB                          WBC4NB
     I              OMDPNB                          WBDPNB
     I              OMUENB                          WBUENB
     I              OMHGCD                          WBHGCD
     I              OMAJCD                          WBAJCD
     I              OMBKC7                          WBBKC7
     I              OMCFC7                          WBCFC7
     I              OMGMST                          WBGMST
     I              OMGNST                          WBGNST
     I              OMMAVA                          WBMAVA
     I              OMKDVA                          WBKDVA
     I              OML8VA                          WBL8VA
     I              OML9VA                          WBL9VA
     I              OMGTST                          WBGTST
     I              OMGVST                          WBGVST
     I              OMGUST                          WBGUST
     I              OMQFST                          WBQFST
     I              OMAYVA                          WBAYVA
     I              OMEXDT                          WBEXDT
     I              OMLQCD                          WBLQCD
     I              OMRDCD                          WBRDCD
     I              OMQ7CD                          WBQ7CD
     I              OMBZPR                          WBBZPR
     I              OML6NB                          WBL6NB
     I              OMU1ST                          WBU1ST
     I              OMGIDT                          WBGIDT
     I              OMCRCD                          WBCRCD
     I              OMAGCD                          WBAGCD
     I              OMRZST                          WBRZST
     I              OMR0ST                          WBR0ST
     I              OMR1ST                          WBR1ST
     I              OMG7NA                          WBG7NA
     I              OMG8NA                          WBG8NA
     I              OMRPCD                          WBRPCD
     I              OMVEST                          WBVEST
     I              OMVGST                          WBVGST
     I              OMAVST                          WBAVST
     I              OMU0ST                          WBU0ST
     I              OMRFCD                          WBRFCD
     I              OMFZST                          WBFZST
     I              OMR1NB                          WBR1NB
     I              OMAVQT                          WBAVQT
     I              OMD0WG                          WBD0WG
     I              OMCCQT                          WBCCQT
     I              OMAUWG                          WBAUWG
     I              OMCBQT                          WBCBQT
     I              OMATWG                          WBATWG
     I              OMAQCS                          WBAQCS
     I              OMAGCS                          WBAGCS
     I              OMAKPR                          WBAKPR
     I              OMALPR                          WBALPR
     I              OMAUPR                          WBAUPR
     I              OMAVWG                          WBAVWG
     I              OMA4WG                          WBA4WG
     I              OMA5DT                          WBA5DT
     I              OMAODT                          WBAODT
     I              OMGNDT                          WBGNDT
     I              OMAMST                          WBAMST
     I              OMANST                          WBANST
     I              OMVAST                          WBVAST
     I              OMRGNB                          WBRGNB
     I              OMRHNB                          WBRHNB
     I              OMRINB                          WBRINB
     I              OMRBCD                          WBRBCD
     I              OMHICD                          WBHICD
     I              OMRNCD                          WBRNCD
     I              OMROCD                          WBROCD
     I              OMCXDT                          WBCXDT
     I              OMAJVN                          WBAJVN
     I              OMKXCD                          WBKXCD
     I              OMJPCD                          WBJPCD
     I              OMCQCD                          WBCQCD
     I              OMR4CD                          WBR4CD
     I              OMZ1ST                          WBZ1ST
     I              OMZ3ST                          WBZ3ST
     I              OMZ4ST                          WBZ4ST
     I              OMDUPR                          WBDUPR
     I              OMB6VL                          WBB6VL
     I              OMA1AA                          WBA1AA
     I              OMFZSX                          WBFZSX
     I              OMF0SX                          WBF0SX
     I              OMF1SX                          WBF1SX
     I              OMF2SX                          WBF2SX
     I              OMF3SX                          WBF3SX
     I              OMF4SX                          WBF4SX
     I              OMF5SX                          WBF5SX
     I              OMF6SX                          WBF6SX
     I              OMF7SX                          WBF7SX
     I              OMNTDT                          WBNTDT
     I              OMNUDT                          WBNUDT
     I              OMNVDT                          WBNVDT
     I              OMNWDT                          WBNWDT
     I              OMNXDT                          WBNXDT
     I              OMBUTM                          WBBUTM
     I              OMBVTM                          WBBVTM
     I              OMBWTM                          WBBWTM
     I              OMBXTM                          WBBXTM
     I              OMBYTM                          WBBYTM
     I              OMH5NX                          WBH5NX
     I              OMH6NX                          WBH6NX
     I              OMH7NX                          WBH7NX
     I              OMH8NX                          WBH8NX
     I              OMH9NX                          WBH9NX
     I              OMDVPR                          WBDVPR
     I              OMDWPR                          WBDWPR
     I              OMDXPR                          WBDXPR
     I              OMDYPR                          WBDYPR
     I              OMDZPR                          WBDZPR
     I              OMGSPR                          WBGSPR
     I              OMGTPR                          WBGTPR
     I              OMGUPR                          WBGUPR
     I              OMHOST                          WBHOST
     I              OMHPST                          WBHPST
     I              OMIOST                          WBIOST
     I              OMPEWG                          WBPEWG
     I              OMRINY                          WBRINY
     I              OMTIDT                          WBTIDT
     I              OMTJDT                          WBTJDT
     I              OMH2ST                          WBH2ST
     I              OMH0ST                          WBH0ST
     I              OMH1ST                          WBH1ST
     I              OMTKDT                          WBTKDT
     I              OMTLDT                          WBTLDT
     I              OMTMDT                          WBTMDT
     I              OMUVST                          WBUVST
     I              OMUWST                          WBUWST
     I              OMUXST                          WBUXST
     I              OMAATM                          WBAATM
     I              OMAYNA                          WBAYNA
     I              OMA0NA                          WBA0NA
     I              OMAXDT                          WBAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WCAIC3
     I              OMC4NB                          WCC4NB
     I              OMDPNB                          WCDPNB
     I              OMUENB                          WCUENB
     I              OMHGCD                          WCHGCD
     I              OMAJCD                          WCAJCD
     I              OMBKC7                          WCBKC7
     I              OMCFC7                          WCCFC7
     I              OMGMST                          WCGMST
     I              OMGNST                          WCGNST
     I              OMMAVA                          WCMAVA
     I              OMKDVA                          WCKDVA
     I              OML8VA                          WCL8VA
     I              OML9VA                          WCL9VA
     I              OMGTST                          WCGTST
     I              OMGVST                          WCGVST
     I              OMGUST                          WCGUST
     I              OMQFST                          WCQFST
     I              OMAYVA                          WCAYVA
     I              OMEXDT                          WCEXDT
     I              OMLQCD                          WCLQCD
     I              OMRDCD                          WCRDCD
     I              OMQ7CD                          WCQ7CD
     I              OMBZPR                          WCBZPR
     I              OML6NB                          WCL6NB
     I              OMU1ST                          WCU1ST
     I              OMGIDT                          WCGIDT
     I              OMCRCD                          WCCRCD
     I              OMAGCD                          WCAGCD
     I              OMRZST                          WCRZST
     I              OMR0ST                          WCR0ST
     I              OMR1ST                          WCR1ST
     I              OMG7NA                          WCG7NA
     I              OMG8NA                          WCG8NA
     I              OMRPCD                          WCRPCD
     I              OMVEST                          WCVEST
     I              OMVGST                          WCVGST
     I              OMAVST                          WCAVST
     I              OMU0ST                          WCU0ST
     I              OMRFCD                          WCRFCD
     I              OMFZST                          WCFZST
     I              OMR1NB                          WCR1NB
     I              OMAVQT                          WCAVQT
     I              OMD0WG                          WCD0WG
     I              OMCCQT                          WCCCQT
     I              OMAUWG                          WCAUWG
     I              OMCBQT                          WCCBQT
     I              OMATWG                          WCATWG
     I              OMAQCS                          WCAQCS
     I              OMAGCS                          WCAGCS
     I              OMAKPR                          WCAKPR
     I              OMALPR                          WCALPR
     I              OMAUPR                          WCAUPR
     I              OMAVWG                          WCAVWG
     I              OMA4WG                          WCA4WG
     I              OMA5DT                          WCA5DT
     I              OMAODT                          WCAODT
     I              OMGNDT                          WCGNDT
     I              OMAMST                          WCAMST
     I              OMANST                          WCANST
     I              OMVAST                          WCVAST
     I              OMRGNB                          WCRGNB
     I              OMRHNB                          WCRHNB
     I              OMRINB                          WCRINB
     I              OMRBCD                          WCRBCD
     I              OMHICD                          WCHICD
     I              OMRNCD                          WCRNCD
     I              OMROCD                          WCROCD
     I              OMCXDT                          WCCXDT
     I              OMAJVN                          WCAJVN
     I              OMKXCD                          WCKXCD
     I              OMJPCD                          WCJPCD
     I              OMCQCD                          WCCQCD
     I              OMR4CD                          WCR4CD
     I              OMZ1ST                          WCZ1ST
     I              OMZ3ST                          WCZ3ST
     I              OMZ4ST                          WCZ4ST
     I              OMDUPR                          WCDUPR
     I              OMB6VL                          WCB6VL
     I              OMA1AA                          WCA1AA
     I              OMFZSX                          WCFZSX
     I              OMF0SX                          WCF0SX
     I              OMF1SX                          WCF1SX
     I              OMF2SX                          WCF2SX
     I              OMF3SX                          WCF3SX
     I              OMF4SX                          WCF4SX
     I              OMF5SX                          WCF5SX
     I              OMF6SX                          WCF6SX
     I              OMF7SX                          WCF7SX
     I              OMNTDT                          WCNTDT
     I              OMNUDT                          WCNUDT
     I              OMNVDT                          WCNVDT
     I              OMNWDT                          WCNWDT
     I              OMNXDT                          WCNXDT
     I              OMBUTM                          WCBUTM
     I              OMBVTM                          WCBVTM
     I              OMBWTM                          WCBWTM
     I              OMBXTM                          WCBXTM
     I              OMBYTM                          WCBYTM
     I              OMH5NX                          WCH5NX
     I              OMH6NX                          WCH6NX
     I              OMH7NX                          WCH7NX
     I              OMH8NX                          WCH8NX
     I              OMH9NX                          WCH9NX
     I              OMDVPR                          WCDVPR
     I              OMDWPR                          WCDWPR
     I              OMDXPR                          WCDXPR
     I              OMDYPR                          WCDYPR
     I              OMDZPR                          WCDZPR
     I              OMGSPR                          WCGSPR
     I              OMGTPR                          WCGTPR
     I              OMGUPR                          WCGUPR
     I              OMHOST                          WCHOST
     I              OMHPST                          WCHPST
     I              OMIOST                          WCIOST
     I              OMPEWG                          WCPEWG
     I              OMRINY                          WCRINY
     I              OMTIDT                          WCTIDT
     I              OMTJDT                          WCTJDT
     I              OMH2ST                          WCH2ST
     I              OMH0ST                          WCH0ST
     I              OMH1ST                          WCH1ST
     I              OMTKDT                          WCTKDT
     I              OMTLDT                          WCTLDT
     I              OMTMDT                          WCTMDT
     I              OMUVST                          WCUVST
     I              OMUWST                          WCUWST
     I              OMUXST                          WCUXST
     I              OMAATM                          WCAATM
     I              OMAYNA                          WCAYNA
     I              OMA0NA                          WCA0NA
     I              OMAXDT                          WCAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WDAIC3
     I              OMC4NB                          WDC4NB
     I              OMDPNB                          WDDPNB
     I              OMUENB                          WDUENB
     I              OMHGCD                          WDHGCD
     I              OMAJCD                          WDAJCD
     I              OMBKC7                          WDBKC7
     I              OMCFC7                          WDCFC7
     I              OMGMST                          WDGMST
     I              OMGNST                          WDGNST
     I              OMMAVA                          WDMAVA
     I              OMKDVA                          WDKDVA
     I              OML8VA                          WDL8VA
     I              OML9VA                          WDL9VA
     I              OMGTST                          WDGTST
     I              OMGVST                          WDGVST
     I              OMGUST                          WDGUST
     I              OMQFST                          WDQFST
     I              OMAYVA                          WDAYVA
     I              OMEXDT                          WDEXDT
     I              OMLQCD                          WDLQCD
     I              OMRDCD                          WDRDCD
     I              OMQ7CD                          WDQ7CD
     I              OMBZPR                          WDBZPR
     I              OML6NB                          WDL6NB
     I              OMU1ST                          WDU1ST
     I              OMGIDT                          WDGIDT
     I              OMCRCD                          WDCRCD
     I              OMAGCD                          WDAGCD
     I              OMRZST                          WDRZST
     I              OMR0ST                          WDR0ST
     I              OMR1ST                          WDR1ST
     I              OMG7NA                          WDG7NA
     I              OMG8NA                          WDG8NA
     I              OMRPCD                          WDRPCD
     I              OMVEST                          WDVEST
     I              OMVGST                          WDVGST
     I              OMAVST                          WDAVST
     I              OMU0ST                          WDU0ST
     I              OMRFCD                          WDRFCD
     I              OMFZST                          WDFZST
     I              OMR1NB                          WDR1NB
     I              OMAVQT                          WDAVQT
     I              OMD0WG                          WDD0WG
     I              OMCCQT                          WDCCQT
     I              OMAUWG                          WDAUWG
     I              OMCBQT                          WDCBQT
     I              OMATWG                          WDATWG
     I              OMAQCS                          WDAQCS
     I              OMAGCS                          WDAGCS
     I              OMAKPR                          WDAKPR
     I              OMALPR                          WDALPR
     I              OMAUPR                          WDAUPR
     I              OMAVWG                          WDAVWG
     I              OMA4WG                          WDA4WG
     I              OMA5DT                          WDA5DT
     I              OMAODT                          WDAODT
     I              OMGNDT                          WDGNDT
     I              OMAMST                          WDAMST
     I              OMANST                          WDANST
     I              OMVAST                          WDVAST
     I              OMRGNB                          WDRGNB
     I              OMRHNB                          WDRHNB
     I              OMRINB                          WDRINB
     I              OMRBCD                          WDRBCD
     I              OMHICD                          WDHICD
     I              OMRNCD                          WDRNCD
     I              OMROCD                          WDROCD
     I              OMCXDT                          WDCXDT
     I              OMAJVN                          WDAJVN
     I              OMKXCD                          WDKXCD
     I              OMJPCD                          WDJPCD
     I              OMCQCD                          WDCQCD
     I              OMR4CD                          WDR4CD
     I              OMZ1ST                          WDZ1ST
     I              OMZ3ST                          WDZ3ST
     I              OMZ4ST                          WDZ4ST
     I              OMDUPR                          WDDUPR
     I              OMB6VL                          WDB6VL
     I              OMA1AA                          WDA1AA
     I              OMFZSX                          WDFZSX
     I              OMF0SX                          WDF0SX
     I              OMF1SX                          WDF1SX
     I              OMF2SX                          WDF2SX
     I              OMF3SX                          WDF3SX
     I              OMF4SX                          WDF4SX
     I              OMF5SX                          WDF5SX
     I              OMF6SX                          WDF6SX
     I              OMF7SX                          WDF7SX
     I              OMNTDT                          WDNTDT
     I              OMNUDT                          WDNUDT
     I              OMNVDT                          WDNVDT
     I              OMNWDT                          WDNWDT
     I              OMNXDT                          WDNXDT
     I              OMBUTM                          WDBUTM
     I              OMBVTM                          WDBVTM
     I              OMBWTM                          WDBWTM
     I              OMBXTM                          WDBXTM
     I              OMBYTM                          WDBYTM
     I              OMH5NX                          WDH5NX
     I              OMH6NX                          WDH6NX
     I              OMH7NX                          WDH7NX
     I              OMH8NX                          WDH8NX
     I              OMH9NX                          WDH9NX
     I              OMDVPR                          WDDVPR
     I              OMDWPR                          WDDWPR
     I              OMDXPR                          WDDXPR
     I              OMDYPR                          WDDYPR
     I              OMDZPR                          WDDZPR
     I              OMGSPR                          WDGSPR
     I              OMGTPR                          WDGTPR
     I              OMGUPR                          WDGUPR
     I              OMHOST                          WDHOST
     I              OMHPST                          WDHPST
     I              OMIOST                          WDIOST
     I              OMPEWG                          WDPEWG
     I              OMRINY                          WDRINY
     I              OMTIDT                          WDTIDT
     I              OMTJDT                          WDTJDT
     I              OMH2ST                          WDH2ST
     I              OMH0ST                          WDH0ST
     I              OMH1ST                          WDH1ST
     I              OMTKDT                          WDTKDT
     I              OMTLDT                          WDTLDT
     I              OMTMDT                          WDTMDT
     I              OMUVST                          WDUVST
     I              OMUWST                          WDUWST
     I              OMUXST                          WDUXST
     I              OMAATM                          WDAATM
     I              OMAYNA                          WDAYNA
     I              OMA0NA                          WDA0NA
     I              OMAXDT                          WDAXDT
      *
     I@EOREXM
      * Company Customer          Retrieval index
      * Renamed input format fields
     I              EOAIC3                          WEAIC3
     I              EOBKC7                          WEBKC7
     I              EOAQCD                          WEAQCD
     I              EOR4CD                          WER4CD
     I              EOBYNA                          WEBYNA
     I              EOB6NA                          WEB6NA
     I              EOBZNA                          WEBZNA
     I              EOLLST                          WELLST
     I              EOPPST                          WEPPST
     I              EOR5NB                          WER5NB
     I              EOR6NB                          WER6NB
     I              EOQGST                          WEQGST
     I              EOBOCD                          WEBOCD
     I              EOTBNB                          WETBNB
     I              EOMTCU                          WEMTCU
     I              EOW2NB                          WEW2NB
     I              EORPCD                          WERPCD
     I              EOAJCD                          WEAJCD
     I              EOX9ST                          WEX9ST
     I              EOT9CD                          WET9CD
     I              EOUBCD                          WEUBCD
     I              EOISTX                          WEISTX
     I              EOLQCD                          WELQCD
     I              EONJNA                          WENJNA
     I              EOI0TX                          WEI0TX
     I              EONKNA                          WENKNA
     I              EOI1TX                          WEI1TX
     I              EOVLST                          WEVLST
     I              EORLST                          WERLST
     I              EOMMTX                          WEMMTX
     I              EOOHNA                          WEOHNA
     I              EOQ6ST                          WEQ6ST
     I              EOQ8ST                          WEQ8ST
     I              EORBST                          WERBST
     I              EOREST                          WEREST
     I              EOUVST                          WEUVST
     I              EOUWST                          WEUWST
     I              EOUXST                          WEUXST
     I              EOVSST                          WEVSST
     I              EOAATM                          WEAATM
     I              EOAYNA                          WEAYNA
     I              EOA0NA                          WEA0NA
     I              EOAXDT                          WEAXDT
      *
     I@BGWKJM
      * Order Detail              Co/Ord/Seqs/not Canc
      * Renamed input format fields
     I              OMAIC3                          WFAIC3
     I              OMC4NB                          WFC4NB
     I              OMDPNB                          WFDPNB
     I              OMUENB                          WFUENB
     I              OMHGCD                          WFHGCD
     I              OMAJCD                          WFAJCD
     I              OMBKC7                          WFBKC7
     I              OMCFC7                          WFCFC7
     I              OMGMST                          WFGMST
     I              OMGNST                          WFGNST
     I              OMMAVA                          WFMAVA
     I              OMKDVA                          WFKDVA
     I              OML8VA                          WFL8VA
     I              OML9VA                          WFL9VA
     I              OMGTST                          WFGTST
     I              OMGVST                          WFGVST
     I              OMGUST                          WFGUST
     I              OMQFST                          WFQFST
     I              OMAYVA                          WFAYVA
     I              OMEXDT                          WFEXDT
     I              OMLQCD                          WFLQCD
     I              OMRDCD                          WFRDCD
     I              OMQ7CD                          WFQ7CD
     I              OMBZPR                          WFBZPR
     I              OML6NB                          WFL6NB
     I              OMU1ST                          WFU1ST
     I              OMGIDT                          WFGIDT
     I              OMCRCD                          WFCRCD
     I              OMAGCD                          WFAGCD
     I              OMRZST                          WFRZST
     I              OMR0ST                          WFR0ST
     I              OMR1ST                          WFR1ST
     I              OMG7NA                          WFG7NA
     I              OMG8NA                          WFG8NA
     I              OMRPCD                          WFRPCD
     I              OMVEST                          WFVEST
     I              OMVGST                          WFVGST
     I              OMAVST                          WFAVST
     I              OMU0ST                          WFU0ST
     I              OMRFCD                          WFRFCD
     I              OMFZST                          WFFZST
     I              OMR1NB                          WFR1NB
     I              OMAVQT                          WFAVQT
     I              OMD0WG                          WFD0WG
     I              OMCCQT                          WFCCQT
     I              OMAUWG                          WFAUWG
     I              OMCBQT                          WFCBQT
     I              OMATWG                          WFATWG
     I              OMAQCS                          WFAQCS
     I              OMAGCS                          WFAGCS
     I              OMAKPR                          WFAKPR
     I              OMALPR                          WFALPR
     I              OMAUPR                          WFAUPR
     I              OMAVWG                          WFAVWG
     I              OMA4WG                          WFA4WG
     I              OMA5DT                          WFA5DT
     I              OMAODT                          WFAODT
     I              OMGNDT                          WFGNDT
     I              OMAMST                          WFAMST
     I              OMANST                          WFANST
     I              OMVAST                          WFVAST
     I              OMRGNB                          WFRGNB
     I              OMRHNB                          WFRHNB
     I              OMRINB                          WFRINB
     I              OMRBCD                          WFRBCD
     I              OMHICD                          WFHICD
     I              OMRNCD                          WFRNCD
     I              OMROCD                          WFROCD
     I              OMCXDT                          WFCXDT
     I              OMAJVN                          WFAJVN
     I              OMKXCD                          WFKXCD
     I              OMJPCD                          WFJPCD
     I              OMCQCD                          WFCQCD
     I              OMR4CD                          WFR4CD
     I              OMZ1ST                          WFZ1ST
     I              OMZ3ST                          WFZ3ST
     I              OMZ4ST                          WFZ4ST
     I              OMDUPR                          WFDUPR
     I              OMB6VL                          WFB6VL
     I              OMA1AA                          WFA1AA
     I              OMFZSX                          WFFZSX
     I              OMF0SX                          WFF0SX
     I              OMF1SX                          WFF1SX
     I              OMF2SX                          WFF2SX
     I              OMF3SX                          WFF3SX
     I              OMF4SX                          WFF4SX
     I              OMF5SX                          WFF5SX
     I              OMF6SX                          WFF6SX
     I              OMF7SX                          WFF7SX
     I              OMNTDT                          WFNTDT
     I              OMNUDT                          WFNUDT
     I              OMNVDT                          WFNVDT
     I              OMNWDT                          WFNWDT
     I              OMNXDT                          WFNXDT
     I              OMBUTM                          WFBUTM
     I              OMBVTM                          WFBVTM
     I              OMBWTM                          WFBWTM
     I              OMBXTM                          WFBXTM
     I              OMBYTM                          WFBYTM
     I              OMH5NX                          WFH5NX
     I              OMH6NX                          WFH6NX
     I              OMH7NX                          WFH7NX
     I              OMH8NX                          WFH8NX
     I              OMH9NX                          WFH9NX
     I              OMDVPR                          WFDVPR
     I              OMDWPR                          WFDWPR
     I              OMDXPR                          WFDXPR
     I              OMDYPR                          WFDYPR
     I              OMDZPR                          WFDZPR
     I              OMGSPR                          WFGSPR
     I              OMGTPR                          WFGTPR
     I              OMGUPR                          WFGUPR
     I              OMHOST                          WFHOST
     I              OMHPST                          WFHPST
     I              OMIOST                          WFIOST
     I              OMPEWG                          WFPEWG
     I              OMRINY                          WFRINY
     I              OMTIDT                          WFTIDT
     I              OMTJDT                          WFTJDT
     I              OMH2ST                          WFH2ST
     I              OMH0ST                          WFH0ST
     I              OMH1ST                          WFH1ST
     I              OMTKDT                          WFTKDT
     I              OMTLDT                          WFTLDT
     I              OMTMDT                          WFTMDT
     I              OMUVST                          WFUVST
     I              OMUWST                          WFUWST
     I              OMUXST                          WFUXST
     I              OMAATM                          WFAATM
     I              OMAYNA                          WFAYNA
     I              OMA0NA                          WFA0NA
     I              OMAXDT                          WFAXDT
      *
     I@ADREAO
      * Warehouse Codes           Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WGAJCD
     I              ADF8NA                          WGF8NA
     I              ADACNA                          WGACNA
     I              ADADNA                          WGADNA
     I              ADAENA                          WGAENA
     I              ADAJNA                          WGAJNA
     I              ADBTTX                          WGBTTX
     I              ADAOCD                          WGAOCD
     I              ADBGCD                          WGBGCD
     I              ADVHST                          WGVHST
     I              ADMPNA                          WGMPNA
     I              ADWPST                          WGWPST
     I              ADXUST                          WGXUST
     I              ADT0ST                          WGT0ST
     I              ADT1ST                          WGT1ST
     I              ADDBNB                          WGDBNB
     I              ADT2ST                          WGT2ST
     I              ADT3ST                          WGT3ST
     I              ADT4ST                          WGT4ST
     I              ADT6ST                          WGT6ST
     I              ADBWC3                          WGBWC3
     I              ADBTC3                          WGBTC3
     I              ADBUC3                          WGBUC3
     I              ADBVC3                          WGBVC3
     I              ADFCAA                          WGFCAA
     I              ADRQSX                          WGRQSX
     I              ADRRSX                          WGRRSX
     I              ADRSSX                          WGRSSX
     I              ADRTSX                          WGRTSX
     I              ADT7ST                          WGT7ST
     I              ADT8ST                          WGT8ST
     I              ADRNSX                          WGRNSX
     I              ADROSX                          WGROSX
     I              ADRPSX                          WGRPSX
     I              ADUVST                          WGUVST
     I              ADUWST                          WGUWST
     I              ADUXST                          WGUXST
     I              ADVSST                          WGVSST
     I              ADAATM                          WGAATM
     I              ADAYNA                          WGAYNA
     I              ADA0NA                          WGA0NA
     I              ADAXDT                          WGAXDT
      *
     I@JYRECE
      * Company Defaults Internal Active Records
      * Renamed input format fields
     I              JYAIC3                          WHAIC3
     I              JYZ9ST                          WHZ9ST
     I              JYCSST                          WHCSST
     I              JYZ8ST                          WHZ8ST
     I              JYCXST                          WHCXST
     I              JYSWST                          WHSWST
     I              JYXXTM                          WHXXTM
     I              JYUECD                          WHUECD
     I              JYHSST                          WHHSST
     I              JYAMEO                          WHAMEO
     I              JYSSDF                          WHSSDF
     I              JYPDFT                          WHPDFT
     I              JYYISX                          WHYISX
     I              JYYJSX                          WHYJSX
     I              JYYKSX                          WHYKSX
     I              JYYLSX                          WHYLSX
     I              JYYMSX                          WHYMSX
     I              JYYNSX                          WHYNSX
     I              JYUVST                          WHUVST
     I              JYUWST                          WHUWST
     I              JYUXST                          WHUXST
     I              JYVSST                          WHVSST
     I              JYAATM                          WHAATM
     I              JYAYNA                          WHAYNA
     I              JYA0NA                          WHA0NA
     I              JYAXDT                          WHAXDT
      *
     I@IHRERN
      * Price Method Header       Retrieval index
      * Renamed input format fields
     I              IHAIC3                          WIAIC3
     I              IHQ7CD                          WIQ7CD
     I              IHMLNA                          WIMLNA
     I              IHU0ST                          WIU0ST
     I              IHV8ST                          WIV8ST
     I              IHBYST                          WIBYST
     I              IHRMNY                          WIRMNY
     I              IHH3ST                          WIH3ST
     I              IHH5ST                          WIH5ST
     I              IHH6ST                          WIH6ST
     I              IHH7ST                          WIH7ST
     I              IHUVST                          WIUVST
     I              IHUWST                          WIUWST
     I              IHUXST                          WIUXST
     I              IHAATM                          WIAATM
     I              IHAYNA                          WIAYNA
     I              IHA0NA                          WIA0NA
     I              IHAXDT                          WIAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WJAIC3
     I              BZHGCD                          WJHGCD
     I              BZAVNA                          WJAVNA
     I              BZAWNA                          WJAWNA
     I              BZL7NA                          WJL7NA
     I              BZL8NA                          WJL8NA
     I              BZL6NA                          WJL6NA
     I              BZMFNA                          WJMFNA
     I              BZADCD                          WJADCD
     I              BZAWPC                          WJAWPC
     I              BZLXST                          WJLXST
     I              BZAECD                          WJAECD
     I              BZAXPC                          WJAXPC
     I              BZLYST                          WJLYST
     I              BZAFCD                          WJAFCD
     I              BZAICD                          WJAICD
     I              BZAIWG                          WJAIWG
     I              BZHICD                          WJHICD
     I              BZRBCD                          WJRBCD
     I              BZFZST                          WJFZST
     I              BZAVST                          WJAVST
     I              BZCZWG                          WJCZWG
     I              BZC0WG                          WJC0WG
     I              BZURTN                          WJURTN
     I              BZAJC8                          WJAJC8
     I              BZRINB                          WJRINB
     I              BZRHNB                          WJRHNB
     I              BZRGNB                          WJRGNB
     I              BZLNCD                          WJLNCD
     I              BZTFNB                          WJTFNB
     I              BZN0CD                          WJN0CD
     I              BZX4ST                          WJX4ST
     I              BZTMVA                          WJTMVA
     I              BZTNVA                          WJTNVA
     I              BZBLPR                          WJBLPR
     I              BZBMPR                          WJBMPR
     I              BZLRCD                          WJLRCD
     I              BZU9ST                          WJU9ST
     I              BZCMCO                          WJCMCO
     I              BZQ1CD                          WJQ1CD
     I              BZQ8CD                          WJQ8CD
     I              BZCHTM                          WJCHTM
     I              BZQZCD                          WJQZCD
     I              BZXWST                          WJXWST
     I              BZXXST                          WJXXST
     I              BZVMST                          WJVMST
     I              BZSWGH                          WJSWGH
     I              BZPPHE                          WJPPHE
     I              BZR3CD                          WJR3CD
     I              BZSDCD                          WJSDCD
     I              BZICN1                          WJICN1
     I              BZSVCD                          WJSVCD
     I              BZICN2                          WJICN2
     I              BZSWCD                          WJSWCD
     I              BZV2NB                          WJV2NB
     I              BZSXCD                          WJSXCD
     I              BZITCN                          WJITCN
     I              BZSYCD                          WJSYCD
     I              BZITC5                          WJITC5
     I              BZSZCD                          WJSZCD
     I              BZICN6                          WJICN6
     I              BZS0CD                          WJS0CD
     I              BZICN7                          WJICN7
     I              BZS1CD                          WJS1CD
     I              BZICN8                          WJICN8
     I              BZS2CD                          WJS2CD
     I              BZICN9                          WJICN9
     I              BZS3CD                          WJS3CD
     I              BZICN0                          WJICN0
     I              BZS4CD                          WJS4CD
     I              BZSFNB                          WJSFNB
     I              BZA3WG                          WJA3WG
     I              BZSJNB                          WJSJNB
     I              BZLLCD                          WJLLCD
     I              BZLMCD                          WJLMCD
     I              BZP3ST                          WJP3ST
     I              BZSKNB                          WJSKNB
     I              BZSLNB                          WJSLNB
     I              BZSMNB                          WJSMNB
     I              BZP4ST                          WJP4ST
     I              BZCFNB                          WJCFNB
     I              BZCGNB                          WJCGNB
     I              BZILNB                          WJILNB
     I              BZCHNB                          WJCHNB
     I              BZCINB                          WJCINB
     I              BZCJNB                          WJCJNB
     I              BZCMNB                          WJCMNB
     I              BZCNNB                          WJCNNB
     I              BZCRNB                          WJCRNB
     I              BZCSNB                          WJCSNB
     I              BZCVNB                          WJCVNB
     I              BZCWNB                          WJCWNB
     I              BZCXNB                          WJCXNB
     I              BZCZNB                          WJCZNB
     I              BZC0NB                          WJC0NB
     I              BZN1CD                          WJN1CD
     I              BZB4NB                          WJB4NB
     I              BZB5NB                          WJB5NB
     I              BZX5ST                          WJX5ST
     I              BZX6ST                          WJX6ST
     I              BZX7ST                          WJX7ST
     I              BZPCCT                          WJPCCT
     I              BZBDNB                          WJBDNB
     I              BZBJNB                          WJBJNB
     I              BZSUST                          WJSUST
     I              BZSVST                          WJSVST
     I              BZSYST                          WJSYST
     I              BZSZST                          WJSZST
     I              BZS1ST                          WJS1ST
     I              BZXRCD                          WJXRCD
     I              BZXTCD                          WJXTCD
     I              BZXUCD                          WJXUCD
     I              BZF5WG                          WJF5WG
     I              BZF6WG                          WJF6WG
     I              BZF7WG                          WJF7WG
     I              BZBLNB                          WJBLNB
     I              BZBNNB                          WJBNNB
     I              BZS2ST                          WJS2ST
     I              BZS4ST                          WJS4ST
     I              BZS5ST                          WJS5ST
     I              BZS6ST                          WJS6ST
     I              BZS8ST                          WJS8ST
     I              BZS9ST                          WJS9ST
     I              BZTCST                          WJTCST
     I              BZTDST                          WJTDST
     I              BZUVST                          WJUVST
     I              BZUWST                          WJUWST
     I              BZUXST                          WJUXST
     I              BZVSST                          WJVSST
     I              BZAATM                          WJAATM
     I              BZAYNA                          WJAYNA
     I              BZA0NA                          WJA0NA
     I              BZAXDT                          WJAXDT
      *
     I@ASREVL
      * Company Control           Retrieval Active Only
      * Renamed input format fields
     I              ASAIC3                          WKAIC3
     I              ASAXNB                          WKAXNB
     I              ASNGNB                          WKNGNB
     I              ASBZNB                          WKBZNB
     I              ASC5NB                          WKC5NB
     I              ASC3NB                          WKC3NB
     I              ASCYNB                          WKCYNB
     I              ASIONB                          WKIONB
     I              ASI6NB                          WKI6NB
     I              ASDCNB                          WKDCNB
     I              ASC7NB                          WKC7NB
     I              ASC2NB                          WKC2NB
     I              ASC1NB                          WKC1NB
     I              ASL8NB                          WKL8NB
     I              ASBANB                          WKBANB
     I              ASCHST                          WKCHST
     I              ASCKST                          WKCKST
     I              ASCIST                          WKCIST
     I              ASCGST                          WKCGST
     I              ASAIPC                          WKAIPC
     I              ASASPC                          WKASPC
     I              ASA2VA                          WKA2VA
     I              ASC2ST                          WKC2ST
     I              ASD8ST                          WKD8ST
     I              ASD7ST                          WKD7ST
     I              ASA8NA                          WKA8NA
     I              ASA9NA                          WKA9NA
     I              ASBANA                          WKBANA
     I              ASBBNA                          WKBBNA
     I              ASEUST                          WKEUST
     I              ASAADY                          WKAADY
     I              ASABDY                          WKABDY
     I              ASACDY                          WKACDY
     I              ASADDY                          WKADDY
     I              ASAEDY                          WKAEDY
     I              ASAFDY                          WKAFDY
     I              ASAGDY                          WKAGDY
     I              ASAHDY                          WKAHDY
     I              ASAENB                          WKAENB
     I              ASALNB                          WKALNB
     I              ASEVNB                          WKEVNB
     I              ASRPOP                          WKRPOP
     I              ASDWNB                          WKDWNB
     I              ASR3NB                          WKR3NB
     I              ASPNST                          WKPNST
     I              ASR4NB                          WKR4NB
     I              ASPOST                          WKPOST
     I              ASSCNB                          WKSCNB
     I              ASVIST                          WKVIST
     I              ASVJST                          WKVJST
     I              ASBVVN                          WKBVVN
     I              ASUVST                          WKUVST
     I              ASUWST                          WKUWST
     I              ASUXST                          WKUXST
     I              ASVSST                          WKVSST
     I              ASAATM                          WKAATM
     I              ASAYNA                          WKAYNA
     I              ASA0NA                          WKA0NA
     I              ASAXDT                          WKAXDT
      *
     I@F0CPEP
      * Commodity Mrkt Price      Market Date Descending
      * Renamed input format fields
     I              F0LQCD                          WLLQCD
     I              F0LRCD                          WLLRCD
     I              F0EQDT                          WLEQDT
     I              F0A5PR                          WLA5PR
     I              F0B8PR                          WLB8PR
     I              F0UVST                          WLUVST
     I              F0UWST                          WLUWST
     I              F0UXST                          WLUXST
     I              F0VSST                          WLVSST
     I              F0AATM                          WLAATM
     I              F0AYNA                          WLAYNA
     I              F0A0NA                          WLA0NA
     I              F0AXDT                          WLAXDT
      *
     I@K3CPKR
      * Price Change Audit Log    Co/Ord/Seq1&2/AdtSeq (D)
      * Renamed input format fields
     I              K3AIC3                          WMAIC3
     I              K3C4NB                          WMC4NB
     I              K3DPNB                          WMDPNB
     I              K3UENB                          WMUENB
     I              K3ASNO                          WMASNO
     I              K3HGCD                          WMHGCD
     I              K3GMST                          WMGMST
     I              K3GNST                          WMGNST
     I              K3AYVA                          WMAYVA
     I              K3YJVA                          WMYJVA
     I              K3U1ST                          WMU1ST
     I              K3PSTL                          WMPSTL
     I              K3U0ST                          WMU0ST
     I              K3RFCD                          WMRFCD
     I              K3PALS                          WMPALS
     I              K3WWCD                          WMWWCD
     I              K3AKPR                          WMAKPR
     I              K3DBPR                          WMDBPR
     I              K3ALPR                          WMALPR
     I              K3DCPR                          WMDCPR
     I              K3JPCD                          WMJPCD
     I              K3WXCD                          WMWXCD
     I              K3PREC                          WMPREC
     I              K3PIDX                          WMPIDX
     I              K3UVST                          WMUVST
     I              K3UWST                          WMUWST
     I              K3UXST                          WMUXST
     I              K3AATM                          WMAATM
     I              K3AYNA                          WMAYNA
     I              K3A0NA                          WMA0NA
     I              K3AXDT                          WMAXDT
      *
     I@K3CPKP
      * Price Change Audit Log    Update index
      * Renamed input format fields
     I              K3AIC3                          WOAIC3
     I              K3C4NB                          WOC4NB
     I              K3DPNB                          WODPNB
     I              K3UENB                          WOUENB
     I              K3ASNO                          WOASNO
     I              K3HGCD                          WOHGCD
     I              K3GMST                          WOGMST
     I              K3GNST                          WOGNST
     I              K3AYVA                          WOAYVA
     I              K3YJVA                          WOYJVA
     I              K3U1ST                          WOU1ST
     I              K3PSTL                          WOPSTL
     I              K3U0ST                          WOU0ST
     I              K3RFCD                          WORFCD
     I              K3PALS                          WOPALS
     I              K3WWCD                          WOWWCD
     I              K3AKPR                          WOAKPR
     I              K3DBPR                          WODBPR
     I              K3ALPR                          WOALPR
     I              K3DCPR                          WODCPR
     I              K3JPCD                          WOJPCD
     I              K3WXCD                          WOWXCD
     I              K3PREC                          WOPREC
     I              K3PIDX                          WOPIDX
     I              K3UVST                          WOUVST
     I              K3UWST                          WOUWST
     I              K3UXST                          WOUXST
     I              K3AATM                          WOAATM
     I              K3AYNA                          WOAYNA
     I              K3A0NA                          WOA0NA
     I              K3AXDT                          WOAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WRAIC3
     I              OMC4NB                          WRC4NB
     I              OMDPNB                          WRDPNB
     I              OMUENB                          WRUENB
     I              OMHGCD                          WRHGCD
     I              OMAJCD                          WRAJCD
     I              OMBKC7                          WRBKC7
     I              OMCFC7                          WRCFC7
     I              OMGMST                          WRGMST
     I              OMGNST                          WRGNST
     I              OMMAVA                          WRMAVA
     I              OMKDVA                          WRKDVA
     I              OML8VA                          WRL8VA
     I              OML9VA                          WRL9VA
     I              OMGTST                          WRGTST
     I              OMGVST                          WRGVST
     I              OMGUST                          WRGUST
     I              OMQFST                          WRQFST
     I              OMAYVA                          WRAYVA
     I              OMEXDT                          WREXDT
     I              OMLQCD                          WRLQCD
     I              OMRDCD                          WRRDCD
     I              OMQ7CD                          WRQ7CD
     I              OMBZPR                          WRBZPR
     I              OML6NB                          WRL6NB
     I              OMU1ST                          WRU1ST
     I              OMGIDT                          WRGIDT
     I              OMCRCD                          WRCRCD
     I              OMAGCD                          WRAGCD
     I              OMRZST                          WRRZST
     I              OMR0ST                          WRR0ST
     I              OMR1ST                          WRR1ST
     I              OMG7NA                          WRG7NA
     I              OMG8NA                          WRG8NA
     I              OMRPCD                          WRRPCD
     I              OMVEST                          WRVEST
     I              OMVGST                          WRVGST
     I              OMAVST                          WRAVST
     I              OMU0ST                          WRU0ST
     I              OMRFCD                          WRRFCD
     I              OMFZST                          WRFZST
     I              OMR1NB                          WRR1NB
     I              OMAVQT                          WRAVQT
     I              OMD0WG                          WRD0WG
     I              OMCCQT                          WRCCQT
     I              OMAUWG                          WRAUWG
     I              OMCBQT                          WRCBQT
     I              OMATWG                          WRATWG
     I              OMAQCS                          WRAQCS
     I              OMAGCS                          WRAGCS
     I              OMAKPR                          WRAKPR
     I              OMALPR                          WRALPR
     I              OMAUPR                          WRAUPR
     I              OMAVWG                          WRAVWG
     I              OMA4WG                          WRA4WG
     I              OMA5DT                          WRA5DT
     I              OMAODT                          WRAODT
     I              OMGNDT                          WRGNDT
     I              OMAMST                          WRAMST
     I              OMANST                          WRANST
     I              OMVAST                          WRVAST
     I              OMRGNB                          WRRGNB
     I              OMRHNB                          WRRHNB
     I              OMRINB                          WRRINB
     I              OMRBCD                          WRRBCD
     I              OMHICD                          WRHICD
     I              OMRNCD                          WRRNCD
     I              OMROCD                          WRROCD
     I              OMCXDT                          WRCXDT
     I              OMAJVN                          WRAJVN
     I              OMKXCD                          WRKXCD
     I              OMJPCD                          WRJPCD
     I              OMCQCD                          WRCQCD
     I              OMR4CD                          WRR4CD
     I              OMZ1ST                          WRZ1ST
     I              OMZ3ST                          WRZ3ST
     I              OMZ4ST                          WRZ4ST
     I              OMDUPR                          WRDUPR
     I              OMB6VL                          WRB6VL
     I              OMA1AA                          WRA1AA
     I              OMFZSX                          WRFZSX
     I              OMF0SX                          WRF0SX
     I              OMF1SX                          WRF1SX
     I              OMF2SX                          WRF2SX
     I              OMF3SX                          WRF3SX
     I              OMF4SX                          WRF4SX
     I              OMF5SX                          WRF5SX
     I              OMF6SX                          WRF6SX
     I              OMF7SX                          WRF7SX
     I              OMNTDT                          WRNTDT
     I              OMNUDT                          WRNUDT
     I              OMNVDT                          WRNVDT
     I              OMNWDT                          WRNWDT
     I              OMNXDT                          WRNXDT
     I              OMBUTM                          WRBUTM
     I              OMBVTM                          WRBVTM
     I              OMBWTM                          WRBWTM
     I              OMBXTM                          WRBXTM
     I              OMBYTM                          WRBYTM
     I              OMH5NX                          WRH5NX
     I              OMH6NX                          WRH6NX
     I              OMH7NX                          WRH7NX
     I              OMH8NX                          WRH8NX
     I              OMH9NX                          WRH9NX
     I              OMDVPR                          WRDVPR
     I              OMDWPR                          WRDWPR
     I              OMDXPR                          WRDXPR
     I              OMDYPR                          WRDYPR
     I              OMDZPR                          WRDZPR
     I              OMGSPR                          WRGSPR
     I              OMGTPR                          WRGTPR
     I              OMGUPR                          WRGUPR
     I              OMHOST                          WRHOST
     I              OMHPST                          WRHPST
     I              OMIOST                          WRIOST
     I              OMPEWG                          WRPEWG
     I              OMRINY                          WRRINY
     I              OMTIDT                          WRTIDT
     I              OMTJDT                          WRTJDT
     I              OMH2ST                          WRH2ST
     I              OMH0ST                          WRH0ST
     I              OMH1ST                          WRH1ST
     I              OMTKDT                          WRTKDT
     I              OMTLDT                          WRTLDT
     I              OMTMDT                          WRTMDT
     I              OMUVST                          WRUVST
     I              OMUWST                          WRUWST
     I              OMUXST                          WRUXST
     I              OMAATM                          WRAATM
     I              OMAYNA                          WRAYNA
     I              OMA0NA                          WRA0NA
     I              OMAXDT                          WRAXDT
      *
     I@EXRETY
      * Order Types               Active order Types
      * Renamed input format fields
     I              EXJNCD                          WSJNCD
     I              EXJVNA                          WSJVNA
     I              EXOAST                          WSOAST
     I              EXOBST                          WSOBST
     I              EXOEST                          WSOEST
     I              EXOFST                          WSOFST
     I              EXVBST                          WSVBST
     I              EXPYST                          WSPYST
     I              EXX8ST                          WSX8ST
     I              EXISTX                          WSISTX
     I              EXUVST                          WSUVST
     I              EXUWST                          WSUWST
     I              EXUXST                          WSUXST
     I              EXVSST                          WSVSST
     I              EXAATM                          WSAATM
     I              EXAYNA                          WSAYNA
     I              EXA0NA                          WSA0NA
     I              EXAXDT                          WSAXDT
      *
     I@BCREFE
      * A/R Summary               Retrieval index       NV
      * Renamed input format fields
     I              BCAIC3                          WTAIC3
     I              BCANC7                          WTANC7
     I              BCAGVA                          WTAGVA
     I              BCACVA                          WTACVA
     I              BCADVA                          WTADVA
     I              BCAEVA                          WTAEVA
     I              BCAFVA                          WTAFVA
     I              BCAHVA                          WTAHVA
     I              BCVIVA                          WTVIVA
     I              BCVJVA                          WTVJVA
     I              BCVKVA                          WTVKVA
     I              BCVLVA                          WTVLVA
     I              BCVMVA                          WTVMVA
     I              BCVNVA                          WTVNVA
     I              BCEEVA                          WTEEVA
     I              BCAKTM                          WTAKTM
     I              BCAHDT                          WTAHDT
     I              BCANDT                          WTANDT
     I              BCANVA                          WTANVA
     I              BCALDT                          WTALDT
     I              BCAMVA                          WTAMVA
     I              BCAIDT                          WTAIDT
     I              BCALVA                          WTALVA
     I              BCDJNB                          WTDJNB
     I              BCDLNB                          WTDLNB
     I              BCDDNB                          WTDDNB
     I              BCDMNB                          WTDMNB
     I              BCDUDT                          WTDUDT
     I              BCLYNO                          WTLYNO
     I              BCLYNC                          WTLYNC
     I              BCLYNP                          WTLYNP
     I              BCLYNI                          WTLYNI
     I              BCADPM                          WTADPM
     I              BCVOVA                          WTVOVA
     I              BCBTDY                          WTBTDY
     I              BCBUDY                          WTBUDY
     I              BCVPVA                          WTVPVA
     I              BCVQVA                          WTVQVA
     I              BCBCCD                          WTBCCD
     I              BCR4CD                          WTR4CD
     I              BCCUMO                          WTCUMO
     I              BCUVST                          WTUVST
     I              BCUWST                          WTUWST
     I              BCUXST                          WTUXST
     I              BCAATM                          WTAATM
     I              BCAYNA                          WTAYNA
     I              BCA0NA                          WTA0NA
     I              BCAXDT                          WTAXDT
      *
     I@BCREFD
      * A/R Summary               Update index
      * Renamed input format fields
     I              BCAIC3                          WVAIC3
     I              BCANC7                          WVANC7
     I              BCAGVA                          WVAGVA
     I              BCACVA                          WVACVA
     I              BCADVA                          WVADVA
     I              BCAEVA                          WVAEVA
     I              BCAFVA                          WVAFVA
     I              BCAHVA                          WVAHVA
     I              BCVIVA                          WVVIVA
     I              BCVJVA                          WVVJVA
     I              BCVKVA                          WVVKVA
     I              BCVLVA                          WVVLVA
     I              BCVMVA                          WVVMVA
     I              BCVNVA                          WVVNVA
     I              BCEEVA                          WVEEVA
     I              BCAKTM                          WVAKTM
     I              BCAHDT                          WVAHDT
     I              BCANDT                          WVANDT
     I              BCANVA                          WVANVA
     I              BCALDT                          WVALDT
     I              BCAMVA                          WVAMVA
     I              BCAIDT                          WVAIDT
     I              BCALVA                          WVALVA
     I              BCDJNB                          WVDJNB
     I              BCDLNB                          WVDLNB
     I              BCDDNB                          WVDDNB
     I              BCDMNB                          WVDMNB
     I              BCDUDT                          WVDUDT
     I              BCLYNO                          WVLYNO
     I              BCLYNC                          WVLYNC
     I              BCLYNP                          WVLYNP
     I              BCLYNI                          WVLYNI
     I              BCADPM                          WVADPM
     I              BCVOVA                          WVVOVA
     I              BCBTDY                          WVBTDY
     I              BCBUDY                          WVBUDY
     I              BCVPVA                          WVVPVA
     I              BCVQVA                          WVVQVA
     I              BCBCCD                          WVBCCD
     I              BCR4CD                          WVR4CD
     I              BCCUMO                          WVCUMO
     I              BCUVST                          WVUVST
     I              BCUWST                          WVUWST
     I              BCUXST                          WVUXST
     I              BCAATM                          WVAATM
     I              BCAYNA                          WVAYNA
     I              BCA0NA                          WVA0NA
     I              BCAXDT                          WVAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WWAIC3
     I              BEC4NB                          WWC4NB
     I              BEJNCD                          WWJNCD
     I              BEANC7                          WWANC7
     I              BEBKC7                          WWBKC7
     I              BEBRTX                          WWBRTX
     I              BEHMNA                          WWHMNA
     I              BEHONA                          WWHONA
     I              BEHPNA                          WWHPNA
     I              BEHNNA                          WWHNNA
     I              BEDBCD                          WWDBCD
     I              BECKTX                          WWCKTX
     I              BEB0C7                          WWB0C7
     I              BEAETX                          WWAETX
     I              BEB1NA                          WWB1NA
     I              BEB3NA                          WWB3NA
     I              BEB4NA                          WWB4NA
     I              BEB2NA                          WWB2NA
     I              BEBHCD                          WWBHCD
     I              BEC8TX                          WWC8TX
     I              BEBCNA                          WWBCNA
     I              BEA0DT                          WWA0DT
     I              BEA5DT                          WWA5DT
     I              BEGNDT                          WWGNDT
     I              BEACDT                          WWACDT
     I              BEAQCD                          WWAQCD
     I              BEB6NA                          WWB6NA
     I              BEBYNA                          WWBYNA
     I              BEBZNA                          WWBZNA
     I              BEGTST                          WWGTST
     I              BEGVST                          WWGVST
     I              BEGUST                          WWGUST
     I              BEQFST                          WWQFST
     I              BECQCD                          WWCQCD
     I              BEGJST                          WWGJST
     I              BEGWST                          WWGWST
     I              BEGXST                          WWGXST
     I              BEGYST                          WWGYST
     I              BEAODT                          WWAODT
     I              BEAIVN                          WWAIVN
     I              BECXDT                          WWCXDT
     I              BEJZVA                          WWJZVA
     I              BEA1WG                          WWA1WG
     I              BEXIST                          WWXIST
     I              BEXJST                          WWXJST
     I              BEXKST                          WWXKST
     I              BEEIDT                          WWEIDT
     I              BEAFTM                          WWAFTM
     I              BEE8CD                          WWE8CD
     I              BEE9CD                          WWE9CD
     I              BERMNB                          WWRMNB
     I              BETBNB                          WWTBNB
     I              BER1NB                          WWR1NB
     I              BEPJST                          WWPJST
     I              BEU0ST                          WWU0ST
     I              BEU1ST                          WWU1ST
     I              BEQ2CD                          WWQ2CD
     I              BEU2ST                          WWU2ST
     I              BEVEST                          WWVEST
     I              BEVFST                          WWVFST
     I              BEVGST                          WWVGST
     I              BERPCD                          WWRPCD
     I              BERNNB                          WWRNNB
     I              BEVDST                          WWVDST
     I              BEATIN                          WWATIN
     I              BEU4ST                          WWU4ST
     I              BEU5ST                          WWU5ST
     I              BERSRN                          WWRSRN
     I              BEMHNA                          WWMHNA
     I              BEMINA                          WWMINA
     I              BEWBST                          WWWBST
     I              BER4CD                          WWR4CD
     I              BEBFCD                          WWBFCD
     I              BEQ4CD                          WWQ4CD
     I              BET3NB                          WWT3NB
     I              BESICD                          WWSICD
     I              BECONB                          WWCONB
     I              BECEST                          WWCEST
     I              BEAWDT                          WWAWDT
     I              BEJPCD                          WWJPCD
     I              BEXUST                          WWXUST
     I              BEZ1ST                          WWZ1ST
     I              BEVRVA                          WWVRVA
     I              BEOBST                          WWOBST
     I              BEBCST                          WWBCST
     I              BEBDST                          WWBDST
     I              BEB7VL                          WWB7VL
     I              BEGASX                          WWGASX
     I              BEGBSX                          WWGBSX
     I              BEGCSX                          WWGCSX
     I              BEGDSX                          WWGDSX
     I              BEFNSX                          WWFNSX
     I              BEFOSX                          WWFOSX
     I              BEFPSX                          WWFPSX
     I              BEFQSX                          WWFQSX
     I              BEFRSX                          WWFRSX
     I              BEFSSX                          WWFSSX
     I              BEFTSX                          WWFTSX
     I              BEFUSX                          WWFUSX
     I              BEFVSX                          WWFVSX
     I              BEFWSX                          WWFWSX
     I              BEFXSX                          WWFXSX
     I              BEFYSX                          WWFYSX
     I              BENODT                          WWNODT
     I              BENPDT                          WWNPDT
     I              BENQDT                          WWNQDT
     I              BENRDT                          WWNRDT
     I              BENSDT                          WWNSDT
     I              BEBPTM                          WWBPTM
     I              BEBQTM                          WWBQTM
     I              BEBRTM                          WWBRTM
     I              BEBSTM                          WWBSTM
     I              BEBTTM                          WWBTTM
     I              BEH0NX                          WWH0NX
     I              BEH1NX                          WWH1NX
     I              BEH2NX                          WWH2NX
     I              BEH3NX                          WWH3NX
     I              BEH4NX                          WWH4NX
     I              BEC0C7                          WWC0C7
     I              BEUVST                          WWUVST
     I              BEUWST                          WWUWST
     I              BEUXST                          WWUXST
     I              BEAATM                          WWAATM
     I              BEAYNA                          WWAYNA
     I              BEA0NA                          WWA0NA
     I              BEAXDT                          WWAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WDAIC3
     I              OMC4NB                          WDC4NB
     I              OMDPNB                          WDDPNB
     I              OMUENB                          WDUENB
     I              OMHGCD                          WDHGCD
     I              OMAJCD                          WDAJCD
     I              OMBKC7                          WDBKC7
     I              OMCFC7                          WDCFC7
     I              OMGMST                          WDGMST
     I              OMGNST                          WDGNST
     I              OMMAVA                          WDMAVA
     I              OMKDVA                          WDKDVA
     I              OML8VA                          WDL8VA
     I              OML9VA                          WDL9VA
     I              OMGTST                          WDGTST
     I              OMGVST                          WDGVST
     I              OMGUST                          WDGUST
     I              OMQFST                          WDQFST
     I              OMAYVA                          WDAYVA
     I              OMEXDT                          WDEXDT
     I              OMLQCD                          WDLQCD
     I              OMRDCD                          WDRDCD
     I              OMQ7CD                          WDQ7CD
     I              OMBZPR                          WDBZPR
     I              OML6NB                          WDL6NB
     I              OMU1ST                          WDU1ST
     I              OMGIDT                          WDGIDT
     I              OMCRCD                          WDCRCD
     I              OMAGCD                          WDAGCD
     I              OMRZST                          WDRZST
     I              OMR0ST                          WDR0ST
     I              OMR1ST                          WDR1ST
     I              OMG7NA                          WDG7NA
     I              OMG8NA                          WDG8NA
     I              OMRPCD                          WDRPCD
     I              OMVEST                          WDVEST
     I              OMVGST                          WDVGST
     I              OMAVST                          WDAVST
     I              OMU0ST                          WDU0ST
     I              OMRFCD                          WDRFCD
     I              OMFZST                          WDFZST
     I              OMR1NB                          WDR1NB
     I              OMAVQT                          WDAVQT
     I              OMD0WG                          WDD0WG
     I              OMCCQT                          WDCCQT
     I              OMAUWG                          WDAUWG
     I              OMCBQT                          WDCBQT
     I              OMATWG                          WDATWG
     I              OMAQCS                          WDAQCS
     I              OMAGCS                          WDAGCS
     I              OMAKPR                          WDAKPR
     I              OMALPR                          WDALPR
     I              OMAUPR                          WDAUPR
     I              OMAVWG                          WDAVWG
     I              OMA4WG                          WDA4WG
     I              OMA5DT                          WDA5DT
     I              OMAODT                          WDAODT
     I              OMGNDT                          WDGNDT
     I              OMAMST                          WDAMST
     I              OMANST                          WDANST
     I              OMVAST                          WDVAST
     I              OMRGNB                          WDRGNB
     I              OMRHNB                          WDRHNB
     I              OMRINB                          WDRINB
     I              OMRBCD                          WDRBCD
     I              OMHICD                          WDHICD
     I              OMRNCD                          WDRNCD
     I              OMROCD                          WDROCD
     I              OMCXDT                          WDCXDT
     I              OMAJVN                          WDAJVN
     I              OMKXCD                          WDKXCD
     I              OMJPCD                          WDJPCD
     I              OMCQCD                          WDCQCD
     I              OMR4CD                          WDR4CD
     I              OMZ1ST                          WDZ1ST
     I              OMZ3ST                          WDZ3ST
     I              OMZ4ST                          WDZ4ST
     I              OMDUPR                          WDDUPR
     I              OMB6VL                          WDB6VL
     I              OMA1AA                          WDA1AA
     I              OMFZSX                          WDFZSX
     I              OMF0SX                          WDF0SX
     I              OMF1SX                          WDF1SX
     I              OMF2SX                          WDF2SX
     I              OMF3SX                          WDF3SX
     I              OMF4SX                          WDF4SX
     I              OMF5SX                          WDF5SX
     I              OMF6SX                          WDF6SX
     I              OMF7SX                          WDF7SX
     I              OMNTDT                          WDNTDT
     I              OMNUDT                          WDNUDT
     I              OMNVDT                          WDNVDT
     I              OMNWDT                          WDNWDT
     I              OMNXDT                          WDNXDT
     I              OMBUTM                          WDBUTM
     I              OMBVTM                          WDBVTM
     I              OMBWTM                          WDBWTM
     I              OMBXTM                          WDBXTM
     I              OMBYTM                          WDBYTM
     I              OMH5NX                          WDH5NX
     I              OMH6NX                          WDH6NX
     I              OMH7NX                          WDH7NX
     I              OMH8NX                          WDH8NX
     I              OMH9NX                          WDH9NX
     I              OMDVPR                          WDDVPR
     I              OMDWPR                          WDDWPR
     I              OMDXPR                          WDDXPR
     I              OMDYPR                          WDDYPR
     I              OMDZPR                          WDDZPR
     I              OMGSPR                          WDGSPR
     I              OMGTPR                          WDGTPR
     I              OMGUPR                          WDGUPR
     I              OMHOST                          WDHOST
     I              OMHPST                          WDHPST
     I              OMIOST                          WDIOST
     I              OMPEWG                          WDPEWG
     I              OMRINY                          WDRINY
     I              OMTIDT                          WDTIDT
     I              OMTJDT                          WDTJDT
     I              OMH2ST                          WDH2ST
     I              OMH0ST                          WDH0ST
     I              OMH1ST                          WDH1ST
     I              OMTKDT                          WDTKDT
     I              OMTLDT                          WDTLDT
     I              OMTMDT                          WDTMDT
     I              OMUVST                          WDUVST
     I              OMUWST                          WDUWST
     I              OMUXST                          WDUXST
     I              OMAATM                          WDAATM
     I              OMAYNA                          WDAYNA
     I              OMA0NA                          WDA0NA
     I              OMAXDT                          WDAXDT
      *
     IYARDCS      DS                            525
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                            525
     IQPDK31    E DSPDK3CPL0
      * UPD : Price Change Audit Log    Update index
      * Renamed input format fields
     I              K3AIC3                          WOAIC3
     I              K3C4NB                          WOC4NB
     I              K3DPNB                          WODPNB
     I              K3UENB                          WOUENB
     I              K3ASNO                          WOASNO
     I              K3HGCD                          WOHGCD
     I              K3GMST                          WOGMST
     I              K3GNST                          WOGNST
     I              K3AYVA                          WOAYVA
     I              K3YJVA                          WOYJVA
     I              K3U1ST                          WOU1ST
     I              K3PSTL                          WOPSTL
     I              K3U0ST                          WOU0ST
     I              K3RFCD                          WORFCD
     I              K3PALS                          WOPALS
     I              K3WWCD                          WOWWCD
     I              K3AKPR                          WOAKPR
     I              K3DBPR                          WODBPR
     I              K3ALPR                          WOALPR
     I              K3DCPR                          WODCPR
     I              K3JPCD                          WOJPCD
     I              K3WXCD                          WOWXCD
     I              K3PREC                          WOPREC
     I              K3PIDX                          WOPIDX
     I              K3UVST                          WOUVST
     I              K3UWST                          WOUWST
     I              K3UXST                          WOUXST
     I              K3AATM                          WOAATM
     I              K3AYNA                          WOAYNA
     I              K3A0NA                          WOA0NA
     I              K3AXDT                          WOAXDT
      *
     IQARBC1    E DSARBCREL0
      * UPD : A/R Summary               Update index
      * Renamed input format fields
     I              BCAIC3                          WVAIC3
     I              BCANC7                          WVANC7
     I              BCAGVA                          WVAGVA
     I              BCACVA                          WVACVA
     I              BCADVA                          WVADVA
     I              BCAEVA                          WVAEVA
     I              BCAFVA                          WVAFVA
     I              BCAHVA                          WVAHVA
     I              BCVIVA                          WVVIVA
     I              BCVJVA                          WVVJVA
     I              BCVKVA                          WVVKVA
     I              BCVLVA                          WVVLVA
     I              BCVMVA                          WVVMVA
     I              BCVNVA                          WVVNVA
     I              BCEEVA                          WVEEVA
     I              BCAKTM                          WVAKTM
     I              BCAHDT                          WVAHDT
     I              BCANDT                          WVANDT
     I              BCANVA                          WVANVA
     I              BCALDT                          WVALDT
     I              BCAMVA                          WVAMVA
     I              BCAIDT                          WVAIDT
     I              BCALVA                          WVALVA
     I              BCDJNB                          WVDJNB
     I              BCDLNB                          WVDLNB
     I              BCDDNB                          WVDDNB
     I              BCDMNB                          WVDMNB
     I              BCDUDT                          WVDUDT
     I              BCLYNO                          WVLYNO
     I              BCLYNC                          WVLYNC
     I              BCLYNP                          WVLYNP
     I              BCLYNI                          WVLYNI
     I              BCADPM                          WVADPM
     I              BCVOVA                          WVVOVA
     I              BCBTDY                          WVBTDY
     I              BCBUDY                          WVBUDY
     I              BCVPVA                          WVVPVA
     I              BCVQVA                          WVVQVA
     I              BCBCCD                          WVBCCD
     I              BCR4CD                          WVR4CD
     I              BCCUMO                          WVCUMO
     I              BCUVST                          WVUVST
     I              BCUWST                          WVUWST
     I              BCUXST                          WVUXST
     I              BCAATM                          WVAATM
     I              BCAYNA                          WVAYNA
     I              BCA0NA                          WVA0NA
     I              BCAXDT                          WVAXDT
      *
     IYCRDCS      DS                            213
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WWAIC3
     I              BEC4NB                          WWC4NB
     I              BEJNCD                          WWJNCD
     I              BEANC7                          WWANC7
     I              BEBKC7                          WWBKC7
     I              BEBRTX                          WWBRTX
     I              BEHMNA                          WWHMNA
     I              BEHONA                          WWHONA
     I              BEHPNA                          WWHPNA
     I              BEHNNA                          WWHNNA
     I              BEDBCD                          WWDBCD
     I              BECKTX                          WWCKTX
     I              BEB0C7                          WWB0C7
     I              BEAETX                          WWAETX
     I              BEB1NA                          WWB1NA
     I              BEB3NA                          WWB3NA
     I              BEB4NA                          WWB4NA
     I              BEB2NA                          WWB2NA
     I              BEBHCD                          WWBHCD
     I              BEC8TX                          WWC8TX
     I              BEBCNA                          WWBCNA
     I              BEA0DT                          WWA0DT
     I              BEA5DT                          WWA5DT
     I              BEGNDT                          WWGNDT
     I              BEACDT                          WWACDT
     I              BEAQCD                          WWAQCD
     I              BEB6NA                          WWB6NA
     I              BEBYNA                          WWBYNA
     I              BEBZNA                          WWBZNA
     I              BEGTST                          WWGTST
     I              BEGVST                          WWGVST
     I              BEGUST                          WWGUST
     I              BEQFST                          WWQFST
     I              BECQCD                          WWCQCD
     I              BEGJST                          WWGJST
     I              BEGWST                          WWGWST
     I              BEGXST                          WWGXST
     I              BEGYST                          WWGYST
     I              BEAODT                          WWAODT
     I              BEAIVN                          WWAIVN
     I              BECXDT                          WWCXDT
     I              BEJZVA                          WWJZVA
     I              BEA1WG                          WWA1WG
     I              BEXIST                          WWXIST
     I              BEXJST                          WWXJST
     I              BEXKST                          WWXKST
     I              BEEIDT                          WWEIDT
     I              BEAFTM                          WWAFTM
     I              BEE8CD                          WWE8CD
     I              BEE9CD                          WWE9CD
     I              BERMNB                          WWRMNB
     I              BETBNB                          WWTBNB
     I              BER1NB                          WWR1NB
     I              BEPJST                          WWPJST
     I              BEU0ST                          WWU0ST
     I              BEU1ST                          WWU1ST
     I              BEQ2CD                          WWQ2CD
     I              BEU2ST                          WWU2ST
     I              BEVEST                          WWVEST
     I              BEVFST                          WWVFST
     I              BEVGST                          WWVGST
     I              BERPCD                          WWRPCD
     I              BERNNB                          WWRNNB
     I              BEVDST                          WWVDST
     I              BEATIN                          WWATIN
     I              BEU4ST                          WWU4ST
     I              BEU5ST                          WWU5ST
     I              BERSRN                          WWRSRN
     I              BEMHNA                          WWMHNA
     I              BEMINA                          WWMINA
     I              BEWBST                          WWWBST
     I              BER4CD                          WWR4CD
     I              BEBFCD                          WWBFCD
     I              BEQ4CD                          WWQ4CD
     I              BET3NB                          WWT3NB
     I              BESICD                          WWSICD
     I              BECONB                          WWCONB
     I              BECEST                          WWCEST
     I              BEAWDT                          WWAWDT
     I              BEJPCD                          WWJPCD
     I              BEXUST                          WWXUST
     I              BEZ1ST                          WWZ1ST
     I              BEVRVA                          WWVRVA
     I              BEOBST                          WWOBST
     I              BEBCST                          WWBCST
     I              BEBDST                          WWBDST
     I              BEB7VL                          WWB7VL
     I              BEGASX                          WWGASX
     I              BEGBSX                          WWGBSX
     I              BEGCSX                          WWGCSX
     I              BEGDSX                          WWGDSX
     I              BEFNSX                          WWFNSX
     I              BEFOSX                          WWFOSX
     I              BEFPSX                          WWFPSX
     I              BEFQSX                          WWFQSX
     I              BEFRSX                          WWFRSX
     I              BEFSSX                          WWFSSX
     I              BEFTSX                          WWFTSX
     I              BEFUSX                          WWFUSX
     I              BEFVSX                          WWFVSX
     I              BEFWSX                          WWFWSX
     I              BEFXSX                          WWFXSX
     I              BEFYSX                          WWFYSX
     I              BENODT                          WWNODT
     I              BENPDT                          WWNPDT
     I              BENQDT                          WWNQDT
     I              BENRDT                          WWNRDT
     I              BENSDT                          WWNSDT
     I              BEBPTM                          WWBPTM
     I              BEBQTM                          WWBQTM
     I              BEBRTM                          WWBRTM
     I              BEBSTM                          WWBSTM
     I              BEBTTM                          WWBTTM
     I              BEH0NX                          WWH0NX
     I              BEH1NX                          WWH1NX
     I              BEH2NX                          WWH2NX
     I              BEH3NX                          WWH3NX
     I              BEH4NX                          WWH4NX
     I              BEC0C7                          WWC0C7
     I              BEUVST                          WWUVST
     I              BEUWST                          WWUWST
     I              BEUXST                          WWUXST
     I              BEAATM                          WWAATM
     I              BEAYNA                          WWAYNA
     I              BEA0NA                          WWA0NA
     I              BEAXDT                          WWAXDT
      *
     IYDRDCS      DS                            779
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type - Sales
     I                                        7   8 PAJNCD
      * I :  AR Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400_Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PANQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PANRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PABSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Detail
      * I : MAP Company Number
     I                                    P   1   20P1AIC3
      * I : MAP Order Number
     I                                    P   3   60P1C4NB
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Send Price MSG to Seaboar'
      * Order Number
     I                                        1   7 ZA0001
      * Order Sequence Number
     I                                    P   8   90ZA0002
      * Item Code
     I                                       10  16 ZA0003
      * Catch Weight Status
     I                                       17  17 ZA0004
      * Unit Price
     I                                    P  18  234ZA0005
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Exc Gate Adj needed?  XF
      * WHD 89095
      * RMC 01/12/22 added to make sure JPN shipped orders have the gate
      *  adjustment calculated. if they were Gate priced before ship, the
      * RTV Header Status      RT - Order Header TRG  * 
     C                     EXSR SARVGN
      * CASE: LCL.Header Status is Confirmed
     C           YL0001    IFEQ 'R'                        *IF
      * Rtv Gate Adj Aft/Ship RT - Order Detail  * 
     C                     EXSR SBRVGN
      * CASE: LCL.Status Flag 1  Y/N is Yes
     C           YL0003    IFEQ 'Y'                        *IF
     C                     Z-ADD*ZERO     YL0004           OD Gate/Final P
     C                     Z-ADD*ZERO     YL0005           OD Weighted Avg
      * Exc Calc Gat Prc Aj/Av XF - Order Detail  * 
     C                     CALL 'PBIGXFR'              90  Exc Calc Gat Pr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0001  30       Company Number
     C                     PARM P1C4NB    WQ0002  70       Order Number
     C                     PARM YL0002    WQ0003 114       Order Gate/Fina
     C           YL0004    PARM YL0004    WQ0004 114       OD Gate/Final P
     C           YL0005    PARM YL0005    WQ0005 114       OD Weighted Avg
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBIGXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.OD Gate/Final Price Adj is Not Zeros
     C           YL0004    IFNE *ZERO                      *IF
      * CHG Order Gate Price   RT - Order Detail  * 
     C                     EXSR SCRVGN
      * CLC Price/Price Audit  RT - Order Header TRG  * 
     C                     EXSR SERVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Header Status      RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP1C4NB    WAC4NB           Order Number
      * Establish starting position
     C           KRSSA     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAGWST    YL0001           Header Status
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Gate Adj Aft/Ship RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0003           Status Flag 1
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSB02           Order Number
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSB01           Company Number
     C                     Z-ADDP1C4NB    WQSB02           Order Number
      * Establish starting position
     C           KRSSB     SETLL@BGWKFW                    *
     C           KRSSB     READE@BGWKFW                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * if the price needs to be calc'd on any of the details, set flag t
      * CASE:
      *  - (c3ORc5)ANDc1ANDc2
      *   |- c3    : DB1.Price Method Code is Deviated Flat Duty Item
      *   |- c5    : DB1.Price Method Code is Deviated Gate Price
      *   |- c1    : DB1.Order Gate/Final Price is Not Zeros
      *   |- c2    : DB1.OD Gate/Final Price Adj is Equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C                     MOVEL'0'       Y0CX02  1
     C           WBQ7CD    IFEQ 'DVF'                      *IF
     C           WBQ7CD    OREQ 'DVG'                      *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C           WBDVPR    IFNE 0                          *IF
     C           WBDXPR    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWBDVPR    YL0002           Order Gate/Fina
     C                     MOVEL'Y'       YL0003           Status Flag 1
     C                     END                             *FI
     C           KRSSB     READE@BGWKFW                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * CHG Order Gate Price   RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0006           Display Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSC02           Order Number
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
     C                     KFLD           WCDPNB           Order Sequence
     C                     KFLD           WCUENB           Order Secondary
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSC01           Company Number
     C                     Z-ADDP1C4NB    WQSC02           Order Number
     C                     Z-ADD1         WCDPNB           Order Sequence
     C                     Z-ADD1         WCUENB           Order Secondary
      * Establish starting position
     C           KPSSC     SETLL@BGWKL1                    *
     C           KRSSC     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WCGMST    IFEQ 'L'                        *IF
     C           WCGMST    OREQ 'A'
     C           WCGMST    OREQ 'C'
     C           WCGMST    OREQ 'R'
     C           WCGMST    OREQ 'E'
     C           WCGMST    OREQ 'H'
     C           WCGMST    OREQ 'I'
      * E2494 RMC 4.1.13 upd gate price adj and weight avg price
      * CHG Order Gate Price   CH - Order Detail  * 
     C                     EXSR SDCHRC
     C                     MOVEL'Y'       YL0006           Display Flag
     C                     END                             *FI
     C           KRSSC     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCHRC    BEGSR
      *================================================================
      * CHG Order Gate Price   CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       Item Code
     C                     MOVEL*BLANK    WN0002  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0003  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0004  70       Order Group Cod
     C                     MOVEL*BLANK    WN0005  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0006  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0007 112       Billing Detail
     C                     Z-ADD*ZERO     WN0008 112       Billing Detail
     C                     Z-ADD*ZERO     WN0009 112       Billing Detail
     C                     Z-ADD*ZERO     WN0010 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0011  1        Comment Print A
     C                     MOVEL*BLANK    WN0012  1        Comment Print I
     C                     MOVEL*BLANK    WN0013  1        Comment Print P
     C                     MOVEL*BLANK    WN0014  1        Comment Print S
     C                     Z-ADD*ZERO     WN0015 112       Extended Amount
     C                     Z-ADD*ZERO     WN0016  70       Market Pricing
     C                     MOVEL*BLANK    WN0017  3        Commodity Marke
     C                     MOVEL*BLANK    WN0018  3        Date Method Cod
     C                     MOVEL*BLANK    WN0019  3        Price Method Co
     C                     Z-ADD*ZERO     WN0020 114       Price Overage O
     C                     Z-ADD*ZERO     WN0021  70       Contract Number
     C                     MOVEL*BLANK    WN0022  1        Price Status
     C                     Z-ADD*ZERO     WN0023  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0024  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0025  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0026  1        Work Confirm St
     C                     MOVEL*BLANK    WN0027  1        Work Over/Short
     C                     MOVEL*BLANK    WN0028  1        OD Production P
     C                     MOVEL*BLANK    WN0029 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0030 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0031  1        Age Code
     C                     MOVEL*BLANK    WN0032  1        Palletize
     C                     MOVEL*BLANK    WN0033  1        Slip Sheet
     C                     MOVEL*BLANK    WN0034  1        Catch Weight St
     C                     MOVEL*BLANK    WN0035  1        Price Audit
     C                     MOVEL*BLANK    WN0036  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0037  1        Production Date
     C                     Z-ADD*ZERO     WN0038 112       Rated Freight
     C                     Z-ADD*ZERO     WN0039 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0040 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0041 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0042 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0043 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0044 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0045 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0046 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0047 114       Unit Price
     C                     Z-ADD*ZERO     WN0048 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0049 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0050 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0051 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0052  70       Requested Ship
     C                     Z-ADD*ZERO     WN0053  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0054  70       Actual Shipped
     C                     MOVEL*BLANK    WN0055  1        Affect Inventor
     C                     MOVEL*BLANK    WN0056  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0057  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0058  30       Item Structure
     C                     Z-ADD*ZERO     WN0059  30       Item Structure
     C                     Z-ADD*ZERO     WN0060  30       Item Structure
     C                     MOVEL*BLANK    WN0061  2        Item Level
     C                     MOVEL*BLANK    WN0062  2        Quality Level
     C                     MOVEL*BLANK    WN0063  2        Pricing Product
     C                     MOVEL*BLANK    WN0064  2        Season Product
     C                     Z-ADD*ZERO     WN0065  70       Date of Origina
     C                     MOVEL*BLANK    WN0066 10        User Profile Na
     C                     MOVEL*BLANK    WN0067  6        Country Code
     C                     MOVEL*BLANK    WN0068  2        Event Code
     C                     MOVEL*BLANK    WN0069  3        Reason Code
     C                     MOVEL*BLANK    WN0070  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0071  1        Modified Flag
     C                     MOVEL*BLANK    WN0072  1        Substituted Fla
     C                     MOVEL*BLANK    WN0073  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0074 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0075 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0076  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0077  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0078  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0079  1        Affect Commissi
     C                     MOVEL*BLANK    WN0080  1        Affect Pricing
     C                     MOVEL*BLANK    WN0081  1        Released by Use
     C                     MOVEL*BLANK    WN0082  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0083  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0084  3        Production Ware
     C                     MOVEL*BLANK    WN0085  3        OD Price Type
     C                     Z-ADD*ZERO     WN0086  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0087  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0088  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0089  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0090  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0091  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0092  60       Price Code
     C                     Z-ADD*ZERO     WN0093  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0094  60       Substitution Li
     C                     Z-ADD*ZERO     WN0095  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0096 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0097 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0098 112       OD Item Target
     C                     Z-ADD*ZERO     WN0099 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0100 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0101 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0102 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0103 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0104 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0105 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0106  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0107  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0108  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0109 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0110  40       Item Age Days
     C                     Z-ADD*ZERO     WN0111  70       Production Ovr
     C                     Z-ADD*ZERO     WN0112  70       Production Ovr
     C                     MOVEL*BLANK    WN0113  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0114  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0115  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0116  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0117  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0118  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0119  1        EDI Status 1
     C                     MOVEL*BLANK    WN0120  1        EDI Status 2
     C                     MOVEL*BLANK    WN0121  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0122  60       Job Time
     C                     MOVEL*BLANK    WN0123 10        User Id
     C                     MOVEL*BLANK    WN0124 10        Job Name
     C                     Z-ADD*ZERO     WN0125  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWCAIC3    WDAIC3           Company Number
     C                     Z-ADDWCC4NB    WDC4NB           Order Number
     C                     Z-ADDWCDPNB    WDDPNB           Order Sequence
     C                     Z-ADDWCUENB    WDUENB           Order Secondary
      *
     C           KLCHSD    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
     C                     KFLD           WDDPNB           Order Sequence
     C                     KFLD           WDUENB           Order Secondary
     C           KLCHSD    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YARDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDYL0002    WDDVPR           Order Gate/Fina
     C                     Z-ADDYL0004    WDDXPR           OD Gate/Final P
     C                     Z-ADDYL0005    WDDYPR           OD Weighted Avg
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * CLC Price/Price Audit  RT - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0126  1        Price Audit
     C                     MOVEL*BLANK    WN0127  1        Price Status
     C                     Z-ADD*ZERO     WN0128 112       A/R order Value
     C                     Z-ADD*ZERO     WN0129 112       USR Order Weigh
     C                     Z-ADD*ZERO     WN0130 112       USR Order Value
     C                     MOVEL*BLANK    WN0131  1        Billing Activit
     C                     MOVEL*BLANK    WN0132  1        Price Status US
     C                     MOVEL*BLANK    WN0133  1        Price Audit USR
     C                     MOVEL*BLANK    WN0134  2        Type Code
     C                     MOVEL*BLANK    WN0135  1        Allow Man/Qt WO
     C                     Z-ADD*ZERO     WN0136  30       Accounting Comp
     C                     Z-ADD*ZERO     WN0137  30       Shipping Compan
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP1C4NB    WAC4NB           Order Number
      * Establish starting position
     C           KRSSE     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV Allow Man/Qt Flag  RT - Company Customer  * 
     C                     EXSR SFRVGN
      * CASE: DB1.Header Status is Not cancelled
     C           WAGWST    IFEQ 'L'                        *IF
     C           WAGWST    OREQ 'A'
     C           WAGWST    OREQ 'C'
     C           WAGWST    OREQ 'R'
     C           WAGWST    OREQ 'E'
     C           WAGWST    OREQ 'H'
     C           WAGWST    OREQ 'I'
      * Order is not Cancelled.
     C                     EXSR UASUBR                     Order is not Ca
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Allow Man/Qt Flag  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWAAIC3    WEAIC3           Company Number
     C                     Z-ADDWABKC7    WEBKC7           Ship To Custome
      * Establish starting position
     C           KRSSF     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0134           Type Code
     C                     MOVEL*BLANK    WN0135           Allow Man/Qt WO
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEBOCD    WN0134           Type Code
     C                     MOVELWEVLST    WN0135           Allow Man/Qt WO
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv All Prc Sts/Audit  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * RMC 3/30/2022 change lf from OPBGWKLJ TO OPBGWKN9 - TO INCLUDE 'R
     C                     MOVEL'P'       WL0005           Price Status
     C                     MOVEL'M'       WL0006           Price Audit
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WFC4NB    WQSG02           Order Number
      * Define keylist
     C           KPSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Order Number
     C                     KFLD           WFDPNB           Order Sequence
     C                     KFLD           WFUENB           Order Secondary
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Order Number
      * Setup key
     C                     Z-ADDWL0001    WQSG01           Company Number
     C                     Z-ADDWL0002    WQSG02           Order Number
     C                     Z-ADDWL0003    WFDPNB           Order Sequence
     C                     Z-ADDWL0004    WFUENB           Order Secondary
      * Establish starting position
     C           KPSSG     SETLL@BGWKJM                    *
     C           KRSSG     READE@BGWKJM                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Price Status is Blank or Unpriced
     C           WFU1ST    IFEQ *BLANK                     *IF
     C           WFU1ST    OREQ 'U'
     C                     MOVELWFU1ST    WL0005           Price Status
     C                     END                             *FI
      * CASE: DB1.Price Audit is Not Manually Price Audit
     C           WFU0ST    IFEQ 'A'                        *IF
     C           WFU0ST    OREQ 'N'
     C           WFU0ST    OREQ *BLANK
     C                     MOVELWFU0ST    WL0006           Price Audit
     C                     END                             *FI
      * RTV OD Whs/ShpCo/AccCo RT - Warehouse  * 
     C                     EXSR SHRVGN
     C           KRSSG     READE@BGWKJM                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV OD Whs/ShpCo/AccCo RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WGAJCD           Warehouse Code
      * Setup key
     C                     MOVELWFAJCD    WGAJCD           Warehouse Code
      * Establish starting position
     C           KRSSH     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0007           Shipping Compan
     C                     Z-ADD*ZERO     WL0008           Accounting Comp
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGBWC3    WL0007           Shipping Compan
     C                     Z-ADDWGBTC3    WL0008           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * CLC Extend Price       RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0138 112       Extended Amount
     C                     Z-ADD*ZERO     WN0139 114       Unit Price
     C                     Z-ADD*ZERO     WN0140 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0141 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0142 112       USR Quantity
     C                     Z-ADD*ZERO     WN0143 112       USR Weight
     C                     Z-ADD*ZERO     WN0144 114       Price per Pound
     C                     MOVEL*BLANK    WN0145  1        Company Organiz
     C                     MOVEL*BLANK    WN0146  6        Primal Group Co
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0138           Extended Amount
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0009           Company Number
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    YN0001    P      Plant Company S
     C                     MOVELWL0011    WN0145    P      Company Organiz
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSI01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSI02           Order Number
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WQSI01           Company Number
     C                     Z-ADDWAC4NB    WQSI02           Order Number
      * Establish starting position
     C           KRSSI     SETLL@BGWKL1                    *
     C           KRSSI     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCAYVA    WN0138           Extended Amount
     C                     Z-ADDWCAKPR    WN0139           Unit Price
     C                     Z-ADDWCAUPR    WN0140           Unit Price Orde
     C                     Z-ADDWCAVWG    WN0141           Unit Weight Ord
      * Load Quantity Shipped Total field.
      * CASE: DB1.Quantity Shipped Total is Equal to zero
     C           WCCBQT    IFEQ 0                          *IF
     C                     Z-ADD1         WUCBQT           Quantity Shippe
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWCCBQT    WUCBQT           Quantity Shippe
     C                     END                             *FI
      * Set quantity and weight according to order status
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Detail Line Status is Avail/Alloc/Enter/Hold
      *   |- c2    : DB1.Event Code is Entered Thru 03 Picked
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCGMST    IFEQ 'L'                        *IF
     C           WCGMST    OREQ 'A'
     C           WCGMST    OREQ 'E'
     C           WCGMST    OREQ 'H'
     C           WCJPCD    IFGE '01'                       *IF
     C           WCJPCD    ANDLE'03'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RMC 6/17/09 FP1054 use qty/wgt ordered instead of sched
     C                     Z-ADDWCAVQT    WN0142           USR Quantity
     C                     Z-ADDWCD0WG    WN0143           USR Weight
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUCBQT    WN0142           USR Quantity
     C                     Z-ADDWCATWG    WN0143           USR Weight
     C                     END                             *FI
      * RTV For Price Extent   XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDXRXFR'              90  RTV For Price E
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WCAIC3    WQ0006  30       Company Number
     C                     PARM WCHGCD    WQ0007  70       Item Code
     C                     PARM *BLANK    WQ0008  2        UOM Pricing
     C                     PARM *ZERO     WQ0009 112       Unit Weight
     C                     PARM *BLANK    WQ0010  1        Catch Weight St
     C           WN0146    PARM *BLANK    WQ0011  6        Primal Group Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * 06/25/10 PKD P205 Replace to use the Price Method Type & PMP Pric
      *                   instead of hard coding Price Method Code
      * RTV PrcMthTyp/PrcTyp  XF - Price Method Header  * 
     C                     CALL 'PNS7XFR'              90  RTV PrcMthTyp/P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WCAIC3    WQ0012  30       Company Number
     C                     PARM WCQ7CD    WQ0013  3        Price Method Co
     C           YL0011    PARM *BLANK    WQ0014  1        Price Method Ty
     C           YL0012    PARM *BLANK    WQ0015  1        PMH Price Type
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNS7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Extend
      * CASE: LCL.Price Method Type is Extended Pricing
     C           YL0011    IFEQ 'X'                        *IF
     C                     Z-ADDWCBZPR    WN0138           Extended Amount
     C                     ELSE
      * CASE: *OTHERWISE
      * 06/25/10 PKD P205 Replace to use the Price Method Type & PMP Pric
      *                   instead of hard coding Price Method Code
      * Extend price with unit price credit if not zeros
      * CASE:
      *  - (c1 AND c2 AND c3 AND c5 AND c7)
      *   |- c1    : DB1.Detail Line Status is Avail/Alloc/Enter/Hold
      *   |- c2    : DB1.Event Code is Entered Thru 03 Picked
      *   |- c3    : DB1.Unit Price - Credit is Not Zeros
      *   |- c5    : DB1.Price Audit is Not Manually Price Audit
      *   |- c7    : PAR.Pricing Event Called From is No Price With Credi
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCGMST    IFEQ 'L'                        *IF
     C           WCGMST    OREQ 'A'
     C           WCGMST    OREQ 'E'
     C           WCGMST    OREQ 'H'
     C           WCJPCD    IFGE '01'                       *IF
     C           WCJPCD    ANDLE'03'
     C           WCALPR    IFNE 0                          *IF
     C           WCU0ST    IFEQ 'A'                        *IF
     C           WCU0ST    OREQ 'N'
     C           WCU0ST    OREQ *BLANK
     C           'PM'      IFEQ 'OE'                       *IF
     C           'PM'      OREQ 'PS'
     C           'PM'      OREQ 'UWC'
     C           'PM'      OREQ 'UWT'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 07/07/08 PKD Replaced the following
      * 06/25/10 PKD P205 Replace to use the Price Method Type & PMP Pric
      *                   instead of hard coding Price Method Code
      * Extend Price using Price Overage Override or Unit Price-Credit
      * CASE: Contract Invoice Price
      *  - c1 AND c2
      *   |- c1    : LCL.Price Method Type is Contract Pricing
      *   |- c2    : LCL.PMH Price Type is Invoice Price
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0011    IFEQ 'Q'                        *IF
     C           YL0012    IFEQ 'I'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0138    PARM *ZERO     WQ0016 112       Extended Amount
     C                     PARM WCCRCD    WQ0017  2        U/M - Base Pric
     C                     PARM WN0142    WQ0018 112       Quantity Shippe
     C                     PARM WN0143    WQ0019 112       Weight Shipped
     C                     PARM WCBZPR    WQ0020 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: Manual & HPB
      *  - c1 AND c2
      *   |- c1    : LCL.Price Method Type is Manual Pricing
      *   |- c2    : PAR.Company Organization is High Plains Biodiesel
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0011    IFEQ 'M'                        *IF
     C           WN0145    IFEQ 'H'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0138    PARM *ZERO     WQ0021 112       Extended Amount
     C                     PARM WCCRCD    WQ0022  2        U/M - Base Pric
     C                     PARM WN0142    WQ0023 112       Quantity Shippe
     C                     PARM WN0143    WQ0024 112       Weight Shipped
     C                     PARM WCBZPR    WQ0025 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: Manual & Not HPB
      *  - c1 AND c2
      *   |- c1    : LCL.Price Method Type is Manual Pricing
      *   |- c2    : PAR.Company Organization is Not HPB
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0011    IFEQ 'M'                        *IF
     C           WN0145    IFEQ 'D'                        *IF
     C           WN0145    OREQ 'S'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ----- USE: Price Overage Override OR Unit Price-Credit
      * CASE: PS Cst | IC Cst | UNID Itm | OTHER Itm | >.01 Prc
      *  - c1 OR c2 OR c3 OR c4 OR c5
      *   |- c1    : PAR.Type Code is Inter Company
      *   |- c2    : PAR.Type Code is Is Promotional/Samples
      *   |- c3    : PAR.Primal Group Code is Samples or Cut Loss
      *   |- c4    : PAR.Primal Group Code is Other
      *   |- c5    : DB1.Price Overage Override is GT .01
      *   '-
     C           WN0134    IFEQ 'IC'                       *IF
     C           WN0134    OREQ 'PS'                       *OR
     C           WN0146    OREQ 'UNID'                     *OR
     C           WN0146    OREQ 'OTHER'                    *OR
     C           WCBZPR    ORGT .01                        *OR
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0138    PARM *ZERO     WQ0026 112       Extended Amount
     C                     PARM WCCRCD    WQ0027  2        U/M - Base Pric
     C                     PARM WN0142    WQ0028 112       Quantity Shippe
     C                     PARM WN0143    WQ0029 112       Weight Shipped
     C                     PARM WCBZPR    WQ0030 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * ----- USE: Unit Price-Credit
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0138    PARM *ZERO     WQ0031 112       Extended Amount
     C                     PARM WCCRCD    WQ0032  2        U/M - Base Pric
     C                     PARM WN0142    WQ0033 112       Quantity Shippe
     C                     PARM WN0143    WQ0034 112       Weight Shipped
     C                     PARM WCALPR    WQ0035 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * ---- USE: Unit Price-Credit
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0138    PARM *ZERO     WQ0036 112       Extended Amount
     C                     PARM WCCRCD    WQ0037  2        U/M - Base Pric
     C                     PARM WN0142    WQ0038 112       Quantity Shippe
     C                     PARM WN0143    WQ0039 112       Weight Shipped
     C                     PARM WCBZPR    WQ0040 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * *** Determine Extended Amount
      * 08/28/07 PKD Replaced with Clc OrdDtl Ext Amt    XF
      * 04/28/10 PKD If Unit Price is zero, then use Unit Price-Credit.
      * CASE: DB1.Unit Price is Not Zeros
     C           WCAKPR    IFNE 0                          *IF
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0138    PARM *ZERO     WQ0041 112       Extended Amount
     C                     PARM WCCRCD    WQ0042  2        U/M - Base Pric
     C                     PARM WN0142    WQ0043 112       Quantity Shippe
     C                     PARM WN0143    WQ0044 112       Weight Shipped
     C                     PARM WCAKPR    WQ0045 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.USR Quantity is not equal zero
     C           WN0142    IFNE 0                          *IF
     C           WN0138    DIV  WN0142    WN0140    H      Unit Price Orde
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0138    PARM *ZERO     WQ0046 112       Extended Amount
     C                     PARM WCCRCD    WQ0047  2        U/M - Base Pric
     C                     PARM WN0142    WQ0048 112       Quantity Shippe
     C                     PARM WN0143    WQ0049 112       Weight Shipped
     C                     PARM WCALPR    WQ0050 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CHG Dtl Price/Audit    CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0012           Company Number
     C                     Z-ADDWCC4NB    WL0013           Order Number
     C                     Z-ADDWCDPNB    WL0014           Order Sequence
     C                     Z-ADDWCUENB    WL0015           Order Secondary
     C                     Z-ADDWN0138    WL0016           Billing Detail
     C                     Z-ADDWN0138    WL0017           Extended Amount
     C                     MOVELWCU1ST    WL0018    P      Price Status
     C                     Z-ADDWCGIDT    WL0019           Pricing Date Us
     C                     MOVELWCU0ST    WL0020    P      Price Audit
     C                     MOVELWCRFCD    WL0021    P      Price Audit Rea
     C                     Z-ADDWCAKPR    WL0022           Unit Price
     C                     Z-ADDWCALPR    WL0023           Unit Price - Cr
     C                     Z-ADDWN0140    WL0024           Unit Price Orde
     C                     Z-ADDWCAVWG    WL0025           Unit Weight Ord
     C                     Z-ADDWCAODT    WL0026           Scheduled Ship
     C                     MOVELWCZ1ST    WL0027    P      Modified Flag
     C                     MOVELWCZ3ST    WL0028    P      Substituted Fla
     C                     MOVELWCZ4ST    WL0029    P      OD Schedule Ove
     C                     EXSR SKCHRC
     C           KRSSI     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WHAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0009    WHAIC3           Company Number
      * Establish starting position
     C           KRSSJ     CHAIN@JYRECE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2025' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0010           Plant Company S
     C                     MOVEL*BLANK    WL0011           Company Organiz
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHYISX    WL0010           Plant Company S
     C                     MOVELWHYJSX    WL0011           Company Organiz
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCHRC    BEGSR
      *================================================================
      * CHG Dtl Price/Audit    CH - Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0147  70       Item Code
     C                     MOVEL*BLANK    WN0148  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0149  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0150  70       Order Group Cod
     C                     MOVEL*BLANK    WN0151  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0152  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0153 112       Billing Detail
     C                     Z-ADD*ZERO     WN0154 112       Billing Detail
     C                     Z-ADD*ZERO     WN0155 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0156  1        Comment Print A
     C                     MOVEL*BLANK    WN0157  1        Comment Print I
     C                     MOVEL*BLANK    WN0158  1        Comment Print P
     C                     MOVEL*BLANK    WN0159  1        Comment Print S
     C                     Z-ADD*ZERO     WN0160  70       Market Pricing
     C                     MOVEL*BLANK    WN0161  3        Commodity Marke
     C                     MOVEL*BLANK    WN0162  3        Date Method Cod
     C                     MOVEL*BLANK    WN0163  3        Price Method Co
     C                     Z-ADD*ZERO     WN0164 114       Price Overage O
     C                     Z-ADD*ZERO     WN0165  70       Contract Number
     C                     MOVEL*BLANK    WN0166  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0167  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0168  1        Work Confirm St
     C                     MOVEL*BLANK    WN0169  1        Work Over/Short
     C                     MOVEL*BLANK    WN0170  1        OD Production P
     C                     MOVEL*BLANK    WN0171 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0172 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0173  1        Age Code
     C                     MOVEL*BLANK    WN0174  1        Palletize
     C                     MOVEL*BLANK    WN0175  1        Slip Sheet
     C                     MOVEL*BLANK    WN0176  1        Catch Weight St
     C                     MOVEL*BLANK    WN0177  1        Production Date
     C                     Z-ADD*ZERO     WN0178 112       Rated Freight
     C                     Z-ADD*ZERO     WN0179 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0180 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0181 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0182 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0183 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0184 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0185 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0186 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0187 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0188  70       Requested Ship
     C                     Z-ADD*ZERO     WN0189  70       Actual Shipped
     C                     MOVEL*BLANK    WN0190  1        Affect Inventor
     C                     MOVEL*BLANK    WN0191  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0192  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0193  30       Item Structure
     C                     Z-ADD*ZERO     WN0194  30       Item Structure
     C                     Z-ADD*ZERO     WN0195  30       Item Structure
     C                     MOVEL*BLANK    WN0196  2        Item Level
     C                     MOVEL*BLANK    WN0197  2        Quality Level
     C                     MOVEL*BLANK    WN0198  2        Pricing Product
     C                     MOVEL*BLANK    WN0199  2        Season Product
     C                     Z-ADD*ZERO     WN0200  70       Date of Origina
     C                     MOVEL*BLANK    WN0201 10        User Profile Na
     C                     MOVEL*BLANK    WN0202  6        Country Code
     C                     MOVEL*BLANK    WN0203  2        Event Code
     C                     MOVEL*BLANK    WN0204  3        Reason Code
     C                     MOVEL*BLANK    WN0205  3        Sales Route Cod
     C                     Z-ADD*ZERO     WN0206 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0207 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0208  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0209  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0210  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0211  1        Affect Commissi
     C                     MOVEL*BLANK    WN0212  1        Affect Pricing
     C                     MOVEL*BLANK    WN0213  1        Released by Use
     C                     MOVEL*BLANK    WN0214  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0215  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0216  3        Production Ware
     C                     MOVEL*BLANK    WN0217  3        OD Price Type
     C                     Z-ADD*ZERO     WN0218  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0219  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0220  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0221  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0222  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0223  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0224  60       Price Code
     C                     Z-ADD*ZERO     WN0225  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0226  60       Substitution Li
     C                     Z-ADD*ZERO     WN0227  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0228 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0229 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0230 112       OD Item Target
     C                     Z-ADD*ZERO     WN0231 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0232 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0233 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0234 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0235 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0236 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0237 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0238 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0239 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0240 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0241  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0242  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0243  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0244 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0245  40       Item Age Days
     C                     Z-ADD*ZERO     WN0246  70       Production Ovr
     C                     Z-ADD*ZERO     WN0247  70       Production Ovr
     C                     MOVEL*BLANK    WN0248  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0249  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0250  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0251  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0252  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0253  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0254  1        EDI Status 1
     C                     MOVEL*BLANK    WN0255  1        EDI Status 2
     C                     MOVEL*BLANK    WN0256  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0257  60       Job Time
     C                     MOVEL*BLANK    WN0258 10        User Id
     C                     MOVEL*BLANK    WN0259 10        Job Name
     C                     Z-ADD*ZERO     WN0260  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0012    WDAIC3           Company Number
     C                     Z-ADDWL0013    WDC4NB           Order Number
     C                     Z-ADDWL0014    WDDPNB           Order Sequence
     C                     Z-ADDWL0015    WDUENB           Order Secondary
      *
     C           KLCHSK    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
     C                     KFLD           WDDPNB           Order Sequence
     C                     KFLD           WDUENB           Order Secondary
     C           KLCHSK    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YBRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWL0016    WDKDVA           Billing Detail
     C                     Z-ADDWL0017    WDAYVA           Extended Amount
     C                     MOVELWL0018    WDU1ST    P      Price Status
     C                     Z-ADDWL0019    WDGIDT           Pricing Date Us
     C                     MOVELWL0020    WDU0ST    P      Price Audit
     C                     MOVELWL0021    WDRFCD    P      Price Audit Rea
     C                     Z-ADDWL0022    WDAKPR           Unit Price
     C                     Z-ADDWL0023    WDALPR           Unit Price - Cr
     C                     Z-ADDWL0024    WDAUPR           Unit Price Orde
     C                     Z-ADDWL0025    WDAVWG           Unit Weight Ord
     C                     Z-ADDWL0026    WDAODT           Scheduled Ship
     C                     MOVELWL0027    WDZ1ST    P      Modified Flag
     C                     MOVELWL0028    WDZ3ST    P      Substituted Fla
     C                     MOVELWL0029    WDZ4ST    P      OD Schedule Ove
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * CLC Price/Price Audit  RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0261 112       Extended Amount
     C                     MOVEL*BLANK    WN0262  3        Commodity Marke
     C                     MOVEL*BLANK    WN0263  1        Price Status
     C                     Z-ADD*ZERO     WN0264  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0265  1        Price Audit
     C                     MOVEL*BLANK    WN0266  3        Price Audit Rea
     C                     Z-ADD*ZERO     WN0267 114       Unit Price
     C                     Z-ADD*ZERO     WN0268 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0269 114       Unit Price Orde
     C                     MOVEL*BLANK    WN0270  2        Event Code
     C                     MOVEL*BLANK    WN0271  3        Price Audit Rea
     C                     Z-ADD*ZERO     WN0272 112       Unit Weight
     C                     MOVEL*BLANK    WN0273  1        Catch Weight St
     C                     MOVEL*BLANK    WN0274  2        Event Called Fr
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'P'       WN0132           Price Status US
     C                     MOVEL*BLANK    WN0265           Price Audit
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0009           Company Number
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    YN0005    P      Plant Company S
     C                     MOVELWL0011    YL0013    P      Company Organiz
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSL01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSL02           Order Number
      * Define keylist
     C           KPSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Order Number
     C                     KFLD           WCDPNB           Order Sequence
     C                     KFLD           WCUENB           Order Secondary
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WQSL01           Company Number
     C                     Z-ADDWAC4NB    WQSL02           Order Number
     C                     Z-ADD1         WCDPNB           Order Sequence
     C                     Z-ADD1         WCUENB           Order Secondary
      * Establish starting position
     C           KPSSL     SETLL@BGWKL1                    *
     C           KRSSL     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If only one line item suposed to be repriced
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Order Sequence Number is not equal to zero
      *   |- c2    : PAR.Order Sequence Number NE DB1.Order Sequence Numb
      *   |- c3    : PAR.Order Secondary Line Seq NE DB1.Order Secondary
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           1         IFNE 0                          *IF
     C           1         IFNE WCDPNB                     *IF
     C           1         IFNE WCUENB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     GOTO SLEXIT                     *QUIT
     C                     END                             *FI
      * Process Shipping Detail record if not cancelled
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WCGMST    IFEQ 'L'                        *IF
     C           WCGMST    OREQ 'A'
     C           WCGMST    OREQ 'C'
     C           WCGMST    OREQ 'R'
     C           WCGMST    OREQ 'E'
     C           WCGMST    OREQ 'H'
     C           WCGMST    OREQ 'I'
      * Set hold fields and call pricing routine
     C                     EXSR UCSUBR                     Set hold fields
      * Check price audit options
      * CASE: Sts=Prcd, Adt=Man, Evt=MktGrpChg/CstItmChg/ItmChg
      *  - (c1 AND c2) OR c3 OR c4 OR c5
      *   |- c1    : DB1.Price Status is Priced
      *   |- c2    : DB1.Price Audit is Manually Price Audited
      *   |- c3    : PAR.Pricing Event Called From is Market Group Change
      *   |- c4    : PAR.Pricing Event Called From is Customer/Item Chang
      *   |- c5    : PAR.Pricing Event Called From is Item Change
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCU1ST    IFEQ 'P'                        *IF
     C           WCU0ST    IFEQ 'M'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           'PM'      IFEQ 'MGC'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           'PM'      IFEQ 'CIC'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           'PM'      IFEQ 'IC'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: PAR.Unit Price NE DB1.Unit Price
     C           WN0267    IFNE WCAKPR                     *IF
     C                     MOVEL'N'       WN0265           Price Audit
      * Set reason code for pricing event called from
      * CASE: PAR.Pricing Event Called From is Customer/Item Change
     C           'PM'      IFEQ 'CIC'                      *IF
     C                     MOVEL'CIT'     WN0266           Price Audit Rea
     C                     ELSE
      * CASE: PAR.Pricing Event Called From is Market Group Change
     C           'PM'      IFEQ 'MGC'                      *IF
     C                     MOVEL'CGP'     WN0266           Price Audit Rea
     C                     ELSE
      * CASE: PAR.Pricing Event Called From is Market Price Change
     C           'PM'      IFEQ 'MPC'                      *IF
     C                     MOVEL'CMP'     WN0266           Price Audit Rea
     C                     ELSE
      * CASE: PAR.Pricing Event Called From is Item Change
     C           'PM'      IFEQ 'IC'                       *IF
     C                     MOVEL'ITM'     WN0266           Price Audit Rea
     C                     ELSE
      * CASE: PAR.Pricing Event Called From is Shipping
     C           'PM'      IFEQ 'SHP'                      *IF
      * If ship date change use SDC else use price change PC
      * CASE: DB1.Scheduled Ship Date NE DB1.Actual Shipped Date
     C           WCAODT    IFNE WCGNDT                     *IF
     C                     MOVEL'SDC'     WN0266           Price Audit Rea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WN0266           Price Audit Rea
     C                     MOVEL'PC'      WN0266           Price Audit Rea
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WN0266           Price Audit Rea
     C                     MOVEL'PC'      WN0266           Price Audit Rea
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'M'       WN0265           Price Audit
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Retrieve Pricing Method Price Audit Flag to determine price
      * audit
      * RTV Meth Type/Audit    RT - Price Method Header  * 
     C                     EXSR SMRVGN
      * RTV Price Maint        XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDP6XFR'              90  RTV Price Maint
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WCAIC3    WQ0119  30       Company Number
     C                     PARM WCHGCD    WQ0120  70       Item Code
     C           WULNCD    PARM *BLANK    WQ0121  3        Default Commod
     C           WUTMVA    PARM *ZERO     WQ0122 112       Maximum Audit V
     C           WUTNVA    PARM *ZERO     WQ0123 112       Minimum Audit V
     C           WULRCD    PARM *BLANK    WQ0124  7        Commodity Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDP6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * If price method is audit then audit else check more conditions
      * CASE: WRK.Price Audit is Needs Price Audit
     C           WUU0ST    IFEQ 'N'                        *IF
     C                     MOVELWUU0ST    WN0265           Price Audit
      * Set reason code for pricing event called from
      * CASE: PAR.Pricing Event Called From is Market Price Change
     C           'PM'      IFEQ 'MPC'                      *IF
     C                     MOVEL'CMP'     WN0266           Price Audit Rea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'MTH'     WN0266           Price Audit Rea
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If price falls outside of audit range, then flag for audit
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Unit Price GT WRK.Maximum Audit Value
      *   |- c2    : DB1.Unit Price LT WRK.Minimum Audit Value
      *   '-
     C           WCAKPR    IFGT WUTMVA                     *IF
     C           WCAKPR    ORLT WUTNVA                     *OR
     C                     MOVEL'N'       WN0265           Price Audit
      * Set reason code for pricing event called from
      * CASE: PAR.Pricing Event Called From is Market Price Change
     C           'PM'      IFEQ 'MPC'                      *IF
     C                     MOVEL'CMP'     WN0266           Price Audit Rea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'RNG'     WN0266           Price Audit Rea
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If Contract or MAN EXT Pricing, Price Audit if Allow Man/Qt = N
      * CASE: PAR.Allow Man/Qt WO/Approval is Do Not Allow
     C           WN0135    IFEQ 'N'                        *IF
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : DB1.Price Method Code is Manual
      *   |- c2    : DB1.Price Method Code is Extended
      *   |- c3    : DB1.Contract Number is Not Zeros
      *   '-
     C           WCQ7CD    IFEQ 'MAN'                      *IF
     C           WCQ7CD    OREQ 'EXT'                      *OR
     C           WCL6NB    ORNE 0                          *OR
     C                     MOVEL'N'       WN0265           Price Audit
      * Set reason code for pricing event called from
      * CASE: PAR.Pricing Event Called From is Market Price Change
     C           'PM'      IFEQ 'MPC'                      *IF
     C                     MOVEL'CMP'     WN0266           Price Audit Rea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'MCE'     WN0266           Price Audit Rea
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * If manual pricing and not a transfer order, check price range
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Code is Manual
      *   |- c2    : PAR.Billing Activity Type is Not Warehouse Transfer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCQ7CD    IFEQ 'MAN'                      *IF
     C           WAOBST    IFEQ '2'                        *IF
     C           WAOBST    OREQ '3'
     C           WAOBST    OREQ '1'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Val Manual Price      RT - Company/Item  * 
     C                     EXSR SNRVGN
      * R12926 DN 04/23/18-Do NOT use AFR from Co Customer, use AFR from
      * RTV AbsFrtRt/Type Cde  RT - Company Customer  * 
     C                     EXSR SORVGN
      * Val Price
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Primal Group Code is NE Samples or Cut Loss
      *   |- c2    : LCL.Type Code is Not Promotional/Samples
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0020    IFNE 'UNID'                     *IF
     C           YL0021    IFNE 'PS'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RMC chg parm lcl.default commod mark basis to lcl.commodity price
      *    on commodity price group parameter         S12258 1/3/2018
      * RMC chg parm lcl.commodity marke code to lcl.default commod mark
      *    on commodity market code parameter         S11258 1/3/2018
      * R12926 DN 04/23/18-Do NOT use AFR from Co Customer, use AFR from
      *
     C                     Z-ADD*ZERO     WN0282  52       Manual Price Ac
     C                     Z-ADD*ZERO     WN0283  52       CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WN0284  74       Percent 7.4 USR
     C                     Z-ADD*ZERO     WN0285 114       Price Adjustmen
      *
      * VAL Manual Price Range IF
      * *---------------------------------------------------------------*
      * Documentation:
      * This internal function will determine if a manual price entered
      * on an order detail line is within the Manual Pricing Acceptance
      * Percentage from the Company Control file. If it does not fall
      * within the percentage range then the market price will be used.
      * If no market price is found then it is a manual price error
      * *---------------------------------------------------------------*
     C                     Z-ADD*ZERO     WUB8PR           Projected Marke
     C                     Z-ADD*ZERO     YL0022           Minimum Price
     C                     Z-ADD*ZERO     YL0023           Maximum Price
     C                     MOVEL'Y'       WUTXST           Error Status  3
      * RTV Manual Price Accpt RT - Company Control  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0030           Company Number
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0031    WN0282           Manual Price Ac
     C                     Z-ADDWL0032    WN0283           CoPk/FdSrv ManP
      * Food Service and Co-Pack Items
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Default Commod Mark basis is Food Service
      *   |- c2    : PAR.Default Commod Mark basis is Co-Pack
      *   '-
     C           YL0016    IFEQ 'FSV'                      *IF
     C           YL0016    OREQ 'CPK'                      *OR
     C                     Z-ADDWN0283    WN0282           Manual Price Ac
     C                     END                             *FI
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0016    WL0033    P      Commodity Marke
     C                     MOVELYL0019    WL0034    P      Commodity Price
     C                     Z-ADD9999999   WL0035           Market Price Da
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0036    WUB8PR           Commodity Marke
     C                     Z-ADDWL0037    WUE7DT           USR Date Priced
      * Projected Market Price
      * PAR.Projected Market Price =
      *    *COMPUTE (x1 + x2 + (x3 / x4))
      * x1    : PAR.Projected Market Price
      * +     : PGM.*Synon (15,5) work field
      * x2    : PAR.Standard Overage_Underage
      * +     : PGM.*Synon (15,5) work field
      * x3    : PAR.Absorbed Freight Rate CWT
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
     C           WUB8PR    ADD  YL0017    W0WB01           *Synon (15,5) w
     C           WATBNB    DIV  100       W0WB02    H      *Synon (15,5) w
     C           W0WB01    ADD  W0WB02    W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    WUB8PR           Projected Marke
      * If a market price is found for co/cust market code default
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Minimum price allowed
      * PAR.Minimum Price   USR =
      *    *COMPUTE (((x4 - (x1 / x2)) * x3))
      * x4    : CON.1
      * -     : PGM.*Synon (17,7) work field
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0282    DIV  100       W0WD02    H      *Synon (17,7) w
     C           1         SUB  W0WD02    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT WUB8PR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0022           Minimum Price
      * Maximum price allowed
      * PAR.Maximum Price  USR =
      *    *COMPUTE ((((x1 / x2) + x4) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * +     : PGM.*Synon (17,7) work field
      * x4    : CON.1
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0282    DIV  100       W0WD02    H      *Synon (17,7) w
     C           W0WD02    ADD  1         W0WD01           *Synon (17,7) w
     C           W0WD01    MULT WUB8PR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0023           Maximum Price
      * If the Price Override is within the range then error status is no
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Overage Override GE PAR.Minimum Price   US
      *   |- c2    : PAR.Price Overage Override LE PAR.Maximum Price  USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCBZPR    IFGE YL0022                     *IF
     C           WCBZPR    IFLE YL0023                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WUTXST           Error Status  3
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If no price for co/cust market code then use co/item market code
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0016    WL0033    P      Commodity Marke
     C                     MOVELYL0019    WL0034    P      Commodity Price
     C                     Z-ADD9999999   WL0035           Market Price Da
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0036    WUB8PR           Commodity Marke
     C                     Z-ADDWL0037    WUE7DT           USR Date Priced
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Minimum price allowed
      * PAR.Minimum Price   USR =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0282    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WUB8PR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0022           Minimum Price
      * Maximum price allowed
      * PAR.Maximum Price  USR =
      *    *COMPUTE ((((x1 / x2) + x4) * x3))
      * x1    : PAR.Manual Price Accept Prcnt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * +     : PGM.*Synon (17,7) work field
      * x4    : CON.1
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Projected Market Price
     C           WN0282    DIV  100       W0WD02    H      *Synon (17,7) w
     C           W0WD02    ADD  1         W0WD01           *Synon (17,7) w
     C           W0WD01    MULT WUB8PR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0023           Maximum Price
      * If the Price Override is within the range then error status is no
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Overage Override GE PAR.Minimum Price   US
      *   |- c2    : PAR.Price Overage Override LE PAR.Maximum Price  USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCBZPR    IFGE YL0022                     *IF
     C           WCBZPR    IFLE YL0023                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WUTXST           Error Status  3
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUB8PR           Projected Marke
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.Error Status  3 is Yes
     C           WUTXST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WN0265           Price Audit
     C                     MOVEL'MPB'     WN0266           Price Audit Rea
      * Price Status will be "U" if Called from OE, Prd Sched
      * CASE: PAR.Pricing Event Called From is No Price With Credit Pric
     C           'PM'      IFEQ 'OE'                       *IF
     C           'PM'      OREQ 'PS'
     C           'PM'      OREQ 'UWC'
     C           'PM'      OREQ 'UWT'
     C                     MOVEL'U'       WN0263           Price Status
     C                     END                             *FI
     C                     END                             *FI
      * 06/27/08 PKD if the items is priced at .01, then the items is unp
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : DB1.Unit Price is LE .0100
      *   |- c2    : LCL.Primal Group Code is NE Other
      *   |- c3    : LCL.Company Organization is Not HPB
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCAKPR    IFLE .0100                      *IF
     C           YL0020    IFNE 'OTHER'                    *IF
     C           YL0013    IFEQ 'D'                        *IF
     C           YL0013    OREQ 'S'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'U'       WN0263           Price Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * If unpriced order then Audit EQ Blank
      * CASE: PAR.Price Status is Unpriced
     C           WN0263    IFEQ 'U'                        *IF
     C                     MOVEL*BLANK    WN0265           Price Audit
     C                     MOVEL*BLANK    WN0133           Price Audit USR
     C                     END                             *FI
      * If price audit is blank and order is priced then make price audit
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Price Audit is No Audit
      *   |- c2    : PAR.Price Status is Priced
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0265    IFEQ *BLANK                     *IF
     C           WN0263    IFEQ 'P'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'A'       WN0265           Price Audit
     C                     MOVEL*BLANK    WN0266           Price Audit Rea
     C                     END                             *FI
      * If shipped quantities are zero then Value=0, Prc Sts=P, Audit=' '
      * CASE:
      *  - c1 AND c2 AND c3 AND c4
      *   |- c1    : DB1.Quantity Shipped Total is Equal to zero
      *   |- c2    : DB1.Weight Shipped Total is Equal to zero
      *   |- c3    : DB1.Detail Line Status is Confirmed & Complete
      *   |- c4    : DB1.Event Code is Shipped Thru 07 History
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCCBQT    IFEQ 0                          *IF
     C           WCATWG    IFEQ 0                          *IF
     C           WCGMST    IFEQ 'C'                        *IF
     C           WCGMST    OREQ 'R'
     C           WCJPCD    IFGE '04'                       *IF
     C           WCJPCD    ANDLE'07'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'P'       WN0263           Price Status
      * CASE: WRK.Price Audit is Automatically Price Audit
     C           WUU0ST    IFEQ 'A'                        *IF
     C                     MOVELWUU0ST    WN0265           Price Audit
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'M'       WN0265           Price Audit
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * If Price Audit Flag is "N"eeds Audit update Header Parm else blan
      * CASE: PAR.Price Audit is Needs Price Audit
     C           WN0265    IFEQ 'N'                        *IF
     C                     MOVELWN0265    WN0133           Price Audit USR
     C                     MOVELWN0266    WN0271           Price Audit Rea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WN0266           Price Audit Rea
     C                     END                             *FI
      * Write to audit file if Price flag, Audit or Price change
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : DB1.Price Status NE PAR.Price Status
      *   |- c2    : DB1.Price Audit NE PAR.Price Audit
      *   |- c3    : DB1.Unit Price NE PAR.Unit Price
      *   '-
     C           WCU1ST    IFNE WN0263                     *IF
     C           WCU0ST    ORNE WN0265                     *OR
     C           WCAKPR    ORNE WN0267                     *OR
      * RTV Next Audit Seq #   RT - PD Price Change Audit Log  * 
     C                     EXSR SRRVGN
      * CRT Price Change Audit CR - PD Price Change Audit Log  * 
     C                     EXSR SSCRRC
     C                     END                             *FI
      * If shipped quantities are zero then Value=0, Prc Sts=P, Audit=' '
      * CASE:
      *  - c1 AND c2 AND c3 AND c4
      *   |- c1    : DB1.Quantity Shipped Total is Equal to zero
      *   |- c2    : DB1.Weight Shipped Total is Equal to zero
      *   |- c3    : DB1.Detail Line Status is Confirmed & Complete
      *   |- c4    : DB1.Event Code is Shipped Thru 07 History
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCCBQT    IFEQ 0                          *IF
     C           WCATWG    IFEQ 0                          *IF
     C           WCGMST    IFEQ 'C'                        *IF
     C           WCGMST    OREQ 'R'
     C           WCJPCD    IFGE '04'                       *IF
     C           WCJPCD    ANDLE'07'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * If mpr sent or Xcluded, set to "M" else set to "N"
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.OD MPR Sent to USDA Sts is Exclude
      *   |- c2    : DB1.OD MPR Sent to USDA Sts is yes
      *   '-
     C           WCHOST    IFEQ 'X'                        *IF
     C           WCHOST    OREQ 'Y'                        *OR
     C                     MOVEL'M'       YL0024           Price Audit
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0024           Price Audit
     C                     END                             *FI
      * 9/9/13 upd with par.price instead of db1.price.. we want new pric
      * CHG Dtl Price/Audit    CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0012           Company Number
     C                     Z-ADDWCC4NB    WL0013           Order Number
     C                     Z-ADDWCDPNB    WL0014           Order Sequence
     C                     Z-ADDWCUENB    WL0015           Order Secondary
     C                     Z-ADD*ZERO     WL0016           Billing Detail
     C                     Z-ADD*ZERO     WL0017           Extended Amount
     C                     MOVEL'P'       WL0018    P      Price Status
     C                     Z-ADDWCGIDT    WL0019           Pricing Date Us
     C                     MOVELYL0024    WL0020    P      Price Audit
     C                     MOVEL*BLANK    WL0021           Price Audit Rea
     C                     Z-ADDWN0267    WL0022           Unit Price
     C                     Z-ADDWCALPR    WL0023           Unit Price - Cr
     C                     Z-ADDWCAUPR    WL0024           Unit Price Orde
     C                     Z-ADDWCAVWG    WL0025           Unit Weight Ord
     C                     Z-ADDWCAODT    WL0026           Scheduled Ship
     C                     MOVELWCZ1ST    WL0027    P      Modified Flag
     C                     MOVELWCZ3ST    WL0028    P      Substituted Fla
     C                     MOVELWCZ4ST    WL0029    P      OD Schedule Ove
     C                     EXSR SKCHRC
     C                     MOVEL'P'       WN0263           Price Status
     C                     ELSE
      * CASE: *OTHERWISE
      * If order detail is priced and manually audited then dont chg pric
      * CASE:
      *  - (c1 AND c2) OR c3 OR c4 OR c5
      *   |- c1    : DB1.Price Status is Priced
      *   |- c2    : DB1.Price Audit is Manually Price Audited
      *   |- c3    : PAR.Pricing Event Called From is Market Group Change
      *   |- c4    : PAR.Pricing Event Called From is Customer/Item Chang
      *   |- c5    : PAR.Pricing Event Called From is Item Change
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCU1ST    IFEQ 'P'                        *IF
     C           WCU0ST    IFEQ 'M'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           'PM'      IFEQ 'MGC'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           'PM'      IFEQ 'CIC'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           'PM'      IFEQ 'IC'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: PAR.Unit Price NE DB1.Unit Price
     C           WN0267    IFNE WCAKPR                     *IF
      * CHG Dtl Price/Audit    CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0012           Company Number
     C                     Z-ADDWCC4NB    WL0013           Order Number
     C                     Z-ADDWCDPNB    WL0014           Order Sequence
     C                     Z-ADDWCUENB    WL0015           Order Secondary
     C                     Z-ADDWCKDVA    WL0016           Billing Detail
     C                     Z-ADDWCAYVA    WL0017           Extended Amount
     C                     MOVELWCU1ST    WL0018    P      Price Status
     C                     Z-ADDWCGIDT    WL0019           Pricing Date Us
     C                     MOVELWN0265    WL0020    P      Price Audit
     C                     MOVELWN0266    WL0021    P      Price Audit Rea
     C                     Z-ADDWCAKPR    WL0022           Unit Price
     C                     Z-ADDWCALPR    WL0023           Unit Price - Cr
     C                     Z-ADDWCAUPR    WL0024           Unit Price Orde
     C                     Z-ADDWCAVWG    WL0025           Unit Weight Ord
     C                     Z-ADDWCAODT    WL0026           Scheduled Ship
     C                     MOVELWCZ1ST    WL0027    P      Modified Flag
     C                     MOVELWCZ3ST    WL0028    P      Substituted Fla
     C                     MOVELWCZ4ST    WL0029    P      OD Schedule Ove
     C                     EXSR SKCHRC
     C                     END                             *FI
      * Extend price incase Shipping Quantities have changed.
      * CLC Extend Price 1 Dtl RT - Order Detail  * 
     C                     EXSR STRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * CHG Dtl Price/Audit    CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0012           Company Number
     C                     Z-ADDWCC4NB    WL0013           Order Number
     C                     Z-ADDWCDPNB    WL0014           Order Sequence
     C                     Z-ADDWCUENB    WL0015           Order Secondary
     C                     Z-ADDWN0261    WL0016           Billing Detail
     C                     Z-ADDWN0261    WL0017           Extended Amount
     C                     MOVELWN0263    WL0018    P      Price Status
     C                     Z-ADDWN0264    WL0019           Pricing Date Us
     C                     MOVELWN0265    WL0020    P      Price Audit
     C                     MOVELWN0266    WL0021    P      Price Audit Rea
     C                     Z-ADDWN0267    WL0022           Unit Price
     C                     Z-ADDWCALPR    WL0023           Unit Price - Cr
     C                     Z-ADDWN0269    WL0024           Unit Price Orde
     C                     Z-ADDWCAVWG    WL0025           Unit Weight Ord
     C                     Z-ADDWCAODT    WL0026           Scheduled Ship
     C                     MOVELWCZ1ST    WL0027    P      Modified Flag
     C                     MOVELWCZ3ST    WL0028    P      Substituted Fla
     C                     MOVELWCZ4ST    WL0029    P      OD Schedule Ove
     C                     EXSR SKCHRC
     C                     END                             *FI
     C                     END                             *FI
      * Mark Header Price Status Flag as Unpriced if Unpriced
      * CASE: PAR.Price Status is Unpriced
     C           WN0263    IFEQ 'U'                        *IF
     C                     MOVEL'U'       WN0132           Price Status US
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSL     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Meth Type/Audit    RT - Price Method Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIQ7CD           Price Method Co
      * Setup key
     C                     Z-ADDWAAIC3    WIAIC3           Company Number
     C                     MOVELWCQ7CD    WIQ7CD           Price Method Co
      * Establish starting position
     C           KRSSM     CHAIN@IHRERN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1665' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUU0ST           Price Audit
     C                     MOVEL*BLANK    WUV8ST           Price Method Ty
     C                     Z-ADD*ZERO     YL0014           Decimal Places
     C                     MOVEL*BLANK    YL0015           PMH Price Type
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIU0ST    WUU0ST           Price Audit
     C                     MOVELWIV8ST    WUV8ST           Price Method Ty
     C                     Z-ADDWIRMNY    YL0014           Decimal Places
     C                     MOVELWIH3ST    YL0015           PMH Price Type
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Val Manual Price      RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJHGCD           Item Code
      * Setup key
     C                     Z-ADDWCAIC3    WJAIC3           Company Number
     C                     Z-ADDWCHGCD    WJHGCD           Item Code
      * Establish starting position
     C           KRSSN     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAVNA           Description Lin
     C                     MOVEL*BLANK    YL0016           Default Commod
     C                     Z-ADD*ZERO     YL0017           Market Overage
     C                     Z-ADD*ZERO     YL0018           Standard Overag
     C                     MOVEL*BLANK    YL0019           Commodity Price
     C                     Z-ADD*ZERO     WUSWGH           Std Weight_Head
     C                     MOVEL*BLANK    YL0020           Primal Group Co
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJAVNA    WUAVNA           Description Lin
     C                     MOVELWJLNCD    YL0016           Default Commod
     C                     Z-ADDWJBLPR    YL0017           Market Overage
     C                     Z-ADDWJBMPR    YL0018           Standard Overag
     C                     MOVELWJLRCD    YL0019           Commodity Price
     C                     Z-ADDWJSWGH    WUSWGH           Std Weight_Head
     C                     MOVELWJXRCD    YL0020           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV AbsFrtRt/Type Cde  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWCAIC3    WEAIC3           Company Number
     C                     Z-ADDWCBKC7    WEBKC7           Ship To Custome
      * Establish starting position
     C           KRSSO     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0021           Type Code
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEBOCD    YL0021           Type Code
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Manual Price Accpt RT - Company Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WKAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0030    WKAIC3           Company Number
      * Establish starting position
     C           KRSSP     CHAIN@ASREVL              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0049' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0031           Manual Price Ac
     C                     Z-ADD*ZERO     WL0032           CoPk/FdSrv ManP
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWKAIPC    WL0031           Manual Price Ac
     C                     Z-ADDWKASPC    WL0032           CoPk/FdSrv ManP
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLLQCD    WQSQ01           Commodity Marke
     C           *LIKE     DEFN WLLRCD    WQSQ02           Commodity Price
      * Define keylist
     C           KPSSQ     KLIST
     C                     KFLD           WQSQ01           Commodity Marke
     C                     KFLD           WQSQ02           Commodity Price
     C                     KFLD           WLEQDT           Market Price Da
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Commodity Marke
     C                     KFLD           WQSQ02           Commodity Price
      * Setup key
     C                     MOVELWL0033    WQSQ01           Commodity Marke
     C                     MOVELWL0034    WQSQ02           Commodity Price
     C                     Z-ADDWL0035    WLEQDT           Market Price Da
      * Establish starting position
     C           KPSSQ     SETLL@F0CPEP                    *
     C           KRSSQ     READE@F0CPEP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1222' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0036           Commodity Marke
     C                     Z-ADD*ZERO     WL0037           USR Date Priced
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWLA5PR    WL0036           Commodity Marke
     C                     Z-ADDWLEQDT    WL0037           USR Date Priced
     C                     GOTO SQEXIT                     *QUIT
     C           KRSSQ     READE@F0CPEP                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Next Audit Seq #   RT - PD Price Change Audit Log  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMAIC3    WQSR01           Company Number
     C           *LIKE     DEFN WMC4NB    WQSR02           Order Number
     C           *LIKE     DEFN WMDPNB    WQSR03           Order Sequence
     C           *LIKE     DEFN WMUENB    WQSR04           Order Secondary
      * Define keylist
     C           KPSSR     KLIST
     C                     KFLD           WQSR01           Company Number
     C                     KFLD           WQSR02           Order Number
     C                     KFLD           WQSR03           Order Sequence
     C                     KFLD           WQSR04           Order Secondary
     C                     KFLD           WMASNO           Audit Sequence
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           Company Number
     C                     KFLD           WQSR02           Order Number
     C                     KFLD           WQSR03           Order Sequence
     C                     KFLD           WQSR04           Order Secondary
      * Setup key
     C                     Z-ADDWCAIC3    WQSR01           Company Number
     C                     Z-ADDWCC4NB    WQSR02           Order Number
     C                     Z-ADDWCDPNB    WQSR03           Order Sequence
     C                     Z-ADDWCUENB    WQSR04           Order Secondary
     C                     Z-ADD999       WMASNO           Audit Sequence
      * Establish starting position
     C           KPSSR     SETLL@K3CPKR                    *
     C           KRSSR     READE@K3CPKR                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2378' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WUQQNB           USR Sequence Nu
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WMASNO    ADD  1         WUQQNB           USR Sequence Nu
     C                     GOTO SREXIT                     *QUIT
     C           KRSSR     READE@K3CPKR                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCRRC    BEGSR
      *================================================================
      * CRT Price Change Audit CR - PD Price Change Audit Log  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0286  1        EDI Status 1
     C                     MOVEL*BLANK    WN0287  1        EDI Status 2
     C                     MOVEL*BLANK    WN0288  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0289  60       Job Time
     C                     MOVEL*BLANK    WN0290 10        User Id
     C                     MOVEL*BLANK    WN0291 10        Job Name
     C                     Z-ADD*ZERO     WN0292  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @K3CPKP
     C                     Z-ADDWCAIC3    WOAIC3           Company Number
     C                     Z-ADDWCC4NB    WOC4NB           Order Number
     C                     Z-ADDWCDPNB    WODPNB           Order Sequence
     C                     Z-ADDWCUENB    WOUENB           Order Secondary
     C                     Z-ADDWUQQNB    WOASNO           Audit Sequence
     C                     Z-ADDWCHGCD    WOHGCD           Item Code
     C                     MOVELWCGMST    WOGMST           Detail Line Sta
     C                     MOVELWCGNST    WOGNST           Detail Line Sta
     C                     Z-ADDWN0261    WOAYVA           Extended Amount
     C                     Z-ADDWCAYVA    WOYJVA           Extended Amount
     C                     MOVELWN0263    WOU1ST           Price Status
     C                     MOVELWCU1ST    WOPSTL           Price Status La
     C                     MOVELWN0265    WOU0ST           Price Audit
     C                     MOVELWN0266    WORFCD           Price Audit Rea
     C                     MOVELWCU0ST    WOPALS           Price Audit Las
     C                     MOVELWCRFCD    WOWWCD           Price Audit Rea
     C                     Z-ADDWN0267    WOAKPR           Unit Price
     C                     Z-ADDWCAKPR    WODBPR           Unit Price Last
     C                     Z-ADDWN0268    WOALPR           Unit Price - Cr
     C                     Z-ADDWCALPR    WODCPR           Unit Price - Cr
     C                     MOVELWCJPCD    WOJPCD           Event Code
     C                     MOVELWCJPCD    WOWXCD           Event Code Last
     C                     MOVE *BLANK    WOPREC           Price Event Cal
     C                     MOVEL'PM'      WOPREC           Price Event Cal
     C                     MOVEL##PGM     WOPIDX           Program ID . .
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WOAATM           Job Time
     C                     MOVEL##USR     WOAYNA           User Id
     C                     MOVEL##JOB     WOA0NA           Job Name
     C                     Z-ADD##JDT     WOAXDT           Job Date
     C           KLCRSS    KLIST
     C                     KFLD           WOAIC3           Company Number
     C                     KFLD           WOC4NB           Order Number
     C                     KFLD           WODPNB           Order Sequence
     C                     KFLD           WOUENB           Order Secondary
     C                     KFLD           WOASNO           Audit Sequence
      * Check for duplicate primary key
     C           KLCRSS    SETLL@K3CPKP                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2379' W0RTN   7
      * Send message 'Price Change Audit Log EX'
     C                     MOVEL'USR2379' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C                     WRITE@K3CPKP                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * CLC Extend Price 1 Dtl RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0293 112       Extended Amount
     C                     Z-ADD*ZERO     WN0294 114       Unit Price
     C                     Z-ADD*ZERO     WN0295 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0296 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0297 112       USR Quantity
     C                     Z-ADD*ZERO     WN0298 112       USR Weight
     C                     Z-ADD*ZERO     WN0299 114       Price per Pound
     C                     MOVEL*BLANK    WN0300  6        Primal Group Co
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * RMC 6/17/09 FP1054 use qty/wgt ordered instead of sched
     C                     Z-ADD*ZERO     WN0293           Extended Amount
      * Declare restrictor key work fields
     C           *LIKE     DEFN WRAIC3    WQST01           Company Number
     C           *LIKE     DEFN WRC4NB    WQST02           Order Number
     C           *LIKE     DEFN WRDPNB    WQST03           Order Sequence
     C           *LIKE     DEFN WRUENB    WQST04           Order Secondary
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           Company Number
     C                     KFLD           WQST02           Order Number
     C                     KFLD           WQST03           Order Sequence
     C                     KFLD           WQST04           Order Secondary
      * Setup key
     C                     Z-ADDWCAIC3    WQST01           Company Number
     C                     Z-ADDWCC4NB    WQST02           Order Number
     C                     Z-ADDWCDPNB    WQST03           Order Sequence
     C                     Z-ADDWCUENB    WQST04           Order Secondary
      * Establish starting position
     C           KRSST     SETLL@BGWKAE                    *
     C           KRSST     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAYVA    WN0293           Extended Amount
     C                     Z-ADDWRAKPR    WN0294           Unit Price
     C                     Z-ADDWRAUPR    WN0295           Unit Price Orde
     C                     Z-ADDWRAVWG    WN0296           Unit Weight Ord
      * RTV For Price Extent   XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDXRXFR'              90  RTV For Price E
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WRAIC3    WQ0125  30       Company Number
     C                     PARM WRHGCD    WQ0126  70       Item Code
     C                     PARM *BLANK    WQ0127  2        UOM Pricing
     C                     PARM *ZERO     WQ0128 112       Unit Weight
     C                     PARM *BLANK    WQ0129  1        Catch Weight St
     C           WN0300    PARM *BLANK    WQ0130  6        Primal Group Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Load Quantity Shipped Total field.
      * CASE: DB1.Quantity Shipped Total is Equal to zero
     C           WRCBQT    IFEQ 0                          *IF
     C                     Z-ADD1         WUCBQT           Quantity Shippe
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWRCBQT    WUCBQT           Quantity Shippe
     C                     END                             *FI
      * Set quantity and weight according to order status
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Detail Line Status is Avail/Alloc/Enter/Hold
      *   |- c2    : DB1.Event Code is Entered Thru 03 Picked
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WRGMST    IFEQ 'L'                        *IF
     C           WRGMST    OREQ 'A'
     C           WRGMST    OREQ 'E'
     C           WRGMST    OREQ 'H'
     C           WRJPCD    IFGE '01'                       *IF
     C           WRJPCD    ANDLE'03'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWRAVQT    WN0297           USR Quantity
     C                     Z-ADDWRD0WG    WN0298           USR Weight
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUCBQT    WN0297           USR Quantity
     C                     Z-ADDWRATWG    WN0298           USR Weight
     C                     END                             *FI
      * CASE: DB1.Price Method Code is Extended
     C           WRQ7CD    IFEQ 'EXT'                      *IF
     C                     Z-ADDWRBZPR    WN0293           Extended Amount
     C                     ELSE
      * CASE: *OTHERWISE
      * Extend price with unit price credit if not zeros
      * CASE:
      *  - (c1 AND c2 AND c3 AND c5 AND c7)
      *   |- c1    : DB1.Detail Line Status is Avail/Alloc/Enter/Hold
      *   |- c2    : DB1.Event Code is Entered Thru 03 Picked
      *   |- c3    : DB1.Unit Price - Credit is Not Zeros
      *   |- c5    : DB1.Price Audit is Not Manually Price Audit
      *   |- c7    : PAR.Pricing Event Called From is No Price With Credi
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WRGMST    IFEQ 'L'                        *IF
     C           WRGMST    OREQ 'A'
     C           WRGMST    OREQ 'E'
     C           WRGMST    OREQ 'H'
     C           WRJPCD    IFGE '01'                       *IF
     C           WRJPCD    ANDLE'03'
     C           WRALPR    IFNE 0                          *IF
     C           WRU0ST    IFEQ 'A'                        *IF
     C           WRU0ST    OREQ 'N'
     C           WRU0ST    OREQ *BLANK
     C           'PM'      IFEQ 'OE'                       *IF
     C           'PM'      OREQ 'PS'
     C           'PM'      OREQ 'UWC'
     C           'PM'      OREQ 'UWT'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 07/08/09 PKD Replaced w/consideration to .01 price or less
      * Extend Price using Price Overage Override or Unit Price-Credit
      * CASE: DB1.Price Method Code is Deviated
     C           WRQ7CD    IFEQ 'DEV'                      *IF
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0293    PARM *ZERO     WQ0131 112       Extended Amount
     C                     PARM WRCRCD    WQ0132  2        U/M - Base Pric
     C                     PARM WN0297    WQ0133 112       Quantity Shippe
     C                     PARM WN0298    WQ0134 112       Weight Shipped
     C                     PARM WRBZPR    WQ0135 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: Manual & HPB
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Code is Manual
      *   |- c2    : PAR.Company Organization is High Plains Biodiesel
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WRQ7CD    IFEQ 'MAN'                      *IF
     C           YL0013    IFEQ 'H'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0293    PARM *ZERO     WQ0136 112       Extended Amount
     C                     PARM WRCRCD    WQ0137  2        U/M - Base Pric
     C                     PARM WN0297    WQ0138 112       Quantity Shippe
     C                     PARM WN0298    WQ0139 112       Weight Shipped
     C                     PARM WRBZPR    WQ0140 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: Manual & Not HPB
      *  - c1 AND c2
      *   |- c1    : DB1.Price Method Code is Manual
      *   |- c2    : PAR.Company Organization is Not HPB
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WRQ7CD    IFEQ 'MAN'                      *IF
     C           YL0013    IFEQ 'D'                        *IF
     C           YL0013    OREQ 'S'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ----- USE: Price Overage Override OR Unit Price-Credit
      * CASE: PS Cst | IC Cst | UNID Itm | OTHER Itm | >.01 Prc
      *  - c1 OR c2 OR c3 OR c4 OR c5
      *   |- c1    : PAR.Type Code is Inter Company
      *   |- c2    : PAR.Type Code is Is Promotional/Samples
      *   |- c3    : PAR.Primal Group Code is Samples or Cut Loss
      *   |- c4    : PAR.Primal Group Code is Other
      *   |- c5    : DB1.Price Overage Override is GT .01
      *   '-
     C           WN0134    IFEQ 'IC'                       *IF
     C           WN0134    OREQ 'PS'                       *OR
     C           WN0300    OREQ 'UNID'                     *OR
     C           WN0300    OREQ 'OTHER'                    *OR
     C           WRBZPR    ORGT .01                        *OR
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0293    PARM *ZERO     WQ0141 112       Extended Amount
     C                     PARM WRCRCD    WQ0142  2        U/M - Base Pric
     C                     PARM WN0297    WQ0143 112       Quantity Shippe
     C                     PARM WN0298    WQ0144 112       Weight Shipped
     C                     PARM WRBZPR    WQ0145 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * ----- USE: Unit Price-Credit
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0293    PARM *ZERO     WQ0146 112       Extended Amount
     C                     PARM WRCRCD    WQ0147  2        U/M - Base Pric
     C                     PARM WN0297    WQ0148 112       Quantity Shippe
     C                     PARM WN0298    WQ0149 112       Weight Shipped
     C                     PARM WRALPR    WQ0150 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * ---- USE: Unit Price-Credit
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0293    PARM *ZERO     WQ0151 112       Extended Amount
     C                     PARM WRCRCD    WQ0152  2        U/M - Base Pric
     C                     PARM WN0297    WQ0153 112       Quantity Shippe
     C                     PARM WN0298    WQ0154 112       Weight Shipped
     C                     PARM WRALPR    WQ0155 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * *** Determine Extended Amount
      * 08/28/07 PKD Replaced with Clc OrdDtl Ext Amt    XF
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0293    PARM *ZERO     WQ0156 112       Extended Amount
     C                     PARM WRCRCD    WQ0157  2        U/M - Base Pric
     C                     PARM WN0297    WQ0158 112       Quantity Shippe
     C                     PARM WN0298    WQ0159 112       Weight Shipped
     C                     PARM WRAKPR    WQ0160 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.USR Quantity is not equal zero
     C           WN0297    IFNE 0                          *IF
     C           WN0293    DIV  WN0297    WN0295    H      Unit Price Orde
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CHG Dtl Price/Audit    CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWRAIC3    WL0012           Company Number
     C                     Z-ADDWRC4NB    WL0013           Order Number
     C                     Z-ADDWRDPNB    WL0014           Order Sequence
     C                     Z-ADDWRUENB    WL0015           Order Secondary
     C                     Z-ADDWN0293    WL0016           Billing Detail
     C                     Z-ADDWN0293    WL0017           Extended Amount
     C                     MOVELWRU1ST    WL0018    P      Price Status
     C                     Z-ADDWRGIDT    WL0019           Pricing Date Us
     C                     MOVELWRU0ST    WL0020    P      Price Audit
     C                     MOVELWRRFCD    WL0021    P      Price Audit Rea
     C                     Z-ADDWRAKPR    WL0022           Unit Price
     C                     Z-ADDWRALPR    WL0023           Unit Price - Cr
     C                     Z-ADDWN0295    WL0024           Unit Price Orde
     C                     Z-ADDWRAVWG    WL0025           Unit Weight Ord
     C                     Z-ADDWRAODT    WL0026           Scheduled Ship
     C                     MOVELWRZ1ST    WL0027    P      Modified Flag
     C                     MOVELWRZ3ST    WL0028    P      Substituted Fla
     C                     MOVELWRZ4ST    WL0029    P      OD Schedule Ove
     C                     EXSR SKCHRC
     C           KRSST     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV Affect Fields      RT - Order Types  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WSJNCD           Order Type - Sa
      * Setup key
     C                     MOVELWAJNCD    WSJNCD           Order Type - Sa
      * Establish starting position
     C           KRSSU     CHAIN@EXRETY              90    *
      * Data record not found
     C   90                MOVEL'USR1063' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWSOEST    WUOEST           Affect Inventor
     C                     MOVELWSOFST    WUOFST           Affect Sales Do
     C                     MOVELWSVBST    WUVBST           Affect Sales Pn
     C                     MOVELWSPYST    WUPYST           Affect Brokerag
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * UPD Chg Val Open Ord   RT - A/R Summary  * Company
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0301 112       Value of Open O
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTANC7           AR Customer Num
      * Setup key
     C                     Z-ADDWL0038    WTAIC3           Company Number
     C                     Z-ADDWL0039    WTANC7           AR Customer Num
      * Establish starting position
     C           KRSSV     CHAIN@BCREFE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0172' W0RTN   7
      * USER: Processing if Data record not found
      * This shouldn't be used here--A/R Summary is created when an order
      * is created
      * CRT A/R Summary        CR - A/R Summary  * 
     C                     EXSR SWCRRC
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WTEEVA    ADD  WL0040    WN0301           Value of Open O
      * CHG Value Open Orders  CH - A/R Summary  * 
     C                     EXSR SXCHRC
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWCRRC    BEGSR
      *================================================================
      * CRT A/R Summary        CR - A/R Summary  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0302  60       Job Time
     C                     MOVEL*BLANK    WN0303 10        User Id
     C                     MOVEL*BLANK    WN0304 10        Job Name
     C                     Z-ADD*ZERO     WN0305  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BCREFD
     C                     Z-ADDWL0038    WVAIC3           Company Number
     C                     Z-ADDWL0039    WVANC7           AR Customer Num
     C                     Z-ADD*ZERO     WVAGVA           Age $ Due - Cur
     C                     Z-ADD*ZERO     WVACVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WVADVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WVAEVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WVAFVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WVAHVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WVVIVA           Age $ Due-Curre
     C                     Z-ADD*ZERO     WVVJVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WVVKVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WVVLVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WVVMVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WVVNVA           Age $ Due-Aging
     C                     Z-ADDWL0040    WVEEVA           Value of Open O
     C                     Z-ADD*ZERO     WVAKTM           Time of Last Ag
     C                     Z-ADD*ZERO     WVAHDT           Date of First S
     C                     Z-ADD*ZERO     WVANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WVANVA           Amount of Last
     C                     Z-ADD*ZERO     WVALDT           Date of Last Pa
     C                     Z-ADD*ZERO     WVAMVA           Amount of Last
     C                     Z-ADD*ZERO     WVAIDT           Date of Highest
     C                     Z-ADD*ZERO     WVALVA           Amount of Highe
     C                     Z-ADD*ZERO     WVDJNB           Number of Invoi
     C                     Z-ADD1         WVDLNB           Number of Order
     C                     Z-ADD*ZERO     WVDDNB           Number of Credi
     C                     Z-ADD*ZERO     WVDMNB           Number of Payme
     C                     Z-ADD*ZERO     WVDUDT           Date of Last Ag
     C                     Z-ADD*ZERO     WVLYNO           Last YTD Nbr of
     C                     Z-ADD*ZERO     WVLYNC           Last YTD Nbr of
     C                     Z-ADD*ZERO     WVLYNP           Last YTD Nbr of
     C                     Z-ADD*ZERO     WVLYNI           Last YTD Nbr of
     C                     Z-ADD*ZERO     WVADPM           MTD Invoices Pa
     C                     Z-ADD*ZERO     WVVOVA           YTD Invoices Pa
     C                     Z-ADD*ZERO     WVBTDY           MTD Days Paid
     C                     Z-ADD*ZERO     WVBUDY           YTD Days Paid
     C                     Z-ADD*ZERO     WVVPVA           YTD Sales Invoi
     C                     Z-ADD*ZERO     WVVQVA           Last Year Sales
     C                     MOVEL*BLANK    WVBCCD           Salesperson Cod
     C                     MOVEL*BLANK    WVR4CD           Sales Route Cod
     C                     Z-ADD*ZERO     WVCUMO           Current Month
     C                     MOVEL*BLANK    WVUVST           EDI Status 1
     C                     MOVEL*BLANK    WVUWST           EDI Status 2
     C                     MOVEL*BLANK    WVUXST           EDI Status 3
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WVAATM           Job Time
     C                     MOVEL##USR     WVAYNA           User Id
     C                     MOVEL##JOB     WVA0NA           Job Name
     C                     Z-ADD##JDT     WVAXDT           Job Date
     C           KLCRSW    KLIST
     C                     KFLD           WVAIC3           Company Number
     C                     KFLD           WVANC7           AR Customer Num
      * Check for duplicate primary key
     C           KLCRSW    SETLL@BCREFD                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0173' W0RTN   7
      * Send message 'A/R Summary            EX'
     C                     MOVEL'USR0173' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C                     WRITE@BCREFD                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCHRC    BEGSR
      *================================================================
      * CHG Value Open Orders  CH - A/R Summary  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0306 112       Age $ Due - Cur
     C                     Z-ADD*ZERO     WN0307 112       Age $ Due - Agi
     C                     Z-ADD*ZERO     WN0308 112       Age $ Due - Agi
     C                     Z-ADD*ZERO     WN0309 112       Age $ Due - Agi
     C                     Z-ADD*ZERO     WN0310 112       Age $ Due - Agi
     C                     Z-ADD*ZERO     WN0311 112       Age $ Due - Agi
     C                     Z-ADD*ZERO     WN0312 112       Age $ Due-Curre
     C                     Z-ADD*ZERO     WN0313 112       Age $ Due-Aging
     C                     Z-ADD*ZERO     WN0314 112       Age $ Due-Aging
     C                     Z-ADD*ZERO     WN0315 112       Age $ Due-Aging
     C                     Z-ADD*ZERO     WN0316 112       Age $ Due-Aging
     C                     Z-ADD*ZERO     WN0317 112       Age $ Due-Aging
     C                     Z-ADD*ZERO     WN0318  60       Time of Last Ag
     C                     Z-ADD*ZERO     WN0319  70       Date of First S
     C                     Z-ADD*ZERO     WN0320  70       Date of Last Sh
     C                     Z-ADD*ZERO     WN0321 112       Amount of Last
     C                     Z-ADD*ZERO     WN0322  70       Date of Last Pa
     C                     Z-ADD*ZERO     WN0323 112       Amount of Last
     C                     Z-ADD*ZERO     WN0324  70       Date of Highest
     C                     Z-ADD*ZERO     WN0325 112       Amount of Highe
     C                     Z-ADD*ZERO     WN0326  50       Number of Invoi
     C                     Z-ADD*ZERO     WN0327  50       Number of Order
     C                     Z-ADD*ZERO     WN0328  50       Number of Credi
     C                     Z-ADD*ZERO     WN0329  50       Number of Payme
     C                     Z-ADD*ZERO     WN0330  70       Date of Last Ag
     C                     Z-ADD*ZERO     WN0331  50       Last YTD Nbr of
     C                     Z-ADD*ZERO     WN0332  50       Last YTD Nbr of
     C                     Z-ADD*ZERO     WN0333  50       Last YTD Nbr of
     C                     Z-ADD*ZERO     WN0334  50       Last YTD Nbr of
     C                     Z-ADD*ZERO     WN0335  50       MTD Invoices Pa
     C                     Z-ADD*ZERO     WN0336  50       YTD Invoices Pa
     C                     Z-ADD*ZERO     WN0337  50       MTD Days Paid
     C                     Z-ADD*ZERO     WN0338  50       YTD Days Paid
     C                     Z-ADD*ZERO     WN0339 112       YTD Sales Invoi
     C                     Z-ADD*ZERO     WN0340 112       Last Year Sales
     C                     MOVEL*BLANK    WN0341  3        Salesperson Cod
     C                     MOVEL*BLANK    WN0342  3        Sales Route Cod
     C                     Z-ADD*ZERO     WN0343  20       Current Month
     C                     MOVEL*BLANK    WN0344  1        EDI Status 1
     C                     MOVEL*BLANK    WN0345  1        EDI Status 2
     C                     MOVEL*BLANK    WN0346  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0347  60       Job Time
     C                     MOVEL*BLANK    WN0348 10        User Id
     C                     MOVEL*BLANK    WN0349 10        Job Name
     C                     Z-ADD*ZERO     WN0350  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BCREFD
     C                     Z-ADDWTAIC3    WVAIC3           Company Number
     C                     Z-ADDWTANC7    WVANC7           AR Customer Num
      *
     C           KLCHSX    KLIST
     C                     KFLD           WVAIC3           Company Number
     C                     KFLD           WVANC7           AR Customer Num
     C           KLCHSX    CHAIN@BCREFD              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'ARBCREL0'MDACP
     C                     MOVEL'@BCREFD' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QARBC1    YCRDCS
      * Move non-key fields to @BCREFD
     C                     Z-ADDWN0301    WVEEVA           Value of Open O
      *
      * Set PGM.*Record Data Changed flag
     C           QARBC1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WVAATM           Job Time
     C                     MOVEL##USR     WVAYNA           User Id
     C                     MOVEL##JOB     WVA0NA           Job Name
     C                     Z-ADD##JDT     WVAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QARBC1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BCREFD                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKARBCREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCHRC    BEGSR
      *================================================================
      * CHG Order Price/PrcAud CH - PD Order Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0351  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0352  70       AR Customer Num
     C                     Z-ADD*ZERO     WN0353  70       Ship To Custome
     C                     MOVEL*BLANK    WN0354 30        Ship To Name
     C                     MOVEL*BLANK    WN0355 30        Ship To Address
     C                     MOVEL*BLANK    WN0356 30        Ship To Address
     C                     MOVEL*BLANK    WN0357 30        Ship To Address
     C                     MOVEL*BLANK    WN0358 20        Ship To City
     C                     MOVEL*BLANK    WN0359  2        Ship To State C
     C                     MOVEL*BLANK    WN0360 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0361  70       Bill to Custome
     C                     MOVEL*BLANK    WN0362 30        Bill to Name
     C                     MOVEL*BLANK    WN0363 30        Bill to Address
     C                     MOVEL*BLANK    WN0364 30        Bill to Address
     C                     MOVEL*BLANK    WN0365 30        Bill to Address
     C                     MOVEL*BLANK    WN0366 20        Bill to City
     C                     MOVEL*BLANK    WN0367  2        Bill to State C
     C                     MOVEL*BLANK    WN0368 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0369 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0370  70       Order Date
     C                     Z-ADD*ZERO     WN0371  70       Requested Ship
     C                     Z-ADD*ZERO     WN0372  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0373  70       Cancel Date
     C                     MOVEL*BLANK    WN0374  2        Terms Code
     C                     MOVEL*BLANK    WN0375 40        Special Instruc
     C                     MOVEL*BLANK    WN0376 40        Special Instruc
     C                     MOVEL*BLANK    WN0377  3        Carrier Code
     C                     MOVEL*BLANK    WN0378  1        Comment Print A
     C                     MOVEL*BLANK    WN0379  1        Comment Print I
     C                     MOVEL*BLANK    WN0380  1        Comment Print P
     C                     MOVEL*BLANK    WN0381  1        Comment Print S
     C                     MOVEL*BLANK    WN0382  3        Reason Code
     C                     MOVEL*BLANK    WN0383  1        Order in Use
     C                     MOVEL*BLANK    WN0384  1        Header Status
     C                     MOVEL*BLANK    WN0385  1        Header Status L
     C                     MOVEL*BLANK    WN0386  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0387  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0388 10        User Original E
     C                     Z-ADD*ZERO     WN0389  70       Date of Origina
     C                     MOVEL*BLANK    WN0390  1        Credit Hold
     C                     MOVEL*BLANK    WN0391  1        Production Hold
     C                     MOVEL*BLANK    WN0392  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0393  40       Requested Deliv
     C                     MOVEL*BLANK    WN0394  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0395 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0396  70       Load ID
     C                     Z-ADD*ZERO     WN0397  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0398 112       Rated Freight
     C                     MOVEL*BLANK    WN0399  1        LTL Flag
     C                     MOVEL*BLANK    WN0400  2        Shipping Method
     C                     MOVEL*BLANK    WN0401  1        Export Status
     C                     MOVEL*BLANK    WN0402  1        Palletize
     C                     MOVEL*BLANK    WN0403  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0404  1        Slip Sheet
     C                     MOVEL*BLANK    WN0405  1        Age Code
     C                     Z-ADD*ZERO     WN0406  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0407  1        Load Type
     C                     Z-ADD*ZERO     WN0408  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0409  1        Load Plan Order
     C                     MOVEL*BLANK    WN0410  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0411  70       Resell Referenc
     C                     MOVEL*BLANK    WN0412 30        Special Comment
     C                     MOVEL*BLANK    WN0413 30        Special Comment
     C                     MOVEL*BLANK    WN0414  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0415  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0416  2        Manager Level C
     C                     MOVEL*BLANK    WN0417  3        VP Level Code
     C                     Z-ADD*ZERO     WN0418  70       Attach to Order
     C                     MOVEL*BLANK    WN0419  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0420  70       Invoice Number
     C                     MOVEL*BLANK    WN0421  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0422  70       Invoice Date
     C                     MOVEL*BLANK    WN0423  2        Event Code
     C                     MOVEL*BLANK    WN0424  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0425  1        Billing Activit
     C                     MOVEL*BLANK    WN0426  1        Block Order Fla
     C                     MOVEL*BLANK    WN0427  1        Order Certifica
     C                     Z-ADD*ZERO     WN0428 112       Invoice Order V
     C                     MOVEL*BLANK    WN0429  1        Process Sts for
     C                     MOVEL*BLANK    WN0430  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0431  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0432  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0433  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0434  1        Email Cust On O
     C                     MOVEL*BLANK    WN0435  1        Order Emailed
     C                     MOVEL*BLANK    WN0436  1        Export Docs Go
     C                     MOVEL*BLANK    WN0437  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0438  1        Broker Order St
     C                     MOVEL*BLANK    WN0439  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0440  2        Order Requires
     C                     MOVEL*BLANK    WN0441  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0442  2        Export USDA App
     C                     MOVEL*BLANK    WN0443  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0444  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0445  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0446  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0447  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0448  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0449  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0450  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0451  60       Time of Origina
     C                     Z-ADD*ZERO     WN0452  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0453  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0454  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0455 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0456 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0457 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0458 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0459 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0460  70       Claim Number
     C                     MOVEL*BLANK    WN0461  1        EDI Status 1
     C                     MOVEL*BLANK    WN0462  1        EDI Status 2
     C                     MOVEL*BLANK    WN0463  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0464  60       Job Time
     C                     MOVEL*BLANK    WN0465 10        User Id
     C                     MOVEL*BLANK    WN0466 10        Job Name
     C                     Z-ADD*ZERO     WN0467  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWL0041    WWAIC3           Company Number
     C                     Z-ADDWL0042    WWC4NB           Order Number
      *
     C           KLCHSY    KLIST
     C                     KFLD           WWAIC3           Company Number
     C                     KFLD           WWC4NB           Order Number
     C           KLCHSY    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YDRDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADDWL0043    WWJZVA           Order Value Tot
     C                     Z-ADDWL0044    WWA1WG           Order Weight To
     C                     Z-ADDWL0045    WWEIDT           Requested Deliv
     C                     MOVELWL0046    WWU0ST    P      Price Audit
     C                     MOVELWL0047    WWU1ST    P      Price Status
     C                     MOVELWL0048    WWZ1ST    P      Modified Flag
     C                     Z-ADDWL0049    WWVRVA           A/R order Value
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WWAATM           Job Time
     C                     MOVEL##USR     WWAYNA           User Id
     C                     MOVEL##PGM     WWA0NA           Job Name
     C                     Z-ADD##JDT     WWAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDWWAIC3    PAAIC3           Company Number
     C                     Z-ADDWWC4NB    PAC4NB           Order Number
     C                     MOVELWWJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDWWANC7    PAANC7           AR Customer Num
     C                     Z-ADDWWBKC7    PABKC7           Ship To Custome
     C                     MOVELWWBRTX    PABRTX    P      Ship To Name
     C                     MOVELWWHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWWHONA    PAHONA    P      Ship To Address
     C                     MOVELWWHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWWHNNA    PAHNNA    P      Ship To City
     C                     MOVELWWDBCD    PADBCD    P      Ship To State C
     C                     MOVELWWCKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDWWB0C7    PAB0C7           Bill to Custome
     C                     MOVELWWAETX    PAAETX    P      Bill to Name
     C                     MOVELWWB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWWB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWWB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWWB2NA    PAB2NA    P      Bill to City
     C                     MOVELWWBHCD    PABHCD    P      Bill to State C
     C                     MOVELWWC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELWWBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWWA0DT    PAA0DT           Order Date
     C                     Z-ADDWWA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWWGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWWACDT    PAACDT           Cancel Date
     C                     MOVELWWAQCD    PAAQCD    P      Terms Code
     C                     MOVELWWB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWWBYNA    PABYNA    P      Special Instruc
     C                     MOVELWWBZNA    PABZNA    P      Carrier Code
     C                     MOVELWWGTST    PAGTST    P      Comment Print A
     C                     MOVELWWGVST    PAGVST    P      Comment Print I
     C                     MOVELWWGUST    PAGUST    P      Comment Print P
     C                     MOVELWWQFST    PAQFST    P      Comment Print S
     C                     MOVELWWCQCD    PACQCD    P      Reason Code
     C                     MOVELWWGJST    PAGJST    P      Order in Use
     C                     MOVELWWGWST    PAGWST    P      Header Status
     C                     MOVELWWGXST    PAGXST    P      Header Status L
     C                     MOVELWWGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWWAODT    PAAODT           Scheduled Ship
     C                     MOVELWWAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWWCXDT    PACXDT           Date of Origina
     C                     Z-ADDWWJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWWA1WG    PAA1WG           Order Weight To
     C                     MOVELWWXIST    PAXIST    P      Credit Hold
     C                     MOVELWWXJST    PAXJST    P      Production Hold
     C                     MOVELWWXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWWEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWWAFTM    PAAFTM           Requested Deliv
     C                     MOVELWWE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWWE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWWRMNB    PARMNB           Load ID
     C                     Z-ADDWWTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWWR1NB    PAR1NB           Rated Freight
     C                     MOVELWWPJST    PAPJST    P      LTL Flag
     C                     MOVELWWU0ST    PAU0ST    P      Price Audit
     C                     MOVELWWU1ST    PAU1ST    P      Price Status
     C                     MOVELWWQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWWU2ST    PAU2ST    P      Export Status
     C                     MOVELWWVEST    PAVEST    P      Palletize
     C                     MOVELWWVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWWVGST    PAVGST    P      Slip Sheet
     C                     MOVELWWRPCD    PARPCD    P      Age Code
     C                     Z-ADDWWRNNB    PARNNB           Reefer Temperat
     C                     MOVELWWVDST    PAVDST    P      Load Type
     C                     Z-ADDWWATIN    PAATIN           Attach to Invoi
     C                     MOVELWWU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWWU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWWRSRN    PARSRN           Resell Referenc
     C                     MOVELWWMHNA    PAMHNA    P      Special Comment
     C                     MOVELWWMINA    PAMINA    P      Special Comment
     C                     MOVELWWWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWWR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWWBFCD    PABFCD    P      Manager Level C
     C                     MOVELWWQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWWT3NB    PAT3NB           Attach to Order
     C                     MOVELWWSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWWCONB    PACONB           Invoice Number
     C                     MOVELWWCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWWAWDT    PAAWDT           Invoice Date
     C                     MOVELWWJPCD    PAJPCD    P      Event Code
     C                     MOVELWWXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWWZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWWVRVA    PAVRVA           A/R order Value
     C                     MOVELWWOBST    PAOBST    P      Billing Activit
     C                     MOVELWWBCST    PABCST    P      Block Order Fla
     C                     MOVELWWBDST    PABDST    P      Order Certifica
     C                     Z-ADDWWB7VL    PAB7VL           Invoice Order V
     C                     MOVELWWGASX    PAGASX    P      Process Sts for
     C                     MOVELWWGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWWGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWWGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWWFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWWFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWWFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWWFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWWFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWWFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWWFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWWFUSX    PAFUSX    P      Order Requires
     C                     MOVELWWFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWWFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWWFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWWFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWWNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWWNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWWNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWWNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWWNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWWBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWWBQTM    PABQTM           Time of Origina
     C                     Z-ADDWWBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWWBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWWBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWWH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWWH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDWWH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWWH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDWWH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWWC0C7    PAC0C7           Claim Number
     C                     MOVELWWUVST    PAUVST    P      EDI Status 1
     C                     MOVELWWUWST    PAUWST    P      EDI Status 2
     C                     MOVELWWUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWWAATM    PAAATM           Job Time
     C                     MOVELWWAYNA    PAAYNA    P      User Id
     C                     MOVELWWA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWWAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Order is not Cancelled.
      *================================================================
      * CASE: DB1.Billing Activity Type is Invoice
     C           WAOBST    IFEQ '1'                        *IF
      * Invoice.
     C                     EXSR UBSUBR                     Invoice.
     C                     ELSE
      * CASE: DB1.Billing Activity Type is Warehouse Transfer
     C           WAOBST    IFEQ '4'                        *IF
      * Warehouse Transfer.
     C                     EXSR UDSUBR                     Warehouse Trans
     C                     ELSE
      * CASE: *OTHERWISE
      * Credit Memo/Debit Memo
     C                     Z-ADDWAJZVA    WN0130           USR Order Value
     C                     Z-ADDWAA1WG    WN0129           USR Order Weigh
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0130    YL0007           Order Value Tot
     C                     Z-ADDWN0129    YL0008           Order Weight To
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Invoice.
      *================================================================
      * Rtv All Prc Sts/Audit  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADDWAC4NB    WL0002           Order Number
     C                     Z-ADD*ZERO     WL0003           Order Sequence
     C                     Z-ADD*ZERO     WL0004           Order Secondary
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    WN0127    P      Price Status
     C                     MOVELWL0006    WN0126    P      Price Audit
     C                     Z-ADDWL0007    WN0137           Shipping Compan
     C                     Z-ADDWL0008    WN0136           Accounting Comp
     C                     MOVELWN0126    WN0133           Price Audit USR
      * Extend $ if call from OE and Price=P & Audit=M)
      * CASE:
      *  - (c2 AND c3 ANDc4)
      *   |- c2    : PAR.Pricing Event Called From is Order Entry
      *   |- c3    : PAR.Price Audit is Manually Price Audited
      *   |- c4    : PAR.Price Status is Priced
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           'PM'      IFEQ 'OE'                       *IF
     C           WN0126    IFEQ 'M'                        *IF
     C           WN0127    IFEQ 'P'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELWN0127    WN0132           Price Status US
      * CLC Extend Price       RT - Order Detail  * 
     C                     EXSR SIRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * Price OR Reprice
      * C4029:  We won't be using PAR.Price Status USR or PAR.Price Audit
      *         to update order header; re-retrieving it.
      * R12926 DN 04/23/18-Pass in Absorbed Freight Rate. Use AFR at Orde
      * CLC Price/Price Audit  RT - Order Detail  * 
     C                     EXSR SLRVGN
     C                     END                             *FI
      * RTV Affect Fields      RT - Order Types  * 
     C                     EXSR SURVGN
      * If not a new order remove A/R Summary
      * CASE: PAR.USR New Order is *NO
     C           YL0010    IFEQ '*NO'                      *IF
      * Remove old order value from A/R Summary
      * CASE: DB1.Block Order Flag is Block Order
     C           WABCST    IFEQ 'B'                        *IF
      *    **OMS203:  Block Orders don't affect A/R Summary
     C                     ELSE
      * CASE: WRK.Affect Sales Doll Default is yes
     C           WUOFST    IFEQ 'Y'                        *IF
     C           *ZERO     SUB  WAVRVA    WUJZVA           Order Value Tot
      * 08/20/07 RMC PK0040 Use Accounting Company if there, else db1
      * CASE: PAR.Accounting Company is Equal to zero
     C           WN0136    IFEQ 0                          *IF
      * UPD Chg Val Open Ord   RT - A/R Summary  * Company
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0038           Company Number
     C                     Z-ADDWAANC7    WL0039           AR Customer Num
     C                     Z-ADDWUJZVA    WL0040           A/R order Value
     C                     EXSR SVRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * UPD Chg Val Open Ord   RT - A/R Summary  * Accounting Company
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0136    WL0038           Company Number
     C                     Z-ADDWAANC7    WL0039           AR Customer Num
     C                     Z-ADDWUJZVA    WL0040           A/R order Value
     C                     EXSR SVRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CLC Tot Ord Val Ship   XF - Order Detail  * 
     C                     CALL 'PDP1XFR'              90  CLC Tot Ord Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0161  30       Company Number
     C                     PARM WAC4NB    WQ0162  70       Order Number
     C           WN0130    PARM WN0130    WQ0163 112       USR Order Value
     C           WN0129    PARM WN0129    WQ0164 112       USR Order Weigh
     C           YL0009    PARM YL0009    WQ0165  1        USR Production
     C           WUR4ST    PARM WUR4ST    WQ0166  1        USR Update Flag
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDP1XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * A/R Summary updated if order type affect sales $/not block order
      * CASE: DB1.Block Order Flag is Block Order
     C           WABCST    IFEQ 'B'                        *IF
     C                     Z-ADD*ZERO     WN0128           A/R order Value
     C                     ELSE
      * CASE: WRK.Affect Sales Doll Default is yes
     C           WUOFST    IFEQ 'Y'                        *IF
      * 12/07/06 PKD PK0040 Use Accounting Company if there
      * CASE: PAR.Accounting Company is Equal to zero
     C           WN0136    IFEQ 0                          *IF
      * UPD Chg Val Open Ord   RT - A/R Summary  * Company
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0038           Company Number
     C                     Z-ADDWAANC7    WL0039           AR Customer Num
     C                     Z-ADDWN0130    WL0040           A/R order Value
     C                     EXSR SVRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * UPD Chg Val Open Ord   RT - A/R Summary  * Accounting Company
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0136    WL0038           Company Number
     C                     Z-ADDWAANC7    WL0039           AR Customer Num
     C                     Z-ADDWN0130    WL0040           A/R order Value
     C                     EXSR SVRVGN
     C                     END                             *FI
     C                     Z-ADDWN0130    WN0128           A/R order Value
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0128           A/R order Value
     C                     END                             *FI
     C                     END                             *FI
      * Load ID NE *zero
      * CASE: DB1.Load ID NE WRK.ZERO
     C           WARMNB    IFNE WUW0NB                     *IF
      * RTV UPD Ld Abs.Frt/Wgt XF - OP Order Header  * 
     C                     CALL 'PDE0XFR'              90  RTV UPD Ld Abs.
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WARMNB    WQ0167  70       Load ID
     C           WURPNB    PARM WURPNB    WQ0168  70       Total Load Orde
     C           WURQNB    PARM WURQNB    WQ0169 112       Total Freight
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDE0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Update header with Order Value/Weight and Price Status/Audit Valu
      * C4029:  3/20/98 pll  Added code so the header re-gets the price/a
      * Rtv All Prc Sts/Audit  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADDWAC4NB    WL0002           Order Number
     C                     Z-ADD*ZERO     WL0003           Order Sequence
     C                     Z-ADD*ZERO     WL0004           Order Secondary
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    WN0132    P      Price Status
     C                     MOVELWL0006    WN0133    P      Price Audit
     C                     Z-ADDWL0007    WN0137           Shipping Compan
     C                     Z-ADDWL0008    WN0136           Accounting Comp
      * CHG Order Price/PrcAud CH - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0041           Company Number
     C                     Z-ADDWAC4NB    WL0042           Order Number
     C                     Z-ADDWN0130    WL0043           Order Value Tot
     C                     Z-ADDWN0129    WL0044           Order Weight To
     C                     Z-ADDWAEIDT    WL0045           Requested Deliv
     C                     MOVELWN0133    WL0046    P      Price Audit
     C                     MOVELWN0132    WL0047    P      Price Status
     C                     MOVELWAZ1ST    WL0048    P      Modified Flag
     C                     Z-ADDWN0128    WL0049           A/R order Value
     C                     EXSR SYCHRC
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Set hold fields and call pricing routine
      *================================================================
     C                     Z-ADDWCAKPR    WN0267           Unit Price
     C                     Z-ADDWCALPR    WN0268           Unit Price - Cr
     C                     Z-ADDWCAUPR    WN0269           Unit Price Orde
     C                     MOVELWCU1ST    WN0263           Price Status
     C                     MOVELWCRFCD    WN0266           Price Audit Rea
      * If order is priced and manually price audited then price only
      * CASE:
      *  - (c1 AND c2) OR c3 OR c4 OR c5
      *   |- c1    : DB1.Price Status is Priced
      *   |- c2    : DB1.Price Audit is Manually Price Audited
      *   |- c3    : PAR.Pricing Event Called From is Market Group Change
      *   |- c4    : PAR.Pricing Event Called From is Customer/Item Chang
      *   |- c5    : PAR.Pricing Event Called From is Item Change
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCU1ST    IFEQ 'P'                        *IF
     C           WCU0ST    IFEQ 'M'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           'PM'      IFEQ 'MGC'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           'PM'      IFEQ 'CIC'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           'PM'      IFEQ 'IC'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'99'      WN0274           Event Called Fr
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'AO'      WN0274           Event Called Fr
     C                     END                             *FI
      * CLC Price Item         XF - Price Method Header  * 
     C                     CALL 'PDG9XFR'              90  CLC Price Item
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WCAIC3    WQ0051  30       Company Number
     C                     PARM WCQ7CD    WQ0052  3        Price Method Co
     C                     PARM WCBKC7    WQ0053  70       Ship To Custome
     C                     PARM WCGNDT    WQ0054  70       Actual Shipped
     C                     PARM WCAGCD    WQ0055  2        U/M - Ordered
     C                     PARM WCAVQT    WQ0056 112       Quantity Ordere
     C                     PARM WCA5DT    WQ0057  70       Requested Ship
     C           WN0267    PARM WN0267    WQ0058 114       Unit Price
     C           WN0269    PARM WN0269    WQ0059 114       Unit Price Orde
     C                     PARM WCHGCD    WQ0060  70       Item Code
     C                     PARM WAA0DT    WQ0061  70       Date of Orig. E
     C                     PARM WCLQCD    WQ0062  3        Commodity Marke
     C                     PARM WCEXDT    WQ0063  70       Market Pricing
     C           WN0263    PARM WN0263    WQ0064  1        Price Status
     C                     PARM WCRDCD    WQ0065  3        Date Method Cod
     C                     PARM WCBZPR    WQ0066 114       Price Overage O
     C           WN0264    PARM WN0264    WQ0067  70       Pricing Date Us
     C                     PARM WN0274    WQ0068  2        Event Called Fr
     C                     PARM WCDWPR    WQ0069 114       OD Ceiling Pric
     C                     PARM WCTKDT    WQ0070  70       OD Market Begin
     C                     PARM WCTLDT    WQ0071  70       OD Market Endin
     C                     PARM WCC4NB    WQ0072  70       Order Number
     C                     PARM WAEIDT    WQ0073  70       Requested Deliv
     C                     PARM WCDPNB    WQ0074  30       Order Sequence
     C                     PARM WCUENB    WQ0075  30       Order Secondary
     C           WUWZST    PARM WUWZST    WQ0076  5        Error Return
     C                     PARM 'S'       WQ0077  1        Price Type Stat
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDG9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RMC 6/17/09 FP1054 pass qty/wgt ordered
      *
     C                     MOVEL*BLANK    WN0275  2        UOM Pricing
     C                     Z-ADD*ZERO     WN0276 112       Unit Weight
     C                     MOVEL*BLANK    WN0277  1        Catch Weight St
     C                     MOVEL*BLANK    WN0278  6        Primal Group Co
     C                     Z-ADD*ZERO     WN0279 114       Price per Pound
     C                     Z-ADD*ZERO     WN0280 112       USR Quantity
     C                     Z-ADD*ZERO     WN0281 112       USR Weight
      *
      * CLC Price,Ext,U/M1Prc  IF
      * *****************************************************************
      * Calculate "Price Per Pound", "Extended Amount", "Primary U/M Pric
      * *****************************************************************
     C                     Z-ADD*ZERO     WN0276           Unit Weight
     C                     MOVEL*BLANK    WN0275           UOM Pricing
     C                     MOVEL*BLANK    WN0277           Catch Weight St
      * Load Quantity Shipped Total field. c2742- do -0- shipped from ord
      * CASE: PAR.Quantity Shipped Total is Equal to zero
     C           WCCBQT    IFEQ 0                          *IF
     C                     Z-ADD1         WUCBQT           Quantity Shippe
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWCCBQT    WUCBQT           Quantity Shippe
     C                     END                             *FI
      * Set quantity and weight according to order status  c2742 -0- shpe
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Detail Line Status is Avail/Alloc/Enter/Hold
      *   |- c2    : PAR.Event Code is Entered Thru 03 Picked
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCGMST    IFEQ 'L'                        *IF
     C           WCGMST    OREQ 'A'
     C           WCGMST    OREQ 'E'
     C           WCGMST    OREQ 'H'
     C           WCJPCD    IFGE '01'                       *IF
     C           WCJPCD    ANDLE'03'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RMC 6/17/09 FP1054 use qty/wgt ordered instead of sched
     C                     Z-ADDWCAVQT    WN0280           USR Quantity
     C                     Z-ADDWCD0WG    WN0281           USR Weight
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUCBQT    WN0280           USR Quantity
     C                     Z-ADDWCATWG    WN0281           USR Weight
     C                     END                             *FI
      * RTV For Price Extent   XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDXRXFR'              90  RTV For Price E
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WCAIC3    WQ0078  30       Company Number
     C                     PARM WCHGCD    WQ0079  70       Item Code
     C           WN0275    PARM *BLANK    WQ0080  2        UOM Pricing
     C           WN0276    PARM *ZERO     WQ0081 112       Unit Weight
     C           WN0277    PARM *BLANK    WQ0082  1        Catch Weight St
     C           WN0278    PARM *BLANK    WQ0083  6        Primal Group Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Check retrieve Unit Weight & C/W error
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : PAR.Catch Weight Status is Y/N Values
      *   |- c3    : PAR.Unit Weight is Not equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           WN0277    IFEQ 'N'                        *IF
     C           WN0277    OREQ 'Y'
     C           WN0276    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           *ZERO     IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL*ZERO     WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0001           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0001           CD7 Ext Numeric
     C                     END                             *FI
     C                     Z-ADD*ZERO     ZA0002           Order Sequence
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           WCHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVELWCHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0003           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0003           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVELWN0277    ZA0004           Catch Weight St
     C                     Z-ADD*ZERO     ZA0005           Unit Price
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR2306' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
     C                     END                             *FI
      * CASE: PAR.Price Method Code is Extended
     C           WCQ7CD    IFEQ 'EXT'                      *IF
     C                     Z-ADDWCBZPR    WN0261           Extended Amount
      * Calculate Unit Price for Extended
      * CASE: PAR.USR Weight is Not equal zero
     C           WN0281    IFNE 0                          *IF
     C           WN0261    DIV  WN0281    WN0267    H      Unit Price
     C                     END                             *FI
      * Calculate Pricing U/M Price for Extended
      * CASE: PAR.USR Quantity is not equal zero
     C           WN0280    IFNE 0                          *IF
     C           WN0261    DIV  WN0280    WN0269    H      Unit Price Orde
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Extend price with unit price credit if not zeros
      * CASE:
      *  - (c1 AND c2 AND c3 AND c5 AND c7)
      *   |- c1    : PAR.Detail Line Status is Avail/Alloc/Enter/Hold
      *   |- c2    : PAR.Event Code is Entered Thru 03 Picked
      *   |- c3    : PAR.Unit Price - Credit is Not Zeros
      *   |- c5    : PAR.Price Audit is Not Manually Price Audit
      *   |- c7    : PAR.Pricing Event Called From is No Price With Credi
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCGMST    IFEQ 'L'                        *IF
     C           WCGMST    OREQ 'A'
     C           WCGMST    OREQ 'E'
     C           WCGMST    OREQ 'H'
     C           WCJPCD    IFGE '01'                       *IF
     C           WCJPCD    ANDLE'03'
     C           WCALPR    IFNE 0                          *IF
     C           WCU0ST    IFEQ 'A'                        *IF
     C           WCU0ST    OREQ 'N'
     C           WCU0ST    OREQ *BLANK
     C           'PM'      IFEQ 'OE'                       *IF
     C           'PM'      OREQ 'PS'
     C           'PM'      OREQ 'UWC'
     C           'PM'      OREQ 'UWT'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 07/07/08 PKD Replaced w/consideration for .01 manual price
      * Extend Price using Price Overage Override or Unit Price-Credit
      * CASE: PAR.Price Method Code is Deviated
     C           WCQ7CD    IFEQ 'DEV'                      *IF
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0261    PARM *ZERO     WQ0084 112       Extended Amount
     C                     PARM WN0275    WQ0085  2        U/M - Base Pric
     C                     PARM WN0280    WQ0086 112       Quantity Shippe
     C                     PARM WN0281    WQ0087 112       Weight Shipped
     C                     PARM WCBZPR    WQ0088 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: Manual & HPB
      *  - c1 AND c2
      *   |- c1    : PAR.Price Method Code is Manual
      *   |- c2    : PAR.Company Organization is High Plains Biodiesel
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCQ7CD    IFEQ 'MAN'                      *IF
     C           YL0013    IFEQ 'H'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0261    PARM *ZERO     WQ0089 112       Extended Amount
     C                     PARM WN0275    WQ0090  2        U/M - Base Pric
     C                     PARM WN0280    WQ0091 112       Quantity Shippe
     C                     PARM WN0281    WQ0092 112       Weight Shipped
     C                     PARM WCBZPR    WQ0093 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: Manual & Not HPB
      *  - c1 AND c2
      *   |- c1    : PAR.Price Method Code is Manual
      *   |- c2    : PAR.Company Organization is Not HPB
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCQ7CD    IFEQ 'MAN'                      *IF
     C           YL0013    IFEQ 'D'                        *IF
     C           YL0013    OREQ 'S'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ----- USE: Price Overage Override OR Unit Price-Credit
      * CASE: PS Cst | IC Cst | UNID Itm | OTHER Itm | >.01 Prc
      *  - c1 OR c2 OR c3 OR c4 OR c5
      *   |- c1    : PAR.Type Code is Inter Company
      *   |- c2    : PAR.Type Code is Is Promotional/Samples
      *   |- c3    : PAR.Primal Group Code is Samples or Cut Loss
      *   |- c4    : PAR.Primal Group Code is Other
      *   |- c5    : PAR.Price Overage Override is GT .01
      *   '-
     C           WN0134    IFEQ 'IC'                       *IF
     C           WN0134    OREQ 'PS'                       *OR
     C           WN0278    OREQ 'UNID'                     *OR
     C           WN0278    OREQ 'OTHER'                    *OR
     C           WCBZPR    ORGT .01                        *OR
      * ----- USE: Price Overage Override
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0261    PARM *ZERO     WQ0094 112       Extended Amount
     C                     PARM WN0275    WQ0095  2        U/M - Base Pric
     C                     PARM WN0280    WQ0096 112       Quantity Shippe
     C                     PARM WN0281    WQ0097 112       Weight Shipped
     C                     PARM WCBZPR    WQ0098 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * ----- USE: Unit Price-Credit
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0261    PARM *ZERO     WQ0099 112       Extended Amount
     C                     PARM WN0275    WQ0100  2        U/M - Base Pric
     C                     PARM WN0280    WQ0101 112       Quantity Shippe
     C                     PARM WN0281    WQ0102 112       Weight Shipped
     C                     PARM WCALPR    WQ0103 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * ---- USE: Unit Price-Credit
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0261    PARM *ZERO     WQ0104 112       Extended Amount
     C                     PARM WN0275    WQ0105  2        U/M - Base Pric
     C                     PARM WN0280    WQ0106 112       Quantity Shippe
     C                     PARM WN0281    WQ0107 112       Weight Shipped
     C                     PARM WCALPR    WQ0108 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * 08/28/07 PKD Replaced with Clc OrdDtl Ext Amt    XF
      * 04/28/10 PKD If Unit Price is zero, then use Unit Price-Credit.
      * ** Added Not .01 to force these orders to use Credit Chk Price.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Unit Price is Not Zeros
      *   |- c2    : PAR.Unit Price is Not .01
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0267    IFNE 0                          *IF
     C           WN0267    IFNE .01                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0261    PARM *ZERO     WQ0109 112       Extended Amount
     C                     PARM WN0275    WQ0110  2        U/M - Base Pric
     C                     PARM WN0280    WQ0111 112       Quantity Shippe
     C                     PARM WN0281    WQ0112 112       Weight Shipped
     C                     PARM WN0267    WQ0113 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Unit Price Ordered U/M
      * CASE: PAR.USR Quantity is not equal zero
     C           WN0280    IFNE 0                          *IF
     C           WN0261    DIV  WN0280    WN0269    H      Unit Price Orde
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Clc OrdDtl Ext Amt    XF - Unit of Measure  * 
     C                     CALL 'PMMMXFR'              90  Clc OrdDtl Ext
     C                     PARM *BLANK    W0RTN   7
     C           WN0261    PARM *ZERO     WQ0114 112       Extended Amount
     C                     PARM WN0275    WQ0115  2        U/M - Base Pric
     C                     PARM WN0280    WQ0116 112       Quantity Shippe
     C                     PARM WN0281    WQ0117 112       Weight Shipped
     C                     PARM WCALPR    WQ0118 114       Unit Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * *****************************************************************
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Warehouse Transfer.
      *================================================================
      * Rtv All Prc Sts/Audit  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADDWAC4NB    WL0002           Order Number
     C                     Z-ADD*ZERO     WL0003           Order Sequence
     C                     Z-ADD*ZERO     WL0004           Order Secondary
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    WN0127    P      Price Status
     C                     MOVELWL0006    WN0126    P      Price Audit
     C                     Z-ADDWL0007    WN0137           Shipping Compan
     C                     Z-ADDWL0008    WN0136           Accounting Comp
      * CLC Tot Ord Val Ship   XF - Order Detail  * 
     C                     CALL 'PDP1XFR'              90  CLC Tot Ord Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0170  30       Company Number
     C                     PARM WAC4NB    WQ0171  70       Order Number
     C           WN0130    PARM WN0130    WQ0172 112       USR Order Value
     C           WN0129    PARM WN0129    WQ0173 112       USR Order Weigh
     C           YL0009    PARM YL0009    WQ0174  1        USR Production
     C           WUR4ST    PARM WUR4ST    WQ0175  1        USR Update Flag
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDP1XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CHG Order Price/PrcAud CH - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0041           Company Number
     C                     Z-ADDWAC4NB    WL0042           Order Number
     C                     Z-ADDWN0130    WL0043           Order Value Tot
     C                     Z-ADDWN0129    WL0044           Order Weight To
     C                     Z-ADDWAEIDT    WL0045           Requested Deliv
     C                     MOVELWAU0ST    WL0046    P      Price Audit
     C                     MOVELWN0127    WL0047    P      Price Status
     C                     MOVELWAZ1ST    WL0048    P      Modified Flag
     C                     Z-ADDWN0130    WL0049           A/R order Value
     C                     EXSR SYCHRC
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           AR Customer Num
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A/R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WBMAVA           Billing Detail
     C                     Z-ADD*ZERO     WBKDVA           Billing Detail
     C                     Z-ADD*ZERO     WBL8VA           Billing Detail
     C                     Z-ADD*ZERO     WBL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WBAYVA           Extended Amount
     C                     Z-ADD*ZERO     WBEXDT           Market Pricing
     C                     Z-ADD*ZERO     WBBZPR           Price Overage O
     C                     Z-ADD*ZERO     WBL6NB           Contract Number
     C                     Z-ADD*ZERO     WBGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WBD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WBCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WBAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WBCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WBATWG           Weight Shipped
     C                     Z-ADD*ZERO     WBAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WBAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WBAKPR           Unit Price
     C                     Z-ADD*ZERO     WBALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WBAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WBAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WBA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WBB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WBA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WBNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WBNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WBNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WBNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WBNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WBBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WBBVTM           Price Code
     C                     Z-ADD*ZERO     WBBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WBBXTM           Substitution Li
     C                     Z-ADD*ZERO     WBBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WBH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WBH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WBH7NX           OD Item Target
     C                     Z-ADD*ZERO     WBH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WBH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WBDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WBDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WBDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WBDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WBDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WBGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WBGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WBGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WBPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WBRINY           Item Age Days
     C                     Z-ADD*ZERO     WBTIDT           Production Ovr
     C                     Z-ADD*ZERO     WBTJDT           Production Ovr
     C                     Z-ADD*ZERO     WBTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WBTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WBTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WER5NB           Deliver after t
     C                     Z-ADD*ZERO     WER6NB           Deliver before
     C                     Z-ADD*ZERO     WETBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WEMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WEW2NB           Co/Cust Overage
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WGBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WGBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WGBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WGBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHXXTM           Departure Time
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field Quantity Shipped Total
     C                     Z-ADD*ZERO     WUCBQT 112
      * Define work field Error Return
     C                     MOVEL*BLANK    WUWZST  5
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Price Audit
     C                     MOVEL*BLANK    WUU0ST  1
      * Define work field Price Method Type
     C                     MOVEL*BLANK    WUV8ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIRMNY           Decimal Places
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Define work field Default Commod Mark basis
     C                     MOVEL*BLANK    WULNCD  3
      * Define work field Maximum Audit Value
     C                     Z-ADD*ZERO     WUTMVA 112
      * Define work field Minimum Audit Value
     C                     Z-ADD*ZERO     WUTNVA 112
      * Define work field Commodity Price Group
     C                     MOVEL*BLANK    WULRCD  7
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field Std Weight_Head_Var_Ren
     C                     Z-ADD*ZERO     WUSWGH 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJHGCD           Item Code
     C                     Z-ADD*ZERO     WJAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WJAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WJAIWG           Unit Weight
     C                     Z-ADD*ZERO     WJCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WJC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WJURTN           Number Cases On
     C                     Z-ADD*ZERO     WJAJC8           Vendor Item Def
     C                     Z-ADD*ZERO     WJRINB           Item Structure
     C                     Z-ADD*ZERO     WJRHNB           Item Structure
     C                     Z-ADD*ZERO     WJRGNB           Item Structure
     C                     Z-ADD*ZERO     WJTFNB           Transportation
     C                     Z-ADD*ZERO     WJTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WJTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WJBLPR           Market Overage
     C                     Z-ADD*ZERO     WJBMPR           Standard Overag
     C                     Z-ADD*ZERO     WJCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WJCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WJSWGH           Std Weight_Head
     C                     Z-ADD*ZERO     WJPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WJICN1           Item Category N
     C                     Z-ADD*ZERO     WJICN2           Item Category N
     C                     Z-ADD*ZERO     WJV2NB           Item Category N
     C                     Z-ADD*ZERO     WJITCN           Item Category N
     C                     Z-ADD*ZERO     WJITC5           Item Category N
     C                     Z-ADD*ZERO     WJICN6           Item Category N
     C                     Z-ADD*ZERO     WJICN7           Item Category N
     C                     Z-ADD*ZERO     WJICN8           Item Category N
     C                     Z-ADD*ZERO     WJICN9           Item Category N
     C                     Z-ADD*ZERO     WJICN0           Item Category N
     C                     Z-ADD*ZERO     WJSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WJA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WJSJNB           Production Lead
     C                     Z-ADD*ZERO     WJSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WJSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WJSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WJCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WJCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WJILNB           Packages per ca
     C                     Z-ADD*ZERO     WJCHNB           Use_Freeze_Sell
     C                     Z-ADD*ZERO     WJCINB           PM Batch Size
     C                     Z-ADD*ZERO     WJCJNB           Package Level s
     C                     Z-ADD*ZERO     WJCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WJCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WJCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WJCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WJCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WJCWNB           PM Std LBS Man
     C                     Z-ADD*ZERO     WJCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WJCZNB           PM Formula LBS
     C                     Z-ADD*ZERO     WJC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WJB4NB           PM Raw Material
     C                     Z-ADD*ZERO     WJB5NB           PM Line Number
     C                     Z-ADD*ZERO     WJBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WJBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WJF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WJF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WJF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WJBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WJBNNB           Production Qty
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Define work field Projected Market Price
     C                     Z-ADD*ZERO     WUB8PR 114
      * Define work field Error Status  3
     C                     MOVEL*BLANK    WUTXST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKAXNB           Current Account
     C                     Z-ADD*ZERO     WKNGNB           Current Account
     C                     Z-ADD*ZERO     WKBZNB           OM Week
     C                     Z-ADD*ZERO     WKC5NB           Next Order Numb
     C                     Z-ADD*ZERO     WKC3NB           Next Invoice Nu
     C                     Z-ADD*ZERO     WKCYNB           Next Credit Mem
     C                     Z-ADD*ZERO     WKIONB           Next Charge Bac
     C                     Z-ADD*ZERO     WKI6NB           Next On Acct Ca
     C                     Z-ADD*ZERO     WKDCNB           Next Voucher Nu
     C                     Z-ADD*ZERO     WKC7NB           Next Customer #
     C                     Z-ADD*ZERO     WKC2NB           Next Inventory
     C                     Z-ADD*ZERO     WKC1NB           Next PFS Batch
     C                     Z-ADD*ZERO     WKL8NB           Next Contract/P
     C                     Z-ADD*ZERO     WKBANB           Next HPB Batch
     C                     Z-ADD*ZERO     WKAIPC           Manual Price Ac
     C                     Z-ADD*ZERO     WKASPC           CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WKA2VA           Late Charge Min
     C                     Z-ADD*ZERO     WKAADY           A/P Aging Days
     C                     Z-ADD*ZERO     WKABDY           A/P Aging Days
     C                     Z-ADD*ZERO     WKACDY           A/P Aging Days
     C                     Z-ADD*ZERO     WKADDY           A/P Aging Days
     C                     Z-ADD*ZERO     WKAEDY           A/R Aging Days
     C                     Z-ADD*ZERO     WKAFDY           A/R Aging Days
     C                     Z-ADD*ZERO     WKAGDY           A/R Aging Days
     C                     Z-ADD*ZERO     WKAHDY           A/R Aging Days
     C                     Z-ADD*ZERO     WKAENB           Retention Perio
     C                     Z-ADD*ZERO     WKALNB           Retention Perio
     C                     Z-ADD*ZERO     WKEVNB           Retention Perio
     C                     Z-ADD*ZERO     WKRPOP           Retention Perio
     C                     Z-ADD*ZERO     WKDWNB           Retention Perio
     C                     Z-ADD*ZERO     WKR3NB           Next Load ID
     C                     Z-ADD*ZERO     WKR4NB           Next Item Numbe
     C                     Z-ADD*ZERO     WKSCNB           Production Numb
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field USR Date Priced
     C                     Z-ADD*ZERO     WUE7DT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLEQDT           Market Price Da
     C                     Z-ADD*ZERO     WLA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WLB8PR           Projected Marke
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Define work field USR Sequence Num. New ATR
     C                     Z-ADD*ZERO     WUQQNB  30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMC4NB           Order Number
     C                     Z-ADD*ZERO     WMDPNB           Order Sequence
     C                     Z-ADD*ZERO     WMUENB           Order Secondary
     C                     Z-ADD*ZERO     WMASNO           Audit Sequence
     C                     Z-ADD*ZERO     WMHGCD           Item Code
     C                     Z-ADD*ZERO     WMAYVA           Extended Amount
     C                     Z-ADD*ZERO     WMYJVA           Extended Amount
     C                     Z-ADD*ZERO     WMAKPR           Unit Price
     C                     Z-ADD*ZERO     WMDBPR           Unit Price Last
     C                     Z-ADD*ZERO     WMALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WMDCPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Clear all neither parameters
      * CRT Price Change Audit CR - PD Price Change Audit Log  * 
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Define work field Affect Inventory Default
     C                     MOVEL*BLANK    WUOEST  1
      * Define work field Affect Sales Doll Default
     C                     MOVEL*BLANK    WUOFST  1
      * Define work field Affect Sales Pnds Default
     C                     MOVEL*BLANK    WUVBST  1
      * Define work field Affect Brokerage Default
     C                     MOVEL*BLANK    WUPYST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Define work field Order Value Total
     C                     Z-ADD*ZERO     WUJZVA 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WTAIC3           Company Number
     C                     Z-ADD*ZERO     WTANC7           AR Customer Num
     C                     Z-ADD*ZERO     WTAGVA           Age $ Due - Cur
     C                     Z-ADD*ZERO     WTACVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WTADVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WTAEVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WTAFVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WTAHVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WTVIVA           Age $ Due-Curre
     C                     Z-ADD*ZERO     WTVJVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WTVKVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WTVLVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WTVMVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WTVNVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WTEEVA           Value of Open O
     C                     Z-ADD*ZERO     WTAKTM           Time of Last Ag
     C                     Z-ADD*ZERO     WTAHDT           Date of First S
     C                     Z-ADD*ZERO     WTANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WTANVA           Amount of Last
     C                     Z-ADD*ZERO     WTALDT           Date of Last Pa
     C                     Z-ADD*ZERO     WTAMVA           Amount of Last
     C                     Z-ADD*ZERO     WTAIDT           Date of Highest
     C                     Z-ADD*ZERO     WTALVA           Amount of Highe
     C                     Z-ADD*ZERO     WTDJNB           Number of Invoi
     C                     Z-ADD*ZERO     WTDLNB           Number of Order
     C                     Z-ADD*ZERO     WTDDNB           Number of Credi
     C                     Z-ADD*ZERO     WTDMNB           Number of Payme
     C                     Z-ADD*ZERO     WTDUDT           Date of Last Ag
     C                     Z-ADD*ZERO     WTLYNO           Last YTD Nbr of
     C                     Z-ADD*ZERO     WTLYNC           Last YTD Nbr of
     C                     Z-ADD*ZERO     WTLYNP           Last YTD Nbr of
     C                     Z-ADD*ZERO     WTLYNI           Last YTD Nbr of
     C                     Z-ADD*ZERO     WTADPM           MTD Invoices Pa
     C                     Z-ADD*ZERO     WTVOVA           YTD Invoices Pa
     C                     Z-ADD*ZERO     WTBTDY           MTD Days Paid
     C                     Z-ADD*ZERO     WTBUDY           YTD Days Paid
     C                     Z-ADD*ZERO     WTVPVA           YTD Sales Invoi
     C                     Z-ADD*ZERO     WTVQVA           Last Year Sales
     C                     Z-ADD*ZERO     WTCUMO           Current Month
     C                     Z-ADD*ZERO     WTAATM           Job Time
     C                     Z-ADD*ZERO     WTAXDT           Job Date
      * Clear all neither parameters
      * CRT A/R Summary        CR - A/R Summary  * 
     C                     Z-ADD*ZERO     WVAATM           Job Time
     C                     Z-ADD*ZERO     WVAXDT           Job Date
      * Define work field USR Update Flag
     C                     MOVEL*BLANK    WUR4ST  1
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Total Load Order Weight
     C                     Z-ADD*ZERO     WURPNB  70
      * Define work field Total Freight
     C                     Z-ADD*ZERO     WURQNB 112
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB02 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB00 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  30
     C                     MOVEL*BLANK    WL0005  1
     C                     MOVEL*BLANK    WL0006  1
     C                     Z-ADD*ZERO     WL0007  30
     C                     Z-ADD*ZERO     WL0008  30
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0009  30
     C                     MOVEL*BLANK    WL0010  1
     C                     MOVEL*BLANK    WL0011  1
      * Define local variables for subroutine SKCHRC.
     C                     Z-ADD*ZERO     WL0012  30
     C                     Z-ADD*ZERO     WL0013  70
     C                     Z-ADD*ZERO     WL0014  30
     C                     Z-ADD*ZERO     WL0015  30
     C                     Z-ADD*ZERO     WL0016 112
     C                     Z-ADD*ZERO     WL0017 112
     C                     MOVEL*BLANK    WL0018  1
     C                     Z-ADD*ZERO     WL0019  70
     C                     MOVEL*BLANK    WL0020  1
     C                     MOVEL*BLANK    WL0021  3
     C                     Z-ADD*ZERO     WL0022 114
     C                     Z-ADD*ZERO     WL0023 114
     C                     Z-ADD*ZERO     WL0024 114
     C                     Z-ADD*ZERO     WL0025 112
     C                     Z-ADD*ZERO     WL0026  70
     C                     MOVEL*BLANK    WL0027  1
     C                     MOVEL*BLANK    WL0028  1
     C                     MOVEL*BLANK    WL0029  1
      * Define local variables for subroutine SPRVGN.
     C                     Z-ADD*ZERO     WL0030  30
     C                     Z-ADD*ZERO     WL0031  52
     C                     Z-ADD*ZERO     WL0032  52
      * Define local variables for subroutine SQRVGN.
     C                     MOVEL*BLANK    WL0033  3
     C                     MOVEL*BLANK    WL0034  7
     C                     Z-ADD*ZERO     WL0035  70
     C                     Z-ADD*ZERO     WL0036 114
     C                     Z-ADD*ZERO     WL0037  70
      * Define local variables for subroutine SVRVGN.
     C                     Z-ADD*ZERO     WL0038  30
     C                     Z-ADD*ZERO     WL0039  70
     C                     Z-ADD*ZERO     WL0040 112
      * Define local variables for subroutine SYCHRC.
     C                     Z-ADD*ZERO     WL0041  30
     C                     Z-ADD*ZERO     WL0042  70
     C                     Z-ADD*ZERO     WL0043 112
     C                     Z-ADD*ZERO     WL0044 112
     C                     Z-ADD*ZERO     WL0045  70
     C                     MOVEL*BLANK    WL0046  1
     C                     MOVEL*BLANK    WL0047  1
     C                     MOVEL*BLANK    WL0048  1
     C                     Z-ADD*ZERO     WL0049 112
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Order Gate/Final Price
     C                     Z-ADD*ZERO     YL0002 114
      * Define local work field Status Flag 1  Y/N
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field OD Gate/Final Price Adj
     C                     Z-ADD*ZERO     YL0004 114
      * Define local work field OD Weighted Avg Price
     C                     Z-ADD*ZERO     YL0005 114
      * Define local work field Display Flag
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Order Value Total
     C                     Z-ADD*ZERO     YL0007 112
      * Define local work field Order Weight Total
     C                     Z-ADD*ZERO     YL0008 112
      * Define local work field Production Hold
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field USR New Order
     C                     MOVEL*BLANK    YL0010  4
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field UOM Pricing
     C                     MOVEL*BLANK    YN0002  2
      * Define null work field Unit Weight
     C                     Z-ADD*ZERO     YN0003 112
      * Define null work field Catch Weight Status
     C                     MOVEL*BLANK    YN0004  1
      * Define local work field Price Method Type
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field PMH Price Type
     C                     MOVEL*BLANK    YL0012  1
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0005  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0013  1
      * Define local work field Decimal Places Rounded
     C                     Z-ADD*ZERO     YL0014  20
      * Define local work field PMH Price Type
     C                     MOVEL*BLANK    YL0015  1
      * Define local work field Default Commod Mark basis
     C                     MOVEL*BLANK    YL0016  3
      * Define local work field Market Overage
     C                     Z-ADD*ZERO     YL0017 114
      * Define local work field Standard Overage_Underage
     C                     Z-ADD*ZERO     YL0018 114
      * Define local work field Commodity Price Group
     C                     MOVEL*BLANK    YL0019  7
      * Define local work field Primal Group Code
     C                     MOVEL*BLANK    YL0020  6
      * Define local work field Type Code
     C                     MOVEL*BLANK    YL0021  2
      * Define null work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YN0006  52
      * Define local work field Minimum Price   USR
     C                     Z-ADD*ZERO     YL0022 114
      * Define local work field Maximum Price  USR
     C                     Z-ADD*ZERO     YL0023 114
      * Define local work field Price Audit
     C                     MOVEL*BLANK    YL0024  1
      * Define null work field UOM Pricing
     C                     MOVEL*BLANK    YN0007  2
      * Define null work field Unit Weight
     C                     Z-ADD*ZERO     YN0008 112
      * Define null work field Catch Weight Status
     C                     MOVEL*BLANK    YN0009  1
      *================================================================
     CSR         ZZEXIT    ENDSR
