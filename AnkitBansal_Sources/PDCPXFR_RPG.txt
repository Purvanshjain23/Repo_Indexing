     H/TITLE UPD ATS Order DeAlloc  XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     W* Warning: This program does not set on the LR indicator
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJMIST
     H* Date          : 07/10/24  Time  : 00:43:45
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDKNCPL8IF  E           K        DISK
      * RSQ : Order Detail Schedule     Co/Ord/Seq/Ssq/PDte(d)
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse Codes           Active records only
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FPDJCCPL1IF  E           K        DISK
      * RTV : PS Prod Schedule          Retrieval index
      *
     FPDI8CPL1IF  E           K        DISK
      * RTV : PS Prod Item Schedule     Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar Master           Retrieval index       NV
      *
     FOPBFCPLOIF  E           K        DISK
      * RSQ : Order Header TRG          Ord-D/Co
      *
     FPOB6CPL3IF  E           K        DISK
      * RSQ : Order Detail Sched_Consmd Co/Ord/PrdDt/Cns/Itm/Seq
      *
     FPOB6CPL1IF  E           K        DISK
      * RTV : Order Detail Sched_Consmd Retrieval index
      *
     FPDIORELKIF  E           K        DISK
      * RSQ : Item Bill Of Material     Co/Item/CItem StrWgtYld
      *
     FPOB5CPL2IF  E           K        DISK
      * RSQ : Order Detail Sched_Inv    Co/Ord/Seq/Seq2/PDte(d)
      *
     FPDKNCPL1IF  E           K        DISK
      * RTV : Order Detail Schedule     Retrieval index
      *
     FPDKNCPL0UF  E           K        DISK                      A
      * UPD : Order Detail Schedule     Update index
      *
     FPDI8CPL0UF  E           K        DISK                      A
      * UPD : PS Prod Item Schedule     Update index
      *
     FPOB6CPL0UF  E           K        DISK                      A
      * UPD : Order Detail Sched_Consmd Update index
      *
     FPOB5CPL0UF  E           K        DISK
      * UPD : Order Detail Sched_Inv    Update index
      *
     I@KNCPM6
      * Order Detail Schedule     Co/Ord/Seq/Ssq/PDte(d)
      * Renamed input format fields
     I              KNAIC3                          WAAIC3
     I              KNC4NB                          WAC4NB
     I              KNDPNB                          WADPNB
     I              KNUENB                          WAUENB
     I              KNJGDT                          WAJGDT
     I              KNAODT                          WAAODT
     I              KNAJCD                          WAAJCD
     I              KNAYAA                          WAAYAA
     I              KNHGCD                          WAHGCD
     I              KNIGQT                          WAIGQT
     I              KNFLWG                          WAFLWG
     I              KNIUQT                          WAIUQT
     I              KNF3WG                          WAF3WG
     I              KNIVQT                          WAIVQT
     I              KNF4WG                          WAF4WG
     I              KNP7ST                          WAP7ST
     I              KNP8ST                          WAP8ST
     I              KNQAST                          WAQAST
     I              KNUVST                          WAUVST
     I              KNUWST                          WAUWST
     I              KNUXST                          WAUXST
     I              KNVSST                          WAVSST
     I              KNAATM                          WAAATM
     I              KNAYNA                          WAAYNA
     I              KNA0NA                          WAA0NA
     I              KNAXDT                          WAAXDT
      *
     I@ADRET1
      * Warehouse Codes           Active records only
      * Renamed input format fields
     I              ADAJCD                          WBAJCD
     I              ADF8NA                          WBF8NA
     I              ADACNA                          WBACNA
     I              ADADNA                          WBADNA
     I              ADAENA                          WBAENA
     I              ADAJNA                          WBAJNA
     I              ADBTTX                          WBBTTX
     I              ADAOCD                          WBAOCD
     I              ADBGCD                          WBBGCD
     I              ADVHST                          WBVHST
     I              ADMPNA                          WBMPNA
     I              ADWPST                          WBWPST
     I              ADXUST                          WBXUST
     I              ADT0ST                          WBT0ST
     I              ADT1ST                          WBT1ST
     I              ADDBNB                          WBDBNB
     I              ADT2ST                          WBT2ST
     I              ADT3ST                          WBT3ST
     I              ADT4ST                          WBT4ST
     I              ADT6ST                          WBT6ST
     I              ADBWC3                          WBBWC3
     I              ADBTC3                          WBBTC3
     I              ADBUC3                          WBBUC3
     I              ADBVC3                          WBBVC3
     I              ADFCAA                          WBFCAA
     I              ADRQSX                          WBRQSX
     I              ADRRSX                          WBRRSX
     I              ADRSSX                          WBRSSX
     I              ADRTSX                          WBRTSX
     I              ADT7ST                          WBT7ST
     I              ADT8ST                          WBT8ST
     I              ADRNSX                          WBRNSX
     I              ADROSX                          WBROSX
     I              ADRPSX                          WBRPSX
     I              ADUVST                          WBUVST
     I              ADUWST                          WBUWST
     I              ADUXST                          WBUXST
     I              ADVSST                          WBVSST
     I              ADAATM                          WBAATM
     I              ADAYNA                          WBAYNA
     I              ADA0NA                          WBA0NA
     I              ADAXDT                          WBAXDT
      *
     I@ADREAO
      * Warehouse Codes           Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WCAJCD
     I              ADF8NA                          WCF8NA
     I              ADACNA                          WCACNA
     I              ADADNA                          WCADNA
     I              ADAENA                          WCAENA
     I              ADAJNA                          WCAJNA
     I              ADBTTX                          WCBTTX
     I              ADAOCD                          WCAOCD
     I              ADBGCD                          WCBGCD
     I              ADVHST                          WCVHST
     I              ADMPNA                          WCMPNA
     I              ADWPST                          WCWPST
     I              ADXUST                          WCXUST
     I              ADT0ST                          WCT0ST
     I              ADT1ST                          WCT1ST
     I              ADDBNB                          WCDBNB
     I              ADT2ST                          WCT2ST
     I              ADT3ST                          WCT3ST
     I              ADT4ST                          WCT4ST
     I              ADT6ST                          WCT6ST
     I              ADBWC3                          WCBWC3
     I              ADBTC3                          WCBTC3
     I              ADBUC3                          WCBUC3
     I              ADBVC3                          WCBVC3
     I              ADFCAA                          WCFCAA
     I              ADRQSX                          WCRQSX
     I              ADRRSX                          WCRRSX
     I              ADRSSX                          WCRSSX
     I              ADRTSX                          WCRTSX
     I              ADT7ST                          WCT7ST
     I              ADT8ST                          WCT8ST
     I              ADRNSX                          WCRNSX
     I              ADROSX                          WCROSX
     I              ADRPSX                          WCRPSX
     I              ADUVST                          WCUVST
     I              ADUWST                          WCUWST
     I              ADUXST                          WCUXST
     I              ADVSST                          WCVSST
     I              ADAATM                          WCAATM
     I              ADAYNA                          WCAYNA
     I              ADA0NA                          WCA0NA
     I              ADAXDT                          WCAXDT
      *
     I@JCCPVC
      * PS Prod Schedule          Retrieval index
      * Renamed input format fields
     I              JCAIC3                          WDAIC3
     I              JCV5ST                          WDV5ST
     I              JCELDT                          WDELDT
     I              JCHVHD                          WDHVHD
     I              JCZ6NB                          WDZ6NB
     I              JCZ7NB                          WDZ7NB
     I              JCDGPC                          WDDGPC
     I              JCAVCW                          WDAVCW
     I              JCDIPC                          WDDIPC
     I              JCZ0NB                          WDZ0NB
     I              JCAVLE                          WDAVLE
     I              JCECWG                          WDECWG
     I              JCUVST                          WDUVST
     I              JCUWST                          WDUWST
     I              JCUXST                          WDUXST
     I              JCVSST                          WDVSST
     I              JCAATM                          WDAATM
     I              JCAYNA                          WDAYNA
     I              JCA0NA                          WDA0NA
     I              JCAXDT                          WDAXDT
      *
     I@KNCPHN
      * Order Detail Schedule     Update index
      * Renamed input format fields
     I              KNAIC3                          WEAIC3
     I              KNC4NB                          WEC4NB
     I              KNDPNB                          WEDPNB
     I              KNUENB                          WEUENB
     I              KNJGDT                          WEJGDT
     I              KNAODT                          WEAODT
     I              KNAJCD                          WEAJCD
     I              KNAYAA                          WEAYAA
     I              KNHGCD                          WEHGCD
     I              KNIGQT                          WEIGQT
     I              KNFLWG                          WEFLWG
     I              KNIUQT                          WEIUQT
     I              KNF3WG                          WEF3WG
     I              KNIVQT                          WEIVQT
     I              KNF4WG                          WEF4WG
     I              KNP7ST                          WEP7ST
     I              KNP8ST                          WEP8ST
     I              KNQAST                          WEQAST
     I              KNUVST                          WEUVST
     I              KNUWST                          WEUWST
     I              KNUXST                          WEUXST
     I              KNVSST                          WEVSST
     I              KNAATM                          WEAATM
     I              KNAYNA                          WEAYNA
     I              KNA0NA                          WEA0NA
     I              KNAXDT                          WEAXDT
      *
     I@I8CPUS
      * PS Prod Item Schedule     Retrieval index
      * Renamed input format fields
     I              I8AIC3                          WFAIC3
     I              I8V5ST                          WFV5ST
     I              I8ELDT                          WFELDT
     I              I8HGCD                          WFHGCD
     I              I8AJCD                          WFAJCD
     I              I8GPDT                          WFGPDT
     I              I8WTSP                          WFWTSP
     I              I8QTSP                          WFQTSP
     I              I8DJPC                          WFDJPC
     I              I8F8WG                          WFF8WG
     I              I8WTIN                          WFWTIN
     I              I8D5NB                          WFD5NB
     I              I8DXWG                          WFDXWG
     I              I8B2NB                          WFB2NB
     I              I8WTCN                          WFWTCN
     I              I8PSCV                          WFPSCV
     I              I8SAWT                          WFSAWT
     I              I8B9NB                          WFB9NB
     I              I8D1WG                          WFD1WG
     I              I8CBNB                          WFCBNB
     I              I8EZWG                          WFEZWG
     I              I8CCNB                          WFCCNB
     I              I8E0WG                          WFE0WG
     I              I8D6NB                          WFD6NB
     I              I8OAWT                          WFOAWT
     I              I8CDNB                          WFCDNB
     I              I8UNW2                          WFUNW2
     I              I8CENB                          WFCENB
     I              I8F9WG                          WFF9WG
     I              I8BPNB                          WFBPNB
     I              I8GAWG                          WFGAWG
     I              I8BQNB                          WFBQNB
     I              I8GBWG                          WFGBWG
     I              I8BRNB                          WFBRNB
     I              I8GCWG                          WFGCWG
     I              I8BSNB                          WFBSNB
     I              I8GDWG                          WFGDWG
     I              I8BWNB                          WFBWNB
     I              I8GEWG                          WFGEWG
     I              I8PS6U                          WFPS6U
     I              I8WCST                          WFWCST
     I              I8WPST                          WFWPST
     I              I8B5ST                          WFB5ST
     I              I8TFST                          WFTFST
     I              I8TEST                          WFTEST
     I              I8THST                          WFTHST
     I              I8UDST                          WFUDST
     I              I8UFST                          WFUFST
     I              I8UGST                          WFUGST
     I              I8UHST                          WFUHST
     I              I8B6ST                          WFB6ST
     I              I8B7ST                          WFB7ST
     I              I8DVWG                          WFDVWG
     I              I8D7NB                          WFD7NB
     I              I8FCAD                          WFFCAD
     I              I8D9NB                          WFD9NB
     I              I8DWWG                          WFDWWG
     I              I8EANB                          WFEANB
     I              I8SHWT                          WFSHWT
     I              I8EBNB                          WFEBNB
     I              I8AVWT                          WFAVWT
     I              I8ECNB                          WFECNB
     I              I8WTON                          WFWTON
     I              I8EDNB                          WFEDNB
     I              I8FNWT                          WFFNWT
     I              I8EENB                          WFEENB
     I              I8QTAS                          WFQTAS
     I              I8EFNB                          WFEFNB
     I              I8WAIO                          WFWAIO
     I              I8EGNB                          WFEGNB
     I              I8R3CD                          WFR3CD
     I              I8RGNB                          WFRGNB
     I              I8RHNB                          WFRHNB
     I              I8RINB                          WFRINB
     I              I8XRCD                          WFXRCD
     I              I8UVST                          WFUVST
     I              I8UWST                          WFUWST
     I              I8UXST                          WFUXST
     I              I8VSST                          WFVSST
     I              I8AATM                          WFAATM
     I              I8AYNA                          WFAYNA
     I              I8A0NA                          WFA0NA
     I              I8AXDT                          WFAXDT
      *
     I@I8CPUR
      * PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WGAIC3
     I              I8V5ST                          WGV5ST
     I              I8ELDT                          WGELDT
     I              I8HGCD                          WGHGCD
     I              I8AJCD                          WGAJCD
     I              I8GPDT                          WGGPDT
     I              I8WTSP                          WGWTSP
     I              I8QTSP                          WGQTSP
     I              I8DJPC                          WGDJPC
     I              I8F8WG                          WGF8WG
     I              I8WTIN                          WGWTIN
     I              I8D5NB                          WGD5NB
     I              I8DXWG                          WGDXWG
     I              I8B2NB                          WGB2NB
     I              I8WTCN                          WGWTCN
     I              I8PSCV                          WGPSCV
     I              I8SAWT                          WGSAWT
     I              I8B9NB                          WGB9NB
     I              I8D1WG                          WGD1WG
     I              I8CBNB                          WGCBNB
     I              I8EZWG                          WGEZWG
     I              I8CCNB                          WGCCNB
     I              I8E0WG                          WGE0WG
     I              I8D6NB                          WGD6NB
     I              I8OAWT                          WGOAWT
     I              I8CDNB                          WGCDNB
     I              I8UNW2                          WGUNW2
     I              I8CENB                          WGCENB
     I              I8F9WG                          WGF9WG
     I              I8BPNB                          WGBPNB
     I              I8GAWG                          WGGAWG
     I              I8BQNB                          WGBQNB
     I              I8GBWG                          WGGBWG
     I              I8BRNB                          WGBRNB
     I              I8GCWG                          WGGCWG
     I              I8BSNB                          WGBSNB
     I              I8GDWG                          WGGDWG
     I              I8BWNB                          WGBWNB
     I              I8GEWG                          WGGEWG
     I              I8PS6U                          WGPS6U
     I              I8WCST                          WGWCST
     I              I8WPST                          WGWPST
     I              I8B5ST                          WGB5ST
     I              I8TFST                          WGTFST
     I              I8TEST                          WGTEST
     I              I8THST                          WGTHST
     I              I8UDST                          WGUDST
     I              I8UFST                          WGUFST
     I              I8UGST                          WGUGST
     I              I8UHST                          WGUHST
     I              I8B6ST                          WGB6ST
     I              I8B7ST                          WGB7ST
     I              I8DVWG                          WGDVWG
     I              I8D7NB                          WGD7NB
     I              I8FCAD                          WGFCAD
     I              I8D9NB                          WGD9NB
     I              I8DWWG                          WGDWWG
     I              I8EANB                          WGEANB
     I              I8SHWT                          WGSHWT
     I              I8EBNB                          WGEBNB
     I              I8AVWT                          WGAVWT
     I              I8ECNB                          WGECNB
     I              I8WTON                          WGWTON
     I              I8EDNB                          WGEDNB
     I              I8FNWT                          WGFNWT
     I              I8EENB                          WGEENB
     I              I8QTAS                          WGQTAS
     I              I8EFNB                          WGEFNB
     I              I8WAIO                          WGWAIO
     I              I8EGNB                          WGEGNB
     I              I8R3CD                          WGR3CD
     I              I8RGNB                          WGRGNB
     I              I8RHNB                          WGRHNB
     I              I8RINB                          WGRINB
     I              I8XRCD                          WGXRCD
     I              I8UVST                          WGUVST
     I              I8UWST                          WGUWST
     I              I8UXST                          WGUXST
     I              I8VSST                          WGVSST
     I              I8AATM                          WGAATM
     I              I8AYNA                          WGAYNA
     I              I8A0NA                          WGA0NA
     I              I8AXDT                          WGAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WHAIC3
     I              BZHGCD                          WHHGCD
     I              BZAVNA                          WHAVNA
     I              BZAWNA                          WHAWNA
     I              BZL7NA                          WHL7NA
     I              BZL8NA                          WHL8NA
     I              BZL6NA                          WHL6NA
     I              BZMFNA                          WHMFNA
     I              BZADCD                          WHADCD
     I              BZAWPC                          WHAWPC
     I              BZLXST                          WHLXST
     I              BZAECD                          WHAECD
     I              BZAXPC                          WHAXPC
     I              BZLYST                          WHLYST
     I              BZAFCD                          WHAFCD
     I              BZAICD                          WHAICD
     I              BZAIWG                          WHAIWG
     I              BZHICD                          WHHICD
     I              BZRBCD                          WHRBCD
     I              BZFZST                          WHFZST
     I              BZAVST                          WHAVST
     I              BZCZWG                          WHCZWG
     I              BZC0WG                          WHC0WG
     I              BZURTN                          WHURTN
     I              BZAJC8                          WHAJC8
     I              BZRINB                          WHRINB
     I              BZRHNB                          WHRHNB
     I              BZRGNB                          WHRGNB
     I              BZLNCD                          WHLNCD
     I              BZTFNB                          WHTFNB
     I              BZN0CD                          WHN0CD
     I              BZX4ST                          WHX4ST
     I              BZTMVA                          WHTMVA
     I              BZTNVA                          WHTNVA
     I              BZBLPR                          WHBLPR
     I              BZBMPR                          WHBMPR
     I              BZLRCD                          WHLRCD
     I              BZU9ST                          WHU9ST
     I              BZCMCO                          WHCMCO
     I              BZQ1CD                          WHQ1CD
     I              BZQ8CD                          WHQ8CD
     I              BZCHTM                          WHCHTM
     I              BZQZCD                          WHQZCD
     I              BZXWST                          WHXWST
     I              BZXXST                          WHXXST
     I              BZVMST                          WHVMST
     I              BZSWGH                          WHSWGH
     I              BZPPHE                          WHPPHE
     I              BZR3CD                          WHR3CD
     I              BZSDCD                          WHSDCD
     I              BZICN1                          WHICN1
     I              BZSVCD                          WHSVCD
     I              BZICN2                          WHICN2
     I              BZSWCD                          WHSWCD
     I              BZV2NB                          WHV2NB
     I              BZSXCD                          WHSXCD
     I              BZITCN                          WHITCN
     I              BZSYCD                          WHSYCD
     I              BZITC5                          WHITC5
     I              BZSZCD                          WHSZCD
     I              BZICN6                          WHICN6
     I              BZS0CD                          WHS0CD
     I              BZICN7                          WHICN7
     I              BZS1CD                          WHS1CD
     I              BZICN8                          WHICN8
     I              BZS2CD                          WHS2CD
     I              BZICN9                          WHICN9
     I              BZS3CD                          WHS3CD
     I              BZICN0                          WHICN0
     I              BZS4CD                          WHS4CD
     I              BZSFNB                          WHSFNB
     I              BZA3WG                          WHA3WG
     I              BZSJNB                          WHSJNB
     I              BZLLCD                          WHLLCD
     I              BZLMCD                          WHLMCD
     I              BZP3ST                          WHP3ST
     I              BZSKNB                          WHSKNB
     I              BZSLNB                          WHSLNB
     I              BZSMNB                          WHSMNB
     I              BZP4ST                          WHP4ST
     I              BZCFNB                          WHCFNB
     I              BZCGNB                          WHCGNB
     I              BZILNB                          WHILNB
     I              BZCHNB                          WHCHNB
     I              BZCINB                          WHCINB
     I              BZCJNB                          WHCJNB
     I              BZCMNB                          WHCMNB
     I              BZCNNB                          WHCNNB
     I              BZCRNB                          WHCRNB
     I              BZCSNB                          WHCSNB
     I              BZCVNB                          WHCVNB
     I              BZCWNB                          WHCWNB
     I              BZCXNB                          WHCXNB
     I              BZCZNB                          WHCZNB
     I              BZC0NB                          WHC0NB
     I              BZN1CD                          WHN1CD
     I              BZB4NB                          WHB4NB
     I              BZB5NB                          WHB5NB
     I              BZX5ST                          WHX5ST
     I              BZX6ST                          WHX6ST
     I              BZX7ST                          WHX7ST
     I              BZPCCT                          WHPCCT
     I              BZBDNB                          WHBDNB
     I              BZBJNB                          WHBJNB
     I              BZSUST                          WHSUST
     I              BZSVST                          WHSVST
     I              BZSYST                          WHSYST
     I              BZSZST                          WHSZST
     I              BZS1ST                          WHS1ST
     I              BZXRCD                          WHXRCD
     I              BZXTCD                          WHXTCD
     I              BZXUCD                          WHXUCD
     I              BZF5WG                          WHF5WG
     I              BZF6WG                          WHF6WG
     I              BZF7WG                          WHF7WG
     I              BZBLNB                          WHBLNB
     I              BZBNNB                          WHBNNB
     I              BZS2ST                          WHS2ST
     I              BZS4ST                          WHS4ST
     I              BZS5ST                          WHS5ST
     I              BZS6ST                          WHS6ST
     I              BZS8ST                          WHS8ST
     I              BZS9ST                          WHS9ST
     I              BZTCST                          WHTCST
     I              BZTDST                          WHTDST
     I              BZUVST                          WHUVST
     I              BZUWST                          WHUWST
     I              BZUXST                          WHUXST
     I              BZVSST                          WHVSST
     I              BZAATM                          WHAATM
     I              BZAYNA                          WHAYNA
     I              BZA0NA                          WHA0NA
     I              BZAXDT                          WHAXDT
      *
     I@AFREBE
      * Calendar Master           Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WIAIC3
     I              AFBCDT                          WIBCDT
     I              AFCQNB                          WICQNB
     I              AFESNB                          WIESNB
     I              AFETNB                          WIETNB
     I              AFBZNB                          WIBZNB
     I              AFA9ST                          WIA9ST
     I              AFEINB                          WIEINB
     I              AFC5ST                          WIC5ST
     I              AFAQNB                          WIAQNB
     I              AFCMST                          WICMST
     I              AFV9ST                          WIV9ST
     I              AFWAST                          WIWAST
     I              AFX2ST                          WIX2ST
     I              AFOJDT                          WIOJDT
     I              AFNQNX                          WINQNX
     I              AFNRNX                          WINRNX
     I              AFI9SX                          WII9SX
     I              AFJASX                          WIJASX
     I              AFOKDT                          WIOKDT
     I              AFOLDT                          WIOLDT
     I              AFUVST                          WIUVST
     I              AFUWST                          WIUWST
     I              AFUXST                          WIUXST
     I              AFAATM                          WIAATM
     I              AFAYNA                          WIAYNA
     I              AFA0NA                          WIA0NA
     I              AFAXDT                          WIAXDT
      *
     I@BFCPY2
      * Order Header TRG          Ord-D/Co
      * Renamed input format fields
     I              BEAIC3                          WJAIC3
     I              BEC4NB                          WJC4NB
     I              BEJNCD                          WJJNCD
     I              BEANC7                          WJANC7
     I              BEBKC7                          WJBKC7
     I              BEBRTX                          WJBRTX
     I              BEHMNA                          WJHMNA
     I              BEHONA                          WJHONA
     I              BEHPNA                          WJHPNA
     I              BEHNNA                          WJHNNA
     I              BEDBCD                          WJDBCD
     I              BECKTX                          WJCKTX
     I              BEB0C7                          WJB0C7
     I              BEAETX                          WJAETX
     I              BEB1NA                          WJB1NA
     I              BEB3NA                          WJB3NA
     I              BEB4NA                          WJB4NA
     I              BEB2NA                          WJB2NA
     I              BEBHCD                          WJBHCD
     I              BEC8TX                          WJC8TX
     I              BEBCNA                          WJBCNA
     I              BEA0DT                          WJA0DT
     I              BEA5DT                          WJA5DT
     I              BEGNDT                          WJGNDT
     I              BEACDT                          WJACDT
     I              BEAQCD                          WJAQCD
     I              BEB6NA                          WJB6NA
     I              BEBYNA                          WJBYNA
     I              BEBZNA                          WJBZNA
     I              BEGTST                          WJGTST
     I              BEGVST                          WJGVST
     I              BEGUST                          WJGUST
     I              BEQFST                          WJQFST
     I              BECQCD                          WJCQCD
     I              BEGJST                          WJGJST
     I              BEGWST                          WJGWST
     I              BEGXST                          WJGXST
     I              BEGYST                          WJGYST
     I              BEAODT                          WJAODT
     I              BEAIVN                          WJAIVN
     I              BECXDT                          WJCXDT
     I              BEJZVA                          WJJZVA
     I              BEA1WG                          WJA1WG
     I              BEXIST                          WJXIST
     I              BEXJST                          WJXJST
     I              BEXKST                          WJXKST
     I              BEEIDT                          WJEIDT
     I              BEAFTM                          WJAFTM
     I              BEE8CD                          WJE8CD
     I              BEE9CD                          WJE9CD
     I              BERMNB                          WJRMNB
     I              BETBNB                          WJTBNB
     I              BER1NB                          WJR1NB
     I              BEPJST                          WJPJST
     I              BEU0ST                          WJU0ST
     I              BEU1ST                          WJU1ST
     I              BEQ2CD                          WJQ2CD
     I              BEU2ST                          WJU2ST
     I              BEVEST                          WJVEST
     I              BEVFST                          WJVFST
     I              BEVGST                          WJVGST
     I              BERPCD                          WJRPCD
     I              BERNNB                          WJRNNB
     I              BEVDST                          WJVDST
     I              BEATIN                          WJATIN
     I              BEU4ST                          WJU4ST
     I              BEU5ST                          WJU5ST
     I              BERSRN                          WJRSRN
     I              BEMHNA                          WJMHNA
     I              BEMINA                          WJMINA
     I              BEWBST                          WJWBST
     I              BER4CD                          WJR4CD
     I              BEBFCD                          WJBFCD
     I              BEQ4CD                          WJQ4CD
     I              BET3NB                          WJT3NB
     I              BESICD                          WJSICD
     I              BECONB                          WJCONB
     I              BECEST                          WJCEST
     I              BEAWDT                          WJAWDT
     I              BEJPCD                          WJJPCD
     I              BEXUST                          WJXUST
     I              BEZ1ST                          WJZ1ST
     I              BEVRVA                          WJVRVA
     I              BEOBST                          WJOBST
     I              BEBCST                          WJBCST
     I              BEBDST                          WJBDST
     I              BEB7VL                          WJB7VL
     I              BEGASX                          WJGASX
     I              BEGBSX                          WJGBSX
     I              BEGCSX                          WJGCSX
     I              BEGDSX                          WJGDSX
     I              BEFNSX                          WJFNSX
     I              BEFOSX                          WJFOSX
     I              BEFPSX                          WJFPSX
     I              BEFQSX                          WJFQSX
     I              BEFRSX                          WJFRSX
     I              BEFSSX                          WJFSSX
     I              BEFTSX                          WJFTSX
     I              BEFUSX                          WJFUSX
     I              BEFVSX                          WJFVSX
     I              BEFWSX                          WJFWSX
     I              BEFXSX                          WJFXSX
     I              BEFYSX                          WJFYSX
     I              BENODT                          WJNODT
     I              BENPDT                          WJNPDT
     I              BENQDT                          WJNQDT
     I              BENRDT                          WJNRDT
     I              BENSDT                          WJNSDT
     I              BEBPTM                          WJBPTM
     I              BEBQTM                          WJBQTM
     I              BEBRTM                          WJBRTM
     I              BEBSTM                          WJBSTM
     I              BEBTTM                          WJBTTM
     I              BEH0NX                          WJH0NX
     I              BEH1NX                          WJH1NX
     I              BEH2NX                          WJH2NX
     I              BEH3NX                          WJH3NX
     I              BEH4NX                          WJH4NX
     I              BEC0C7                          WJC0C7
     I              BEUVST                          WJUVST
     I              BEUWST                          WJUWST
     I              BEUXST                          WJUXST
     I              BEAATM                          WJAATM
     I              BEAYNA                          WJAYNA
     I              BEA0NA                          WJA0NA
     I              BEAXDT                          WJAXDT
      *
     I@B6CPAG
      * Order Detail Sched_Consmd Co/Ord/PrdDt/Cns/Itm/Seq
      * Renamed input format fields
     I              B6AIC3                          WKAIC3
     I              B6C4NB                          WKC4NB
     I              B6DPNB                          WKDPNB
     I              B6UENB                          WKUENB
     I              B6JGDT                          WKJGDT
     I              B6OONY                          WKOONY
     I              B6AODT                          WKAODT
     I              B6AJCD                          WKAJCD
     I              B6NUDT                          WKNUDT
     I              B6HGCD                          WKHGCD
     I              B6IGQT                          WKIGQT
     I              B6FLWG                          WKFLWG
     I              B6NSQT                          WKNSQT
     I              B6JQWG                          WKJQWG
     I              B6NVDT                          WKNVDT
     I              B6BUTM                          WKBUTM
     I              B6UVST                          WKUVST
     I              B6UWST                          WKUWST
     I              B6UXST                          WKUXST
     I              B6VSST                          WKVSST
     I              B6AATM                          WKAATM
     I              B6AYNA                          WKAYNA
     I              B6A0NA                          WKA0NA
     I              B6AXDT                          WKAXDT
      *
     I@B6CPNB
      * Order Detail Sched_Consmd Retrieval index
      * Renamed input format fields
     I              B6AIC3                          WLAIC3
     I              B6C4NB                          WLC4NB
     I              B6DPNB                          WLDPNB
     I              B6UENB                          WLUENB
     I              B6JGDT                          WLJGDT
     I              B6OONY                          WLOONY
     I              B6AODT                          WLAODT
     I              B6AJCD                          WLAJCD
     I              B6NUDT                          WLNUDT
     I              B6HGCD                          WLHGCD
     I              B6IGQT                          WLIGQT
     I              B6FLWG                          WLFLWG
     I              B6NSQT                          WLNSQT
     I              B6JQWG                          WLJQWG
     I              B6NVDT                          WLNVDT
     I              B6BUTM                          WLBUTM
     I              B6UVST                          WLUVST
     I              B6UWST                          WLUWST
     I              B6UXST                          WLUXST
     I              B6VSST                          WLVSST
     I              B6AATM                          WLAATM
     I              B6AYNA                          WLAYNA
     I              B6A0NA                          WLA0NA
     I              B6AXDT                          WLAXDT
      *
     I@B6CPNA
      * Order Detail Sched_Consmd Update index
      * Renamed input format fields
     I              B6AIC3                          WMAIC3
     I              B6C4NB                          WMC4NB
     I              B6DPNB                          WMDPNB
     I              B6UENB                          WMUENB
     I              B6JGDT                          WMJGDT
     I              B6OONY                          WMOONY
     I              B6AODT                          WMAODT
     I              B6AJCD                          WMAJCD
     I              B6NUDT                          WMNUDT
     I              B6HGCD                          WMHGCD
     I              B6IGQT                          WMIGQT
     I              B6FLWG                          WMFLWG
     I              B6NSQT                          WMNSQT
     I              B6JQWG                          WMJQWG
     I              B6NVDT                          WMNVDT
     I              B6BUTM                          WMBUTM
     I              B6UVST                          WMUVST
     I              B6UWST                          WMUWST
     I              B6UXST                          WMUXST
     I              B6VSST                          WMVSST
     I              B6AATM                          WMAATM
     I              B6AYNA                          WMAYNA
     I              B6A0NA                          WMA0NA
     I              B6AXDT                          WMAXDT
      *
     I@IOREA4
      * Item Bill Of Material     Co/Item/CItem StrWgtYld
      * Renamed input format fields
     I              IOAIC3                          WOAIC3
     I              IOHGCD                          WOHGCD
     I              IOC9NB                          WOC9NB
     I              IOV2ST                          WOV2ST
     I              IOBOPR                          WOBOPR
     I              IOBPPR                          WOBPPR
     I              IOHGQT                          WOHGQT
     I              IOHHCD                          WOHHCD
     I              IOYAST                          WOYAST
     I              IOCNSM                          WOCNSM
     I              IOBMY1                          WOBMY1
     I              IOBMY2                          WOBMY2
     I              IOIXQT                          WOIXQT
     I              IOIYQT                          WOIYQT
     I              IORSST                          WORSST
     I              IORTST                          WORTST
     I              IOUVST                          WOUVST
     I              IOUWST                          WOUWST
     I              IOUXST                          WOUXST
     I              IOVSST                          WOVSST
     I              IOAATM                          WOAATM
     I              IOAYNA                          WOAYNA
     I              IOA0NA                          WOA0NA
     I              IOAXDT                          WOAXDT
      *
     I@B5CPM3
      * Order Detail Sched_Inv    Co/Ord/Seq/Seq2/PDte(d)
      * Renamed input format fields
     I              B5AIC3                          WRAIC3
     I              B5C4NB                          WRC4NB
     I              B5DPNB                          WRDPNB
     I              B5UENB                          WRUENB
     I              B5JGDT                          WRJGDT
     I              B5AODT                          WRAODT
     I              B5AJCD                          WRAJCD
     I              B5HGCD                          WRHGCD
     I              B5IUQT                          WRIUQT
     I              B5F3WG                          WRF3WG
     I              B5UVST                          WRUVST
     I              B5UWST                          WRUWST
     I              B5UXST                          WRUXST
     I              B5VSST                          WRVSST
     I              B5AATM                          WRAATM
     I              B5AYNA                          WRAYNA
     I              B5A0NA                          WRA0NA
     I              B5AXDT                          WRAXDT
      *
     I@KNCPHO
      * Order Detail Schedule     Retrieval index
      * Renamed input format fields
     I              KNAIC3                          WSAIC3
     I              KNC4NB                          WSC4NB
     I              KNDPNB                          WSDPNB
     I              KNUENB                          WSUENB
     I              KNJGDT                          WSJGDT
     I              KNAODT                          WSAODT
     I              KNAJCD                          WSAJCD
     I              KNAYAA                          WSAYAA
     I              KNHGCD                          WSHGCD
     I              KNIGQT                          WSIGQT
     I              KNFLWG                          WSFLWG
     I              KNIUQT                          WSIUQT
     I              KNF3WG                          WSF3WG
     I              KNIVQT                          WSIVQT
     I              KNF4WG                          WSF4WG
     I              KNP7ST                          WSP7ST
     I              KNP8ST                          WSP8ST
     I              KNQAST                          WSQAST
     I              KNUVST                          WSUVST
     I              KNUWST                          WSUWST
     I              KNUXST                          WSUXST
     I              KNVSST                          WSVSST
     I              KNAATM                          WSAATM
     I              KNAYNA                          WSAYNA
     I              KNA0NA                          WSA0NA
     I              KNAXDT                          WSAXDT
      *
     I@B5CPM1
      * Order Detail Sched_Inv    Update index
      * Renamed input format fields
     I              B5AIC3                          WTAIC3
     I              B5C4NB                          WTC4NB
     I              B5DPNB                          WTDPNB
     I              B5UENB                          WTUENB
     I              B5JGDT                          WTJGDT
     I              B5AODT                          WTAODT
     I              B5AJCD                          WTAJCD
     I              B5HGCD                          WTHGCD
     I              B5IUQT                          WTIUQT
     I              B5F3WG                          WTF3WG
     I              B5UVST                          WTUVST
     I              B5UWST                          WTUWST
     I              B5UXST                          WTUXST
     I              B5VSST                          WTVSST
     I              B5AATM                          WTAATM
     I              B5AYNA                          WTAYNA
     I              B5A0NA                          WTA0NA
     I              B5AXDT                          WTAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPDKN1    E DSPDKNCPL0
      * UPD : Order Detail Schedule     Update index
      * Renamed input format fields
     I              KNAIC3                          WEAIC3
     I              KNC4NB                          WEC4NB
     I              KNDPNB                          WEDPNB
     I              KNUENB                          WEUENB
     I              KNJGDT                          WEJGDT
     I              KNAODT                          WEAODT
     I              KNAJCD                          WEAJCD
     I              KNAYAA                          WEAYAA
     I              KNHGCD                          WEHGCD
     I              KNIGQT                          WEIGQT
     I              KNFLWG                          WEFLWG
     I              KNIUQT                          WEIUQT
     I              KNF3WG                          WEF3WG
     I              KNIVQT                          WEIVQT
     I              KNF4WG                          WEF4WG
     I              KNP7ST                          WEP7ST
     I              KNP8ST                          WEP8ST
     I              KNQAST                          WEQAST
     I              KNUVST                          WEUVST
     I              KNUWST                          WEUWST
     I              KNUXST                          WEUXST
     I              KNVSST                          WEVSST
     I              KNAATM                          WEAATM
     I              KNAYNA                          WEAYNA
     I              KNA0NA                          WEA0NA
     I              KNAXDT                          WEAXDT
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPDI81    E DSPDI8CPL0
      * UPD : PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WGAIC3
     I              I8V5ST                          WGV5ST
     I              I8ELDT                          WGELDT
     I              I8HGCD                          WGHGCD
     I              I8AJCD                          WGAJCD
     I              I8GPDT                          WGGPDT
     I              I8WTSP                          WGWTSP
     I              I8QTSP                          WGQTSP
     I              I8DJPC                          WGDJPC
     I              I8F8WG                          WGF8WG
     I              I8WTIN                          WGWTIN
     I              I8D5NB                          WGD5NB
     I              I8DXWG                          WGDXWG
     I              I8B2NB                          WGB2NB
     I              I8WTCN                          WGWTCN
     I              I8PSCV                          WGPSCV
     I              I8SAWT                          WGSAWT
     I              I8B9NB                          WGB9NB
     I              I8D1WG                          WGD1WG
     I              I8CBNB                          WGCBNB
     I              I8EZWG                          WGEZWG
     I              I8CCNB                          WGCCNB
     I              I8E0WG                          WGE0WG
     I              I8D6NB                          WGD6NB
     I              I8OAWT                          WGOAWT
     I              I8CDNB                          WGCDNB
     I              I8UNW2                          WGUNW2
     I              I8CENB                          WGCENB
     I              I8F9WG                          WGF9WG
     I              I8BPNB                          WGBPNB
     I              I8GAWG                          WGGAWG
     I              I8BQNB                          WGBQNB
     I              I8GBWG                          WGGBWG
     I              I8BRNB                          WGBRNB
     I              I8GCWG                          WGGCWG
     I              I8BSNB                          WGBSNB
     I              I8GDWG                          WGGDWG
     I              I8BWNB                          WGBWNB
     I              I8GEWG                          WGGEWG
     I              I8PS6U                          WGPS6U
     I              I8WCST                          WGWCST
     I              I8WPST                          WGWPST
     I              I8B5ST                          WGB5ST
     I              I8TFST                          WGTFST
     I              I8TEST                          WGTEST
     I              I8THST                          WGTHST
     I              I8UDST                          WGUDST
     I              I8UFST                          WGUFST
     I              I8UGST                          WGUGST
     I              I8UHST                          WGUHST
     I              I8B6ST                          WGB6ST
     I              I8B7ST                          WGB7ST
     I              I8DVWG                          WGDVWG
     I              I8D7NB                          WGD7NB
     I              I8FCAD                          WGFCAD
     I              I8D9NB                          WGD9NB
     I              I8DWWG                          WGDWWG
     I              I8EANB                          WGEANB
     I              I8SHWT                          WGSHWT
     I              I8EBNB                          WGEBNB
     I              I8AVWT                          WGAVWT
     I              I8ECNB                          WGECNB
     I              I8WTON                          WGWTON
     I              I8EDNB                          WGEDNB
     I              I8FNWT                          WGFNWT
     I              I8EENB                          WGEENB
     I              I8QTAS                          WGQTAS
     I              I8EFNB                          WGEFNB
     I              I8WAIO                          WGWAIO
     I              I8EGNB                          WGEGNB
     I              I8R3CD                          WGR3CD
     I              I8RGNB                          WGRGNB
     I              I8RHNB                          WGRHNB
     I              I8RINB                          WGRINB
     I              I8XRCD                          WGXRCD
     I              I8UVST                          WGUVST
     I              I8UWST                          WGUWST
     I              I8UXST                          WGUXST
     I              I8VSST                          WGVSST
     I              I8AATM                          WGAATM
     I              I8AYNA                          WGAYNA
     I              I8A0NA                          WGA0NA
     I              I8AXDT                          WGAXDT
      *
     IQPOB61    E DSPOB6CPL0
      * UPD : Order Detail Sched_Consmd Update index
      * Renamed input format fields
     I              B6AIC3                          WMAIC3
     I              B6C4NB                          WMC4NB
     I              B6DPNB                          WMDPNB
     I              B6UENB                          WMUENB
     I              B6JGDT                          WMJGDT
     I              B6OONY                          WMOONY
     I              B6AODT                          WMAODT
     I              B6AJCD                          WMAJCD
     I              B6NUDT                          WMNUDT
     I              B6HGCD                          WMHGCD
     I              B6IGQT                          WMIGQT
     I              B6FLWG                          WMFLWG
     I              B6NSQT                          WMNSQT
     I              B6JQWG                          WMJQWG
     I              B6NVDT                          WMNVDT
     I              B6BUTM                          WMBUTM
     I              B6UVST                          WMUVST
     I              B6UWST                          WMUWST
     I              B6UXST                          WMUXST
     I              B6VSST                          WMVSST
     I              B6AATM                          WMAATM
     I              B6AYNA                          WMAYNA
     I              B6A0NA                          WMA0NA
     I              B6AXDT                          WMAXDT
      *
     IYARDCS      DS                             91
     IYBRDCS      DS                            326
     IYCRDCS      DS                            100
      * Outward parameters
     IPARC        DS                             14
      * KEY : Item Bill Of Material     Co/Itm/Typ/CPty/CItm Mt
      * I : RST Company Number
     I                                    P   1   20PAAIC3
      * I : RST Item Code
     I                                    P   3   60PAHGCD
      *
     IYDRDCS      DS                            326
     IYERDCS      DS                            326
     IYFRDCS      DS                            326
     IYGRDCS      DS                            100
     IQPOB51    E DSPOB5CPL0
      * UPD : Order Detail Sched_Inv    Update index
      * Renamed input format fields
     I              B5AIC3                          WTAIC3
     I              B5C4NB                          WTC4NB
     I              B5DPNB                          WTDPNB
     I              B5UENB                          WTUENB
     I              B5JGDT                          WTJGDT
     I              B5AODT                          WTAODT
     I              B5AJCD                          WTAJCD
     I              B5HGCD                          WTHGCD
     I              B5IUQT                          WTIUQT
     I              B5F3WG                          WTF3WG
     I              B5UVST                          WTUVST
     I              B5UWST                          WTUWST
     I              B5UXST                          WTUXST
     I              B5VSST                          WTVSST
     I              B5AATM                          WTAATM
     I              B5AYNA                          WTAYNA
     I              B5A0NA                          WTA0NA
     I              B5AXDT                          WTAXDT
      *
     IYHRDCS      DS                             69
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Order Number
     I                                    P   3   60P1C4NB
      * I :  Order Sequence Number
     I                                    P   7   80P1DPNB
      * I :  Order Secondary Line Seq
     I                                    P   9  100P1UENB
      * I :  Item Code
     I                                    P  11  140P1HGCD
      * I :  Warehouse Code
     I                                       15  17 P1AJCD
      * I :  Ship Date USR
     I                                    P  18  210P1HLDT
      * I :  Quantity Ordered
     I                                    P  22  272P1AVQT
      * I :  Weight Ordered
     I                                    P  28  332P1D0WG
      * B :  Quantity Scheduled
     I                                    P  34  392P1CCQT
      * B :  Weight Scheduled
     I                                    P  40  452P1AUWG
      * I :  PSAA Program Name
     I                                       46  55 P1BXVN
      * B :  ATS Quantity Need USR
     I                                    P  56  612P1HWQT
      * B :  ATS Weight Need USR
     I                                    P  62  672P1ENWG
      * I :  Unit Weight
     I                                    P  68  732P1AIWG
      * N :  Production Date
     I                                    P  74  770P1ELDT
      * N :  Production Date RGF
     I                                    P  78  810P1GVDT
      * N :  Production Date RGT
     I                                    P  82  850P1GWDT
      * I :  ATS Adj Type USR 2
     I                                       86  87 P1QJST
      * I :  Production Date USR
     I                                    P  88  910P1GXDT
     IP2PARM      DS
      * FLD: Company Item
      * I :  UOM Primary
     I                                        1   2 P2ADCD
      * I :  Fresh Chilling Time
     I                                    P   3   52P2CHTM
      * I :  Base_Conv_Loss Item
     I                                        6   7 P2QZCD
      * I :  Department Code
     I                                        8  13 P2R3CD
      * I :  Piece Count Item
     I                                       14  14 P2PCCT
      * I :  Pieces Per Bag
     I                                    P  15  180P2BDNB
      * I :  Bags Per Unit
     I                                    P  19  220P2BJNB
      * I :  Export_Domestic
     I                                       23  23 P2SUST
      * I :  Print On Schedule
     I                                       24  24 P2SVST
      * I :  Fresh Inv Allocation Seq
     I                                       25  25 P2SYST
      * I :  Fresh Sched As Ordered
     I                                       26  26 P2SZST
      * I :  Frozen Inv Allocation Seq
     I                                       27  27 P2S1ST
      * I :  Primal Group Code
     I                                       28  33 P2XRCD
     IP3PARM      DS
      * FLD: Warehouse Codes
      * I :  Warehouse Type
     I                                        1   2 P3WPST
      * I :  Warehouse Std Chill Time
     I                                        3   3 P3T1ST
      * I :  Warehouse Chill Time
     I                                    P   4   62P3DBNB
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1DPNB    PARM           WP0003  30       Order Sequence
     C           P1UENB    PARM           WP0004  30       Order Secondary
     C           P1HGCD    PARM           WP0005  70       Item Code
     C           P1AJCD    PARM           WP0006  3        Warehouse Code
     C           P1HLDT    PARM           WP0007  70       Ship Date USR
     C           P1AVQT    PARM           WP0008 112       Quantity Ordere
     C           P1D0WG    PARM           WP0009 112       Weight Ordered
     C           P1CCQT    PARM P1CCQT    WP0010 112       Quantity Schedu
     C           P1AUWG    PARM P1AUWG    WP0011 112       Weight Schedule
     C           P1BXVN    PARM           WP0012 10        PSAA Program Na
     C           P1HWQT    PARM P1HWQT    WP0013 112       ATS Quantity Ne
     C           P1ENWG    PARM P1ENWG    WP0014 112       ATS Weight Need
     C           P1AIWG    PARM           WP0015 112       Unit Weight
     C           P1QJST    PARM           WP0016  2        ATS Adj Type US
     C           P1GXDT    PARM           WP0017  70       Production Date
     C           P2ADCD    PARM           WP0018  2        UOM Primary
     C           P2CHTM    PARM           WP0019  52       Fresh Chilling
     C           P2QZCD    PARM           WP0020  2        Base_Conv_Loss
     C           P2R3CD    PARM           WP0021  6        Department Code
     C           P2PCCT    PARM           WP0022  1        Piece Count Ite
     C           P2BDNB    PARM           WP0023  70       Pieces Per Bag
     C           P2BJNB    PARM           WP0024  70       Bags Per Unit
     C           P2SUST    PARM           WP0025  1        Export_Domestic
     C           P2SVST    PARM           WP0026  1        Print On Schedu
     C           P2SYST    PARM           WP0027  1        Fresh Inv Alloc
     C           P2SZST    PARM           WP0028  1        Fresh Sched As
     C           P2S1ST    PARM           WP0029  1        Frozen Inv Allo
     C           P2XRCD    PARM           WP0030  6        Primal Group Co
     C           P3WPST    PARM           WP0031  2        Warehouse Type
     C           P3T1ST    PARM           WP0032  1        Warehouse Std C
     C           P3DBNB    PARM           WP0033  52       Warehouse Chill
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * UPD ATS Order DeAlloc  XF
      * S015890 JM 07/09/24 - Block Order automation fixes.
      *                     - Changed closedown program to N.
      *                     - for performance tuning.INVBLDALC will compl
      * WI546_2 JM 04/11/24 - Block Order automation phase 2.
      *                     - Changed closedown program to Y.
      * E10457 RMC 5/10/17 use prod whse when updating pdi8cpp--> COMMENT
      * FP1054 Changes in:Upd Deallocate PRD    RT - Order Detail Schedul
      * Deallocate Inventory & Production
      * CASE: PAR.Warehouse Type is Frozen
     C           P3WPST    IFEQ 'FZ'                       *IF
      * Deallocate Production
      * CASE: PAR.ATS Weight Need USR is Less than zero
     C           P1ENWG    IFLT *ZERO                      *IF
      * Upd Deallocate PRD    RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDP1C4NB    WL0002           Order Number
     C                     Z-ADDP1DPNB    WL0003           Order Sequence
     C                     Z-ADDP1UENB    WL0004           Order Secondary
     C                     MOVELP1AJCD    WL0005    P      Warehouse Code
     C                     Z-ADDP1HGCD    WL0006           Item Code
     C                     MOVELP2ADCD    WL0007    P      UOM Primary
     C                     Z-ADDP1AIWG    WL0008           Unit Weight
     C                     MOVELP2QZCD    WL0009    P      Base_Conv_Loss
     C                     MOVELP2PCCT    WL0010    P      Piece Count Ite
     C                     Z-ADDP2BDNB    WL0011           Pieces Per Bag
     C                     Z-ADDP2BJNB    WL0012           Bags Per Unit
     C                     Z-ADDP1AVQT    WL0013           Quantity Ordere
     C                     Z-ADDP1D0WG    WL0014           Weight Ordered
     C                     Z-ADDP1CCQT    WL0015           Quantity Schedu
     C                     Z-ADDP1AUWG    WL0016           Weight Schedule
     C                     Z-ADDP1HWQT    WL0017           ATS Quantity Ne
     C                     Z-ADDP1ENWG    WL0018           ATS Weight Need
     C                     Z-ADDP1GXDT    WL0019           Production Date
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0015    P1CCQT           Quantity Schedu
     C                     Z-ADDWL0016    P1AUWG           Weight Schedule
     C                     Z-ADDWL0017    P1HWQT           ATS Quantity Ne
     C                     Z-ADDWL0018    P1ENWG           ATS Weight Need
     C                     END                             *FI
      * **** NEW ****
      * Deallocate Inventory
      * CASE: PAR.ATS Quantity Need USR is Less than zero
     C           P1HWQT    IFLT *ZERO                      *IF
      *
     C                     Z-ADD*ZERO     WN0511 112       OD Quantity Inv
     C                     Z-ADD*ZERO     WN0512 112       OD Weight Inv S
     C                     Z-ADD*ZERO     WN0513  92       Weight Dealloca
     C                     Z-ADD*ZERO     WN0514 112       Quantity Deallo
      *
      * UPD Deallocate Inv    IF
      * UPD Deallocate Inv    RT - Order Detail Sched-Inv  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0182           Company Number
     C                     Z-ADDP1C4NB    WL0183           Order Number
     C                     Z-ADDP1DPNB    WL0184           Order Sequence
     C                     Z-ADDP1UENB    WL0185           Order Secondary
     C                     MOVELP1AJCD    WL0186    P      Warehouse Code
     C                     Z-ADDP1HGCD    WL0187           Item Code
     C                     Z-ADDP1AIWG    WL0188           Unit Weight
     C                     MOVELP2PCCT    WL0189    P      Piece Count Ite
     C                     Z-ADDP2BDNB    WL0190           Pieces Per Bag
     C                     Z-ADDP2BJNB    WL0191           Bags Per Unit
     C                     Z-ADDP1AVQT    WL0192           Quantity Ordere
     C                     Z-ADDP1D0WG    WL0193           Weight Ordered
     C                     Z-ADDP1CCQT    WL0194           Quantity Schedu
     C                     Z-ADDP1AUWG    WL0195           Weight Schedule
     C                     Z-ADDP1HWQT    WL0196           ATS Quantity Ne
     C                     Z-ADDP1ENWG    WL0197           ATS Weight Need
     C                     Z-ADDP1HLDT    WL0198           Ship Date USR
     C                     Z-ADDP1GXDT    WL0199           Production Date
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0194    P1CCQT           Quantity Schedu
     C                     Z-ADDWL0195    P1AUWG           Weight Schedule
     C                     Z-ADDWL0196    P1HWQT           ATS Quantity Ne
     C                     Z-ADDWL0197    P1ENWG           ATS Weight Need
     C                     END                             *FI
      * *************
     C                     ELSE
      * CASE: PAR.Warehouse Type is Fresh
     C           P3WPST    IFEQ 'FR'                       *IF
      * Deallocate Production
      * CASE: PAR.ATS Weight Need USR is Less than zero
     C           P1ENWG    IFLT *ZERO                      *IF
      * Upd Deallocate PRD    RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADDP1C4NB    WL0002           Order Number
     C                     Z-ADDP1DPNB    WL0003           Order Sequence
     C                     Z-ADDP1UENB    WL0004           Order Secondary
     C                     MOVELP1AJCD    WL0005    P      Warehouse Code
     C                     Z-ADDP1HGCD    WL0006           Item Code
     C                     MOVELP2ADCD    WL0007    P      UOM Primary
     C                     Z-ADDP1AIWG    WL0008           Unit Weight
     C                     MOVELP2QZCD    WL0009    P      Base_Conv_Loss
     C                     MOVELP2PCCT    WL0010    P      Piece Count Ite
     C                     Z-ADDP2BDNB    WL0011           Pieces Per Bag
     C                     Z-ADDP2BJNB    WL0012           Bags Per Unit
     C                     Z-ADDP1AVQT    WL0013           Quantity Ordere
     C                     Z-ADDP1D0WG    WL0014           Weight Ordered
     C                     Z-ADDP1CCQT    WL0015           Quantity Schedu
     C                     Z-ADDP1AUWG    WL0016           Weight Schedule
     C                     Z-ADDP1HWQT    WL0017           ATS Quantity Ne
     C                     Z-ADDP1ENWG    WL0018           ATS Weight Need
     C                     Z-ADDP1GXDT    WL0019           Production Date
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0015    P1CCQT           Quantity Schedu
     C                     Z-ADDWL0016    P1AUWG           Weight Schedule
     C                     Z-ADDWL0017    P1HWQT           ATS Quantity Ne
     C                     Z-ADDWL0018    P1ENWG           ATS Weight Need
     C                     END                             *FI
      * **** NEW ****
      * Deallocate Inventory
      * CASE: PAR.ATS Quantity Need USR is Less than zero
     C           P1HWQT    IFLT *ZERO                      *IF
      *
     C                     Z-ADD*ZERO     WN0641 112       OD Quantity Inv
     C                     Z-ADD*ZERO     WN0642 112       OD Weight Inv S
     C                     Z-ADD*ZERO     WN0643  92       Weight Dealloca
     C                     Z-ADD*ZERO     WN0644 112       Quantity Deallo
      *
      * UPD Deallocate Inv    IF
      * UPD Deallocate Inv    RT - Order Detail Sched-Inv  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0182           Company Number
     C                     Z-ADDP1C4NB    WL0183           Order Number
     C                     Z-ADDP1DPNB    WL0184           Order Sequence
     C                     Z-ADDP1UENB    WL0185           Order Secondary
     C                     MOVELP1AJCD    WL0186    P      Warehouse Code
     C                     Z-ADDP1HGCD    WL0187           Item Code
     C                     Z-ADDP1AIWG    WL0188           Unit Weight
     C                     MOVELP2PCCT    WL0189    P      Piece Count Ite
     C                     Z-ADDP2BDNB    WL0190           Pieces Per Bag
     C                     Z-ADDP2BJNB    WL0191           Bags Per Unit
     C                     Z-ADDP1AVQT    WL0192           Quantity Ordere
     C                     Z-ADDP1D0WG    WL0193           Weight Ordered
     C                     Z-ADDP1CCQT    WL0194           Quantity Schedu
     C                     Z-ADDP1AUWG    WL0195           Weight Schedule
     C                     Z-ADDP1HWQT    WL0196           ATS Quantity Ne
     C                     Z-ADDP1ENWG    WL0197           ATS Weight Need
     C                     Z-ADDP1HLDT    WL0198           Ship Date USR
     C                     Z-ADDP1GXDT    WL0199           Production Date
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0194    P1CCQT           Quantity Schedu
     C                     Z-ADDWL0195    P1AUWG           Weight Schedule
     C                     Z-ADDWL0196    P1HWQT           ATS Quantity Ne
     C                     Z-ADDWL0197    P1ENWG           ATS Weight Need
     C                     END                             *FI
      * *************
     C                     END                             *FI
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Upd Deallocate PRD    RT - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       OD Production D
     C                     Z-ADD*ZERO     WN0002 112       OD Qty_Cnsmd Pi
     C                     Z-ADD*ZERO     WN0003 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0004  52       Fresh Chilling
     C                     MOVEL*BLANK    WN0005  1        Production Type
     C                     Z-ADD*ZERO     WN0006  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0007  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0008  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0009  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0010  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0011  52       Production Yiel
     C                     Z-ADD*ZERO     WN0012 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0013  70       ATS Pieces Avai
     C                     Z-ADD*ZERO     WN0014  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0015  92       PS Weight Produ
     C                     MOVEL*BLANK    WN0016  2        Warehouse Type
     C                     MOVEL*BLANK    WN0017  1        Warehouse Std C
     C                     Z-ADD*ZERO     WN0018  52       Warehouse Chill
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * C01643 8/02/11 RMC use db1.od avg piece wght instead of pdi8cpp w
      *  its being upd per order on its order dtl schedule rcd
      * The value coming in is Negative, need to make it positive.
     C           -1        MULT WL0017    WUHWQT           ATS Quantity Ne
      * FP1054 new
      * Rtv Productin Whs     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWL0005    WL0020    P      Warehouse Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0021    YL0001    P      Production Ware
     C                     Z-ADDWL0022    YL0002           Accounting Comp
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSA02           Order Number
     C           *LIKE     DEFN WADPNB    WQSA03           Order Sequence
     C           *LIKE     DEFN WAUENB    WQSA04           Order Secondary
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Order Number
     C                     KFLD           WQSA03           Order Sequence
     C                     KFLD           WQSA04           Order Secondary
      * Setup key
     C                     Z-ADDWL0001    WQSA01           Company Number
     C                     Z-ADDWL0002    WQSA02           Order Number
     C                     Z-ADDWL0003    WQSA03           Order Sequence
     C                     Z-ADDWL0004    WQSA04           Order Secondary
      * Establish starting position
     C           KRSSA     SETLL@KNCPM6                    *
     C           KRSSA     READE@KNCPM6                  90*
      * Data record not found
     C   90                MOVEL'USR2238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * CASE: PAR.Production Date USR is Entered
     C           WL0019    IFNE 0                          *IF
      * CASE: DB1.OD Production Date NE PAR.Production Date USR
     C           WAJGDT    IFNE WL0019                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Process Record
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     Z-ADDWAJGDT    WN0001           OD Production D
      * RTV Type/Std Chil/Chil RT - Warehouse  * 
     C                     EXSR SCRVGN
      * Chilling Time
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           WN0017    IFEQ 'Y'                        *IF
     C                     Z-ADDWN0018    WN0004           Fresh Chilling
     C                     END                             *FI
      * CASE: WRK.ATS Quantity Need USR is Equal to zero
     C           WUHWQT    IFEQ 0                          *IF
     C                     GOTO SAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Deallocate Production
      * CASE: DB1.OD Quantity Scheduled is Greater than zero
     C           WAIGQT    IFGT 0                          *IF
      * Determine Production Type
      * CASE: DB1.OD Production Date EQ JOB.*Job date
     C           WAJGDT    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0005           Production Type
     C                     Z-ADD##JDT     WN0001           OD Production D
      * Val Sched Existance   RT - PS Prod Schedule  * 
     C                     EXSR SDRVGN
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0005           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.OD Production Date GT JOB.*Job date
     C           WAJGDT    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0005           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * De-allocate
      * CASE: DB1.OD Production Date LT JOB.*Job date
     C           WAJGDT    IFLT ##JDT                      *IF
      * DLT Ord Detail Sched   DL - PD Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0023           Company Number
     C                     Z-ADDWAC4NB    WL0024           Order Number
     C                     Z-ADDWADPNB    WL0025           Order Sequence
     C                     Z-ADDWAUENB    WL0026           Order Secondary
     C                     Z-ADDWAJGDT    WL0027           OD Production D
     C                     EXSR SEDLRC
      * Rtv AvgPcWgt/Prd/PrdAl RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0028           Company Number
     C                     MOVELWN0005    WL0029    P      Production Type
     C                     Z-ADDWN0001    WL0030           Production Date
     C                     Z-ADDWAHGCD    WL0031           Item Code
     C                     MOVELWAAJCD    WL0032    P      Warehouse Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0033    WN0006           PS Weight Plann
     C                     Z-ADDWL0034    WN0007           PS Pieces Plann
     C                     Z-ADDWL0035    WN0008           PS Avg Piece Wg
     C                     Z-ADDWL0036    WN0009           PS Weight Prod
     C                     Z-ADDWL0037    WN0010           PS Pieces Prod
      * Pieces & Weight Deallocated.
      * CASE: PAR.Piece Count Item is yes
     C           WL0010    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * WRK.Pieces Allocated USR =
      *    *COMPUTE ((x1 * x2 * x3) * x4)
      * x1    : DB1.OD Qty_Cnsmd Pieces Sched
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,0) work field *
      * x4    : CON.-1
     C           WAIGQT    MULT WL0011    W0WJ02    H      *Synon (15,0) w
     C           W0WJ02    MULT WL0012    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT -1        W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WUPCAL           Pieces Allocate
      * C01643 8/5/11 use od sched wgt on order dtl sched
     C           -1        MULT WAFLWG    WUEOWG           ATS Weight Avai
     C                     ELSE
      * CASE: *OTHERWISE
      * ATS Weight Available USR
      * WRK.ATS Weight Available USR =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : DB1.OD Qty_Cnsmd Pieces Sched
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Unit Weight
      * *     : PGM.*Synon (15,2) work field *
      * x3    : CON.-1
     C           WAIGQT    MULT WL0008    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT -1        W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUEOWG           ATS Weight Avai
     C                     Z-ADD*ZERO     WUPCAL           Pieces Allocate
     C                     END                             *FI
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0038           Company Number
     C                     MOVEL'S'       WL0039    P      Production Type
     C                     Z-ADD##JDT     WL0040           Production Date
     C                     Z-ADDWAHGCD    WL0041           Item Code
     C                     MOVELWAAJCD    WL0042    P      Warehouse Code
     C                     Z-ADDWUEOWG    WL0043           Weight Allocate
     C                     Z-ADDWUPCAL    WL0044           Pieces Allocate
     C                     Z-ADDWAC4NB    WL0045           Order Number
     C                     Z-ADDWADPNB    WL0046           Order Sequence
     C                     Z-ADDWAUENB    WL0047           Order Secondary
     C                     MOVEL'Y'       WL0048    P      Status Flag 19
     C                     EXSR SGRVGN
     C                     SUB  WAIGQT    WUHWQT           ATS Quantity Ne
     C                     SUB  WAIGQT    WL0015           Quantity Schedu
     C           WL0015    MULT WL0008    WL0016    H      Weight Schedule
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv AvgPcWgt/Prd/PrdAl RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0028           Company Number
     C                     MOVELWN0005    WL0029    P      Production Type
     C                     Z-ADDWN0001    WL0030           Production Date
     C                     Z-ADDWAHGCD    WL0031           Item Code
     C                     MOVELWAAJCD    WL0032    P      Warehouse Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0033    WN0006           PS Weight Plann
     C                     Z-ADDWL0034    WN0007           PS Pieces Plann
     C                     Z-ADDWL0035    WN0008           PS Avg Piece Wg
     C                     Z-ADDWL0036    WN0009           PS Weight Prod
     C                     Z-ADDWL0037    WN0010           PS Pieces Prod
      * Update Production Schedule
      * CASE: DB1.OD Quantity Scheduled GT WRK.ATS Quantity Need USR
     C           WAIGQT    IFGT WUHWQT                     *IF
     C           WAIGQT    SUB  WUHWQT    WN0002           OD Qty_Cnsmd Pi
      * Calc Weight to deallocate from order detail schedule
      * CASE: PAR.Piece Count Item is yes
     C           WL0010    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * WRK.Pieces Allocated USR =
      *    *COMPUTE ((x1 * x2 * x3) * x4)
      * x1    : WRK.ATS Quantity Need USR
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,0) work field *
      * x4    : CON.-1
     C           WUHWQT    MULT WL0011    W0WJ02    H      *Synon (15,0) w
     C           W0WJ02    MULT WL0012    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT -1        W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WUPCAL           Pieces Allocate
      * C01643 8/5/11 use od weight sched on order dtl sched
     C           WAFLWG    MULT -1        WUEOWG           ATS Weight Avai
     C           WN0002    MULT WL0008    WN0003           OD Weight Sched
     C                     ELSE
      * CASE: *OTHERWISE
      * ATS Weight Available USR
      * WRK.ATS Weight Available USR =
      *    *COMPUTE ((x1 * x2) * x3)
      * x1    : WRK.ATS Quantity Need USR
      * *     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Unit Weight
      * *     : PGM.*Synon (15,2) work field *
      * x3    : CON.-1
     C           WUHWQT    MULT WL0008    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT -1        W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUEOWG           ATS Weight Avai
     C                     Z-ADD*ZERO     WUPCAL           Pieces Allocate
     C           WN0002    MULT WL0008    WN0003           OD Weight Sched
     C                     END                             *FI
      * CHG Qty/Wgt Scheduled  CH - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0168           Company Number
     C                     Z-ADDWAC4NB    WL0169           Order Number
     C                     Z-ADDWADPNB    WL0170           Order Sequence
     C                     Z-ADDWAUENB    WL0171           Order Secondary
     C                     Z-ADDWAJGDT    WL0172           OD Production D
     C                     Z-ADDWN0002    WL0173           OD Qty_Cnsmd Pi
     C                     Z-ADDWN0003    WL0174           OD Weight Sched
     C                     Z-ADDWAIUQT    WL0175           OD Quantity Inv
     C                     Z-ADDWAF3WG    WL0176           OD Weight Inv S
     C                     MOVELWAP7ST    WL0177    P      OD Added to Sch
     C                     EXSR STCHRC
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0038           Company Number
     C                     MOVELWN0005    WL0039    P      Production Type
     C                     Z-ADDWN0001    WL0040           Production Date
     C                     Z-ADDWAHGCD    WL0041           Item Code
     C                     MOVELWAAJCD    WL0042    P      Warehouse Code
     C                     Z-ADDWUEOWG    WL0043           Weight Allocate
     C                     Z-ADDWUPCAL    WL0044           Pieces Allocate
     C                     Z-ADDWAC4NB    WL0045           Order Number
     C                     Z-ADDWADPNB    WL0046           Order Sequence
     C                     Z-ADDWAUENB    WL0047           Order Secondary
     C                     MOVEL'Y'       WL0048    P      Status Flag 19
     C                     EXSR SGRVGN
      * Production Date > or = Job Date, Add back BASE
      * CASE: DB1.OD Production Date GE JOB.*Job date
     C           WAJGDT    IFGE ##JDT                      *IF
      * If converted item add scheduled quantity back to base item
      * CASE: PAR.Base/Conv/Loss Item is Converted
     C           WL0009    IFEQ 'C'                        *IF
      * Rtv Item Prd Yld SWYG RT - Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0001    WL0178           Company Number
     C                     Z-ADDWL0006    WL0179           Item Code
     C                     Z-ADDWN0011    WL0180           Production Yiel
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0180    WN0011           Production Yiel
     C                     MOVELWL0181    WUWXST    P      Record Found US
      * Add back to the base item and remove from credit items.
      * CASE: PAR.Production Yield is Greater than zero
     C           WN0011    IFGT 0                          *IF
      * If piece count Item, find production avail in pieces else weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0010    IFEQ 'Y'                        *IF
     C                     Z-ADDWUPCAL    WN0014           PS Pieces Produ
      * This should be pieces * avg weight of consumed item if consuming
      * only one base item.
      * Weight Need
      * PAR.PS Weight Production Need =
      *    *COMPUTE ((x1 / (x2 / x3)))
      * x1    : WRK.ATS Weight Available USR
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Production Yield
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WN0011    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WUEOWG    DIV  W0WB01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0015           PS Weight Produ
     C                     ELSE
      * CASE: *OTHERWISE
      * Weight Need
      * PAR.PS Weight Production Need =
      *    *COMPUTE ((x1 / (x2 / x3)))
      * x1    : WRK.ATS Weight Available USR
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.Production Yield
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WN0011    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WUEOWG    DIV  W0WB01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0015           PS Weight Produ
     C                     Z-ADD*ZERO     WN0014           PS Pieces Produ
     C                     END                             *FI
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.PS Pieces Production Need is NE Zeros
      *   |- c2    : PAR.PS Weight Production Need is NE Zero
      *   '-
     C           WN0014    IFNE 0                          *IF
     C           WN0015    ORNE 0                          *OR
      * Upd Allocate Std      XF - Item Bill Of Material  * 
     C                     CLEARPARC
     C                     Z-ADDWL0001    PAAIC3           Company Number
     C                     Z-ADDWL0006    PAHGCD           Item Code
      *
     C                     CALL 'PDHNXFR'              90  Upd Allocate St
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Item Bill
     C                     PARM WL0005    WQ0001  3        Warehouse Code
     C                     PARM WN0001    WQ0002  70       Production Date
     C                     PARM WN0005    WQ0003  1        Production Type
     C                     PARM WL0007    WQ0004  2        UOM Primary
     C                     PARM WL0008    WQ0005 112       Unit Weight
     C                     PARM WN0004    WQ0006  52       Fresh Chilling
     C                     PARM WL0010    WQ0007  1        Piece Count Ite
     C                     PARM WL0011    WQ0008  70       Pieces Per Bag
     C                     PARM WL0012    WQ0009  70       Bags Per Unit
     C                     PARM WN0016    WQ0010  2        Warehouse Type
     C                     PARM WN0017    WQ0011  1        Warehouse Std C
     C                     PARM WN0018    WQ0012  52       Warehouse Chill
     C                     PARM WAC4NB    WQ0013  70       Order Number
     C                     PARM WADPNB    WQ0014  30       Order Sequence
     C                     PARM WAUENB    WQ0015  30       Order Secondary
     C                     PARM 'OD'      WQ0016  2        ATS Adj Type US
     C           WN0015    PARM WN0015    WQ0017 112       SM Weight Need
     C           WN0014    PARM WN0014    WQ0018  70       SM Pieces Need
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     SUB  WUHWQT    WL0015           Quantity Schedu
     C           WL0015    MULT WL0008    WL0016    H      Weight Schedule
      * FP1054 save this for prod whse update outside of this CASE
     C                     Z-ADDWUEOWG    WUF1WG           Weight Dealloca
     C                     Z-ADD*ZERO     WUHWQT           ATS Quantity Ne
     C                     ELSE
      * CASE: *OTHERWISE
      * Calc Weight to deallocate from order detail schedule
      * CASE: PAR.Piece Count Item is yes
     C           WL0010    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * WRK.Pieces Allocated USR =
      *    *COMPUTE ((x1 * x2 * x3) * x4)
      * x1    : DB1.OD Qty_Cnsmd Pieces Sched
      * *     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
      * *     : PGM.*Synon (15,0) work field *
      * x4    : CON.-1
     C           WAIGQT    MULT WL0011    W0WJ02           *Synon (15,0) w
     C           W0WJ02    MULT WL0012    W0WJ01           *Synon (15,0) w
     C           W0WJ01    MULT -1        W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WUPCAL           Pieces Allocate
      * C01643 use db1 weight sched
     C           WAFLWG    MULT -1        WUEOWG           ATS Weight Avai
     C                     ELSE
      * CASE: *OTHERWISE
      * ATS Weight Available USR
      * WRK.ATS Weight Available USR =
      *    *COMPUTE (x1 * x3)
      * x1    : DB1.OD Weight Scheduled
      * *     : PGM.*Synon (15,2) work field *
      * x3    : CON.-1
     C           WAFLWG    MULT -1        W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUEOWG           ATS Weight Avai
     C                     Z-ADD*ZERO     WUPCAL           Pieces Allocate
     C                     END                             *FI
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0038           Company Number
     C                     MOVELWN0005    WL0039    P      Production Type
     C                     Z-ADDWN0001    WL0040           Production Date
     C                     Z-ADDWAHGCD    WL0041           Item Code
     C                     MOVELWAAJCD    WL0042    P      Warehouse Code
     C                     Z-ADDWUEOWG    WL0043           Weight Allocate
     C                     Z-ADDWUPCAL    WL0044           Pieces Allocate
     C                     Z-ADDWAC4NB    WL0045           Order Number
     C                     Z-ADDWADPNB    WL0046           Order Sequence
     C                     Z-ADDWAUENB    WL0047           Order Secondary
     C                     MOVEL'Y'       WL0048    P      Status Flag 19
     C                     EXSR SGRVGN
      * Production Date > or = Job Date, Add back Base
      * CASE: DB1.OD Production Date GE JOB.*Job date
     C           WAJGDT    IFGE ##JDT                      *IF
      * If converted item add scheduled quantity back to base item
      * CASE: PAR.Base/Conv/Loss Item is Converted
     C           WL0009    IFEQ 'C'                        *IF
      * Rtv Item Prd Yld SWYG RT - Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0001    WL0178           Company Number
     C                     Z-ADDWL0006    WL0179           Item Code
     C                     Z-ADDWN0011    WL0180           Production Yiel
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0180    WN0011           Production Yiel
     C                     MOVELWL0181    WUWXST    P      Record Found US
      * Add back to the base item and remove from credit items.
      * CASE: PAR.Production Yield is Greater than zero
     C           WN0011    IFGT 0                          *IF
      * If piece count Item, find production avail in pieces else weight
      * CASE: PAR.Piece Count Item is yes
     C           WL0010    IFEQ 'Y'                        *IF
     C                     Z-ADDWUPCAL    WN0014           PS Pieces Produ
      * Weight Need
      * PAR.PS Weight Production Need =
      *    *COMPUTE ( x1 / (x2 / x3))
      * x1    : WRK.ATS Weight Available USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Production Yield
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WN0011    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WUEOWG    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0015           PS Weight Produ
     C                     ELSE
      * CASE: *OTHERWISE
      * Weight Need
      * PAR.PS Weight Production Need =
      *    *COMPUTE ( x1 / (x2 / x3))
      * x1    : WRK.ATS Weight Available USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Production Yield
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WN0011    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WUEOWG    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0015           PS Weight Produ
     C                     Z-ADD*ZERO     WN0014           PS Pieces Produ
     C                     END                             *FI
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.PS Pieces Production Need is NE Zeros
      *   |- c2    : PAR.PS Weight Production Need is NE Zero
      *   '-
     C           WN0014    IFNE 0                          *IF
     C           WN0015    ORNE 0                          *OR
      * Upd Allocate Std      XF - Item Bill Of Material  * 
     C                     CLEARPARC
     C                     Z-ADDWL0001    PAAIC3           Company Number
     C                     Z-ADDWL0006    PAHGCD           Item Code
      *
     C                     CALL 'PDHNXFR'              90  Upd Allocate St
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Item Bill
     C                     PARM WL0005    WQ0019  3        Warehouse Code
     C                     PARM WN0001    WQ0020  70       Production Date
     C                     PARM WN0005    WQ0021  1        Production Type
     C                     PARM WL0007    WQ0022  2        UOM Primary
     C                     PARM WL0008    WQ0023 112       Unit Weight
     C                     PARM WN0004    WQ0024  52       Fresh Chilling
     C                     PARM WL0010    WQ0025  1        Piece Count Ite
     C                     PARM WL0011    WQ0026  70       Pieces Per Bag
     C                     PARM WL0012    WQ0027  70       Bags Per Unit
     C                     PARM WN0016    WQ0028  2        Warehouse Type
     C                     PARM WN0017    WQ0029  1        Warehouse Std C
     C                     PARM WN0018    WQ0030  52       Warehouse Chill
     C                     PARM WAC4NB    WQ0031  70       Order Number
     C                     PARM WADPNB    WQ0032  30       Order Sequence
     C                     PARM WAUENB    WQ0033  30       Order Secondary
     C                     PARM 'OD'      WQ0034  2        ATS Adj Type US
     C           WN0015    PARM WN0015    WQ0035 112       SM Weight Need
     C           WN0014    PARM WN0014    WQ0036  70       SM Pieces Need
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     SUB  WAIGQT    WUHWQT           ATS Quantity Ne
      * CASE: DB1.OD Quantity Inv Sched is Equal to zero
     C           WAIUQT    IFEQ 0                          *IF
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0023           Company Number
     C                     Z-ADDWAC4NB    WL0024           Order Number
     C                     Z-ADDWADPNB    WL0025           Order Sequence
     C                     Z-ADDWAUENB    WL0026           Order Secondary
     C                     Z-ADDWAJGDT    WL0027           OD Production D
     C                     EXSR SEDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * CHG Qty/Wgt Scheduled  CH - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0168           Company Number
     C                     Z-ADDWAC4NB    WL0169           Order Number
     C                     Z-ADDWADPNB    WL0170           Order Sequence
     C                     Z-ADDWAUENB    WL0171           Order Secondary
     C                     Z-ADDWAJGDT    WL0172           OD Production D
     C                     Z-ADD*ZERO     WL0173           OD Qty_Cnsmd Pi
     C                     Z-ADD*ZERO     WL0174           OD Weight Sched
     C                     Z-ADDWAIUQT    WL0175           OD Quantity Inv
     C                     Z-ADDWAF3WG    WL0176           OD Weight Inv S
     C                     MOVELWAP7ST    WL0177    P      OD Added to Sch
     C                     EXSR STCHRC
     C                     END                             *FI
     C                     SUB  WAIGQT    WL0015           Quantity Schedu
     C           WL0015    MULT WL0008    WL0016           Weight Schedule
      * FP1054 save this for prod whse update outside of this CASE
     C                     Z-ADDWUEOWG    WUF1WG           Weight Dealloca
     C                     END                             *FI
      * FP1054 New
      * CASE: PAR.Base/Conv/Loss Item is Base
     C           WL0009    IFEQ 'B'                        *IF
      * FP1054  Reduce order's warehouse standard prod too & prod whse tx
      * CASE: PAR.Warehouse Code NE LCL.Production Warehouse Code
     C           WL0005    IFNE YL0001                     *IF
      * use order's warehouse and company
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
     C                     EXSR SVRVGN
      * Move prod that was alloc to order's warehouse back to prod whse's
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
     C                     EXSR SXRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           WL0014    SUB  WL0016    WL0018           ATS Weight Need
     C           WL0013    SUB  WL0015    WL0017           ATS Quantity Ne
     C           KRSSA     READE@KNCPM6                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Productin Whs     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0020    WBAJCD           Warehouse Code
      * Establish starting position
     C           KRSSB     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0021           Production Ware
     C                     Z-ADD*ZERO     WL0022           Accounting Comp
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBAOCD    WL0021           Production Ware
     C                     Z-ADDWBBTC3    WL0022           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Type/Std Chil/Chil RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWAAJCD    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSC     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0016           Warehouse Type
     C                     MOVEL*BLANK    WN0017           Warehouse Std C
     C                     Z-ADD*ZERO     WN0018           Warehouse Chill
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCWPST    WN0016           Warehouse Type
     C                     MOVELWCT1ST    WN0017           Warehouse Std C
     C                     Z-ADDWCDBNB    WN0018           Warehouse Chill
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Val Sched Existance   RT - PS Prod Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDV5ST           Production Type
     C                     KFLD           WDELDT           Production Date
      * Setup key
     C                     Z-ADDWL0001    WDAIC3           Company Number
     C                     MOVELWN0005    WDV5ST           Production Type
     C                     Z-ADDWN0001    WDELDT           Production Date
      * Establish starting position
     C           KRSSD     CHAIN@JCCPVC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1795' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WUWXST           Record Found US
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUWXST           Record Found US
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SEDLRC    BEGSR
      *================================================================
      * DLT Ord Detail Sched   DL - PD Order Detail Schedule  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @KNCPHN
     C                     Z-ADDWL0023    WEAIC3           Company Number
     C                     Z-ADDWL0024    WEC4NB           Order Number
     C                     Z-ADDWL0025    WEDPNB           Order Sequence
     C                     Z-ADDWL0026    WEUENB           Order Secondary
     C                     Z-ADDWL0027    WEJGDT           OD Production D
      *
     C           KLDLSE    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C                     KFLD           WEJGDT           OD Production D
     C           KLDLSE    CHAIN@KNCPHN              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@KNCPHN                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv AvgPcWgt/Prd/PrdAl RT - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFV5ST           Production Type
     C                     KFLD           WFELDT           Production Date
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0028    WFAIC3           Company Number
     C                     MOVELWL0029    WFV5ST           Production Type
     C                     Z-ADDWL0030    WFELDT           Production Date
     C                     Z-ADDWL0031    WFHGCD           Item Code
     C                     MOVELWL0032    WFAJCD           Warehouse Code
      * Establish starting position
     C           KRSSF     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0033           PS Weight Plann
     C                     Z-ADD*ZERO     WL0034           PS Pieces Plann
     C                     Z-ADD*ZERO     WL0035           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WL0036           PS Weight Prod
     C                     Z-ADD*ZERO     WL0037           PS Pieces Prod
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFWTSP    WL0033           PS Weight Plann
     C                     Z-ADDWFQTSP    WL0034           PS Pieces Plann
     C                     Z-ADDWFF8WG    WL0035           PS Avg Piece Wg
     C                     Z-ADDWFOAWT    WL0036           PS Weight Prod
     C                     Z-ADDWFCDNB    WL0037           PS Pieces Prod
      * Total Production Weight
      * PAR.PS Weight Planned Prod =
      *    *COMPUTE (x1 + x2 - x3 - x4)
      * x1    : DB1.PS Weight Standard
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.PS Weight Prod Adj
      * -     : PGM.*Synon (17,7) work field
      * x3    : DB1.PS Weight Converted
      * -     : PGM.*Synon (17,7) work field
      * x4    : DB1.PS Weight Whs Tfr Adj
     C           WFDXWG    ADD  WFD1WG    W0WD02           *Synon (17,7) w
     C           W0WD02    SUB  WFWTCN    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WFGAWG    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WL0033           PS Weight Plann
      * Total Production Pieces
      * PAR.PS Pieces Planned Prod =
      *    *COMPUTE (x1 + x2 - x3 - x4)
      * x1    : DB1.PS Pieces Standard
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.PS Pieces Prod Adj
      * -     : PGM.*Synon (17,7) work field
      * x3    : DB1.PS Pieces Converted
      * -     : PGM.*Synon (17,7) work field
      * x4    : DB1.PS Pieces Whs Tfr Adj
     C           WFB2NB    ADD  WFCBNB    W0WD02           *Synon (17,7) w
     C           W0WD02    SUB  WFPSCV    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  WFBPNB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WL0034           PS Pieces Plann
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0019  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0020  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0021  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0022  72       PS Pct of Carca
     C                     Z-ADD*ZERO     WN0023  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0024  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0025  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0026  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0027  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0028  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0029  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0030  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0031  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0032  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0033  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0034  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0035  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0036  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0037  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0038  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0039  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0040  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0041  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0042 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0043  70       PS Pieces Whs T
     C                     Z-ADD*ZERO     WN0044 112       PS Weight Whs T
     C                     Z-ADD*ZERO     WN0045  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0046 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0047  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0048 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0049  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0050 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0051  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0052 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0053  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0054  3        PS Item Id
     C                     MOVEL*BLANK    WN0055  2        Warehouse Type
     C                     MOVEL*BLANK    WN0056  1        PS Lock Status
     C                     MOVEL*BLANK    WN0057  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0058  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0059  1        PS Piece Count
     C                     MOVEL*BLANK    WN0060  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0061  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0062  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0063  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0064  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0065  3        PS Production W
     C                     Z-ADD*ZERO     WN0066  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0067  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0068  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0069  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0070  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0071  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0072  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0073  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0074  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0075  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0076  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0077  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0078  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0079  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0080  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0081  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0082  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0083  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0084  6        Department Code
     C                     Z-ADD*ZERO     WN0085  30       Item Structure
     C                     Z-ADD*ZERO     WN0086  30       Item Structure
     C                     Z-ADD*ZERO     WN0087  30       Item Structure
     C                     MOVEL*BLANK    WN0088  6        Primal Group Co
     C                     MOVEL*BLANK    WN0089  1        EDI Status 1
     C                     MOVEL*BLANK    WN0090  1        EDI Status 2
     C                     MOVEL*BLANK    WN0091  1        EDI Status 3
     C                     MOVEL*BLANK    WN0092  1        Record Status
     C                     Z-ADD*ZERO     WN0093  60       Job Time
     C                     MOVEL*BLANK    WN0094 10        User Id
     C                     MOVEL*BLANK    WN0095 10        Job Name
     C                     Z-ADD*ZERO     WN0096  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFV5ST           Production Type
     C                     KFLD           WFELDT           Production Date
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0038    WFAIC3           Company Number
     C                     MOVELWL0039    WFV5ST           Production Type
     C                     Z-ADDWL0040    WFELDT           Production Date
     C                     Z-ADDWL0041    WFHGCD           Item Code
     C                     MOVELWL0042    WFAJCD           Warehouse Code
      * Establish starting position
     C           KRSSG     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADDWL0043    WN0038           PS Weight Prod
     C                     Z-ADDWL0044    WN0039           PS Pieces Prod
      * CASE: PAR.PS Pieces Prod Allocated is GT Zero
     C           WN0039    IFGT 0                          *IF
      * Average Piece Weight
      * PAR.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Prod Allocated
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Pieces Prod Allocated
     C           WN0038    DIV  WN0039    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0023           PS Avg Piece Wg
     C                     END                             *FI
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0038    WL0049           Company Number
     C                     MOVELWL0039    WL0050    P      Production Type
     C                     Z-ADDWL0040    WL0051           Production Date
     C                     Z-ADDWL0041    WL0052           Item Code
     C                     MOVELWL0042    WL0053    P      Warehouse Code
     C                     Z-ADDWN0019    WL0054           PS Available Sh
     C                     Z-ADDWN0020    WL0055           PS Weight Plann
     C                     Z-ADDWN0021    WL0056           PS Pieces Plann
     C                     Z-ADDWN0022    WL0057           PS Pct of Carca
     C                     Z-ADDWN0023    WL0058           PS Avg Piece Wg
     C                     Z-ADDWN0024    WL0059           PS Weight Inv O
     C                     Z-ADDWN0025    WL0060           PS Pieces Inv O
     C                     Z-ADDWN0026    WL0061           PS Weight Stand
     C                     Z-ADDWN0027    WL0062           PS Pieces Stand
     C                     Z-ADDWN0028    WL0063           PS Weight Conve
     C                     Z-ADDWN0029    WL0064           PS Pieces Conve
     C                     Z-ADDWN0030    WL0065           PS Weight Shipp
     C                     Z-ADDWN0031    WL0066           PS Pieces Shipp
     C                     Z-ADDWN0032    WL0067           PS Weight Prod
     C                     Z-ADDWN0033    WL0068           PS Pieces Prod
     C                     Z-ADDWN0034    WL0069           PS Weight Inv A
     C                     Z-ADDWN0035    WL0070           PS Pieces Inv A
     C                     Z-ADDWN0036    WL0071           PS Weight Ship
     C                     Z-ADDWN0037    WL0072           PS Pieces Ship
     C                     Z-ADDWN0038    WL0073           PS Weight Prod
     C                     Z-ADDWN0039    WL0074           PS Pieces Prod
     C                     Z-ADDWN0040    WL0075           PS Weight Inv A
     C                     Z-ADDWN0041    WL0076           PS Pieces Inv A
     C                     Z-ADDWN0042    WL0077           PS Unit Weight
     C                     Z-ADDWN0043    WL0078           PS Pieces Whs T
     C                     Z-ADDWN0044    WL0079           PS Weight Whs T
     C                     Z-ADDWN0045    WL0080           PS Pieces Unuse
     C                     Z-ADDWN0046    WL0081           PS Weight Unuse
     C                     Z-ADDWN0047    WL0082           PS Pieces Unuse
     C                     Z-ADDWN0048    WL0083           PS Weight Unuse
     C                     Z-ADDWN0049    WL0084           PS Pieces Unuse
     C                     Z-ADDWN0050    WL0085           PS Weight Unuse
     C                     Z-ADDWN0051    WL0086           PS Pieces Unuse
     C                     Z-ADDWN0052    WL0087           PS Weight Unuse
     C                     Z-ADDWN0053    WL0088           PS Pieces Unuse
     C                     MOVELWN0054    WL0089    P      PS Item Id
     C                     MOVELWN0055    WL0090    P      Warehouse Type
     C                     MOVELWN0056    WL0091    P      PS Lock Status
     C                     MOVELWN0057    WL0092    P      PS Export/Domes
     C                     MOVELWN0058    WL0093    P      PS Print On Sch
     C                     MOVELWN0059    WL0094    P      PS Piece Count
     C                     MOVELWN0060    WL0095    P      PS Unused Sts 1
     C                     MOVELWN0061    WL0096    P      PS Unused Sts 2
     C                     MOVELWN0062    WL0097    P      PS Unused Sts 3
     C                     MOVELWN0063    WL0098    P      PS Unused Sts 4
     C                     MOVELWN0064    WL0099    P      PS Item Sched N
     C                     MOVELWN0065    WL0100    P      PS Production W
     C                     Z-ADDWN0066    WL0101           PS Weight Order
     C                     Z-ADDWN0067    WL0102           PS Pieces Order
     C                     Z-ADDWN0068    WL0103           PS Weight FC Ad
     C                     Z-ADDWN0069    WL0104           PS Pieces FC Ad
     C                     Z-ADDWN0070    WL0105           PS Weight FX Ad
     C                     Z-ADDWN0071    WL0106           PS Pieces FX Ad
     C                     Z-ADDWN0072    WL0107           PS Weight Sched
     C                     Z-ADDWN0073    WL0108           PS Pieces Sched
     C                     Z-ADDWN0074    WL0109           PS Weight Avail
     C                     Z-ADDWN0075    WL0110           PS Pieces Avail
     C                     Z-ADDWN0076    WL0111           PS Weight Produ
     C                     Z-ADDWN0077    WL0112           PS Pieces Produ
     C                     Z-ADDWN0078    WL0113           PS Weight Fab N
     C                     Z-ADDWN0079    WL0114           PS Pieces Fab N
     C                     Z-ADDWN0080    WL0115           PS Weight Sched
     C                     Z-ADDWN0081    WL0116           PS Pieces Sched
     C                     Z-ADDWN0082    WL0117           PS Weight Sched
     C                     Z-ADDWN0083    WL0118           PS Pieces Sched
     C                     MOVELWN0084    WL0119    P      Department Code
     C                     Z-ADDWN0085    WL0120           Item Structure
     C                     Z-ADDWN0086    WL0121           Item Structure
     C                     Z-ADDWN0087    WL0122           Item Structure
     C                     MOVELWN0088    WL0123    P      Primal Group Co
     C                     MOVELWN0089    WL0124    P      EDI Status 1
     C                     MOVELWN0090    WL0125    P      EDI Status 2
     C                     MOVELWN0091    WL0126    P      EDI Status 3
     C                     MOVELWN0092    WL0127    P      Record Status
     C                     Z-ADDWN0093    WL0128           Job Time
     C                     MOVELWN0094    WL0129    P      User Id
     C                     MOVELWN0095    WL0130    P      Job Name
     C                     Z-ADDWN0096    WL0131           Job Date
     C                     EXSR SHCRRC
      * FP1054 create consumed records
      * Create/update/delete Order Detail Sched-Consmd (POB6CPP)
      * CASE: PAR.Order Number is Greater then zero
     C           WL0045    IFGT 0                          *IF
      * RMC 10-05 20 use ord co instead of par.company which is acctng
      * RTV Company for Ord   RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0045    WL0137           Order Number
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0136    YL0004           Company Number
      * Rtv Next Seq for Ord/ItRT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0004    WL0138           Company Number
     C                     Z-ADDWL0045    WL0139           Order Number
     C                     Z-ADDWL0046    WL0140           Order Sequence
     C                     Z-ADDWL0047    WL0141           Order Secondary
     C                     Z-ADDWL0040    WL0142           OD Production D
     C                     Z-ADDYL0005    WL0143           ODS Sequence Nu
     C                     Z-ADDWL0041    WL0144           Consumed Item C
     C                     Z-ADDWL0041    WL0145           Item Code
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0143    YL0005           ODS Sequence Nu
      * CASE: LCL.ODS Sequence Number is zero
     C           YL0005    IFEQ 0                          *IF
      * Rtv Next Seq for Key  RT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0004    WL0146           Company Number
     C                     Z-ADDWL0045    WL0147           Order Number
     C                     Z-ADDWL0046    WL0148           Order Sequence
     C                     Z-ADDWL0047    WL0149           Order Secondary
     C                     Z-ADDWL0040    WL0150           OD Production D
     C                     Z-ADDYL0005    WL0151           ODS Sequence Nu
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0151    YL0005           ODS Sequence Nu
     C                     END                             *FI
      * Upd OrdDtl Sch-Consmd RT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0004    WL0152           Company Number
     C                     Z-ADDWL0045    WL0153           Order Number
     C                     Z-ADDWL0046    WL0154           Order Sequence
     C                     Z-ADDWL0047    WL0155           Order Secondary
     C                     Z-ADDWL0040    WL0156           OD Production D
     C                     Z-ADDYL0005    WL0157           ODS Sequence Nu
     C                     Z-ADD*ZERO     WL0158           Scheduled Ship
     C                     MOVELWL0042    WL0159    P      Warehouse Code
     C                     Z-ADDWL0041    WL0160           Consumed Item C
     C                     Z-ADDWL0041    WL0161           Item Code
     C                     Z-ADDWL0044    WL0162           OD Qty_Cnsmd Pi
     C                     Z-ADDWL0043    WL0163           OD Weight Sched
     C                     Z-ADD*ZERO     WL0164           ODS Quantity Sh
     C                     Z-ADD*ZERO     WL0165           ODS Weight Shor
     C                     Z-ADD*ZERO     WL0166           Deadline Depart
     C                     Z-ADD*ZERO     WL0167           Deadline Depart
     C                     EXSR SORVGN
     C                     END                             *FI
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WFOAWT    ADD  WL0043    WN0038           PS Weight Prod
     C           WFCDNB    ADD  WL0044    WN0039           PS Pieces Prod
      * Chg Prod Allocated    CH - PS Prod Item Schedule  * 
     C                     EXSR SSCHRC
      * FP1054 create/delete consumed records - if called from PRD routin
      *  and STD was allocated
      * CASE: PAR.Status Flag 19 Y/N is Yes
     C           WL0048    IFEQ 'Y'                        *IF
      * Create/update/delete Order Detail Sched-Consmd (POB6CPP)
      * CASE: PAR.Order Number is Greater then zero
     C           WL0045    IFGT 0                          *IF
      * RMC 10-05-2020 was par.company number which is acctng
      * RTV Company for Ord   RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0045    WL0137           Order Number
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0136    YL0004           Company Number
      * Rtv Next Seq for Ord/ItRT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0004    WL0138           Company Number
     C                     Z-ADDWL0045    WL0139           Order Number
     C                     Z-ADDWL0046    WL0140           Order Sequence
     C                     Z-ADDWL0047    WL0141           Order Secondary
     C                     Z-ADDWL0040    WL0142           OD Production D
     C                     Z-ADDYL0005    WL0143           ODS Sequence Nu
     C                     Z-ADDWL0041    WL0144           Consumed Item C
     C                     Z-ADDWL0041    WL0145           Item Code
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0143    YL0005           ODS Sequence Nu
      * CASE: LCL.ODS Sequence Number is zero
     C           YL0005    IFEQ 0                          *IF
      * Rtv Next Seq for Key  RT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0004    WL0146           Company Number
     C                     Z-ADDWL0045    WL0147           Order Number
     C                     Z-ADDWL0046    WL0148           Order Sequence
     C                     Z-ADDWL0047    WL0149           Order Secondary
     C                     Z-ADDWL0040    WL0150           OD Production D
     C                     Z-ADDYL0005    WL0151           ODS Sequence Nu
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0151    YL0005           ODS Sequence Nu
     C                     END                             *FI
      * Upd OrdDtl Sch-Consmd RT - Order Detail Sched-Consmd  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0004    WL0152           Company Number
     C                     Z-ADDWL0045    WL0153           Order Number
     C                     Z-ADDWL0046    WL0154           Order Sequence
     C                     Z-ADDWL0047    WL0155           Order Secondary
     C                     Z-ADDWL0040    WL0156           OD Production D
     C                     Z-ADDYL0005    WL0157           ODS Sequence Nu
     C                     Z-ADD*ZERO     WL0158           Scheduled Ship
     C                     MOVELWL0042    WL0159    P      Warehouse Code
     C                     Z-ADDWL0041    WL0160           Consumed Item C
     C                     Z-ADDWL0041    WL0161           Item Code
     C                     Z-ADDWL0044    WL0162           OD Qty_Cnsmd Pi
     C                     Z-ADDWL0043    WL0163           OD Weight Sched
     C                     Z-ADD*ZERO     WL0164           ODS Quantity Sh
     C                     Z-ADD*ZERO     WL0165           ODS Weight Shor
     C                     Z-ADD*ZERO     WL0166           Deadline Depart
     C                     Z-ADD*ZERO     WL0167           Deadline Depart
     C                     EXSR SORVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCRRC    BEGSR
      *================================================================
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @I8CPUR
     C                     Z-ADDWL0049    WGAIC3           Company Number
     C                     MOVELWL0050    WGV5ST           Production Type
     C                     Z-ADDWL0051    WGELDT           Production Date
     C                     Z-ADDWL0052    WGHGCD           Item Code
     C                     MOVELWL0053    WGAJCD           Warehouse Code
     C                     Z-ADDWL0054    WGGPDT           PS Available Sh
     C                     Z-ADDWL0055    WGWTSP           PS Weight Plann
     C                     Z-ADDWL0056    WGQTSP           PS Pieces Plann
     C                     Z-ADDWL0057    WGDJPC           PS Pct of Carca
     C                     Z-ADDWL0058    WGF8WG           PS Avg Piece Wg
     C                     Z-ADDWL0059    WGWTIN           PS Weight Inv O
     C                     Z-ADDWL0060    WGD5NB           PS Pieces Inv O
     C                     Z-ADDWL0061    WGDXWG           PS Weight Stand
     C                     Z-ADDWL0062    WGB2NB           PS Pieces Stand
     C                     Z-ADDWL0063    WGWTCN           PS Weight Conve
     C                     Z-ADDWL0064    WGPSCV           PS Pieces Conve
     C                     Z-ADDWL0065    WGSAWT           PS Weight Shipp
     C                     Z-ADDWL0066    WGB9NB           PS Pieces Shipp
     C                     Z-ADDWL0067    WGD1WG           PS Weight Prod
     C                     Z-ADDWL0068    WGCBNB           PS Pieces Prod
     C                     Z-ADDWL0069    WGEZWG           PS Weight Inv A
     C                     Z-ADDWL0070    WGCCNB           PS Pieces Inv A
     C                     Z-ADDWL0071    WGE0WG           PS Weight Ship
     C                     Z-ADDWL0072    WGD6NB           PS Pieces Ship
     C                     Z-ADDWL0073    WGOAWT           PS Weight Prod
     C                     Z-ADDWL0074    WGCDNB           PS Pieces Prod
     C                     Z-ADDWL0075    WGUNW2           PS Weight Inv A
     C                     Z-ADDWL0076    WGCENB           PS Pieces Inv A
     C                     Z-ADDWL0077    WGF9WG           PS Unit Weight
     C                     Z-ADDWL0078    WGBPNB           PS Pieces Whs T
     C                     Z-ADDWL0079    WGGAWG           PS Weight Whs T
     C                     Z-ADDWL0080    WGBQNB           PS Pieces Unuse
     C                     Z-ADDWL0081    WGGBWG           PS Weight Unuse
     C                     Z-ADDWL0082    WGBRNB           PS Pieces Unuse
     C                     Z-ADDWL0083    WGGCWG           PS Weight Unuse
     C                     Z-ADDWL0084    WGBSNB           PS Pieces Unuse
     C                     Z-ADDWL0085    WGGDWG           PS Weight Unuse
     C                     Z-ADDWL0086    WGBWNB           PS Pieces Unuse
     C                     Z-ADDWL0087    WGGEWG           PS Weight Unuse
     C                     Z-ADDWL0088    WGPS6U           PS Pieces Unuse
     C                     MOVELWL0089    WGWCST           PS Item Id
     C                     MOVELWL0090    WGWPST           Warehouse Type
     C                     MOVELWL0091    WGB5ST           PS Lock Status
     C                     MOVELWL0092    WGTFST           PS Export/Domes
     C                     MOVELWL0093    WGTEST           PS Print On Sch
     C                     MOVELWL0094    WGTHST           PS Piece Count
     C                     MOVELWL0095    WGUDST           PS Unused Sts 1
     C                     MOVELWL0096    WGUFST           PS Unused Sts 2
     C                     MOVELWL0097    WGUGST           PS Unused Sts 3
     C                     MOVELWL0098    WGUHST           PS Unused Sts 4
     C                     MOVELWL0099    WGB6ST           PS Item Sched N
     C                     MOVELWL0100    WGB7ST           PS Production W
     C                     Z-ADDWL0101    WGDVWG           PS Weight Order
     C                     Z-ADDWL0102    WGD7NB           PS Pieces Order
     C                     Z-ADDWL0103    WGFCAD           PS Weight FC Ad
     C                     Z-ADDWL0104    WGD9NB           PS Pieces FC Ad
     C                     Z-ADDWL0105    WGDWWG           PS Weight FX Ad
     C                     Z-ADDWL0106    WGEANB           PS Pieces FX Ad
     C                     Z-ADDWL0107    WGSHWT           PS Weight Sched
     C                     Z-ADDWL0108    WGEBNB           PS Pieces Sched
     C                     Z-ADDWL0109    WGAVWT           PS Weight Avail
     C                     Z-ADDWL0110    WGECNB           PS Pieces Avail
     C                     Z-ADDWL0111    WGWTON           PS Weight Produ
     C                     Z-ADDWL0112    WGEDNB           PS Pieces Produ
     C                     Z-ADDWL0113    WGFNWT           PS Weight Fab N
     C                     Z-ADDWL0114    WGEENB           PS Pieces Fab N
     C                     Z-ADDWL0115    WGQTAS           PS Weight Sched
     C                     Z-ADDWL0116    WGEFNB           PS Pieces Sched
     C                     Z-ADDWL0117    WGWAIO           PS Weight Sched
     C                     Z-ADDWL0118    WGEGNB           PS Pieces Sched
     C                     MOVELWL0119    WGR3CD           Department Code
     C                     Z-ADDWL0120    WGRGNB           Item Structure
     C                     Z-ADDWL0121    WGRHNB           Item Structure
     C                     Z-ADDWL0122    WGRINB           Item Structure
     C                     MOVELWL0123    WGXRCD           Primal Group Co
     C                     MOVELWL0124    WGUVST           EDI Status 1
     C                     MOVELWL0125    WGUWST           EDI Status 2
     C                     MOVELWL0126    WGUXST           EDI Status 3
     C                     MOVELWL0127    WGVSST           Record Status
     C                     Z-ADDWL0128    WGAATM           Job Time
     C                     MOVELWL0129    WGAYNA           User Id
     C                     MOVELWL0130    WGA0NA           Job Name
     C                     Z-ADDWL0131    WGAXDT           Job Date
      *
      * USER: Processing before Data update
      * BPS Setup Item Info   IF
      *
     C                     Z-ADD*ZERO     WN0097 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
     C                     EXSR SIRVGN
      * BPS Rtv Whs Info      RT - Warehouse  * 
     C                     EXSR SJRVGN
      * BPS Set Up Item Id    IF
      * CASE: PAR.Item Type Code is Raw Materials
     C           WUN0CD    IFEQ 'RM'                       *IF
     C                     MOVEL'RMB'     WGWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Seconds Item is Yes
     C           WUX5ST    IFEQ 'Y'                        *IF
     C                     MOVEL'FSC'     WGWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Variety/Rendered/Cut is Variety
     C           WUXWST    IFEQ 'V'                        *IF
     C                     MOVEL'FVR'     WGWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Rendered
     C           WUXWST    IFEQ 'R'                        *IF
     C                     MOVEL'FRD'     WGWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Cut
     C           WUXWST    IFEQ 'C'                        *IF
      * Base/Converted/Fabricated
      * CASE: PAR.Credit Item Status is yes
     C           WUVMST    IFEQ 'Y'                        *IF
      * Setup Base/Converted/Fabricated Credit
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FBC'     WGWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCC'     WGWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFC'     WGWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLC'     WGWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup Base/Converted/Fabricated
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FGB'     WGWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCV'     WGWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFB'     WGWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLS'     WGWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Output PS Prod Warehouse
      * Rtv Productin Whs     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWGAJCD    WL0020    P      Warehouse Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0021    WGB7ST    P      Production Ware
     C                     Z-ADDWL0022    YL0003           Accounting Comp
      * Available Ship Date
      * CASE: WRK.Warehouse Std Chill Time is yes
     C           WUT1ST    IFEQ 'Y'                        *IF
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWGAIC3    WL0132           Company Number
     C                     Z-ADDWL0051    WL0133           Post to G_L Dat
     C                     Z-ADDWUDBNB    WL0134           Fresh Chilling
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0135    WGGPDT           PS Available Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWGAIC3    WL0132           Company Number
     C                     Z-ADDWL0051    WL0133           Post to G_L Dat
     C                     Z-ADDWUCHTM    WL0134           Fresh Chilling
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0135    WGGPDT           PS Available Sh
     C                     END                             *FI
      * Average Piece Weight
      * CASE: PAR.PS Pieces Planned Prod is GT Zero
     C           WL0056    IFGT 0                          *IF
     C           WL0055    DIV  WL0056    WGF8WG           PS Avg Piece Wg
     C                     END                             *FI
      * UPS CRTOBJ Stamp      IF
     C                     MOVEL'A'       WGVSST           Record Status
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##PGM     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
     C                     MOVEL'N'       WGB5ST           PS Lock Status
     C           KLCRSH    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGV5ST           Production Type
     C                     KFLD           WGELDT           Production Date
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
      * Check for duplicate primary key
     C           KLCRSH    SETLL@I8CPUR                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1764' W0RTN   7
      * Send message 'PS Prod Item Schedule  EX'
     C                     MOVEL'USR1764' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C                     WRITE@I8CPUR                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHHGCD           Item Code
      * Setup key
     C                     Z-ADDWGAIC3    WHAIC3           Company Number
     C                     Z-ADDWGHGCD    WHHGCD           Item Code
      * Establish starting position
     C           KRSSI     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAVNA           Description Lin
     C                     MOVEL*BLANK    WUADCD           UOM Primary
     C                     Z-ADD*ZERO     WUAIWG           Unit Weight
     C                     Z-ADD*ZERO     WGRINB           Item Structure
     C                     Z-ADD*ZERO     WGRHNB           Item Structure
     C                     Z-ADD*ZERO     WGRGNB           Item Structure
     C                     MOVEL*BLANK    WUN0CD           Item Type Code
     C                     MOVEL*BLANK    WUQ1CD           Default Warehou
     C                     Z-ADD*ZERO     WUCHTM           Fresh Chilling
     C                     MOVEL*BLANK    WUQZCD           Base_Conv_Loss
     C                     MOVEL*BLANK    WUXWST           Variety_Rendere
     C                     MOVEL*BLANK    WUVMST           Credit Item Sta
     C                     Z-ADD*ZERO     WUSWGH           Std Weight_Head
     C                     Z-ADD*ZERO     WUPPHE           Pieces Per Head
     C                     MOVEL*BLANK    WGR3CD           Department Code
     C                     MOVEL*BLANK    WUSDCD           Group for Packa
     C                     MOVEL*BLANK    WUX5ST           Seconds Item
     C                     MOVEL*BLANK    WGTHST           Piece Count Ite
     C                     Z-ADD*ZERO     WUBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WUBJNB           Bags Per Unit
     C                     MOVEL*BLANK    WGTFST           Export_Domestic
     C                     MOVEL*BLANK    WGTEST           Print On Schedu
     C                     MOVEL*BLANK    WUSYST           Fresh Inv Alloc
     C                     MOVEL*BLANK    WUSZST           Fresh Sched As
     C                     MOVEL*BLANK    WUS1ST           Frozen Inv Allo
     C                     MOVEL*BLANK    WGXRCD           Primal Group Co
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHAVNA    WUAVNA           Description Lin
     C                     MOVELWHADCD    WUADCD           UOM Primary
     C                     Z-ADDWHAIWG    WUAIWG           Unit Weight
     C                     Z-ADDWHRINB    WGRINB           Item Structure
     C                     Z-ADDWHRHNB    WGRHNB           Item Structure
     C                     Z-ADDWHRGNB    WGRGNB           Item Structure
     C                     MOVELWHN0CD    WUN0CD           Item Type Code
     C                     MOVELWHQ1CD    WUQ1CD           Default Warehou
     C                     Z-ADDWHCHTM    WUCHTM           Fresh Chilling
     C                     MOVELWHQZCD    WUQZCD           Base_Conv_Loss
     C                     MOVELWHXWST    WUXWST           Variety_Rendere
     C                     MOVELWHVMST    WUVMST           Credit Item Sta
     C                     Z-ADDWHSWGH    WUSWGH           Std Weight_Head
     C                     Z-ADDWHPPHE    WUPPHE           Pieces Per Head
     C                     MOVELWHR3CD    WGR3CD           Department Code
     C                     MOVELWHSDCD    WUSDCD           Group for Packa
     C                     MOVELWHX5ST    WUX5ST           Seconds Item
     C                     MOVELWHPCCT    WGTHST           Piece Count Ite
     C                     Z-ADDWHBDNB    WUBDNB           Pieces Per Bag
     C                     Z-ADDWHBJNB    WUBJNB           Bags Per Unit
     C                     MOVELWHSUST    WGTFST           Export_Domestic
     C                     MOVELWHSVST    WGTEST           Print On Schedu
     C                     MOVELWHSYST    WUSYST           Fresh Inv Alloc
     C                     MOVELWHSZST    WUSZST           Fresh Sched As
     C                     MOVELWHS1ST    WUS1ST           Frozen Inv Allo
     C                     MOVELWHXRCD    WGXRCD           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * BPS Rtv Whs Info      RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWGAJCD    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSJ     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WGWPST           Warehouse Type
     C                     MOVEL*BLANK    WUXUST           Trans Contol AS
     C                     MOVEL*BLANK    WUT0ST           Warehouse Locat
     C                     MOVEL*BLANK    WUT1ST           Warehouse Std C
     C                     Z-ADD*ZERO     WUDBNB           Warehouse Chill
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCWPST    WGWPST           Warehouse Type
     C                     MOVELWCXUST    WUXUST           Trans Contol AS
     C                     MOVELWCT0ST    WUT0ST           Warehouse Locat
     C                     MOVELWCT1ST    WUT1ST           Warehouse Std C
     C                     Z-ADDWCDBNB    WUDBNB           Warehouse Chill
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIAIC3    WQSK01           Company Number
      * Define keylist
     C           KPSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WIBCDT           Post to G_L Dat
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Company Number
      * Setup key
     C                     Z-ADDWL0132    WQSK01           Company Number
     C                     Z-ADDWL0133    WIBCDT           Post to G_L Dat
      * Establish starting position
     C           KPSSK     SETLL@AFREBE                    *
     C           KRSSK     READE@AFREBE                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Count USR EQ PAR.Chilling Time
     C           WUCNTU    IFEQ WL0134                     *IF
     C                     Z-ADDWIBCDT    WL0135           PS Available Sh
     C                     GOTO SKEXIT                     *QUIT
     C                     END                             *FI
      * Skip Saturday
      * CASE: DB1.Day of Week is Saturday
     C           WIA9ST    IFEQ '7'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C           KRSSK     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Company for Ord   RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJC4NB    WQSL01           Order Number
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Order Number
      * Setup key
     C                     Z-ADDWL0137    WQSL01           Order Number
      * Establish starting position
     C           KRSSL     SETLL@BFCPY2                    *
     C           KRSSL     READE@BFCPY2                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWJAIC3    WL0136           Company Number
     C           KRSSL     READE@BFCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Next Seq for Ord/ItRT - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WL0143           ODS Sequence Nu
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKAIC3    WQSM01           Company Number
     C           *LIKE     DEFN WKC4NB    WQSM02           Order Number
     C           *LIKE     DEFN WKDPNB    WQSM03           Order Sequence
     C           *LIKE     DEFN WKUENB    WQSM04           Order Secondary
     C           *LIKE     DEFN WKJGDT    WQSM05           OD Production D
     C           *LIKE     DEFN WKNUDT    WQSM06           Consumed Item C
     C           *LIKE     DEFN WKHGCD    WQSM07           Item Code
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Order Number
     C                     KFLD           WQSM03           Order Sequence
     C                     KFLD           WQSM04           Order Secondary
     C                     KFLD           WQSM05           OD Production D
     C                     KFLD           WQSM06           Consumed Item C
     C                     KFLD           WQSM07           Item Code
      * Setup key
     C                     Z-ADDWL0138    WQSM01           Company Number
     C                     Z-ADDWL0139    WQSM02           Order Number
     C                     Z-ADDWL0140    WQSM03           Order Sequence
     C                     Z-ADDWL0141    WQSM04           Order Secondary
     C                     Z-ADDWL0142    WQSM05           OD Production D
     C                     Z-ADDWL0144    WQSM06           Consumed Item C
     C                     Z-ADDWL0145    WQSM07           Item Code
      * Establish starting position
     C           KRSSM     SETLL@B6CPAG                    *
     C           KRSSM     READE@B6CPAG                  90*
      * Data record not found
     C   90                MOVEL'USR3152' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWKOONY    WL0143           ODS Sequence Nu
     C           KRSSM     READE@B6CPAG                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Next Seq for Key  RT - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0151           ODS Sequence Nu
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLAIC3    WQSN01           Company Number
     C           *LIKE     DEFN WLC4NB    WQSN02           Order Number
     C           *LIKE     DEFN WLDPNB    WQSN03           Order Sequence
     C           *LIKE     DEFN WLUENB    WQSN04           Order Secondary
     C           *LIKE     DEFN WLJGDT    WQSN05           OD Production D
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           Order Number
     C                     KFLD           WQSN03           Order Sequence
     C                     KFLD           WQSN04           Order Secondary
     C                     KFLD           WQSN05           OD Production D
      * Setup key
     C                     Z-ADDWL0146    WQSN01           Company Number
     C                     Z-ADDWL0147    WQSN02           Order Number
     C                     Z-ADDWL0148    WQSN03           Order Sequence
     C                     Z-ADDWL0149    WQSN04           Order Secondary
     C                     Z-ADDWL0150    WQSN05           OD Production D
      * Establish starting position
     C           KRSSN     SETLL@B6CPNB                    *
     C           KRSSN     READE@B6CPNB                  90*
      * Data record not found
     C   90                MOVEL'USR3152' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWLOONY    WL0151           ODS Sequence Nu
     C           KRSSN     READE@B6CPNB                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     ADD  1         WL0151           ODS Sequence Nu
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Upd OrdDtl Sch-Consmd RT - Order Detail Sched-Consmd  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0098  1        EDI Status 1
     C                     MOVEL*BLANK    WN0099  1        EDI Status 2
     C                     MOVEL*BLANK    WN0100  1        EDI Status 3
     C                     MOVEL*BLANK    WN0101  1        Record Status
     C                     Z-ADD*ZERO     WN0102  60       Job Time
     C                     MOVEL*BLANK    WN0103 10        User Id
     C                     MOVEL*BLANK    WN0104 10        Job Name
     C                     Z-ADD*ZERO     WN0105  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLC4NB           Order Number
     C                     KFLD           WLDPNB           Order Sequence
     C                     KFLD           WLUENB           Order Secondary
     C                     KFLD           WLJGDT           OD Production D
     C                     KFLD           WLOONY           ODS Sequence Nu
      * Setup key
     C                     Z-ADDWL0152    WLAIC3           Company Number
     C                     Z-ADDWL0153    WLC4NB           Order Number
     C                     Z-ADDWL0154    WLDPNB           Order Sequence
     C                     Z-ADDWL0155    WLUENB           Order Secondary
     C                     Z-ADDWL0156    WLJGDT           OD Production D
     C                     Z-ADDWL0157    WLOONY           ODS Sequence Nu
      * Establish starting position
     C           KRSSO     CHAIN@B6CPNB              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3152' W0RTN   7
      * USER: Processing if Data record not found
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.OD Pieces Scheduled is Greater than zero
      *   |- c2    : PAR.OD Weight Scheduled is Greater than zero
      *   '-
     C           WL0162    IFGT 0                          *IF
     C           WL0163    ORGT 0                          *OR
      * Crt OrdDtl Sch-Consmd CR - Order Detail Sched-Consmd  * 
     C                     EXSR SPCRRC
     C                     END                             *FI
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WLFLWG    ADD  WL0163    YL0006           OD Weight Sched
     C           WLIGQT    ADD  WL0162    YL0007           OD Qty_Cnsmd Pi
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.OD Pieces Scheduled is Less than or equal zero
      *   |- c2    : LCL.OD Weight Scheduled is Less than or equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0007    IFLE 0                          *IF
     C           YL0006    IFLE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Del OrdDtl Sch-Consmd DL - Order Detail Sched-Consmd  * 
     C                     EXSR SQDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg OrdDtl Sch-Consmd CH - Order Detail Sched-Consmd  * 
     C                     EXSR SRCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCRRC    BEGSR
      *================================================================
      * Crt OrdDtl Sch-Consmd CR - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPNA
     C                     Z-ADDWL0152    WMAIC3           Company Number
     C                     Z-ADDWL0153    WMC4NB           Order Number
     C                     Z-ADDWL0154    WMDPNB           Order Sequence
     C                     Z-ADDWL0155    WMUENB           Order Secondary
     C                     Z-ADDWL0156    WMJGDT           OD Production D
     C                     Z-ADDWL0157    WMOONY           ODS Sequence Nu
     C                     Z-ADDWL0158    WMAODT           Scheduled Ship
     C                     MOVELWL0159    WMAJCD           Warehouse Code
     C                     Z-ADDWL0160    WMNUDT           Consumed Item C
     C                     Z-ADDWL0161    WMHGCD           Item Code
     C                     Z-ADDWL0162    WMIGQT           OD Qty_Cnsmd Pi
     C                     Z-ADDWL0163    WMFLWG           OD Weight Sched
     C                     Z-ADDWL0164    WMNSQT           ODS Quantity Sh
     C                     Z-ADDWL0165    WMJQWG           ODS Weight Shor
     C                     Z-ADDWL0166    WMNVDT           Deadline Depart
     C                     Z-ADDWL0167    WMBUTM           Deadline Depart
     C                     MOVELWN0098    WMUVST           EDI Status 1
     C                     MOVELWN0099    WMUWST           EDI Status 2
     C                     MOVELWN0100    WMUXST           EDI Status 3
     C                     MOVELWN0101    WMVSST           Record Status
     C                     Z-ADDWN0102    WMAATM           Job Time
     C                     MOVELWN0103    WMAYNA           User Id
     C                     MOVELWN0104    WMA0NA           Job Name
     C                     Z-ADDWN0105    WMAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WMVSST           Record Status
     C                     Z-ADD##JTM     WMAATM           Job Time
     C                     MOVEL##USR     WMAYNA           User Id
     C                     MOVEL##PGM     WMA0NA           Job Name
     C                     Z-ADD##JDT     WMAXDT           Job Date
     C           KLCRSP    KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMC4NB           Order Number
     C                     KFLD           WMDPNB           Order Sequence
     C                     KFLD           WMUENB           Order Secondary
     C                     KFLD           WMJGDT           OD Production D
     C                     KFLD           WMOONY           ODS Sequence Nu
      * Check for duplicate primary key
     C           KLCRSP    SETLL@B6CPNA                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3153' W0RTN   7
      * Send message 'Order Detail Sched_Con EX'
     C                     MOVEL'USR3153' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPNA                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQDLRC    BEGSR
      *================================================================
      * Del OrdDtl Sch-Consmd DL - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B6CPNA
     C                     Z-ADDWLAIC3    WMAIC3           Company Number
     C                     Z-ADDWLC4NB    WMC4NB           Order Number
     C                     Z-ADDWLDPNB    WMDPNB           Order Sequence
     C                     Z-ADDWLUENB    WMUENB           Order Secondary
     C                     Z-ADDWLJGDT    WMJGDT           OD Production D
     C                     Z-ADDWLOONY    WMOONY           ODS Sequence Nu
      *
     C           KLDLSQ    KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMC4NB           Order Number
     C                     KFLD           WMDPNB           Order Sequence
     C                     KFLD           WMUENB           Order Secondary
     C                     KFLD           WMJGDT           OD Production D
     C                     KFLD           WMOONY           ODS Sequence Nu
     C           KLDLSQ    CHAIN@B6CPNA              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB6CPL0'MDACP
     C                     MOVEL'@B6CPNA' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B6CPNA                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCHRC    BEGSR
      *================================================================
      * Chg OrdDtl Sch-Consmd CH - Order Detail Sched-Consmd  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0106  1        EDI Status 1
     C                     MOVEL*BLANK    WN0107  1        EDI Status 2
     C                     MOVEL*BLANK    WN0108  1        EDI Status 3
     C                     MOVEL*BLANK    WN0109  1        Record Status
     C                     Z-ADD*ZERO     WN0110  60       Job Time
     C                     MOVEL*BLANK    WN0111 10        User Id
     C                     MOVEL*BLANK    WN0112 10        Job Name
     C                     Z-ADD*ZERO     WN0113  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @B6CPNA
     C                     Z-ADDWLAIC3    WMAIC3           Company Number
     C                     Z-ADDWLC4NB    WMC4NB           Order Number
     C                     Z-ADDWLDPNB    WMDPNB           Order Sequence
     C                     Z-ADDWLUENB    WMUENB           Order Secondary
     C                     Z-ADDWLJGDT    WMJGDT           OD Production D
     C                     Z-ADDWLOONY    WMOONY           ODS Sequence Nu
      *
     C           KLCHSR    KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMC4NB           Order Number
     C                     KFLD           WMDPNB           Order Sequence
     C                     KFLD           WMUENB           Order Secondary
     C                     KFLD           WMJGDT           OD Production D
     C                     KFLD           WMOONY           ODS Sequence Nu
     C           KLCHSR    CHAIN@B6CPNA              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB6CPL0'MDACP
     C                     MOVEL'@B6CPNA' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPOB61    YARDCS
      * Move non-key fields to @B6CPNA
     C                     Z-ADDWL0158    WMAODT           Scheduled Ship
     C                     MOVELWL0159    WMAJCD    P      Warehouse Code
     C                     Z-ADDWL0160    WMNUDT           Consumed Item C
     C                     Z-ADDWL0161    WMHGCD           Item Code
     C                     Z-ADDYL0007    WMIGQT           OD Qty_Cnsmd Pi
     C                     Z-ADDYL0006    WMFLWG           OD Weight Sched
     C                     Z-ADDWLNSQT    WMNSQT           ODS Quantity Sh
     C                     Z-ADDWLJQWG    WMJQWG           ODS Weight Shor
     C                     Z-ADD*ZERO     WMNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WMBUTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QPOB61    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WMAATM           Job Time
     C                     MOVEL##USR     WMAYNA           User Id
     C                     MOVEL##JOB     WMA0NA           Job Name
     C                     Z-ADD##JDT     WMAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPOB61    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@B6CPNA                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPOB6CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCHRC    BEGSR
      *================================================================
      * Chg Prod Allocated    CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0114  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0115  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0116  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0117  72       PS Pct of Carca
     C                     Z-ADD*ZERO     WN0118  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0119  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0120  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0121  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0122  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0123  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0124  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0125  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0126  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0127  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0128  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0129  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0130  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0131  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0132  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0133  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0134 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0135  70       PS Pieces Whs T
     C                     Z-ADD*ZERO     WN0136 112       PS Weight Whs T
     C                     Z-ADD*ZERO     WN0137  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0138 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0139  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0140 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0141  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0142 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0143  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0144 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0145  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0146  3        PS Item Id
     C                     MOVEL*BLANK    WN0147  2        Warehouse Type
     C                     MOVEL*BLANK    WN0148  1        PS Lock Status
     C                     MOVEL*BLANK    WN0149  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0150  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0151  1        PS Piece Count
     C                     MOVEL*BLANK    WN0152  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0153  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0154  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0155  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0156  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0157  3        PS Production W
     C                     Z-ADD*ZERO     WN0158  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0159  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0160  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0161  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0162  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0163  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0164  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0165  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0166  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0167  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0168  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0169  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0170  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0171  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0172  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0173  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0174  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0175  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0176  6        Department Code
     C                     Z-ADD*ZERO     WN0177  30       Item Structure
     C                     Z-ADD*ZERO     WN0178  30       Item Structure
     C                     Z-ADD*ZERO     WN0179  30       Item Structure
     C                     MOVEL*BLANK    WN0180  6        Primal Group Co
     C                     MOVEL*BLANK    WN0181  1        EDI Status 1
     C                     MOVEL*BLANK    WN0182  1        EDI Status 2
     C                     MOVEL*BLANK    WN0183  1        EDI Status 3
     C                     MOVEL*BLANK    WN0184  1        Record Status
     C                     Z-ADD*ZERO     WN0185  60       Job Time
     C                     MOVEL*BLANK    WN0186 10        User Id
     C                     MOVEL*BLANK    WN0187 10        Job Name
     C                     Z-ADD*ZERO     WN0188  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWFAIC3    WGAIC3           Company Number
     C                     MOVELWFV5ST    WGV5ST    P      Production Type
     C                     Z-ADDWFELDT    WGELDT           Production Date
     C                     Z-ADDWFHGCD    WGHGCD           Item Code
     C                     MOVELWFAJCD    WGAJCD    P      Warehouse Code
      *
     C           KLCHSS    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGV5ST           Production Type
     C                     KFLD           WGELDT           Production Date
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
     C           KLCHSS    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YBRDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWFF8WG    WGF8WG           PS Avg Piece Wg
     C                     Z-ADDWN0038    WGOAWT           PS Weight Prod
     C                     Z-ADDWN0039    WGCDNB           PS Pieces Prod
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * UPS CHGOBJ Stamp      IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##PGM     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCHRC    BEGSR
      *================================================================
      * CHG Qty/Wgt Scheduled  CH - Order Detail Schedule  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0189  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0190  3        Warehouse Code
     C                     MOVEL*BLANK    WN0191  3        Order From Ware
     C                     Z-ADD*ZERO     WN0192  70       Item Code
     C                     Z-ADD*ZERO     WN0193 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0194 112       OD Unused weigh
     C                     MOVEL*BLANK    WN0195  1        OD Reallocate S
     C                     MOVEL*BLANK    WN0196  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0197  1        EDI Status 1
     C                     MOVEL*BLANK    WN0198  1        EDI Status 2
     C                     MOVEL*BLANK    WN0199  1        EDI Status 3
     C                     MOVEL*BLANK    WN0200  1        Record Status
     C                     Z-ADD*ZERO     WN0201  60       Job Time
     C                     MOVEL*BLANK    WN0202 10        User Id
     C                     MOVEL*BLANK    WN0203 10        Job Name
     C                     Z-ADD*ZERO     WN0204  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @KNCPHN
     C                     Z-ADDWL0168    WEAIC3           Company Number
     C                     Z-ADDWL0169    WEC4NB           Order Number
     C                     Z-ADDWL0170    WEDPNB           Order Sequence
     C                     Z-ADDWL0171    WEUENB           Order Secondary
     C                     Z-ADDWL0172    WEJGDT           OD Production D
      *
     C           KLCHST    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C                     KFLD           WEJGDT           OD Production D
     C           KLCHST    CHAIN@KNCPHN              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDKN1    YCRDCS
      * Move non-key fields to @KNCPHN
     C                     Z-ADDWL0173    WEIGQT           OD Qty_Cnsmd Pi
     C                     Z-ADDWL0174    WEFLWG           OD Weight Sched
     C                     Z-ADDWL0175    WEIUQT           OD Quantity Inv
     C                     Z-ADDWL0176    WEF3WG           OD Weight Inv S
     C                     MOVELWL0177    WEP7ST    P      OD Added to Sch
      *
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@KNCPHN                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDKNCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Item Prd Yld SWYG RT - Item Bill Of Material  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0180           Production Yiel
     C                     MOVEL*BLANK    WL0181           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOAIC3    WQSU01           Company Number
     C           *LIKE     DEFN WOHGCD    WQSU02           Item Code
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           Company Number
     C                     KFLD           WQSU02           Item Code
      * Setup key
     C                     Z-ADDWL0178    WQSU01           Company Number
     C                     Z-ADDWL0179    WQSU02           Item Code
      * Establish starting position
     C           KRSSU     SETLL@IOREA4                    *
     C           KRSSU     READE@IOREA4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1679' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WL0181           Record Found US
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WOBPPR    WL0180           Production Yiel
     C                     MOVEL'Y'       WL0181           Record Found US
     C           KRSSU     READE@IOREA4                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * BPS Upd Pcs/Wgt Std   RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0205  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0206  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0207  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0208  72       PS Pct of Carca
     C                     Z-ADD*ZERO     WN0209  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0210  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0211  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0212  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0213  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0214  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0215  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0216  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0217  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0218  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0219  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0220  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0221  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0222  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0223  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0224  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0225  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0226  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0227  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0228 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0229  70       PS Pieces Whs T
     C                     Z-ADD*ZERO     WN0230 112       PS Weight Whs T
     C                     Z-ADD*ZERO     WN0231  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0232 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0233  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0234 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0235  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0236 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0237  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0238 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0239  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0240  3        PS Item Id
     C                     MOVEL*BLANK    WN0241  2        Warehouse Type
     C                     MOVEL*BLANK    WN0242  1        PS Lock Status
     C                     MOVEL*BLANK    WN0243  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0244  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0245  1        PS Piece Count
     C                     MOVEL*BLANK    WN0246  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0247  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0248  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0249  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0250  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0251  3        PS Production W
     C                     Z-ADD*ZERO     WN0252  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0253  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0254  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0255  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0256  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0257  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0258  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0259  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0260  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0261  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0262  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0263  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0264  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0265  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0266  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0267  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0268  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0269  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0270  6        Department Code
     C                     Z-ADD*ZERO     WN0271  30       Item Structure
     C                     Z-ADD*ZERO     WN0272  30       Item Structure
     C                     Z-ADD*ZERO     WN0273  30       Item Structure
     C                     MOVEL*BLANK    WN0274  6        Primal Group Co
     C                     MOVEL*BLANK    WN0275  1        EDI Status 1
     C                     MOVEL*BLANK    WN0276  1        EDI Status 2
     C                     MOVEL*BLANK    WN0277  1        EDI Status 3
     C                     MOVEL*BLANK    WN0278  1        Record Status
     C                     Z-ADD*ZERO     WN0279  60       Job Time
     C                     MOVEL*BLANK    WN0280 10        User Id
     C                     MOVEL*BLANK    WN0281 10        Job Name
     C                     Z-ADD*ZERO     WN0282  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFV5ST           Production Type
     C                     KFLD           WFELDT           Production Date
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWAAIC3    WFAIC3           Company Number
     C                     MOVELWN0005    WFV5ST           Production Type
     C                     Z-ADDWAJGDT    WFELDT           Production Date
     C                     Z-ADDWL0006    WFHGCD           Item Code
     C                     MOVELWAAJCD    WFAJCD           Warehouse Code
      * Establish starting position
     C           KRSSV     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADDWUF1WG    WN0212           PS Weight Stand
     C                     Z-ADDWUPCAL    WN0213           PS Pieces Stand
      * Average Piece Weight
      * CASE: PAR.PS Pieces Standard is NE Zeros
     C           WN0213    IFNE 0                          *IF
      * FP1054 RMC 5/14/09 chg above CASE to ne 0 , it was gt 0
      * Avg Piece Weight
      * PAR.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Standard
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Pieces Standard
     C           WN0212    DIV  WN0213    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0209           PS Avg Piece Wg
      * FP1054 RMC 5/14/09 make positive if negative
      * CASE: PAR.PS Avg Piece Wgt is LT Zero
     C           WN0209    IFLT 0                          *IF
     C                     MULT -1        WN0209           PS Avg Piece Wg
     C                     END                             *FI
     C                     END                             *FI
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.PS Weight Standard is NE Zero
      *   |- c2    : PAR.PS Pieces Standard is NE Zeros
      *   '-
     C           WN0212    IFNE 0                          *IF
     C           WN0213    ORNE 0                          *OR
      * FP1054 RMC 5/14/09 chg above CASE to ne 0 , it was gt 0
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0049           Company Number
     C                     MOVELWN0005    WL0050    P      Production Type
     C                     Z-ADDWAJGDT    WL0051           Production Date
     C                     Z-ADDWL0006    WL0052           Item Code
     C                     MOVELWAAJCD    WL0053    P      Warehouse Code
     C                     Z-ADDWN0205    WL0054           PS Available Sh
     C                     Z-ADDWN0206    WL0055           PS Weight Plann
     C                     Z-ADDWN0207    WL0056           PS Pieces Plann
     C                     Z-ADDWN0208    WL0057           PS Pct of Carca
     C                     Z-ADDWN0209    WL0058           PS Avg Piece Wg
     C                     Z-ADDWN0210    WL0059           PS Weight Inv O
     C                     Z-ADDWN0211    WL0060           PS Pieces Inv O
     C                     Z-ADDWN0212    WL0061           PS Weight Stand
     C                     Z-ADDWN0213    WL0062           PS Pieces Stand
     C                     Z-ADDWN0214    WL0063           PS Weight Conve
     C                     Z-ADDWN0215    WL0064           PS Pieces Conve
     C                     Z-ADDWN0216    WL0065           PS Weight Shipp
     C                     Z-ADDWN0217    WL0066           PS Pieces Shipp
     C                     Z-ADDWN0218    WL0067           PS Weight Prod
     C                     Z-ADDWN0219    WL0068           PS Pieces Prod
     C                     Z-ADDWN0220    WL0069           PS Weight Inv A
     C                     Z-ADDWN0221    WL0070           PS Pieces Inv A
     C                     Z-ADDWN0222    WL0071           PS Weight Ship
     C                     Z-ADDWN0223    WL0072           PS Pieces Ship
     C                     Z-ADDWN0224    WL0073           PS Weight Prod
     C                     Z-ADDWN0225    WL0074           PS Pieces Prod
     C                     Z-ADDWN0226    WL0075           PS Weight Inv A
     C                     Z-ADDWN0227    WL0076           PS Pieces Inv A
     C                     Z-ADDWN0228    WL0077           PS Unit Weight
     C                     Z-ADDWN0229    WL0078           PS Pieces Whs T
     C                     Z-ADDWN0230    WL0079           PS Weight Whs T
     C                     Z-ADDWN0231    WL0080           PS Pieces Unuse
     C                     Z-ADDWN0232    WL0081           PS Weight Unuse
     C                     Z-ADDWN0233    WL0082           PS Pieces Unuse
     C                     Z-ADDWN0234    WL0083           PS Weight Unuse
     C                     Z-ADDWN0235    WL0084           PS Pieces Unuse
     C                     Z-ADDWN0236    WL0085           PS Weight Unuse
     C                     Z-ADDWN0237    WL0086           PS Pieces Unuse
     C                     Z-ADDWN0238    WL0087           PS Weight Unuse
     C                     Z-ADDWN0239    WL0088           PS Pieces Unuse
     C                     MOVELWN0240    WL0089    P      PS Item Id
     C                     MOVELWN0241    WL0090    P      Warehouse Type
     C                     MOVELWN0242    WL0091    P      PS Lock Status
     C                     MOVELWN0243    WL0092    P      PS Export/Domes
     C                     MOVELWN0244    WL0093    P      PS Print On Sch
     C                     MOVELWN0245    WL0094    P      PS Piece Count
     C                     MOVELWN0246    WL0095    P      PS Unused Sts 1
     C                     MOVELWN0247    WL0096    P      PS Unused Sts 2
     C                     MOVELWN0248    WL0097    P      PS Unused Sts 3
     C                     MOVELWN0249    WL0098    P      PS Unused Sts 4
     C                     MOVELWN0250    WL0099    P      PS Item Sched N
     C                     MOVELWN0251    WL0100    P      PS Production W
     C                     Z-ADDWN0252    WL0101           PS Weight Order
     C                     Z-ADDWN0253    WL0102           PS Pieces Order
     C                     Z-ADDWN0254    WL0103           PS Weight FC Ad
     C                     Z-ADDWN0255    WL0104           PS Pieces FC Ad
     C                     Z-ADDWN0256    WL0105           PS Weight FX Ad
     C                     Z-ADDWN0257    WL0106           PS Pieces FX Ad
     C                     Z-ADDWN0258    WL0107           PS Weight Sched
     C                     Z-ADDWN0259    WL0108           PS Pieces Sched
     C                     Z-ADDWN0260    WL0109           PS Weight Avail
     C                     Z-ADDWN0261    WL0110           PS Pieces Avail
     C                     Z-ADDWN0262    WL0111           PS Weight Produ
     C                     Z-ADDWN0263    WL0112           PS Pieces Produ
     C                     Z-ADDWN0264    WL0113           PS Weight Fab N
     C                     Z-ADDWN0265    WL0114           PS Pieces Fab N
     C                     Z-ADDWN0266    WL0115           PS Weight Sched
     C                     Z-ADDWN0267    WL0116           PS Pieces Sched
     C                     Z-ADDWN0268    WL0117           PS Weight Sched
     C                     Z-ADDWN0269    WL0118           PS Pieces Sched
     C                     MOVELWN0270    WL0119    P      Department Code
     C                     Z-ADDWN0271    WL0120           Item Structure
     C                     Z-ADDWN0272    WL0121           Item Structure
     C                     Z-ADDWN0273    WL0122           Item Structure
     C                     MOVELWN0274    WL0123    P      Primal Group Co
     C                     MOVELWN0275    WL0124    P      EDI Status 1
     C                     MOVELWN0276    WL0125    P      EDI Status 2
     C                     MOVELWN0277    WL0126    P      EDI Status 3
     C                     MOVELWN0278    WL0127    P      Record Status
     C                     Z-ADDWN0279    WL0128           Job Time
     C                     MOVELWN0280    WL0129    P      User Id
     C                     MOVELWN0281    WL0130    P      Job Name
     C                     Z-ADDWN0282    WL0131           Job Date
     C                     EXSR SHCRRC
     C                     END                             *FI
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WFDXWG    ADD  WUF1WG    WN0212           PS Weight Stand
     C           WFB2NB    ADD  WUPCAL    WN0213           PS Pieces Stand
      * Average Piece Weight
      * CASE: PAR.PS Pieces Standard is NE Zeros
     C           WN0213    IFNE 0                          *IF
      * FP1054 RMC 5/14/09 chg above CASE to ne 0 , it was gt 0
      * Avg Piece Weight
      * PAR.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Standard
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Pieces Standard
     C           WN0212    DIV  WN0213    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0209           PS Avg Piece Wg
      * FP1054 RMC 5/14/09 make positive if negative
      * CASE: PAR.PS Avg Piece Wgt is LT Zero
     C           WN0209    IFLT 0                          *IF
     C                     MULT -1        WN0209           PS Avg Piece Wg
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 RMC 5/14/09 dont do below case - they may be negative now
      * BPS Chg Pcs/Wgt Std   CH - PS Prod Item Schedule  * 
     C                     EXSR SWCHRC
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWCHRC    BEGSR
      *================================================================
      * BPS Chg Pcs/Wgt Std   CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0283  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0284  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0285  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0286  72       PS Pct of Carca
     C                     Z-ADD*ZERO     WN0287  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0288  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0289  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0290  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0291  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0292  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0293  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0294  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0295  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0296  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0297  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0298  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0299  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0300  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0301  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0302  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0303 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0304  70       PS Pieces Whs T
     C                     Z-ADD*ZERO     WN0305 112       PS Weight Whs T
     C                     Z-ADD*ZERO     WN0306  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0307 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0308  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0309 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0310  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0311 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0312  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0313 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0314  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0315  3        PS Item Id
     C                     MOVEL*BLANK    WN0316  2        Warehouse Type
     C                     MOVEL*BLANK    WN0317  1        PS Lock Status
     C                     MOVEL*BLANK    WN0318  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0319  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0320  1        PS Piece Count
     C                     MOVEL*BLANK    WN0321  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0322  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0323  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0324  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0325  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0326  3        PS Production W
     C                     Z-ADD*ZERO     WN0327  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0328  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0329  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0330  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0331  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0332  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0333  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0334  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0335  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0336  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0337  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0338  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0339  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0340  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0341  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0342  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0343  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0344  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0345  6        Department Code
     C                     Z-ADD*ZERO     WN0346  30       Item Structure
     C                     Z-ADD*ZERO     WN0347  30       Item Structure
     C                     Z-ADD*ZERO     WN0348  30       Item Structure
     C                     MOVEL*BLANK    WN0349  6        Primal Group Co
     C                     MOVEL*BLANK    WN0350  1        EDI Status 1
     C                     MOVEL*BLANK    WN0351  1        EDI Status 2
     C                     MOVEL*BLANK    WN0352  1        EDI Status 3
     C                     MOVEL*BLANK    WN0353  1        Record Status
     C                     Z-ADD*ZERO     WN0354  60       Job Time
     C                     MOVEL*BLANK    WN0355 10        User Id
     C                     MOVEL*BLANK    WN0356 10        Job Name
     C                     Z-ADD*ZERO     WN0357  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWFAIC3    WGAIC3           Company Number
     C                     MOVELWFV5ST    WGV5ST    P      Production Type
     C                     Z-ADDWFELDT    WGELDT           Production Date
     C                     Z-ADDWFHGCD    WGHGCD           Item Code
     C                     MOVELWFAJCD    WGAJCD    P      Warehouse Code
      *
     C           KLCHSW    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGV5ST           Production Type
     C                     KFLD           WGELDT           Production Date
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
     C           KLCHSW    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YDRDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWN0209    WGF8WG           PS Avg Piece Wg
     C                     Z-ADDWN0212    WGDXWG           PS Weight Stand
     C                     Z-ADDWN0213    WGB2NB           PS Pieces Stand
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Upd Prod Whse Txfr    RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0358  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0359  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0360  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0361  72       PS Pct of Carca
     C                     Z-ADD*ZERO     WN0362  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0363  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0364  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0365  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0366  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0367  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0368  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0369  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0370  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0371  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0372  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0373  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0374  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0375  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0376  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0377  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0378  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0379  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0380  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0381 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0382  70       PS Pieces Whs T
     C                     Z-ADD*ZERO     WN0383 112       PS Weight Whs T
     C                     Z-ADD*ZERO     WN0384  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0385 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0386  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0387 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0388  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0389 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0390  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0391 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0392  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0393  3        PS Item Id
     C                     MOVEL*BLANK    WN0394  2        Warehouse Type
     C                     MOVEL*BLANK    WN0395  1        PS Lock Status
     C                     MOVEL*BLANK    WN0396  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0397  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0398  1        PS Piece Count
     C                     MOVEL*BLANK    WN0399  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0400  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0401  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0402  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0403  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0404  3        PS Production W
     C                     Z-ADD*ZERO     WN0405  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0406  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0407  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0408  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0409  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0410  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0411  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0412  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0413  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0414  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0415  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0416  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0417  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0418  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0419  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0420  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0421  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0422  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0423  6        Department Code
     C                     Z-ADD*ZERO     WN0424  30       Item Structure
     C                     Z-ADD*ZERO     WN0425  30       Item Structure
     C                     Z-ADD*ZERO     WN0426  30       Item Structure
     C                     MOVEL*BLANK    WN0427  6        Primal Group Co
     C                     MOVEL*BLANK    WN0428  1        EDI Status 1
     C                     MOVEL*BLANK    WN0429  1        EDI Status 2
     C                     MOVEL*BLANK    WN0430  1        EDI Status 3
     C                     MOVEL*BLANK    WN0431  1        Record Status
     C                     Z-ADD*ZERO     WN0432  60       Job Time
     C                     MOVEL*BLANK    WN0433 10        User Id
     C                     MOVEL*BLANK    WN0434 10        Job Name
     C                     Z-ADD*ZERO     WN0435  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFV5ST           Production Type
     C                     KFLD           WFELDT           Production Date
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDYL0002    WFAIC3           Company Number
     C                     MOVELWN0005    WFV5ST           Production Type
     C                     Z-ADDWAJGDT    WFELDT           Production Date
     C                     Z-ADDWL0006    WFHGCD           Item Code
     C                     MOVELYL0001    WFAJCD           Warehouse Code
      * Establish starting position
     C           KRSSX     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADDWUF1WG    WN0383           PS Weight Whs T
     C                     Z-ADDWUPCAL    WN0382           PS Pieces Whs T
      * CASE: PAR.PS Pieces Whse Tfr Adj is GT Zero
     C           WN0382    IFGT 0                          *IF
      * Average Piece Weight
      * PAR.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Whs Tfr Adj
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.PS Pieces Whs Tfr Adj
     C           WN0383    DIV  WN0382    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0362           PS Avg Piece Wg
     C                     END                             *FI
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0002    WL0049           Company Number
     C                     MOVELWN0005    WL0050    P      Production Type
     C                     Z-ADDWAJGDT    WL0051           Production Date
     C                     Z-ADDWL0006    WL0052           Item Code
     C                     MOVELYL0001    WL0053    P      Warehouse Code
     C                     Z-ADDWN0358    WL0054           PS Available Sh
     C                     Z-ADDWN0359    WL0055           PS Weight Plann
     C                     Z-ADDWN0360    WL0056           PS Pieces Plann
     C                     Z-ADDWN0361    WL0057           PS Pct of Carca
     C                     Z-ADDWN0362    WL0058           PS Avg Piece Wg
     C                     Z-ADDWN0363    WL0059           PS Weight Inv O
     C                     Z-ADDWN0364    WL0060           PS Pieces Inv O
     C                     Z-ADDWN0365    WL0061           PS Weight Stand
     C                     Z-ADDWN0366    WL0062           PS Pieces Stand
     C                     Z-ADDWN0367    WL0063           PS Weight Conve
     C                     Z-ADDWN0368    WL0064           PS Pieces Conve
     C                     Z-ADDWN0369    WL0065           PS Weight Shipp
     C                     Z-ADDWN0370    WL0066           PS Pieces Shipp
     C                     Z-ADDWN0371    WL0067           PS Weight Prod
     C                     Z-ADDWN0372    WL0068           PS Pieces Prod
     C                     Z-ADDWN0373    WL0069           PS Weight Inv A
     C                     Z-ADDWN0374    WL0070           PS Pieces Inv A
     C                     Z-ADDWN0375    WL0071           PS Weight Ship
     C                     Z-ADDWN0376    WL0072           PS Pieces Ship
     C                     Z-ADDWN0377    WL0073           PS Weight Prod
     C                     Z-ADDWN0378    WL0074           PS Pieces Prod
     C                     Z-ADDWN0379    WL0075           PS Weight Inv A
     C                     Z-ADDWN0380    WL0076           PS Pieces Inv A
     C                     Z-ADDWN0381    WL0077           PS Unit Weight
     C                     Z-ADDWN0382    WL0078           PS Pieces Whs T
     C                     Z-ADDWN0383    WL0079           PS Weight Whs T
     C                     Z-ADDWN0384    WL0080           PS Pieces Unuse
     C                     Z-ADDWN0385    WL0081           PS Weight Unuse
     C                     Z-ADDWN0386    WL0082           PS Pieces Unuse
     C                     Z-ADDWN0387    WL0083           PS Weight Unuse
     C                     Z-ADDWN0388    WL0084           PS Pieces Unuse
     C                     Z-ADDWN0389    WL0085           PS Weight Unuse
     C                     Z-ADDWN0390    WL0086           PS Pieces Unuse
     C                     Z-ADDWN0391    WL0087           PS Weight Unuse
     C                     Z-ADDWN0392    WL0088           PS Pieces Unuse
     C                     MOVELWN0393    WL0089    P      PS Item Id
     C                     MOVELWN0394    WL0090    P      Warehouse Type
     C                     MOVELWN0395    WL0091    P      PS Lock Status
     C                     MOVELWN0396    WL0092    P      PS Export/Domes
     C                     MOVELWN0397    WL0093    P      PS Print On Sch
     C                     MOVELWN0398    WL0094    P      PS Piece Count
     C                     MOVELWN0399    WL0095    P      PS Unused Sts 1
     C                     MOVELWN0400    WL0096    P      PS Unused Sts 2
     C                     MOVELWN0401    WL0097    P      PS Unused Sts 3
     C                     MOVELWN0402    WL0098    P      PS Unused Sts 4
     C                     MOVELWN0403    WL0099    P      PS Item Sched N
     C                     MOVELWN0404    WL0100    P      PS Production W
     C                     Z-ADDWN0405    WL0101           PS Weight Order
     C                     Z-ADDWN0406    WL0102           PS Pieces Order
     C                     Z-ADDWN0407    WL0103           PS Weight FC Ad
     C                     Z-ADDWN0408    WL0104           PS Pieces FC Ad
     C                     Z-ADDWN0409    WL0105           PS Weight FX Ad
     C                     Z-ADDWN0410    WL0106           PS Pieces FX Ad
     C                     Z-ADDWN0411    WL0107           PS Weight Sched
     C                     Z-ADDWN0412    WL0108           PS Pieces Sched
     C                     Z-ADDWN0413    WL0109           PS Weight Avail
     C                     Z-ADDWN0414    WL0110           PS Pieces Avail
     C                     Z-ADDWN0415    WL0111           PS Weight Produ
     C                     Z-ADDWN0416    WL0112           PS Pieces Produ
     C                     Z-ADDWN0417    WL0113           PS Weight Fab N
     C                     Z-ADDWN0418    WL0114           PS Pieces Fab N
     C                     Z-ADDWN0419    WL0115           PS Weight Sched
     C                     Z-ADDWN0420    WL0116           PS Pieces Sched
     C                     Z-ADDWN0421    WL0117           PS Weight Sched
     C                     Z-ADDWN0422    WL0118           PS Pieces Sched
     C                     MOVELWN0423    WL0119    P      Department Code
     C                     Z-ADDWN0424    WL0120           Item Structure
     C                     Z-ADDWN0425    WL0121           Item Structure
     C                     Z-ADDWN0426    WL0122           Item Structure
     C                     MOVELWN0427    WL0123    P      Primal Group Co
     C                     MOVELWN0428    WL0124    P      EDI Status 1
     C                     MOVELWN0429    WL0125    P      EDI Status 2
     C                     MOVELWN0430    WL0126    P      EDI Status 3
     C                     MOVELWN0431    WL0127    P      Record Status
     C                     Z-ADDWN0432    WL0128           Job Time
     C                     MOVELWN0433    WL0129    P      User Id
     C                     MOVELWN0434    WL0130    P      Job Name
     C                     Z-ADDWN0435    WL0131           Job Date
     C                     EXSR SHCRRC
      *  not necessary here ...
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WFGAWG    ADD  WUF1WG    WN0383           PS Weight Whs T
     C           WFBPNB    ADD  WUPCAL    WN0382           PS Pieces Whs T
      * Chg Prod Whse Txfr    CH - PS Prod Item Schedule  * 
     C                     EXSR SYCHRC
      *  not necessary here ...
      * FP1054 create/delete consumed records - if called from PRD routin
      *  and STD was allocated
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCHRC    BEGSR
      *================================================================
      * Chg Prod Whse Txfr    CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0436  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0437  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0438  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0439  72       PS Pct of Carca
     C                     Z-ADD*ZERO     WN0440  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0441  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0442  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0443  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0444  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0445  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0446  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0447  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0448  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0449  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0450  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0451  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0452  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0453  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0454  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0455  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0456  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0457  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0458 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0459  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0460 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0461  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0462 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0463  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0464 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0465  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0466 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0467  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0468  3        PS Item Id
     C                     MOVEL*BLANK    WN0469  2        Warehouse Type
     C                     MOVEL*BLANK    WN0470  1        PS Lock Status
     C                     MOVEL*BLANK    WN0471  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0472  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0473  1        PS Piece Count
     C                     MOVEL*BLANK    WN0474  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0475  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0476  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0477  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0478  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0479  3        PS Production W
     C                     Z-ADD*ZERO     WN0480  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0481  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0482  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0483  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0484  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0485  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0486  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0487  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0488  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0489  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0490  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0491  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0492  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0493  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0494  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0495  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0496  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0497  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0498  6        Department Code
     C                     Z-ADD*ZERO     WN0499  30       Item Structure
     C                     Z-ADD*ZERO     WN0500  30       Item Structure
     C                     Z-ADD*ZERO     WN0501  30       Item Structure
     C                     MOVEL*BLANK    WN0502  6        Primal Group Co
     C                     MOVEL*BLANK    WN0503  1        EDI Status 1
     C                     MOVEL*BLANK    WN0504  1        EDI Status 2
     C                     MOVEL*BLANK    WN0505  1        EDI Status 3
     C                     MOVEL*BLANK    WN0506  1        Record Status
     C                     Z-ADD*ZERO     WN0507  60       Job Time
     C                     MOVEL*BLANK    WN0508 10        User Id
     C                     MOVEL*BLANK    WN0509 10        Job Name
     C                     Z-ADD*ZERO     WN0510  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWFAIC3    WGAIC3           Company Number
     C                     MOVELWFV5ST    WGV5ST    P      Production Type
     C                     Z-ADDWFELDT    WGELDT           Production Date
     C                     Z-ADDWFHGCD    WGHGCD           Item Code
     C                     MOVELWFAJCD    WGAJCD    P      Warehouse Code
      *
     C           KLCHSY    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGV5ST           Production Type
     C                     KFLD           WGELDT           Production Date
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
     C           KLCHSY    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YERDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWFF8WG    WGF8WG           PS Avg Piece Wg
     C                     Z-ADDWN0382    WGBPNB           PS Pieces Whs T
     C                     Z-ADDWN0383    WGGAWG           PS Weight Whs T
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * UPS CHGOBJ Stamp      IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##PGM     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * UPD Deallocate Inv    RT - Order Detail Sched-Inv  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0515 112       OD Quantity Inv
     C                     Z-ADD*ZERO     WN0516 112       OD Weight Inv S
     C                     Z-ADD*ZERO     WN0517  92       Weight Dealloca
     C                     Z-ADD*ZERO     WN0518 112       Quantity Deallo
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WRAIC3    WQSZ01           Company Number
     C           *LIKE     DEFN WRC4NB    WQSZ02           Order Number
     C           *LIKE     DEFN WRDPNB    WQSZ03           Order Sequence
     C           *LIKE     DEFN WRUENB    WQSZ04           Order Secondary
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           Company Number
     C                     KFLD           WQSZ02           Order Number
     C                     KFLD           WQSZ03           Order Sequence
     C                     KFLD           WQSZ04           Order Secondary
      * Setup key
     C                     Z-ADDWL0182    WQSZ01           Company Number
     C                     Z-ADDWL0183    WQSZ02           Order Number
     C                     Z-ADDWL0184    WQSZ03           Order Sequence
     C                     Z-ADDWL0185    WQSZ04           Order Secondary
      * Establish starting position
     C           KRSSZ     SETLL@B5CPM3                    *
     C           KRSSZ     READE@B5CPM3                  90*
      * Data record not found
     C   90                MOVEL'USR3150' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * CASE: PAR.Production Date USR is Entered
     C           WL0199    IFNE 0                          *IF
      * CASE: DB1.OD Production Date NE PAR.Production Date USR
     C           WRJGDT    IFNE WL0199                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Process Record
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Deallocate Inventory
      * CASE: PAR.ATS Quantity Need USR is Less than zero
     C           WL0196    IFLT 0                          *IF
      * CASE: DB1.OD Weight Inv Sched is Greater than zero
     C           WRF3WG    IFGT 0                          *IF
      * Weight Deallocate USR
      * PAR.Weight Deallocate USR =
      *    *COMPUTE (x1 * x3)
      * x1    : DB1.OD Weight Inv Sched
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.-1
     C           WRF3WG    MULT -1        W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0517           Weight Dealloca
      * Quantity Deallocate USR
      * PAR.Quantity Deallocated USR =
      *    *COMPUTE (x1 * x3)
      * x1    : DB1.OD Quantity Inv Sched
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.-1
     C           WRIUQT    MULT -1        W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0518           Quantity Deallo
      * Update Inventory Allocated.
      * CASE: PAR.Weight Deallocate USR LE PAR.ATS Weight Need USR
     C           WN0517    IFLE WL0197                     *IF
      * Upd Inv Allocated     RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0182    WL0200           Company Number
     C                     MOVEL'S'       WL0201    P      Production Type
     C                     Z-ADD##JDT     WL0202           Production Date
     C                     Z-ADDWL0187    WL0203           Item Code
     C                     MOVELWL0186    WL0204    P      Warehouse Code
     C                     MOVELWL0189    WL0205    P      Piece Count Ite
     C                     Z-ADDWL0190    WL0206           Pieces Per Bag
     C                     Z-ADDWL0191    WL0207           Bags Per Unit
     C                     Z-ADDWL0197    WL0208           Weight Allocate
     C                     Z-ADDWL0196    WL0209           Quantity Alloca
     C                     EXSR TARVGN
      * Upd Qty/Wgt Inv Alc   RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0182    WL0210           Company Number
     C                     Z-ADDWL0183    WL0211           Order Number
     C                     Z-ADDWL0184    WL0212           Order Sequence
     C                     Z-ADDWL0185    WL0213           Order Secondary
     C                     Z-ADD##JDT     WL0214           OD Production D
     C                     Z-ADDWL0198    WL0215           Scheduled Ship
     C                     MOVELWL0186    WL0216    P      Warehouse Code
     C                     MOVELWL0186    WL0217    P      Order From Ware
     C                     Z-ADDWL0187    WL0218           Item Code
     C                     Z-ADDWL0196    WL0219           Quantity Alloca
     C                     Z-ADDWL0197    WL0220           Weight Allocate
     C                     EXSR TCRVGN
     C           WRF3WG    ADD  WL0197    WN0516           OD Weight Inv S
     C           WRIUQT    ADD  WL0196    WN0515           OD Quantity Inv
      * CASE: PAR.OD Quantity Inv Sched is LE Zero
     C           WN0515    IFLE 0                          *IF
      * Delete Order Detail Sched - Order Detail Sched-Inv  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWRAIC3    WL0221           Company Number
     C                     Z-ADDWRC4NB    WL0222           Order Number
     C                     Z-ADDWRDPNB    WL0223           Order Sequence
     C                     Z-ADDWRUENB    WL0224           Order Secondary
     C                     Z-ADDWRJGDT    WL0225           OD Production D
     C                     EXSR TFDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Ord Dtl Sch-Inv   CH - Order Detail Sched-Inv  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWRAIC3    WL0226           Company Number
     C                     Z-ADDWRC4NB    WL0227           Order Number
     C                     Z-ADDWRDPNB    WL0228           Order Sequence
     C                     Z-ADDWRUENB    WL0229           Order Secondary
     C                     Z-ADDWRJGDT    WL0230           OD Production D
     C                     Z-ADDWL0198    WL0231           Scheduled Ship
     C                     MOVELWRAJCD    WL0232    P      Warehouse Code
     C                     Z-ADDWRHGCD    WL0233           Item Code
     C                     Z-ADDWN0515    WL0234           OD Quantity Inv
     C                     Z-ADDWN0516    WL0235           OD Weight Inv S
     C                     EXSR TGCHRC
     C                     END                             *FI
     C                     ADD  WL0197    WL0195           Weight Schedule
     C                     ADD  WL0196    WL0194           Quantity Schedu
     C                     ELSE
      * CASE: PAR.Weight Deallocate USR GT PAR.ATS Weight Need USR
     C           WN0517    IFGT WL0197                     *IF
      * Upd Inv Allocated     RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0182    WL0200           Company Number
     C                     MOVEL'S'       WL0201    P      Production Type
     C                     Z-ADD##JDT     WL0202           Production Date
     C                     Z-ADDWL0187    WL0203           Item Code
     C                     MOVELWL0186    WL0204    P      Warehouse Code
     C                     MOVELWL0189    WL0205    P      Piece Count Ite
     C                     Z-ADDWL0190    WL0206           Pieces Per Bag
     C                     Z-ADDWL0191    WL0207           Bags Per Unit
     C                     Z-ADDWN0517    WL0208           Weight Allocate
     C                     Z-ADDWN0518    WL0209           Quantity Alloca
     C                     EXSR TARVGN
      * Upd Qty/Wgt Inv Alc   RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0182    WL0210           Company Number
     C                     Z-ADDWL0183    WL0211           Order Number
     C                     Z-ADDWL0184    WL0212           Order Sequence
     C                     Z-ADDWL0185    WL0213           Order Secondary
     C                     Z-ADD##JDT     WL0214           OD Production D
     C                     Z-ADDWRAODT    WL0215           Scheduled Ship
     C                     MOVELWL0186    WL0216    P      Warehouse Code
     C                     MOVELWL0186    WL0217    P      Order From Ware
     C                     Z-ADDWL0187    WL0218           Item Code
     C                     Z-ADDWN0518    WL0219           Quantity Alloca
     C                     Z-ADDWN0517    WL0220           Weight Allocate
     C                     EXSR TCRVGN
      * ** UPDATE INVENTORY SCHEDULED **
     C           WRF3WG    ADD  WN0517    WN0516           OD Weight Inv S
     C           WRIUQT    ADD  WN0518    WN0515           OD Quantity Inv
      * CASE: PAR.OD Quantity Inv Sched is LE Zero
     C           WN0515    IFLE 0                          *IF
      * Delete Order Detail Sched - Order Detail Sched-Inv  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWRAIC3    WL0221           Company Number
     C                     Z-ADDWRC4NB    WL0222           Order Number
     C                     Z-ADDWRDPNB    WL0223           Order Sequence
     C                     Z-ADDWRUENB    WL0224           Order Secondary
     C                     Z-ADDWRJGDT    WL0225           OD Production D
     C                     EXSR TFDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Ord Dtl Sch-Inv   CH - Order Detail Sched-Inv  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWRAIC3    WL0226           Company Number
     C                     Z-ADDWRC4NB    WL0227           Order Number
     C                     Z-ADDWRDPNB    WL0228           Order Sequence
     C                     Z-ADDWRUENB    WL0229           Order Secondary
     C                     Z-ADDWRJGDT    WL0230           OD Production D
     C                     Z-ADDWL0198    WL0231           Scheduled Ship
     C                     MOVELWRAJCD    WL0232    P      Warehouse Code
     C                     Z-ADDWRHGCD    WL0233           Item Code
     C                     Z-ADDWN0515    WL0234           OD Quantity Inv
     C                     Z-ADDWN0516    WL0235           OD Weight Inv S
     C                     EXSR TGCHRC
     C                     END                             *FI
     C                     ADD  WN0517    WL0195           Weight Schedule
     C                     ADD  WN0518    WL0194           Quantity Schedu
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           WL0193    SUB  WL0195    WL0197           ATS Weight Need
     C           WL0192    SUB  WL0194    WL0196           ATS Quantity Ne
     C           KRSSZ     READE@B5CPM3                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Upd Inv Allocated     RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0519  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0520  70       PS Pieces Inv A
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFV5ST           Production Type
     C                     KFLD           WFELDT           Production Date
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0200    WFAIC3           Company Number
     C                     MOVELWL0201    WFV5ST           Production Type
     C                     Z-ADDWL0202    WFELDT           Production Date
     C                     Z-ADDWL0203    WFHGCD           Item Code
     C                     MOVELWL0204    WFAJCD           Warehouse Code
      * Establish starting position
     C           KRSTA     CHAIN@I8CPUS              90    *
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WFUNW2    ADD  WL0208    WN0519           PS Weight Inv A
      * PS Pieces Inv Allocated
      * CASE: PAR.Piece Count Item is yes
     C           WL0205    IFEQ 'Y'                        *IF
      * Pieces Inv Allocated
      * PAR.PS Pieces Inv Allocated =
      *    *COMPUTE (x1 + (x2 * (x3 * x4)))
      * x1    : DB1.PS Pieces Inv Allocated
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Bags Per Unit
     C           WL0206    MULT WL0207    W0WJ02           *Synon (15,0) w
     C           WL0209    MULT W0WJ02    W0WJ01    H      *Synon (15,0) w
     C           WFCENB    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0520           PS Pieces Inv A
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0520           PS Pieces Inv A
     C                     END                             *FI
      * Chg Inv Allocated     CH - PS Prod Item Schedule  * 
     C                     EXSR TBCHRC
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBCHRC    BEGSR
      *================================================================
      * Chg Inv Allocated     CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0521  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0522  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0523  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0524  72       PS Pct of Carca
     C                     Z-ADD*ZERO     WN0525  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0526  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0527  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0528  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0529  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0530  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0531  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0532  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0533  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0534  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0535  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0536  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0537  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0538  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0539  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0540  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0541  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0542 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0543  70       PS Pieces Whs T
     C                     Z-ADD*ZERO     WN0544 112       PS Weight Whs T
     C                     Z-ADD*ZERO     WN0545  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0546 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0547  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0548 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0549  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0550 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0551  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0552 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0553  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0554  3        PS Item Id
     C                     MOVEL*BLANK    WN0555  2        Warehouse Type
     C                     MOVEL*BLANK    WN0556  1        PS Lock Status
     C                     MOVEL*BLANK    WN0557  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0558  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0559  1        PS Piece Count
     C                     MOVEL*BLANK    WN0560  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0561  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0562  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0563  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0564  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0565  3        PS Production W
     C                     Z-ADD*ZERO     WN0566  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0567  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0568  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0569  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0570  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0571  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0572  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0573  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0574  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0575  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0576  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0577  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0578  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0579  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0580  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0581  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0582  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0583  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0584  6        Department Code
     C                     Z-ADD*ZERO     WN0585  30       Item Structure
     C                     Z-ADD*ZERO     WN0586  30       Item Structure
     C                     Z-ADD*ZERO     WN0587  30       Item Structure
     C                     MOVEL*BLANK    WN0588  6        Primal Group Co
     C                     MOVEL*BLANK    WN0589  1        EDI Status 1
     C                     MOVEL*BLANK    WN0590  1        EDI Status 2
     C                     MOVEL*BLANK    WN0591  1        EDI Status 3
     C                     MOVEL*BLANK    WN0592  1        Record Status
     C                     Z-ADD*ZERO     WN0593  60       Job Time
     C                     MOVEL*BLANK    WN0594 10        User Id
     C                     MOVEL*BLANK    WN0595 10        Job Name
     C                     Z-ADD*ZERO     WN0596  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWFAIC3    WGAIC3           Company Number
     C                     MOVELWFV5ST    WGV5ST    P      Production Type
     C                     Z-ADDWFELDT    WGELDT           Production Date
     C                     Z-ADDWFHGCD    WGHGCD           Item Code
     C                     MOVELWFAJCD    WGAJCD    P      Warehouse Code
      *
     C           KLCHTB    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGV5ST           Production Type
     C                     KFLD           WGELDT           Production Date
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
     C           KLCHTB    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YFRDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWN0519    WGUNW2           PS Weight Inv A
     C                     Z-ADDWN0520    WGCENB           PS Pieces Inv A
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * UPS CHGOBJ Stamp      IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##PGM     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Upd Qty/Wgt Inv Alc   RT - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0597 112       OD Qty_Cnsmd Pi
     C                     Z-ADD*ZERO     WN0598 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0599 112       OD Quantity Inv
     C                     Z-ADD*ZERO     WN0600 112       OD Weight Inv S
     C                     Z-ADD*ZERO     WN0601 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0602 112       OD Unused weigh
     C                     MOVEL*BLANK    WN0603  1        OD Added to Sch
     C                     MOVEL*BLANK    WN0604  1        OD Reallocate S
     C                     MOVEL*BLANK    WN0605  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0606  1        EDI Status 1
     C                     MOVEL*BLANK    WN0607  1        EDI Status 2
     C                     MOVEL*BLANK    WN0608  1        EDI Status 3
     C                     MOVEL*BLANK    WN0609  1        Record Status
     C                     Z-ADD*ZERO     WN0610  60       Job Time
     C                     MOVEL*BLANK    WN0611 10        User Id
     C                     MOVEL*BLANK    WN0612 10        Job Name
     C                     Z-ADD*ZERO     WN0613  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSC4NB           Order Number
     C                     KFLD           WSDPNB           Order Sequence
     C                     KFLD           WSUENB           Order Secondary
     C                     KFLD           WSJGDT           OD Production D
      * Setup key
     C                     Z-ADDWL0210    WSAIC3           Company Number
     C                     Z-ADDWL0211    WSC4NB           Order Number
     C                     Z-ADDWL0212    WSDPNB           Order Sequence
     C                     Z-ADDWL0213    WSUENB           Order Secondary
     C                     Z-ADDWL0214    WSJGDT           OD Production D
      * Establish starting position
     C           KRSTC     CHAIN@KNCPHO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2238' W0RTN   7
      * USER: Processing if Data record not found
      * CRT Ord Detail Sched   CR - Order Detail Schedule  * 
     C                     EXSR TDCRRC
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WSIUQT    ADD  WL0219    WN0599           OD Quantity Inv
     C           WSF3WG    ADD  WL0220    WN0600           OD Weight Inv S
      * CASE: PAR.OD Quantity Inv Sched is LE Zero
     C           WN0599    IFLE 0                          *IF
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWSAIC3    WL0023           Company Number
     C                     Z-ADDWSC4NB    WL0024           Order Number
     C                     Z-ADDWSDPNB    WL0025           Order Sequence
     C                     Z-ADDWSUENB    WL0026           Order Secondary
     C                     Z-ADDWSJGDT    WL0027           OD Production D
     C                     EXSR SEDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Qty/Wgt Inv Alc - Order Detail Schedule  * 
     C                     EXSR TECHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDCRRC    BEGSR
      *================================================================
      * CRT Ord Detail Sched   CR - Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @KNCPHN
     C                     Z-ADDWL0210    WEAIC3           Company Number
     C                     Z-ADDWL0211    WEC4NB           Order Number
     C                     Z-ADDWL0212    WEDPNB           Order Sequence
     C                     Z-ADDWL0213    WEUENB           Order Secondary
     C                     Z-ADDWL0214    WEJGDT           OD Production D
     C                     Z-ADDWL0215    WEAODT           Scheduled Ship
     C                     MOVELWL0216    WEAJCD           Warehouse Code
     C                     MOVELWL0216    WEAYAA           Order From Ware
     C                     Z-ADDWL0218    WEHGCD           Item Code
     C                     Z-ADDWN0597    WEIGQT           OD Qty_Cnsmd Pi
     C                     Z-ADDWN0598    WEFLWG           OD Weight Sched
     C                     Z-ADDWL0219    WEIUQT           OD Quantity Inv
     C                     Z-ADDWL0220    WEF3WG           OD Weight Inv S
     C                     Z-ADDWN0601    WEIVQT           OD Quantity Unu
     C                     Z-ADDWN0602    WEF4WG           OD Unused weigh
     C                     MOVELWN0603    WEP7ST           OD Added to Sch
     C                     MOVELWN0604    WEP8ST           OD Reallocate S
     C                     MOVELWN0605    WEQAST           OD Status Unuse
     C                     MOVELWN0606    WEUVST           EDI Status 1
     C                     MOVELWN0607    WEUWST           EDI Status 2
     C                     MOVELWN0608    WEUXST           EDI Status 3
     C                     MOVELWN0609    WEVSST           Record Status
     C                     Z-ADDWN0610    WEAATM           Job Time
     C                     MOVELWN0611    WEAYNA           User Id
     C                     MOVELWN0612    WEA0NA           Job Name
     C                     Z-ADDWN0613    WEAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WEVSST           Record Status
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
     C           KLCRTD    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C                     KFLD           WEJGDT           OD Production D
      * Check for duplicate primary key
     C           KLCRTD    SETLL@KNCPHN                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2239' W0RTN   7
      * Send message 'Order Detail Schedule  EX'
     C                     MOVEL'USR2239' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C                     WRITE@KNCPHN                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TECHRC    BEGSR
      *================================================================
      * Chg Qty/Wgt Inv Alc - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0614  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0615  3        Warehouse Code
     C                     MOVEL*BLANK    WN0616  3        Order From Ware
     C                     Z-ADD*ZERO     WN0617  70       Item Code
     C                     Z-ADD*ZERO     WN0618 112       OD Qty_Cnsmd Pi
     C                     Z-ADD*ZERO     WN0619 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0620 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0621 112       OD Unused weigh
     C                     MOVEL*BLANK    WN0622  1        OD Added to Sch
     C                     MOVEL*BLANK    WN0623  1        OD Reallocate S
     C                     MOVEL*BLANK    WN0624  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0625  1        EDI Status 1
     C                     MOVEL*BLANK    WN0626  1        EDI Status 2
     C                     MOVEL*BLANK    WN0627  1        EDI Status 3
     C                     MOVEL*BLANK    WN0628  1        Record Status
     C                     Z-ADD*ZERO     WN0629  60       Job Time
     C                     MOVEL*BLANK    WN0630 10        User Id
     C                     MOVEL*BLANK    WN0631 10        Job Name
     C                     Z-ADD*ZERO     WN0632  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @KNCPHN
     C                     Z-ADDWL0210    WEAIC3           Company Number
     C                     Z-ADDWL0211    WEC4NB           Order Number
     C                     Z-ADDWL0212    WEDPNB           Order Sequence
     C                     Z-ADDWL0213    WEUENB           Order Secondary
     C                     Z-ADDWL0214    WEJGDT           OD Production D
      *
     C           KLCHTE    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C                     KFLD           WEJGDT           OD Production D
     C           KLCHTE    CHAIN@KNCPHN              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDKN1    YGRDCS
      * Move non-key fields to @KNCPHN
     C                     Z-ADDWN0599    WEIUQT           OD Quantity Inv
     C                     Z-ADDWN0600    WEF3WG           OD Weight Inv S
      *
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * UPS CHGOBJ Stamp      IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@KNCPHN                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDKNCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFDLRC    BEGSR
      *================================================================
      * Delete Order Detail Sched - Order Detail Sched-Inv  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B5CPM1
     C                     Z-ADDWL0221    WTAIC3           Company Number
     C                     Z-ADDWL0222    WTC4NB           Order Number
     C                     Z-ADDWL0223    WTDPNB           Order Sequence
     C                     Z-ADDWL0224    WTUENB           Order Secondary
     C                     Z-ADDWL0225    WTJGDT           OD Production D
      *
     C           KLDLTF    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTC4NB           Order Number
     C                     KFLD           WTDPNB           Order Sequence
     C                     KFLD           WTUENB           Order Secondary
     C                     KFLD           WTJGDT           OD Production D
     C           KLDLTF    CHAIN@B5CPM1              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB5CPL0'MDACP
     C                     MOVEL'@B5CPM1' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TFEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B5CPM1                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGCHRC    BEGSR
      *================================================================
      * Chg Ord Dtl Sch-Inv   CH - Order Detail Sched-Inv  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0633  1        EDI Status 1
     C                     MOVEL*BLANK    WN0634  1        EDI Status 2
     C                     MOVEL*BLANK    WN0635  1        EDI Status 3
     C                     MOVEL*BLANK    WN0636  1        Record Status
     C                     Z-ADD*ZERO     WN0637  60       Job Time
     C                     MOVEL*BLANK    WN0638 10        User Id
     C                     MOVEL*BLANK    WN0639 10        Job Name
     C                     Z-ADD*ZERO     WN0640  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @B5CPM1
     C                     Z-ADDWL0226    WTAIC3           Company Number
     C                     Z-ADDWL0227    WTC4NB           Order Number
     C                     Z-ADDWL0228    WTDPNB           Order Sequence
     C                     Z-ADDWL0229    WTUENB           Order Secondary
     C                     Z-ADDWL0230    WTJGDT           OD Production D
      *
     C           KLCHTG    KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTC4NB           Order Number
     C                     KFLD           WTDPNB           Order Sequence
     C                     KFLD           WTUENB           Order Secondary
     C                     KFLD           WTJGDT           OD Production D
     C           KLCHTG    CHAIN@B5CPM1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB5CPL0'MDACP
     C                     MOVEL'@B5CPM1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPOB51    YHRDCS
      * Move non-key fields to @B5CPM1
     C                     Z-ADDWL0231    WTAODT           Scheduled Ship
     C                     MOVELWL0232    WTAJCD    P      Warehouse Code
     C                     Z-ADDWL0233    WTHGCD           Item Code
     C                     Z-ADDWL0234    WTIUQT           OD Quantity Inv
     C                     Z-ADDWL0235    WTF3WG           OD Weight Inv S
      *
      * Set PGM.*Record Data Changed flag
     C           QPOB51    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WTAATM           Job Time
     C                     MOVEL##USR     WTAYNA           User Id
     C                     MOVEL##JOB     WTA0NA           Job Name
     C                     Z-ADD##JDT     WTAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPOB51    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@B5CPM1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPOB5CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1ELDT           Production Date
     C                     Z-ADD*ZERO     P1GVDT           Production Date
     C                     Z-ADD*ZERO     P1GWDT           Production Date
      *
      * Initialise indicators for re-entry
     C                     MOVE '0'       *IN
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WAJGDT           OD Production D
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAIGQT           OD Qty_Cnsmd Pi
     C                     Z-ADD*ZERO     WAFLWG           OD Weight Sched
     C                     Z-ADD*ZERO     WAIUQT           OD Quantity Inv
     C                     Z-ADD*ZERO     WAF3WG           OD Weight Inv S
     C                     Z-ADD*ZERO     WAIVQT           OD Quantity Unu
     C                     Z-ADD*ZERO     WAF4WG           OD Unused weigh
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field ATS Quantity Need USR
     C                     Z-ADD*ZERO     WUHWQT 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WBBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WBBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WBBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WBBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUWXST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDELDT           Production Date
     C                     Z-ADD*ZERO     WDHVHD           Hog Volume
     C                     Z-ADD*ZERO     WDZ6NB           Average Live We
     C                     Z-ADD*ZERO     WDZ7NB           Average Hot Wei
     C                     Z-ADD*ZERO     WDDGPC           Cooler Shrink P
     C                     Z-ADD*ZERO     WDAVCW           Average Cold We
     C                     Z-ADD*ZERO     WDDIPC           Average Lean Pe
     C                     Z-ADD*ZERO     WDZ0NB           Average Backfat
     C                     Z-ADD*ZERO     WDAVLE           Average Loin Ey
     C                     Z-ADD*ZERO     WDECWG           Hot Weight Tota
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFELDT           Production Date
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFGPDT           PS Available Sh
     C                     Z-ADD*ZERO     WFWTSP           PS Weight Plann
     C                     Z-ADD*ZERO     WFQTSP           PS Pieces Plann
     C                     Z-ADD*ZERO     WFDJPC           PS Pct of Carca
     C                     Z-ADD*ZERO     WFF8WG           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WFWTIN           PS Weight Inv O
     C                     Z-ADD*ZERO     WFD5NB           PS Pieces Inv O
     C                     Z-ADD*ZERO     WFDXWG           PS Weight Stand
     C                     Z-ADD*ZERO     WFB2NB           PS Pieces Stand
     C                     Z-ADD*ZERO     WFWTCN           PS Weight Conve
     C                     Z-ADD*ZERO     WFPSCV           PS Pieces Conve
     C                     Z-ADD*ZERO     WFSAWT           PS Weight Shipp
     C                     Z-ADD*ZERO     WFB9NB           PS Pieces Shipp
     C                     Z-ADD*ZERO     WFD1WG           PS Weight Prod
     C                     Z-ADD*ZERO     WFCBNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WFEZWG           PS Weight Inv A
     C                     Z-ADD*ZERO     WFCCNB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WFE0WG           PS Weight Ship
     C                     Z-ADD*ZERO     WFD6NB           PS Pieces Ship
     C                     Z-ADD*ZERO     WFOAWT           PS Weight Prod
     C                     Z-ADD*ZERO     WFCDNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WFUNW2           PS Weight Inv A
     C                     Z-ADD*ZERO     WFCENB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WFF9WG           PS Unit Weight
     C                     Z-ADD*ZERO     WFBPNB           PS Pieces Whs T
     C                     Z-ADD*ZERO     WFGAWG           PS Weight Whs T
     C                     Z-ADD*ZERO     WFBQNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WFGBWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WFBRNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WFGCWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WFBSNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WFGDWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WFBWNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WFGEWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WFPS6U           PS Pieces Unuse
     C                     Z-ADD*ZERO     WFDVWG           PS Weight Order
     C                     Z-ADD*ZERO     WFD7NB           PS Pieces Order
     C                     Z-ADD*ZERO     WFFCAD           PS Weight FC Ad
     C                     Z-ADD*ZERO     WFD9NB           PS Pieces FC Ad
     C                     Z-ADD*ZERO     WFDWWG           PS Weight FX Ad
     C                     Z-ADD*ZERO     WFEANB           PS Pieces FX Ad
     C                     Z-ADD*ZERO     WFSHWT           PS Weight Sched
     C                     Z-ADD*ZERO     WFEBNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WFAVWT           PS Weight Avail
     C                     Z-ADD*ZERO     WFECNB           PS Pieces Avail
     C                     Z-ADD*ZERO     WFWTON           PS Weight Produ
     C                     Z-ADD*ZERO     WFEDNB           PS Pieces Produ
     C                     Z-ADD*ZERO     WFFNWT           PS Weight Fab N
     C                     Z-ADD*ZERO     WFEENB           PS Pieces Fab N
     C                     Z-ADD*ZERO     WFQTAS           PS Weight Sched
     C                     Z-ADD*ZERO     WFEFNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WFWAIO           PS Weight Sched
     C                     Z-ADD*ZERO     WFEGNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WFRGNB           Item Structure
     C                     Z-ADD*ZERO     WFRHNB           Item Structure
     C                     Z-ADD*ZERO     WFRINB           Item Structure
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field Pieces Allocated USR
     C                     Z-ADD*ZERO     WUPCAL  70
      * Define work field ATS Weight Available USR
     C                     Z-ADD*ZERO     WUEOWG 112
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field UOM Primary
     C                     MOVEL*BLANK    WUADCD  2
      * Define work field Unit Weight
     C                     Z-ADD*ZERO     WUAIWG 112
      * Define work field Item Type Code
     C                     MOVEL*BLANK    WUN0CD  3
      * Define work field Default Warehouse
     C                     MOVEL*BLANK    WUQ1CD  3
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Define work field Base_Conv_Loss Item
     C                     MOVEL*BLANK    WUQZCD  2
      * Define work field Variety_Rendered_Cut
     C                     MOVEL*BLANK    WUXWST  1
      * Define work field Credit Item Status
     C                     MOVEL*BLANK    WUVMST  1
      * Define work field Std Weight_Head_Var_Ren
     C                     Z-ADD*ZERO     WUSWGH 112
      * Define work field Pieces Per Head
     C                     Z-ADD*ZERO     WUPPHE  70
      * Define work field Group for Packaging
     C                     MOVEL*BLANK    WUSDCD  1
      * Define work field Seconds Item
     C                     MOVEL*BLANK    WUX5ST  1
      * Define work field Pieces Per Bag
     C                     Z-ADD*ZERO     WUBDNB  70
      * Define work field Bags Per Unit
     C                     Z-ADD*ZERO     WUBJNB  70
      * Define work field Fresh Inv Allocation Seq
     C                     MOVEL*BLANK    WUSYST  1
      * Define work field Fresh Sched As Ordered
     C                     MOVEL*BLANK    WUSZST  1
      * Define work field Frozen Inv Allocation Seq
     C                     MOVEL*BLANK    WUS1ST  1
      * Define work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field Warehouse Location
     C                     MOVEL*BLANK    WUT0ST  1
      * Define work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    WUT1ST  1
      * Define work field Warehouse Chill Time
     C                     Z-ADD*ZERO     WUDBNB  52
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHHGCD           Item Code
     C                     Z-ADD*ZERO     WHAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WHAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WHAIWG           Unit Weight
     C                     Z-ADD*ZERO     WHCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WHC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WHURTN           Number Cases On
     C                     Z-ADD*ZERO     WHAJC8           Vendor Item Def
     C                     Z-ADD*ZERO     WHRINB           Item Structure
     C                     Z-ADD*ZERO     WHRHNB           Item Structure
     C                     Z-ADD*ZERO     WHRGNB           Item Structure
     C                     Z-ADD*ZERO     WHTFNB           Transportation
     C                     Z-ADD*ZERO     WHTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WHTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WHBLPR           Market Overage
     C                     Z-ADD*ZERO     WHBMPR           Standard Overag
     C                     Z-ADD*ZERO     WHCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WHCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WHSWGH           Std Weight_Head
     C                     Z-ADD*ZERO     WHPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WHICN1           Item Category N
     C                     Z-ADD*ZERO     WHICN2           Item Category N
     C                     Z-ADD*ZERO     WHV2NB           Item Category N
     C                     Z-ADD*ZERO     WHITCN           Item Category N
     C                     Z-ADD*ZERO     WHITC5           Item Category N
     C                     Z-ADD*ZERO     WHICN6           Item Category N
     C                     Z-ADD*ZERO     WHICN7           Item Category N
     C                     Z-ADD*ZERO     WHICN8           Item Category N
     C                     Z-ADD*ZERO     WHICN9           Item Category N
     C                     Z-ADD*ZERO     WHICN0           Item Category N
     C                     Z-ADD*ZERO     WHSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WHA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WHSJNB           Production Lead
     C                     Z-ADD*ZERO     WHSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WHSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WHSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WHCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WHCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WHILNB           Packages per ca
     C                     Z-ADD*ZERO     WHCHNB           Use_Freeze_Sell
     C                     Z-ADD*ZERO     WHCINB           PM Batch Size
     C                     Z-ADD*ZERO     WHCJNB           Package Level s
     C                     Z-ADD*ZERO     WHCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WHCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WHCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WHCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WHCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WHCWNB           PM Std LBS Man
     C                     Z-ADD*ZERO     WHCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WHCZNB           PM Formula LBS
     C                     Z-ADD*ZERO     WHC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WHB4NB           PM Raw Material
     C                     Z-ADD*ZERO     WHB5NB           PM Line Number
     C                     Z-ADD*ZERO     WHBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WHBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WHF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WHF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WHF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WHBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WHBNNB           Production Qty
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIBCDT           Post to G_L Dat
     C                     Z-ADD*ZERO     WICQNB           Julian Date
     C                     Z-ADD*ZERO     WIESNB           Accounting Year
     C                     Z-ADD*ZERO     WIETNB           Accounting Peri
     C                     Z-ADD*ZERO     WIBZNB           OM Week
     C                     Z-ADD*ZERO     WIEINB           Week Number
     C                     Z-ADD*ZERO     WIAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WIOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WINQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WINRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WIOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WIOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUCNTU  50
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJC4NB           Order Number
     C                     Z-ADD*ZERO     WJANC7           AR Customer Num
     C                     Z-ADD*ZERO     WJBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WJB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WJA0DT           Order Date
     C                     Z-ADD*ZERO     WJA5DT           Requested Ship
     C                     Z-ADD*ZERO     WJGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WJACDT           Cancel Date
     C                     Z-ADD*ZERO     WJAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WJCXDT           Date of Origina
     C                     Z-ADD*ZERO     WJJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WJA1WG           Order Weight To
     C                     Z-ADD*ZERO     WJEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WJAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WJRMNB           Load ID
     C                     Z-ADD*ZERO     WJTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WJR1NB           Rated Freight
     C                     Z-ADD*ZERO     WJRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WJATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WJRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WJT3NB           Attach to Order
     C                     Z-ADD*ZERO     WJCONB           Invoice Number
     C                     Z-ADD*ZERO     WJAWDT           Invoice Date
     C                     Z-ADD*ZERO     WJVRVA           A_R order Value
     C                     Z-ADD*ZERO     WJB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WJNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WJNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WJNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WJNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WJNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WJBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WJBQTM           Time of Origina
     C                     Z-ADD*ZERO     WJBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WJBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WJBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WJH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WJH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WJH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WJH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WJH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WJC0C7           Claim Number
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKC4NB           Order Number
     C                     Z-ADD*ZERO     WKDPNB           Order Sequence
     C                     Z-ADD*ZERO     WKUENB           Order Secondary
     C                     Z-ADD*ZERO     WKJGDT           OD Production D
     C                     Z-ADD*ZERO     WKOONY           ODS Sequence Nu
     C                     Z-ADD*ZERO     WKAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WKNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WKHGCD           Item Code
     C                     Z-ADD*ZERO     WKIGQT           OD Qty_Cnsmd Pi
     C                     Z-ADD*ZERO     WKFLWG           OD Weight Sched
     C                     Z-ADD*ZERO     WKNSQT           ODS Quantity Sh
     C                     Z-ADD*ZERO     WKJQWG           ODS Weight Shor
     C                     Z-ADD*ZERO     WKNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WKBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOAIC3           Company Number
     C                     Z-ADD*ZERO     WOHGCD           Item Code
     C                     Z-ADD*ZERO     WOC9NB           Component Item
     C                     Z-ADD*ZERO     WOBOPR           Sales Yield
     C                     Z-ADD*ZERO     WOBPPR           Production Yiel
     C                     Z-ADD*ZERO     WOHGQT           Packaging Quant
     C                     Z-ADD*ZERO     WOCNSM           Consume Priorit
     C                     Z-ADD*ZERO     WOBMY1           Consume Priorit
     C                     Z-ADD*ZERO     WOBMY2           BOM Pumped Perc
     C                     Z-ADD*ZERO     WOIXQT           BOM Meat Cost C
     C                     Z-ADD*ZERO     WOIYQT           BOM Off Line Yi
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Define work field Weight Deallocate USR
     C                     Z-ADD*ZERO     WUF1WG  92
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRAIC3           Company Number
     C                     Z-ADD*ZERO     WRC4NB           Order Number
     C                     Z-ADD*ZERO     WRDPNB           Order Sequence
     C                     Z-ADD*ZERO     WRUENB           Order Secondary
     C                     Z-ADD*ZERO     WRJGDT           OD Production D
     C                     Z-ADD*ZERO     WRAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WRHGCD           Item Code
     C                     Z-ADD*ZERO     WRIUQT           OD Quantity Inv
     C                     Z-ADD*ZERO     WRF3WG           OD Weight Inv S
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WJ02 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ01 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  30
     C                     MOVEL*BLANK    WL0005  3
     C                     Z-ADD*ZERO     WL0006  70
     C                     MOVEL*BLANK    WL0007  2
     C                     Z-ADD*ZERO     WL0008 112
     C                     MOVEL*BLANK    WL0009  2
     C                     MOVEL*BLANK    WL0010  1
     C                     Z-ADD*ZERO     WL0011  70
     C                     Z-ADD*ZERO     WL0012  70
     C                     Z-ADD*ZERO     WL0013 112
     C                     Z-ADD*ZERO     WL0014 112
     C                     Z-ADD*ZERO     WL0015 112
     C                     Z-ADD*ZERO     WL0016 112
     C                     Z-ADD*ZERO     WL0017 112
     C                     Z-ADD*ZERO     WL0018 112
     C                     Z-ADD*ZERO     WL0019  70
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0020  3
     C                     MOVEL*BLANK    WL0021  3
     C                     Z-ADD*ZERO     WL0022  30
      * Define local variables for subroutine SEDLRC.
     C                     Z-ADD*ZERO     WL0023  30
     C                     Z-ADD*ZERO     WL0024  70
     C                     Z-ADD*ZERO     WL0025  30
     C                     Z-ADD*ZERO     WL0026  30
     C                     Z-ADD*ZERO     WL0027  70
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0028  30
     C                     MOVEL*BLANK    WL0029  1
     C                     Z-ADD*ZERO     WL0030  70
     C                     Z-ADD*ZERO     WL0031  70
     C                     MOVEL*BLANK    WL0032  3
     C                     Z-ADD*ZERO     WL0033  92
     C                     Z-ADD*ZERO     WL0034  70
     C                     Z-ADD*ZERO     WL0035  92
     C                     Z-ADD*ZERO     WL0036  92
     C                     Z-ADD*ZERO     WL0037  70
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0038  30
     C                     MOVEL*BLANK    WL0039  1
     C                     Z-ADD*ZERO     WL0040  70
     C                     Z-ADD*ZERO     WL0041  70
     C                     MOVEL*BLANK    WL0042  3
     C                     Z-ADD*ZERO     WL0043  92
     C                     Z-ADD*ZERO     WL0044  70
     C                     Z-ADD*ZERO     WL0045  70
     C                     Z-ADD*ZERO     WL0046  30
     C                     Z-ADD*ZERO     WL0047  30
     C                     MOVEL*BLANK    WL0048  1
      * Define local variables for subroutine SHCRRC.
     C                     Z-ADD*ZERO     WL0049  30
     C                     MOVEL*BLANK    WL0050  1
     C                     Z-ADD*ZERO     WL0051  70
     C                     Z-ADD*ZERO     WL0052  70
     C                     MOVEL*BLANK    WL0053  3
     C                     Z-ADD*ZERO     WL0054  70
     C                     Z-ADD*ZERO     WL0055  92
     C                     Z-ADD*ZERO     WL0056  70
     C                     Z-ADD*ZERO     WL0057  72
     C                     Z-ADD*ZERO     WL0058  92
     C                     Z-ADD*ZERO     WL0059  92
     C                     Z-ADD*ZERO     WL0060  70
     C                     Z-ADD*ZERO     WL0061  92
     C                     Z-ADD*ZERO     WL0062  70
     C                     Z-ADD*ZERO     WL0063  92
     C                     Z-ADD*ZERO     WL0064  70
     C                     Z-ADD*ZERO     WL0065  92
     C                     Z-ADD*ZERO     WL0066  70
     C                     Z-ADD*ZERO     WL0067  92
     C                     Z-ADD*ZERO     WL0068  70
     C                     Z-ADD*ZERO     WL0069  92
     C                     Z-ADD*ZERO     WL0070  70
     C                     Z-ADD*ZERO     WL0071  92
     C                     Z-ADD*ZERO     WL0072  70
     C                     Z-ADD*ZERO     WL0073  92
     C                     Z-ADD*ZERO     WL0074  70
     C                     Z-ADD*ZERO     WL0075  92
     C                     Z-ADD*ZERO     WL0076  70
     C                     Z-ADD*ZERO     WL0077 112
     C                     Z-ADD*ZERO     WL0078  70
     C                     Z-ADD*ZERO     WL0079 112
     C                     Z-ADD*ZERO     WL0080  70
     C                     Z-ADD*ZERO     WL0081 112
     C                     Z-ADD*ZERO     WL0082  70
     C                     Z-ADD*ZERO     WL0083 112
     C                     Z-ADD*ZERO     WL0084  70
     C                     Z-ADD*ZERO     WL0085 112
     C                     Z-ADD*ZERO     WL0086  70
     C                     Z-ADD*ZERO     WL0087 112
     C                     Z-ADD*ZERO     WL0088  70
     C                     MOVEL*BLANK    WL0089  3
     C                     MOVEL*BLANK    WL0090  2
     C                     MOVEL*BLANK    WL0091  1
     C                     MOVEL*BLANK    WL0092  1
     C                     MOVEL*BLANK    WL0093  1
     C                     MOVEL*BLANK    WL0094  1
     C                     MOVEL*BLANK    WL0095  1
     C                     MOVEL*BLANK    WL0096  1
     C                     MOVEL*BLANK    WL0097  1
     C                     MOVEL*BLANK    WL0098  1
     C                     MOVEL*BLANK    WL0099  2
     C                     MOVEL*BLANK    WL0100  3
     C                     Z-ADD*ZERO     WL0101  92
     C                     Z-ADD*ZERO     WL0102  70
     C                     Z-ADD*ZERO     WL0103  92
     C                     Z-ADD*ZERO     WL0104  70
     C                     Z-ADD*ZERO     WL0105  92
     C                     Z-ADD*ZERO     WL0106  70
     C                     Z-ADD*ZERO     WL0107  92
     C                     Z-ADD*ZERO     WL0108  70
     C                     Z-ADD*ZERO     WL0109  92
     C                     Z-ADD*ZERO     WL0110  70
     C                     Z-ADD*ZERO     WL0111  92
     C                     Z-ADD*ZERO     WL0112  70
     C                     Z-ADD*ZERO     WL0113  92
     C                     Z-ADD*ZERO     WL0114  70
     C                     Z-ADD*ZERO     WL0115  92
     C                     Z-ADD*ZERO     WL0116  70
     C                     Z-ADD*ZERO     WL0117  92
     C                     Z-ADD*ZERO     WL0118  70
     C                     MOVEL*BLANK    WL0119  6
     C                     Z-ADD*ZERO     WL0120  30
     C                     Z-ADD*ZERO     WL0121  30
     C                     Z-ADD*ZERO     WL0122  30
     C                     MOVEL*BLANK    WL0123  6
     C                     MOVEL*BLANK    WL0124  1
     C                     MOVEL*BLANK    WL0125  1
     C                     MOVEL*BLANK    WL0126  1
     C                     MOVEL*BLANK    WL0127  1
     C                     Z-ADD*ZERO     WL0128  60
     C                     MOVEL*BLANK    WL0129 10
     C                     MOVEL*BLANK    WL0130 10
     C                     Z-ADD*ZERO     WL0131  70
      * Define local variables for subroutine SKRVGN.
     C                     Z-ADD*ZERO     WL0132  30
     C                     Z-ADD*ZERO     WL0133  70
     C                     Z-ADD*ZERO     WL0134  52
     C                     Z-ADD*ZERO     WL0135  70
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0136  30
     C                     Z-ADD*ZERO     WL0137  70
      * Define local variables for subroutine SMRVGN.
     C                     Z-ADD*ZERO     WL0138  30
     C                     Z-ADD*ZERO     WL0139  70
     C                     Z-ADD*ZERO     WL0140  30
     C                     Z-ADD*ZERO     WL0141  30
     C                     Z-ADD*ZERO     WL0142  70
     C                     Z-ADD*ZERO     WL0143  30
     C                     Z-ADD*ZERO     WL0144  70
     C                     Z-ADD*ZERO     WL0145  70
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0146  30
     C                     Z-ADD*ZERO     WL0147  70
     C                     Z-ADD*ZERO     WL0148  30
     C                     Z-ADD*ZERO     WL0149  30
     C                     Z-ADD*ZERO     WL0150  70
     C                     Z-ADD*ZERO     WL0151  30
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0152  30
     C                     Z-ADD*ZERO     WL0153  70
     C                     Z-ADD*ZERO     WL0154  30
     C                     Z-ADD*ZERO     WL0155  30
     C                     Z-ADD*ZERO     WL0156  70
     C                     Z-ADD*ZERO     WL0157  30
     C                     Z-ADD*ZERO     WL0158  70
     C                     MOVEL*BLANK    WL0159  3
     C                     Z-ADD*ZERO     WL0160  70
     C                     Z-ADD*ZERO     WL0161  70
     C                     Z-ADD*ZERO     WL0162 112
     C                     Z-ADD*ZERO     WL0163 112
     C                     Z-ADD*ZERO     WL0164  50
     C                     Z-ADD*ZERO     WL0165  92
     C                     Z-ADD*ZERO     WL0166  70
     C                     Z-ADD*ZERO     WL0167  60
      * Define local variables for subroutine STCHRC.
     C                     Z-ADD*ZERO     WL0168  30
     C                     Z-ADD*ZERO     WL0169  70
     C                     Z-ADD*ZERO     WL0170  30
     C                     Z-ADD*ZERO     WL0171  30
     C                     Z-ADD*ZERO     WL0172  70
     C                     Z-ADD*ZERO     WL0173 112
     C                     Z-ADD*ZERO     WL0174 112
     C                     Z-ADD*ZERO     WL0175 112
     C                     Z-ADD*ZERO     WL0176 112
     C                     MOVEL*BLANK    WL0177  1
      * Define local variables for subroutine SURVGN.
     C                     Z-ADD*ZERO     WL0178  30
     C                     Z-ADD*ZERO     WL0179  70
     C                     Z-ADD*ZERO     WL0180  52
     C                     MOVEL*BLANK    WL0181  1
      * Define local variables for subroutine SZRVGN.
     C                     Z-ADD*ZERO     WL0182  30
     C                     Z-ADD*ZERO     WL0183  70
     C                     Z-ADD*ZERO     WL0184  30
     C                     Z-ADD*ZERO     WL0185  30
     C                     MOVEL*BLANK    WL0186  3
     C                     Z-ADD*ZERO     WL0187  70
     C                     Z-ADD*ZERO     WL0188 112
     C                     MOVEL*BLANK    WL0189  1
     C                     Z-ADD*ZERO     WL0190  70
     C                     Z-ADD*ZERO     WL0191  70
     C                     Z-ADD*ZERO     WL0192 112
     C                     Z-ADD*ZERO     WL0193 112
     C                     Z-ADD*ZERO     WL0194 112
     C                     Z-ADD*ZERO     WL0195 112
     C                     Z-ADD*ZERO     WL0196 112
     C                     Z-ADD*ZERO     WL0197 112
     C                     Z-ADD*ZERO     WL0198  70
     C                     Z-ADD*ZERO     WL0199  70
      * Define local variables for subroutine TARVGN.
     C                     Z-ADD*ZERO     WL0200  30
     C                     MOVEL*BLANK    WL0201  1
     C                     Z-ADD*ZERO     WL0202  70
     C                     Z-ADD*ZERO     WL0203  70
     C                     MOVEL*BLANK    WL0204  3
     C                     MOVEL*BLANK    WL0205  1
     C                     Z-ADD*ZERO     WL0206  70
     C                     Z-ADD*ZERO     WL0207  70
     C                     Z-ADD*ZERO     WL0208  92
     C                     Z-ADD*ZERO     WL0209 112
      * Define local variables for subroutine TCRVGN.
     C                     Z-ADD*ZERO     WL0210  30
     C                     Z-ADD*ZERO     WL0211  70
     C                     Z-ADD*ZERO     WL0212  30
     C                     Z-ADD*ZERO     WL0213  30
     C                     Z-ADD*ZERO     WL0214  70
     C                     Z-ADD*ZERO     WL0215  70
     C                     MOVEL*BLANK    WL0216  3
     C                     MOVEL*BLANK    WL0217  3
     C                     Z-ADD*ZERO     WL0218  70
     C                     Z-ADD*ZERO     WL0219 112
     C                     Z-ADD*ZERO     WL0220  92
      * Define local variables for subroutine TFDLRC.
     C                     Z-ADD*ZERO     WL0221  30
     C                     Z-ADD*ZERO     WL0222  70
     C                     Z-ADD*ZERO     WL0223  30
     C                     Z-ADD*ZERO     WL0224  30
     C                     Z-ADD*ZERO     WL0225  70
      * Define local variables for subroutine TGCHRC.
     C                     Z-ADD*ZERO     WL0226  30
     C                     Z-ADD*ZERO     WL0227  70
     C                     Z-ADD*ZERO     WL0228  30
     C                     Z-ADD*ZERO     WL0229  30
     C                     Z-ADD*ZERO     WL0230  70
     C                     Z-ADD*ZERO     WL0231  70
     C                     MOVEL*BLANK    WL0232  3
     C                     Z-ADD*ZERO     WL0233  70
     C                     Z-ADD*ZERO     WL0234 112
     C                     Z-ADD*ZERO     WL0235 112
      * Define local work field Production Warehouse Code
     C                     MOVEL*BLANK    YL0001  3
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0002  30
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0003  30
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0004  30
      * Define local work field ODS Sequence Number
     C                     Z-ADD*ZERO     YL0005  30
      * Define local work field OD Weight Scheduled
     C                     Z-ADD*ZERO     YL0006 112
      * Define local work field OD Qty_Cnsmd Pieces Sched
     C                     Z-ADD*ZERO     YL0007 112
      *================================================================
     CSR         ZZEXIT    ENDSR
