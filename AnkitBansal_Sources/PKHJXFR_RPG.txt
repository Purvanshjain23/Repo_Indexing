     H/TITLE Val Kill Transaction   XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 00:34:04
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKB6CPL1IF  E           K        DISK
      * RTV : Eval/Loss Error           Retrieval index
      *
     FPKBSCPL3IF  E           K        DISK
      * RSQ : Loss Trans                By Bo/Ld/Tattoo No Delet
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKBSCPLBIF  E           K        DISK
      * RSQ : Loss Trans                Co/LsTyp/Bo/Ld/Tto/KDte
      *
     FPKA2CPL1IF  E           K        DISK
      * RTV : Tattoo Detail             Retrieval index
      *
     FPKDYCPL1IF  E           K        DISK
      * RTV : Tattoo Detail Ext         Retrieval index
      *
     FPKBVCPL3IF  E           K        DISK
      * RSQ : Eval Trans                Tattoo Evaluation
      *
     FPKBOREL1IF  E           K        DISK
      * RTV : Evaluation Validation     Retrieval index
      *
     FPKB6CPL0UF  E           K        DISK                      A
      * UPD : Eval/Loss Error           Update index
      *
     FPKBSCPL0UF  E           K        DISK
      * UPD : Loss Trans                Update index
      *
     FPKA1CPL1UF  E           K        DISK
      * UPD : Tattoo Header             Update index
      *
     FPKDYCPL0UF  E           K        DISK                      A
      * UPD : Tattoo Detail Ext         Update index
      *
     FPKBVCPL0UF  E           K        DISK
      * UPD : Eval Trans                Update index
      *
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     I@B6CPGX
      * Eval/Loss Error           Retrieval index
      * Renamed input format fields
     I              B6HRNB                          WAHRNB
     I              B6BPDT                          WABPDT
     I              B6IRNB                          WAIRNB
     I              B6BONM                          WABONM
     I              B6LDNM                          WALDNM
     I              B6FPNB                          WAFPNB
     I              B6DYST                          WADYST
     I              B6DXST                          WADXST
     I              B6B7TX                          WAB7TX
     I              B6AAVN                          WAAAVN
     I              B6AADT                          WAAADT
     I              B6AMTM                          WAAMTM
     I              B6AJST                          WAAJST
     I              B6AHVN                          WAAHVN
     I              B6AGVN                          WAAGVN
     I              B6ABVN                          WAABVN
     I              B6ABDT                          WAABDT
     I              B6ABTM                          WAABTM
      *
     I@B6CPGW
      * Eval/Loss Error           Update index
      * Renamed input format fields
     I              B6HRNB                          WBHRNB
     I              B6BPDT                          WBBPDT
     I              B6IRNB                          WBIRNB
     I              B6BONM                          WBBONM
     I              B6LDNM                          WBLDNM
     I              B6FPNB                          WBFPNB
     I              B6DYST                          WBDYST
     I              B6DXST                          WBDXST
     I              B6B7TX                          WBB7TX
     I              B6AAVN                          WBAAVN
     I              B6AADT                          WBAADT
     I              B6AMTM                          WBAMTM
     I              B6AJST                          WBAJST
     I              B6AHVN                          WBAHVN
     I              B6AGVN                          WBAGVN
     I              B6ABVN                          WBABVN
     I              B6ABDT                          WBABDT
     I              B6ABTM                          WBABTM
      *
     I@BSCPLV
      * Loss Trans                By Bo/Ld/Tattoo No Delet
      * Renamed input format fields
     I              BSHUNB                          WCHUNB
     I              BSA7DT                          WCA7DT
     I              BSFHNB                          WCFHNB
     I              BSFFNB                          WCFFNB
     I              BSEBST                          WCEBST
     I              BSDSNB                          WCDSNB
     I              BSS3NB                          WCS3NB
     I              BSS4NB                          WCS4NB
     I              BSD1ST                          WCD1ST
     I              BSH5ST                          WCH5ST
     I              BSJMST                          WCJMST
     I              BSSMST                          WCSMST
     I              BSBWCD                          WCBWCD
     I              BSBYCD                          WCBYCD
     I              BSHMNB                          WCHMNB
     I              BSBNNB                          WCBNNB
     I              BSBONB                          WCBONB
     I              BSCVNB                          WCCVNB
     I              BSB0DT                          WCB0DT
     I              BSAAVN                          WCAAVN
     I              BSAADT                          WCAADT
     I              BSAMTM                          WCAMTM
     I              BSAJST                          WCAJST
     I              BSAHVN                          WCAHVN
     I              BSAGVN                          WCAGVN
     I              BSABVN                          WCABVN
     I              BSABDT                          WCABDT
     I              BSABTM                          WCABTM
     I              BSB8DT                          WCB8DT
     I              BSAOTM                          WCAOTM
      *
     I@BSCPFS
      * Loss Trans                Update index
      * Renamed input format fields
     I              BSHUNB                          WDHUNB
     I              BSA7DT                          WDA7DT
     I              BSFHNB                          WDFHNB
     I              BSFFNB                          WDFFNB
     I              BSEBST                          WDEBST
     I              BSDSNB                          WDDSNB
     I              BSS3NB                          WDS3NB
     I              BSS4NB                          WDS4NB
     I              BSD1ST                          WDD1ST
     I              BSH5ST                          WDH5ST
     I              BSJMST                          WDJMST
     I              BSSMST                          WDSMST
     I              BSBWCD                          WDBWCD
     I              BSBYCD                          WDBYCD
     I              BSHMNB                          WDHMNB
     I              BSBNNB                          WDBNNB
     I              BSBONB                          WDBONB
     I              BSCVNB                          WDCVNB
     I              BSB0DT                          WDB0DT
     I              BSAAVN                          WDAAVN
     I              BSAADT                          WDAADT
     I              BSAMTM                          WDAMTM
     I              BSAJST                          WDAJST
     I              BSAHVN                          WDAHVN
     I              BSAGVN                          WDAGVN
     I              BSABVN                          WDABVN
     I              BSABDT                          WDABDT
     I              BSABTM                          WDABTM
     I              BSB8DT                          WDB8DT
     I              BSAOTM                          WDAOTM
      *
     I@A1CPC4
      * Tattoo Header             Retrieval index
      * Renamed input format fields
     I              A1HMNB                          WEHMNB
     I              A1BNNB                          WEBNNB
     I              A1BONB                          WEBONB
     I              A1CVNB                          WECVNB
     I              A1B0DT                          WEB0DT
     I              A1AWDT                          WEAWDT
     I              A1BICD                          WEBICD
     I              A1CPST                          WECPST
     I              A1ACPR                          WEACPR
     I              A1B9PR                          WEB9PR
     I              A1CAPR                          WECAPR
     I              A1C4ST                          WEC4ST
     I              A1AIPR                          WEAIPR
     I              A1A6DT                          WEA6DT
     I              A1C2ST                          WEC2ST
     I              A1CXNB                          WECXNB
     I              A1CWNB                          WECWNB
     I              A1FCNB                          WEFCNB
     I              A1H9NB                          WEH9NB
     I              A1FDNB                          WEFDNB
     I              A1FENB                          WEFENB
     I              A1HENB                          WEHENB
     I              A1HFNB                          WEHFNB
     I              A1CYNB                          WECYNB
     I              A1LRNB                          WELRNB
     I              A1E0NB                          WEE0NB
     I              A1A5PC                          WEA5PC
     I              A1FBNB                          WEFBNB
     I              A1A4PC                          WEA4PC
     I              A1F7NB                          WEF7NB
     I              A1HDNB                          WEHDNB
     I              A1F5NB                          WEF5NB
     I              A1F4NB                          WEF4NB
     I              A1F3NB                          WEF3NB
     I              A1F2NB                          WEF2NB
     I              A1AVPC                          WEAVPC
     I              A1AWPC                          WEAWPC
     I              A1CWPC                          WECWPC
     I              A1A8PC                          WEA8PC
     I              A1A7PC                          WEA7PC
     I              A1B8PR                          WEB8PR
     I              A1AMPR                          WEAMPR
     I              A1ANPR                          WEANPR
     I              A1AYVA                          WEAYVA
     I              A1AWVA                          WEAWVA
     I              A1AOPR                          WEAOPR
     I              A1AXVA                          WEAXVA
     I              A1APPR                          WEAPPR
     I              A1ASPR                          WEASPR
     I              A1A4VA                          WEA4VA
     I              A1ATPR                          WEATPR
     I              A1A5VA                          WEA5VA
     I              A1CBPR                          WECBPR
     I              A1CCPR                          WECCPR
     I              A1LPNB                          WELPNB
     I              A1CDPR                          WECDPR
     I              A1A7VA                          WEA7VA
     I              A1A2PR                          WEA2PR
     I              A1JWST                          WEJWST
     I              A1CWST                          WECWST
     I              A1D7ST                          WED7ST
     I              A1D8ST                          WED8ST
     I              A1DWST                          WEDWST
     I              A1D6ST                          WED6ST
     I              A1GHNB                          WEGHNB
     I              A1BYDT                          WEBYDT
     I              A1E0ST                          WEE0ST
     I              A1E1ST                          WEE1ST
     I              A1E2ST                          WEE2ST
     I              A1BSDT                          WEBSDT
     I              A1BTDT                          WEBTDT
     I              A1BUDT                          WEBUDT
     I              A1HGNB                          WEHGNB
     I              A1HHNB                          WEHHNB
     I              A1HINB                          WEHINB
     I              A1A3PR                          WEA3PR
     I              A1A4PR                          WEA4PR
     I              A1A6PR                          WEA6PR
     I              A1J9NB                          WEJ9NB
     I              A1D6PR                          WED6PR
     I              A1D7PR                          WED7PR
     I              A1D8PR                          WED8PR
     I              A1D9PR                          WED9PR
     I              A1EAPR                          WEEAPR
     I              A1EBPR                          WEEBPR
     I              A1ECPR                          WEECPR
     I              A1EDPR                          WEEDPR
     I              A1EEPR                          WEEEPR
     I              A1EFPR                          WEEFPR
     I              A1EGPR                          WEEGPR
     I              A1EHPR                          WEEHPR
     I              A1KAST                          WEKAST
     I              A1J7ST                          WEJ7ST
     I              A1J9ST                          WEJ9ST
     I              A1OXNB                          WEOXNB
     I              A1LKST                          WELKST
     I              A1LLST                          WELLST
     I              A1J8ST                          WEJ8ST
     I              A1LIST                          WELIST
     I              A1LJST                          WELJST
     I              A1NZTX                          WENZTX
     I              A1HJCD                          WEHJCD
     I              A1R4ST                          WER4ST
     I              A1R5ST                          WER5ST
     I              A1R6ST                          WER6ST
     I              A1R7ST                          WER7ST
     I              A1THWT                          WETHWT
     I              A1T2WT                          WET2WT
     I              A1THHD                          WETHHD
     I              A1T2HD                          WET2HD
     I              A1OBPR                          WEOBPR
     I              A1KOER                          WEKOER
     I              A1OPIR                          WEOPIR
     I              A1OPEM                          WEOPEM
     I              A1IORP                          WEIORP
     I              A1OWEO                          WEOWEO
     I              A1OQET                          WEOQET
     I              A1URST                          WEURST
     I              A1USST                          WEUSST
     I              A1HHPC                          WEHHPC
     I              A1S9PR                          WES9PR
     I              A1TAPR                          WETAPR
     I              A1TBPR                          WETBPR
     I              A1JFUR                          WEJFUR
     I              A1KRIF                          WEKRIF
     I              A1KORF                          WEKORF
     I              A1KAPR                          WEKAPR
     I              A1KROT                          WEKROT
     I              A1OTJG                          WEOTJG
     I              A1IRJG                          WEIRJG
     I              A1IMJF                          WEIMJF
     I              A1IRGF                          WEIRGF
     I              A1KRJF                          WEKRJF
     I              A1OJRF                          WEOJRF
     I              A1KFOR                          WEKFOR
     I              A1ORJK                          WEORJK
     I              A1OMVJ                          WEOMVJ
     I              A1MVNF                          WEMVNF
     I              A1MCNF                          WEMCNF
     I              A1NCNF                          WENCNF
     I              A1NCHF                          WENCHF
     I              A1IGIR                          WEIGIR
     I              A1KFJR                          WEKFJR
     I              A1EADT                          WEEADT
     I              A1EBDT                          WEEBDT
     I              A1ECDT                          WEECDT
     I              A1EDDT                          WEEDDT
     I              A1EEDT                          WEEEDT
     I              A1U4ST                          WEU4ST
     I              A1U5ST                          WEU5ST
     I              A1U6ST                          WEU6ST
     I              A1U7ST                          WEU7ST
     I              A1U8ST                          WEU8ST
     I              A1U9ST                          WEU9ST
     I              A1VAST                          WEVAST
     I              A1VBST                          WEVBST
     I              A1BDCD                          WEBDCD
     I              A1CSCD                          WECSCD
     I              A1ABCD                          WEABCD
     I              A1AECD                          WEAECD
     I              A1ACCD                          WEACCD
     I              A1AGCD                          WEAGCD
     I              A1BECD                          WEBECD
     I              A1AAVN                          WEAAVN
     I              A1AADT                          WEAADT
     I              A1AMTM                          WEAMTM
     I              A1AJST                          WEAJST
     I              A1AHVN                          WEAHVN
     I              A1AGVN                          WEAGVN
     I              A1ABVN                          WEABVN
     I              A1ABDT                          WEABDT
     I              A1ABTM                          WEABTM
      *
     I@BSCPEM
      * Loss Trans                Co/LsTyp/Bo/Ld/Tto/KDte
      * Renamed input format fields
     I              BSHUNB                          WFHUNB
     I              BSA7DT                          WFA7DT
     I              BSFHNB                          WFFHNB
     I              BSFFNB                          WFFFNB
     I              BSEBST                          WFEBST
     I              BSDSNB                          WFDSNB
     I              BSS3NB                          WFS3NB
     I              BSS4NB                          WFS4NB
     I              BSD1ST                          WFD1ST
     I              BSH5ST                          WFH5ST
     I              BSJMST                          WFJMST
     I              BSSMST                          WFSMST
     I              BSBWCD                          WFBWCD
     I              BSBYCD                          WFBYCD
     I              BSHMNB                          WFHMNB
     I              BSBNNB                          WFBNNB
     I              BSBONB                          WFBONB
     I              BSCVNB                          WFCVNB
     I              BSB0DT                          WFB0DT
     I              BSAAVN                          WFAAVN
     I              BSAADT                          WFAADT
     I              BSAMTM                          WFAMTM
     I              BSAJST                          WFAJST
     I              BSAHVN                          WFAHVN
     I              BSAGVN                          WFAGVN
     I              BSABVN                          WFABVN
     I              BSABDT                          WFABDT
     I              BSABTM                          WFABTM
     I              BSB8DT                          WFB8DT
     I              BSAOTM                          WFAOTM
      *
     I@A1CPC5
      * Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WGHMNB
     I              A1BNNB                          WGBNNB
     I              A1BONB                          WGBONB
     I              A1CVNB                          WGCVNB
     I              A1B0DT                          WGB0DT
     I              A1AWDT                          WGAWDT
     I              A1BICD                          WGBICD
     I              A1CPST                          WGCPST
     I              A1ACPR                          WGACPR
     I              A1B9PR                          WGB9PR
     I              A1CAPR                          WGCAPR
     I              A1C4ST                          WGC4ST
     I              A1AIPR                          WGAIPR
     I              A1A6DT                          WGA6DT
     I              A1C2ST                          WGC2ST
     I              A1CXNB                          WGCXNB
     I              A1CWNB                          WGCWNB
     I              A1FCNB                          WGFCNB
     I              A1H9NB                          WGH9NB
     I              A1FDNB                          WGFDNB
     I              A1FENB                          WGFENB
     I              A1HENB                          WGHENB
     I              A1HFNB                          WGHFNB
     I              A1CYNB                          WGCYNB
     I              A1LRNB                          WGLRNB
     I              A1E0NB                          WGE0NB
     I              A1A5PC                          WGA5PC
     I              A1FBNB                          WGFBNB
     I              A1A4PC                          WGA4PC
     I              A1F7NB                          WGF7NB
     I              A1HDNB                          WGHDNB
     I              A1F5NB                          WGF5NB
     I              A1F4NB                          WGF4NB
     I              A1F3NB                          WGF3NB
     I              A1F2NB                          WGF2NB
     I              A1AVPC                          WGAVPC
     I              A1AWPC                          WGAWPC
     I              A1CWPC                          WGCWPC
     I              A1A8PC                          WGA8PC
     I              A1A7PC                          WGA7PC
     I              A1B8PR                          WGB8PR
     I              A1AMPR                          WGAMPR
     I              A1ANPR                          WGANPR
     I              A1AYVA                          WGAYVA
     I              A1AWVA                          WGAWVA
     I              A1AOPR                          WGAOPR
     I              A1AXVA                          WGAXVA
     I              A1APPR                          WGAPPR
     I              A1ASPR                          WGASPR
     I              A1A4VA                          WGA4VA
     I              A1ATPR                          WGATPR
     I              A1A5VA                          WGA5VA
     I              A1CBPR                          WGCBPR
     I              A1CCPR                          WGCCPR
     I              A1LPNB                          WGLPNB
     I              A1CDPR                          WGCDPR
     I              A1A7VA                          WGA7VA
     I              A1A2PR                          WGA2PR
     I              A1JWST                          WGJWST
     I              A1CWST                          WGCWST
     I              A1D7ST                          WGD7ST
     I              A1D8ST                          WGD8ST
     I              A1DWST                          WGDWST
     I              A1D6ST                          WGD6ST
     I              A1GHNB                          WGGHNB
     I              A1BYDT                          WGBYDT
     I              A1E0ST                          WGE0ST
     I              A1E1ST                          WGE1ST
     I              A1E2ST                          WGE2ST
     I              A1BSDT                          WGBSDT
     I              A1BTDT                          WGBTDT
     I              A1BUDT                          WGBUDT
     I              A1HGNB                          WGHGNB
     I              A1HHNB                          WGHHNB
     I              A1HINB                          WGHINB
     I              A1A3PR                          WGA3PR
     I              A1A4PR                          WGA4PR
     I              A1A6PR                          WGA6PR
     I              A1J9NB                          WGJ9NB
     I              A1D6PR                          WGD6PR
     I              A1D7PR                          WGD7PR
     I              A1D8PR                          WGD8PR
     I              A1D9PR                          WGD9PR
     I              A1EAPR                          WGEAPR
     I              A1EBPR                          WGEBPR
     I              A1ECPR                          WGECPR
     I              A1EDPR                          WGEDPR
     I              A1EEPR                          WGEEPR
     I              A1EFPR                          WGEFPR
     I              A1EGPR                          WGEGPR
     I              A1EHPR                          WGEHPR
     I              A1KAST                          WGKAST
     I              A1J7ST                          WGJ7ST
     I              A1J9ST                          WGJ9ST
     I              A1OXNB                          WGOXNB
     I              A1LKST                          WGLKST
     I              A1LLST                          WGLLST
     I              A1J8ST                          WGJ8ST
     I              A1LIST                          WGLIST
     I              A1LJST                          WGLJST
     I              A1NZTX                          WGNZTX
     I              A1HJCD                          WGHJCD
     I              A1R4ST                          WGR4ST
     I              A1R5ST                          WGR5ST
     I              A1R6ST                          WGR6ST
     I              A1R7ST                          WGR7ST
     I              A1THWT                          WGTHWT
     I              A1T2WT                          WGT2WT
     I              A1THHD                          WGTHHD
     I              A1T2HD                          WGT2HD
     I              A1OBPR                          WGOBPR
     I              A1KOER                          WGKOER
     I              A1OPIR                          WGOPIR
     I              A1OPEM                          WGOPEM
     I              A1IORP                          WGIORP
     I              A1OWEO                          WGOWEO
     I              A1OQET                          WGOQET
     I              A1URST                          WGURST
     I              A1USST                          WGUSST
     I              A1HHPC                          WGHHPC
     I              A1S9PR                          WGS9PR
     I              A1TAPR                          WGTAPR
     I              A1TBPR                          WGTBPR
     I              A1JFUR                          WGJFUR
     I              A1KRIF                          WGKRIF
     I              A1KORF                          WGKORF
     I              A1KAPR                          WGKAPR
     I              A1KROT                          WGKROT
     I              A1OTJG                          WGOTJG
     I              A1IRJG                          WGIRJG
     I              A1IMJF                          WGIMJF
     I              A1IRGF                          WGIRGF
     I              A1KRJF                          WGKRJF
     I              A1OJRF                          WGOJRF
     I              A1KFOR                          WGKFOR
     I              A1ORJK                          WGORJK
     I              A1OMVJ                          WGOMVJ
     I              A1MVNF                          WGMVNF
     I              A1MCNF                          WGMCNF
     I              A1NCNF                          WGNCNF
     I              A1NCHF                          WGNCHF
     I              A1IGIR                          WGIGIR
     I              A1KFJR                          WGKFJR
     I              A1EADT                          WGEADT
     I              A1EBDT                          WGEBDT
     I              A1ECDT                          WGECDT
     I              A1EDDT                          WGEDDT
     I              A1EEDT                          WGEEDT
     I              A1U4ST                          WGU4ST
     I              A1U5ST                          WGU5ST
     I              A1U6ST                          WGU6ST
     I              A1U7ST                          WGU7ST
     I              A1U8ST                          WGU8ST
     I              A1U9ST                          WGU9ST
     I              A1VAST                          WGVAST
     I              A1VBST                          WGVBST
     I              A1BDCD                          WGBDCD
     I              A1CSCD                          WGCSCD
     I              A1ABCD                          WGABCD
     I              A1AECD                          WGAECD
     I              A1ACCD                          WGACCD
     I              A1AGCD                          WGAGCD
     I              A1BECD                          WGBECD
     I              A1AAVN                          WGAAVN
     I              A1AADT                          WGAADT
     I              A1AMTM                          WGAMTM
     I              A1AJST                          WGAJST
     I              A1AHVN                          WGAHVN
     I              A1AGVN                          WGAGVN
     I              A1ABVN                          WGABVN
     I              A1ABDT                          WGABDT
     I              A1ABTM                          WGABTM
      *
     I@A2CPDG
      * Tattoo Detail             Retrieval index
      * Renamed input format fields
     I              A2HMNB                          WHHMNB
     I              A2BNNB                          WHBNNB
     I              A2BONB                          WHBONB
     I              A2CVNB                          WHCVNB
     I              A2B0DT                          WHB0DT
     I              A2C2NB                          WHC2NB
     I              A2CZNB                          WHCZNB
     I              A2C0NB                          WHC0NB
     I              A2D8NB                          WHD8NB
     I              A2H7NB                          WHH7NB
     I              A2GGST                          WHGGST
     I              A2AJTM                          WHAJTM
     I              A2JEA1                          WHJEA1
     I              A2B7CD                          WHB7CD
     I              A2D7NB                          WHD7NB
     I              A2D9ST                          WHD9ST
     I              A2E3ST                          WHE3ST
     I              A2E4ST                          WHE4ST
     I              A2E5ST                          WHE5ST
     I              A2BVDT                          WHBVDT
     I              A2BWDT                          WHBWDT
     I              A2BXDT                          WHBXDT
     I              A2HVNB                          WHHVNB
     I              A2CMCD                          WHCMCD
     I              A2B9CD                          WHB9CD
     I              A2H8NB                          WHH8NB
     I              A2CYCD                          WHCYCD
     I              A2AAVN                          WHAAVN
     I              A2AADT                          WHAADT
     I              A2AMTM                          WHAMTM
     I              A2AJST                          WHAJST
     I              A2AHVN                          WHAHVN
     I              A2AGVN                          WHAGVN
     I              A2ABVN                          WHABVN
     I              A2ABDT                          WHABDT
     I              A2ABTM                          WHABTM
      *
     I@DYCPXX
      * Tattoo Detail Ext         Retrieval index
      * Renamed input format fields
     I              DYHMNB                          WIHMNB
     I              DYBNNB                          WIBNNB
     I              DYBONB                          WIBONB
     I              DYCVNB                          WICVNB
     I              DYB0DT                          WIB0DT
     I              DYC2NB                          WIC2NB
     I              DYP3ST                          WIP3ST
     I              DYLENB                          WILENB
     I              DYLFNB                          WILFNB
     I              DYLINB                          WILINB
     I              DYP4ST                          WIP4ST
     I              DYP5ST                          WIP5ST
     I              DYAAVN                          WIAAVN
     I              DYAADT                          WIAADT
     I              DYAMTM                          WIAMTM
     I              DYAJST                          WIAJST
     I              DYAHVN                          WIAHVN
     I              DYAGVN                          WIAGVN
     I              DYABVN                          WIABVN
     I              DYABDT                          WIABDT
     I              DYABTM                          WIABTM
      *
     I@DYCPXW
      * Tattoo Detail Ext         Update index
      * Renamed input format fields
     I              DYHMNB                          WJHMNB
     I              DYBNNB                          WJBNNB
     I              DYBONB                          WJBONB
     I              DYCVNB                          WJCVNB
     I              DYB0DT                          WJB0DT
     I              DYC2NB                          WJC2NB
     I              DYP3ST                          WJP3ST
     I              DYLENB                          WJLENB
     I              DYLFNB                          WJLFNB
     I              DYLINB                          WJLINB
     I              DYP4ST                          WJP4ST
     I              DYP5ST                          WJP5ST
     I              DYAAVN                          WJAAVN
     I              DYAADT                          WJAADT
     I              DYAMTM                          WJAMTM
     I              DYAJST                          WJAJST
     I              DYAHVN                          WJAHVN
     I              DYAGVN                          WJAGVN
     I              DYABVN                          WJABVN
     I              DYABDT                          WJABDT
     I              DYABTM                          WJABTM
      *
     I@BVCPG8
      * Eval Trans                Tattoo Evaluation
      * Renamed input format fields
     I              BVHSNB                          WKHSNB
     I              BVA9DT                          WKA9DT
     I              BVFJNB                          WKFJNB
     I              BVHCNB                          WKHCNB
     I              BVGDNB                          WKGDNB
     I              BVFINB                          WKFINB
     I              BVLKNB                          WKLKNB
     I              BVEAST                          WKEAST
     I              BVAMPC                          WKAMPC
     I              BVAIPC                          WKAIPC
     I              BVAJPC                          WKAJPC
     I              BVAKPC                          WKAKPC
     I              BVX8NB                          WKX8NB
     I              BVFVPC                          WKFVPC
     I              BVFWPC                          WKFWPC
     I              BVFXPC                          WKFXPC
     I              BVALPC                          WKALPC
     I              BVDIST                          WKDIST
     I              BVFYST                          WKFYST
     I              BVD2ST                          WKD2ST
     I              BVEHST                          WKEHST
     I              BVG1ST                          WKG1ST
     I              BVH4ST                          WKH4ST
     I              BVJLST                          WKJLST
     I              BVUUST                          WKUUST
     I              BVVHST                          WKVHST
     I              BVVIST                          WKVIST
     I              BVVJST                          WKVJST
     I              BVVKST                          WKVKST
     I              BVVLST                          WKVLST
     I              BVHMNB                          WKHMNB
     I              BVBNNB                          WKBNNB
     I              BVBONB                          WKBONB
     I              BVCVNB                          WKCVNB
     I              BVB0DT                          WKB0DT
     I              BVAAVN                          WKAAVN
     I              BVAADT                          WKAADT
     I              BVAMTM                          WKAMTM
     I              BVAJST                          WKAJST
     I              BVAHVN                          WKAHVN
     I              BVAGVN                          WKAGVN
     I              BVABVN                          WKABVN
     I              BVABDT                          WKABDT
     I              BVABTM                          WKABTM
     I              BVB8DT                          WKB8DT
     I              BVAOTM                          WKAOTM
      *
     I@BOREFN
      * Evaluation Validation     Retrieval index
      * Renamed input format fields
     I              BOBVCD                          WLBVCD
     I              BOCBTX                          WLCBTX
     I              BOC5ST                          WLC5ST
     I              BOAFPC                          WLAFPC
     I              BOAGPC                          WLAGPC
     I              BOFEST                          WLFEST
     I              BOAAVN                          WLAAVN
     I              BOAADT                          WLAADT
     I              BOAMTM                          WLAMTM
     I              BOAJST                          WLAJST
     I              BOAHVN                          WLAHVN
     I              BOAGVN                          WLAGVN
     I              BOABVN                          WLABVN
     I              BOABDT                          WLABDT
     I              BOABTM                          WLABTM
      *
     I@BVCPF0
      * Eval Trans                Update index
      * Renamed input format fields
     I              BVHSNB                          WMHSNB
     I              BVA9DT                          WMA9DT
     I              BVFJNB                          WMFJNB
     I              BVHCNB                          WMHCNB
     I              BVGDNB                          WMGDNB
     I              BVFINB                          WMFINB
     I              BVLKNB                          WMLKNB
     I              BVEAST                          WMEAST
     I              BVAMPC                          WMAMPC
     I              BVAIPC                          WMAIPC
     I              BVAJPC                          WMAJPC
     I              BVAKPC                          WMAKPC
     I              BVX8NB                          WMX8NB
     I              BVFVPC                          WMFVPC
     I              BVFWPC                          WMFWPC
     I              BVFXPC                          WMFXPC
     I              BVALPC                          WMALPC
     I              BVDIST                          WMDIST
     I              BVFYST                          WMFYST
     I              BVD2ST                          WMD2ST
     I              BVEHST                          WMEHST
     I              BVG1ST                          WMG1ST
     I              BVH4ST                          WMH4ST
     I              BVJLST                          WMJLST
     I              BVUUST                          WMUUST
     I              BVVHST                          WMVHST
     I              BVVIST                          WMVIST
     I              BVVJST                          WMVJST
     I              BVVKST                          WMVKST
     I              BVVLST                          WMVLST
     I              BVHMNB                          WMHMNB
     I              BVBNNB                          WMBNNB
     I              BVBONB                          WMBONB
     I              BVCVNB                          WMCVNB
     I              BVB0DT                          WMB0DT
     I              BVAAVN                          WMAAVN
     I              BVAADT                          WMAADT
     I              BVAMTM                          WMAMTM
     I              BVAJST                          WMAJST
     I              BVAHVN                          WMAHVN
     I              BVAGVN                          WMAGVN
     I              BVABVN                          WMABVN
     I              BVABDT                          WMABDT
     I              BVABTM                          WMABTM
     I              BVB8DT                          WMB8DT
     I              BVAOTM                          WMAOTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKB61    E DSPKB6CPL0
      * UPD : Eval/Loss Error           Update index
      * Renamed input format fields
     I              B6HRNB                          WBHRNB
     I              B6BPDT                          WBBPDT
     I              B6IRNB                          WBIRNB
     I              B6BONM                          WBBONM
     I              B6LDNM                          WBLDNM
     I              B6FPNB                          WBFPNB
     I              B6DYST                          WBDYST
     I              B6DXST                          WBDXST
     I              B6B7TX                          WBB7TX
     I              B6AAVN                          WBAAVN
     I              B6AADT                          WBAADT
     I              B6AMTM                          WBAMTM
     I              B6AJST                          WBAJST
     I              B6AHVN                          WBAHVN
     I              B6AGVN                          WBAGVN
     I              B6ABVN                          WBABVN
     I              B6ABDT                          WBABDT
     I              B6ABTM                          WBABTM
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPARC        DS                            111
      * RCD : Loss Trans                Retrieval index
      * I : MAP LTN Company Number
     I                                    P   1   20PAHUNB
      * I : MAP LTN Kill Date
     I                                    P   3   60PAA7DT
      * I : MAP LTN Record Number
     I                                    P   7  100PAFHNB
      * I : MAP LTN Tattoo Number
     I                                    P  11  130PAFFNB
      * I : MAP LTN Shift
     I                                       14  14 PAEBST
      * I : MAP LTN Wgt
     I                                    P  15  181PADSNB
      * I : MAP LTN Extent
     I                                       19  20 PAS3NB
      * I : MAP LTN Trim Location
     I                                       21  22 PAS4NB
      * B : MAP LTN Error Sts
     I                                       23  23 PAD1ST
      * I : MAP LTN Record Created Status
     I                                       24  24 PAH5ST
      * I : MAP LTN User Error Override
     I                                       25  25 PAJMST
      * I : MAP LTN Source Type
     I                                       26  26 PASMST
      * I : MAP LT Type Code
     I                                    P  27  280PABWCD
      * I : MAP LR Reason Code
     I                                    P  29  300PABYCD
      * I : MAP BOH Company Number
     I                                    P  31  320PAHMNB
      * I : MAP BOH Buy Order Number
     I                                    P  33  360PABNNB
      * I : MAP BOL Load Number
     I                                    P  37  390PABONB
      * I : MAP TH Tattoo Number
     I                                    P  40  420PACVNB
      * I : MAP TH Kill Date
     I                                    P  43  460PAB0DT
      * I : MAP RS User Changed
     I                                       47  56 PAAAVN
      * I : MAP RS Date Changed
     I                                    P  57  600PAAADT
      * I : MAP RS Time Changed
     I                                    P  61  640PAAMTM
      * I : MAP RS Record Status
     I                                       65  65 PAAJST
      * I : MAP RS Job
     I                                       66  75 PAAHVN
      * I : MAP RS Program
     I                                       76  85 PAAGVN
      * I : MAP RS User Added
     I                                       86  95 PAABVN
      * I : MAP RS Date Added
     I                                    P  96  990PAABDT
      * I : MAP RS Time Added
     I                                    P 100 1030PAABTM
      * I : MAP RU Date
     I                                    P 104 1070PAB8DT
      * I : MAP RU Time
     I                                    P 108 1110PAAOTM
      *
     IQPKBS1    E DSPKBSCPL0
      * UPD : Loss Trans                Update index
      * Renamed input format fields
     I              BSHUNB                          WDHUNB
     I              BSA7DT                          WDA7DT
     I              BSFHNB                          WDFHNB
     I              BSFFNB                          WDFFNB
     I              BSEBST                          WDEBST
     I              BSDSNB                          WDDSNB
     I              BSS3NB                          WDS3NB
     I              BSS4NB                          WDS4NB
     I              BSD1ST                          WDD1ST
     I              BSH5ST                          WDH5ST
     I              BSJMST                          WDJMST
     I              BSSMST                          WDSMST
     I              BSBWCD                          WDBWCD
     I              BSBYCD                          WDBYCD
     I              BSHMNB                          WDHMNB
     I              BSBNNB                          WDBNNB
     I              BSBONB                          WDBONB
     I              BSCVNB                          WDCVNB
     I              BSB0DT                          WDB0DT
     I              BSAAVN                          WDAAVN
     I              BSAADT                          WDAADT
     I              BSAMTM                          WDAMTM
     I              BSAJST                          WDAJST
     I              BSAHVN                          WDAHVN
     I              BSAGVN                          WDAGVN
     I              BSABVN                          WDABVN
     I              BSABDT                          WDABDT
     I              BSABTM                          WDABTM
     I              BSB8DT                          WDB8DT
     I              BSAOTM                          WDAOTM
      *
     IYARDCS      DS                            111
     IQPKA11    E DSPKA1CPL1
      * UPD : Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WGHMNB
     I              A1BNNB                          WGBNNB
     I              A1BONB                          WGBONB
     I              A1CVNB                          WGCVNB
     I              A1B0DT                          WGB0DT
     I              A1AWDT                          WGAWDT
     I              A1BICD                          WGBICD
     I              A1CPST                          WGCPST
     I              A1ACPR                          WGACPR
     I              A1B9PR                          WGB9PR
     I              A1CAPR                          WGCAPR
     I              A1C4ST                          WGC4ST
     I              A1AIPR                          WGAIPR
     I              A1A6DT                          WGA6DT
     I              A1C2ST                          WGC2ST
     I              A1CXNB                          WGCXNB
     I              A1CWNB                          WGCWNB
     I              A1FCNB                          WGFCNB
     I              A1H9NB                          WGH9NB
     I              A1FDNB                          WGFDNB
     I              A1FENB                          WGFENB
     I              A1HENB                          WGHENB
     I              A1HFNB                          WGHFNB
     I              A1CYNB                          WGCYNB
     I              A1LRNB                          WGLRNB
     I              A1E0NB                          WGE0NB
     I              A1A5PC                          WGA5PC
     I              A1FBNB                          WGFBNB
     I              A1A4PC                          WGA4PC
     I              A1F7NB                          WGF7NB
     I              A1HDNB                          WGHDNB
     I              A1F5NB                          WGF5NB
     I              A1F4NB                          WGF4NB
     I              A1F3NB                          WGF3NB
     I              A1F2NB                          WGF2NB
     I              A1AVPC                          WGAVPC
     I              A1AWPC                          WGAWPC
     I              A1CWPC                          WGCWPC
     I              A1A8PC                          WGA8PC
     I              A1A7PC                          WGA7PC
     I              A1B8PR                          WGB8PR
     I              A1AMPR                          WGAMPR
     I              A1ANPR                          WGANPR
     I              A1AYVA                          WGAYVA
     I              A1AWVA                          WGAWVA
     I              A1AOPR                          WGAOPR
     I              A1AXVA                          WGAXVA
     I              A1APPR                          WGAPPR
     I              A1ASPR                          WGASPR
     I              A1A4VA                          WGA4VA
     I              A1ATPR                          WGATPR
     I              A1A5VA                          WGA5VA
     I              A1CBPR                          WGCBPR
     I              A1CCPR                          WGCCPR
     I              A1LPNB                          WGLPNB
     I              A1CDPR                          WGCDPR
     I              A1A7VA                          WGA7VA
     I              A1A2PR                          WGA2PR
     I              A1JWST                          WGJWST
     I              A1CWST                          WGCWST
     I              A1D7ST                          WGD7ST
     I              A1D8ST                          WGD8ST
     I              A1DWST                          WGDWST
     I              A1D6ST                          WGD6ST
     I              A1GHNB                          WGGHNB
     I              A1BYDT                          WGBYDT
     I              A1E0ST                          WGE0ST
     I              A1E1ST                          WGE1ST
     I              A1E2ST                          WGE2ST
     I              A1BSDT                          WGBSDT
     I              A1BTDT                          WGBTDT
     I              A1BUDT                          WGBUDT
     I              A1HGNB                          WGHGNB
     I              A1HHNB                          WGHHNB
     I              A1HINB                          WGHINB
     I              A1A3PR                          WGA3PR
     I              A1A4PR                          WGA4PR
     I              A1A6PR                          WGA6PR
     I              A1J9NB                          WGJ9NB
     I              A1D6PR                          WGD6PR
     I              A1D7PR                          WGD7PR
     I              A1D8PR                          WGD8PR
     I              A1D9PR                          WGD9PR
     I              A1EAPR                          WGEAPR
     I              A1EBPR                          WGEBPR
     I              A1ECPR                          WGECPR
     I              A1EDPR                          WGEDPR
     I              A1EEPR                          WGEEPR
     I              A1EFPR                          WGEFPR
     I              A1EGPR                          WGEGPR
     I              A1EHPR                          WGEHPR
     I              A1KAST                          WGKAST
     I              A1J7ST                          WGJ7ST
     I              A1J9ST                          WGJ9ST
     I              A1OXNB                          WGOXNB
     I              A1LKST                          WGLKST
     I              A1LLST                          WGLLST
     I              A1J8ST                          WGJ8ST
     I              A1LIST                          WGLIST
     I              A1LJST                          WGLJST
     I              A1NZTX                          WGNZTX
     I              A1HJCD                          WGHJCD
     I              A1R4ST                          WGR4ST
     I              A1R5ST                          WGR5ST
     I              A1R6ST                          WGR6ST
     I              A1R7ST                          WGR7ST
     I              A1THWT                          WGTHWT
     I              A1T2WT                          WGT2WT
     I              A1THHD                          WGTHHD
     I              A1T2HD                          WGT2HD
     I              A1OBPR                          WGOBPR
     I              A1KOER                          WGKOER
     I              A1OPIR                          WGOPIR
     I              A1OPEM                          WGOPEM
     I              A1IORP                          WGIORP
     I              A1OWEO                          WGOWEO
     I              A1OQET                          WGOQET
     I              A1URST                          WGURST
     I              A1USST                          WGUSST
     I              A1HHPC                          WGHHPC
     I              A1S9PR                          WGS9PR
     I              A1TAPR                          WGTAPR
     I              A1TBPR                          WGTBPR
     I              A1JFUR                          WGJFUR
     I              A1KRIF                          WGKRIF
     I              A1KORF                          WGKORF
     I              A1KAPR                          WGKAPR
     I              A1KROT                          WGKROT
     I              A1OTJG                          WGOTJG
     I              A1IRJG                          WGIRJG
     I              A1IMJF                          WGIMJF
     I              A1IRGF                          WGIRGF
     I              A1KRJF                          WGKRJF
     I              A1OJRF                          WGOJRF
     I              A1KFOR                          WGKFOR
     I              A1ORJK                          WGORJK
     I              A1OMVJ                          WGOMVJ
     I              A1MVNF                          WGMVNF
     I              A1MCNF                          WGMCNF
     I              A1NCNF                          WGNCNF
     I              A1NCHF                          WGNCHF
     I              A1IGIR                          WGIGIR
     I              A1KFJR                          WGKFJR
     I              A1EADT                          WGEADT
     I              A1EBDT                          WGEBDT
     I              A1ECDT                          WGECDT
     I              A1EDDT                          WGEDDT
     I              A1EEDT                          WGEEDT
     I              A1U4ST                          WGU4ST
     I              A1U5ST                          WGU5ST
     I              A1U6ST                          WGU6ST
     I              A1U7ST                          WGU7ST
     I              A1U8ST                          WGU8ST
     I              A1U9ST                          WGU9ST
     I              A1VAST                          WGVAST
     I              A1VBST                          WGVBST
     I              A1BDCD                          WGBDCD
     I              A1CSCD                          WGCSCD
     I              A1ABCD                          WGABCD
     I              A1AECD                          WGAECD
     I              A1ACCD                          WGACCD
     I              A1AGCD                          WGAGCD
     I              A1BECD                          WGBECD
     I              A1AAVN                          WGAAVN
     I              A1AADT                          WGAADT
     I              A1AMTM                          WGAMTM
     I              A1AJST                          WGAJST
     I              A1AHVN                          WGAHVN
     I              A1AGVN                          WGAGVN
     I              A1ABVN                          WGABVN
     I              A1ABDT                          WGABDT
     I              A1ABTM                          WGABTM
      *
     IYBRDCS      DS                            583
     IQPKDY1    E DSPKDYCPL0
      * UPD : Tattoo Detail Ext         Update index
      * Renamed input format fields
     I              DYHMNB                          WJHMNB
     I              DYBNNB                          WJBNNB
     I              DYBONB                          WJBONB
     I              DYCVNB                          WJCVNB
     I              DYB0DT                          WJB0DT
     I              DYC2NB                          WJC2NB
     I              DYP3ST                          WJP3ST
     I              DYLENB                          WJLENB
     I              DYLFNB                          WJLFNB
     I              DYLINB                          WJLINB
     I              DYP4ST                          WJP4ST
     I              DYP5ST                          WJP5ST
     I              DYAAVN                          WJAAVN
     I              DYAADT                          WJAADT
     I              DYAMTM                          WJAMTM
     I              DYAJST                          WJAJST
     I              DYAHVN                          WJAHVN
     I              DYAGVN                          WJAGVN
     I              DYABVN                          WJABVN
     I              DYABDT                          WJABDT
     I              DYABTM                          WJABTM
      *
     IYCRDCS      DS                             88
     IQPKBV1    E DSPKBVCPL0
      * UPD : Eval Trans                Update index
      * Renamed input format fields
     I              BVHSNB                          WMHSNB
     I              BVA9DT                          WMA9DT
     I              BVFJNB                          WMFJNB
     I              BVHCNB                          WMHCNB
     I              BVGDNB                          WMGDNB
     I              BVFINB                          WMFINB
     I              BVLKNB                          WMLKNB
     I              BVEAST                          WMEAST
     I              BVAMPC                          WMAMPC
     I              BVAIPC                          WMAIPC
     I              BVAJPC                          WMAJPC
     I              BVAKPC                          WMAKPC
     I              BVX8NB                          WMX8NB
     I              BVFVPC                          WMFVPC
     I              BVFWPC                          WMFWPC
     I              BVFXPC                          WMFXPC
     I              BVALPC                          WMALPC
     I              BVDIST                          WMDIST
     I              BVFYST                          WMFYST
     I              BVD2ST                          WMD2ST
     I              BVEHST                          WMEHST
     I              BVG1ST                          WMG1ST
     I              BVH4ST                          WMH4ST
     I              BVJLST                          WMJLST
     I              BVUUST                          WMUUST
     I              BVVHST                          WMVHST
     I              BVVIST                          WMVIST
     I              BVVJST                          WMVJST
     I              BVVKST                          WMVKST
     I              BVVLST                          WMVLST
     I              BVHMNB                          WMHMNB
     I              BVBNNB                          WMBNNB
     I              BVBONB                          WMBONB
     I              BVCVNB                          WMCVNB
     I              BVB0DT                          WMB0DT
     I              BVAAVN                          WMAAVN
     I              BVAADT                          WMAADT
     I              BVAMTM                          WMAMTM
     I              BVAJST                          WMAJST
     I              BVAHVN                          WMAHVN
     I              BVAGVN                          WMAGVN
     I              BVABVN                          WMABVN
     I              BVABDT                          WMABDT
     I              BVABTM                          WMABTM
     I              BVB8DT                          WMB8DT
     I              BVAOTM                          WMAOTM
      *
     IYDRDCS      DS                            144
     IYERDCS      DS                            583
     IYFRDCS      DS                             88
      /EJECT
      * Parameter declarations
     IP1PARM      DS                            583
      * RCD: Tattoo Header             Retrieval index
      * I : MAP BOH Company Number
     I                                    P   1   20P1HMNB
      * I : MAP BOH Buy Order Number
     I                                    P   3   60P1BNNB
      * I : MAP BOL Load Number
     I                                    P   7   90P1BONB
      * I : MAP TH Tattoo Number
     I                                    P  10  120P1CVNB
      * I : MAP TH Kill Date
     I                                    P  13  160P1B0DT
      * I : MAP TH Purchase Date
     I                                    P  17  200P1AWDT
      * I : MAP TH Group Reference
     I                                       21  30 P1BICD
      * I : MAP TH Live Purchase UOM
     I                                       31  32 P1CPST
      * I : MAP TH Live Purchase Price
     I                                    P  33  352P1ACPR
      * I : MAP TH Live Gross Amt
     I                                    P  36  392P1B9PR
      * I : MAP TH LIve Net Amt
     I                                    P  40  432P1CAPR
      * I : MAP TH Resale UOM
     I                                       44  45 P1C4ST
      * I : MAP TH Recalc Live Wgt Yld
     I                                    P  46  482P1AIPR
      * I : MAP TH Pricing Date
     I                                    P  49  520P1A6DT
      * I : MAP TH Resale Spread Sts
     I                                       53  53 P1C2ST
      * I : MAP TH Dead On Arrival
     I                                    P  54  560P1CXNB
      * I : MAP TH Head Received
     I                                    P  57  590P1CWNB
      * I : MAP TH Yard Deads
     I                                    P  60  620P1FCNB
      * I : MAP TH Held Over
     I                                    P  63  650P1H9NB
      * I : MAP TH Head Condemned
     I                                    P  66  680P1FDNB
      * I : MAP TH Head Killed
     I                                    P  69  710P1FENB
      * I : MAP TH Head Adds
     I                                    P  72  740P1HENB
      * I : MAP TH Head Accepted
     I                                    P  75  770P1HFNB
      * I : MAP TH Live Wgt
     I                                    P  78  811P1CYNB
      * I : MAP TH Adj Live Wgt
     I                                    P  82  851P1LRNB
      * I : MAP TH Hot Wgt
     I                                    P  86  891P1E0NB
      * I : MAP TH Tot Loin Eye Depth
     I                                    P  90  931P1A5PC
      * I : MAP TH Tot Backfat Inches
     I                                    P  94  971P1FBNB
      * I : MAP TH Tot Light Reflectance
     I                                    P  98 1011P1A4PC
      * I : MAP TH Avg Live Wgt
     I                                    P 102 1041P1F7NB
      * I : MAP TH Avg Hot Wgt
     I                                    P 105 1071P1HDNB
      * I : MAP TH Avg Light Reflectance
     I                                    P 108 1091P1F5NB
      * I : MAP TH Avg Lean Percent
     I                                    P 110 1111P1F4NB
      * I : MAP TH Avg Loin Eye Depth
     I                                    P 112 1131P1F3NB
      * I : MAP TH Avg Backfat
     I                                    P 114 1151P1F2NB
      * I : MAP TH Std Yield Percent
     I                                    P 116 1182P1AVPC
      * I : MAP TH Actual Yield %
     I                                    P 119 1212P1AWPC
      * I : MAP TH Adj Actual Yield %
     I                                    P 122 1242P1CWPC
      * I : MAP TH Yield Difference
     I                                    P 125 1272P1A8PC
      * I : MAP TH Recalc Live Wgt
     I                                    P 128 1291P1A7PC
      * I : MAP TH CM Market Price
     I                                    P 130 1322P1B8PR
      * I : MAP TH CM Base Mkt Price
     I                                    P 133 1352P1AMPR
      * I : MAP TH CM Base Mkt Price Amt
     I                                    P 136 1392P1ANPR
      * I : MAP TH CM Sort Discount Amt
     I                                    P 140 1432P1AYVA
      * I : MAP TH CM Yield Gain/Loss Amt
     I                                    P 144 1472P1AWVA
      * I : MAP TH CM Base Carcass Value
     I                                    P 148 1512P1AOPR
      * I : MAP TH CM LN AddOn/Deduct Amt
     I                                    P 152 1552P1AXVA
      * I : MAP TH CM Carcass Gross Amt
     I                                    P 156 1592P1APPR
      * I : MAP TH Deduction Amt
     I                                    P 160 1632P1ASPR
      * I : MAP TH Total Net WO Adds
     I                                    P 164 1672P1A4VA
      * I : MAP TH Carcass Net Amt
     I                                    P 168 1712P1ATPR
      * I : MAP TH Additions Amt
     I                                    P 172 1752P1A5VA
      * I : MAP TH Payment Gross
     I                                    P 176 1792P1CBPR
      * I : MAP Th Payment Net Amt
     I                                    P 180 1832P1CCPR
      * I : MAP TH AP Voucher/Document#
     I                                    P 184 1880P1LPNB
      * I : MAP TH Freight Amount
     I                                    P 189 1922P1CDPR
      * I : MAP TH Accrual Amount
     I                                    P 193 1962P1A7VA
      * I : MAP TH Fixed Cost Amount
     I                                    P 197 2002P1A2PR
      * I : MAP TH Calc Net Sts
     I                                      201 201 P1JWST
      * I : MAP TH Payment Sts
     I                                      202 203 P1CWST
      * O : MAP TH Header Error Sts
     I                                      204 204 P1D7ST
      * O : MAP TH Detail Error Sts
     I                                      205 205 P1D8ST
      * O : MAP TH Kill Balancing Sts
     I                                      206 206 P1DWST
      * O : MAP TH Bal to Kill Gen
     I                                      207 207 P1D6ST
      * I : MAP TH Commission A/P Voucher
     I                                      208 2150P1GHNB
      * I : MAP TH Voucher Payment Date
     I                                    P 216 2190P1BYDT
      * I : MAP TH User Error Override
     I                                      220 220 P1E0ST
      * I : MAP TH Held Over Record
     I                                      221 221 P1E1ST
      * I : MAP TH Sex
     I                                      222 222 P1E2ST
      * I : MAP TH Held/Ovr Completed Dte
     I                                    P 223 2260P1BSDT
      * I : MAP TH Commission Paid Date
     I                                    P 227 2300P1BTDT
      * I : MAP TH Actual Check Date
     I                                    P 231 2340P1BUDT
      * I : MAP TH Shipped Weight
     I                                    P 235 2381P1HGNB
      * I : MAP TH Avg Hot Wgt EXC/ADD
     I                                    P 239 2421P1HHNB
      * I : MAP TH FFLI
     I                                    P 243 2441P1HINB
      * I : MAP TH Kill Product Value
     I                                    P 245 2482P1A3PR
      * I : MAP TH Cut Product Value
     I                                    P 249 2522P1A4PR
      * I : MAP TH Render Product Value
     I                                    P 253 2562P1A6PR
      * I : MAP TH Head Excluded
     I                                    P 257 2590P1J9NB
      * I : MAP TH CM Bse Mkt Live /CWT
     I                                    P 260 2622P1D6PR
      * I : MAP TH CM Bse Mkt Carc /CWT
     I                                    P 263 2652P1D7PR
      * I : MAP TH CM Srt Dsc Live /CWT
     I                                    P 266 2682P1D8PR
      * I : MAP TH CM Srt Dsc Carc /CWT
     I                                    P 269 2712P1D9PR
      * I : MAP TH CM Yld G/L Live /CWT
     I                                    P 272 2742P1EAPR
      * I : MAP TH CM Yld G/L Carc /CWT
     I                                    P 275 2772P1EBPR
      * I : MAP TH CM Crc Val Live /CWT
     I                                    P 278 2802P1ECPR
      * I : MAP TH CM Crc Val Carc /CWT
     I                                    P 281 2832P1EDPR
      * I : MAP TH CM Lean Prem Live /CWT
     I                                    P 284 2862P1EEPR
      * I : MAP TH CM Lean Prem Carc /CWT
     I                                    P 287 2892P1EFPR
      * I : MAP TH CM Gross Live /CWT
     I                                    P 290 2922P1EGPR
      * I : MAP TH CM Gross Carc /CWT
     I                                    P 293 2952P1EHPR
      * I : MAP TH Source Type
     I                                      296 296 P1KAST
      * I : MAP TH Scale Ticket Sts
     I                                      297 297 P1J7ST
      * I : MAP TH Payment Type
     I                                      298 298 P1J9ST
      * I : MAP TH HPS Movement Ref #
     I                                    P 299 3020P1OXNB
      * I : MAP TH Source Code
     I                                      303 305 P1LKST
      * I : MAP TH Hog Class Type
     I                                      306 306 P1LLST
      * I : MAP TH Posted to HPS Flag
     I                                      307 307 P1J8ST
      * I : MAP TH Schedule Kill Shift
     I                                      308 308 P1LIST
      * I : MAP TH Shift Held Over
     I                                      309 309 P1LJST
      * I : MAP DF Defect Code
     I                                      492 497 P1BDCD
      * I : MAP THP Process Code
     I                                      498 503 P1CSCD
      * I : MAP PD Producer Code
     I                                      504 509 P1ABCD
      * I : MAP PL Location Code
     I                                      510 515 P1AECD
      * I : MAP HB Buyer Code
     I                                      516 518 P1ACCD
      * I : MAP GN Genetic Code
     I                                      519 523 P1AGCD
      * I : MAP HC Class Code
     I                                      524 526 P1BECD
      * I : MAP RS User Changed
     I                                      527 536 P1AAVN
      * I : MAP RS Date Changed
     I                                    P 537 5400P1AADT
      * I : MAP RS Time Changed
     I                                    P 541 5440P1AMTM
      * I : MAP RS Record Status
     I                                      545 545 P1AJST
      * I : MAP RS Job
     I                                      546 555 P1AHVN
      * I : MAP RS Program
     I                                      556 565 P1AGVN
      * I : MAP RS User Added
     I                                      566 575 P1ABVN
      * I : MAP RS Date Added
     I                                    P 576 5790P1ABDT
      * I : MAP RS Time Added
     I                                    P 580 5830P1ABTM
     IP2PARM      DS
      * FLD: STR Evaluation Min/Max
      * I : MAP Carcass Dbw Min
     I                                    P   1   41P2I7NB
      * I : MAP Carcass Dbw Max
     I                                    P   5   81P2I8NB
      * I : MAP Carcass Lgt Min
     I                                    P   9  121P2I9NB
      * I : MAP Carcass Lgt Max
     I                                    P  13  161P2JANB
      * I : MAP %Lean High Min
     I                                    P  17  201P2JBNB
      * I : MAP %Lean High Max
     I                                    P  21  241P2JLNB
      * I : MAP %Lean Low Min
     I                                    P  25  281P2JMNB
      * I : MAP %Lean Low Max
     I                                    P  29  321P2JCNB
      * I : MAP High Yield Min
     I                                    P  33  361P2JDNB
      * I : MAP High Yield Max
     I                                    P  37  401P2JENB
      * I : MAP Low Yield Min
     I                                    P  41  441P2JFNB
      * I : MAP Low Yield Max
     I                                    P  45  481P2JGNB
      * I : MAP Head < Percent Min
     I                                    P  49  521P2JHNB
      * I : MAP Head < Percent Max
     I                                    P  53  561P2JINB
      * I : MAP Head > Percent Min
     I                                    P  57  601P2JJNB
      * I : MAP Head > Percent Max
     I                                    P  61  641P2JKNB
      * I : MAP BackFat High Min
     I                                    P  65  681P2K5NB
      * I : MAP BackFat High Max
     I                                    P  69  721P2K6NB
      * I : MAP BackFat Low Min
     I                                    P  73  761P2K7NB
      * I : MAP Backfat Low Max
     I                                    P  77  801P2K8NB
      * I : MAP LoinEye High Min
     I                                    P  81  841P2K9NB
      * I : MAP LoinEye High Max
     I                                    P  85  881P2LANB
      * I : MAP LoinEye Low Min
     I                                    P  89  921P2LBNB
      * I : MAP LoinEye Low Max
     I                                    P  93  961P2LCNB
     IP3PARM      DS
      * I :  Requested by User to Bal
     I                                        1   1 P3G2ST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           RCD: Tattoo Hea
     C           P2I7NB    PARM           WP0001  71       Carcass Dbw Min
     C           P2I8NB    PARM           WP0002  71       Carcass Dbw Max
     C           P2I9NB    PARM           WP0003  71       Carcass Lgt Min
     C           P2JANB    PARM           WP0004  71       Carcass Lgt Max
     C           P2JBNB    PARM           WP0005  71       %Lean High Min
     C           P2JLNB    PARM           WP0006  71       %Lean High Max
     C           P2JMNB    PARM           WP0007  71       %Lean Low Min
     C           P2JCNB    PARM           WP0008  71       %Lean Low Max
     C           P2JDNB    PARM           WP0009  71       High Yield Min
     C           P2JENB    PARM           WP0010  71       High Yield Max
     C           P2JFNB    PARM           WP0011  71       Low Yield Min
     C           P2JGNB    PARM           WP0012  71       Low Yield Max
     C           P2JHNB    PARM           WP0013  71       Head < Percent
     C           P2JINB    PARM           WP0014  71       Head < Percent
     C           P2JJNB    PARM           WP0015  71       Head > Percent
     C           P2JKNB    PARM           WP0016  71       Head > Percent
     C           P2K5NB    PARM           WP0017  71       BackFat High Mi
     C           P2K6NB    PARM           WP0018  71       BackFat High Ma
     C           P2K7NB    PARM           WP0019  71       BackFat Low Min
     C           P2K8NB    PARM           WP0020  71       Backfat Low Max
     C           P2K9NB    PARM           WP0021  71       LoinEye High Mi
     C           P2LANB    PARM           WP0022  71       LoinEye High Ma
     C           P2LBNB    PARM           WP0023  71       LoinEye Low Min
     C           P2LCNB    PARM           WP0024  71       LoinEye Low Max
     C           P3G2ST    PARM           WP0025  1        Requested by Us
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Val Kill Transaction  XF
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * Delete all error transaction for this company/kill date/tattoo
      * Dlt All Error's       RT - Eval/Loss Error  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    W0RTN            *Return code
      * Zero/blank/status fields for Tattoo Header to Zero/Blank/N
     C                     EXSR UBSUBR                     Zero/blank/stat
      * Tattoo Header Accumulate/Validate Loss Transaction
     C                     EXSR UCSUBR                     Tattoo Header A
     C                     MOVEL*BLANK    W0RTN            *Return code
     C           P1CWNB    SUB  P1FCNB    WUF6NB           Net Head Usr
     C                     SUB  WUFDNB    WUF6NB           Net Head Usr
     C           WUFDNB    ADD  P1FCNB    WUZANB           Net Head Adjust
      * Tattoo Header Accumulate/Validate Evaluation Records
     C                     EXSR UDSUBR                     Tattoo Header A
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     Z-ADD*ZERO     WUJPNB           Head Percent Us
      * Calculate Head %
      * CASE: WRK.Net Head Usr is Not Zero
     C           WUF6NB    IFNE *ZERO                      *IF
      * Cal Head Percent
      * WRK.Head Percent Usr =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : WRK.TH Head Killed
      * /     : PGM.*Synon (17,7) work field *
      * x2    : WRK.Net Head Usr
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           WUFENB    DIV  WUF6NB    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUJPNB           Head Percent Us
     C                     END                             *FI
      * Calculate Tattoo Header Averages/yield
     C                     EXSR UHSUBR                     Calculate Tatto
      * Validate tattoo header
      * CASE: WRK.Net Head Usr is *Zeros
     C           WUF6NB    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Validate tattoo header
     C                     EXSR UJSUBR                     Validate tattoo
     C                     END                             *FI
      * balance flags, user balance, system balance
      * CASE: PAR.Requested by User to Bal is Yes
     C           P3G2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'B'       WUDWST           TH Kill Balanci
      * CASE: WRK.TH Head Killed LT WRK.Net Head Usr
     C           WUFENB    IFLT WUF6NB                     *IF
     C                     MOVEL'U'       WUD6ST           TH Bal to Kill
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.TH Kill Balancing Sts is Error
     C           WUDWST    IFEQ 'E'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.TH Head Killed is *Zeros
     C           WUFENB    IFEQ *ZERO                      *IF
     C                     MOVEL'B'       WUDWST           TH Kill Balanci
     C                     ELSE
      * CASE: WRK.TH Head Killed EQ WRK.Net Head Usr
     C           WUFENB    IFEQ WUF6NB                     *IF
     C                     MOVEL'B'       WUDWST           TH Kill Balanci
     C                     ELSE
      * CASE: WRK.TH Head Killed GT WRK.Net Head Usr
     C           WUFENB    IFGT WUF6NB                     *IF
     C                     MOVEL'E'       WUDWST           TH Kill Balanci
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVELWUD7ST    P1D7ST           TH Header Error
     C                     MOVELWUD8ST    P1D8ST           TH Detail Error
     C                     MOVELWUDWST    P1DWST           TH Kill Balanci
     C                     MOVELWUD6ST    P1D6ST           TH Bal to Kill
      * ** OLD: Chg Tattoo Header   CH * Tattoo Header ** (PKP)
      * Chg Val Kill Trans    CH - Tattoo Header  * 
     C                     EXSR TNCHRC
      * Added 8/7/98 -- call c4841  (rmc)
      * If Internal, and balanced change the TD Ext complete status to Ye
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.TH Kill Balancing Sts is Balance
      *   |- c2    : PAR.TH Tattoo Number is Internals
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUDWST    IFEQ 'B'                        *IF
     C           P1CVNB    IFGE 7000                       *IF
     C           P1CVNB    ANDLE7999
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RtvChg Td Cmpl Sts     RT - Tattoo Detail Ext  * 
     C                     EXSR TORVGN
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Dlt All Error's       RT - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHRNB    WQSA01           KV Company Numb
     C           *LIKE     DEFN WABPDT    WQSA02           KV Kill Date
     C           *LIKE     DEFN WAIRNB    WQSA03           KV TATTOO NUMBE
     C           *LIKE     DEFN WABONM    WQSA04           KV Buy Order Nu
     C           *LIKE     DEFN WALDNM    WQSA05           KV Load Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           KV Company Numb
     C                     KFLD           WQSA02           KV Kill Date
     C                     KFLD           WQSA03           KV TATTOO NUMBE
     C                     KFLD           WQSA04           KV Buy Order Nu
     C                     KFLD           WQSA05           KV Load Number
      * Setup key
     C                     Z-ADDP1HMNB    WQSA01           KV Company Numb
     C                     Z-ADDP1B0DT    WQSA02           KV Kill Date
     C                     Z-ADDP1CVNB    WQSA03           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WQSA04           KV Buy Order Nu
     C                     Z-ADDP1BONB    WQSA05           KV Load Number
      * Establish starting position
     C           KRSSA     SETLL@B6CPGX                    *
     C           KRSSA     READE@B6CPGX                  90*
      * Data record not found
     C   90                MOVEL'PRK0150' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WABONM' defaulted for 'KV Buy Order Number'.
      * Field '(DB1) WALDNM' defaulted for 'KV Load Number'.
      * Delete Kill Validation - Eval/Loss Error  * 
     C                     EXSR SBDLRC
     C           KRSSA     READE@B6CPGX                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBDLRC    BEGSR
      *================================================================
      * Delete Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B6CPGW
     C                     Z-ADDWAHRNB    WBHRNB           KV Company Numb
     C                     Z-ADDWABPDT    WBBPDT           KV Kill Date
     C                     Z-ADDWAIRNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWABONM    WBBONM           KV Buy Order Nu
     C                     Z-ADDWALDNM    WBLDNM           KV Load Number
     C                     Z-ADDWAFPNB    WBFPNB           KV Record Numbe
     C                     MOVELWADYST    WBDYST           KV Record Type
     C                     MOVELWADXST    WBDXST           KV Error Code
      *
     C           KLDLSB    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
     C           KLDLSB    CHAIN@B6CPGW              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKB6CPL0'MDACP
     C                     MOVEL'@B6CPGW' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B6CPGW                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Bal/Tattoo Hdr    RT - Loss Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSC01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQSC02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQSC03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQSC04           TH Tattoo Numbe
     C           *LIKE     DEFN WCB0DT    WQSC05           TH Kill Date
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           BOH Company Num
     C                     KFLD           WQSC02           BOH Buy Order N
     C                     KFLD           WQSC03           BOL Load Number
     C                     KFLD           WQSC04           TH Tattoo Numbe
     C                     KFLD           WQSC05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQSC01           BOH Company Num
     C                     Z-ADDP1BNNB    WQSC02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQSC03           BOL Load Number
     C                     Z-ADDP1CVNB    WQSC04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQSC05           TH Kill Date
      * Establish starting position
     C           KRSSC     SETLL@BSCPLV                    *
     C           KRSSC     READE@BSCPLV                  90*
      * Data record not found
     C   90                MOVEL'PRK0115' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.LT Type Code is Carcass Loss
      *   |- c2    : DB1.LTN Wgt is Zeros
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCBWCD    IFEQ 02                         *IF
     C           WCDSNB    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDP1F7NB    WUDSNB           LTN Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWCDSNB    WUDSNB           LTN Wgt
     C                     END                             *FI
      * Val Loss Trans        XF - Loss Trans  * 
     C                     CLEARPARC
     C                     Z-ADDWCHUNB    PAHUNB           LTN Company Num
     C                     Z-ADDWCA7DT    PAA7DT           LTN Kill Date
     C                     Z-ADDWCFHNB    PAFHNB           LTN Record Numb
     C                     Z-ADDWCFFNB    PAFFNB           LTN Tattoo Numb
     C                     MOVELWCEBST    PAEBST    P      LTN Shift
     C                     Z-ADDWUDSNB    PADSNB           LTN Wgt
     C                     MOVELWCS3NB    PAS3NB    P      LTN Extent
     C                     MOVELWCS4NB    PAS4NB    P      LTN Trim Locati
     C                     MOVELWUD1ST    PAD1ST    P      LTN Error Sts
     C                     MOVELWCH5ST    PAH5ST    P      LTN Record Crea
     C                     MOVELWCJMST    PAJMST    P      LTN User Error
     C                     MOVELWCSMST    PASMST    P      LTN Source Type
     C                     Z-ADDWCBWCD    PABWCD           LT Type Code
     C                     Z-ADDWCBYCD    PABYCD           LR Reason Code
     C                     Z-ADDWCHMNB    PAHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    PABNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    PABONB           BOL Load Number
     C                     Z-ADDWCCVNB    PACVNB           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    PAB0DT           TH Kill Date
     C                     MOVELWCAAVN    PAAAVN    P      RS User Changed
     C                     Z-ADDWCAADT    PAAADT           RS Date Changed
     C                     Z-ADDWCAMTM    PAAMTM           RS Time Changed
     C                     MOVELWCAJST    PAAJST    P      RS Record Statu
     C                     MOVELWCAHVN    PAAHVN    P      RS Job
     C                     MOVELWCAGVN    PAAGVN    P      RS Program
     C                     MOVELWCABVN    PAABVN    P      RS User Added
     C                     Z-ADDWCABDT    PAABDT           RS Date Added
     C                     Z-ADDWCABTM    PAABTM           RS Time Added
     C                     Z-ADDWCB8DT    PAB8DT           RU Date
     C                     Z-ADDWCAOTM    PAAOTM           RU Time
      *
     C                     CALL 'PKPJXFR'              90  Val Loss Trans
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Loss Trans
     C           WUFDNB    PARM WUFDNB    WQ0001  50       TH Head Condemn
     C           WUH9ST    PARM WUH9ST    WQ0002  1        Loss Error 1 Us
     C           WUIAST    PARM WUIAST    WQ0003  1        Loss Error 2 Us
     C           WUIBST    PARM WUIBST    WQ0004  1        Loss Error 3 Us
     C           WUICST    PARM WUICST    WQ0005  1        Loss Error 4 Us
     C           WULRST    PARM WULRST    WQ0006  1        Loss Error 5 Us
     C           WUD8ST    PARM WUD8ST    WQ0007  1        TH Detail Error
      *
     C                     MOVELPAD1ST    WUD1ST           LTN Error Sts
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKPJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Chg Loss Transaction  CH - Loss Trans  * 
     C                     EXSR SDCHRC
     C           KRSSC     READE@BSCPLV                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCHRC    BEGSR
      *================================================================
      * Chg Loss Transaction  CH - Loss Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BSCPFS
     C                     Z-ADDWCHUNB    WDHUNB           LTN Company Num
     C                     Z-ADDWCA7DT    WDA7DT           LTN Kill Date
     C                     Z-ADDWCFHNB    WDFHNB           LTN Record Numb
      *
     C           KLCHSD    KLIST
     C                     KFLD           WDHUNB           LTN Company Num
     C                     KFLD           WDA7DT           LTN Kill Date
     C                     KFLD           WDFHNB           LTN Record Numb
     C           KLCHSD    CHAIN@BSCPFS              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBSCPL0'MDACP
     C                     MOVEL'@BSCPFS' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBS1    YARDCS
      * Move non-key fields to @BSCPFS
     C                     Z-ADDWCFFNB    WDFFNB           LTN Tattoo Numb
     C                     MOVELWCEBST    WDEBST    P      LTN Shift
     C                     Z-ADDWUDSNB    WDDSNB           LTN Wgt
     C                     MOVELWCS3NB    WDS3NB    P      LTN Extent
     C                     MOVELWCS4NB    WDS4NB    P      LTN Trim Locati
     C                     MOVELWUD1ST    WDD1ST    P      LTN Error Sts
     C                     MOVELWCH5ST    WDH5ST    P      LTN Record Crea
     C                     MOVELWCJMST    WDJMST    P      LTN User Error
     C                     MOVELWCSMST    WDSMST    P      LTN Source Type
     C                     Z-ADDWCBWCD    WDBWCD           LT Type Code
     C                     Z-ADDWCBYCD    WDBYCD           LR Reason Code
     C                     Z-ADDWCHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    WDBONB           BOL Load Number
     C                     Z-ADDWCCVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    WDB0DT           TH Kill Date
     C                     MOVEL##USR     WDAAVN    P      RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVELWCAJST    WDAJST    P      RS Record Statu
     C                     MOVELWCAHVN    WDAHVN    P      RS Job
     C                     MOVELWCAGVN    WDAGVN    P      RS Program
     C                     MOVELWCABVN    WDABVN    P      RS User Added
     C                     Z-ADDWCABDT    WDABDT           RS Date Added
     C                     Z-ADDWCABTM    WDABTM           RS Time Added
     C                     Z-ADDWCB8DT    WDB8DT           RU Date
     C                     Z-ADDWCAOTM    WDAOTM           RU Time
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBS1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WDAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WDAGVN' defaulted for 'RS Program'.
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBS1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BSCPFS                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBSCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * Upd Head Condemn      RT - Tattoo Header  * 
     C                     EXSR SERVGN
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Upd Head Condemn      RT - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  50       TH Head Condemn
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDWDHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WEBONB           BOL Load Number
     C                     Z-ADDWDCVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WEB0DT           TH Kill Date
      * Establish starting position
     C           KRSSE     CHAIN@A1CPC4              90    *
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Rtv Head Condemned    RT - Loss Trans  * 
     C                     EXSR SFRVGN
      * Chg Head Condemned    CH - Tattoo Header  * 
     C                     EXSR SGCHRC
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Head Condemned    RT - Loss Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0001           TH Head Condemn
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFBWCD    WQSF01           LT Type Code
     C           *LIKE     DEFN WFHMNB    WQSF02           BOH Company Num
     C           *LIKE     DEFN WFBNNB    WQSF03           BOH Buy Order N
     C           *LIKE     DEFN WFBONB    WQSF04           BOL Load Number
     C           *LIKE     DEFN WFCVNB    WQSF05           TH Tattoo Numbe
     C           *LIKE     DEFN WFB0DT    WQSF06           TH Kill Date
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           LT Type Code
     C                     KFLD           WQSF02           BOH Company Num
     C                     KFLD           WQSF03           BOH Buy Order N
     C                     KFLD           WQSF04           BOL Load Number
     C                     KFLD           WQSF05           TH Tattoo Numbe
     C                     KFLD           WQSF06           TH Kill Date
      * Setup key
     C                     Z-ADD02        WQSF01           LT Type Code
     C                     Z-ADDWEHMNB    WQSF02           BOH Company Num
     C                     Z-ADDWEBNNB    WQSF03           BOH Buy Order N
     C                     Z-ADDWEBONB    WQSF04           BOL Load Number
     C                     Z-ADDWECVNB    WQSF05           TH Tattoo Numbe
     C                     Z-ADDWEB0DT    WQSF06           TH Kill Date
      * Establish starting position
     C           KRSSF     SETLL@BSCPEM                    *
     C           KRSSF     READE@BSCPEM                  90*
      * Data record not found
     C   90                MOVEL'PRK0115' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WN0001           TH Head Condemn
     C           KRSSF     READE@BSCPEM                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * Chg Head Condemned    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0002  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0003 10        TH Group Refere
     C                     MOVEL*BLANK    WN0004  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0005  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0006  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0007  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0008  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0009  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0010  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0011  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0012  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0013  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0014  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0015  50       TH Held Over
     C                     Z-ADD*ZERO     WN0016  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0017  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0018  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0019  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0020  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0021  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0022  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0023  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0024  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0025  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0026  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0027  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0028  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0029  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0030  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0031  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0032  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0033  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0034  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0035  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0036  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0037  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0038  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0039  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0040  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0041  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0042  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0043  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0044  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0045  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0046  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0047  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0048  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0049  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0050  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0051  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0052  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0053  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0054  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0055  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0056  1        TH Header Error
     C                     MOVEL*BLANK    WN0057  1        TH Detail Error
     C                     MOVEL*BLANK    WN0058  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0059  80       TH Commission A
     C                     Z-ADD*ZERO     WN0060  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0061  1        TH User Error O
     C                     MOVEL*BLANK    WN0062  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0063  1        TH Sex
     C                     Z-ADD*ZERO     WN0064  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0065  70       TH Commission P
     C                     Z-ADD*ZERO     WN0066  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0067  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0068  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0069  31       TH FFLI
     C                     Z-ADD*ZERO     WN0070  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0071  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0072  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0073  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0074  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0075  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0076  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0077  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0078  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0079  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0080  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0081  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0082  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0083  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0084  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0085  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0086  1        TH Source Type
     C                     MOVEL*BLANK    WN0087  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0088  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0089  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0090  3        TH Source Code
     C                     MOVEL*BLANK    WN0091  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0092  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0093  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0094  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0095  3        TH State
     C                     MOVEL*BLANK    WN0096  3        TH Unused Code
     C                     MOVEL*BLANK    WN0097  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0098  1        TH Commission S
     C                     MOVEL*BLANK    WN0099  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0100  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0101  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0102  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0103  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0104  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0105  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0106  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0107  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0108  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0109  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0110  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0111  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0112  3        TH PHA Average
     C                     MOVEL*BLANK    WN0113  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0114  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0115  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0116  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0117  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0118  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0119  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0120  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0121  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0122  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0123  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0124  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0125  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0126 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0127 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0128 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0129 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0130  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0131  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0132  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0133  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0134  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0135  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0136  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0137  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0138  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0139  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0140  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0141  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0142  70       TH Unused Date
     C                     MOVEL*BLANK    WN0143  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0144  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0145  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0146  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0147  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0148  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0149  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0150  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0151  6        DF Defect Code
     C                     MOVEL*BLANK    WN0152  6        THP Process Cod
     C                     MOVEL*BLANK    WN0153  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0154  6        PL Location Cod
     C                     MOVEL*BLANK    WN0155  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0156  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0157  3        HC Class Code
     C                     MOVEL*BLANK    WN0158 10        RS User Changed
     C                     Z-ADD*ZERO     WN0159  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0160  60       RS Time Changed
     C                     MOVEL*BLANK    WN0161  1        RS Record Statu
     C                     MOVEL*BLANK    WN0162 10        RS Job
     C                     MOVEL*BLANK    WN0163 10        RS Program
     C                     MOVEL*BLANK    WN0164 10        RS User Added
     C                     Z-ADD*ZERO     WN0165  70       RS Date Added
     C                     Z-ADD*ZERO     WN0166  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWEHMNB    WGHMNB           BOH Company Num
     C                     Z-ADDWEBNNB    WGBNNB           BOH Buy Order N
     C                     Z-ADDWEBONB    WGBONB           BOL Load Number
     C                     Z-ADDWECVNB    WGCVNB           TH Tattoo Numbe
     C                     Z-ADDWEB0DT    WGB0DT           TH Kill Date
      *
     C           KLCHSG    KLIST
     C                     KFLD           WGHMNB           BOH Company Num
     C                     KFLD           WGBNNB           BOH Buy Order N
     C                     KFLD           WGBONB           BOL Load Number
     C                     KFLD           WGCVNB           TH Tattoo Numbe
     C                     KFLD           WGB0DT           TH Kill Date
     C           KLCHSG    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YBRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWN0001    WGFDNB           TH Head Condemn
     C                     MOVEL'E'       WGDWST    P      TH Kill Balanci
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * Upd Head Condemned    RT - Tattoo Detail  * 
     C                     EXSR SHRVGN
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Upd Head Condemned    RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQSH01           BOH Company Num
     C           *LIKE     DEFN WHBNNB    WQSH02           BOH Buy Order N
     C           *LIKE     DEFN WHBONB    WQSH03           BOL Load Number
     C           *LIKE     DEFN WHCVNB    WQSH04           TH Tattoo Numbe
     C           *LIKE     DEFN WHB0DT    WQSH05           TH Kill Date
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           BOH Company Num
     C                     KFLD           WQSH02           BOH Buy Order N
     C                     KFLD           WQSH03           BOL Load Number
     C                     KFLD           WQSH04           TH Tattoo Numbe
     C                     KFLD           WQSH05           TH Kill Date
      * Setup key
     C                     Z-ADDWGHMNB    WQSH01           BOH Company Num
     C                     Z-ADDWGBNNB    WQSH02           BOH Buy Order N
     C                     Z-ADDWGBONB    WQSH03           BOL Load Number
     C                     Z-ADDWGCVNB    WQSH04           TH Tattoo Numbe
     C                     Z-ADDWGB0DT    WQSH05           TH Kill Date
      * Establish starting position
     C           KRSSH     SETLL@A2CPDG                    *
     C           KRSSH     READE@A2CPDG                  90*
      * Data record not found
     C   90                MOVEL'PRK0063' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WHC0NB    SUB  WHD8NB    YL0001           Net Head Usr
      * Rtv Stress Pens Only  XF - Pen Ext  * 
     C                     CALL 'PLPJXFR'              90  Rtv Stress Pens
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WHHVNB    WQ0008  30       Pen Company Num
     C                     PARM WHCMCD    WQ0009  3        Pen Number
     C           YL0002    PARM YL0002    WQ0010  1        Stress/Market T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLPJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Stress pen is now defined at the pen ext instead of ST1
      * CASE: LCL.Stress/Market Type is Stress
     C           YL0002    IFEQ 'S'                        *IF
     C                     ELSE
      * CASE: LCL.Net Head Usr is *Zeros
     C           YL0001    IFEQ 0                          *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Upd Head Condemned    RT - Tattoo Detail Ext  * 
     C                     EXSR SIRVGN
     C                     GOTO SHEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSH     READE@A2CPDG                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Upd Head Condemned    RT - Tattoo Detail Ext  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0167  1        Completed Statu
     C                     Z-ADD*ZERO     WN0168  50       Hot Head
     C                     Z-ADD*ZERO     WN0169  50       Head 2
     C                     MOVEL*BLANK    WN0170  1        Status 1
     C                     MOVEL*BLANK    WN0171  1        Status 2
     C                     MOVEL*BLANK    WN0172 10        RS User Changed
     C                     Z-ADD*ZERO     WN0173  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0174  60       RS Time Changed
     C                     MOVEL*BLANK    WN0175  1        RS Record Statu
     C                     MOVEL*BLANK    WN0176 10        RS Job
     C                     MOVEL*BLANK    WN0177 10        RS Program
     C                     MOVEL*BLANK    WN0178 10        RS User Added
     C                     Z-ADD*ZERO     WN0179  70       RS Date Added
     C                     Z-ADD*ZERO     WN0180  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
     C                     KFLD           WIC2NB           TD Sequence Num
      * Setup key
     C                     Z-ADDWHHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWHBNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWHBONB    WIBONB           BOL Load Number
     C                     Z-ADDWHCVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWHB0DT    WIB0DT           TH Kill Date
     C                     Z-ADDWHC2NB    WIC2NB           TD Sequence Num
      * Establish starting position
     C           KRSSI     CHAIN@DYCPXX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0733' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Tattoo Detail Ext  CR - Tattoo Detail Ext  * 
     C                     EXSR SJCRRC
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Head Condemned    CH - Tattoo Detail Ext  * 
     C                     EXSR SKCHRC
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCRRC    BEGSR
      *================================================================
      * Crt Tattoo Detail Ext  CR - Tattoo Detail Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DYCPXW
     C                     Z-ADDWHHMNB    WJHMNB           BOH Company Num
     C                     Z-ADDWHBNNB    WJBNNB           BOH Buy Order N
     C                     Z-ADDWHBONB    WJBONB           BOL Load Number
     C                     Z-ADDWHCVNB    WJCVNB           TH Tattoo Numbe
     C                     Z-ADDWHB0DT    WJB0DT           TH Kill Date
     C                     Z-ADDWHC2NB    WJC2NB           TD Sequence Num
     C                     MOVEL'N'       WJP3ST           Completed Statu
     C                     Z-ADD*ZERO     WJLENB           Hot Head
     C                     Z-ADDWGFDNB    WJLFNB           TDE Head Condem
     C                     Z-ADD*ZERO     WJLINB           Head 2
     C                     MOVEL'N'       WJP4ST           Status 1
     C                     MOVEL'N'       WJP5ST           Status 2
     C                     MOVELWN0172    WJAAVN           RS User Changed
     C                     Z-ADDWN0173    WJAADT           RS Date Changed
     C                     Z-ADDWN0174    WJAMTM           RS Time Changed
     C                     MOVELWN0175    WJAJST           RS Record Statu
     C                     MOVELWN0176    WJAHVN           RS Job
     C                     MOVELWN0177    WJAGVN           RS Program
     C                     MOVELWN0178    WJABVN           RS User Added
     C                     Z-ADDWN0179    WJABDT           RS Date Added
     C                     Z-ADDWN0180    WJABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WJAJST           RS Record Statu
     C                     MOVEL##USR     WJABVN           RS User Added
     C                     Z-ADD##JDT     WJABDT           RS Date Added
     C                     Z-ADD##JTM     WJABTM           RS Time Added
     C                     MOVEL##PGM     WJAGVN           RS Program
     C                     MOVEL##JOB     WJAHVN           RS Job
     C           KLCRSJ    KLIST
     C                     KFLD           WJHMNB           BOH Company Num
     C                     KFLD           WJBNNB           BOH Buy Order N
     C                     KFLD           WJBONB           BOL Load Number
     C                     KFLD           WJCVNB           TH Tattoo Numbe
     C                     KFLD           WJB0DT           TH Kill Date
     C                     KFLD           WJC2NB           TD Sequence Num
      * Check for duplicate primary key
     C           KLCRSJ    SETLL@DYCPXW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0734' W0RTN   7
      * Send message 'Tattoo Detail Ext      EX'
     C                     MOVEL'PRK0734' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C                     WRITE@DYCPXW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCHRC    BEGSR
      *================================================================
      * Chg Head Condemned    CH - Tattoo Detail Ext  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0181  1        Completed Statu
     C                     Z-ADD*ZERO     WN0182  50       Hot Head
     C                     Z-ADD*ZERO     WN0183  50       Head 2
     C                     MOVEL*BLANK    WN0184  1        Status 1
     C                     MOVEL*BLANK    WN0185  1        Status 2
     C                     MOVEL*BLANK    WN0186 10        RS User Changed
     C                     Z-ADD*ZERO     WN0187  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0188  60       RS Time Changed
     C                     MOVEL*BLANK    WN0189  1        RS Record Statu
     C                     MOVEL*BLANK    WN0190 10        RS Job
     C                     MOVEL*BLANK    WN0191 10        RS Program
     C                     MOVEL*BLANK    WN0192 10        RS User Added
     C                     Z-ADD*ZERO     WN0193  70       RS Date Added
     C                     Z-ADD*ZERO     WN0194  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @DYCPXW
     C                     Z-ADDWIHMNB    WJHMNB           BOH Company Num
     C                     Z-ADDWIBNNB    WJBNNB           BOH Buy Order N
     C                     Z-ADDWIBONB    WJBONB           BOL Load Number
     C                     Z-ADDWICVNB    WJCVNB           TH Tattoo Numbe
     C                     Z-ADDWIB0DT    WJB0DT           TH Kill Date
     C                     Z-ADDWIC2NB    WJC2NB           TD Sequence Num
      *
     C           KLCHSK    KLIST
     C                     KFLD           WJHMNB           BOH Company Num
     C                     KFLD           WJBNNB           BOH Buy Order N
     C                     KFLD           WJBONB           BOL Load Number
     C                     KFLD           WJCVNB           TH Tattoo Numbe
     C                     KFLD           WJB0DT           TH Kill Date
     C                     KFLD           WJC2NB           TD Sequence Num
     C           KLCHSK    CHAIN@DYCPXW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDYCPL0'MDACP
     C                     MOVEL'@DYCPXW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDY1    YCRDCS
      * Move non-key fields to @DYCPXW
     C                     Z-ADDWGFDNB    WJLFNB           TDE Head Condem
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDY1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@DYCPXW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDYCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Bal/Kill Inform    RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKHMNB    WQSL01           BOH Company Num
     C           *LIKE     DEFN WKBNNB    WQSL02           BOH Buy Order N
     C           *LIKE     DEFN WKBONB    WQSL03           BOL Load Number
     C           *LIKE     DEFN WKCVNB    WQSL04           TH Tattoo Numbe
     C           *LIKE     DEFN WKB0DT    WQSL05           TH Kill Date
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           BOH Company Num
     C                     KFLD           WQSL02           BOH Buy Order N
     C                     KFLD           WQSL03           BOL Load Number
     C                     KFLD           WQSL04           TH Tattoo Numbe
     C                     KFLD           WQSL05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQSL01           BOH Company Num
     C                     Z-ADDP1BNNB    WQSL02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQSL03           BOL Load Number
     C                     Z-ADDP1CVNB    WQSL04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQSL05           TH Kill Date
      * Establish starting position
     C           KRSSL     SETLL@BVCPG8                    *
     C           KRSSL     READE@BVCPG8                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0121' W0RTN   7
      * USER: Processing if Data record not found
      * CASE: PAR.Net Head Usr is *Zeros
     C           WUF6NB    IFEQ 0                          *IF
      * Net head is zeros if there are no transaction then this is ok
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'K'       WUD7ST           TH Header Error
     C                     MOVEL'E'       WUDWST           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR SMCRRC
     C                     END                             *FI
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'B'       WUD2ST           ET Error Sts
     C                     Z-ADDWKAKPC    WUAKPC           ET Lean Percent
     C                     Z-ADDWKFXPC    WUFXPC           ET Lean Percent
     C                     Z-ADDWKX8NB    WUX8NB           ET Backfat Thic
     C                     Z-ADDWKFVPC    WUFVPC           ET Loineye Dept
     C                     Z-ADDWKFWPC    WUFWPC           ET Light Reflec
      * LEAN % FOM
     C                     MOVEL'N'       WUM0ST           Calculate All U
      * Clc Inch to MM/Lean%FOM - Carcass Detail  * 
     C                     CALL 'PKINMMLP'             90  Clc Inch to MM/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0011  31       CD Lean Percent
     C                     PARM WKAIPC    WQ0012  31       CD Backfat Thic
     C                     PARM WKAJPC    WQ0013  31       CD Loin-Eye Dep
     C                     PARM WKALPC    WQ0014  31       CD Light Reflec
     C           WUX8NB    PARM WUX8NB    WQ0015  31       CD Backfat Thic
     C           WUFVPC    PARM WUFVPC    WQ0016  31       CD Loin-Eye Dep
     C           WUFWPC    PARM WUFWPC    WQ0017  31       CD Light Reflec
     C           WUFXPC    PARM WUFXPC    WQ0018  31       CD Lean Percent
     C           WUM0ST    PARM WUM0ST    WQ0019  1        Calculate All U
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKINMMLP'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: DB1.ET Record Add/Del Sts is Add Rec and Create Record
     C           WKEHST    IFEQ 'A'                        *IF
     C           WKEHST    OREQ *BLANK
     C           WKEHST    OREQ 'O'
      * COMPUTE LEAN % Morrison Hot Scale
     C                     EXSR UESUBR                     COMPUTE LEAN %
      * VALIDATE RECORD
      * CASE: DB1.ET User Error Override is Yes
     C           WKJLST    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Validate, unless user override error
      * Validate transaction for min max rules
     C                     EXSR UFSUBR                     Validate transa
     C                     END                             *FI
      * CASE: WRK.ET Error Sts is Balance
     C           WUD2ST    IFEQ 'B'                        *IF
     C                     ADD  1         WUHFNB           TH Head Accepte
      * Accumulate Add record
      * CASE: DB1.ET Record Add/Del Sts is Add
     C           WKEHST    IFEQ 'A'                        *IF
     C                     ADD  1         WUHENB           TH Head Adds
     C                     END                             *FI
      * Special Note:  Accumulate totals
      * Accumulate Totals
     C                     EXSR UGSUBR                     Accumulate Tota
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUHFNB           TH Head Accepte
      * Accumulate Delete record
      * CASE: DB1.ET Record Add/Del Sts is Delete
     C           WKEHST    IFEQ 'D'                        *IF
     C                     ADD  1         WUJ9NB           TH Head Exclude
     C                     END                             *FI
     C                     END                             *FI
      * Chg Eval Transac      CH - Eval Trans  * 
     C                     EXSR TECHRC
     C           KRSSL     READE@BVCPG8                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVEL'HNE'     WBDXST           KV Error Code
     C                     MOVEL@CN,001   WBB7TX           KV Error Descri
     C                     MOVEL@CN,002   WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##JOB     WBAHVN           RS Job
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           @CN,001   IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR SNRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRSM    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRSM    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WLBVCD           EV Validation C
      * Setup key
     C                     MOVEL'HNE'     WLBVCD           EV Validation C
      * Establish starting position
     C           KRSSN     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWLCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWKHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWKA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWKFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWKBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWKBONB    WBLDNM           KV Load Number
     C                     Z-ADDWKFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELWUDXST    WBDXST           KV Error Code
     C                     MOVELWUB7TX    WBB7TX           KV Error Descri
     C                     MOVELWKAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWKAADT    WBAADT           RS Date Changed
     C                     Z-ADDWKAMTM    WBAMTM           RS Time Changed
     C                     MOVELWKAJST    WBAJST           RS Record Statu
     C                     MOVELWKAHVN    WBAHVN           RS Job
     C                     MOVELWKAGVN    WBAGVN           RS Program
     C                     MOVELWKABVN    WBABVN           RS User Added
     C                     Z-ADDWKABDT    WBABDT           RS Date Added
     C                     Z-ADDWKABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           WUB7TX    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR SPRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRSO    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRSO    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WLBVCD           EV Validation C
      * Setup key
     C                     MOVELWUDXST    WLBVCD           EV Validation C
      * Establish starting position
     C           KRSSP     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWLCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWKHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWKA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWKFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWKBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWKBONB    WBLDNM           KV Load Number
     C                     Z-ADDWKFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELWUDXST    WBDXST           KV Error Code
     C                     MOVELWUB7TX    WBB7TX           KV Error Descri
     C                     MOVELWKAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWKAADT    WBAADT           RS Date Changed
     C                     Z-ADDWKAMTM    WBAMTM           RS Time Changed
     C                     MOVELWKAJST    WBAJST           RS Record Statu
     C                     MOVELWKAHVN    WBAHVN           RS Job
     C                     MOVELWKAGVN    WBAGVN           RS Program
     C                     MOVELWKABVN    WBABVN           RS User Added
     C                     Z-ADDWKABDT    WBABDT           RS Date Added
     C                     Z-ADDWKABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           WUB7TX    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR SRRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRSQ    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRSQ    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WLBVCD           EV Validation C
      * Setup key
     C                     MOVELWUDXST    WLBVCD           EV Validation C
      * Establish starting position
     C           KRSSR     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWLCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWKHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWKA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWKFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWKBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWKBONB    WBLDNM           KV Load Number
     C                     Z-ADDWKFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELWUDXST    WBDXST           KV Error Code
     C                     MOVELWUB7TX    WBB7TX           KV Error Descri
     C                     MOVELWKAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWKAADT    WBAADT           RS Date Changed
     C                     Z-ADDWKAMTM    WBAMTM           RS Time Changed
     C                     MOVELWKAJST    WBAJST           RS Record Statu
     C                     MOVELWKAHVN    WBAHVN           RS Job
     C                     MOVELWKAGVN    WBAGVN           RS Program
     C                     MOVELWKABVN    WBABVN           RS User Added
     C                     Z-ADDWKABDT    WBABDT           RS Date Added
     C                     Z-ADDWKABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           WUB7TX    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR STRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRSS    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRSS    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WLBVCD           EV Validation C
      * Setup key
     C                     MOVELWUDXST    WLBVCD           EV Validation C
      * Establish starting position
     C           KRSST     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWLCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWKHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWKA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWKFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWKBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWKBONB    WBLDNM           KV Load Number
     C                     Z-ADDWKFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELWUDXST    WBDXST           KV Error Code
     C                     MOVELWUB7TX    WBB7TX           KV Error Descri
     C                     MOVELWKAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWKAADT    WBAADT           RS Date Changed
     C                     Z-ADDWKAMTM    WBAMTM           RS Time Changed
     C                     MOVELWKAJST    WBAJST           RS Record Statu
     C                     MOVELWKAHVN    WBAHVN           RS Job
     C                     MOVELWKAGVN    WBAGVN           RS Program
     C                     MOVELWKABVN    WBABVN           RS User Added
     C                     Z-ADDWKABDT    WBABDT           RS Date Added
     C                     Z-ADDWKABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           WUB7TX    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR SVRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRSU    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRSU    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WLBVCD           EV Validation C
      * Setup key
     C                     MOVELWUDXST    WLBVCD           EV Validation C
      * Establish starting position
     C           KRSSV     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWLCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWKHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWKA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWKFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWKBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWKBONB    WBLDNM           KV Load Number
     C                     Z-ADDWKFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELWUDXST    WBDXST           KV Error Code
     C                     MOVELWUB7TX    WBB7TX           KV Error Descri
     C                     MOVELWKAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWKAADT    WBAADT           RS Date Changed
     C                     Z-ADDWKAMTM    WBAMTM           RS Time Changed
     C                     MOVELWKAJST    WBAJST           RS Record Statu
     C                     MOVELWKAHVN    WBAHVN           RS Job
     C                     MOVELWKAGVN    WBAGVN           RS Program
     C                     MOVELWKABVN    WBABVN           RS User Added
     C                     Z-ADDWKABDT    WBABDT           RS Date Added
     C                     Z-ADDWKABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           WUB7TX    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR SXRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRSW    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRSW    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WLBVCD           EV Validation C
      * Setup key
     C                     MOVELWUDXST    WLBVCD           EV Validation C
      * Establish starting position
     C           KRSSX     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWLCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWKHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWKA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWKFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWKBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWKBONB    WBLDNM           KV Load Number
     C                     Z-ADDWKFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELWUDXST    WBDXST           KV Error Code
     C                     MOVELWUB7TX    WBB7TX           KV Error Descri
     C                     MOVELWKAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWKAADT    WBAADT           RS Date Changed
     C                     Z-ADDWKAMTM    WBAMTM           RS Time Changed
     C                     MOVELWKAJST    WBAJST           RS Record Statu
     C                     MOVELWKAHVN    WBAHVN           RS Job
     C                     MOVELWKAGVN    WBAGVN           RS Program
     C                     MOVELWKABVN    WBABVN           RS User Added
     C                     Z-ADDWKABDT    WBABDT           RS Date Added
     C                     Z-ADDWKABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           WUB7TX    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR SZRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRSY    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRSY    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WLBVCD           EV Validation C
      * Setup key
     C                     MOVELWUDXST    WLBVCD           EV Validation C
      * Establish starting position
     C           KRSSZ     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWLCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TACRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWKHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWKA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWKFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWKBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWKBONB    WBLDNM           KV Load Number
     C                     Z-ADDWKFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELWUDXST    WBDXST           KV Error Code
     C                     MOVELWUB7TX    WBB7TX           KV Error Descri
     C                     MOVELWKAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWKAADT    WBAADT           RS Date Changed
     C                     Z-ADDWKAMTM    WBAMTM           RS Time Changed
     C                     MOVELWKAJST    WBAJST           RS Record Statu
     C                     MOVELWKAHVN    WBAHVN           RS Job
     C                     MOVELWKAGVN    WBAGVN           RS Program
     C                     MOVELWKABVN    WBABVN           RS User Added
     C                     Z-ADDWKABDT    WBABDT           RS Date Added
     C                     Z-ADDWKABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           WUB7TX    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR TBRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRTA    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRTA    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WLBVCD           EV Validation C
      * Setup key
     C                     MOVELWUDXST    WLBVCD           EV Validation C
      * Establish starting position
     C           KRSTB     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWLCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDWKHSNB    WBHRNB           KV Company Numb
     C                     Z-ADDWKA9DT    WBBPDT           KV Kill Date
     C                     Z-ADDWKFINB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWKBNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDWKBONB    WBLDNM           KV Load Number
     C                     Z-ADDWKFJNB    WBFPNB           KV Record Numbe
     C                     MOVEL'E'       WBDYST           KV Record Type
     C                     MOVELWUDXST    WBDXST           KV Error Code
     C                     MOVELWUB7TX    WBB7TX           KV Error Descri
     C                     MOVELWKAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWKAADT    WBAADT           RS Date Changed
     C                     Z-ADDWKAMTM    WBAMTM           RS Time Changed
     C                     MOVELWKAJST    WBAJST           RS Record Statu
     C                     MOVELWKAHVN    WBAHVN           RS Job
     C                     MOVELWKAGVN    WBAGVN           RS Program
     C                     MOVELWKABVN    WBABVN           RS User Added
     C                     Z-ADDWKABDT    WBABDT           RS Date Added
     C                     Z-ADDWKABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           WUB7TX    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR TDRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRTC    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRTC    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WLBVCD           EV Validation C
      * Setup key
     C                     MOVELWUDXST    WLBVCD           EV Validation C
      * Establish starting position
     C           KRSTD     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWLCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TECHRC    BEGSR
      *================================================================
      * Chg Eval Transac      CH - Eval Trans  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0195  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0196  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0197  3        ET Unused Sts 5
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @BVCPF0
     C                     Z-ADDWKHSNB    WMHSNB           ET Company Numb
     C                     Z-ADDWKA9DT    WMA9DT           ET Kill Date
     C                     Z-ADDWKFJNB    WMFJNB           ET Scale Sequen
     C                     Z-ADDWKHCNB    WMHCNB           ET Carcass Numb
     C                     Z-ADDWKGDNB    WMGDNB           ET Carcass Numb
      *
     C           KLCHTE    KLIST
     C                     KFLD           WMHSNB           ET Company Numb
     C                     KFLD           WMA9DT           ET Kill Date
     C                     KFLD           WMFJNB           ET Scale Sequen
     C                     KFLD           WMHCNB           ET Carcass Numb
     C                     KFLD           WMGDNB           ET Carcass Numb
     C           KLCHTE    CHAIN@BVCPF0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBV1    YDRDCS
      * Move non-key fields to @BVCPF0
     C                     Z-ADDWKFINB    WMFINB           ET Tattoo Numbe
     C                     Z-ADDWKLKNB    WMLKNB           ET Lot
     C                     MOVELWKEAST    WMEAST    P      ET Shift
     C                     Z-ADDWKAMPC    WMAMPC           ET Hot Wgt
     C                     Z-ADDWKAIPC    WMAIPC           ET Backfat Thic
     C                     Z-ADDWKAJPC    WMAJPC           ET Loin-Eye Dep
     C                     Z-ADDWUAKPC    WMAKPC           ET Lean Percent
     C                     Z-ADDWUX8NB    WMX8NB           ET Backfat Thic
     C                     Z-ADDWUFVPC    WMFVPC           ET Loineye Dept
     C                     Z-ADDWUFWPC    WMFWPC           ET Light Reflec
     C                     Z-ADDWUFXPC    WMFXPC           ET Lean Percent
     C                     Z-ADDWKALPC    WMALPC           ET Light Reflec
     C                     MOVELWKDIST    WMDIST    P      ET Trim Area
     C                     MOVELWKFYST    WMFYST    P      ET Carcass Sex
     C                     MOVELWUD2ST    WMD2ST    P      ET Error Sts
     C                     MOVELWKEHST    WMEHST    P      ET Record Add/D
     C                     MOVELWKG1ST    WMG1ST    P      ET Record Creat
     C                     MOVELWKH4ST    WMH4ST    P      ET Record Creat
     C                     MOVELWKJLST    WMJLST    P      ET User Error O
     C                     MOVELWKUUST    WMUUST    P      ET Adjust/Add T
     C                     MOVELWKVHST    WMVHST    P      ET Broken Back
     C                     MOVELWKVJST    WMVJST    P      ET Adjust/Add S
     C                     Z-ADDWKHMNB    WMHMNB           BOH Company Num
     C                     Z-ADDWKBNNB    WMBNNB           BOH Buy Order N
     C                     Z-ADDWKBONB    WMBONB           BOL Load Number
     C                     Z-ADDWKCVNB    WMCVNB           TH Tattoo Numbe
     C                     Z-ADDWKB0DT    WMB0DT           TH Kill Date
     C                     MOVELWKAAVN    WMAAVN    P      RS User Changed
     C                     Z-ADDWKAADT    WMAADT           RS Date Changed
     C                     Z-ADDWKAMTM    WMAMTM           RS Time Changed
     C                     MOVELWKAJST    WMAJST    P      RS Record Statu
     C                     MOVELWKAHVN    WMAHVN    P      RS Job
     C                     MOVELWKAGVN    WMAGVN    P      RS Program
     C                     MOVELWKABVN    WMABVN    P      RS User Added
     C                     Z-ADDWKABDT    WMABDT           RS Date Added
     C                     Z-ADDWKABTM    WMABTM           RS Time Added
     C                     Z-ADDWKB8DT    WMB8DT           RU Date
     C                     Z-ADDWKAOTM    WMAOTM           RU Time
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WMAAVN           RS User Changed
     C                     Z-ADD##JDT     WMAADT           RS Date Changed
     C                     Z-ADD##JTM     WMAMTM           RS Time Changed
     C                     MOVEL##JOB     WMAHVN           RS Job
     C                     MOVEL##PGM     WMAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKBV1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@BVCPF0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBVCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVELWUDXST    WBDXST           KV Error Code
     C                     MOVELWUB7TX    WBB7TX           KV Error Descri
     C                     MOVELWUAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWUAADT    WBAADT           RS Date Changed
     C                     Z-ADDWUAMTM    WBAMTM           RS Time Changed
     C                     MOVELWUAJST    WBAJST           RS Record Statu
     C                     MOVELWUAHVN    WBAHVN           RS Job
     C                     MOVELWUAGVN    WBAGVN           RS Program
     C                     MOVELWUABVN    WBABVN           RS User Added
     C                     Z-ADDWUABDT    WBABDT           RS Date Added
     C                     Z-ADDWUABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           WUB7TX    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR TGRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRTF    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRTF    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WLBVCD           EV Validation C
      * Setup key
     C                     MOVELWUDXST    WLBVCD           EV Validation C
      * Establish starting position
     C           KRSTG     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWLCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVELWUDXST    WBDXST           KV Error Code
     C                     MOVELWUB7TX    WBB7TX           KV Error Descri
     C                     MOVELWUAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWUAADT    WBAADT           RS Date Changed
     C                     Z-ADDWUAMTM    WBAMTM           RS Time Changed
     C                     MOVELWUAJST    WBAJST           RS Record Statu
     C                     MOVELWUAHVN    WBAHVN           RS Job
     C                     MOVELWUAGVN    WBAGVN           RS Program
     C                     MOVELWUABVN    WBABVN           RS User Added
     C                     Z-ADDWUABDT    WBABDT           RS Date Added
     C                     Z-ADDWUABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           WUB7TX    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR TIRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRTH    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRTH    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           WLBVCD           EV Validation C
      * Setup key
     C                     MOVELWUDXST    WLBVCD           EV Validation C
      * Establish starting position
     C           KRSTI     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWLCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVELWUDXST    WBDXST           KV Error Code
     C                     MOVELWUB7TX    WBB7TX           KV Error Descri
     C                     MOVELWUAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWUAADT    WBAADT           RS Date Changed
     C                     Z-ADDWUAMTM    WBAMTM           RS Time Changed
     C                     MOVELWUAJST    WBAJST           RS Record Statu
     C                     MOVELWUAHVN    WBAHVN           RS Job
     C                     MOVELWUAGVN    WBAGVN           RS Program
     C                     MOVELWUABVN    WBABVN           RS User Added
     C                     Z-ADDWUABDT    WBABDT           RS Date Added
     C                     Z-ADDWUABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           WUB7TX    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR TKRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRTJ    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRTJ    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           WLBVCD           EV Validation C
      * Setup key
     C                     MOVELWUDXST    WLBVCD           EV Validation C
      * Establish starting position
     C           KRSTK     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWLCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HMNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1B0DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1CVNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADD999999    WBFPNB           KV Record Numbe
     C                     MOVEL'H'       WBDYST           KV Record Type
     C                     MOVELWUDXST    WBDXST           KV Error Code
     C                     MOVELWUB7TX    WBB7TX           KV Error Descri
     C                     MOVELWUAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWUAADT    WBAADT           RS Date Changed
     C                     Z-ADDWUAMTM    WBAMTM           RS Time Changed
     C                     MOVELWUAJST    WBAJST           RS Record Statu
     C                     MOVELWUAHVN    WBAHVN           RS Job
     C                     MOVELWUAGVN    WBAGVN           RS Program
     C                     MOVELWUABVN    WBABVN           RS User Added
     C                     Z-ADDWUABDT    WBABDT           RS Date Added
     C                     Z-ADDWUABTM    WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           WUB7TX    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR TMRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRTL    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRTL    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           WLBVCD           EV Validation C
      * Setup key
     C                     MOVELWUDXST    WLBVCD           EV Validation C
      * Establish starting position
     C           KRSTM     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWLCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNCHRC    BEGSR
      *================================================================
      * Chg Val Kill Trans    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0198  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0199 10        TH Group Refere
     C                     MOVEL*BLANK    WN0200  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0201  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0202  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0203  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0204  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0205  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0206  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0207  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0208  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0209  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0210  50       TH Held Over
     C                     Z-ADD*ZERO     WN0211  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0212  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0213  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0214  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0215  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0216  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0217  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0218  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0219  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0220  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0221  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0222  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0223  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0224  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0225  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0226  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0227  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0228  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0229  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0230  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0231  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0232  72       TH Accrual Amou
     C                     MOVEL*BLANK    WN0233  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0234  2        TH Payment Sts
     C                     Z-ADD*ZERO     WN0235  80       TH Commission A
     C                     Z-ADD*ZERO     WN0236  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0237  1        TH User Error O
     C                     MOVEL*BLANK    WN0238  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0239  1        TH Sex
     C                     Z-ADD*ZERO     WN0240  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0241  70       TH Commission P
     C                     Z-ADD*ZERO     WN0242  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0243  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0244  31       TH FFLI
     C                     Z-ADD*ZERO     WN0245  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0246  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0247  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0248  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0249  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0250  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0251  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0252  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0253  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0254  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0255  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0256  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0257  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0258  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0259  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0260  1        TH Source Type
     C                     MOVEL*BLANK    WN0261  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0262  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0263  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0264  3        TH Source Code
     C                     MOVEL*BLANK    WN0265  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0266  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0267  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0268  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0269  3        TH State
     C                     MOVEL*BLANK    WN0270  3        TH Unused Code
     C                     MOVEL*BLANK    WN0271  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0272  1        TH Commission S
     C                     MOVEL*BLANK    WN0273  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0274  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0275  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0276  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0277  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0278  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0279  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0280  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0281  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0282  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0283  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0284  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0285  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0286  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0287  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0288  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0289 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0290 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0291 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0292 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0293  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0294  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0295  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0296  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0297  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0298  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0299  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0300  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0301  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0302  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0303  70       TH Unused Date
     C                     MOVEL*BLANK    WN0304  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0305  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0306  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0307  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0308  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0309  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0310  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0311  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0312  6        DF Defect Code
     C                     MOVEL*BLANK    WN0313  6        THP Process Cod
     C                     MOVEL*BLANK    WN0314  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0315  6        PL Location Cod
     C                     MOVEL*BLANK    WN0316  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0317  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0318  3        HC Class Code
     C                     MOVEL*BLANK    WN0319 10        RS User Changed
     C                     Z-ADD*ZERO     WN0320  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0321  60       RS Time Changed
     C                     MOVEL*BLANK    WN0322  1        RS Record Statu
     C                     MOVEL*BLANK    WN0323 10        RS Job
     C                     MOVEL*BLANK    WN0324 10        RS Program
     C                     MOVEL*BLANK    WN0325 10        RS User Added
     C                     Z-ADD*ZERO     WN0326  70       RS Date Added
     C                     Z-ADD*ZERO     WN0327  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDP1HMNB    WGHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WGBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WGBONB           BOL Load Number
     C                     Z-ADDP1CVNB    WGCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WGB0DT           TH Kill Date
      *
     C           KLCHTN    KLIST
     C                     KFLD           WGHMNB           BOH Company Num
     C                     KFLD           WGBNNB           BOH Buy Order N
     C                     KFLD           WGBONB           BOL Load Number
     C                     KFLD           WGCVNB           TH Tattoo Numbe
     C                     KFLD           WGB0DT           TH Kill Date
     C           KLCHTN    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YERDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDP1AIPR    WGAIPR           TH Recalc Live
     C                     Z-ADDWUFDNB    WGFDNB           TH Head Condemn
     C                     Z-ADDWUFENB    WGFENB           TH Head Killed
     C                     Z-ADDWUHENB    WGHENB           TH Head Adds
     C                     Z-ADDWUHFNB    WGHFNB           TH Head Accepte
     C                     Z-ADDWULRNB    WGLRNB           TH Adj Live Wgt
     C                     Z-ADDWUE0NB    WGE0NB           TH Hot Wgt
     C                     Z-ADDWUA5PC    WGA5PC           TH Tot Loin Eye
     C                     Z-ADDWUFBNB    WGFBNB           TH Tot Backfat
     C                     Z-ADDWUA4PC    WGA4PC           TH Tot Light Re
     C                     Z-ADDWUHDNB    WGHDNB           TH Avg Hot Wgt
     C                     Z-ADDWUF5NB    WGF5NB           TH Avg Light Re
     C                     Z-ADDWUF4NB    WGF4NB           TH Avg Lean Per
     C                     Z-ADDWUF3NB    WGF3NB           TH Avg Loin Eye
     C                     Z-ADDWUF2NB    WGF2NB           TH Avg Backfat
     C                     Z-ADDWUAWPC    WGAWPC           TH Actual Yield
     C                     Z-ADDWUCWPC    WGCWPC           TH Adj Actual Y
     C                     Z-ADDWUA2PR    WGA2PR           TH Fixed Cost A
     C                     MOVELWUD7ST    WGD7ST    P      TH Header Error
     C                     MOVELWUD8ST    WGD8ST    P      TH Detail Error
     C                     MOVELWUDWST    WGDWST    P      TH Kill Balanci
     C                     MOVELWUD6ST    WGD6ST    P      TH Bal to Kill
     C                     Z-ADD*ZERO     WGHHNB           TH Avg Hot Wgt
     C                     Z-ADDWUJ9NB    WGJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WGT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WGKOER           TH Head Identif
     C                     Z-ADD*ZERO     WGOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WGOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WGIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WGOWEO           TH PHA Head Add
     C                     MOVELYL0003    WGOQET    P      TH PHA Add Type
     C                     MOVELYL0004    WGURST    P      TH PHA Average
     C                     MOVELYL0005    WGUSST    P      TH PHA Add Reas
     C                     Z-ADD*ZERO     WGHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WGS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WGORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WGOMVJ           TH PHA Sort Dis
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WGAAVN           RS User Changed
     C                     Z-ADD##JDT     WGAADT           RS Date Changed
     C                     Z-ADD##JTM     WGAMTM           RS Time Changed
     C                     MOVEL##JOB     WGAHVN           RS Job
     C                     MOVEL##PGM     WGAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * RtvChg Td Cmpl Sts     RT - Tattoo Detail Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIHMNB    WQTO01           BOH Company Num
     C           *LIKE     DEFN WIBNNB    WQTO02           BOH Buy Order N
     C           *LIKE     DEFN WIBONB    WQTO03           BOL Load Number
     C           *LIKE     DEFN WICVNB    WQTO04           TH Tattoo Numbe
     C           *LIKE     DEFN WIB0DT    WQTO05           TH Kill Date
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           WQTO01           BOH Company Num
     C                     KFLD           WQTO02           BOH Buy Order N
     C                     KFLD           WQTO03           BOL Load Number
     C                     KFLD           WQTO04           TH Tattoo Numbe
     C                     KFLD           WQTO05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQTO01           BOH Company Num
     C                     Z-ADDP1BNNB    WQTO02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQTO03           BOL Load Number
     C                     Z-ADDP1CVNB    WQTO04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQTO05           TH Kill Date
      * Establish starting position
     C           KRSTO     SETLL@DYCPXX                    *
     C           KRSTO     READE@DYCPXX                  90*
      * Data record not found
     C   90                MOVEL'PRK0733' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Tattoo Detail Ext  CH - Tattoo Detail Ext  * 
     C                     EXSR TPCHRC
     C           KRSTO     READE@DYCPXX                  90*
     C                     ENDDO
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPCHRC    BEGSR
      *================================================================
      * Chg Tattoo Detail Ext  CH - Tattoo Detail Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @DYCPXW
     C                     Z-ADDWIHMNB    WJHMNB           BOH Company Num
     C                     Z-ADDWIBNNB    WJBNNB           BOH Buy Order N
     C                     Z-ADDWIBONB    WJBONB           BOL Load Number
     C                     Z-ADDWICVNB    WJCVNB           TH Tattoo Numbe
     C                     Z-ADDWIB0DT    WJB0DT           TH Kill Date
     C                     Z-ADDWIC2NB    WJC2NB           TD Sequence Num
      *
     C           KLCHTP    KLIST
     C                     KFLD           WJHMNB           BOH Company Num
     C                     KFLD           WJBNNB           BOH Buy Order N
     C                     KFLD           WJBONB           BOL Load Number
     C                     KFLD           WJCVNB           TH Tattoo Numbe
     C                     KFLD           WJB0DT           TH Kill Date
     C                     KFLD           WJC2NB           TD Sequence Num
     C           KLCHTP    CHAIN@DYCPXW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDYCPL0'MDACP
     C                     MOVEL'@DYCPXW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDY1    YFRDCS
      * USER: Processing after Data read
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WJAAVN           RS User Changed
     C                     Z-ADD##JDT     WJAADT           RS Date Changed
     C                     Z-ADD##JTM     WJAMTM           RS Time Changed
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Move non-key fields to @DYCPXW
     C                     MOVEL'Y'       WJP3ST    P      Completed Statu
     C                     Z-ADDWILENB    WJLENB           Hot Head
     C                     Z-ADDWILFNB    WJLFNB           TDE Head Condem
     C                     Z-ADDWILINB    WJLINB           Head 2
     C                     MOVELWIP4ST    WJP4ST    P      Status 1
     C                     MOVELWIP5ST    WJP5ST    P      Status 2
     C                     MOVELWIAAVN    WJAAVN    P      RS User Changed
     C                     Z-ADDWIAADT    WJAADT           RS Date Changed
     C                     Z-ADDWIAMTM    WJAMTM           RS Time Changed
     C                     MOVELWIAJST    WJAJST    P      RS Record Statu
     C                     MOVELWIAHVN    WJAHVN    P      RS Job
     C                     MOVELWIAGVN    WJAGVN    P      RS Program
     C                     MOVELWIABVN    WJABVN    P      RS User Added
     C                     Z-ADDWIABDT    WJABDT           RS Date Added
     C                     Z-ADDWIABTM    WJABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDY1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@DYCPXW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDYCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * H16853 ISE 11/02/20 - Increased the Buy Order Number field
      *   length from 5 to 7.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Zero/blank/status fields for Tattoo Header to Zero/Blank/N
      *================================================================
      * Zero fields/blanks fields and set null on status fields
     C                     Z-ADD*ZERO     WUFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WUFENB           TH Head Killed
     C                     Z-ADD*ZERO     WUHENB           TH Head Adds
     C                     Z-ADD*ZERO     WUJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WUHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WUE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WUA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WUFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WUA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WUHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WUF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WUF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WUF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WUF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WUAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WULRNB           TH Adj Live Wgt
      * Set Status fields to begining value
     C                     MOVEL*BLANK    WUD7ST           TH Header Error
     C                     MOVEL'N'       WUD8ST           TH Detail Error
     C                     MOVEL*BLANK    WUDWST           TH Kill Balanci
      * CASE: PAR.Requested by User to Bal is Yes
     C           P3G2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'U'       WUD6ST           TH Bal to Kill
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    WUDWST           TH Kill Balanci
     C                     END                             *FI
     C                     MOVEL*BLANK    WUCSCD           THP Process Cod
     C                     MOVEL'SLG'     WUCSCD           THP Process Cod
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Tattoo Header Accumulate/Validate Loss Transaction
      *================================================================
      * Rtv Bal/Tattoo Hdr    RT - Loss Trans  * 
     C                     EXSR SCRVGN
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Tattoo Header Accumulate/Validate Evaluation Records
      *================================================================
     C                     Z-ADD*ZERO     WUJONB           Hot Wgt/Lean %
     C                     Z-ADD*ZERO     WUL0NB           Hot Wgt/Backf A
     C                     Z-ADD*ZERO     WUL1NB           Hot Wgt/Loine A
     C                     Z-ADD*ZERO     WUL2NB           Hot Wgt/LghtR A
      * Rtv Bal/Kill Inform    RT - Eval Trans  * 
     C                     EXSR SLRVGN
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * COMPUTE LEAN % Morrison Hot Scale
      *================================================================
      * Calculate Lean % per Pork Rules
      * Backfat/loin are in inches
      * 2.827
      * + (0.469 * Carcass Weight)
      * - (0.7271657 * Backfat MM)
      * + (0.3867718 * Loin Eye MM)
      * -----------------------------
      * / Carcass Weight
      * * 100
     C           1         MULT 2.827     WUJVNB           Lean % Fld 1 Us
     C           1         MULT 0.469     WUJYNB           Lean % Fld 2 Us
     C                     Z-ADD0.7271657 WUJWNB           Lean % Fld 3 Us
     C                     Z-ADD0.3867718 WUJXNB           Lean % Fld 4 Us
      * CASE: DB1.ET Hot Wgt NE WRK.Zero USR
     C           WKAMPC    IFNE WUE9NB                     *IF
      * LEAN % COMPUTE
      * WRK.Lean % Fld 5 Usr =
      *    *COMPUTE (((x1 + (x2 * x5) - (x3 * x6) + (x4 * x7)) / x5 * x8
      *    ))
      * x1    : WRK.Lean % Fld 1 Usr
      * +     : WRK.Lean @ Ext 4 Usr
      * x2    : WRK.Lean % Fld 2 Usr
      * *     : WRK.Lean @ Ext 1 Usr *
      * x5    : DB1.ET Hot Wgt
      * -     : WRK.Lean @ Ext 4 Usr
      * x3    : WRK.Lean % Fld 3 Usr
      * *     : WRK.Lean @ Ext 2 Usr *
      * x6    : DB1.ET Backfat Thickness MM
      * +     : WRK.Lean @ Ext 4 Usr
      * x4    : WRK.Lean % Fld 4 Usr
      * *     : WRK.Lean @ Ext 3 Usr *
      * x7    : DB1.ET Loineye Depth MM
      * /     : WRK.Lean % Fld 5 Usr *
      * x5    : DB1.ET Hot Wgt
      * *     : WRK.Lean @ Ext 5 Usr *
      * x8    : CON.100
     C           WUJYNB    MULT WKAMPC    WUJ2NB           Lean @ Ext 1 Us
     C           WUJVNB    ADD  WUJ2NB    WUJ5NB           Lean @ Ext 4 Us
     C           WUJWNB    MULT WKX8NB    WUJ3NB           Lean @ Ext 2 Us
     C                     SUB  WUJ3NB    WUJ5NB           Lean @ Ext 4 Us
     C           WUJXNB    MULT WKFVPC    WUJ4NB           Lean @ Ext 3 Us
     C                     ADD  WUJ4NB    WUJ5NB           Lean @ Ext 4 Us
     C           WUJ5NB    DIV  WKAMPC    WUJZNB           Lean % Fld 5 Us
     C           WUJZNB    MULT 100       WUJ6NB           Lean @ Ext 5 Us
     C                     Z-ADDWUJ6NB    WUJZNB           Lean % Fld 5 Us
     C                     END                             *FI
     C           WUJZNB    MULT 1         WUAKPC    H      ET Lean Percent
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Validate transaction for min max rules
      *================================================================
      * Validate Hot Weight
      * CASE: DB1.ET Hot Wgt LE PAR.Carcass Lgt Max
     C           WKAMPC    IFLE P2JANB                     *IF
      * Carcass Light Weight Error
     C                     MOVEL'CLT'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     MOVEL'Y'       WUD8ST           TH Detail Error
     C                     MOVEL'E'       WUDWST           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR SOCRRC
     C                     ELSE
      * CASE: DB1.ET Hot Wgt GE PAR.Carcass Dbw Min
     C           WKAMPC    IFGE P2I7NB                     *IF
      * Carcass Double Weight Error
     C                     MOVEL'CDB'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     MOVEL'Y'       WUD8ST           TH Detail Error
     C                     MOVEL'E'       WUDWST           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR SQCRRC
     C                     END                             *FI
     C                     END                             *FI
      * Validate Backfat
      * CASE: DB1.ET Backfat Thickness Inch LE PAR.Backfat Low Max
     C           WKAIPC    IFLE P2K8NB                     *IF
      * backfat to low  Error
     C                     MOVEL'BLW'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     MOVEL'Y'       WUD8ST           TH Detail Error
     C                     MOVEL'E'       WUDWST           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR SSCRRC
     C                     ELSE
      * CASE: DB1.ET Backfat Thickness Inch GE PAR.BackFat High Min
     C           WKAIPC    IFGE P2K5NB                     *IF
      * backfat high error
     C                     MOVEL'BHI'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     MOVEL'Y'       WUD8ST           TH Detail Error
     C                     MOVEL'E'       WUDWST           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR SUCRRC
     C                     END                             *FI
     C                     END                             *FI
      * Validate Loineye
      * CASE: DB1.ET Loin-Eye Depth Inches LE PAR.LoinEye Low Max
     C           WKAJPC    IFLE P2LCNB                     *IF
      * Loin eye  Light Error
     C                     MOVEL'LLW'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     MOVEL'Y'       WUD8ST           TH Detail Error
     C                     MOVEL'E'       WUDWST           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR SWCRRC
     C                     ELSE
      * CASE: DB1.ET Loin-Eye Depth Inches GE PAR.LoinEye High Min
     C           WKAJPC    IFGE P2K9NB                     *IF
      * Loin eye  High Error
     C                     MOVEL'LHI'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     MOVEL'Y'       WUD8ST           TH Detail Error
     C                     MOVEL'E'       WUDWST           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR SYCRRC
     C                     END                             *FI
     C                     END                             *FI
      * Validate  % Lean
      * CASE: WRK.ET Lean Percent LE PAR.%Lean Low Max
     C           WUAKPC    IFLE P2JCNB                     *IF
      * % Lean low  Error
     C                     MOVEL'PLL'     WUDXST           KV Error Code
     C                     MOVEL'Y'       WUD8ST           TH Detail Error
     C                     MOVEL'E'       WUDWST           TH Kill Balanci
     C                     MOVEL'E'       WUD2ST           ET Error Sts
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR TACRRC
     C                     ELSE
      * CASE: WRK.ET Lean Percent GE PAR.%Lean High Min
     C           WUAKPC    IFGE P2JBNB                     *IF
      * % Lean High Error
     C                     MOVEL'PLH'     WUDXST           KV Error Code
     C                     MOVEL'Y'       WUD8ST           TH Detail Error
     C                     MOVEL'E'       WUDWST           TH Kill Balanci
     C                     MOVEL'E'       WUD2ST           ET Error Sts
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR TCCRRC
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Accumulate Totals
      *================================================================
      * Accumulate totals
     C                     ADD  1         WUFENB           TH Head Killed
     C                     ADD  WKAJPC    WUA5PC           TH Tot Loin Eye
     C                     ADD  WKAIPC    WUFBNB           TH Tot Backfat
     C                     ADD  WKALPC    WUA4PC           TH Tot Light Re
     C                     ADD  WKAMPC    WUE0NB           TH Hot Wgt
      * Weighted accumulated Lean%
     C           WUAKPC    MULT WKAMPC    WUJNNB           Hot Wgt/Weight
     C                     ADD  WUJNNB    WUJONB           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           WKAIPC    MULT WKAMPC    WUJNNB           Hot Wgt/Weight
     C                     ADD  WUJNNB    WUL0NB           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           WKAJPC    MULT WKAMPC    WUJNNB           Hot Wgt/Weight
     C                     ADD  WUJNNB    WUL1NB           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           WKALPC    MULT WKAMPC    WUJNNB           Hot Wgt/Weight
     C                     ADD  WUJNNB    WUL2NB           Hot Wgt/LghtR A
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Calculate Tattoo Header Averages/yield
      *================================================================
      * Calculate Adj Live Weight
      * CASE: PAR.TH Head Received EQ WRK.Net Head Usr
     C           P1CWNB    IFEQ WUF6NB                     *IF
     C                     Z-ADDP1CYNB    WULRNB           TH Adj Live Wgt
     C                     ELSE
      * CASE: WRK.Net Head Usr EQ WRK.Zero USR
     C           WUF6NB    IFEQ WUE9NB                     *IF
     C                     Z-ADD*ZERO     WULRNB           TH Adj Live Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C           WUZANB    MULT P1F7NB    WUWA             *Synon (15,2) w
     C           P1CYNB    SUB  WUWA      WULRNB           TH Adj Live Wgt
     C                     END                             *FI
     C                     END                             *FI
      * Calculate Adj Actual Yield
     C                     EXSR UISUBR                     Calculate Adj A
      * Calculate Hot Weight
      * CASE: WRK.TH Head Killed NE WRK.Zero USR
     C           WUFENB    IFNE WUE9NB                     *IF
      * Accumulated totals div by head killed
     C           WUE0NB    DIV  WUFENB    WUHDNB           TH Avg Hot Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUHDNB           TH Avg Hot Wgt
     C                     END                             *FI
      * Weighted Adverages
      * CASE: WRK.TH Hot Wgt NE WRK.Zero USR
     C           WUE0NB    IFNE WUE9NB                     *IF
      * Weighted average
     C           WUJONB    DIV  WUE0NB    WUF4NB           TH Avg Lean Per
     C           WUL0NB    DIV  WUE0NB    WUF2NB           TH Avg Backfat
     C           WUL1NB    DIV  WUE0NB    WUF3NB           TH Avg Loin Eye
     C           WUL2NB    DIV  WUE0NB    WUF5NB           TH Avg Light Re
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WUF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WUF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WUF5NB           TH Avg Light Re
     C                     END                             *FI
      * Actual Yield Percent
      * CASE: PAR.TH Live Wgt NE WRK.Zero USR
     C           P1CYNB    IFNE WUE9NB                     *IF
      * actual yield percent: hot w / live wgt * 100
      * TH Actual Yield Percent
      * WRK.TH Actual Yield Percent =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : WRK.TH Hot Wgt
      * /     : PGM.*Synon (17,7) work field *
      * x2    : PAR.TH Live Wgt
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           WUE0NB    DIV  P1CYNB    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUAWPC           TH Actual Yield
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUAWPC           TH Actual Yield
     C                     END                             *FI
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Calculate Adj Actual Yield
      *================================================================
      * CASE: WRK.TH Adj Live Wgt NE WRK.Zero USR
     C           WULRNB    IFNE WUE9NB                     *IF
      * actual yield percent: hot w / live wgt * 100
      * Adj Actual Yield
      * WRK.TH Adj Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (17,7) work field *
      * x2    : WRK.TH Adj Live Wgt
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           P1E0NB    DIV  WULRNB    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCWPC           TH Adj Actual Y
     C                     END                             *FI
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * Validate tattoo header
      *================================================================
     C                     EXSR UKSUBR
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      *
      *================================================================
      * CASE: WRK.Head Percent Usr GT PAR.Head > Percent Min
     C           WUJPNB    IFGT P2JJNB                     *IF
      * head killed > Percent Error
     C                     MOVEL'HHP'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD7ST           TH Header Error
     C                     MOVEL'E'       WUDWST           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR TFCRRC
     C                     ELSE
      * CASE: WRK.Head Percent Usr LE PAR.Head < Percent Max
     C           WUJPNB    IFLE P2JINB                     *IF
      * head killed < Percent Error
     C                     MOVEL'HLP'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD7ST           TH Header Error
     C                     MOVEL'E'       WUDWST           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR THCRRC
     C                     END                             *FI
     C                     END                             *FI
      * CASE:
      *  - c1 OR (c2 AND c3)
      *   |- c1    : PAR.TH User Error Override is Yes
      *   |- c2    : PAR.TH Live Wgt is Zeros
      *   |- c3    : PAR.TH Source Type is Internal
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1E0ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           P1CYNB    IFEQ *ZERO                      *IF
     C           P1KAST    IFEQ 'I'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.TH Actual Yield Percent GT PAR.High Yield Min
     C           WUAWPC    IFGT P2JDNB                     *IF
      * High Yield
     C                     MOVEL'YHI'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD7ST           TH Header Error
     C                     MOVEL'E'       WUDWST           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR TJCRRC
     C                     ELSE
      * CASE: WRK.TH Actual Yield Percent LE PAR.Low Yield Max
     C           WUAWPC    IFLE P2JGNB                     *IF
      * Low Yield
     C                     MOVEL'YLW'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD7ST           TH Header Error
     C                     MOVEL'E'       WUDWST           TH Kill Balanci
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR TLCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHRNB           KV Company Numb
     C                     Z-ADD*ZERO     WABPDT           KV Kill Date
     C                     Z-ADD*ZERO     WAIRNB           KV TATTOO NUMBE
     C                     Z-ADD*ZERO     WABONM           KV Buy Order Nu
     C                     Z-ADD*ZERO     WALDNM           KV Load Number
     C                     Z-ADD*ZERO     WAFPNB           KV Record Numbe
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field TH Head Condemned
     C                     Z-ADD*ZERO     WUFDNB  50
      * Define work field TH Head Killed
     C                     Z-ADD*ZERO     WUFENB  50
      * Define work field TH Head Adds
     C                     Z-ADD*ZERO     WUHENB  50
      * Define work field TH Head Excluded
     C                     Z-ADD*ZERO     WUJ9NB  50
      * Define work field TH Head Accepted
     C                     Z-ADD*ZERO     WUHFNB  50
      * Define work field TH Hot Wgt
     C                     Z-ADD*ZERO     WUE0NB  71
      * Define work field TH Tot Loin Eye Depth
     C                     Z-ADD*ZERO     WUA5PC  61
      * Define work field TH Tot Backfat Inches
     C                     Z-ADD*ZERO     WUFBNB  61
      * Define work field TH Tot Light Reflectance
     C                     Z-ADD*ZERO     WUA4PC  61
      * Define work field TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WUHDNB  51
      * Define work field TH Avg Light Reflectance
     C                     Z-ADD*ZERO     WUF5NB  31
      * Define work field TH Avg Lean Percent
     C                     Z-ADD*ZERO     WUF4NB  31
      * Define work field TH Avg Loin Eye Depth
     C                     Z-ADD*ZERO     WUF3NB  31
      * Define work field TH Avg Backfat
     C                     Z-ADD*ZERO     WUF2NB  31
      * Define work field TH Actual Yield %
     C                     Z-ADD*ZERO     WUAWPC  52
      * Define work field TH Adj Live Wgt
     C                     Z-ADD*ZERO     WULRNB  71
      * Define work field TH Header Error Sts
     C                     MOVEL*BLANK    WUD7ST  1
      * Define work field TH Detail Error Sts
     C                     MOVEL*BLANK    WUD8ST  1
      * Define work field TH Kill Balancing Sts
     C                     MOVEL*BLANK    WUDWST  1
      * Define work field TH Bal to Kill Gen
     C                     MOVEL*BLANK    WUD6ST  1
      * Define work field THP Process Code
     C                     MOVEL*BLANK    WUCSCD  6
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHUNB           LTN Company Num
     C                     Z-ADD*ZERO     WCA7DT           LTN Kill Date
     C                     Z-ADD*ZERO     WCFHNB           LTN Record Numb
     C                     Z-ADD*ZERO     WCFFNB           LTN Tattoo Numb
     C                     Z-ADD*ZERO     WCDSNB           LTN Wgt
     C                     Z-ADD*ZERO     WCBWCD           LT Type Code
     C                     Z-ADD*ZERO     WCBYCD           LR Reason Code
     C                     Z-ADD*ZERO     WCHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WCBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WCBONB           BOL Load Number
     C                     Z-ADD*ZERO     WCCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WCB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
     C                     Z-ADD*ZERO     WCB8DT           RU Date
     C                     Z-ADD*ZERO     WCAOTM           RU Time
      * Define work field LTN Wgt
     C                     Z-ADD*ZERO     WUDSNB  71
      * Define work field LTN Error Sts
     C                     MOVEL*BLANK    WUD1ST  1
      * Define work field Loss Error 1 Usr
     C                     MOVEL*BLANK    WUH9ST  1
      * Define work field Loss Error 2 Usr
     C                     MOVEL*BLANK    WUIAST  1
      * Define work field Loss Error 3 Usr
     C                     MOVEL*BLANK    WUIBST  1
      * Define work field Loss Error 4 Usr
     C                     MOVEL*BLANK    WUICST  1
      * Define work field Loss Error 5 Usr
     C                     MOVEL*BLANK    WULRST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WEBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WEBONB           BOL Load Number
     C                     Z-ADD*ZERO     WECVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WEB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WEAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WEACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WEB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WECAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WEAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WEA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WECXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WECWNB           TH Head Receive
     C                     Z-ADD*ZERO     WEFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WEH9NB           TH Held Over
     C                     Z-ADD*ZERO     WEFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WEFENB           TH Head Killed
     C                     Z-ADD*ZERO     WEHENB           TH Head Adds
     C                     Z-ADD*ZERO     WEHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WECYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WELRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WEE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WEA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WEFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WEA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WEF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WEHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WEF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WEF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WEF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WEF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WEAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WEAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WECWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WEA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WEA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WEB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WEAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WEANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WEAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WEAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WEAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WEAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WEAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WEASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WEA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WEATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WEA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WECBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WECCPR           Th Payment Net
     C                     Z-ADD*ZERO     WELPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WECDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WEA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WEA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WEGHNB           TH Commission A
     C                     Z-ADD*ZERO     WEBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WEBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WEBTDT           TH Commission P
     C                     Z-ADD*ZERO     WEBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WEHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WEHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WEHINB           TH FFLI
     C                     Z-ADD*ZERO     WEA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WEA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WEA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WEJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WED6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WED7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WED8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WED9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WEEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WEEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WEECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WEEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WEEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WEEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WEEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WEEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WEOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WETHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WET2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WETHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WET2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WEOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WEKOER           TH Head Identif
     C                     Z-ADD*ZERO     WEOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WEOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WEIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WEOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WEHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WES9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WETAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WETBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WEJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WEKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WEKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WEKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WEKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WEOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WEIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WEIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WEIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WEKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WEOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WEKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WEORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WEOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WEMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WEMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WENCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WENCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WEIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WEKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WEEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WEEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WEECDT           TH Head LFT
     C                     Z-ADD*ZERO     WEEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WEEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WHBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WHBONB           BOL Load Number
     C                     Z-ADD*ZERO     WHCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WHB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WHC2NB           TD Sequence Num
     C                     Z-ADD*ZERO     WHCZNB           TD Live Wgt
     C                     Z-ADD*ZERO     WHC0NB           TD Pen Head
     C                     Z-ADD*ZERO     WHD8NB           TD Yard Dead
     C                     Z-ADD*ZERO     WHH7NB           TD Held Over
     C                     Z-ADD*ZERO     WHAJTM           TD Drive Time
     C                     Z-ADD*ZERO     WHJEA1           TD Drive Hour
     C                     Z-ADD*ZERO     WHB7CD           TD Drive Card N
     C                     Z-ADD*ZERO     WHD7NB           TD Avg Live Wgt
     C                     Z-ADD*ZERO     WHBVDT           TD User Date 1
     C                     Z-ADD*ZERO     WHBWDT           TD User Date 2
     C                     Z-ADD*ZERO     WHBXDT           TD Drive Date
     C                     Z-ADD*ZERO     WHHVNB           Pen Company Num
     C                     Z-ADD*ZERO     WHH8NB           Held Over Pen C
     C                     Z-ADD*ZERO     WHAADT           RS Date Changed
     C                     Z-ADD*ZERO     WHAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WHABDT           RS Date Added
     C                     Z-ADD*ZERO     WHABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WIBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WIBONB           BOL Load Number
     C                     Z-ADD*ZERO     WICVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WIB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WIC2NB           TD Sequence Num
     C                     Z-ADD*ZERO     WILENB           Hot Head
     C                     Z-ADD*ZERO     WILFNB           TDE Head Condem
     C                     Z-ADD*ZERO     WILINB           Head 2
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WIABDT           RS Date Added
     C                     Z-ADD*ZERO     WIABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Net Head Usr
     C                     Z-ADD*ZERO     WUF6NB  50
      * Define work field Net Head Adjusted Usr
     C                     Z-ADD*ZERO     WUZANB  50
      * Define work field Hot Wgt/Lean % Accum Usr
     C                     Z-ADD*ZERO     WUJONB  91
      * Define work field Hot Wgt/Backf Accum Usr
     C                     Z-ADD*ZERO     WUL0NB  91
      * Define work field Hot Wgt/Loine Accum Usr
     C                     Z-ADD*ZERO     WUL1NB  91
      * Define work field Hot Wgt/LghtR Accum Usr
     C                     Z-ADD*ZERO     WUL2NB  91
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKHSNB           ET Company Numb
     C                     Z-ADD*ZERO     WKA9DT           ET Kill Date
     C                     Z-ADD*ZERO     WKFJNB           ET Scale Sequen
     C                     Z-ADD*ZERO     WKHCNB           ET Carcass Numb
     C                     Z-ADD*ZERO     WKGDNB           ET Carcass Numb
     C                     Z-ADD*ZERO     WKFINB           ET Tattoo Numbe
     C                     Z-ADD*ZERO     WKLKNB           ET Lot
     C                     Z-ADD*ZERO     WKAMPC           ET Hot Wgt
     C                     Z-ADD*ZERO     WKAIPC           ET Backfat Thic
     C                     Z-ADD*ZERO     WKAJPC           ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WKAKPC           ET Lean Percent
     C                     Z-ADD*ZERO     WKX8NB           ET Backfat Thic
     C                     Z-ADD*ZERO     WKFVPC           ET Loineye Dept
     C                     Z-ADD*ZERO     WKFWPC           ET Light Reflec
     C                     Z-ADD*ZERO     WKFXPC           ET Lean Percent
     C                     Z-ADD*ZERO     WKALPC           ET Light Reflec
     C                     Z-ADD*ZERO     WKHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WKBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WKBONB           BOL Load Number
     C                     Z-ADD*ZERO     WKCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WKB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WKAADT           RS Date Changed
     C                     Z-ADD*ZERO     WKAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WKABDT           RS Date Added
     C                     Z-ADD*ZERO     WKABTM           RS Time Added
     C                     Z-ADD*ZERO     WKB8DT           RU Date
     C                     Z-ADD*ZERO     WKAOTM           RU Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAFPC           EV Minimum
     C                     Z-ADD*ZERO     WLAGPC           EV Maximum
     C                     Z-ADD*ZERO     WLAADT           RS Date Changed
     C                     Z-ADD*ZERO     WLAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WLABDT           RS Date Added
     C                     Z-ADD*ZERO     WLABTM           RS Time Added
      * Define work field ET Error Sts
     C                     MOVEL*BLANK    WUD2ST  1
      * Define work field ET Lean Percent NPPC
     C                     Z-ADD*ZERO     WUAKPC  31
      * Define work field ET Lean Percent FOM
     C                     Z-ADD*ZERO     WUFXPC  31
      * Define work field ET Backfat Thickness MM
     C                     Z-ADD*ZERO     WUX8NB  31
      * Define work field ET Loineye Depth MM
     C                     Z-ADD*ZERO     WUFVPC  31
      * Define work field ET Light Reflectance MM
     C                     Z-ADD*ZERO     WUFWPC  31
      * Define work field Calculate All Usr
     C                     MOVEL*BLANK    WUM0ST  1
      * Define work field Lean % Fld 1 Usr
     C                     Z-ADD*ZERO     WUJVNB 177
      * Define work field Lean % Fld 2 Usr
     C                     Z-ADD*ZERO     WUJYNB 177
      * Define work field Lean % Fld 3 Usr
     C                     Z-ADD*ZERO     WUJWNB 177
      * Define work field Lean % Fld 4 Usr
     C                     Z-ADD*ZERO     WUJXNB 177
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Define work field Lean @ Ext 1 Usr
     C                     Z-ADD*ZERO     WUJ2NB 177
      * Define work field Lean @ Ext 4 Usr
     C                     Z-ADD*ZERO     WUJ5NB 177
      * Define work field Lean @ Ext 2 Usr
     C                     Z-ADD*ZERO     WUJ3NB 177
      * Define work field Lean @ Ext 3 Usr
     C                     Z-ADD*ZERO     WUJ4NB 177
      * Define work field Lean % Fld 5 Usr
     C                     Z-ADD*ZERO     WUJZNB 177
      * Define work field Lean @ Ext 5 Usr
     C                     Z-ADD*ZERO     WUJ6NB 177
      * Define work field KV Error Code
     C                     MOVEL*BLANK    WUDXST  3
      * Define work field KV Error Description
     C                     MOVEL*BLANK    WUB7TX 25
      * Define work field Hot Wgt/Weight Ext Usr
     C                     Z-ADD*ZERO     WUJNNB  91
      * Define work field Head Percent Usr
     C                     Z-ADD*ZERO     WUJPNB  71
      * Define work field *Synon (15,2) work field
     C                     Z-ADD*ZERO     WUWA   152
      * Define work field TH Adj Actual Yield %
     C                     Z-ADD*ZERO     WUCWPC  52
      * Define work field RS User Changed
     C                     MOVEL*BLANK    WUAAVN 10
      * Define work field RS Date Changed
     C                     Z-ADD*ZERO     WUAADT  70
      * Define work field RS Time Changed
     C                     Z-ADD*ZERO     WUAMTM  60
      * Define work field RS Record Status
     C                     MOVEL*BLANK    WUAJST  1
      * Define work field RS Job
     C                     MOVEL*BLANK    WUAHVN 10
      * Define work field RS Program
     C                     MOVEL*BLANK    WUAGVN 10
      * Define work field RS User Added
     C                     MOVEL*BLANK    WUABVN 10
      * Define work field RS Date Added
     C                     Z-ADD*ZERO     WUABDT  70
      * Define work field RS Time Added
     C                     Z-ADD*ZERO     WUABTM  60
      * Define work field TH Fixed Cost Amount
     C                     Z-ADD*ZERO     WUA2PR  72
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Net Head Usr
     C                     Z-ADD*ZERO     YL0001  50
      * Define local work field Stress/Market Type
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field TH PHA Add Type
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field TH PHA Average Type
     C                     MOVEL*BLANK    YL0004  3
      * Define local work field TH PHA Add Reason
     C                     MOVEL*BLANK    YL0005  1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Header No Evaluation Recs
00002 *BLANKS
