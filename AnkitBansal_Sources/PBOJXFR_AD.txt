// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PBOJXFR
// ?Date: 14.08.2025 Time: 03:48:41
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?Change log
DO;

//?PIO 03/06/24  CHANGED THE FILE NAME FROM PDLHCPLI TO PDLHCPLM
ENDDO;

EXECUTE FUNCTION(RTV Last OrdQty Chg   RT) TYPE(RTVOBJ) FILE(PDLHCPP)           AC2094615;
PARAMETER(PAR.Load_Change_Type);
PARAMETER(PAR.Order_Number);
PARAMETER(PAR.Created_Date);
PARAMETER(PAR.Created_Time);
PARAMETER(PAR.Order_Sequence_Number);
{
 //?USER: Initialize routine

 //?Pass out the latest create date/time for the load order change type parm
 //? if the order seq is 000 then get the latest for the order, else get
 //?  the latest for the order seq
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: CON);

 CASE;

 // IF DB1.Load Change Type EQ PAR.Load Change Type
 IF DB1.Load_Change_Type = PAR.Load_Change_Type;

 //?Latest Change per Order or Order Seq
 CASE;

 // IF PAR.Order Sequence Number is Equal to zero
 IF PAR.Order_Sequence_Number = *ZERO;

 // PAR.Date Entered = DB1.Created Date
 PAR.Date_Entered = DB1.Created_Date;

 // PAR.Time Entered = DB1.Created Time
 PAR.Time_Entered = DB1.Created_Time;

 QUIT;

 //?Latest Change per Order or Order Seq
 // IF *OTHERWISE
 IF *OTHERWISE;

 //?Extract seq from 1st 3 positions of prior value
 // WRK.Text 3 Length USR = DB1.Change Log Prior Value
 WRK.Text_3_Length_USR = DB1.Change_Log_Prior_Value;

 // WRK.Order Sequence Number = CVTVAR(WRK.Text 3 Length USR)
 WRK.Order_Sequence_Number = CVTVAR(WRK.Text_3_Length_USR);

 CASE;

 // IF PAR.Order Sequence Number EQ WRK.Order Sequence Number
 IF PAR.Order_Sequence_Number = WRK.Order_Sequence_Number;

 // PAR.Date Entered = DB1.Created Date
 PAR.Date_Entered = DB1.Created_Date;

 // PAR.Time Entered = DB1.Created Time
 PAR.Time_Entered = DB1.Created_Time;

 QUIT;

 ENDIF;

 ENDIF;

 ENDIF;

}


