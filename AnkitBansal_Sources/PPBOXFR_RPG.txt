     H/TITLE EXC EOP Update f/pmt  XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 05/05/11  Time  : 14:26:13
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOMHRCPL6IF  E           K        DISK
      * RSQ : Shipping Dtl Accrual      Acc/Shpto/ShpDt/Item
      *
     FPDICCPL1IF  E           K        DISK
      * RTV : History Dtl Accrual       Retrieval index
      *
     FOMHRCPL0UF  E           K        DISK
      * UPD : Shipping Dtl Accrual      Update index
      *
     FPDICCPL0UF  E           K        DISK
      * UPD : History Dtl Accrual       Update index
      *
     FOMHSTPL0UF  E           K        DISK
      * UPD : Sales History             Update index
      *
     I@HRCPV5
      * Shipping Dtl Accrual      Acc/Shpto/ShpDt/Item
      * Renamed input format fields
     I              HRAIC3                          WAAIC3
     I              HRC4NB                          WAC4NB
     I              HRDPNB                          WADPNB
     I              HRUENB                          WAUENB
     I              HRDXNB                          WADXNB
     I              HRBKPR                          WABKPR
     I              HRC5PC                          WAC5PC
     I              HRAYVA                          WAAYVA
     I              HREDVL                          WAEDVL
     I              HRHGCD                          WAHGCD
     I              HRBKC7                          WABKC7
     I              HRDUC7                          WADUC7
     I              HRHHAA                          WAHHAA
     I              HRPODT                          WAPODT
     I              HRBYWG                          WABYWG
     I              HRBVST                          WABVST
     I              HRP7SX                          WAP7SX
     I              HROKCD                          WAOKCD
     I              HRP8SX                          WAP8SX
     I              HRP9SX                          WAP9SX
     I              HRQASX                          WAQASX
     I              HRQBSX                          WAQBSX
     I              HRPPDT                          WAPPDT
     I              HRPQDT                          WAPQDT
     I              HREEVL                          WAEEVL
     I              HREFVL                          WAEFVL
     I              HRFITX                          WAFITX
     I              HRFJTX                          WAFJTX
     I              HRQ8DT                          WAQ8DT
     I              HRFKTX                          WAFKTX
     I              HRH0NY                          WAH0NY
     I              HRKQT1                          WAKQT1
     I              HRKTT1                          WAKTT1
     I              HRHIAA                          WAHIAA
     I              HRHLAA                          WAHLAA
     I              HROJCD                          WAOJCD
     I              HRAVNB                          WAAVNB
     I              HRDSCD                          WADSCD
     I              HRUVST                          WAUVST
     I              HRUWST                          WAUWST
     I              HRUXST                          WAUXST
     I              HRAATM                          WAAATM
     I              HRAYNA                          WAAYNA
     I              HRA0NA                          WAA0NA
     I              HRAXDT                          WAAXDT
      *
     I@HRCPLL
      * Shipping Dtl Accrual      Update index
      * Renamed input format fields
     I              HRAIC3                          WBAIC3
     I              HRC4NB                          WBC4NB
     I              HRDPNB                          WBDPNB
     I              HRUENB                          WBUENB
     I              HRDXNB                          WBDXNB
     I              HRBKPR                          WBBKPR
     I              HRC5PC                          WBC5PC
     I              HRAYVA                          WBAYVA
     I              HREDVL                          WBEDVL
     I              HRHGCD                          WBHGCD
     I              HRBKC7                          WBBKC7
     I              HRDUC7                          WBDUC7
     I              HRHHAA                          WBHHAA
     I              HRPODT                          WBPODT
     I              HRBYWG                          WBBYWG
     I              HRBVST                          WBBVST
     I              HRP7SX                          WBP7SX
     I              HROKCD                          WBOKCD
     I              HRP8SX                          WBP8SX
     I              HRP9SX                          WBP9SX
     I              HRQASX                          WBQASX
     I              HRQBSX                          WBQBSX
     I              HRPPDT                          WBPPDT
     I              HRPQDT                          WBPQDT
     I              HREEVL                          WBEEVL
     I              HREFVL                          WBEFVL
     I              HRFITX                          WBFITX
     I              HRFJTX                          WBFJTX
     I              HRQ8DT                          WBQ8DT
     I              HRFKTX                          WBFKTX
     I              HRH0NY                          WBH0NY
     I              HRKQT1                          WBKQT1
     I              HRKTT1                          WBKTT1
     I              HRHIAA                          WBHIAA
     I              HRHLAA                          WBHLAA
     I              HROJCD                          WBOJCD
     I              HRAVNB                          WBAVNB
     I              HRDSCD                          WBDSCD
     I              HRUVST                          WBUVST
     I              HRUWST                          WBUWST
     I              HRUXST                          WBUXST
     I              HRAATM                          WBAATM
     I              HRAYNA                          WBAYNA
     I              HRA0NA                          WBA0NA
     I              HRAXDT                          WBAXDT
      *
     I@ICCPS0
      * History Dtl Accrual       Retrieval index
      * Renamed input format fields
     I              ICAIC3                          WCAIC3
     I              ICC4NB                          WCC4NB
     I              ICDPNB                          WCDPNB
     I              ICUENB                          WCUENB
     I              ICDXNB                          WCDXNB
     I              ICBKPR                          WCBKPR
     I              ICAYVA                          WCAYVA
     I              ICEDVL                          WCEDVL
     I              ICHGCD                          WCHGCD
     I              ICBKC7                          WCBKC7
     I              ICPTDT                          WCPTDT
     I              ICBYWG                          WCBYWG
     I              ICBVST                          WCBVST
     I              ICP7SX                          WCP7SX
     I              ICOKCD                          WCOKCD
     I              ICQQSX                          WCQQSX
     I              ICQRSX                          WCQRSX
     I              ICFLTX                          WCFLTX
     I              ICQSSX                          WCQSSX
     I              ICPRDT                          WCPRDT
     I              ICPSDT                          WCPSDT
     I              ICEGVL                          WCEGVL
     I              ICEHVL                          WCEHVL
     I              ICAVNB                          WCAVNB
     I              ICDSCD                          WCDSCD
     I              ICFMTX                          WCFMTX
     I              ICFNTX                          WCFNTX
     I              ICQ9DT                          WCQ9DT
     I              ICFOTX                          WCFOTX
     I              ICH1NY                          WCH1NY
     I              ICKRT1                          WCKRT1
     I              ICKST1                          WCKST1
     I              ICHJAA                          WCHJAA
     I              ICHKAA                          WCHKAA
     I              ICHHAA                          WCHHAA
     I              ICOJCD                          WCOJCD
     I              ICAATM                          WCAATM
     I              ICAYNA                          WCAYNA
     I              ICA0NA                          WCA0NA
     I              ICAXDT                          WCAXDT
      *
     I@ICCPSZ
      * History Dtl Accrual       Update index
      * Renamed input format fields
     I              ICAIC3                          WDAIC3
     I              ICC4NB                          WDC4NB
     I              ICDPNB                          WDDPNB
     I              ICUENB                          WDUENB
     I              ICDXNB                          WDDXNB
     I              ICBKPR                          WDBKPR
     I              ICAYVA                          WDAYVA
     I              ICEDVL                          WDEDVL
     I              ICHGCD                          WDHGCD
     I              ICBKC7                          WDBKC7
     I              ICPTDT                          WDPTDT
     I              ICBYWG                          WDBYWG
     I              ICBVST                          WDBVST
     I              ICP7SX                          WDP7SX
     I              ICOKCD                          WDOKCD
     I              ICQQSX                          WDQQSX
     I              ICQRSX                          WDQRSX
     I              ICFLTX                          WDFLTX
     I              ICQSSX                          WDQSSX
     I              ICPRDT                          WDPRDT
     I              ICPSDT                          WDPSDT
     I              ICEGVL                          WDEGVL
     I              ICEHVL                          WDEHVL
     I              ICAVNB                          WDAVNB
     I              ICDSCD                          WDDSCD
     I              ICFMTX                          WDFMTX
     I              ICFNTX                          WDFNTX
     I              ICQ9DT                          WDQ9DT
     I              ICFOTX                          WDFOTX
     I              ICH1NY                          WDH1NY
     I              ICKRT1                          WDKRT1
     I              ICKST1                          WDKST1
     I              ICHJAA                          WDHJAA
     I              ICHKAA                          WDHKAA
     I              ICHHAA                          WDHHAA
     I              ICOJCD                          WDOJCD
     I              ICAATM                          WDAATM
     I              ICAYNA                          WDAYNA
     I              ICA0NA                          WDA0NA
     I              ICAXDT                          WDAXDT
      *
     I@FHSTD2
      * Sales History             Update index
      * Renamed input format fields
     I              F4AIC3                          WEAIC3
     I              F4C4NB                          WEC4NB
     I              F4DPNB                          WEDPNB
     I              F4UENB                          WEUENB
     I              F4MONA                          WEMONA
     I              F4RJCD                          WERJCD
     I              F4RKCD                          WERKCD
     I              F4GPTX                          WEGPTX
     I              F4ABTX                          WEABTX
     I              F4KXCD                          WEKXCD
     I              F4BOCD                          WEBOCD
     I              F4BTC7                          WEBTC7
     I              F4ANC7                          WEANC7
     I              F4AQTX                          WEAQTX
     I              F4BKC7                          WEBKC7
     I              F4BRTX                          WEBRTX
     I              F4HNNA                          WEHNNA
     I              F4DBCD                          WEDBCD
     I              F4CKTX                          WECKTX
     I              F4BCNA                          WEBCNA
     I              F4A0DT                          WEA0DT
     I              F4ACDT                          WEACDT
     I              F4R4CD                          WER4CD
     I              F4R5CD                          WER5CD
     I              F4BFCD                          WEBFCD
     I              F4Q4CD                          WEQ4CD
     I              F4AQCD                          WEAQCD
     I              F4TBNB                          WETBNB
     I              F4BZNA                          WEBZNA
     I              F4RLCD                          WERLCD
     I              F4JNCD                          WEJNCD
     I              F4Q2CD                          WEQ2CD
     I              F4U2ST                          WEU2ST
     I              F4ATIN                          WEATIN
     I              F4T3NB                          WET3NB
     I              F4RSRN                          WERSRN
     I              F4ORIT                          WEORIT
     I              F4AJCD                          WEAJCD
     I              F4AVQT                          WEAVQT
     I              F4D0WG                          WED0WG
     I              F4CCQT                          WECCQT
     I              F4AUWG                          WEAUWG
     I              F4AGCD                          WEAGCD
     I              F4AKPR                          WEAKPR
     I              F4AUPR                          WEAUPR
     I              F4CRCD                          WECRCD
     I              F4A5DT                          WEA5DT
     I              F4AWDT                          WEAWDT
     I              F4HDDT                          WEHDDT
     I              F4AGCS                          WEAGCS
     I              F4AQCS                          WEAQCS
     I              F4AVWG                          WEAVWG
     I              F4AYVA                          WEAYVA
     I              F4AMST                          WEAMST
     I              F4ANST                          WEANST
     I              F4VAST                          WEVAST
     I              F4L6NB                          WEL6NB
     I              F4UMCD                          WEUMCD
     I              F4HCDT                          WEHCDT
     I              F4ESNB                          WEESNB
     I              F4ETNB                          WEETNB
     I              F4BZNB                          WEBZNB
     I              F4EXQT                          WEEXQT
     I              F4BYWG                          WEBYWG
     I              F4S5NB                          WES5NB
     I              F4MAVA                          WEMAVA
     I              F4KDVA                          WEKDVA
     I              F4USVA                          WEUSVA
     I              F4UTVA                          WEUTVA
     I              F4A4WG                          WEA4WG
     I              F4CKNB                          WECKNB
     I              F4BMST                          WEBMST
     I              F4R8NB                          WER8NB
     I              F4RMCD                          WERMCD
     I              F4BZPR                          WEBZPR
     I              F4RDCD                          WERDCD
     I              F4Q7CD                          WEQ7CD
     I              F4EXDT                          WEEXDT
     I              F4LQCD                          WELQCD
     I              F4HICD                          WEHICD
     I              F4RBCD                          WERBCD
     I              F4RGNB                          WERGNB
     I              F4RHNB                          WERHNB
     I              F4RINB                          WERINB
     I              F4R1NB                          WER1NB
     I              F4CONB                          WECONB
     I              F4CEST                          WECEST
     I              F4GNDT                          WEGNDT
     I              F4RMNB                          WERMNB
     I              F4AODT                          WEAODT
     I              F4LLCD                          WELLCD
     I              F4LMCD                          WELMCD
     I              F4SKNB                          WESKNB
     I              F4SLNB                          WESLNB
     I              F4SMNB                          WESMNB
     I              F4G7NA                          WEG7NA
     I              F4ONVA                          WEONVA
     I              F4N0CD                          WEN0CD
     I              F4B4NB                          WEB4NB
     I              F4B5NB                          WEB5NB
     I              F4N1CD                          WEN1CD
     I              F4GIDT                          WEGIDT
     I              F4Z1ST                          WEZ1ST
     I              F4ULVA                          WEULVA
     I              F4UNVA                          WEUNVA
     I              F4UOVA                          WEUOVA
     I              F4UPVA                          WEUPVA
     I              F4UQVA                          WEUQVA
     I              F4SDCD                          WESDCD
     I              F4QZCD                          WEQZCD
     I              F4XWST                          WEXWST
     I              F4T9CD                          WET9CD
     I              F4UBCD                          WEUBCD
     I              F4CFC7                          WECFC7
     I              F4X1CD                          WEX1CD
     I              F4GASX                          WEGASX
     I              F4DUPR                          WEDUPR
     I              F4B6VL                          WEB6VL
     I              F4IANX                          WEIANX
     I              F4IBNX                          WEIBNX
     I              F4RPCD                          WERPCD
     I              F4NYDT                          WENYDT
     I              F4BZTM                          WEBZTM
     I              F4Z4NB                          WEZ4NB
     I              F4XACD                          WEXACD
     I              F4OANA                          WEOANA
     I              F4OKTX                          WEOKTX
     I              F4K4TX                          WEK4TX
     I              F4NBBO                          WENBBO
     I              F4OCFR                          WEOCFR
     I              F4C0C7                          WEC0C7
     I              F4A1AA                          WEA1AA
     I              F4VEST                          WEVEST
     I              F4A5PR                          WEA5PR
     I              F4CDPR                          WECDPR
     I              F4D0PR                          WED0PR
     I              F4D0VL                          WED0VL
     I              F4IRSX                          WEIRSX
     I              F4CEVL                          WECEVL
     I              F4ISSX                          WEISSX
     I              F4ITSX                          WEITSX
     I              F4IUSX                          WEIUSX
     I              F4OHDT                          WEOHDT
     I              F4D9PR                          WED9PR
     I              F4CFVL                          WECFVL
     I              F4UVST                          WEUVST
     I              F4UWST                          WEUWST
     I              F4UXST                          WEUXST
     I              F4AATM                          WEAATM
     I              F4AYNA                          WEAYNA
     I              F4A0NA                          WEA0NA
     I              F4AXDT                          WEAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQOMHR1    E DSOMHRCPL0
      * UPD : Shipping Dtl Accrual      Update index
      * Renamed input format fields
     I              HRAIC3                          WBAIC3
     I              HRC4NB                          WBC4NB
     I              HRDPNB                          WBDPNB
     I              HRUENB                          WBUENB
     I              HRDXNB                          WBDXNB
     I              HRBKPR                          WBBKPR
     I              HRC5PC                          WBC5PC
     I              HRAYVA                          WBAYVA
     I              HREDVL                          WBEDVL
     I              HRHGCD                          WBHGCD
     I              HRBKC7                          WBBKC7
     I              HRDUC7                          WBDUC7
     I              HRHHAA                          WBHHAA
     I              HRPODT                          WBPODT
     I              HRBYWG                          WBBYWG
     I              HRBVST                          WBBVST
     I              HRP7SX                          WBP7SX
     I              HROKCD                          WBOKCD
     I              HRP8SX                          WBP8SX
     I              HRP9SX                          WBP9SX
     I              HRQASX                          WBQASX
     I              HRQBSX                          WBQBSX
     I              HRPPDT                          WBPPDT
     I              HRPQDT                          WBPQDT
     I              HREEVL                          WBEEVL
     I              HREFVL                          WBEFVL
     I              HRFITX                          WBFITX
     I              HRFJTX                          WBFJTX
     I              HRQ8DT                          WBQ8DT
     I              HRFKTX                          WBFKTX
     I              HRH0NY                          WBH0NY
     I              HRKQT1                          WBKQT1
     I              HRKTT1                          WBKTT1
     I              HRHIAA                          WBHIAA
     I              HRHLAA                          WBHLAA
     I              HROJCD                          WBOJCD
     I              HRAVNB                          WBAVNB
     I              HRDSCD                          WBDSCD
     I              HRUVST                          WBUVST
     I              HRUWST                          WBUWST
     I              HRUXST                          WBUXST
     I              HRAATM                          WBAATM
     I              HRAYNA                          WBAYNA
     I              HRA0NA                          WBA0NA
     I              HRAXDT                          WBAXDT
      *
     IYARDCS      DS                            183
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPDIC1    E DSPDICCPL0
      * UPD : History Dtl Accrual       Update index
      * Renamed input format fields
     I              ICAIC3                          WDAIC3
     I              ICC4NB                          WDC4NB
     I              ICDPNB                          WDDPNB
     I              ICUENB                          WDUENB
     I              ICDXNB                          WDDXNB
     I              ICBKPR                          WDBKPR
     I              ICAYVA                          WDAYVA
     I              ICEDVL                          WDEDVL
     I              ICHGCD                          WDHGCD
     I              ICBKC7                          WDBKC7
     I              ICPTDT                          WDPTDT
     I              ICBYWG                          WDBYWG
     I              ICBVST                          WDBVST
     I              ICP7SX                          WDP7SX
     I              ICOKCD                          WDOKCD
     I              ICQQSX                          WDQQSX
     I              ICQRSX                          WDQRSX
     I              ICFLTX                          WDFLTX
     I              ICQSSX                          WDQSSX
     I              ICPRDT                          WDPRDT
     I              ICPSDT                          WDPSDT
     I              ICEGVL                          WDEGVL
     I              ICEHVL                          WDEHVL
     I              ICAVNB                          WDAVNB
     I              ICDSCD                          WDDSCD
     I              ICFMTX                          WDFMTX
     I              ICFNTX                          WDFNTX
     I              ICQ9DT                          WDQ9DT
     I              ICFOTX                          WDFOTX
     I              ICH1NY                          WDH1NY
     I              ICKRT1                          WDKRT1
     I              ICKST1                          WDKST1
     I              ICHJAA                          WDHJAA
     I              ICHKAA                          WDHKAA
     I              ICHHAA                          WDHHAA
     I              ICOJCD                          WDOJCD
     I              ICAATM                          WDAATM
     I              ICAYNA                          WDAYNA
     I              ICA0NA                          WDA0NA
     I              ICAXDT                          WDAXDT
      *
     IYBRDCS      DS                            173
     IQOMHS1    E DSOMHSTPL0
      * UPD : Sales History             Update index
      * Renamed input format fields
     I              F4AIC3                          WEAIC3
     I              F4C4NB                          WEC4NB
     I              F4DPNB                          WEDPNB
     I              F4UENB                          WEUENB
     I              F4MONA                          WEMONA
     I              F4RJCD                          WERJCD
     I              F4RKCD                          WERKCD
     I              F4GPTX                          WEGPTX
     I              F4ABTX                          WEABTX
     I              F4KXCD                          WEKXCD
     I              F4BOCD                          WEBOCD
     I              F4BTC7                          WEBTC7
     I              F4ANC7                          WEANC7
     I              F4AQTX                          WEAQTX
     I              F4BKC7                          WEBKC7
     I              F4BRTX                          WEBRTX
     I              F4HNNA                          WEHNNA
     I              F4DBCD                          WEDBCD
     I              F4CKTX                          WECKTX
     I              F4BCNA                          WEBCNA
     I              F4A0DT                          WEA0DT
     I              F4ACDT                          WEACDT
     I              F4R4CD                          WER4CD
     I              F4R5CD                          WER5CD
     I              F4BFCD                          WEBFCD
     I              F4Q4CD                          WEQ4CD
     I              F4AQCD                          WEAQCD
     I              F4TBNB                          WETBNB
     I              F4BZNA                          WEBZNA
     I              F4RLCD                          WERLCD
     I              F4JNCD                          WEJNCD
     I              F4Q2CD                          WEQ2CD
     I              F4U2ST                          WEU2ST
     I              F4ATIN                          WEATIN
     I              F4T3NB                          WET3NB
     I              F4RSRN                          WERSRN
     I              F4ORIT                          WEORIT
     I              F4AJCD                          WEAJCD
     I              F4AVQT                          WEAVQT
     I              F4D0WG                          WED0WG
     I              F4CCQT                          WECCQT
     I              F4AUWG                          WEAUWG
     I              F4AGCD                          WEAGCD
     I              F4AKPR                          WEAKPR
     I              F4AUPR                          WEAUPR
     I              F4CRCD                          WECRCD
     I              F4A5DT                          WEA5DT
     I              F4AWDT                          WEAWDT
     I              F4HDDT                          WEHDDT
     I              F4AGCS                          WEAGCS
     I              F4AQCS                          WEAQCS
     I              F4AVWG                          WEAVWG
     I              F4AYVA                          WEAYVA
     I              F4AMST                          WEAMST
     I              F4ANST                          WEANST
     I              F4VAST                          WEVAST
     I              F4L6NB                          WEL6NB
     I              F4UMCD                          WEUMCD
     I              F4HCDT                          WEHCDT
     I              F4ESNB                          WEESNB
     I              F4ETNB                          WEETNB
     I              F4BZNB                          WEBZNB
     I              F4EXQT                          WEEXQT
     I              F4BYWG                          WEBYWG
     I              F4S5NB                          WES5NB
     I              F4MAVA                          WEMAVA
     I              F4KDVA                          WEKDVA
     I              F4USVA                          WEUSVA
     I              F4UTVA                          WEUTVA
     I              F4A4WG                          WEA4WG
     I              F4CKNB                          WECKNB
     I              F4BMST                          WEBMST
     I              F4R8NB                          WER8NB
     I              F4RMCD                          WERMCD
     I              F4BZPR                          WEBZPR
     I              F4RDCD                          WERDCD
     I              F4Q7CD                          WEQ7CD
     I              F4EXDT                          WEEXDT
     I              F4LQCD                          WELQCD
     I              F4HICD                          WEHICD
     I              F4RBCD                          WERBCD
     I              F4RGNB                          WERGNB
     I              F4RHNB                          WERHNB
     I              F4RINB                          WERINB
     I              F4R1NB                          WER1NB
     I              F4CONB                          WECONB
     I              F4CEST                          WECEST
     I              F4GNDT                          WEGNDT
     I              F4RMNB                          WERMNB
     I              F4AODT                          WEAODT
     I              F4LLCD                          WELLCD
     I              F4LMCD                          WELMCD
     I              F4SKNB                          WESKNB
     I              F4SLNB                          WESLNB
     I              F4SMNB                          WESMNB
     I              F4G7NA                          WEG7NA
     I              F4ONVA                          WEONVA
     I              F4N0CD                          WEN0CD
     I              F4B4NB                          WEB4NB
     I              F4B5NB                          WEB5NB
     I              F4N1CD                          WEN1CD
     I              F4GIDT                          WEGIDT
     I              F4Z1ST                          WEZ1ST
     I              F4ULVA                          WEULVA
     I              F4UNVA                          WEUNVA
     I              F4UOVA                          WEUOVA
     I              F4UPVA                          WEUPVA
     I              F4UQVA                          WEUQVA
     I              F4SDCD                          WESDCD
     I              F4QZCD                          WEQZCD
     I              F4XWST                          WEXWST
     I              F4T9CD                          WET9CD
     I              F4UBCD                          WEUBCD
     I              F4CFC7                          WECFC7
     I              F4X1CD                          WEX1CD
     I              F4GASX                          WEGASX
     I              F4DUPR                          WEDUPR
     I              F4B6VL                          WEB6VL
     I              F4IANX                          WEIANX
     I              F4IBNX                          WEIBNX
     I              F4RPCD                          WERPCD
     I              F4NYDT                          WENYDT
     I              F4BZTM                          WEBZTM
     I              F4Z4NB                          WEZ4NB
     I              F4XACD                          WEXACD
     I              F4OANA                          WEOANA
     I              F4OKTX                          WEOKTX
     I              F4K4TX                          WEK4TX
     I              F4NBBO                          WENBBO
     I              F4OCFR                          WEOCFR
     I              F4C0C7                          WEC0C7
     I              F4A1AA                          WEA1AA
     I              F4VEST                          WEVEST
     I              F4A5PR                          WEA5PR
     I              F4CDPR                          WECDPR
     I              F4D0PR                          WED0PR
     I              F4D0VL                          WED0VL
     I              F4IRSX                          WEIRSX
     I              F4CEVL                          WECEVL
     I              F4ISSX                          WEISSX
     I              F4ITSX                          WEITSX
     I              F4IUSX                          WEIUSX
     I              F4OHDT                          WEOHDT
     I              F4D9PR                          WED9PR
     I              F4CFVL                          WECFVL
     I              F4UVST                          WEUVST
     I              F4UWST                          WEUWST
     I              F4UXST                          WEUXST
     I              F4AATM                          WEAATM
     I              F4AYNA                          WEAYNA
     I              F4A0NA                          WEA0NA
     I              F4AXDT                          WEAXDT
      *
     IYCRDCS      DS                            792
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Shipping Dtl Accrual
      * I :  Ship To Customer
     I                                    P   1   40P1BKC7
      * I :  Accrual Code
     I                                        5   7 P1OJCD
     IP2PARM      DS
      * I :  Period Beginning Date
     I                                    P   1   40P2BFDT
     IP3PARM      DS
      * I :  Period Ending Date
     I                                    P   1   40P3A2DT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1BKC7    PARM           WP0001  70       Ship To Custome
     C           P1OJCD    PARM           WP0002  3        Accrual Code
     C           P2BFDT    PARM           WP0003  70       Period Beginnin
     C           P3A2DT    PARM           WP0004  70       Period Ending D
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * EXC EOP Update f/pmt  XF
      * At EOP, if Min Commission Amount not met, update extended amt to
      *  meaning that no commission will be paid.
      * RMC EXPCOM 10/21/04 remove co from the input parm and key
      * RMC DLY029 05/23/07 Db Changes
      * Rtv EOP Upd f/pmt ALL RT - Shipping Dtl Accrual  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv EOP Upd f/pmt ALL RT - Shipping Dtl Accrual  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAOJCD    WQSA01           Accrual Code
     C           *LIKE     DEFN WABKC7    WQSA02           Ship To Custome
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WQSA01           Accrual Code
     C                     KFLD           WQSA02           Ship To Custome
     C                     KFLD           WAPODT           SDA Actual Ship
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Accrual Code
     C                     KFLD           WQSA02           Ship To Custome
      * Setup key
     C                     MOVELP1OJCD    WQSA01           Accrual Code
     C                     Z-ADDP1BKC7    WQSA02           Ship To Custome
     C                     Z-ADDP2BFDT    WAPODT           SDA Actual Ship
      * Establish starting position
     C           KPSSA     SETLL@HRCPV5                    *
     C           KRSSA     READE@HRCPV5                  90*
      * Data record not found
     C   90                MOVEL'USR1526' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.SDA Actual Ship Date GE PAR.Period Beginning Dat
      *   |- c2    : DB1.SDA Actual Ship Date LE PAR.Period Ending Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAPODT    IFGE P2BFDT                     *IF
     C           WAPODT    IFLE P3A2DT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Chg Extended Amt      CH - Shipping Dtl Accrual  * 
     C                     EXSR SBCHRC
      * Chg Extended Amt      RT - History Dtl Accrual  * 
     C                     EXSR SCRVGN
      * CASE: DB1.Accrual Type is Commission
     C           WAOKCD    IFEQ 'CM'                       *IF
      * Rtv TF/CM Amount      RT - History Dtl Accrual  * 
     C                     EXSR SERVGN
      * Chg TF/CM Amount      CH - Sales History  * 
     C                     EXSR SFCHRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@HRCPV5                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCHRC    BEGSR
      *================================================================
      * Chg Extended Amt      CH - Shipping Dtl Accrual  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  96       Accrual Rate
     C                     Z-ADD*ZERO     WN0002  52       Accrual Percent
     C                     Z-ADD*ZERO     WN0003 112       Item Accrual Am
     C                     Z-ADD*ZERO     WN0004  70       Item Code
     C                     Z-ADD*ZERO     WN0005  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0006  70       A/R Customer
     C                     MOVEL*BLANK    WN0007  6        Broker Code
     C                     Z-ADD*ZERO     WN0008  70       SDA Actual Ship
     C                     Z-ADD*ZERO     WN0009 112       Weight Billed
     C                     MOVEL*BLANK    WN0010  1        Use G/L Code Dr
     C                     MOVEL*BLANK    WN0011  2        Accrual Type
     C                     MOVEL*BLANK    WN0012  1        SDA Affect Sale
     C                     MOVEL*BLANK    WN0013  1        SDA Affect Invo
     C                     MOVEL*BLANK    WN0014  1        SDA Print on In
     C                     MOVEL*BLANK    WN0015  2        SDA Invoice Pri
     C                     Z-ADD*ZERO     WN0016  70       SDA Ord Dtl Acr
     C                     Z-ADD*ZERO     WN0017  70       SDA Unused Date
     C                     Z-ADD*ZERO     WN0018 112       SDA Unused Amt
     C                     Z-ADD*ZERO     WN0019 112       SDA Unused Amt
     C                     MOVEL*BLANK    WN0020  1        SDA Ledger Accr
     C                     MOVEL*BLANK    WN0021  2        SDA Accrual Rat
     C                     Z-ADD*ZERO     WN0022  70       SDA Invoice Dat
     C                     MOVEL*BLANK    WN0023  2        SDA Sub Ledger
     C                     Z-ADD*ZERO     WN0024  80       SDA G/L Sub Led
     C                     MOVEL*BLANK    WN0025  8        SDA G/L Code Dr
     C                     MOVEL*BLANK    WN0026  8        SDA G/L Code Cr
     C                     MOVEL*BLANK    WN0027  8        SDA JDE Account
     C                     MOVEL*BLANK    WN0028  8        SDA JDE Account
     C                     MOVEL*BLANK    WN0029  3        Accrual Code
     C                     MOVEL*BLANK    WN0030  6        G/L Account for
     C                     MOVEL*BLANK    WN0031  8        G/L Sub Account
     C                     MOVEL*BLANK    WN0032  1        EDI Status 1
     C                     MOVEL*BLANK    WN0033  1        EDI Status 2
     C                     MOVEL*BLANK    WN0034  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0035  60       Job Time
     C                     MOVEL*BLANK    WN0036 10        User Id
     C                     MOVEL*BLANK    WN0037 10        Job Name
     C                     Z-ADD*ZERO     WN0038  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @HRCPLL
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     Z-ADDWAC4NB    WBC4NB           Order Number
     C                     Z-ADDWADPNB    WBDPNB           Order Sequence
     C                     Z-ADDWAUENB    WBUENB           Order Secondary
     C                     Z-ADDWADXNB    WBDXNB           Sequence Number
      *
     C           KLCHSB    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
     C                     KFLD           WBDPNB           Order Sequence
     C                     KFLD           WBUENB           Order Secondary
     C                     KFLD           WBDXNB           Sequence Number
     C           KLCHSB    CHAIN@HRCPLL              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMHRCPL0'MDACP
     C                     MOVEL'@HRCPLL' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMHR1    YARDCS
      * Move non-key fields to @HRCPLL
     C                     Z-ADD*ZERO     WBAYVA           Extended Amount
     C                     MOVEL'Y'       WBP7SX    P      Retro Comm Calc
      *
      * Set PGM.*Record Data Changed flag
     C           QOMHR1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WN0035           Job Time
     C                     MOVEL##USR     WN0036           User Id
     C                     MOVEL##JOB     WN0037           Job Name
     C                     Z-ADD##JDT     WN0038           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMHR1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@HRCPLL                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMHRCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Chg Extended Amt      RT - History Dtl Accrual  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C                     KFLD           WCDPNB           Order Sequence
     C                     KFLD           WCUENB           Order Secondary
     C                     KFLD           WCDXNB           Sequence Number
      * Setup key
     C                     Z-ADDWAAIC3    WCAIC3           Company Number
     C                     Z-ADDWAC4NB    WCC4NB           Order Number
     C                     Z-ADDWADPNB    WCDPNB           Order Sequence
     C                     Z-ADDWAUENB    WCUENB           Order Secondary
     C                     Z-ADDWADXNB    WCDXNB           Sequence Number
      * Establish starting position
     C           KRSSC     CHAIN@ICCPS0              90    *
      * Data record not found
     C   90                MOVEL'USR1655' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Extended Amt      CH - History Dtl Accrual  * 
     C                     EXSR SDCHRC
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCHRC    BEGSR
      *================================================================
      * Chg Extended Amt      CH - History Dtl Accrual  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0039  96       Accrual Rate
     C                     Z-ADD*ZERO     WN0040 112       Item Accrual Am
     C                     Z-ADD*ZERO     WN0041  70       Item Code
     C                     Z-ADD*ZERO     WN0042  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0043  70       HDA Actual Ship
     C                     Z-ADD*ZERO     WN0044 112       Weight Billed
     C                     MOVEL*BLANK    WN0045  1        Use G/L Code Dr
     C                     MOVEL*BLANK    WN0046  2        Accrual Type
     C                     MOVEL*BLANK    WN0047  1        HDA Affect Sale
     C                     MOVEL*BLANK    WN0048  1        HDA Affect Invo
     C                     MOVEL*BLANK    WN0049  1        HDA Print on In
     C                     MOVEL*BLANK    WN0050  2        HDA Invoice Pri
     C                     Z-ADD*ZERO     WN0051  70       HDA SA Week End
     C                     Z-ADD*ZERO     WN0052  70       HDA Unused Date
     C                     Z-ADD*ZERO     WN0053 112       HDA Unused Amt
     C                     Z-ADD*ZERO     WN0054 112       HDA Unused Amt
     C                     MOVEL*BLANK    WN0055  6        G/L Account for
     C                     MOVEL*BLANK    WN0056  8        G/L Sub Account
     C                     MOVEL*BLANK    WN0057  1        HDA Ledger Accr
     C                     MOVEL*BLANK    WN0058  2        HDA Accrual Rat
     C                     Z-ADD*ZERO     WN0059  70       HDA Invoice Dat
     C                     MOVEL*BLANK    WN0060  2        HDA Sub Ledger
     C                     Z-ADD*ZERO     WN0061  80       HDA G/L Sub Led
     C                     MOVEL*BLANK    WN0062  8        HDA G/L Code Dr
     C                     MOVEL*BLANK    WN0063  8        HDA G/L Code Cr
     C                     MOVEL*BLANK    WN0064  8        HDA JDE Account
     C                     MOVEL*BLANK    WN0065  8        HDA JDE Account
     C                     MOVEL*BLANK    WN0066  6        Broker Code
     C                     MOVEL*BLANK    WN0067  3        Accrual Code
     C                     Z-ADD*ZERO     WN0068  60       Job Time
     C                     MOVEL*BLANK    WN0069 10        User Id
     C                     MOVEL*BLANK    WN0070 10        Job Name
     C                     Z-ADD*ZERO     WN0071  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @ICCPSZ
     C                     Z-ADDWCAIC3    WDAIC3           Company Number
     C                     Z-ADDWCC4NB    WDC4NB           Order Number
     C                     Z-ADDWCDPNB    WDDPNB           Order Sequence
     C                     Z-ADDWCUENB    WDUENB           Order Secondary
     C                     Z-ADDWCDXNB    WDDXNB           Sequence Number
      *
     C           KLCHSD    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
     C                     KFLD           WDDPNB           Order Sequence
     C                     KFLD           WDUENB           Order Secondary
     C                     KFLD           WDDXNB           Sequence Number
     C           KLCHSD    CHAIN@ICCPSZ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDICCPL0'MDACP
     C                     MOVEL'@ICCPSZ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDIC1    YBRDCS
      * Move non-key fields to @ICCPSZ
     C                     Z-ADD*ZERO     WDAYVA           Extended Amount
     C                     MOVEL'Y'       WDP7SX    P      Retro Comm Calc
      *
      * Set PGM.*Record Data Changed flag
     C           QPDIC1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@ICCPSZ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDICCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv TF/CM Amount      RT - History Dtl Accrual  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0001           Ledgrd Trd Fund
     C                     Z-ADD*ZERO     YL0002           Commission Amou
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSE01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSE02           Order Number
     C           *LIKE     DEFN WCDPNB    WQSE03           Order Sequence
     C           *LIKE     DEFN WCUENB    WQSE04           Order Secondary
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Order Number
     C                     KFLD           WQSE03           Order Sequence
     C                     KFLD           WQSE04           Order Secondary
      * Setup key
     C                     Z-ADDWAAIC3    WQSE01           Company Number
     C                     Z-ADDWAC4NB    WQSE02           Order Number
     C                     Z-ADDWADPNB    WQSE03           Order Sequence
     C                     Z-ADDWAUENB    WQSE04           Order Secondary
      * Establish starting position
     C           KRSSE     SETLL@ICCPS0                    *
     C           KRSSE     READE@ICCPS0                  90*
      * Data record not found
     C   90                MOVEL'USR1655' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Accrual Type is Commission
     C           WCOKCD    IFEQ 'CM'                       *IF
     C                     ADD  WCAYVA    YL0002           Commission Amou
     C                     ELSE
      * CASE: DB1.Accrual Type is Trade Fund
     C           WCOKCD    IFEQ 'TF'                       *IF
     C                     ADD  WCAYVA    YL0001           Ledgrd Trd Fund
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSE     READE@ICCPS0                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * Chg TF/CM Amount      CH - Sales History  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0072 20        A/R City
     C                     MOVEL*BLANK    WN0073  2        A/R State
     C                     MOVEL*BLANK    WN0074  6        A/R County Code
     C                     MOVEL*BLANK    WN0075 11        A/R Zip/Postal
     C                     MOVEL*BLANK    WN0076 25        Alpha Search
     C                     MOVEL*BLANK    WN0077  6        Country Code
     C                     MOVEL*BLANK    WN0078  2        Type Code
     C                     Z-ADD*ZERO     WN0079  70       Parent Customer
     C                     Z-ADD*ZERO     WN0080  70       A/R Customer Nu
     C                     MOVEL*BLANK    WN0081 30        A/R Customer Na
     C                     Z-ADD*ZERO     WN0082  70       Ship To Custome
     C                     MOVEL*BLANK    WN0083 30        Ship To Name
     C                     MOVEL*BLANK    WN0084 20        Ship To City
     C                     MOVEL*BLANK    WN0085  2        Ship To State C
     C                     MOVEL*BLANK    WN0086 11        Ship To Zip/Pos
     C                     MOVEL*BLANK    WN0087 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0088  70       Order Date
     C                     Z-ADD*ZERO     WN0089  70       Cancel Date
     C                     MOVEL*BLANK    WN0090  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0091  3        Original Salesp
     C                     MOVEL*BLANK    WN0092  2        Manager Level C
     C                     MOVEL*BLANK    WN0093  3        VP Level Code
     C                     MOVEL*BLANK    WN0094  2        Terms Code
     C                     Z-ADD*ZERO     WN0095  52       Absorbed Freigh
     C                     MOVEL*BLANK    WN0096  3        Carrier Code
     C                     MOVEL*BLANK    WN0097  3        Order Header Re
     C                     MOVEL*BLANK    WN0098  2        Order Type - Sa
     C                     MOVEL*BLANK    WN0099  2        Shipping Method
     C                     MOVEL*BLANK    WN0100  1        Export Status
     C                     Z-ADD*ZERO     WN0101  70       Attach to Invoi
     C                     Z-ADD*ZERO     WN0102  70       Attach to Order
     C                     Z-ADD*ZERO     WN0103  70       Resell Referenc
     C                     Z-ADD*ZERO     WN0104  70       Original Item
     C                     MOVEL*BLANK    WN0105  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0106 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0107 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0108 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0109 112       Weight Schedule
     C                     MOVEL*BLANK    WN0110  2        U/M - Ordered
     C                     Z-ADD*ZERO     WN0111 114       Unit Price
     C                     Z-ADD*ZERO     WN0112 114       Unit Price Orde
     C                     MOVEL*BLANK    WN0113  2        U/M - Base Pric
     C                     Z-ADD*ZERO     WN0114  70       Requested Ship
     C                     Z-ADD*ZERO     WN0115  70       Invoice Date
     C                     Z-ADD*ZERO     WN0116  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0117 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0118 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0119 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0120 112       Extended Amount
     C                     MOVEL*BLANK    WN0121  1        Affect Inventor
     C                     MOVEL*BLANK    WN0122  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0123  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0124  70       Contract Number
     C                     MOVEL*BLANK    WN0125  6        Export Country
     C                     Z-ADD*ZERO     WN0126  70       LD Arrival Date
     C                     Z-ADD*ZERO     WN0127  40       Accounting Year
     C                     Z-ADD*ZERO     WN0128  20       Accounting Peri
     C                     Z-ADD*ZERO     WN0129  30       OM Week
     C                     Z-ADD*ZERO     WN0130 112       Quantity Billed
     C                     Z-ADD*ZERO     WN0131 112       Weight Billed
     C                     Z-ADD*ZERO     WN0132  70       Shipped Item Co
     C                     Z-ADD*ZERO     WN0133 112       Billing Detail
     C                     Z-ADD*ZERO     WN0134 112       Billing Detail
     C                     Z-ADD*ZERO     WN0135 112       FOB Gross Amoun
     C                     Z-ADD*ZERO     WN0136 112       Standard Overag
     C                     Z-ADD*ZERO     WN0137 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0138  80       G/L Document Nu
     C                     MOVEL*BLANK    WN0139  1        G/L Update Stat
     C                     Z-ADD*ZERO     WN0140  30       Shipping Compan
     C                     MOVEL*BLANK    WN0141  3        Order Detail Re
     C                     Z-ADD*ZERO     WN0142 114       Price Overage O
     C                     MOVEL*BLANK    WN0143  3        Date Method Cod
     C                     MOVEL*BLANK    WN0144  3        Price Method Co
     C                     Z-ADD*ZERO     WN0145  70       Market Pricing
     C                     MOVEL*BLANK    WN0146  3        Commodity Marke
     C                     MOVEL*BLANK    WN0147  2        Quality Level
     C                     MOVEL*BLANK    WN0148  2        Item Level
     C                     Z-ADD*ZERO     WN0149  30       Item Structure
     C                     Z-ADD*ZERO     WN0150  30       Item Structure
     C                     Z-ADD*ZERO     WN0151  30       Item Structure
     C                     Z-ADD*ZERO     WN0152 112       Rated Freight
     C                     Z-ADD*ZERO     WN0153  70       Invoice Number
     C                     MOVEL*BLANK    WN0154  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0155  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0156  70       Load ID
     C                     Z-ADD*ZERO     WN0157  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0158  3        Packaging Code
     C                     MOVEL*BLANK    WN0159  3        Item Market Cod
     C                     Z-ADD*ZERO     WN0160  20       Agrimetrics gro
     C                     Z-ADD*ZERO     WN0161  10       Agrimetrics pac
     C                     Z-ADD*ZERO     WN0162  20       Agrimetrics gra
     C                     MOVEL*BLANK    WN0163 30        Order Desc. Lin
     C                     Z-ADD*ZERO     WN0164 112       Actual Freight
     C                     MOVEL*BLANK    WN0165  3        Item Type Code
     C                     Z-ADD*ZERO     WN0166  30       PM R/M Type Cod
     C                     Z-ADD*ZERO     WN0167  50       PM Line Number
     C                     MOVEL*BLANK    WN0168  3        SH Unused (was
     C                     Z-ADD*ZERO     WN0169  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0170  1        Modified Flag
     C                     Z-ADD*ZERO     WN0171 112       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0172 112       Financials Amou
     C                     Z-ADD*ZERO     WN0173 112       Financials Amou
     C                     MOVEL*BLANK    WN0174  1        Group for Packa
     C                     MOVEL*BLANK    WN0175  2        Base/Conv/Loss
     C                     MOVEL*BLANK    WN0176  1        Variety/Rendere
     C                     MOVEL*BLANK    WN0177  3        Customer Group
     C                     MOVEL*BLANK    WN0178  3        Customer Group
     C                     Z-ADD*ZERO     WN0179  70       Order Group Cod
     C                     MOVEL*BLANK    WN0180  4        Shipping Zone C
     C                     MOVEL*BLANK    WN0181  1        Process Sts for
     C                     Z-ADD*ZERO     WN0182 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0183 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0184  30       Req Shipping Te
     C                     Z-ADD*ZERO     WN0185  30       Actual Shipping
     C                     MOVEL*BLANK    WN0186  1        Age Code
     C                     Z-ADD*ZERO     WN0187  70       Req Delivery Da
     C                     Z-ADD*ZERO     WN0188  60       Req Delivery Ti
     C                     Z-ADD*ZERO     WN0189  70       MPC Number
     C                     MOVEL*BLANK    WN0190  3        Shipping Line
     C                     MOVEL*BLANK    WN0191 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0192 25        Port City
     C                     MOVEL*BLANK    WN0193 30        Vessel Name
     C                     MOVEL*BLANK    WN0194 12        Booking Number
     C                     Z-ADD*ZERO     WN0195 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0196  70       Claim Number
     C                     Z-ADD*ZERO     WN0197  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0198  1        Palletize
     C                     Z-ADD*ZERO     WN0199 114       Commodity Marke
     C                     Z-ADD*ZERO     WN0200 114       Market Value
     C                     Z-ADD*ZERO     WN0201 114       Default Cmdty M
     C                     Z-ADD*ZERO     WN0202 114       Raw Material Co
     C                     MOVEL*BLANK    WN0203  1        Sales Expense P
     C                     Z-ADD*ZERO     WN0204 112       Sales Expense T
     C                     MOVEL*BLANK    WN0205  1        Data Mart Proce
     C                     MOVEL*BLANK    WN0206  1        LH Load Type
     C                     MOVEL*BLANK    WN0207  2        Order TF Exempt
     C                     Z-ADD*ZERO     WN0208  70       LD Sail Date
     C                     Z-ADD*ZERO     WN0209 114       NonLedgrd TrdFn
     C                     Z-ADD*ZERO     WN0210 112       HST Item Target
     C                     MOVEL*BLANK    WN0211  1        EDI Status 1
     C                     MOVEL*BLANK    WN0212  1        EDI Status 2
     C                     MOVEL*BLANK    WN0213  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0214  60       Job Time
     C                     MOVEL*BLANK    WN0215 10        User Id
     C                     MOVEL*BLANK    WN0216 10        Job Name
     C                     Z-ADD*ZERO     WN0217  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @FHSTD2
     C                     Z-ADDWAAIC3    WEAIC3           Company Number
     C                     Z-ADDWAC4NB    WEC4NB           Order Number
     C                     Z-ADDWADPNB    WEDPNB           Order Sequence
     C                     Z-ADDWAUENB    WEUENB           Order Secondary
      *
     C           KLCHSF    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C           KLCHSF    CHAIN@FHSTD2              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMHSTPL0'MDACP
     C                     MOVEL'@FHSTD2' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMHS1    YCRDCS
      * USER: Processing after Data read
     C                     MOVEL'N'       WEGASX           Process Sts for
     C                     MOVEL'N'       WEISSX           Data Mart Proce
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Move non-key fields to @FHSTD2
     C                     Z-ADDYL0001    WEUNVA           Ledgrd Trd Fund
     C                     Z-ADDYL0002    WEUOVA           Commission Amou
      *
      * Set PGM.*Record Data Changed flag
     C           QOMHS1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@FHSTD2                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMHSTPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WADXNB           Sequence Number
     C                     Z-ADD*ZERO     WABKPR           Accrual Rate
     C                     Z-ADD*ZERO     WAC5PC           Accrual Percent
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WAEDVL           Item Accrual Am
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WADUC7           A/R Customer
     C                     Z-ADD*ZERO     WAPODT           SDA Actual Ship
     C                     Z-ADD*ZERO     WABYWG           Weight Billed
     C                     Z-ADD*ZERO     WAPPDT           SDA Ord Dtl Acr
     C                     Z-ADD*ZERO     WAPQDT           SDA Unused Date
     C                     Z-ADD*ZERO     WAEEVL           SDA Unused Amt
     C                     Z-ADD*ZERO     WAEFVL           SDA Unused Amt
     C                     Z-ADD*ZERO     WAQ8DT           SDA Invoice Dat
     C                     Z-ADD*ZERO     WAH0NY           SDA G/L Sub Led
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCDXNB           Sequence Number
     C                     Z-ADD*ZERO     WCBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WCAYVA           Extended Amount
     C                     Z-ADD*ZERO     WCEDVL           Item Accrual Am
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCPTDT           HDA Actual Ship
     C                     Z-ADD*ZERO     WCBYWG           Weight Billed
     C                     Z-ADD*ZERO     WCPRDT           HDA SA Week End
     C                     Z-ADD*ZERO     WCPSDT           HDA Unused Date
     C                     Z-ADD*ZERO     WCEGVL           HDA Unused Amt
     C                     Z-ADD*ZERO     WCEHVL           HDA Unused Amt
     C                     Z-ADD*ZERO     WCQ9DT           HDA Invoice Dat
     C                     Z-ADD*ZERO     WCH1NY           HDA G/L Sub Led
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEDPNB           Order Sequence
     C                     Z-ADD*ZERO     WEUENB           Order Secondary
     C                     Z-ADD*ZERO     WEBTC7           Parent Customer
     C                     Z-ADD*ZERO     WEANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEA0DT           Order Date
     C                     Z-ADD*ZERO     WEACDT           Cancel Date
     C                     Z-ADD*ZERO     WETBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WEATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WET3NB           Attach to Order
     C                     Z-ADD*ZERO     WERSRN           Resell Referenc
     C                     Z-ADD*ZERO     WEORIT           Original Item
     C                     Z-ADD*ZERO     WEAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WED0WG           Weight Ordered
     C                     Z-ADD*ZERO     WECCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WEAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WEAKPR           Unit Price
     C                     Z-ADD*ZERO     WEAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WEA5DT           Requested Ship
     C                     Z-ADD*ZERO     WEAWDT           Invoice Date
     C                     Z-ADD*ZERO     WEHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WEAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WEAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WEAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WEAYVA           Extended Amount
     C                     Z-ADD*ZERO     WEL6NB           Contract Number
     C                     Z-ADD*ZERO     WEHCDT           LD Arrival Date
     C                     Z-ADD*ZERO     WEESNB           Accounting Year
     C                     Z-ADD*ZERO     WEETNB           Accounting Peri
     C                     Z-ADD*ZERO     WEBZNB           OM Week
     C                     Z-ADD*ZERO     WEEXQT           Quantity Billed
     C                     Z-ADD*ZERO     WEBYWG           Weight Billed
     C                     Z-ADD*ZERO     WES5NB           Shipped Item Co
     C                     Z-ADD*ZERO     WEMAVA           Billing Detail
     C                     Z-ADD*ZERO     WEKDVA           Billing Detail
     C                     Z-ADD*ZERO     WEUSVA           FOB Gross Amoun
     C                     Z-ADD*ZERO     WEUTVA           Standard Overag
     C                     Z-ADD*ZERO     WEA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WECKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WER8NB           Shipping Compan
     C                     Z-ADD*ZERO     WEBZPR           Price Overage O
     C                     Z-ADD*ZERO     WEEXDT           Market Pricing
     C                     Z-ADD*ZERO     WERGNB           Item Structure
     C                     Z-ADD*ZERO     WERHNB           Item Structure
     C                     Z-ADD*ZERO     WERINB           Item Structure
     C                     Z-ADD*ZERO     WER1NB           Rated Freight
     C                     Z-ADD*ZERO     WECONB           Invoice Number
     C                     Z-ADD*ZERO     WEGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WERMNB           Load ID
     C                     Z-ADD*ZERO     WEAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WESKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WESLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WESMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WEONVA           Actual Freight
     C                     Z-ADD*ZERO     WEB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WEB5NB           PM Line Number
     C                     Z-ADD*ZERO     WEGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WEULVA           Absorbed Freigh
     C                     Z-ADD*ZERO     WEUNVA           Ledgrd Trd Fund
     C                     Z-ADD*ZERO     WEUOVA           Commission Amou
     C                     Z-ADD*ZERO     WEUPVA           Financials Amou
     C                     Z-ADD*ZERO     WEUQVA           Financials Amou
     C                     Z-ADD*ZERO     WECFC7           Order Group Cod
     C                     Z-ADD*ZERO     WEDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WEB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WEIANX           Req Shipping Te
     C                     Z-ADD*ZERO     WEIBNX           Actual Shipping
     C                     Z-ADD*ZERO     WENYDT           Req Delivery Da
     C                     Z-ADD*ZERO     WEBZTM           Req Delivery Ti
     C                     Z-ADD*ZERO     WEZ4NB           MPC Number
     C                     Z-ADD*ZERO     WEOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WEC0C7           Claim Number
     C                     Z-ADD*ZERO     WEA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WEA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WECDPR           Market Value
     C                     Z-ADD*ZERO     WED0PR           Default Cmdty M
     C                     Z-ADD*ZERO     WED0VL           Raw Material Co
     C                     Z-ADD*ZERO     WECEVL           Sales Expense T
     C                     Z-ADD*ZERO     WEOHDT           LD Sail Date
     C                     Z-ADD*ZERO     WED9PR           NonLedgrd TrdFn
     C                     Z-ADD*ZERO     WECFVL           HST Item Target
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Ledgrd Trd Fund Accrl Amt
     C                     Z-ADD*ZERO     YL0001 112
      * Define local work field Commission Amount
     C                     Z-ADD*ZERO     YL0002 112
      *================================================================
     CSR         ZZEXIT    ENDSR
