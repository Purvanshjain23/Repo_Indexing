// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKFXEFR
// ?Date: 14.08.2025 Time: 02:49:18
// ?------------------------------------------------------------------------------------------------

//?USER: Initialize program

//?Modifications and Comments
DO;

//?H16853 ISE 11/02/20 - Increased the Buy Order Number field
//?  length from 5 to 7.
ENDDO;

// Execute function Mov ApplN to Company  US.
EXECUTE FUNCTION(Mov ApplN to Company  US) TYPE(EXCUSRSRC) ('PKMFUFR');
PARAMETER(PAR.Oms_System_Value_Alpha);
{
 C***   MOVE USER SOURCE                      ***
 C                     MOVEL#IEVTX    ##CMP
}


//?USER: Initialize subfile record (existing record)

CASE;

// IF RCD.THD Transaction Created is User Created
IF RCD.THD_Transaction_Created = 'U';

// PGM.*Record selected = CND.*YES
PGM.*Record_selected = 'Y';

// IF *OTHERWISE
IF *OTHERWISE;

// PGM.*Record selected = CND.*NO
PGM.*Record_selected = 'N';

ENDIF;

//?USER: Create DBF record

EXECUTE FUNCTION(Create Tattoo Deduction) TYPE(CRTOBJ) FILE(PKCDCPP)            AB1107817;
PARAMETER(RCD.BOH_Company_Number);
PARAMETER(RCD.BOH_Buy_Order_Number);
PARAMETER(RCD.BOL_Load_Number);
PARAMETER(RCD.TH_Tattoo_Number);
PARAMETER(RCD.TH_Kill_Date);
PARAMETER(RCD.DED_D_A_Code);
PARAMETER(RCD.THD_Unit_Amt);
PARAMETER(RCD.THD_Ded_Add_Amount);
PARAMETER(RCD.THD_Unit_Amt_Sign);
PARAMETER(RCD.THD_UOM);
PARAMETER('U');
PARAMETER(RCD.THD_GL_Code);
PARAMETER(RCD.THD_Contra_Gl_Code);
PARAMETER(RCD.THD_Re_imbursement_Head);
PARAMETER(RCD.THD_Payment_Sts);
PARAMETER(RCD.THD_Expense_Paid_by);
PARAMETER(RCD.THD_Expense_Type);
PARAMETER(RCD.THD_Reserve_Account_Upd);
PARAMETER(RCD.THD_Commission_Deduction);
PARAMETER(RCD.THD_Deferred_Payment);
PARAMETER(RCD.THD_Status_4);
PARAMETER(RCD.THD_Status_5);
PARAMETER(RCD.RS_User_Changed);
PARAMETER(RCD.RS_Date_Changed);
PARAMETER(RCD.RS_Time_Changed);
PARAMETER(RCD.RS_Record_Status);
PARAMETER(RCD.RS_Job);
PARAMETER(RCD.RS_Program);
PARAMETER(RCD.RS_User_Added);
PARAMETER(RCD.RS_Date_Added);
PARAMETER(RCD.RS_Time_Added);
{
 //?USER: Processing before Data update

 EXECUTE FUNCTION(Rtv Add Stamp         IF) TYPE(EXCINTFUN)                      AB1100935;
 PARAMETER(DB1.RS_Record_Status);
 PARAMETER(DB1.RS_Job);
 PARAMETER(DB1.RS_Program);
 PARAMETER(DB1.RS_User_Added);
 PARAMETER(DB1.RS_Date_Added);
 PARAMETER(DB1.RS_Time_Added);
 {
  //?Execute internal function

  // PAR.RS Record Status = CND.Active
  PAR.RS_Record_Status = 'A';

  // PAR.RS User Added = JOB.*USER
  PAR.RS_User_Added = JOB.*USER;

  // PAR.RS Date Added = JOB.*Job date
  PAR.RS_Date_Added = JOB.*Job_date;

  // PAR.RS Time Added = JOB.*Job time
  PAR.RS_Time_Added = JOB.*Job_time;

  // PAR.RS Program = JOB.*PROGRAM
  PAR.RS_Program = JOB.*PROGRAM;

  // PAR.RS Job = JOB.*JOB
  PAR.RS_Job = JOB.*JOB;

 }

}


//?USER: Delete DBF record

EXECUTE FUNCTION(Delete Tattoo Deduction) TYPE(DLTOBJ) FILE(PKCDCPP)            AB1107819;

//?USER: Change DBF record

EXECUTE FUNCTION(Change Tattoo Deduction) TYPE(CHGOBJ) FILE(PKCDCPP)            AB1107818;
PARAMETER(RCD.BOH_Company_Number);
PARAMETER(RCD.BOH_Buy_Order_Number);
PARAMETER(RCD.BOL_Load_Number);
PARAMETER(RCD.TH_Tattoo_Number);
PARAMETER(RCD.TH_Kill_Date);
PARAMETER(RCD.DED_D_A_Code);
PARAMETER(RCD.THD_Unit_Amt);
PARAMETER(RCD.THD_Ded_Add_Amount);
PARAMETER(RCD.THD_Unit_Amt_Sign);
PARAMETER(RCD.THD_UOM);
PARAMETER(RCD.THD_Transaction_Created);
PARAMETER(RCD.THD_GL_Code);
PARAMETER(RCD.THD_Contra_Gl_Code);
PARAMETER(RCD.THD_Re_imbursement_Head);
PARAMETER(RCD.THD_Payment_Sts);
PARAMETER(RCD.THD_Expense_Paid_by);
PARAMETER(RCD.THD_Expense_Type);
PARAMETER(RCD.THD_Reserve_Account_Upd);
PARAMETER(RCD.THD_Commission_Deduction);
PARAMETER(RCD.THD_Deferred_Payment);
PARAMETER(RCD.THD_Status_4);
PARAMETER(RCD.THD_Status_5);
PARAMETER(RCD.RS_User_Changed);
PARAMETER(RCD.RS_Date_Changed);
PARAMETER(RCD.RS_Time_Changed);
PARAMETER(RCD.RS_Record_Status);
PARAMETER(RCD.RS_Job);
PARAMETER(RCD.RS_Program);
PARAMETER(RCD.RS_User_Added);
PARAMETER(RCD.RS_Date_Added);
PARAMETER(RCD.RS_Time_Added);
{
 //?USER: Processing before Data update

 EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
 PARAMETER(DB1.RS_User_Changed);
 PARAMETER(DB1.RS_Date_Changed);
 PARAMETER(DB1.RS_Time_Changed);
 PARAMETER(DB1.RS_Job);
 PARAMETER(DB1.RS_Program);
 {
  //?Execute internal function

  // PAR.RS User Changed = JOB.*USER
  PAR.RS_User_Changed = JOB.*USER;

  // PAR.RS Date Changed = JOB.*Job date
  PAR.RS_Date_Changed = JOB.*Job_date;

  // PAR.RS Time Changed = JOB.*Job time
  PAR.RS_Time_Changed = JOB.*Job_time;

  // PAR.RS Job = JOB.*JOB
  PAR.RS_Job = JOB.*JOB;

  // PAR.RS Program = JOB.*PROGRAM
  PAR.RS_Program = JOB.*PROGRAM;

 }

}


