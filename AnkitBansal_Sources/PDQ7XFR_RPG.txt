     H/TITLE UPS Bld FG Items      XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     W* Warning: This program does not set on the LR indicator
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 06/15/09  Time  : 11:41:40
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCABZRELGIF  E           K        DISK
      * RTV : Company Item              Active Finished Goods
      *
     FCAB0RELJIF  E           K        DISK
      * RTV : Item Balance              Acitve records only
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FPDI8CPL0IF  E           K        DISK                      A
      * UPD : PS Prod Item Schedule     Update index
      *
      * Long constants
     E                    @CN#    1   1  6   @CN    25
     I@BZREZY
      * Company Item              Active Finished Goods
      * Renamed input format fields
     I              BZAIC3                          WAAIC3
     I              BZHGCD                          WAHGCD
     I              BZAVNA                          WAAVNA
     I              BZAWNA                          WAAWNA
     I              BZL7NA                          WAL7NA
     I              BZL8NA                          WAL8NA
     I              BZL6NA                          WAL6NA
     I              BZMFNA                          WAMFNA
     I              BZADCD                          WAADCD
     I              BZAWPC                          WAAWPC
     I              BZLXST                          WALXST
     I              BZAECD                          WAAECD
     I              BZAXPC                          WAAXPC
     I              BZLYST                          WALYST
     I              BZAFCD                          WAAFCD
     I              BZAICD                          WAAICD
     I              BZAIWG                          WAAIWG
     I              BZHICD                          WAHICD
     I              BZRBCD                          WARBCD
     I              BZFZST                          WAFZST
     I              BZAVST                          WAAVST
     I              BZCZWG                          WACZWG
     I              BZC0WG                          WAC0WG
     I              BZURTN                          WAURTN
     I              BZAJC8                          WAAJC8
     I              BZRINB                          WARINB
     I              BZRHNB                          WARHNB
     I              BZRGNB                          WARGNB
     I              BZLNCD                          WALNCD
     I              BZTFNB                          WATFNB
     I              BZN0CD                          WAN0CD
     I              BZX4ST                          WAX4ST
     I              BZTMVA                          WATMVA
     I              BZTNVA                          WATNVA
     I              BZBLPR                          WABLPR
     I              BZBMPR                          WABMPR
     I              BZLRCD                          WALRCD
     I              BZU9ST                          WAU9ST
     I              BZCMCO                          WACMCO
     I              BZQ1CD                          WAQ1CD
     I              BZQ8CD                          WAQ8CD
     I              BZCHTM                          WACHTM
     I              BZQZCD                          WAQZCD
     I              BZXWST                          WAXWST
     I              BZXXST                          WAXXST
     I              BZVMST                          WAVMST
     I              BZSWGH                          WASWGH
     I              BZPPHE                          WAPPHE
     I              BZR3CD                          WAR3CD
     I              BZSDCD                          WASDCD
     I              BZICN1                          WAICN1
     I              BZSVCD                          WASVCD
     I              BZICN2                          WAICN2
     I              BZSWCD                          WASWCD
     I              BZV2NB                          WAV2NB
     I              BZSXCD                          WASXCD
     I              BZITCN                          WAITCN
     I              BZSYCD                          WASYCD
     I              BZITC5                          WAITC5
     I              BZSZCD                          WASZCD
     I              BZICN6                          WAICN6
     I              BZS0CD                          WAS0CD
     I              BZICN7                          WAICN7
     I              BZS1CD                          WAS1CD
     I              BZICN8                          WAICN8
     I              BZS2CD                          WAS2CD
     I              BZICN9                          WAICN9
     I              BZS3CD                          WAS3CD
     I              BZICN0                          WAICN0
     I              BZS4CD                          WAS4CD
     I              BZSFNB                          WASFNB
     I              BZA3WG                          WAA3WG
     I              BZSJNB                          WASJNB
     I              BZLLCD                          WALLCD
     I              BZLMCD                          WALMCD
     I              BZP3ST                          WAP3ST
     I              BZSKNB                          WASKNB
     I              BZSLNB                          WASLNB
     I              BZSMNB                          WASMNB
     I              BZP4ST                          WAP4ST
     I              BZCFNB                          WACFNB
     I              BZCGNB                          WACGNB
     I              BZILNB                          WAILNB
     I              BZCHNB                          WACHNB
     I              BZCINB                          WACINB
     I              BZCJNB                          WACJNB
     I              BZCMNB                          WACMNB
     I              BZCNNB                          WACNNB
     I              BZCRNB                          WACRNB
     I              BZCSNB                          WACSNB
     I              BZCVNB                          WACVNB
     I              BZCWNB                          WACWNB
     I              BZCXNB                          WACXNB
     I              BZCZNB                          WACZNB
     I              BZC0NB                          WAC0NB
     I              BZN1CD                          WAN1CD
     I              BZB4NB                          WAB4NB
     I              BZB5NB                          WAB5NB
     I              BZX5ST                          WAX5ST
     I              BZX6ST                          WAX6ST
     I              BZX7ST                          WAX7ST
     I              BZPCCT                          WAPCCT
     I              BZBDNB                          WABDNB
     I              BZBJNB                          WABJNB
     I              BZSUST                          WASUST
     I              BZSVST                          WASVST
     I              BZSYST                          WASYST
     I              BZSZST                          WASZST
     I              BZS1ST                          WAS1ST
     I              BZXRCD                          WAXRCD
     I              BZXTCD                          WAXTCD
     I              BZXUCD                          WAXUCD
     I              BZF5WG                          WAF5WG
     I              BZF6WG                          WAF6WG
     I              BZF7WG                          WAF7WG
     I              BZBLNB                          WABLNB
     I              BZBNNB                          WABNNB
     I              BZS2ST                          WAS2ST
     I              BZS4ST                          WAS4ST
     I              BZS5ST                          WAS5ST
     I              BZS6ST                          WAS6ST
     I              BZS8ST                          WAS8ST
     I              BZS9ST                          WAS9ST
     I              BZTCST                          WATCST
     I              BZTDST                          WATDST
     I              BZUVST                          WAUVST
     I              BZUWST                          WAUWST
     I              BZUXST                          WAUXST
     I              BZVSST                          WAVSST
     I              BZAATM                          WAAATM
     I              BZAYNA                          WAAYNA
     I              BZA0NA                          WAA0NA
     I              BZAXDT                          WAAXDT
      *
     I@B0REYY
      * Item Balance              Acitve records only
      * Renamed input format fields
     I              B0AIC3                          WBAIC3
     I              B0HGCD                          WBHGCD
     I              B0AJCD                          WBAJCD
     I              B0AGCS                          WBAGCS
     I              B0AECS                          WBAECS
     I              B0BACS                          WBBACS
     I              B0BBCS                          WBBBCS
     I              B0CBPR                          WBCBPR
     I              B0GUDT                          WBGUDT
     I              B0XYST                          WBXYST
     I              B0CTPR                          WBCTPR
     I              B0G4DT                          WBG4DT
     I              B0BOWG                          WBBOWG
     I              B0DDQT                          WBDDQT
     I              B0DEQT                          WBDEQT
     I              B0DFQT                          WBDFQT
     I              B0HDQT                          WBHDQT
     I              B0HEQT                          WBHEQT
     I              B0AJQT                          WBAJQT
     I              B0AQQT                          WBAQQT
     I              B0AUQT                          WBAUQT
     I              B0EMQT                          WBEMQT
     I              B0DOQT                          WBDOQT
     I              B0ATNA                          WBATNA
     I              B0AKDT                          WBAKDT
     I              B0ANDT                          WBANDT
     I              B0IDVA                          WBIDVA
     I              B0JVST                          WBJVST
     I              B0BZPC                          WBBZPC
     I              B0DGQT                          WBDGQT
     I              B0DIDT                          WBDIDT
     I              B0ALCD                          WBALCD
     I              B0BFDY                          WBBFDY
     I              B0DJDT                          WBDJDT
     I              B0BGDY                          WBBGDY
     I              B0DKDT                          WBDKDT
     I              B0J2ST                          WBJ2ST
     I              B0DJQT                          WBDJQT
     I              B0BNWG                          WBBNWG
     I              B0DLDT                          WBDLDT
     I              B0DPQT                          WBDPQT
     I              B0DQQT                          WBDQQT
     I              B0DMDT                          WBDMDT
     I              B0M0ST                          WBM0ST
     I              B0J9ST                          WBJ9ST
     I              B0KBST                          WBKBST
     I              B0AKC8                          WBAKC8
     I              B0RINB                          WBRINB
     I              B0RHNB                          WBRHNB
     I              B0RGNB                          WBRGNB
     I              B0UVST                          WBUVST
     I              B0UWST                          WBUWST
     I              B0UXST                          WBUXST
     I              B0VSST                          WBVSST
     I              B0AATM                          WBAATM
     I              B0AYNA                          WBAYNA
     I              B0A0NA                          WBA0NA
     I              B0AXDT                          WBAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WCAJCD
     I              ADF8NA                          WCF8NA
     I              ADACNA                          WCACNA
     I              ADADNA                          WCADNA
     I              ADAENA                          WCAENA
     I              ADAJNA                          WCAJNA
     I              ADBTTX                          WCBTTX
     I              ADAOCD                          WCAOCD
     I              ADBGCD                          WCBGCD
     I              ADVHST                          WCVHST
     I              ADMPNA                          WCMPNA
     I              ADWPST                          WCWPST
     I              ADXUST                          WCXUST
     I              ADT0ST                          WCT0ST
     I              ADT1ST                          WCT1ST
     I              ADDBNB                          WCDBNB
     I              ADT2ST                          WCT2ST
     I              ADT3ST                          WCT3ST
     I              ADT4ST                          WCT4ST
     I              ADT6ST                          WCT6ST
     I              ADBWC3                          WCBWC3
     I              ADBTC3                          WCBTC3
     I              ADBUC3                          WCBUC3
     I              ADBVC3                          WCBVC3
     I              ADFCAA                          WCFCAA
     I              ADRQSX                          WCRQSX
     I              ADRRSX                          WCRRSX
     I              ADRSSX                          WCRSSX
     I              ADRTSX                          WCRTSX
     I              ADT7ST                          WCT7ST
     I              ADT8ST                          WCT8ST
     I              ADRNSX                          WCRNSX
     I              ADROSX                          WCROSX
     I              ADRPSX                          WCRPSX
     I              ADUVST                          WCUVST
     I              ADUWST                          WCUWST
     I              ADUXST                          WCUXST
     I              ADVSST                          WCVSST
     I              ADAATM                          WCAATM
     I              ADAYNA                          WCAYNA
     I              ADA0NA                          WCA0NA
     I              ADAXDT                          WCAXDT
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WDAIC3
     I              KMV8CD                          WDV8CD
     I              KMAUNA                          WDAUNA
     I              KMI5ST                          WDI5ST
     I              KMBXTX                          WDBXTX
     I              KMM8NB                          WDM8NB
     I              KMUVST                          WDUVST
     I              KMUWST                          WDUWST
     I              KMUXST                          WDUXST
     I              KMVSST                          WDVSST
     I              KMAATM                          WDAATM
     I              KMAYNA                          WDAYNA
     I              KMA0NA                          WDA0NA
     I              KMAXDT                          WDAXDT
      *
     I@AFREBE
      * Calendar                  Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WEAIC3
     I              AFBCDT                          WEBCDT
     I              AFCQNB                          WECQNB
     I              AFESNB                          WEESNB
     I              AFETNB                          WEETNB
     I              AFBZNB                          WEBZNB
     I              AFA9ST                          WEA9ST
     I              AFEINB                          WEEINB
     I              AFC5ST                          WEC5ST
     I              AFAQNB                          WEAQNB
     I              AFCMST                          WECMST
     I              AFV9ST                          WEV9ST
     I              AFWAST                          WEWAST
     I              AFX2ST                          WEX2ST
     I              AFOJDT                          WEOJDT
     I              AFNQNX                          WENQNX
     I              AFNRNX                          WENRNX
     I              AFI9SX                          WEI9SX
     I              AFJASX                          WEJASX
     I              AFOKDT                          WEOKDT
     I              AFOLDT                          WEOLDT
     I              AFUVST                          WEUVST
     I              AFUWST                          WEUWST
     I              AFUXST                          WEUXST
     I              AFAATM                          WEAATM
     I              AFAYNA                          WEAYNA
     I              AFA0NA                          WEA0NA
     I              AFAXDT                          WEAXDT
      *
     I@ADRET1
      * Warehouse                 Active records only
      * Renamed input format fields
     I              ADAJCD                          WFAJCD
     I              ADF8NA                          WFF8NA
     I              ADACNA                          WFACNA
     I              ADADNA                          WFADNA
     I              ADAENA                          WFAENA
     I              ADAJNA                          WFAJNA
     I              ADBTTX                          WFBTTX
     I              ADAOCD                          WFAOCD
     I              ADBGCD                          WFBGCD
     I              ADVHST                          WFVHST
     I              ADMPNA                          WFMPNA
     I              ADWPST                          WFWPST
     I              ADXUST                          WFXUST
     I              ADT0ST                          WFT0ST
     I              ADT1ST                          WFT1ST
     I              ADDBNB                          WFDBNB
     I              ADT2ST                          WFT2ST
     I              ADT3ST                          WFT3ST
     I              ADT4ST                          WFT4ST
     I              ADT6ST                          WFT6ST
     I              ADBWC3                          WFBWC3
     I              ADBTC3                          WFBTC3
     I              ADBUC3                          WFBUC3
     I              ADBVC3                          WFBVC3
     I              ADFCAA                          WFFCAA
     I              ADRQSX                          WFRQSX
     I              ADRRSX                          WFRRSX
     I              ADRSSX                          WFRSSX
     I              ADRTSX                          WFRTSX
     I              ADT7ST                          WFT7ST
     I              ADT8ST                          WFT8ST
     I              ADRNSX                          WFRNSX
     I              ADROSX                          WFROSX
     I              ADRPSX                          WFRPSX
     I              ADUVST                          WFUVST
     I              ADUWST                          WFUWST
     I              ADUXST                          WFUXST
     I              ADVSST                          WFVSST
     I              ADAATM                          WFAATM
     I              ADAYNA                          WFAYNA
     I              ADA0NA                          WFA0NA
     I              ADAXDT                          WFAXDT
      *
     I@I8CPUR
      * PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WGAIC3
     I              I8V5ST                          WGV5ST
     I              I8ELDT                          WGELDT
     I              I8HGCD                          WGHGCD
     I              I8AJCD                          WGAJCD
     I              I8GPDT                          WGGPDT
     I              I8WTSP                          WGWTSP
     I              I8QTSP                          WGQTSP
     I              I8DJPC                          WGDJPC
     I              I8F8WG                          WGF8WG
     I              I8WTIN                          WGWTIN
     I              I8D5NB                          WGD5NB
     I              I8DXWG                          WGDXWG
     I              I8B2NB                          WGB2NB
     I              I8WTCN                          WGWTCN
     I              I8PSCV                          WGPSCV
     I              I8SAWT                          WGSAWT
     I              I8B9NB                          WGB9NB
     I              I8D1WG                          WGD1WG
     I              I8CBNB                          WGCBNB
     I              I8EZWG                          WGEZWG
     I              I8CCNB                          WGCCNB
     I              I8E0WG                          WGE0WG
     I              I8D6NB                          WGD6NB
     I              I8OAWT                          WGOAWT
     I              I8CDNB                          WGCDNB
     I              I8UNW2                          WGUNW2
     I              I8CENB                          WGCENB
     I              I8F9WG                          WGF9WG
     I              I8BPNB                          WGBPNB
     I              I8GAWG                          WGGAWG
     I              I8BQNB                          WGBQNB
     I              I8GBWG                          WGGBWG
     I              I8BRNB                          WGBRNB
     I              I8GCWG                          WGGCWG
     I              I8BSNB                          WGBSNB
     I              I8GDWG                          WGGDWG
     I              I8BWNB                          WGBWNB
     I              I8GEWG                          WGGEWG
     I              I8PS6U                          WGPS6U
     I              I8WCST                          WGWCST
     I              I8WPST                          WGWPST
     I              I8B5ST                          WGB5ST
     I              I8TFST                          WGTFST
     I              I8TEST                          WGTEST
     I              I8THST                          WGTHST
     I              I8UDST                          WGUDST
     I              I8UFST                          WGUFST
     I              I8UGST                          WGUGST
     I              I8UHST                          WGUHST
     I              I8B6ST                          WGB6ST
     I              I8B7ST                          WGB7ST
     I              I8DVWG                          WGDVWG
     I              I8D7NB                          WGD7NB
     I              I8FCAD                          WGFCAD
     I              I8D9NB                          WGD9NB
     I              I8DWWG                          WGDWWG
     I              I8EANB                          WGEANB
     I              I8SHWT                          WGSHWT
     I              I8EBNB                          WGEBNB
     I              I8AVWT                          WGAVWT
     I              I8ECNB                          WGECNB
     I              I8WTON                          WGWTON
     I              I8EDNB                          WGEDNB
     I              I8FNWT                          WGFNWT
     I              I8EENB                          WGEENB
     I              I8QTAS                          WGQTAS
     I              I8EFNB                          WGEFNB
     I              I8WAIO                          WGWAIO
     I              I8EGNB                          WGEGNB
     I              I8R3CD                          WGR3CD
     I              I8RGNB                          WGRGNB
     I              I8RHNB                          WGRHNB
     I              I8RINB                          WGRINB
     I              I8XRCD                          WGXRCD
     I              I8UVST                          WGUVST
     I              I8UWST                          WGUWST
     I              I8UXST                          WGUXST
     I              I8VSST                          WGVSST
     I              I8AATM                          WGAATM
     I              I8AYNA                          WGAYNA
     I              I8A0NA                          WGA0NA
     I              I8AXDT                          WGAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPDI81    E DSPDI8CPL0
      * UPD : PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WGAIC3
     I              I8V5ST                          WGV5ST
     I              I8ELDT                          WGELDT
     I              I8HGCD                          WGHGCD
     I              I8AJCD                          WGAJCD
     I              I8GPDT                          WGGPDT
     I              I8WTSP                          WGWTSP
     I              I8QTSP                          WGQTSP
     I              I8DJPC                          WGDJPC
     I              I8F8WG                          WGF8WG
     I              I8WTIN                          WGWTIN
     I              I8D5NB                          WGD5NB
     I              I8DXWG                          WGDXWG
     I              I8B2NB                          WGB2NB
     I              I8WTCN                          WGWTCN
     I              I8PSCV                          WGPSCV
     I              I8SAWT                          WGSAWT
     I              I8B9NB                          WGB9NB
     I              I8D1WG                          WGD1WG
     I              I8CBNB                          WGCBNB
     I              I8EZWG                          WGEZWG
     I              I8CCNB                          WGCCNB
     I              I8E0WG                          WGE0WG
     I              I8D6NB                          WGD6NB
     I              I8OAWT                          WGOAWT
     I              I8CDNB                          WGCDNB
     I              I8UNW2                          WGUNW2
     I              I8CENB                          WGCENB
     I              I8F9WG                          WGF9WG
     I              I8BPNB                          WGBPNB
     I              I8GAWG                          WGGAWG
     I              I8BQNB                          WGBQNB
     I              I8GBWG                          WGGBWG
     I              I8BRNB                          WGBRNB
     I              I8GCWG                          WGGCWG
     I              I8BSNB                          WGBSNB
     I              I8GDWG                          WGGDWG
     I              I8BWNB                          WGBWNB
     I              I8GEWG                          WGGEWG
     I              I8PS6U                          WGPS6U
     I              I8WCST                          WGWCST
     I              I8WPST                          WGWPST
     I              I8B5ST                          WGB5ST
     I              I8TFST                          WGTFST
     I              I8TEST                          WGTEST
     I              I8THST                          WGTHST
     I              I8UDST                          WGUDST
     I              I8UFST                          WGUFST
     I              I8UGST                          WGUGST
     I              I8UHST                          WGUHST
     I              I8B6ST                          WGB6ST
     I              I8B7ST                          WGB7ST
     I              I8DVWG                          WGDVWG
     I              I8D7NB                          WGD7NB
     I              I8FCAD                          WGFCAD
     I              I8D9NB                          WGD9NB
     I              I8DWWG                          WGDWWG
     I              I8EANB                          WGEANB
     I              I8SHWT                          WGSHWT
     I              I8EBNB                          WGEBNB
     I              I8AVWT                          WGAVWT
     I              I8ECNB                          WGECNB
     I              I8WTON                          WGWTON
     I              I8EDNB                          WGEDNB
     I              I8FNWT                          WGFNWT
     I              I8EENB                          WGEENB
     I              I8QTAS                          WGQTAS
     I              I8EFNB                          WGEFNB
     I              I8WAIO                          WGWAIO
     I              I8EGNB                          WGEGNB
     I              I8R3CD                          WGR3CD
     I              I8RGNB                          WGRGNB
     I              I8RHNB                          WGRHNB
     I              I8RINB                          WGRINB
     I              I8XRCD                          WGXRCD
     I              I8UVST                          WGUVST
     I              I8UWST                          WGUWST
     I              I8UXST                          WGUXST
     I              I8VSST                          WGVSST
     I              I8AATM                          WGAATM
     I              I8AYNA                          WGAYNA
     I              I8A0NA                          WGA0NA
     I              I8AXDT                          WGAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: PS Prod Item Schedule
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Production Type
     I                                        3   3 P1V5ST
      * I :  Production Date
     I                                    P   4   70P1ELDT
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1V5ST    PARM           WP0002  1        Production Type
     C           P1ELDT    PARM           WP0003  70       Production Date
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * UPS Bld FG Items      XF
      * FP1054 output ps production warehouse to pdi8cpp
      * UPS Rtv FG Items      RT - Company/Item  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * UPS Rtv FG Items      RT - Company/Item  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0002  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0003  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0004  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0005  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0006  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0007  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0008  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0009  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0010  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0011  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0012  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0013  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0014  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0015  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0016  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0017  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0018  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0019  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0020  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0021  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0022  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0023  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0024 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0025  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0026 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0027  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0028 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0029  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0030 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0031  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0032 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0033  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0034 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0035  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0036  3        PS Item Id
     C                     MOVEL*BLANK    WN0037  2        Warehouse Type
     C                     MOVEL*BLANK    WN0038  1        PS Lock Status
     C                     MOVEL*BLANK    WN0039  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0040  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0041  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0042  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0043  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0044  3        PS Production W
     C                     Z-ADD*ZERO     WN0045  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0046  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0047  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0048  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0049  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0050  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0051  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0052  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0053  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0054  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0055  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0056  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0057  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0058  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0059  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0060  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0061  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0062  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0063  6        Department Code
     C                     Z-ADD*ZERO     WN0064  30       Item Structure
     C                     Z-ADD*ZERO     WN0065  30       Item Structure
     C                     Z-ADD*ZERO     WN0066  30       Item Structure
     C                     MOVEL*BLANK    WN0067  1        EDI Status 1
     C                     MOVEL*BLANK    WN0068  1        EDI Status 2
     C                     MOVEL*BLANK    WN0069  1        EDI Status 3
     C                     MOVEL*BLANK    WN0070  1        Record Status
     C                     Z-ADD*ZERO     WN0071  60       Job Time
     C                     MOVEL*BLANK    WN0072 10        User Id
     C                     MOVEL*BLANK    WN0073 10        Job Name
     C                     Z-ADD*ZERO     WN0074  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
      * Establish starting position
     C           KRSSA     SETLL@BZREZY                    *
     C           KRSSA     READE@BZREZY                  90*
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * BPS Set Up Item Id    IF
      * CASE: PAR.Item Type Code is Raw Materials
     C           WAN0CD    IFEQ 'RM'                       *IF
     C                     MOVEL'RMB'     WN0036           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Seconds Item is Yes
     C           WAX5ST    IFEQ 'Y'                        *IF
     C                     MOVEL'FSC'     WN0036           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Variety/Rendered/Cut is Variety
     C           WAXWST    IFEQ 'V'                        *IF
     C                     MOVEL'FVR'     WN0036           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Rendered
     C           WAXWST    IFEQ 'R'                        *IF
     C                     MOVEL'FRD'     WN0036           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Cut
     C           WAXWST    IFEQ 'C'                        *IF
      * Base/Converted/Fabricated
      * CASE: PAR.Credit Item Status is yes
     C           WAVMST    IFEQ 'Y'                        *IF
      * Setup Base/Converted/Fabricated Credit
      * CASE: PAR.Converted/Base Item is Base
     C           WAQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FBC'     WN0036           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WAQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCC'     WN0036           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WAQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFC'     WN0036           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WAQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLC'     WN0036           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup Base/Converted/Fabricated
      * CASE: PAR.Converted/Base Item is Base
     C           WAQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FGB'     WN0036           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WAQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCV'     WN0036           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WAQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFB'     WN0036           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WAQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLS'     WN0036           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Ups Crt Prod Dtl Rec  RT - Item Balance  * 
     C                     EXSR SBRVGN
     C           KRSSA     READE@BZREZY                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Ups Crt Prod Dtl Rec  RT - Item Balance  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0075  70       PS Available Sh
     C                     MOVEL*BLANK    WN0076  2        Warehouse Type
     C                     Z-ADD*ZERO     WN0077  52       Chilling Time U
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBHGCD    WQSB02           Item Code
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Item Code
      * Setup key
     C                     Z-ADDWAAIC3    WQSB01           Company Number
     C                     Z-ADDWAHGCD    WQSB02           Item Code
      * Establish starting position
     C           KRSSB     SETLL@B0REYY                    *
     C           KRSSB     READE@B0REYY                  90*
      * Data record not found
     C   90                MOVEL'USR0328' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWACHTM    WN0077           Chilling Time U
      *
     C                     Z-ADD*ZERO     WN0078 155       System Value Nu
      *
      * Rtv Whs Typ/FZNCHLTME IF
      * RTV Warehouse Type     RT - Warehouse  * 
     C                     EXSR SCRVGN
      * CASE: PAR.Warehouse Type is Frozen
     C           WN0076    IFEQ 'FZ'                       *IF
      * RTV Numeric Value      RT - Company Values  * 
     C                     EXSR SDRVGN
     C                     Z-ADDWN0078    WN0077           Fresh Chilling
     C                     END                             *FI
      * UPS Clc Avail Shp Dte RT - Calendar  * 
     C                     EXSR SERVGN
      * Rtv Productin Whs     RT - Warehouse  * 
     C                     EXSR SFRVGN
     C                     MOVELYL0001    YL0002           PS Production W
      * UPS Crt Prd Dtl Rec   CR - PS Prod Item Schedule  * 
     C                     EXSR SGCRRC
     C           KRSSB     READE@B0REYY                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWBAJCD    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSC     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0076           Warehouse Type
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCWPST    WN0076           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDV8CD           Company Value C
      * Setup key
     C                     Z-ADDWAAIC3    WDAIC3           Company Number
     C                     MOVEL@CN,01    WDV8CD           Company Value C
      * Establish starting position
     C           KRSSD     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDM8NB    WN0078           System Value Nu
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSE01           Company Number
      * Define keylist
     C           KPSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WEBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
      * Setup key
     C                     Z-ADDWAAIC3    WQSE01           Company Number
     C                     Z-ADDP1ELDT    WEBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSE     SETLL@AFREBE                    *
     C           KRSSE     READE@AFREBE                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DOC:  Change Log
     C                     EXSR UASUBR                     DOC:  Change Lo
      * CASE: WRK.Count USR EQ PAR.Chilling Time
     C           WUCNTU    IFEQ WN0077                     *IF
     C                     Z-ADDWEBCDT    WN0075           PS Available Sh
     C                     GOTO SEEXIT                     *QUIT
     C                     END                             *FI
      * 04/10/07 PKD No offset, so do not check for Saturday.
      * 06/15/09 PKD FP1054 Saturday offset back in place.
      * Code for Saturday Offset
      * CASE: DB1.Day of Week is Saturday
     C           WEA9ST    IFEQ '7'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
      * ------ Code for no Offset -----
      * -------------------------------
     C           KRSSE     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Productin Whs     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFAJCD           Warehouse Code
      * Setup key
     C                     MOVELWBAJCD    WFAJCD           Warehouse Code
      * Establish starting position
     C           KRSSF     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           Production Ware
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFAOCD    YL0001           Production Ware
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCRRC    BEGSR
      *================================================================
      * UPS Crt Prd Dtl Rec   CR - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @I8CPUR
     C                     Z-ADDWAAIC3    WGAIC3           Company Number
     C                     MOVELP1V5ST    WGV5ST           Production Type
     C                     Z-ADDP1ELDT    WGELDT           Production Date
     C                     Z-ADDWAHGCD    WGHGCD           Item Code
     C                     MOVELWBAJCD    WGAJCD           Warehouse Code
     C                     Z-ADDWN0075    WGGPDT           PS Available Sh
     C                     Z-ADDWN0002    WGWTSP           PS Weight Plann
     C                     Z-ADDWN0003    WGQTSP           PS Pieces Plann
     C                     Z-ADDWN0004    WGDJPC           PS % of Carcass
     C                     Z-ADDWN0005    WGF8WG           PS Avg Piece Wg
     C                     Z-ADDWN0006    WGWTIN           PS Weight Inv O
     C                     Z-ADDWN0007    WGD5NB           PS Pieces Inv O
     C                     Z-ADDWN0008    WGDXWG           PS Weight Stand
     C                     Z-ADDWN0009    WGB2NB           PS Pieces Stand
     C                     Z-ADDWN0010    WGWTCN           PS Weight Conve
     C                     Z-ADDWN0011    WGPSCV           PS Pieces Conve
     C                     Z-ADDWN0012    WGSAWT           PS Weight Shipp
     C                     Z-ADDWN0013    WGB9NB           PS Pieces Shipp
     C                     Z-ADDWN0014    WGD1WG           PS Weight Prod
     C                     Z-ADDWN0015    WGCBNB           PS Pieces Prod
     C                     Z-ADDWN0016    WGEZWG           PS Weight Inv A
     C                     Z-ADDWN0017    WGCCNB           PS Pieces Inv A
     C                     Z-ADDWN0018    WGE0WG           PS Weight Ship
     C                     Z-ADDWN0019    WGD6NB           PS Pieces Ship
     C                     Z-ADDWN0020    WGOAWT           PS Weight Prod
     C                     Z-ADDWN0021    WGCDNB           PS Pieces Prod
     C                     Z-ADDWN0022    WGUNW2           PS Weight Inv A
     C                     Z-ADDWN0023    WGCENB           PS Pieces Inv A
     C                     Z-ADDWAAIWG    WGF9WG           PS Unit Weight
     C                     Z-ADDWN0025    WGBPNB           PS Pieces Whse
     C                     Z-ADDWN0026    WGGAWG           PS Weight Whse
     C                     Z-ADDWN0027    WGBQNB           PS Pieces Unuse
     C                     Z-ADDWN0028    WGGBWG           PS Weight Unuse
     C                     Z-ADDWN0029    WGBRNB           PS Pieces Unuse
     C                     Z-ADDWN0030    WGGCWG           PS Weight Unuse
     C                     Z-ADDWN0031    WGBSNB           PS Pieces Unuse
     C                     Z-ADDWN0032    WGGDWG           PS Weight Unuse
     C                     Z-ADDWN0033    WGBWNB           PS Pieces Unuse
     C                     Z-ADDWN0034    WGGEWG           PS Weight Unuse
     C                     Z-ADDWN0035    WGPS6U           PS Pieces Unuse
     C                     MOVELWN0036    WGWCST           PS Item Id
     C                     MOVELWN0076    WGWPST           Warehouse Type
     C                     MOVELWN0038    WGB5ST           PS Lock Status
     C                     MOVELWASUST    WGTFST           PS Export/Domes
     C                     MOVELWASVST    WGTEST           PS Print On Sch
     C                     MOVELWAPCCT    WGTHST           PS Piece Count
     C                     MOVELWN0039    WGUDST           PS Unused Sts 1
     C                     MOVELWN0040    WGUFST           PS Unused Sts 2
     C                     MOVELWN0041    WGUGST           PS Unused Sts 3
     C                     MOVELWN0042    WGUHST           PS Unused Sts 4
     C                     MOVELWN0043    WGB6ST           PS Item Sched N
     C                     MOVELYL0002    WGB7ST           PS Production W
     C                     Z-ADDWN0045    WGDVWG           PS Weight Order
     C                     Z-ADDWN0046    WGD7NB           PS Pieces Order
     C                     Z-ADDWN0047    WGFCAD           PS Weight FC Ad
     C                     Z-ADDWN0048    WGD9NB           PS Pieces FC Ad
     C                     Z-ADDWN0049    WGDWWG           PS Weight FX Ad
     C                     Z-ADDWN0050    WGEANB           PS Pieces FX Ad
     C                     Z-ADDWN0051    WGSHWT           PS Weight Sched
     C                     Z-ADDWN0052    WGEBNB           PS Pieces Sched
     C                     Z-ADDWN0053    WGAVWT           PS Weight Avail
     C                     Z-ADDWN0054    WGECNB           PS Pieces Avail
     C                     Z-ADDWN0055    WGWTON           PS Weight Produ
     C                     Z-ADDWN0056    WGEDNB           PS Pieces Produ
     C                     Z-ADDWN0057    WGFNWT           PS Weight Fab N
     C                     Z-ADDWN0058    WGEENB           PS Pieces Fab N
     C                     Z-ADDWN0059    WGQTAS           PS Weight Sched
     C                     Z-ADDWN0060    WGEFNB           PS Pieces Sched
     C                     Z-ADDWN0061    WGWAIO           PS Weight Sched
     C                     Z-ADDWN0062    WGEGNB           PS Pieces Sched
     C                     MOVELWAR3CD    WGR3CD           Department Code
     C                     Z-ADDWARGNB    WGRGNB           Item Structure
     C                     Z-ADDWARHNB    WGRHNB           Item Structure
     C                     Z-ADDWARINB    WGRINB           Item Structure
     C                     MOVELWAXRCD    WGXRCD           Primal Group Co
     C                     MOVELWN0067    WGUVST           EDI Status 1
     C                     MOVELWN0068    WGUWST           EDI Status 2
     C                     MOVELWN0069    WGUXST           EDI Status 3
     C                     MOVELWN0070    WGVSST           Record Status
     C                     Z-ADDWN0071    WGAATM           Job Time
     C                     MOVELWN0072    WGAYNA           User Id
     C                     MOVELWN0073    WGA0NA           Job Name
     C                     Z-ADDWN0074    WGAXDT           Job Date
      *
      * USER: Processing before Data update
      * UPS CRTOBJ Stamp      IF
     C                     MOVEL'A'       WGVSST           Record Status
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##PGM     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
     C                     MOVEL'N'       WGB5ST           PS Lock Status
     C           KLCRSG    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGV5ST           Production Type
     C                     KFLD           WGELDT           Production Date
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
      * Check for duplicate primary key
     C           KLCRSG    SETLL@I8CPUR                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1764' W0RTN   7
      * USER: Processing if Data record already exists
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C                     WRITE@I8CPUR                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * DOC:  Change Log
      *================================================================
      * 04/10/07 Effective 04/23/07 representation of Age Code changes
      *          will be such that Age Code A will be 0 day for boxes
      *          and combos.  The labels on the cartons will not print
      *          a date that is offset by Sunday or Holiday.  Instead of
      *          Code Date, it will be the Pack Date.
      * 06/15/09 PKD FP1054 Skip Sunday's as Available Ship Date.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Initialise indicators for re-entry
     C                     MOVE '0'       *IN
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAIWG           Unit Weight
     C                     Z-ADD*ZERO     WACZWG           Minimum Weight
     C                     Z-ADD*ZERO     WAC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WAURTN           Number Cases On
     C                     Z-ADD*ZERO     WAAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WATFNB           Transportation
     C                     Z-ADD*ZERO     WATMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WATNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WABLPR           Market Overage
     C                     Z-ADD*ZERO     WABMPR           Standard Overag
     C                     Z-ADD*ZERO     WACMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WACHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WASWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WAPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WAICN1           Item Category N
     C                     Z-ADD*ZERO     WAICN2           Item Category N
     C                     Z-ADD*ZERO     WAV2NB           Item Category N
     C                     Z-ADD*ZERO     WAITCN           Item Category N
     C                     Z-ADD*ZERO     WAITC5           Item Category N
     C                     Z-ADD*ZERO     WAICN6           Item Category N
     C                     Z-ADD*ZERO     WAICN7           Item Category N
     C                     Z-ADD*ZERO     WAICN8           Item Category N
     C                     Z-ADD*ZERO     WAICN9           Item Category N
     C                     Z-ADD*ZERO     WAICN0           Item Category N
     C                     Z-ADD*ZERO     WASFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WAA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WASJNB           Production Lead
     C                     Z-ADD*ZERO     WASKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WASLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WASMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WACFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WACGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WAILNB           PM % 2nds Facto
     C                     Z-ADD*ZERO     WACHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WACINB           PM Batch Size
     C                     Z-ADD*ZERO     WACJNB           PM Lot Size
     C                     Z-ADD*ZERO     WACMNB           Partial Item Co
     C                     Z-ADD*ZERO     WACNNB           WIP Item Code
     C                     Z-ADD*ZERO     WACRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WACSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WACVNB           FP Std Green We
     C                     Z-ADD*ZERO     WACWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WACXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WACZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WAC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WAB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WAB5NB           PM Line Number
     C                     Z-ADD*ZERO     WABDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WABJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WAF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WAF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WAF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WABLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WABNNB           Production Qty
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WBAECS           Last Cost
     C                     Z-ADD*ZERO     WBBACS           Cost per Primar
     C                     Z-ADD*ZERO     WBBBCS           Cost per Pricin
     C                     Z-ADD*ZERO     WBCBPR           Revaluation Cos
     C                     Z-ADD*ZERO     WBGUDT           Revaluation Eff
     C                     Z-ADD*ZERO     WBCTPR           Last Revaluatio
     C                     Z-ADD*ZERO     WBG4DT           Last Revaluatio
     C                     Z-ADD*ZERO     WBBOWG           On Hand Weight
     C                     Z-ADD*ZERO     WBDDQT           On Hand U/M1 Su
     C                     Z-ADD*ZERO     WBDEQT           On Hand U/M2 Su
     C                     Z-ADD*ZERO     WBDFQT           On Hand U/M3 Su
     C                     Z-ADD*ZERO     WBHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WBHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WBAJQT           Quantity Schedu
     C                     Z-ADD*ZERO     WBAQQT           Quantity on Sal
     C                     Z-ADD*ZERO     WBAUQT           Quantity on Pur
     C                     Z-ADD*ZERO     WBEMQT           Quantity on Tra
     C                     Z-ADD*ZERO     WBDOQT           Quantity Avail.
     C                     Z-ADD*ZERO     WBAKDT           Date of Last Or
     C                     Z-ADD*ZERO     WBANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WBIDVA           Value of On Han
     C                     Z-ADD*ZERO     WBBZPC           Safety Allowanc
     C                     Z-ADD*ZERO     WBDGQT           Safety Allowanc
     C                     Z-ADD*ZERO     WBDIDT           Stock Out Date
     C                     Z-ADD*ZERO     WBBFDY           Lead Time - Las
     C                     Z-ADD*ZERO     WBDJDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WBBGDY           Lead Time - Nex
     C                     Z-ADD*ZERO     WBDKDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WBDJQT           Usage Qty per C
     C                     Z-ADD*ZERO     WBBNWG           Usage Weight pe
     C                     Z-ADD*ZERO     WBDLDT           Inventory Manag
     C                     Z-ADD*ZERO     WBDPQT           Minimum Quantit
     C                     Z-ADD*ZERO     WBDQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WBDMDT           Last Physical C
     C                     Z-ADD*ZERO     WBAKC8           Vendor - Item/W
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WCBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WCBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WCBUC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WCBVC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDM8NB           System Value Nu
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEBCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WECQNB           Julian Date
     C                     Z-ADD*ZERO     WEESNB           Accounting Year
     C                     Z-ADD*ZERO     WEETNB           Accounting Peri
     C                     Z-ADD*ZERO     WEBZNB           OM Week
     C                     Z-ADD*ZERO     WEEINB           Week Number
     C                     Z-ADD*ZERO     WEAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WEOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WENQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WENRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WEOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WEOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUCNTU  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGELDT           Production Date
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGGPDT           PS Available Sh
     C                     Z-ADD*ZERO     WGWTSP           PS Weight Plann
     C                     Z-ADD*ZERO     WGQTSP           PS Pieces Plann
     C                     Z-ADD*ZERO     WGDJPC           PS % of Carcass
     C                     Z-ADD*ZERO     WGF8WG           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WGWTIN           PS Weight Inv O
     C                     Z-ADD*ZERO     WGD5NB           PS Pieces Inv O
     C                     Z-ADD*ZERO     WGDXWG           PS Weight Stand
     C                     Z-ADD*ZERO     WGB2NB           PS Pieces Stand
     C                     Z-ADD*ZERO     WGWTCN           PS Weight Conve
     C                     Z-ADD*ZERO     WGPSCV           PS Pieces Conve
     C                     Z-ADD*ZERO     WGSAWT           PS Weight Shipp
     C                     Z-ADD*ZERO     WGB9NB           PS Pieces Shipp
     C                     Z-ADD*ZERO     WGD1WG           PS Weight Prod
     C                     Z-ADD*ZERO     WGCBNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WGEZWG           PS Weight Inv A
     C                     Z-ADD*ZERO     WGCCNB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WGE0WG           PS Weight Ship
     C                     Z-ADD*ZERO     WGD6NB           PS Pieces Ship
     C                     Z-ADD*ZERO     WGOAWT           PS Weight Prod
     C                     Z-ADD*ZERO     WGCDNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WGUNW2           PS Weight Inv A
     C                     Z-ADD*ZERO     WGCENB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WGF9WG           PS Unit Weight
     C                     Z-ADD*ZERO     WGBPNB           PS Pieces Whse
     C                     Z-ADD*ZERO     WGGAWG           PS Weight Whse
     C                     Z-ADD*ZERO     WGBQNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WGGBWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WGBRNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WGGCWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WGBSNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WGGDWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WGBWNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WGGEWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WGPS6U           PS Pieces Unuse
     C                     Z-ADD*ZERO     WGDVWG           PS Weight Order
     C                     Z-ADD*ZERO     WGD7NB           PS Pieces Order
     C                     Z-ADD*ZERO     WGFCAD           PS Weight FC Ad
     C                     Z-ADD*ZERO     WGD9NB           PS Pieces FC Ad
     C                     Z-ADD*ZERO     WGDWWG           PS Weight FX Ad
     C                     Z-ADD*ZERO     WGEANB           PS Pieces FX Ad
     C                     Z-ADD*ZERO     WGSHWT           PS Weight Sched
     C                     Z-ADD*ZERO     WGEBNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WGAVWT           PS Weight Avail
     C                     Z-ADD*ZERO     WGECNB           PS Pieces Avail
     C                     Z-ADD*ZERO     WGWTON           PS Weight Produ
     C                     Z-ADD*ZERO     WGEDNB           PS Pieces Produ
     C                     Z-ADD*ZERO     WGFNWT           PS Weight Fab N
     C                     Z-ADD*ZERO     WGEENB           PS Pieces Fab N
     C                     Z-ADD*ZERO     WGQTAS           PS Weight Sched
     C                     Z-ADD*ZERO     WGEFNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WGWAIO           PS Weight Sched
     C                     Z-ADD*ZERO     WGEGNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WGRGNB           Item Structure
     C                     Z-ADD*ZERO     WGRHNB           Item Structure
     C                     Z-ADD*ZERO     WGRINB           Item Structure
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Production Warehouse Code
     C                     MOVEL*BLANK    YL0001  3
      * Define null work field Accounting Company
     C                     Z-ADD*ZERO     YN0001  30
      * Define local work field PS Production Warehouse
     C                     MOVEL*BLANK    YL0002  3
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 FZNCHLTME
