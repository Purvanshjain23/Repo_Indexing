     H/TITLE Prt Load Schdlng Summ4 PF Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 06/09/22  Time  : 16:14:50
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FPDMHCPLAIF  E           K        DISK
      * RSQ : Load Schdlng Position     OCW/Dd/Ld/Stp/Itm/PS
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse Codes           Active records only
      *
     FPDMHCPL8IF  E           K        DISK
      * RSQ : Load Schdlng Position     DB1 Date/Time
      *
     FPDLLREL1IF  E           K        DISK
      * RTV : PS Primal Group           Retrieval index
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOMFFREL3IF  E           K        DISK
      * RTV : Carrier                   Active records
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier                   Retrieval index
      *
     FOPBFCPLLIF  E           K        DISK
      * RSQ : Order Header TRG          Ld(d)/Ord
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FOPBFCPLGIF  E           K        DISK
      * RSQ : Order Header TRG          Load Id/Order Num
      *
     FOMBYREL1IF  E           K        DISK
      * RTV : Item Default              Retrieval index
      *
     FOMFJCPLFIF  E           K        DISK
      * RSQ : Load Header               Whse/SchdShpDt/Load
      *
     FCAAFREL3IF  E           K        DISK
      * RSQ : Calendar                  Co/Date               NV
      *
     FPOA3REL2IF  E           K        DISK
      * RSQ : Load Slotting Sched Ctl   Co/Whse/Day  (D)
      *
     FPBCKPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Prt Load Schdlng Summ4 PF Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L3         3  1
     E                    #L7         7  1
     E                    YK01      100 11  A            ARR Load Schdln
      *
     I@ADRET1
      * Warehouse Codes           Active records only
      * Renamed input format fields
     I              ADAJCD                          WAAJCD
     I              ADF8NA                          WAF8NA
     I              ADACNA                          WAACNA
     I              ADADNA                          WAADNA
     I              ADAENA                          WAAENA
     I              ADAJNA                          WAAJNA
     I              ADBTTX                          WABTTX
     I              ADAOCD                          WAAOCD
     I              ADBGCD                          WABGCD
     I              ADVHST                          WAVHST
     I              ADMPNA                          WAMPNA
     I              ADWPST                          WAWPST
     I              ADXUST                          WAXUST
     I              ADT0ST                          WAT0ST
     I              ADT1ST                          WAT1ST
     I              ADDBNB                          WADBNB
     I              ADT2ST                          WAT2ST
     I              ADT3ST                          WAT3ST
     I              ADT4ST                          WAT4ST
     I              ADT6ST                          WAT6ST
     I              ADBWC3                          WABWC3
     I              ADBTC3                          WABTC3
     I              ADBUC3                          WABUC3
     I              ADBVC3                          WABVC3
     I              ADFCAA                          WAFCAA
     I              ADRQSX                          WARQSX
     I              ADRRSX                          WARRSX
     I              ADRSSX                          WARSSX
     I              ADRTSX                          WARTSX
     I              ADT7ST                          WAT7ST
     I              ADT8ST                          WAT8ST
     I              ADRNSX                          WARNSX
     I              ADROSX                          WAROSX
     I              ADRPSX                          WARPSX
     I              ADUVST                          WAUVST
     I              ADUWST                          WAUWST
     I              ADUXST                          WAUXST
     I              ADVSST                          WAVSST
     I              ADAATM                          WAAATM
     I              ADAYNA                          WAAYNA
     I              ADA0NA                          WAA0NA
     I              ADAXDT                          WAAXDT
      *
     I@MHCPYF
      * Load Schdlng Position     DB1 Date/Time
      * Renamed input format fields
     I              MHHGCD                          WBHGCD
     I              MHCQC3                          WBCQC3
     I              MHLQAA                          WBLQAA
     I              MHCUC3                          WBCUC3
     I              MHLUAA                          WBLUAA
     I              MHSPSQ                          WBSPSQ
     I              MHBMSX                          WBBMSX
     I              MHL7DT                          WBL7DT
     I              MHC4NB                          WBC4NB
     I              MHRMNB                          WBRMNB
     I              MHAODT                          WBAODT
     I              MHJPCD                          WBJPCD
     I              MHKBQT                          WBKBQT
     I              MHKCQT                          WBKCQT
     I              MHKHQT                          WBKHQT
     I              MHKDQT                          WBKDQT
     I              MHKEQT                          WBKEQT
     I              MHKFQT                          WBKFQT
     I              MHH1QT                          WBH1QT
     I              MHKGQT                          WBKGQT
     I              MHKZDT                          WBKZDT
     I              MHAXTM                          WBAXTM
     I              MHBOSX                          WBBOSX
     I              MHBPSX                          WBBPSX
     I              MHBQSX                          WBBQSX
     I              MHUNUS                          WBUNUS
     I              MHUNU2                          WBUNU2
     I              MHT4NB                          WBT4NB
     I              MHRVNB                          WBRVNB
     I              MHBUST                          WBBUST
     I              MHSTDT                          WBSTDT
     I              MHN5NY                          WBN5NY
     I              MHRINY                          WBRINY
     I              MHTIDT                          WBTIDT
     I              MHTJDT                          WBTJDT
     I              MHTNDT                          WBTNDT
     I              MHTODT                          WBTODT
     I              MHUVST                          WBUVST
     I              MHUWST                          WBUWST
     I              MHUXST                          WBUXST
     I              MHVSST                          WBVSST
     I              MHAATM                          WBAATM
     I              MHAYNA                          WBAYNA
     I              MHA0NA                          WBA0NA
     I              MHAXDT                          WBAXDT
      *
     I@FFREBF
      * Carrier                   Retrieval index
      * Renamed input format fields
     I              FFBZNA                          WCBZNA
     I              FFADTX                          WCADTX
     I              FFACNA                          WCACNA
     I              FFADNA                          WCADNA
     I              FFAENA                          WCAENA
     I              FFAJNA                          WCAJNA
     I              FFBTTX                          WCBTTX
     I              FFEZNB                          WCEZNB
     I              FFBGCD                          WCBGCD
     I              FFEEDT                          WCEEDT
     I              FFDUTX                          WCDUTX
     I              FFNRVA                          WCNRVA
     I              FFNSVA                          WCNSVA
     I              FFNTVA                          WCNTVA
     I              FFNUVA                          WCNUVA
     I              FFP1ST                          WCP1ST
     I              FFDVTX                          WCDVTX
     I              FFDWTX                          WCDWTX
     I              FFLVCD                          WCLVCD
     I              FFS8NB                          WCS8NB
     I              FFS9NB                          WCS9NB
     I              FFNMVA                          WCNMVA
     I              FFNOVA                          WCNOVA
     I              FFNPVA                          WCNPVA
     I              FFNQVA                          WCNQVA
     I              FFMFCD                          WCMFCD
     I              FFQXNB                          WCQXNB
     I              FFQ1NB                          WCQ1NB
     I              FFMRNG                          WCMRNG
     I              FFMRNE                          WCMRNE
     I              FFRFNB                          WCRFNB
     I              FFMREG                          WCMREG
     I              FFBQPR                          WCBQPR
     I              FFBRPR                          WCBRPR
     I              FFBSPR                          WCBSPR
     I              FFBTPR                          WCBTPR
     I              FFBUPR                          WCBUPR
     I              FFBVPR                          WCBVPR
     I              FFDJWG                          WCDJWG
     I              FFDKWG                          WCDKWG
     I              FFDLWG                          WCDLWG
     I              FFDMWG                          WCDMWG
     I              FFDNWG                          WCDNWG
     I              FFDOWG                          WCDOWG
     I              FFB2PR                          WCB2PR
     I              FFB3PR                          WCB3PR
     I              FFB4PR                          WCB4PR
     I              FFB5PR                          WCB5PR
     I              FFB6PR                          WCB6PR
     I              FFB7PR                          WCB7PR
     I              FFAAC7                          WCAAC7
     I              FFCOFI                          WCCOFI
     I              FFK6TX                          WCK6TX
     I              FFOCNA                          WCOCNA
     I              FFODNA                          WCODNA
     I              FFW7CD                          WCW7CD
     I              FFK7TX                          WCK7TX
     I              FFTENO                          WCTENO
     I              FFK8TX                          WCK8TX
     I              FFAOFC                          WCAOFC
     I              FFAOLI                          WCAOLI
     I              FFKHDT                          WCKHDT
     I              FFUNUS                          WCUNUS
     I              FFUNU2                          WCUNU2
     I              FFUNU3                          WCUNU3
     I              FFUVST                          WCUVST
     I              FFUWST                          WCUWST
     I              FFUXST                          WCUXST
     I              FFVSST                          WCVSST
     I              FFAATM                          WCAATM
     I              FFAYNA                          WCAYNA
     I              FFA0NA                          WCA0NA
     I              FFAXDT                          WCAXDT
      *
     I@BFCPR0
      * Order Header TRG          Ld(d)/Ord
      * Renamed input format fields
     I              BEAIC3                          WDAIC3
     I              BEC4NB                          WDC4NB
     I              BEJNCD                          WDJNCD
     I              BEANC7                          WDANC7
     I              BEBKC7                          WDBKC7
     I              BEBRTX                          WDBRTX
     I              BEHMNA                          WDHMNA
     I              BEHONA                          WDHONA
     I              BEHPNA                          WDHPNA
     I              BEHNNA                          WDHNNA
     I              BEDBCD                          WDDBCD
     I              BECKTX                          WDCKTX
     I              BEB0C7                          WDB0C7
     I              BEAETX                          WDAETX
     I              BEB1NA                          WDB1NA
     I              BEB3NA                          WDB3NA
     I              BEB4NA                          WDB4NA
     I              BEB2NA                          WDB2NA
     I              BEBHCD                          WDBHCD
     I              BEC8TX                          WDC8TX
     I              BEBCNA                          WDBCNA
     I              BEA0DT                          WDA0DT
     I              BEA5DT                          WDA5DT
     I              BEGNDT                          WDGNDT
     I              BEACDT                          WDACDT
     I              BEAQCD                          WDAQCD
     I              BEB6NA                          WDB6NA
     I              BEBYNA                          WDBYNA
     I              BEBZNA                          WDBZNA
     I              BEGTST                          WDGTST
     I              BEGVST                          WDGVST
     I              BEGUST                          WDGUST
     I              BEQFST                          WDQFST
     I              BECQCD                          WDCQCD
     I              BEGJST                          WDGJST
     I              BEGWST                          WDGWST
     I              BEGXST                          WDGXST
     I              BEGYST                          WDGYST
     I              BEAODT                          WDAODT
     I              BEAIVN                          WDAIVN
     I              BECXDT                          WDCXDT
     I              BEJZVA                          WDJZVA
     I              BEA1WG                          WDA1WG
     I              BEXIST                          WDXIST
     I              BEXJST                          WDXJST
     I              BEXKST                          WDXKST
     I              BEEIDT                          WDEIDT
     I              BEAFTM                          WDAFTM
     I              BEE8CD                          WDE8CD
     I              BEE9CD                          WDE9CD
     I              BERMNB                          WDRMNB
     I              BETBNB                          WDTBNB
     I              BER1NB                          WDR1NB
     I              BEPJST                          WDPJST
     I              BEU0ST                          WDU0ST
     I              BEU1ST                          WDU1ST
     I              BEQ2CD                          WDQ2CD
     I              BEU2ST                          WDU2ST
     I              BEVEST                          WDVEST
     I              BEVFST                          WDVFST
     I              BEVGST                          WDVGST
     I              BERPCD                          WDRPCD
     I              BERNNB                          WDRNNB
     I              BEVDST                          WDVDST
     I              BEATIN                          WDATIN
     I              BEU4ST                          WDU4ST
     I              BEU5ST                          WDU5ST
     I              BERSRN                          WDRSRN
     I              BEMHNA                          WDMHNA
     I              BEMINA                          WDMINA
     I              BEWBST                          WDWBST
     I              BER4CD                          WDR4CD
     I              BEBFCD                          WDBFCD
     I              BEQ4CD                          WDQ4CD
     I              BET3NB                          WDT3NB
     I              BESICD                          WDSICD
     I              BECONB                          WDCONB
     I              BECEST                          WDCEST
     I              BEAWDT                          WDAWDT
     I              BEJPCD                          WDJPCD
     I              BEXUST                          WDXUST
     I              BEZ1ST                          WDZ1ST
     I              BEVRVA                          WDVRVA
     I              BEOBST                          WDOBST
     I              BEBCST                          WDBCST
     I              BEBDST                          WDBDST
     I              BEB7VL                          WDB7VL
     I              BEGASX                          WDGASX
     I              BEGBSX                          WDGBSX
     I              BEGCSX                          WDGCSX
     I              BEGDSX                          WDGDSX
     I              BEFNSX                          WDFNSX
     I              BEFOSX                          WDFOSX
     I              BEFPSX                          WDFPSX
     I              BEFQSX                          WDFQSX
     I              BEFRSX                          WDFRSX
     I              BEFSSX                          WDFSSX
     I              BEFTSX                          WDFTSX
     I              BEFUSX                          WDFUSX
     I              BEFVSX                          WDFVSX
     I              BEFWSX                          WDFWSX
     I              BEFXSX                          WDFXSX
     I              BEFYSX                          WDFYSX
     I              BENODT                          WDNODT
     I              BENPDT                          WDNPDT
     I              BENQDT                          WDNQDT
     I              BENRDT                          WDNRDT
     I              BENSDT                          WDNSDT
     I              BEBPTM                          WDBPTM
     I              BEBQTM                          WDBQTM
     I              BEBRTM                          WDBRTM
     I              BEBSTM                          WDBSTM
     I              BEBTTM                          WDBTTM
     I              BEH0NX                          WDH0NX
     I              BEH1NX                          WDH1NX
     I              BEH2NX                          WDH2NX
     I              BEH3NX                          WDH3NX
     I              BEH4NX                          WDH4NX
     I              BEC0C7                          WDC0C7
     I              BEUVST                          WDUVST
     I              BEUWST                          WDUWST
     I              BEUXST                          WDUXST
     I              BEAATM                          WDAATM
     I              BEAYNA                          WDAYNA
     I              BEA0NA                          WDA0NA
     I              BEAXDT                          WDAXDT
      *
     I@BFCPRQ
      * Order Header TRG          Load Id/Order Num
      * Renamed input format fields
     I              BEAIC3                          WFAIC3
     I              BEC4NB                          WFC4NB
     I              BEJNCD                          WFJNCD
     I              BEANC7                          WFANC7
     I              BEBKC7                          WFBKC7
     I              BEBRTX                          WFBRTX
     I              BEHMNA                          WFHMNA
     I              BEHONA                          WFHONA
     I              BEHPNA                          WFHPNA
     I              BEHNNA                          WFHNNA
     I              BEDBCD                          WFDBCD
     I              BECKTX                          WFCKTX
     I              BEB0C7                          WFB0C7
     I              BEAETX                          WFAETX
     I              BEB1NA                          WFB1NA
     I              BEB3NA                          WFB3NA
     I              BEB4NA                          WFB4NA
     I              BEB2NA                          WFB2NA
     I              BEBHCD                          WFBHCD
     I              BEC8TX                          WFC8TX
     I              BEBCNA                          WFBCNA
     I              BEA0DT                          WFA0DT
     I              BEA5DT                          WFA5DT
     I              BEGNDT                          WFGNDT
     I              BEACDT                          WFACDT
     I              BEAQCD                          WFAQCD
     I              BEB6NA                          WFB6NA
     I              BEBYNA                          WFBYNA
     I              BEBZNA                          WFBZNA
     I              BEGTST                          WFGTST
     I              BEGVST                          WFGVST
     I              BEGUST                          WFGUST
     I              BEQFST                          WFQFST
     I              BECQCD                          WFCQCD
     I              BEGJST                          WFGJST
     I              BEGWST                          WFGWST
     I              BEGXST                          WFGXST
     I              BEGYST                          WFGYST
     I              BEAODT                          WFAODT
     I              BEAIVN                          WFAIVN
     I              BECXDT                          WFCXDT
     I              BEJZVA                          WFJZVA
     I              BEA1WG                          WFA1WG
     I              BEXIST                          WFXIST
     I              BEXJST                          WFXJST
     I              BEXKST                          WFXKST
     I              BEEIDT                          WFEIDT
     I              BEAFTM                          WFAFTM
     I              BEE8CD                          WFE8CD
     I              BEE9CD                          WFE9CD
     I              BERMNB                          WFRMNB
     I              BETBNB                          WFTBNB
     I              BER1NB                          WFR1NB
     I              BEPJST                          WFPJST
     I              BEU0ST                          WFU0ST
     I              BEU1ST                          WFU1ST
     I              BEQ2CD                          WFQ2CD
     I              BEU2ST                          WFU2ST
     I              BEVEST                          WFVEST
     I              BEVFST                          WFVFST
     I              BEVGST                          WFVGST
     I              BERPCD                          WFRPCD
     I              BERNNB                          WFRNNB
     I              BEVDST                          WFVDST
     I              BEATIN                          WFATIN
     I              BEU4ST                          WFU4ST
     I              BEU5ST                          WFU5ST
     I              BERSRN                          WFRSRN
     I              BEMHNA                          WFMHNA
     I              BEMINA                          WFMINA
     I              BEWBST                          WFWBST
     I              BER4CD                          WFR4CD
     I              BEBFCD                          WFBFCD
     I              BEQ4CD                          WFQ4CD
     I              BET3NB                          WFT3NB
     I              BESICD                          WFSICD
     I              BECONB                          WFCONB
     I              BECEST                          WFCEST
     I              BEAWDT                          WFAWDT
     I              BEJPCD                          WFJPCD
     I              BEXUST                          WFXUST
     I              BEZ1ST                          WFZ1ST
     I              BEVRVA                          WFVRVA
     I              BEOBST                          WFOBST
     I              BEBCST                          WFBCST
     I              BEBDST                          WFBDST
     I              BEB7VL                          WFB7VL
     I              BEGASX                          WFGASX
     I              BEGBSX                          WFGBSX
     I              BEGCSX                          WFGCSX
     I              BEGDSX                          WFGDSX
     I              BEFNSX                          WFFNSX
     I              BEFOSX                          WFFOSX
     I              BEFPSX                          WFFPSX
     I              BEFQSX                          WFFQSX
     I              BEFRSX                          WFFRSX
     I              BEFSSX                          WFFSSX
     I              BEFTSX                          WFFTSX
     I              BEFUSX                          WFFUSX
     I              BEFVSX                          WFFVSX
     I              BEFWSX                          WFFWSX
     I              BEFXSX                          WFFXSX
     I              BEFYSX                          WFFYSX
     I              BENODT                          WFNODT
     I              BENPDT                          WFNPDT
     I              BENQDT                          WFNQDT
     I              BENRDT                          WFNRDT
     I              BENSDT                          WFNSDT
     I              BEBPTM                          WFBPTM
     I              BEBQTM                          WFBQTM
     I              BEBRTM                          WFBRTM
     I              BEBSTM                          WFBSTM
     I              BEBTTM                          WFBTTM
     I              BEH0NX                          WFH0NX
     I              BEH1NX                          WFH1NX
     I              BEH2NX                          WFH2NX
     I              BEH3NX                          WFH3NX
     I              BEH4NX                          WFH4NX
     I              BEC0C7                          WFC0C7
     I              BEUVST                          WFUVST
     I              BEUWST                          WFUWST
     I              BEUXST                          WFUXST
     I              BEAATM                          WFAATM
     I              BEAYNA                          WFAYNA
     I              BEA0NA                          WFA0NA
     I              BEAXDT                          WFAXDT
      *
     I@FJCPN3
      * Load Header               Whse/SchdShpDt/Load
      * Renamed input format fields
     I              FJRMNB                          WGRMNB
     I              FJAIC3                          WGAIC3
     I              FJAODT                          WGAODT
     I              FJPJST                          WGPJST
     I              FJPKST                          WGPKST
     I              FJRNNB                          WGRNNB
     I              FJDMTX                          WGDMTX
     I              FJDNTX                          WGDNTX
     I              FJDOTX                          WGDOTX
     I              FJWTTX                          WGWTTX
     I              FJWUTX                          WGWUTX
     I              FJRPNB                          WGRPNB
     I              FJFLAM                          WGFLAM
     I              FJXQST                          WGXQST
     I              FJRRNB                          WGRRNB
     I              FJDXTX                          WGDXTX
     I              FJDYTX                          WGDYTX
     I              FJSBNB                          WGSBNB
     I              FJBZNA                          WGBZNA
     I              FJRONB                          WGRONB
     I              FJSQNB                          WGSQNB
     I              FJR1NB                          WGR1NB
     I              FJVCST                          WGVCST
     I              FJVDST                          WGVDST
     I              FJSDNB                          WGSDNB
     I              FJPAOU                          WGPAOU
     I              FJDGWG                          WGDGWG
     I              FJSXNB                          WGSXNB
     I              FJHADT                          WGHADT
     I              FJAART                          WGAART
     I              FJDHWG                          WGDHWG
     I              FJDIWG                          WGDIWG
     I              FJAQDT                          WGAQDT
     I              FJS6NB                          WGS6NB
     I              FJT4NB                          WGT4NB
     I              FJPRTM                          WGPRTM
     I              FJNPSV                          WGNPSV
     I              FJJ8TX                          WGJ8TX
     I              FJTLMI                          WGTLMI
     I              FJJ9TX                          WGJ9TX
     I              FJQ2CD                          WGQ2CD
     I              FJVPCD                          WGVPCD
     I              FJDBCD                          WGDBCD
     I              FJGRWE                          WGGRWE
     I              FJXCCD                          WGXCCD
     I              FJU2ST                          WGU2ST
     I              FJF9DT                          WGF9DT
     I              FJONTM                          WGONTM
     I              FJJ4DT                          WGJ4DT
     I              FJTRTM                          WGTRTM
     I              FJJ5DT                          WGJ5DT
     I              FJSPTM                          WGSPTM
     I              FJJ6DT                          WGJ6DT
     I              FJLFTM                          WGLFTM
     I              FJJ7DT                          WGJ7DT
     I              FJBOTM                          WGBOTM
     I              FJJ8DT                          WGJ8DT
     I              FJBLTM                          WGBLTM
     I              FJKIDT                          WGKIDT
     I              FJASTM                          WGASTM
     I              FJKADT                          WGKADT
     I              FJAJCM                          WGAJCM
     I              FJXACD                          WGXACD
     I              FJOANA                          WGOANA
     I              FJK4TX                          WGK4TX
     I              FJVOAG                          WGVOAG
     I              FJKBDT                          WGKBDT
     I              FJNBBO                          WGNBBO
     I              FJW4CD                          WGW4CD
     I              FJEFDT                          WGEFDT
     I              FJCNTN                          WGCNTN
     I              FJKCDT                          WGKCDT
     I              FJTMIN                          WGTMIN
     I              FJKDDT                          WGKDDT
     I              FJVMNB                          WGVMNB
     I              FJOCFR                          WGOCFR
     I              FJKJDT                          WGKJDT
     I              FJATTM                          WGATTM
     I              FJOTRS                          WGOTRS
     I              FJRNST                          WGRNST
     I              FJBRBK                          WGBRBK
     I              FJEIDT                          WGEIDT
     I              FJRMST                          WGRMST
     I              FJAJCD                          WGAJCD
     I              FJKKDT                          WGKKDT
     I              FJAVTM                          WGAVTM
     I              FJKZDT                          WGKZDT
     I              FJAXTM                          WGAXTM
     I              FJLHOS                          WGLHOS
     I              FJLHOR                          WGLHOR
     I              FJWNTX                          WGWNTX
     I              FJOITX                          WGOITX
     I              FJOJTX                          WGOJTX
     I              FJLLDT                          WGLLDT
     I              FJLSHG                          WGLSHG
     I              FJYPST                          WGYPST
     I              FJK0DT                          WGK0DT
     I              FJAYTM                          WGAYTM
     I              FJKNNX                          WGKNNX
     I              FJICWG                          WGICWG
     I              FJIDWG                          WGIDWG
     I              FJH9SX                          WGH9SX
     I              FJWOTX                          WGWOTX
     I              FJK1DT                          WGK1DT
     I              FJAZTM                          WGAZTM
     I              FJK2DT                          WGK2DT
     I              FJA0TM                          WGA0TM
     I              FJROST                          WGROST
     I              FJRPST                          WGRPST
     I              FJRQST                          WGRQST
     I              FJRRST                          WGRRST
     I              FJZBVA                          WGZBVA
     I              FJWPTX                          WGWPTX
     I              FJWQTX                          WGWQTX
     I              FJWRTX                          WGWRTX
     I              FJWSTX                          WGWSTX
     I              FJRVSX                          WGRVSX
     I              FJRUSX                          WGRUSX
     I              FJRWSX                          WGRWSX
     I              FJRXSX                          WGRXSX
     I              FJRYSX                          WGRYSX
     I              FJRZSX                          WGRZSX
     I              FJR0SX                          WGR0SX
     I              FJR1SX                          WGR1SX
     I              FJR2SX                          WGR2SX
     I              FJR3SX                          WGR3SX
     I              FJR4SX                          WGR4SX
     I              FJPYDT                          WGPYDT
     I              FJCKTM                          WGCKTM
     I              FJPZDT                          WGPZDT
     I              FJCLTM                          WGCLTM
     I              FJP0DT                          WGP0DT
     I              FJCMTM                          WGCMTM
     I              FJP1DT                          WGP1DT
     I              FJCNTM                          WGCNTM
     I              FJP2DT                          WGP2DT
     I              FJCOTM                          WGCOTM
     I              FJP3DT                          WGP3DT
     I              FJCQTM                          WGCQTM
     I              FJUVST                          WGUVST
     I              FJUWST                          WGUWST
     I              FJUXST                          WGUXST
     I              FJAATM                          WGAATM
     I              FJAYNA                          WGAYNA
     I              FJA0NA                          WGA0NA
     I              FJAXDT                          WGAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IYD01        DS
     I                                        1   6 YI0101
     I                                        7  110YI01
      *
     IYM01        DS                        100
     I                                        1   6 WEXRCD
     I                                        7  152WESZQT
      *
     IYW01        DS
     I                                        1   6 XAXRCD
     I                                        7  152XASZQT
      *
      * Outward parameters
     IPARC        DS                              8
      * KEY : Order Header TRG          Load Exports
      * I : RST Load ID
     I                                    P   1   40PARMNB
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  LSP Accounting Co
     I                                    P   1   20P1CQC3
     IP2PARM      DS
      * I :  LSP Prodution Warehouse
     I                                        1   3 P2LQAA
     IP3PARM      DS
      * FLD: Load Schdlng Position
      * I : MAP LSP Order Company
     I                                    P   1   20P3CUC3
     IP4PARM      DS
      * FLD: *Arrays
      * I :  From Date             USR
     I                                    P   1   40P4L9DT
      * I :  To Date               USR
     I                                    P   5   80P4MADT
      * I :  From Load ID  USR
     I                                    P   9  120P4HQNX
      * I :  To Load ID  USR
     I                                    P  13  160P4HRNX
      * I :  Export Status
     I                                       17  17 P4U2ST
      * I :  U/M - Load Scheduling USR
     I                                       18  19 P4FGSX
      * I :  Load Grade
     I                                       20  20 P4BPSX
      * I :  Untied Orders Flag USR
     I                                       21  21 P4FHSX
      * I :  Primal Group Code
     I                                       22  27 P4XRCD
     IP5PARM      DS
      * N :  Export Status Dft
     I                                        1   1 P5CXST
     IP6PARM      DS
      * N :  USR Unit of Measure
     I                                        1   2 P6ODCD
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1CQC3    PARM           WP0001  30       LSP Accounting
     C           P2LQAA    PARM           WP0002  3        LSP Prodution W
     C           P3CUC3    PARM           WP0003  30       LSP Order Compa
     C           P4L9DT    PARM           WP0004  70       From Date
     C           P4MADT    PARM           WP0005  70       To Date
     C           P4HQNX    PARM           WP0006  70       From Load ID  U
     C           P4HRNX    PARM           WP0007  70       To Load ID  USR
     C           P4U2ST    PARM           WP0008  1        Export Status
     C           P4FGSX    PARM           WP0009  2        U/M - Load Sche
     C           P4BPSX    PARM           WP0010  1        Load Grade
     C           P4FHSX    PARM           WP0011  1        Untied Orders F
     C           P4XRCD    PARM           WP0012  6        Primal Group Co
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prt Load Schdlng Summ4 PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$GENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Prt Load Schdlng Summ4 PF: Mainline
      *================================================================
      * Establish starting position
     C           *LOVAL    SETLL@MHCPY7                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
      * USER: Null report processing
      * CLC Set for Null Rpt   US - /UT User Source  * 
     C                     MOVEL'Y'       W0AP1P
     C                     MOVEL'Y'       W0NEWP
     C                     MOVEL'Y'       WUTIST           USR Display 1
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        LSP Order Compa
     C                     MOVEL'Y'       W0AL01  1        Deadline Depart
     C                     MOVEL'Y'       W0AL02  1        Deadline Depart
     C                     MOVEL'Y'       W0AL03  1        Load ID
     C                     MOVEL'Y'       W0AL04  1        Stop/Drop
     C                     MOVEL'Y'       W0AL05  1        Item Code
     C                     MOVEL'Y'       W0AL06  1        Process Sequenc
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Load key header format
     C                     Z-ADD*ZERO     $CAIC3           Company Number
     C                     MOVEL*BLANK    $CADTX           Name
     C                     Z-ADD*ZERO     $CL9DT           From Date
     C                     Z-ADD*ZERO     $CMADT           To Date
     C                     MOVEL*BLANK    $CAJCD           Warehouse Code
     C                     MOVEL*BLANK    $CO6NA           Warehouse Desc
     C                     Z-ADD*ZERO     $CHQNX           From Load ID  U
     C                     Z-ADD*ZERO     $CHRNX           To Load ID  USR
     C                     MOVEL*BLANK    $CU2ST           Export Status
     C                     MOVEL*BLANK    $CFGSX           U/M - Load Sche
     C                     Z-ADD*ZERO     $CRADT           Job Date Usr
     C                     Z-ADD*ZERO     $CDHTM           Job Time User
     C                     MOVEL*BLANK    $CBPSX           Load Grade
     C                     MOVEL*BLANK    $CFHSX           Untied Orders F
      * Load related totals format
     C                     MOVEL*BLANK    $FULTX           Day of the Week
     C                     Z-ADD*ZERO     $FBINX           Combo Load Limi
     C                     Z-ADD*ZERO     $FNWNX           Slot Limit for
     C                     Z-ADD*ZERO     $FIUNX           Export Load Lim
     C                     Z-ADD*ZERO     $FNVNX           Slot Limit for
     C                     Z-ADD*ZERO     $FBHNX           Box Load Limit
     C                     Z-ADD*ZERO     $FNXNX           Slot Limit for
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDMHCQC3    $DCQC3           LSP Accounting
     C                     MOVELMHLQAA    $DLQAA           LSP Prodution W
     C                     Z-ADDMHCUC3    $DCUC3           LSP Order Compa
     C                     Z-ADDMHRMNB    $DRMNB           Load ID
     C                     MOVELMHBPSX    $DBPSX           Load Grade
     C                     MOVEL*BLANK    $DDXTX           Trailer Id
     C                     Z-ADD*ZERO     $DKKDT           On Yard Date
     C                     Z-ADD*ZERO     $DAVTM           On Yard Time
     C                     Z-ADD*ZERO     $DT4TM           USR Time 4.0
     C                     MOVEL*BLANK    $DBZNA           Carrier Code
     C                     MOVEL*BLANK    $DADTX           Name
     C                     MOVEL*BLANK    $DWMTX           @Text 15
     C                     MOVEL*BLANK    $DBRTX           Ship To Name
     C                     MOVEL*BLANK    $DDCU1           Text USR 15
     C                     Z-ADD*ZERO     $DSSDT           USR Sched Ship
     C                     Z-ADD*ZERO     $DYANB           Deadline Depart
     C                     Z-ADD*ZERO     $DOTNB           USR Deadline De
     C                     Z-ADD*ZERO     $DCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     $DP0DT           LPT Load Plan S
     C                     Z-ADDMHKZDT    $DKZDT           Deadline Depart
     C                     Z-ADD*ZERO     $DXRDT           Deadline Depart
     C                     Z-ADD*ZERO     $DEQTM           Deadline Depart
     C                     Z-ADDMHAXTM    $DAXTM           Deadline Depart
     C                     Z-ADDMHT4NB    $DT4NB           Schedule Sequen
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP03  1
     C                     END
      *
     C           W0AL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP04  1
     C                     END
      *
     C           W0AL05    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP05  1
     C                     END
      *
     C           W0AL06    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP06  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     MOVEL*BLANK    $ED6C7           Customer Name D
     C                     MOVEL*BLANK    $EPAT1           SCAC Code
     C                     Z-ADDMHSTDT    $ESTDT           LSP Production
     C                     Z-ADDMHN5NY    $EN5NY           Process Sequenc
     C                     Z-ADDMHRINY    $ERINY           Item Age Days
     C                     Z-ADDMHTIDT    $ETIDT           Production Ovr
     C                     Z-ADDMHTJDT    $ETJDT           Production Ovr
     C                     MOVEL*BLANK    $EGGST           USR Display fie
     C                     Z-ADDMHRVNB    $ERVNB           Stop/Drop
     C                     Z-ADDMHHGCD    $EHGCD           Item Code
     C                     Z-ADDMHCQC3    $ECQC3           LSP Accounting
     C                     MOVELMHLQAA    $ELQAA           LSP Prodution W
     C                     Z-ADDMHCUC3    $ECUC3           LSP Order Compa
     C                     MOVELMHLUAA    $ELUAA           LSP Order Wareh
     C                     MOVELMHBOSX    $EBOSX           Order Grade
     C                     Z-ADDMHH1QT    $EH1QT           Scheduled Quant
     C                     Z-ADDMHKGQT    $EKGQT           Scheduling Posi
     C                     Z-ADDMHTNDT    $ETNDT           Production AgeD
     C                     Z-ADDMHTODT    $ETODT           Production AgeD
     C                     MOVELMHBUST    $EBUST           LSP Order Aged
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN MHCUC3    WZA001           LSP Order Compa
     C                     Z-ADDMHCUC3    WZA001
     C           *LIKE     DEFN MHKZDT    WZA002           Deadline Depart
     C                     Z-ADDMHKZDT    WZA002
     C           *LIKE     DEFN MHAXTM    WZA003           Deadline Depart
     C                     Z-ADDMHAXTM    WZA003
     C           *LIKE     DEFN MHRMNB    WZA004           Load ID
     C                     Z-ADDMHRMNB    WZA004
     C           *LIKE     DEFN MHRVNB    WZA005           Stop/Drop
     C                     Z-ADDMHRVNB    WZA005
     C           *LIKE     DEFN MHHGCD    WZA006           Item Code
     C                     Z-ADDMHHGCD    WZA006
     C           *LIKE     DEFN MHN5NY    WZA007           Process Sequenc
     C                     Z-ADDMHN5NY    WZA007
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C                     READ @MHCPY7                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * LSP Accounting Co selection
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.LSP Accounting Co EQ DB1.LSP Accounting Co
      *   |- c2    : PAR.LSP Accounting Co EQ DB1.LSP Order Company
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1CQC3    IFEQ MHCQC3                     *IF
     C           P1CQC3    IFEQ MHCUC3                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: PAR.LSP Prodution Warehouse NE DB1.LSP Order Warehouse
     C           P2LQAA    IFNE MHLUAA                     *IF
      * CASE: DB1.Multiple Warehouses is Multiple Warehouses f/Ld
     C           MHBQSX    IFEQ 'M'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.LSP Accounting Co NE DB1.LSP Accounting Co
      *   |- c2    : PAR.LSP Accounting Co EQ DB1.LSP Order Company
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1CQC3    IFNE MHCQC3                     *IF
     C           P1CQC3    IFEQ MHCUC3                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Warehouse selection
      * CASE: DB1.Multiple Warehouses is Multiple Warehouses f/Ld
     C           MHBQSX    IFEQ 'M'                        *IF
      * CASE: LCL.Warehouse Type is Frozen
     C           YL0001    IFEQ 'FZ'                       *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Order tied to a load.
     C                     EXSR UASUBR                     Order tied to a
      * Scheduled Ship Date Selection.
     C                     EXSR UDSUBR                     Scheduled Ship
      * Load ID Selection.
     C                     EXSR UESUBR                     Load ID Selecti
      * Export Status Selection.
     C                     EXSR UFSUBR                     Export Status S
      * Unit of Measure Selection.
     C                     EXSR UGSUBR                     Unit of Measure
      * Load Grade Selection.
     C                     EXSR UHSUBR                     Load Grade Sele
      * 11/13/19 DN S15765-Select By Primal Group Code.
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE:
      *  - NOTc1
      *   |- c1    : PAR.Primal Group Code is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P4XRCD    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * DEL Load Schdlng Summ  DL - *Arrays  * 
     C                     EXSR SQDLRC
      * Bld ARR Load Schdlng SmRT - Order Header TRG  * Build Array
     C                     EXSR SRRVGN
     C                     MOVEL*BLANK    YL0009           Primal Group Co
      * RTV Load Schdlng Summ  RT - *Arrays  * DESC by Tot Qty Ordered
     C                     EXSR SXRVGN
      * 1st Record Matches Primal Code User Selected?
      * CASE: PAR.Primal Group Code EQ LCL.Primal Group Code USR
     C           P4XRCD    IFEQ YL0010                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        LSP Order Compa
     C                     MOVEL*BLANK    W0AL01  1        Deadline Depart
     C                     MOVEL*BLANK    W0AL02  1        Deadline Depart
     C                     MOVEL*BLANK    W0AL03  1        Load ID
     C                     MOVEL*BLANK    W0AL04  1        Stop/Drop
     C                     MOVEL*BLANK    W0AL05  1        Item Code
     C                     MOVEL*BLANK    W0AL06  1        Process Sequenc
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        LSP Order Compa
     C                     MOVEL'Y'       W0AL01  1        Deadline Depart
     C                     MOVEL'Y'       W0AL02  1        Deadline Depart
     C                     MOVEL'Y'       W0AL03  1        Load ID
     C                     MOVEL'Y'       W0AL04  1        Stop/Drop
     C                     MOVEL'Y'       W0AL05  1        Item Code
     C                     MOVEL'Y'       W0AL06  1        Process Sequenc
     C                     ELSE
      * Next record - Detect level breaks
     C           MHCUC3    IFNE WZA001                     LSP Order Compa
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           MHKZDT    IFNE WZA002                     Deadline Depart
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           MHAXTM    IFNE WZA003                     Deadline Depart
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C           MHRMNB    IFNE WZA004                     Load ID
     C           W0AL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL03
     C                     END
     C           MHRVNB    IFNE WZA005                     Stop/Drop
     C           W0AL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL04
     C                     END
     C           MHHGCD    IFNE WZA006                     Item Code
     C           W0AL04    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL05
     C                     END
     C           MHN5NY    IFNE WZA007                     Process Sequenc
     C           W0AL05    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL06
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL06    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP06
     C                     END
      *
     C           W0AL05    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP05
     C                     END
      *
     C           W0AL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP04
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP03
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of final totals format
      * RTV Limit Loads f/Slot RT - Load Header  * 
     C                     EXSR SYRVGN
      * CASE: LCL.Warehouse Type is Fresh
     C           YL0001    IFEQ 'FR'                       *IF
      * ** Rtv week day name, rst on day of week for limits   E000233
      * RTV Day and Week No.   RT - Calendar  * 
     C                     EXSR TBRVGN
      * CUR.Day of the Week USR = Condition name of LCL.Day of Week
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1159101   Y2LSNO  70       List number
     C                     PARM YL0020    W0INVL 25        Day of Week
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $FULTX    PARM           W0CNNM 25        Day of the Week
      *
      * Rtv Load Slotting Sch RT - Load Slotting Sched Ctl  * 
     C                     EXSR TCRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD999       $FNWNX           Slot Limit for
     C                     Z-ADD999       $FNXNX           Slot Limit for
     C                     Z-ADD999       $FNVNX           Slot Limit for
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 7
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$FFINTTL
     C                     END
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of Prt Load Schdlng Summ4 PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Prt Load Schdlng Summ4 PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
     C                     MOVEL'0'       *IN79
     C           WUTIST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$C1STPAG
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print LSP Order Company of Prt Load Schdlng Summ4 PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE 'P'       W0AP00
     C                     END                             FI
      * Print Deadline Departure Date of Prt Load Schdlng Summ4 PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print Deadline Departure Time of Prt Load Schdlng Summ4 PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print Load ID of Prt Load Schdlng Summ4 PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP03    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Load ID format
      * 12/31/14 CGL E3780 Load Scheduling Position Reports enhancement
      * 06/09/22 DN W100270-Added Deadline Departure Date/Time User Field
      *   & get LPT Load Plan Start Date & Time.
      * RTV Load All Fields    RT - Load Header  * 
     C                     EXSR SHRVGN
      * RTV Active Carr Name   RT - Carrier  * 
     C                     EXSR SIRVGN
     C                     MOVEL$DADTX    $DWMTX           @Text 15
      * RTV Ship To Name       RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1CQC3    WL0003           Company Number
     C                     Z-ADDMHC4NB    WL0004           Order Number
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    $DBRTX    P      Ship To Name
     C                     MOVEL$DBRTX    $DDCU1           Text USR 15
     C           $DAVTM    DIV  100       $DT4TM           USR Time 4.0
     C                     MOVE MHAODT    $DSSDT           USR Sched Ship
      * 06/09/22 DN W100270-Commented Out Old Way to Populate Deadline De
      * 06/09/22 DN W100270-New Way to Populate Deadline Departure Date/T
      * CASE: *OTHERWISE
      * NOTE: Fields 'Deadline Departure MM/DD' & 'USR Deadline Deprt Tim
      *       is the actual Load Plan Start Date & Time.
     C                     MOVE $DP0DT    $DYANB           Deadline Depart
     C           $DCMTM    DIV  100       $DOTNB           USR Deadline De
     C                     Z-ADD*ZERO     YL0002           Stop/Drop
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert On Yard Date to display format
      * Convert date
     C           1000000   ADD  $DKKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDKKDT
      * Convert Deadline Departure Date U to display format
      * Convert date
     C           1000000   ADD  $DXRDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDXRDT
      * Print format
     C                     WRITE$DKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP03
     C                     END                             FI
      * Print Stop/Drop of Prt Load Schdlng Summ4 PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP04
     C                     END                             FI
      * Print Item Code of Prt Load Schdlng Summ4 PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP05    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP05    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP05
     C                     END                             FI
      * Print Process Sequence of Prt Load Schdlng Summ4 PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP06    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP06    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP06
     C                     END                             FI
      * Print Detail line. of Prt Load Schdlng Summ4 PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * CASE: WRK.First time flag 2     USR is Yes
     C           WUFTFG    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUFTFG           First time flag
     C                     END                             *FI
      * Check for change in Stop/Drop number
      * CASE: DB1.Stop/Drop NE LCL.Stop/Drop
     C           MHRVNB    IFNE YL0002                     *IF
     C                     MOVEL'Y'       $EGGST           USR Display fie
     C                     Z-ADDMHRVNB    YL0002           Stop/Drop
      * RTV Ship To Name       RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDMHCUC3    WL0003           Company Number
     C                     Z-ADDMHC4NB    WL0004           Order Number
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    $ED6C7    P      Ship To Name
      * RTV Carrier Code       RT - Load Header  * 
     C                     EXSR SKRVGN
      * RTV Carrier Name       RT - Carrier  * 
     C                     EXSR SLRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       $EGGST           USR Display fie
     C                     MOVEL*BLANK    $ED6C7           Customer Name D
     C                     MOVEL*BLANK    $EPAT1           SCAC Code
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $EHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$EHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VEHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VEHGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Production AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  $ETNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VETNDT
      * Convert Production AgeDte To to display format
      * Convert date
     C           1000000   ADD  $ETODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VETODT
     C                     MOVEL'0'       *IN79
     C           $EGGST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$ECOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$EDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of Prt Load Schdlng Summ4 PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * LSP Order Company of Prt Load Schdlng Summ4 PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Deadline Departure Date of Prt Load Schdlng Summ4 PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Deadline Departure Time of Prt Load Schdlng Summ4 PF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Load ID of Prt Load Schdlng Summ4 PF
     C           W0AP03    IFEQ 'Y'
     C                     ADD  4         W0FSUM
     C                     END                             FI
      *
      * * Stop/Drop of Prt Load Schdlng Summ4 PF
     C           W0AP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Item Code of Prt Load Schdlng Summ4 PF
     C           W0AP05    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Process Sequence of Prt Load Schdlng Summ4 PF
     C           W0AP06    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Load Schdlng Summ4 PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
      * TOP = PAR By name
     C                     Z-ADDP4L9DT    $BL9DT           From Date
     C                     Z-ADDP4MADT    $BMADT           To Date
     C                     Z-ADDP4HQNX    $BHQNX           From Load ID  U
     C                     Z-ADDP4HRNX    $BHRNX           To Load ID  USR
     C                     MOVELP4XRCD    $BXRCD           Primal Group Co
     C                     MOVELP4U2ST    $BU2ST           Export Status
     C                     MOVELP4FGSX    $BFGSX           U/M - Load Sche
     C                     MOVELP4BPSX    $BBPSX           Load Grade
     C                     MOVELP4FHSX    $BFHSX           Untied Orders F
     C                     Z-ADDP1CQC3    $BAIC3           Company Number
     C                     MOVELP2LQAA    $BAJCD           Warehouse Code
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SDRVGN
     C                     MOVEL*BLANK    $CO6NA           Warehouse Desc
      * Warehouse Desc DRV
      * RTV Whse Descrip       RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP2LQAA    WL0001    P      Warehouse Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    $CO6NA    P      Warehouse Descr
      * RTV Whse Descrip       RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL$BAJCD    WL0001    P      Warehouse Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    $BF8NA    P      Warehouse Descr
      * RTV Newest Rcd         RT - Load Schdlng Position  * 
     C                     EXSR SFRVGN
     C                     Z-ADD$BHQNX    $BHQNX           From Load ID  U
     C                     Z-ADD$BHRNX    $BHRNX           To Load ID  USR
     C                     MOVEL*BLANK    $BVMNA           Primal Group De
      * Primal Group Desc DRV
      * Rtv Primal Grp Desc   RT - PS Primal Group  * 
     C                     EXSR SGRVGN
      * Convert fields to external form
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $BAIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$BAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VBAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert From Date             USR to display format
      * Convert date
     C           1000000   ADD  $BL9DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBL9DT
      * Convert To Date               USR to display format
      * Convert date
     C           1000000   ADD  $BMADT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBMADT
      * Convert Job Date Usr to display format
      * Convert date
     C           1000000   ADD  $BRADT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBRADT
     C                     MOVEL'0'       *IN79
     C           WUFTFG    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSA01           Application Cod
     C                     MOVEL'OMS'     WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELP2LQAA    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSC     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           Warehouse Type
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADWPST    YL0001           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADDP1CQC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSD     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $BAPTX           Name
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    $BAPTX           Name
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Whse Descrip       RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WAAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0001    WAAJCD           Warehouse Code
      * Establish starting position
     C           KRSSE     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Warehouse Descr
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWAF8NA    WL0002           Warehouse Descr
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Newest Rcd         RT - Load Schdlng Position  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *HIVAL    SETLL@MHCPYF                    *
     C                     READ @MHCPYF                  90*
      * Data record not found
     C   90                MOVEL'USR2706' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBAATM    $BDHTM           Job Time
     C                     Z-ADDWBAXDT    $BRADT           Job Date
     C                     GOTO SFEXIT                     *QUIT
     C                     READ @MHCPYF                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Primal Grp Desc   RT - PS Primal Group  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           LLXRCD           Primal Group Co
      * Setup key
     C                     MOVELP4XRCD    LLXRCD           Primal Group Co
      * Establish starting position
     C           KRSSG     CHAIN@LLREOY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2505' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    $BVMNA           Primal Group De
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELLLOJNA    $BVMNA           Primal Group De
     C                     GOTO SGEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Load All Fields    RT - Load Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        Status - Y or N
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD$DRMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSH     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJDXTX    $DDXTX           Trailer Id
     C                     MOVELFJBZNA    $DBZNA           Carrier Code
     C                     Z-ADDFJKKDT    $DKKDT           On Yard Date
     C                     Z-ADDFJAVTM    $DAVTM           On Yard Time
     C                     Z-ADDFJKZDT    $DXRDT           Deadline Depart
     C                     Z-ADDFJAXTM    $DEQTM           Deadline Depart
     C                     Z-ADDFJP0DT    $DP0DT           LPT Load Plan S
     C                     Z-ADDFJCMTM    $DCMTM           LPT Load Plan S
     C                     GOTO SHEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Active Carr Name   RT - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVEL$DBZNA    FFBZNA           Carrier Code
      * Establish starting position
     C           KRSSI     CHAIN@FFREUG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $DADTX           Name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFFADTX    $DADTX           Name
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Ship To Name       RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0003    BEAIC3           Company Number
     C                     Z-ADDWL0004    BEC4NB           Order Number
      * Establish starting position
     C           KRSSJ     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0005           Ship To Name
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEBRTX    WL0005           Ship To Name
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Carrier Code       RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDMHRMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSK     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJBZNA    YL0003           Carrier Code
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Carrier Name       RT - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WCBZNA           Carrier Code
      * Setup key
     C                     MOVELYL0003    WCBZNA           Carrier Code
      * Establish starting position
     C           KRSSL     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $EPAT1           Name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCADTX    $EPAT1           Name
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Export Status RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDMHRMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSM     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P5CXST           Export Status
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJU2ST    P5CXST           Export Status
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV UM/Whs Code        RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    P6ODCD           USR Unit of Mea
     C                     Z-ADD*ZERO     YL0004           Boxes Total Qua
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQSN01           Load ID
      * Define keylist
     C           KPSSN     KLIST
     C                     KFLD           WQSN01           Load ID
     C                     KFLD           WDC4NB           Order Number
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Load ID
      * Setup key
     C                     Z-ADDMHRMNB    WQSN01           Load ID
     C                     Z-ADDMHC4NB    WDC4NB           Order Number
      * Establish starting position
     C           KPSSN     SETLL@BFCPR0                    *
     C           KRSSN     READE@BFCPR0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     GOTO SNEXIT                     *QUIT
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV UM/Whs Code,BX Qty RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0006           Company Number
     C                     Z-ADDWDC4NB    WL0007           Order Number
     C                     Z-ADD1         WL0008           Order Sequence
     C                     MOVELP6ODCD    WL0009    P      USR Unit of Mea
     C                     Z-ADDYL0004    WL0010           Boxes Total Qua
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0009    P6ODCD    P      USR Unit of Mea
     C                     Z-ADDWL0010    YL0004           Boxes Total Qua
      * If doing for one Order, because it isnt tied to a load yet
      * CASE: DB1.Load ID is Blank
     C           WDRMNB    IFEQ 0                          *IF
      * CASE: PAR.USR Unit of Measure is Mixed
     C           P6ODCD    IFEQ 'MX'                       *IF
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0011           Company Number
     C                     MOVEL'BOXLOAD' WL0012    P      Company Value C
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0013    YL0006           System Value Nu
      * CASE: LCL.Boxes Total Quantity LT LCL.Box Load Min Box Qty USR
     C           YL0004    IFLT YL0006                     *IF
     C                     MOVEL'CB'      P6ODCD           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BX'      P6ODCD           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
     C                     GOTO SNEXIT                     *QUIT
     C                     END                             *FI
      * orig code
     C           KRSSN     READE@BFCPR0                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.USR Unit of Measure is Mixed
     C           P6ODCD    IFEQ 'MX'                       *IF
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0011           Company Number
     C                     MOVEL'BOXLOAD' WL0012    P      Company Value C
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0013    YL0006           System Value Nu
      * CASE: LCL.Boxes Total Quantity LT LCL.Box Load Min Box Qty USR
     C           YL0004    IFLT YL0006                     *IF
     C                     MOVEL'CB'      P6ODCD           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BX'      P6ODCD           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV UM/Whs Code,BX Qty RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSO01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSO02           Order Number
      * Define keylist
     C           KPSSO     KLIST
     C                     KFLD           WQSO01           Company Number
     C                     KFLD           WQSO02           Order Number
     C                     KFLD           OMDPNB           Order Sequence
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Company Number
     C                     KFLD           WQSO02           Order Number
      * Setup key
     C                     Z-ADDWL0006    WQSO01           Company Number
     C                     Z-ADDWL0007    WQSO02           Order Number
     C                     Z-ADDWL0008    OMDPNB           Order Sequence
      * Establish starting position
     C           KPSSO     SETLL@BGWKL1                    *
     C           KRSSO     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0009           USR Unit of Mea
     C                     Z-ADD*ZERO     WL0010           Boxes Total Qua
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SOEXIT                     *QUIT
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           OMGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * S17054 DN 04/08/21-Beyond this point, changed all 'U/M - Ordered'
      *   to reference LCL Context instead of DB1.
      * S17054 DN 04/08/21-Count Type 'Cases' (CS) as 'Boxes' (BX).
      * CASE: *OTHERWISE
     C                     MOVELOMAGCD    YL0005           U/M - Ordered
      * CASE: LCL.U/M - Ordered is Cases
     C           YL0005    IFEQ 'CS'                       *IF
     C                     MOVEL'BX'      YL0005           U/M - Ordered
     C                     END                             *FI
      * Accumulate the Box Quantity for slotting consideration  6/12/01
      * CASE: LCL.U/M - Ordered is EQ Boxes
     C           YL0005    IFEQ 'BX'                       *IF
     C                     ADD  OMAVQT    WL0010           Boxes Total Qua
     C                     END                             *FI
      * CASE: PAR.USR Unit of Measure is *Blank
     C           WL0009    IFEQ *BLANK                     *IF
     C                     MOVELYL0005    WL0009           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.U/M - Ordered EQ PAR.USR Unit of Measure
     C           YL0005    IFEQ WL0009                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'MX'      WL0009           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSO     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADDWL0011    KMAIC3           Company Number
     C                     MOVELWL0012    KMV8CD           Company Value C
      * Establish starting position
     C           KRSSP     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDKMM8NB    WL0013           System Value Nu
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQDLRC    BEGSR
      *================================================================
      * DEL Load Schdlng Summ  DL - *Arrays  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Initialize array variables
     C                     MOVEA*HIVAL    YK01
      * Initialize last used element number
     C                     Z-ADD0         YL01
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Bld ARR Load Schdlng SmRT - Order Header TRG  * Build Array
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFRMNB    WQSR02           Load ID
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR02           Load ID
      * Setup key
     C                     Z-ADDMHRMNB    WQSR02           Load ID
      * Establish starting position
     C           KRSSR     SETLL@BFCPRQ                    *
     C           KRSSR     READE@BFCPRQ                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Header Status is Not cancelled
     C           WFGWST    IFEQ 'L'                        *IF
     C           WFGWST    OREQ 'A'
     C           WFGWST    OREQ 'C'
     C           WFGWST    OREQ 'R'
     C           WFGWST    OREQ 'E'
     C           WFGWST    OREQ 'H'
     C           WFGWST    OREQ 'I'
      * Bld ARR Load Schdlng SmRT - Order Detail  * 
     C                     EXSR SSRVGN
     C                     END                             *FI
     C           KRSSR     READE@BFCPRQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Bld ARR Load Schdlng SmRT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSS01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSS02           Order Number
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Company Number
     C                     KFLD           WQSS02           Order Number
      * Setup key
     C                     Z-ADDWFAIC3    WQSS01           Company Number
     C                     Z-ADDWFC4NB    WQSS02           Order Number
      * Establish starting position
     C           KRSSS     SETLL@BGWKL1                    *
     C           KRSSS     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           OMGMST    IFEQ 'L'                        *IF
     C           OMGMST    OREQ 'A'
     C           OMGMST    OREQ 'C'
     C           OMGMST    OREQ 'R'
     C           OMGMST    OREQ 'E'
     C           OMGMST    OREQ 'H'
     C           OMGMST    OREQ 'I'
      * Rtv Primal Group Code RT - Item Default  * 
     C                     EXSR STRVGN
      * Accum QTY Ordered Per Primal Group Code.
      * UPD Load Schdlng Summ  RT - *Arrays  * 
     C                     EXSR SURVGN
     C                     END                             *FI
     C           KRSSS     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv Primal Group Code RT - Item Default  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           BYHGCD           Item Code
      * Setup key
     C                     Z-ADDOMHGCD    BYHGCD           Item Code
      * Establish starting position
     C           KRSST     CHAIN@BYREA1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1160' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0007           Primal Group Co
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBYXRCD    YL0007           Primal Group Co
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * UPD Load Schdlng Summ  RT - *Arrays  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C           YL01      IFGT 0
      * Set search index to first element of array
     C                     Z-ADD1         Y       50
     C                     MOVELYK01,Y    YD01
     C           YI01      OCUR YM01
      * Initialize internal index
     C                     MOVEL*LOVAL    YD01
      * Move key fields to ARR Load Schdlng Summ
     C                     MOVELYL0007    YI0101           Primal Group Co
      *
      * Only search if key is not beyond range of current elements
     C           YK01,YL01 IFGT YD01
     C           YD01      LOKUPYK01,Y               90    Look for >
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C           *IN90     IFEQ '1'
      * Move to data structure for comparison
     C                     MOVELYK01,Y    YD01
      * Compare
     C           YI0101    IFNE YL0007
      *
     C                     SETOF                     90    *
     C                     ENDIF
     C                     ENDIF
     C           *IN90     IFEQ '0'
      * Array element not found
     C                     MOVEL'Y2U0005' W0RTN   7
      * USER: Processing if Data record not found
      * CRT Load Schdlng Summ  CR - *Arrays  * 
     C                     EXSR SVCRRC
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '1'
     C           YI01      OCUR YM01
      * USER: Process Data record
     C           WESZQT    ADD  OMAVQT    YL0008           Total Quantity
      * CHG Load Schdlng Summ  CH - *Arrays  * 
     C                     EXSR SWCHRC
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCRRC    BEGSR
      *================================================================
      * CRT Load Schdlng Summ  CR - *Arrays  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Array full, cannot add any more elements
     C           YL01      IFEQ 100
     C                     MOVEL'Y2U0036' W0RTN   7
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C                     MOVEL*BLANK    XAXRCD           Primal Group Co
     C                     Z-ADD*ZERO     XASZQT           Total Quantity
      * Move all fields to ARR Load Schdlng Summ
     C                     MOVELYL0007    XAXRCD           Primal Group Co
     C                     Z-ADDOMAVQT    XASZQT           Total Quantity
      *
      * Move key fields to ARR Load Schdlng Summ
     C                     MOVELXAXRCD    YI0101           Primal Group Co
      *
      * Check for duplicate primary key
      * Initialize internal index
     C                     Z-ADD*ZERO     YI01
      * Only search if key is not beyond range of current elements
     C           YL01      IFGT 0
     C           YK01,YL01 ANDGTYD01
      * Set search index to first element of array
     C                     Z-ADD1         Y       50
     C           YD01      LOKUPYK01,Y               90    Look for >
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C           *IN90     IFEQ '1'
      * Move to data structure for comparison
     C                     MOVELYK01,Y    YD01
      * Compare
     C           YI0101    IFEQ XAXRCD
      * Array element already exists
     C                     MOVEL'Y2U0003' W0RTN   7
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C                     ENDIF
      *
      * Insert after last used element
     C           YL01      ADD  1         Y       50
      * Check if element was a previously deleted element
     C           YK01,Y    IFNE *HIVAL
      * If so, reuse MODS index
     C                     MOVELYK01,Y    YD01
     C                     ELSE
      * If not, use element number as MODS index
     C                     Z-ADDY         YI01
     C                     ENDIF
      *
      * Create(insert) new element
      * Move key fields to ARR Load Schdlng Summ
     C                     MOVELXAXRCD    YI0101           Primal Group Co
      *
     C                     MOVELYD01      YK01,Y
     C           YI01      OCUR YM01
      * Update MODS fields
     C                     MOVELXAXRCD    WEXRCD           Primal Group Co
     C                     Z-ADDXASZQT    WESZQT           Total Quantity
      * Only sort if element is out of position
     C           YL01      IFGT 0
     C           YK01,YL01 ANDGTYD01
      * Adjust RTVOBJ index to reflect position of added/removed element
     C           YR01      IFGT 0
     C           YR01      ANDLE100
     C           YK01,YR01 ANDGTYD01
     C                     ADD  1         YR01    50
     C                     ENDIF
      * Sort array to place element in correct position
     C                     SORTAYK01
     C                     ENDIF
      * Adjust number of elements currently in array
     C                     ADD  1         YL01
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWCHRC    BEGSR
      *================================================================
      * CHG Load Schdlng Summ  CH - *Arrays  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to ARR Load Schdlng Summ
     C                     MOVELWEXRCD    YI0101    P      Primal Group Co
      *
      * Reset global index if not within range of current elements
     C           Y         IFGT YL01
     C                     Z-ADD1         Y
     C                     ENDIF
      * Only search if not already pointing to correct element
     C           Y         IFGT 0
     C           YD01      ANDNEYK01,Y
      * Initialize internal index
     C                     Z-ADD*ZERO     YI01
      * Only search if key is not beyond range of current elements
     C           YL01      IFGT 0
     C           YK01,YL01 ANDGTYD01
      * Set search index to first element of array
     C                     Z-ADD1         Y       50
     C           YD01      LOKUPYK01,Y               90    Look for >
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C           *IN90     IFEQ '1'
      * Move to data structure for comparison
     C                     MOVELYK01,Y    YD01
      * Compare
     C           YI0101    IFNE WEXRCD
      *
     C                     SETOF                     90    *
     C                     ENDIF
     C                     ENDIF
     C           *IN90     IFEQ '0'
      * Element not found in array
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C                     ENDIF
     C           YI01      OCUR YM01
      *
      * Move all fields to ARR Load Schdlng Summ
     C                     Z-ADDYL0008    WESZQT           Total Quantity
      *
      *
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Load Schdlng Summ  RT - *Arrays  * DESC by Tot Qty Ordered
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    YL0010           Primal Group Co
     C                     Z-ADD*ZERO     YL0011           Total Quantity
     C           YL01      IFGT 0
      * Set search index to first element of array
     C                     Z-ADD1         Y       50
     C                     MOVELYK01,Y    YD01
     C           YI01      OCUR YM01
      * Initialize internal index
     C                     MOVEL*LOVAL    YD01
      * Move key fields to ARR Load Schdlng Summ
     C                     MOVELYL0009    YI0101           Primal Group Co
      *
      *
      * Only search if key is not beyond range of current elements
     C           YK01,YL01 IFGT YD01
     C           YD01      LOKUPYK01,Y               90    Look for >
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C           *IN90     IFEQ '0'
      * Array element not found
     C                     MOVEL'Y2U0005' W0RTN   7
     C                     ENDIF
      *
     C           *IN90     IFEQ '1'
      * Sequence through qualified elements:
     C                     Z-ADDY         YR01    50
     C           YR01      DOWLEYL01
     C                     Z-ADDYR01      Y
     C                     MOVELYK01,Y    YD01
     C           YI01      OCUR YM01
      * USER: Process Data record
      * Send Back the Most Qty Ordered for Primal Group.
      * CASE: DB1.Total Quantity Ordered U GT LCL.Total Quantity Ordered
     C           WESZQT    IFGT YL0011                     *IF
     C                     Z-ADDWESZQT    YL0011           Total Quantity
     C                     MOVELWEXRCD    YL0010           Primal Group Co
     C                     END                             *FI
     C                     ADD  1         YR01
     C                     ENDDO
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV Limit Loads f/Slot RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     $FIUNX           Export Load Lim
     C                     Z-ADD*ZERO     $FBINX           Combo Load Limi
     C                     Z-ADD*ZERO     $FBHNX           Box Load Limit
     C                     MOVEL'N'       WUYIST           Record Found -O
      * RTV Shipping Co        RT - Warehouse  * 
     C                     EXSR SZRVGN
      * ** Retrieve needed values from System Values file     E000233
      * Rtv Company Ctl Vals  XF - Company Values  * 
     C                     CALL 'PNOQXFR'              90  Rtv Company Ctl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0012    WQ0001  30       Company Number
     C           YL0013    PARM *ZERO     WQ0002  50       Box Load Min Bo
     C           YL0014    PARM *ZERO     WQ0003  70       Partial Load Ma
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNOQXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * change log
     C                     EXSR UISUBR                     change log
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGVPCD    WQSY02           Ship From Wareh
     C           *LIKE     DEFN WGAODT    WQSY03           Scheduled Ship
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY02           Ship From Wareh
     C                     KFLD           WQSY03           Scheduled Ship
      * Setup key
     C                     MOVELP2LQAA    WQSY02           Ship From Wareh
     C                     Z-ADDP4L9DT    WQSY03           Scheduled Ship
      * Establish starting position
     C           KRSSY     SETLL@FJCPN3                    *
     C           KRSSY     READE@FJCPN3                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RMC 9/11/13 E2709
      * Check for Mixed having box qty>BOXLOAD qty, if yes, then BX, else
      * Change Priority 3/14/01    RMC
      * Check for Mixed having a box qty > 60 to stay BX   6/12/01    RMC
      * Per Steve Burke - 6/27/01
      * Dont check just for Prepaid Trucks.  Collect and Prepaid trucks i
      * If Partial Load (<= 20000 lbs) dont count.
      * Priority :  Combo , Export, Box
      * CASE:
      *  - c1ANDc2ANDc3
      *   |- c1    : DB1.Load Type is Regular
      *   |- c2    : DB1.Total Load Order Weight GT LCL.Partial Load Max
      *   |- c3    : DB1.Shipping Method is Not Rail
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WGVDST    IFEQ 'R'                        *IF
     C           WGRPNB    IFGT YL0014                     *IF
     C           WGQ2CD    IFEQ 'CT'                       *IF
     C           WGQ2CD    OREQ 'PT'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Update load found so this load wont be counted again in the calli
      * CASE: DB1.Load ID EQ PAR.Load ID
     C           WGRMNB    IFEQ *ZERO                      *IF
     C                     MOVEL'Y'       WUYIST           Record Found -O
     C                     END                             *FI
     C                     Z-ADD*ZERO     YL0015           Boxes Total Qua
      * 05/11/04 SLM PKTR01 Multi-Company - Function chgd-remove Company
      * RTV UM/Whs Code,BX Qty RT - Order Header TRG  * 
     C                     EXSR TARVGN
      * CASE: LCL.U/M - Ordered is Combos
     C           YL0016    IFEQ 'CB'                       *IF
     C                     ADD  1         $FBINX           Combo Load Limi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWGU2ST    YL0018           Export Status D
      * Count Load as Export if order whse = Ship-From-Whse & Export 8/3/
      * CASE: DB1.Export Status is yes
     C           WGU2ST    IFEQ 'Y'                        *IF
      * See if export order whse matches load Shipfrom whse  08/03/07 RMC
      * For example a load could be export sts=Y and ship from whse is GP
      * there are multiple orders, and the one that is export is out of C
      *  in that case, dont count the load as export- per Steve B and Jim
      * RTV ExpOrd Whse for LD XF - Order Header TRG  * 
     C                     CLEARPARC
     C                     Z-ADDWGRMNB    PARMNB           Load ID
      *
     C                     CALL 'PMK2XFR'              90  RTV ExpOrd Whse
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Order Head
     C                     PARM WGVPCD    WQ0004  3        Ship From Wareh
     C           YL0018    PARM YL0018    WQ0005  1        Export Status D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMK2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * CASE: LCL.Export Status Dft is yes
     C           YL0018    IFEQ 'Y'                        *IF
     C                     ADD  1         $FIUNX           Export Load Lim
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         $FBHNX           Box Load Limit
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSY     READE@FJCPN3                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV Shipping Co        RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELP2LQAA    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSZ     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0012           Shipping Compan
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDADBWC3    YL0012           Shipping Compan
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * RTV UM/Whs Code,BX Qty RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/13/04 SLM PKTR01 Multi-Company - Funt chg to rmv Co RST or Pos
     C                     MOVEL*BLANK    YL0016           USR Unit of Mea
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQTA01           Load ID
      * Define keylist
     C           KPSTA     KLIST
     C                     KFLD           WQTA01           Load ID
     C                     KFLD           WDC4NB           Order Number
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           Load ID
      * Setup key
     C                     Z-ADDWGRMNB    WQTA01           Load ID
     C                     Z-ADD*ZERO     WDC4NB           Order Number
      * Establish starting position
     C           KPSTA     SETLL@BFCPR0                    *
     C           KRSTA     READE@BFCPR0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV UM/Whs Code,BX Qty RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0006           Company Number
     C                     Z-ADDWDC4NB    WL0007           Order Number
     C                     Z-ADD1         WL0008           Order Sequence
     C                     MOVELYL0016    WL0009    P      USR Unit of Mea
     C                     Z-ADDYL0015    WL0010           Boxes Total Qua
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0009    YL0016    P      USR Unit of Mea
     C                     Z-ADDWL0010    YL0015           Boxes Total Qua
     C           KRSTA     READE@BFCPR0                  90*
     C                     ENDDO
      * USER: Exit processing
      * RMC E2709 added here so it wont need to be in every calling pgm
      * CASE: PAR.USR Unit of Measure is Mixed
     C           YL0016    IFEQ 'MX'                       *IF
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0011           Company Number
     C                     MOVEL'BOXLOAD' WL0012    P      Company Value C
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0013    YL0017           System Value Nu
      * CASE: PAR.Boxes Total Quantity LT LCL.Box Load Min Box Qty USR
     C           YL0015    IFLT YL0017                     *IF
     C                     MOVEL'CB'      YL0016           USR Unit of Mea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'BX'      YL0016           USR Unit of Mea
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * RTV Day and Week No.   RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFAIC3    WQTB01           Company Number
     C           *LIKE     DEFN AFBCDT    WQTB02           Post to G/L Dat
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WQTB01           Company Number
     C                     KFLD           WQTB02           Post to G/L Dat
      * Setup key
     C                     Z-ADDP1CQC3    WQTB01           Company Number
     C                     Z-ADDP4L9DT    WQTB02           Post to G/L Dat
      * Establish starting position
     C           KRSTB     SETLL@AFREYY                    *
     C           KRSTB     READE@AFREYY                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     Z-ADDAFETNB    YL0019           Accounting Peri
     C                     MOVELAFA9ST    YL0020           Day of Week
     C                     Z-ADDAFEINB    YL0021           Week Number
     C           KRSTB     READE@AFREYY                  90*
     C                     ENDDO
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Rtv Load Slotting Sch RT - Load Slotting Sched Ctl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN A3AIC3    WQTC01           Company Number
     C           *LIKE     DEFN A3AJCD    WQTC02           Warehouse Code
     C           *LIKE     DEFN A3A9ST    WQTC03           Day of Week
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WQTC01           Company Number
     C                     KFLD           WQTC02           Warehouse Code
     C                     KFLD           WQTC03           Day of Week
      * Setup key
     C                     Z-ADDP1CQC3    WQTC01           Company Number
     C                     MOVELP2LQAA    WQTC02           Warehouse Code
     C                     MOVELYL0020    WQTC03           Day of Week
      * Establish starting position
     C           KRSTC     SETLL@A3REI3                    *
     C           KRSTC     READE@A3REI3                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3033' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     $FNVNX           Slot Limit for
     C                     Z-ADD*ZERO     $FNWNX           Slot Limit for
     C                     Z-ADD*ZERO     $FNXNX           Slot Limit for
     C                     Z-ADD*ZERO     WUIOWG           Weight Limit fo
     C                     Z-ADD*ZERO     WUIPWG           Weight Limit fo
     C                     Z-ADD*ZERO     WUIQWG           Weight Limit fo
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDA3NVNX    $FNVNX           Slot Limit for
     C                     Z-ADDA3NWNX    $FNWNX           Slot Limit for
     C                     Z-ADDA3NXNX    $FNXNX           Slot Limit for
     C                     Z-ADDA3IOWG    WUIOWG           Weight Limit fo
     C                     Z-ADDA3IPWG    WUIPWG           Weight Limit fo
     C                     Z-ADDA3IQWG    WUIQWG           Weight Limit fo
     C                     GOTO TCEXIT                     *QUIT
     C           KRSTC     READE@A3REI3                  90*
     C                     ENDDO
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Order tied to a load.
      *================================================================
      * CASE: PAR.Untied Orders Flag USR is No
     C           P4FHSX    IFEQ 'N'                        *IF
      * Select Tied Order Only.
     C                     EXSR UBSUBR                     Select Tied Ord
     C                     ELSE
      * CASE: PAR.Untied Orders Flag USR is Yes
     C           P4FHSX    IFEQ 'Y'                        *IF
      * Select Untied Orders Only.
     C                     EXSR UCSUBR                     Select Untied O
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Select Tied Order Only.
      *================================================================
      * CASE: DB1.Load ID is GT Zero
     C           MHRMNB    IFGT *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Select Untied Orders Only.
      *================================================================
      * CASE: DB1.Load ID is Blank
     C           MHRMNB    IFEQ *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Scheduled Ship Date Selection.
      *================================================================
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.From Date             USR is Entered
      *   |- c2    : PAR.To Date               USR is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P4L9DT    IFNE *ZERO                      *IF
     C           P4MADT    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Scheduled Ship Date LT PAR.From Date
      *   |- c2    : DB1.Scheduled Ship Date GT PAR.To Date
      *   '-
     C           MHAODT    IFLT P4L9DT                     *IF
     C           MHAODT    ORGT P4MADT                     *OR
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Load ID Selection.
      *================================================================
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.From Load ID  USR is NE Blank
      *   |- c2    : PAR.To Load ID  USR is NE Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P4HQNX    IFNE *ZERO                      *IF
     C           P4HRNX    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Load ID LT PAR.From Load ID  USR
      *   |- c2    : DB1.Load ID GT PAR.To Load ID  USR
      *   '-
     C           MHRMNB    IFLT P4HQNX                     *IF
     C           MHRMNB    ORGT P4HRNX                     *OR
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Export Status Selection.
      *================================================================
      * CASE: PAR.Export Status is Y/N Values
     C           P4U2ST    IFEQ 'N'                        *IF
     C           P4U2ST    OREQ 'Y'
      * RTV Export Status RT - Load Header  * 
     C                     EXSR SMRVGN
      * CASE: PAR.Export Status Dft NE PAR.Export Status
     C           P5CXST    IFNE P4U2ST                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Unit of Measure Selection.
      *================================================================
      * CASE: PAR.U/M - Load Scheduling USR is Not Blank
     C           P4FGSX    IFEQ 'BX'                       *IF
     C           P4FGSX    OREQ 'CB'
     C           P4FGSX    OREQ 'MX'
      * 05/11/04 SLM PKTR01 Multi-Company - Function was changed
      *                                     to remove Company RST or Pos
      * RTV UM/Whs Code        RT - Order Header TRG  * 
     C                     EXSR SNRVGN
      * CASE: PAR.USR Unit of Measure NE PAR.U/M - Load Scheduling USR
     C           P6ODCD    IFNE P4FGSX                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Load Grade Selection.
      *================================================================
      * CASE: PAR.Load Grade is Not Blank
     C           P4BPSX    IFEQ 'C'                        *IF
     C           P4BPSX    OREQ 'L'
     C           P4BPSX    OREQ 'X'
     C           P4BPSX    OREQ 'A'
     C           P4BPSX    OREQ 'P'
      * CASE: DB1.Load Grade NE PAR.Load Grade
     C           MHBPSX    IFNE P4BPSX                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * change log
      *================================================================
      * 02/03/2010 LJB E000233
      *    Retrieve needed values from System Values file
      * 08/03/07 RMC dly029 Count Load as Export if export order whse
      *    matches ShipFrom Whse on the load   -- per jim n, steve b
      * 05/11/04 SLM PKTR01 Multi-Company - Order Header TRG Remove Co
      *    from Logical View
      * 05/17/04 RMC PKTR01 Multi-Company - Use Shipping Co from Whse
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P5CXST           Export Status D
     C                     MOVEL*BLANK    P6ODCD           USR Unit of Mea
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field USR Display 1
     C                     MOVEL*BLANK    WUTIST  1
      * Define work field First time flag 2     USR
     C                     MOVEL*BLANK    WUFTFG  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    MHCUC3           LSP Order Compa
     C                     MOVEL*LOVAL    MHKZDT           Deadline Depart
     C                     MOVEL*LOVAL    MHAXTM           Deadline Depart
     C                     MOVEL*LOVAL    MHRMNB           Load ID
     C                     MOVEL*LOVAL    MHRVNB           Stop/Drop
     C                     MOVEL*LOVAL    MHHGCD           Item Code
     C                     MOVEL*LOVAL    MHN5NY           Process Sequenc
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WADBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WABWC3           Shipping Compan
     C                     Z-ADD*ZERO     WABTC3           Accounting Comp
     C                     Z-ADD*ZERO     WABUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WABVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBCQC3           LSP Accounting
     C                     Z-ADD*ZERO     WBCUC3           LSP Order Compa
     C                     Z-ADD*ZERO     WBSPSQ           Sequence
     C                     Z-ADD*ZERO     WBL7DT           Thru Scheduled
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBKBQT           Actual Inventor
     C                     Z-ADD*ZERO     WBKCQT           Picked Inventor
     C                     Z-ADD*ZERO     WBKHQT           Available Inven
     C                     Z-ADD*ZERO     WBKDQT           Actual Producti
     C                     Z-ADD*ZERO     WBKEQT           Scheduled Produ
     C                     Z-ADD*ZERO     WBKFQT           Available Produ
     C                     Z-ADD*ZERO     WBH1QT           Scheduled Quant
     C                     Z-ADD*ZERO     WBKGQT           Scheduling Posi
     C                     Z-ADD*ZERO     WBKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WBAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WBT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WBRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WBSTDT           LSP Production
     C                     Z-ADD*ZERO     WBN5NY           Process Sequenc
     C                     Z-ADD*ZERO     WBRINY           Item Age Days
     C                     Z-ADD*ZERO     WBTIDT           Production Ovr
     C                     Z-ADD*ZERO     WBTJDT           Production Ovr
     C                     Z-ADD*ZERO     WBTNDT           Production AgeD
     C                     Z-ADD*ZERO     WBTODT           Production AgeD
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCEZNB           Telephone Numbe
     C                     Z-ADD*ZERO     WCEEDT           Carrier Last Us
     C                     Z-ADD*ZERO     WCNRVA           Pallet Balance
     C                     Z-ADD*ZERO     WCNSVA           Long hook balan
     C                     Z-ADD*ZERO     WCNTVA           Short hook bala
     C                     Z-ADD*ZERO     WCNUVA           Tub Balance
     C                     Z-ADD*ZERO     WCS8NB           Home Phone
     C                     Z-ADD*ZERO     WCS9NB           Other Phone
     C                     Z-ADD*ZERO     WCNMVA           Flat Rate
     C                     Z-ADD*ZERO     WCNOVA           Rate Per Pound
     C                     Z-ADD*ZERO     WCNPVA           Unused Rate Per
     C                     Z-ADD*ZERO     WCNQVA           Miscellaneous C
     C                     Z-ADD*ZERO     WCQXNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WCQ1NB           Unused Mile Ran
     C                     Z-ADD*ZERO     WCMRNG           Unused Mile Ran
     C                     Z-ADD*ZERO     WCMRNE           Unused Mile Ran
     C                     Z-ADD*ZERO     WCRFNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WCMREG           Unused Mile Ran
     C                     Z-ADD*ZERO     WCBQPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WCBRPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WCBSPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WCBTPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WCBUPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WCBVPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WCDJWG           Unused Weight R
     C                     Z-ADD*ZERO     WCDKWG           Unused Weight R
     C                     Z-ADD*ZERO     WCDLWG           Unused Weight R
     C                     Z-ADD*ZERO     WCDMWG           Unused Weight R
     C                     Z-ADD*ZERO     WCDNWG           Unused Weight R
     C                     Z-ADD*ZERO     WCDOWG           Unused Weight R
     C                     Z-ADD*ZERO     WCB2PR           Unused Weight R
     C                     Z-ADD*ZERO     WCB3PR           Unused Weight R
     C                     Z-ADD*ZERO     WCB4PR           Unused Weight R
     C                     Z-ADD*ZERO     WCB5PR           Unused Weight R
     C                     Z-ADD*ZERO     WCB6PR           Unused Weight R
     C                     Z-ADD*ZERO     WCB7PR           Unused Weight R
     C                     Z-ADD*ZERO     WCAAC7           Contact Number
     C                     Z-ADD*ZERO     WCTENO           Carrier Unused
     C                     Z-ADD*ZERO     WCAOFC           Amount of Cargo
     C                     Z-ADD*ZERO     WCAOLI           Amount of Liabi
     C                     Z-ADD*ZERO     WCKHDT           Date of Expirat
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WDA0DT           Order Date
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDACDT           Cancel Date
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WDA1WG           Order Weight To
     C                     Z-ADD*ZERO     WDEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WDAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WDATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WDRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WDT3NB           Attach to Order
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
     C                     Z-ADD*ZERO     WDAWDT           Invoice Date
     C                     Z-ADD*ZERO     WDVRVA           A/R order Value
     C                     Z-ADD*ZERO     WDB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WDNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WDNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WDNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WDNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WDNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WDBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WDBQTM           Time of Origina
     C                     Z-ADD*ZERO     WDBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WDBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WDBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WDH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WDH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WDH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WDH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WDH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WDC0C7           Claim Number
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      *
     C           W0ICL     IFEQ 'Y'
      * Initialize array variables
     C                     MOVEA*HIVAL    YK01
      * Initialize last used element number
     C                     Z-ADD0         YL01    50
     C                     Z-ADD1         Y       50
     C                     ENDIF
      *
      * Define work field Record Found -OrdDtlUSR
     C                     MOVEL*BLANK    WUYIST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGRMNB           Load ID
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WGRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WGRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WGFLAM           Flat Amount
     C                     Z-ADD*ZERO     WGRRNB           Total Stops
     C                     Z-ADD*ZERO     WGSBNB           BOL Time
     C                     Z-ADD*ZERO     WGSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WGR1NB           Rated Freight
     C                     Z-ADD*ZERO     WGSDNB           Number Pallets
     C                     Z-ADD*ZERO     WGPAOU           Number Pallets
     C                     Z-ADD*ZERO     WGDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WGSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WGHADT           Actual Arrival
     C                     Z-ADD*ZERO     WGAART           Actual Arrival
     C                     Z-ADD*ZERO     WGDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WGDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WGAQDT           Actual Departur
     C                     Z-ADD*ZERO     WGS6NB           Departure Time
     C                     Z-ADD*ZERO     WGT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WGPRTM           Product Tempera
     C                     Z-ADD*ZERO     WGNPSV           Number Spacers
     C                     Z-ADD*ZERO     WGTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WGGRWE           Gross Weight
     C                     Z-ADD*ZERO     WGF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WGJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WGTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WGJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WGSPTM           Spotted Time
     C                     Z-ADD*ZERO     WGJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WGLFTM           Load Finished T
     C                     Z-ADD*ZERO     WGJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WGBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WGJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WGBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WGKIDT           Truck Departure
     C                     Z-ADD*ZERO     WGASTM           Truck Departure
     C                     Z-ADD*ZERO     WGKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WGAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WGVOAG           Voyage
     C                     Z-ADD*ZERO     WGKBDT           Sail Date
     C                     Z-ADD*ZERO     WGEFDT           Arrival Date
     C                     Z-ADD*ZERO     WGKCDT           Date In
     C                     Z-ADD*ZERO     WGTMIN           Time In
     C                     Z-ADD*ZERO     WGKDDT           Date Out
     C                     Z-ADD*ZERO     WGVMNB           Time Out
     C                     Z-ADD*ZERO     WGOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WGKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WGATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WGBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WGEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WGKKDT           On Yard Date
     C                     Z-ADD*ZERO     WGAVTM           On Yard Time
     C                     Z-ADD*ZERO     WGKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WGAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WGLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WGK0DT           Product Complet
     C                     Z-ADD*ZERO     WGAYTM           Product Complet
     C                     Z-ADD*ZERO     WGKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WGICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WGIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WGK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WGAZTM           Load Door 1
     C                     Z-ADD*ZERO     WGK2DT           Override Total
     C                     Z-ADD*ZERO     WGA0TM           Load Door 2
     C                     Z-ADD*ZERO     WGZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WGPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WGCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WGPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WGCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WGP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WGCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WGP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WGCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WGP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WGCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WGP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WGCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field Weight Limit for Export
     C                     Z-ADD*ZERO     WUIOWG 110
      * Define work field Weight Limit for Combo
     C                     Z-ADD*ZERO     WUIPWG 110
      * Define work field Weight Limit for Box/Othr
     C                     Z-ADD*ZERO     WUIQWG 110
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SERVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002 30
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  70
     C                     MOVEL*BLANK    WL0005 30
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  70
     C                     Z-ADD*ZERO     WL0008  30
     C                     MOVEL*BLANK    WL0009  2
     C                     Z-ADD*ZERO     WL0010 112
      * Define local variables for subroutine SPRVGN.
     C                     Z-ADD*ZERO     WL0011  30
     C                     MOVEL*BLANK    WL0012 10
     C                     Z-ADD*ZERO     WL0013 155
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0001  2
      * Define null work field Thru Scheduled Ship Date
     C                     Z-ADD*ZERO     YN0001  70
      * Define null work field Company Number
     C                     Z-ADD*ZERO     YN0002  30
      * Define null work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YN0003  70
      * Define null work field LTL Flag
     C                     MOVEL*BLANK    YN0004  1
      * Define null work field Load Status
     C                     MOVEL*BLANK    YN0005  1
      * Define null work field Reefer Temperature
     C                     Z-ADD*ZERO     YN0006  52
      * Define null work field Seal 1
     C                     MOVEL*BLANK    YN0007 15
      * Define null work field Seal 2
     C                     MOVEL*BLANK    YN0008 15
      * Define null work field Seal 3
     C                     MOVEL*BLANK    YN0009 15
      * Define null work field Seal 4
     C                     MOVEL*BLANK    YN0010 15
      * Define null work field Seal 2 Unused
     C                     MOVEL*BLANK    YN0011 15
      * Define null work field Total Load Order Weight
     C                     Z-ADD*ZERO     YN0012  70
      * Define null work field Flat Amount
     C                     Z-ADD*ZERO     YN0013 112
      * Define null work field Allocate Pounds/Miles
     C                     MOVEL*BLANK    YN0014  1
      * Define null work field Total Stops
     C                     Z-ADD*ZERO     YN0015  50
      * Define null work field Transloader Carrier Code
     C                     MOVEL*BLANK    YN0016  3
      * Define null work field BOL Time
     C                     Z-ADD*ZERO     YN0017  40
      * Define null work field Truck Size
     C                     MOVEL*BLANK    YN0018  7
      * Define null work field Ld Hdr/Ld Dtl Unused
     C                     Z-ADD*ZERO     YN0019  70
      * Define null work field Rated Freight
     C                     Z-ADD*ZERO     YN0020 112
      * Define null work field Ship Status
     C                     MOVEL*BLANK    YN0021  1
      * Define null work field Load Type
     C                     MOVEL*BLANK    YN0022  1
      * Define null work field Number Pallets Received
     C                     Z-ADD*ZERO     YN0023  50
      * Define null work field Number Pallets Loaded
     C                     Z-ADD*ZERO     YN0024  50
      * Define null work field Load Carrier Pay Amt
     C                     Z-ADD*ZERO     YN0025 112
      * Define null work field Estimated Arrival Time
     C                     Z-ADD*ZERO     YN0026  60
      * Define null work field Actual Arrival Date
     C                     Z-ADD*ZERO     YN0027  70
      * Define null work field Actual Arrival Time
     C                     Z-ADD*ZERO     YN0028  40
      * Define null work field Trailer IN Weight
     C                     Z-ADD*ZERO     YN0029 112
      * Define null work field Trailer OUT Weight
     C                     Z-ADD*ZERO     YN0030 112
      * Define null work field Actual Departure Date
     C                     Z-ADD*ZERO     YN0031  70
      * Define null work field Departure Time
     C                     Z-ADD*ZERO     YN0032  40
      * Define null work field Schedule Sequence Number
     C                     Z-ADD*ZERO     YN0033  50
      * Define null work field Product Temperature
     C                     Z-ADD*ZERO     YN0034  52
      * Define null work field Number Spacers Loaded
     C                     Z-ADD*ZERO     YN0035  50
      * Define null work field Car/Veh. Initials
     C                     MOVEL*BLANK    YN0036 12
      * Define null work field Total Load Miles
     C                     Z-ADD*ZERO     YN0037  70
      * Define null work field Recorder ID
     C                     MOVEL*BLANK    YN0038 12
      * Define null work field Shipping Method
     C                     MOVEL*BLANK    YN0039  2
      * Define null work field Ship From Warehouse
     C                     MOVEL*BLANK    YN0040  3
      * Define null work field Ship To State Code
     C                     MOVEL*BLANK    YN0041  2
      * Define null work field Gross Weight
     C                     Z-ADD*ZERO     YN0042  70
      * Define null work field Carrier Broker
     C                     MOVEL*BLANK    YN0043  3
      * Define null work field Export Status
     C                     MOVEL*BLANK    YN0044  1
      * Define null work field Actual Ship Date
     C                     Z-ADD*ZERO     YN0045  70
      * Define null work field On Time - (Y/N)
     C                     MOVEL*BLANK    YN0046  1
      * Define null work field Truck Ready Date
     C                     Z-ADD*ZERO     YN0047  70
      * Define null work field Truck Ready Time
     C                     Z-ADD*ZERO     YN0048  60
      * Define null work field Spotted Date
     C                     Z-ADD*ZERO     YN0049  70
      * Define null work field Spotted Time
     C                     Z-ADD*ZERO     YN0050  60
      * Define null work field Load Finished Date
     C                     Z-ADD*ZERO     YN0051  70
      * Define null work field Load Finished Time
     C                     Z-ADD*ZERO     YN0052  60
      * Define null work field BOL Complete Date
     C                     Z-ADD*ZERO     YN0053  70
      * Define null work field BOL Complete Time
     C                     Z-ADD*ZERO     YN0054  60
      * Define null work field BOL Received Date
     C                     Z-ADD*ZERO     YN0055  70
      * Define null work field BOL Received Time
     C                     Z-ADD*ZERO     YN0056  60
      * Define null work field Truck Departure Date
     C                     Z-ADD*ZERO     YN0057  70
      * Define null work field Truck Departure Time
     C                     Z-ADD*ZERO     YN0058  60
      * Define null work field Adjusted Departure Date
     C                     Z-ADD*ZERO     YN0059  70
      * Define null work field Adjusted Departure Time
     C                     Z-ADD*ZERO     YN0060  60
      * Define null work field Shipping Line
     C                     MOVEL*BLANK    YN0061  3
      * Define null work field Port Delv Terminal
     C                     MOVEL*BLANK    YN0062 20
      * Define null work field Vessel Name
     C                     MOVEL*BLANK    YN0063 30
      * Define null work field Voyage
     C                     Z-ADD*ZERO     YN0064  50
      * Define null work field Sail Date
     C                     Z-ADD*ZERO     YN0065  70
      * Define null work field Booking Number
     C                     MOVEL*BLANK    YN0066 12
      * Define null work field Discharge Port
     C                     MOVEL*BLANK    YN0067 20
      * Define null work field Arrival Date
     C                     Z-ADD*ZERO     YN0068  70
      * Define null work field Container Number
     C                     MOVEL*BLANK    YN0069 12
      * Define null work field Date In
     C                     Z-ADD*ZERO     YN0070  70
      * Define null work field Time In
     C                     Z-ADD*ZERO     YN0071  60
      * Define null work field Date Out
     C                     Z-ADD*ZERO     YN0072  70
      * Define null work field Time Out
     C                     Z-ADD*ZERO     YN0073  60
      * Define null work field Load Total Freight
     C                     Z-ADD*ZERO     YN0074 112
      * Define null work field Scheduled Delivery Date
     C                     Z-ADD*ZERO     YN0075  70
      * Define null work field Scheduled Delivery Time
     C                     Z-ADD*ZERO     YN0076  60
      * Define null work field LH Unused Sts
     C                     MOVEL*BLANK    YN0077  1
      * Define null work field LH Carrier Payment Sts
     C                     MOVEL*BLANK    YN0078  1
      * Define null work field Bring Back Miles
     C                     Z-ADD*ZERO     YN0079  70
      * Define null work field Requested Delivery Date
     C                     Z-ADD*ZERO     YN0080  70
      * Define null work field Load Acceptance Flag
     C                     MOVEL*BLANK    YN0081  1
      * Define null work field Warehouse Code
     C                     MOVEL*BLANK    YN0082  3
      * Define null work field Load Held Over
     C                     MOVEL*BLANK    YN0083  1
      * Define null work field Load Held Over Reason
     C                     MOVEL*BLANK    YN0084  1
      * Define null work field Load Held Over Rsn Cmt
     C                     MOVEL*BLANK    YN0085 15
      * Define null work field Ocean BOL Number
     C                     MOVEL*BLANK    YN0086 25
      * Define null work field Express Mail Number
     C                     MOVEL*BLANK    YN0087 20
      * Define null work field Express Mail Date
     C                     Z-ADD*ZERO     YN0088  70
      * Define null work field Load Shag Flag
     C                     MOVEL*BLANK    YN0089  1
      * Define null work field Load Wash Flag
     C                     MOVEL*BLANK    YN0090  1
      * Define null work field Product Complete Date
     C                     Z-ADD*ZERO     YN0091  70
      * Define null work field Product Complete Time
     C                     Z-ADD*ZERO     YN0092  60
      * Define null work field Pallets Loaded
     C                     Z-ADD*ZERO     YN0093  50
      * Define null work field Avg Pallet Tare
     C                     Z-ADD*ZERO     YN0094  92
      * Define null work field Tot Pallet Tare
     C                     Z-ADD*ZERO     YN0095  92
      * Define null work field Load Confirmed Sts
     C                     MOVEL*BLANK    YN0096  1
      * Define null work field Load Confirmed Contact
     C                     MOVEL*BLANK    YN0097 25
      * Define null work field Load Confirmation Time
     C                     Z-ADD*ZERO     YN0098  70
      * Define null work field Load Door 1
     C                     Z-ADD*ZERO     YN0099  60
      * Define null work field Override Total Load Miles
     C                     Z-ADD*ZERO     YN0100  70
      * Define null work field Load Door 2
     C                     Z-ADD*ZERO     YN0101  60
      * Define null work field Partial Load
     C                     MOVEL*BLANK    YN0102  1
      * Define null work field Load Confirmation Fax Sts
     C                     MOVEL*BLANK    YN0103  1
      * Define null work field Export Load USDA-OK
     C                     MOVEL*BLANK    YN0104  1
      * Define null work field Late Delivery Email Flag
     C                     MOVEL*BLANK    YN0105  1
      * Define null work field Load Actual Freight
     C                     Z-ADD*ZERO     YN0106 112
      * Define null work field Hide on WW Load Sts
     C                     MOVEL*BLANK    YN0107 15
      * Define null work field Late Billing Email Flag
     C                     MOVEL*BLANK    YN0108 15
      * Define null work field Shipping Temp C/F txt
     C                     MOVEL*BLANK    YN0109 25
      * Define null work field LH Held Over Rsn Cmt
     C                     MOVEL*BLANK    YN0110 25
      * Define null work field Multi Company Load
     C                     MOVEL*BLANK    YN0111  1
      * Define null work field Fax Sent to SSI Carrier
     C                     MOVEL*BLANK    YN0112  1
      * Define null work field Schedule Pos Load Grade
     C                     MOVEL*BLANK    YN0113  1
      * Define null work field LH Power Only Load
     C                     MOVEL*BLANK    YN0114  1
      * Define null work field MG Created Load
     C                     MOVEL*BLANK    YN0115  1
      * Define null work field LH Unused Sts 5
     C                     MOVEL*BLANK    YN0116  1
      * Define null work field Load U/M
     C                     MOVEL*BLANK    YN0117  2
      * Define null work field TPM Shipment Status
     C                     MOVEL*BLANK    YN0118  2
      * Define null work field LH Unused Sts 8
     C                     MOVEL*BLANK    YN0119  2
      * Define null work field LH On-Time Reason Code
     C                     MOVEL*BLANK    YN0120  3
      * Define null work field LH Held Over Reason
     C                     MOVEL*BLANK    YN0121  3
      * Define null work field LH Carrier Paid Dte
     C                     Z-ADD*ZERO     YN0122  70
      * Define null work field LH Carrier Paid Time
     C                     Z-ADD*ZERO     YN0123  60
      * Define null work field LH Last Combo Prod Date
     C                     Z-ADD*ZERO     YN0124  70
      * Define null work field LH Last Combo Prod Time
     C                     Z-ADD*ZERO     YN0125  60
      * Define null work field TPM Planned Ship Date
     C                     Z-ADD*ZERO     YN0126  70
      * Define null work field LH Unused Time 4
     C                     Z-ADD*ZERO     YN0127  60
      * Define null work field LH Unused Date 5
     C                     Z-ADD*ZERO     YN0128  70
      * Define null work field LH Unused Time 5
     C                     Z-ADD*ZERO     YN0129  60
      * Define null work field LH Unused Date 6
     C                     Z-ADD*ZERO     YN0130  70
      * Define null work field LH Unused Time 6
     C                     Z-ADD*ZERO     YN0131  60
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0132  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0133  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0134  1
      * Define local work field Stop/Drop
     C                     Z-ADD*ZERO     YL0002  50
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0003  3
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0135  1
      * Define local work field Boxes Total Quantity
     C                     Z-ADD*ZERO     YL0004 112
      * Define local work field U/M - Ordered
     C                     MOVEL*BLANK    YL0005  2
      * Define local work field Box Load Min Box Qty USR
     C                     Z-ADD*ZERO     YL0006  50
      * Define local work field Primal Group Code
     C                     MOVEL*BLANK    YL0007  6
      * Define local work field Total Quantity Ordered U
     C                     Z-ADD*ZERO     YL0008  92
      * Define local work field Primal Group Code
     C                     MOVEL*BLANK    YL0009  6
      * Define local work field Primal Group Code USR
     C                     MOVEL*BLANK    YL0010  6
      * Define local work field Total Quantity Ordered U
     C                     Z-ADD*ZERO     YL0011  92
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0012  30
      * Define local work field Box Load Min Box Qty USR
     C                     Z-ADD*ZERO     YL0013  50
      * Define local work field Partial Load Max Lbs USR
     C                     Z-ADD*ZERO     YL0014  70
      * Define local work field Boxes Total Quantity
     C                     Z-ADD*ZERO     YL0015 112
      * Define local work field U/M - Ordered
     C                     MOVEL*BLANK    YL0016  2
      * Define local work field Box Load Min Box Qty USR
     C                     Z-ADD*ZERO     YL0017  50
      * Define local work field Export Status Dft
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field Accounting Period Code
     C                     Z-ADD*ZERO     YL0019  20
      * Define local work field Day of Week
     C                     MOVEL*BLANK    YL0020  1
      * Define local work field Week Number
     C                     Z-ADD*ZERO     YL0021  20
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
     C                     MOVEL'N'       WUTIST           USR Display 1
      * RTV Warehouse Type     RT - Warehouse  * 
     C                     EXSR SCRVGN
     C                     MOVEL'Y'       WUFTFG           First time flag
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
