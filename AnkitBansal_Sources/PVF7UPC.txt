/*********************************************************************/
/* PROGRAM : PVF7UPC                                                 */
/* DESC    : CNV CRT MAN DTL SUFFIX CL EXECUTE USER PROGRAM          */
/* DATE    : 06/27/2024                                              */
/* PROJECT : SR # 3015938                                            */
/* BY      : DANNY NGUYEN                                            */
/* PURPOSE : Create one time conversion process to save & recreate   */
/*           the PPBNCPP* suffix tables.                             */
/*           Only PPBNCPPSNT has data.                               */
/*           This is required due DBFC on PPBNCPP.                   */
/*                                                                   */
/*           ***MANUALLY SUBMIT PVF7UPC TO BATCH.                    */
/*                                                                   */
/*********************************************************************/
/* MAINTENANCE LOG:                                                  */
/*-------------------------------------------------------------------*/
/* DATE     BY  CHANGE DESCRIPTION                                   */
/* -------- --- ---------------------------------------------------- */
/* MM/DD/YY                                                          */
/*                                                                   */
/*********************************************************************/

             PGM

             DCL        VAR(&DATA) TYPE(*CHAR) LEN(10)
             DCL        VAR(&DATAH) TYPE(*CHAR) LEN(10)


/*-------------------------------------------------------------------*/
/* PROD OR TEST ENVIRONMENT?                                         */
/*-------------------------------------------------------------------*/
             CALL       PGM(CAQXXFR) PARM(' ' &DATA &DATAH)

/*-------------------------------------------------------------------*/
/* Recreate PPBNCPP in the Appropriate Library.                      */
/*-------------------------------------------------------------------*/
  /***********************************/
  /*TEST Environment Processing     */
  /***********************************/
             IF         COND(&DATA *NE 'PRKFLIB') THEN(DO)

             CHKOBJ     OBJ(&DATA/PPBNCPPGUY) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(DO)  /* NOT FOUND */

      /* FOR PRKTESTF ENV */
             RUNSQL     SQL('CREATE TABLE +
                          PRKTESTF/PFS_MANIFEST_DETAIL_GUY FOR +
                          SYSTEM NAME PPBNCPPGUY LIKE +
                          OMSDEVSQC/PPBNCPP RCDFMT @BNCPZK') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          PRKTESTF/PFS_MANIFEST_DETAIL_SNT FOR +
                          SYSTEM NAME PPBNCPPSNT LIKE +
                          OMSDEVSQC/PPBNCPP RCDFMT @BNCPZK') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          PRKTESTF/PFS_MANIFEST_DETAIL_STF FOR +
                          SYSTEM NAME PPBNCPPSTF LIKE +
                          OMSDEVSQC/PPBNCPP RCDFMT @BNCPZK') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          PRKTESTF/PFS_MANIFEST_DETAIL_STJ FOR +
                          SYSTEM NAME PPBNCPPSTJ LIKE +
                          OMSDEVSQC/PPBNCPP RCDFMT @BNCPZK') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          PRKTESTF/PFS_MANIFEST_DETAIL_STS FOR +
                          SYSTEM NAME PPBNCPPSTS LIKE +
                          OMSDEVSQC/PPBNCPP RCDFMT @BNCPZK') +
                          COMMIT(*NONE)

        /* CREATE INDEX FOR SUFFIX TABLE GUY/STF/STJ - PRKTESTF */
             RUNSQL     SQL('CREATE INDEX +
                          IX_PFS_MANIFEST_DETAIL_GUY_PFS_MANIFEST_ID_+
                          PFS_MANIFEST_DETAIL_ID ON +
                          PRKTESTF/PFS_MANIFEST_DETAIL_GUY +
                          (PFS_MANIFEST_ID ASC, +
                          PFS_MANIFEST_DETAIL_ID ASC)') COMMIT(*NONE)

             RUNSQL     SQL('CREATE INDEX +
                          IX_PFS_MANIFEST_DETAIL_STF_PFS_MANIFEST_ID_+
                          PFS_MANIFEST_DETAIL_ID ON +
                          PRKTESTF/PFS_MANIFEST_DETAIL_STF +
                          (PFS_MANIFEST_ID ASC, +
                          PFS_MANIFEST_DETAIL_ID ASC)') COMMIT(*NONE)

             RUNSQL     SQL('CREATE INDEX +
                          IX_PFS_MANIFEST_DETAIL_STJ_PFS_MANIFEST_ID_+
                          PFS_MANIFEST_DETAIL_ID ON +
                          PRKTESTF/PFS_MANIFEST_DETAIL_STJ +
                          (PFS_MANIFEST_ID ASC, +
                          PFS_MANIFEST_DETAIL_ID ASC)') COMMIT(*NONE)

        /* START JOURNAL PHYSICAL FILE - PRKTESTF */
          /* STRJRNPF   FILE(PRKTESTF/PPBNCPPGUY) +
                          JRN(TESTJRN/PORKTEST) IMAGES(*AFTER)  +
                                                                +
             STRJRNPF   FILE(PRKTESTF/PPBNCPPSNT) +
                          JRN(TESTJRN/PORKTEST) IMAGES(*AFTER)  +
                                                                +
             STRJRNPF   FILE(PRKTESTF/PPBNCPPSTF) +
                          JRN(TESTJRN/PORKTEST) IMAGES(*AFTER)  +
                                                                +
             STRJRNPF   FILE(PRKTESTF/PPBNCPPSTJ) +
                          JRN(TESTJRN/PORKTEST) IMAGES(*AFTER)  +
                                                                +
             STRJRNPF   FILE(PRKTESTF/PPBNCPPSTS) +
                          JRN(TESTJRN/PORKTEST) IMAGES(*AFTER)  */

      /* FOR TPMTESTF ENV */
             RUNSQL     SQL('CREATE TABLE +
                          TPMTESTF/PFS_MANIFEST_DETAIL_GUY FOR +
                          SYSTEM NAME PPBNCPPGUY LIKE +
                          OMSDEVSQC/PPBNCPP RCDFMT @BNCPZK') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          TPMTESTF/PFS_MANIFEST_DETAIL_SNT FOR +
                          SYSTEM NAME PPBNCPPSNT LIKE +
                          OMSDEVSQC/PPBNCPP RCDFMT @BNCPZK') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          TPMTESTF/PFS_MANIFEST_DETAIL_STF FOR +
                          SYSTEM NAME PPBNCPPSTF LIKE +
                          OMSDEVSQC/PPBNCPP RCDFMT @BNCPZK') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          TPMTESTF/PFS_MANIFEST_DETAIL_STJ FOR +
                          SYSTEM NAME PPBNCPPSTJ LIKE +
                          OMSDEVSQC/PPBNCPP RCDFMT @BNCPZK') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          TPMTESTF/PFS_MANIFEST_DETAIL_STS FOR +
                          SYSTEM NAME PPBNCPPSTS LIKE +
                          OMSDEVSQC/PPBNCPP RCDFMT @BNCPZK') +
                          COMMIT(*NONE)

        /* CREATE INDEX FOR SUFFIX TABLE GUY/STF/STJ - TPMTESTF */
             RUNSQL     SQL('CREATE INDEX +
                          IX_PFS_MANIFEST_DETAIL_GUY_PFS_MANIFEST_ID_+
                          PFS_MANIFEST_DETAIL_ID ON +
                          TPMTESTF/PFS_MANIFEST_DETAIL_GUY +
                          (PFS_MANIFEST_ID ASC, +
                          PFS_MANIFEST_DETAIL_ID ASC)') COMMIT(*NONE)

             RUNSQL     SQL('CREATE INDEX +
                          IX_PFS_MANIFEST_DETAIL_STF_PFS_MANIFEST_ID_+
                          PFS_MANIFEST_DETAIL_ID ON +
                          TPMTESTF/PFS_MANIFEST_DETAIL_STF +
                          (PFS_MANIFEST_ID ASC, +
                          PFS_MANIFEST_DETAIL_ID ASC)') COMMIT(*NONE)

             RUNSQL     SQL('CREATE INDEX +
                          IX_PFS_MANIFEST_DETAIL_STJ_PFS_MANIFEST_ID_+
                          PFS_MANIFEST_DETAIL_ID ON +
                          TPMTESTF/PFS_MANIFEST_DETAIL_STJ +
                          (PFS_MANIFEST_ID ASC, +
                          PFS_MANIFEST_DETAIL_ID ASC)') COMMIT(*NONE)

        /* START JOURNAL PHYSICAL FILE - TPMTESTF */
          /* STRJRNPF   FILE(TPMTESTF/PPBNCPPGUY) +
                          JRN(TESTJRN/PORKTEST) IMAGES(*AFTER)  +
                                                                +
             STRJRNPF   FILE(TPMTESTF/PPBNCPPSNT) +
                          JRN(TESTJRN/PORKTEST) IMAGES(*AFTER)  +
                                                                +
             STRJRNPF   FILE(TPMTESTF/PPBNCPPSTF) +
                          JRN(TESTJRN/PORKTEST) IMAGES(*AFTER)  +
                                                                +
             STRJRNPF   FILE(TPMTESTF/PPBNCPPSTJ) +
                          JRN(TESTJRN/PORKTEST) IMAGES(*AFTER)  +
                                                                +
             STRJRNPF   FILE(TPMTESTF/PPBNCPPSTS) +
                          JRN(TESTJRN/PORKTEST) IMAGES(*AFTER)  */


      /* FOR PRKUATF ENV */
             RUNSQL     SQL('CREATE TABLE +
                          PRKUATF/PFS_MANIFEST_DETAIL_GUY FOR +
                          SYSTEM NAME PPBNCPPGUY LIKE +
                          OMSDEVSQC/PPBNCPP RCDFMT @BNCPZK') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          PRKUATF/PFS_MANIFEST_DETAIL_SNT FOR +
                          SYSTEM NAME PPBNCPPSNT LIKE +
                          OMSDEVSQC/PPBNCPP RCDFMT @BNCPZK') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          PRKUATF/PFS_MANIFEST_DETAIL_STF FOR +
                          SYSTEM NAME PPBNCPPSTF LIKE +
                          OMSDEVSQC/PPBNCPP RCDFMT @BNCPZK') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          PRKUATF/PFS_MANIFEST_DETAIL_STJ FOR +
                          SYSTEM NAME PPBNCPPSTJ LIKE +
                          OMSDEVSQC/PPBNCPP RCDFMT @BNCPZK') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          PRKUATF/PFS_MANIFEST_DETAIL_STS FOR +
                          SYSTEM NAME PPBNCPPSTS LIKE +
                          OMSDEVSQC/PPBNCPP RCDFMT @BNCPZK') +
                          COMMIT(*NONE)

        /* CREATE INDEX FOR SUFFIX TABLE GUY/STF/STJ - PRKUATF */
             RUNSQL     SQL('CREATE INDEX +
                          IX_PFS_MANIFEST_DETAIL_GUY_PFS_MANIFEST_ID_+
                          PFS_MANIFEST_DETAIL_ID ON +
                          PRKUATF/PFS_MANIFEST_DETAIL_GUY +
                          (PFS_MANIFEST_ID ASC, +
                          PFS_MANIFEST_DETAIL_ID ASC)') COMMIT(*NONE)

             RUNSQL     SQL('CREATE INDEX +
                          IX_PFS_MANIFEST_DETAIL_STF_PFS_MANIFEST_ID_+
                          PFS_MANIFEST_DETAIL_ID ON +
                          PRKUATF/PFS_MANIFEST_DETAIL_STF +
                          (PFS_MANIFEST_ID ASC, +
                          PFS_MANIFEST_DETAIL_ID ASC)') COMMIT(*NONE)

             RUNSQL     SQL('CREATE INDEX +
                          IX_PFS_MANIFEST_DETAIL_STJ_PFS_MANIFEST_ID_+
                          PFS_MANIFEST_DETAIL_ID ON +
                          PRKUATF/PFS_MANIFEST_DETAIL_STJ +
                          (PFS_MANIFEST_ID ASC, +
                          PFS_MANIFEST_DETAIL_ID ASC)') COMMIT(*NONE)

        /* START JOURNAL PHYSICAL FILE - PRKUATF */
          /* STRJRNPF   FILE(PRKUATF/PPBNCPPGUY) +
                          JRN(TESTJRN/PORKTEST) IMAGES(*AFTER)  +
                                                                +
             STRJRNPF   FILE(PRKUATF/PPBNCPPSNT) +
                          JRN(TESTJRN/PORKTEST) IMAGES(*AFTER)  +
                                                                +
             STRJRNPF   FILE(PRKUATF/PPBNCPPSTF) +
                          JRN(TESTJRN/PORKTEST) IMAGES(*AFTER)  +
                                                                +
             STRJRNPF   FILE(PRKUATF/PPBNCPPSTJ) +
                          JRN(TESTJRN/PORKTEST) IMAGES(*AFTER)  +
                                                                +
             STRJRNPF   FILE(PRKUATF/PPBNCPPSTS) +
                          JRN(TESTJRN/PORKTEST) IMAGES(*AFTER)  */

             ENDDO
             ENDDO      /* &DATA *NE 'PRKFLIB' */

  /***********************************/
  /*ˆPROD Environment Processing     */
  /***********************************/
             IF         COND(&DATA *EQ 'PRKFLIB') THEN(DO)
             CHKOBJ     OBJ(&DATA/PPBNCPPGUY) OBJTYPE(*FILE)
             MONMSG     MSGID(CPF9801) EXEC(DO)  /* NOT FOUND */

      /* FOR PRKFLIB ENV */
             RUNSQL     SQL('CREATE TABLE +
                          PRKFLIB/PFS_MANIFEST_DETAIL_GUY FOR +
                          SYSTEM NAME PPBNCPPGUY LIKE +
                          PRKFLIB/PPBNCPP RCDFMT @BNCPZK') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          PRKFLIB/PFS_MANIFEST_DETAIL_SNT FOR +
                          SYSTEM NAME PPBNCPPSNT LIKE +
                          PRKFLIB/PPBNCPP RCDFMT @BNCPZK') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          PRKFLIB/PFS_MANIFEST_DETAIL_STF FOR +
                          SYSTEM NAME PPBNCPPSTF LIKE +
                          PRKFLIB/PPBNCPP RCDFMT @BNCPZK') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          PRKFLIB/PFS_MANIFEST_DETAIL_STJ FOR +
                          SYSTEM NAME PPBNCPPSTJ LIKE +
                          PRKFLIB/PPBNCPP RCDFMT @BNCPZK') +
                          COMMIT(*NONE)
             RUNSQL     SQL('CREATE TABLE +
                          PRKFLIB/PFS_MANIFEST_DETAIL_STS FOR +
                          SYSTEM NAME PPBNCPPSTS LIKE +
                          PRKFLIB/PPBNCPP RCDFMT @BNCPZK') +
                          COMMIT(*NONE)

        /* CREATE INDEX FOR SUFFIX TABLE GUY/STF/STJ - PRKFLIB */
             RUNSQL     SQL('CREATE INDEX +
                          IX_PFS_MANIFEST_DETAIL_GUY_PFS_MANIFEST_ID_+
                          PFS_MANIFEST_DETAIL_ID ON +
                          PRKFLIB/PFS_MANIFEST_DETAIL_GUY +
                          (PFS_MANIFEST_ID ASC, +
                          PFS_MANIFEST_DETAIL_ID ASC)') COMMIT(*NONE)

             RUNSQL     SQL('CREATE INDEX +
                          IX_PFS_MANIFEST_DETAIL_STF_PFS_MANIFEST_ID_+
                          PFS_MANIFEST_DETAIL_ID ON +
                          PRKFLIB/PFS_MANIFEST_DETAIL_STF +
                          (PFS_MANIFEST_ID ASC, +
                          PFS_MANIFEST_DETAIL_ID ASC)') COMMIT(*NONE)

             RUNSQL     SQL('CREATE INDEX +
                          IX_PFS_MANIFEST_DETAIL_STJ_PFS_MANIFEST_ID_+
                          PFS_MANIFEST_DETAIL_ID ON +
                          PRKFLIB/PFS_MANIFEST_DETAIL_STJ +
                          (PFS_MANIFEST_ID ASC, +
                          PFS_MANIFEST_DETAIL_ID ASC)') COMMIT(*NONE)

        /* START JOURNAL PHYSICAL FILE - PRKFLIB */
         /*  STRJRNPF   FILE(PRKFLIB/PPBNCPPGUY) +
                          JRN(MIMIXPRK/PRKJRN) IMAGES(*AFTER)   +
                                                                +
             STRJRNPF   FILE(PRKFLIB/PPBNCPPSNT) +
                          JRN(MIMIXPRK/PRKJRN) IMAGES(*AFTER)   +
                                                                +
             STRJRNPF   FILE(PRKFLIB/PPBNCPPSTF) +
                          JRN(MIMIXPRK/PRKJRN) IMAGES(*AFTER)   +
                                                                +
             STRJRNPF   FILE(PRKFLIB/PPBNCPPSTJ) +
                          JRN(MIMIXPRK/PRKJRN) IMAGES(*AFTER)   +
                                                                +
             STRJRNPF   FILE(PRKFLIB/PPBNCPPSTS) +
                          JRN(MIMIXPRK/PRKJRN) IMAGES(*AFTER)   */

             ENDDO
             ENDDO      /* &DATA *EQ 'PRKFLIB' */

 ENDPGM:     ENDPGM
