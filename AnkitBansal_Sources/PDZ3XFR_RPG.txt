     H/TITLE EXT Fax Invoice ReprintXF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 02/14/20  Time  : 08:55:47
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDJ4CPL3IF  E           K        DISK
      * RSQ : WF Invoice List Work      Co,A/R #,Order
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPNF7REL4IF  E           K        DISK
      * RSQ : Cust Distribution Entry   Cust/DistCd/Type/Seq
      *
     FPDJYREL2IF  E           K        DISK
      * RTV : Company Defaults Internal Active Records
      *
     FPMAFCPL2IF  E           K        DISK
      * RSQ : WF Invoice/Combine Drv    Job/Co/CstPO/Shpto/Ord
      *
     FPMAFCPL0IF  E           K        DISK                      A
      * UPD : WF Invoice/Combine Drv    Update index
      *
     FPDJ4CPL0UF  E           K        DISK
      * UPD : WF Invoice List Work      Update index
      *
      * Long constants
     E                    @CN#    1  04  6   @CN    25
     I@J4CPOV
      * WF Invoice List Work      Co,A/R #,Order
      * Renamed input format fields
     I              J4B2VN                          WAB2VN
     I              J4C4NB                          WAC4NB
     I              J4JZVA                          WAJZVA
     I              J4A1WG                          WAA1WG
     I              J4BRTX                          WABRTX
     I              J4AETX                          WAAETX
     I              J4RLST                          WARLST
     I              J4CBC7                          WACBC7
     I              J4BKC7                          WABKC7
     I              J4AIC3                          WAAIC3
     I              J4CONB                          WACONB
     I              J4CEST                          WACEST
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@F7REN4
      * Cust Distribution Entry   Cust/DistCd/Type/Seq
      * Renamed input format fields
     I              F7BKC7                          WCBKC7
     I              F7MNAA                          WCMNAA
     I              F7RNNY                          WCRNNY
     I              F7WLT1                          WCWLT1
     I              F7IRST                          WCIRST
     I              F7WMT1                          WCWMT1
     I              F7VSST                          WCVSST
     I              F7MJDT                          WCMJDT
     I              F7BETM                          WCBETM
     I              F7CCVN                          WCCCVN
     I              F7CDVN                          WCCDVN
     I              F7MKDT                          WCMKDT
     I              F7BFTM                          WCBFTM
     I              F7CEVN                          WCCEVN
     I              F7CFVN                          WCCFVN
      *
     I@AFCPHT
      * WF Invoice/Combine Drv    Update index
      * Renamed input format fields
     I              AFB2VN                          WDB2VN
     I              AFDJVN                          WDDJVN
     I              AFC4NB                          WDC4NB
     I              AFAETX                          WDAETX
     I              AFJZVA                          WDJZVA
     I              AFA1WG                          WDA1WG
     I              AFBRTX                          WDBRTX
     I              AFRLST                          WDRLST
     I              AFHUSX                          WDHUSX
     I              AFBCNA                          WDBCNA
     I              AFA8TX                          WDA8TX
     I              AFBETX                          WDBETX
     I              AFGNDT                          WDGNDT
     I              AFBKC7                          WDBKC7
     I              AFEMC7                          WDEMC7
     I              AFAIC3                          WDAIC3
     I              AFCONB                          WDCONB
     I              AFCEST                          WDCEST
     I              AFVSST                          WDVSST
     I              AFMJDT                          WDMJDT
     I              AFBETM                          WDBETM
     I              AFCCVN                          WDCCVN
     I              AFCDVN                          WDCDVN
     I              AFMKDT                          WDMKDT
     I              AFBFTM                          WDBFTM
     I              AFCEVN                          WDCEVN
     I              AFCFVN                          WDCFVN
      *
     I@J4CPDG
      * WF Invoice List Work      Update index
      * Renamed input format fields
     I              J4B2VN                          WEB2VN
     I              J4C4NB                          WEC4NB
     I              J4JZVA                          WEJZVA
     I              J4A1WG                          WEA1WG
     I              J4BRTX                          WEBRTX
     I              J4AETX                          WEAETX
     I              J4RLST                          WERLST
     I              J4CBC7                          WECBC7
     I              J4BKC7                          WEBKC7
     I              J4AIC3                          WEAIC3
     I              J4CONB                          WECONB
     I              J4CEST                          WECEST
      *
     I@JYRECE
      * Company Defaults Internal Active Records
      * Renamed input format fields
     I              JYAIC3                          WFAIC3
     I              JYZ9ST                          WFZ9ST
     I              JYCSST                          WFCSST
     I              JYZ8ST                          WFZ8ST
     I              JYCXST                          WFCXST
     I              JYSWST                          WFSWST
     I              JYXXTM                          WFXXTM
     I              JYUECD                          WFUECD
     I              JYHSST                          WFHSST
     I              JYAMEO                          WFAMEO
     I              JYSSDF                          WFSSDF
     I              JYPDFT                          WFPDFT
     I              JYYISX                          WFYISX
     I              JYYJSX                          WFYJSX
     I              JYYKSX                          WFYKSX
     I              JYYLSX                          WFYLSX
     I              JYYMSX                          WFYMSX
     I              JYYNSX                          WFYNSX
     I              JYUVST                          WFUVST
     I              JYUWST                          WFUWST
     I              JYUXST                          WFUXST
     I              JYVSST                          WFVSST
     I              JYAATM                          WFAATM
     I              JYAYNA                          WFAYNA
     I              JYA0NA                          WFA0NA
     I              JYAXDT                          WFAXDT
      *
     I@AFCPHX
      * WF Invoice/Combine Drv    Job/Co/CstPO/Shpto/Ord
      * Renamed input format fields
     I              AFB2VN                          WGB2VN
     I              AFDJVN                          WGDJVN
     I              AFC4NB                          WGC4NB
     I              AFAETX                          WGAETX
     I              AFJZVA                          WGJZVA
     I              AFA1WG                          WGA1WG
     I              AFBRTX                          WGBRTX
     I              AFRLST                          WGRLST
     I              AFHUSX                          WGHUSX
     I              AFBCNA                          WGBCNA
     I              AFA8TX                          WGA8TX
     I              AFBETX                          WGBETX
     I              AFGNDT                          WGGNDT
     I              AFBKC7                          WGBKC7
     I              AFEMC7                          WGEMC7
     I              AFAIC3                          WGAIC3
     I              AFCONB                          WGCONB
     I              AFCEST                          WGCEST
     I              AFVSST                          WGVSST
     I              AFMJDT                          WGMJDT
     I              AFBETM                          WGBETM
     I              AFCCVN                          WGCCVN
     I              AFCDVN                          WGCDVN
     I              AFMKDT                          WGMKDT
     I              AFBFTM                          WGBFTM
     I              AFCEVN                          WGCEVN
     I              AFCFVN                          WGCFVN
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * Outward parameters
     IPARC        DS                              4
      * KEY : Customer EXT              Retrieval index
      * I : RST Ship To Customer
     I                                    P   1   40PABKC7
      *
     IQPMAF1    E DSPMAFCPL0
      * UPD : WF Invoice/Combine Drv    Update index
      * Renamed input format fields
     I              AFB2VN                          WDB2VN
     I              AFDJVN                          WDDJVN
     I              AFC4NB                          WDC4NB
     I              AFAETX                          WDAETX
     I              AFJZVA                          WDJZVA
     I              AFA1WG                          WDA1WG
     I              AFBRTX                          WDBRTX
     I              AFRLST                          WDRLST
     I              AFHUSX                          WDHUSX
     I              AFBCNA                          WDBCNA
     I              AFA8TX                          WDA8TX
     I              AFBETX                          WDBETX
     I              AFGNDT                          WDGNDT
     I              AFBKC7                          WDBKC7
     I              AFEMC7                          WDEMC7
     I              AFAIC3                          WDAIC3
     I              AFCONB                          WDCONB
     I              AFCEST                          WDCEST
     I              AFVSST                          WDVSST
     I              AFMJDT                          WDMJDT
     I              AFBETM                          WDBETM
     I              AFCCVN                          WDCCVN
     I              AFCDVN                          WDCDVN
     I              AFMKDT                          WDMKDT
     I              AFBFTM                          WDBFTM
     I              AFCEVN                          WDCEVN
     I              AFCFVN                          WDCFVN
      *
     IQPDJ41    E DSPDJ4CPL0
      * UPD : WF Invoice List Work      Update index
      * Renamed input format fields
     I              J4B2VN                          WEB2VN
     I              J4C4NB                          WEC4NB
     I              J4JZVA                          WEJZVA
     I              J4A1WG                          WEA1WG
     I              J4BRTX                          WEBRTX
     I              J4AETX                          WEAETX
     I              J4RLST                          WERLST
     I              J4CBC7                          WECBC7
     I              J4BKC7                          WEBKC7
     I              J4AIC3                          WEAIC3
     I              J4CONB                          WECONB
     I              J4CEST                          WECEST
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * B :  Company Number
     I                                    P   1   20P1AIC3
      * B :  Order Number
     I                                    P   3   60P1C4NB
      * B :  A/R Customer Number
     I                                    P   7  100P1ANC7
     IP2PARM      DS
      * I :  Printed Status
     I                                        1   1 P2C1ST
     IP3PARM      DS
      * B :  Job Name CDE
     I                                        1  10 P3B2VN
     IP4PARM      DS
      * I :  Cover Sheet Name
     I                                        1  10 P4LGTX
     IP5PARM      DS
      * I :  Use Credit Contact Info
     I                                        1   1 P5
     IP6PARM      DS
      * N :  Fax Area Code
     I                                        1   3 P6XDCD
     IP7PARM      DS
      * N :  Fax Phone Number
     I                                        1  25 P7LNTX
     IP8PARM      DS
      * N :  Fax Recipient
     I                                        1  25 P8LLTX
     IP9PARM      DS
      * FLD: WF Invoice/Combine Drv
      * B :  Job Number Cde
     I                                        1  10 P9DJVN
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM P1AIC3    WP0001  30       Company Number
     C           P1C4NB    PARM P1C4NB    WP0002  70       Order Number
     C           P1ANC7    PARM P1ANC7    WP0003  70       A/R Customer Nu
     C           P2C1ST    PARM           WP0004  1        Printed Status
     C           P3B2VN    PARM P3B2VN    WP0005 10        Job Name CDE
     C           P4LGTX    PARM           WP0006 10        Cover Sheet Nam
     C           P5        PARM           WP0007  1        Use Credit Cont
     C           P9DJVN    PARM P9DJVN    WP0008 10        Job Number Cde
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PRT Fax Invoice ReprintXF
      * RTV by A/R Customer    RT - WF Invoice List Work  * 
     C                     EXSR SARVGN
      * RTV InvRep Fax         RT - WF Invoice/Combine Drv  * 
     C                     EXSR SGRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV by A/R Customer    RT - WF Invoice List Work  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       A/R Customer Nu
     C                     MOVEL*BLANK    WN0002  1        Use Credit Cont
     C                     MOVEL*BLANK    WN0003  3        Fax Area Code
     C                     MOVEL*BLANK    WN0004 25        Fax Phone Numbe
     C                     MOVEL*BLANK    WN0005 25        Fax Recipient
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** Change Log
     C                     EXSR UASUBR                     ***** Change Lo
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
      * Establish starting position
     C           KRSSA     SETLL@J4CPOV                    *
     C           KRSSA     READE@J4CPOV                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2068' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Job Name same
      * CASE: DB1.Job Name CDE EQ PAR.Job Name CDE
     C           WAB2VN    IFEQ P3B2VN                     *IF
     C                     MOVEL*BLANK    YL0001           Spool File Sele
      * ship to customer on this file is really A/R Customer.
     C                     Z-ADDWABKC7    WN0001           A/R Customer Nu
      * Rtv One Invoice /PO   XP - Customer EXT  * 
     C                     CLEARPARC
     C                     Z-ADDWACBC7    PABKC7           Ship To Custome
      *
     C                     CALL 'PMCOXFR'              90  Rtv One Invoice
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Customer E
     C           YL0002    PARM *BLANK    WQ0001  1        One Invoice Per
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RTV Info for Invc Prt  RT - Order Header TRG  * 
     C                     EXSR SBRVGN
      * 4/15/19 RMC R14851 If customer has 1 One Email/Inv type - dont de
     C                     MOVEL'N'       YL0033           Status Flag 1
      * RTV One Email/inv     RT - Cust Distribution Entry  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWABKC7    WL0001           Ship To Custome
     C                     MOVEL@CN,001   WL0002    P      Distribution Co
     C                     Z-ADD1         WL0003           CDE Sequence Nu
     C                     MOVEL'O'       WL0004    P      CDE Destination
     C                     MOVELYL0033    WL0005    P      Status Flag 1
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    YL0033    P      Status Flag 1
      * print invoice
      * CASE:
      *  - c1 AND c2 AND c3 AND c4
      *   |- c1    : LCL.One Invoice Per PO is Yes
      *   |- c2    : LCL.Billing Activity Type is Invoice or Debit Memo
      *   |- c3    : DB1.Order Value Total is not equal to zeros
      *   |- c4    : DB1.Order Weight Total is Not equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0002    IFEQ 'Y'                        *IF
     C           YL0032    IFEQ '3'                        *IF
     C           YL0032    OREQ '1'
     C           WAJZVA    IFNE 0                          *IF
     C           WAA1WG    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SLM 122206 Add a record to the WF Invoice/Combine file
      *            only if onepo is Y
      *            and billing type is Y
      *            delete the WF Invoice record no longer needed
      * Crt WF Invoice/Combine CR - WF Invoice/Combine Drv  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP3B2VN    WL0006    P      Job Name CDE
     C                     MOVELP9DJVN    WL0007    P      Job Number Cde
     C                     Z-ADDWAC4NB    WL0008           Order Number
     C                     MOVELWAAETX    WL0009    P      Bill to Name
     C                     Z-ADDWAJZVA    WL0010           Order Value Tot
     C                     Z-ADDWAA1WG    WL0011           Order Weight To
     C                     MOVELWABRTX    WL0012    P      Ship To Name
     C                     MOVEL'Y'       WL0013    P      Fax Invoice Fla
     C                     MOVEL'Y'       WL0014    P      One Invoice Per
     C                     MOVELYL0021    WL0015    P      Customer Purcha
     C                     MOVEL'N'       WL0016    P      Combine Invoice
     C                     MOVELYL0032    WL0017    P      WF Inv/Comb Bil
     C                     Z-ADDYL0023    WL0018           Actual Shipped
     C                     Z-ADDWACBC7    WL0019           Ship To Custome
     C                     Z-ADDYL0013    WL0020           Bill to Custome
     C                     Z-ADDWAAIC3    WL0021           Company Number
     C                     Z-ADDWACONB    WL0022           Invoice Number
     C                     MOVELWACEST    WL0023    P      Invoice Suffix
     C                     MOVEL'A'       WL0024    P      Record Status
     C                     EXSR SDCRRC
      * DLT PD Invoice List Wk DL - WF Invoice List Work  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAB2VN    WL0025    P      Job Name CDE
     C                     Z-ADDWAC4NB    WL0026           Order Number
     C                     EXSR SEDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV CDD for Overlays   XF - Company Document Defaults  * 
     C                     CALL 'PMG9XFR'              90  RTV CDD for Ove
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0002  30       Company Number
     C                     PARM 'IN'      WQ0003  2        CDD Type
     C                     PARM 'INCFX1'  WQ0004  6        CDD Department
     C                     PARM *BLANK    WQ0005  8        CDD Name of Ove
     C           YL0034    PARM *BLANK    WQ0006 10        CDD Program Nam
     C           YL0035    PARM *BLANK    WQ0007 10        CDD Printer Fil
     C                     PARM *BLANK    WQ0008 10        CDD Additional
     C                     PARM *BLANK    WQ0009 25        CDD Sender Phon
     C                     PARM *BLANK    WQ0010 25        CDD Sender Fax
     C                     PARM *BLANK    WQ0011 10        Output Queue
     C                     PARM *BLANK    WQ0012  4        Hold File
     C                     PARM *BLANK    WQ0013  4        Save File
     C                     PARM *ZERO     WQ0014  30       Source Drawer
     C                     PARM *BLANK    WQ0015 10        Printer Device
     C                     PARM *ZERO     WQ0016  30       Page Length 2
     C                     PARM *ZERO     WQ0017  30       Page Width 2
     C                     PARM *ZERO     WQ0018  30       Page LPI
     C                     PARM *ZERO     WQ0019  31       Page CPI
     C                     PARM *ZERO     WQ0020  30       Page Overflow
     C                     PARM *BLANK    WQ0021  5        Page Rotation
     C                     PARM *BLANK    WQ0022 50        CDD Comment 1
     C                     PARM *BLANK    WQ0023 50        CDD Comment 2
     C                     PARM *BLANK    WQ0024 50        CDD Comment 3
     C                     PARM *BLANK    WQ0025 50        CDD Comment 4
     C                     PARM *BLANK    WQ0026 50        CDD Comment 5
     C                     PARM *BLANK    WQ0027  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMG9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.CDD Program Name is Not entered
     C           YL0034    IFEQ *BLANK                     *IF
      * PRT Inv/Fast Fax 6LPI  PF - Order Header TRG  * 
     C                     CALL 'PDVGPFR'              90  PRT Inv/Fast Fa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0028  30       Company Number
     C                     PARM WAC4NB    WQ0029  70       Order Number
     C                     PARM WN0001    WQ0030  70       A/R Customer Nu
     C           WUC1ST    PARM WUC1ST    WQ0031  1        Printed Status
     C                     PARM YL0033    WQ0032  1        Status Flag 1
     C                     PARM P3B2VN    WQ0033 10        Job Name CDE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDVGPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL@CN,002   YL0036           Spool File Sele
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0027           Company Number
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0028    YN0022    P      Plant Company S
     C                     MOVELWL0029    YL0037    P      Company Organiz
      * CASE: LCL.Company Organization is Daily's
     C           YL0037    IFEQ 'D'                        *IF
      * 062707 slm    /custom faxing pgm
      * PRT Inv/Fast Fax 8LPIDLPF - Order Header TRG  * 
     C                     CALL 'PMJHPFR'              90  PRT Inv/Fast Fa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0034  30       Company Number
     C                     PARM WAC4NB    WQ0035  70       Order Number
     C                     PARM WN0001    WQ0036  70       A/R Customer Nu
     C                     PARM WUC1ST    WQ0037  1        Printed Status
     C                     PARM P3B2VN    WQ0038 10        Job Name CDE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMJHPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0035    YL0036           Spool File Sele
     C                     ELSE
      * CASE: LCL.Company Organization is High Plains Biodiesel
     C           YL0037    IFEQ 'H'                        *IF
      * Print BOLs for fax for Cust if Ord from a meter reading whse
      *  meaning that it has RIN nbr that was just assigned in the invoic
      * PRT BillofLd-mlt/Fx/InvXF - Load Header  * 
     C                     CALL 'PMW1XFR'              90  PRT BillofLd-ml
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAB2VN    WQ0039 10        Job Name CDE
     C                     PARM WN0001    WQ0040  70       A/R Customer Nu
     C                     PARM WAAIC3    WQ0041  30       Company Number
     C           YL0001    PARM YL0001    WQ0042 10        Spool File Sele
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMW1XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Print Invoice to fax
      * 08/27/19 DN S15356-Added Parm 'Status Flag 1  Y/N' for One Email/
      * - We will delete the WF Invoice List Work record in PUNRPFR.
      * 12/18/19 DN S15948-Commented Out & Moved Below.
      * PRT Inv/Fast Fax 8LPIHPPF - Order Header TRG  * 
     C                     CALL 'PMROPFR'              90  PRT Inv/Fast Fa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0043  30       Company Number
     C                     PARM WAC4NB    WQ0044  70       Order Number
     C                     PARM WN0001    WQ0045  70       A/R Customer Nu
     C                     PARM WUC1ST    WQ0046  1        Printed Status
     C                     PARM WAB2VN    WQ0047 10        Job Name CDE
     C                     PARM YL0033    WQ0048  1        Status Flag 1
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMROPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0035    YL0036           Spool File Sele
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** Fax/email unless the amount and weight are zeros.   04/19/06 L
      * CASE: Select orders with weight or quantity
      *  - c1 AND c2
      *   |- c1    : DB1.Order Value Total is equal to zero
      *   |- c2    : DB1.Order Weight Total is Equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAJZVA    IFEQ 0                          *IF
     C           WAA1WG    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * PRC Fax One Customer   XF - Company Customer  * 
     C                     CALL 'PDVPXFR'              90  PRC Fax One Cus
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0049  30       Company Number
     C                     PARM WN0001    WQ0050  70       Ship To Custome
     C                     PARM YL0036    WQ0051 10        Spool File Sele
     C                     PARM P4LGTX    WQ0052 10        Cover Sheet Nam
     C           WN0005    PARM WN0005    WQ0053 25        Fax Recipient
     C           WN0003    PARM WN0003    WQ0054  3        Fax Area Code
     C           WN0004    PARM WN0004    WQ0055 25        Fax Phone Numbe
     C                     PARM YL0001    WQ0056 10        Spool File Sele
     C                     PARM WN0002    WQ0057  1        Use Credit Cont
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDVPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * 4/15/19 RMC R14851 If customer has One Email/Invoice call other r
      * Do new inv print/email -  1 email per invoice -NEW PRINTFILE PUMF
      * CASE: LCL.Status Flag 1  Y/N is Yes
     C           YL0033    IFEQ 'Y'                        *IF
      * print invoice - NEW ONE EMAIL/INVOICE
      * CASE:
      *  - c1 AND c2 AND c3 AND c4
      *   |- c1    : LCL.One Invoice Per PO is Yes
      *   |- c2    : LCL.Billing Activity Type is Invoice or Debit Memo
      *   |- c3    : DB1.Order Value Total is not equal to zeros
      *   |- c4    : DB1.Order Weight Total is Not equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0002    IFEQ 'Y'                        *IF
     C           YL0032    IFEQ '3'                        *IF
     C           YL0032    OREQ '1'
     C           WAJZVA    IFNE 0                          *IF
     C           WAA1WG    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SLM 122206 Add a record to the WF Invoice/Combine file
      *            only if onepo is Y
      *            and billing type is Y
      *            delete the WF Invoice record no longer needed
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV CDD for Overlays   XF - Company Document Defaults  * 
     C                     CALL 'PMG9XFR'              90  RTV CDD for Ove
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0058  30       Company Number
     C                     PARM 'IN'      WQ0059  2        CDD Type
     C                     PARM 'INCFX1'  WQ0060  6        CDD Department
     C                     PARM *BLANK    WQ0061  8        CDD Name of Ove
     C           YL0034    PARM *BLANK    WQ0062 10        CDD Program Nam
     C           YL0035    PARM *BLANK    WQ0063 10        CDD Printer Fil
     C                     PARM *BLANK    WQ0064 10        CDD Additional
     C                     PARM *BLANK    WQ0065 25        CDD Sender Phon
     C                     PARM *BLANK    WQ0066 25        CDD Sender Fax
     C                     PARM *BLANK    WQ0067 10        Output Queue
     C                     PARM *BLANK    WQ0068  4        Hold File
     C                     PARM *BLANK    WQ0069  4        Save File
     C                     PARM *ZERO     WQ0070  30       Source Drawer
     C                     PARM *BLANK    WQ0071 10        Printer Device
     C                     PARM *ZERO     WQ0072  30       Page Length 2
     C                     PARM *ZERO     WQ0073  30       Page Width 2
     C                     PARM *ZERO     WQ0074  30       Page LPI
     C                     PARM *ZERO     WQ0075  31       Page CPI
     C                     PARM *ZERO     WQ0076  30       Page Overflow
     C                     PARM *BLANK    WQ0077  5        Page Rotation
     C                     PARM *BLANK    WQ0078 50        CDD Comment 1
     C                     PARM *BLANK    WQ0079 50        CDD Comment 2
     C                     PARM *BLANK    WQ0080 50        CDD Comment 3
     C                     PARM *BLANK    WQ0081 50        CDD Comment 4
     C                     PARM *BLANK    WQ0082 50        CDD Comment 5
     C                     PARM *BLANK    WQ0083  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMG9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.CDD Program Name is Not entered
     C           YL0034    IFEQ *BLANK                     *IF
      * wf invoice list gets deleted in this prtf
      * PRT Inv/Email6LPI-1 em PF - Order Header TRG  * 
     C                     CALL 'PUMFPFR'              90  PRT Inv/Email6L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0084  30       Company Number
     C                     PARM WAC4NB    WQ0085  70       Order Number
     C                     PARM WN0001    WQ0086  70       A/R Customer Nu
     C           WUC1ST    PARM WUC1ST    WQ0087  1        Printed Status
     C                     PARM P3B2VN    WQ0088 10        Job Name CDE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUMFPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL@CN,003   YL0036           Spool File Sele
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0027           Company Number
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0028    YN0022    P      Plant Company S
     C                     MOVELWL0029    YL0037    P      Company Organiz
      * 08/26/19 DN S15356-HPB Now Have Access to use ONE EMAIL/INVOICE.
      * CASE: LCL.Company Organization is High Plains Biodiesel
     C           YL0037    IFEQ 'H'                        *IF
      * HPB is now Seaboard Energy as of 6/11/2019.
      * Print BOLs for fax for Cust if Ord from a meter reading whse
      *  meaning that it has RIN nbr that was just assigned in the invoic
      * PRT BillLd-mlt/Fx/InvSEXF - Load Header  * 
     C                     CALL 'PUNSXFR'              90  PRT BillLd-mlt/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAB2VN    WQ0089 10        Job Name CDE
     C                     PARM WN0001    WQ0090  70       A/R Customer Nu
     C                     PARM WAAIC3    WQ0091  30       Company Number
     C                     PARM WAC4NB    WQ0092  70       Order Number
     C           YL0001    PARM YL0001    WQ0093 10        Spool File Sele
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUNSXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Print Invoice to fax
      * PRT Inv/Fast Fax 8LPISEPF - Order Header TRG  * 
     C                     CALL 'PUNRPFR'              90  PRT Inv/Fast Fa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0094  30       Company Number
     C                     PARM WAC4NB    WQ0095  70       Order Number
     C                     PARM WN0001    WQ0096  70       A/R Customer Nu
     C                     PARM WUC1ST    WQ0097  1        Printed Status
     C                     PARM P3B2VN    WQ0098 10        Job Name CDE
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUNRPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL@CN,004   YL0036           Spool File Sele
     C                     END                             *FI
     C                     END                             *FI
      * ** Fax/email unless the amount and weight are zeros.   04/19/06 L
      * CASE: Select orders with weight or quantity
      *  - c1 AND c2
      *   |- c1    : DB1.Order Value Total is equal to zero
      *   |- c2    : DB1.Order Weight Total is Equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAJZVA    IFEQ 0                          *IF
     C           WAA1WG    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * PRC Eml One inv /eml  XF - Company Customer  * 
     C                     CALL 'PUMGXFR'              90  PRC Eml One inv
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0099  30       Company Number
     C                     PARM WN0001    WQ0100  70       Ship To Custome
     C                     PARM YL0036    WQ0101 10        Spool File Sele
     C                     PARM P4LGTX    WQ0102 10        Cover Sheet Nam
     C           WN0005    PARM WN0005    WQ0103 25        Fax Recipient
     C           WN0003    PARM WN0003    WQ0104  3        Fax Area Code
     C           WN0004    PARM WN0004    WQ0105 25        Fax Phone Numbe
     C                     PARM YL0001    WQ0106 10        Spool File Sele
     C                     PARM WN0002    WQ0107  1        Use Credit Cont
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUMGXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@J4CPOV                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Info for Invc Prt  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     Z-ADDWAC4NB    WBC4NB           Order Number
      * Establish starting position
     C           KRSSB     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0003           Order Type - Sa
     C                     Z-ADD*ZERO     YL0004           A/R Customer Nu
     C                     Z-ADD*ZERO     YL0005           Ship To Custome
     C                     MOVEL*BLANK    YL0006           Ship To Name
     C                     MOVEL*BLANK    YL0007           Ship To Address
     C                     MOVEL*BLANK    YL0008           Ship To Address
     C                     MOVEL*BLANK    YL0009           Ship To Address
     C                     MOVEL*BLANK    YL0010           Ship To City
     C                     MOVEL*BLANK    YL0011           Ship To State C
     C                     MOVEL*BLANK    YL0012           Ship To Zip/Pos
     C                     Z-ADD*ZERO     YL0013           Bill to Custome
     C                     MOVEL*BLANK    YL0014           Bill to Name
     C                     MOVEL*BLANK    YL0015           Bill to Address
     C                     MOVEL*BLANK    YL0016           Bill to Address
     C                     MOVEL*BLANK    YL0017           Bill to Address
     C                     MOVEL*BLANK    YL0018           Bill to City
     C                     MOVEL*BLANK    YL0019           Bill to State C
     C                     MOVEL*BLANK    YL0020           Bill to Zip/Pos
     C                     MOVEL*BLANK    YL0021           Customer Purcha
     C                     Z-ADD*ZERO     YL0022           Order Date
     C                     Z-ADD*ZERO     YL0023           Actual Shipped
     C                     MOVEL*BLANK    YL0024           Terms Code
     C                     MOVEL*BLANK    YL0025           Carrier Code
     C                     Z-ADD*ZERO     YL0026           Order Value Tot
     C                     Z-ADD*ZERO     YL0027           Order Weight To
     C                     Z-ADD*ZERO     YL0028           Load ID
     C                     MOVEL*BLANK    YL0029           Sales Route Cod
     C                     Z-ADD*ZERO     YL0030           Invoice Number
     C                     Z-ADD*ZERO     YL0031           Invoice Date
     C                     MOVEL*BLANK    YL0032           Billing Activit
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBJNCD    YL0003           Order Type - Sa
     C                     Z-ADDWBANC7    YL0004           A/R Customer Nu
     C                     Z-ADDWBBKC7    YL0005           Ship To Custome
     C                     MOVELWBBRTX    YL0006           Ship To Name
     C                     MOVELWBHMNA    YL0007           Ship To Address
     C                     MOVELWBHONA    YL0008           Ship To Address
     C                     MOVELWBHPNA    YL0009           Ship To Address
     C                     MOVELWBHNNA    YL0010           Ship To City
     C                     MOVELWBDBCD    YL0011           Ship To State C
     C                     MOVELWBCKTX    YL0012           Ship To Zip/Pos
     C                     Z-ADDWBB0C7    YL0013           Bill to Custome
     C                     MOVELWBAETX    YL0014           Bill to Name
     C                     MOVELWBB1NA    YL0015           Bill to Address
     C                     MOVELWBB3NA    YL0016           Bill to Address
     C                     MOVELWBB4NA    YL0017           Bill to Address
     C                     MOVELWBB2NA    YL0018           Bill to City
     C                     MOVELWBBHCD    YL0019           Bill to State C
     C                     MOVELWBC8TX    YL0020           Bill to Zip/Pos
     C                     MOVELWBBCNA    YL0021           Customer Purcha
     C                     Z-ADDWBA0DT    YL0022           Order Date
     C                     Z-ADDWBGNDT    YL0023           Actual Shipped
     C                     MOVELWBAQCD    YL0024           Terms Code
     C                     MOVELWBBZNA    YL0025           Carrier Code
     C                     Z-ADDWBJZVA    YL0026           Order Value Tot
     C                     Z-ADDWBA1WG    YL0027           Order Weight To
     C                     Z-ADDWBRMNB    YL0028           Load ID
     C                     MOVELWBR4CD    YL0029           Sales Route Cod
     C                     Z-ADDWBCONB    YL0030           Invoice Number
     C                     Z-ADDWBAWDT    YL0031           Invoice Date
     C                     MOVELWBOBST    YL0032           Billing Activit
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV One Email/inv     RT - Cust Distribution Entry  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WL0005           Status Flag 1
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCBKC7    WQSC01           Ship To Custome
     C           *LIKE     DEFN WCMNAA    WQSC02           Distribution Co
     C           *LIKE     DEFN WCIRST    WQSC03           CDE Destination
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           Ship To Custome
     C                     KFLD           WQSC02           Distribution Co
     C                     KFLD           WQSC03           CDE Destination
     C                     KFLD           WCRNNY           CDE Sequence Nu
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Ship To Custome
     C                     KFLD           WQSC02           Distribution Co
     C                     KFLD           WQSC03           CDE Destination
      * Setup key
     C                     Z-ADDWL0001    WQSC01           Ship To Custome
     C                     MOVELWL0002    WQSC02           Distribution Co
     C                     MOVELWL0004    WQSC03           CDE Destination
     C                     Z-ADDWL0003    WCRNNY           CDE Sequence Nu
      * Establish starting position
     C           KPSSC     SETLL@F7REN4                    *
     C           KRSSC     READE@F7REN4                  90*
      * Data record not found
     C   90                MOVEL'USR4289' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Return 1st active record with an email address- set matching par
      * CASE: DB1.CDE Destination Type EQ PAR.CDE Destination Type
     C           WCIRST    IFEQ WL0004                     *IF
      * CASE: DB1.Record Status is Active
     C           WCVSST    IFEQ 'A'                        *IF
     C                     MOVEL'Y'       WL0005           Status Flag 1
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSC     READE@F7REN4                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCRRC    BEGSR
      *================================================================
      * Crt WF Invoice/Combine CR - WF Invoice/Combine Drv  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0006  70       Create Date
     C                     Z-ADD*ZERO     WN0007  60       Create Time
     C                     MOVEL*BLANK    WN0008 10        Create User
     C                     MOVEL*BLANK    WN0009 10        Create Program
     C                     Z-ADD*ZERO     WN0010  70       Change Date
     C                     Z-ADD*ZERO     WN0011  60       Change Time
     C                     MOVEL*BLANK    WN0012 10        Change User
     C                     MOVEL*BLANK    WN0013 10        Change Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AFCPHT
     C                     MOVELWL0006    WDB2VN           Job Name CDE
     C                     MOVELWL0007    WDDJVN           Job Number Cde
     C                     Z-ADDWL0008    WDC4NB           Order Number
     C                     MOVELWL0009    WDAETX           Bill to Name
     C                     Z-ADDWL0010    WDJZVA           Order Value Tot
     C                     Z-ADDWL0011    WDA1WG           Order Weight To
     C                     MOVELWL0012    WDBRTX           Ship To Name
     C                     MOVELWL0013    WDRLST           Fax Invoice Fla
     C                     MOVELWL0014    WDHUSX           One Invoice Per
     C                     MOVELWL0015    WDBCNA           Customer Purcha
     C                     MOVELWL0016    WDA8TX           Combine Invoice
     C                     MOVELWL0017    WDBETX           WF Inv/Comb Bil
     C                     Z-ADDWL0018    WDGNDT           Actual Shipped
     C                     Z-ADDWL0019    WDBKC7           Ship To Custome
     C                     Z-ADDWL0020    WDEMC7           Bill to Custome
     C                     Z-ADDWL0021    WDAIC3           Company Number
     C                     Z-ADDWL0022    WDCONB           Invoice Number
     C                     MOVELWL0023    WDCEST           Invoice Suffix
     C                     MOVELWL0024    WDVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WDVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WDMJDT           Create Date
     C                     Z-ADD##JTM     WDBETM           Create Time
     C                     MOVEL##USR     WDCCVN           Create User
     C                     MOVEL##PGM     WDCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD0         WDMKDT           Change Date
     C                     Z-ADD0         WDBFTM           Change Time
     C                     MOVEL*BLANK    WDCEVN           Change User
     C                     MOVEL*BLANK    WDCFVN           Change Program
     C           KLCRSD    KLIST
     C                     KFLD           WDB2VN           Job Name CDE
     C                     KFLD           WDDJVN           Job Number Cde
     C                     KFLD           WDC4NB           Order Number
      * Check for duplicate primary key
     C           KLCRSD    SETLL@AFCPHT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3672' W0RTN   7
      * Send message 'WF Invoice/Combine Drv EX'
     C                     MOVEL'USR3672' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C                     WRITE@AFCPHT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SEDLRC    BEGSR
      *================================================================
      * DLT PD Invoice List Wk DL - WF Invoice List Work  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @J4CPDG
     C                     MOVELWL0025    WEB2VN           Job Name CDE
     C                     Z-ADDWL0026    WEC4NB           Order Number
      *
     C           KLDLSE    KLIST
     C                     KFLD           WEB2VN           Job Name CDE
     C                     KFLD           WEC4NB           Order Number
     C           KLDLSE    CHAIN@J4CPDG              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDJ4CPL0'MDACP
     C                     MOVEL'@J4CPDG' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@J4CPDG                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Plant Co/Org      RT - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0027    WFAIC3           Company Number
      * Establish starting position
     C           KRSSF     CHAIN@JYRECE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2025' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0028           Plant Company S
     C                     MOVEL*BLANK    WL0029           Company Organiz
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFYISX    WL0028           Plant Company S
     C                     MOVELWFYJSX    WL0029           Company Organiz
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV InvRep Fax         RT - WF Invoice/Combine Drv  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0014  70       A/R Customer Nu
     C                     MOVEL*BLANK    WN0015  1        Use Credit Cont
     C                     MOVEL*BLANK    WN0016  3        Fax Area Code
     C                     MOVEL*BLANK    WN0017 25        Fax Phone Numbe
     C                     MOVEL*BLANK    WN0018 25        Fax Recipient
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGB2VN    WQSG01           Job Name CDE
     C           *LIKE     DEFN WGDJVN    WQSG02           Job Number Cde
     C           *LIKE     DEFN WGAIC3    WQSG03           Company Number
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Job Name CDE
     C                     KFLD           WQSG02           Job Number Cde
     C                     KFLD           WQSG03           Company Number
      * Setup key
     C                     MOVELP3B2VN    WQSG01           Job Name CDE
     C                     MOVELP9DJVN    WQSG02           Job Number Cde
     C                     Z-ADDP1AIC3    WQSG03           Company Number
      * Establish starting position
     C           KRSSG     SETLL@AFCPHX                    *
     C           KRSSG     READE@AFCPHX                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3671' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'N'       YL0038           Break
      * This process is already restricting by Job and company
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.WF Inv/Comb Billing Type is Invoice or Debit Mem
      *   |- c2    : DB1.One Invoice Per PO is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WGBETX    IFEQ '3'                        *IF
     C           WGBETX    OREQ '1'
     C           WGHUSX    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * BRK: Actual Shipped Date/Ship To Customer/Customer PO
      * CASE: LCL.Actual Shipped Date NE DB1.Actual Shipped Date
     C           YL0039    IFNE WGGNDT                     *IF
     C                     MOVEL'Y'       YL0038           Break
     C                     ELSE
      * CASE: LCL.Ship To Customer NE DB1.Ship To Customer
     C           YL0040    IFNE WGBKC7                     *IF
     C                     MOVEL'Y'       YL0038           Break
     C                     ELSE
      * CASE: LCL.Customer Purchase Order # NE DB1.Customer Purchase Orde
     C           YL0041    IFNE WGBCNA                     *IF
     C                     MOVEL'Y'       YL0038           Break
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * FAX or Email: Invoice
      * Print the combined invoice on break
      * CASE: LCL.Break is Yes
     C           YL0038    IFEQ 'Y'                        *IF
      * * first logic break, only print combined invoice when the ship to
      * * or customer po or actual ship date changes
      * PRT Inv/Fast FaxCMB 6LPPF - Order Header TRG  * 
     C                     CALL 'PMCKPFR'              90  PRT Inv/Fast Fa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WGAIC3    WQ0108  30       Company Number
     C                     PARM WGC4NB    WQ0109  70       Order Number
     C                     PARM WGBKC7    WQ0110  70       Ship To Custome
     C                     PARM WGBCNA    WQ0111 15        Customer Purcha
     C                     PARM WGGNDT    WQ0112  70       Actual Shipped
     C           YL0042    PARM YL0042    WQ0113  1        Printed Status
     C                     PARM WGB2VN    WQ0114 10        Job Name CDE
     C                     PARM WGDJVN    WQ0115 10        Job Number Cde
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCKPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PRC Fax One Cust Combo XF - Company Customer  * 
     C                     CALL 'PMC6XFR'              90  PRC Fax One Cus
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WGAIC3    WQ0116  30       Company Number
     C                     PARM WGEMC7    WQ0117  70       Ship To Custome
     C           WN0018    PARM WN0018    WQ0118 25        Fax Recipient
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMC6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDWGBKC7    YL0040           Ship To Custome
     C                     MOVELWGBCNA    YL0041           Customer Purcha
     C                     Z-ADDWGGNDT    YL0039           Actual Shipped
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSG     READE@AFCPHX                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change Log
      *================================================================
      * *****
      * ** R14851 RMC 4/16/19  NEW PROCESS TO SEND ONE EMAIL/INVOICE - NE
      *    CDE Destination Type of "O", new printfile for Inv PUMFPFR, ne
      *    process PUMGXFR
      * *****
      * ** 04/01/2010 LJB P000198 (sub task: E000673)
      * ** Change to fax and/or email to one or multiple recipients.
      * ** Now stored in Cust Distribution Entry file.
      * ** Delete spooled files in this function AFTER all faxes
      * ** and emails have been sent.
      * *****
      * ** FP1110 RMC 7/21/08  HPB Only - fax bol with invoice, use
      * ** spool file selection 2 parm to pass to cl
      * *****
      * ** 04/19/2006 LJB
      * ** Don't fax if the amount and weight are zeros.
      * ** There is no spooled file so the program errs out.
      * *****
      * ** 05/16/2006 LJB
      * ** The fax work fields have been changed from 12 to 25 characters
      * *****
      * ** 07/02/2007 SLM DLY029 invoice (std and custom)invoice faxing
      * *****
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P6XDCD           Fax Area Code
     C                     MOVEL*BLANK    P7LNTX           Fax Phone Numbe
     C                     MOVEL*BLANK    P8LLTX           Fax Recipient
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WACBC7           Ship to Custome
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WACONB           Invoice Number
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A/R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WBNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WBNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WBNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WBNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WBBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WBBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCRNNY           CDE Sequence Nu
     C                     Z-ADD*ZERO     WCMJDT           Create Date
     C                     Z-ADD*ZERO     WCBETM           Create Time
     C                     Z-ADD*ZERO     WCMKDT           Change Date
     C                     Z-ADD*ZERO     WCBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WDA1WG           Order Weight To
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDEMC7           Bill to Custome
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
     C                     Z-ADD*ZERO     WDMJDT           Create Date
     C                     Z-ADD*ZERO     WDBETM           Create Time
     C                     Z-ADD*ZERO     WDMKDT           Change Date
     C                     Z-ADD*ZERO     WDBFTM           Change Time
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Printed Status
     C                     MOVEL*BLANK    WUC1ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFXXTM           Departure Time
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  70
     C                     MOVEL*BLANK    WL0002 10
     C                     Z-ADD*ZERO     WL0003  30
     C                     MOVEL*BLANK    WL0004  1
     C                     MOVEL*BLANK    WL0005  1
      * Define local variables for subroutine SDCRRC.
     C                     MOVEL*BLANK    WL0006 10
     C                     MOVEL*BLANK    WL0007 10
     C                     Z-ADD*ZERO     WL0008  70
     C                     MOVEL*BLANK    WL0009 30
     C                     Z-ADD*ZERO     WL0010 112
     C                     Z-ADD*ZERO     WL0011 112
     C                     MOVEL*BLANK    WL0012 30
     C                     MOVEL*BLANK    WL0013  1
     C                     MOVEL*BLANK    WL0014  1
     C                     MOVEL*BLANK    WL0015 15
     C                     MOVEL*BLANK    WL0016  1
     C                     MOVEL*BLANK    WL0017  1
     C                     Z-ADD*ZERO     WL0018  70
     C                     Z-ADD*ZERO     WL0019  70
     C                     Z-ADD*ZERO     WL0020  70
     C                     Z-ADD*ZERO     WL0021  30
     C                     Z-ADD*ZERO     WL0022  70
     C                     MOVEL*BLANK    WL0023  2
     C                     MOVEL*BLANK    WL0024  1
      * Define local variables for subroutine SEDLRC.
     C                     MOVEL*BLANK    WL0025 10
     C                     Z-ADD*ZERO     WL0026  70
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0027  30
     C                     MOVEL*BLANK    WL0028  1
     C                     MOVEL*BLANK    WL0029  1
      * Define local work field Spool File Selection 2
     C                     MOVEL*BLANK    YL0001 10
      * Define local work field One Invoice Per PO
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Order Type - Sales
     C                     MOVEL*BLANK    YL0003  2
      * Define local work field A/R Customer Number
     C                     Z-ADD*ZERO     YL0004  70
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field Ship To Name
     C                     MOVEL*BLANK    YL0006 30
      * Define local work field Ship To Address Line 1
     C                     MOVEL*BLANK    YL0007 30
      * Define local work field Ship To Address Line 2
     C                     MOVEL*BLANK    YL0008 30
      * Define local work field Ship To Address Line 3
     C                     MOVEL*BLANK    YL0009 30
      * Define local work field Ship To City
     C                     MOVEL*BLANK    YL0010 20
      * Define local work field Ship To State Code
     C                     MOVEL*BLANK    YL0011  2
      * Define local work field Ship To Zip/Postal Code
     C                     MOVEL*BLANK    YL0012 11
      * Define local work field Bill to Customer
     C                     Z-ADD*ZERO     YL0013  70
      * Define local work field Bill to Name
     C                     MOVEL*BLANK    YL0014 30
      * Define local work field Bill to Address Line 1
     C                     MOVEL*BLANK    YL0015 30
      * Define local work field Bill to Address Line 2
     C                     MOVEL*BLANK    YL0016 30
      * Define local work field Bill to Address Line 3
     C                     MOVEL*BLANK    YL0017 30
      * Define local work field Bill to City
     C                     MOVEL*BLANK    YL0018 20
      * Define local work field Bill to State Code
     C                     MOVEL*BLANK    YL0019  2
      * Define local work field Bill to Zip/Postal Code
     C                     MOVEL*BLANK    YL0020 11
      * Define local work field Customer Purchase Order #
     C                     MOVEL*BLANK    YL0021 15
      * Define local work field Order Date
     C                     Z-ADD*ZERO     YL0022  70
      * Define local work field Actual Shipped Date
     C                     Z-ADD*ZERO     YL0023  70
      * Define local work field Terms Code
     C                     MOVEL*BLANK    YL0024  2
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0025  3
      * Define local work field Order Value Total
     C                     Z-ADD*ZERO     YL0026 112
      * Define local work field Order Weight Total
     C                     Z-ADD*ZERO     YL0027 112
      * Define local work field Load ID
     C                     Z-ADD*ZERO     YL0028  70
      * Define local work field Sales Route Code
     C                     MOVEL*BLANK    YL0029  3
      * Define local work field Invoice Number
     C                     Z-ADD*ZERO     YL0030  70
      * Define local work field Invoice Date
     C                     Z-ADD*ZERO     YL0031  70
      * Define local work field Billing Activity Type
     C                     MOVEL*BLANK    YL0032  1
      * Define local work field Status Flag 1  Y/N
     C                     MOVEL*BLANK    YL0033  1
      * Define null work field CDD Name of Overlay
     C                     MOVEL*BLANK    YN0001  8
      * Define local work field CDD Program Name
     C                     MOVEL*BLANK    YL0034 10
      * Define local work field CDD Printer File Name
     C                     MOVEL*BLANK    YL0035 10
      * Define null work field CDD Additional Object
     C                     MOVEL*BLANK    YN0002 10
      * Define null work field CDD Sender Phone
     C                     MOVEL*BLANK    YN0003 25
      * Define null work field CDD Sender Fax
     C                     MOVEL*BLANK    YN0004 25
      * Define null work field Output Queue
     C                     MOVEL*BLANK    YN0005 10
      * Define null work field Hold File
     C                     MOVEL*BLANK    YN0006  4
      * Define null work field Save File
     C                     MOVEL*BLANK    YN0007  4
      * Define null work field Source Drawer
     C                     Z-ADD*ZERO     YN0008  30
      * Define null work field Printer Device Type
     C                     MOVEL*BLANK    YN0009 10
      * Define null work field Page Length 2
     C                     Z-ADD*ZERO     YN0010  30
      * Define null work field Page Width 2
     C                     Z-ADD*ZERO     YN0011  30
      * Define null work field Page LPI
     C                     Z-ADD*ZERO     YN0012  30
      * Define null work field Page CPI
     C                     Z-ADD*ZERO     YN0013  31
      * Define null work field Page Overflow
     C                     Z-ADD*ZERO     YN0014  30
      * Define null work field Page Rotation
     C                     MOVEL*BLANK    YN0015  5
      * Define null work field CDD Comment 1
     C                     MOVEL*BLANK    YN0016 50
      * Define null work field CDD Comment 2
     C                     MOVEL*BLANK    YN0017 50
      * Define null work field CDD Comment 3
     C                     MOVEL*BLANK    YN0018 50
      * Define null work field CDD Comment 4
     C                     MOVEL*BLANK    YN0019 50
      * Define null work field CDD Comment 5
     C                     MOVEL*BLANK    YN0020 50
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0021  1
      * Define local work field Spool File Selection
     C                     MOVEL*BLANK    YL0036 10
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0022  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0037  1
      * Define local work field Break
     C                     MOVEL*BLANK    YL0038  1
      * Define local work field Actual Shipped Date
     C                     Z-ADD*ZERO     YL0039  70
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0040  70
      * Define local work field Customer Purchase Order #
     C                     MOVEL*BLANK    YL0041 15
      * Define local work field Status - Y or N
     C                     MOVEL*BLANK    YL0042  1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 AR-INVOICE
00002 PDVGPFR$
00003 PUMFPFR$
00004 PUNRPFR$
