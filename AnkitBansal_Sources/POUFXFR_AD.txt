// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for POUFXFR
// ?Date: 14.08.2025 Time: 03:39:03
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(Rtv Order Prod Sched  RT) TYPE(RTVOBJ) FILE(PDKNCPP)           AC1648127;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Order_Number);
PARAMETER(PAR.Order_Sequence_Number);
PARAMETER(PAR.Order_Secondary_Line_Seq);
PARAMETER(PAR.USR_Day_1);
PARAMETER(PAR.USR_Day_2);
PARAMETER(PAR.USR_Day_3);
PARAMETER(PAR.USR_Day_4);
PARAMETER(PAR.USR_Day_5);
PARAMETER(PAR.USR_Day_6);
PARAMETER(PAR.Qty_Sched_Ord_1_USR);
PARAMETER(PAR.Qty_Sched_Ord_2_USR);
PARAMETER(PAR.Qty_Sched_Ord_3_USR);
PARAMETER(PAR.Qty_Sched_Ord_4_USR);
PARAMETER(PAR.Qty_Sched_Ord_5_USR);
PARAMETER(PAR.Qty_Sched_Ord_6_USR);
PARAMETER(PAR.OD_Added_to_Sched_Today);
PARAMETER(PAR.Production_USR);
PARAMETER(PAR.Inv_Total_USR);
{
 //?USER: Initialize routine

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 //?Production
 CASE;

 // IF DB1.OD Production Date EQ PAR.USR Day 1
 IF DB1.OD_Production_Date = PAR.USR_Day_1;

 // PAR.Qty Sched Ord 1 USR = DB1.OD Quantity Scheduled
 PAR.Qty_Sched_Ord_1_USR = DB1.OD_Qty_Cnsmd_Pieces_Sched;

 //?Production
 // IF DB1.OD Production Date EQ PAR.USR Day 2
 IF DB1.OD_Production_Date = PAR.USR_Day_2;

 // PAR.Qty Sched Ord 2 USR = DB1.OD Quantity Scheduled
 PAR.Qty_Sched_Ord_2_USR = DB1.OD_Qty_Cnsmd_Pieces_Sched;

 //?Production
 // IF DB1.OD Production Date EQ PAR.USR Day 3
 IF DB1.OD_Production_Date = PAR.USR_Day_3;

 // PAR.Qty Sched Ord 3 USR = DB1.OD Quantity Scheduled
 PAR.Qty_Sched_Ord_3_USR = DB1.OD_Qty_Cnsmd_Pieces_Sched;

 //?Production
 // IF DB1.OD Production Date EQ PAR.USR Day 4
 IF DB1.OD_Production_Date = PAR.USR_Day_4;

 // PAR.Qty Sched Ord 4 USR = DB1.OD Quantity Scheduled
 PAR.Qty_Sched_Ord_4_USR = DB1.OD_Qty_Cnsmd_Pieces_Sched;

 //?Production
 // IF DB1.OD Production Date EQ PAR.USR Day 5
 IF DB1.OD_Production_Date = PAR.USR_Day_5;

 // PAR.Qty Sched Ord 5 USR = DB1.OD Quantity Scheduled
 PAR.Qty_Sched_Ord_5_USR = DB1.OD_Qty_Cnsmd_Pieces_Sched;

 //?Production
 // IF DB1.OD Production Date EQ PAR.USR Day 6
 IF DB1.OD_Production_Date = PAR.USR_Day_6;

 // PAR.Qty Sched Ord 6 USR = DB1.OD Quantity Scheduled
 PAR.Qty_Sched_Ord_6_USR = DB1.OD_Qty_Cnsmd_Pieces_Sched;

 ENDIF;

 // PAR.OD Quantity Scheduled = PAR.OD Quantity Scheduled + DB1.OD Quantity Scheduled
 PAR.OD_Qty_Cnsmd_Pieces_Sched = PAR.OD_Qty_Cnsmd_Pieces_Sched
 + DB1.OD_Qty_Cnsmd_Pieces_Sched;

 // PAR.OD Quantity Inv Sched = PAR.OD Quantity Inv Sched + DB1.OD Quantity Inv Sched
 PAR.OD_Quantity_Inv_Sched = PAR.OD_Quantity_Inv_Sched + DB1.OD_Quantity_Inv_Sched;

}


// PAR.Qty Sched Prod 1 USR = PAR.Qty Sched Ord 1 USR
PAR.Qty_Sched_Prod_1_USR = PAR.Qty_Sched_Ord_1_USR;

// PAR.Qty Sched Prod 2 USR = PAR.Qty Sched Ord 2 USR
PAR.Qty_Sched_Prod_2_USR = PAR.Qty_Sched_Ord_2_USR;

// PAR.Qty Sched Prod 3 USR = PAR.Qty Sched Ord 3 USR
PAR.Qty_Sched_Prod_3_USR = PAR.Qty_Sched_Ord_3_USR;

// PAR.Qty Sched Prod 4 USR = PAR.Qty Sched Ord 4 USR
PAR.Qty_Sched_Prod_4_USR = PAR.Qty_Sched_Ord_4_USR;

// PAR.Qty Sched Prod 5 USR = PAR.Qty Sched Ord 5 USR
PAR.Qty_Sched_Prod_5_USR = PAR.Qty_Sched_Ord_5_USR;

// PAR.Qty Sched Prod 6 USR = PAR.Qty Sched Ord 6 USR
PAR.Qty_Sched_Prod_6_USR = PAR.Qty_Sched_Ord_6_USR;

// PAR.Qty 5.0 USR = PAR.Inv Total             USR
PAR.Qty_5_0_USR = PAR.Inv_Total_USR;

//?* Post Order *
// PAR.Post Flag USR = CND.Yes
PAR.Post_Flag_USR = 'Y';

EXECUTE FUNCTION(RTV Cr/Pr Hold        RT) TYPE(RTVOBJ) FILE(OPBFCPP)           AC1920451;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Order_Number);
PARAMETER(PAR.Scheduled_Ship_Date);
PARAMETER(PAR.Credit_Hold);
PARAMETER(PAR.Production_Hold);
{
 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


//?added output.Requested        8/23/19
EXECUTE FUNCTION(RTV for PA Refresh RT) TYPE(RTVOBJ) FILE(OPBGWKP)              AC1944291;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Order_Number);
PARAMETER(PAR.Order_Sequence_Number);
PARAMETER(PAR.Order_Secondary_Line_Seq);
PARAMETER(PAR.Warehouse_Code);
PARAMETER(PAR.OD_Production_Plan_Sts);
PARAMETER(PAR.Requested_Ship_Date);
PARAMETER(PAR.OD_Schedule_Override_Sts);
PARAMETER(PAR.OD_Adj_Type_Override);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


//?* Calculate Variance *
// Quantity Variance
PAR.ODS_Quantity_Short = ( PAR.Production_USR + PAR.Inv_Total_USR ) - PAR.Quantity_Ordered;

//?New for FP1054
// LCL.Date                  USR = JOB.*Job date + CON.-3 *DAYS
LCL.Date_USR = DATEINCR(JOB.*Job_date '-3' 'DY' 1111111 'NONE' 'N' 1);

//?8/23/19 requested instead
//?REQ   Ship Date display in YLW if ship dt 3 days prior current date FP1054
CASE;

// IF PAR.Requested Ship Date LT LCL.Date                  USR
IF PAR.Requested_Ship_Date < LCL.Date_USR;

// PAR.Record Found -OrdDtlUSR = CND.Record Not Found
PAR.Record_Found_OrdDtlUSR = 'N';

//?REQ   Ship Date display in YLW if ship dt 3 days prior current date FP1054
// IF *OTHERWISE
IF *OTHERWISE;

// PAR.Record Found -OrdDtlUSR = CND.Record Found
PAR.Record_Found_OrdDtlUSR = 'Y';

ENDIF;

CASE;

// IF PAR.Record Found -OrdDtlUSR is Record Not Found
IF PAR.Record_Found_OrdDtlUSR = 'N';

//?RI:  Order Number
CASE;

// IF PAR.ODS Quantity Short is NE Zero
IF PAR.ODS_Quantity_Short <> *ZERO;

// PAR.Reverse Image Flag USR = CND.Yes
PAR.Reverse_Image_Flag_USR = 'Y';

//?RI:  Order Number
// IF *OTHERWISE
IF *OTHERWISE;

// PAR.Reverse Image Flag USR = CND.No
PAR.Reverse_Image_Flag_USR = 'N';

ENDIF;

// IF *OTHERWISE
IF *OTHERWISE;

//?Short  and Prod Hold (RED)
CASE;

// IF PAR.ODS Quantity Short is NE Zero
IF PAR.ODS_Quantity_Short <> *ZERO;

// AND PAR.Production Hold is Yes
AND PAR.Production_Hold = 'Y';

// PAR.Reverse Image Flag USR = CND.Yes
PAR.Reverse_Image_Flag_USR = 'Y';

//?Short  and Prod Hold (RED)
// IF *OTHERWISE
IF *OTHERWISE;

// PAR.Reverse Image Flag USR = CND.No
PAR.Reverse_Image_Flag_USR = 'N';

// PAR.ODS Quantity Short = CON.*ZERO
PAR.ODS_Quantity_Short = *ZERO;

ENDIF;

ENDIF;

EXECUTE FUNCTION(RTV Load Status        RT) TYPE(RTVOBJ) FILE(OMFJCPP)          AC1297640;
PARAMETER(PAR.Load_ID);
PARAMETER(PAR.Load_Status);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 //?USER: Process Data record

 // PGM.*Return code = CND.*Record already exists
 PGM.*Return_code = 'Y2U0003';

 MOVE *ALL (To: PAR From: DB1);

}


