     H/TITLE Exc TRG PDMRREP ProcessXF Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJMIST
     H* Date          : 03/19/25  Time  : 04:18:00
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPVCOREL0  IF A E           K DISK
      * UPD : Export Doc Order Hdr TRG  Update index
      *
      * Long constants
     D @CN#            S              6    DIM(02)CTDATA PERRCD(1)
     D @CN             S             25    DIM(02) ALT(@CN#)
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
     D QPVCO1        E DS                  EXTNAME(PVCOREL0)
      * UPD : Export Doc Order Hdr TRG  Update index
      * Renamed input format fields
     D  WAAIC3       E                     EXTFLD(COAIC3)
     D  WAC4NB       E                     EXTFLD(COC4NB)
     D  WADGSX       E                     EXTFLD(CODGSX)
     D  WAKXCD       E                     EXTFLD(COKXCD)
     D  WABZTS       E                     EXTFLD(COBZTS)
     D  WAQ0SC       E                     EXTFLD(COQ0SC)
     D  WAQ1SC       E                     EXTFLD(COQ1SC)
     D  WACDDX       E                     EXTFLD(COCDDX)
      *
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  WP0001         S              1
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  XDTSDL         S             26
     D  WL0001         S              3  0
     D  WL0002         S              7  0
     D  WL0003         S              1
     D  WL0004         S              6
     D  WL0005         S              1
     D  WL0006         S              2
     D  WL0007         S              8  0
     D  WN0001         S             26
     D  ##TMS          S             26
     D  ZADFMF         S             10
     D  YL0001         S             15  5
     D  YL0002         S             15  5
     D  WQ0001         S             15  5
     D  WQ0002         S             15  5
     D  W0CLPG         S             10
     D  WUZHNB         S             15  5
     D  WQ0003         S             15  5
     D  WQ0004         S             15  5
     D  WQ0005         S             15  5
     D  WQ0006         S             15  5
     D  WQ0007         S             15  5
     D  WQ0008         S             15  5
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  W0PMT          S              1
      /EJECT
      * Parameter declarations
     D P1PARM          DS          3848
      * RCD: Export Doc Order Hdr      Retrieval index
      * I :  Company Number
     D  P1AIC3                 1      2P 0
      * I :  Order Number
     D  P1C4NB                 3      6P 0
      * I :  ED Export Document Type
     D  P1DGSX                 7      7
      * I :  Country Code
     D  P1KXCD                 8     13
      * I :  ED Area Office
     D  P1ZMCD                14     28
      * I :  ED Destination
     D  P1PSTX                29     48
      * I :  ED Consignor Name
     D  P1PUTX                49    111
      * I :  ED Consignor Addr 1
     D  P1PVTX               112    174
      * I :  ED Consignor Addr 2
     D  P1PWTX               175    237
      * I :  ED Consignor Addr 3
     D  P1RVTX               238    300
      * I :  ED Consignor Addr 4
     D  P1PPU1               301    363
      * I :  ED Consignor State
     D  P1Z7AA               364    365
      * I :  ED Consignor Postal
     D  P1PDU1               366    385
      * I :  ED Consignor Country Code
     D  P1Z8AA               386    391
      * I :  ED Consignee Name
     D  P1RHTX               392    454
      * I :  ED Consignee Addr 1
     D  P1RITX               455    517
      * I :  ED Consignee Addr 2
     D  P1RJTX               518    580
      * I :  ED Consignee Addr 3
     D  P1SCTX               581    643
      * I :  ED Consignee Addr 4
     D  P1SDTX               644    706
      * I :  ED Consignee State
     D  P1AAAB               707    708
      * I :  ED Consignee Postal
     D  P1PHU1               709    728
      * I :  ED Consignee Country Code
     D  P1ABAB               729    734
      * I :  ED Plant Location City
     D  P1PXTX               735    764
      * I :  ED Plant Location State
     D  P1ZOCD               765    766
      * I :  ED Plant Number
     D  P1ZNCD               767    776
      * I :  ED Processing Plant Sts
     D  P1CSSX               777    777
      * I :  ED Attachment Subtype
     D  P1CTSX               778    778
      * I :  ED Attachment Type Sts
     D  P1CUSX               779    779
      * I :  ED Xlate Desc to Country
     D  P1CVSX               780    780
      * I :  ED Unmarked Txt
     D  P1PTTX               781    790
      * I :  ED Shipping Marks Txt
     D  P1ORNA               791    805
      * I :  ED Date of Slaughter
     D  P1RKTX               806    875
      * I :  ED Place of Slaughter Txt
     D  P1PZTX               876    945
      * I :  ED Date of Processing
     D  P1RLTX               946   1015
      * I :  ED Place of processing Tx
     D  P1P0TX              1016   1085
      * I :  ED Continue Comment Txt
     D  P1P1TX              1086   1155
      * I :  ED Remark Constant 1
     D  P1P2TX              1156   1225
      * I :  ED Remark Constant 2
     D  P1P3TX              1226   1295
      * I :  ED Remark Constant 3
     D  P1P4TX              1296   1365
      * I :  ED Remark Constant 4
     D  P1P5TX              1366   1435
      * I :  ED Remark Constant 5
     D  P1P6TX              1436   1505
      * I :  ED Remark Constant 7
     D  P1YHTX              1506   1575
      * I :  ED Remark Constant 8
     D  P1YITX              1576   1645
      * I :  ED Certify that the meat
     D  P1CWSX              1646   1646
      * I :  ED Inspector Name
     D  P1OUNA              1647   1686
      * I :  ED Origin Country
     D  P1P7TX              1687   1696
      * I :  ED Port of Loading
     D  P1P9TX              1697   1714
      * I :  ED Transportion
     D  P1OVNA              1715   1729
      * I :  ED Seal Number 1
     D  P1QATX              1730   1739
      * I :  ED Seal Number 2
     D  P1QBTX              1740   1749
      * I :  ED Can_Import Cntrl Nm
     D  P1QCTX              1750   1779
      * I :  ED Can_Import Cntrl Ad 1
     D  P1OWNA              1780   1809
      * I :  ED Can_Import Cntrl Ad 2
     D  P1OXNA              1810   1839
      * I :  ED Can_Import Cntrl Fax
     D  P1ABNX              1840   1845P 0
      * I :  ED Can_Import Cntrl Phne
     D  P1ACNX              1846   1851P 0
      * I :  ED Seaboard Plant Fax
     D  P1ADNX              1852   1857P 0
      * I :  ED USDA Cert Nbr US
     D  P1QDTX              1858   1860
      * I :  ED USDA Cert Nbr CA
     D  P1QETX              1861   1868
      * I :  ED Can_Port of Entry
     D  P1OYNA              1869   1898
      * I :  ED Can_Reinsp Est Nbr
     D  P1OZNA              1899   1928
      * I :  ED Can_Reinsp Est Name
     D  P1O0NA              1929   1958
      * I :  ED Can_Reinsp Est City
     D  P1O1NA              1959   1988
      * I :  ED Herm Sealed Cntr Sts
     D  P1CXSX              1989   1989
      * I :  ED Herm Sealed Cntr Type
     D  P1CYSX              1990   1990
      * I :  ED Herm Sealed Cntr p_Crt
     D  P1AGNX              1991   2010
      * I :  ED Whole Bird Sts
     D  P1CZSX              2011   2011
      * I :  ED Marked Sts
     D  P1C0SX              2012   2012
      * I :  ED Tamper Evident Sts
     D  P1C1SX              2013   2013
      * I :  ED Plant Contact Name
     D  P1QFTX              2014   2043
      * I :  ED Plant Contact Phone
     D  P1AHNX              2044   2049P 0
      * I :  ED Modified Text
     D  P1QGTX              2050   2059
      * I :  ED Issued Crt for Exp Txt
     D  P1QHTX              2060   2109
      * I :  ED Species
     D  P1QITX              2110   2134
      * I :  ED Slaughter Plant Name
     D  P1QJTX              2135   2174
      * I :  ED Slaughter Plant Addr 1
     D  P1QKTX              2175   2214
      * I :  ED Slaughter Plant Addr 2
     D  P1QMTX              2215   2254
      * I :  ED Packaging Plant Name
     D  P1QNTX              2255   2294
      * I :  ED Packaging Plant Addr 1
     D  P1QOTX              2295   2334
      * I :  ED Packaging Plant Addr 2
     D  P1QPTX              2335   2374
      * I :  ED Manufact Plant Name
     D  P1QQTX              2375   2414
      * I :  ED Manufact Plant Addr 1
     D  P1QRTX              2415   2454
      * I :  ED Manufact Plant Addr 2
     D  P1QSTX              2455   2494
      * I :  ED USDA Name 1
     D  P1QTTX              2495   2534
      * I :  ED USDA Name 2
     D  P1QUTX              2535   2574
      * I :  ED USDA Name 3
     D  P1QVTX              2575   2614
      * I :  ED Title of Official
     D  P1QYTX              2615   2634
      * I :  ED Letter of Credit Nbr
     D  P1QWTX              2635   2644
      * I :  ED Unused prd mo_yr
     D  P1QZTX              2645   2664
      * I :  ED Nbr of prods on 1st pg
     D  P1AINX              2665   2666P 0
      * I :  ED Importer Name
     D  P1Q1TX              2667   2696
      * I :  ED Importer Addr 1
     D  P1Q2TX              2697   2726
      * I :  ED Importer Addr 2
     D  P1Q3TX              2727   2756
      * I :  ED Purchaser Name
     D  P1Q4TX              2757   2786
      * I :  ED Purchaser Addr 1
     D  P1Q5TX              2787   2816
      * I :  ED Purchaser Addr 2
     D  P1Q6TX              2817   2846
      * I :  ED Place Drct Shpmnt Nm
     D  P1Q7TX              2847   2909
      * I :  ED Place Drct Shpmnt Ad 1
     D  P1Q8TX              2910   2972
      * I :  ED Place Drct Shpmnt Ad 2
     D  P1Q9TX              2973   3035
      * I :  ED Place Drct Shpmnt Ad 3
     D  P1SMTX              3036   3098
      * I :  ED Currency
     D  P1ZQCD              3099   3103
      * I :  ED Conditions of Sale
     D  P1ZRCD              3104   3108
      * I :  ED Total Unit Price
     D  P1A7VL              3109   3112P 2
      * I :  ED Invoice Total
     D  P1A8VL              3113   3117P 2
      * I :  ED Live with PHIS
     D  P1C2SX              3118   3118
      * I :  ED Print Status
     D  P1C8SX              3119   3119
      * I :  ED Total Net Weight lbs
     D  P1HRWG              3120   3124P 1
      * I :  ED Total Net Weight MT
     D  P1BIVL              3125   3128P 4
      * I :  ED Nbr of Packages
     D  P1K2QT              3129   3131P 0
      * I :  ED Customer PO #
     D  P1O5NA              3132   3146
      * I :  ED Total Gross Weight lbs
     D  P1HSWG              3147   3151P 1
      * I :  ED Total Gross Weight MT
     D  P1BJVL              3152   3155P 4
      * I :  ED Plant Number Dtl
     D  P1RATX              3156   3165
      * I :  ED Language Xlate Desc 2
     D  P1RBTX              3166   3190
      * I :  ED Slaughter Date CofE 3
     D  P1RCTX              3191   3215
      * I :  ED Production mo_yr ln 3
     D  P1RDTX              3216   3245
      * I :  ED Remark Constant 6
     D  P1RETX              3246   3315
      * I :  ED Allow Print bef Ship
     D  P1C3SX              3316   3316
      * I :  ED Cert of Orig Sbd addr
     D  P1C4SX              3317   3317
      * I :  ED Use item label 1_2
     D  P1C5SX              3318   3318
      * I :  ED Slg_Proc Date Format
     D  P1C6SX              3319   3320
      * I :  ED Total Package UOM
     D  P1C7SX              3321   3322
      * I :  ED Export Certificate Nbr
     D  P1MQDT              3323   3326P 0
      * I :  ED Sail Date
     D  P1MRDT              3327   3330P 0
      * I :  ED Sworn on Date
     D  P1MSDT              3331   3334P 0
      * I :  ED Consignee Address Nbr
     D  P1AJNX              3335   3339P 2
      * I :  ED Form Identification Tx
     D  P1YFTX              3340   3404
      * I :  ED Cold Storage Name
     D  P1X9TX              3405   3444
      * I :  ED Cold Storage Addr 1
     D  P1YATX              3445   3484
      * I :  ED Cold Storage Addr 2
     D  P1YBTX              3485   3524
      * I :  ED Cold Storage Plant Nbr
     D  P1B5AA              3525   3534
      * I :  ED Slaughter Date CofE  1
     D  P1YCTX              3535   3574
      * I :  ED Production mo_yr ln 1
     D  P1YDTX              3575   3614
      * I :  ED Production mo_yr ln 2
     D  P1YETX              3615   3654
      * I :  ED Booking Nbr
     D  P1B6AA              3655   3664
      * I :  ED Document Date
     D  P1PADT              3665   3668P 0
      * I :  ED Packing Date
     D  P1PBDT              3669   3672P 0
      * I :  ED Expiration Date
     D  P1PCDT              3673   3676P 0
      * I :  ED Packing Date To
     D  P1PDDT              3677   3680P 0
      * I :  ED Unused Date 2
     D  P1PEDT              3681   3684P 0
      * I :  ED Print Kilograms
     D  P1O4SX              3685   3685
      * I :  ED MPR Canadian Province
     D  P1O5SX              3686   3687
      * I :  ED Container Nbrs
     D  P1C1T1              3688   3712
      * I :  ED Slaughter Date CofE 2
     D  P1C2T1              3713   3737
      * I :  ED Submit Status
     D  P1LKSC              3738   3738
      * I :  EDOH Unused Sts 2
     D  P1LLSC              3739   3741
      * I :  EDOH Unused Text 1
     D  P1PIU1              3742   3766
      * I :  EDOH Unused Text 2
     D  P1PJU1              3767   3806
      * I :  EDOH Unused Number 1
     D  P1FFNZ              3807   3811P 0
      * I :  EDOH Unused Date 1
     D  P1BUDX              3812   3816P 0
      * I :  EDI Status 1
     D  P1UVST              3817   3817
      * I :  EDI Status 2
     D  P1UWST              3818   3818
      * I :  EDI Status 3
     D  P1UXST              3819   3819
      * I :  Record Status
     D  P1VSST              3820   3820
      * I :  Job Time
     D  P1AATM              3821   3824P 0
      * I :  User Id
     D  P1AYNA              3825   3834
      * I :  Job Name
     D  P1A0NA              3835   3844
      * I : MAP Job Date
     D  P1AXDT              3845   3848P 0
     D P2PARM          DS          3848
      * RCD: Export Doc Order Hdr      Retrieval index
      * I :  Company Number
     D  P2AIC3                 1      2P 0
      * I :  Order Number
     D  P2C4NB                 3      6P 0
      * I :  ED Export Document Type
     D  P2DGSX                 7      7
      * I :  Country Code
     D  P2KXCD                 8     13
      * I :  ED Area Office
     D  P2ZMCD                14     28
      * I :  ED Destination
     D  P2PSTX                29     48
      * I :  ED Consignor Name
     D  P2PUTX                49    111
      * I :  ED Consignor Addr 1
     D  P2PVTX               112    174
      * I :  ED Consignor Addr 2
     D  P2PWTX               175    237
      * I :  ED Consignor Addr 3
     D  P2RVTX               238    300
      * I :  ED Consignor Addr 4
     D  P2PPU1               301    363
      * I :  ED Consignor State
     D  P2Z7AA               364    365
      * I :  ED Consignor Postal
     D  P2PDU1               366    385
      * I :  ED Consignor Country Code
     D  P2Z8AA               386    391
      * I :  ED Consignee Name
     D  P2RHTX               392    454
      * I :  ED Consignee Addr 1
     D  P2RITX               455    517
      * I :  ED Consignee Addr 2
     D  P2RJTX               518    580
      * I :  ED Consignee Addr 3
     D  P2SCTX               581    643
      * I :  ED Consignee Addr 4
     D  P2SDTX               644    706
      * I :  ED Consignee State
     D  P2AAAB               707    708
      * I :  ED Consignee Postal
     D  P2PHU1               709    728
      * I :  ED Consignee Country Code
     D  P2ABAB               729    734
      * I :  ED Plant Location City
     D  P2PXTX               735    764
      * I :  ED Plant Location State
     D  P2ZOCD               765    766
      * I :  ED Plant Number
     D  P2ZNCD               767    776
      * I :  ED Processing Plant Sts
     D  P2CSSX               777    777
      * I :  ED Attachment Subtype
     D  P2CTSX               778    778
      * I :  ED Attachment Type Sts
     D  P2CUSX               779    779
      * I :  ED Xlate Desc to Country
     D  P2CVSX               780    780
      * I :  ED Unmarked Txt
     D  P2PTTX               781    790
      * I :  ED Shipping Marks Txt
     D  P2ORNA               791    805
      * I :  ED Date of Slaughter
     D  P2RKTX               806    875
      * I :  ED Place of Slaughter Txt
     D  P2PZTX               876    945
      * I :  ED Date of Processing
     D  P2RLTX               946   1015
      * I :  ED Place of processing Tx
     D  P2P0TX              1016   1085
      * I :  ED Continue Comment Txt
     D  P2P1TX              1086   1155
      * I :  ED Remark Constant 1
     D  P2P2TX              1156   1225
      * I :  ED Remark Constant 2
     D  P2P3TX              1226   1295
      * I :  ED Remark Constant 3
     D  P2P4TX              1296   1365
      * I :  ED Remark Constant 4
     D  P2P5TX              1366   1435
      * I :  ED Remark Constant 5
     D  P2P6TX              1436   1505
      * I :  ED Remark Constant 7
     D  P2YHTX              1506   1575
      * I :  ED Remark Constant 8
     D  P2YITX              1576   1645
      * I :  ED Certify that the meat
     D  P2CWSX              1646   1646
      * I :  ED Inspector Name
     D  P2OUNA              1647   1686
      * I :  ED Origin Country
     D  P2P7TX              1687   1696
      * I :  ED Port of Loading
     D  P2P9TX              1697   1714
      * I :  ED Transportion
     D  P2OVNA              1715   1729
      * I :  ED Seal Number 1
     D  P2QATX              1730   1739
      * I :  ED Seal Number 2
     D  P2QBTX              1740   1749
      * I :  ED Can_Import Cntrl Nm
     D  P2QCTX              1750   1779
      * I :  ED Can_Import Cntrl Ad 1
     D  P2OWNA              1780   1809
      * I :  ED Can_Import Cntrl Ad 2
     D  P2OXNA              1810   1839
      * I :  ED Can_Import Cntrl Fax
     D  P2ABNX              1840   1845P 0
      * I :  ED Can_Import Cntrl Phne
     D  P2ACNX              1846   1851P 0
      * I :  ED Seaboard Plant Fax
     D  P2ADNX              1852   1857P 0
      * I :  ED USDA Cert Nbr US
     D  P2QDTX              1858   1860
      * I :  ED USDA Cert Nbr CA
     D  P2QETX              1861   1868
      * I :  ED Can_Port of Entry
     D  P2OYNA              1869   1898
      * I :  ED Can_Reinsp Est Nbr
     D  P2OZNA              1899   1928
      * I :  ED Can_Reinsp Est Name
     D  P2O0NA              1929   1958
      * I :  ED Can_Reinsp Est City
     D  P2O1NA              1959   1988
      * I :  ED Herm Sealed Cntr Sts
     D  P2CXSX              1989   1989
      * I :  ED Herm Sealed Cntr Type
     D  P2CYSX              1990   1990
      * I :  ED Herm Sealed Cntr p_Crt
     D  P2AGNX              1991   2010
      * I :  ED Whole Bird Sts
     D  P2CZSX              2011   2011
      * I :  ED Marked Sts
     D  P2C0SX              2012   2012
      * I :  ED Tamper Evident Sts
     D  P2C1SX              2013   2013
      * I :  ED Plant Contact Name
     D  P2QFTX              2014   2043
      * I :  ED Plant Contact Phone
     D  P2AHNX              2044   2049P 0
      * I :  ED Modified Text
     D  P2QGTX              2050   2059
      * I :  ED Issued Crt for Exp Txt
     D  P2QHTX              2060   2109
      * I :  ED Species
     D  P2QITX              2110   2134
      * I :  ED Slaughter Plant Name
     D  P2QJTX              2135   2174
      * I :  ED Slaughter Plant Addr 1
     D  P2QKTX              2175   2214
      * I :  ED Slaughter Plant Addr 2
     D  P2QMTX              2215   2254
      * I :  ED Packaging Plant Name
     D  P2QNTX              2255   2294
      * I :  ED Packaging Plant Addr 1
     D  P2QOTX              2295   2334
      * I :  ED Packaging Plant Addr 2
     D  P2QPTX              2335   2374
      * I :  ED Manufact Plant Name
     D  P2QQTX              2375   2414
      * I :  ED Manufact Plant Addr 1
     D  P2QRTX              2415   2454
      * I :  ED Manufact Plant Addr 2
     D  P2QSTX              2455   2494
      * I :  ED USDA Name 1
     D  P2QTTX              2495   2534
      * I :  ED USDA Name 2
     D  P2QUTX              2535   2574
      * I :  ED USDA Name 3
     D  P2QVTX              2575   2614
      * I :  ED Title of Official
     D  P2QYTX              2615   2634
      * I :  ED Letter of Credit Nbr
     D  P2QWTX              2635   2644
      * I :  ED Unused prd mo_yr
     D  P2QZTX              2645   2664
      * I :  ED Nbr of prods on 1st pg
     D  P2AINX              2665   2666P 0
      * I :  ED Importer Name
     D  P2Q1TX              2667   2696
      * I :  ED Importer Addr 1
     D  P2Q2TX              2697   2726
      * I :  ED Importer Addr 2
     D  P2Q3TX              2727   2756
      * I :  ED Purchaser Name
     D  P2Q4TX              2757   2786
      * I :  ED Purchaser Addr 1
     D  P2Q5TX              2787   2816
      * I :  ED Purchaser Addr 2
     D  P2Q6TX              2817   2846
      * I :  ED Place Drct Shpmnt Nm
     D  P2Q7TX              2847   2909
      * I :  ED Place Drct Shpmnt Ad 1
     D  P2Q8TX              2910   2972
      * I :  ED Place Drct Shpmnt Ad 2
     D  P2Q9TX              2973   3035
      * I :  ED Place Drct Shpmnt Ad 3
     D  P2SMTX              3036   3098
      * I :  ED Currency
     D  P2ZQCD              3099   3103
      * I :  ED Conditions of Sale
     D  P2ZRCD              3104   3108
      * I :  ED Total Unit Price
     D  P2A7VL              3109   3112P 2
      * I :  ED Invoice Total
     D  P2A8VL              3113   3117P 2
      * I :  ED Live with PHIS
     D  P2C2SX              3118   3118
      * I :  ED Print Status
     D  P2C8SX              3119   3119
      * I :  ED Total Net Weight lbs
     D  P2HRWG              3120   3124P 1
      * I :  ED Total Net Weight MT
     D  P2BIVL              3125   3128P 4
      * I :  ED Nbr of Packages
     D  P2K2QT              3129   3131P 0
      * I :  ED Customer PO #
     D  P2O5NA              3132   3146
      * I :  ED Total Gross Weight lbs
     D  P2HSWG              3147   3151P 1
      * I :  ED Total Gross Weight MT
     D  P2BJVL              3152   3155P 4
      * I :  ED Plant Number Dtl
     D  P2RATX              3156   3165
      * I :  ED Language Xlate Desc 2
     D  P2RBTX              3166   3190
      * I :  ED Slaughter Date CofE 3
     D  P2RCTX              3191   3215
      * I :  ED Production mo_yr ln 3
     D  P2RDTX              3216   3245
      * I :  ED Remark Constant 6
     D  P2RETX              3246   3315
      * I :  ED Allow Print bef Ship
     D  P2C3SX              3316   3316
      * I :  ED Cert of Orig Sbd addr
     D  P2C4SX              3317   3317
      * I :  ED Use item label 1_2
     D  P2C5SX              3318   3318
      * I :  ED Slg_Proc Date Format
     D  P2C6SX              3319   3320
      * I :  ED Total Package UOM
     D  P2C7SX              3321   3322
      * I :  ED Export Certificate Nbr
     D  P2MQDT              3323   3326P 0
      * I :  ED Sail Date
     D  P2MRDT              3327   3330P 0
      * I :  ED Sworn on Date
     D  P2MSDT              3331   3334P 0
      * I :  ED Consignee Address Nbr
     D  P2AJNX              3335   3339P 2
      * I :  ED Form Identification Tx
     D  P2YFTX              3340   3404
      * I :  ED Cold Storage Name
     D  P2X9TX              3405   3444
      * I :  ED Cold Storage Addr 1
     D  P2YATX              3445   3484
      * I :  ED Cold Storage Addr 2
     D  P2YBTX              3485   3524
      * I :  ED Cold Storage Plant Nbr
     D  P2B5AA              3525   3534
      * I :  ED Slaughter Date CofE  1
     D  P2YCTX              3535   3574
      * I :  ED Production mo_yr ln 1
     D  P2YDTX              3575   3614
      * I :  ED Production mo_yr ln 2
     D  P2YETX              3615   3654
      * I :  ED Booking Nbr
     D  P2B6AA              3655   3664
      * I :  ED Document Date
     D  P2PADT              3665   3668P 0
      * I :  ED Packing Date
     D  P2PBDT              3669   3672P 0
      * I :  ED Expiration Date
     D  P2PCDT              3673   3676P 0
      * I :  ED Packing Date To
     D  P2PDDT              3677   3680P 0
      * I :  ED Unused Date 2
     D  P2PEDT              3681   3684P 0
      * I :  ED Print Kilograms
     D  P2O4SX              3685   3685
      * I :  ED MPR Canadian Province
     D  P2O5SX              3686   3687
      * I :  ED Container Nbrs
     D  P2C1T1              3688   3712
      * I :  ED Slaughter Date CofE 2
     D  P2C2T1              3713   3737
      * I :  ED Submit Status
     D  P2LKSC              3738   3738
      * I :  EDOH Unused Sts 2
     D  P2LLSC              3739   3741
      * I :  EDOH Unused Text 1
     D  P2PIU1              3742   3766
      * I :  EDOH Unused Text 2
     D  P2PJU1              3767   3806
      * I :  EDOH Unused Number 1
     D  P2FFNZ              3807   3811P 0
      * I :  EDOH Unused Date 1
     D  P2BUDX              3812   3816P 0
      * I :  EDI Status 1
     D  P2UVST              3817   3817
      * I :  EDI Status 2
     D  P2UWST              3818   3818
      * I :  EDI Status 3
     D  P2UXST              3819   3819
      * I :  Record Status
     D  P2VSST              3820   3820
      * I :  Job Time
     D  P2AATM              3821   3824P 0
      * I :  User Id
     D  P2AYNA              3825   3834
      * I :  Job Name
     D  P2A0NA              3835   3844
      * I :  Job Date
     D  P2AXDT              3845   3848P 0
     D P3PARM          DS
      * I :  TRG Database Event
     D  P3D8SC                 1      1
     D                 DS
     D  ZAMSDA                 1    132
     I@COREXA
      * Export Doc Order Hdr TRG  Update index
      * Renamed input format fields
     I              COAIC3                      WAAIC3
     I              COC4NB                      WAC4NB
     I              CODGSX                      WADGSX
     I              COKXCD                      WAKXCD
     I              COBZTS                      WABZTS
     I              COQ0SC                      WAQ0SC
     I              COQ1SC                      WAQ1SC
     I              COCDDX                      WACDDX
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
     C                   PARM                    P1PARM                         RCD: Export Doc
     C                   PARM                    P2PARM                         RCD: Export Doc
     C     P3D8SC        PARM                    WP0001                         TRG Database Ev
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Exc TRG PDMRREP ProcessXF
      * *****************************************************************
      * ** PR1 Parms Represent Old Record Fields (Will be blank for Inser
      * ** PR2 Parms Represent New Record Fields (Will be blank for Delet
      * *****************************************************************
      * Trigger Processing for Insert Event.
      * CASE: PR3.TRG Database Event is Insert
      * Create Export Doc Order H - Export Doc Order Hdr TRG  * 
      * Move input parameters to subroutine local variables.
     C                   IF        P3D8SC = '1'
     C                   Z-ADD     P2AIC3        WL0001                         Company Number
     C                   Z-ADD     P2C4NB        WL0002                         Order Number
     C                   MOVEL(P)  P2DGSX        WL0003                         ED Export Docum
     C                   MOVEL(P)  P2KXCD        WL0004                         Country Code
     C                   MOVEL(P)  P3D8SC        WL0005                         ED TRG Database
     C                   MOVEL(P)  '0'           WL0006                         ED Process Stat
     C                   Z-ADD     *ZERO         WL0007                         ED Process Date
     C                   EXSR      SACRRC
      * If Record Already Exist.
      * CASE: PGM.*Return code is *Record already exists
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                   IF        W0RTN = @CN(002)
     C                   CALL      'PDGFUPC'                            90      RTV System Date
     C     YL0001        PARM      *ZERO         WQ0001                         Current System
     C     YL0002        PARM      *ZERO         WQ0002                         Current System
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDGFUPC'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
     C                   Z-ADD     YL0002        WUZHNB                         Current System
      * WI642 JM 02/19/25-Loop Until System Time Changes.
      * DO WHILE: LCL.Current System Time EQ WRK.Current System Time
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                   DOW       YL0002 = WUZHNB
     C                   CALL      'PDGFUPC'                            90      RTV System Date
     C     YL0001        PARM      *ZERO         WQ0003                         Current System
     C     WUZHNB        PARM      *ZERO         WQ0004                         Current System
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDGFUPC'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
     C                   END                                                    *ITR
      * Create Export Doc Order H - Export Doc Order Hdr TRG  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     P2AIC3        WL0001                         Company Number
     C                   Z-ADD     P2C4NB        WL0002                         Order Number
     C                   MOVEL(P)  P2DGSX        WL0003                         ED Export Docum
     C                   MOVEL(P)  P2KXCD        WL0004                         Country Code
     C                   MOVEL(P)  P3D8SC        WL0005                         ED TRG Database
     C                   MOVEL(P)  '0'           WL0006                         ED Process Stat
     C                   Z-ADD     *ZERO         WL0007                         ED Process Date
     C                   EXSR      SACRRC
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Trigger Processing for Update Event.
      * CASE: PR3.TRG Database Event is Update
      * Create Export Doc Order H - Export Doc Order Hdr TRG  * 
      * Move input parameters to subroutine local variables.
     C                   IF        P3D8SC = '3'
     C                   Z-ADD     P2AIC3        WL0001                         Company Number
     C                   Z-ADD     P2C4NB        WL0002                         Order Number
     C                   MOVEL(P)  P2DGSX        WL0003                         ED Export Docum
     C                   MOVEL(P)  P2KXCD        WL0004                         Country Code
     C                   MOVEL(P)  P3D8SC        WL0005                         ED TRG Database
     C                   MOVEL(P)  '0'           WL0006                         ED Process Stat
     C                   Z-ADD     *ZERO         WL0007                         ED Process Date
     C                   EXSR      SACRRC
      * If Record Already Exist.
      * CASE: PGM.*Return code is *Record already exists
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                   IF        W0RTN = @CN(002)
     C                   CALL      'PDGFUPC'                            90      RTV System Date
     C     YL0001        PARM      *ZERO         WQ0005                         Current System
     C     YL0002        PARM      *ZERO         WQ0006                         Current System
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDGFUPC'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
     C                   Z-ADD     YL0002        WUZHNB                         Current System
      * WI642 JM 02/19/25-Loop Until System Time Changes.
      * DO WHILE: LCL.Current System Time EQ WRK.Current System Time
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                   DOW       YL0002 = WUZHNB
     C                   CALL      'PDGFUPC'                            90      RTV System Date
     C     YL0001        PARM      *ZERO         WQ0007                         Current System
     C     WUZHNB        PARM      *ZERO         WQ0008                         Current System
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDGFUPC'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
     C                   END                                                    *ITR
      * Create Export Doc Order H - Export Doc Order Hdr TRG  * 
      * Move input parameters to subroutine local variables.
     C                   Z-ADD     P2AIC3        WL0001                         Company Number
     C                   Z-ADD     P2C4NB        WL0002                         Order Number
     C                   MOVEL(P)  P2DGSX        WL0003                         ED Export Docum
     C                   MOVEL(P)  P2KXCD        WL0004                         Country Code
     C                   MOVEL(P)  P3D8SC        WL0005                         ED TRG Database
     C                   MOVEL(P)  '0'           WL0006                         ED Process Stat
     C                   Z-ADD     *ZERO         WL0007                         ED Process Date
     C                   EXSR      SACRRC
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Trigger Processing for Delete Event.
      * CASE: PR3.TRG Database Event is Delete
      * Create Export Doc Order H - Export Doc Order Hdr TRG  * 
      * Move input parameters to subroutine local variables.
     C                   IF        P3D8SC = '2'
     C                   Z-ADD     P1AIC3        WL0001                         Company Number
     C                   Z-ADD     P1C4NB        WL0002                         Order Number
     C                   MOVEL(P)  P1DGSX        WL0003                         ED Export Docum
     C                   MOVEL(P)  P1KXCD        WL0004                         Country Code
     C                   MOVEL(P)  P3D8SC        WL0005                         ED TRG Database
     C                   MOVEL(P)  '0'           WL0006                         ED Process Stat
     C                   Z-ADD     *ZERO         WL0007                         ED Process Date
     C                   EXSR      SACRRC
     C                   END                                                    *FI
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SACRRC        BEGSR
      *================================================================
      * Create Export Doc Order H - Export Doc Order Hdr TRG  * 
      *================================================================
      *
     C                   MOVEL     XDTSDL        WN0001                         ED Timestamp
      *
     C                   EVAL      W0RTN = ' '
      * Move all fields to @COREXA
     C                   Z-ADD     WL0001        WAAIC3                         Company Number
     C                   Z-ADD     WL0002        WAC4NB                         Order Number
     C                   MOVEL     WL0003        WADGSX                         ED Export Docum
     C                   MOVEL     WL0004        WAKXCD                         Country Code
     C                   MOVEL     WL0005        WAQ0SC                         ED TRG Database
     C                   MOVEL     WL0006        WAQ1SC                         ED Process Stat
     C                   Z-ADD     WL0007        WACDDX                         ED Process Date
      *
      * USER: Processing before Data update
      * Set Timestamp TS#     IF
      * PAR.@Timestamp TS# = JOB.*System timestamp
     C                   EXSR      XSTMS
     C                   MOVEL     ##TMS         WABZTS                         @Timestamp TS#
     C     KLCRSA        KLIST
     C                   KFLD                    WAAIC3                         Company Number
     C                   KFLD                    WAC4NB                         Order Number
     C                   KFLD                    WADGSX                         ED Export Docum
     C                   KFLD                    WAKXCD                         Country Code
     C                   KFLD                    WABZTS                         ED Timestamp
      * Check for duplicate primary key
     C     KLCRSA        SETLL     @COREXA                                90    *
     C                   IF        *IN90
     C                   MOVEL     'USR5541'     W0RTN
      * Send message 'Export Doc Order HdrTRGEX'
     C                   MOVEL     'USR5541'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      SAEXIT
     C                   ENDIF
      *
     C                   WRITE     @COREXA                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   XSTMS         BEGSR
      *================================================================
      * Refresh System timestamp
      *================================================================
     C                   CALL      'Y2RTTSK'
     C                   PARM                    ##TMS                          System timestam
      *================================================================
     CSR   XSTMSE        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
      * If no message file specified, use default
     C                   IF        ZAMSGF = ' '
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      *
      *
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAAIC3                         Company Number
     C                   Z-ADD     *ZERO         WAC4NB                         Order Number
     C                   MOVE(P)   '0'           XDTSDL
     C                   MOVEL     @CN(001)      XDTSDL
     C                   MOVEL     XDTSDL        WABZTS                         ED Timestamp
     C                   Z-ADD     *ZERO         WACDDX                         ED Process Date
      * Obtain default message file
     C     *DTAARA       DEFINE    CAMGFLA       ZADFMF
     C                   IN        ZADFMF
      * Define work field Current System Time
     C                   Z-ADD     *ZERO         WUZHNB
      * Dummy move for compiler
     C                   MOVE      '0'           @CN#(1)
     C                   MOVEL     @CN(1)        @CN(1)
     C                   MOVEL     'N'           W0PMT
      * Define local variables for subroutine SACRRC.
     C                   Z-ADD     *ZERO         WL0001
     C                   Z-ADD     *ZERO         WL0002
     C                   EVAL      WL0003 = ' '
     C                   EVAL      WL0004 = ' '
     C                   EVAL      WL0005 = ' '
     C                   EVAL      WL0006 = ' '
     C                   Z-ADD     *ZERO         WL0007
      * Define local work field Current System Date
     C                   Z-ADD     *ZERO         YL0001
      * Define local work field Current System Time
     C                   Z-ADD     *ZERO         YL0002
      *================================================================
     CSR   ZZEXIT        ENDSR
** @CN
00001 0001-01-01-00.00.00.00000
00002 Y2U0003
