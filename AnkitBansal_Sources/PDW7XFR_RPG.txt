     H/TITLE Prc Post Physcial Inv XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 12/17/13  Time  : 16:39:38
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAB0REL3IF  E           K        DISK
      * RSQ : Item Balance              RSQ by Cycle Count    V
      *
     FCAB1REL0IF  E           K        DISK
      * RTV : Item Balance Detail       Retrieval index       NV
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAB0REL1IF  E           K        DISK
      * RTV : Item Balance              Retrieval index       NV
      *
     FCAB7CPLEIF  E           K        DISK
      * RSQ : Item Transaction Detail   Normal KEY Sequence (D)
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FCAB1REL4IF  E           K        DISK
      * RTV : Item Balance Detail       Active only
      *
     FPDL5CPL7IF  E           K        DISK
      * RSQ : Item Lot Location         Co/Whs/Itm
      *
     FCAB7CPL0IF  E           K        DISK                      A
      * UPD : Item Transaction Detail   Update index
      *
     FCAB1REL1UF  E           K        DISK                      A
      * UPD : Item Balance Detail       Update index
      *
     FCAB0REL0UF  E           K        DISK
      * UPD : Item Balance              Update index
      *
     FPDL5CPL0UF  E           K        DISK
      * UPD : Item Lot Location         Update index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@B0REK7
      * Item Balance              RSQ by Cycle Count    V
      * Renamed input format fields
     I              B0AIC3                          WAAIC3
     I              B0HGCD                          WAHGCD
     I              B0AJCD                          WAAJCD
     I              B0AGCS                          WAAGCS
     I              B0AECS                          WAAECS
     I              B0BACS                          WABACS
     I              B0BBCS                          WABBCS
     I              B0CBPR                          WACBPR
     I              B0GUDT                          WAGUDT
     I              B0XYST                          WAXYST
     I              B0CTPR                          WACTPR
     I              B0G4DT                          WAG4DT
     I              B0BOWG                          WABOWG
     I              B0DDQT                          WADDQT
     I              B0DEQT                          WADEQT
     I              B0DFQT                          WADFQT
     I              B0HDQT                          WAHDQT
     I              B0HEQT                          WAHEQT
     I              B0AJQT                          WAAJQT
     I              B0AQQT                          WAAQQT
     I              B0AUQT                          WAAUQT
     I              B0EMQT                          WAEMQT
     I              B0DOQT                          WADOQT
     I              B0ATNA                          WAATNA
     I              B0AKDT                          WAAKDT
     I              B0ANDT                          WAANDT
     I              B0IDVA                          WAIDVA
     I              B0JVST                          WAJVST
     I              B0BZPC                          WABZPC
     I              B0DGQT                          WADGQT
     I              B0DIDT                          WADIDT
     I              B0ALCD                          WAALCD
     I              B0BFDY                          WABFDY
     I              B0DJDT                          WADJDT
     I              B0BGDY                          WABGDY
     I              B0DKDT                          WADKDT
     I              B0J2ST                          WAJ2ST
     I              B0DJQT                          WADJQT
     I              B0BNWG                          WABNWG
     I              B0DLDT                          WADLDT
     I              B0DPQT                          WADPQT
     I              B0DQQT                          WADQQT
     I              B0DMDT                          WADMDT
     I              B0M0ST                          WAM0ST
     I              B0J9ST                          WAJ9ST
     I              B0KBST                          WAKBST
     I              B0AKC8                          WAAKC8
     I              B0RINB                          WARINB
     I              B0RHNB                          WARHNB
     I              B0RGNB                          WARGNB
     I              B0UVST                          WAUVST
     I              B0UWST                          WAUWST
     I              B0UXST                          WAUXST
     I              B0VSST                          WAVSST
     I              B0AATM                          WAAATM
     I              B0AYNA                          WAAYNA
     I              B0A0NA                          WAA0NA
     I              B0AXDT                          WAAXDT
      *
     I@B1REJ0
      * Item Balance Detail       Retrieval index       NV
      * Renamed input format fields
     I              B1AIC3                          WBAIC3
     I              B1HGCD                          WBHGCD
     I              B1AJCD                          WBAJCD
     I              B1ELDT                          WBELDT
     I              B1ABWG                          WBABWG
     I              B1AGQT                          WBAGQT
     I              B1AHQT                          WBAHQT
     I              B1AIQT                          WBAIQT
     I              B1CTST                          WBCTST
     I              B1ACWG                          WBACWG
     I              B1ARQT                          WBARQT
     I              B1ASQT                          WBASQT
     I              B1ATQT                          WBATQT
     I              B1HDQT                          WBHDQT
     I              B1HEQT                          WBHEQT
     I              B1F6ST                          WBF6ST
     I              B1BMWG                          WBBMWG
     I              B1DSQT                          WBDSQT
     I              B1DTQT                          WBDTQT
     I              B1DUQT                          WBDUQT
     I              B1DHDT                          WBDHDT
     I              B1AGCS                          WBAGCS
     I              B1AECS                          WBAECS
     I              B1IDVA                          WBIDVA
     I              B1K7DT                          WBK7DT
     I              B1RINB                          WBRINB
     I              B1RHNB                          WBRHNB
     I              B1RGNB                          WBRGNB
     I              B1UVST                          WBUVST
     I              B1UWST                          WBUWST
     I              B1UXST                          WBUXST
     I              B1VSST                          WBVSST
     I              B1AATM                          WBAATM
     I              B1AYNA                          WBAYNA
     I              B1A0NA                          WBA0NA
     I              B1AXDT                          WBAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WCAIC3
     I              BZHGCD                          WCHGCD
     I              BZAVNA                          WCAVNA
     I              BZAWNA                          WCAWNA
     I              BZL7NA                          WCL7NA
     I              BZL8NA                          WCL8NA
     I              BZL6NA                          WCL6NA
     I              BZMFNA                          WCMFNA
     I              BZADCD                          WCADCD
     I              BZAWPC                          WCAWPC
     I              BZLXST                          WCLXST
     I              BZAECD                          WCAECD
     I              BZAXPC                          WCAXPC
     I              BZLYST                          WCLYST
     I              BZAFCD                          WCAFCD
     I              BZAICD                          WCAICD
     I              BZAIWG                          WCAIWG
     I              BZHICD                          WCHICD
     I              BZRBCD                          WCRBCD
     I              BZFZST                          WCFZST
     I              BZAVST                          WCAVST
     I              BZCZWG                          WCCZWG
     I              BZC0WG                          WCC0WG
     I              BZURTN                          WCURTN
     I              BZAJC8                          WCAJC8
     I              BZRINB                          WCRINB
     I              BZRHNB                          WCRHNB
     I              BZRGNB                          WCRGNB
     I              BZLNCD                          WCLNCD
     I              BZTFNB                          WCTFNB
     I              BZN0CD                          WCN0CD
     I              BZX4ST                          WCX4ST
     I              BZTMVA                          WCTMVA
     I              BZTNVA                          WCTNVA
     I              BZBLPR                          WCBLPR
     I              BZBMPR                          WCBMPR
     I              BZLRCD                          WCLRCD
     I              BZU9ST                          WCU9ST
     I              BZCMCO                          WCCMCO
     I              BZQ1CD                          WCQ1CD
     I              BZQ8CD                          WCQ8CD
     I              BZCHTM                          WCCHTM
     I              BZQZCD                          WCQZCD
     I              BZXWST                          WCXWST
     I              BZXXST                          WCXXST
     I              BZVMST                          WCVMST
     I              BZSWGH                          WCSWGH
     I              BZPPHE                          WCPPHE
     I              BZR3CD                          WCR3CD
     I              BZSDCD                          WCSDCD
     I              BZICN1                          WCICN1
     I              BZSVCD                          WCSVCD
     I              BZICN2                          WCICN2
     I              BZSWCD                          WCSWCD
     I              BZV2NB                          WCV2NB
     I              BZSXCD                          WCSXCD
     I              BZITCN                          WCITCN
     I              BZSYCD                          WCSYCD
     I              BZITC5                          WCITC5
     I              BZSZCD                          WCSZCD
     I              BZICN6                          WCICN6
     I              BZS0CD                          WCS0CD
     I              BZICN7                          WCICN7
     I              BZS1CD                          WCS1CD
     I              BZICN8                          WCICN8
     I              BZS2CD                          WCS2CD
     I              BZICN9                          WCICN9
     I              BZS3CD                          WCS3CD
     I              BZICN0                          WCICN0
     I              BZS4CD                          WCS4CD
     I              BZSFNB                          WCSFNB
     I              BZA3WG                          WCA3WG
     I              BZSJNB                          WCSJNB
     I              BZLLCD                          WCLLCD
     I              BZLMCD                          WCLMCD
     I              BZP3ST                          WCP3ST
     I              BZSKNB                          WCSKNB
     I              BZSLNB                          WCSLNB
     I              BZSMNB                          WCSMNB
     I              BZP4ST                          WCP4ST
     I              BZCFNB                          WCCFNB
     I              BZCGNB                          WCCGNB
     I              BZILNB                          WCILNB
     I              BZCHNB                          WCCHNB
     I              BZCINB                          WCCINB
     I              BZCJNB                          WCCJNB
     I              BZCMNB                          WCCMNB
     I              BZCNNB                          WCCNNB
     I              BZCRNB                          WCCRNB
     I              BZCSNB                          WCCSNB
     I              BZCVNB                          WCCVNB
     I              BZCWNB                          WCCWNB
     I              BZCXNB                          WCCXNB
     I              BZCZNB                          WCCZNB
     I              BZC0NB                          WCC0NB
     I              BZN1CD                          WCN1CD
     I              BZB4NB                          WCB4NB
     I              BZB5NB                          WCB5NB
     I              BZX5ST                          WCX5ST
     I              BZX6ST                          WCX6ST
     I              BZX7ST                          WCX7ST
     I              BZPCCT                          WCPCCT
     I              BZBDNB                          WCBDNB
     I              BZBJNB                          WCBJNB
     I              BZSUST                          WCSUST
     I              BZSVST                          WCSVST
     I              BZSYST                          WCSYST
     I              BZSZST                          WCSZST
     I              BZS1ST                          WCS1ST
     I              BZXRCD                          WCXRCD
     I              BZXTCD                          WCXTCD
     I              BZXUCD                          WCXUCD
     I              BZF5WG                          WCF5WG
     I              BZF6WG                          WCF6WG
     I              BZF7WG                          WCF7WG
     I              BZBLNB                          WCBLNB
     I              BZBNNB                          WCBNNB
     I              BZS2ST                          WCS2ST
     I              BZS4ST                          WCS4ST
     I              BZS5ST                          WCS5ST
     I              BZS6ST                          WCS6ST
     I              BZS8ST                          WCS8ST
     I              BZS9ST                          WCS9ST
     I              BZTCST                          WCTCST
     I              BZTDST                          WCTDST
     I              BZUVST                          WCUVST
     I              BZUWST                          WCUWST
     I              BZUXST                          WCUXST
     I              BZVSST                          WCVSST
     I              BZAATM                          WCAATM
     I              BZAYNA                          WCAYNA
     I              BZA0NA                          WCA0NA
     I              BZAXDT                          WCAXDT
      *
     I@B0REJX
      * Item Balance              Retrieval index       NV
      * Renamed input format fields
     I              B0AIC3                          WDAIC3
     I              B0HGCD                          WDHGCD
     I              B0AJCD                          WDAJCD
     I              B0AGCS                          WDAGCS
     I              B0AECS                          WDAECS
     I              B0BACS                          WDBACS
     I              B0BBCS                          WDBBCS
     I              B0CBPR                          WDCBPR
     I              B0GUDT                          WDGUDT
     I              B0XYST                          WDXYST
     I              B0CTPR                          WDCTPR
     I              B0G4DT                          WDG4DT
     I              B0BOWG                          WDBOWG
     I              B0DDQT                          WDDDQT
     I              B0DEQT                          WDDEQT
     I              B0DFQT                          WDDFQT
     I              B0HDQT                          WDHDQT
     I              B0HEQT                          WDHEQT
     I              B0AJQT                          WDAJQT
     I              B0AQQT                          WDAQQT
     I              B0AUQT                          WDAUQT
     I              B0EMQT                          WDEMQT
     I              B0DOQT                          WDDOQT
     I              B0ATNA                          WDATNA
     I              B0AKDT                          WDAKDT
     I              B0ANDT                          WDANDT
     I              B0IDVA                          WDIDVA
     I              B0JVST                          WDJVST
     I              B0BZPC                          WDBZPC
     I              B0DGQT                          WDDGQT
     I              B0DIDT                          WDDIDT
     I              B0ALCD                          WDALCD
     I              B0BFDY                          WDBFDY
     I              B0DJDT                          WDDJDT
     I              B0BGDY                          WDBGDY
     I              B0DKDT                          WDDKDT
     I              B0J2ST                          WDJ2ST
     I              B0DJQT                          WDDJQT
     I              B0BNWG                          WDBNWG
     I              B0DLDT                          WDDLDT
     I              B0DPQT                          WDDPQT
     I              B0DQQT                          WDDQQT
     I              B0DMDT                          WDDMDT
     I              B0M0ST                          WDM0ST
     I              B0J9ST                          WDJ9ST
     I              B0KBST                          WDKBST
     I              B0AKC8                          WDAKC8
     I              B0RINB                          WDRINB
     I              B0RHNB                          WDRHNB
     I              B0RGNB                          WDRGNB
     I              B0UVST                          WDUVST
     I              B0UWST                          WDUWST
     I              B0UXST                          WDUXST
     I              B0VSST                          WDVSST
     I              B0AATM                          WDAATM
     I              B0AYNA                          WDAYNA
     I              B0A0NA                          WDA0NA
     I              B0AXDT                          WDAXDT
      *
     I@B7CPZA
      * Item Transaction Detail   Normal KEY Sequence (D)
      * Renamed input format fields
     I              B7AIC3                          WEAIC3
     I              B7HGCD                          WEHGCD
     I              B7AJCD                          WEAJCD
     I              B7W9ST                          WEW9ST
     I              B7BSST                          WEBSST
     I              B7B4DT                          WEB4DT
     I              B7C4NY                          WEC4NY
     I              B7DXNB                          WEDXNB
     I              B7ELDT                          WEELDT
     I              B7HVCD                          WEHVCD
     I              B7F1ST                          WEF1ST
     I              B7AUNA                          WEAUNA
     I              B7A5QT                          WEA5QT
     I              B7AHWG                          WEAHWG
     I              B7AKCS                          WEAKCS
     I              B7CGCD                          WECGCD
     I              B7AYVA                          WEAYVA
     I              B7BJNA                          WEBJNA
     I              B7CKNB                          WECKNB
     I              B7BMST                          WEBMST
     I              B7CQCD                          WECQCD
     I              B7DTCD                          WEDTCD
     I              B7MGNA                          WEMGNA
     I              B7TRBN                          WETRBN
     I              B7TRBS                          WETRBS
     I              B7C4NB                          WEC4NB
     I              B7RINB                          WERINB
     I              B7RHNB                          WERHNB
     I              B7RGNB                          WERGNB
     I              B7M3NA                          WEM3NA
     I              B7AWTM                          WEAWTM
     I              B7XLCD                          WEXLCD
     I              B7K7DT                          WEK7DT
     I              B7UVST                          WEUVST
     I              B7UWST                          WEUWST
     I              B7UXST                          WEUXST
     I              B7VSST                          WEVSST
     I              B7AATM                          WEAATM
     I              B7AYNA                          WEAYNA
     I              B7A0NA                          WEA0NA
     I              B7AXDT                          WEAXDT
      *
     I@B7CPJZ
      * Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WFAIC3
     I              B7HGCD                          WFHGCD
     I              B7AJCD                          WFAJCD
     I              B7W9ST                          WFW9ST
     I              B7BSST                          WFBSST
     I              B7B4DT                          WFB4DT
     I              B7C4NY                          WFC4NY
     I              B7DXNB                          WFDXNB
     I              B7ELDT                          WFELDT
     I              B7HVCD                          WFHVCD
     I              B7F1ST                          WFF1ST
     I              B7AUNA                          WFAUNA
     I              B7A5QT                          WFA5QT
     I              B7AHWG                          WFAHWG
     I              B7AKCS                          WFAKCS
     I              B7CGCD                          WFCGCD
     I              B7AYVA                          WFAYVA
     I              B7BJNA                          WFBJNA
     I              B7CKNB                          WFCKNB
     I              B7BMST                          WFBMST
     I              B7CQCD                          WFCQCD
     I              B7DTCD                          WFDTCD
     I              B7MGNA                          WFMGNA
     I              B7TRBN                          WFTRBN
     I              B7TRBS                          WFTRBS
     I              B7C4NB                          WFC4NB
     I              B7RINB                          WFRINB
     I              B7RHNB                          WFRHNB
     I              B7RGNB                          WFRGNB
     I              B7M3NA                          WFM3NA
     I              B7AWTM                          WFAWTM
     I              B7XLCD                          WFXLCD
     I              B7K7DT                          WFK7DT
     I              B7UVST                          WFUVST
     I              B7UWST                          WFUWST
     I              B7UXST                          WFUXST
     I              B7VSST                          WFVSST
     I              B7AATM                          WFAATM
     I              B7AYNA                          WFAYNA
     I              B7A0NA                          WFA0NA
     I              B7AXDT                          WFAXDT
      *
     I@B1REJ1
      * Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WGAIC3
     I              B1HGCD                          WGHGCD
     I              B1AJCD                          WGAJCD
     I              B1ELDT                          WGELDT
     I              B1ABWG                          WGABWG
     I              B1AGQT                          WGAGQT
     I              B1AHQT                          WGAHQT
     I              B1AIQT                          WGAIQT
     I              B1CTST                          WGCTST
     I              B1ACWG                          WGACWG
     I              B1ARQT                          WGARQT
     I              B1ASQT                          WGASQT
     I              B1ATQT                          WGATQT
     I              B1HDQT                          WGHDQT
     I              B1HEQT                          WGHEQT
     I              B1F6ST                          WGF6ST
     I              B1BMWG                          WGBMWG
     I              B1DSQT                          WGDSQT
     I              B1DTQT                          WGDTQT
     I              B1DUQT                          WGDUQT
     I              B1DHDT                          WGDHDT
     I              B1AGCS                          WGAGCS
     I              B1AECS                          WGAECS
     I              B1IDVA                          WGIDVA
     I              B1K7DT                          WGK7DT
     I              B1RINB                          WGRINB
     I              B1RHNB                          WGRHNB
     I              B1RGNB                          WGRGNB
     I              B1UVST                          WGUVST
     I              B1UWST                          WGUWST
     I              B1UXST                          WGUXST
     I              B1VSST                          WGVSST
     I              B1AATM                          WGAATM
     I              B1AYNA                          WGAYNA
     I              B1A0NA                          WGA0NA
     I              B1AXDT                          WGAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WHAJCD
     I              ADF8NA                          WHF8NA
     I              ADACNA                          WHACNA
     I              ADADNA                          WHADNA
     I              ADAENA                          WHAENA
     I              ADAJNA                          WHAJNA
     I              ADBTTX                          WHBTTX
     I              ADAOCD                          WHAOCD
     I              ADBGCD                          WHBGCD
     I              ADVHST                          WHVHST
     I              ADMPNA                          WHMPNA
     I              ADWPST                          WHWPST
     I              ADXUST                          WHXUST
     I              ADT0ST                          WHT0ST
     I              ADT1ST                          WHT1ST
     I              ADDBNB                          WHDBNB
     I              ADT2ST                          WHT2ST
     I              ADT3ST                          WHT3ST
     I              ADT4ST                          WHT4ST
     I              ADT6ST                          WHT6ST
     I              ADBWC3                          WHBWC3
     I              ADBTC3                          WHBTC3
     I              ADBUC3                          WHBUC3
     I              ADBVC3                          WHBVC3
     I              ADFCAA                          WHFCAA
     I              ADRQSX                          WHRQSX
     I              ADRRSX                          WHRRSX
     I              ADRSSX                          WHRSSX
     I              ADRTSX                          WHRTSX
     I              ADT7ST                          WHT7ST
     I              ADT8ST                          WHT8ST
     I              ADRNSX                          WHRNSX
     I              ADROSX                          WHROSX
     I              ADRPSX                          WHRPSX
     I              ADUVST                          WHUVST
     I              ADUWST                          WHUWST
     I              ADUXST                          WHUXST
     I              ADVSST                          WHVSST
     I              ADAATM                          WHAATM
     I              ADAYNA                          WHAYNA
     I              ADA0NA                          WHA0NA
     I              ADAXDT                          WHAXDT
      *
     ICAB1RL4
      * Item Balance Detail       Active only
      * Renamed input format fields
     I              B1AIC3                          WIAIC3
     I              B1HGCD                          WIHGCD
     I              B1AJCD                          WIAJCD
     I              B1ELDT                          WIELDT
     I              B1ABWG                          WIABWG
     I              B1AGQT                          WIAGQT
     I              B1AHQT                          WIAHQT
     I              B1AIQT                          WIAIQT
     I              B1CTST                          WICTST
     I              B1ACWG                          WIACWG
     I              B1ARQT                          WIARQT
     I              B1ASQT                          WIASQT
     I              B1ATQT                          WIATQT
     I              B1HDQT                          WIHDQT
     I              B1HEQT                          WIHEQT
     I              B1F6ST                          WIF6ST
     I              B1BMWG                          WIBMWG
     I              B1DSQT                          WIDSQT
     I              B1DTQT                          WIDTQT
     I              B1DUQT                          WIDUQT
     I              B1DHDT                          WIDHDT
     I              B1AGCS                          WIAGCS
     I              B1AECS                          WIAECS
     I              B1IDVA                          WIIDVA
     I              B1K7DT                          WIK7DT
     I              B1RINB                          WIRINB
     I              B1RHNB                          WIRHNB
     I              B1RGNB                          WIRGNB
     I              B1UVST                          WIUVST
     I              B1UWST                          WIUWST
     I              B1UXST                          WIUXST
     I              B1VSST                          WIVSST
     I              B1AATM                          WIAATM
     I              B1AYNA                          WIAYNA
     I              B1A0NA                          WIA0NA
     I              B1AXDT                          WIAXDT
      *
     I@B0REJT
      * Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WJAIC3
     I              B0HGCD                          WJHGCD
     I              B0AJCD                          WJAJCD
     I              B0AGCS                          WJAGCS
     I              B0AECS                          WJAECS
     I              B0BACS                          WJBACS
     I              B0BBCS                          WJBBCS
     I              B0CBPR                          WJCBPR
     I              B0GUDT                          WJGUDT
     I              B0XYST                          WJXYST
     I              B0CTPR                          WJCTPR
     I              B0G4DT                          WJG4DT
     I              B0BOWG                          WJBOWG
     I              B0DDQT                          WJDDQT
     I              B0DEQT                          WJDEQT
     I              B0DFQT                          WJDFQT
     I              B0HDQT                          WJHDQT
     I              B0HEQT                          WJHEQT
     I              B0AJQT                          WJAJQT
     I              B0AQQT                          WJAQQT
     I              B0AUQT                          WJAUQT
     I              B0EMQT                          WJEMQT
     I              B0DOQT                          WJDOQT
     I              B0ATNA                          WJATNA
     I              B0AKDT                          WJAKDT
     I              B0ANDT                          WJANDT
     I              B0IDVA                          WJIDVA
     I              B0JVST                          WJJVST
     I              B0BZPC                          WJBZPC
     I              B0DGQT                          WJDGQT
     I              B0DIDT                          WJDIDT
     I              B0ALCD                          WJALCD
     I              B0BFDY                          WJBFDY
     I              B0DJDT                          WJDJDT
     I              B0BGDY                          WJBGDY
     I              B0DKDT                          WJDKDT
     I              B0J2ST                          WJJ2ST
     I              B0DJQT                          WJDJQT
     I              B0BNWG                          WJBNWG
     I              B0DLDT                          WJDLDT
     I              B0DPQT                          WJDPQT
     I              B0DQQT                          WJDQQT
     I              B0DMDT                          WJDMDT
     I              B0M0ST                          WJM0ST
     I              B0J9ST                          WJJ9ST
     I              B0KBST                          WJKBST
     I              B0AKC8                          WJAKC8
     I              B0RINB                          WJRINB
     I              B0RHNB                          WJRHNB
     I              B0RGNB                          WJRGNB
     I              B0UVST                          WJUVST
     I              B0UWST                          WJUWST
     I              B0UXST                          WJUXST
     I              B0VSST                          WJVSST
     I              B0AATM                          WJAATM
     I              B0AYNA                          WJAYNA
     I              B0A0NA                          WJA0NA
     I              B0AXDT                          WJAXDT
      *
     I@L5CPX4
      * Item Lot Location         Co/Whs/Itm
      * Renamed input format fields
     I              L5AIC3                          WKAIC3
     I              L5HGCD                          WKHGCD
     I              L5AJCD                          WKAJCD
     I              L5ELDT                          WKELDT
     I              L5LXNM                          WKLXNM
     I              L5YMCD                          WKYMCD
     I              L5YNCD                          WKYNCD
     I              L5J2QT                          WKJ2QT
     I              L5G5WG                          WKG5WG
     I              L5J3QT                          WKJ3QT
     I              L5G6WG                          WKG6WG
     I              L5J4QT                          WKJ4QT
     I              L5G7WG                          WKG7WG
     I              L5LODT                          WKLODT
     I              L5LPDT                          WKLPDT
     I              L5LQDT                          WKLQDT
     I              L5NBR                           WKNBR
     I              L5YTCD                          WKYTCD
     I              L5AMSX                          WKAMSX
     I              L5ASSX                          WKASSX
     I              L5ATSX                          WKATSX
     I              L5AUSX                          WKAUSX
     I              L5YSCD                          WKYSCD
     I              L5UVST                          WKUVST
     I              L5UWST                          WKUWST
     I              L5UXST                          WKUXST
     I              L5VSST                          WKVSST
     I              L5AATM                          WKAATM
     I              L5AYNA                          WKAYNA
     I              L5A0NA                          WKA0NA
     I              L5AXDT                          WKAXDT
      *
     I@L5CPSL
      * Item Lot Location         Update index
      * Renamed input format fields
     I              L5AIC3                          WLAIC3
     I              L5HGCD                          WLHGCD
     I              L5AJCD                          WLAJCD
     I              L5ELDT                          WLELDT
     I              L5LXNM                          WLLXNM
     I              L5YMCD                          WLYMCD
     I              L5YNCD                          WLYNCD
     I              L5J2QT                          WLJ2QT
     I              L5G5WG                          WLG5WG
     I              L5J3QT                          WLJ3QT
     I              L5G6WG                          WLG6WG
     I              L5J4QT                          WLJ4QT
     I              L5G7WG                          WLG7WG
     I              L5LODT                          WLLODT
     I              L5LPDT                          WLLPDT
     I              L5LQDT                          WLLQDT
     I              L5NBR                           WLNBR
     I              L5YTCD                          WLYTCD
     I              L5AMSX                          WLAMSX
     I              L5ASSX                          WLASSX
     I              L5ATSX                          WLATSX
     I              L5AUSX                          WLAUSX
     I              L5YSCD                          WLYSCD
     I              L5UVST                          WLUVST
     I              L5UWST                          WLUWST
     I              L5UXST                          WLUXST
     I              L5VSST                          WLVSST
     I              L5AATM                          WLAATM
     I              L5AYNA                          WLAYNA
     I              L5A0NA                          WLA0NA
     I              L5AXDT                          WLAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQCAB71    E DSCAB7CPL0
      * UPD : Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WFAIC3
     I              B7HGCD                          WFHGCD
     I              B7AJCD                          WFAJCD
     I              B7W9ST                          WFW9ST
     I              B7BSST                          WFBSST
     I              B7B4DT                          WFB4DT
     I              B7C4NY                          WFC4NY
     I              B7DXNB                          WFDXNB
     I              B7ELDT                          WFELDT
     I              B7HVCD                          WFHVCD
     I              B7F1ST                          WFF1ST
     I              B7AUNA                          WFAUNA
     I              B7A5QT                          WFA5QT
     I              B7AHWG                          WFAHWG
     I              B7AKCS                          WFAKCS
     I              B7CGCD                          WFCGCD
     I              B7AYVA                          WFAYVA
     I              B7BJNA                          WFBJNA
     I              B7CKNB                          WFCKNB
     I              B7BMST                          WFBMST
     I              B7CQCD                          WFCQCD
     I              B7DTCD                          WFDTCD
     I              B7MGNA                          WFMGNA
     I              B7TRBN                          WFTRBN
     I              B7TRBS                          WFTRBS
     I              B7C4NB                          WFC4NB
     I              B7RINB                          WFRINB
     I              B7RHNB                          WFRHNB
     I              B7RGNB                          WFRGNB
     I              B7M3NA                          WFM3NA
     I              B7AWTM                          WFAWTM
     I              B7XLCD                          WFXLCD
     I              B7K7DT                          WFK7DT
     I              B7UVST                          WFUVST
     I              B7UWST                          WFUWST
     I              B7UXST                          WFUXST
     I              B7VSST                          WFVSST
     I              B7AATM                          WFAATM
     I              B7AYNA                          WFAYNA
     I              B7A0NA                          WFA0NA
     I              B7AXDT                          WFAXDT
      *
     IQCAB11    E DSCAB1REL1
      * UPD : Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WGAIC3
     I              B1HGCD                          WGHGCD
     I              B1AJCD                          WGAJCD
     I              B1ELDT                          WGELDT
     I              B1ABWG                          WGABWG
     I              B1AGQT                          WGAGQT
     I              B1AHQT                          WGAHQT
     I              B1AIQT                          WGAIQT
     I              B1CTST                          WGCTST
     I              B1ACWG                          WGACWG
     I              B1ARQT                          WGARQT
     I              B1ASQT                          WGASQT
     I              B1ATQT                          WGATQT
     I              B1HDQT                          WGHDQT
     I              B1HEQT                          WGHEQT
     I              B1F6ST                          WGF6ST
     I              B1BMWG                          WGBMWG
     I              B1DSQT                          WGDSQT
     I              B1DTQT                          WGDTQT
     I              B1DUQT                          WGDUQT
     I              B1DHDT                          WGDHDT
     I              B1AGCS                          WGAGCS
     I              B1AECS                          WGAECS
     I              B1IDVA                          WGIDVA
     I              B1K7DT                          WGK7DT
     I              B1RINB                          WGRINB
     I              B1RHNB                          WGRHNB
     I              B1RGNB                          WGRGNB
     I              B1UVST                          WGUVST
     I              B1UWST                          WGUWST
     I              B1UXST                          WGUXST
     I              B1VSST                          WGVSST
     I              B1AATM                          WGAATM
     I              B1AYNA                          WGAYNA
     I              B1A0NA                          WGA0NA
     I              B1AXDT                          WGAXDT
      *
     IYARDCS      DS                            163
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                            163
     IQCAB01    E DSCAB0REL0
      * UPD : Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WJAIC3
     I              B0HGCD                          WJHGCD
     I              B0AJCD                          WJAJCD
     I              B0AGCS                          WJAGCS
     I              B0AECS                          WJAECS
     I              B0BACS                          WJBACS
     I              B0BBCS                          WJBBCS
     I              B0CBPR                          WJCBPR
     I              B0GUDT                          WJGUDT
     I              B0XYST                          WJXYST
     I              B0CTPR                          WJCTPR
     I              B0G4DT                          WJG4DT
     I              B0BOWG                          WJBOWG
     I              B0DDQT                          WJDDQT
     I              B0DEQT                          WJDEQT
     I              B0DFQT                          WJDFQT
     I              B0HDQT                          WJHDQT
     I              B0HEQT                          WJHEQT
     I              B0AJQT                          WJAJQT
     I              B0AQQT                          WJAQQT
     I              B0AUQT                          WJAUQT
     I              B0EMQT                          WJEMQT
     I              B0DOQT                          WJDOQT
     I              B0ATNA                          WJATNA
     I              B0AKDT                          WJAKDT
     I              B0ANDT                          WJANDT
     I              B0IDVA                          WJIDVA
     I              B0JVST                          WJJVST
     I              B0BZPC                          WJBZPC
     I              B0DGQT                          WJDGQT
     I              B0DIDT                          WJDIDT
     I              B0ALCD                          WJALCD
     I              B0BFDY                          WJBFDY
     I              B0DJDT                          WJDJDT
     I              B0BGDY                          WJBGDY
     I              B0DKDT                          WJDKDT
     I              B0J2ST                          WJJ2ST
     I              B0DJQT                          WJDJQT
     I              B0BNWG                          WJBNWG
     I              B0DLDT                          WJDLDT
     I              B0DPQT                          WJDPQT
     I              B0DQQT                          WJDQQT
     I              B0DMDT                          WJDMDT
     I              B0M0ST                          WJM0ST
     I              B0J9ST                          WJJ9ST
     I              B0KBST                          WJKBST
     I              B0AKC8                          WJAKC8
     I              B0RINB                          WJRINB
     I              B0RHNB                          WJRHNB
     I              B0RGNB                          WJRGNB
     I              B0UVST                          WJUVST
     I              B0UWST                          WJUWST
     I              B0UXST                          WJUXST
     I              B0VSST                          WJVSST
     I              B0AATM                          WJAATM
     I              B0AYNA                          WJAYNA
     I              B0A0NA                          WJA0NA
     I              B0AXDT                          WJAXDT
      *
     IYCRDCS      DS                            245
     IQPDL51    E DSPDL5CPL0
      * UPD : Item Lot Location         Update index
      * Renamed input format fields
     I              L5AIC3                          WLAIC3
     I              L5HGCD                          WLHGCD
     I              L5AJCD                          WLAJCD
     I              L5ELDT                          WLELDT
     I              L5LXNM                          WLLXNM
     I              L5YMCD                          WLYMCD
     I              L5YNCD                          WLYNCD
     I              L5J2QT                          WLJ2QT
     I              L5G5WG                          WLG5WG
     I              L5J3QT                          WLJ3QT
     I              L5G6WG                          WLG6WG
     I              L5J4QT                          WLJ4QT
     I              L5G7WG                          WLG7WG
     I              L5LODT                          WLLODT
     I              L5LPDT                          WLLPDT
     I              L5LQDT                          WLLQDT
     I              L5NBR                           WLNBR
     I              L5YTCD                          WLYTCD
     I              L5AMSX                          WLAMSX
     I              L5ASSX                          WLASSX
     I              L5ATSX                          WLATSX
     I              L5AUSX                          WLAUSX
     I              L5YSCD                          WLYSCD
     I              L5UVST                          WLUVST
     I              L5UWST                          WLUWST
     I              L5UXST                          WLUXST
     I              L5VSST                          WLVSST
     I              L5AATM                          WLAATM
     I              L5AYNA                          WLAYNA
     I              L5A0NA                          WLA0NA
     I              L5AXDT                          WLAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Item Balance
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Warehouse Code
     I                                        3   5 P1AJCD
      * I :  Cycle Count Code - IB
     I                                        6   8 P1ATNA
     IP2PARM      DS
      * FLD: Item Transaction Detail
      * I :  Transaction Date Code
     I                                    P   1   40P2B4DT
     IP3PARM      DS
      * I :  Post Exception USR
     I                                        1   1 P3LXSX
     IP4PARM      DS
      * B :  Exceptions Exist Sts USR
     I                                        1   1 P4LTSX
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1AJCD    PARM           WP0002  3        Warehouse Code
     C           P1ATNA    PARM           WP0003  3        Cycle Count Cod
     C           P2B4DT    PARM           WP0004  70       Transaction Dat
     C           P3LXSX    PARM           WP0005  1        Post Exception
     C           P4LTSX    PARM P4LTSX    WP0006  1        Exceptions Exis
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prc Post Physcial Inv XF
      * E00168 RMC 6/05/08,  6/06/08
      * 1. Delete Item Lot Loc with 0 qty at end of process
      * 2. Update Item Balance in that rtv, rather than after EVERY item
      * 3. Dont Create Item Trans Dtl if qty and wgt are 0
      * 4. Dont Create PDJWCPP (PS Avail Audit) if adj weight is zero
     C                     MOVEL'N'       P4LTSX           Exceptions Exis
      * Rtv Post Physcial Cnt  RT - Item Balance  * 
     C                     EXSR SARVGN
      * Delete Item Lot Loc with -0- qty/wgt    6/05/08 RMC
      * Rtv Lot Track,int flg RT - Warehouse  * 
     C                     EXSR SORVGN
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Lot Tracking Flag is yes
      *   |- c2    : LCL.Warehouse Location is Internal (Plant)
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0004    IFEQ 'Y'                        *IF
     C           YL0005    IFEQ 'I'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Del Zero qty,Wgt  RT - Item Lot Location  * 
     C                     EXSR SPRVGN
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Post Physcial Cnt  RT - Item Balance  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        USR Process sta
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WAAJCD           Warehouse Code
     C                     KFLD           WAATNA           Cycle Count Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
     C                     MOVELP1AJCD    WAAJCD           Warehouse Code
     C                     MOVELP1ATNA    WAATNA           Cycle Count Cod
      * Establish starting position
     C           KPSSA     SETLL@B0REK7                    *
     C           KRSSA     READE@B0REK7                  90*
      * Data record not found
     C   90                MOVEL'USR0328' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WN0001           USR Process sta
      *   Validate warehouse match
      * CASE: PAR.Warehouse Code is Warehouse Code not Blank
     C           P1AJCD    IFNE *BLANK                     *IF
      * CASE: DB1.Warehouse Code NE PAR.Warehouse Code
     C           WAAJCD    IFNE P1AJCD                     *IF
     C                     MOVEL'N'       WN0001           USR Process sta
     C                     END                             *FI
     C                     END                             *FI
      *   Validate cycle count code match
      * CASE: PAR.Cycle Count Code - IB is Entered
     C           P1ATNA    IFNE *BLANK                     *IF
      * CASE: DB1.Cycle Count Code - IB NE PAR.Cycle Count Code - IB
     C           WAATNA    IFNE P1ATNA                     *IF
     C                     MOVEL'N'       WN0001           USR Process sta
     C                     END                             *FI
     C                     END                             *FI
      *   O.K. to process physical post (won't print on report)
      * CASE: PAR.USR Process status is yes
     C           WN0001    IFEQ 'Y'                        *IF
      *   Create transaction detail records, update/create transaction
      *   update item balance detail records
      * Rtv Post Physical Cnt  RT - Item Balance Detail  * 
     C                     EXSR SBRVGN
      * E00168 6/06/08 Do do this here after all item bal dtls have been
      * RTV Sum Act Qty,Wgt,ValRT - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADDWAHGCD    WL0002           Item Code
     C                     MOVELWAAJCD    WL0003    P      Warehouse Code
     C                     Z-ADDYL0001    WL0004           Quantity on Han
     C                     Z-ADDYL0002    WL0005           Quantity on Han
     C                     Z-ADDWUNFNN    WL0006           Quantity on Han
     C                     Z-ADDWUNFNN    WL0007           Quantity on Han
     C                     Z-ADDYL0003    WL0008           Value of On Han
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0004    YL0001           Quantity on Han
     C                     Z-ADDWL0005    YL0002           Quantity on Han
     C                     Z-ADDWL0006    WUNFNN           Quantity on Han
     C                     Z-ADDWL0007    WUNFNN           Quantity on Han
     C                     Z-ADDWL0008    YL0003           Value of On Han
      * Chg Val/Qty/Wgt        Ch - Item Balance  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0009           Company Number
     C                     Z-ADDWAHGCD    WL0010           Item Code
     C                     MOVELWAAJCD    WL0011    P      Warehouse Code
     C                     Z-ADDYL0001    WL0012           On Hand Weight
     C                     Z-ADDYL0002    WL0013           On Hand U/M1 Su
     C                     Z-ADDYL0003    WL0014           Value of On Han
     C                     EXSR SNCHRC
     C                     END                             *FI
     C           KRSSA     READE@B0REK7                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Post Physical Cnt  RT - Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0002 112       Transaction Qua
     C                     Z-ADD*ZERO     WN0003 112       Transaction Wei
     C                     MOVEL*BLANK    WN0004  1        Shift Number
     C                     MOVEL*BLANK    WN0005 30        Description Lin
     C                     MOVEL*BLANK    WN0006 30        Description Lin
     C                     MOVEL*BLANK    WN0007  2        U/M - Primary
     C                     Z-ADD*ZERO     WN0008  94       Conversion Fact
     C                     MOVEL*BLANK    WN0009  1        Operation Facto
     C                     MOVEL*BLANK    WN0010  2        U/M - Second
     C                     Z-ADD*ZERO     WN0011  94       Conversion Fact
     C                     MOVEL*BLANK    WN0012  1        Operation Facto
     C                     MOVEL*BLANK    WN0013  2        U/M - Third
     C                     MOVEL*BLANK    WN0014  2        U/M - Pricing
     C                     Z-ADD*ZERO     WN0015 112       Unit Weight
     C                     MOVEL*BLANK    WN0016  1        Production Date
     C                     MOVEL*BLANK    WN0017  1        Catch Weight St
     C                     Z-ADD*ZERO     WN0018 114       Unit Cost Per P
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'1'       WN0004           Shift Number
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBHGCD    WQSB02           Item Code
     C           *LIKE     DEFN WBAJCD    WQSB03           Warehouse Code
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Item Code
     C                     KFLD           WQSB03           Warehouse Code
      * Setup key
     C                     Z-ADDWAAIC3    WQSB01           Company Number
     C                     Z-ADDWAHGCD    WQSB02           Item Code
     C                     MOVELWAAJCD    WQSB03           Warehouse Code
      * Establish starting position
     C           KRSSB     SETLL@B1REJ0                    *
     C           KRSSB     READE@B1REJ0                  90*
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Update Exception Status is no
      *   |- c2    : PAR.Post Exception USR is yes
      *   '-
     C           WBF6ST    IFEQ 'N'                        *IF
     C           P3LXSX    OREQ 'Y'                        *OR
      * Item balance has physical start date?
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Physical Start Date is entered
      *   |- c2    : DB1.Physical Count Status is Physical in progress
      *   '-
     C           WBDHDT    IFNE *ZERO                      *IF
     C           WBCTST    OREQ 'P'                        *OR
     C           WBAGQT    SUB  WBDSQT    WN0002           Transaction Qua
     C           WBABWG    SUB  WBBMWG    WN0003           Transaction Wei
      * Rtv Base Values        RT - Company/Item  * 
     C                     EXSR SCRVGN
      * RTV Unit Cost          RT - IC Item Balance  * 
     C                     EXSR SDRVGN
      * RMC E00168        6/06/08
      * call this IF instead - so we dont update the item bal for every
      *  item bal dtl read. update it in the rtv that calls this rtv inst
      *
     C                     Z-ADD*ZERO     WN0019  30       Item Structure
     C                     Z-ADD*ZERO     WN0020  30       Item Structure
     C                     Z-ADD*ZERO     WN0021  30       Item Structure
     C                     Z-ADD*ZERO     WN0022  50       ITD Sequence Nu
     C                     Z-ADD*ZERO     WN0023  30       Sequence Number
     C                     Z-ADD*ZERO     WN0024 114       USR Transaction
     C                     Z-ADD*ZERO     WN0025 112       Extended Amount
     C                     Z-ADD*ZERO     WN0026 112       On Hand Weight
     C                     Z-ADD*ZERO     WN0027 112       On Hand U/M1 Su
     C                     Z-ADD*ZERO     WN0028 112       Value of On Han
     C                     Z-ADD*ZERO     WN0029 112       Quantity based
     C                     Z-ADD*ZERO     WN0030 112       Quantity based
     C                     Z-ADD*ZERO     WN0031 112       Quantity based
     C                     Z-ADD*ZERO     WN0032 114       Cost based on U
     C                     Z-ADD*ZERO     WN0033 114       Cost based on U
     C                     Z-ADD*ZERO     WN0034 114       Cost based on U
     C                     Z-ADD*ZERO     WN0035 112       Quantity Total
     C                     Z-ADD*ZERO     WN0036 112       USR Transaction
     C                     MOVEL*BLANK    WN0037  3        USR Reason Code
      *
      * UPD Bal from Phys CountIF
     C                     Z-ADDWN0002    WN0035           Quantity Total
     C                     Z-ADDWN0003    WN0036           USR Transaction
      * Adjust quantity, weight for trans type
      * CASE: PAR.Inventory Trans. Type is Issue types
     C           'AP'      IFEQ 'I'                        *IF
     C           'AP'      OREQ 'IO'
     C           'AP'      OREQ 'RW'
      * CASE: PAR.USR Unship Flag is yes
     C           'N'       IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Qty
      * CASE: PAR.Transaction Quantity GT WRK.ZERO
     C           WN0002    IFGT WUW0NB                     *IF
     C           *ZERO     SUB  WN0002    WN0035           Quantity Total
     C                     END                             *FI
      * Wgt
      * CASE: PAR.Transaction Weight GT WRK.ZERO
     C           WN0003    IFGT WUW0NB                     *IF
     C           *ZERO     SUB  WN0003    WN0036           USR Transaction
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Send message 'Processing'
     C                     MOVEL'USR2303' ZAMSID
     C                     MOVEL'*EXT '   ZAPGRL           Rel queue
     C                     MOVEL'*STATUS' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
      *
     C                     Z-ADD*ZERO     WN0038 112       Quantity based
     C                     Z-ADD*ZERO     WN0039 112       Quantity based
     C                     Z-ADD*ZERO     WN0040 112       Quantity based
      *
      * Clc Convert Quantity   IF
      * Clear output parameters
     C                     Z-ADD*ZERO     WN0029           USR Qty based o
     C                     Z-ADD*ZERO     WN0030           USR Qty based o
     C                     Z-ADD*ZERO     WN0031           USR Qty based o
      * Process based on transaction U/M
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Transaction
     C           WN0007    IFEQ WN0007                     *IF
     C                     Z-ADDWN0035    WN0029           USR Qty based o
      * Process entered U/M2
      * CASE: PAR.U/M - Second is Entered
     C           WN0010    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0009    IFEQ 'M'                        *IF
     C           WN0035    MULT WN0008    WN0039    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0009    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0008    IFNE *ZERO                      *IF
     C           WN0035    DIV  WN0008    WN0039    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0039    WN0030           USR Qty based o
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           WN0013    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0012    IFEQ 'M'                        *IF
     C           WN0039    MULT WN0011    WN0040    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0012    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0011    IFNE *ZERO                      *IF
     C           WN0039    DIV  WN0011    WN0040    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0040    WN0031           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Transaction
     C           WN0010    IFEQ WN0007                     *IF
     C                     Z-ADDWN0035    WN0030           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0009    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0008    IFNE *ZERO                      *IF
     C           WN0035    DIV  WN0008    WN0029    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0009    IFEQ 'D'                        *IF
     C           WN0035    MULT WN0008    WN0029    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           WN0013    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0012    IFEQ 'M'                        *IF
     C           WN0035    MULT WN0011    WN0040    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0012    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0011    IFNE *ZERO                      *IF
     C           WN0035    DIV  WN0011    WN0040    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0040    WN0031           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Transaction
     C           WN0013    IFEQ WN0007                     *IF
     C                     Z-ADDWN0035    WN0031           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0012    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0011    IFNE *ZERO                      *IF
     C           WN0035    DIV  WN0011    WN0039    H      Quantity based
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0012    IFEQ 'D'                        *IF
     C           WN0035    MULT WN0011    WN0039    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0039    WN0030           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0009    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0008    IFNE *ZERO                      *IF
     C           WN0039    DIV  WN0008    WN0029    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0009    IFEQ 'D'                        *IF
     C           WN0039    MULT WN0008    WN0029    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0041 114       Cost based on U
     C                     Z-ADD*ZERO     WN0042 114       Cost based on U
     C                     Z-ADD*ZERO     WN0043 114       Cost based on U
      *
      * Clc Convert Cost       IF
      * Initialize parameter values
     C                     Z-ADD*ZERO     WN0032           Cost based on U
     C                     Z-ADD*ZERO     WN0033           Cost based on U
     C                     Z-ADD*ZERO     WN0034           Cost based on U
      * Process based on Unit of Measure entered
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Cost
     C           WN0007    IFEQ WN0007                     *IF
     C                     Z-ADDWN0018    WN0032           Cost based on U
      * Process second U/M if entered
      * CASE: PAR.U/M - Second is Entered
     C           WN0010    IFNE *BLANK                     *IF
      * Convert based on operation code
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0009    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0008    IFNE *ZERO                      *IF
     C           WN0018    DIV  WN0008    WN0042    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0009    IFEQ 'D'                        *IF
     C           WN0018    MULT WN0008    WN0042    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0042    WN0033           Cost based on U
     C                     END                             *FI
      * Process third U/M if entered
      * CASE: PAR.U/M - Third is Entered
     C           WN0013    IFNE *BLANK                     *IF
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0012    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0011    IFNE *ZERO                      *IF
     C           WN0042    DIV  WN0011    WN0034    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0012    IFEQ 'D'                        *IF
     C           WN0042    MULT WN0011    WN0034    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Cost
     C           WN0010    IFEQ WN0007                     *IF
     C                     Z-ADDWN0018    WN0033           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0009    IFEQ 'M'                        *IF
     C           WN0018    MULT WN0008    WN0032    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0009    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0008    IFNE *ZERO                      *IF
     C           WN0018    DIV  WN0008    WN0032    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Process third U/M if entered
      * CASE: PAR.U/M - Third is Entered
     C           WN0013    IFNE *BLANK                     *IF
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0012    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0011    IFNE *ZERO                      *IF
     C           WN0018    DIV  WN0011    WN0034    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0012    IFEQ 'D'                        *IF
     C           WN0018    MULT WN0011    WN0034    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Cost
     C           WN0013    IFEQ WN0007                     *IF
     C                     Z-ADDWN0018    WN0034           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0012    IFEQ 'M'                        *IF
     C           WN0018    MULT WN0011    WN0042    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0012    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           WN0011    IFNE *ZERO                      *IF
     C           WN0018    DIV  WN0011    WN0042    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0042    WN0033           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0009    IFEQ 'M'                        *IF
     C           WN0042    MULT WN0008    WN0032    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0009    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           WN0008    IFNE *ZERO                      *IF
     C           WN0042    DIV  WN0008    WN0032    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           WN0018    MULT WN0036    WN0025           Extended Amount
     C                     MOVEL*BLANK    WN0037           USR Reason Code
      * Rtv Item Typ/Grp/Cls  RT - Item  * 
     C                     EXSR SERVGN
      * RMC E00168  6/06/08 Crt CAB7CPP if adj qty or weight NOT zero.
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Quantity Total S is not equal zero
      *   |- c2    : PAR.USR Transaction Weight is NE 0
      *   '-
     C           WN0035    IFNE *ZERO                      *IF
     C           WN0036    ORNE 0                          *OR
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
     C                     EXSR SFRVGN
      * Error if unit cost = 0
      * CASE: PAR.Unit Cost Pricing U/M EQ WRK.ZERO
     C           WN0018    IFEQ WUW0NB                     *IF
     C                     MOVEL'ERR'     WN0037           USR Reason Code
     C                     END                             *FI
      * Crt IC Trans. Detail   CR - Item Transaction Detail  * 
     C                     EXSR SGCRRC
     C                     END                             *FI
      * CHG Value/Qty/Wgt      CH - Item Balance Detail  * 
     C                     EXSR SHCHRC
      * 11/25/09 PKD Comment out until we know what we need to do here.
      * E00168 6/06/08 Dont do this here for EVERY item bal dtl. do in ca
      * Chg Clear Physical Cnt Ch - Item Balance Detail  * 
     C                     EXSR SLCHRC
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       P4LTSX           Exceptions Exis
     C                     END                             *FI
     C           KRSSB     READE@B1REJ0                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Base Values        RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCHGCD           Item Code
      * Setup key
     C                     Z-ADDWBAIC3    WCAIC3           Company Number
     C                     Z-ADDWBHGCD    WCHGCD           Item Code
      * Establish starting position
     C           KRSSC     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0005           Description Lin
     C                     MOVEL*BLANK    WN0006           Description Lin
     C                     MOVEL*BLANK    WN0007           U/M - Primary
     C                     Z-ADD*ZERO     WN0008           Conversion Fact
     C                     MOVEL*BLANK    WN0009           Operation Facto
     C                     MOVEL*BLANK    WN0010           U/M - Second
     C                     Z-ADD*ZERO     WN0011           Conversion Fact
     C                     MOVEL*BLANK    WN0012           Operation Facto
     C                     MOVEL*BLANK    WN0013           U/M - Third
     C                     MOVEL*BLANK    WN0014           U/M - Pricing
     C                     Z-ADD*ZERO     WN0015           Unit Weight
     C                     MOVEL*BLANK    WN0016           Production Date
     C                     MOVEL*BLANK    WN0017           Catch Weight St
     C                     Z-ADD*ZERO     WUCHTM           Fresh Chilling
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCAVNA    WN0005           Description Lin
     C                     MOVELWCAWNA    WN0006           Description Lin
     C                     MOVELWCADCD    WN0007           U/M - Primary
     C                     Z-ADDWCAWPC    WN0008           Conversion Fact
     C                     MOVELWCLXST    WN0009           Operation Facto
     C                     MOVELWCAECD    WN0010           U/M - Second
     C                     Z-ADDWCAXPC    WN0011           Conversion Fact
     C                     MOVELWCLYST    WN0012           Operation Facto
     C                     MOVELWCAFCD    WN0013           U/M - Third
     C                     MOVELWCAICD    WN0014           U/M - Pricing
     C                     Z-ADDWCAIWG    WN0015           Unit Weight
     C                     MOVELWCFZST    WN0016           Production Date
     C                     MOVELWCAVST    WN0017           Catch Weight St
     C                     Z-ADDWCCHTM    WUCHTM           Fresh Chilling
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Unit Cost          RT - IC Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDHGCD           Item Code
     C                     KFLD           WDAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWBAIC3    WDAIC3           Company Number
     C                     Z-ADDWBHGCD    WDHGCD           Item Code
     C                     MOVELWBAJCD    WDAJCD           Warehouse Code
      * Establish starting position
     C           KRSSD     CHAIN@B0REJX              90    *
      * Data record not found
     C   90                MOVEL'USR0328' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDAGCS    WN0018           Unit Cost Per P
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Item Typ/Grp/Cls  RT - Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCHGCD           Item Code
      * Setup key
     C                     Z-ADDWBAIC3    WCAIC3           Company Number
     C                     Z-ADDWBHGCD    WCHGCD           Item Code
      * Establish starting position
     C           KRSSE     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCRINB    WN0019           Item Structure
     C                     Z-ADDWCRHNB    WN0020           Item Structure
     C                     Z-ADDWCRGNB    WN0021           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WEHGCD    WQSF02           Item Code
     C           *LIKE     DEFN WEAJCD    WQSF03           Warehouse Code
     C           *LIKE     DEFN WEW9ST    WQSF04           Inventory Trans
     C           *LIKE     DEFN WEBSST    WQSF05           Inventory Trans
     C           *LIKE     DEFN WEB4DT    WQSF06           Transaction Dat
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Item Code
     C                     KFLD           WQSF03           Warehouse Code
     C                     KFLD           WQSF04           Inventory Trans
     C                     KFLD           WQSF05           Inventory Trans
     C                     KFLD           WQSF06           Transaction Dat
      * Setup key
     C                     Z-ADDWBAIC3    WQSF01           Company Number
     C                     Z-ADDWBHGCD    WQSF02           Item Code
     C                     MOVELWBAJCD    WQSF03           Warehouse Code
     C                     MOVEL'A'       WQSF04           Inventory Trans
     C                     MOVEL'AP'      WQSF05           Inventory Trans
     C                     Z-ADDP2B4DT    WQSF06           Transaction Dat
      * Establish starting position
     C           KRSSF     SETLL@B7CPZA                    *
     C           KRSSF     READE@B7CPZA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0344' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WN0022           ITD Sequence Nu
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WEC4NY    ADD  1         WN0022           ITD Sequence Nu
     C                     GOTO SFEXIT                     *QUIT
     C           KRSSF     READE@B7CPZA                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCRRC    BEGSR
      *================================================================
      * Crt IC Trans. Detail   CR - Item Transaction Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0044  60       Job Time
     C                     MOVEL*BLANK    WN0045 10        User Id
     C                     MOVEL*BLANK    WN0046 10        Job Name
     C                     Z-ADD*ZERO     WN0047  70       Job Date
     C                     Z-ADD*ZERO     WN0048  20       Production Hour
     C                     Z-ADD*ZERO     WN0049 112       Production Weig
     C                     Z-ADD*ZERO     WN0050  50       Production Quan
     C                     Z-ADD*ZERO     WN0051  70       Production Piec
     C                     MOVEL*BLANK    WN0052  1        Export/Domestic
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B7CPJZ
     C                     Z-ADDWBAIC3    WFAIC3           Company Number
     C                     Z-ADDWBHGCD    WFHGCD           Item Code
     C                     MOVELWBAJCD    WFAJCD           Warehouse Code
     C                     MOVEL'A'       WFW9ST           Inventory Trans
     C                     MOVEL'AP'      WFBSST           Inventory Trans
     C                     Z-ADDP2B4DT    WFB4DT           Transaction Dat
     C                     Z-ADDWN0022    WFC4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     WFDXNB           Sequence Number
     C                     Z-ADDWBELDT    WFELDT           Production Date
     C                     MOVELWN0007    WFHVCD           U/M - Transacti
     C                     MOVEL'IC'      WFF1ST           Item Transactio
     C                     MOVEL@CN,001   WFAUNA           Description
     C                     Z-ADDWN0035    WFA5QT           Transaction Qua
     C                     Z-ADDWN0036    WFAHWG           Transaction Wei
     C                     Z-ADD*ZERO     WFAKCS           USR Transaction
     C                     MOVELWN0007    WFCGCD           U/M - Cost
     C                     Z-ADDWN0025    WFAYVA           Extended Amount
     C                     MOVEL*BLANK    WFBJNA           Ticket Number
     C                     Z-ADD*ZERO     WFCKNB           G/L Document Nu
     C                     MOVEL*BLANK    WFBMST           G/L Update Stat
     C                     MOVELWN0037    WFCQCD           Reason Code
     C                     MOVEL*BLANK    WFDTCD           Reference Numbe
     C                     MOVEL*BLANK    WFMGNA           Lot ID
     C                     Z-ADD*ZERO     WFTRBN           Transfer Batch
     C                     Z-ADD*ZERO     WFTRBS           Transfer Batch
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADDWN0019    WFRINB           Item Structure
     C                     Z-ADDWN0020    WFRHNB           Item Structure
     C                     Z-ADDWN0021    WFRGNB           Item Structure
     C                     MOVEL*BLANK    WFM3NA           Employee Badge
     C                     Z-ADD*ZERO     WFAWTM           Production Time
     C                     MOVELWN0004    WFXLCD           Shift Number
     C                     Z-ADDWBK7DT    WFK7DT           Label Date
     C                     MOVEL*BLANK    WFUVST           EDI Status 1
     C                     MOVEL*BLANK    WFUWST           EDI Status 2
     C                     MOVEL*BLANK    WFUXST           EDI Status 3
     C                     MOVEL'A'       WFVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##JOB     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
     C           KLCRSG    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFAJCD           Warehouse Code
     C                     KFLD           WFW9ST           Inventory Trans
     C                     KFLD           WFBSST           Inventory Trans
     C                     KFLD           WFB4DT           Transaction Dat
     C                     KFLD           WFC4NY           ITD Sequence Nu
     C                     KFLD           WFDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSG    SETLL@B7CPJZ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0345' W0RTN   7
      * Send message 'Item Transaction Detai EX'
     C                     MOVEL'USR0345' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C                     WRITE@B7CPJZ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * Crt Export Rate Dtl   XF - Item Transaction Detail  * 
     C                     CALL 'POO5XFR'              90  Crt Export Rate
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WFAIC3    WQ0001  30       Company Number
     C                     PARM WFHGCD    WQ0002  70       Item Code
     C                     PARM WFAJCD    WQ0003  3        Warehouse Code
     C                     PARM WFW9ST    WQ0004  1        Inventory Trans
     C                     PARM WFBSST    WQ0005  2        Inventory Trans
     C                     PARM WFB4DT    WQ0006  70       Transaction Dat
     C                     PARM WFDXNB    WQ0007  30       Sequence Number
     C                     PARM WFELDT    WQ0008  70       Production Date
     C                     PARM WFHVCD    WQ0009  2        U/M - Transacti
     C                     PARM WFF1ST    WQ0010  2        Item Transactio
     C                     PARM WFAUNA    WQ0011 30        Description
     C                     PARM WFA5QT    WQ0012 112       Transaction Qua
     C                     PARM WFAHWG    WQ0013 112       Transaction Wei
     C                     PARM WFAKCS    WQ0014 114       USR Transaction
     C                     PARM WFCGCD    WQ0015  2        U/M - Cost
     C                     PARM WFAYVA    WQ0016 112       Extended Amount
     C                     PARM WFBJNA    WQ0017  6        Ticket Number
     C                     PARM WFCKNB    WQ0018  80       G/L Document Nu
     C                     PARM WFBMST    WQ0019  1        G/L Update Stat
     C                     PARM WFCQCD    WQ0020  3        Reason Code
     C                     PARM WFDTCD    WQ0021 15        Reference Numbe
     C                     PARM WFMGNA    WQ0022 10        Lot ID
     C                     PARM WFTRBN    WQ0023  70       Transfer Batch
     C                     PARM WFTRBS    WQ0024  30       Transfer Batch
     C                     PARM WFC4NB    WQ0025  70       Order Number
     C                     PARM WFRINB    WQ0026  30       Item Structure
     C                     PARM WFRHNB    WQ0027  30       Item Structure
     C                     PARM WFRGNB    WQ0028  30       Item Structure
     C                     PARM WFM3NA    WQ0029 10        Employee Badge
     C                     PARM WFAWTM    WQ0030  60       Production Time
     C                     PARM WFXLCD    WQ0031  1        Shift Number
     C                     PARM WFK7DT    WQ0032  70       Label Date
     C                     PARM WFVSST    WQ0033  1        Record Status
     C                     PARM WFAATM    WQ0034  60       Job Time
     C                     PARM WFAXDT    WQ0035  70       Job Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POO5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCHRC    BEGSR
      *================================================================
      * CHG Value/Qty/Wgt      CH - Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0053 112       Physical Count
     C                     Z-ADD*ZERO     WN0054 112       Physical Count
     C                     Z-ADD*ZERO     WN0055 112       Physical Count
     C                     Z-ADD*ZERO     WN0056 112       Physical Count
     C                     MOVEL*BLANK    WN0057  1        Physical Count
     C                     Z-ADD*ZERO     WN0058 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0059 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0060 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0061 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0062 112       Quantity In Chi
     C                     Z-ADD*ZERO     WN0063 112       Weight In Chill
     C                     MOVEL*BLANK    WN0064  1        Update Exceptio
     C                     Z-ADD*ZERO     WN0065 112       Physical Start
     C                     Z-ADD*ZERO     WN0066 112       Physical Start
     C                     Z-ADD*ZERO     WN0067 112       Physical Start
     C                     Z-ADD*ZERO     WN0068 112       Physical Start
     C                     Z-ADD*ZERO     WN0069  70       Physical Start
     C                     Z-ADD*ZERO     WN0070 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0071 114       Last Cost
     C                     Z-ADD*ZERO     WN0072 112       Value of On Han
     C                     Z-ADD*ZERO     WN0073  70       Label Date
     C                     MOVEL*BLANK    WN0074  1        EDI Status 1
     C                     MOVEL*BLANK    WN0075  1        EDI Status 2
     C                     MOVEL*BLANK    WN0076  1        EDI Status 3
     C                     MOVEL*BLANK    WN0077  1        Record Status
     C                     Z-ADD*ZERO     WN0078  60       Job Time
     C                     MOVEL*BLANK    WN0079 10        User Id
     C                     MOVEL*BLANK    WN0080 10        Job Name
     C                     Z-ADD*ZERO     WN0081  70       Job Date
     C                     MOVEL*BLANK    WN0082  1        Shift Number
     C                     MOVEL*BLANK    WN0083  1        Lot Tracking Fl
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
     C                     MOVEL'1'       WN0082           Shift Number
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @B1REJ1
     C                     Z-ADDWBAIC3    WGAIC3           Company Number
     C                     Z-ADDWBHGCD    WGHGCD           Item Code
     C                     MOVELWBAJCD    WGAJCD    P      Warehouse Code
     C                     Z-ADDWBELDT    WGELDT           Production Date
      *
     C           KLCHSH    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
     C                     KFLD           WGELDT           Production Date
     C           KLCHSH    CHAIN@B1REJ1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Item Bal. Detail   CR - Item Balance Detail  * 
     C                     EXSR SICRRC
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB11    YARDCS
      * Move non-key fields to @B1REJ1
     C                     Z-ADDWN0019    WGRINB           Item Structure
     C                     Z-ADDWN0020    WGRHNB           Item Structure
     C                     Z-ADDWN0021    WGRGNB           Item Structure
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'Y'       YARDC            *Record Data Ch
     C                     ADD  WN0029    WGARQT           Quantity on Han
     C                     ADD  WN0036    WGACWG           Quantity on Han
     C                     ADD  WN0025    WGIDVA           Value of On Han
      * If quantity is zero, so are weight, value of inventory
      * CASE: DB1.Quantity on Hand - U/M1 EQ WRK.ZERO
     C           WGARQT    IFEQ WUW0NB                     *IF
      * UPD Create Weight Adj. XF - Item Transaction Detail  * 
     C                     CALL 'PDMYXFR'              90  UPD Create Weig
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WGAIC3    WQ0038  30       Company Number
     C                     PARM WGHGCD    WQ0039  70       Item Code
     C                     PARM WGAJCD    WQ0040  3        Warehouse Code
     C                     PARM P2B4DT    WQ0041  70       Transaction Dat
     C                     PARM WGELDT    WQ0042  70       Production Date
     C                     PARM WN0007    WQ0043  2        U/M - Transacti
     C                     PARM WGACWG    WQ0044 112       Transaction Wei
     C                     PARM WN0018    WQ0045 114       USR Transaction
     C                     PARM WN0007    WQ0046  2        U/M - Cost
     C                     PARM WGRINB    WQ0047  30       Item Structure
     C                     PARM WGRHNB    WQ0048  30       Item Structure
     C                     PARM WGRGNB    WQ0049  30       Item Structure
     C                     PARM WN0082    WQ0050  1        Shift Number
     C                     PARM WGK7DT    WQ0051  70       Label Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD*ZERO     WGACWG           Quantity on Han
     C                     Z-ADD*ZERO     WGIDVA           Value of On Han
     C                     END                             *FI
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WGAXDT    PARM *ZERO     WQ0052 155       Current System
     C           WGAATM    PARM *ZERO     WQ0053 155       Current System
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@B1REJ1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB1REL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * CASE: DB1.Quantity on Hand - U/M1 EQ WRK.ZERO
     C           WGARQT    IFEQ WUW0NB                     *IF
      * Rtv Lot Tracking Flag RT - Warehouse  * 
     C                     EXSR SJRVGN
      * CASE: PAR.Lot Tracking Flag is Not Yes
     C           WN0083    IFEQ *BLANK                     *IF
     C           WN0083    OREQ 'N'
      * DLT Item Bal. Detail   DL - Item Balance Detail  * 
     C                     EXSR SKDLRC
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICRRC    BEGSR
      *================================================================
      * Crt Item Bal. Detail   CR - Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0084  60       Job Time
     C                     MOVEL*BLANK    WN0085 10        User Id
     C                     MOVEL*BLANK    WN0086 10        Job Name
     C                     Z-ADD*ZERO     WN0087  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1REJ1
     C                     Z-ADDWBAIC3    WGAIC3           Company Number
     C                     Z-ADDWBHGCD    WGHGCD           Item Code
     C                     MOVELWBAJCD    WGAJCD           Warehouse Code
     C                     Z-ADDWBELDT    WGELDT           Production Date
     C                     Z-ADD*ZERO     WGABWG           Physical Count
     C                     Z-ADD*ZERO     WGAGQT           Physical Count
     C                     Z-ADD*ZERO     WGAHQT           Physical Count
     C                     Z-ADD*ZERO     WGAIQT           Physical Count
     C                     MOVEL*BLANK    WGCTST           Physical Count
     C                     Z-ADDWN0036    WGACWG           Quantity on Han
     C                     Z-ADDWN0029    WGARQT           Quantity on Han
     C                     Z-ADD*ZERO     WGASQT           Quantity on Han
     C                     Z-ADD*ZERO     WGATQT           Quantity on Han
     C                     Z-ADD*ZERO     WGHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WGHEQT           Weight In Chill
     C                     MOVEL'N'       WGF6ST           Update Exceptio
     C                     Z-ADD*ZERO     WGBMWG           Physical Start
     C                     Z-ADD*ZERO     WGDSQT           Physical Start
     C                     Z-ADD*ZERO     WGDTQT           Physical Start
     C                     Z-ADD*ZERO     WGDUQT           Physical Start
     C                     Z-ADD*ZERO     WGDHDT           Physical Start
     C                     Z-ADD*ZERO     WGAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WGAECS           Last Cost
     C                     Z-ADDWN0025    WGIDVA           Value of On Han
     C                     Z-ADDWBK7DT    WGK7DT           Label Date
     C                     Z-ADDWN0019    WGRINB           Item Structure
     C                     Z-ADDWN0020    WGRHNB           Item Structure
     C                     Z-ADDWN0021    WGRGNB           Item Structure
     C                     MOVEL*BLANK    WGUVST           EDI Status 1
     C                     MOVEL*BLANK    WGUWST           EDI Status 2
     C                     MOVEL*BLANK    WGUXST           EDI Status 3
     C                     MOVEL'A'       WGVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WGAXDT    PARM *ZERO     WQ0036 155       Current System
     C           WGAATM    PARM *ZERO     WQ0037 155       Current System
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C           KLCRSI    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
     C                     KFLD           WGELDT           Production Date
      * Check for duplicate primary key
     C           KLCRSI    SETLL@B1REJ1                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0331' W0RTN   7
      * Send message 'Item Balance Detail    EX'
     C                     MOVEL'USR0331' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C                     WRITE@B1REJ1                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WHAJCD           Warehouse Code
      * Setup key
     C                     MOVELWGAJCD    WHAJCD           Warehouse Code
      * Establish starting position
     C           KRSSJ     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0083           Lot Tracking Fl
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHVHST    WN0083           Lot Tracking Fl
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKDLRC    BEGSR
      *================================================================
      * DLT Item Bal. Detail   DL - Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B1REJ1
      *
     C           KLDLSK    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
     C                     KFLD           WGELDT           Production Date
     C           KLDLSK    CHAIN@B1REJ1              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B1REJ1                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * Chg Clear Physical Cnt Ch - Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0088 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0089 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0090 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0091 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0092 112       Quantity In Chi
     C                     Z-ADD*ZERO     WN0093 112       Weight In Chill
     C                     Z-ADD*ZERO     WN0094 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0095 114       Last Cost
     C                     Z-ADD*ZERO     WN0096 112       Value of On Han
     C                     Z-ADD*ZERO     WN0097  70       Label Date
     C                     Z-ADD*ZERO     WN0098  30       Item Structure
     C                     Z-ADD*ZERO     WN0099  30       Item Structure
     C                     Z-ADD*ZERO     WN0100  30       Item Structure
     C                     MOVEL*BLANK    WN0101  1        EDI Status 1
     C                     MOVEL*BLANK    WN0102  1        EDI Status 2
     C                     MOVEL*BLANK    WN0103  1        EDI Status 3
     C                     MOVEL*BLANK    WN0104  1        Record Status
     C                     Z-ADD*ZERO     WN0105  60       Job Time
     C                     MOVEL*BLANK    WN0106 10        User Id
     C                     MOVEL*BLANK    WN0107 10        Job Name
     C                     Z-ADD*ZERO     WN0108  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @B1REJ1
     C                     Z-ADDWBAIC3    WGAIC3           Company Number
     C                     Z-ADDWBHGCD    WGHGCD           Item Code
     C                     MOVELWBAJCD    WGAJCD    P      Warehouse Code
     C                     Z-ADDWBELDT    WGELDT           Production Date
      *
     C           KLCHSL    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
     C                     KFLD           WGELDT           Production Date
     C           KLCHSL    CHAIN@B1REJ1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB11    YBRDCS
      * Move non-key fields to @B1REJ1
     C                     Z-ADD*ZERO     WGABWG           Physical Count
     C                     Z-ADD*ZERO     WGAGQT           Physical Count
     C                     Z-ADD*ZERO     WGAHQT           Physical Count
     C                     Z-ADD*ZERO     WGAIQT           Physical Count
     C                     MOVEL*BLANK    WGCTST    P      Physical Count
     C                     MOVEL'N'       WGF6ST    P      Update Exceptio
     C                     Z-ADD*ZERO     WGBMWG           Physical Start
     C                     Z-ADD*ZERO     WGDSQT           Physical Start
     C                     Z-ADD*ZERO     WGDTQT           Physical Start
     C                     Z-ADD*ZERO     WGDUQT           Physical Start
     C                     Z-ADD*ZERO     WGDHDT           Physical Start
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##PGM     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@B1REJ1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB1REL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Sum Act Qty,Wgt,ValRT - Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0004           Quantity on Han
     C                     Z-ADD*ZERO     WL0005           Quantity on Han
     C                     Z-ADD*ZERO     WL0006           Quantity on Han
     C                     Z-ADD*ZERO     WL0007           Quantity on Han
     C                     Z-ADD*ZERO     WL0008           Value of On Han
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIAIC3    WQSM01           Company Number
     C           *LIKE     DEFN WIHGCD    WQSM02           Item Code
     C           *LIKE     DEFN WIAJCD    WQSM03           Warehouse Code
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Item Code
     C                     KFLD           WQSM03           Warehouse Code
      * Setup key
     C                     Z-ADDWL0001    WQSM01           Company Number
     C                     Z-ADDWL0002    WQSM02           Item Code
     C                     MOVELWL0003    WQSM03           Warehouse Code
      * Establish starting position
     C           KRSSM     SETLLCAB1RL4                    *
     C           KRSSM     READECAB1RL4                  90*
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WIACWG    WL0004           Quantity on Han
     C                     ADD  WIARQT    WL0005           Quantity on Han
     C                     ADD  WIASQT    WL0006           Quantity on Han
     C                     ADD  WIATQT    WL0007           Quantity on Han
     C                     ADD  WIIDVA    WL0008           Value of On Han
     C           KRSSM     READECAB1RL4                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCHRC    BEGSR
      *================================================================
      * Chg Val/Qty/Wgt        Ch - Item Balance  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0109 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0110 114       Last Cost
     C                     Z-ADD*ZERO     WN0111 114       Cost per Primar
     C                     Z-ADD*ZERO     WN0112 114       Cost per Pricin
     C                     Z-ADD*ZERO     WN0113 114       Revaluation Cos
     C                     Z-ADD*ZERO     WN0114  70       Revaluation Eff
     C                     MOVEL*BLANK    WN0115  1        Revaluation Cos
     C                     Z-ADD*ZERO     WN0116 114       Last Revaluatio
     C                     Z-ADD*ZERO     WN0117  70       Last Revaluatio
     C                     Z-ADD*ZERO     WN0118 112       On Hand U/M2 Su
     C                     Z-ADD*ZERO     WN0119 112       On Hand U/M3 Su
     C                     Z-ADD*ZERO     WN0120 112       Quantity In Chi
     C                     Z-ADD*ZERO     WN0121 112       Weight In Chill
     C                     Z-ADD*ZERO     WN0122 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0123 112       Quantity on Sal
     C                     Z-ADD*ZERO     WN0124 112       Quantity on Pur
     C                     Z-ADD*ZERO     WN0125 112       Quantity on Tra
     C                     Z-ADD*ZERO     WN0126 112       Quantity Avail.
     C                     MOVEL*BLANK    WN0127  3        Cycle Count Cod
     C                     Z-ADD*ZERO     WN0128  70       Date of Last Or
     C                     Z-ADD*ZERO     WN0129  70       Date of Last Sh
     C                     MOVEL*BLANK    WN0130  1        Inventory Plann
     C                     Z-ADD*ZERO     WN0131  52       Safety Allowanc
     C                     Z-ADD*ZERO     WN0132 112       Safety Allowanc
     C                     Z-ADD*ZERO     WN0133  70       Stock Out Date
     C                     MOVEL*BLANK    WN0134  3        Buyer Code
     C                     Z-ADD*ZERO     WN0135  30       Lead Time - Las
     C                     Z-ADD*ZERO     WN0136  70       Lead Time - Dat
     C                     Z-ADD*ZERO     WN0137  30       Lead Time - Nex
     C                     Z-ADD*ZERO     WN0138  70       Lead Time - Dat
     C                     MOVEL*BLANK    WN0139  1        Lead Time - Exc
     C                     Z-ADD*ZERO     WN0140 112       Usage Qty per C
     C                     Z-ADD*ZERO     WN0141 112       Usage Weight pe
     C                     Z-ADD*ZERO     WN0142  70       Inventory Manag
     C                     Z-ADD*ZERO     WN0143 112       Minimum Quantit
     C                     Z-ADD*ZERO     WN0144 112       Maximum Quantit
     C                     Z-ADD*ZERO     WN0145  70       Last Physical C
     C                     MOVEL*BLANK    WN0146  1        Requisition Mod
     C                     MOVEL*BLANK    WN0147  1        Cost Update Pen
     C                     MOVEL*BLANK    WN0148  1        Post G/L Status
     C                     Z-ADD*ZERO     WN0149  80       Vendor - Item/W
     C                     Z-ADD*ZERO     WN0150  30       Item Structure
     C                     Z-ADD*ZERO     WN0151  30       Item Structure
     C                     Z-ADD*ZERO     WN0152  30       Item Structure
     C                     MOVEL*BLANK    WN0153  1        EDI Status 1
     C                     MOVEL*BLANK    WN0154  1        EDI Status 2
     C                     MOVEL*BLANK    WN0155  1        EDI Status 3
     C                     MOVEL*BLANK    WN0156  1        Record Status
     C                     Z-ADD*ZERO     WN0157  60       Job Time
     C                     MOVEL*BLANK    WN0158 10        User Id
     C                     MOVEL*BLANK    WN0159 10        Job Name
     C                     Z-ADD*ZERO     WN0160  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @B0REJT
     C                     Z-ADDWL0009    WJAIC3           Company Number
     C                     Z-ADDWL0010    WJHGCD           Item Code
     C                     MOVELWL0011    WJAJCD    P      Warehouse Code
      *
     C           KLCHSN    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJHGCD           Item Code
     C                     KFLD           WJAJCD           Warehouse Code
     C           KLCHSN    CHAIN@B0REJT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB0REL0'MDACP
     C                     MOVEL'@B0REJT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB01    YCRDCS
      * Move non-key fields to @B0REJT
     C                     Z-ADDWL0012    WJBOWG           On Hand Weight
     C                     Z-ADDWL0013    WJDDQT           On Hand U/M1 Su
     C                     Z-ADDWL0014    WJIDVA           Value of On Han
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'Y'       YCRDC            *Record Data Ch
      * Refresh the available to sell quantity
     C                     Z-ADDWJDDQT    WJDOQT           Quantity Avail.
     C                     SUB  WJAQQT    WJDOQT           Quantity Avail.
     C                     SUB  WJAUQT    WJDOQT           Quantity Avail.
     C                     SUB  WJEMQT    WJDOQT           Quantity Avail.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##JOB     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@B0REJT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB0REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Lot Track,int flg RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WHAJCD           Warehouse Code
      * Setup key
     C                     MOVELP1AJCD    WHAJCD           Warehouse Code
      * Establish starting position
     C           KRSSO     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0004           Lot Tracking Fl
     C                     MOVEL*BLANK    YL0005           Warehouse Locat
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHVHST    YL0004           Lot Tracking Fl
     C                     MOVELWHT0ST    YL0005           Warehouse Locat
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Del Zero qty,Wgt  RT - Item Lot Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKAIC3    WQSP01           Company Number
     C           *LIKE     DEFN WKAJCD    WQSP02           Warehouse Code
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Company Number
     C                     KFLD           WQSP02           Warehouse Code
      * Setup key
     C                     Z-ADDP1AIC3    WQSP01           Company Number
     C                     MOVELP1AJCD    WQSP02           Warehouse Code
      * Establish starting position
     C           KRSSP     SETLL@L5CPX4                    *
     C           KRSSP     READE@L5CPX4                  90*
      * Data record not found
     C   90                MOVEL'USR2634' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.ILL Item Qty On-Hand is LE Zero
     C           WKJ2QT    IFLE *ZERO                      *IF
      * Del Item Location     DL - Item Lot Location  * 
     C                     EXSR SQDLRC
     C                     END                             *FI
     C           KRSSP     READE@L5CPX4                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQDLRC    BEGSR
      *================================================================
      * Del Item Location     DL - Item Lot Location  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0161  50       ILL Item Qty On
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @L5CPSL
     C                     Z-ADDWKAIC3    WLAIC3           Company Number
     C                     Z-ADDWKHGCD    WLHGCD           Item Code
     C                     MOVELWKAJCD    WLAJCD           Warehouse Code
     C                     Z-ADDWKELDT    WLELDT           Production Date
     C                     Z-ADDWKLXNM    WLLXNM           Lot Number
     C                     MOVELWKYMCD    WLYMCD           Location Code
     C                     Z-ADDWKYNCD    WLYNCD           Location Level
      *
     C           KLDLSQ    KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLHGCD           Item Code
     C                     KFLD           WLAJCD           Warehouse Code
     C                     KFLD           WLELDT           Production Date
     C                     KFLD           WLLXNM           Lot Number
     C                     KFLD           WLYMCD           Location Code
     C                     KFLD           WLYNCD           Location Level
     C           KLDLSQ    CHAIN@L5CPSL              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL5CPL0'MDACP
     C                     MOVEL'@L5CPSL' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@L5CPSL                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WAAECS           Last Cost
     C                     Z-ADD*ZERO     WABACS           Cost per Primar
     C                     Z-ADD*ZERO     WABBCS           Cost per Pricin
     C                     Z-ADD*ZERO     WACBPR           Revaluation Cos
     C                     Z-ADD*ZERO     WAGUDT           Revaluation Eff
     C                     Z-ADD*ZERO     WACTPR           Last Revaluatio
     C                     Z-ADD*ZERO     WAG4DT           Last Revaluatio
     C                     Z-ADD*ZERO     WABOWG           On Hand Weight
     C                     Z-ADD*ZERO     WADDQT           On Hand U/M1 Su
     C                     Z-ADD*ZERO     WADEQT           On Hand U/M2 Su
     C                     Z-ADD*ZERO     WADFQT           On Hand U/M3 Su
     C                     Z-ADD*ZERO     WAHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WAHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WAAJQT           Quantity Schedu
     C                     Z-ADD*ZERO     WAAQQT           Quantity on Sal
     C                     Z-ADD*ZERO     WAAUQT           Quantity on Pur
     C                     Z-ADD*ZERO     WAEMQT           Quantity on Tra
     C                     Z-ADD*ZERO     WADOQT           Quantity Avail.
     C                     Z-ADD*ZERO     WAAKDT           Date of Last Or
     C                     Z-ADD*ZERO     WAANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WAIDVA           Value of On Han
     C                     Z-ADD*ZERO     WABZPC           Safety Allowanc
     C                     Z-ADD*ZERO     WADGQT           Safety Allowanc
     C                     Z-ADD*ZERO     WADIDT           Stock Out Date
     C                     Z-ADD*ZERO     WABFDY           Lead Time - Las
     C                     Z-ADD*ZERO     WADJDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WABGDY           Lead Time - Nex
     C                     Z-ADD*ZERO     WADKDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WADJQT           Usage Qty per C
     C                     Z-ADD*ZERO     WABNWG           Usage Weight pe
     C                     Z-ADD*ZERO     WADLDT           Inventory Manag
     C                     Z-ADD*ZERO     WADPQT           Minimum Quantit
     C                     Z-ADD*ZERO     WADQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WADMDT           Last Physical C
     C                     Z-ADD*ZERO     WAAKC8           Vendor - Item/W
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBELDT           Production Date
     C                     Z-ADD*ZERO     WBABWG           Physical Count
     C                     Z-ADD*ZERO     WBAGQT           Physical Count
     C                     Z-ADD*ZERO     WBAHQT           Physical Count
     C                     Z-ADD*ZERO     WBAIQT           Physical Count
     C                     Z-ADD*ZERO     WBACWG           Quantity on Han
     C                     Z-ADD*ZERO     WBARQT           Quantity on Han
     C                     Z-ADD*ZERO     WBASQT           Quantity on Han
     C                     Z-ADD*ZERO     WBATQT           Quantity on Han
     C                     Z-ADD*ZERO     WBHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WBHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WBBMWG           Physical Start
     C                     Z-ADD*ZERO     WBDSQT           Physical Start
     C                     Z-ADD*ZERO     WBDTQT           Physical Start
     C                     Z-ADD*ZERO     WBDUQT           Physical Start
     C                     Z-ADD*ZERO     WBDHDT           Physical Start
     C                     Z-ADD*ZERO     WBAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WBAECS           Last Cost
     C                     Z-ADD*ZERO     WBIDVA           Value of On Han
     C                     Z-ADD*ZERO     WBK7DT           Label Date
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WCAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WCAIWG           Unit Weight
     C                     Z-ADD*ZERO     WCCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WCC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WCURTN           Number Cases On
     C                     Z-ADD*ZERO     WCAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WCRINB           Item Structure
     C                     Z-ADD*ZERO     WCRHNB           Item Structure
     C                     Z-ADD*ZERO     WCRGNB           Item Structure
     C                     Z-ADD*ZERO     WCTFNB           Transportation
     C                     Z-ADD*ZERO     WCTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WCTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WCBLPR           Market Overage
     C                     Z-ADD*ZERO     WCBMPR           Standard Overag
     C                     Z-ADD*ZERO     WCCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WCCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WCSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WCPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WCICN1           Item Category N
     C                     Z-ADD*ZERO     WCICN2           Item Category N
     C                     Z-ADD*ZERO     WCV2NB           Item Category N
     C                     Z-ADD*ZERO     WCITCN           Item Category N
     C                     Z-ADD*ZERO     WCITC5           Item Category N
     C                     Z-ADD*ZERO     WCICN6           Item Category N
     C                     Z-ADD*ZERO     WCICN7           Item Category N
     C                     Z-ADD*ZERO     WCICN8           Item Category N
     C                     Z-ADD*ZERO     WCICN9           Item Category N
     C                     Z-ADD*ZERO     WCICN0           Item Category N
     C                     Z-ADD*ZERO     WCSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WCA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WCSJNB           Production Lead
     C                     Z-ADD*ZERO     WCSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WCSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WCSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WCCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WCCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WCILNB           Packages per ca
     C                     Z-ADD*ZERO     WCCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WCCINB           PM Batch Size
     C                     Z-ADD*ZERO     WCCJNB           Package Level s
     C                     Z-ADD*ZERO     WCCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WCCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WCCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WCCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WCCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WCCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WCCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WCCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WCC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WCB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WCB5NB           PM Line Number
     C                     Z-ADD*ZERO     WCBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WCBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WCF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WCF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WCF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WCBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WCBNNB           Production Qty
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WEC4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     WEDXNB           Sequence Number
     C                     Z-ADD*ZERO     WEELDT           Production Date
     C                     Z-ADD*ZERO     WEA5QT           Transaction Qua
     C                     Z-ADD*ZERO     WEAHWG           Transaction Wei
     C                     Z-ADD*ZERO     WEAKCS           USR Transaction
     C                     Z-ADD*ZERO     WEAYVA           Extended Amount
     C                     Z-ADD*ZERO     WECKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WETRBN           Transfer Batch
     C                     Z-ADD*ZERO     WETRBS           Transfer Batch
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WERINB           Item Structure
     C                     Z-ADD*ZERO     WERHNB           Item Structure
     C                     Z-ADD*ZERO     WERGNB           Item Structure
     C                     Z-ADD*ZERO     WEAWTM           Production Time
     C                     Z-ADD*ZERO     WEK7DT           Label Date
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Clear all neither parameters
      * Crt IC Trans. Detail   CR - Item Transaction Detail  * 
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Clear all neither parameters
      * Crt Item Bal. Detail   CR - Item Balance Detail  * 
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WHBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WHBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WHBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WHBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKHGCD           Item Code
     C                     Z-ADD*ZERO     WKELDT           Production Date
     C                     Z-ADD*ZERO     WKLXNM           Lot Number
     C                     Z-ADD*ZERO     WKYNCD           Location Level
     C                     Z-ADD*ZERO     WKJ2QT           ILL Item Qty On
     C                     Z-ADD*ZERO     WKG5WG           ILL Unit Weight
     C                     Z-ADD*ZERO     WKJ3QT           ILL Co-Packer L
     C                     Z-ADD*ZERO     WKG6WG           ILl Item Wgt On
     C                     Z-ADD*ZERO     WKJ4QT           ILL Unused Qty
     C                     Z-ADD*ZERO     WKG7WG           ILL Unused Wgt
     C                     Z-ADD*ZERO     WKLODT           ILL Avail Ship
     C                     Z-ADD*ZERO     WKLPDT           ILL Unused Date
     C                     Z-ADD*ZERO     WKLQDT           ILL Unused Date
     C                     Z-ADD*ZERO     WKNBR            ILL Unused Nbr
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SMRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  3
     C                     Z-ADD*ZERO     WL0004 112
     C                     Z-ADD*ZERO     WL0005 112
     C                     Z-ADD*ZERO     WL0006 112
     C                     Z-ADD*ZERO     WL0007 112
     C                     Z-ADD*ZERO     WL0008 112
      * Define local variables for subroutine SNCHRC.
     C                     Z-ADD*ZERO     WL0009  30
     C                     Z-ADD*ZERO     WL0010  70
     C                     MOVEL*BLANK    WL0011  3
     C                     Z-ADD*ZERO     WL0012 112
     C                     Z-ADD*ZERO     WL0013 112
     C                     Z-ADD*ZERO     WL0014 112
      * Define local work field On Hand Weight Summary
     C                     Z-ADD*ZERO     YL0001 112
      * Define local work field On Hand U/M1 Summary
     C                     Z-ADD*ZERO     YL0002 112
      * Define local work field Value of On Hand Inventor
     C                     Z-ADD*ZERO     YL0003 112
      * Define local work field Lot Tracking Flag
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0005  1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Post physical counts
