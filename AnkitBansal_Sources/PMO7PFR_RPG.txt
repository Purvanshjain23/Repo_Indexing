     H/TITLE PRT Bill of Lading-HPB PF Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     W* Warning: This program does not set on the LR indicator
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 09/20/22  Time  : 15:37:47
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOMFNCPL1IF  E           K        DISK
      * RTV : Manifest Detail           Retrieval index
      *
     FPMDACPLMIF  E           K        DISK
      * RSQ : COA Batch Header RIN      ShpCo/EMTS PTD/EMTS Batc
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FCAAOREL0IF  E           K        DISK
      * RTV : Terms                     Retrieval index       NV
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FPMCAREL2IF  E           K        DISK
      * RSQ : COA Property Define Hdr   Co/Item Code
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FPDNIREL1IF  E           K        DISK
      * RTV : Company Customer EXT      Retrieval index
      *
     FPMDLREL1IF  E           K        DISK
      * RTV : COA Transloading Station  Retrieval index
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FPMDACPLAIF  E           K        DISK
      * RSQ : COA Batch Header RIN      ShCo/Order
      *
     FPNGGREL1IF  E           K        DISK
      * RTV : RFS Transaction Reason    Retrieval index
      *
     FOPBFCPL8IF  E           K        DISK
      * RSQ : Order Header TRG          Load #/All orders
      *
     FPMDACPL5IF  E           K        DISK
      * RSQ : COA Batch Header RIN      Co/EMTS PTD/EMTS Batch
      *
     FPMO7PFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: PRT Bill of Lading-HPB PF Print file
      *
     E                    #L7         7  1
      * Long constants
     E                    @CN#    1  18  6   @CN    25
     I@FLCPBW
      * Load Detail               Retrieval index
      * Renamed input format fields
     I              FLRMNB                          WARMNB
     I              FLRUNB                          WARUNB
     I              FLRVNB                          WARVNB
     I              FLDQTX                          WADQTX
     I              FLRWNB                          WARWNB
     I              FLRXNB                          WARXNB
     I              FLSQNB                          WASQNB
     I              FLT0NB                          WAT0NB
     I              FLT1NB                          WAT1NB
     I              FLR1NB                          WAR1NB
     I              FLAIC3                          WAAIC3
     I              FLC4NB                          WAC4NB
     I              FLVCST                          WAVCST
     I              FLKEDT                          WAKEDT
     I              FLSXNB                          WASXNB
     I              FLKFDT                          WAKFDT
     I              FLACTM                          WAACTM
     I              FLK5TX                          WAK5TX
     I              FLW5CD                          WAW5CD
     I              FLEJDT                          WAEJDT
     I              FLAGTM                          WAAGTM
     I              FLKJDT                          WAKJDT
     I              FLATTM                          WAATTM
     I              FLHDDT                          WAHDDT
     I              FLAUTM                          WAAUTM
     I              FLKKDT                          WAKKDT
     I              FLAVTM                          WAAVTM
     I              FLZ4NB                          WAZ4NB
     I              FLY7ST                          WAY7ST
     I              FLY2ST                          WAY2ST
     I              FLWHTX                          WAWHTX
     I              FLWITX                          WAWITX
     I              FLWJTX                          WAWJTX
     I              FLWKTX                          WAWKTX
     I              FLWLTX                          WAWLTX
     I              FLN7DT                          WAN7DT
     I              FLN8DT                          WAN8DT
     I              FLN9DT                          WAN9DT
     I              FLB3TM                          WAB3TM
     I              FLB4TM                          WAB4TM
     I              FLB5TM                          WAB5TM
     I              FLIASX                          WAIASX
     I              FLIBSX                          WAIBSX
     I              FLICSX                          WAICSX
     I              FLWVTX                          WAWVTX
     I              FLWWTX                          WAWWTX
     I              FLWXTX                          WAWXTX
     I              FLUVST                          WAUVST
     I              FLUWST                          WAUWST
     I              FLUXST                          WAUXST
     I              FLAATM                          WAAATM
     I              FLAYNA                          WAAYNA
     I              FLA0NA                          WAA0NA
     I              FLAXDT                          WAAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WBAIC3
     I              OMC4NB                          WBC4NB
     I              OMDPNB                          WBDPNB
     I              OMUENB                          WBUENB
     I              OMHGCD                          WBHGCD
     I              OMAJCD                          WBAJCD
     I              OMBKC7                          WBBKC7
     I              OMCFC7                          WBCFC7
     I              OMGMST                          WBGMST
     I              OMGNST                          WBGNST
     I              OMMAVA                          WBMAVA
     I              OMKDVA                          WBKDVA
     I              OML8VA                          WBL8VA
     I              OML9VA                          WBL9VA
     I              OMGTST                          WBGTST
     I              OMGVST                          WBGVST
     I              OMGUST                          WBGUST
     I              OMQFST                          WBQFST
     I              OMAYVA                          WBAYVA
     I              OMEXDT                          WBEXDT
     I              OMLQCD                          WBLQCD
     I              OMRDCD                          WBRDCD
     I              OMQ7CD                          WBQ7CD
     I              OMBZPR                          WBBZPR
     I              OML6NB                          WBL6NB
     I              OMU1ST                          WBU1ST
     I              OMGIDT                          WBGIDT
     I              OMCRCD                          WBCRCD
     I              OMAGCD                          WBAGCD
     I              OMRZST                          WBRZST
     I              OMR0ST                          WBR0ST
     I              OMR1ST                          WBR1ST
     I              OMG7NA                          WBG7NA
     I              OMG8NA                          WBG8NA
     I              OMRPCD                          WBRPCD
     I              OMVEST                          WBVEST
     I              OMVGST                          WBVGST
     I              OMAVST                          WBAVST
     I              OMU0ST                          WBU0ST
     I              OMRFCD                          WBRFCD
     I              OMFZST                          WBFZST
     I              OMR1NB                          WBR1NB
     I              OMAVQT                          WBAVQT
     I              OMD0WG                          WBD0WG
     I              OMCCQT                          WBCCQT
     I              OMAUWG                          WBAUWG
     I              OMCBQT                          WBCBQT
     I              OMATWG                          WBATWG
     I              OMAQCS                          WBAQCS
     I              OMAGCS                          WBAGCS
     I              OMAKPR                          WBAKPR
     I              OMALPR                          WBALPR
     I              OMAUPR                          WBAUPR
     I              OMAVWG                          WBAVWG
     I              OMA4WG                          WBA4WG
     I              OMA5DT                          WBA5DT
     I              OMAODT                          WBAODT
     I              OMGNDT                          WBGNDT
     I              OMAMST                          WBAMST
     I              OMANST                          WBANST
     I              OMVAST                          WBVAST
     I              OMRGNB                          WBRGNB
     I              OMRHNB                          WBRHNB
     I              OMRINB                          WBRINB
     I              OMRBCD                          WBRBCD
     I              OMHICD                          WBHICD
     I              OMRNCD                          WBRNCD
     I              OMROCD                          WBROCD
     I              OMCXDT                          WBCXDT
     I              OMAJVN                          WBAJVN
     I              OMKXCD                          WBKXCD
     I              OMJPCD                          WBJPCD
     I              OMCQCD                          WBCQCD
     I              OMR4CD                          WBR4CD
     I              OMZ1ST                          WBZ1ST
     I              OMZ3ST                          WBZ3ST
     I              OMZ4ST                          WBZ4ST
     I              OMDUPR                          WBDUPR
     I              OMB6VL                          WBB6VL
     I              OMA1AA                          WBA1AA
     I              OMFZSX                          WBFZSX
     I              OMF0SX                          WBF0SX
     I              OMF1SX                          WBF1SX
     I              OMF2SX                          WBF2SX
     I              OMF3SX                          WBF3SX
     I              OMF4SX                          WBF4SX
     I              OMF5SX                          WBF5SX
     I              OMF6SX                          WBF6SX
     I              OMF7SX                          WBF7SX
     I              OMNTDT                          WBNTDT
     I              OMNUDT                          WBNUDT
     I              OMNVDT                          WBNVDT
     I              OMNWDT                          WBNWDT
     I              OMNXDT                          WBNXDT
     I              OMBUTM                          WBBUTM
     I              OMBVTM                          WBBVTM
     I              OMBWTM                          WBBWTM
     I              OMBXTM                          WBBXTM
     I              OMBYTM                          WBBYTM
     I              OMH5NX                          WBH5NX
     I              OMH6NX                          WBH6NX
     I              OMH7NX                          WBH7NX
     I              OMH8NX                          WBH8NX
     I              OMH9NX                          WBH9NX
     I              OMDVPR                          WBDVPR
     I              OMDWPR                          WBDWPR
     I              OMDXPR                          WBDXPR
     I              OMDYPR                          WBDYPR
     I              OMDZPR                          WBDZPR
     I              OMGSPR                          WBGSPR
     I              OMGTPR                          WBGTPR
     I              OMGUPR                          WBGUPR
     I              OMHOST                          WBHOST
     I              OMHPST                          WBHPST
     I              OMIOST                          WBIOST
     I              OMPEWG                          WBPEWG
     I              OMRINY                          WBRINY
     I              OMTIDT                          WBTIDT
     I              OMTJDT                          WBTJDT
     I              OMH2ST                          WBH2ST
     I              OMH0ST                          WBH0ST
     I              OMH1ST                          WBH1ST
     I              OMTKDT                          WBTKDT
     I              OMTLDT                          WBTLDT
     I              OMTMDT                          WBTMDT
     I              OMUVST                          WBUVST
     I              OMUWST                          WBUWST
     I              OMUXST                          WBUXST
     I              OMAATM                          WBAATM
     I              OMAYNA                          WBAYNA
     I              OMA0NA                          WBA0NA
     I              OMAXDT                          WBAXDT
      *
     I@DACPDL
      * COA Batch Header RIN      ShCo/Order
      * Renamed input format fields
     I              DAAIC3                          WCAIC3
     I              DAL6T1                          WCL6T1
     I              DAI3NY                          WCI3NY
     I              DAJYNY                          WCJYNY
     I              DAQ1NY                          WCQ1NY
     I              DAMUT1                          WCMUT1
     I              DAJZNY                          WCJZNY
     I              DAJ0NY                          WCJ0NY
     I              DAJ2NY                          WCJ2NY
     I              DARIDT                          WCRIDT
     I              DAC5TM                          WCC5TM
     I              DAMVT1                          WCMVT1
     I              DAMWT1                          WCMWT1
     I              DARINT                          WCRINT
     I              DARJDT                          WCRJDT
     I              DAC6TM                          WCC6TM
     I              DAC4NB                          WCC4NB
     I              DADPNB                          WCDPNB
     I              DAUENB                          WCUENB
     I              DARZNB                          WCRZNB
     I              DANGT1                          WCNGT1
     I              DARMNB                          WCRMNB
     I              DARKDT                          WCRKDT
     I              DAC7TM                          WCC7TM
     I              DARINS                          WCRINS
     I              DAMXT1                          WCMXT1
     I              DAG3ST                          WCG3ST
     I              DAQWNY                          WCQWNY
     I              DAL0AA                          WCL0AA
     I              DAMAT1                          WCMAT1
     I              DATDNA                          WCTDNA
     I              DACWC3                          WCCWC3
     I              DAQXNY                          WCQXNY
     I              DAQZNY                          WCQZNY
     I              DAQ0NY                          WCQ0NY
     I              DALVTX                          WCLVTX
     I              DANYT1                          WCNYT1
     I              DAG5ST                          WCG5ST
     I              DAG7ST                          WCG7ST
     I              DATFDT                          WCTFDT
     I              DATGDT                          WCTGDT
     I              DAWIT1                          WCWIT1
     I              DAQYNY                          WCQYNY
     I              DAL7T1                          WCL7T1
     I              DAR8NY                          WCR8NY
     I              DAR0NY                          WCR0NY
     I              DAI7AA                          WCI7AA
     I              DAMXAA                          WCMXAA
     I              DAMSAA                          WCMSAA
     I              DAR7NY                          WCR7NY
     I              DAHEPR                          WCHEPR
     I              DAHFPR                          WCHFPR
     I              DAWVT1                          WCWVT1
     I              DAW0T1                          WCW0T1
     I              DAR5NY                          WCR5NY
     I              DAW1T1                          WCW1T1
     I              DAR6NY                          WCR6NY
     I              DAJ1ST                          WCJ1ST
     I              DAKHST                          WCKHST
     I              DATWDT                          WCTWDT
     I              DADUTM                          WCDUTM
     I              DAKGST                          WCKGST
     I              DATVDT                          WCTVDT
     I              DADTTM                          WCDTTM
     I              DAR9NY                          WCR9NY
     I              DASQNY                          WCSQNY
     I              DABHR3                          WCBHR3
     I              DASRNY                          WCSRNY
     I              DAW7T1                          WCW7T1
     I              DAW8T1                          WCW8T1
     I              DAT2DT                          WCT2DT
     I              DASXNY                          WCSXNY
     I              DASYNY                          WCSYNY
     I              DASZNY                          WCSZNY
     I              DAVSST                          WCVSST
     I              DAMJDT                          WCMJDT
     I              DABETM                          WCBETM
     I              DACCVN                          WCCCVN
     I              DACDVN                          WCCDVN
     I              DAMKDT                          WCMKDT
     I              DABFTM                          WCBFTM
     I              DACEVN                          WCCEVN
     I              DACFVN                          WCCFVN
      *
     I@BFCPD9
      * Order Header TRG          Load #/All orders
      * Renamed input format fields
     I              BEAIC3                          WDAIC3
     I              BEC4NB                          WDC4NB
     I              BEJNCD                          WDJNCD
     I              BEANC7                          WDANC7
     I              BEBKC7                          WDBKC7
     I              BEBRTX                          WDBRTX
     I              BEHMNA                          WDHMNA
     I              BEHONA                          WDHONA
     I              BEHPNA                          WDHPNA
     I              BEHNNA                          WDHNNA
     I              BEDBCD                          WDDBCD
     I              BECKTX                          WDCKTX
     I              BEB0C7                          WDB0C7
     I              BEAETX                          WDAETX
     I              BEB1NA                          WDB1NA
     I              BEB3NA                          WDB3NA
     I              BEB4NA                          WDB4NA
     I              BEB2NA                          WDB2NA
     I              BEBHCD                          WDBHCD
     I              BEC8TX                          WDC8TX
     I              BEBCNA                          WDBCNA
     I              BEA0DT                          WDA0DT
     I              BEA5DT                          WDA5DT
     I              BEGNDT                          WDGNDT
     I              BEACDT                          WDACDT
     I              BEAQCD                          WDAQCD
     I              BEB6NA                          WDB6NA
     I              BEBYNA                          WDBYNA
     I              BEBZNA                          WDBZNA
     I              BEGTST                          WDGTST
     I              BEGVST                          WDGVST
     I              BEGUST                          WDGUST
     I              BEQFST                          WDQFST
     I              BECQCD                          WDCQCD
     I              BEGJST                          WDGJST
     I              BEGWST                          WDGWST
     I              BEGXST                          WDGXST
     I              BEGYST                          WDGYST
     I              BEAODT                          WDAODT
     I              BEAIVN                          WDAIVN
     I              BECXDT                          WDCXDT
     I              BEJZVA                          WDJZVA
     I              BEA1WG                          WDA1WG
     I              BEXIST                          WDXIST
     I              BEXJST                          WDXJST
     I              BEXKST                          WDXKST
     I              BEEIDT                          WDEIDT
     I              BEAFTM                          WDAFTM
     I              BEE8CD                          WDE8CD
     I              BEE9CD                          WDE9CD
     I              BERMNB                          WDRMNB
     I              BETBNB                          WDTBNB
     I              BER1NB                          WDR1NB
     I              BEPJST                          WDPJST
     I              BEU0ST                          WDU0ST
     I              BEU1ST                          WDU1ST
     I              BEQ2CD                          WDQ2CD
     I              BEU2ST                          WDU2ST
     I              BEVEST                          WDVEST
     I              BEVFST                          WDVFST
     I              BEVGST                          WDVGST
     I              BERPCD                          WDRPCD
     I              BERNNB                          WDRNNB
     I              BEVDST                          WDVDST
     I              BEATIN                          WDATIN
     I              BEU4ST                          WDU4ST
     I              BEU5ST                          WDU5ST
     I              BERSRN                          WDRSRN
     I              BEMHNA                          WDMHNA
     I              BEMINA                          WDMINA
     I              BEWBST                          WDWBST
     I              BER4CD                          WDR4CD
     I              BEBFCD                          WDBFCD
     I              BEQ4CD                          WDQ4CD
     I              BET3NB                          WDT3NB
     I              BESICD                          WDSICD
     I              BECONB                          WDCONB
     I              BECEST                          WDCEST
     I              BEAWDT                          WDAWDT
     I              BEJPCD                          WDJPCD
     I              BEXUST                          WDXUST
     I              BEZ1ST                          WDZ1ST
     I              BEVRVA                          WDVRVA
     I              BEOBST                          WDOBST
     I              BEBCST                          WDBCST
     I              BEBDST                          WDBDST
     I              BEB7VL                          WDB7VL
     I              BEGASX                          WDGASX
     I              BEGBSX                          WDGBSX
     I              BEGCSX                          WDGCSX
     I              BEGDSX                          WDGDSX
     I              BEFNSX                          WDFNSX
     I              BEFOSX                          WDFOSX
     I              BEFPSX                          WDFPSX
     I              BEFQSX                          WDFQSX
     I              BEFRSX                          WDFRSX
     I              BEFSSX                          WDFSSX
     I              BEFTSX                          WDFTSX
     I              BEFUSX                          WDFUSX
     I              BEFVSX                          WDFVSX
     I              BEFWSX                          WDFWSX
     I              BEFXSX                          WDFXSX
     I              BEFYSX                          WDFYSX
     I              BENODT                          WDNODT
     I              BENPDT                          WDNPDT
     I              BENQDT                          WDNQDT
     I              BENRDT                          WDNRDT
     I              BENSDT                          WDNSDT
     I              BEBPTM                          WDBPTM
     I              BEBQTM                          WDBQTM
     I              BEBRTM                          WDBRTM
     I              BEBSTM                          WDBSTM
     I              BEBTTM                          WDBTTM
     I              BEH0NX                          WDH0NX
     I              BEH1NX                          WDH1NX
     I              BEH2NX                          WDH2NX
     I              BEH3NX                          WDH3NX
     I              BEH4NX                          WDH4NX
     I              BEC0C7                          WDC0C7
     I              BEUVST                          WDUVST
     I              BEUWST                          WDUWST
     I              BEUXST                          WDUXST
     I              BEAATM                          WDAATM
     I              BEAYNA                          WDAYNA
     I              BEA0NA                          WDA0NA
     I              BEAXDT                          WDAXDT
      *
     I@DACPRB
      * COA Batch Header RIN      Co/EMTS PTD/EMTS Batch
      * Renamed input format fields
     I              DAAIC3                          WEAIC3
     I              DAL6T1                          WEL6T1
     I              DAI3NY                          WEI3NY
     I              DAJYNY                          WEJYNY
     I              DAQ1NY                          WEQ1NY
     I              DAMUT1                          WEMUT1
     I              DAJZNY                          WEJZNY
     I              DAJ0NY                          WEJ0NY
     I              DAJ2NY                          WEJ2NY
     I              DARIDT                          WERIDT
     I              DAC5TM                          WEC5TM
     I              DAMVT1                          WEMVT1
     I              DAMWT1                          WEMWT1
     I              DARINT                          WERINT
     I              DARJDT                          WERJDT
     I              DAC6TM                          WEC6TM
     I              DAC4NB                          WEC4NB
     I              DADPNB                          WEDPNB
     I              DAUENB                          WEUENB
     I              DARZNB                          WERZNB
     I              DANGT1                          WENGT1
     I              DARMNB                          WERMNB
     I              DARKDT                          WERKDT
     I              DAC7TM                          WEC7TM
     I              DARINS                          WERINS
     I              DAMXT1                          WEMXT1
     I              DAG3ST                          WEG3ST
     I              DAQWNY                          WEQWNY
     I              DAL0AA                          WEL0AA
     I              DAMAT1                          WEMAT1
     I              DATDNA                          WETDNA
     I              DACWC3                          WECWC3
     I              DAQXNY                          WEQXNY
     I              DAQZNY                          WEQZNY
     I              DAQ0NY                          WEQ0NY
     I              DALVTX                          WELVTX
     I              DANYT1                          WENYT1
     I              DAG5ST                          WEG5ST
     I              DAG7ST                          WEG7ST
     I              DATFDT                          WETFDT
     I              DATGDT                          WETGDT
     I              DAWIT1                          WEWIT1
     I              DAQYNY                          WEQYNY
     I              DAL7T1                          WEL7T1
     I              DAR8NY                          WER8NY
     I              DAR0NY                          WER0NY
     I              DAI7AA                          WEI7AA
     I              DAMXAA                          WEMXAA
     I              DAMSAA                          WEMSAA
     I              DAR7NY                          WER7NY
     I              DAHEPR                          WEHEPR
     I              DAHFPR                          WEHFPR
     I              DAWVT1                          WEWVT1
     I              DAW0T1                          WEW0T1
     I              DAR5NY                          WER5NY
     I              DAW1T1                          WEW1T1
     I              DAR6NY                          WER6NY
     I              DAJ1ST                          WEJ1ST
     I              DAKHST                          WEKHST
     I              DATWDT                          WETWDT
     I              DADUTM                          WEDUTM
     I              DAKGST                          WEKGST
     I              DATVDT                          WETVDT
     I              DADTTM                          WEDTTM
     I              DAR9NY                          WER9NY
     I              DASQNY                          WESQNY
     I              DABHR3                          WEBHR3
     I              DASRNY                          WESRNY
     I              DAW7T1                          WEW7T1
     I              DAW8T1                          WEW8T1
     I              DAT2DT                          WET2DT
     I              DASXNY                          WESXNY
     I              DASYNY                          WESYNY
     I              DASZNY                          WESZNY
     I              DAVSST                          WEVSST
     I              DAMJDT                          WEMJDT
     I              DABETM                          WEBETM
     I              DACCVN                          WECCVN
     I              DACDVN                          WECDVN
     I              DAMKDT                          WEMKDT
     I              DABFTM                          WEBFTM
     I              DACEVN                          WECEVN
     I              DACFVN                          WECFVN
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS                              7
      * KEY: Load Detail               Retrieval index
      * I : RST Load ID
     I                                    P   1   40P1RMNB
     IP2PARM      DS
      * I :  Company Number
     I                                    P   1   20P2AIC3
     IP3PARM      DS
      * I :  Export Status
     I                                        1   1 P3U2ST
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           KEY: Load Detai
     C           P2AIC3    PARM           WP0001  30       Company Number
     C           P3U2ST    PARM           WP0002  1        Export Status
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PRT Bill of Lading-HPB PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$GENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * PRT Bill of Lading-HPB PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQKA01           Load ID
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQKA01           Load ID
      * Establish starting position
     C           KRSA      SETLL@FLCPBW                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Load ID
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     MOVEL*BLANK    $BYMTX           Text USR 8
     C                     Z-ADD*ZERO     $BBQDT           USR Date - ATR
     C                     MOVEL*BLANK    $BD6T1           Text USR 9
     C                     Z-ADD*ZERO     $BAWDT           Invoice Date
     C                     MOVEL*BLANK    $BLMT1           Delivery P.O. N
     C                     Z-ADD*ZERO     $BBKC7           Ship To Custome
     C                     Z-ADDWAC4NB    $BC4NB           Order Number
     C                     MOVEL*BLANK    $BBCNA           Customer Purcha
     C                     MOVEL*BLANK    $BAUNA           Description
     C                     Z-ADDWARMNB    $BRMNB           Load ID
     C                     MOVEL*BLANK    $BKGTX           @Blank for 5
     C                     MOVEL*BLANK    $BADTX           Name
     C                     MOVEL*BLANK    $BZ7TX           Text USR 4
     C                     MOVEL*BLANK    $BNIT1           COA Station Nam
     C                     MOVEL*BLANK    $BO7TX           @Text 8
     C                     MOVEL*BLANK    $BGNNA           USR Compressed
     C                     MOVEL*BLANK    $BDGT1           Address 1
     C                     MOVEL*BLANK    $BGONA           USR Compressed
     C                     MOVEL*BLANK    $BDHT1           Address 2
     C                     MOVEL*BLANK    $BDIT1           Address 3
     C                     MOVEL*BLANK    $BHLTX           Condition Desc.
     C                     MOVEL*BLANK    $BL2T1           COA Producer Re
     C                     MOVEL*BLANK    $BNLTX           USR 15 Text
     C                     MOVEL*BLANK    $BL3T1           COA Employer ID
     C                     MOVEL*BLANK    $BD3T1           Text 35 USR
     C                     MOVEL*BLANK    $BEET1           Description 21A
     C                     MOVEL*BLANK    $BL6T1           COA ULSD Compan
     C                     MOVEL*BLANK    $BKNTX           @Blank for 6
     C                     MOVEL*BLANK    $BGPNA           USR Compressed
     C                     MOVEL*BLANK    $BHMTX           Condition Desc.
     C                     MOVEL*BLANK    $BL7T1           COA ULSD Facili
     C                     MOVEL*BLANK    $BMLT1           Text 3 Length U
     C                     MOVEL*BLANK    $BNAT1           HPB ULSD Facili
     C                     MOVEL*BLANK    $BYPTX           Generic Heading
     C                     MOVEL*BLANK    $BAETX           Bill to Name
     C                     MOVEL*BLANK    $BYYTX           Generic Heading
     C                     MOVEL*BLANK    $BBRTX           Ship To Name
     C                     MOVEL*BLANK    $BM5TX           Generic Heading
     C                     MOVEL*BLANK    $BB1NA           Bill to Address
     C                     MOVEL*BLANK    $BM6TX           Generic Heading
     C                     MOVEL*BLANK    $BHMNA           Ship To Address
     C                     MOVEL*BLANK    $BB3NA           Bill to Address
     C                     MOVEL*BLANK    $BHONA           Ship To Address
     C                     MOVEL*BLANK    $BB4NA           Bill to Address
     C                     MOVEL*BLANK    $BHPNA           Ship To Address
     C                     MOVEL*BLANK    $BMZT1           Employer ID bil
     C                     MOVEL*BLANK    $BM3T1           Employer ID bil
     C                     MOVEL*BLANK    $BM0T1           Employer ID shi
     C                     MOVEL*BLANK    $BM4T1           Employer ID shi
     C                     MOVEL*BLANK    $BM1T1           ULSD Comp bill
     C                     MOVEL*BLANK    $BM5T1           ULSD Comp bill
     C                     MOVEL*BLANK    $BM7T1           ULSD Facility b
     C                     MOVEL*BLANK    $BM2T1           ULSD Comp ship
     C                     MOVEL*BLANK    $BM6T1           ULSD Comp ship
     C                     MOVEL*BLANK    $BM8T1           ULSD Facility s
     C                     MOVEL*BLANK    $BDMT1           Fax Area Code #
     C                     MOVEL*BLANK    $BBVTX           Telephone Numbe
     C                     MOVEL*BLANK    $BDQT1           Fax Area Code #
     C                     MOVEL*BLANK    $BEWT1           CDD Sender Phon
      * USER: Process before print of detail format
      * Load header line and get data for other fields
      * CASE: *OTHERWISE
      * RTV Trailer Nbr,Pr Tmp RT - Load Header  * 
     C                     EXSR SFRVGN
     C                     Z-ADDYL0012    YL0013           COA Temperature
      * RTV All Fields         RT - Order Header TRG  * 
     C                     EXSR SGRVGN
      * E2013 RMC 3/22/12 Trans date is Act ship date now - print if invc
      * CASE: CUR.Invoice Date is entered
     C           $BAWDT    IFNE *ZERO                      *IF
     C                     Z-ADD$BBQDT    $BAWDT           Invoice Date
     C                     END                             *FI
     C                     MOVEL@CN,001   $BYMTX           Text USR 8
     C                     MOVEL@CN,002   $BD6T1           Text USR 9
      * RTV Ship To Whse-HPB  RT - Order Header TRG  * 
     C                     EXSR SHRVGN
      * RTV Desc, status       RT - Terms  * 
     C                     EXSR SIRVGN
      * RTV HPB fields/dlv po RT - Order Header Extension  * 
     C                     EXSR SJRVGN
      * RTV 1st Item Code     RT - Order Detail  * 
     C                     EXSR SKRVGN
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
     C                     EXSR SLRVGN
     C                     Z-ADDYL0034    WUH4NY           Item Code 5.0
     C                     MOVEL*BLANK    WUY7TX           Text USR 5
     C                     MOVELWUH4NY    WUY7TX           Text USR 5
     C                     MOVEL*BLANK    YL0037           COA OMS Item Co
     C                     MOVELWUY7TX    YL0037           COA OMS Item Co
      * Rtv HPB fields,type   RT - Warehouse  * 
     C                     EXSR SNRVGN
      * CASE: LCL.Production Warehouse Code is Not Blanks
     C           YL0038    IFNE *BLANK                     *IF
      * Rtv Acct Co          RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0038    WL0001    P      Warehouse Code
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    YL0042           Accounting Comp
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Acct Co          RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0035    WL0001    P      Warehouse Code
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    YL0042           Accounting Comp
     C                     END                             *FI
      * CASE: LCL.HPB Ship to Warehouse is not entered
     C           YL0031    IFEQ *BLANK                     *IF
      * RTV all used fields 2  RT - COA Property Define Hdr  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0003           Company Number
     C                     MOVELYL0037    WL0033    P      COA OMS Item Co
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    YL0043    P      COA Bio-diesel
     C                     MOVELWL0005    YL0044    P      COA Bio-dsl Fue
     C                     MOVELWL0006    $BL2T1    P      COA Producer Re
     C                     MOVELWL0007    $BL3T1    P      COA Employer ID
     C                     MOVELWL0008    YN0107    P      COA Sold From A
     C                     MOVELWL0009    YL0045    P      COA Sold From N
     C                     MOVELWL0010    $BL6T1    P      COA ULSD Compan
     C                     MOVELWL0011    $BL7T1    P      COA ULSD Facili
     C                     MOVELWL0012    YL0046    P      COA RIN Equival
     C                     MOVELWL0013    YL0047    P      COA RIN Renewab
     C                     MOVELWL0014    YL0048    P      COA RIN Type Fl
     C                     Z-ADDWL0015    YN0108           COA Density Loa
     C                     Z-ADDWL0016    YN0109           COA Density Ref
     C                     Z-ADDWL0017    YN0110           COA Temperature
     C                     Z-ADDWL0018    YL0049           COA Temperature
     C                     Z-ADDWL0019    YL0050           COA BOL Percent
     C                     MOVELWL0020    YN0111    P      COA Sale Locati
     C                     MOVELWL0021    YN0112    P      COA Active Whse
     C                     MOVELWL0022    YN0113    P      COA Active Whse
     C                     MOVELWL0023    YN0114    P      COA Active Whse
     C                     MOVELWL0024    YN0115    P      COA Active Whse
     C                     MOVELWL0025    YN0116    P      COA Active Whse
     C                     MOVELWL0026    YN0117    P      COA Active Whse
     C                     Z-ADDWL0027    YL0051           COA Temp Conv F
     C                     MOVELWL0028    YL0052    P      Operation Facto
     C                     Z-ADDWL0029    YL0053           COA Temp Conv F
     C                     MOVELWL0030    YL0054    P      Operation Facto
     C                     MOVELWL0031    YN0118    P      COA RFS Renew F
     C                     MOVELWL0032    YN0119    P      COA RFS Rnwbl F
     C                     MOVELWL0034    YL0055    P      COA Fuel Desc2/
     C                     MOVELWL0035    YN0106    P      Record Status
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV all used fields 2  RT - COA Property Define Hdr  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0042    WL0003           Company Number
     C                     MOVELYL0037    WL0033    P      COA OMS Item Co
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    YL0043    P      COA Bio-diesel
     C                     MOVELWL0005    YL0044    P      COA Bio-dsl Fue
     C                     MOVELWL0006    $BL2T1    P      COA Producer Re
     C                     MOVELWL0007    $BL3T1    P      COA Employer ID
     C                     MOVELWL0008    YN0107    P      COA Sold From A
     C                     MOVELWL0009    YL0045    P      COA Sold From N
     C                     MOVELWL0010    $BL6T1    P      COA ULSD Compan
     C                     MOVELWL0011    $BL7T1    P      COA ULSD Facili
     C                     MOVELWL0012    YL0046    P      COA RIN Equival
     C                     MOVELWL0013    YL0047    P      COA RIN Renewab
     C                     MOVELWL0014    YL0048    P      COA RIN Type Fl
     C                     Z-ADDWL0015    YN0108           COA Density Loa
     C                     Z-ADDWL0016    YN0109           COA Density Ref
     C                     Z-ADDWL0017    YN0110           COA Temperature
     C                     Z-ADDWL0018    YL0049           COA Temperature
     C                     Z-ADDWL0019    YL0050           COA BOL Percent
     C                     MOVELWL0020    YN0111    P      COA Sale Locati
     C                     MOVELWL0021    YN0112    P      COA Active Whse
     C                     MOVELWL0022    YN0113    P      COA Active Whse
     C                     MOVELWL0023    YN0114    P      COA Active Whse
     C                     MOVELWL0024    YN0115    P      COA Active Whse
     C                     MOVELWL0025    YN0116    P      COA Active Whse
     C                     MOVELWL0026    YN0117    P      COA Active Whse
     C                     Z-ADDWL0027    YL0051           COA Temp Conv F
     C                     MOVELWL0028    YL0052    P      Operation Facto
     C                     Z-ADDWL0029    YL0053           COA Temp Conv F
     C                     MOVELWL0030    YL0054    P      Operation Facto
     C                     MOVELWL0031    YN0118    P      COA RFS Renew F
     C                     MOVELWL0032    YN0119    P      COA RFS Rnwbl F
     C                     MOVELWL0034    YL0055    P      COA Fuel Desc2/
     C                     MOVELWL0035    YN0106    P      Record Status
     C                     END                             *FI
      * CASE: LCL.Warehouse Type is Blended
     C           YL0039    IFEQ 'BL'                       *IF
      * RTV ULSD Facility     RT - COA Property Define Hdr  * 
     C                     EXSR SQRVGN
     C                     MOVEL'And'     $BMLT1           Text 3 Length U
     C                     END                             *FI
      * Load producer address and other details
      * CASE: *OTHERWISE
     C                     MOVELYL0045    $BADTX           Name
     C                     MOVEL@CN,003   $BKNTX           @Blank for 6
     C                     MOVEL@CN,004   $BNLTX           USR 15 Text
     C                     MOVEL@CN,005   $BEET1           Description 21A
      * RTV Co Addr & Phone FaxRT - Company Name and Address  * 
     C                     EXSR SRRVGN
     C                     Z-ADD1         ZQ      50
     C           YL0058    CAT  YL0062:ZQ YL0063    P      USR Compressed
     C                     Z-ADD1         ZQ      50
     C           YL0063    CAT  YL0059:ZQ $BGONA    P      USR Compressed
     C                     MOVEL*BLANK    $BGPNA           USR Compressed
     C                     MOVELYL0060    $BGPNA           USR Compressed
     C                     MOVEL@CN,006   $BHMTX           Condition Desc.
      * Load Bill-to and Ship-to addresses
      * CASE: *OTHERWISE
      * If not Transload BOL -- fill in Bill To data
      * CASE: PAR.Export Status is Not Yes
     C           P3U2ST    IFEQ *BLANK                     *IF
     C           P3U2ST    OREQ 'N'
     C                     MOVELYL0022    $BAETX           Bill to Name
     C                     MOVELYL0023    $BB1NA           Bill to Address
      * Squash out blank line if address line 2 is blank
      * CASE: LCL.Bill to Address Line 2 is Blank
     C           YL0024    IFEQ *BLANK                     *IF
     C                     Z-ADD1         ZQ      50
     C           YL0026    CAT  YL0027:ZQ YL0024    P      Bill to Address
     C                     Z-ADD1         ZQ      50
     C           YL0024    CAT  YL0028:ZQ $BB3NA    P      Bill to Address
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELYL0024    $BB3NA           Bill to Address
     C                     Z-ADD1         ZQ      50
     C           YL0026    CAT  YL0027:ZQ YL0025    P      Bill to Address
     C                     Z-ADD1         ZQ      50
     C           YL0025    CAT  YL0028:ZQ $BB4NA    P      Bill to Address
     C                     END                             *FI
      * RTV Customer A/R Cust  RT - Customer  * 
     C                     EXSR SSRVGN
      * Rtv HPB Cust Fields   RT - Company Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0036           Company Number
     C                     Z-ADDYL0064    WL0037           Ship To Custome
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0038    YL0065    P      HPB Employer ID
     C                     MOVELWL0039    YL0066    P      HPB ULSD Compan
     C                     MOVELWL0040    YL0067    P      HPB ULSD Facili
     C                     MOVELYL0065    $BM3T1           Employer ID bil
     C                     MOVELYL0066    $BM5T1           ULSD Comp bill
     C                     MOVELYL0067    $BM7T1           ULSD Facility b
     C                     MOVEL@CN,004   $BMZT1           Employer ID bil
     C                     MOVEL@CN,005   $BM1T1           ULSD Comp bill
      * If Transload Sts entered, then Print "Via"  transload station nam
      * CASE: DB1.HPB Transload Station NE WRK.Blank for 4           USR
     C           WAICSX    IFNE WUOTTX                     *IF
     C                     MOVEL'Via:'    $BZ7TX           Text USR 4
      * Rtv Transload Stn All RT - COA Transloading Station  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAICSX    WL0041    P      COA Station Cod
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0042    $BNIT1    P      COA Station Nam
     C                     MOVELWL0043    $BDGT1    P      Address Line 1
     C                     MOVELWL0044    YL0068    P      Address Line 2
     C                     MOVELWL0045    YL0069    P      Address Line 3
     C                     MOVELWL0046    YL0058    P      City
     C                     MOVELWL0047    YL0062    P      State Code
     C                     MOVELWL0048    YL0059    P      Zip Postal Code
     C                     MOVELWL0049    YN0121    P      COA ULSD Compan
     C                     MOVELWL0050    YN0122    P      COA ULSD Facili
     C                     MOVELWL0051    YN0123    P      COA Employer ID
      * Squash out blank line if address line 2 is blank
      * CASE: LCL.Address 2 is blank
     C           YL0068    IFEQ *BLANK                     *IF
     C                     Z-ADD1         ZQ      50
     C           YL0058    CAT  YL0062:ZQ YL0068    P      Address 2
     C                     Z-ADD1         ZQ      50
     C           YL0068    CAT  YL0059:ZQ $BDHT1    P      Address 2
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELYL0068    $BDHT1           Address 2
     C                     Z-ADD1         ZQ      50
     C           YL0058    CAT  YL0062:ZQ YL0069    P      Address 3
     C                     Z-ADD1         ZQ      50
     C           YL0069    CAT  YL0059:ZQ $BDIT1    P      Address 3
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * C2265 9/24/12 RMC print whse addr if transload=' '
     C                     MOVEL'Via:'    $BZ7TX           Text USR 4
      * RTV Warehouse Address  RT - Warehouse  * 
     C                     EXSR SVRVGN
     C                     Z-ADD1         ZQ      50
     C           YL0058    CAT  YL0062:ZQ YL0070    P      Address 1
     C                     Z-ADD1         ZQ      50
     C           YL0070    CAT  YL0059:ZQ $BDGT1    P      Address 1
     C                     END                             *FI
      * RTV Type Code          RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0052           Company Number
     C                     Z-ADDYL0064    WL0053           Ship To Custome
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0054    YL0071    P      Type Code
     C                     MOVELWL0055    YN0127    P      Customer Group
     C                     MOVELWL0056    YN0128    P      Customer Group
      * E1762 use type code override from OHE  9/30/11
      * CASE: LCL.OHE Override Type Code is No
     C           YL0032    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELYL0032    YL0071           Type Code
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Type Code          RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0052           Company Number
     C                     Z-ADD$BBKC7    WL0053           Ship To Custome
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0054    YL0071    P      Type Code
     C                     MOVELWL0055    YN0127    P      Customer Group
     C                     MOVELWL0056    YN0128    P      Customer Group
     C                     END                             *FI
     C                     MOVEL@CN,004   $BM0T1           Employer ID shi
     C                     MOVEL@CN,005   $BM2T1           ULSD Comp ship
      * If Not transload Bol, print cust ship to, else print Transload St
      * CASE: PAR.Export Status is Not Yes
     C           P3U2ST    IFEQ *BLANK                     *IF
     C           P3U2ST    OREQ 'N'
     C                     MOVELYL0014    $BBRTX           Ship To Name
     C                     MOVELYL0015    $BHMNA           Ship To Address
      * Squash out blank line if address line 2 is blank
      * CASE: LCL.Ship To Address Line 2 is Blank
     C           YL0016    IFEQ *BLANK                     *IF
     C                     Z-ADD1         ZQ      50
     C           YL0018    CAT  YL0019:ZQ YL0016    P      Ship To Address
     C                     Z-ADD1         ZQ      50
     C           YL0016    CAT  YL0020:ZQ $BHONA    P      Ship To Address
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELYL0016    $BHONA           Ship To Address
     C                     Z-ADD1         ZQ      50
     C           YL0018    CAT  YL0019:ZQ YL0017    P      Ship To Address
     C                     Z-ADD1         ZQ      50
     C           YL0017    CAT  YL0020:ZQ $BHPNA    P      Ship To Address
     C                     END                             *FI
      * Rtv HPB Cust Fields   RT - Comp Cust Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0036           Company Number
     C                     Z-ADD$BBKC7    WL0037           Ship To Custome
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0038    YL0065    P      HPB Employer ID
     C                     MOVELWL0039    YL0066    P      HPB ULSD Compan
     C                     MOVELWL0040    YL0067    P      HPB ULSD Facili
     C                     MOVELYL0065    $BM4T1           Employer ID shi
     C                     MOVELYL0066    $BM6T1           ULSD Comp ship
     C                     MOVELYL0067    $BM8T1           ULSD Facility s
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Transload Stn All RT - COA Transloading Station  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAICSX    WL0041    P      COA Station Cod
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0042    $BBRTX    P      COA Station Nam
     C                     MOVELWL0043    $BHMNA    P      Address Line 1
     C                     MOVELWL0044    YL0016    P      Address Line 2
     C                     MOVELWL0045    YL0017    P      Address Line 3
     C                     MOVELWL0046    YL0018    P      City
     C                     MOVELWL0047    YL0019    P      State Code
     C                     MOVELWL0048    YL0020    P      Zip Postal Code
     C                     MOVELWL0049    $BM6T1    P      COA ULSD Compan
     C                     MOVELWL0050    $BM8T1    P      COA ULSD Facili
     C                     MOVELWL0051    $BM4T1    P      COA Employer ID
      * Squash out blank line if address line 2 is blank
      * CASE: LCL.Ship To Address Line 2 is Blank
     C           YL0016    IFEQ *BLANK                     *IF
     C                     Z-ADD1         ZQ      50
     C           YL0018    CAT  YL0019:ZQ YL0016    P      Ship To Address
     C                     Z-ADD1         ZQ      50
     C           YL0016    CAT  YL0020:ZQ $BHONA    P      Ship To Address
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELYL0016    $BHONA           Ship To Address
     C                     Z-ADD1         ZQ      50
     C           YL0018    CAT  YL0019:ZQ YL0017    P      Ship To Address
     C                     Z-ADD1         ZQ      50
     C           YL0017    CAT  YL0020:ZQ $BHPNA    P      Ship To Address
     C                     END                             *FI
     C                     END                             *FI
      * If BLender, count Manif Dtl -- print nbr RINS on last manif dtl l
      * CASE: LCL.Type Code is Blender for Biodiesel
     C           YL0071    IFEQ 'BL'                       *IF
     C                     Z-ADD*ZERO     YL0072           Count USR
      * RTV Count for BOL     RT - Manifest Detail  * 
     C                     EXSR SXRVGN
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : PRT HPB BOL Info       PO
     C                     EXSR UASUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WARMNB    WZA001           Load ID
     C                     Z-ADDWARMNB    WZA001
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@FLCPBW                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Load ID
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Load ID
     C                     ELSE
      * Next record - Detect level breaks
     C           WARMNB    IFNE WZA001                     Load ID
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * PRT HPB BOL Info       PO: Mainline
      *================================================================
      * PRT HPB BOL Info       PO: Initialise
     C                     EXSR ZBINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN FNAIC3    WQKB01           Company Number
     C           *LIKE     DEFN FNC4NB    WQKB02           Order Number
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           Company Number
     C                     KFLD           WQKB02           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WQKB01           Company Number
     C                     Z-ADD$BC4NB    WQKB02           Order Number
      * Establish starting position
     C           KRSB      SETLL@FNCPCT                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Order Number
     C                     MOVEL'Y'       W0BL02  1        Order Sequence
     C                     MOVEL'Y'       W0BL03  1        Order Secondary
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $FGMPC           COA BOL Percent
     C                     MOVEL*BLANK    $FPFTX           Text 1 Length U
     C                     MOVEL*BLANK    $FY0TX           Generic Heading
     C                     Z-ADD*ZERO     $FJJNY           Page Nbr - of (
     C                     MOVEL*BLANK    $FHKT1           Text 2
     C                     Z-ADD*ZERO     $FJKNY           Page Nbr - Tota
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP03  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDFNAIC3    $CAIC3           Company Number
     C                     Z-ADDFNC4NB    $CC4NB           Order Number
     C                     Z-ADDFNDPNB    $CDPNB           Order Sequence
     C                     Z-ADDFNUENB    $CUENB           Order Secondary
     C                     Z-ADDFNRZNB    $CRZNB           Case Sequence N
     C                     MOVEL*BLANK    $CIDAA           COA Bio-diesel
     C                     MOVEL*BLANK    $CR2NA           COA Bio-dsl Fue
     C                     MOVEL*BLANK    $CMUT1           COA Batch Heade
     C                     Z-ADD*ZERO     $CSQNY           COA EMTS Batch
     C                     Z-ADDFNITNY    $CITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     $CJENY           COA Temperature
     C                     Z-ADDFNIYNY    $CIYNY           HPB Density Ref
     C                     Z-ADDFNIUNY    $CIUNY           HPB Meter Endin
     C                     Z-ADDFNIWNY    $CIWNY           HPB Meter Total
     C                     Z-ADD*ZERO     $CJHNY           COA Gallons Use
     C                     Z-ADDFNN6WG    $CN6WG           HPB Meter Net G
     C                     Z-ADDFNIXNY    $CIXNY           HPB Meter Net W
     C                     MOVEL*BLANK    $CMCT1           COA Fuel Desc2/
     C                     Z-ADD*ZERO     $CR8NY           COA Batch RIN V
     C                     Z-ADD*ZERO     $CR0NY           COA RIN Quantit
     C                     MOVEL*BLANK    $CMSAA           RFS Fuel Code
     C                     MOVEL*BLANK    $CD6T1           Text USR 9
     C                     Z-ADD*ZERO     $CR7NY           COA BHR RIN Gen
     C                     MOVEL*BLANK    $CY8TX           Text USR 7
     C                     MOVEL*BLANK    $CMXAA           RFS Trans Reaso
     C                     MOVEL*BLANK    $CWTT1           RFS Trans Reaso
     C                     MOVEL*BLANK    $COPT1           Text 93 USR
      * USER: Process before print of detail format
      * CASE: LCL.USR Count is 4
     C           YL0081    IFEQ 4                          *IF
      * User Source to print Order total and New detail page
      * PRT HPB BOL NP & Hds   US - Load Detail  * 
     C                     MOVE 'Y'       W0BL01
     C                     EXSR B4PTOT
     C                     MOVE 'Y'       W0NEWP
     C                     MOVE 'Y'       W0APDT
     C                     Z-ADD*ZERO     YL0081           USR Count
     C                     ADD  1         YL0082           Page Nbr - of (
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : Prt BOL RINS-Prt w/ap PO
     C                     EXSR UBSUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN FNAIC3    WZB001           Company Number
     C                     Z-ADDFNAIC3    WZB001
     C           *LIKE     DEFN FNC4NB    WZB002           Order Number
     C                     Z-ADDFNC4NB    WZB002
     C           *LIKE     DEFN FNDPNB    WZB003           Order Sequence
     C                     Z-ADDFNDPNB    WZB003
     C           *LIKE     DEFN FNUENB    WZB004           Order Secondary
     C                     Z-ADDFNUENB    WZB004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@FNCPCT                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        Company Number
     C                     MOVEL*BLANK    W0BL01  1        Order Number
     C                     MOVEL*BLANK    W0BL02  1        Order Sequence
     C                     MOVEL*BLANK    W0BL03  1        Order Secondary
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Order Number
     C                     MOVEL'Y'       W0BL02  1        Order Sequence
     C                     MOVEL'Y'       W0BL03  1        Order Secondary
     C                     ELSE
      * Next record - Detect level breaks
     C           FNAIC3    IFNE WZB001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           FNC4NB    IFNE WZB002                     Order Number
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           FNDPNB    IFNE WZB003                     Order Sequence
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C           FNUENB    IFNE WZB004                     Order Secondary
     C           W0BL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL03
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP03
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * USER: Process before print of Order Number format
      * TPA Before print
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Order Number format
      * Dont print percent per mel/tom 4/12 E01485
     C                     Z-ADD*ZERO     $FGMPC           COA BOL Percent
     C                     ADD  1         YL0099           USR Counter
     C                     MOVEL'Page:'   $FY0TX           Generic Heading
     C           1         ADD  YL0076    $FJJNY           Page Nbr - of (
      * CASE: CUR.Page Nbr - of (2.0)   USR is GT 1
     C           $FJJNY    IFGT 1                          *IF
      * RMC 10/10/19 add another page to count the TERMS page (back ovl)
     C                     ADD  1         $FJJNY           Page Nbr - of (
     C                     END                             *FI
     C                     Z-ADD$FJJNY    YL0076           Page Nbr - of (
     C                     MOVEL'of'      $FHKT1           Text 2
     C                     Z-ADDYL0002    $FJKNY           Page Nbr - Tota
     C           W0PFM     IFEQ 'Y'
      * If we are already passed the nominated
      * Start line for this format
     C           @$CLN     IFGE 65
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$FKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         C0MAIN    BEGSR
      *================================================================
      * Prt BOL RINS-Prt w/ap PO: Mainline
      *================================================================
      * Prt BOL RINS-Prt w/ap PO: Initialise
     C                     EXSR ZCINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN DACWC3    WQKC01           COA Shipping Co
     C           *LIKE     DEFN DAR9NY    WQKC02           COA EMTS PTD Nb
      * Define keylist
     C           KRSC      KLIST
     C                     KFLD           WQKC01           COA Shipping Co
     C                     KFLD           WQKC02           COA EMTS PTD Nb
      * Setup key
     C                     Z-ADD$CAIC3    WQKC01           COA Shipping Co
     C                     Z-ADDYL0087    WQKC02           COA EMTS PTD Nb
      * Establish starting position
     C           KRSC      SETLL@DACPY6                    *
      * Read first record with user selection
     C                     EXSR C3READ
     C           W0EOFC    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0CL1P  1        First page
     C                     MOVEL'Y'       W0CL00  1        COA Shipping Co
     C                     MOVEL'Y'       W0CL01  1        COA EMTS PTD Nb
     C                     MOVEL'Y'       W0CL02  1        COA EMTS Batch
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      * Print report body
     C           W0EOFC    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR C1PHDR
      * Print report detail line
     C                     EXSR C2PDTL
      * Read next record with user selection
     C                     EXSR C3READ
      * Print totals
     C                     EXSR C4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         C0EXIT    ENDSR
      /EJECT
     CSR         C1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0CL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP1P  1
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP00  1
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP01  1
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDDAAIC3    $DAIC3           Company Number
     C                     Z-ADDDAR9NY    $DR9NY           COA EMTS PTD Nb
     C                     Z-ADDDASQNY    $DSQNY           COA EMTS Batch
     C                     MOVEL*BLANK    $DUAT1           Blank for 3
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP02  1
     C                     END
      *
      *================================================================
     CSR         C1EXIT    ENDSR
      /EJECT
     CSR         C2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDDAAIC3    $EAIC3           Company Number
     C                     MOVELDAL6T1    $EL6T1           COA ULSD Compan
     C                     Z-ADDDAI3NY    $EI3NY           COA Batch Numbe
     C                     Z-ADDDAJYNY    $EJYNY           COA Batch Heade
     C                     Z-ADDDAQ1NY    $EQ1NY           COA Batch Hdr R
     C                     MOVELDAMUT1    $EMUT1           COA Batch Heade
     C                     Z-ADDDAJZNY    $EJZNY           COA RIN SSSSSSS
     C                     Z-ADDDAJ0NY    $EJ0NY           COA RIN EEEEEEE
     C                     Z-ADDDAJ2NY    $EJ2NY           COA RIN Volume
     C                     Z-ADDDARIDT    $ERIDT           COA RIN Transac
     C                     Z-ADDDAC5TM    $EC5TM           COA RIN Transac
     C                     MOVELDAMVT1    $EMVT1           COA RIN Trans P
     C                     MOVELDAMWT1    $EMWT1           COA RIN Trans P
     C                     MOVELDARINT    $ERINT           COA Retired RIN
     C                     Z-ADDDARJDT    $ERJDT           COA Retired RIN
     C                     Z-ADDDAC6TM    $EC6TM           COA Retired RIN
     C                     Z-ADDDAC4NB    $EC4NB           Order Number
     C                     Z-ADDDADPNB    $EDPNB           Order Sequence
     C                     Z-ADDDAUENB    $EUENB           Order Secondary
     C                     Z-ADDDARZNB    $ERZNB           Case Sequence N
     C                     MOVELDANGT1    $ENGT1           COA Rail Car
     C                     Z-ADDDARMNB    $ERMNB           Load ID
     C                     Z-ADDDARKDT    $ERKDT           COA Date of 1st
     C                     Z-ADDDAC7TM    $EC7TM           COA RIN Unused
     C                     MOVELDARINS    $ERINS           COA RIN Modifie
     C                     MOVELDAMXT1    $EMXT1           COA RIN Unused
     C                     MOVELDAG3ST    $EG3ST           COA RIN SoldFul
     C                     Z-ADDDAQWNY    $EQWNY           COA RIN Gallons
     C                     MOVELDAL0AA    $EL0AA           COA Ship To War
     C                     MOVELDAMAT1    $EMAT1           COA RIN Type Fl
     C                     MOVELDATDNA    $ETDNA           COA RIN Custome
     C                     Z-ADDDACWC3    $ECWC3           COA Shipping Co
     C                     Z-ADDDAQXNY    $EQXNY           COA Ref Load Id
     C                     Z-ADDDAQZNY    $EQZNY           COA Reference B
     C                     Z-ADDDAQ0NY    $EQ0NY           COA Reference B
     C                     MOVELDALVTX    $ELVTX           RFS Compliance
     C                     MOVELDANYT1    $ENYT1           RFS Report Year
     C                     MOVELDAG5ST    $EG5ST           COA RIN Int/Ext
     C                     MOVELDAG7ST    $EG7ST           COA BHR Unused
     C                     Z-ADDDATFDT    $ETFDT           COA BHR Net Gal
     C                     Z-ADDDATGDT    $ETGDT           COA BHR Unused
     C                     MOVELDAWIT1    $EWIT1           COA BHR Unused
     C                     Z-ADDDAQYNY    $EQYNY           COA BHR Loadout
     C                     MOVELDAL7T1    $EL7T1           COA ULSD Facili
     C                     MOVEL*BLANK    $EXLTX           Text USR 6
     C                     Z-ADDDASQNY    $ESQNY           COA EMTS Batch
     C                     MOVEL*BLANK    $EZ3TX           Text 7 Alpha Us
     C                     Z-ADDDAR8NY    $ER8NY           COA Batch RIN V
     C                     MOVEL*BLANK    $EY7TX           Text USR 5
     C                     Z-ADDDAR0NY    $ER0NY           COA RIN Quantit
     C                     MOVEL*BLANK    $EHKT1           Text 2
     C                     MOVELDAMSAA    $EMSAA           RFS Fuel Code
     C                     MOVEL*BLANK    $ES4TX           Text 9
     C                     Z-ADDDAR7NY    $ER7NY           COA BHR RIN Gen
     C                     MOVEL*BLANK    $EY8TX           Text USR 7
     C                     MOVEL*BLANK    $EWTT1           RFS Trans Reaso
     C                     MOVELDAI7AA    $EI7AA           RFS Transaction
     C                     MOVELDAMXAA    $EMXAA           RFS Trans Reaso
     C                     Z-ADDDAHEPR    $EHEPR           COA BHR RIN Pri
     C                     Z-ADDDAHFPR    $EHFPR           COA BHR Gallon
     C                     MOVELDAWVT1    $EWVT1           COA Transaction
     C                     MOVELDAW0T1    $EW0T1           COA RIN Support
     C                     Z-ADDDAR5NY    $ER5NY           COA RIN Support
     C                     MOVELDAW1T1    $EW1T1           COA RIN Support
     C                     Z-ADDDAR6NY    $ER6NY           COA RIN Support
     C                     MOVELDAJ1ST    $EJ1ST           COA BHR RFS Ver
     C                     MOVELDAKHST    $EKHST           COA GEN EMTS St
     C                     Z-ADDDATWDT    $ETWDT           COA GEN EMTS Da
     C                     Z-ADDDADUTM    $EDUTM           COA GEN EMTS Ti
     C                     MOVELDAKGST    $EKGST           COA RIN EMTS St
     C                     Z-ADDDATVDT    $ETVDT           COA RIN EMTS Da
     C                     Z-ADDDADTTM    $EDTTM           COA RIN EMTS Ti
     C                     Z-ADDDAR9NY    $ER9NY           COA EMTS PTD Nb
     C                     MOVELDABHR3    $EBHR3           COA BHR Unused
     C                     Z-ADDDASRNY    $ESRNY           COA BHR Unused
     C                     MOVELDAW7T1    $EW7T1           COA EMTS Trans
     C                     MOVELDAW8T1    $EW8T1           COA EMTS Return
     C                     Z-ADDDAT2DT    $ET2DT           COA BHR Unused
     C                     Z-ADDDASXNY    $ESXNY           COA BHR Equiv V
     C                     Z-ADDDASYNY    $ESYNY           COA BHR RINs to
     C                     Z-ADDDASZNY    $ESZNY           COA Unassgnd Tx
     C                     MOVELDAVSST    $EVSST           Record Status
     C                     Z-ADDDAMJDT    $EMJDT           Create Date
     C                     Z-ADDDABETM    $EBETM           Create Time
     C                     MOVELDACCVN    $ECCVN           Create User
     C                     MOVELDACDVN    $ECDVN           Create Program
     C                     Z-ADDDAMKDT    $EMKDT           Change Date
     C                     Z-ADDDABFTM    $EBFTM           Change Time
     C                     MOVELDACEVN    $ECEVN           Change User
     C                     MOVELDACFVN    $ECFVN           Change Program
      * USER: Process before print of detail format
      * CASE: PAR.USR Count is 4
     C           YL0081    IFEQ 4                          *IF
      * User Source to print Order total and New detail page
      * PRT HPB BOL NP & Hds   US - Load Detail  * 
     C                     MOVE 'Y'       W0BL01
     C                     EXSR B4PTOT
     C                     MOVE 'Y'       W0NEWP
     C                     MOVE 'Y'       W0APDT
     C                     Z-ADD*ZERO     YL0081           USR Count
     C                     ADD  1         YL0082           Page Nbr - of (
     C                     MOVEL'Y'       YL0098           Print Blank Lin
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
     C                     MOVEL'N'       YL0098           Print Blank Lin
      *
      *================================================================
     CSR         C2EXIT    ENDSR
      /EJECT
     CSR         C3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN DACWC3    WZC001           COA Shipping Co
     C                     Z-ADDDACWC3    WZC001
     C           *LIKE     DEFN DAR9NY    WZC002           COA EMTS PTD Nb
     C                     Z-ADDDAR9NY    WZC002
     C           *LIKE     DEFN DASQNY    WZC003           COA EMTS Batch
     C                     Z-ADDDASQNY    WZC003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFC    OREQ '1'
     C           KRSC      READE@DACPY6                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFC  1
      * Quit if no record read
     C           W0EOFC    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * CASE: DB1.RFS Transaction Type is Sold or Delivered
     C           DAI7AA    IFEQ 'SEL'                      *IF
      * dont print rin being printed from manifest dtl prtobj
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.COA EMTS Batch Nbr EQ PAR.COA EMTS Batch Nbr
      *   |- c2    : DB1.Case Sequence Number is GT 0
      *   '-
     C           DASQNY    IFEQ $CSQNY                     *IF
     C           DARZNB    ORGT 0                          *OR
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0CL00  1        COA Shipping Co
     C                     MOVEL*BLANK    W0CL01  1        COA EMTS PTD Nb
     C                     MOVEL*BLANK    W0CL02  1        COA EMTS Batch
     C           W0EOFC    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0CL00  1        COA Shipping Co
     C                     MOVEL'Y'       W0CL01  1        COA EMTS PTD Nb
     C                     MOVEL'Y'       W0CL02  1        COA EMTS Batch
     C                     ELSE
      * Next record - Detect level breaks
     C           DACWC3    IFNE WZC001                     COA Shipping Co
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL00
     C                     END
     C           DAR9NY    IFNE WZC002                     COA EMTS PTD Nb
     C           W0CL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL01
     C                     END
     C           DASQNY    IFNE WZC003                     COA EMTS Batch
     C           W0CL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL02
     C                     END
     C                     END
      *================================================================
     CSR         C3EXIT    ENDSR
      /EJECT
     CSR         C4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0CL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP02
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP01
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP00
     C                     END
      *
     C           W0EOFC    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         C4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of PRT Bill of Lading-HPB PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of PRT Bill of Lading-HPB PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Load ID of PRT Bill of Lading-HPB PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print Detail line. of PRT Bill of Lading-HPB PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
      * Convert fields to external form
      * Convert USR Date - ATR to display format
      * Convert date
     C           1000000   ADD  $BBQDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBBQDT
      * Convert Invoice Date to display format
      * Convert date
     C           1000000   ADD  $BAWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBAWDT
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $BBKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$BBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VBBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBBKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $BC4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$BC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VBC4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBC4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$BCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$BDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of PRT HPB BOL Info       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print Company Number of PRT HPB BOL Info       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print Order Number of PRT HPB BOL Info       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print Order Sequence Number of PRT HPB BOL Info       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print Order Secondary Line Seq of PRT HPB BOL Info       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP03
     C                     END                             FI
      * Print Detail line. of PRT HPB BOL Info       PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     ADD  1         YL0081           USR Count
     C                     ADD  1         YL0077           Count Records
      * If BLender, print 2nd line for last manif dtl only -- it accumula
      * CASE: PAR.Type Code is Blender for Biodiesel
     C           YL0071    IFEQ 'BL'                       *IF
      * CASE: LCL.Count Records         USR EQ PAR.Count USR
     C           YL0077    IFEQ YL0072                     *IF
     C                     MOVEL'Y'       YL0083           Print (Yes/No)
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0083           Print (Yes/No)
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0083           Print (Yes/No)
     C                     END                             *FI
      * Get from manifest dtl in case they have reg biodiesel & dyed on s
     C                     Z-ADDFNHGCD    WUH4NY           Item Code 5.0
     C                     MOVEL*BLANK    WUY7TX           Text USR 5
     C                     MOVELWUH4NY    WUY7TX           Text USR 5
     C                     MOVEL*BLANK    YL0084           COA OMS Item Co
     C                     MOVELWUY7TX    YL0084           COA OMS Item Co
      * RTV Item Desc         RT - COA Property Define Hdr  * 
     C                     EXSR SYRVGN
      * Meter Total Gallon is used for Gross Gallons
      * Net weight and gallons comes straight off the Manifest record
     C                     Z-ADDFNIWNY    $CIWNY           HPB Meter Total
     C                     Z-ADDFNN6WG    $CJHNY           COA Gallons Use
      * RTV Warehouse Type     RT - Warehouse  * 
     C                     EXSR SZRVGN
      * use temp on the batch rin rcd
      * Rtv RIN for Order     RT - COA Batch Header RIN  * 
     C                     EXSR TARVGN
      * P00579 RMC 5/13/10 EMTS: get new fields to print. for rfs1, print
      * Print 2nd line if trans date is there, ie, its been invoiced
      * CASE:
      *  - c1ANDc2ANDc3
      *   |- c1    : LCL.COA BHR RFS Version Nbr is RFS 2
      *   |- c2    : LCL.COA RIN Transaction Date is Entered
      *   |- c3    : LCL.Print (Yes/No) USR is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0092    IFEQ '2'                        *IF
     C           YL0086    IFNE *ZERO                      *IF
     C           YL0083    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: LCL.COA EMTS Batch Nbr is Entered
     C           YL0093    IFGT *ZERO                      *IF
     C                     Z-ADDYL0093    $CSQNY           COA EMTS Batch
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDFNITNY    $CSQNY           COA EMTS Batch
     C                     END                             *FI
      * Use COA Supporting # if diff than EMTS batch (ie. tom overrode it
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.COA RIN Supporting Nbr 1 is Not equal to zero
      *   |- c2    : LCL.COA RIN Supporting Nbr 1 NE CUR.COA EMTS Batch N
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0091    IFNE *ZERO                      *IF
     C           YL0091    IFNE $CSQNY                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0091    $CSQNY           COA EMTS Batch
     C                     END                             *FI
      * CUR.Text USR 9 = Condition name of LCL.COA RIN Type Flag
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1852628   Y2LSNO  70       List number
     C                     PARM YL0088    W0INVL 25        COA RIN Type Fl
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CD6T1    PARM           W0CNNM 25        Text USR 9
      *
     C                     MOVEL@CN,014   $CY8TX           Text USR 7
      * Rtv Trans Reason Desc RT - RFS Transaction Reason  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0090    WL0057    P      RFS Transaction
     C                     MOVEL$CMXAA    WL0058    P      RFS Trans Reaso
     C                     EXSR TBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0059    $CWTT1    P      RFS Trans Reaso
     C                     MOVEL'Y'       YL0083           Print (Yes/No)
      * CASE: LCL.COA Ref Load Id is GT Zero
     C           YL0089    IFGT *ZERO                      *IF
      * RTV Load Cust PO      RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0089    WL0061           Load ID
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0060    YL0094    P      Customer Purcha
     C                     Z-ADD1         ZQ      50
     C           @CN,015   CAT  YL0094:ZQ $CMUT1    P      COA Batch Heade
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDFNITNY    $CSQNY           COA EMTS Batch
      * Use COA Supporting # if diff than EMTS batch (ie. tom overrode it
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.COA RIN Supporting Nbr 1 is Not equal to zero
      *   |- c2    : LCL.COA RIN Supporting Nbr 1 NE CUR.COA EMTS Batch N
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0091    IFNE *ZERO                      *IF
     C           YL0091    IFNE $CSQNY                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0091    $CSQNY           COA EMTS Batch
     C                     END                             *FI
     C                     MOVEL'N'       YL0083           Print (Yes/No)
      * CASE: LCL.COA Ref Load Id is GT Zero
     C           YL0089    IFGT *ZERO                      *IF
      * RTV Load Cust PO      RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0089    WL0061           Load ID
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0060    YL0094    P      Customer Purcha
     C                     MOVEL*BLANK    $CWTT1           RFS Trans Reaso
     C                     MOVELYL0094    $CWTT1           RFS Trans Reaso
     C                     MOVEL@CN,015   $CY8TX           Text USR 7
     C                     END                             *FI
      * BLender
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Type Code is Blender for Biodiesel
      *   |- c2    : LCL.COA EMTS Batch Nbr is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0071    IFEQ 'BL'                       *IF
     C           YL0093    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0093    $CSQNY           COA EMTS Batch
     C                     END                             *FI
     C                     END                             *FI
      * CASE: CUR.COA Temperature Loadout is Not Entered
     C           $CJENY    IFEQ *ZERO                      *IF
     C                     Z-ADDYL0013    $CJENY           COA Temperature
     C                     END                             *FI
      * Non Rin Customer
      * CASE: PAR.Type Code is Not RIN Customer
     C           YL0071    IFEQ 'NR'                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,016   CAT  'red.':ZQ $CMUT1    P      COA Batch Heade
     C                     MOVEL*BLANK    $CD6T1           Text USR 9
     C                     MOVEL'N'       YL0083           Print (Yes/No)
     C                     END                             *FI
      * Non Rin Customer - dyed fuel codes
      * CASE: PAR.Type Code is Not RIN Customer
     C           YL0071    IFEQ 'NR'                       *IF
      * CASE:
      *  - c1ORc2
      *   |- c1    : CUR.COA Bio-diesel Fuel Code is D100
      *   |- c2    : CUR.COA Bio-diesel Fuel Code is D99.9
      *   '-
     C           $CIDAA    IFEQ 'D100'                     *IF
     C           $CIDAA    OREQ 'D99.9'                    *OR
     C                     MOVEL*BLANK    $COPT1           Text 93 USR
     C                     MOVELYL0079    $COPT1           Text 93 USR
     C                     MOVEL'2'       YL0088           COA RIN Type Fl
     C                     END                             *FI
     C                     END                             *FI
      * BLender customer - accum rins - may be multiple bhr rcds
      * CASE: PAR.Type Code is Blender for Biodiesel
     C           YL0071    IFEQ 'BL'                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           @CN,016   CAT  'red.':ZQ $CMUT1    P      COA Batch Heade
      * CASE: LCL.Print (Yes/No) USR is Yes
     C           YL0083    IFEQ 'Y'                        *IF
     C                     MOVELYL0080    $COPT1           Text 93 USR
      * Rtv SEP to Accum RINs RT - COA Batch Header RIN  * 
     C                     EXSR TDRVGN
     C                     END                             *FI
     C                     END                             *FI
      * RTV HPB RIN Fields     RT - Order Header Extension  * 
     C                     EXSR TERVGN
      * Regular customer with >1.5 equiv value- accum rin-may be multiple
      * CASE: LCL.OHE HPB RIN Equiv Value is Normal 1.5
     C           YL0095    IFEQ 1.5                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.OHE HPB RIN Equiv Value is EQ 0
     C           YL0095    IFEQ *ZERO                      *IF
     C                     Z-ADD1.5       YL0095           OHE HPB RIN Equ
     C                     END                             *FI
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
     C                     MOVEL'0'       *IN79
     C           YL0083    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           YL0088    IFEQ '1'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$CCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$CDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print First Page Format of Prt BOL RINS-Prt w/ap PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0CL1P
     C                     END                             FI
      * Print COA Shipping Company of Prt BOL RINS-Prt w/ap PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP00
     C                     END                             FI
      * Print COA EMTS PTD Nbr of Prt BOL RINS-Prt w/ap PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP01
     C                     END                             FI
      * Print COA EMTS Batch Nbr of Prt BOL RINS-Prt w/ap PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP02    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of COA EMTS Batch Nbr format
      * print for overflow only to skp printing to the detail box
      * CASE: LCL.Print Blank Line Usr is yes
     C           YL0098    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       W0PFM            *Print format
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Print format
     C                     WRITE$DKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE 'P'       W0CP02
     C                     END                             FI
      * Print Detail line. of Prt BOL RINS-Prt w/ap PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0CCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     ADD  1         YL0081           USR Count
      * CUR.Text 9                USR = Condition name of DB1.COA RIN Typ
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1852628   Y2LSNO  70       List number
     C                     PARM DAMAT1    W0INVL 25        COA RIN Type Fl
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $ES4TX    PARM           W0CNNM 25        Text 9
      *
      * Rtv Trans Reason Desc RT - RFS Transaction Reason  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELDAI7AA    WL0057    P      RFS Transaction
     C                     MOVELDAMXAA    WL0058    P      RFS Trans Reaso
     C                     EXSR TBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0059    $EWTT1    P      RFS Trans Reaso
      * Use fields for field headings to control font size
     C                     MOVEL@CN,017   $EZ3TX           Text 7 Alpha Us
     C                     MOVEL'RINs:'   $EY7TX           Text USR 5
     C                     MOVEL'D='      $EHKT1           Text 2
     C                     MOVEL@CN,014   $EY8TX           Text USR 7
      * CASE: CUR.COA EMTS Batch Nbr is Entered
     C           $ESQNY    IFGT *ZERO                      *IF
     C                     MOVEL@CN,018   $EXLTX           Text USR 6
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $EXLTX           Text USR 6
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Print column headings if required
     C           W0CCDT    IFEQ 'Y'
     C                     WRITE$ECOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0CCDT
     C                     END                             FI
      * Print format
     C                     WRITE$EDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     MOVEL*BLANK    W0SKP   1
      * Cascade skip to new page requests upwards
     C           W0APDT    IFEQ 'Y'
     C                     MOVEL'Y'       W0SKP
     C                     END
      * Request new page if required
     C           W0SKP     IFEQ 'Y'                        IF
     C                     MOVE 'Y'       W0NEWP
     C                     END                             FI
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of PRT Bill of Lading-HPB PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Load ID of PRT Bill of Lading-HPB PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Bill of Lading-HPB PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD26        W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT HPB BOL Info       PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT HPB BOL Info       PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of PRT HPB BOL Info       PO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Sequence Number of PRT HPB BOL Info       PO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Secondary Line Seq of PRT HPB BOL Info       PO
     C           W0BP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT HPB BOL Info       PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD3         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt BOL RINS-Prt w/ap PO
     C           W0CP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * COA Shipping Company of Prt BOL RINS-Prt w/ap PO
     C           W0CP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * COA EMTS PTD Nbr of Prt BOL RINS-Prt w/ap PO
     C           W0CP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * COA EMTS Batch Nbr of Prt BOL RINS-Prt w/ap PO
     C           W0CP02    IFEQ 'Y'
     C                     ADD  6         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt BOL RINS-Prt w/ap PO
     C           W0CPDT    IFEQ 'Y'
     C                     Z-ADD2         W0DTLN
     C           W0CCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV calc BOL pages req RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0003           USR Counter
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSA02           Load ID
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA02           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSA02           Load ID
      * Establish starting position
     C           KRSSA     SETLL@FLCPKF                    *
     C           KRSSA     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         YL0003           USR Counter
      * Drill down to the Manifest detail to see if there will be overflo
      * RTV calc pages for BOL RT - Order Header TRG  * 
     C                     EXSR SBRVGN
      * Rtv Count for BOL Rin RT - COA Batch Header RIN  * 
     C                     EXSR SERVGN
     C                     ADD  YL0004    YL0003           USR Counter
     C           KRSSA     READE@FLCPKF                  90*
     C                     ENDDO
      * USER: Exit processing
      * Double the pages to count the new TERMS page (back overlay)  T154
     C           2         MULT YL0003    YL0002           Page Nbr - Tota
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV calc pages for BOL RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0004           Page Overflow
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    BEAIC3           Company Number
     C                     Z-ADDFLC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSB     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV calc pages for BOL RT - Order Detail  * 
     C                     EXSR SCRVGN
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV calc pages for BOL RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSC01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSC02           Order Number
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
      * Setup key
     C                     Z-ADDBEAIC3    WQSC01           Company Number
     C                     Z-ADDBEC4NB    WQSC02           Order Number
      * Establish starting position
     C           KRSSC     SETLL@BGWKL1                    *
     C           KRSSC     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV calc pages for BOL RT - Manifest Detail  * 
     C                     EXSR SDRVGN
     C           KRSSC     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV calc pages for BOL RT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Declare restrictor key work fields
     C           *LIKE     DEFN FNAIC3    WQSD01           Company Number
     C           *LIKE     DEFN FNC4NB    WQSD02           Order Number
     C           *LIKE     DEFN FNDPNB    WQSD03           Order Sequence
     C           *LIKE     DEFN FNUENB    WQSD04           Order Secondary
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Order Number
     C                     KFLD           WQSD03           Order Sequence
     C                     KFLD           WQSD04           Order Secondary
      * Setup key
     C                     Z-ADDOMAIC3    WQSD01           Company Number
     C                     Z-ADDOMC4NB    WQSD02           Order Number
     C                     Z-ADDOMDPNB    WQSD03           Order Sequence
     C                     Z-ADDOMUENB    WQSD04           Order Secondary
      * Establish starting position
     C           KRSSD     SETLL@FNCPCT                    *
     C           KRSSD     READE@FNCPCT                  90*
      * Data record not found
     C   90                MOVEL'USR1196' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         YL0005           USR Count
     C                     ADD  1         YL0001           Manifest Dtl Re
     C           KRSSD     READE@FNCPCT                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: LCL.USR Count GT PAR.ED Nbr of prods on 1st pg
     C           YL0005    IFGT 4                          *IF
     C           YL0005    DIV  4         YL0006           USR Page Number
     C                     MVR            YL0007           Remaining Bal 8
      * CASE: LCL.Remaining Bal 8.2 USR is Zero
     C           YL0007    IFEQ 0                          *IF
     C           YL0006    SUB  1         YL0004           Page Overflow
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0006    YL0004           Page Overflow
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Count for BOL Rin RT - COA Batch Header RIN  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DACWC3    WQSE01           COA Shipping Co
     C           *LIKE     DEFN DAR9NY    WQSE02           COA EMTS PTD Nb
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           COA Shipping Co
     C                     KFLD           WQSE02           COA EMTS PTD Nb
      * Setup key
     C                     Z-ADDFLAIC3    WQSE01           COA Shipping Co
     C                     Z-ADDP1RMNB    WQSE02           COA EMTS PTD Nb
      * Establish starting position
     C           KRSSE     SETLL@DACPY6                    *
     C           KRSSE     READE@DACPY6                  90*
      * Data record not found
     C   90                MOVEL'USR3855' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RFS Transaction Type is Sold or Delivered
     C           DAI7AA    IFEQ 'SEL'                      *IF
      * W104274 DN 08/08/22-Added Co 376 Hugoton SE Marketing.
      * CASE:
      *  - c1ORc2ORc3
      *   |- c1    : DB1.Company Number is HPB Biodiesel
      *   |- c2    : DB1.Company Number is St Joseph HPB Marketing
      *   |- c3    : DB1.Company Number is Hugoton SE Marketing
      *   '-
     C           DAAIC3    IFEQ 369                        *IF
     C           DAAIC3    OREQ 374                        *OR
     C           DAAIC3    OREQ 376                        *OR
     C                     ADD  1         YL0008           USR Count
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSE     READE@DACPY6                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: LCL.USR Count GT PAR.ED Nbr of prods on 1st pg
     C           YL0008    IFGT 4                          *IF
     C           YL0008    DIV  4         YL0009           USR Page Number
     C                     MVR            YL0010           Remaining Bal 8
      * CASE: LCL.Remaining Bal 8.2 USR is Zero
     C           YL0010    IFEQ 0                          *IF
     C           YL0009    SUB  1         YL0004           Page Overflow
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0009    YL0004           Page Overflow
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Trailer Nbr,Pr Tmp RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWARMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSF     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJDXTX    YL0011           Trailer Id
     C                     Z-ADDFJPRTM    YL0012           Product Tempera
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV All Fields         RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    BEAIC3           Company Number
     C                     Z-ADDWAC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSG     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     $BBKC7           Ship To Custome
     C                     MOVEL*BLANK    YL0014           Ship To Name
     C                     MOVEL*BLANK    YL0015           Ship To Address
     C                     MOVEL*BLANK    YL0016           Ship To Address
     C                     MOVEL*BLANK    YL0017           Ship To Address
     C                     MOVEL*BLANK    YL0018           Ship To City
     C                     MOVEL*BLANK    YL0019           Ship To State C
     C                     MOVEL*BLANK    YL0020           Ship To Zip/Pos
     C                     Z-ADD*ZERO     YL0021           Bill to Custome
     C                     MOVEL*BLANK    YL0022           Bill to Name
     C                     MOVEL*BLANK    YL0023           Bill to Address
     C                     MOVEL*BLANK    YL0024           Bill to Address
     C                     MOVEL*BLANK    YL0025           Bill to Address
     C                     MOVEL*BLANK    YL0026           Bill to City
     C                     MOVEL*BLANK    YL0027           Bill to State C
     C                     MOVEL*BLANK    YL0028           Bill to Zip/Pos
     C                     MOVEL*BLANK    $BBCNA           Customer Purcha
     C                     Z-ADD*ZERO     $BBQDT           Actual Shipped
     C                     MOVEL*BLANK    YL0029           Terms Code
     C                     Z-ADD*ZERO     $BAWDT           Invoice Date
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBEBKC7    $BBKC7           Ship To Custome
     C                     MOVELBEBRTX    YL0014           Ship To Name
     C                     MOVELBEHMNA    YL0015           Ship To Address
     C                     MOVELBEHONA    YL0016           Ship To Address
     C                     MOVELBEHPNA    YL0017           Ship To Address
     C                     MOVELBEHNNA    YL0018           Ship To City
     C                     MOVELBEDBCD    YL0019           Ship To State C
     C                     MOVELBECKTX    YL0020           Ship To Zip/Pos
     C                     Z-ADDBEB0C7    YL0021           Bill to Custome
     C                     MOVELBEAETX    YL0022           Bill to Name
     C                     MOVELBEB1NA    YL0023           Bill to Address
     C                     MOVELBEB3NA    YL0024           Bill to Address
     C                     MOVELBEB4NA    YL0025           Bill to Address
     C                     MOVELBEB2NA    YL0026           Bill to City
     C                     MOVELBEBHCD    YL0027           Bill to State C
     C                     MOVELBEC8TX    YL0028           Bill to Zip/Pos
     C                     MOVELBEBCNA    $BBCNA           Customer Purcha
     C                     Z-ADDBEGNDT    $BBQDT           Actual Shipped
     C                     MOVELBEAQCD    YL0029           Terms Code
     C                     Z-ADDBEAWDT    $BAWDT           Invoice Date
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Ship To Whse-HPB  RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    BEAIC3           Company Number
     C                     Z-ADDWAC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSH     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEBCNA    YL0030           Customer Purcha
     C                     MOVELBEFXSX    YL0031           HPB Ship to War
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Desc, status       RT - Terms  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           AOAIC3           Company Number
     C                     KFLD           AOAQCD           Terms Code
      * Setup key
     C                     Z-ADDWAAIC3    AOAIC3           Company Number
     C                     MOVELYL0029    AOAQCD           Terms Code
      * Establish starting position
     C           KRSSI     CHAIN@AOREB3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0037' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $BAUNA           Description
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAOAUNA    $BAUNA           Description
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV HPB fields/dlv po RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    AMAIC3           Company Number
     C                     Z-ADDWAC4NB    AMC4NB           Order Number
      * Establish starting position
     C           KRSSJ     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0032           OHE Override Ty
     C                     Z-ADD*ZERO     YL0033           HPB COA Batch N
     C                     MOVEL*BLANK    $BLMT1           Delivery P.O. N
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAMCHTX    YL0032           OHE Override Ty
     C                     Z-ADDAMITNY    YL0033           HPB COA Batch N
     C                     MOVELAMLMT1    $BLMT1           Delivery P.O. N
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV 1st Item Code     RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSK01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSK02           Order Number
      * Define keylist
     C           KPSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WQSK02           Order Number
     C                     KFLD           WBDPNB           Order Sequence
     C                     KFLD           WBUENB           Order Secondary
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WQSK02           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WQSK01           Company Number
     C                     Z-ADDWAC4NB    WQSK02           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
      * Establish starting position
     C           KPSSK     SETLL@BGWKAE                    *
     C           KRSSK     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBHGCD    YL0034           Item Code
     C                     GOTO SKEXIT                     *QUIT
     C           KRSSK     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSL01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSL02           Order Number
      * Define keylist
     C           KPSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Order Number
     C                     KFLD           WBDPNB           Order Sequence
     C                     KFLD           WBUENB           Order Secondary
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WQSL01           Company Number
     C                     Z-ADDWAC4NB    WQSL02           Order Number
     C                     Z-ADD1         WBDPNB           Order Sequence
     C                     Z-ADD1         WBUENB           Order Secondary
      * Establish starting position
     C           KPSSL     SETLL@BGWKAE                    *
     C           KRSSL     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0035           Warehouse Code
     C                     MOVEL*BLANK    YL0036           Trans Contol AS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Warehouse Control  RT - Warehouse  * 
     C                     EXSR SMRVGN
      * PAR = DB1 By name
     C                     MOVELWBAJCD    YL0035           Warehouse Code
     C                     GOTO SLEXIT                     *QUIT
     C           KRSSL     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Warehouse Control  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWBAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSM     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0036           Trans Contol AS
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADXUST    YL0036           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv HPB fields,type   RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELYL0035    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSN     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0038           Production Ware
     C                     MOVEL*BLANK    YL0039           Warehouse Type
     C                     MOVEL*BLANK    YL0040           Warehouse Locat
     C                     MOVEL*BLANK    YL0041           WHS Req Meter R
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADAOCD    YL0038           Production Ware
     C                     MOVELADWPST    YL0039           Warehouse Type
     C                     MOVELADT0ST    YL0040           Warehouse Locat
     C                     MOVELADRTSX    YL0041           WHS Req Meter R
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Acct Co          RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0001    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSO     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0002           Accounting Comp
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDADBTC3    WL0002           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV all used fields 2  RT - COA Property Define Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0004           COA Bio-diesel
     C                     MOVEL*BLANK    WL0005           COA Bio-dsl Fue
     C                     MOVEL*BLANK    WL0006           COA Producer Re
     C                     MOVEL*BLANK    WL0007           COA Employer ID
     C                     MOVEL*BLANK    WL0008           COA Sold From A
     C                     MOVEL*BLANK    WL0009           COA Sold From N
     C                     MOVEL*BLANK    WL0010           COA ULSD Compan
     C                     MOVEL*BLANK    WL0011           COA ULSD Facili
     C                     MOVEL*BLANK    WL0012           COA RIN Equival
     C                     MOVEL*BLANK    WL0013           COA RIN Renewab
     C                     MOVEL*BLANK    WL0014           COA RIN Type Fl
     C                     Z-ADD*ZERO     WL0015           COA Density Loa
     C                     Z-ADD*ZERO     WL0016           COA Density Ref
     C                     Z-ADD*ZERO     WL0017           COA Temperature
     C                     Z-ADD*ZERO     WL0018           COA Temperature
     C                     Z-ADD*ZERO     WL0019           COA BOL Percent
     C                     MOVEL*BLANK    WL0020           COA Sale Locati
     C                     MOVEL*BLANK    WL0021           COA Active Whse
     C                     MOVEL*BLANK    WL0022           COA Active Whse
     C                     MOVEL*BLANK    WL0023           COA Active Whse
     C                     MOVEL*BLANK    WL0024           COA Active Whse
     C                     MOVEL*BLANK    WL0025           COA Active Whse
     C                     MOVEL*BLANK    WL0026           COA Active Whse
     C                     Z-ADD*ZERO     WL0027           COA Temp Conv F
     C                     MOVEL*BLANK    WL0028           Operation Facto
     C                     Z-ADD*ZERO     WL0029           COA Temp Conv F
     C                     MOVEL*BLANK    WL0030           Operation Facto
     C                     MOVEL*BLANK    WL0031           COA RFS Renew F
     C                     MOVEL*BLANK    WL0032           COA RFS Rnwbl F
     C                     MOVEL*BLANK    WL0034           COA Fuel Desc2/
     C                     MOVEL*BLANK    WL0035           Record Status
      * Declare restrictor key work fields
     C           *LIKE     DEFN CAAIC3    WQSP01           Company Number
     C           *LIKE     DEFN CAIBAA    WQSP02           COA OMS Item Co
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Company Number
     C                     KFLD           WQSP02           COA OMS Item Co
      * Setup key
     C                     Z-ADDWL0003    WQSP01           Company Number
     C                     MOVELWL0033    WQSP02           COA OMS Item Co
      * Establish starting position
     C           KRSSP     SETLL@CARED2                    *
     C           KRSSP     READE@CARED2                  90*
      * Data record not found
     C   90                MOVEL'USR3799' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELCAIDAA    WL0004           COA Bio-diesel
     C                     MOVELCAR2NA    WL0005           COA Bio-dsl Fue
     C                     MOVELCAL2T1    WL0006           COA Producer Re
     C                     MOVELCAL3T1    WL0007           COA Employer ID
     C                     MOVELCAL4T1    WL0008           COA Sold From A
     C                     MOVELCAL5T1    WL0009           COA Sold From N
     C                     MOVELCAL6T1    WL0010           COA ULSD Compan
     C                     MOVELCAL7T1    WL0011           COA ULSD Facili
     C                     MOVELCAL8T1    WL0012           COA RIN Equival
     C                     MOVELCAL9T1    WL0013           COA RIN Renewab
     C                     MOVELCAMAT1    WL0014           COA RIN Type Fl
     C                     Z-ADDCAJCNY    WL0015           COA Density Loa
     C                     Z-ADDCAJDNY    WL0016           COA Density Ref
     C                     Z-ADDCAJENY    WL0017           COA Temperature
     C                     Z-ADDCAJFNY    WL0018           COA Temperature
     C                     Z-ADDCAGMPC    WL0019           COA BOL Percent
     C                     MOVELCAMBT1    WL0020           COA Sale Locati
     C                     MOVELCAIEAA    WL0021           COA Active Whse
     C                     MOVELCAIFAA    WL0022           COA Active Whse
     C                     MOVELCAIGAA    WL0023           COA Active Whse
     C                     MOVELCAIHAA    WL0024           COA Active Whse
     C                     MOVELCAIIAA    WL0025           COA Active Whse
     C                     MOVELCAIJAA    WL0026           COA Active Whse
     C                     Z-ADDCAJQNY    WL0027           COA Temp Conv F
     C                     MOVELCALXST    WL0028           Operation Facto
     C                     Z-ADDCAJRNY    WL0029           COA Temp Conv F
     C                     MOVELCALYST    WL0030           Operation Facto
     C                     MOVELCAIMTX    WL0031           COA RFS Renew F
     C                     MOVELCAFEDS    WL0032           COA RFS Rnwbl F
     C                     MOVELCAMCT1    WL0034           COA Fuel Desc2/
     C                     MOVELCAVSST    WL0035           Record Status
     C           KRSSP     READE@CARED2                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV ULSD Facility     RT - COA Property Define Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KPSSQ     KLIST
     C                     KFLD           CAAIC3           Company Number
      * Setup key
     C                     Z-ADD0         CAAIC3           Company Number
      * Establish starting position
     C           KPSSQ     SETLL@CARED2                    *
     C                     READ @CARED2                  90*
      * Data record not found
     C   90                MOVEL'USR3799' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RMC - get the other facility number
      * CASE: DB1.COA ULSD Facility # NE PAR.COA ULSD Facility #
     C           CAL7T1    IFNE $BL7T1                     *IF
     C                     MOVELCAL7T1    $BNAT1           HPB ULSD Facili
     C                     GOTO SQEXIT                     *QUIT
     C                     END                             *FI
     C                     READ @CARED2                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Co Addr & Phone FaxRT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADDWAAIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSR     CHAIN@ABREG3              90    *
      * Data record not found
     C   90                MOVEL'USR0003' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABACNA    $BGNNA           Address Line 1
     C                     MOVELABADNA    YL0056           Address Line 2
     C                     MOVELABAENA    YL0057           Address Line 3
     C                     MOVELABAJNA    YL0058           City
     C                     MOVELABBTTX    YL0059           Zip Postal Code
     C                     MOVELABBVTX    YL0060           Telephone Numbe
     C                     MOVELABBWTX    YL0061           Fax Number FF
     C                     MOVELABBGCD    YL0062           State Code
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Customer A/R Cust  RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD$BBKC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSS     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBBANC7    YL0064           A/R Customer Nu
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv HPB Cust Fields   RT - Company Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           NIAIC3           Company Number
     C                     KFLD           NIBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0036    NIAIC3           Company Number
     C                     Z-ADDWL0037    NIBKC7           Ship To Custome
      * Establish starting position
     C           KRSST     CHAIN@NIREBO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2904' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0038           HPB Employer ID
     C                     MOVEL*BLANK    WL0039           HPB ULSD Compan
     C                     MOVEL*BLANK    WL0040           HPB ULSD Facili
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELNINCT1    WL0038           HPB Employer ID
     C                     MOVELNIM9T1    WL0039           HPB ULSD Compan
     C                     MOVELNINAT1    WL0040           HPB ULSD Facili
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Transload Stn All RT - COA Transloading Station  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           DLIZAA           COA Station Cod
      * Setup key
     C                     MOVELWL0041    DLIZAA           COA Station Cod
      * Establish starting position
     C           KRSSU     CHAIN@DLRERJ              90    *
      * Data record not found
     C   90                MOVEL'USR3897' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDLNIT1    WL0042           COA Station Nam
     C                     MOVELDLACNA    WL0043           Address Line 1
     C                     MOVELDLADNA    WL0044           Address Line 2
     C                     MOVELDLAENA    WL0045           Address Line 3
     C                     MOVELDLAJNA    WL0046           City
     C                     MOVELDLBGCD    WL0047           State Code
     C                     MOVELDLBTTX    WL0048           Zip Postal Code
     C                     MOVELDLL6T1    WL0049           COA ULSD Compan
     C                     MOVELDLL7T1    WL0050           COA ULSD Facili
     C                     MOVELDLL3T1    WL0051           COA Employer ID
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Warehouse Address  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELYL0035    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSV     CHAIN@ADREAO              90    *
      * Data record not found
     C   90                MOVEL'USR0007' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADF8NA    $BNIT1           Warehouse Descr
     C                     MOVELADAJNA    YL0058           City
     C                     MOVELADBTTX    YL0059           Zip Postal Code
     C                     MOVELADBGCD    YL0062           State Code
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV Type Code          RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           EOAIC3           Company Number
     C                     KFLD           EOBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0052    EOAIC3           Company Number
     C                     Z-ADDWL0053    EOBKC7           Ship To Custome
      * Establish starting position
     C           KRSSW     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0054           Type Code
     C                     MOVEL*BLANK    WL0055           Customer Group
     C                     MOVEL*BLANK    WL0056           Customer Group
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEOBOCD    WL0054           Type Code
     C                     MOVELEOT9CD    WL0055           Customer Group
     C                     MOVELEOUBCD    WL0056           Customer Group
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Count for BOL     RT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FNAIC3    WQSX01           Company Number
     C           *LIKE     DEFN FNC4NB    WQSX02           Order Number
      * Define keylist
     C           KPSSX     KLIST
     C                     KFLD           WQSX01           Company Number
     C                     KFLD           WQSX02           Order Number
     C                     KFLD           FNDPNB           Order Sequence
     C                     KFLD           FNUENB           Order Secondary
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           Company Number
     C                     KFLD           WQSX02           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WQSX01           Company Number
     C                     Z-ADDWAC4NB    WQSX02           Order Number
     C                     Z-ADD*ZERO     FNDPNB           Order Sequence
     C                     Z-ADD*ZERO     FNUENB           Order Secondary
      * Establish starting position
     C           KPSSX     SETLL@FNCPCT                    *
     C           KRSSX     READE@FNCPCT                  90*
      * Data record not found
     C   90                MOVEL'USR1196' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         YL0072           Count USR
     C           KRSSX     READE@FNCPCT                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV Item Desc         RT - COA Property Define Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    $CIDAA           COA Bio-diesel
     C                     MOVEL*BLANK    $CR2NA           COA Bio-dsl Fue
     C                     MOVEL*BLANK    $CMCT1           COA Fuel Desc2/
      * Declare restrictor key work fields
     C           *LIKE     DEFN CAAIC3    WQSY01           Company Number
     C           *LIKE     DEFN CAIBAA    WQSY02           COA OMS Item Co
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           Company Number
     C                     KFLD           WQSY02           COA OMS Item Co
      * Setup key
     C                     Z-ADD$CAIC3    WQSY01           Company Number
     C                     MOVELYL0084    WQSY02           COA OMS Item Co
      * Establish starting position
     C           KRSSY     SETLL@CARED2                    *
     C           KRSSY     READE@CARED2                  90*
      * Data record not found
     C   90                MOVEL'USR3799' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELCAIDAA    $CIDAA           COA Bio-diesel
     C                     MOVELCAR2NA    $CR2NA           COA Bio-dsl Fue
     C                     MOVELCAMCT1    $CMCT1           COA Fuel Desc2/
     C           KRSSY     READE@CARED2                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELFNAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSZ     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0085           Warehouse Type
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADWPST    YL0085           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Rtv RIN for Order     RT - COA Batch Header RIN  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCCWC3    WQTA01           COA Shipping Co
     C           *LIKE     DEFN WCC4NB    WQTA03           Order Number
     C           *LIKE     DEFN WCDPNB    WQTA04           Order Sequence
     C           *LIKE     DEFN WCUENB    WQTA05           Order Secondary
     C           *LIKE     DEFN WCRZNB    WQTA06           Case Sequence N
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           COA Shipping Co
     C                     KFLD           WQTA03           Order Number
     C                     KFLD           WQTA04           Order Sequence
     C                     KFLD           WQTA05           Order Secondary
     C                     KFLD           WQTA06           Case Sequence N
      * Setup key
     C                     Z-ADD$CAIC3    WQTA01           COA Shipping Co
     C                     Z-ADD$CC4NB    WQTA03           Order Number
     C                     Z-ADD$CDPNB    WQTA04           Order Sequence
     C                     Z-ADD$CUENB    WQTA05           Order Secondary
     C                     Z-ADD$CRZNB    WQTA06           Case Sequence N
      * Establish starting position
     C           KRSTA     SETLL@DACPDL                    *
     C           KRSTA     READE@DACPDL                  90*
      * Data record not found
     C   90                MOVEL'USR3855' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.COA Retired RIN Reason Cd is *Blank
     C           WCRINT    IFEQ *BLANK                     *IF
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.COA RIN Transaction Date is not entered
      *   |- c2    : PAR.Type Code is Marketing
      *   '-
     C           WCRIDT    IFEQ 0                          *IF
     C           YL0071    OREQ 'MK'                       *OR
      * Before invoicing, compare to acctn company
      * CASE: PAR.Warehouse Type is Fresh or Frozen
     C           YL0085    IFEQ 'FR'                       *IF
     C           YL0085    OREQ 'FZ'
      * CASE: DB1.Company Number EQ PAR.Accounting Company
     C           WCAIC3    IFEQ YL0042                     *IF
      * PAR = DB1 By name
     C                     MOVELWCMUT1    $CMUT1           COA Batch Heade
     C                     Z-ADDWCRIDT    YL0086           COA RIN Transac
     C                     Z-ADDWCRMNB    YL0087           Load ID
     C                     MOVELWCMAT1    YL0088           COA RIN Type Fl
     C                     Z-ADDWCQXNY    YL0089           COA Ref Load Id
     C                     Z-ADDWCQYNY    $CJENY           COA BHR Loadout
     C                     Z-ADDWCR8NY    $CR8NY           COA Batch RIN V
     C                     Z-ADDWCR0NY    $CR0NY           COA RIN Quantit
     C                     MOVELWCI7AA    YL0090           RFS Transaction
     C                     MOVELWCMXAA    $CMXAA           RFS Trans Reaso
     C                     MOVELWCMSAA    $CMSAA           RFS Fuel Code
     C                     Z-ADDWCR7NY    $CR7NY           COA BHR RIN Gen
     C                     Z-ADDWCR5NY    YL0091           COA RIN Support
     C                     MOVELWCJ1ST    YL0092           COA BHR RFS Ver
     C                     Z-ADDWCSQNY    YL0093           COA EMTS Batch
     C                     GOTO TAEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * dont check if blended .. not sure why i am anyways! ??? 1-17-20
      * PAR = DB1 By name
     C                     MOVELWCMUT1    $CMUT1           COA Batch Heade
     C                     Z-ADDWCRIDT    YL0086           COA RIN Transac
     C                     Z-ADDWCRMNB    YL0087           Load ID
     C                     MOVELWCMAT1    YL0088           COA RIN Type Fl
     C                     Z-ADDWCQXNY    YL0089           COA Ref Load Id
     C                     Z-ADDWCQYNY    $CJENY           COA BHR Loadout
     C                     Z-ADDWCR8NY    $CR8NY           COA Batch RIN V
     C                     Z-ADDWCR0NY    $CR0NY           COA RIN Quantit
     C                     MOVELWCI7AA    YL0090           RFS Transaction
     C                     MOVELWCMXAA    $CMXAA           RFS Trans Reaso
     C                     MOVELWCMSAA    $CMSAA           RFS Fuel Code
     C                     Z-ADDWCR7NY    $CR7NY           COA BHR RIN Gen
     C                     Z-ADDWCR5NY    YL0091           COA RIN Support
     C                     MOVELWCJ1ST    YL0092           COA BHR RFS Ver
     C                     Z-ADDWCSQNY    YL0093           COA EMTS Batch
     C                     GOTO TAEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * After invoicing, compare to shipping company
      * CASE: DB1.Company Number EQ PAR.COA Shipping Company
     C           WCAIC3    IFEQ $CAIC3                     *IF
      * PAR = DB1 By name
     C                     MOVELWCMUT1    $CMUT1           COA Batch Heade
     C                     Z-ADDWCRIDT    YL0086           COA RIN Transac
     C                     Z-ADDWCRMNB    YL0087           Load ID
     C                     MOVELWCMAT1    YL0088           COA RIN Type Fl
     C                     Z-ADDWCQXNY    YL0089           COA Ref Load Id
     C                     Z-ADDWCQYNY    $CJENY           COA BHR Loadout
     C                     Z-ADDWCR8NY    $CR8NY           COA Batch RIN V
     C                     Z-ADDWCR0NY    $CR0NY           COA RIN Quantit
     C                     MOVELWCI7AA    YL0090           RFS Transaction
     C                     MOVELWCMXAA    $CMXAA           RFS Trans Reaso
     C                     MOVELWCMSAA    $CMSAA           RFS Fuel Code
     C                     Z-ADDWCR7NY    $CR7NY           COA BHR RIN Gen
     C                     Z-ADDWCR5NY    YL0091           COA RIN Support
     C                     MOVELWCJ1ST    YL0092           COA BHR RFS Ver
     C                     Z-ADDWCSQNY    YL0093           COA EMTS Batch
     C                     GOTO TAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Warehouse Type is Blended
     C           YL0085    IFEQ 'BL'                       *IF
      * RMC 1/16/20 for  Blended they may not = so dont check it
      * PAR = DB1 By name
     C                     MOVELWCMUT1    $CMUT1           COA Batch Heade
     C                     Z-ADDWCRIDT    YL0086           COA RIN Transac
     C                     Z-ADDWCRMNB    YL0087           Load ID
     C                     MOVELWCMAT1    YL0088           COA RIN Type Fl
     C                     Z-ADDWCQXNY    YL0089           COA Ref Load Id
     C                     Z-ADDWCQYNY    $CJENY           COA BHR Loadout
     C                     Z-ADDWCR8NY    $CR8NY           COA Batch RIN V
     C                     Z-ADDWCR0NY    $CR0NY           COA RIN Quantit
     C                     MOVELWCI7AA    YL0090           RFS Transaction
     C                     MOVELWCMXAA    $CMXAA           RFS Trans Reaso
     C                     MOVELWCMSAA    $CMSAA           RFS Fuel Code
     C                     Z-ADDWCR7NY    $CR7NY           COA BHR RIN Gen
     C                     Z-ADDWCR5NY    YL0091           COA RIN Support
     C                     MOVELWCJ1ST    YL0092           COA BHR RFS Ver
     C                     Z-ADDWCSQNY    YL0093           COA EMTS Batch
     C                     GOTO TAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTA     READE@DACPDL                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Rtv Trans Reason Desc RT - RFS Transaction Reason  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           GGI7AA           RFS Transaction
     C                     KFLD           GGMXAA           RFS Trans Reaso
      * Setup key
     C                     MOVELWL0057    GGI7AA           RFS Transaction
     C                     MOVELWL0058    GGMXAA           RFS Trans Reaso
      * Establish starting position
     C           KRSTB     CHAIN@GGREG2              90    *
      * Data record not found
     C   90                MOVEL'USR4324' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELGGWTT1    WL0059           RFS Trans Reaso
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * RTV Load Cust PO      RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQTC02           Load ID
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WQTC02           Load ID
      * Setup key
     C                     Z-ADDWL0061    WQTC02           Load ID
      * Establish starting position
     C           KRSTC     SETLL@BFCPD9                    *
     C           KRSTC     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDBCNA    WL0060           Customer Purcha
     C           KRSTC     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv SEP to Accum RINs RT - COA Batch Header RIN  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     $CR8NY           COA Batch RIN V
     C                     Z-ADD*ZERO     $CR0NY           COA RIN Quantit
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQTD01           Company Number
     C           *LIKE     DEFN WER9NY    WQTD02           COA EMTS PTD Nb
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           Company Number
     C                     KFLD           WQTD02           COA EMTS PTD Nb
      * Setup key
     C                     Z-ADD$CAIC3    WQTD01           Company Number
     C                     Z-ADDYL0087    WQTD02           COA EMTS PTD Nb
      * Establish starting position
     C           KRSTD     SETLL@DACPRB                    *
     C           KRSTD     READE@DACPRB                  90*
      * Data record not found
     C   90                MOVEL'USR3855' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RFS Transaction Type EQ PAR.RFS Transaction Type
     C           WEI7AA    IFEQ 'SEP'                      *IF
     C                     ADD  WER8NY    $CR8NY           COA Batch RIN V
     C                     ADD  WER0NY    $CR0NY           COA RIN Quantit
     C                     END                             *FI
     C           KRSTD     READE@DACPRB                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * RTV HPB RIN Fields     RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADD$CAIC3    AMAIC3           Company Number
     C                     Z-ADD$CC4NB    AMC4NB           Order Number
      * Establish starting position
     C           KRSTE     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0095           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     YL0096           OHE HPB RIN Pri
     C                     MOVEL*BLANK    YL0097           OHE Override Ty
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAMHEVL    YL0095           OHE HPB RIN Equ
     C                     Z-ADDAMHFVL    YL0096           OHE HPB RIN Pri
     C                     MOVELAMCHTX    YL0097           OHE Override Ty
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT HPB BOL Info       PO
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  80       Last Ending Gal
      *
      * PRT HPB BOL Info       PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt BOL RINS-Prt w/ap PO
      *================================================================
      * dont chk >1.5 equiv value- Print rins-may be multiple    7-16-15
      * CASE:
      *  - c2ORc3
      *   |- c2    : LCL.COA RIN Transaction Date is not entered
      *   |- c3    : LCL.Count Records         USR NE PAR.Manifest Dtl Re
      *   '-
     C           YL0086    IFEQ *ZERO                      *IF
     C           YL0077    ORNE YL0001                     *OR
      * And dont print if not invoiced yet.
     C                     GOTO UBEXIT                     *QUIT
     C                     END                             *FI
      * Prt BOL RINS-Prt w/ap PO: Mainline
     C                     EXSR C0MAIN
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZBINIT    BEGSR
      *================================================================
      * PRT HPB BOL Info       PO: Initialise
      *================================================================
      * USER: Initialize program
      * If BLender & more than one manifest detl, then print nbr rins on
      *  par.count usr has the nbr of manifest dtls
     C                     Z-ADD*ZERO     YL0077           Count Records
     C                     Z-ADD1         ZQ      50
     C           @CN,007   CAT  @CN,008:ZQYL0078    P      Text Usr 50
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0078    CAT  @CN,009:ZQYL0079    P      text usr 75
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0079    CAT  @CN,010:ZQYL0080    P      Text 93 USR
      * New for Dyed fuel:
     C                     Z-ADD1         ZQ      50
     C           @CN,011   CAT  @CN,012:ZQYL0078    P      Text Usr 50
     C                     Z-ADD1         ZQ      50
     C           YL0078    CAT  @CN,013:ZQYL0079    P      text usr 75
      *================================================================
     CSR         ZBEXIT    ENDSR
      /EJECT
     CSR         ZCINIT    BEGSR
      *================================================================
      * Prt BOL RINS-Prt w/ap PO: Initialise
      *================================================================
      * USER: Initialize program
     C                     MOVEL'N'       YL0098           Print Blank Lin
      *================================================================
     CSR         ZCEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Initialise indicators for re-entry
     C                     MOVE '0'       *IN
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WARUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WARVNB           Stop/Drop
     C                     Z-ADD*ZERO     WARWNB           Miles to next s
     C                     Z-ADD*ZERO     WARXNB           Freight Charge
     C                     Z-ADD*ZERO     WASQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WAT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WAT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WASXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WAKFDT           Appointment Con
     C                     Z-ADD*ZERO     WAACTM           Appointment Con
     C                     Z-ADD*ZERO     WAEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WAAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WAKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WAATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WAHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WAAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WAKKDT           On Yard Date
     C                     Z-ADD*ZERO     WAAVTM           On Yard Time
     C                     Z-ADD*ZERO     WAZ4NB           MPC Number
     C                     Z-ADD*ZERO     WAN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WAN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WAN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WAB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WAB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WAB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WARMNB           Load ID
     C                     MOVEL*LOVAL    WARUNB           Stop/Drop Seque
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WBMAVA           Billing Detail
     C                     Z-ADD*ZERO     WBKDVA           Billing Detail
     C                     Z-ADD*ZERO     WBL8VA           Billing Detail
     C                     Z-ADD*ZERO     WBL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WBAYVA           Extended Amount
     C                     Z-ADD*ZERO     WBEXDT           Market Pricing
     C                     Z-ADD*ZERO     WBBZPR           Price Overage O
     C                     Z-ADD*ZERO     WBL6NB           Contract Number
     C                     Z-ADD*ZERO     WBGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WBD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WBCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WBAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WBCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WBATWG           Weight Shipped
     C                     Z-ADD*ZERO     WBAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WBAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WBAKPR           Unit Price
     C                     Z-ADD*ZERO     WBALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WBAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WBAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WBA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WBB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WBA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WBNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WBNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WBNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WBNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WBNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WBBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WBBVTM           Price Code
     C                     Z-ADD*ZERO     WBBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WBBXTM           Substitution Li
     C                     Z-ADD*ZERO     WBBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WBH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WBH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WBH7NX           OD Item Target
     C                     Z-ADD*ZERO     WBH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WBH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WBDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WBDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WBDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WBDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WBDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WBGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WBGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WBGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WBPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WBRINY           Item Age Days
     C                     Z-ADD*ZERO     WBTIDT           Production Ovr
     C                     Z-ADD*ZERO     WBTJDT           Production Ovr
     C                     Z-ADD*ZERO     WBTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WBTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WBTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Item Code 5.0
     C                     Z-ADD*ZERO     WUH4NY  50
      * Define work field Text USR 5
     C                     MOVEL*BLANK    WUY7TX  5
      * Define work field Blank for 4           USR
     C                     MOVEL*BLANK    WUOTTX  4
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    FNAIC3           Company Number
     C                     MOVEL*LOVAL    FNC4NB           Order Number
     C                     MOVEL*LOVAL    FNDPNB           Order Sequence
     C                     MOVEL*LOVAL    FNUENB           Order Secondary
     C                     MOVEL*LOVAL    FNRZNB           Case Sequence N
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCI3NY           COA Batch Numbe
     C                     Z-ADD*ZERO     WCJYNY           COA Batch Heade
     C                     Z-ADD*ZERO     WCQ1NY           COA Batch Hdr R
     C                     Z-ADD*ZERO     WCJZNY           COA RIN SSSSSSS
     C                     Z-ADD*ZERO     WCJ0NY           COA RIN EEEEEEE
     C                     Z-ADD*ZERO     WCJ2NY           COA RIN Volume
     C                     Z-ADD*ZERO     WCRIDT           COA RIN Transac
     C                     Z-ADD*ZERO     WCC5TM           COA RIN Transac
     C                     Z-ADD*ZERO     WCRJDT           COA Retired RIN
     C                     Z-ADD*ZERO     WCC6TM           COA Retired RIN
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCRZNB           Case Sequence N
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCRKDT           COA Date of 1st
     C                     Z-ADD*ZERO     WCC7TM           COA RIN Unused
     C                     Z-ADD*ZERO     WCQWNY           COA RIN Gallons
     C                     Z-ADD*ZERO     WCCWC3           COA Shipping Co
     C                     Z-ADD*ZERO     WCQXNY           COA Ref Load Id
     C                     Z-ADD*ZERO     WCQZNY           COA Reference B
     C                     Z-ADD*ZERO     WCQ0NY           COA Reference B
     C                     Z-ADD*ZERO     WCTFDT           COA BHR Net Gal
     C                     Z-ADD*ZERO     WCTGDT           COA BHR Unused
     C                     Z-ADD*ZERO     WCQYNY           COA BHR Loadout
     C                     Z-ADD*ZERO     WCR8NY           COA Batch RIN V
     C                     Z-ADD*ZERO     WCR0NY           COA RIN Quantit
     C                     Z-ADD*ZERO     WCR7NY           COA BHR RIN Gen
     C                     Z-ADD*ZERO     WCHEPR           COA BHR RIN Pri
     C                     Z-ADD*ZERO     WCHFPR           COA BHR Gallon
     C                     Z-ADD*ZERO     WCR5NY           COA RIN Support
     C                     Z-ADD*ZERO     WCR6NY           COA RIN Support
     C                     Z-ADD*ZERO     WCTWDT           COA GEN EMTS Da
     C                     Z-ADD*ZERO     WCDUTM           COA GEN EMTS Ti
     C                     Z-ADD*ZERO     WCTVDT           COA RIN EMTS Da
     C                     Z-ADD*ZERO     WCDTTM           COA RIN EMTS Ti
     C                     Z-ADD*ZERO     WCR9NY           COA EMTS PTD Nb
     C                     Z-ADD*ZERO     WCSQNY           COA EMTS Batch
     C                     Z-ADD*ZERO     WCSRNY           COA BHR Unused
     C                     Z-ADD*ZERO     WCT2DT           COA BHR Unused
     C                     Z-ADD*ZERO     WCSXNY           COA BHR Equiv V
     C                     Z-ADD*ZERO     WCSYNY           COA BHR RINs to
     C                     Z-ADD*ZERO     WCSZNY           COA Unassgnd Tx
     C                     Z-ADD*ZERO     WCMJDT           Create Date
     C                     Z-ADD*ZERO     WCBETM           Create Time
     C                     Z-ADD*ZERO     WCMKDT           Change Date
     C                     Z-ADD*ZERO     WCBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WDA0DT           Order Date
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDACDT           Cancel Date
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WDA1WG           Order Weight To
     C                     Z-ADD*ZERO     WDEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WDAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WDATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WDRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WDT3NB           Attach to Order
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
     C                     Z-ADD*ZERO     WDAWDT           Invoice Date
     C                     Z-ADD*ZERO     WDVRVA           A/R order Value
     C                     Z-ADD*ZERO     WDB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WDNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WDNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WDNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WDNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WDNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WDBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WDBQTM           Time of Origina
     C                     Z-ADD*ZERO     WDBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WDBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WDBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WDH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WDH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WDH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WDH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WDH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WDC0C7           Claim Number
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    DACWC3           COA Shipping Co
     C                     MOVEL*LOVAL    DAR9NY           COA EMTS PTD Nb
     C                     MOVEL*LOVAL    DASQNY           COA EMTS Batch
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SORVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     Z-ADD*ZERO     WL0002  30
      * Define local variables for subroutine SPRVGN.
     C                     Z-ADD*ZERO     WL0003  30
     C                     MOVEL*BLANK    WL0004  6
     C                     MOVEL*BLANK    WL0005 30
     C                     MOVEL*BLANK    WL0006 25
     C                     MOVEL*BLANK    WL0007 20
     C                     MOVEL*BLANK    WL0008 40
     C                     MOVEL*BLANK    WL0009 40
     C                     MOVEL*BLANK    WL0010  4
     C                     MOVEL*BLANK    WL0011  5
     C                     MOVEL*BLANK    WL0012  2
     C                     MOVEL*BLANK    WL0013  1
     C                     MOVEL*BLANK    WL0014  1
     C                     Z-ADD*ZERO     WL0015  75
     C                     Z-ADD*ZERO     WL0016  75
     C                     Z-ADD*ZERO     WL0017  30
     C                     Z-ADD*ZERO     WL0018  30
     C                     Z-ADD*ZERO     WL0019  41
     C                     MOVEL*BLANK    WL0020 30
     C                     MOVEL*BLANK    WL0021  3
     C                     MOVEL*BLANK    WL0022  3
     C                     MOVEL*BLANK    WL0023  3
     C                     MOVEL*BLANK    WL0024  3
     C                     MOVEL*BLANK    WL0025  3
     C                     MOVEL*BLANK    WL0026  3
     C                     Z-ADD*ZERO     WL0027 118
     C                     MOVEL*BLANK    WL0028  1
     C                     Z-ADD*ZERO     WL0029 118
     C                     MOVEL*BLANK    WL0030  1
     C                     MOVEL*BLANK    WL0031  3
     C                     MOVEL*BLANK    WL0032  3
     C                     MOVEL*BLANK    WL0033  6
     C                     MOVEL*BLANK    WL0034 15
     C                     MOVEL*BLANK    WL0035  1
      * Define local variables for subroutine STRVGN.
     C                     Z-ADD*ZERO     WL0036  30
     C                     Z-ADD*ZERO     WL0037  70
     C                     MOVEL*BLANK    WL0038 20
     C                     MOVEL*BLANK    WL0039  4
     C                     MOVEL*BLANK    WL0040  5
      * Define local variables for subroutine SURVGN.
     C                     MOVEL*BLANK    WL0041  2
     C                     MOVEL*BLANK    WL0042 30
     C                     MOVEL*BLANK    WL0043 30
     C                     MOVEL*BLANK    WL0044 30
     C                     MOVEL*BLANK    WL0045 30
     C                     MOVEL*BLANK    WL0046 20
     C                     MOVEL*BLANK    WL0047  2
     C                     MOVEL*BLANK    WL0048 11
     C                     MOVEL*BLANK    WL0049  4
     C                     MOVEL*BLANK    WL0050  5
     C                     MOVEL*BLANK    WL0051 20
      * Define local variables for subroutine SWRVGN.
     C                     Z-ADD*ZERO     WL0052  30
     C                     Z-ADD*ZERO     WL0053  70
     C                     MOVEL*BLANK    WL0054  2
     C                     MOVEL*BLANK    WL0055  3
     C                     MOVEL*BLANK    WL0056  3
      * Define local variables for subroutine TBRVGN.
     C                     MOVEL*BLANK    WL0057  3
     C                     MOVEL*BLANK    WL0058  3
     C                     MOVEL*BLANK    WL0059 30
      * Define local variables for subroutine TCRVGN.
     C                     MOVEL*BLANK    WL0060 15
     C                     Z-ADD*ZERO     WL0061  70
      * Define local work field Manifest Dtl Record Count
     C                     Z-ADD*ZERO     YL0001  50
      * Define local work field Page Nbr - Total (2.0)USR
     C                     Z-ADD*ZERO     YL0002  20
      * Define local work field USR Counter
     C                     Z-ADD*ZERO     YL0003  50
      * Define local work field Page Overflow
     C                     Z-ADD*ZERO     YL0004  30
      * Define local work field USR Count
     C                     Z-ADD*ZERO     YL0005  30
      * Define local work field USR Page Number 3.0
     C                     Z-ADD*ZERO     YL0006  30
      * Define local work field Remaining Bal 8.2 USR
     C                     Z-ADD*ZERO     YL0007  82
      * Define local work field USR Count
     C                     Z-ADD*ZERO     YL0008  30
      * Define local work field USR Page Number 3.0
     C                     Z-ADD*ZERO     YL0009  30
      * Define local work field Remaining Bal 8.2 USR
     C                     Z-ADD*ZERO     YL0010  82
      * Define local work field Trailer Id
     C                     MOVEL*BLANK    YL0011 20
      * Define local work field Product Temperature
     C                     Z-ADD*ZERO     YL0012  52
      * Define null work field Actual Ship Date
     C                     Z-ADD*ZERO     YN0001  70
      * Define local work field COA Temperature Loadout
     C                     Z-ADD*ZERO     YL0013  30
      * Define null work field Order Type - Sales
     C                     MOVEL*BLANK    YN0002  2
      * Define null work field A/R Customer Number
     C                     Z-ADD*ZERO     YN0003  70
      * Define local work field Ship To Name
     C                     MOVEL*BLANK    YL0014 30
      * Define local work field Ship To Address Line 1
     C                     MOVEL*BLANK    YL0015 30
      * Define local work field Ship To Address Line 2
     C                     MOVEL*BLANK    YL0016 30
      * Define local work field Ship To Address Line 3
     C                     MOVEL*BLANK    YL0017 30
      * Define local work field Ship To City
     C                     MOVEL*BLANK    YL0018 20
      * Define local work field Ship To State Code
     C                     MOVEL*BLANK    YL0019  2
      * Define local work field Ship To Zip/Postal Code
     C                     MOVEL*BLANK    YL0020 11
      * Define local work field Bill to Customer
     C                     Z-ADD*ZERO     YL0021  70
      * Define local work field Bill to Name
     C                     MOVEL*BLANK    YL0022 30
      * Define local work field Bill to Address Line 1
     C                     MOVEL*BLANK    YL0023 30
      * Define local work field Bill to Address Line 2
     C                     MOVEL*BLANK    YL0024 30
      * Define local work field Bill to Address Line 3
     C                     MOVEL*BLANK    YL0025 30
      * Define local work field Bill to City
     C                     MOVEL*BLANK    YL0026 20
      * Define local work field Bill to State Code
     C                     MOVEL*BLANK    YL0027  2
      * Define local work field Bill to Zip/Postal Code
     C                     MOVEL*BLANK    YL0028 11
      * Define null work field Order Date
     C                     Z-ADD*ZERO     YN0004  70
      * Define null work field Requested Ship Date
     C                     Z-ADD*ZERO     YN0005  70
      * Define null work field Cancel Date
     C                     Z-ADD*ZERO     YN0006  70
      * Define local work field Terms Code
     C                     MOVEL*BLANK    YL0029  2
      * Define null work field Special Instructions
     C                     MOVEL*BLANK    YN0007 40
      * Define null work field Special Instructions 2
     C                     MOVEL*BLANK    YN0008 40
      * Define null work field Carrier Code
     C                     MOVEL*BLANK    YN0009  3
      * Define null work field Comment Print Acknowledge
     C                     MOVEL*BLANK    YN0010  1
      * Define null work field Comment Print Inv/Cr.Memo
     C                     MOVEL*BLANK    YN0011  1
      * Define null work field Comment Print Pick Slip
     C                     MOVEL*BLANK    YN0012  1
      * Define null work field Comment Print Ship Doc
     C                     MOVEL*BLANK    YN0013  1
      * Define null work field Reason Code
     C                     MOVEL*BLANK    YN0014  3
      * Define null work field Order in Use
     C                     MOVEL*BLANK    YN0015  1
      * Define null work field Header Status
     C                     MOVEL*BLANK    YN0016  1
      * Define null work field Header Status Last
     C                     MOVEL*BLANK    YN0017  1
      * Define null work field Order Type Print Status
     C                     MOVEL*BLANK    YN0018  1
      * Define null work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YN0019  70
      * Define null work field User Original Entry
     C                     MOVEL*BLANK    YN0020 10
      * Define null work field Date of Original Entry
     C                     Z-ADD*ZERO     YN0021  70
      * Define null work field Order Value Total
     C                     Z-ADD*ZERO     YN0022 112
      * Define null work field Order Weight Total
     C                     Z-ADD*ZERO     YN0023 112
      * Define null work field Credit Hold
     C                     MOVEL*BLANK    YN0024  1
      * Define null work field Production Hold
     C                     MOVEL*BLANK    YN0025  1
      * Define null work field New Customer Hold
     C                     MOVEL*BLANK    YN0026  1
      * Define null work field Requested Delivery Date
     C                     Z-ADD*ZERO     YN0027  70
      * Define null work field Requested Delivery Time
     C                     Z-ADD*ZERO     YN0028  40
      * Define null work field Accounts Receiv. Ent 1
     C                     MOVEL*BLANK    YN0029  4
      * Define null work field Accounts Receiv. Ent 2
     C                     MOVEL*BLANK    YN0030 12
      * Define null work field Load ID
     C                     Z-ADD*ZERO     YN0031  70
      * Define null work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YN0032  52
      * Define null work field Rated Freight
     C                     Z-ADD*ZERO     YN0033 112
      * Define null work field LTL Flag
     C                     MOVEL*BLANK    YN0034  1
      * Define null work field Price Audit
     C                     MOVEL*BLANK    YN0035  1
      * Define null work field Price Status
     C                     MOVEL*BLANK    YN0036  1
      * Define null work field Shipping Method
     C                     MOVEL*BLANK    YN0037  2
      * Define null work field Export Status
     C                     MOVEL*BLANK    YN0038  1
      * Define null work field Palletize
     C                     MOVEL*BLANK    YN0039  1
      * Define null work field Shrink Wrap
     C                     MOVEL*BLANK    YN0040  1
      * Define null work field Slip Sheet
     C                     MOVEL*BLANK    YN0041  1
      * Define null work field Age Code
     C                     MOVEL*BLANK    YN0042  1
      * Define null work field Reefer Temperature
     C                     Z-ADD*ZERO     YN0043  52
      * Define null work field Load Type
     C                     MOVEL*BLANK    YN0044  1
      * Define null work field Attach to Invoice Number
     C                     Z-ADD*ZERO     YN0045  70
      * Define null work field Load Plan Order
     C                     MOVEL*BLANK    YN0046  1
      * Define null work field Print Pick Slip
     C                     MOVEL*BLANK    YN0047  1
      * Define null work field Resell Reference Number
     C                     Z-ADD*ZERO     YN0048  70
      * Define null work field Special Comment 1
     C                     MOVEL*BLANK    YN0049 30
      * Define null work field Special Comment 2
     C                     MOVEL*BLANK    YN0050 30
      * Define null work field Affect Auto Accruals
     C                     MOVEL*BLANK    YN0051  1
      * Define null work field Sales Route Code
     C                     MOVEL*BLANK    YN0052  3
      * Define null work field Manager Level Code
     C                     MOVEL*BLANK    YN0053  2
      * Define null work field VP Level Code
     C                     MOVEL*BLANK    YN0054  3
      * Define null work field Attach to Order Number
     C                     Z-ADD*ZERO     YN0055  70
      * Define null work field Reason for Price Audit
     C                     MOVEL*BLANK    YN0056  3
      * Define null work field Invoice Number
     C                     Z-ADD*ZERO     YN0057  70
      * Define null work field Invoice Suffix
     C                     MOVEL*BLANK    YN0058  2
      * Define null work field Event Code
     C                     MOVEL*BLANK    YN0059  2
      * Define null work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    YN0060  1
      * Define null work field Modified Flag
     C                     MOVEL*BLANK    YN0061  1
      * Define null work field A/R order Value Total
     C                     Z-ADD*ZERO     YN0062 112
      * Define null work field Billing Activity Type
     C                     MOVEL*BLANK    YN0063  1
      * Define null work field Block Order Flag
     C                     MOVEL*BLANK    YN0064  1
      * Define null work field Order Certification Flag
     C                     MOVEL*BLANK    YN0065  1
      * Define null work field Invoice Order Value Tot
     C                     Z-ADD*ZERO     YN0066 112
      * Define null work field Process Sts for 3C
     C                     MOVEL*BLANK    YN0067  1
      * Define null work field Order Conf Fax Sts
     C                     MOVEL*BLANK    YN0068  1
      * Define null work field Manifest Fax Sts
     C                     MOVEL*BLANK    YN0069  1
      * Define null work field Invoice Fax Sts
     C                     MOVEL*BLANK    YN0070  1
      * Define null work field Transfer in Storage Ind
     C                     MOVEL*BLANK    YN0071  1
      * Define null work field Email Cust On Order Ship
     C                     MOVEL*BLANK    YN0072  1
      * Define null work field Order Emailed
     C                     MOVEL*BLANK    YN0073  1
      * Define null work field Export Docs Go w/Driver
     C                     MOVEL*BLANK    YN0074  1
      * Define null work field Shipping Temp Code C/F
     C                     MOVEL*BLANK    YN0075  1
      * Define null work field Broker Order Status
     C                     MOVEL*BLANK    YN0076  1
      * Define null work field Air Freight Order
     C                     MOVEL*BLANK    YN0077  1
      * Define null work field Order Requires Review
     C                     MOVEL*BLANK    YN0078  2
      * Define null work field OH Load Plan Ready
     C                     MOVEL*BLANK    YN0079  2
      * Define null work field Export USDA Approved
     C                     MOVEL*BLANK    YN0080  2
      * Define null work field HPB Ship to Warehouse
     C                     MOVEL*BLANK    YN0081  3
      * Define null work field OH TF Exempt Code
     C                     MOVEL*BLANK    YN0082  3
      * Define null work field OH Appt Confirmation Dt
     C                     Z-ADD*ZERO     YN0083  70
      * Define null work field JPN Invoice Issuance Date
     C                     Z-ADD*ZERO     YN0084  70
      * Define null work field Load Actual Shipped Date
     C                     Z-ADD*ZERO     YN0085  70
      * Define null work field Load BOL Complete Date
     C                     Z-ADD*ZERO     YN0086  70
      * Define null work field Load Truck Departure Date
     C                     Z-ADD*ZERO     YN0087  70
      * Define null work field Maximum Gross Weight
     C                     Z-ADD*ZERO     YN0088  60
      * Define null work field Time of Original Entry
     C                     Z-ADD*ZERO     YN0089  60
      * Define null work field OH Appt Confirmation Tm
     C                     Z-ADD*ZERO     YN0090  60
      * Define null work field Load BOL Complete Time
     C                     Z-ADD*ZERO     YN0091  60
      * Define null work field Load Truck Departure Time
     C                     Z-ADD*ZERO     YN0092  60
      * Define null work field Act Frt Reference Amount
     C                     Z-ADD*ZERO     YN0093 112
      * Define null work field Act Non-Ref Frt Amount
     C                     Z-ADD*ZERO     YN0094 112
      * Define null work field OH Fuel Surcharge Amount
     C                     Z-ADD*ZERO     YN0095 112
      * Define null work field OH Total Non-Ref Frt Amt
     C                     Z-ADD*ZERO     YN0096 112
      * Define null work field OH Total Ref Frt Amt
     C                     Z-ADD*ZERO     YN0097 112
      * Define null work field Claim Number
     C                     Z-ADD*ZERO     YN0098  70
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0099  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0100  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0101  1
      * Define null work field Job Time
     C                     Z-ADD*ZERO     YN0102  60
      * Define null work field User Id
     C                     MOVEL*BLANK    YN0103 10
      * Define null work field Job Name
     C                     MOVEL*BLANK    YN0104 10
      * Define null work field Job Date
     C                     Z-ADD*ZERO     YN0105  70
      * Define local work field Customer Purchase Order #
     C                     MOVEL*BLANK    YL0030 15
      * Define local work field HPB Ship to Warehouse
     C                     MOVEL*BLANK    YL0031  3
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0106  1
      * Define local work field OHE Override Type Code
     C                     MOVEL*BLANK    YL0032  2
      * Define local work field HPB COA Batch Number
     C                     Z-ADD*ZERO     YL0033  50
      * Define local work field Item Code
     C                     Z-ADD*ZERO     YL0034  70
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0035  3
      * Define local work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    YL0036  1
      * Define local work field COA OMS Item Code
     C                     MOVEL*BLANK    YL0037  6
      * Define local work field Production Warehouse Code
     C                     MOVEL*BLANK    YL0038  3
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0039  2
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0040  1
      * Define local work field WHS Req Meter Reading Shp
     C                     MOVEL*BLANK    YL0041  1
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0042  30
      * Define local work field COA Bio-diesel Fuel Code
     C                     MOVEL*BLANK    YL0043  6
      * Define local work field COA Bio-dsl Fuel Cd Descr
     C                     MOVEL*BLANK    YL0044 30
      * Define null work field COA Sold From Address
     C                     MOVEL*BLANK    YN0107 40
      * Define local work field COA Sold From Name
     C                     MOVEL*BLANK    YL0045 40
      * Define local work field COA RIN Equivalence Valu
     C                     MOVEL*BLANK    YL0046  2
      * Define local work field COA RIN Renewable Enrgy
     C                     MOVEL*BLANK    YL0047  1
      * Define local work field COA RIN Type Flag
     C                     MOVEL*BLANK    YL0048  1
      * Define null work field COA Density Loadout
     C                     Z-ADD*ZERO     YN0108  75
      * Define null work field COA Density Reference
     C                     Z-ADD*ZERO     YN0109  75
      * Define null work field COA Temperature Loadout
     C                     Z-ADD*ZERO     YN0110  30
      * Define local work field COA Temperature Ref
     C                     Z-ADD*ZERO     YL0049  30
      * Define local work field COA BOL Percent
     C                     Z-ADD*ZERO     YL0050  41
      * Define null work field COA Sale Location
     C                     MOVEL*BLANK    YN0111 30
      * Define null work field COA Active Whse/Tank 1
     C                     MOVEL*BLANK    YN0112  3
      * Define null work field COA Active Whse/Tank 2
     C                     MOVEL*BLANK    YN0113  3
      * Define null work field COA Active Whse/Tank 3
     C                     MOVEL*BLANK    YN0114  3
      * Define null work field COA Active Whse/Tank 4
     C                     MOVEL*BLANK    YN0115  3
      * Define null work field COA Active Whse/Tank 5
     C                     MOVEL*BLANK    YN0116  3
      * Define null work field COA Active Whse/Tank 6
     C                     MOVEL*BLANK    YN0117  3
      * Define local work field COA Temp Conv Factor 1
     C                     Z-ADD*ZERO     YL0051 118
      * Define local work field Operation Factor 1
     C                     MOVEL*BLANK    YL0052  1
      * Define local work field COA Temp Conv Factor 2
     C                     Z-ADD*ZERO     YL0053 118
      * Define local work field Operation Factor 2
     C                     MOVEL*BLANK    YL0054  1
      * Define null work field COA RFS Renew Fuel Code
     C                     MOVEL*BLANK    YN0118  3
      * Define null work field COA RFS Rnwbl Feedstock
     C                     MOVEL*BLANK    YN0119  3
      * Define local work field COA Fuel Desc2/Prop Value
     C                     MOVEL*BLANK    YL0055 15
      * Define null work field Name
     C                     MOVEL*BLANK    YN0120 30
      * Define local work field Address Line 2
     C                     MOVEL*BLANK    YL0056 30
      * Define local work field Address Line 3
     C                     MOVEL*BLANK    YL0057 30
      * Define local work field City
     C                     MOVEL*BLANK    YL0058 20
      * Define local work field Zip Postal Code
     C                     MOVEL*BLANK    YL0059 11
      * Define local work field Telephone Number FF
     C                     MOVEL*BLANK    YL0060 25
      * Define local work field Fax Number FF
     C                     MOVEL*BLANK    YL0061 25
      * Define local work field State Code
     C                     MOVEL*BLANK    YL0062  2
      * Define local work field USR Compressed Address 2
     C                     MOVEL*BLANK    YL0063 34
      * Define local work field A/R Customer Number
     C                     Z-ADD*ZERO     YL0064  70
      * Define local work field HPB Employer ID #
     C                     MOVEL*BLANK    YL0065 20
      * Define local work field HPB ULSD Company #
     C                     MOVEL*BLANK    YL0066  4
      * Define local work field HPB ULSD Facility ID
     C                     MOVEL*BLANK    YL0067  5
      * Define local work field Address 2
     C                     MOVEL*BLANK    YL0068 40
      * Define local work field Address 3
     C                     MOVEL*BLANK    YL0069 40
      * Define null work field COA ULSD Company #
     C                     MOVEL*BLANK    YN0121  4
      * Define null work field COA ULSD Facility #
     C                     MOVEL*BLANK    YN0122  5
      * Define null work field COA Employer ID
     C                     MOVEL*BLANK    YN0123 20
      * Define null work field Address Line 1
     C                     MOVEL*BLANK    YN0124 30
      * Define null work field Address Line 2
     C                     MOVEL*BLANK    YN0125 30
      * Define null work field Address Line 3
     C                     MOVEL*BLANK    YN0126 30
      * Define local work field Address 1
     C                     MOVEL*BLANK    YL0070 40
      * Define local work field Type Code
     C                     MOVEL*BLANK    YL0071  2
      * Define null work field Customer Group Code
     C                     MOVEL*BLANK    YN0127  3
      * Define null work field Customer Group Code 2
     C                     MOVEL*BLANK    YN0128  3
      * Define local work field Count USR
     C                     Z-ADD*ZERO     YL0072  50
      * Define local work field COA ULSD Company #
     C                     MOVEL*BLANK    YL0073  4
      * Define local work field COA Density Loadout
     C                     Z-ADD*ZERO     YL0074  75
      * Define local work field COA Density Reference
     C                     Z-ADD*ZERO     YL0075  75
      * Define local work field Page Nbr - of (2.0)   USR
     C                     Z-ADD*ZERO     YL0076  20
      * Define local work field Count Records         USR
     C                     Z-ADD*ZERO     YL0077 110
      * Define local work field Text Usr 50
     C                     MOVEL*BLANK    YL0078 50
      * Define local work field text usr 75
     C                     MOVEL*BLANK    YL0079 75
      * Define local work field Text 93 USR
     C                     MOVEL*BLANK    YL0080 93
      * Define local work field USR Count
     C                     Z-ADD*ZERO     YL0081  30
      * Define local work field Page Nbr - of (2.0)   USR
     C                     Z-ADD*ZERO     YL0082  20
      * Define local work field Print (Yes/No) USR
     C                     MOVEL*BLANK    YL0083  1
      * Define local work field COA OMS Item Code
     C                     MOVEL*BLANK    YL0084  6
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0085  2
      * Define local work field COA RIN Transaction Date
     C                     Z-ADD*ZERO     YL0086  70
      * Define local work field Load ID
     C                     Z-ADD*ZERO     YL0087  70
      * Define local work field COA RIN Type Flag
     C                     MOVEL*BLANK    YL0088  1
      * Define local work field COA Ref Load Id
     C                     Z-ADD*ZERO     YL0089  70
      * Define local work field RFS Transaction Type
     C                     MOVEL*BLANK    YL0090  3
      * Define local work field COA RIN Supporting Nbr 1
     C                     Z-ADD*ZERO     YL0091  70
      * Define local work field COA BHR RFS Version Nbr
     C                     MOVEL*BLANK    YL0092  1
      * Define local work field COA EMTS Batch Nbr
     C                     Z-ADD*ZERO     YL0093  80
      * Define local work field Customer Purchase Order #
     C                     MOVEL*BLANK    YL0094 15
      * Define local work field OHE HPB RIN Equiv Value
     C                     Z-ADD*ZERO     YL0095 112
      * Define local work field OHE HPB RIN Price
     C                     Z-ADD*ZERO     YL0096 112
      * Define local work field OHE Override Type Code
     C                     MOVEL*BLANK    YL0097  2
      * Define local work field Print Blank Line Usr
     C                     MOVEL*BLANK    YL0098  1
      * Define local work field USR Counter
     C                     Z-ADD*ZERO     YL0099  50
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * Calculate the number of pages the report will need.
     C                     Z-ADD*ZERO     YL0001           Manifest Dtl Re
      * RTV calc BOL pages req RT - Load Detail  * 
     C                     EXSR SARVGN
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Ship Dt:
00002 Trans Dt:
00003 Phone:
00004 Employer ID#:
00005 EPA RFS Company ID #:
00006 EPA RFS Facility ID #:
00007 This volume of fuel must
00008 be used in the designated
00009  form, without further bl
00010 ending.
00011 This volume of renewable
00012 fuel may not be used as a
00013 motor vehicle fuel.
00014 Reason:
00015 Ref PO:
00016 No assigned RINs transfer
00017 Volume:
00018 Batch:
