     H/TITLE Crt Exp Doc Ord Dtl PRTXF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSPATI
     H* Date          : 06/25/24  Time  : 00:53:32
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPUCFCPL1IF  E           K        DISK
      * RTV : Export Doc Order Dtl PRT  Retrieval index
      *
     FPDMSREL5IF  E           K        DISK
      * RSQ : Export Doc Order Dtl      Co/Ord/Doc/Country/Item
      *
     FPUCFCPL3IF  E           K        DISK
      * RSQ : Export Doc Order Dtl PRT  Co/Ord/Type/Cntry/Item(D
      *
     FPUCFCPL0UF  E           K        DISK                      A
      * UPD : Export Doc Order Dtl PRT  Update index
      *
      * Long constants
     E                    @CN#    1  05  6   @CN    25
     I@CFCPJV
      * Export Doc Order Dtl PRT  Retrieval index
      * Renamed input format fields
     I              CFAIC3                          WAAIC3
     I              CFC4NB                          WAC4NB
     I              CFDGSX                          WADGSX
     I              CFKXCD                          WAKXCD
     I              CFHGCD                          WAHGCD
     I              CFRDU1                          WARDU1
     I              CFREU1                          WAREU1
     I              CFRFU1                          WARFU1
     I              CFMYSC                          WAMYSC
     I              CFG2NZ                          WAG2NZ
     I              CFM9SC                          WAM9SC
     I              CFNASC                          WANASC
     I              CFM4SC                          WAM4SC
     I              CFMZSC                          WAMZSC
     I              CFM5SC                          WAM5SC
     I              CFG7NZ                          WAG7NZ
     I              CFG8NZ                          WAG8NZ
     I              CFG9NZ                          WAG9NZ
     I              CFHANZ                          WAHANZ
     I              CFM6SC                          WAM6SC
     I              CFM7SC                          WAM7SC
     I              CFG3NZ                          WAG3NZ
     I              CFXSDT                          WAXSDT
     I              CFRLU1                          WARLU1
     I              CFRMU1                          WARMU1
      *
     I@CFCPJU
      * Export Doc Order Dtl PRT  Update index
      * Renamed input format fields
     I              CFAIC3                          WBAIC3
     I              CFC4NB                          WBC4NB
     I              CFDGSX                          WBDGSX
     I              CFKXCD                          WBKXCD
     I              CFHGCD                          WBHGCD
     I              CFRDU1                          WBRDU1
     I              CFREU1                          WBREU1
     I              CFRFU1                          WBRFU1
     I              CFMYSC                          WBMYSC
     I              CFG2NZ                          WBG2NZ
     I              CFM9SC                          WBM9SC
     I              CFNASC                          WBNASC
     I              CFM4SC                          WBM4SC
     I              CFMZSC                          WBMZSC
     I              CFM5SC                          WBM5SC
     I              CFG7NZ                          WBG7NZ
     I              CFG8NZ                          WBG8NZ
     I              CFG9NZ                          WBG9NZ
     I              CFHANZ                          WBHANZ
     I              CFM6SC                          WBM6SC
     I              CFM7SC                          WBM7SC
     I              CFG3NZ                          WBG3NZ
     I              CFXSDT                          WBXSDT
     I              CFRLU1                          WBRLU1
     I              CFRMU1                          WBRMU1
      *
     I@MSREEM
      * Export Doc Order Dtl      Co/Ord/Doc/Country/Item
      * Renamed input format fields
     I              MSAIC3                          WCAIC3
     I              MSC4NB                          WCC4NB
     I              MSDGSX                          WCDGSX
     I              MSKXCD                          WCKXCD
     I              MSDPNB                          WCDPNB
     I              MSUENB                          WCUENB
     I              MSDIC7                          WCDIC7
     I              MSO3NA                          WCO3NA
     I              MSO4NA                          WCO4NA
     I              MSRMTX                          WCRMTX
     I              MSPTTX                          WCPTTX
     I              MSHJWG                          WCHJWG
     I              MSHKWG                          WCHKWG
     I              MSRNTX                          WCRNTX
     I              MSAONX                          WCAONX
     I              MSROTX                          WCROTX
     I              MSORNA                          WCORNA
     I              MSAMNX                          WCAMNX
     I              MSANNX                          WCANNX
     I              MSAPNX                          WCAPNX
     I              MSDKPR                          WCDKPR
     I              MSA9VL                          WCA9VL
     I              MSC8SX                          WCC8SX
     I              MSRATX                          WCRATX
     I              MSRBTX                          WCRBTX
     I              MSAJNX                          WCAJNX
     I              MSZWTX                          WCZWTX
     I              MSZXTX                          WCZXTX
     I              MSZYTX                          WCZYTX
     I              MSZZTX                          WCZZTX
     I              MSK0U1                          WCK0U1
     I              MSK1U1                          WCK1U1
     I              MSIJSC                          WCIJSC
     I              MSIKSC                          WCIKSC
     I              MSK2U1                          WCK2U1
     I              MSW0DT                          WCW0DT
     I              MSUVST                          WCUVST
     I              MSUWST                          WCUWST
     I              MSUXST                          WCUXST
     I              MSVSST                          WCVSST
     I              MSAATM                          WCAATM
     I              MSAYNA                          WCAYNA
     I              MSA0NA                          WCA0NA
     I              MSAXDT                          WCAXDT
      *
     I@CFCPJ0
      * Export Doc Order Dtl PRT  Co/Ord/Type/Cntry/Item(D
      * Renamed input format fields
     I              CFAIC3                          WDAIC3
     I              CFC4NB                          WDC4NB
     I              CFDGSX                          WDDGSX
     I              CFKXCD                          WDKXCD
     I              CFHGCD                          WDHGCD
     I              CFRDU1                          WDRDU1
     I              CFREU1                          WDREU1
     I              CFRFU1                          WDRFU1
     I              CFMYSC                          WDMYSC
     I              CFG2NZ                          WDG2NZ
     I              CFM9SC                          WDM9SC
     I              CFNASC                          WDNASC
     I              CFM4SC                          WDM4SC
     I              CFMZSC                          WDMZSC
     I              CFM5SC                          WDM5SC
     I              CFG7NZ                          WDG7NZ
     I              CFG8NZ                          WDG8NZ
     I              CFG9NZ                          WDG9NZ
     I              CFHANZ                          WDHANZ
     I              CFM6SC                          WDM6SC
     I              CFM7SC                          WDM7SC
     I              CFG3NZ                          WDG3NZ
     I              CFXSDT                          WDXSDT
     I              CFRLU1                          WDRLU1
     I              CFRMU1                          WDRMU1
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPUCF1    E DSPUCFCPL0
      * UPD : Export Doc Order Dtl PRT  Update index
      * Renamed input format fields
     I              CFAIC3                          WBAIC3
     I              CFC4NB                          WBC4NB
     I              CFDGSX                          WBDGSX
     I              CFKXCD                          WBKXCD
     I              CFHGCD                          WBHGCD
     I              CFRDU1                          WBRDU1
     I              CFREU1                          WBREU1
     I              CFRFU1                          WBRFU1
     I              CFMYSC                          WBMYSC
     I              CFG2NZ                          WBG2NZ
     I              CFM9SC                          WBM9SC
     I              CFNASC                          WBNASC
     I              CFM4SC                          WBM4SC
     I              CFMZSC                          WBMZSC
     I              CFM5SC                          WBM5SC
     I              CFG7NZ                          WBG7NZ
     I              CFG8NZ                          WBG8NZ
     I              CFG9NZ                          WBG9NZ
     I              CFHANZ                          WBHANZ
     I              CFM6SC                          WBM6SC
     I              CFM7SC                          WBM7SC
     I              CFG3NZ                          WBG3NZ
     I              CFXSDT                          WBXSDT
     I              CFRLU1                          WBRLU1
     I              CFRMU1                          WBRMU1
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPARC        DS                             19
      * KEY : Export Doc Order Dtl      Co/Ord/Doc/Country/Item
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  ED Export Document Type
     I                                        7   7 PADGSX
      * I :  Country Code
     I                                        8  13 PAKXCD
      * I :  ED Item Code
     I                                    P  14  170PADIC7
      * I :  Order Sequence Number
     I                                    P  18  190PADPNB
      *
     IYARDCS      DS                            250
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Export Doc Order Dtl
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Order Number
     I                                    P   3   60P1C4NB
      * I :  ED Export Document Type
     I                                        7   7 P1DGSX
      * I :  Country Code
     I                                        8  13 P1KXCD
     IP2PARM      DS
      * FLD: Export Doc Order Hdr
      * I :  ED Xlate Desc to Country
     I                                        1   1 P2CVSX
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1DGSX    PARM           WP0003  1        ED Export Docum
     C           P1KXCD    PARM           WP0004  6        Country Code
     C           P2CVSX    PARM           WP0005  1        ED Xlate Desc t
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Crt Exp Doc Ord Dtl PRTXF
      * NOTE: Consider changing PUWTXFR if changing the # of lines to pri
      *       on the HC.
      * Delete Existing Records.
      * Del Exp Doc Ord Dtl PRTRT - Export Doc Order Dtl PRT  * 
     C                     EXSR SARVGN
      * Create New Records for Other Specific Export Doc Types.
      * CASE: *OTHERWISE
      * Anything Identify in here should Process & then QUIT. Don't fall
      * through.
      * Chile Letterhead.
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Country Code is Chile - ISO 3
      *   |- c2    : PAR.ED Export Document Type is Letterhead-Pork to Ex
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1KXCD    IFEQ 'CHL'                      *IF
     C           P1DGSX    IFEQ 'L'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Crt EDOD PRT-CHL Ltrhd RT - Export Doc Order Dtl  * 
     C                     EXSR SCRVGN
     C                     GOTO AAEXIT                     *QUIT
     C                     END                             *FI
      * Create New Records for Health Certificate.
      * CASE:
      *  - NOTc1
      *   |- c1    : PAR.ED Export Document Type is Application for Expor
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1DGSX    IFEQ 'A'                        *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Crt EDOD PRT-HC       RT - Export Doc Order Dtl  * 
     C                     EXSR SHRVGN
     C                     END                             *FI
      * Create New Records for Application Export Doc.
      * CASE: PAR.ED Export Document Type is Application for Export
     C           P1DGSX    IFEQ 'A'                        *IF
      * Crt EDOD PRT-Appl Exp RT - Export Doc Order Dtl  * 
     C                     EXSR SJRVGN
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Del Exp Doc Ord Dtl PRTRT - Export Doc Order Dtl PRT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSA02           Order Number
     C           *LIKE     DEFN WADGSX    WQSA03           ED Export Docum
     C           *LIKE     DEFN WAKXCD    WQSA04           Country Code
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Order Number
     C                     KFLD           WQSA03           ED Export Docum
     C                     KFLD           WQSA04           Country Code
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
     C                     Z-ADDP1C4NB    WQSA02           Order Number
     C                     MOVELP1DGSX    WQSA03           ED Export Docum
     C                     MOVELP1KXCD    WQSA04           Country Code
      * Establish starting position
     C           KRSSA     SETLL@CFCPJV                    *
     C           KRSSA     READE@CFCPJV                  90*
      * Data record not found
     C   90                MOVEL'USR5245' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Exp Doc Dtl Xlate DL - Exp Doc Order Dtl Xlate  * 
     C                     EXSR SBDLRC
     C           KRSSA     READE@CFCPJV                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBDLRC    BEGSR
      *================================================================
      * Del Exp Doc Dtl Xlate DL - Exp Doc Order Dtl Xlate  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @CFCPJU
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     Z-ADDWAC4NB    WBC4NB           Order Number
     C                     MOVELWADGSX    WBDGSX           ED Export Docum
     C                     MOVELWAKXCD    WBKXCD           Country Code
     C                     Z-ADDWAHGCD    WBHGCD           Item Code
      *
     C           KLDLSB    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
     C                     KFLD           WBDGSX           ED Export Docum
     C                     KFLD           WBKXCD           Country Code
     C                     KFLD           WBHGCD           Item Code
     C           KLDLSB    CHAIN@CFCPJU              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PUCFCPL0'MDACP
     C                     MOVEL'@CFCPJU' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@CFCPJU                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Crt EDOD PRT-CHL Ltrhd RT - Export Doc Order Dtl  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  30       # of Lines Reqd
     C                     MOVEL*BLANK    WN0002  1        Prt Overflow Ds
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0001           USR Counter
     C                     MOVEL'Y'       YL0002           First Time Flag
     C                     Z-ADD*ZERO     YL0003           1st Page Line C
     C                     MOVEL'N'       YL0004           Force Xlate Dsc
     C                     Z-ADD*ZERO     WN0001           # of Lines Reqd
     C                     MOVEL'N'       WN0002           Prt Overflow Ds
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSC02           Order Number
     C           *LIKE     DEFN WCDGSX    WQSC03           ED Export Docum
     C           *LIKE     DEFN WCKXCD    WQSC04           Country Code
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
     C                     KFLD           WQSC03           ED Export Docum
     C                     KFLD           WQSC04           Country Code
      * Setup key
     C                     Z-ADDP1AIC3    WQSC01           Company Number
     C                     Z-ADDP1C4NB    WQSC02           Order Number
     C                     MOVELP1DGSX    WQSC03           ED Export Docum
     C                     MOVELP1KXCD    WQSC04           Country Code
      * Establish starting position
     C           KRSSC     SETLL@MSREEM                    *
     C           KRSSC     READE@MSREEM                  90*
      * Data record not found
     C   90                MOVEL'USR2745' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Select Only Product with Weights.
      * CASE: DB1.ED Product Net Weight lbs is Entered
     C           WCHJWG    IFNE 0                          *IF
      * First Time Thru, Create Exp Doc Order Dtl PRT Record.
      * CASE: LCL.First Time Flag is Yes
     C           YL0002    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       YL0002           First Time Flag
     C                     Z-ADDWCDIC7    YL0005           ED Item Code
      * Determine '# of Lines Reqd to Print'.
      * CASE: *OTHERWISE
      * Initialize.
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0006           # of Lines Reqd
     C                     MOVEL'N'       YL0007           Skip Ln Before
     C                     MOVEL'N'       YL0008           Skip Ln After X
     C                     Z-ADD*ZERO     YL0009           # of Blank Line
     C                     Z-ADD*ZERO     YL0010           # of Blank Line
     C                     Z-ADD*ZERO     YL0011           # of Blank Line
     C                     Z-ADD*ZERO     YL0011           # of Blank Line
      * CASE: DB1.ED Item Label Line 1 is Entered
     C           WCO3NA    IFNE *BLANK                     *IF
     C                     ADD  2         YL0006           # of Lines Reqd
     C                     Z-ADD1         YL0009           # of Blank Line
     C                     END                             *FI
      * CASE: DB1.ED Item Label Line 2 is Entered
     C           WCO4NA    IFNE *BLANK                     *IF
     C                     ADD  2         YL0006           # of Lines Reqd
     C                     Z-ADD1         YL0010           # of Blank Line
     C                     END                             *FI
      * Country is Setup for Language Translation.
      * CASE:
      *  - NOTc1
      *   |- c1    : PAR.ED Xlate Desc to Country is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2CVSX    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DB1.ED Language Xlate Desc is Entered
     C           WCK1U1    IFNE *BLANK                     *IF
     C                     ADD  2         YL0006           # of Lines Reqd
     C                     Z-ADD1         YL0011           # of Blank Line
      * CASE: DB1.ED Item Label Line 2 is Not Entered
     C           WCO4NA    IFEQ *BLANK                     *IF
     C                     Z-ADD0         YL0011           # of Blank Line
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DB1.ED Language Xlate Desc 2 is Entered
     C           WCRBTX    IFNE *BLANK                     *IF
     C                     ADD  2         YL0006           # of Lines Reqd
     C                     Z-ADD1         YL0012           # of Blank Line
     C                     ELSE
      * CASE: *OTHERWISE
      * Check Spanish Translation to Set '# of Lines Reqd to Print'.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.ED Xlate Desc to Country is Spanish
      *   |- c2    : DB1.ED Language Xlate Desc is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2CVSX    IFEQ 'S'                        *IF
     C           WCK1U1    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    YL0013           Overflow Pg Dsc
     C                     MOVELWCK1U1    YL0013           Overflow Pg Dsc
     C                     MOVEL*BLANK    YL0014           Description Xla
     C                     MOVELWCRBTX    YL0014           Description Xla
     C                     MOVEL*BLANK    YL0015           Text USR 12
     C                     MOVEL*BLANK    YL0016           Frozen/Chilled
      * Xlate Frozen/Chilled - Xlate Line Desc 1.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.ED Chilled/Frozen Text is Frozen
      *   |- c2    : DB1.ED Chilled/Frozen Text is FROZEN All Caps
      *   '-
     C           WCRMTX    IFEQ @CN,001                    *IF
     C           WCRMTX    OREQ @CN,002                    *OR
      * 06/19/24 SP S312722-Start
      * 06/19/24 SP S312722-End
     C                     Z-ADD10        YRSW00
     C                     Z-ADD31        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00052
     C           ZQ        ORGT 00052
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0013:ZQ YL0015    P  90  Text USR 12
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.ED Chilled/Frozen Text is Chilled
      *   |- c2    : DB1.ED Chilled/Frozen Text is CHILLED All Caps
      *   '-
     C           WCRMTX    IFEQ @CN,003                    *IF
     C           WCRMTX    OREQ @CN,004                    *OR
     C                     MOVEL@CN,005   YL0016           Frozen/Chilled
     C                     Z-ADD12        YRSW00
     C                     Z-ADD29        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00052
     C           ZQ        ORGT 00052
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0013:ZQ YL0015    P  90  Text USR 12
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Override ED Language Xlate Desc 2 to print but was originally bla
      * CASE: LCL.Text USR 12 is Not Entered
     C           YL0015    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Description Xlate Line 2 is Not Entered
     C           YL0014    IFEQ *BLANK                     *IF
      * Was originally blank.
     C                     MOVEL'Y'       YL0004           Force Xlate Dsc
     C                     ADD  2         YL0006           # of Lines Reqd
     C                     Z-ADD1         YL0012           # of Blank Line
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDYL0006    WN0001           # of Lines Reqd
     C                     Z-ADDYL0006    YL0003           1st Page Line C
      * Create Exp Doc Order Dtl PRT.
      * CASE: *OTHERWISE
      * Format 'Overflow Pg Dsc Xlate Ln1'.
      * CASE:
      *  - c1 AND NOTc2
      *   |- c1    : DB1.ED Language Xlate Desc is Entered
      *   |- c2    : PAR.ED Xlate Desc to Country is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCK1U1    IFNE *BLANK                     *IF
     C           P2CVSX    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Always use 'Overflow Pg Dsc Xlate Ln1' for Chile Letterhead.
     C                     MOVEL*BLANK    YL0013           Overflow Pg Dsc
     C                     MOVELWCK1U1    YL0013           Overflow Pg Dsc
     C                     MOVEL*BLANK    YL0014           Description Xla
     C                     MOVELWCRBTX    YL0014           Description Xla
      * Spanish Translation.
      * CASE: PAR.ED Xlate Desc to Country is Spanish
     C           P2CVSX    IFEQ 'S'                        *IF
     C                     MOVEL*BLANK    YL0015           Text USR 12
     C                     MOVEL*BLANK    YL0016           Frozen/Chilled
      * Xlate Frozen/Chilled - Xlate Line Desc 1.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.ED Chilled/Frozen Text is Frozen
      *   |- c2    : DB1.ED Chilled/Frozen Text is FROZEN All Caps
      *   '-
     C           WCRMTX    IFEQ @CN,001                    *IF
     C           WCRMTX    OREQ @CN,002                    *OR
      * 06/19/24 SP S312722-Start
      * 06/19/24 SP S312722-End
     C                     Z-ADD10        YRSW00
     C                     Z-ADD31        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00052
     C           ZQ        ORGT 00052
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0013:ZQ YL0015    P  90  Text USR 12
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.ED Chilled/Frozen Text is Chilled
      *   |- c2    : DB1.ED Chilled/Frozen Text is CHILLED All Caps
      *   '-
     C           WCRMTX    IFEQ @CN,003                    *IF
     C           WCRMTX    OREQ @CN,004                    *OR
     C                     MOVEL@CN,005   YL0016           Frozen/Chilled
     C                     Z-ADD12        YRSW00
     C                     Z-ADD29        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00052
     C           ZQ        ORGT 00052
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0013:ZQ YL0015    P  90  Text USR 12
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * If Blank Then Append to Xlate Desc Line 1 Else to Xlate Desc Line
      * CASE: LCL.Text USR 12 is Not Entered
     C           YL0015    IFEQ *BLANK                     *IF
      * CASE: LCL.Description Xlate Line 2 is Not Entered
     C           YL0014    IFEQ *BLANK                     *IF
     C                     Z-ADD1         ZQ      50
     C           YL0013    CAT  YL0016:ZQ YL0013    P      Overflow Pg Dsc
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           YL0014    CAT  YL0016:ZQ YL0014    P      Description Xla
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Description Xlate Line 2 is Not Entered
     C           YL0014    IFEQ *BLANK                     *IF
     C                     Z-ADD0         ZQ      50
     C           YL0014    CAT  YL0016:ZQ YL0014    P      Description Xla
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           YL0014    CAT  YL0016:ZQ YL0014    P      Description Xla
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0017           ED Language Xla
      * Force no print of Xlate Desc Line 2 if Xlate Desc Line 1 is not e
     C                     MOVEL*BLANK    YL0014           Description Xla
     C                     END                             *FI
      * Crt Exp Doc Ord Dtl PRTRT - Export Doc Order Dtl PRT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0001           Company Number
     C                     Z-ADDWCC4NB    WL0002           Order Number
     C                     MOVELWCDGSX    WL0003    P      ED Export Docum
     C                     MOVELWCKXCD    WL0004    P      Country Code
     C                     Z-ADDWCDIC7    WL0005           Item Code
     C                     MOVEL*BLANK    WL0006           Description Xla
     C                     MOVELYL0014    WL0007    P      Description Xla
     C                     MOVELYL0013    WL0008    P      Overflow Pg Dsc
     C                     MOVEL'N'       WL0009    P      Overflow
     C                     Z-ADD*ZERO     WL0010           EDODP Unused Nu
     C                     MOVELYL0007    WL0011    P      Skip Ln Before
     C                     MOVELYL0008    WL0012    P      Skip Ln After X
     C                     MOVEL'N'       WL0013    P      Prt Inspector N
     C                     MOVEL*BLANK    WL0014           Item Printed
     C                     MOVELYL0018    WL0015    P      Prt Continuatio
     C                     Z-ADDYL0009    WL0016           # of Blank Line
     C                     Z-ADDYL0010    WL0017           # of Blank Line
     C                     Z-ADDYL0011    WL0018           # of Blank Line
     C                     Z-ADDYL0012    WL0019           # of Blank Line
     C                     MOVELYL0018    WL0020    P      EDODP Unused St
     C                     MOVELYL0018    WL0021    P      EDODP Unused St
     C                     Z-ADD*ZERO     WL0022           EDODP Unused Nb
     C                     Z-ADD*ZERO     WL0023           EDODP Unused Dt
     C                     MOVELYL0018    WL0024    P      EDODP Unused Tx
     C                     MOVELYL0018    WL0025    P      EDODP Unused Tx
     C                     EXSR SDRVGN
     C                     END                             *FI
      * Item Code Change, Create Exp Doc Order Dtl PRT Record.
      * CASE: DB1.ED Item Code NE LCL.ED Item Code
     C           WCDIC7    IFNE YL0005                     *IF
     C                     Z-ADDWCDIC7    YL0005           ED Item Code
      * Determine '# of Lines Reqd to Print'.
      * CASE: *OTHERWISE
      * Initialization.
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0006           # of Lines Reqd
     C                     Z-ADD*ZERO     YL0019           EDODP Unused Nu
     C                     MOVEL'N'       YL0007           Skip Ln Before
     C                     MOVEL'N'       YL0008           Skip Ln After X
     C                     MOVEL'N'       YL0020           Overflow
     C                     MOVEL'N'       YL0021           Prt Inspector N
      * Check If Overflow Reached to Reset Count & Update Overflow Line.
      * CASE: *OTHERWISE
      * Max detail lines to print on Page is 12 else set Overflow On.
      * Call PUW6XFR to ensure we are on the correct Box.
      * Ext Reset Count f/LtrhdXF - Export Doc Order Dtl  * 
     C                     CLEARPARC
     C                     Z-ADDWCAIC3    PAAIC3           Company Number
     C                     Z-ADDWCC4NB    PAC4NB           Order Number
     C                     MOVELWCDGSX    PADGSX    P      ED Export Docum
     C                     MOVELWCKXCD    PAKXCD    P      Country Code
     C                     Z-ADDWCDIC7    PADIC7           ED Item Code
     C                     Z-ADDWCDPNB    PADPNB           Order Sequence
      *
     C                     CALL 'PUW6XFR'              90  Ext Reset Count
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Export Doc
     C           WN0001    PARM WN0001    WQ0001  30       # of Lines Reqd
     C           YL0020    PARM *BLANK    WQ0002  1        Overflow
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUW6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Update Previous Item Code to Print Continuation Text Flag.
      * CASE: LCL.Overflow is Yes
     C           YL0020    IFEQ 'Y'                        *IF
      * Upd Prt Continuation  RT - Export Doc Order Dtl PRT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0026           Company Number
     C                     Z-ADDWCC4NB    WL0027           Order Number
     C                     MOVELWCDGSX    WL0028    P      ED Export Docum
     C                     MOVELWCKXCD    WL0029    P      Country Code
     C                     Z-ADDWCDIC7    WL0030           Item Code
     C                     EXSR SFRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * Normally would be for last record processing.
      * CASE: PAR.# of Lines Reqd to Print is 12
     C           WN0001    IFEQ 12                         *IF
     C                     MOVEL'Y'       YL0020           Overflow
     C                     Z-ADD*ZERO     WN0001           # of Lines Reqd
      * Update Previous Item Code to Print Continuation Text Flag.
      * Upd Prt Continuation  RT - Export Doc Order Dtl PRT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0026           Company Number
     C                     Z-ADDWCC4NB    WL0027           Order Number
     C                     MOVELWCDGSX    WL0028    P      ED Export Docum
     C                     MOVELWCKXCD    WL0029    P      Country Code
     C                     Z-ADDWCDIC7    WL0030           Item Code
     C                     EXSR SFRVGN
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DB1.ED Item Label Line 1 is Entered
     C           WCO3NA    IFNE *BLANK                     *IF
     C                     ADD  2         YL0006           # of Lines Reqd
     C           WN0001    ADD  YL0006    YL0001           USR Counter
      * Check Which Box we are on & Set # of Blank Line to Print.
      * CASE: LCL.USR Counter is EQ 2
     C           YL0001    IFEQ 2                          *IF
     C                     Z-ADD1         YL0009           # of Blank Line
     C                     ELSE
      * CASE: LCL.USR Counter is 4
     C           YL0001    IFEQ 4                          *IF
     C                     Z-ADD*ZERO     YL0009           # of Blank Line
     C                     ELSE
      * CASE: LCL.USR Counter is 6
     C           YL0001    IFEQ 6                          *IF
     C                     Z-ADD1         YL0009           # of Blank Line
     C                     ELSE
      * CASE: LCL.USR Counter is 8
     C           YL0001    IFEQ 8                          *IF
     C                     Z-ADD1         YL0009           # of Blank Line
     C                     ELSE
      * CASE: LCL.USR Counter is 10
     C           YL0001    IFEQ 10                         *IF
     C                     Z-ADD1         YL0009           # of Blank Line
     C                     ELSE
      * CASE: LCL.USR Counter is 12
     C           YL0001    IFEQ 12                         *IF
      * Do Not Print Blank Line If Box 6.
     C                     Z-ADD*ZERO     YL0009           # of Blank Line
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DB1.ED Item Label Line 2 is Entered
     C           WCO4NA    IFNE *BLANK                     *IF
     C                     ADD  2         YL0006           # of Lines Reqd
     C           WN0001    ADD  YL0006    YL0001           USR Counter
      * Check Which Box we are on & Set # of Blank Line to Print.
      * CASE: LCL.USR Counter is EQ 2
     C           YL0001    IFEQ 2                          *IF
     C                     Z-ADD2         YL0010           # of Blank Line
     C                     ELSE
      * CASE: LCL.USR Counter is 4
     C           YL0001    IFEQ 4                          *IF
     C                     Z-ADD1         YL0010           # of Blank Line
     C                     ELSE
      * CASE: LCL.USR Counter is 6
     C           YL0001    IFEQ 6                          *IF
     C                     Z-ADD2         YL0010           # of Blank Line
     C                     ELSE
      * CASE: LCL.USR Counter is 8
     C           YL0001    IFEQ 8                          *IF
     C                     Z-ADD2         YL0010           # of Blank Line
     C                     ELSE
      * CASE: LCL.USR Counter is 10
     C           YL0001    IFEQ 10                         *IF
     C                     Z-ADD2         YL0010           # of Blank Line
     C                     ELSE
      * CASE: LCL.USR Counter is 12
     C           YL0001    IFEQ 12                         *IF
      * Do Not Print Blank Line If Box 6.
     C                     Z-ADD0         YL0010           # of Blank Line
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Country is Setup for Language Translation.
      * CASE:
      *  - NOTc1
      *   |- c1    : PAR.ED Xlate Desc to Country is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2CVSX    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DB1.ED Language Xlate Desc is Entered
     C           WCK1U1    IFNE *BLANK                     *IF
     C                     ADD  2         YL0006           # of Lines Reqd
     C           WN0001    ADD  YL0006    YL0001           USR Counter
      * Check Which Box we are on & Set # of Blank Line to Print.
      * CASE: LCL.USR Counter is EQ 2
     C           YL0001    IFEQ 2                          *IF
     C                     Z-ADD1         YL0011           # of Blank Line
     C                     ELSE
      * CASE: LCL.USR Counter is 4
     C           YL0001    IFEQ 4                          *IF
     C                     Z-ADD*ZERO     YL0011           # of Blank Line
     C                     ELSE
      * CASE: LCL.USR Counter is 6
     C           YL0001    IFEQ 6                          *IF
     C                     Z-ADD1         YL0011           # of Blank Line
     C                     ELSE
      * CASE: LCL.USR Counter is 8
     C           YL0001    IFEQ 8                          *IF
     C                     Z-ADD1         YL0011           # of Blank Line
     C                     ELSE
      * CASE: LCL.USR Counter is 10
     C           YL0001    IFEQ 10                         *IF
     C                     Z-ADD1         YL0011           # of Blank Line
     C                     ELSE
      * CASE: LCL.USR Counter is 12
     C           YL0001    IFEQ 12                         *IF
      * Do Not Print Blank Line If Box 6.
     C                     Z-ADD*ZERO     YL0011           # of Blank Line
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Force No Blank Line.
      * CASE: DB1.ED Item Label Line 2 is Not Entered
     C           WCO4NA    IFEQ *BLANK                     *IF
     C                     Z-ADD0         YL0011           # of Blank Line
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DB1.ED Language Xlate Desc 2 is Entered
     C           WCRBTX    IFNE *BLANK                     *IF
     C                     ADD  2         YL0006           # of Lines Reqd
     C           WN0001    ADD  YL0006    YL0001           USR Counter
      * Check Which Box we are on & Set # of Blank Line to Print.
      * CASE: LCL.USR Counter is EQ 2
     C           YL0001    IFEQ 2                          *IF
     C                     Z-ADD1         YL0012           # of Blank Line
     C                     ELSE
      * CASE: LCL.USR Counter is 4
     C           YL0001    IFEQ 4                          *IF
     C                     Z-ADD0         YL0012           # of Blank Line
     C                     ELSE
      * CASE: LCL.USR Counter is 6
     C           YL0001    IFEQ 6                          *IF
     C                     Z-ADD1         YL0012           # of Blank Line
     C                     ELSE
      * CASE: LCL.USR Counter is 8
     C           YL0001    IFEQ 8                          *IF
     C                     Z-ADD1         YL0012           # of Blank Line
     C                     ELSE
      * CASE: LCL.USR Counter is 10
     C           YL0001    IFEQ 10                         *IF
     C                     Z-ADD1         YL0012           # of Blank Line
     C                     ELSE
      * CASE: LCL.USR Counter is 12
     C           YL0001    IFEQ 12                         *IF
      * Do Not Print Blank Line If Box 6.
     C                     Z-ADD*ZERO     YL0012           # of Blank Line
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Check Exception if Spanish Text Needs to Be Printed on Xlate Desc
      * CASE: DB1.ED Language Xlate Desc is Entered
     C           WCK1U1    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    YL0015           Text USR 12
     C                     MOVEL*BLANK    YL0016           Frozen/Chilled
      * Xlate Frozen/Chilled - Xlate Line Desc 1.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.ED Chilled/Frozen Text is Frozen
      *   |- c2    : DB1.ED Chilled/Frozen Text is FROZEN All Caps
      *   '-
     C           WCRMTX    IFEQ @CN,001                    *IF
     C           WCRMTX    OREQ @CN,002                    *OR
      * 06/19/24 SP S312722-Start
      * 06/19/24 SP S312722-End
     C                     Z-ADD10        YRSW00
     C                     Z-ADD31        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00040
     C           ZQ        ORGT 00040
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWCK1U1:ZQ YL0015    P  90  Text USR 12
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.ED Chilled/Frozen Text is Chilled
      *   |- c2    : DB1.ED Chilled/Frozen Text is CHILLED All Caps
      *   '-
     C           WCRMTX    IFEQ @CN,003                    *IF
     C           WCRMTX    OREQ @CN,004                    *OR
     C                     MOVEL@CN,005   YL0016           Frozen/Chilled
     C                     Z-ADD12        YRSW00
     C                     Z-ADD29        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00040
     C           ZQ        ORGT 00040
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWCK1U1:ZQ YL0015    P  90  Text USR 12
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Override ED Language Xlate Desc 2 to print but was originally bla
      * CASE: LCL.Text USR 12 is Not Entered
     C           YL0015    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  2         YL0006           # of Lines Reqd
     C           WN0001    ADD  YL0006    YL0001           USR Counter
      * Check Which Box we are on & Set # of Blank Line to Print.
      * CASE: LCL.USR Counter is EQ 2
     C           YL0001    IFEQ 2                          *IF
     C                     Z-ADD1         YL0012           # of Blank Line
     C                     ELSE
      * CASE: LCL.USR Counter is 4
     C           YL0001    IFEQ 4                          *IF
     C                     Z-ADD0         YL0012           # of Blank Line
     C                     ELSE
      * CASE: LCL.USR Counter is 6
     C           YL0001    IFEQ 6                          *IF
     C                     Z-ADD1         YL0012           # of Blank Line
     C                     ELSE
      * CASE: LCL.USR Counter is 8
     C           YL0001    IFEQ 8                          *IF
     C                     Z-ADD1         YL0012           # of Blank Line
     C                     ELSE
      * CASE: LCL.USR Counter is 10
     C           YL0001    IFEQ 10                         *IF
     C                     Z-ADD1         YL0012           # of Blank Line
     C                     ELSE
      * CASE: LCL.USR Counter is 12
     C           YL0001    IFEQ 12                         *IF
      * Do Not Print Blank Line If Box 6.
     C                     Z-ADD*ZERO     YL0012           # of Blank Line
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  YL0006    WN0001           # of Lines Reqd
      * Re-Check if Overflow.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Overflow is No
      *   |- c2    : PAR.# of Lines Reqd to Print is GT 12
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0020    IFEQ 'N'                        *IF
     C           WN0001    IFGT 12                         *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0020           Overflow
      * Update Previous Item Code to Print Continuation Text Flag.
      * Upd Prt Continuation  RT - Export Doc Order Dtl PRT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0026           Company Number
     C                     Z-ADDWCC4NB    WL0027           Order Number
     C                     MOVELWCDGSX    WL0028    P      ED Export Docum
     C                     MOVELWCKXCD    WL0029    P      Country Code
     C                     Z-ADDWCDIC7    WL0030           Item Code
     C                     EXSR SFRVGN
      * Reset Counter.
     C                     Z-ADDYL0006    WN0001           # of Lines Reqd
     C                     END                             *FI
      * Create Export Doc Order Dtl PRT (PUCFCPP) Record.
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0017           ED Language Xla
     C                     MOVEL*BLANK    YL0014           Description Xla
     C                     MOVEL*BLANK    YL0013           Overflow Pg Dsc
      * Format 'Overflow Pg Dsc Xlate Ln1'.
      * CASE:
      *  - c1 AND NOTc2
      *   |- c1    : DB1.ED Language Xlate Desc is Entered
      *   |- c2    : PAR.ED Xlate Desc to Country is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCK1U1    IFNE *BLANK                     *IF
     C           P2CVSX    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Always use 'Overflow Pg Dsc Xlate Ln1' for Appl Export Doc.
     C                     MOVEL*BLANK    YL0013           Overflow Pg Dsc
     C                     MOVELWCK1U1    YL0013           Overflow Pg Dsc
     C                     MOVEL*BLANK    YL0014           Description Xla
     C                     MOVELWCRBTX    YL0014           Description Xla
      * Spanish Translation.
      * CASE: PAR.ED Xlate Desc to Country is Spanish
     C           P2CVSX    IFEQ 'S'                        *IF
     C                     MOVEL*BLANK    YL0015           Text USR 12
     C                     MOVEL*BLANK    YL0016           Frozen/Chilled
      * Xlate Frozen/Chilled - Xlate Line Desc 1.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.ED Chilled/Frozen Text is Frozen
      *   |- c2    : DB1.ED Chilled/Frozen Text is FROZEN All Caps
      *   '-
     C           WCRMTX    IFEQ @CN,001                    *IF
     C           WCRMTX    OREQ @CN,002                    *OR
      * 06/19/24 SP S312722-Start
      * 06/19/24 SP S312722-End
     C                     Z-ADD10        YRSW00
     C                     Z-ADD31        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00052
     C           ZQ        ORGT 00052
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0013:ZQ YL0015    P  90  Text USR 12
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.ED Chilled/Frozen Text is Chilled
      *   |- c2    : DB1.ED Chilled/Frozen Text is CHILLED All Caps
      *   '-
     C           WCRMTX    IFEQ @CN,003                    *IF
     C           WCRMTX    OREQ @CN,004                    *OR
     C                     MOVEL@CN,005   YL0016           Frozen/Chilled
     C                     Z-ADD12        YRSW00
     C                     Z-ADD29        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00052
     C           ZQ        ORGT 00052
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0013:ZQ YL0015    P  90  Text USR 12
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * If Blank Then Append to Xlate Desc Line 1 Else to Xlate Desc Line
      * CASE: LCL.Text USR 12 is Not Entered
     C           YL0015    IFEQ *BLANK                     *IF
      * CASE: LCL.Description Xlate Line 2 is Not Entered
     C           YL0014    IFEQ *BLANK                     *IF
     C                     Z-ADD1         ZQ      50
     C           YL0013    CAT  YL0016:ZQ YL0013    P      Overflow Pg Dsc
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           YL0014    CAT  YL0016:ZQ YL0014    P      Description Xla
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Description Xlate Line 2 is Not Entered
     C           YL0014    IFEQ *BLANK                     *IF
     C                     Z-ADD0         ZQ      50
     C           YL0014    CAT  YL0016:ZQ YL0014    P      Description Xla
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           YL0014    CAT  YL0016:ZQ YL0014    P      Description Xla
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Crt Exp Doc Ord Dtl PRTRT - Export Doc Order Dtl PRT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0001           Company Number
     C                     Z-ADDWCC4NB    WL0002           Order Number
     C                     MOVELWCDGSX    WL0003    P      ED Export Docum
     C                     MOVELWCKXCD    WL0004    P      Country Code
     C                     Z-ADDWCDIC7    WL0005           Item Code
     C                     MOVEL*BLANK    WL0006           Description Xla
     C                     MOVELYL0014    WL0007    P      Description Xla
     C                     MOVELYL0013    WL0008    P      Overflow Pg Dsc
     C                     MOVELYL0020    WL0009    P      Overflow
     C                     Z-ADDYL0019    WL0010           EDODP Unused Nu
     C                     MOVELYL0007    WL0011    P      Skip Ln Before
     C                     MOVELYL0008    WL0012    P      Skip Ln After X
     C                     MOVEL'N'       WL0013    P      Prt Inspector N
     C                     MOVEL*BLANK    WL0014           Item Printed
     C                     MOVELYL0018    WL0015    P      Prt Continuatio
     C                     Z-ADDYL0009    WL0016           # of Blank Line
     C                     Z-ADDYL0010    WL0017           # of Blank Line
     C                     Z-ADDYL0011    WL0018           # of Blank Line
     C                     Z-ADDYL0012    WL0019           # of Blank Line
     C                     MOVELYL0018    WL0020    P      EDODP Unused St
     C                     MOVELYL0018    WL0021    P      EDODP Unused St
     C                     Z-ADD*ZERO     WL0022           EDODP Unused Nb
     C                     Z-ADD*ZERO     WL0023           EDODP Unused Dt
     C                     MOVELYL0018    WL0024    P      EDODP Unused Tx
     C                     MOVELYL0018    WL0025    P      EDODP Unused Tx
     C                     EXSR SDRVGN
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSC     READE@MSREEM                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Crt Exp Doc Ord Dtl PRTRT - Export Doc Order Dtl PRT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
     C                     KFLD           WADGSX           ED Export Docum
     C                     KFLD           WAKXCD           Country Code
     C                     KFLD           WAHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0001    WAAIC3           Company Number
     C                     Z-ADDWL0002    WAC4NB           Order Number
     C                     MOVELWL0003    WADGSX           ED Export Docum
     C                     MOVELWL0004    WAKXCD           Country Code
     C                     Z-ADDWL0005    WAHGCD           Item Code
      * Establish starting position
     C           KRSSD     CHAIN@CFCPJV              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR5245' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Doc Ord Dtl PRT   CR - Export Doc Order Dtl PRT  * 
     C                     EXSR SECRRC
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * Crt Doc Ord Dtl PRT   CR - Export Doc Order Dtl PRT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CFCPJU
     C                     Z-ADDWL0001    WBAIC3           Company Number
     C                     Z-ADDWL0002    WBC4NB           Order Number
     C                     MOVELWL0003    WBDGSX           ED Export Docum
     C                     MOVELWL0004    WBKXCD           Country Code
     C                     Z-ADDWL0005    WBHGCD           Item Code
     C                     MOVELWL0006    WBRDU1           Description Xla
     C                     MOVELWL0007    WBREU1           Description Xla
     C                     MOVELWL0008    WBRFU1           Overflow Pg Dsc
     C                     MOVELWL0009    WBMYSC           Overflow
     C                     Z-ADDWL0010    WBG2NZ           EDODP Unused Nu
     C                     MOVELWL0011    WBM9SC           Skip Ln Before
     C                     MOVELWL0012    WBNASC           Skip Ln After X
     C                     MOVELWL0013    WBM4SC           Prt Inspector N
     C                     MOVELWL0014    WBMZSC           Item Printed
     C                     MOVELWL0015    WBM5SC           Prt Continuatio
     C                     Z-ADDWL0016    WBG7NZ           # of Blank Line
     C                     Z-ADDWL0017    WBG8NZ           # of Blank Line
     C                     Z-ADDWL0018    WBG9NZ           # of Blank Line
     C                     Z-ADDWL0019    WBHANZ           # of Blank Line
     C                     MOVELWL0020    WBM6SC           EDODP Unused St
     C                     MOVELWL0021    WBM7SC           EDODP Unused St
     C                     Z-ADDWL0022    WBG3NZ           EDODP Unused Nb
     C                     Z-ADDWL0023    WBXSDT           EDODP Unused Dt
     C                     MOVELWL0024    WBRLU1           EDODP Unused Tx
     C                     MOVELWL0025    WBRMU1           EDODP Unused Tx
      *
     C           KLCRSE    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
     C                     KFLD           WBDGSX           ED Export Docum
     C                     KFLD           WBKXCD           Country Code
     C                     KFLD           WBHGCD           Item Code
      * Check for duplicate primary key
     C           KLCRSE    SETLL@CFCPJU                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR5246' W0RTN   7
      * Send message 'Export Doc Order Dtl P EX'
     C                     MOVEL'USR5246' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@CFCPJU                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Upd Prt Continuation  RT - Export Doc Order Dtl PRT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WDC4NB    WQSF02           Order Number
     C           *LIKE     DEFN WDDGSX    WQSF03           ED Export Docum
     C           *LIKE     DEFN WDKXCD    WQSF04           Country Code
      * Define keylist
     C           KPSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
     C                     KFLD           WQSF03           ED Export Docum
     C                     KFLD           WQSF04           Country Code
     C                     KFLD           WDHGCD           Item Code
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
     C                     KFLD           WQSF03           ED Export Docum
     C                     KFLD           WQSF04           Country Code
      * Setup key
     C                     Z-ADDWL0026    WQSF01           Company Number
     C                     Z-ADDWL0027    WQSF02           Order Number
     C                     MOVELWL0028    WQSF03           ED Export Docum
     C                     MOVELWL0029    WQSF04           Country Code
     C                     Z-ADDWL0030    WDHGCD           Item Code
      * Establish starting position
     C           KPSSF     SETLL@CFCPJ0                    *
     C           KRSSF     READE@CFCPJ0                  90*
      * Data record not found
     C   90                MOVEL'USR5245' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Doc Ord Dtl PRT   CH - Export Doc Order Dtl PRT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0031           Company Number
     C                     Z-ADDWDC4NB    WL0032           Order Number
     C                     MOVELWDDGSX    WL0033    P      ED Export Docum
     C                     MOVELWDKXCD    WL0034    P      Country Code
     C                     Z-ADDWDHGCD    WL0035           Item Code
     C                     MOVELWDRDU1    WL0036    P      Description Xla
     C                     MOVELWDREU1    WL0037    P      Description Xla
     C                     MOVELWDRFU1    WL0038    P      Overflow Pg Dsc
     C                     MOVELWDMYSC    WL0039    P      Overflow
     C                     Z-ADDWDG2NZ    WL0040           EDODP Unused Nu
     C                     MOVELWDM9SC    WL0041    P      Skip Ln Before
     C                     MOVELWDNASC    WL0042    P      Skip Ln After X
     C                     MOVELWDM4SC    WL0043    P      Prt Inspector N
     C                     MOVELWDMZSC    WL0044    P      Item Printed
     C                     MOVEL'Y'       WL0045    P      Prt Continuatio
     C                     Z-ADDWDG7NZ    WL0046           # of Blank Line
     C                     Z-ADDWDG8NZ    WL0047           # of Blank Line
     C                     Z-ADDWDG9NZ    WL0048           # of Blank Line
     C                     Z-ADDWDHANZ    WL0049           # of Blank Line
     C                     MOVELWDM6SC    WL0050    P      EDODP Unused St
     C                     MOVELWDM7SC    WL0051    P      EDODP Unused St
     C                     Z-ADDWDG3NZ    WL0052           EDODP Unused Nb
     C                     Z-ADDWDXSDT    WL0053           EDODP Unused Dt
     C                     MOVELWDRLU1    WL0054    P      EDODP Unused Tx
     C                     MOVELWDRMU1    WL0055    P      EDODP Unused Tx
     C                     EXSR SGCHRC
     C                     GOTO SFEXIT                     *QUIT
     C           KRSSF     READE@CFCPJ0                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * Chg Doc Ord Dtl PRT   CH - Export Doc Order Dtl PRT  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @CFCPJU
     C                     Z-ADDWL0031    WBAIC3           Company Number
     C                     Z-ADDWL0032    WBC4NB           Order Number
     C                     MOVELWL0033    WBDGSX    P      ED Export Docum
     C                     MOVELWL0034    WBKXCD    P      Country Code
     C                     Z-ADDWL0035    WBHGCD           Item Code
      *
     C           KLCHSG    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
     C                     KFLD           WBDGSX           ED Export Docum
     C                     KFLD           WBKXCD           Country Code
     C                     KFLD           WBHGCD           Item Code
     C           KLCHSG    CHAIN@CFCPJU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PUCFCPL0'MDACP
     C                     MOVEL'@CFCPJU' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPUCF1    YARDCS
      * Move non-key fields to @CFCPJU
     C                     MOVELWL0036    WBRDU1    P      Description Xla
     C                     MOVELWL0037    WBREU1    P      Description Xla
     C                     MOVELWL0038    WBRFU1    P      Overflow Pg Dsc
     C                     MOVELWL0039    WBMYSC    P      Overflow
     C                     Z-ADDWL0040    WBG2NZ           EDODP Unused Nu
     C                     MOVELWL0041    WBM9SC    P      Skip Ln Before
     C                     MOVELWL0042    WBNASC    P      Skip Ln After X
     C                     MOVELWL0043    WBM4SC    P      Prt Inspector N
     C                     MOVELWL0044    WBMZSC    P      Item Printed
     C                     MOVELWL0045    WBM5SC    P      Prt Continuatio
     C                     Z-ADDWL0046    WBG7NZ           # of Blank Line
     C                     Z-ADDWL0047    WBG8NZ           # of Blank Line
     C                     Z-ADDWL0048    WBG9NZ           # of Blank Line
     C                     Z-ADDWL0049    WBHANZ           # of Blank Line
     C                     MOVELWL0050    WBM6SC    P      EDODP Unused St
     C                     MOVELWL0051    WBM7SC    P      EDODP Unused St
     C                     Z-ADDWL0052    WBG3NZ           EDODP Unused Nb
     C                     Z-ADDWL0053    WBXSDT           EDODP Unused Dt
     C                     MOVELWL0054    WBRLU1    P      EDODP Unused Tx
     C                     MOVELWL0055    WBRMU1    P      EDODP Unused Tx
      *
      * Set PGM.*Record Data Changed flag
     C           QPUCF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@CFCPJU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPUCFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Crt EDOD PRT-HC       RT - Export Doc Order Dtl  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0003  30       # of Lines Reqd
     C                     MOVEL*BLANK    WN0004  1        Prt Overflow Ds
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0022           Count USR
     C                     Z-ADD1         YL0023           USR Page Number
     C                     MOVEL'Y'       YL0024           First Time Flag
     C                     Z-ADD*ZERO     WN0003           # of Lines Reqd
     C                     MOVEL'N'       WN0004           Prt Overflow Ds
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSH01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSH02           Order Number
     C           *LIKE     DEFN WCDGSX    WQSH03           ED Export Docum
     C           *LIKE     DEFN WCKXCD    WQSH04           Country Code
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Order Number
     C                     KFLD           WQSH03           ED Export Docum
     C                     KFLD           WQSH04           Country Code
      * Setup key
     C                     Z-ADDP1AIC3    WQSH01           Company Number
     C                     Z-ADDP1C4NB    WQSH02           Order Number
     C                     MOVELP1DGSX    WQSH03           ED Export Docum
     C                     MOVELP1KXCD    WQSH04           Country Code
      * Establish starting position
     C           KRSSH     SETLL@MSREEM                    *
     C           KRSSH     READE@MSREEM                  90*
      * Data record not found
     C   90                MOVEL'USR2745' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Select Only Product with Weights.
      * CASE: DB1.ED Product Net Weight lbs is Entered
     C           WCHJWG    IFNE 0                          *IF
      * First Time Thru, Create Exp Doc Order Dtl PRT Record.
      * CASE: LCL.First Time Flag is Yes
     C           YL0024    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       YL0024           First Time Flag
     C                     Z-ADDWCDIC7    YL0025           ED Item Code
      * Determine '# of Lines Reqd to Print'.
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0026           # of Lines Reqd
      * CASE: DB1.ED Item Label Line 1 is Entered
     C           WCO3NA    IFNE *BLANK                     *IF
     C                     ADD  2         YL0026           # of Lines Reqd
     C                     END                             *FI
      * CASE:
      *  - c1 AND NOTc2
      *   |- c1    : DB1.ED Language Xlate Desc is Entered
      *   |- c2    : PAR.ED Xlate Desc to Country is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCK1U1    IFNE *BLANK                     *IF
     C           P2CVSX    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  2         YL0026           # of Lines Reqd
     C                     END                             *FI
     C                     Z-ADDYL0026    WN0003           # of Lines Reqd
      * Create Exp Doc Order Dtl PRT.
      * CASE: *OTHERWISE
      * CASE:
      *  - c1 AND NOTc2
      *   |- c1    : DB1.ED Language Xlate Desc is Entered
      *   |- c2    : PAR.ED Xlate Desc to Country is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCK1U1    IFNE *BLANK                     *IF
     C           P2CVSX    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELWCK1U1    YL0027           ED Language Xla
     C                     MOVEL*BLANK    YL0028           Description Xla
     C                     MOVELWCRBTX    YL0028           Description Xla
      * Spanish Translation.
      * CASE: PAR.ED Xlate Desc to Country is Spanish
     C           P2CVSX    IFEQ 'S'                        *IF
     C                     MOVEL*BLANK    YL0029           Text USR 12
     C                     MOVEL*BLANK    YL0030           Frozen/Chilled
      * Xlate Frozen/Chilled - Xlate Line Desc 1.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.ED Chilled/Frozen Text is Frozen
      *   |- c2    : DB1.ED Chilled/Frozen Text is FROZEN All Caps
      *   '-
     C           WCRMTX    IFEQ @CN,001                    *IF
     C           WCRMTX    OREQ @CN,002                    *OR
      * 06/19/24 SP S312722-Start
      * 06/19/24 SP S312722-End
     C                     Z-ADD10        YRSW00
     C                     Z-ADD31        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00040
     C           ZQ        ORGT 00040
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0027:ZQ YL0029    P  90  Text USR 12
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.ED Chilled/Frozen Text is Chilled
      *   |- c2    : DB1.ED Chilled/Frozen Text is CHILLED All Caps
      *   '-
     C           WCRMTX    IFEQ @CN,003                    *IF
     C           WCRMTX    OREQ @CN,004                    *OR
     C                     MOVEL@CN,005   YL0030           Frozen/Chilled
     C                     Z-ADD12        YRSW00
     C                     Z-ADD29        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00040
     C           ZQ        ORGT 00040
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0027:ZQ YL0029    P  90  Text USR 12
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * If Blank Then Append to Xlate Desc Line 1 Else to Xlate Desc Line
      * CASE: LCL.Text USR 12 is Not Entered
     C           YL0029    IFEQ *BLANK                     *IF
      * CASE: LCL.Description Xlate Line 2 is Not Entered
     C           YL0028    IFEQ *BLANK                     *IF
     C                     Z-ADD1         ZQ      50
     C           YL0027    CAT  YL0030:ZQ YL0027    P      ED Language Xla
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           YL0028    CAT  YL0030:ZQ YL0028    P      Description Xla
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Description Xlate Line 2 is Not Entered
     C           YL0028    IFEQ *BLANK                     *IF
     C                     Z-ADD0         ZQ      50
     C           YL0028    CAT  YL0030:ZQ YL0028    P      Description Xla
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           YL0028    CAT  YL0030:ZQ YL0028    P      Description Xla
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0027           ED Language Xla
      * Force no print of Xlate Desc Line 2 if Xlate Desc Line 1 is not e
     C                     MOVEL*BLANK    YL0028           Description Xla
     C                     END                             *FI
      * Crt Exp Doc Ord Dtl PRTRT - Export Doc Order Dtl PRT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0001           Company Number
     C                     Z-ADDWCC4NB    WL0002           Order Number
     C                     MOVELWCDGSX    WL0003    P      ED Export Docum
     C                     MOVELWCKXCD    WL0004    P      Country Code
     C                     Z-ADDWCDIC7    WL0005           Item Code
     C                     MOVELYL0027    WL0006    P      Description Xla
     C                     MOVELYL0028    WL0007    P      Description Xla
     C                     MOVEL*BLANK    WL0008           Overflow Pg Dsc
     C                     MOVEL'N'       WL0009    P      Overflow
     C                     Z-ADD*ZERO     WL0010           EDODP Unused Nu
     C                     MOVEL'N'       WL0011    P      Skip Ln Before
     C                     MOVEL'N'       WL0012    P      Skip Ln After X
     C                     MOVEL'N'       WL0013    P      Prt Inspector N
     C                     MOVEL*BLANK    WL0014           Item Printed
     C                     MOVELYL0031    WL0015    P      Prt Continuatio
     C                     Z-ADD*ZERO     WL0016           # of Blank Line
     C                     Z-ADD*ZERO     WL0017           # of Blank Line
     C                     Z-ADD*ZERO     WL0018           # of Blank Line
     C                     Z-ADD*ZERO     WL0019           # of Blank Line
     C                     MOVELYL0031    WL0020    P      EDODP Unused St
     C                     MOVELYL0031    WL0021    P      EDODP Unused St
     C                     Z-ADD*ZERO     WL0022           EDODP Unused Nb
     C                     Z-ADD*ZERO     WL0023           EDODP Unused Dt
     C                     MOVELYL0031    WL0024    P      EDODP Unused Tx
     C                     MOVELYL0031    WL0025    P      EDODP Unused Tx
     C                     EXSR SDRVGN
     C                     END                             *FI
      * Item Code Change, Create Exp Doc Order Dtl PRT Record.
      * CASE: DB1.ED Item Code NE LCL.ED Item Code
     C           WCDIC7    IFNE YL0025                     *IF
     C                     Z-ADDWCDIC7    YL0025           ED Item Code
      * Determine '# of Lines Reqd to Print'.
      * CASE: *OTHERWISE
      * Initialization.
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0026           # of Lines Reqd
     C                     MOVEL'N'       YL0032           Skip Ln Before
     C                     MOVEL'N'       YL0033           Skip Ln After X
     C                     MOVEL'N'       YL0034           Overflow
     C                     MOVEL'N'       YL0035           Prt Inspector N
      * CASE: DB1.ED Item Label Line 1 is Entered
     C           WCO3NA    IFNE *BLANK                     *IF
     C                     ADD  2         YL0022           Count USR
     C                     ADD  2         YL0026           # of Lines Reqd
      * For Continuation Overflow Page, Set Skip Line Before Xlate Desc.
      * CASE: LCL.USR Page Number 3.0 is Greater than 1
     C           YL0023    IFGT 1                          *IF
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10ORc11
      *   |- c1    : LCL.Count USR is Four
      *   |- c2    : LCL.Count USR is Six
      *   |- c3    : LCL.Count USR is Eight
      *   |- c4    : LCL.Count USR is Twelve
      *   |- c5    : LCL.Count USR is Fourteen
      *   |- c6    : LCL.Count USR is Eighteen
      *   |- c7    : LCL.Count USR is twenty-two
      *   |- c8    : LCL.Count USR is twenty-four
      *   |- c9    : LCL.Count USR is twenty-eight
      *   |- c10   : LCL.Count USR is Thirty
      *   |- c11   : LCL.Count USR is Thirty-Two
      *   '-
     C           YL0022    IFEQ 4                          *IF
     C           YL0022    OREQ 6                          *OR
     C           YL0022    OREQ 8                          *OR
     C           YL0022    OREQ 12                         *OR
     C           YL0022    OREQ 14                         *OR
     C           YL0022    OREQ 18                         *OR
     C           YL0022    OREQ 22                         *OR
     C           YL0022    OREQ 24                         *OR
     C           YL0022    OREQ 28                         *OR
     C           YL0022    OREQ 30                         *OR
     C           YL0022    OREQ 32                         *OR
     C                     MOVEL'Y'       YL0032           Skip Ln Before
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE:
      *  - c1 AND NOTc2
      *   |- c1    : DB1.ED Language Xlate Desc is Entered
      *   |- c2    : PAR.ED Xlate Desc to Country is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCK1U1    IFNE *BLANK                     *IF
     C           P2CVSX    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  2         YL0022           Count USR
     C                     ADD  2         YL0026           # of Lines Reqd
      * For Continuation Overflow Page, Set Skip Line After Xlate Desc.
      * CASE: LCL.USR Page Number 3.0 is Greater than 1
     C           YL0023    IFGT 1                          *IF
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10ORc11
      *   |- c1    : LCL.Count USR is Four
      *   |- c2    : LCL.Count USR is Six
      *   |- c3    : LCL.Count USR is Eight
      *   |- c4    : LCL.Count USR is Twelve
      *   |- c5    : LCL.Count USR is Fourteen
      *   |- c6    : LCL.Count USR is Eighteen
      *   |- c7    : LCL.Count USR is twenty-two
      *   |- c8    : LCL.Count USR is twenty-four
      *   |- c9    : LCL.Count USR is twenty-eight
      *   |- c10   : LCL.Count USR is Thirty
      *   |- c11   : LCL.Count USR is Thirty-Two
      *   '-
     C           YL0022    IFEQ 4                          *IF
     C           YL0022    OREQ 6                          *OR
     C           YL0022    OREQ 8                          *OR
     C           YL0022    OREQ 12                         *OR
     C           YL0022    OREQ 14                         *OR
     C           YL0022    OREQ 18                         *OR
     C           YL0022    OREQ 22                         *OR
     C           YL0022    OREQ 24                         *OR
     C           YL0022    OREQ 28                         *OR
     C           YL0022    OREQ 30                         *OR
     C           YL0022    OREQ 32                         *OR
     C                     MOVEL'Y'       YL0033           Skip Ln After X
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  YL0026    WN0003           # of Lines Reqd
      * 1st Page Exception to Print 9th Detail Line if No Label Ln2 or Xl
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.USR Page Number 3.0 is 1
      *   |- c2    : PAR.# of Lines Reqd to Print is GT 9
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0023    IFEQ 1                          *IF
     C           WN0003    IFGT 9                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DB1.ED Item Label Line 2 is Not Entered
     C           WCO4NA    IFEQ *BLANK                     *IF
     C                     SUB  1         WN0003           # of Lines Reqd
     C                     END                             *FI
      * CASE:
      *  - c1 AND NOTc2
      *   |- c1    : DB1.ED Language Xlate Desc 2 is Not Entered
      *   |- c2    : PAR.ED Xlate Desc to Country is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCRBTX    IFEQ *BLANK                     *IF
     C           P2CVSX    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     SUB  1         WN0003           # of Lines Reqd
     C                     END                             *FI
     C                     END                             *FI
      * Page 1 or Continuation Page Processing.
      * CASE: *OTHERWISE
      * Page 1 Else Not Page 1.
      * CASE: LCL.USR Page Number 3.0 is 1
     C           YL0023    IFEQ 1                          *IF
      * Determine Overflow Line to Print on Continuation Page.
      * CASE: PAR.# of Lines Reqd to Print is GT 9
     C           WN0003    IFGT 9                          *IF
      * Max detail lines to print on Page 1 of HC is 9. 5th box on
      * 1st page can only print 1 detail line else set Overflow.
     C                     MOVEL'Y'       YL0034           Overflow
     C                     MOVEL'Y'       WN0004           Prt Overflow Ds
     C                     ADD  1         YL0023           USR Page Number
      * Set Skip Line After. Will Print a Blank Line in the Overflow Cont
      * CASE: LCL.# of Lines Reqd to Print is 4
     C           YL0026    IFEQ 4                          *IF
     C                     MOVEL'Y'       YL0033           Skip Ln After X
     C                     END                             *FI
      * Reset Counter for Continuation Page.
     C                     Z-ADDYL0026    WN0003           # of Lines Reqd
     C                     Z-ADDYL0026    YL0022           Count USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Not Page 1. Continuation Page has total of 34 DTL lines (17 boxes
      * Determine Overflow Line to Print on Continuation Page.
      * CASE: PAR.# of Lines Reqd to Print is GT 34
     C           WN0003    IFGT 34                         *IF
      * Max detail lines to print on Continuation Page is 34.
     C                     MOVEL'Y'       YL0034           Overflow
     C                     MOVEL'Y'       WN0004           Prt Overflow Ds
     C                     ADD  1         YL0023           USR Page Number
      * Set Skip Line After. Will Print a Blank Line in the next Overflow
      * CASE: LCL.# of Lines Reqd to Print is 4
     C           YL0026    IFEQ 4                          *IF
     C                     MOVEL'Y'       YL0033           Skip Ln After X
     C                     END                             *FI
      * Update Previous Item Code to Print Inspector Name/Date Flag.
      * CASE: *OTHERWISE
      * Upd Prt Insp Name/Date RT - Export Doc Order Dtl PRT  * 
     C                     EXSR SIRVGN
      * Reset Counter for Continuation Page.
     C                     Z-ADDYL0026    WN0003           # of Lines Reqd
     C                     Z-ADDYL0026    YL0022           Count USR
     C                     END                             *FI
     C                     END                             *FI
      * Create Export Doc Order Dtl PRT (PUCFCPP) Record.
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0027           ED Language Xla
     C                     MOVEL*BLANK    YL0028           Description Xla
     C                     MOVEL*BLANK    YL0036           Overflow Pg Dsc
      * If 'Prt Overflow Dsc Xlate L1=Y' Then Update 'Overflow Pg Dsc Xla
      * CASE: PAR.Prt Overflow Dsc Xlate L1 is No
     C           WN0004    IFEQ 'N'                        *IF
      * CASE:
      *  - c1 AND NOTc2
      *   |- c1    : DB1.ED Language Xlate Desc is Entered
      *   |- c2    : PAR.ED Xlate Desc to Country is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCK1U1    IFNE *BLANK                     *IF
     C           P2CVSX    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELWCK1U1    YL0027           ED Language Xla
     C                     MOVEL*BLANK    YL0028           Description Xla
     C                     MOVELWCRBTX    YL0028           Description Xla
      * Spanish Translation.
      * CASE: PAR.ED Xlate Desc to Country is Spanish
     C           P2CVSX    IFEQ 'S'                        *IF
     C                     MOVEL*BLANK    YL0029           Text USR 12
     C                     MOVEL*BLANK    YL0030           Frozen/Chilled
      * Xlate Frozen/Chilled - Xlate Line Desc 1.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.ED Chilled/Frozen Text is Frozen
      *   |- c2    : DB1.ED Chilled/Frozen Text is FROZEN All Caps
      *   '-
     C           WCRMTX    IFEQ @CN,001                    *IF
     C           WCRMTX    OREQ @CN,002                    *OR
      * 06/19/24 SP S312722-Start
      * 06/19/24 SP S312722-End
     C                     Z-ADD10        YRSW00
     C                     Z-ADD31        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00040
     C           ZQ        ORGT 00040
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0027:ZQ YL0029    P  90  Text USR 12
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.ED Chilled/Frozen Text is Chilled
      *   |- c2    : DB1.ED Chilled/Frozen Text is CHILLED All Caps
      *   '-
     C           WCRMTX    IFEQ @CN,003                    *IF
     C           WCRMTX    OREQ @CN,004                    *OR
     C                     MOVEL@CN,005   YL0030           Frozen/Chilled
     C                     Z-ADD12        YRSW00
     C                     Z-ADD29        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00040
     C           ZQ        ORGT 00040
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0027:ZQ YL0029    P  90  Text USR 12
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * If Blank Then Append to Xlate Desc Line 1 Else to Xlate Desc Line
      * CASE: LCL.Text USR 12 is Not Entered
     C           YL0029    IFEQ *BLANK                     *IF
      * CASE: LCL.Description Xlate Line 2 is Not Entered
     C           YL0028    IFEQ *BLANK                     *IF
     C                     Z-ADD1         ZQ      50
     C           YL0027    CAT  YL0030:ZQ YL0027    P      ED Language Xla
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           YL0028    CAT  YL0030:ZQ YL0028    P      Description Xla
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Description Xlate Line 2 is Not Entered
     C           YL0028    IFEQ *BLANK                     *IF
     C                     Z-ADD0         ZQ      50
     C           YL0028    CAT  YL0030:ZQ YL0028    P      Description Xla
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           YL0028    CAT  YL0030:ZQ YL0028    P      Description Xla
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Format 'Overflow Pg Dsc Xlate Ln1' to Print on HC Overflow (PUH0P
      * CASE:
      *  - c1 AND NOTc2
      *   |- c1    : DB1.ED Language Xlate Desc is Entered
      *   |- c2    : PAR.ED Xlate Desc to Country is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCK1U1    IFNE *BLANK                     *IF
     C           P2CVSX    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    YL0036           Overflow Pg Dsc
     C                     MOVELWCK1U1    YL0036           Overflow Pg Dsc
     C                     MOVEL*BLANK    YL0028           Description Xla
     C                     MOVELWCRBTX    YL0028           Description Xla
      * Spanish Translation.
      * CASE: PAR.ED Xlate Desc to Country is Spanish
     C           P2CVSX    IFEQ 'S'                        *IF
     C                     MOVEL*BLANK    YL0029           Text USR 12
     C                     MOVEL*BLANK    YL0030           Frozen/Chilled
      * Xlate Frozen/Chilled - Xlate Line Desc 1.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.ED Chilled/Frozen Text is Frozen
      *   |- c2    : DB1.ED Chilled/Frozen Text is FROZEN All Caps
      *   '-
     C           WCRMTX    IFEQ @CN,001                    *IF
     C           WCRMTX    OREQ @CN,002                    *OR
      * 06/19/24 SP S312722-Start
      * 06/19/24 SP S312722-End
     C                     Z-ADD10        YRSW00
     C                     Z-ADD31        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00052
     C           ZQ        ORGT 00052
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0036:ZQ YL0029    P  90  Text USR 12
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.ED Chilled/Frozen Text is Chilled
      *   |- c2    : DB1.ED Chilled/Frozen Text is CHILLED All Caps
      *   '-
     C           WCRMTX    IFEQ @CN,003                    *IF
     C           WCRMTX    OREQ @CN,004                    *OR
     C                     MOVEL@CN,005   YL0030           Frozen/Chilled
     C                     Z-ADD12        YRSW00
     C                     Z-ADD29        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00052
     C           ZQ        ORGT 00052
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0036:ZQ YL0029    P  90  Text USR 12
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * If Blank Then Append to Xlate Desc Line 1 Else to Xlate Desc Line
      * CASE: LCL.Text USR 12 is Not Entered
     C           YL0029    IFEQ *BLANK                     *IF
      * CASE: LCL.Description Xlate Line 2 is Not Entered
     C           YL0028    IFEQ *BLANK                     *IF
     C                     Z-ADD1         ZQ      50
     C           YL0036    CAT  YL0030:ZQ YL0036    P      Overflow Pg Dsc
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           YL0028    CAT  YL0030:ZQ YL0028    P      Description Xla
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Description Xlate Line 2 is Not Entered
     C           YL0028    IFEQ *BLANK                     *IF
     C                     Z-ADD0         ZQ      50
     C           YL0028    CAT  YL0030:ZQ YL0028    P      Description Xla
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           YL0028    CAT  YL0030:ZQ YL0028    P      Description Xla
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Will use PRTOBJ to print the Language Translated Desc in the HC p
      * Crt Exp Doc Ord Dtl PRTRT - Export Doc Order Dtl PRT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0001           Company Number
     C                     Z-ADDWCC4NB    WL0002           Order Number
     C                     MOVELWCDGSX    WL0003    P      ED Export Docum
     C                     MOVELWCKXCD    WL0004    P      Country Code
     C                     Z-ADDWCDIC7    WL0005           Item Code
     C                     MOVELYL0027    WL0006    P      Description Xla
     C                     MOVELYL0028    WL0007    P      Description Xla
     C                     MOVELYL0036    WL0008    P      Overflow Pg Dsc
     C                     MOVELYL0034    WL0009    P      Overflow
     C                     Z-ADD*ZERO     WL0010           EDODP Unused Nu
     C                     MOVELYL0032    WL0011    P      Skip Ln Before
     C                     MOVELYL0033    WL0012    P      Skip Ln After X
     C                     MOVELYL0035    WL0013    P      Prt Inspector N
     C                     MOVEL*BLANK    WL0014           Item Printed
     C                     MOVELYL0031    WL0015    P      Prt Continuatio
     C                     Z-ADD*ZERO     WL0016           # of Blank Line
     C                     Z-ADD*ZERO     WL0017           # of Blank Line
     C                     Z-ADD*ZERO     WL0018           # of Blank Line
     C                     Z-ADD*ZERO     WL0019           # of Blank Line
     C                     MOVELYL0031    WL0020    P      EDODP Unused St
     C                     MOVELYL0031    WL0021    P      EDODP Unused St
     C                     Z-ADD*ZERO     WL0022           EDODP Unused Nb
     C                     Z-ADD*ZERO     WL0023           EDODP Unused Dt
     C                     MOVELYL0031    WL0024    P      EDODP Unused Tx
     C                     MOVELYL0031    WL0025    P      EDODP Unused Tx
     C                     EXSR SDRVGN
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSH     READE@MSREEM                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Upd Prt Insp Name/Date RT - Export Doc Order Dtl PRT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSI01           Company Number
     C           *LIKE     DEFN WDC4NB    WQSI02           Order Number
     C           *LIKE     DEFN WDDGSX    WQSI03           ED Export Docum
     C           *LIKE     DEFN WDKXCD    WQSI04           Country Code
      * Define keylist
     C           KPSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Order Number
     C                     KFLD           WQSI03           ED Export Docum
     C                     KFLD           WQSI04           Country Code
     C                     KFLD           WDHGCD           Item Code
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Order Number
     C                     KFLD           WQSI03           ED Export Docum
     C                     KFLD           WQSI04           Country Code
      * Setup key
     C                     Z-ADDWCAIC3    WQSI01           Company Number
     C                     Z-ADDWCC4NB    WQSI02           Order Number
     C                     MOVELWCDGSX    WQSI03           ED Export Docum
     C                     MOVELWCKXCD    WQSI04           Country Code
     C                     Z-ADDWCDIC7    WDHGCD           Item Code
      * Establish starting position
     C           KPSSI     SETLL@CFCPJ0                    *
     C           KRSSI     READE@CFCPJ0                  90*
      * Data record not found
     C   90                MOVEL'USR5245' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Doc Ord Dtl PRT   CH - Export Doc Order Dtl PRT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0031           Company Number
     C                     Z-ADDWDC4NB    WL0032           Order Number
     C                     MOVELWDDGSX    WL0033    P      ED Export Docum
     C                     MOVELWDKXCD    WL0034    P      Country Code
     C                     Z-ADDWDHGCD    WL0035           Item Code
     C                     MOVELWDRDU1    WL0036    P      Description Xla
     C                     MOVELWDREU1    WL0037    P      Description Xla
     C                     MOVELWDRFU1    WL0038    P      Overflow Pg Dsc
     C                     MOVELWDMYSC    WL0039    P      Overflow
     C                     Z-ADDWDG2NZ    WL0040           EDODP Unused Nu
     C                     MOVELWDM9SC    WL0041    P      Skip Ln Before
     C                     MOVELWDNASC    WL0042    P      Skip Ln After X
     C                     MOVEL'Y'       WL0043    P      Prt Inspector N
     C                     MOVELWDMZSC    WL0044    P      Item Printed
     C                     MOVELWDM5SC    WL0045    P      Prt Continuatio
     C                     Z-ADDWDG7NZ    WL0046           # of Blank Line
     C                     Z-ADDWDG8NZ    WL0047           # of Blank Line
     C                     Z-ADDWDG9NZ    WL0048           # of Blank Line
     C                     Z-ADDWDHANZ    WL0049           # of Blank Line
     C                     MOVELWDM6SC    WL0050    P      EDODP Unused St
     C                     MOVELWDM7SC    WL0051    P      EDODP Unused St
     C                     Z-ADDWDG3NZ    WL0052           EDODP Unused Nb
     C                     Z-ADDWDXSDT    WL0053           EDODP Unused Dt
     C                     MOVELWDRLU1    WL0054    P      EDODP Unused Tx
     C                     MOVELWDRMU1    WL0055    P      EDODP Unused Tx
     C                     EXSR SGCHRC
     C                     GOTO SIEXIT                     *QUIT
     C           KRSSI     READE@CFCPJ0                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Crt EDOD PRT-Appl Exp RT - Export Doc Order Dtl  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0005  30       # of Lines Reqd
     C                     MOVEL*BLANK    WN0006  1        Prt Overflow Ds
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0037           Count USR
     C                     Z-ADD1         YL0038           USR Page Number
     C                     MOVEL'Y'       YL0039           First Time Flag
     C                     Z-ADD*ZERO     YL0040           1st Page Line C
     C                     Z-ADD*ZERO     WN0005           # of Lines Reqd
     C                     MOVEL'N'       WN0006           Prt Overflow Ds
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSJ02           Order Number
     C           *LIKE     DEFN WCDGSX    WQSJ03           ED Export Docum
     C           *LIKE     DEFN WCKXCD    WQSJ04           Country Code
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Order Number
     C                     KFLD           WQSJ03           ED Export Docum
     C                     KFLD           WQSJ04           Country Code
      * Setup key
     C                     Z-ADDP1AIC3    WQSJ01           Company Number
     C                     Z-ADDP1C4NB    WQSJ02           Order Number
     C                     MOVELP1DGSX    WQSJ03           ED Export Docum
     C                     MOVELP1KXCD    WQSJ04           Country Code
      * Establish starting position
     C           KRSSJ     SETLL@MSREEM                    *
     C           KRSSJ     READE@MSREEM                  90*
      * Data record not found
     C   90                MOVEL'USR2745' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Do NOT check ED Product Net Weight lbs is entered here,
      * the Application Export prints before the HC doc hence no
      * weight will exist, per RC.
      * First Time Thru, Create Exp Doc Order Dtl PRT Record.
      * CASE: LCL.First Time Flag is Yes
     C           YL0039    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       YL0039           First Time Flag
     C                     Z-ADDWCDIC7    YL0041           ED Item Code
      * Determine '# of Lines Reqd to Print'.
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0042           # of Lines Reqd
     C                     MOVEL'N'       YL0043           Skip Ln After X
      * CASE: DB1.ED Item Label Line 1 is Entered
     C           WCO3NA    IFNE *BLANK                     *IF
     C                     ADD  2         YL0042           # of Lines Reqd
     C                     END                             *FI
      * CASE:
      *  - c1 AND NOTc2
      *   |- c1    : DB1.ED Language Xlate Desc is Entered
      *   |- c2    : PAR.ED Xlate Desc to Country is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCK1U1    IFNE *BLANK                     *IF
     C           P2CVSX    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  2         YL0042           # of Lines Reqd
      * For 1st Page, Set Skip Line Before/After Xlate Desc.
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0043           Skip Ln After X
     C                     END                             *FI
     C                     Z-ADDYL0042    WN0005           # of Lines Reqd
     C                     Z-ADDYL0042    YL0040           1st Page Line C
      * Create Exp Doc Order Dtl PRT.
      * CASE: *OTHERWISE
      * CASE:
      *  - c1 AND NOTc2
      *   |- c1    : DB1.ED Language Xlate Desc is Entered
      *   |- c2    : PAR.ED Xlate Desc to Country is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCK1U1    IFNE *BLANK                     *IF
     C           P2CVSX    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Always use 'Overflow Pg Dsc Xlate Ln1' for Appl Export Doc.
     C                     MOVEL*BLANK    YL0044           Overflow Pg Dsc
     C                     MOVELWCK1U1    YL0044           Overflow Pg Dsc
     C                     MOVEL*BLANK    YL0045           Description Xla
     C                     MOVELWCRBTX    YL0045           Description Xla
      * Spanish Translation.
      * CASE: PAR.ED Xlate Desc to Country is Spanish
     C           P2CVSX    IFEQ 'S'                        *IF
     C                     MOVEL*BLANK    YL0046           Text USR 12
     C                     MOVEL*BLANK    YL0047           Frozen/Chilled
      * Xlate Frozen/Chilled - Xlate Line Desc 1.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.ED Chilled/Frozen Text is Frozen
      *   |- c2    : DB1.ED Chilled/Frozen Text is FROZEN All Caps
      *   '-
     C           WCRMTX    IFEQ @CN,001                    *IF
     C           WCRMTX    OREQ @CN,002                    *OR
      * 06/19/24 SP S312722-Start
      * 06/19/24 SP S312722-End
     C                     Z-ADD10        YRSW00
     C                     Z-ADD31        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00052
     C           ZQ        ORGT 00052
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0044:ZQ YL0046    P  90  Text USR 12
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.ED Chilled/Frozen Text is Chilled
      *   |- c2    : DB1.ED Chilled/Frozen Text is CHILLED All Caps
      *   '-
     C           WCRMTX    IFEQ @CN,003                    *IF
     C           WCRMTX    OREQ @CN,004                    *OR
     C                     MOVEL@CN,005   YL0047           Frozen/Chilled
     C                     Z-ADD12        YRSW00
     C                     Z-ADD29        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00052
     C           ZQ        ORGT 00052
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0044:ZQ YL0046    P  90  Text USR 12
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * If Blank Then Append to Xlate Desc Line 1 Else to Xlate Desc Line
      * CASE: LCL.Text USR 12 is Not Entered
     C           YL0046    IFEQ *BLANK                     *IF
      * CASE: LCL.Description Xlate Line 2 is Not Entered
     C           YL0045    IFEQ *BLANK                     *IF
     C                     Z-ADD1         ZQ      50
     C           YL0044    CAT  YL0047:ZQ YL0044    P      Overflow Pg Dsc
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           YL0045    CAT  YL0047:ZQ YL0045    P      Description Xla
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Description Xlate Line 2 is Not Entered
     C           YL0045    IFEQ *BLANK                     *IF
     C                     Z-ADD0         ZQ      50
     C           YL0045    CAT  YL0047:ZQ YL0045    P      Description Xla
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           YL0045    CAT  YL0047:ZQ YL0045    P      Description Xla
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0048           ED Language Xla
      * Force no print of Xlate Desc Line 2 if Xlate Desc Line 1 is not e
     C                     MOVEL*BLANK    YL0045           Description Xla
     C                     END                             *FI
      * Crt Exp Doc Ord Dtl PRTRT - Export Doc Order Dtl PRT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0001           Company Number
     C                     Z-ADDWCC4NB    WL0002           Order Number
     C                     MOVELWCDGSX    WL0003    P      ED Export Docum
     C                     MOVELWCKXCD    WL0004    P      Country Code
     C                     Z-ADDWCDIC7    WL0005           Item Code
     C                     MOVEL*BLANK    WL0006           Description Xla
     C                     MOVELYL0045    WL0007    P      Description Xla
     C                     MOVELYL0044    WL0008    P      Overflow Pg Dsc
     C                     MOVEL'N'       WL0009    P      Overflow
     C                     Z-ADD*ZERO     WL0010           EDODP Unused Nu
     C                     MOVEL'N'       WL0011    P      Skip Ln Before
     C                     MOVELYL0043    WL0012    P      Skip Ln After X
     C                     MOVEL'N'       WL0013    P      Prt Inspector N
     C                     MOVEL*BLANK    WL0014           Item Printed
     C                     MOVELYL0049    WL0015    P      Prt Continuatio
     C                     Z-ADD*ZERO     WL0016           # of Blank Line
     C                     Z-ADD*ZERO     WL0017           # of Blank Line
     C                     Z-ADD*ZERO     WL0018           # of Blank Line
     C                     Z-ADD*ZERO     WL0019           # of Blank Line
     C                     MOVELYL0049    WL0020    P      EDODP Unused St
     C                     MOVELYL0049    WL0021    P      EDODP Unused St
     C                     Z-ADD*ZERO     WL0022           EDODP Unused Nb
     C                     Z-ADD*ZERO     WL0023           EDODP Unused Dt
     C                     MOVELYL0049    WL0024    P      EDODP Unused Tx
     C                     MOVELYL0049    WL0025    P      EDODP Unused Tx
     C                     EXSR SDRVGN
     C                     END                             *FI
      * Item Code Change, Create Exp Doc Order Dtl PRT Record.
      * CASE: DB1.ED Item Code NE LCL.ED Item Code
     C           WCDIC7    IFNE YL0041                     *IF
     C                     Z-ADDWCDIC7    YL0041           ED Item Code
      * Determine '# of Lines Reqd to Print'.
      * CASE: *OTHERWISE
      * Initialization.
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0042           # of Lines Reqd
     C                     MOVEL'N'       YL0050           Skip Ln Before
     C                     MOVEL'N'       YL0043           Skip Ln After X
     C                     MOVEL'N'       YL0051           Overflow
     C                     MOVEL'N'       YL0052           Prt Inspector N
      * CASE: DB1.ED Item Label Line 1 is Entered
     C           WCO3NA    IFNE *BLANK                     *IF
     C                     ADD  2         YL0037           Count USR
     C                     ADD  2         YL0042           # of Lines Reqd
      * For 1st Page, Set Skip Line Before Xlate Desc.
      * CASE: LCL.USR Page Number 3.0 is 1
     C           YL0038    IFEQ 1                          *IF
     C                     ADD  2         YL0040           1st Page Line C
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : LCL.1st Page Line Counter USR is Four
      *   |- c2    : LCL.1st Page Line Counter USR is Six
      *   |- c3    : LCL.1st Page Line Counter USR is Eight
      *   '-
     C           YL0040    IFEQ 4                          *IF
     C           YL0040    OREQ 6                          *OR
     C           YL0040    OREQ 8                          *OR
     C                     MOVEL'Y'       YL0050           Skip Ln Before
     C                     END                             *FI
     C                     END                             *FI
      * For Continuation Overflow Page, Set Skip Line Before Xlate Desc.
      * CASE: LCL.USR Page Number 3.0 is Greater than 1
     C           YL0038    IFGT 1                          *IF
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10ORc11ORc12ORc13
      *   |- c1    : LCL.Count USR is Four
      *   |- c2    : LCL.Count USR is Eight
      *   |- c3    : LCL.Count USR is Twelve
      *   |- c4    : LCL.Count USR is Sixteen
      *   |- c5    : LCL.Count USR is Twenty
      *   |- c6    : LCL.Count USR is twenty-two
      *   |- c7    : LCL.Count USR is twenty-eight
      *   |- c8    : LCL.Count USR is Thirty
      *   |- c9    : LCL.Count USR is Thirty-Four
      *   |- c10   : LCL.Count USR is Thirty-Eight
      *   |- c11   : LCL.Count USR is Forty
      *   |- c12   : LCL.Count USR is Forty-Four
      *   |- c13   : LCL.Count USR is Forty-Eight
      *   '-
     C           YL0037    IFEQ 4                          *IF
     C           YL0037    OREQ 8                          *OR
     C           YL0037    OREQ 12                         *OR
     C           YL0037    OREQ 16                         *OR
     C           YL0037    OREQ 20                         *OR
     C           YL0037    OREQ 22                         *OR
     C           YL0037    OREQ 28                         *OR
     C           YL0037    OREQ 30                         *OR
     C           YL0037    OREQ 34                         *OR
     C           YL0037    OREQ 38                         *OR
     C           YL0037    OREQ 40                         *OR
     C           YL0037    OREQ 44                         *OR
     C           YL0037    OREQ 48                         *OR
     C                     MOVEL'Y'       YL0050           Skip Ln Before
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE:
      *  - c1 AND NOTc2
      *   |- c1    : DB1.ED Language Xlate Desc is Entered
      *   |- c2    : PAR.ED Xlate Desc to Country is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCK1U1    IFNE *BLANK                     *IF
     C           P2CVSX    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  2         YL0037           Count USR
     C                     ADD  2         YL0042           # of Lines Reqd
      * For 1st Page, Set Skip Line After Xlate Desc.
      * CASE: LCL.USR Page Number 3.0 is 1
     C           YL0038    IFEQ 1                          *IF
     C                     ADD  2         YL0040           1st Page Line C
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : LCL.1st Page Line Counter USR is Four
      *   |- c2    : LCL.1st Page Line Counter USR is Six
      *   |- c3    : LCL.1st Page Line Counter USR is Eight
      *   '-
     C           YL0040    IFEQ 4                          *IF
     C           YL0040    OREQ 6                          *OR
     C           YL0040    OREQ 8                          *OR
     C                     MOVEL'Y'       YL0043           Skip Ln After X
     C                     END                             *FI
     C                     END                             *FI
      * For Continuation Overflow Page, Set Skip Line After Xlate Desc.
      * CASE: LCL.USR Page Number 3.0 is Greater than 1
     C           YL0038    IFGT 1                          *IF
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10ORc11ORc12ORc13
      *   |- c1    : LCL.Count USR is Four
      *   |- c2    : LCL.Count USR is Eight
      *   |- c3    : LCL.Count USR is Twelve
      *   |- c4    : LCL.Count USR is Sixteen
      *   |- c5    : LCL.Count USR is Twenty
      *   |- c6    : LCL.Count USR is twenty-two
      *   |- c7    : LCL.Count USR is twenty-eight
      *   |- c8    : LCL.Count USR is Thirty
      *   |- c9    : LCL.Count USR is Thirty-Four
      *   |- c10   : LCL.Count USR is Thirty-Eight
      *   |- c11   : LCL.Count USR is Forty
      *   |- c12   : LCL.Count USR is Forty-Four
      *   |- c13   : LCL.Count USR is Forty-Eight
      *   '-
     C           YL0037    IFEQ 4                          *IF
     C           YL0037    OREQ 8                          *OR
     C           YL0037    OREQ 12                         *OR
     C           YL0037    OREQ 16                         *OR
     C           YL0037    OREQ 20                         *OR
     C           YL0037    OREQ 22                         *OR
     C           YL0037    OREQ 28                         *OR
     C           YL0037    OREQ 30                         *OR
     C           YL0037    OREQ 34                         *OR
     C           YL0037    OREQ 38                         *OR
     C           YL0037    OREQ 40                         *OR
     C           YL0037    OREQ 44                         *OR
     C           YL0037    OREQ 48                         *OR
     C                     MOVEL'Y'       YL0043           Skip Ln After X
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  YL0042    WN0005           # of Lines Reqd
      * Page 1 or Continuation Page Processing.
      * CASE: *OTHERWISE
      * Page 1 Else Not Page 1.
      * CASE: LCL.USR Page Number 3.0 is 1
     C           YL0038    IFEQ 1                          *IF
      * Determine Overflow Line to Print on Continuation Page.
      * CASE: PAR.# of Lines Reqd to Print is GT 10
     C           WN0005    IFGT 10                         *IF
      * Max detail lines to print on Page 1 is 10 else set Overflow On.
     C                     MOVEL'Y'       YL0051           Overflow
     C                     MOVEL'Y'       WN0006           Prt Overflow Ds
     C                     ADD  1         YL0038           USR Page Number
      * Set Skip Line After. Will Print a Blank Line in the Overflow Cont
      * CASE: LCL.# of Lines Reqd to Print is 4
     C           YL0042    IFEQ 4                          *IF
     C                     MOVEL'Y'       YL0043           Skip Ln After X
     C                     END                             *FI
      * Reset Counter for Continuation Page.
     C                     Z-ADDYL0042    WN0005           # of Lines Reqd
     C                     Z-ADDYL0042    YL0037           Count USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Not Page 1. Continuation Page has total of 50 DTL lines (25 boxes
      * Determine Overflow Line to Print on Continuation Page.
      * CASE: PAR.# of Lines Reqd to Print is GT 50
     C           WN0005    IFGT 50                         *IF
      * Max detail lines to print on Continuation Page is 50.
     C                     MOVEL'Y'       YL0051           Overflow
     C                     MOVEL'Y'       WN0006           Prt Overflow Ds
     C                     ADD  1         YL0038           USR Page Number
      * Set Skip Line After. Will Print a Blank Line in the next Overflow
      * CASE: LCL.# of Lines Reqd to Print is 4
     C           YL0042    IFEQ 4                          *IF
     C                     MOVEL'Y'       YL0043           Skip Ln After X
     C                     END                             *FI
      * Update Previous Item Code to Print Continuation Text Flag.
      * CASE: *OTHERWISE
      * Upd Prt Continuation  RT - Export Doc Order Dtl PRT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0026           Company Number
     C                     Z-ADDWCC4NB    WL0027           Order Number
     C                     MOVELWCDGSX    WL0028    P      ED Export Docum
     C                     MOVELWCKXCD    WL0029    P      Country Code
     C                     Z-ADDWCDIC7    WL0030           Item Code
     C                     EXSR SFRVGN
      * Reset Counter for Continuation Page.
     C                     Z-ADDYL0042    WN0005           # of Lines Reqd
     C                     Z-ADDYL0042    YL0037           Count USR
     C                     END                             *FI
     C                     END                             *FI
      * Create Export Doc Order Dtl PRT (PUCFCPP) Record.
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0048           ED Language Xla
     C                     MOVEL*BLANK    YL0045           Description Xla
     C                     MOVEL*BLANK    YL0044           Overflow Pg Dsc
      * Format 'Overflow Pg Dsc Xlate Ln1' to Print on Appl Overflow (PUI
      * CASE:
      *  - c1 AND NOTc2
      *   |- c1    : DB1.ED Language Xlate Desc is Entered
      *   |- c2    : PAR.ED Xlate Desc to Country is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCK1U1    IFNE *BLANK                     *IF
     C           P2CVSX    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Always use 'Overflow Pg Dsc Xlate Ln1' for Appl Export Doc.
     C                     MOVEL*BLANK    YL0044           Overflow Pg Dsc
     C                     MOVELWCK1U1    YL0044           Overflow Pg Dsc
     C                     MOVEL*BLANK    YL0045           Description Xla
     C                     MOVELWCRBTX    YL0045           Description Xla
      * Spanish Translation.
      * CASE: PAR.ED Xlate Desc to Country is Spanish
     C           P2CVSX    IFEQ 'S'                        *IF
     C                     MOVEL*BLANK    YL0046           Text USR 12
     C                     MOVEL*BLANK    YL0047           Frozen/Chilled
      * Xlate Frozen/Chilled - Xlate Line Desc 1.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.ED Chilled/Frozen Text is Frozen
      *   |- c2    : DB1.ED Chilled/Frozen Text is FROZEN All Caps
      *   '-
     C           WCRMTX    IFEQ @CN,001                    *IF
     C           WCRMTX    OREQ @CN,002                    *OR
      * 06/19/24 SP S312722-Start
      * 06/19/24 SP S312722-End
     C                     Z-ADD10        YRSW00
     C                     Z-ADD31        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00052
     C           ZQ        ORGT 00052
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0044:ZQ YL0046    P  90  Text USR 12
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.ED Chilled/Frozen Text is Chilled
      *   |- c2    : DB1.ED Chilled/Frozen Text is CHILLED All Caps
      *   '-
     C           WCRMTX    IFEQ @CN,003                    *IF
     C           WCRMTX    OREQ @CN,004                    *OR
     C                     MOVEL@CN,005   YL0047           Frozen/Chilled
     C                     Z-ADD12        YRSW00
     C                     Z-ADD29        ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00052
     C           ZQ        ORGT 00052
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0044:ZQ YL0046    P  90  Text USR 12
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * If Blank Then Append to Xlate Desc Line 1 Else to Xlate Desc Line
      * CASE: LCL.Text USR 12 is Not Entered
     C           YL0046    IFEQ *BLANK                     *IF
      * CASE: LCL.Description Xlate Line 2 is Not Entered
     C           YL0045    IFEQ *BLANK                     *IF
     C                     Z-ADD1         ZQ      50
     C           YL0044    CAT  YL0047:ZQ YL0044    P      Overflow Pg Dsc
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           YL0045    CAT  YL0047:ZQ YL0045    P      Description Xla
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.Description Xlate Line 2 is Not Entered
     C           YL0045    IFEQ *BLANK                     *IF
     C                     Z-ADD0         ZQ      50
     C           YL0045    CAT  YL0047:ZQ YL0045    P      Description Xla
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           YL0045    CAT  YL0047:ZQ YL0045    P      Description Xla
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Crt Exp Doc Ord Dtl PRTRT - Export Doc Order Dtl PRT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0001           Company Number
     C                     Z-ADDWCC4NB    WL0002           Order Number
     C                     MOVELWCDGSX    WL0003    P      ED Export Docum
     C                     MOVELWCKXCD    WL0004    P      Country Code
     C                     Z-ADDWCDIC7    WL0005           Item Code
     C                     MOVEL*BLANK    WL0006           Description Xla
     C                     MOVELYL0045    WL0007    P      Description Xla
     C                     MOVELYL0044    WL0008    P      Overflow Pg Dsc
     C                     MOVELYL0051    WL0009    P      Overflow
     C                     Z-ADDYL0053    WL0010           EDODP Unused Nu
     C                     MOVELYL0050    WL0011    P      Skip Ln Before
     C                     MOVELYL0043    WL0012    P      Skip Ln After X
     C                     MOVEL'N'       WL0013    P      Prt Inspector N
     C                     MOVEL*BLANK    WL0014           Item Printed
     C                     MOVELYL0049    WL0015    P      Prt Continuatio
     C                     Z-ADD*ZERO     WL0016           # of Blank Line
     C                     Z-ADD*ZERO     WL0017           # of Blank Line
     C                     Z-ADD*ZERO     WL0018           # of Blank Line
     C                     Z-ADD*ZERO     WL0019           # of Blank Line
     C                     MOVELYL0049    WL0020    P      EDODP Unused St
     C                     MOVELYL0049    WL0021    P      EDODP Unused St
     C                     Z-ADD*ZERO     WL0022           EDODP Unused Nb
     C                     Z-ADD*ZERO     WL0023           EDODP Unused Dt
     C                     MOVELYL0049    WL0024    P      EDODP Unused Tx
     C                     MOVELYL0049    WL0025    P      EDODP Unused Tx
     C                     EXSR SDRVGN
     C                     END                             *FI
     C           KRSSJ     READE@MSREEM                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAG2NZ           EDODP Unused Nu
     C                     Z-ADD*ZERO     WAG7NZ           # of Blank Line
     C                     Z-ADD*ZERO     WAG8NZ           # of Blank Line
     C                     Z-ADD*ZERO     WAG9NZ           # of Blank Line
     C                     Z-ADD*ZERO     WAHANZ           # of Blank Line
     C                     Z-ADD*ZERO     WAG3NZ           EDODP Unused Nb
     C                     Z-ADD*ZERO     WAXSDT           EDODP Unused Dt
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCDIC7           ED Item Code
     C                     Z-ADD*ZERO     WCHJWG           ED Product Net
     C                     Z-ADD*ZERO     WCHKWG           ED Product Net
     C                     Z-ADD*ZERO     WCAONX           ED Product Nbr
     C                     Z-ADD*ZERO     WCAMNX           ED Pieces per B
     C                     Z-ADD*ZERO     WCANNX           ED Bags per Uni
     C                     Z-ADD*ZERO     WCAPNX           ED Total Nbr of
     C                     Z-ADD*ZERO     WCDKPR           ED Product Unit
     C                     Z-ADD*ZERO     WCA9VL           ED Producet Ext
     C                     Z-ADD*ZERO     WCAJNX           ED Consignee Ad
     C                     Z-ADD*ZERO     WCW0DT           ED Nbr of Packi
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  1
     C                     MOVEL*BLANK    WL0004  6
     C                     Z-ADD*ZERO     WL0005  70
     C                     MOVEL*BLANK    WL0006 40
     C                     MOVEL*BLANK    WL0007 40
     C                     MOVEL*BLANK    WL0008 52
     C                     MOVEL*BLANK    WL0009  1
     C                     Z-ADD*ZERO     WL0010  10
     C                     MOVEL*BLANK    WL0011  1
     C                     MOVEL*BLANK    WL0012  1
     C                     MOVEL*BLANK    WL0013  1
     C                     MOVEL*BLANK    WL0014  1
     C                     MOVEL*BLANK    WL0015  1
     C                     Z-ADD*ZERO     WL0016  10
     C                     Z-ADD*ZERO     WL0017  10
     C                     Z-ADD*ZERO     WL0018  10
     C                     Z-ADD*ZERO     WL0019  10
     C                     MOVEL*BLANK    WL0020  1
     C                     MOVEL*BLANK    WL0021  1
     C                     Z-ADD*ZERO     WL0022  70
     C                     Z-ADD*ZERO     WL0023  70
     C                     MOVEL*BLANK    WL0024 40
     C                     MOVEL*BLANK    WL0025 40
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0026  30
     C                     Z-ADD*ZERO     WL0027  70
     C                     MOVEL*BLANK    WL0028  1
     C                     MOVEL*BLANK    WL0029  6
     C                     Z-ADD*ZERO     WL0030  70
      * Define local variables for subroutine SGCHRC.
     C                     Z-ADD*ZERO     WL0031  30
     C                     Z-ADD*ZERO     WL0032  70
     C                     MOVEL*BLANK    WL0033  1
     C                     MOVEL*BLANK    WL0034  6
     C                     Z-ADD*ZERO     WL0035  70
     C                     MOVEL*BLANK    WL0036 40
     C                     MOVEL*BLANK    WL0037 40
     C                     MOVEL*BLANK    WL0038 52
     C                     MOVEL*BLANK    WL0039  1
     C                     Z-ADD*ZERO     WL0040  10
     C                     MOVEL*BLANK    WL0041  1
     C                     MOVEL*BLANK    WL0042  1
     C                     MOVEL*BLANK    WL0043  1
     C                     MOVEL*BLANK    WL0044  1
     C                     MOVEL*BLANK    WL0045  1
     C                     Z-ADD*ZERO     WL0046  10
     C                     Z-ADD*ZERO     WL0047  10
     C                     Z-ADD*ZERO     WL0048  10
     C                     Z-ADD*ZERO     WL0049  10
     C                     MOVEL*BLANK    WL0050  1
     C                     MOVEL*BLANK    WL0051  1
     C                     Z-ADD*ZERO     WL0052  70
     C                     Z-ADD*ZERO     WL0053  70
     C                     MOVEL*BLANK    WL0054 40
     C                     MOVEL*BLANK    WL0055 40
      * Define local work field USR Counter
     C                     Z-ADD*ZERO     YL0001  50
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field 1st Page Line Counter USR
     C                     Z-ADD*ZERO     YL0003  30
      * Define local work field Force Xlate Dsc Ln2 Prt U
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field ED Item Code
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field # of Lines Reqd to Print
     C                     Z-ADD*ZERO     YL0006  30
      * Define local work field Skip Ln Before Xlate Ln1
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field Skip Ln After Xlate Ln2
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field # of Blank Line-Item Ln1
     C                     Z-ADD*ZERO     YL0009  10
      * Define local work field # of Blank Line-Item Ln2
     C                     Z-ADD*ZERO     YL0010  10
      * Define local work field # of Blank Line-Xlate Ln1
     C                     Z-ADD*ZERO     YL0011  10
      * Define local work field # of Blank Line-Xlate Ln2
     C                     Z-ADD*ZERO     YL0012  10
      * Define local work field Overflow Pg Dsc Xlate Ln1
     C                     MOVEL*BLANK    YL0013 52
      * Define local work field Description Xlate Line 2
     C                     MOVEL*BLANK    YL0014 40
      * Define local work field Text USR 12
     C                     MOVEL*BLANK    YL0015 12
      * Define local work field Frozen/Chilled as Spanish
     C                     MOVEL*BLANK    YL0016 11
      * Define local work field ED Language Xlate Desc
     C                     MOVEL*BLANK    YL0017 40
      * Define local work field Blank 1 USR
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field EDODP Unused Number
     C                     Z-ADD*ZERO     YL0019  10
      * Define local work field Overflow
     C                     MOVEL*BLANK    YL0020  1
      * Define local work field Prt Inspector Name/Date
     C                     MOVEL*BLANK    YL0021  1
      * Define local work field Count USR
     C                     Z-ADD*ZERO     YL0022  50
      * Define local work field USR Page Number 3.0
     C                     Z-ADD*ZERO     YL0023  30
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0024  1
      * Define local work field ED Item Code
     C                     Z-ADD*ZERO     YL0025  70
      * Define local work field # of Lines Reqd to Print
     C                     Z-ADD*ZERO     YL0026  30
      * Define local work field ED Language Xlate Desc
     C                     MOVEL*BLANK    YL0027 40
      * Define local work field Description Xlate Line 2
     C                     MOVEL*BLANK    YL0028 40
      * Define local work field Text USR 12
     C                     MOVEL*BLANK    YL0029 12
      * Define local work field Frozen/Chilled as Spanish
     C                     MOVEL*BLANK    YL0030 11
      * Define local work field Blank 1 USR
     C                     MOVEL*BLANK    YL0031  1
      * Define local work field Skip Ln Before Xlate Ln1
     C                     MOVEL*BLANK    YL0032  1
      * Define local work field Skip Ln After Xlate Ln2
     C                     MOVEL*BLANK    YL0033  1
      * Define local work field Overflow
     C                     MOVEL*BLANK    YL0034  1
      * Define local work field Prt Inspector Name/Date
     C                     MOVEL*BLANK    YL0035  1
      * Define local work field Overflow Pg Dsc Xlate Ln1
     C                     MOVEL*BLANK    YL0036 52
      * Define local work field Count USR
     C                     Z-ADD*ZERO     YL0037  50
      * Define local work field USR Page Number 3.0
     C                     Z-ADD*ZERO     YL0038  30
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0039  1
      * Define local work field 1st Page Line Counter USR
     C                     Z-ADD*ZERO     YL0040  30
      * Define local work field ED Item Code
     C                     Z-ADD*ZERO     YL0041  70
      * Define local work field # of Lines Reqd to Print
     C                     Z-ADD*ZERO     YL0042  30
      * Define local work field Skip Ln After Xlate Ln2
     C                     MOVEL*BLANK    YL0043  1
      * Define local work field Overflow Pg Dsc Xlate Ln1
     C                     MOVEL*BLANK    YL0044 52
      * Define local work field Description Xlate Line 2
     C                     MOVEL*BLANK    YL0045 40
      * Define local work field Text USR 12
     C                     MOVEL*BLANK    YL0046 12
      * Define local work field Frozen/Chilled as Spanish
     C                     MOVEL*BLANK    YL0047 11
      * Define local work field ED Language Xlate Desc
     C                     MOVEL*BLANK    YL0048 40
      * Define local work field Blank 1 USR
     C                     MOVEL*BLANK    YL0049  1
      * Define local work field Skip Ln Before Xlate Ln1
     C                     MOVEL*BLANK    YL0050  1
      * Define local work field Overflow
     C                     MOVEL*BLANK    YL0051  1
      * Define local work field Prt Inspector Name/Date
     C                     MOVEL*BLANK    YL0052  1
      * Define local work field EDODP Unused Number
     C                     Z-ADD*ZERO     YL0053  10
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Frozen
00002 FROZEN
00003 Chilled
00004 CHILLED
00005 REFRIGERADO
