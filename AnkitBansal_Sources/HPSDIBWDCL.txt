/***************************************************************** */
/*                                                                 */
/*  System:          Hog Procurement System  (HPS)                 */
/*  Program Number:  HPSDIBWDCL                                    */
/*  Program Name:    Safe Data BGF Weekly Upload Driver            */
/*  Programmer:      Brad Baden                                    */
/*  Create Date:     08/19/2021                                    */
/*                                                                 */
/*  Function:        This CL is called from Informatica and        */
/*                   submits HPSDIBWCL to upload the Sow Weekly    */
/*                   data from SafeData.                           */
/*                                                                 */
/*                   The job is submitted to jobq DMLIVEQ.         */
/*                                                                 */
/*******************************************************************/
/*  MODIFIED BY     ->                                             */
/*******************************************************************/

             PGM

             DCL        VAR(&JOBQ)   TYPE(*CHAR) LEN(10)
             DCL        VAR(&JOBD)   TYPE(*CHAR) LEN(10)
             DCL        VAR(&GRPPRF) TYPE(*CHAR) LEN(10)

             CHGJOB     LOG(4 99 *SECLVL) LOGCLPGM(*YES)

/*------------------------------------------------------------------*/
/*  Submit FTPS job to single-threaded jobq DMLIVEQ                 */
/*------------------------------------------------------------------*/

          /* Retrive user's Group Profile for library list */
             RTVUSRPRF  GRPPRF(&GRPPRF)

          /* Call or Submit program HPSDIBWCL */
             SELECT
               WHEN     COND(&GRPPRF *EQ 'SBDPGMR') THEN(DO)
                 CHGVAR VAR(&JOBD) VALUE('PRKINTT')
               ENDDO

               WHEN     COND(&GRPPRF *NE 'SBDPGMR') THEN(DO)
                 CHGVAR VAR(&JOBD) VALUE('PRKPRDGUY' )
               ENDDO
             ENDSELECT

                /* Submit job in production */
             SBMJOB     CMD(CALL PGM(HPSDIBWCL)) JOB(HPSDIBW) +
                          JOBD(&JOBD) JOBQ(DMLIVEQ) INLLIBL(*JOBD) +
                          LOG(4 99 *SECLVL) LOGCLPGM(*YES)

 ENDIT:      ENDPGM
