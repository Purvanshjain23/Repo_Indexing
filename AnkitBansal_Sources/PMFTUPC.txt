/********************************************************************/
/*                                                                  */
/*  PROGRAM   - PMFTUPC - PRT COMPANY CHARGES                       */
/*  SYNOPSIS  - OVERRIDE PRINTER FILE TO PASSED IN PARAMETERS       */
/*              PRINT A LIST OF THE ON TIME REASON CODES            */
/*                                                                  */
/*  SYSTEM    - TRAFFIC                                             */
/*                                                                  */
/********************************************************************/
/* MODIFICATIONS:                                                   */
/*------------------------------------------------------------------*/
/* XX/XX/XX XXX XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX   */
/*                                                                  */
/********************************************************************/
 PMTFUPC:    PGM        PARM(&DATEF &DATET &CO &EMAIL &OUTQ &HOLD +
                          &SAVE &COPY)

/* PARMS                                                             */
        DCL        VAR(&DATEF) TYPE(*DEC) LEN(7 0)
        DCL        VAR(&DATET) TYPE(*DEC) LEN(7 0)
        DCL    &OUTQ       *CHAR   (10)  /* OUTPUT QUEUE             */
        DCL    &HOLD       *CHAR   (4)   /* HOLD STATUS              */
        DCL    &SAVE       *CHAR   (4)   /* SAVE STATUS              */
        DCL    &COPYN      *DEC          /* NO. OF COPIES  (PASSED)  */
        DCL    &CO         *DEC    (3 0) /* COMPANY NUMBER           */
        DCL    &COPY       *DEC    (2 0) /* NO. OF COPIES            */
        DCL    &EMAIL      *CHAR   (50)  /* EMAIL ADDRESS            */
        DCL    &DATEFA7    *CHAR   (7)   /* DATE FROM ALPHA          */
        DCL    &DATETA7    *CHAR   (7)   /* DATE TO ALPHA          */
        DCL    &DATEFA8    *CHAR   (10)  /* DATE FROM ALPHA          */
        DCL    &DATETA8    *CHAR   (10)  /* DATE TO ALPHA          */
        DCL    &COA        *CHAR   (6)   /* COMPANY ALPHA          */
        DCL    &ATTACHMENT *CHAR   (50)  /* ATTACHMENT NAME */

/*------------------------------------------------------------------*/
/* CHANGE VARIABLES FOR USE IN PROGRAM                              */
/*------------------------------------------------------------------*/
/*           CHGVAR     VAR(&COPY) VALUE(&COPYN) */

             /* FROM DATE */
             CHGVAR     VAR(&DATEFA7) VALUE(&DATEF)
             CVTDAT     DATE(&DATEFA7) TOVAR(&DATEFA8) +
                          FROMFMT(*CYMD) TOFMT(*YYMD)
             /* TO DATE   */
             CHGVAR     VAR(&DATETA7) VALUE(&DATET)
             CVTDAT     DATE(&DATETA7) TOVAR(&DATETA8) +
                          FROMFMT(*CYMD) TOFMT(*YYMD)
             /* COMPANY   */
             CHGVAR     VAR(&COA) VALUE(&CO)
             IF         COND(&CO *EQ 0) THEN(DO)
             CHGVAR     VAR(&COA) VALUE('SHARED')
             ENDDO

             /* ATTACHMENT */
             CHGVAR     VAR(&ATTACHMENT) VALUE(&COA *TCAT +
                          '_FREIGHT_CHARGES_' *CAT &DATEFA8 *TCAT +
                          '-' *CAT &DATETA8 *TCAT '.PDF')

/*------------------------------------------------------------------*/
/* OVERRIDE PRINTER FILE TO PARMS PASSED IN FROM CALLING PROGRAM    */
/*------------------------------------------------------------------*/
             IF         COND(&EMAIL *EQ '             ') THEN(DO)
             OVRPRTF    FILE(PMB0PFR$) OUTQ(&OUTQ) COPIES(&COPY) +
                          HOLD(&HOLD) SAVE(&SAVE)
             ENDDO
             IF         COND(&EMAIL *NE '             ') THEN(DO)
             OVRPRTF    FILE(PMB0PFR$) OUTQ(QPRINT2)
             ENDDO

/********************************************************************/
/* CALL THE INVOICE EXCEPTION REPORT PROGRAM                        */
/********************************************************************/

             CALL       PGM(PMB0PFR) PARM(' ' &DATEF &DATEF &DATET &CO)

             IF         COND(&EMAIL *NE '              ') THEN(DO)
             ESNDMAIL   RECIPIENT(&EMAIL) SUBJECT(&ATTACHMENT) +
                          ATTLIST((&ATTACHMENT *PDF *N PMB0PFR$))
             DLTSPLF    FILE(PMB0PFR$)
             ENDDO

 END:        ENDPGM
