// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PVCIXFR
// ?Date: 14.08.2025 Time: 03:51:53
// ?------------------------------------------------------------------------------------------------

//?Execute user function

// LCL.PFS Company Number = CVTVAR(PAR.PFS Company Number Alpha)
LCL.PFS_Company_Number = CVTVAR(PAR.PFS_Company_Number_Alpha);

EXECUTE FUNCTION(Snd Upd/Del Processed RT) TYPE(RTVOBJ) FILE(PPBRCPP)           AC2220492;
PARAMETER(LCL.PFS_Company_Number);
PARAMETER(PAR.Upd_Del_Sts_USR);
{
 //?USER: Process Data record

 //?Update PFS Manifest Detail Table.
 EXECUTE FUNCTION(Snd Upd/Del Processed RT) TYPE(RTVOBJ) FILE(PPBNCPP)           AC2220497;
 PARAMETER(DB1.PFS_Manifest_ID);
 PARAMETER(PAR.Upd_Del_Sts_USR);
 {
  //?USER: Process Data record

  CASE;

  // IF PAR.Upd/Del Sts USR is Delete
  IF PAR.Upd_Del_Sts_USR = 'D';

  EXECUTE FUNCTION(Del PFS Manifest Dtl  DL) TYPE(DLTOBJ) FILE(PPBNCPP)           AC2089887;
  PARAMETER(DB1.PFS_Manifest_ID);
  PARAMETER(DB1.PFS_Manifest_Detail_ID);
  // IF PAR.Upd/Del Sts USR is Update
  IF PAR.Upd_Del_Sts_USR = 'U';

  EXECUTE FUNCTION(Chg PFS Process Status CH) TYPE(CHGOBJ) FILE(PPBNCPP)          AC2220496;
  PARAMETER(DB1.PFS_Manifest_ID);
  PARAMETER(DB1.PFS_Manifest_Detail_ID);
  PARAMETER(*ZERO);
  {
   //?USER: Processing before Data update

   // Call program RTV System Date/Time   UP.
   CALL PROGRAM(RTV System Date/Time   UP) ('PDGFUPC');
   PARAMETER(DB1.PFS_Change_Date);
   PARAMETER(DB1.PFS_Change_Time);

  }

  ENDIF;

 }

 CASE;

 // IF PAR.Upd/Del Sts USR is Delete
 IF PAR.Upd_Del_Sts_USR = 'D';

 EXECUTE FUNCTION(Del PFS Manifest Hdr  DL) TYPE(DLTOBJ) FILE(PPBRCPP)           AC2220081;
 PARAMETER(DB1.PFS_Manifest_ID);
 // IF PAR.Upd/Del Sts USR is Update
 IF PAR.Upd_Del_Sts_USR = 'U';

 //?Update back to 'Not Processed' since download suffix file still
 //?have data from previous transmission & have not been picked up
 //?by Carlisle.
 EXECUTE FUNCTION(Chg PFS Process Status CH) TYPE(CHGOBJ) FILE(PPBRCPP)          AC2220488;
 PARAMETER(DB1.PFS_Manifest_ID);
 PARAMETER(*ZERO);
 {
  //?USER: Processing before Data update

  // Call program RTV System Date/Time   UP.
  CALL PROGRAM(RTV System Date/Time   UP) ('PDGFUPC');
  PARAMETER(DB1.PFS_Change_Date);
  PARAMETER(DB1.PFS_Change_Time);

 }

 ENDIF;

}


