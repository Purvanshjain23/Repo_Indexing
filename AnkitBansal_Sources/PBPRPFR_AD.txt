// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PBPRPFR
// ?Date: 14.08.2025 Time: 12:03:31
// ?------------------------------------------------------------------------------------------------

//?USER: Initialize program

//?E3387 JJH 09/22/14 - Add Shipping Method to A/R Claim Resale
//? This program is intended to be ran 1 time and is being used to
//? intialize the new field ACR Shipping Method in the A/R Claim
//? Resale file.  For all Claims that are not at Claim Status =
//? M (Approved-Memo Processing) or C (Completed), the ACR Shipping
//? Method in the A/R Claim Resale file is set to the Shipping Method
//? in the Original Order's Shipping Method in the Order Header TRG
//? file.
//? In addition, the AC Shipping Method in the A/R Claim file is being
//? updated to the value in the Order Header TRG Shipping Method.
//? Prior to this project the Shipping Method in the A/R Claims file
//? was restricted to Daily's.  Now it is being utilized in Guymon
//? and Triumph.
//? Exclude Claim Status D=Denied and V=Void
//?USER: Record selection processing

CASE;

// IF DB1.Claim Status is Approved-Memo Processing
IF DB1.Claim_Status = 'M';

// OR DB1.Claim Status is Completed
OR DB1.Claim_Status = 'C';

// OR DB1.Claim Status is Denied
OR DB1.Claim_Status = 'D';

// OR DB1.Claim Status is Voided
OR DB1.Claim_Status = 'V';

// PGM.*Record selected = CND.*NO
PGM.*Record_selected = 'N';

ENDIF;

//?USER: Process before print of detail format

EXECUTE FUNCTION(Rtv Shipping Method   RT) TYPE(RTVOBJ) FILE(OPBFCPP)           AC1848045;
PARAMETER(DB1.Claim_Company_Number);
PARAMETER(DB1.Claim_Order_Number);
PARAMETER(CUR.Shipping_Method);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


//?PRTOBJ calls after print of detail format

//?Embedded PRTOBJ : Pro Init ShpMth ClRsl PF
EXECUTE FUNCTION(Pro Init ShpMth ClRsl PF) TYPE(PRTOBJ);
PARAMETER(CUR.Claim_Number);
PARAMETER(CUR.AC_Shipping_Method);
PARAMETER(PAR.Upd_Del_Sts_USR);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


//?USER: Process after print of detail format

CASE;

// IF PAR.Upd/Del Sts USR is Update
IF PAR.Upd_Del_Sts_USR = 'U';

EXECUTE FUNCTION(CHG Shipping Method   CH) TYPE(CHGOBJ) FILE(PDMKCPP)           AC2099169;
PARAMETER(CUR.Claim_Number);
PARAMETER(CUR.Shipping_Method);
{
 //?USER: Processing before Data update

 EXECUTE FUNCTION(Set Chg Date/Time      IF) TYPE(EXCINTFUN)                     AC1523476;
 PARAMETER(DB1.Change_Date);
 PARAMETER(DB1.Change_Time);
 PARAMETER(DB1.Change_User);
 PARAMETER(DB1.Change_Program);
 {
  //?Execute internal function

  // PAR.Change Date = JOB.*Job date
  PAR.Change_Date = JOB.*Job_date;

  // PAR.Change Time = JOB.*Job time
  PAR.Change_Time = JOB.*Job_time;

  // PAR.Change User = JOB.*USER
  PAR.Change_User = JOB.*USER;

  // PAR.Change Program = JOB.*PROGRAM
  PAR.Change_Program = JOB.*PROGRAM;

 }

}


ENDIF;

