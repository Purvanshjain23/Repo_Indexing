/***************************************************************** */
/*                                                                 */
/*  PROGRAM NUMBER:  PWIFUPC                                       */
/*  PROGRAM NAME:    Print Primal Cuts by Date Added               */
/*  PROGRAMMER:      Brad Baden                                    */
/*  CREATE DATE:      1/24/2019                                    */
/*                                                                 */
/*  FUNCTION:        This CL is submitted from the Primal Cuts     */
/*                   prompt screen (PWIHPVR).  The user is emailed */
/*                   a spreadsheet of the unique Cut Dates for the */
/*                   Date Added value.                             */
/*                                                                 */
/*                   &CO        Company Number from screen         */
/*                   &DATEADD   Date Added from screen             */
/*                   &EMAIL     Person to receive the spreadsheet  */
/*                                                                 */
/*******************************************************************/
/*  Modification History                                           */
/*                                                                 */
/*******************************************************************/

             PGM        PARM(&CO &DATEADD &EMAIL)

             DCL        VAR(&CO)        TYPE(*DEC) LEN(3 0)
             DCL        VAR(&DATEADD)   TYPE(*DEC) LEN(7 0)
             DCL        VAR(&EMAIL)     TYPE(*CHAR) LEN(50)

             DCL        VAR(&COMPANY)   TYPE(*CHAR) LEN(3)
             DCL        VAR(&DATEADDED) TYPE(*CHAR) LEN(7)

/* Convert numeric parms to alpha for EXECUTE command          */
             CHGVAR     VAR(&COMPANY) VALUE(&CO)
             CHGVAR     VAR(&DATEADDED) VALUE(&DATEADD)

/* Execute Sequel Script                                       */
             EXECUTE    VIEW(CUTDATE) PCFMT(*XLS) RECIPIENT(&EMAIL) +
                          EMLMSG('Cut Date Summarized for a Date +
                          Added') SETVAR((&COMPANY &COMPANY) +
                          (&DATEADDED &DATEADDED))

END:         ENDPGM
