     H/TITLE PFS Ship Status ORD   XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 11/05/18  Time  : 13:33:53
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPPBKCPL4IF  E           K        DISK
      * RSQ : PFS Ship Load/Order Sts   Co/Ld/Ord/TDt/TTm PS=0
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FOPEYCPL9IF  E           K        DISK
      * RSQ : Order Events              Co/Order/Event Code
      *
     FOPEYCPL1IF  E           K        DISK
      * RTV : Order Events              Retrieval index       NV
      *
     FPPBKCPL3IF  E           K        DISK
      * RSQ : PFS Ship Load/Order Sts   Load/Order Picked
      *
     FPPBMCPL3IF  E           K        DISK
      * RSQ : PFS Ship Order Detail     Co/Ord/TDt/TTm/Seq PSts=
      *
     FPDL8CPL1IF  E           K        DISK
      * RTV : Order Inv Allocation      Retrieval index
      *
     FPPBLCPL4IF  E           K        DISK
      * RSQ : PFS Ship Load Header      Co/Ld/TDt(d)/TTm(d) PS=0
      *
     FPPBKCPL7IF  E           K        DISK
      * RSQ : PFS Ship Load/Order Sts   Co/Ld/TD-d/TT-d PS=0
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FOMFNCPL5IF  E           K        DISK
      * RSQ : Manifest Detail           Co/Ord#/Seq/Seq2/PrdDte
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAB1REL0IF  E           K        DISK
      * RTV : Item Balance Detail       Retrieval index       NV
      *
     FPDL8CPL5IF  E           K        DISK
      * RSQ : Order Inv Allocation      Co/Ord/Sq/Sq2/PD/Lt/Lc/L
      *
     FPDL7CPL2IF  E           K        DISK
      * RSQ : Item Lot Loc Trans        Co/Itm/Whs/Typ/Dte/Sq(d)
      *
     FPDL5CPL1IF  E           K        DISK
      * RTV : Item Lot Location         Retrieval index
      *
     FPDL2REL0IF  E           K        DISK
      * RTV : Warehouse Location        Retrieval index
      *
     FPDL3REL0IF  E           K        DISK
      * RTV : Warehouse Location Type   Retrieval index
      *
     FPDMSREL2IF  E           K        DISK
      * RSQ : Export Doc Order Dtl      Co/Order/Seq
      *
     FCAB7CPLNIF  E           K        DISK
      * RSQ : Item Transaction Detail   Co/Order/Trans Sel ERR
      *
     FPPBMCPL4IF  E           K        DISK
      * RSQ : PFS Ship Order Detail     Co/Ord/TDt(d)/TTm(D) PS=
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FOPEYCPL0UF  E           K        DISK                      A
      * UPD : Order Events              Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FPPBKCPL0UF  E           K        DISK
      * UPD : PFS Ship Load/Order Sts   Update index
      *
     FPDL8CPL0UF  E           K        DISK
      * UPD : Order Inv Allocation      Update index
      *
     FPPBLCPL0UF  E           K        DISK
      * UPD : PFS Ship Load Header      Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FPDL7CPL0IF  E           K        DISK                      A
      * UPD : Item Lot Loc Trans        Update index
      *
     FPDL5CPL0UF  E           K        DISK                      A
      * UPD : Item Lot Location         Update index
      *
     FCAB1REL1UF  E           K        DISK
      * UPD : Item Balance Detail       Update index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     FPDMSREL0UF  E           K        DISK
      * UPD : Export Doc Order Dtl      Update index
      *
     FCAB7CPL0UF  E           K        DISK
      * UPD : Item Transaction Detail   Update index
      *
     FPPBMCPL0UF  E           K        DISK
      * UPD : PFS Ship Order Detail     Update index
      *
      * Long constants
     E                    @CN#    1  06  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@BKCPFA
      * PFS Ship Load/Order Sts   Co/Ld/Ord/TDt/TTm PS=0
      * Renamed input format fields
     I              BKY1NX                          WAY1NX
     I              BKAID8                          WAAID8
     I              BKAFTS                          WAAFTS
     I              BKBCNY                          WABCNY
     I              BKVRSX                          WAVRSX
     I              BKZGNX                          WAZGNX
     I              BKZPNX                          WAZPNX
     I              BKW0SX                          WAW0SX
     I              BKUWSX                          WAUWSX
     I              BKUXSX                          WAUXSX
     I              BKV3SX                          WAV3SX
     I              BKAHNY                          WAAHNY
     I              BKAINY                          WAAINY
     I              BKAJNY                          WAAJNY
     I              BKAKNY                          WAAKNY
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WCAIC3
     I              OMC4NB                          WCC4NB
     I              OMDPNB                          WCDPNB
     I              OMUENB                          WCUENB
     I              OMHGCD                          WCHGCD
     I              OMAJCD                          WCAJCD
     I              OMBKC7                          WCBKC7
     I              OMCFC7                          WCCFC7
     I              OMGMST                          WCGMST
     I              OMGNST                          WCGNST
     I              OMMAVA                          WCMAVA
     I              OMKDVA                          WCKDVA
     I              OML8VA                          WCL8VA
     I              OML9VA                          WCL9VA
     I              OMGTST                          WCGTST
     I              OMGVST                          WCGVST
     I              OMGUST                          WCGUST
     I              OMQFST                          WCQFST
     I              OMAYVA                          WCAYVA
     I              OMEXDT                          WCEXDT
     I              OMLQCD                          WCLQCD
     I              OMRDCD                          WCRDCD
     I              OMQ7CD                          WCQ7CD
     I              OMBZPR                          WCBZPR
     I              OML6NB                          WCL6NB
     I              OMU1ST                          WCU1ST
     I              OMGIDT                          WCGIDT
     I              OMCRCD                          WCCRCD
     I              OMAGCD                          WCAGCD
     I              OMRZST                          WCRZST
     I              OMR0ST                          WCR0ST
     I              OMR1ST                          WCR1ST
     I              OMG7NA                          WCG7NA
     I              OMG8NA                          WCG8NA
     I              OMRPCD                          WCRPCD
     I              OMVEST                          WCVEST
     I              OMVGST                          WCVGST
     I              OMAVST                          WCAVST
     I              OMU0ST                          WCU0ST
     I              OMRFCD                          WCRFCD
     I              OMFZST                          WCFZST
     I              OMR1NB                          WCR1NB
     I              OMAVQT                          WCAVQT
     I              OMD0WG                          WCD0WG
     I              OMCCQT                          WCCCQT
     I              OMAUWG                          WCAUWG
     I              OMCBQT                          WCCBQT
     I              OMATWG                          WCATWG
     I              OMAQCS                          WCAQCS
     I              OMAGCS                          WCAGCS
     I              OMAKPR                          WCAKPR
     I              OMALPR                          WCALPR
     I              OMAUPR                          WCAUPR
     I              OMAVWG                          WCAVWG
     I              OMA4WG                          WCA4WG
     I              OMA5DT                          WCA5DT
     I              OMAODT                          WCAODT
     I              OMGNDT                          WCGNDT
     I              OMAMST                          WCAMST
     I              OMANST                          WCANST
     I              OMVAST                          WCVAST
     I              OMRGNB                          WCRGNB
     I              OMRHNB                          WCRHNB
     I              OMRINB                          WCRINB
     I              OMRBCD                          WCRBCD
     I              OMHICD                          WCHICD
     I              OMRNCD                          WCRNCD
     I              OMROCD                          WCROCD
     I              OMCXDT                          WCCXDT
     I              OMAJVN                          WCAJVN
     I              OMKXCD                          WCKXCD
     I              OMJPCD                          WCJPCD
     I              OMCQCD                          WCCQCD
     I              OMR4CD                          WCR4CD
     I              OMZ1ST                          WCZ1ST
     I              OMZ3ST                          WCZ3ST
     I              OMZ4ST                          WCZ4ST
     I              OMDUPR                          WCDUPR
     I              OMB6VL                          WCB6VL
     I              OMA1AA                          WCA1AA
     I              OMFZSX                          WCFZSX
     I              OMF0SX                          WCF0SX
     I              OMF1SX                          WCF1SX
     I              OMF2SX                          WCF2SX
     I              OMF3SX                          WCF3SX
     I              OMF4SX                          WCF4SX
     I              OMF5SX                          WCF5SX
     I              OMF6SX                          WCF6SX
     I              OMF7SX                          WCF7SX
     I              OMNTDT                          WCNTDT
     I              OMNUDT                          WCNUDT
     I              OMNVDT                          WCNVDT
     I              OMNWDT                          WCNWDT
     I              OMNXDT                          WCNXDT
     I              OMBUTM                          WCBUTM
     I              OMBVTM                          WCBVTM
     I              OMBWTM                          WCBWTM
     I              OMBXTM                          WCBXTM
     I              OMBYTM                          WCBYTM
     I              OMH5NX                          WCH5NX
     I              OMH6NX                          WCH6NX
     I              OMH7NX                          WCH7NX
     I              OMH8NX                          WCH8NX
     I              OMH9NX                          WCH9NX
     I              OMDVPR                          WCDVPR
     I              OMDWPR                          WCDWPR
     I              OMDXPR                          WCDXPR
     I              OMDYPR                          WCDYPR
     I              OMDZPR                          WCDZPR
     I              OMGSPR                          WCGSPR
     I              OMGTPR                          WCGTPR
     I              OMGUPR                          WCGUPR
     I              OMHOST                          WCHOST
     I              OMHPST                          WCHPST
     I              OMIOST                          WCIOST
     I              OMPEWG                          WCPEWG
     I              OMRINY                          WCRINY
     I              OMTIDT                          WCTIDT
     I              OMTJDT                          WCTJDT
     I              OMH2ST                          WCH2ST
     I              OMH0ST                          WCH0ST
     I              OMH1ST                          WCH1ST
     I              OMTKDT                          WCTKDT
     I              OMTLDT                          WCTLDT
     I              OMTMDT                          WCTMDT
     I              OMUVST                          WCUVST
     I              OMUWST                          WCUWST
     I              OMUXST                          WCUXST
     I              OMAATM                          WCAATM
     I              OMAYNA                          WCAYNA
     I              OMA0NA                          WCA0NA
     I              OMAXDT                          WCAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WDAJCD
     I              ADF8NA                          WDF8NA
     I              ADACNA                          WDACNA
     I              ADADNA                          WDADNA
     I              ADAENA                          WDAENA
     I              ADAJNA                          WDAJNA
     I              ADBTTX                          WDBTTX
     I              ADAOCD                          WDAOCD
     I              ADBGCD                          WDBGCD
     I              ADVHST                          WDVHST
     I              ADMPNA                          WDMPNA
     I              ADWPST                          WDWPST
     I              ADXUST                          WDXUST
     I              ADT0ST                          WDT0ST
     I              ADT1ST                          WDT1ST
     I              ADDBNB                          WDDBNB
     I              ADT2ST                          WDT2ST
     I              ADT3ST                          WDT3ST
     I              ADT4ST                          WDT4ST
     I              ADT6ST                          WDT6ST
     I              ADBWC3                          WDBWC3
     I              ADBTC3                          WDBTC3
     I              ADBUC3                          WDBUC3
     I              ADBVC3                          WDBVC3
     I              ADFCAA                          WDFCAA
     I              ADRQSX                          WDRQSX
     I              ADRRSX                          WDRRSX
     I              ADRSSX                          WDRSSX
     I              ADRTSX                          WDRTSX
     I              ADT7ST                          WDT7ST
     I              ADT8ST                          WDT8ST
     I              ADRNSX                          WDRNSX
     I              ADROSX                          WDROSX
     I              ADRPSX                          WDRPSX
     I              ADUVST                          WDUVST
     I              ADUWST                          WDUWST
     I              ADUXST                          WDUXST
     I              ADVSST                          WDVSST
     I              ADAATM                          WDAATM
     I              ADAYNA                          WDAYNA
     I              ADA0NA                          WDA0NA
     I              ADAXDT                          WDAXDT
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WERMNB
     I              FJAIC3                          WEAIC3
     I              FJAODT                          WEAODT
     I              FJPJST                          WEPJST
     I              FJPKST                          WEPKST
     I              FJRNNB                          WERNNB
     I              FJDMTX                          WEDMTX
     I              FJDNTX                          WEDNTX
     I              FJDOTX                          WEDOTX
     I              FJWTTX                          WEWTTX
     I              FJWUTX                          WEWUTX
     I              FJRPNB                          WERPNB
     I              FJFLAM                          WEFLAM
     I              FJXQST                          WEXQST
     I              FJRRNB                          WERRNB
     I              FJDXTX                          WEDXTX
     I              FJDYTX                          WEDYTX
     I              FJSBNB                          WESBNB
     I              FJBZNA                          WEBZNA
     I              FJRONB                          WERONB
     I              FJSQNB                          WESQNB
     I              FJR1NB                          WER1NB
     I              FJVCST                          WEVCST
     I              FJVDST                          WEVDST
     I              FJSDNB                          WESDNB
     I              FJPAOU                          WEPAOU
     I              FJDGWG                          WEDGWG
     I              FJSXNB                          WESXNB
     I              FJHADT                          WEHADT
     I              FJAART                          WEAART
     I              FJDHWG                          WEDHWG
     I              FJDIWG                          WEDIWG
     I              FJAQDT                          WEAQDT
     I              FJS6NB                          WES6NB
     I              FJT4NB                          WET4NB
     I              FJPRTM                          WEPRTM
     I              FJNPSV                          WENPSV
     I              FJJ8TX                          WEJ8TX
     I              FJTLMI                          WETLMI
     I              FJJ9TX                          WEJ9TX
     I              FJQ2CD                          WEQ2CD
     I              FJVPCD                          WEVPCD
     I              FJDBCD                          WEDBCD
     I              FJGRWE                          WEGRWE
     I              FJXCCD                          WEXCCD
     I              FJU2ST                          WEU2ST
     I              FJF9DT                          WEF9DT
     I              FJONTM                          WEONTM
     I              FJJ4DT                          WEJ4DT
     I              FJTRTM                          WETRTM
     I              FJJ5DT                          WEJ5DT
     I              FJSPTM                          WESPTM
     I              FJJ6DT                          WEJ6DT
     I              FJLFTM                          WELFTM
     I              FJJ7DT                          WEJ7DT
     I              FJBOTM                          WEBOTM
     I              FJJ8DT                          WEJ8DT
     I              FJBLTM                          WEBLTM
     I              FJKIDT                          WEKIDT
     I              FJASTM                          WEASTM
     I              FJKADT                          WEKADT
     I              FJAJCM                          WEAJCM
     I              FJXACD                          WEXACD
     I              FJOANA                          WEOANA
     I              FJK4TX                          WEK4TX
     I              FJVOAG                          WEVOAG
     I              FJKBDT                          WEKBDT
     I              FJNBBO                          WENBBO
     I              FJW4CD                          WEW4CD
     I              FJEFDT                          WEEFDT
     I              FJCNTN                          WECNTN
     I              FJKCDT                          WEKCDT
     I              FJTMIN                          WETMIN
     I              FJKDDT                          WEKDDT
     I              FJVMNB                          WEVMNB
     I              FJOCFR                          WEOCFR
     I              FJKJDT                          WEKJDT
     I              FJATTM                          WEATTM
     I              FJOTRS                          WEOTRS
     I              FJRNST                          WERNST
     I              FJBRBK                          WEBRBK
     I              FJEIDT                          WEEIDT
     I              FJRMST                          WERMST
     I              FJAJCD                          WEAJCD
     I              FJKKDT                          WEKKDT
     I              FJAVTM                          WEAVTM
     I              FJKZDT                          WEKZDT
     I              FJAXTM                          WEAXTM
     I              FJLHOS                          WELHOS
     I              FJLHOR                          WELHOR
     I              FJWNTX                          WEWNTX
     I              FJOITX                          WEOITX
     I              FJOJTX                          WEOJTX
     I              FJLLDT                          WELLDT
     I              FJLSHG                          WELSHG
     I              FJYPST                          WEYPST
     I              FJK0DT                          WEK0DT
     I              FJAYTM                          WEAYTM
     I              FJKNNX                          WEKNNX
     I              FJICWG                          WEICWG
     I              FJIDWG                          WEIDWG
     I              FJH9SX                          WEH9SX
     I              FJWOTX                          WEWOTX
     I              FJK1DT                          WEK1DT
     I              FJAZTM                          WEAZTM
     I              FJK2DT                          WEK2DT
     I              FJA0TM                          WEA0TM
     I              FJROST                          WEROST
     I              FJRPST                          WERPST
     I              FJRQST                          WERQST
     I              FJRRST                          WERRST
     I              FJZBVA                          WEZBVA
     I              FJWPTX                          WEWPTX
     I              FJWQTX                          WEWQTX
     I              FJWRTX                          WEWRTX
     I              FJWSTX                          WEWSTX
     I              FJRVSX                          WERVSX
     I              FJRUSX                          WERUSX
     I              FJRWSX                          WERWSX
     I              FJRXSX                          WERXSX
     I              FJRYSX                          WERYSX
     I              FJRZSX                          WERZSX
     I              FJR0SX                          WER0SX
     I              FJR1SX                          WER1SX
     I              FJR2SX                          WER2SX
     I              FJR3SX                          WER3SX
     I              FJR4SX                          WER4SX
     I              FJPYDT                          WEPYDT
     I              FJCKTM                          WECKTM
     I              FJPZDT                          WEPZDT
     I              FJCLTM                          WECLTM
     I              FJP0DT                          WEP0DT
     I              FJCMTM                          WECMTM
     I              FJP1DT                          WEP1DT
     I              FJCNTM                          WECNTM
     I              FJP2DT                          WEP2DT
     I              FJCOTM                          WECOTM
     I              FJP3DT                          WEP3DT
     I              FJCQTM                          WECQTM
     I              FJUVST                          WEUVST
     I              FJUWST                          WEUWST
     I              FJUXST                          WEUXST
     I              FJAATM                          WEAATM
     I              FJAYNA                          WEAYNA
     I              FJA0NA                          WEA0NA
     I              FJAXDT                          WEAXDT
      *
     I@FLCPBW
      * Load Detail               Retrieval index
      * Renamed input format fields
     I              FLRMNB                          WFRMNB
     I              FLRUNB                          WFRUNB
     I              FLRVNB                          WFRVNB
     I              FLDQTX                          WFDQTX
     I              FLRWNB                          WFRWNB
     I              FLRXNB                          WFRXNB
     I              FLSQNB                          WFSQNB
     I              FLT0NB                          WFT0NB
     I              FLT1NB                          WFT1NB
     I              FLR1NB                          WFR1NB
     I              FLAIC3                          WFAIC3
     I              FLC4NB                          WFC4NB
     I              FLVCST                          WFVCST
     I              FLKEDT                          WFKEDT
     I              FLSXNB                          WFSXNB
     I              FLKFDT                          WFKFDT
     I              FLACTM                          WFACTM
     I              FLK5TX                          WFK5TX
     I              FLW5CD                          WFW5CD
     I              FLEJDT                          WFEJDT
     I              FLAGTM                          WFAGTM
     I              FLKJDT                          WFKJDT
     I              FLATTM                          WFATTM
     I              FLHDDT                          WFHDDT
     I              FLAUTM                          WFAUTM
     I              FLKKDT                          WFKKDT
     I              FLAVTM                          WFAVTM
     I              FLZ4NB                          WFZ4NB
     I              FLY7ST                          WFY7ST
     I              FLY2ST                          WFY2ST
     I              FLWHTX                          WFWHTX
     I              FLWITX                          WFWITX
     I              FLWJTX                          WFWJTX
     I              FLWKTX                          WFWKTX
     I              FLWLTX                          WFWLTX
     I              FLN7DT                          WFN7DT
     I              FLN8DT                          WFN8DT
     I              FLN9DT                          WFN9DT
     I              FLB3TM                          WFB3TM
     I              FLB4TM                          WFB4TM
     I              FLB5TM                          WFB5TM
     I              FLIASX                          WFIASX
     I              FLIBSX                          WFIBSX
     I              FLICSX                          WFICSX
     I              FLWVTX                          WFWVTX
     I              FLWWTX                          WFWWTX
     I              FLWXTX                          WFWXTX
     I              FLUVST                          WFUVST
     I              FLUWST                          WFUWST
     I              FLUXST                          WFUXST
     I              FLAATM                          WFAATM
     I              FLAYNA                          WFAYNA
     I              FLA0NA                          WFA0NA
     I              FLAXDT                          WFAXDT
      *
     I@EYCPZE
      * Order Events              Co/Order/Event Code
      * Renamed input format fields
     I              EYAIC3                          WGAIC3
     I              EYC4NB                          WGC4NB
     I              EYQ2NB                          WGQ2NB
     I              EYJPCD                          WGJPCD
     I              EYAUC3                          WGAUC3
     I              EYQ7NB                          WGQ7NB
     I              EYOMST                          WGOMST
     I              EYD2DT                          WGD2DT
     I              EYONST                          WGONST
     I              EYOOST                          WGOOST
     I              EYOPST                          WGOPST
     I              EYAWC3                          WGAWC3
     I              EYQ8NB                          WGQ8NB
     I              EYQ9NB                          WGQ9NB
     I              EYBKC7                          WGBKC7
     I              EYUVST                          WGUVST
     I              EYUWST                          WGUWST
     I              EYUXST                          WGUXST
     I              EYAATM                          WGAATM
     I              EYAYNA                          WGAYNA
     I              EYA0NA                          WGA0NA
     I              EYAXDT                          WGAXDT
      *
     I@EYCPY2
      * Order Events              Retrieval index       NV
      * Renamed input format fields
     I              EYAIC3                          WHAIC3
     I              EYC4NB                          WHC4NB
     I              EYQ2NB                          WHQ2NB
     I              EYJPCD                          WHJPCD
     I              EYAUC3                          WHAUC3
     I              EYQ7NB                          WHQ7NB
     I              EYOMST                          WHOMST
     I              EYD2DT                          WHD2DT
     I              EYONST                          WHONST
     I              EYOOST                          WHOOST
     I              EYOPST                          WHOPST
     I              EYAWC3                          WHAWC3
     I              EYQ8NB                          WHQ8NB
     I              EYQ9NB                          WHQ9NB
     I              EYBKC7                          WHBKC7
     I              EYUVST                          WHUVST
     I              EYUWST                          WHUWST
     I              EYUXST                          WHUXST
     I              EYAATM                          WHAATM
     I              EYAYNA                          WHAYNA
     I              EYA0NA                          WHA0NA
     I              EYAXDT                          WHAXDT
      *
     I@EYCPY3
      * Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          WIAIC3
     I              EYC4NB                          WIC4NB
     I              EYQ2NB                          WIQ2NB
     I              EYJPCD                          WIJPCD
     I              EYAUC3                          WIAUC3
     I              EYQ7NB                          WIQ7NB
     I              EYOMST                          WIOMST
     I              EYD2DT                          WID2DT
     I              EYONST                          WIONST
     I              EYOOST                          WIOOST
     I              EYOPST                          WIOPST
     I              EYAWC3                          WIAWC3
     I              EYQ8NB                          WIQ8NB
     I              EYQ9NB                          WIQ9NB
     I              EYBKC7                          WIBKC7
     I              EYUVST                          WIUVST
     I              EYUWST                          WIUWST
     I              EYUXST                          WIUXST
     I              EYAATM                          WIAATM
     I              EYAYNA                          WIAYNA
     I              EYA0NA                          WIA0NA
     I              EYAXDT                          WIAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WJAIC3
     I              BEC4NB                          WJC4NB
     I              BEJNCD                          WJJNCD
     I              BEANC7                          WJANC7
     I              BEBKC7                          WJBKC7
     I              BEBRTX                          WJBRTX
     I              BEHMNA                          WJHMNA
     I              BEHONA                          WJHONA
     I              BEHPNA                          WJHPNA
     I              BEHNNA                          WJHNNA
     I              BEDBCD                          WJDBCD
     I              BECKTX                          WJCKTX
     I              BEB0C7                          WJB0C7
     I              BEAETX                          WJAETX
     I              BEB1NA                          WJB1NA
     I              BEB3NA                          WJB3NA
     I              BEB4NA                          WJB4NA
     I              BEB2NA                          WJB2NA
     I              BEBHCD                          WJBHCD
     I              BEC8TX                          WJC8TX
     I              BEBCNA                          WJBCNA
     I              BEA0DT                          WJA0DT
     I              BEA5DT                          WJA5DT
     I              BEGNDT                          WJGNDT
     I              BEACDT                          WJACDT
     I              BEAQCD                          WJAQCD
     I              BEB6NA                          WJB6NA
     I              BEBYNA                          WJBYNA
     I              BEBZNA                          WJBZNA
     I              BEGTST                          WJGTST
     I              BEGVST                          WJGVST
     I              BEGUST                          WJGUST
     I              BEQFST                          WJQFST
     I              BECQCD                          WJCQCD
     I              BEGJST                          WJGJST
     I              BEGWST                          WJGWST
     I              BEGXST                          WJGXST
     I              BEGYST                          WJGYST
     I              BEAODT                          WJAODT
     I              BEAIVN                          WJAIVN
     I              BECXDT                          WJCXDT
     I              BEJZVA                          WJJZVA
     I              BEA1WG                          WJA1WG
     I              BEXIST                          WJXIST
     I              BEXJST                          WJXJST
     I              BEXKST                          WJXKST
     I              BEEIDT                          WJEIDT
     I              BEAFTM                          WJAFTM
     I              BEE8CD                          WJE8CD
     I              BEE9CD                          WJE9CD
     I              BERMNB                          WJRMNB
     I              BETBNB                          WJTBNB
     I              BER1NB                          WJR1NB
     I              BEPJST                          WJPJST
     I              BEU0ST                          WJU0ST
     I              BEU1ST                          WJU1ST
     I              BEQ2CD                          WJQ2CD
     I              BEU2ST                          WJU2ST
     I              BEVEST                          WJVEST
     I              BEVFST                          WJVFST
     I              BEVGST                          WJVGST
     I              BERPCD                          WJRPCD
     I              BERNNB                          WJRNNB
     I              BEVDST                          WJVDST
     I              BEATIN                          WJATIN
     I              BEU4ST                          WJU4ST
     I              BEU5ST                          WJU5ST
     I              BERSRN                          WJRSRN
     I              BEMHNA                          WJMHNA
     I              BEMINA                          WJMINA
     I              BEWBST                          WJWBST
     I              BER4CD                          WJR4CD
     I              BEBFCD                          WJBFCD
     I              BEQ4CD                          WJQ4CD
     I              BET3NB                          WJT3NB
     I              BESICD                          WJSICD
     I              BECONB                          WJCONB
     I              BECEST                          WJCEST
     I              BEAWDT                          WJAWDT
     I              BEJPCD                          WJJPCD
     I              BEXUST                          WJXUST
     I              BEZ1ST                          WJZ1ST
     I              BEVRVA                          WJVRVA
     I              BEOBST                          WJOBST
     I              BEBCST                          WJBCST
     I              BEBDST                          WJBDST
     I              BEB7VL                          WJB7VL
     I              BEGASX                          WJGASX
     I              BEGBSX                          WJGBSX
     I              BEGCSX                          WJGCSX
     I              BEGDSX                          WJGDSX
     I              BEFNSX                          WJFNSX
     I              BEFOSX                          WJFOSX
     I              BEFPSX                          WJFPSX
     I              BEFQSX                          WJFQSX
     I              BEFRSX                          WJFRSX
     I              BEFSSX                          WJFSSX
     I              BEFTSX                          WJFTSX
     I              BEFUSX                          WJFUSX
     I              BEFVSX                          WJFVSX
     I              BEFWSX                          WJFWSX
     I              BEFXSX                          WJFXSX
     I              BEFYSX                          WJFYSX
     I              BENODT                          WJNODT
     I              BENPDT                          WJNPDT
     I              BENQDT                          WJNQDT
     I              BENRDT                          WJNRDT
     I              BENSDT                          WJNSDT
     I              BEBPTM                          WJBPTM
     I              BEBQTM                          WJBQTM
     I              BEBRTM                          WJBRTM
     I              BEBSTM                          WJBSTM
     I              BEBTTM                          WJBTTM
     I              BEH0NX                          WJH0NX
     I              BEH1NX                          WJH1NX
     I              BEH2NX                          WJH2NX
     I              BEH3NX                          WJH3NX
     I              BEH4NX                          WJH4NX
     I              BEC0C7                          WJC0C7
     I              BEUVST                          WJUVST
     I              BEUWST                          WJUWST
     I              BEUXST                          WJUXST
     I              BEAATM                          WJAATM
     I              BEAYNA                          WJAYNA
     I              BEA0NA                          WJA0NA
     I              BEAXDT                          WJAXDT
      *
     I@BKCPEK
      * PFS Ship Load/Order Sts   Load/Order Picked
      * Renamed input format fields
     I              BKY1NX                          WKY1NX
     I              BKAID8                          WKAID8
     I              BKAFTS                          WKAFTS
     I              BKBCNY                          WKBCNY
     I              BKVRSX                          WKVRSX
     I              BKZGNX                          WKZGNX
     I              BKZPNX                          WKZPNX
     I              BKW0SX                          WKW0SX
     I              BKUWSX                          WKUWSX
     I              BKUXSX                          WKUXSX
     I              BKV3SX                          WKV3SX
     I              BKAHNY                          WKAHNY
     I              BKAINY                          WKAINY
     I              BKAJNY                          WKAJNY
     I              BKAKNY                          WKAKNY
      *
     I@BKCPZU
      * PFS Ship Load/Order Sts   Update index
      * Renamed input format fields
     I              BKY1NX                          WLY1NX
     I              BKAID8                          WLAID8
     I              BKAFTS                          WLAFTS
     I              BKBCNY                          WLBCNY
     I              BKVRSX                          WLVRSX
     I              BKZGNX                          WLZGNX
     I              BKZPNX                          WLZPNX
     I              BKW0SX                          WLW0SX
     I              BKUWSX                          WLUWSX
     I              BKUXSX                          WLUXSX
     I              BKV3SX                          WLV3SX
     I              BKAHNY                          WLAHNY
     I              BKAINY                          WLAINY
     I              BKAJNY                          WLAJNY
     I              BKAKNY                          WLAKNY
      *
     I@BMCPDE
      * PFS Ship Order Detail     Co/Ord/TDt/TTm/Seq PSts=
      * Renamed input format fields
     I              BMY1NX                          WMY1NX
     I              BMAID8                          WMAID8
     I              BMAFTS                          WMAFTS
     I              BMBCNY                          WMBCNY
     I              BMZPNX                          WMZPNX
     I              BMZXNX                          WMZXNX
     I              BMZYNX                          WMZYNX
     I              BMY2NX                          WMY2NX
     I              BMAFD8                          WMAFD8
     I              BMAUNY                          WMAUNY
     I              BMAVNY                          WMAVNY
     I              BMVVSX                          WMVVSX
     I              BMUWSX                          WMUWSX
     I              BMUXSX                          WMUXSX
     I              BMV3SX                          WMV3SX
     I              BMAHNY                          WMAHNY
     I              BMAINY                          WMAINY
     I              BMAJNY                          WMAJNY
     I              BMAKNY                          WMAKNY
      *
     I@L8CPSY
      * Order Inv Allocation      Retrieval index
      * Renamed input format fields
     I              L8AIC3                          WOAIC3
     I              L8C4NB                          WOC4NB
     I              L8DPNB                          WODPNB
     I              L8UENB                          WOUENB
     I              L8ALSW                          WOALSW
     I              L8J6QT                          WOJ6QT
     I              L8G9WG                          WOG9WG
     I              L8J9QT                          WOJ9QT
     I              L8HAWG                          WOHAWG
     I              L8IOSE                          WOIOSE
     I              L8OIMN                          WOOIMN
     I              L8SOAS                          WOSOAS
     I              L8ARSX                          WOARSX
     I              L8OTUS                          WOOTUS
     I              L8OTMP                          WOOTMP
     I              L8HGCD                          WOHGCD
     I              L8AJCD                          WOAJCD
     I              L8ELDT                          WOELDT
     I              L8LXNM                          WOLXNM
     I              L8YMCD                          WOYMCD
     I              L8YNCD                          WOYNCD
     I              L8UVST                          WOUVST
     I              L8UWST                          WOUWST
     I              L8UXST                          WOUXST
     I              L8VSST                          WOVSST
     I              L8AATM                          WOAATM
     I              L8AYNA                          WOAYNA
     I              L8A0NA                          WOA0NA
     I              L8AXDT                          WOAXDT
      *
     I@L8CPSX
      * Order Inv Allocation      Update index
      * Renamed input format fields
     I              L8AIC3                          WRAIC3
     I              L8C4NB                          WRC4NB
     I              L8DPNB                          WRDPNB
     I              L8UENB                          WRUENB
     I              L8ALSW                          WRALSW
     I              L8J6QT                          WRJ6QT
     I              L8G9WG                          WRG9WG
     I              L8J9QT                          WRJ9QT
     I              L8HAWG                          WRHAWG
     I              L8IOSE                          WRIOSE
     I              L8OIMN                          WROIMN
     I              L8SOAS                          WRSOAS
     I              L8ARSX                          WRARSX
     I              L8OTUS                          WROTUS
     I              L8OTMP                          WROTMP
     I              L8HGCD                          WRHGCD
     I              L8AJCD                          WRAJCD
     I              L8ELDT                          WRELDT
     I              L8LXNM                          WRLXNM
     I              L8YMCD                          WRYMCD
     I              L8YNCD                          WRYNCD
     I              L8UVST                          WRUVST
     I              L8UWST                          WRUWST
     I              L8UXST                          WRUXST
     I              L8VSST                          WRVSST
     I              L8AATM                          WRAATM
     I              L8AYNA                          WRAYNA
     I              L8A0NA                          WRA0NA
     I              L8AXDT                          WRAXDT
      *
     I@BLCPFB
      * PFS Ship Load Header      Co/Ld/TDt(d)/TTm(d) PS=0
      * Renamed input format fields
     I              BLY1NX                          WSY1NX
     I              BLAID8                          WSAID8
     I              BLAFTS                          WSAFTS
     I              BLBCNY                          WSBCNY
     I              BLZGNX                          WSZGNX
     I              BLAQNY                          WSAQNY
     I              BLVSSX                          WSVSSX
     I              BLBGNY                          WSBGNY
     I              BLV1SX                          WSV1SX
     I              BLGLT1                          WSGLT1
     I              BLGMT1                          WSGMT1
     I              BLGNT1                          WSGNT1
     I              BLG9T1                          WSG9T1
     I              BLGOT1                          WSGOT1
     I              BLVTSX                          WSVTSX
     I              BLARNY                          WSARNY
     I              BLBFNY                          WSBFNY
     I              BLVUSX                          WSVUSX
     I              BLGXT1                          WSGXT1
     I              BLAJD8                          WSAJD8
     I              BLAGTS                          WSAGTS
     I              BLAKD8                          WSAKD8
     I              BLAHTS                          WSAHTS
     I              BLASNY                          WSASNY
     I              BLBHNY                          WSBHNY
     I              BLUWSX                          WSUWSX
     I              BLUXSX                          WSUXSX
     I              BLV3SX                          WSV3SX
     I              BLAHNY                          WSAHNY
     I              BLAINY                          WSAINY
     I              BLAJNY                          WSAJNY
     I              BLAKNY                          WSAKNY
      *
     I@BLCPZ7
      * PFS Ship Load Header      Update index
      * Renamed input format fields
     I              BLY1NX                          WTY1NX
     I              BLAID8                          WTAID8
     I              BLAFTS                          WTAFTS
     I              BLBCNY                          WTBCNY
     I              BLZGNX                          WTZGNX
     I              BLAQNY                          WTAQNY
     I              BLVSSX                          WTVSSX
     I              BLBGNY                          WTBGNY
     I              BLV1SX                          WTV1SX
     I              BLGLT1                          WTGLT1
     I              BLGMT1                          WTGMT1
     I              BLGNT1                          WTGNT1
     I              BLG9T1                          WTG9T1
     I              BLGOT1                          WTGOT1
     I              BLVTSX                          WTVTSX
     I              BLARNY                          WTARNY
     I              BLBFNY                          WTBFNY
     I              BLVUSX                          WTVUSX
     I              BLGXT1                          WTGXT1
     I              BLAJD8                          WTAJD8
     I              BLAGTS                          WTAGTS
     I              BLAKD8                          WTAKD8
     I              BLAHTS                          WTAHTS
     I              BLASNY                          WTASNY
     I              BLBHNY                          WTBHNY
     I              BLUWSX                          WTUWSX
     I              BLUXSX                          WTUXSX
     I              BLV3SX                          WTV3SX
     I              BLAHNY                          WTAHNY
     I              BLAINY                          WTAINY
     I              BLAJNY                          WTAJNY
     I              BLAKNY                          WTAKNY
      *
     I@BKCPFD
      * PFS Ship Load/Order Sts   Co/Ld/TD-d/TT-d PS=0
      * Renamed input format fields
     I              BKY1NX                          WVY1NX
     I              BKAID8                          WVAID8
     I              BKAFTS                          WVAFTS
     I              BKBCNY                          WVBCNY
     I              BKVRSX                          WVVRSX
     I              BKZGNX                          WVZGNX
     I              BKZPNX                          WVZPNX
     I              BKW0SX                          WVW0SX
     I              BKUWSX                          WVUWSX
     I              BKUXSX                          WVUXSX
     I              BKV3SX                          WVV3SX
     I              BKAHNY                          WVAHNY
     I              BKAINY                          WVAINY
     I              BKAJNY                          WVAJNY
     I              BKAKNY                          WVAKNY
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WWAIC3
     I              OMC4NB                          WWC4NB
     I              OMDPNB                          WWDPNB
     I              OMUENB                          WWUENB
     I              OMHGCD                          WWHGCD
     I              OMAJCD                          WWAJCD
     I              OMBKC7                          WWBKC7
     I              OMCFC7                          WWCFC7
     I              OMGMST                          WWGMST
     I              OMGNST                          WWGNST
     I              OMMAVA                          WWMAVA
     I              OMKDVA                          WWKDVA
     I              OML8VA                          WWL8VA
     I              OML9VA                          WWL9VA
     I              OMGTST                          WWGTST
     I              OMGVST                          WWGVST
     I              OMGUST                          WWGUST
     I              OMQFST                          WWQFST
     I              OMAYVA                          WWAYVA
     I              OMEXDT                          WWEXDT
     I              OMLQCD                          WWLQCD
     I              OMRDCD                          WWRDCD
     I              OMQ7CD                          WWQ7CD
     I              OMBZPR                          WWBZPR
     I              OML6NB                          WWL6NB
     I              OMU1ST                          WWU1ST
     I              OMGIDT                          WWGIDT
     I              OMCRCD                          WWCRCD
     I              OMAGCD                          WWAGCD
     I              OMRZST                          WWRZST
     I              OMR0ST                          WWR0ST
     I              OMR1ST                          WWR1ST
     I              OMG7NA                          WWG7NA
     I              OMG8NA                          WWG8NA
     I              OMRPCD                          WWRPCD
     I              OMVEST                          WWVEST
     I              OMVGST                          WWVGST
     I              OMAVST                          WWAVST
     I              OMU0ST                          WWU0ST
     I              OMRFCD                          WWRFCD
     I              OMFZST                          WWFZST
     I              OMR1NB                          WWR1NB
     I              OMAVQT                          WWAVQT
     I              OMD0WG                          WWD0WG
     I              OMCCQT                          WWCCQT
     I              OMAUWG                          WWAUWG
     I              OMCBQT                          WWCBQT
     I              OMATWG                          WWATWG
     I              OMAQCS                          WWAQCS
     I              OMAGCS                          WWAGCS
     I              OMAKPR                          WWAKPR
     I              OMALPR                          WWALPR
     I              OMAUPR                          WWAUPR
     I              OMAVWG                          WWAVWG
     I              OMA4WG                          WWA4WG
     I              OMA5DT                          WWA5DT
     I              OMAODT                          WWAODT
     I              OMGNDT                          WWGNDT
     I              OMAMST                          WWAMST
     I              OMANST                          WWANST
     I              OMVAST                          WWVAST
     I              OMRGNB                          WWRGNB
     I              OMRHNB                          WWRHNB
     I              OMRINB                          WWRINB
     I              OMRBCD                          WWRBCD
     I              OMHICD                          WWHICD
     I              OMRNCD                          WWRNCD
     I              OMROCD                          WWROCD
     I              OMCXDT                          WWCXDT
     I              OMAJVN                          WWAJVN
     I              OMKXCD                          WWKXCD
     I              OMJPCD                          WWJPCD
     I              OMCQCD                          WWCQCD
     I              OMR4CD                          WWR4CD
     I              OMZ1ST                          WWZ1ST
     I              OMZ3ST                          WWZ3ST
     I              OMZ4ST                          WWZ4ST
     I              OMDUPR                          WWDUPR
     I              OMB6VL                          WWB6VL
     I              OMA1AA                          WWA1AA
     I              OMFZSX                          WWFZSX
     I              OMF0SX                          WWF0SX
     I              OMF1SX                          WWF1SX
     I              OMF2SX                          WWF2SX
     I              OMF3SX                          WWF3SX
     I              OMF4SX                          WWF4SX
     I              OMF5SX                          WWF5SX
     I              OMF6SX                          WWF6SX
     I              OMF7SX                          WWF7SX
     I              OMNTDT                          WWNTDT
     I              OMNUDT                          WWNUDT
     I              OMNVDT                          WWNVDT
     I              OMNWDT                          WWNWDT
     I              OMNXDT                          WWNXDT
     I              OMBUTM                          WWBUTM
     I              OMBVTM                          WWBVTM
     I              OMBWTM                          WWBWTM
     I              OMBXTM                          WWBXTM
     I              OMBYTM                          WWBYTM
     I              OMH5NX                          WWH5NX
     I              OMH6NX                          WWH6NX
     I              OMH7NX                          WWH7NX
     I              OMH8NX                          WWH8NX
     I              OMH9NX                          WWH9NX
     I              OMDVPR                          WWDVPR
     I              OMDWPR                          WWDWPR
     I              OMDXPR                          WWDXPR
     I              OMDYPR                          WWDYPR
     I              OMDZPR                          WWDZPR
     I              OMGSPR                          WWGSPR
     I              OMGTPR                          WWGTPR
     I              OMGUPR                          WWGUPR
     I              OMHOST                          WWHOST
     I              OMHPST                          WWHPST
     I              OMIOST                          WWIOST
     I              OMPEWG                          WWPEWG
     I              OMRINY                          WWRINY
     I              OMTIDT                          WWTIDT
     I              OMTJDT                          WWTJDT
     I              OMH2ST                          WWH2ST
     I              OMH0ST                          WWH0ST
     I              OMH1ST                          WWH1ST
     I              OMTKDT                          WWTKDT
     I              OMTLDT                          WWTLDT
     I              OMTMDT                          WWTMDT
     I              OMUVST                          WWUVST
     I              OMUWST                          WWUWST
     I              OMUXST                          WWUXST
     I              OMAATM                          WWAATM
     I              OMAYNA                          WWAYNA
     I              OMA0NA                          WWA0NA
     I              OMAXDT                          WWAXDT
      *
     I@EOREXM
      * Company Customer          Retrieval index
      * Renamed input format fields
     I              EOAIC3                          WXAIC3
     I              EOBKC7                          WXBKC7
     I              EOAQCD                          WXAQCD
     I              EOR4CD                          WXR4CD
     I              EOBYNA                          WXBYNA
     I              EOB6NA                          WXB6NA
     I              EOBZNA                          WXBZNA
     I              EOLLST                          WXLLST
     I              EOPPST                          WXPPST
     I              EOR5NB                          WXR5NB
     I              EOR6NB                          WXR6NB
     I              EOQGST                          WXQGST
     I              EOBOCD                          WXBOCD
     I              EOTBNB                          WXTBNB
     I              EOMTCU                          WXMTCU
     I              EOW2NB                          WXW2NB
     I              EORPCD                          WXRPCD
     I              EOAJCD                          WXAJCD
     I              EOX9ST                          WXX9ST
     I              EOT9CD                          WXT9CD
     I              EOUBCD                          WXUBCD
     I              EOISTX                          WXISTX
     I              EOLQCD                          WXLQCD
     I              EONJNA                          WXNJNA
     I              EOI0TX                          WXI0TX
     I              EONKNA                          WXNKNA
     I              EOI1TX                          WXI1TX
     I              EOVLST                          WXVLST
     I              EORLST                          WXRLST
     I              EOMMTX                          WXMMTX
     I              EOOHNA                          WXOHNA
     I              EOQ6ST                          WXQ6ST
     I              EOQ8ST                          WXQ8ST
     I              EORBST                          WXRBST
     I              EOREST                          WXREST
     I              EOUVST                          WXUVST
     I              EOUWST                          WXUWST
     I              EOUXST                          WXUXST
     I              EOVSST                          WXVSST
     I              EOAATM                          WXAATM
     I              EOAYNA                          WXAYNA
     I              EOA0NA                          WXA0NA
     I              EOAXDT                          WXAXDT
      *
     I@FNCPEZ
      * Manifest Detail           Co/Ord#/Seq/Seq2/PrdDte
      * Renamed input format fields
     I              FNAIC3                          WYAIC3
     I              FNC4NB                          WYC4NB
     I              FNDPNB                          WYDPNB
     I              FNUENB                          WYUENB
     I              FNRZNB                          WYRZNB
     I              FNFOQT                          WYFOQT
     I              FNR0NB                          WYR0NB
     I              FNPMST                          WYPMST
     I              FNK7DT                          WYK7DT
     I              FNPFNX                          WYPFNX
     I              FNHGCD                          WYHGCD
     I              FNAJCD                          WYAJCD
     I              FNELDT                          WYELDT
     I              FNN5WG                          WYN5WG
     I              FNRZNA                          WYRZNA
     I              FNH5NY                          WYH5NY
     I              FNH6NY                          WYH6NY
     I              FNH7NY                          WYH7NY
     I              FNGBTX                          WYGBTX
     I              FNN6WG                          WYN6WG
     I              FNN7WG                          WYN7WG
     I              FNGCTX                          WYGCTX
     I              FNGDTX                          WYGDTX
     I              FNRBDT                          WYRBDT
     I              FNITNY                          WYITNY
     I              FNIVNY                          WYIVNY
     I              FNIUNY                          WYIUNY
     I              FNIWNY                          WYIWNY
     I              FNIXNY                          WYIXNY
     I              FNIYNY                          WYIYNY
     I              FNUVST                          WYUVST
     I              FNUWST                          WYUWST
     I              FNUXST                          WYUXST
     I              FNVSST                          WYVSST
     I              FNAATM                          WYAATM
     I              FNAYNA                          WYAYNA
     I              FNA0NA                          WYA0NA
     I              FNAXDT                          WYAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          TAAIC3
     I              BZHGCD                          TAHGCD
     I              BZAVNA                          TAAVNA
     I              BZAWNA                          TAAWNA
     I              BZL7NA                          TAL7NA
     I              BZL8NA                          TAL8NA
     I              BZL6NA                          TAL6NA
     I              BZMFNA                          TAMFNA
     I              BZADCD                          TAADCD
     I              BZAWPC                          TAAWPC
     I              BZLXST                          TALXST
     I              BZAECD                          TAAECD
     I              BZAXPC                          TAAXPC
     I              BZLYST                          TALYST
     I              BZAFCD                          TAAFCD
     I              BZAICD                          TAAICD
     I              BZAIWG                          TAAIWG
     I              BZHICD                          TAHICD
     I              BZRBCD                          TARBCD
     I              BZFZST                          TAFZST
     I              BZAVST                          TAAVST
     I              BZCZWG                          TACZWG
     I              BZC0WG                          TAC0WG
     I              BZURTN                          TAURTN
     I              BZAJC8                          TAAJC8
     I              BZRINB                          TARINB
     I              BZRHNB                          TARHNB
     I              BZRGNB                          TARGNB
     I              BZLNCD                          TALNCD
     I              BZTFNB                          TATFNB
     I              BZN0CD                          TAN0CD
     I              BZX4ST                          TAX4ST
     I              BZTMVA                          TATMVA
     I              BZTNVA                          TATNVA
     I              BZBLPR                          TABLPR
     I              BZBMPR                          TABMPR
     I              BZLRCD                          TALRCD
     I              BZU9ST                          TAU9ST
     I              BZCMCO                          TACMCO
     I              BZQ1CD                          TAQ1CD
     I              BZQ8CD                          TAQ8CD
     I              BZCHTM                          TACHTM
     I              BZQZCD                          TAQZCD
     I              BZXWST                          TAXWST
     I              BZXXST                          TAXXST
     I              BZVMST                          TAVMST
     I              BZSWGH                          TASWGH
     I              BZPPHE                          TAPPHE
     I              BZR3CD                          TAR3CD
     I              BZSDCD                          TASDCD
     I              BZICN1                          TAICN1
     I              BZSVCD                          TASVCD
     I              BZICN2                          TAICN2
     I              BZSWCD                          TASWCD
     I              BZV2NB                          TAV2NB
     I              BZSXCD                          TASXCD
     I              BZITCN                          TAITCN
     I              BZSYCD                          TASYCD
     I              BZITC5                          TAITC5
     I              BZSZCD                          TASZCD
     I              BZICN6                          TAICN6
     I              BZS0CD                          TAS0CD
     I              BZICN7                          TAICN7
     I              BZS1CD                          TAS1CD
     I              BZICN8                          TAICN8
     I              BZS2CD                          TAS2CD
     I              BZICN9                          TAICN9
     I              BZS3CD                          TAS3CD
     I              BZICN0                          TAICN0
     I              BZS4CD                          TAS4CD
     I              BZSFNB                          TASFNB
     I              BZA3WG                          TAA3WG
     I              BZSJNB                          TASJNB
     I              BZLLCD                          TALLCD
     I              BZLMCD                          TALMCD
     I              BZP3ST                          TAP3ST
     I              BZSKNB                          TASKNB
     I              BZSLNB                          TASLNB
     I              BZSMNB                          TASMNB
     I              BZP4ST                          TAP4ST
     I              BZCFNB                          TACFNB
     I              BZCGNB                          TACGNB
     I              BZILNB                          TAILNB
     I              BZCHNB                          TACHNB
     I              BZCINB                          TACINB
     I              BZCJNB                          TACJNB
     I              BZCMNB                          TACMNB
     I              BZCNNB                          TACNNB
     I              BZCRNB                          TACRNB
     I              BZCSNB                          TACSNB
     I              BZCVNB                          TACVNB
     I              BZCWNB                          TACWNB
     I              BZCXNB                          TACXNB
     I              BZCZNB                          TACZNB
     I              BZC0NB                          TAC0NB
     I              BZN1CD                          TAN1CD
     I              BZB4NB                          TAB4NB
     I              BZB5NB                          TAB5NB
     I              BZX5ST                          TAX5ST
     I              BZX6ST                          TAX6ST
     I              BZX7ST                          TAX7ST
     I              BZPCCT                          TAPCCT
     I              BZBDNB                          TABDNB
     I              BZBJNB                          TABJNB
     I              BZSUST                          TASUST
     I              BZSVST                          TASVST
     I              BZSYST                          TASYST
     I              BZSZST                          TASZST
     I              BZS1ST                          TAS1ST
     I              BZXRCD                          TAXRCD
     I              BZXTCD                          TAXTCD
     I              BZXUCD                          TAXUCD
     I              BZF5WG                          TAF5WG
     I              BZF6WG                          TAF6WG
     I              BZF7WG                          TAF7WG
     I              BZBLNB                          TABLNB
     I              BZBNNB                          TABNNB
     I              BZS2ST                          TAS2ST
     I              BZS4ST                          TAS4ST
     I              BZS5ST                          TAS5ST
     I              BZS6ST                          TAS6ST
     I              BZS8ST                          TAS8ST
     I              BZS9ST                          TAS9ST
     I              BZTCST                          TATCST
     I              BZTDST                          TATDST
     I              BZUVST                          TAUVST
     I              BZUWST                          TAUWST
     I              BZUXST                          TAUXST
     I              BZVSST                          TAVSST
     I              BZAATM                          TAAATM
     I              BZAYNA                          TAAYNA
     I              BZA0NA                          TAA0NA
     I              BZAXDT                          TAAXDT
      *
     I@B1REJ0
      * Item Balance Detail       Retrieval index       NV
      * Renamed input format fields
     I              B1AIC3                          TBAIC3
     I              B1HGCD                          TBHGCD
     I              B1AJCD                          TBAJCD
     I              B1ELDT                          TBELDT
     I              B1ABWG                          TBABWG
     I              B1AGQT                          TBAGQT
     I              B1AHQT                          TBAHQT
     I              B1AIQT                          TBAIQT
     I              B1CTST                          TBCTST
     I              B1ACWG                          TBACWG
     I              B1ARQT                          TBARQT
     I              B1ASQT                          TBASQT
     I              B1ATQT                          TBATQT
     I              B1HDQT                          TBHDQT
     I              B1HEQT                          TBHEQT
     I              B1F6ST                          TBF6ST
     I              B1BMWG                          TBBMWG
     I              B1DSQT                          TBDSQT
     I              B1DTQT                          TBDTQT
     I              B1DUQT                          TBDUQT
     I              B1DHDT                          TBDHDT
     I              B1AGCS                          TBAGCS
     I              B1AECS                          TBAECS
     I              B1IDVA                          TBIDVA
     I              B1K7DT                          TBK7DT
     I              B1RINB                          TBRINB
     I              B1RHNB                          TBRHNB
     I              B1RGNB                          TBRGNB
     I              B1UVST                          TBUVST
     I              B1UWST                          TBUWST
     I              B1UXST                          TBUXST
     I              B1VSST                          TBVSST
     I              B1AATM                          TBAATM
     I              B1AYNA                          TBAYNA
     I              B1A0NA                          TBA0NA
     I              B1AXDT                          TBAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          TCAIC3
     I              OMC4NB                          TCC4NB
     I              OMDPNB                          TCDPNB
     I              OMUENB                          TCUENB
     I              OMHGCD                          TCHGCD
     I              OMAJCD                          TCAJCD
     I              OMBKC7                          TCBKC7
     I              OMCFC7                          TCCFC7
     I              OMGMST                          TCGMST
     I              OMGNST                          TCGNST
     I              OMMAVA                          TCMAVA
     I              OMKDVA                          TCKDVA
     I              OML8VA                          TCL8VA
     I              OML9VA                          TCL9VA
     I              OMGTST                          TCGTST
     I              OMGVST                          TCGVST
     I              OMGUST                          TCGUST
     I              OMQFST                          TCQFST
     I              OMAYVA                          TCAYVA
     I              OMEXDT                          TCEXDT
     I              OMLQCD                          TCLQCD
     I              OMRDCD                          TCRDCD
     I              OMQ7CD                          TCQ7CD
     I              OMBZPR                          TCBZPR
     I              OML6NB                          TCL6NB
     I              OMU1ST                          TCU1ST
     I              OMGIDT                          TCGIDT
     I              OMCRCD                          TCCRCD
     I              OMAGCD                          TCAGCD
     I              OMRZST                          TCRZST
     I              OMR0ST                          TCR0ST
     I              OMR1ST                          TCR1ST
     I              OMG7NA                          TCG7NA
     I              OMG8NA                          TCG8NA
     I              OMRPCD                          TCRPCD
     I              OMVEST                          TCVEST
     I              OMVGST                          TCVGST
     I              OMAVST                          TCAVST
     I              OMU0ST                          TCU0ST
     I              OMRFCD                          TCRFCD
     I              OMFZST                          TCFZST
     I              OMR1NB                          TCR1NB
     I              OMAVQT                          TCAVQT
     I              OMD0WG                          TCD0WG
     I              OMCCQT                          TCCCQT
     I              OMAUWG                          TCAUWG
     I              OMCBQT                          TCCBQT
     I              OMATWG                          TCATWG
     I              OMAQCS                          TCAQCS
     I              OMAGCS                          TCAGCS
     I              OMAKPR                          TCAKPR
     I              OMALPR                          TCALPR
     I              OMAUPR                          TCAUPR
     I              OMAVWG                          TCAVWG
     I              OMA4WG                          TCA4WG
     I              OMA5DT                          TCA5DT
     I              OMAODT                          TCAODT
     I              OMGNDT                          TCGNDT
     I              OMAMST                          TCAMST
     I              OMANST                          TCANST
     I              OMVAST                          TCVAST
     I              OMRGNB                          TCRGNB
     I              OMRHNB                          TCRHNB
     I              OMRINB                          TCRINB
     I              OMRBCD                          TCRBCD
     I              OMHICD                          TCHICD
     I              OMRNCD                          TCRNCD
     I              OMROCD                          TCROCD
     I              OMCXDT                          TCCXDT
     I              OMAJVN                          TCAJVN
     I              OMKXCD                          TCKXCD
     I              OMJPCD                          TCJPCD
     I              OMCQCD                          TCCQCD
     I              OMR4CD                          TCR4CD
     I              OMZ1ST                          TCZ1ST
     I              OMZ3ST                          TCZ3ST
     I              OMZ4ST                          TCZ4ST
     I              OMDUPR                          TCDUPR
     I              OMB6VL                          TCB6VL
     I              OMA1AA                          TCA1AA
     I              OMFZSX                          TCFZSX
     I              OMF0SX                          TCF0SX
     I              OMF1SX                          TCF1SX
     I              OMF2SX                          TCF2SX
     I              OMF3SX                          TCF3SX
     I              OMF4SX                          TCF4SX
     I              OMF5SX                          TCF5SX
     I              OMF6SX                          TCF6SX
     I              OMF7SX                          TCF7SX
     I              OMNTDT                          TCNTDT
     I              OMNUDT                          TCNUDT
     I              OMNVDT                          TCNVDT
     I              OMNWDT                          TCNWDT
     I              OMNXDT                          TCNXDT
     I              OMBUTM                          TCBUTM
     I              OMBVTM                          TCBVTM
     I              OMBWTM                          TCBWTM
     I              OMBXTM                          TCBXTM
     I              OMBYTM                          TCBYTM
     I              OMH5NX                          TCH5NX
     I              OMH6NX                          TCH6NX
     I              OMH7NX                          TCH7NX
     I              OMH8NX                          TCH8NX
     I              OMH9NX                          TCH9NX
     I              OMDVPR                          TCDVPR
     I              OMDWPR                          TCDWPR
     I              OMDXPR                          TCDXPR
     I              OMDYPR                          TCDYPR
     I              OMDZPR                          TCDZPR
     I              OMGSPR                          TCGSPR
     I              OMGTPR                          TCGTPR
     I              OMGUPR                          TCGUPR
     I              OMHOST                          TCHOST
     I              OMHPST                          TCHPST
     I              OMIOST                          TCIOST
     I              OMPEWG                          TCPEWG
     I              OMRINY                          TCRINY
     I              OMTIDT                          TCTIDT
     I              OMTJDT                          TCTJDT
     I              OMH2ST                          TCH2ST
     I              OMH0ST                          TCH0ST
     I              OMH1ST                          TCH1ST
     I              OMTKDT                          TCTKDT
     I              OMTLDT                          TCTLDT
     I              OMTMDT                          TCTMDT
     I              OMUVST                          TCUVST
     I              OMUWST                          TCUWST
     I              OMUXST                          TCUXST
     I              OMAATM                          TCAATM
     I              OMAYNA                          TCAYNA
     I              OMA0NA                          TCA0NA
     I              OMAXDT                          TCAXDT
      *
     I@L8CPZO
      * Order Inv Allocation      Co/Ord/Sq/Sq2/PD/Lt/Lc/L
      * Renamed input format fields
     I              L8AIC3                          TDAIC3
     I              L8C4NB                          TDC4NB
     I              L8DPNB                          TDDPNB
     I              L8UENB                          TDUENB
     I              L8ALSW                          TDALSW
     I              L8J6QT                          TDJ6QT
     I              L8G9WG                          TDG9WG
     I              L8J9QT                          TDJ9QT
     I              L8HAWG                          TDHAWG
     I              L8IOSE                          TDIOSE
     I              L8OIMN                          TDOIMN
     I              L8SOAS                          TDSOAS
     I              L8ARSX                          TDARSX
     I              L8OTUS                          TDOTUS
     I              L8OTMP                          TDOTMP
     I              L8HGCD                          TDHGCD
     I              L8AJCD                          TDAJCD
     I              L8ELDT                          TDELDT
     I              L8LXNM                          TDLXNM
     I              L8YMCD                          TDYMCD
     I              L8YNCD                          TDYNCD
     I              L8UVST                          TDUVST
     I              L8UWST                          TDUWST
     I              L8UXST                          TDUXST
     I              L8VSST                          TDVSST
     I              L8AATM                          TDAATM
     I              L8AYNA                          TDAYNA
     I              L8A0NA                          TDA0NA
     I              L8AXDT                          TDAXDT
      *
     I@L7CPUK
      * Item Lot Loc Trans        Co/Itm/Whs/Typ/Dte/Sq(d)
      * Renamed input format fields
     I              L7AIC3                          TEAIC3
     I              L7HGCD                          TEHGCD
     I              L7AJCD                          TEAJCD
     I              L7LTRT                          TELTRT
     I              L7LRDT                          TELRDT
     I              L7LLTS                          TELLTS
     I              L7LSDT                          TELSDT
     I              L7J5QT                          TEJ5QT
     I              L7G8WG                          TEG8WG
     I              L7LLTN                          TELLTN
     I              L7YMCD                          TEYMCD
     I              L7LLCL                          TELLCL
     I              L7BNAA                          TEBNAA
     I              L7LLTR                          TELLTR
     I              L7Y2CD                          TEY2CD
     I              L7LLTL                          TELLTL
     I              L7C4NB                          TEC4NB
     I              L7LOST                          TELOST
     I              L7LLTU                          TELLTU
     I              L7LLYT                          TELLYT
     I              L7UVST                          TEUVST
     I              L7UWST                          TEUWST
     I              L7UXST                          TEUXST
     I              L7VSST                          TEVSST
     I              L7AATM                          TEAATM
     I              L7AYNA                          TEAYNA
     I              L7A0NA                          TEA0NA
     I              L7AXDT                          TEAXDT
      *
     I@L7CPS3
      * Item Lot Loc Trans        Update index
      * Renamed input format fields
     I              L7AIC3                          TFAIC3
     I              L7HGCD                          TFHGCD
     I              L7AJCD                          TFAJCD
     I              L7LTRT                          TFLTRT
     I              L7LRDT                          TFLRDT
     I              L7LLTS                          TFLLTS
     I              L7LSDT                          TFLSDT
     I              L7J5QT                          TFJ5QT
     I              L7G8WG                          TFG8WG
     I              L7LLTN                          TFLLTN
     I              L7YMCD                          TFYMCD
     I              L7LLCL                          TFLLCL
     I              L7BNAA                          TFBNAA
     I              L7LLTR                          TFLLTR
     I              L7Y2CD                          TFY2CD
     I              L7LLTL                          TFLLTL
     I              L7C4NB                          TFC4NB
     I              L7LOST                          TFLOST
     I              L7LLTU                          TFLLTU
     I              L7LLYT                          TFLLYT
     I              L7UVST                          TFUVST
     I              L7UWST                          TFUWST
     I              L7UXST                          TFUXST
     I              L7VSST                          TFVSST
     I              L7AATM                          TFAATM
     I              L7AYNA                          TFAYNA
     I              L7A0NA                          TFA0NA
     I              L7AXDT                          TFAXDT
      *
     I@L5CPSV
      * Item Lot Location         Retrieval index
      * Renamed input format fields
     I              L5AIC3                          TGAIC3
     I              L5HGCD                          TGHGCD
     I              L5AJCD                          TGAJCD
     I              L5ELDT                          TGELDT
     I              L5LXNM                          TGLXNM
     I              L5YMCD                          TGYMCD
     I              L5YNCD                          TGYNCD
     I              L5J2QT                          TGJ2QT
     I              L5G5WG                          TGG5WG
     I              L5J3QT                          TGJ3QT
     I              L5G6WG                          TGG6WG
     I              L5J4QT                          TGJ4QT
     I              L5G7WG                          TGG7WG
     I              L5LODT                          TGLODT
     I              L5LPDT                          TGLPDT
     I              L5LQDT                          TGLQDT
     I              L5NBR                           TGNBR
     I              L5YTCD                          TGYTCD
     I              L5AMSX                          TGAMSX
     I              L5ASSX                          TGASSX
     I              L5ATSX                          TGATSX
     I              L5AUSX                          TGAUSX
     I              L5YSCD                          TGYSCD
     I              L5UVST                          TGUVST
     I              L5UWST                          TGUWST
     I              L5UXST                          TGUXST
     I              L5VSST                          TGVSST
     I              L5AATM                          TGAATM
     I              L5AYNA                          TGAYNA
     I              L5A0NA                          TGA0NA
     I              L5AXDT                          TGAXDT
      *
     I@L2RESM
      * Warehouse Location        Retrieval index
      * Renamed input format fields
     I              L2AJCD                          THAJCD
     I              L2YMCD                          THYMCD
     I              L2YPCD                          THYPCD
     I              L2LCBY                          THLCBY
     I              L2LCCT                          THLCCT
     I              L2WLUS                          THWLUS
     I              L2WUSD                          THWUSD
     I              L2WLUN                          THWLUN
     I              L2AGSX                          THAGSX
     I              L2UVST                          THUVST
     I              L2UWST                          THUWST
     I              L2UXST                          THUXST
     I              L2VSST                          THVSST
     I              L2AATM                          THAATM
     I              L2AYNA                          THAYNA
     I              L2A0NA                          THA0NA
     I              L2AXDT                          THAXDT
      *
     I@L3RET8
      * Warehouse Location Type   Retrieval index
      * Renamed input format fields
     I              MEAGSX                          TIAGSX
     I              MEOPNA                          TIOPNA
     I              MESLTY                          TISLTY
     I              MEAHSX                          TIAHSX
     I              MEAISX                          TIAISX
     I              MEUVST                          TIUVST
     I              MEUWST                          TIUWST
     I              MEUXST                          TIUXST
     I              MEVSST                          TIVSST
     I              MEAATM                          TIAATM
     I              MEAYNA                          TIAYNA
     I              MEA0NA                          TIA0NA
     I              MEAXDT                          TIAXDT
      *
     I@L5CPSL
      * Item Lot Location         Update index
      * Renamed input format fields
     I              L5AIC3                          TJAIC3
     I              L5HGCD                          TJHGCD
     I              L5AJCD                          TJAJCD
     I              L5ELDT                          TJELDT
     I              L5LXNM                          TJLXNM
     I              L5YMCD                          TJYMCD
     I              L5YNCD                          TJYNCD
     I              L5J2QT                          TJJ2QT
     I              L5G5WG                          TJG5WG
     I              L5J3QT                          TJJ3QT
     I              L5G6WG                          TJG6WG
     I              L5J4QT                          TJJ4QT
     I              L5G7WG                          TJG7WG
     I              L5LODT                          TJLODT
     I              L5LPDT                          TJLPDT
     I              L5LQDT                          TJLQDT
     I              L5NBR                           TJNBR
     I              L5YTCD                          TJYTCD
     I              L5AMSX                          TJAMSX
     I              L5ASSX                          TJASSX
     I              L5ATSX                          TJATSX
     I              L5AUSX                          TJAUSX
     I              L5YSCD                          TJYSCD
     I              L5UVST                          TJUVST
     I              L5UWST                          TJUWST
     I              L5UXST                          TJUXST
     I              L5VSST                          TJVSST
     I              L5AATM                          TJAATM
     I              L5AYNA                          TJAYNA
     I              L5A0NA                          TJA0NA
     I              L5AXDT                          TJAXDT
      *
     I@B1REJ1
      * Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          TKAIC3
     I              B1HGCD                          TKHGCD
     I              B1AJCD                          TKAJCD
     I              B1ELDT                          TKELDT
     I              B1ABWG                          TKABWG
     I              B1AGQT                          TKAGQT
     I              B1AHQT                          TKAHQT
     I              B1AIQT                          TKAIQT
     I              B1CTST                          TKCTST
     I              B1ACWG                          TKACWG
     I              B1ARQT                          TKARQT
     I              B1ASQT                          TKASQT
     I              B1ATQT                          TKATQT
     I              B1HDQT                          TKHDQT
     I              B1HEQT                          TKHEQT
     I              B1F6ST                          TKF6ST
     I              B1BMWG                          TKBMWG
     I              B1DSQT                          TKDSQT
     I              B1DTQT                          TKDTQT
     I              B1DUQT                          TKDUQT
     I              B1DHDT                          TKDHDT
     I              B1AGCS                          TKAGCS
     I              B1AECS                          TKAECS
     I              B1IDVA                          TKIDVA
     I              B1K7DT                          TKK7DT
     I              B1RINB                          TKRINB
     I              B1RHNB                          TKRHNB
     I              B1RGNB                          TKRGNB
     I              B1UVST                          TKUVST
     I              B1UWST                          TKUWST
     I              B1UXST                          TKUXST
     I              B1VSST                          TKVSST
     I              B1AATM                          TKAATM
     I              B1AYNA                          TKAYNA
     I              B1A0NA                          TKA0NA
     I              B1AXDT                          TKAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          TLRMNB
     I              FJAIC3                          TLAIC3
     I              FJAODT                          TLAODT
     I              FJPJST                          TLPJST
     I              FJPKST                          TLPKST
     I              FJRNNB                          TLRNNB
     I              FJDMTX                          TLDMTX
     I              FJDNTX                          TLDNTX
     I              FJDOTX                          TLDOTX
     I              FJWTTX                          TLWTTX
     I              FJWUTX                          TLWUTX
     I              FJRPNB                          TLRPNB
     I              FJFLAM                          TLFLAM
     I              FJXQST                          TLXQST
     I              FJRRNB                          TLRRNB
     I              FJDXTX                          TLDXTX
     I              FJDYTX                          TLDYTX
     I              FJSBNB                          TLSBNB
     I              FJBZNA                          TLBZNA
     I              FJRONB                          TLRONB
     I              FJSQNB                          TLSQNB
     I              FJR1NB                          TLR1NB
     I              FJVCST                          TLVCST
     I              FJVDST                          TLVDST
     I              FJSDNB                          TLSDNB
     I              FJPAOU                          TLPAOU
     I              FJDGWG                          TLDGWG
     I              FJSXNB                          TLSXNB
     I              FJHADT                          TLHADT
     I              FJAART                          TLAART
     I              FJDHWG                          TLDHWG
     I              FJDIWG                          TLDIWG
     I              FJAQDT                          TLAQDT
     I              FJS6NB                          TLS6NB
     I              FJT4NB                          TLT4NB
     I              FJPRTM                          TLPRTM
     I              FJNPSV                          TLNPSV
     I              FJJ8TX                          TLJ8TX
     I              FJTLMI                          TLTLMI
     I              FJJ9TX                          TLJ9TX
     I              FJQ2CD                          TLQ2CD
     I              FJVPCD                          TLVPCD
     I              FJDBCD                          TLDBCD
     I              FJGRWE                          TLGRWE
     I              FJXCCD                          TLXCCD
     I              FJU2ST                          TLU2ST
     I              FJF9DT                          TLF9DT
     I              FJONTM                          TLONTM
     I              FJJ4DT                          TLJ4DT
     I              FJTRTM                          TLTRTM
     I              FJJ5DT                          TLJ5DT
     I              FJSPTM                          TLSPTM
     I              FJJ6DT                          TLJ6DT
     I              FJLFTM                          TLLFTM
     I              FJJ7DT                          TLJ7DT
     I              FJBOTM                          TLBOTM
     I              FJJ8DT                          TLJ8DT
     I              FJBLTM                          TLBLTM
     I              FJKIDT                          TLKIDT
     I              FJASTM                          TLASTM
     I              FJKADT                          TLKADT
     I              FJAJCM                          TLAJCM
     I              FJXACD                          TLXACD
     I              FJOANA                          TLOANA
     I              FJK4TX                          TLK4TX
     I              FJVOAG                          TLVOAG
     I              FJKBDT                          TLKBDT
     I              FJNBBO                          TLNBBO
     I              FJW4CD                          TLW4CD
     I              FJEFDT                          TLEFDT
     I              FJCNTN                          TLCNTN
     I              FJKCDT                          TLKCDT
     I              FJTMIN                          TLTMIN
     I              FJKDDT                          TLKDDT
     I              FJVMNB                          TLVMNB
     I              FJOCFR                          TLOCFR
     I              FJKJDT                          TLKJDT
     I              FJATTM                          TLATTM
     I              FJOTRS                          TLOTRS
     I              FJRNST                          TLRNST
     I              FJBRBK                          TLBRBK
     I              FJEIDT                          TLEIDT
     I              FJRMST                          TLRMST
     I              FJAJCD                          TLAJCD
     I              FJKKDT                          TLKKDT
     I              FJAVTM                          TLAVTM
     I              FJKZDT                          TLKZDT
     I              FJAXTM                          TLAXTM
     I              FJLHOS                          TLLHOS
     I              FJLHOR                          TLLHOR
     I              FJWNTX                          TLWNTX
     I              FJOITX                          TLOITX
     I              FJOJTX                          TLOJTX
     I              FJLLDT                          TLLLDT
     I              FJLSHG                          TLLSHG
     I              FJYPST                          TLYPST
     I              FJK0DT                          TLK0DT
     I              FJAYTM                          TLAYTM
     I              FJKNNX                          TLKNNX
     I              FJICWG                          TLICWG
     I              FJIDWG                          TLIDWG
     I              FJH9SX                          TLH9SX
     I              FJWOTX                          TLWOTX
     I              FJK1DT                          TLK1DT
     I              FJAZTM                          TLAZTM
     I              FJK2DT                          TLK2DT
     I              FJA0TM                          TLA0TM
     I              FJROST                          TLROST
     I              FJRPST                          TLRPST
     I              FJRQST                          TLRQST
     I              FJRRST                          TLRRST
     I              FJZBVA                          TLZBVA
     I              FJWPTX                          TLWPTX
     I              FJWQTX                          TLWQTX
     I              FJWRTX                          TLWRTX
     I              FJWSTX                          TLWSTX
     I              FJRVSX                          TLRVSX
     I              FJRUSX                          TLRUSX
     I              FJRWSX                          TLRWSX
     I              FJRXSX                          TLRXSX
     I              FJRYSX                          TLRYSX
     I              FJRZSX                          TLRZSX
     I              FJR0SX                          TLR0SX
     I              FJR1SX                          TLR1SX
     I              FJR2SX                          TLR2SX
     I              FJR3SX                          TLR3SX
     I              FJR4SX                          TLR4SX
     I              FJPYDT                          TLPYDT
     I              FJCKTM                          TLCKTM
     I              FJPZDT                          TLPZDT
     I              FJCLTM                          TLCLTM
     I              FJP0DT                          TLP0DT
     I              FJCMTM                          TLCMTM
     I              FJP1DT                          TLP1DT
     I              FJCNTM                          TLCNTM
     I              FJP2DT                          TLP2DT
     I              FJCOTM                          TLCOTM
     I              FJP3DT                          TLP3DT
     I              FJCQTM                          TLCQTM
     I              FJUVST                          TLUVST
     I              FJUWST                          TLUWST
     I              FJUXST                          TLUXST
     I              FJAATM                          TLAATM
     I              FJAYNA                          TLAYNA
     I              FJA0NA                          TLA0NA
     I              FJAXDT                          TLAXDT
      *
     I@MSREX2
      * Export Doc Order Dtl      Co/Order/Seq
      * Renamed input format fields
     I              MSAIC3                          TMAIC3
     I              MSC4NB                          TMC4NB
     I              MSDGSX                          TMDGSX
     I              MSKXCD                          TMKXCD
     I              MSDPNB                          TMDPNB
     I              MSUENB                          TMUENB
     I              MSDIC7                          TMDIC7
     I              MSO3NA                          TMO3NA
     I              MSO4NA                          TMO4NA
     I              MSRMTX                          TMRMTX
     I              MSPTTX                          TMPTTX
     I              MSHJWG                          TMHJWG
     I              MSHKWG                          TMHKWG
     I              MSRNTX                          TMRNTX
     I              MSAONX                          TMAONX
     I              MSROTX                          TMROTX
     I              MSORNA                          TMORNA
     I              MSAMNX                          TMAMNX
     I              MSANNX                          TMANNX
     I              MSAPNX                          TMAPNX
     I              MSDKPR                          TMDKPR
     I              MSA9VL                          TMA9VL
     I              MSC8SX                          TMC8SX
     I              MSRATX                          TMRATX
     I              MSRBTX                          TMRBTX
     I              MSAJNX                          TMAJNX
     I              MSZWTX                          TMZWTX
     I              MSZXTX                          TMZXTX
     I              MSZYTX                          TMZYTX
     I              MSZZTX                          TMZZTX
     I              MSK0U1                          TMK0U1
     I              MSK1U1                          TMK1U1
     I              MSIJSC                          TMIJSC
     I              MSIKSC                          TMIKSC
     I              MSK2U1                          TMK2U1
     I              MSW0DT                          TMW0DT
     I              MSUVST                          TMUVST
     I              MSUWST                          TMUWST
     I              MSUXST                          TMUXST
     I              MSVSST                          TMVSST
     I              MSAATM                          TMAATM
     I              MSAYNA                          TMAYNA
     I              MSA0NA                          TMA0NA
     I              MSAXDT                          TMAXDT
      *
     I@MSREW4
      * Export Doc Order Dtl      Update index
      * Renamed input format fields
     I              MSAIC3                          TOAIC3
     I              MSC4NB                          TOC4NB
     I              MSDGSX                          TODGSX
     I              MSKXCD                          TOKXCD
     I              MSDPNB                          TODPNB
     I              MSUENB                          TOUENB
     I              MSDIC7                          TODIC7
     I              MSO3NA                          TOO3NA
     I              MSO4NA                          TOO4NA
     I              MSRMTX                          TORMTX
     I              MSPTTX                          TOPTTX
     I              MSHJWG                          TOHJWG
     I              MSHKWG                          TOHKWG
     I              MSRNTX                          TORNTX
     I              MSAONX                          TOAONX
     I              MSROTX                          TOROTX
     I              MSORNA                          TOORNA
     I              MSAMNX                          TOAMNX
     I              MSANNX                          TOANNX
     I              MSAPNX                          TOAPNX
     I              MSDKPR                          TODKPR
     I              MSA9VL                          TOA9VL
     I              MSC8SX                          TOC8SX
     I              MSRATX                          TORATX
     I              MSRBTX                          TORBTX
     I              MSAJNX                          TOAJNX
     I              MSZWTX                          TOZWTX
     I              MSZXTX                          TOZXTX
     I              MSZYTX                          TOZYTX
     I              MSZZTX                          TOZZTX
     I              MSK0U1                          TOK0U1
     I              MSK1U1                          TOK1U1
     I              MSIJSC                          TOIJSC
     I              MSIKSC                          TOIKSC
     I              MSK2U1                          TOK2U1
     I              MSW0DT                          TOW0DT
     I              MSUVST                          TOUVST
     I              MSUWST                          TOUWST
     I              MSUXST                          TOUXST
     I              MSVSST                          TOVSST
     I              MSAATM                          TOAATM
     I              MSAYNA                          TOAYNA
     I              MSA0NA                          TOA0NA
     I              MSAXDT                          TOAXDT
      *
     I@B7CPJD
      * Item Transaction Detail   Co/Order/Trans Sel ERR
      * Renamed input format fields
     I              B7AIC3                          TRAIC3
     I              B7HGCD                          TRHGCD
     I              B7AJCD                          TRAJCD
     I              B7W9ST                          TRW9ST
     I              B7BSST                          TRBSST
     I              B7B4DT                          TRB4DT
     I              B7C4NY                          TRC4NY
     I              B7DXNB                          TRDXNB
     I              B7ELDT                          TRELDT
     I              B7HVCD                          TRHVCD
     I              B7F1ST                          TRF1ST
     I              B7AUNA                          TRAUNA
     I              B7A5QT                          TRA5QT
     I              B7AHWG                          TRAHWG
     I              B7AKCS                          TRAKCS
     I              B7CGCD                          TRCGCD
     I              B7AYVA                          TRAYVA
     I              B7BJNA                          TRBJNA
     I              B7CKNB                          TRCKNB
     I              B7BMST                          TRBMST
     I              B7CQCD                          TRCQCD
     I              B7DTCD                          TRDTCD
     I              B7MGNA                          TRMGNA
     I              B7TRBN                          TRTRBN
     I              B7TRBS                          TRTRBS
     I              B7C4NB                          TRC4NB
     I              B7RINB                          TRRINB
     I              B7RHNB                          TRRHNB
     I              B7RGNB                          TRRGNB
     I              B7M3NA                          TRM3NA
     I              B7AWTM                          TRAWTM
     I              B7XLCD                          TRXLCD
     I              B7K7DT                          TRK7DT
     I              B7UVST                          TRUVST
     I              B7UWST                          TRUWST
     I              B7UXST                          TRUXST
     I              B7VSST                          TRVSST
     I              B7AATM                          TRAATM
     I              B7AYNA                          TRAYNA
     I              B7A0NA                          TRA0NA
     I              B7AXDT                          TRAXDT
      *
     I@B7CPJZ
      * Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          TSAIC3
     I              B7HGCD                          TSHGCD
     I              B7AJCD                          TSAJCD
     I              B7W9ST                          TSW9ST
     I              B7BSST                          TSBSST
     I              B7B4DT                          TSB4DT
     I              B7C4NY                          TSC4NY
     I              B7DXNB                          TSDXNB
     I              B7ELDT                          TSELDT
     I              B7HVCD                          TSHVCD
     I              B7F1ST                          TSF1ST
     I              B7AUNA                          TSAUNA
     I              B7A5QT                          TSA5QT
     I              B7AHWG                          TSAHWG
     I              B7AKCS                          TSAKCS
     I              B7CGCD                          TSCGCD
     I              B7AYVA                          TSAYVA
     I              B7BJNA                          TSBJNA
     I              B7CKNB                          TSCKNB
     I              B7BMST                          TSBMST
     I              B7CQCD                          TSCQCD
     I              B7DTCD                          TSDTCD
     I              B7MGNA                          TSMGNA
     I              B7TRBN                          TSTRBN
     I              B7TRBS                          TSTRBS
     I              B7C4NB                          TSC4NB
     I              B7RINB                          TSRINB
     I              B7RHNB                          TSRHNB
     I              B7RGNB                          TSRGNB
     I              B7M3NA                          TSM3NA
     I              B7AWTM                          TSAWTM
     I              B7XLCD                          TSXLCD
     I              B7K7DT                          TSK7DT
     I              B7UVST                          TSUVST
     I              B7UWST                          TSUWST
     I              B7UXST                          TSUXST
     I              B7VSST                          TSVSST
     I              B7AATM                          TSAATM
     I              B7AYNA                          TSAYNA
     I              B7A0NA                          TSA0NA
     I              B7AXDT                          TSAXDT
      *
     I@BMCPE9
      * PFS Ship Order Detail     Co/Ord/TDt(d)/TTm(D) PS=
      * Renamed input format fields
     I              BMY1NX                          TTY1NX
     I              BMAID8                          TTAID8
     I              BMAFTS                          TTAFTS
     I              BMBCNY                          TTBCNY
     I              BMZPNX                          TTZPNX
     I              BMZXNX                          TTZXNX
     I              BMZYNX                          TTZYNX
     I              BMY2NX                          TTY2NX
     I              BMAFD8                          TTAFD8
     I              BMAUNY                          TTAUNY
     I              BMAVNY                          TTAVNY
     I              BMVVSX                          TTVVSX
     I              BMUWSX                          TTUWSX
     I              BMUXSX                          TTUXSX
     I              BMV3SX                          TTV3SX
     I              BMAHNY                          TTAHNY
     I              BMAINY                          TTAINY
     I              BMAJNY                          TTAJNY
     I              BMAKNY                          TTAKNY
      *
     I@BMCPYU
      * PFS Ship Order Detail     Update index
      * Renamed input format fields
     I              BMY1NX                          TVY1NX
     I              BMAID8                          TVAID8
     I              BMAFTS                          TVAFTS
     I              BMBCNY                          TVBCNY
     I              BMZPNX                          TVZPNX
     I              BMZXNX                          TVZXNX
     I              BMZYNX                          TVZYNX
     I              BMY2NX                          TVY2NX
     I              BMAFD8                          TVAFD8
     I              BMAUNY                          TVAUNY
     I              BMAVNY                          TVAVNY
     I              BMVVSX                          TVVVSX
     I              BMUWSX                          TVUWSX
     I              BMUXSX                          TVUXSX
     I              BMV3SX                          TVV3SX
     I              BMAHNY                          TVAHNY
     I              BMAINY                          TVAINY
     I              BMAJNY                          TVAJNY
     I              BMAKNY                          TVAKNY
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          TWAIC3
     I              KMV8CD                          TWV8CD
     I              KMAUNA                          TWAUNA
     I              KMI5ST                          TWI5ST
     I              KMBXTX                          TWBXTX
     I              KMM8NB                          TWM8NB
     I              KMUVST                          TWUVST
     I              KMUWST                          TWUWST
     I              KMUXST                          TWUXST
     I              KMVSST                          TWVSST
     I              KMAATM                          TWAATM
     I              KMAYNA                          TWAYNA
     I              KMA0NA                          TWA0NA
     I              KMAXDT                          TWAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQOPEY1    E DSOPEYCPL0
      * UPD : Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          WIAIC3
     I              EYC4NB                          WIC4NB
     I              EYQ2NB                          WIQ2NB
     I              EYJPCD                          WIJPCD
     I              EYAUC3                          WIAUC3
     I              EYQ7NB                          WIQ7NB
     I              EYOMST                          WIOMST
     I              EYD2DT                          WID2DT
     I              EYONST                          WIONST
     I              EYOOST                          WIOOST
     I              EYOPST                          WIOPST
     I              EYAWC3                          WIAWC3
     I              EYQ8NB                          WIQ8NB
     I              EYQ9NB                          WIQ9NB
     I              EYBKC7                          WIBKC7
     I              EYUVST                          WIUVST
     I              EYUWST                          WIUWST
     I              EYUXST                          WIUXST
     I              EYAATM                          WIAATM
     I              EYAYNA                          WIAYNA
     I              EYA0NA                          WIA0NA
     I              EYAXDT                          WIAXDT
      *
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WJAIC3
     I              BEC4NB                          WJC4NB
     I              BEJNCD                          WJJNCD
     I              BEANC7                          WJANC7
     I              BEBKC7                          WJBKC7
     I              BEBRTX                          WJBRTX
     I              BEHMNA                          WJHMNA
     I              BEHONA                          WJHONA
     I              BEHPNA                          WJHPNA
     I              BEHNNA                          WJHNNA
     I              BEDBCD                          WJDBCD
     I              BECKTX                          WJCKTX
     I              BEB0C7                          WJB0C7
     I              BEAETX                          WJAETX
     I              BEB1NA                          WJB1NA
     I              BEB3NA                          WJB3NA
     I              BEB4NA                          WJB4NA
     I              BEB2NA                          WJB2NA
     I              BEBHCD                          WJBHCD
     I              BEC8TX                          WJC8TX
     I              BEBCNA                          WJBCNA
     I              BEA0DT                          WJA0DT
     I              BEA5DT                          WJA5DT
     I              BEGNDT                          WJGNDT
     I              BEACDT                          WJACDT
     I              BEAQCD                          WJAQCD
     I              BEB6NA                          WJB6NA
     I              BEBYNA                          WJBYNA
     I              BEBZNA                          WJBZNA
     I              BEGTST                          WJGTST
     I              BEGVST                          WJGVST
     I              BEGUST                          WJGUST
     I              BEQFST                          WJQFST
     I              BECQCD                          WJCQCD
     I              BEGJST                          WJGJST
     I              BEGWST                          WJGWST
     I              BEGXST                          WJGXST
     I              BEGYST                          WJGYST
     I              BEAODT                          WJAODT
     I              BEAIVN                          WJAIVN
     I              BECXDT                          WJCXDT
     I              BEJZVA                          WJJZVA
     I              BEA1WG                          WJA1WG
     I              BEXIST                          WJXIST
     I              BEXJST                          WJXJST
     I              BEXKST                          WJXKST
     I              BEEIDT                          WJEIDT
     I              BEAFTM                          WJAFTM
     I              BEE8CD                          WJE8CD
     I              BEE9CD                          WJE9CD
     I              BERMNB                          WJRMNB
     I              BETBNB                          WJTBNB
     I              BER1NB                          WJR1NB
     I              BEPJST                          WJPJST
     I              BEU0ST                          WJU0ST
     I              BEU1ST                          WJU1ST
     I              BEQ2CD                          WJQ2CD
     I              BEU2ST                          WJU2ST
     I              BEVEST                          WJVEST
     I              BEVFST                          WJVFST
     I              BEVGST                          WJVGST
     I              BERPCD                          WJRPCD
     I              BERNNB                          WJRNNB
     I              BEVDST                          WJVDST
     I              BEATIN                          WJATIN
     I              BEU4ST                          WJU4ST
     I              BEU5ST                          WJU5ST
     I              BERSRN                          WJRSRN
     I              BEMHNA                          WJMHNA
     I              BEMINA                          WJMINA
     I              BEWBST                          WJWBST
     I              BER4CD                          WJR4CD
     I              BEBFCD                          WJBFCD
     I              BEQ4CD                          WJQ4CD
     I              BET3NB                          WJT3NB
     I              BESICD                          WJSICD
     I              BECONB                          WJCONB
     I              BECEST                          WJCEST
     I              BEAWDT                          WJAWDT
     I              BEJPCD                          WJJPCD
     I              BEXUST                          WJXUST
     I              BEZ1ST                          WJZ1ST
     I              BEVRVA                          WJVRVA
     I              BEOBST                          WJOBST
     I              BEBCST                          WJBCST
     I              BEBDST                          WJBDST
     I              BEB7VL                          WJB7VL
     I              BEGASX                          WJGASX
     I              BEGBSX                          WJGBSX
     I              BEGCSX                          WJGCSX
     I              BEGDSX                          WJGDSX
     I              BEFNSX                          WJFNSX
     I              BEFOSX                          WJFOSX
     I              BEFPSX                          WJFPSX
     I              BEFQSX                          WJFQSX
     I              BEFRSX                          WJFRSX
     I              BEFSSX                          WJFSSX
     I              BEFTSX                          WJFTSX
     I              BEFUSX                          WJFUSX
     I              BEFVSX                          WJFVSX
     I              BEFWSX                          WJFWSX
     I              BEFXSX                          WJFXSX
     I              BEFYSX                          WJFYSX
     I              BENODT                          WJNODT
     I              BENPDT                          WJNPDT
     I              BENQDT                          WJNQDT
     I              BENRDT                          WJNRDT
     I              BENSDT                          WJNSDT
     I              BEBPTM                          WJBPTM
     I              BEBQTM                          WJBQTM
     I              BEBRTM                          WJBRTM
     I              BEBSTM                          WJBSTM
     I              BEBTTM                          WJBTTM
     I              BEH0NX                          WJH0NX
     I              BEH1NX                          WJH1NX
     I              BEH2NX                          WJH2NX
     I              BEH3NX                          WJH3NX
     I              BEH4NX                          WJH4NX
     I              BEC0C7                          WJC0C7
     I              BEUVST                          WJUVST
     I              BEUWST                          WJUWST
     I              BEUXST                          WJUXST
     I              BEAATM                          WJAATM
     I              BEAYNA                          WJAYNA
     I              BEA0NA                          WJA0NA
     I              BEAXDT                          WJAXDT
      *
     IYARDCS      DS                            779
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type - Sales
     I                                        7   8 PAJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400/Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PANQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PANRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PABSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
      * Outward parameters
     IPBRC        DS                             82
      * RCD : Load Order Change Log     Retrieval index
      * N :  Sequence Number
     I                                    P   9  100PBDXNB
      * I :  Load ID
     I                                    P  11  140PBRMNB
      * I :  Stop/Drop
     I                                    P  15  170PBRVNB
      * I :  Load Change Type
     I                                       18  23 PBRVST
      * I :  Department Control Code
     I                                       24  26 PBUJST
      * I :  Change Log Prior Value
     I                                       27  38 PBMNTX
      * I :  Change Log New Value
     I                                       39  50 PBMOTX
      * I :  User Id
     I                                       51  60 PBAYNA
      * I :  Job Name
     I                                       61  70 PBA0NA
      * I :  Carrier Code
     I                                       71  73 PBBZNA
      * N :  Carrier Broker Carrier Co
     I                                       74  76 PBXMCD
      * I :  Company Number
     I                                    P  77  780PBAIC3
      * I :  Order Number
     I                                    P  79  820PBC4NB
      *
     IQPPBK1    E DSPPBKCPL0
      * UPD : PFS Ship Load/Order Sts   Update index
      * Renamed input format fields
     I              BKY1NX                          WLY1NX
     I              BKAID8                          WLAID8
     I              BKAFTS                          WLAFTS
     I              BKBCNY                          WLBCNY
     I              BKVRSX                          WLVRSX
     I              BKZGNX                          WLZGNX
     I              BKZPNX                          WLZPNX
     I              BKW0SX                          WLW0SX
     I              BKUWSX                          WLUWSX
     I              BKUXSX                          WLUXSX
     I              BKV3SX                          WLV3SX
     I              BKAHNY                          WLAHNY
     I              BKAINY                          WLAINY
     I              BKAJNY                          WLAJNY
     I              BKAKNY                          WLAKNY
      *
     IYBRDCS      DS                             75
     IQPDL81    E DSPDL8CPL0
      * UPD : Order Inv Allocation      Update index
      * Renamed input format fields
     I              L8AIC3                          WRAIC3
     I              L8C4NB                          WRC4NB
     I              L8DPNB                          WRDPNB
     I              L8UENB                          WRUENB
     I              L8ALSW                          WRALSW
     I              L8J6QT                          WRJ6QT
     I              L8G9WG                          WRG9WG
     I              L8J9QT                          WRJ9QT
     I              L8HAWG                          WRHAWG
     I              L8IOSE                          WRIOSE
     I              L8OIMN                          WROIMN
     I              L8SOAS                          WRSOAS
     I              L8ARSX                          WRARSX
     I              L8OTUS                          WROTUS
     I              L8OTMP                          WROTMP
     I              L8HGCD                          WRHGCD
     I              L8AJCD                          WRAJCD
     I              L8ELDT                          WRELDT
     I              L8LXNM                          WRLXNM
     I              L8YMCD                          WRYMCD
     I              L8YNCD                          WRYNCD
     I              L8UVST                          WRUVST
     I              L8UWST                          WRUWST
     I              L8UXST                          WRUXST
     I              L8VSST                          WRVSST
     I              L8AATM                          WRAATM
     I              L8AYNA                          WRAYNA
     I              L8A0NA                          WRA0NA
     I              L8AXDT                          WRAXDT
      *
     IQPPBL1    E DSPPBLCPL0
      * UPD : PFS Ship Load Header      Update index
      * Renamed input format fields
     I              BLY1NX                          WTY1NX
     I              BLAID8                          WTAID8
     I              BLAFTS                          WTAFTS
     I              BLBCNY                          WTBCNY
     I              BLZGNX                          WTZGNX
     I              BLAQNY                          WTAQNY
     I              BLVSSX                          WTVSSX
     I              BLBGNY                          WTBGNY
     I              BLV1SX                          WTV1SX
     I              BLGLT1                          WTGLT1
     I              BLGMT1                          WTGMT1
     I              BLGNT1                          WTGNT1
     I              BLG9T1                          WTG9T1
     I              BLGOT1                          WTGOT1
     I              BLVTSX                          WTVTSX
     I              BLARNY                          WTARNY
     I              BLBFNY                          WTBFNY
     I              BLVUSX                          WTVUSX
     I              BLGXT1                          WTGXT1
     I              BLAJD8                          WTAJD8
     I              BLAGTS                          WTAGTS
     I              BLAKD8                          WTAKD8
     I              BLAHTS                          WTAHTS
     I              BLASNY                          WTASNY
     I              BLBHNY                          WTBHNY
     I              BLUWSX                          WTUWSX
     I              BLUXSX                          WTUXSX
     I              BLV3SX                          WTV3SX
     I              BLAHNY                          WTAHNY
     I              BLAINY                          WTAINY
     I              BLAJNY                          WTAJNY
     I              BLAKNY                          WTAKNY
      *
     IYCRDCS      DS                            222
     IYDRDCS      DS                             75
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          TCAIC3
     I              OMC4NB                          TCC4NB
     I              OMDPNB                          TCDPNB
     I              OMUENB                          TCUENB
     I              OMHGCD                          TCHGCD
     I              OMAJCD                          TCAJCD
     I              OMBKC7                          TCBKC7
     I              OMCFC7                          TCCFC7
     I              OMGMST                          TCGMST
     I              OMGNST                          TCGNST
     I              OMMAVA                          TCMAVA
     I              OMKDVA                          TCKDVA
     I              OML8VA                          TCL8VA
     I              OML9VA                          TCL9VA
     I              OMGTST                          TCGTST
     I              OMGVST                          TCGVST
     I              OMGUST                          TCGUST
     I              OMQFST                          TCQFST
     I              OMAYVA                          TCAYVA
     I              OMEXDT                          TCEXDT
     I              OMLQCD                          TCLQCD
     I              OMRDCD                          TCRDCD
     I              OMQ7CD                          TCQ7CD
     I              OMBZPR                          TCBZPR
     I              OML6NB                          TCL6NB
     I              OMU1ST                          TCU1ST
     I              OMGIDT                          TCGIDT
     I              OMCRCD                          TCCRCD
     I              OMAGCD                          TCAGCD
     I              OMRZST                          TCRZST
     I              OMR0ST                          TCR0ST
     I              OMR1ST                          TCR1ST
     I              OMG7NA                          TCG7NA
     I              OMG8NA                          TCG8NA
     I              OMRPCD                          TCRPCD
     I              OMVEST                          TCVEST
     I              OMVGST                          TCVGST
     I              OMAVST                          TCAVST
     I              OMU0ST                          TCU0ST
     I              OMRFCD                          TCRFCD
     I              OMFZST                          TCFZST
     I              OMR1NB                          TCR1NB
     I              OMAVQT                          TCAVQT
     I              OMD0WG                          TCD0WG
     I              OMCCQT                          TCCCQT
     I              OMAUWG                          TCAUWG
     I              OMCBQT                          TCCBQT
     I              OMATWG                          TCATWG
     I              OMAQCS                          TCAQCS
     I              OMAGCS                          TCAGCS
     I              OMAKPR                          TCAKPR
     I              OMALPR                          TCALPR
     I              OMAUPR                          TCAUPR
     I              OMAVWG                          TCAVWG
     I              OMA4WG                          TCA4WG
     I              OMA5DT                          TCA5DT
     I              OMAODT                          TCAODT
     I              OMGNDT                          TCGNDT
     I              OMAMST                          TCAMST
     I              OMANST                          TCANST
     I              OMVAST                          TCVAST
     I              OMRGNB                          TCRGNB
     I              OMRHNB                          TCRHNB
     I              OMRINB                          TCRINB
     I              OMRBCD                          TCRBCD
     I              OMHICD                          TCHICD
     I              OMRNCD                          TCRNCD
     I              OMROCD                          TCROCD
     I              OMCXDT                          TCCXDT
     I              OMAJVN                          TCAJVN
     I              OMKXCD                          TCKXCD
     I              OMJPCD                          TCJPCD
     I              OMCQCD                          TCCQCD
     I              OMR4CD                          TCR4CD
     I              OMZ1ST                          TCZ1ST
     I              OMZ3ST                          TCZ3ST
     I              OMZ4ST                          TCZ4ST
     I              OMDUPR                          TCDUPR
     I              OMB6VL                          TCB6VL
     I              OMA1AA                          TCA1AA
     I              OMFZSX                          TCFZSX
     I              OMF0SX                          TCF0SX
     I              OMF1SX                          TCF1SX
     I              OMF2SX                          TCF2SX
     I              OMF3SX                          TCF3SX
     I              OMF4SX                          TCF4SX
     I              OMF5SX                          TCF5SX
     I              OMF6SX                          TCF6SX
     I              OMF7SX                          TCF7SX
     I              OMNTDT                          TCNTDT
     I              OMNUDT                          TCNUDT
     I              OMNVDT                          TCNVDT
     I              OMNWDT                          TCNWDT
     I              OMNXDT                          TCNXDT
     I              OMBUTM                          TCBUTM
     I              OMBVTM                          TCBVTM
     I              OMBWTM                          TCBWTM
     I              OMBXTM                          TCBXTM
     I              OMBYTM                          TCBYTM
     I              OMH5NX                          TCH5NX
     I              OMH6NX                          TCH6NX
     I              OMH7NX                          TCH7NX
     I              OMH8NX                          TCH8NX
     I              OMH9NX                          TCH9NX
     I              OMDVPR                          TCDVPR
     I              OMDWPR                          TCDWPR
     I              OMDXPR                          TCDXPR
     I              OMDYPR                          TCDYPR
     I              OMDZPR                          TCDZPR
     I              OMGSPR                          TCGSPR
     I              OMGTPR                          TCGTPR
     I              OMGUPR                          TCGUPR
     I              OMHOST                          TCHOST
     I              OMHPST                          TCHPST
     I              OMIOST                          TCIOST
     I              OMPEWG                          TCPEWG
     I              OMRINY                          TCRINY
     I              OMTIDT                          TCTIDT
     I              OMTJDT                          TCTJDT
     I              OMH2ST                          TCH2ST
     I              OMH0ST                          TCH0ST
     I              OMH1ST                          TCH1ST
     I              OMTKDT                          TCTKDT
     I              OMTLDT                          TCTLDT
     I              OMTMDT                          TCTMDT
     I              OMUVST                          TCUVST
     I              OMUWST                          TCUWST
     I              OMUXST                          TCUXST
     I              OMAATM                          TCAATM
     I              OMAYNA                          TCAYNA
     I              OMA0NA                          TCA0NA
     I              OMAXDT                          TCAXDT
      *
     IYERDCS      DS                            525
     IQPDL71    E DSPDL7CPL0
      * UPD : Item Lot Loc Trans        Update index
      * Renamed input format fields
     I              L7AIC3                          TFAIC3
     I              L7HGCD                          TFHGCD
     I              L7AJCD                          TFAJCD
     I              L7LTRT                          TFLTRT
     I              L7LRDT                          TFLRDT
     I              L7LLTS                          TFLLTS
     I              L7LSDT                          TFLSDT
     I              L7J5QT                          TFJ5QT
     I              L7G8WG                          TFG8WG
     I              L7LLTN                          TFLLTN
     I              L7YMCD                          TFYMCD
     I              L7LLCL                          TFLLCL
     I              L7BNAA                          TFBNAA
     I              L7LLTR                          TFLLTR
     I              L7Y2CD                          TFY2CD
     I              L7LLTL                          TFLLTL
     I              L7C4NB                          TFC4NB
     I              L7LOST                          TFLOST
     I              L7LLTU                          TFLLTU
     I              L7LLYT                          TFLLYT
     I              L7UVST                          TFUVST
     I              L7UWST                          TFUWST
     I              L7UXST                          TFUXST
     I              L7VSST                          TFVSST
     I              L7AATM                          TFAATM
     I              L7AYNA                          TFAYNA
     I              L7A0NA                          TFA0NA
     I              L7AXDT                          TFAXDT
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQPDL51    E DSPDL5CPL0
      * UPD : Item Lot Location         Update index
      * Renamed input format fields
     I              L5AIC3                          TJAIC3
     I              L5HGCD                          TJHGCD
     I              L5AJCD                          TJAJCD
     I              L5ELDT                          TJELDT
     I              L5LXNM                          TJLXNM
     I              L5YMCD                          TJYMCD
     I              L5YNCD                          TJYNCD
     I              L5J2QT                          TJJ2QT
     I              L5G5WG                          TJG5WG
     I              L5J3QT                          TJJ3QT
     I              L5G6WG                          TJG6WG
     I              L5J4QT                          TJJ4QT
     I              L5G7WG                          TJG7WG
     I              L5LODT                          TJLODT
     I              L5LPDT                          TJLPDT
     I              L5LQDT                          TJLQDT
     I              L5NBR                           TJNBR
     I              L5YTCD                          TJYTCD
     I              L5AMSX                          TJAMSX
     I              L5ASSX                          TJASSX
     I              L5ATSX                          TJATSX
     I              L5AUSX                          TJAUSX
     I              L5YSCD                          TJYSCD
     I              L5UVST                          TJUVST
     I              L5UWST                          TJUWST
     I              L5UXST                          TJUXST
     I              L5VSST                          TJVSST
     I              L5AATM                          TJAATM
     I              L5AYNA                          TJAYNA
     I              L5A0NA                          TJA0NA
     I              L5AXDT                          TJAXDT
      *
     IYFRDCS      DS                            111
     IQCAB11    E DSCAB1REL1
      * UPD : Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          TKAIC3
     I              B1HGCD                          TKHGCD
     I              B1AJCD                          TKAJCD
     I              B1ELDT                          TKELDT
     I              B1ABWG                          TKABWG
     I              B1AGQT                          TKAGQT
     I              B1AHQT                          TKAHQT
     I              B1AIQT                          TKAIQT
     I              B1CTST                          TKCTST
     I              B1ACWG                          TKACWG
     I              B1ARQT                          TKARQT
     I              B1ASQT                          TKASQT
     I              B1ATQT                          TKATQT
     I              B1HDQT                          TKHDQT
     I              B1HEQT                          TKHEQT
     I              B1F6ST                          TKF6ST
     I              B1BMWG                          TKBMWG
     I              B1DSQT                          TKDSQT
     I              B1DTQT                          TKDTQT
     I              B1DUQT                          TKDUQT
     I              B1DHDT                          TKDHDT
     I              B1AGCS                          TKAGCS
     I              B1AECS                          TKAECS
     I              B1IDVA                          TKIDVA
     I              B1K7DT                          TKK7DT
     I              B1RINB                          TKRINB
     I              B1RHNB                          TKRHNB
     I              B1RGNB                          TKRGNB
     I              B1UVST                          TKUVST
     I              B1UWST                          TKUWST
     I              B1UXST                          TKUXST
     I              B1VSST                          TKVSST
     I              B1AATM                          TKAATM
     I              B1AYNA                          TKAYNA
     I              B1A0NA                          TKA0NA
     I              B1AXDT                          TKAXDT
      *
     IYGRDCS      DS                             91
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          TLRMNB
     I              FJAIC3                          TLAIC3
     I              FJAODT                          TLAODT
     I              FJPJST                          TLPJST
     I              FJPKST                          TLPKST
     I              FJRNNB                          TLRNNB
     I              FJDMTX                          TLDMTX
     I              FJDNTX                          TLDNTX
     I              FJDOTX                          TLDOTX
     I              FJWTTX                          TLWTTX
     I              FJWUTX                          TLWUTX
     I              FJRPNB                          TLRPNB
     I              FJFLAM                          TLFLAM
     I              FJXQST                          TLXQST
     I              FJRRNB                          TLRRNB
     I              FJDXTX                          TLDXTX
     I              FJDYTX                          TLDYTX
     I              FJSBNB                          TLSBNB
     I              FJBZNA                          TLBZNA
     I              FJRONB                          TLRONB
     I              FJSQNB                          TLSQNB
     I              FJR1NB                          TLR1NB
     I              FJVCST                          TLVCST
     I              FJVDST                          TLVDST
     I              FJSDNB                          TLSDNB
     I              FJPAOU                          TLPAOU
     I              FJDGWG                          TLDGWG
     I              FJSXNB                          TLSXNB
     I              FJHADT                          TLHADT
     I              FJAART                          TLAART
     I              FJDHWG                          TLDHWG
     I              FJDIWG                          TLDIWG
     I              FJAQDT                          TLAQDT
     I              FJS6NB                          TLS6NB
     I              FJT4NB                          TLT4NB
     I              FJPRTM                          TLPRTM
     I              FJNPSV                          TLNPSV
     I              FJJ8TX                          TLJ8TX
     I              FJTLMI                          TLTLMI
     I              FJJ9TX                          TLJ9TX
     I              FJQ2CD                          TLQ2CD
     I              FJVPCD                          TLVPCD
     I              FJDBCD                          TLDBCD
     I              FJGRWE                          TLGRWE
     I              FJXCCD                          TLXCCD
     I              FJU2ST                          TLU2ST
     I              FJF9DT                          TLF9DT
     I              FJONTM                          TLONTM
     I              FJJ4DT                          TLJ4DT
     I              FJTRTM                          TLTRTM
     I              FJJ5DT                          TLJ5DT
     I              FJSPTM                          TLSPTM
     I              FJJ6DT                          TLJ6DT
     I              FJLFTM                          TLLFTM
     I              FJJ7DT                          TLJ7DT
     I              FJBOTM                          TLBOTM
     I              FJJ8DT                          TLJ8DT
     I              FJBLTM                          TLBLTM
     I              FJKIDT                          TLKIDT
     I              FJASTM                          TLASTM
     I              FJKADT                          TLKADT
     I              FJAJCM                          TLAJCM
     I              FJXACD                          TLXACD
     I              FJOANA                          TLOANA
     I              FJK4TX                          TLK4TX
     I              FJVOAG                          TLVOAG
     I              FJKBDT                          TLKBDT
     I              FJNBBO                          TLNBBO
     I              FJW4CD                          TLW4CD
     I              FJEFDT                          TLEFDT
     I              FJCNTN                          TLCNTN
     I              FJKCDT                          TLKCDT
     I              FJTMIN                          TLTMIN
     I              FJKDDT                          TLKDDT
     I              FJVMNB                          TLVMNB
     I              FJOCFR                          TLOCFR
     I              FJKJDT                          TLKJDT
     I              FJATTM                          TLATTM
     I              FJOTRS                          TLOTRS
     I              FJRNST                          TLRNST
     I              FJBRBK                          TLBRBK
     I              FJEIDT                          TLEIDT
     I              FJRMST                          TLRMST
     I              FJAJCD                          TLAJCD
     I              FJKKDT                          TLKKDT
     I              FJAVTM                          TLAVTM
     I              FJKZDT                          TLKZDT
     I              FJAXTM                          TLAXTM
     I              FJLHOS                          TLLHOS
     I              FJLHOR                          TLLHOR
     I              FJWNTX                          TLWNTX
     I              FJOITX                          TLOITX
     I              FJOJTX                          TLOJTX
     I              FJLLDT                          TLLLDT
     I              FJLSHG                          TLLSHG
     I              FJYPST                          TLYPST
     I              FJK0DT                          TLK0DT
     I              FJAYTM                          TLAYTM
     I              FJKNNX                          TLKNNX
     I              FJICWG                          TLICWG
     I              FJIDWG                          TLIDWG
     I              FJH9SX                          TLH9SX
     I              FJWOTX                          TLWOTX
     I              FJK1DT                          TLK1DT
     I              FJAZTM                          TLAZTM
     I              FJK2DT                          TLK2DT
     I              FJA0TM                          TLA0TM
     I              FJROST                          TLROST
     I              FJRPST                          TLRPST
     I              FJRQST                          TLRQST
     I              FJRRST                          TLRRST
     I              FJZBVA                          TLZBVA
     I              FJWPTX                          TLWPTX
     I              FJWQTX                          TLWQTX
     I              FJWRTX                          TLWRTX
     I              FJWSTX                          TLWSTX
     I              FJRVSX                          TLRVSX
     I              FJRUSX                          TLRUSX
     I              FJRWSX                          TLRWSX
     I              FJRXSX                          TLRXSX
     I              FJRYSX                          TLRYSX
     I              FJRZSX                          TLRZSX
     I              FJR0SX                          TLR0SX
     I              FJR1SX                          TLR1SX
     I              FJR2SX                          TLR2SX
     I              FJR3SX                          TLR3SX
     I              FJR4SX                          TLR4SX
     I              FJPYDT                          TLPYDT
     I              FJCKTM                          TLCKTM
     I              FJPZDT                          TLPZDT
     I              FJCLTM                          TLCLTM
     I              FJP0DT                          TLP0DT
     I              FJCMTM                          TLCMTM
     I              FJP1DT                          TLP1DT
     I              FJCNTM                          TLCNTM
     I              FJP2DT                          TLP2DT
     I              FJCOTM                          TLCOTM
     I              FJP3DT                          TLP3DT
     I              FJCQTM                          TLCQTM
     I              FJUVST                          TLUVST
     I              FJUWST                          TLUWST
     I              FJUXST                          TLUXST
     I              FJAATM                          TLAATM
     I              FJAYNA                          TLAYNA
     I              FJA0NA                          TLA0NA
     I              FJAXDT                          TLAXDT
      *
     IYHRDCS      DS                            793
     IYIRDCS      DS                            779
     IYJRDCS      DS                            793
     IQPDMS1    E DSPDMSREL0
      * UPD : Export Doc Order Dtl      Update index
      * Renamed input format fields
     I              MSAIC3                          TOAIC3
     I              MSC4NB                          TOC4NB
     I              MSDGSX                          TODGSX
     I              MSKXCD                          TOKXCD
     I              MSDPNB                          TODPNB
     I              MSUENB                          TOUENB
     I              MSDIC7                          TODIC7
     I              MSO3NA                          TOO3NA
     I              MSO4NA                          TOO4NA
     I              MSRMTX                          TORMTX
     I              MSPTTX                          TOPTTX
     I              MSHJWG                          TOHJWG
     I              MSHKWG                          TOHKWG
     I              MSRNTX                          TORNTX
     I              MSAONX                          TOAONX
     I              MSROTX                          TOROTX
     I              MSORNA                          TOORNA
     I              MSAMNX                          TOAMNX
     I              MSANNX                          TOANNX
     I              MSAPNX                          TOAPNX
     I              MSDKPR                          TODKPR
     I              MSA9VL                          TOA9VL
     I              MSC8SX                          TOC8SX
     I              MSRATX                          TORATX
     I              MSRBTX                          TORBTX
     I              MSAJNX                          TOAJNX
     I              MSZWTX                          TOZWTX
     I              MSZXTX                          TOZXTX
     I              MSZYTX                          TOZYTX
     I              MSZZTX                          TOZZTX
     I              MSK0U1                          TOK0U1
     I              MSK1U1                          TOK1U1
     I              MSIJSC                          TOIJSC
     I              MSIKSC                          TOIKSC
     I              MSK2U1                          TOK2U1
     I              MSW0DT                          TOW0DT
     I              MSUVST                          TOUVST
     I              MSUWST                          TOUWST
     I              MSUXST                          TOUXST
     I              MSVSST                          TOVSST
     I              MSAATM                          TOAATM
     I              MSAYNA                          TOAYNA
     I              MSA0NA                          TOA0NA
     I              MSAXDT                          TOAXDT
      *
     IQCAB71    E DSCAB7CPL0
      * UPD : Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          TSAIC3
     I              B7HGCD                          TSHGCD
     I              B7AJCD                          TSAJCD
     I              B7W9ST                          TSW9ST
     I              B7BSST                          TSBSST
     I              B7B4DT                          TSB4DT
     I              B7C4NY                          TSC4NY
     I              B7DXNB                          TSDXNB
     I              B7ELDT                          TSELDT
     I              B7HVCD                          TSHVCD
     I              B7F1ST                          TSF1ST
     I              B7AUNA                          TSAUNA
     I              B7A5QT                          TSA5QT
     I              B7AHWG                          TSAHWG
     I              B7AKCS                          TSAKCS
     I              B7CGCD                          TSCGCD
     I              B7AYVA                          TSAYVA
     I              B7BJNA                          TSBJNA
     I              B7CKNB                          TSCKNB
     I              B7BMST                          TSBMST
     I              B7CQCD                          TSCQCD
     I              B7DTCD                          TSDTCD
     I              B7MGNA                          TSMGNA
     I              B7TRBN                          TSTRBN
     I              B7TRBS                          TSTRBS
     I              B7C4NB                          TSC4NB
     I              B7RINB                          TSRINB
     I              B7RHNB                          TSRHNB
     I              B7RGNB                          TSRGNB
     I              B7M3NA                          TSM3NA
     I              B7AWTM                          TSAWTM
     I              B7XLCD                          TSXLCD
     I              B7K7DT                          TSK7DT
     I              B7UVST                          TSUVST
     I              B7UWST                          TSUWST
     I              B7UXST                          TSUXST
     I              B7VSST                          TSVSST
     I              B7AATM                          TSAATM
     I              B7AYNA                          TSAYNA
     I              B7A0NA                          TSA0NA
     I              B7AXDT                          TSAXDT
      *
     IYKRDCS      DS                            192
     IQPPBM1    E DSPPBMCPL0
      * UPD : PFS Ship Order Detail     Update index
      * Renamed input format fields
     I              BMY1NX                          TVY1NX
     I              BMAID8                          TVAID8
     I              BMAFTS                          TVAFTS
     I              BMBCNY                          TVBCNY
     I              BMZPNX                          TVZPNX
     I              BMZXNX                          TVZXNX
     I              BMZYNX                          TVZYNX
     I              BMY2NX                          TVY2NX
     I              BMAFD8                          TVAFD8
     I              BMAUNY                          TVAUNY
     I              BMAVNY                          TVAVNY
     I              BMVVSX                          TVVVSX
     I              BMUWSX                          TVUWSX
     I              BMUXSX                          TVUXSX
     I              BMV3SX                          TVV3SX
     I              BMAHNY                          TVAHNY
     I              BMAINY                          TVAINY
     I              BMAJNY                          TVAJNY
     I              BMAKNY                          TVAKNY
      *
     IYLRDCS      DS                            101
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: PFS Ship Load/Order Sts
      * I :  PFS Company Number
     I                                        1   30P1Y1NX
      * I :  PFS Load ID
     I                                        4  100P1ZGNX
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'PFS Billing Notify-Order'
      * PFS Load ID
     I                                    P   1   40ZA0001
      * PFS Order Number
     I                                    P   5   80ZA0002
      * Condition Name USR
     I                                        9  33 ZA0003
      * Message data for 'PFS Billing Notify-Load'
      * PFS Load ID
     I                                    P   1   40ZA0004
      * PFS Order Number
     I                                    P   5   80ZA0005
      * Condition Name USR
     I                                        9  33 ZA0006
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1Y1NX    PARM           WP0001  30       PFS Company Num
     C           P1ZGNX    PARM           WP0002  70       PFS Load ID
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PFS Ship Status ORD   XF
      * PFS Ship Status ORD   RT - PFS Ship Load/Order Sts  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         NARVGN    BEGSR
      *================================================================
      * Rtv & Dlt for Cancel  RT - Export Doc Order Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TMAIC3    WQNA01           Company Number
     C           *LIKE     DEFN TMC4NB    WQNA02           Order Number
      * Define keylist
     C           KRSNA     KLIST
     C                     KFLD           WQNA01           Company Number
     C                     KFLD           WQNA02           Order Number
      * Setup key
     C                     Z-ADDWN0003    WQNA01           Company Number
     C                     Z-ADDWN0004    WQNA02           Order Number
      * Establish starting position
     C           KRSNA     SETLL@MSREX2                    *
     C           KRSNA     READE@MSREX2                  90*
      * Data record not found
     C   90                MOVEL'USR2745' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Exp Doc Order Dtl  DL - Export Doc Order Dtl  * 
     C                     EXSR NBDLRC
     C           KRSNA     READE@MSREX2                  90*
     C                     ENDDO
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBDLRC    BEGSR
      *================================================================
      * Del Exp Doc Order Dtl  DL - Export Doc Order Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @MSREW4
     C                     Z-ADDTMAIC3    TOAIC3           Company Number
     C                     Z-ADDTMC4NB    TOC4NB           Order Number
     C                     MOVELTMDGSX    TODGSX           ED Export Docum
     C                     MOVELTMKXCD    TOKXCD           Country Code
     C                     Z-ADDTMDPNB    TODPNB           Order Sequence
     C                     Z-ADDTMUENB    TOUENB           Order Secondary
      *
     C           KLDLNB    KLIST
     C                     KFLD           TOAIC3           Company Number
     C                     KFLD           TOC4NB           Order Number
     C                     KFLD           TODGSX           ED Export Docum
     C                     KFLD           TOKXCD           Country Code
     C                     KFLD           TODPNB           Order Sequence
     C                     KFLD           TOUENB           Order Secondary
     C           KLDLNB    CHAIN@MSREW4              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDMSREL0'MDACP
     C                     MOVEL'@MSREW4' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL015.
     C                     MOVEL'LBL015'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NBEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@MSREW4                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCRVGN    BEGSR
      *================================================================
      * UPD Err Transactions   RT - Item Transaction Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TRAIC3    WQNC01           Company Number
     C           *LIKE     DEFN TRC4NB    WQNC02           Order Number
      * Define keylist
     C           KRSNC     KLIST
     C                     KFLD           WQNC01           Company Number
     C                     KFLD           WQNC02           Order Number
      * Setup key
     C                     Z-ADDWN0003    WQNC01           Company Number
     C                     Z-ADDWN0004    WQNC02           Order Number
      * Establish starting position
     C           KRSNC     SETLL@B7CPJD                    *
     C           KRSNC     READE@B7CPJD                  90*
      * Data record not found
     C   90                MOVEL'USR0344' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Reason Code        CH - Item Transaction Detail  * 
     C                     EXSR NDCHRC
     C           KRSNC     READE@B7CPJD                  90*
     C                     ENDDO
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDCHRC    BEGSR
      *================================================================
      * CHG Reason Code        CH - Item Transaction Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0841  70       Production Date
     C                     MOVEL*BLANK    WN0842  2        U/M - Transacti
     C                     MOVEL*BLANK    WN0843  2        Item Transactio
     C                     MOVEL*BLANK    WN0844 30        Description
     C                     Z-ADD*ZERO     WN0845 112       Transaction Qua
     C                     Z-ADD*ZERO     WN0846 112       Transaction Wei
     C                     Z-ADD*ZERO     WN0847 114       USR Transaction
     C                     MOVEL*BLANK    WN0848  2        U/M - Cost
     C                     Z-ADD*ZERO     WN0849 112       Extended Amount
     C                     MOVEL*BLANK    WN0850  6        Ticket Number
     C                     Z-ADD*ZERO     WN0851  80       G/L Document Nu
     C                     MOVEL*BLANK    WN0852  1        G/L Update Stat
     C                     MOVEL*BLANK    WN0853 15        Reference Numbe
     C                     MOVEL*BLANK    WN0854 10        Lot ID
     C                     Z-ADD*ZERO     WN0855  70       Transfer Batch
     C                     Z-ADD*ZERO     WN0856  30       Transfer Batch
     C                     Z-ADD*ZERO     WN0857  70       Order Number
     C                     Z-ADD*ZERO     WN0858  30       Item Structure
     C                     Z-ADD*ZERO     WN0859  30       Item Structure
     C                     Z-ADD*ZERO     WN0860  30       Item Structure
     C                     MOVEL*BLANK    WN0861 10        Employee Badge
     C                     Z-ADD*ZERO     WN0862  60       Production Time
     C                     MOVEL*BLANK    WN0863  1        Shift Number
     C                     Z-ADD*ZERO     WN0864  70       Label Date
     C                     MOVEL*BLANK    WN0865  1        EDI Status 1
     C                     MOVEL*BLANK    WN0866  1        EDI Status 2
     C                     MOVEL*BLANK    WN0867  1        EDI Status 3
     C                     MOVEL*BLANK    WN0868  1        Record Status
     C                     Z-ADD*ZERO     WN0869  60       Job Time
     C                     MOVEL*BLANK    WN0870 10        User Id
     C                     MOVEL*BLANK    WN0871 10        Job Name
     C                     Z-ADD*ZERO     WN0872  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YKRDC   1
      *
      * Move key fields to @B7CPJZ
     C                     Z-ADDTRAIC3    TSAIC3           Company Number
     C                     Z-ADDTRHGCD    TSHGCD           Item Code
     C                     MOVELTRAJCD    TSAJCD    P      Warehouse Code
     C                     MOVELTRW9ST    TSW9ST    P      Inventory Trans
     C                     MOVELTRBSST    TSBSST    P      Inventory Trans
     C                     Z-ADDTRB4DT    TSB4DT           Transaction Dat
     C                     Z-ADDTRC4NY    TSC4NY           ITD Sequence Nu
     C                     Z-ADDTRDXNB    TSDXNB           Sequence Number
      *
     C           KLCHND    KLIST
     C                     KFLD           TSAIC3           Company Number
     C                     KFLD           TSHGCD           Item Code
     C                     KFLD           TSAJCD           Warehouse Code
     C                     KFLD           TSW9ST           Inventory Trans
     C                     KFLD           TSBSST           Inventory Trans
     C                     KFLD           TSB4DT           Transaction Dat
     C                     KFLD           TSC4NY           ITD Sequence Nu
     C                     KFLD           TSDXNB           Sequence Number
     C           KLCHND    CHAIN@B7CPJZ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB7CPL0'MDACP
     C                     MOVEL'@B7CPJZ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL016.
     C                     MOVEL'LBL016'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB71    YKRDCS
      * Move non-key fields to @B7CPJZ
     C                     MOVEL*BLANK    TSCQCD    P      Reason Code
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB71    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * USER: Processing before Data update
      * 01/29/02 PKD Do not change the Record Stamp per Tom Dye. This
      *              causes inaccurate reporting on the Item Transaction
      *              Journal.
      * Set PGM.*Record Data Changed flag
     C           QCAB71    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YKRDC     IFEQ 'Y'
     C                     UPDAT@B7CPJZ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB7CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         NERVGN    BEGSR
      *================================================================
      * Upd Detail -Unshipped RT - PFS Ship Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TTY1NX    WQNE01           PFS Company Num
     C           *LIKE     DEFN TTZPNX    WQNE02           PFS Order Numbe
      * Define keylist
     C           KPSNE     KLIST
     C                     KFLD           WQNE01           PFS Company Num
     C                     KFLD           WQNE02           PFS Order Numbe
     C                     KFLD           TTAID8           PFS Transaction
     C                     KFLD           TTAFTS           PFS Transaction
      * Define keylist
     C           KRSNE     KLIST
     C                     KFLD           WQNE01           PFS Company Num
     C                     KFLD           WQNE02           PFS Order Numbe
      * Setup key
     C                     Z-ADDWAY1NX    WQNE01           PFS Company Num
     C                     Z-ADDWAZPNX    WQNE02           PFS Order Numbe
     C                     Z-ADDWAAID8    TTAID8           PFS Transaction
     C                     Z-ADDWAAFTS    TTAFTS           PFS Transaction
      * Establish starting position
     C           KPSNE     SETLL@BMCPE9                    *
     C           KRSNE     READE@BMCPE9                  90*
      * Data record not found
     C   90                MOVEL'USR3508' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.PFS Transaction Date EQ PAR.PFS Transaction Date
      *   |- c2    : DB1.PFS Transaction Time EQ PAR.PFS Transaction Time
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           TTAID8    IFEQ WAAID8                     *IF
     C           TTAFTS    IFEQ WAAFTS                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg PrcSts/ErrRsn     CH - PFS Ship Order Detail  * 
     C                     EXSR NFCHRC
     C                     END                             *FI
     C           KRSNE     READE@BMCPE9                  90*
     C                     ENDDO
      *================================================================
     CSR         NEEXIT    ENDSR
      /EJECT
     CSR         NFCHRC    BEGSR
      *================================================================
      * Chg PrcSts/ErrRsn     CH - PFS Ship Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0873  70       PFS Item Code
     C                     Z-ADD*ZERO     WN0874  80       PFS Actual Ship
     C                     Z-ADD*ZERO     WN0875  50       PFS Shipped Qua
     C                     Z-ADD*ZERO     WN0876  82       PFS Shipped Wei
     C                     MOVEL*BLANK    WN0877  2        PFS Short/Over
     C                     MOVEL*BLANK    WN0878  1        PFS Record Stat
     C                     Z-ADD*ZERO     WN0879  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0880  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0881  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0882  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YLRDC   1
      *
      * Move key fields to @BMCPYU
     C                     Z-ADDTTY1NX    TVY1NX           PFS Company Num
     C                     Z-ADDTTAID8    TVAID8           PFS Transaction
     C                     Z-ADDTTAFTS    TVAFTS           PFS Transaction
     C                     Z-ADDTTBCNY    TVBCNY           PFS Transaction
      *
     C           KLCHNF    KLIST
     C                     KFLD           TVY1NX           PFS Company Num
     C                     KFLD           TVAID8           PFS Transaction
     C                     KFLD           TVAFTS           PFS Transaction
     C                     KFLD           TVBCNY           PFS Transaction
     C           KLCHNF    CHAIN@BMCPYU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBMCPL0'MDACP
     C                     MOVEL'@BMCPYU' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL017.
     C                     MOVEL'LBL017'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPBM1    YLRDCS
      * Move non-key fields to @BMCPYU
     C                     Z-ADDTTZPNX    TVZPNX           PFS Order Numbe
     C                     Z-ADDTTZXNX    TVZXNX           PFS Order Line
     C                     Z-ADDTTZYNX    TVZYNX           PFS Substitutio
     C                     Z-ADD3         TVUXSX           PFS Process Sta
     C                     MOVEL'REOPN'   TVV3SX    P      PFS Error Reaso
      *
      * Set PGM.*Record Data Changed flag
     C           QPPBM1    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YLRDC     IFEQ 'Y'
     C                     UPDAT@BMCPYU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPBMCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NFEXIT    ENDSR
      /EJECT
     CSR         NGRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNG     KLIST
     C                     KFLD           TWAIC3           Company Number
     C                     KFLD           TWV8CD           Company Value C
      * Setup key
     C                     Z-ADDWN0003    TWAIC3           Company Number
     C                     MOVEL@CN,006   TWV8CD           Company Value C
      * Establish starting position
     C           KRSNG     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO NGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTWBXTX    YL0021           System Value Al
     C                     ENDIF
      *================================================================
     CSR         NGEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * PFS Ship Status ORD   RT - PFS Ship Load/Order Sts  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0002  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0003  30       Company Number
     C                     Z-ADD*ZERO     WN0004  70       Order Number
     C                     MOVEL*BLANK    WN0005  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0006  70       Ship To Custome
     C                     MOVEL*BLANK    WN0007  3        Carrier Code
     C                     MOVEL*BLANK    WN0008  1        Header Status
     C                     Z-ADD*ZERO     WN0009  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0010  70       Load ID
     C                     MOVEL*BLANK    WN0011  2        Event Code
     C                     MOVEL*BLANK    WN0012  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0013  1        Billing Activit
     C                     Z-ADD*ZERO     WN0014  50       Event Number
     C                     MOVEL*BLANK    WN0015  1        Error Status
     C                     MOVEL*BLANK    WN0016  1        Load Status
     C                     MOVEL*BLANK    WN0017  3        Warehouse Code
     C                     MOVEL*BLANK    WN0018  1        Record Found US
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAY1NX    WQSA01           PFS Company Num
     C           *LIKE     DEFN WAZGNX    WQSA02           PFS Load ID
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           PFS Company Num
     C                     KFLD           WQSA02           PFS Load ID
      * Setup key
     C                     Z-ADDP1Y1NX    WQSA01           PFS Company Num
     C                     Z-ADDP1ZGNX    WQSA02           PFS Load ID
      * Establish starting position
     C           KRSSA     SETLL@BKCPFA                    *
     C           KRSSA     READE@BKCPFA                  90*
      * Data record not found
     C   90                MOVEL'USR3504' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0001           PFS Process Sta
     C                     MOVEL*BLANK    WN0002           PFS Error Reaso
     C                     Z-ADD*ZERO     WN0003           Company Number
     C                     Z-ADD*ZERO     WN0004           Order Number
     C                     MOVEL*BLANK    WN0005           Order Type - Sa
     C                     Z-ADD*ZERO     WN0006           Ship To Custome
     C                     MOVEL*BLANK    WN0007           Carrier Code
     C                     MOVEL*BLANK    WN0008           Header Status
     C                     Z-ADD*ZERO     WN0009           Scheduled Ship
     C                     Z-ADD*ZERO     WN0010           Load ID
     C                     MOVEL*BLANK    WN0011           Event Code
     C                     MOVEL*BLANK    WN0012           Trans Contol AS
     C                     MOVEL*BLANK    WN0013           Billing Activit
     C                     Z-ADD*ZERO     WN0014           Event Number
     C                     MOVEL*BLANK    WN0015           Error Status
     C                     MOVEL*BLANK    WN0016           Load Status
     C                     MOVEL*BLANK    WN0017           Warehouse Code
     C                     MOVEL*BLANK    WN0018           Record Found US
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     Z-ADDWAUXSX    WN0001           PFS Process Sta
      * VALIDATE
     C                     EXSR UASUBR                     VALIDATE
      * PROCESS:  Selected Record
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: DB1.PFS Ship Status is Pick Order
     C           WAVRSX    IFEQ 'PO'                       *IF
      * UPD:  Order Header * Order Events
      * CASE: WRK.#Sequence Block is NULL
     C           WUZRST    IFEQ *BLANK                     *IF
      * RTV Check Pick Event   RT - Order Events  * 
     C                     EXSR SIRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL*BLANK    W0RTN            *Return code
      * RTV Next Event Number  RT - Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0003    WL0003           Company Number
     C                     Z-ADDWN0004    WL0004           Order Number
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    WN0014           Event Number
      * CRT Create Pick Event  RT - Order Events  * 
     C                     EXSR SKRVGN
      * UPD:  Order Header Event Code
      * CASE: PAR.Event Code is Open Orders
     C           WN0011    IFLT '04'                       *IF
      * CHG Event Code    PFS RT - Order Header TRG  * 
     C                     EXSR SMRVGN
      * S00930 RMC 9/02/09 Crt chg log rcd for pick event
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADDWN0010    PBRMNB           Load ID
     C                     Z-ADD0         PBRVNB           Stop/Drop
     C                     MOVEL'PCKPRC'  PBRVST    P      Load Change Typ
     C                     MOVEL'SHP'     PBUJST    P      Department Cont
     C                     MOVEL'02'      PBMNTX    P      Change Log Prio
     C                     MOVEL'03'      PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVELWN0007    PBBZNA    P      Carrier Code
     C                     Z-ADDWN0003    PBAIC3           Company Number
     C                     Z-ADDWN0004    PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD1         WN0001           PFS Process Sta
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PFS Ship Status is Unpick Order
     C           WAVRSX    IFEQ 'UP'                       *IF
      * UPD:  Order Header * Order Events
      * CASE: WRK.#Sequence Block is NULL
     C           WUZRST    IFEQ *BLANK                     *IF
      * Upd Unpick Order      XF - Order Header TRG  * 
     C                     CALL 'POBNXFR'              90  Upd Unpick Orde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0003    WQ0001  30       Company Number
     C                     PARM WN0004    WQ0002  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POBNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Chg 'PO' to 'XO' so it wont be found later.
      * Upd Status -Pick Ord  RT - PFS Ship Load/Order Sts  * 
     C                     EXSR SORVGN
      * S00930 RMC 9/02/09 Crt chg log rcd for Unpick event
      * CRT Load/Order Chg Log XF - Load Order Change Log  * 
     C                     CLEARPBRC
     C                     Z-ADDWN0010    PBRMNB           Load ID
     C                     Z-ADD0         PBRVNB           Stop/Drop
     C                     MOVEL'UNPCAR'  PBRVST    P      Load Change Typ
     C                     MOVEL'SHP'     PBUJST    P      Department Cont
     C                     MOVEL'03'      PBMNTX    P      Change Log Prio
     C                     MOVEL'02'      PBMOTX    P      Change Log New
     C                     MOVEL##USR     PBAYNA    P      User Id
     C                     MOVEL##PGM     PBA0NA    P      Job Name
     C                     MOVELWN0007    PBBZNA    P      Carrier Code
     C                     Z-ADDWN0003    PBAIC3           Company Number
     C                     Z-ADDWN0004    PBC4NB           Order Number
      *
     C                     CALL 'PDADXFR'              90  CRT Load/Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Load Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDADXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD1         WN0001           PFS Process Sta
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PFS Ship Status is Close Order
     C           WAVRSX    IFEQ 'CO'                       *IF
      * Validate if we have Order Detail records for Order.
      * VAl Ship OrdDtl Exist RT - PFS Ship Order Detail  * 
     C                     EXSR SQRVGN
      * Process Close Order if Order Detail records found.
      * CASE: LCL.Record Found USR is Record Found
     C           YL0004    IFEQ 'Y'                        *IF
      * PFS Del I5 Pick Trans RT - Order Inv Allocation  * 
     C                     EXSR SRRVGN
      * PFS Inventory Adj ORD XF - PFS Inventory Adjustment  * 
     C                     CALL 'PMDEXFR'              90  PFS Inventory A
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'S'       WQ0003  1        PFS Inv Adj Prc
     C                     PARM WAZPNX    WQ0004  70       PFS Order Numbe
     C                     PARM WAY1NX    WQ0005  30       PFS Company Num
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMDEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PFS Ship Order Detail XF - PFS Ship Order Detail  * 
     C                     CALL 'PPN9XFR'              90  PFS Ship Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAY1NX    WQ0006  30       PFS Company Num
     C                     PARM WAZPNX    WQ0007  70       PFS Order Numbe
     C           WN0015    PARM WN0015    WQ0008  1        Error Status
     C                     PARM 'PP'      WQ0009  2        Close Order Pre
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPN9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * INIT:  Pre Pass Error
      * CASE: PAR.Error Status is yes
     C           WN0015    IFEQ 'Y'                        *IF
     C                     MOVEL'ORDDTL'  WN0002           PFS Error Reaso
     C                     ELSE
      * CASE: *OTHERWISE
      * PFS Ship Order Detail XF - PFS Ship Order Detail  * 
     C                     CALL 'PPN9XFR'              90  PFS Ship Order
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAY1NX    WQ0010  30       PFS Company Num
     C                     PARM WAZPNX    WQ0011  70       PFS Order Numbe
     C           WN0015    PARM WN0015    WQ0012  1        Error Status
     C                     PARM 'PS'      WQ0013  2        Close Order Pre
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPN9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * INIT:  Process Status & Error Reason
      * CASE: PAR.Error Status is yes
     C           WN0015    IFEQ 'Y'                        *IF
     C                     Z-ADD2         WN0001           PFS Process Sta
     C                     MOVEL'ORDDTL'  WN0002           PFS Error Reaso
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         WN0001           PFS Process Sta
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PFS Ship Status is Close Truck
     C           WAVRSX    IFEQ 'CT'                       *IF
      * RTV All Ords Shipped?  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAZGNX    WL0001           Load ID
     C                     MOVELYL0001    WL0002    P      Status - Y or N
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0001    P      Status - Y or N
      * CASE: LCL.Status - Y or N is yes
     C           YL0001    IFEQ 'Y'                        *IF
      * RMC If record doesnt exist in ppblcpp, dont flag CT as processed
      * PFS Ship Load Header  XF - PFS Ship Load Header  * 
     C                     CALL 'PPNSXFR'              90  PFS Ship Load H
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAY1NX    WQ0014  30       PFS Company Num
     C                     PARM WAZGNX    WQ0015  70       PFS Load ID
     C           WN0018    PARM WN0018    WQ0016  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNSXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.Record Found USR is Record Found
     C           WN0018    IFEQ 'Y'                        *IF
     C                     Z-ADD1         WN0001           PFS Process Sta
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.PFS Ship Status is Reopen Truck
     C           WAVRSX    IFEQ 'RT'                       *IF
      * UPD:  Load & Ship Status
      * CASE: PAR.Load Status is Shipped
     C           WN0016    IFEQ 'S'                        *IF
      * PFS Upd Load Status   RT - Load Header  * 
     C                     EXSR STRVGN
     C                     Z-ADD1         WN0001           PFS Process Sta
     C                     END                             *FI
     C                     Z-ADD1         WN0001           PFS Process Sta
      * ** Mark Previous Transactions with Process Status = 3 **
      * Upd Load -Reopen Trk  RT - PFS Ship Load Header  * 
     C                     EXSR SURVGN
      * Upd Status -ReOpn Trk RT - PFS Ship Load/Order Sts  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0021           PFS Company Num
     C                     Z-ADDWAZGNX    WL0022           PFS Load ID
     C                     Z-ADDWAAID8    WL0023           PFS Transaction
     C                     Z-ADDWAAFTS    WL0024           PFS Transaction
     C                     EXSR SWRVGN
     C                     ELSE
      * CASE: DB1.PFS Ship Status is ReOpen Order (Unship)
     C           WAVRSX    IFEQ 'UO'                       *IF
      * RTV Delete Ship Event  RT - Order Events  * 
     C                     EXSR SYRVGN
      * RTV Next Event Number  RT - Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0003    WL0003           Company Number
     C                     Z-ADDWN0004    WL0004           Order Number
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    YL0006           Event Number
      * RTV Event Code         RT - Order Events  * 
     C                     EXSR TARVGN
      * UPD Unship Ship Detail RT - Order Detail  * 
     C                     EXSR TBRVGN
      * Cnf Order Ship/Unship IF
      * Cnf Order Ship/Unship RT - Order Inv Allocation  * 
     C                     EXSR TIRVGN
      * CLC Tot Ord Val Ship   XF - Order Detail  * 
     C                     CALL 'PDP1XFR'              90  CLC Tot Ord Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0003    WQ0089  30       Company Number
     C                     PARM WN0004    WQ0090  70       Order Number
     C           WUJSVA    PARM WUJSVA    WQ0091 112       USR Order Value
     C           WUAYWG    PARM WUAYWG    WQ0092 112       USR Order Weigh
     C           WUXPST    PARM WUXPST    WQ0093  1        USR Production
     C           WUR4ST    PARM WUR4ST    WQ0094  1        USR Update Flag
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDP1XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * UPD Unship Load Status RT - Load Header  * 
     C                     EXSR TVRVGN
      * PFS Unship Order      RT - Order Header TRG  * 
     C                     EXSR TXRVGN
      * CHG Load Status/ActShp CH - Load Header  * 
     C                     EXSR TZCHRC
      * RMC S00619 01/06/09 Del exp doc dtls when unshipping orders
      * Rtv & Dlt for Cancel  RT - Export Doc Order Dtl  * 
     C                     EXSR NARVGN
      * UPD Err Transactions   RT - Item Transaction Detail  * 
     C                     EXSR NCRVGN
      * T11041 DN 07/12/17-Update EDI WHS Stock Txfr Files for Carlisle O
      * CASE: PAR.Billing Activity Type is Warehouse Transfer
     C           WN0013    IFEQ '4'                        *IF
      * Upd EDI WHS Stock Txfr XF - EDI WHS Stock Txfr   HDR  * 
     C                     CALL 'PUC5XFR'              90  Upd EDI WHS Sto
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0003    WQ0095  30       Company Number
     C                     PARM WN0004    WQ0096  70       Order Number
     C                     PARM 'Y'       WQ0097  1        USR Unship Flag
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUC5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     Z-ADD1         WN0001           PFS Process Sta
      * ** Mark Previous Transactions with Process Status = 3 **
      * Upd Detail -Unshipped RT - PFS Ship Order Detail  * 
     C                     EXSR NERVGN
      * Upd Status -ReOpn Trk RT - PFS Ship Load/Order Sts  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0021           PFS Company Num
     C                     Z-ADDWAZGNX    WL0022           PFS Load ID
     C                     Z-ADDWAAID8    WL0023           PFS Transaction
     C                     Z-ADDWAAFTS    WL0024           PFS Transaction
     C                     EXSR SWRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Pager Message
      * CASE: PAR.PFS Process Status is Error
     C           WN0001    IFEQ 2                          *IF
      * CASE: PAR.PFS Error Reason is Inactive Transaction
     C           WN0002    IFEQ @CN,004                    *IF
     C                     Z-ADD1         WN0001           PFS Process Sta
     C                     ELSE
      * CASE: PAR.PFS Error Reason is All Orders Not Shipped
     C           WN0002    IFEQ @CN,005                    *IF
     C                     Z-ADD0         WN0001           PFS Process Sta
     C                     ELSE
      * CASE: *OTHERWISE
      * LCL.Condition Name USR = Condition name of DB1.PFS Ship Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1731617   Y2LSNO  70       List number
     C                     PARM WAVRSX    W0INVL 25        PFS Ship Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           YL0019    PARM           W0CNNM 25        Condition Name
      *
      * CASE: DB1.PFS Ship Status is Order Transactions
     C           WAVRSX    IFEQ 'CO'                       *IF
     C           WAVRSX    OREQ 'PO'
     C           WAVRSX    OREQ 'UO'
     C           WAVRSX    OREQ 'UP'
      * Setup message data for message
     C                     Z-ADDWAZGNX    ZA0001           PFS Load ID
     C                     Z-ADDWAZPNX    ZA0002           PFS Order Numbe
     C                     MOVELYL0019    ZA0003           Condition Name
      * Retrieve message PFS Billing Notify-Order
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3590' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0020    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADDWAZGNX    ZA0004           PFS Load ID
     C                     Z-ADDWAZPNX    ZA0005           PFS Order Numbe
     C                     MOVELYL0019    ZA0006           Condition Name
      * Retrieve message PFS Billing Notify-Load
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3591' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0020    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
     C                     END                             *FI
      * RTV Alpha Value        RT - Company Values  * 
     C                     EXSR NGRVGN
      * SND Pager Msg (MPLUS) UP - /UT User Programs  * 
     C                     CALL 'POMSUPC'              90  SND Pager Msg (
     C                     PARM YL0021    WQ0098 10        DL List ID
     C                     PARM YL0020    WQ0099132        Office Message
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMSUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Chg PrcSts/ErrRsn     CH - PFS Ship Load/Order Sts  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAY1NX    WL0025           PFS Company Num
     C                     Z-ADDWAAID8    WL0026           PFS Transaction
     C                     Z-ADDWAAFTS    WL0027           PFS Transaction
     C                     Z-ADDWABCNY    WL0028           PFS Transaction
     C                     Z-ADDWN0001    WL0029           PFS Process Sta
     C                     MOVELWN0002    WL0030    P      PFS Error Reaso
     C                     EXSR SXCHRC
     C           KRSSA     READE@BKCPFA                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Order Info PFS    RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDWN0003    WBAIC3           Company Number
     C                     Z-ADDWN0004    WBC4NB           Order Number
      * Establish starting position
     C           KRSSB     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBJNCD    WN0005           Order Type - Sa
     C                     Z-ADDWBBKC7    WN0006           Ship To Custome
     C                     MOVELWBBZNA    WN0007           Carrier Code
     C                     MOVELWBGWST    WN0008           Header Status
     C                     Z-ADDWBAODT    WN0009           Scheduled Ship
     C                     Z-ADDWBRMNB    WN0010           Load ID
     C                     MOVELWBJPCD    WN0011           Event Code
     C                     MOVELWBXUST    WN0012           Trans Contol AS
     C                     MOVELWBOBST    WN0013           Billing Activit
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSC02           Order Number
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
     C                     KFLD           WCDPNB           Order Sequence
     C                     KFLD           WCUENB           Order Secondary
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
      * Setup key
     C                     Z-ADDWN0003    WQSC01           Company Number
     C                     Z-ADDWN0004    WQSC02           Order Number
     C                     Z-ADD0         WCDPNB           Order Sequence
     C                     Z-ADD0         WCUENB           Order Secondary
      * Establish starting position
     C           KPSSC     SETLL@BGWKAE                    *
     C           KRSSC     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0017           Warehouse Code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Warehouse Control  RT - Warehouse  * 
     C                     EXSR SDRVGN
      * PAR = DB1 By name
     C                     MOVELWCAJCD    WN0017           Warehouse Code
     C                     GOTO SCEXIT                     *QUIT
     C           KRSSC     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Warehouse Control  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAJCD           Warehouse Code
      * Setup key
     C                     MOVELWCAJCD    WDAJCD           Warehouse Code
      * Establish starting position
     C           KRSSD     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Load Status        RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WERMNB           Load ID
      * Setup key
     C                     Z-ADDWN0010    WERMNB           Load ID
      * Establish starting position
     C           KRSSE     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0016           Load Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWEPKST    WN0016           Load Status
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV All Ords Shipped?  RT - Load Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0019  1        Header Status
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WL0002           Status - Y or N
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFRMNB    WQSF01           Load ID
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Load ID
      * Setup key
     C                     Z-ADDWL0001    WQSF01           Load ID
      * Establish starting position
     C           KRSSF     SETLL@FLCPBW                    *
     C           KRSSF     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Assume all orders are shipped, unless find one that isn't
      * RTV Order Status       RT - Order Header TRG  * 
     C                     EXSR SGRVGN
      * CASE: PAR.Header Status is Conf/Comp/Canc
     C           WN0019    IFEQ 'X'                        *IF
     C           WN0019    OREQ 'C'
     C           WN0019    OREQ 'R'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WL0002           Status - Y or N
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSF     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Order Status       RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDWFAIC3    WBAIC3           Company Number
     C                     Z-ADDWFC4NB    WBC4NB           Order Number
      * Establish starting position
     C           KRSSG     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBGWST    WN0019           Header Status
     C                     MOVELWBGXST    WUG0TX           Header Status L
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Live w/CT LD/ORD  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WDAJCD           Warehouse Code
      * Setup key
     C                     MOVELWN0017    WDAJCD           Warehouse Code
      * Establish starting position
     C           KRSSH     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0002           WHS Live w/Carl
     C                     MOVEL*BLANK    YL0003           WHS PFS Interfa
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDRRSX    YL0002           WHS Live w/Carl
     C                     MOVELWDRSSX    YL0003           WHS PFS Interfa
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Check Pick Event   RT - Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSI01           Company Number
     C           *LIKE     DEFN WGC4NB    WQSI02           Order Number
     C           *LIKE     DEFN WGJPCD    WQSI03           Event Code
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Order Number
     C                     KFLD           WQSI03           Event Code
      * Setup key
     C                     Z-ADDWN0003    WQSI01           Company Number
     C                     Z-ADDWN0004    WQSI02           Order Number
     C                     MOVEL'03'      WQSI03           Event Code
      * Establish starting position
     C           KRSSI     SETLL@EYCPZE                    *
     C           KRSSI     READE@EYCPZE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1074' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SIEXIT                     *QUIT
     C           KRSSI     READE@EYCPZE                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Next Event Number  RT - Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN WHC4NB    WQSJ02           Order Number
      * Define keylist
     C           KPSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Order Number
     C                     KFLD           WHQ2NB           Event Number
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Order Number
      * Setup key
     C                     Z-ADDWL0003    WQSJ01           Company Number
     C                     Z-ADDWL0004    WQSJ02           Order Number
     C                     Z-ADDWL0005    WHQ2NB           Event Number
      * Establish starting position
     C           KPSSJ     SETLL@EYCPY2                    *
     C           KRSSJ     READE@EYCPY2                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1074' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0005           Event Number
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWHQ2NB    WL0005           Event Number
     C           KRSSJ     READE@EYCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * CRT Create Pick Event  RT - Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHC4NB           Order Number
     C                     KFLD           WHQ2NB           Event Number
      * Setup key
     C                     Z-ADDWN0003    WHAIC3           Company Number
     C                     Z-ADDWN0004    WHC4NB           Order Number
     C                     Z-ADDWN0014    WHQ2NB           Event Number
      * Establish starting position
     C           KRSSK     SETGT@EYCPY2                91  *
     C                     READP@EYCPY2                9190*
      * Check high order keys
     C  N90      WN0003    IFNE WHAIC3                     Company Number
     C           WN0004    ORNE WHC4NB                     Order Number
     C                     SETON                     90
     C                     END
      *
      * Data record not found
     C   90                MOVEL'USR1074' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WHQ2NB    ADD  1         WUQ2NB           Event Number
      * CRT OP Order Events    CR - OP Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWHAIC3    WL0006           Company Number
     C                     Z-ADDWHC4NB    WL0007           Order Number
     C                     Z-ADDWUQ2NB    WL0008           Event Number
     C                     MOVEL'03'      WL0009    P      Event Code
     C                     Z-ADDWHAUC3    WL0010           Invoice/Memo Co
     C                     Z-ADDWHQ7NB    WL0011           Invoice/Memo Nu
     C                     MOVELWHOMST    WL0012    P      Invoice/Memo Su
     C                     Z-ADD##JDT     WL0013           Event Date
     C                     MOVELWHONST    WL0014    P      Activity Comple
     C                     MOVELWHOOST    WL0015    P      Activity Hold
     C                     MOVELWHOPST    WL0016    P      Post Cash Compl
     C                     Z-ADDWHAWC3    WL0017           Cross Event Ref
     C                     Z-ADDWHQ8NB    WL0018           Cross Event Ref
     C                     Z-ADDWHQ9NB    WL0019           Cross Event Ref
     C                     Z-ADDWHBKC7    WL0020           Ship To Custome
     C                     EXSR SLCRRC
     C                     GOTO SKEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCRRC    BEGSR
      *================================================================
      * CRT OP Order Events    CR - OP Order Events  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0020  1        EDI Status 1
     C                     MOVEL*BLANK    WN0021  1        EDI Status 2
     C                     MOVEL*BLANK    WN0022  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0023  60       Job Time
     C                     MOVEL*BLANK    WN0024 10        User Id
     C                     MOVEL*BLANK    WN0025 10        Job Name
     C                     Z-ADD*ZERO     WN0026  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EYCPY3
     C                     Z-ADDWL0006    WIAIC3           Company Number
     C                     Z-ADDWL0007    WIC4NB           Order Number
     C                     Z-ADDWL0008    WIQ2NB           Event Number
     C                     MOVELWL0009    WIJPCD           Event Code
     C                     Z-ADDWL0010    WIAUC3           Invoice/Memo Co
     C                     Z-ADDWL0011    WIQ7NB           Invoice/Memo Nu
     C                     MOVELWL0012    WIOMST           Invoice/Memo Su
     C                     Z-ADDWL0013    WID2DT           Event Date
     C                     MOVELWL0014    WIONST           Activity Comple
     C                     MOVELWL0015    WIOOST           Activity Hold
     C                     MOVELWL0016    WIOPST           Post Cash Compl
     C                     Z-ADDWL0017    WIAWC3           Cross Event Ref
     C                     Z-ADDWL0018    WIQ8NB           Cross Event Ref
     C                     Z-ADDWL0019    WIQ9NB           Cross Event Ref
     C                     Z-ADDWL0020    WIBKC7           Ship To Custome
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##JOB     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
     C           KLCRSL    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C                     KFLD           WIQ2NB           Event Number
      * Check for duplicate primary key
     C           KLCRSL    SETLL@EYCPY3                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1075' W0RTN   7
      * Send message 'Order Events           EX'
     C                     MOVEL'USR1075' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C                     WRITE@EYCPY3                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * CHG Event Code    PFS RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDWN0003    WBAIC3           Company Number
     C                     Z-ADDWN0004    WBC4NB           Order Number
      * Establish starting position
     C           KRSSM     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Order Event        CH - Order Header TRG  * 
     C                     EXSR SNCHRC
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCHRC    BEGSR
      *================================================================
      * Chg Order Event        CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0027  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0028  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0029  70       Ship To Custome
     C                     MOVEL*BLANK    WN0030 30        Ship To Name
     C                     MOVEL*BLANK    WN0031 30        Ship To Address
     C                     MOVEL*BLANK    WN0032 30        Ship To Address
     C                     MOVEL*BLANK    WN0033 30        Ship To Address
     C                     MOVEL*BLANK    WN0034 20        Ship To City
     C                     MOVEL*BLANK    WN0035  2        Ship To State C
     C                     MOVEL*BLANK    WN0036 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0037  70       Bill to Custome
     C                     MOVEL*BLANK    WN0038 30        Bill to Name
     C                     MOVEL*BLANK    WN0039 30        Bill to Address
     C                     MOVEL*BLANK    WN0040 30        Bill to Address
     C                     MOVEL*BLANK    WN0041 30        Bill to Address
     C                     MOVEL*BLANK    WN0042 20        Bill to City
     C                     MOVEL*BLANK    WN0043  2        Bill to State C
     C                     MOVEL*BLANK    WN0044 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0045 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0046  70       Order Date
     C                     Z-ADD*ZERO     WN0047  70       Requested Ship
     C                     Z-ADD*ZERO     WN0048  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0049  70       Cancel Date
     C                     MOVEL*BLANK    WN0050  2        Terms Code
     C                     MOVEL*BLANK    WN0051 40        Special Instruc
     C                     MOVEL*BLANK    WN0052 40        Special Instruc
     C                     MOVEL*BLANK    WN0053  3        Carrier Code
     C                     MOVEL*BLANK    WN0054  1        Comment Print A
     C                     MOVEL*BLANK    WN0055  1        Comment Print I
     C                     MOVEL*BLANK    WN0056  1        Comment Print P
     C                     MOVEL*BLANK    WN0057  1        Comment Print S
     C                     MOVEL*BLANK    WN0058  3        Reason Code
     C                     MOVEL*BLANK    WN0059  1        Order in Use
     C                     MOVEL*BLANK    WN0060  1        Header Status
     C                     MOVEL*BLANK    WN0061  1        Header Status L
     C                     MOVEL*BLANK    WN0062  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0063  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0064 10        User Original E
     C                     Z-ADD*ZERO     WN0065  70       Date of Origina
     C                     Z-ADD*ZERO     WN0066 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0067 112       Order Weight To
     C                     MOVEL*BLANK    WN0068  1        Credit Hold
     C                     MOVEL*BLANK    WN0069  1        Production Hold
     C                     MOVEL*BLANK    WN0070  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0071  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0072  40       Requested Deliv
     C                     MOVEL*BLANK    WN0073  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0074 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0075  70       Load ID
     C                     Z-ADD*ZERO     WN0076  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0077 112       Rated Freight
     C                     MOVEL*BLANK    WN0078  1        LTL Flag
     C                     MOVEL*BLANK    WN0079  1        Price Audit
     C                     MOVEL*BLANK    WN0080  1        Price Status
     C                     MOVEL*BLANK    WN0081  2        Shipping Method
     C                     MOVEL*BLANK    WN0082  1        Export Status
     C                     MOVEL*BLANK    WN0083  1        Palletize
     C                     MOVEL*BLANK    WN0084  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0085  1        Slip Sheet
     C                     MOVEL*BLANK    WN0086  1        Age Code
     C                     Z-ADD*ZERO     WN0087  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0088  1        Load Type
     C                     Z-ADD*ZERO     WN0089  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0090  1        Load Plan Order
     C                     MOVEL*BLANK    WN0091  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0092  70       Resell Referenc
     C                     MOVEL*BLANK    WN0093 30        Special Comment
     C                     MOVEL*BLANK    WN0094 30        Special Comment
     C                     MOVEL*BLANK    WN0095  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0096  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0097  2        Manager Level C
     C                     MOVEL*BLANK    WN0098  3        VP Level Code
     C                     Z-ADD*ZERO     WN0099  70       Attach to Order
     C                     MOVEL*BLANK    WN0100  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0101  70       Invoice Number
     C                     MOVEL*BLANK    WN0102  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0103  70       Invoice Date
     C                     MOVEL*BLANK    WN0104  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0105  1        Modified Flag
     C                     Z-ADD*ZERO     WN0106 112       A/R order Value
     C                     MOVEL*BLANK    WN0107  1        Billing Activit
     C                     MOVEL*BLANK    WN0108  1        Block Order Fla
     C                     MOVEL*BLANK    WN0109  1        Order Certifica
     C                     Z-ADD*ZERO     WN0110 112       Invoice Order V
     C                     MOVEL*BLANK    WN0111  1        Process Sts for
     C                     MOVEL*BLANK    WN0112  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0113  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0114  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0115  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0116  1        Email Cust On O
     C                     MOVEL*BLANK    WN0117  1        Order Emailed
     C                     MOVEL*BLANK    WN0118  1        Export Docs Go
     C                     MOVEL*BLANK    WN0119  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0120  1        Broker Order St
     C                     MOVEL*BLANK    WN0121  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0122  2        Order Requires
     C                     MOVEL*BLANK    WN0123  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0124  2        Export USDA App
     C                     MOVEL*BLANK    WN0125  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0126  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0127  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0128  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0129  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0130  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0131  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0132  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0133  60       Time of Origina
     C                     Z-ADD*ZERO     WN0134  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0135  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0136  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0137 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0138 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0139 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0140 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0141 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0142  70       Claim Number
     C                     MOVEL*BLANK    WN0143  1        EDI Status 1
     C                     MOVEL*BLANK    WN0144  1        EDI Status 2
     C                     MOVEL*BLANK    WN0145  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0146  60       Job Time
     C                     MOVEL*BLANK    WN0147 10        User Id
     C                     MOVEL*BLANK    WN0148 10        Job Name
     C                     Z-ADD*ZERO     WN0149  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWBAIC3    WJAIC3           Company Number
     C                     Z-ADDWBC4NB    WJC4NB           Order Number
      *
     C           KLCHSN    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJC4NB           Order Number
     C           KLCHSN    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YARDCS
      * Move non-key fields to @BECPFJ
     C                     MOVEL'03'      WJJPCD    P      Event Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##PGM     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDWJAIC3    PAAIC3           Company Number
     C                     Z-ADDWJC4NB    PAC4NB           Order Number
     C                     MOVELWJJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDWJANC7    PAANC7           A/R Customer Nu
     C                     Z-ADDWJBKC7    PABKC7           Ship To Custome
     C                     MOVELWJBRTX    PABRTX    P      Ship To Name
     C                     MOVELWJHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWJHONA    PAHONA    P      Ship To Address
     C                     MOVELWJHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWJHNNA    PAHNNA    P      Ship To City
     C                     MOVELWJDBCD    PADBCD    P      Ship To State C
     C                     MOVELWJCKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDWJB0C7    PAB0C7           Bill to Custome
     C                     MOVELWJAETX    PAAETX    P      Bill to Name
     C                     MOVELWJB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWJB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWJB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWJB2NA    PAB2NA    P      Bill to City
     C                     MOVELWJBHCD    PABHCD    P      Bill to State C
     C                     MOVELWJC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELWJBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWJA0DT    PAA0DT           Order Date
     C                     Z-ADDWJA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWJGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWJACDT    PAACDT           Cancel Date
     C                     MOVELWJAQCD    PAAQCD    P      Terms Code
     C                     MOVELWJB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWJBYNA    PABYNA    P      Special Instruc
     C                     MOVELWJBZNA    PABZNA    P      Carrier Code
     C                     MOVELWJGTST    PAGTST    P      Comment Print A
     C                     MOVELWJGVST    PAGVST    P      Comment Print I
     C                     MOVELWJGUST    PAGUST    P      Comment Print P
     C                     MOVELWJQFST    PAQFST    P      Comment Print S
     C                     MOVELWJCQCD    PACQCD    P      Reason Code
     C                     MOVELWJGJST    PAGJST    P      Order in Use
     C                     MOVELWJGWST    PAGWST    P      Header Status
     C                     MOVELWJGXST    PAGXST    P      Header Status L
     C                     MOVELWJGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWJAODT    PAAODT           Scheduled Ship
     C                     MOVELWJAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWJCXDT    PACXDT           Date of Origina
     C                     Z-ADDWJJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWJA1WG    PAA1WG           Order Weight To
     C                     MOVELWJXIST    PAXIST    P      Credit Hold
     C                     MOVELWJXJST    PAXJST    P      Production Hold
     C                     MOVELWJXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWJEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWJAFTM    PAAFTM           Requested Deliv
     C                     MOVELWJE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWJE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWJRMNB    PARMNB           Load ID
     C                     Z-ADDWJTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWJR1NB    PAR1NB           Rated Freight
     C                     MOVELWJPJST    PAPJST    P      LTL Flag
     C                     MOVELWJU0ST    PAU0ST    P      Price Audit
     C                     MOVELWJU1ST    PAU1ST    P      Price Status
     C                     MOVELWJQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWJU2ST    PAU2ST    P      Export Status
     C                     MOVELWJVEST    PAVEST    P      Palletize
     C                     MOVELWJVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWJVGST    PAVGST    P      Slip Sheet
     C                     MOVELWJRPCD    PARPCD    P      Age Code
     C                     Z-ADDWJRNNB    PARNNB           Reefer Temperat
     C                     MOVELWJVDST    PAVDST    P      Load Type
     C                     Z-ADDWJATIN    PAATIN           Attach to Invoi
     C                     MOVELWJU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWJU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWJRSRN    PARSRN           Resell Referenc
     C                     MOVELWJMHNA    PAMHNA    P      Special Comment
     C                     MOVELWJMINA    PAMINA    P      Special Comment
     C                     MOVELWJWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWJR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWJBFCD    PABFCD    P      Manager Level C
     C                     MOVELWJQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWJT3NB    PAT3NB           Attach to Order
     C                     MOVELWJSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWJCONB    PACONB           Invoice Number
     C                     MOVELWJCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWJAWDT    PAAWDT           Invoice Date
     C                     MOVELWJJPCD    PAJPCD    P      Event Code
     C                     MOVELWJXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWJZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWJVRVA    PAVRVA           A/R order Value
     C                     MOVELWJOBST    PAOBST    P      Billing Activit
     C                     MOVELWJBCST    PABCST    P      Block Order Fla
     C                     MOVELWJBDST    PABDST    P      Order Certifica
     C                     Z-ADDWJB7VL    PAB7VL           Invoice Order V
     C                     MOVELWJGASX    PAGASX    P      Process Sts for
     C                     MOVELWJGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWJGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWJGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWJFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWJFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWJFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWJFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWJFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWJFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWJFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWJFUSX    PAFUSX    P      Order Requires
     C                     MOVELWJFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWJFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWJFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWJFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWJNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWJNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWJNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWJNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWJNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWJBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWJBQTM    PABQTM           Time of Origina
     C                     Z-ADDWJBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWJBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWJBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWJH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWJH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDWJH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWJH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDWJH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWJC0C7    PAC0C7           Claim Number
     C                     MOVELWJUVST    PAUVST    P      EDI Status 1
     C                     MOVELWJUWST    PAUWST    P      EDI Status 2
     C                     MOVELWJUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWJAATM    PAAATM           Job Time
     C                     MOVELWJAYNA    PAAYNA    P      User Id
     C                     MOVELWJA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWJAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Upd Status -Pick Ord  RT - PFS Ship Load/Order Sts  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKZGNX    WQSO01           PFS Load ID
     C           *LIKE     DEFN WKZPNX    WQSO02           PFS Order Numbe
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           PFS Load ID
     C                     KFLD           WQSO02           PFS Order Numbe
      * Setup key
     C                     Z-ADDWAZGNX    WQSO01           PFS Load ID
     C                     Z-ADDWAZPNX    WQSO02           PFS Order Numbe
      * Establish starting position
     C           KRSSO     SETLL@BKCPEK                    *
     C           KRSSO     READE@BKCPEK                  90*
      * Data record not found
     C   90                MOVEL'USR3504' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'XO'      WUHKT1           Text 2
      * Chg Pick Ord to XO    CH - PFS Ship Load/Order Sts  * 
     C                     EXSR SPCHRC
     C           KRSSO     READE@BKCPEK                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCHRC    BEGSR
      *================================================================
      * Chg Pick Ord to XO    CH - PFS Ship Load/Order Sts  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0150  70       PFS Load ID
     C                     Z-ADD*ZERO     WN0151  70       PFS Order Numbe
     C                     MOVEL*BLANK    WN0152  1        PFS Export USDA
     C                     MOVEL*BLANK    WN0153  1        PFS Record Stat
     C                     Z-ADD*ZERO     WN0154  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0155  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0156  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0157  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0158  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0159  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BKCPZU
     C                     Z-ADDWKY1NX    WLY1NX           PFS Company Num
     C                     Z-ADDWKAID8    WLAID8           PFS Transaction
     C                     Z-ADDWKAFTS    WLAFTS           PFS Transaction
     C                     Z-ADDWKBCNY    WLBCNY           PFS Transaction
      *
     C           KLCHSP    KLIST
     C                     KFLD           WLY1NX           PFS Company Num
     C                     KFLD           WLAID8           PFS Transaction
     C                     KFLD           WLAFTS           PFS Transaction
     C                     KFLD           WLBCNY           PFS Transaction
     C           KLCHSP    CHAIN@BKCPZU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBKCPL0'MDACP
     C                     MOVEL'@BKCPZU' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPBK1    YBRDCS
      * Move non-key fields to @BKCPZU
     C                     MOVELWUHKT1    WLVRSX    P      PFS Ship Status
      *
      * Set PGM.*Record Data Changed flag
     C           QPPBK1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Change Stamp      IF
     C                     Z-ADD##JDT     WLAJNY           PFS Change Date
     C                     Z-ADD##JTM     WLAKNY           PFS Change time
      * Set PGM.*Record Data Changed flag
     C           QPPBK1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BKCPZU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPBKCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * VAl Ship OrdDtl Exist RT - PFS Ship Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         YL0005           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMY1NX    WQSQ01           PFS Company Num
     C           *LIKE     DEFN WMZPNX    WQSQ02           PFS Order Numbe
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           PFS Company Num
     C                     KFLD           WQSQ02           PFS Order Numbe
      * Setup key
     C                     Z-ADDWAY1NX    WQSQ01           PFS Company Num
     C                     Z-ADDWAZPNX    WQSQ02           PFS Order Numbe
      * Establish starting position
     C           KRSSQ     SETLL@BMCPDE                    *
     C           KRSSQ     READE@BMCPDE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3508' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       YL0004           Record Found US
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0004           Record Found US
     C                     ADD  1         YL0005           Count USR
     C           KRSSQ     READE@BMCPDE                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * PFS Del I5 Pick Trans RT - Order Inv Allocation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOAIC3    WQSR01           Company Number
     C           *LIKE     DEFN WOC4NB    WQSR02           Order Number
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           Company Number
     C                     KFLD           WQSR02           Order Number
      * Setup key
     C                     Z-ADDWN0003    WQSR01           Company Number
     C                     Z-ADDWN0004    WQSR02           Order Number
      * Establish starting position
     C           KRSSR     SETLL@L8CPSY                    *
     C           KRSSR     READE@L8CPSY                  90*
      * Data record not found
     C   90                MOVEL'USR2640' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.OIA Alloc/Shipped Qty is GT 1
     C           WOJ6QT    IFGT 1                          *IF
      * Del Order Inv Alloc   DL - Order Inv Allocation  * 
     C                     EXSR SSDLRC
     C                     END                             *FI
     C           KRSSR     READE@L8CPSY                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSDLRC    BEGSR
      *================================================================
      * Del Order Inv Alloc   DL - Order Inv Allocation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @L8CPSX
     C                     Z-ADDWOAIC3    WRAIC3           Company Number
     C                     Z-ADDWOC4NB    WRC4NB           Order Number
     C                     Z-ADDWODPNB    WRDPNB           Order Sequence
     C                     Z-ADDWOUENB    WRUENB           Order Secondary
     C                     Z-ADDWOALSW    WRALSW           Allocation Seq
      *
     C           KLDLSS    KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRC4NB           Order Number
     C                     KFLD           WRDPNB           Order Sequence
     C                     KFLD           WRUENB           Order Secondary
     C                     KFLD           WRALSW           Allocation Seq
     C           KLDLSS    CHAIN@L8CPSX              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL8CPL0'MDACP
     C                     MOVEL'@L8CPSX' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@L8CPSX                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * PFS Upd Load Status   RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WERMNB           Load ID
      * Setup key
     C                     Z-ADDWN0010    WERMNB           Load ID
      * Establish starting position
     C           KRSST     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Upd Load -Reopen Trk  RT - PFS Ship Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSY1NX    WQSU01           PFS Company Num
     C           *LIKE     DEFN WSZGNX    WQSU02           PFS Load ID
      * Define keylist
     C           KPSSU     KLIST
     C                     KFLD           WQSU01           PFS Company Num
     C                     KFLD           WQSU02           PFS Load ID
     C                     KFLD           WSAID8           PFS Transaction
     C                     KFLD           WSAFTS           PFS Transaction
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           PFS Company Num
     C                     KFLD           WQSU02           PFS Load ID
      * Setup key
     C                     Z-ADDWAY1NX    WQSU01           PFS Company Num
     C                     Z-ADDWAZGNX    WQSU02           PFS Load ID
     C                     Z-ADDWAAID8    WSAID8           PFS Transaction
     C                     Z-ADDWAAFTS    WSAFTS           PFS Transaction
      * Establish starting position
     C           KPSSU     SETLL@BLCPFB                    *
     C           KRSSU     READE@BLCPFB                  90*
      * Data record not found
     C   90                MOVEL'USR3506' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.PFS Transaction Date EQ PAR.PFS Transaction Date
      *   |- c2    : DB1.PFS Transaction Time EQ PAR.PFS Transaction Time
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WSAID8    IFEQ WAAID8                     *IF
     C           WSAFTS    IFEQ WAAFTS                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg PostSts/ErrRsn    CH - PFS Ship Load Header  * 
     C                     EXSR SVCHRC
     C                     END                             *FI
     C           KRSSU     READE@BLCPFB                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCHRC    BEGSR
      *================================================================
      * Chg PostSts/ErrRsn    CH - PFS Ship Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0160  52       PFS Actual Reef
     C                     MOVEL*BLANK    WN0161  1        PFS Actual Reef
     C                     Z-ADD*ZERO     WN0162  52       PFS Actual Prod
     C                     MOVEL*BLANK    WN0163  1        PFS Actual Prod
     C                     MOVEL*BLANK    WN0164 15        PFS Seal 1
     C                     MOVEL*BLANK    WN0165 15        PFS Seal 2
     C                     MOVEL*BLANK    WN0166 15        PFS Seal 3
     C                     MOVEL*BLANK    WN0167 20        PFS Trailer Num
     C                     MOVEL*BLANK    WN0168  1        PFS Truck Condi
     C                     Z-ADD*ZERO     WN0169  50       PFS Pallets Rec
     C                     Z-ADD*ZERO     WN0170  50       PFS Spacers Loa
     C                     MOVEL*BLANK    WN0171  1        PFS Export USDA
     C                     MOVEL*BLANK    WN0172 12        PFS Recorder ID
     C                     Z-ADD*ZERO     WN0173  80       PFS BOL Complet
     C                     Z-ADD*ZERO     WN0174  60       PFS BOL Complet
     C                     Z-ADD*ZERO     WN0175  80       PFS Actual Depa
     C                     Z-ADD*ZERO     WN0176  60       PFS Actual Depa
     C                     Z-ADD*ZERO     WN0177  50       PFS Pallets Loa
     C                     Z-ADD*ZERO     WN0178  82       PFS Total Palle
     C                     MOVEL*BLANK    WN0179  1        PFS Record Stat
     C                     Z-ADD*ZERO     WN0180  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0181  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0182  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0183  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BLCPZ7
     C                     Z-ADDWSY1NX    WTY1NX           PFS Company Num
     C                     Z-ADDWSAID8    WTAID8           PFS Transaction
     C                     Z-ADDWSAFTS    WTAFTS           PFS Transaction
     C                     Z-ADDWSBCNY    WTBCNY           PFS Transaction
      *
     C           KLCHSV    KLIST
     C                     KFLD           WTY1NX           PFS Company Num
     C                     KFLD           WTAID8           PFS Transaction
     C                     KFLD           WTAFTS           PFS Transaction
     C                     KFLD           WTBCNY           PFS Transaction
     C           KLCHSV    CHAIN@BLCPZ7              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBLCPL0'MDACP
     C                     MOVEL'@BLCPZ7' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPBL1    YCRDCS
      * Move non-key fields to @BLCPZ7
     C                     Z-ADDWSZGNX    WTZGNX           PFS Load ID
     C                     MOVELWSG9T1    WTG9T1    P      PFS Seal 4
     C                     Z-ADD3         WTUXSX           PFS Process Sta
     C                     MOVEL'REOPN'   WTV3SX    P      PFS Error Reaso
      *
      * Set PGM.*Record Data Changed flag
     C           QPPBL1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Change Stamp      IF
     C                     Z-ADD##JDT     WTAJNY           PFS Change Date
     C                     Z-ADD##JTM     WTAKNY           PFS Change time
      * Set PGM.*Record Data Changed flag
     C           QPPBL1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BLCPZ7                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPBLCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Upd Status -ReOpn Trk RT - PFS Ship Load/Order Sts  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WVY1NX    WQSW01           PFS Company Num
     C           *LIKE     DEFN WVZGNX    WQSW02           PFS Load ID
      * Define keylist
     C           KPSSW     KLIST
     C                     KFLD           WQSW01           PFS Company Num
     C                     KFLD           WQSW02           PFS Load ID
     C                     KFLD           WVAID8           PFS Transaction
     C                     KFLD           WVAFTS           PFS Transaction
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           PFS Company Num
     C                     KFLD           WQSW02           PFS Load ID
      * Setup key
     C                     Z-ADDWL0021    WQSW01           PFS Company Num
     C                     Z-ADDWL0022    WQSW02           PFS Load ID
     C                     Z-ADDWL0023    WVAID8           PFS Transaction
     C                     Z-ADDWL0024    WVAFTS           PFS Transaction
      * Establish starting position
     C           KPSSW     SETLL@BKCPFD                    *
     C           KRSSW     READE@BKCPFD                  90*
      * Data record not found
     C   90                MOVEL'USR3504' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.PFS Transaction Date EQ PAR.PFS Transaction Date
      *   |- c2    : DB1.PFS Transaction Time EQ PAR.PFS Transaction Time
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WVAID8    IFEQ WL0023                     *IF
     C           WVAFTS    IFEQ WL0024                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg PrcSts/ErrRsn     CH - PFS Ship Load/Order Sts  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVY1NX    WL0025           PFS Company Num
     C                     Z-ADDWVAID8    WL0026           PFS Transaction
     C                     Z-ADDWVAFTS    WL0027           PFS Transaction
     C                     Z-ADDWVBCNY    WL0028           PFS Transaction
     C                     Z-ADD3         WL0029           PFS Process Sta
     C                     MOVEL'REOPN'   WL0030    P      PFS Error Reaso
     C                     EXSR SXCHRC
     C                     END                             *FI
     C           KRSSW     READE@BKCPFD                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCHRC    BEGSR
      *================================================================
      * Chg PrcSts/ErrRsn     CH - PFS Ship Load/Order Sts  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0184  2        PFS Ship Status
     C                     Z-ADD*ZERO     WN0185  70       PFS Load ID
     C                     Z-ADD*ZERO     WN0186  70       PFS Order Numbe
     C                     MOVEL*BLANK    WN0187  1        PFS Export USDA
     C                     MOVEL*BLANK    WN0188  1        PFS Record Stat
     C                     Z-ADD*ZERO     WN0189  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0190  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0191  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0192  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @BKCPZU
     C                     Z-ADDWL0025    WLY1NX           PFS Company Num
     C                     Z-ADDWL0026    WLAID8           PFS Transaction
     C                     Z-ADDWL0027    WLAFTS           PFS Transaction
     C                     Z-ADDWL0028    WLBCNY           PFS Transaction
      *
     C           KLCHSX    KLIST
     C                     KFLD           WLY1NX           PFS Company Num
     C                     KFLD           WLAID8           PFS Transaction
     C                     KFLD           WLAFTS           PFS Transaction
     C                     KFLD           WLBCNY           PFS Transaction
     C           KLCHSX    CHAIN@BKCPZU              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBKCPL0'MDACP
     C                     MOVEL'@BKCPZU' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPBK1    YDRDCS
      * Move non-key fields to @BKCPZU
     C                     Z-ADDWL0029    WLUXSX           PFS Process Sta
     C                     MOVELWL0030    WLV3SX    P      PFS Error Reaso
      *
      * Set PGM.*Record Data Changed flag
     C           QPPBK1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@BKCPZU                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPBKCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV Delete Ship Event  RT - Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSY01           Company Number
     C           *LIKE     DEFN WGC4NB    WQSY02           Order Number
     C           *LIKE     DEFN WGJPCD    WQSY03           Event Code
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           Company Number
     C                     KFLD           WQSY02           Order Number
     C                     KFLD           WQSY03           Event Code
      * Setup key
     C                     Z-ADDWN0003    WQSY01           Company Number
     C                     Z-ADDWN0004    WQSY02           Order Number
     C                     MOVEL'04'      WQSY03           Event Code
      * Establish starting position
     C           KRSSY     SETLL@EYCPZE                    *
     C           KRSSY     READE@EYCPZE                  90*
      * Data record not found
     C   90                MOVEL'USR1074' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DEL Ship Event         DC - OP Order Events  * 
     C                     EXSR SZDLRC
     C           KRSSY     READE@EYCPZE                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZDLRC    BEGSR
      *================================================================
      * DEL Ship Event         DC - OP Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @EYCPY3
     C                     Z-ADDWGAIC3    WIAIC3           Company Number
     C                     Z-ADDWGC4NB    WIC4NB           Order Number
     C                     Z-ADDWGQ2NB    WIQ2NB           Event Number
      *
     C           KLDLSZ    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C                     KFLD           WIQ2NB           Event Number
     C           KLDLSZ    CHAIN@EYCPY3              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPEYCPL0'MDACP
     C                     MOVEL'@EYCPY3' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@EYCPY3                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * RTV Event Code         RT - Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHC4NB           Order Number
     C                     KFLD           WHQ2NB           Event Number
      * Setup key
     C                     Z-ADDWN0003    WHAIC3           Company Number
     C                     Z-ADDWN0004    WHC4NB           Order Number
     C                     Z-ADDYL0006    WHQ2NB           Event Number
      * Establish starting position
     C           KRSTA     SETGT@EYCPY2                91  *
     C                     READP@EYCPY2                9190*
      * Check high order keys
     C  N90      WN0003    IFNE WHAIC3                     Company Number
     C           WN0004    ORNE WHC4NB                     Order Number
     C                     SETON                     90
     C                     END
      *
      * Data record not found
     C   90                MOVEL'USR1074' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHJPCD    YL0007           Event Code
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * UPD Unship Ship Detail RT - Order Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0193  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0194  1        Price Audit
     C                     MOVEL*BLANK    WN0195  3        Price Audit Rea
     C                     Z-ADD*ZERO     WN0196 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0197 112       Weight Shipped
     C                     MOVEL*BLANK    WN0198  3        USR Warehouse C
     C                     MOVEL*BLANK    WN0199  1        Inter-Plant Tra
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WWAIC3    WQTB01           Company Number
     C           *LIKE     DEFN WWC4NB    WQTB02           Order Number
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WQTB01           Company Number
     C                     KFLD           WQTB02           Order Number
      * Setup key
     C                     Z-ADDWN0003    WQTB01           Company Number
     C                     Z-ADDWN0004    WQTB02           Order Number
      * Establish starting position
     C           KRSTB     SETLL@BGWKL1                    *
     C           KRSTB     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Detail Line Status is Confirmed
      *   |- c2    : DB1.Item Code is Not Fuel Surcharge
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WWGMST    IFEQ 'R'                        *IF
     C           WWHGCD    IFNE 99400                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELWWGMST    WN0193           Detail Line Sta
     C                     MOVELWWU0ST    WN0194           Price Audit
     C                     MOVELWWRFCD    WN0195           Price Audit Rea
      * If qty and weight are zero then make price audit "N".
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Quantity Shipped Total is Equal to zero
      *   |- c2    : DB1.Weight Shipped Total is Equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WWCBQT    IFEQ 0                          *IF
     C           WWATWG    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       WN0194           Price Audit
     C                     MOVEL'SUB'     WN0195           Price Audit Rea
     C                     END                             *FI
      * Set Quantity/Weight shipped to 0 if this is a Plant order
      * CASE: PAR.Trans Contol AS400/Plant is Plant
     C           WN0012    IFEQ 'P'                        *IF
     C                     Z-ADD0         WN0196           Quantity Shippe
     C                     Z-ADD0         WN0197           Weight Shipped
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWWCBQT    WN0196           Quantity Shippe
     C                     Z-ADDWWATWG    WN0197           Weight Shipped
     C                     END                             *FI
      * Reverse Issue
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Quantity Shipped Total is not equal zero
      *   |- c2    : DB1.Weight Shipped Total is Not equal zero
      *   '-
     C           WWCBQT    IFNE 0                          *IF
     C           WWATWG    ORNE 0                          *OR
      * CASE: PAR.Billing Activity Type is Warehouse Transfer
     C           WN0013    IFEQ '4'                        *IF
      * Rtv Default Warehouse  RT - Company Customer  * 
     C                     EXSR TCRVGN
      * 12/04/06 PKD Added Inter-Plant Transfer Processing.
      * Rtv Warehouse SHP     RT - Warehouse  * 
     C                     EXSR TDRVGN
      * Inter-Plant Transfer?
      * CASE:
      *  - c2 AND c3
      *   |- c2    : LCL.Warehouse Location is Internal (Plant)
      *   |- c3    : LCL.WHS Live w/Carlisle is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0009    IFEQ 'I'                        *IF
     C           YL0012    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WN0199           Inter-Plant Tra
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WN0199           Inter-Plant Tra
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WN0199           Inter-Plant Tra
     C                     END                             *FI
      * UPD Inv From Unship    RT - Manifest Detail  * 
     C                     EXSR TERVGN
     C                     END                             *FI
      * CHG for UnShip         CH - Order Detail  * 
     C                     EXSR THCHRC
     C                     END                             *FI
     C           KRSTB     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Rtv Default Warehouse  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WXAIC3           Company Number
     C                     KFLD           WXBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWN0003    WXAIC3           Company Number
     C                     Z-ADDWN0006    WXBKC7           Ship To Custome
      * Establish starting position
     C           KRSTC     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0198           Warehouse Code
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWXAJCD    WN0198           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv Warehouse SHP     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WDAJCD           Warehouse Code
      * Setup key
     C                     MOVELWN0198    WDAJCD           Warehouse Code
      * Establish starting position
     C           KRSTD     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0008           Trans Contol AS
     C                     MOVEL*BLANK    YL0009           Warehouse Locat
     C                     Z-ADD*ZERO     YL0010           Shipping Compan
     C                     Z-ADD*ZERO     YL0011           Accounting Comp
     C                     MOVEL*BLANK    YL0012           WHS Live w/Carl
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDXUST    YL0008           Trans Contol AS
     C                     MOVELWDT0ST    YL0009           Warehouse Locat
     C                     Z-ADDWDBWC3    YL0010           Shipping Compan
     C                     Z-ADDWDBTC3    YL0011           Accounting Comp
     C                     MOVELWDRRSX    YL0012           WHS Live w/Carl
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * UPD Inv From Unship    RT - Manifest Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0200  70       Label Date
     C                     Z-ADD*ZERO     WN0201  70       Production Date
     C                     Z-ADD*ZERO     WN0202 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0203 112       Weight Shipped
     C                     MOVEL*BLANK    WN0204  1        First Time Flag
     C                     Z-ADD*ZERO     WN0205 112       Weight Billed
     C                     MOVEL*BLANK    WN0206 30        Description
     C                     MOVEL*BLANK    WN0207  2        U/M - Cost
     C                     MOVEL*BLANK    WN0208  1        Shift Number
     C                     MOVEL*BLANK    WN0209 30        Description Lin
     C                     MOVEL*BLANK    WN0210 30        Description Lin
     C                     MOVEL*BLANK    WN0211  2        U/M - Primary
     C                     Z-ADD*ZERO     WN0212  94       Conversion Fact
     C                     MOVEL*BLANK    WN0213  1        Operation Facto
     C                     MOVEL*BLANK    WN0214  2        U/M - Second
     C                     Z-ADD*ZERO     WN0215  94       Conversion Fact
     C                     MOVEL*BLANK    WN0216  1        Operation Facto
     C                     MOVEL*BLANK    WN0217  2        U/M - Third
     C                     MOVEL*BLANK    WN0218  2        U/M - Pricing
     C                     Z-ADD*ZERO     WN0219 112       Unit Weight
     C                     MOVEL*BLANK    WN0220  1        Production Date
     C                     MOVEL*BLANK    WN0221  1        Catch Weight St
     C                     Z-ADD*ZERO     WN0222  52       Fresh Chilling
     C                     Z-ADD*ZERO     WN0223 114       Cost based on U
     C                     Z-ADD*ZERO     WN0224 114       Cost based on U
     C                     Z-ADD*ZERO     WN0225 114       Cost based on U
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Change Log
     C                     EXSR UBSUBR                     Change Log
     C                     MOVEL'Y'       WN0204           First Time Flag
     C                     Z-ADD0         WN0202           Quantity Shippe
     C                     Z-ADD0         WN0203           Weight Shipped
     C                     Z-ADD0         WN0205           Weight Billed
     C                     MOVEL'1'       WN0208           Shift Number
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           YL0013    PARM *ZERO     WQ0017 155       Current System
     C           YL0014    PARM *ZERO     WQ0018 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Declare restrictor key work fields
     C           *LIKE     DEFN WYAIC3    WQTE01           Company Number
     C           *LIKE     DEFN WYC4NB    WQTE02           Order Number
     C           *LIKE     DEFN WYDPNB    WQTE03           Order Sequence
     C           *LIKE     DEFN WYUENB    WQTE04           Order Secondary
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WQTE01           Company Number
     C                     KFLD           WQTE02           Order Number
     C                     KFLD           WQTE03           Order Sequence
     C                     KFLD           WQTE04           Order Secondary
      * Setup key
     C                     Z-ADDWWAIC3    WQTE01           Company Number
     C                     Z-ADDWWC4NB    WQTE02           Order Number
     C                     Z-ADDWWDPNB    WQTE03           Order Sequence
     C                     Z-ADDWWUENB    WQTE04           Order Secondary
      * Establish starting position
     C           KRSTE     SETLL@FNCPEZ                    *
     C           KRSTE     READE@FNCPEZ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1196' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0200           Label Date
     C                     Z-ADD*ZERO     WN0201           Production Date
     C                     Z-ADD*ZERO     WN0202           Quantity Shippe
     C                     Z-ADD*ZERO     WN0203           Weight Shipped
     C                     MOVEL*BLANK    WN0204           First Time Flag
     C                     Z-ADD*ZERO     WN0205           Weight Billed
     C                     MOVEL*BLANK    WN0206           Description
     C                     MOVEL*BLANK    WN0207           U/M - Cost
     C                     MOVEL*BLANK    WN0208           Shift Number
     C                     MOVEL*BLANK    WN0209           Description Lin
     C                     MOVEL*BLANK    WN0210           Description Lin
     C                     MOVEL*BLANK    WN0211           U/M - Primary
     C                     Z-ADD*ZERO     WN0212           Conversion Fact
     C                     MOVEL*BLANK    WN0213           Operation Facto
     C                     MOVEL*BLANK    WN0214           U/M - Second
     C                     Z-ADD*ZERO     WN0215           Conversion Fact
     C                     MOVEL*BLANK    WN0216           Operation Facto
     C                     MOVEL*BLANK    WN0217           U/M - Third
     C                     MOVEL*BLANK    WN0218           U/M - Pricing
     C                     Z-ADD*ZERO     WN0219           Unit Weight
     C                     MOVEL*BLANK    WN0220           Production Date
     C                     MOVEL*BLANK    WN0221           Catch Weight St
     C                     Z-ADD*ZERO     WN0222           Fresh Chilling
     C                     Z-ADD*ZERO     WN0223           Cost based on U
     C                     Z-ADD*ZERO     WN0224           Cost based on U
     C                     Z-ADD*ZERO     WN0225           Cost based on U
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Set production date for break usage & rtv item info
      * CASE: PAR.First Time Flag is Yes
     C           WN0204    IFEQ 'Y'                        *IF
     C                     Z-ADDWYELDT    WN0201           Production Date
     C                     Z-ADDWYK7DT    WN0200           Label Date
      * Rtv Base Values        RT - Company/Item  * 
     C                     EXSR TFRVGN
      * Set unit of measure for cost
      * CASE: PAR.Catch Weight Status is yes
     C           WN0221    IFEQ 'Y'                        *IF
     C                     MOVEL'LB'      WN0207           U/M - Cost
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWN0211    WN0207           U/M - Cost
     C                     END                             *FI
     C                     MOVEL*BLANK    WUE7TX           Order Number Al
     C                     MOVELWWC4NB    WUE7TX           Order Number Al
     C                     MOVEL@CN,002   WUI6TX           Description 14A
     C                     Z-ADD1         ZQ      50
     C           WUI6TX    CAT  WUE7TX:ZQ WN0206    P      Description
     C                     MOVEL'N'       WN0204           First Time Flag
     C                     END                             *FI
      * When production date changes update inventory files
      * CASE: PAR.Production Date NE DB1.Production Date
     C           WN0201    IFNE WYELDT                     *IF
      * CASE: PAR.Billing Activity Type is Invoice
     C           WN0013    IFEQ '1'                        *IF
      * Upd Balances Issue/Adj XF - Item Balance  * 
     C                     CALL 'PDQRXFR'              90  Upd Balances Is
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WWAIC3    WQ0019  30       Company Number
     C                     PARM WWHGCD    WQ0020  70       Item Code
     C                     PARM WWAJCD    WQ0021  3        Warehouse Code
     C                     PARM 'I'       WQ0022  1        Inventory Trans
     C                     PARM 'IO'      WQ0023  2        Inventory Trans
     C                     PARM YL0013    WQ0024  70       Transaction Dat
     C                     PARM WN0201    WQ0025  70       Production Date
     C                     PARM 'OP'      WQ0026  2        Item Transactio
     C                     PARM WN0206    WQ0027 30        Description
     C                     PARM *BLANK    WQ0028  3        Reason Code
     C                     PARM *BLANK    WQ0029 10        Lot ID
     C                     PARM WWC4NB    WQ0030  70       Order Number
     C                     PARM WN0208    WQ0031  1        Shift Number
     C                     PARM WN0200    WQ0032  70       Label Date
     C                     PARM WN0203    WQ0033 112       USR Weight Accu
     C                     PARM WN0202    WQ0034 112       Transaction Qty
     C                     PARM 'Y'       WQ0035  1        USR Unship Flag
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: PAR.Billing Activity Type is Warehouse Transfer
     C           WN0013    IFEQ '4'                        *IF
      * Upd Balances Transfer  XF - Item Balance  * 
     C                     CALL 'PDQTXFR'              90  Upd Balances Tr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WWAIC3    WQ0036  30       Company Number
     C                     PARM WWHGCD    WQ0037  70       Item Code
     C                     PARM WWAJCD    WQ0038  3        Warehouse Code
     C                     PARM 'T'       WQ0039  1        Inventory Trans
     C                     PARM 'TW'      WQ0040  2        Inventory Trans
     C                     PARM YL0013    WQ0041  70       Transaction Dat
     C                     PARM WN0201    WQ0042  70       Production Date
     C                     PARM 'OP'      WQ0043  2        Item Transactio
     C                     PARM WN0206    WQ0044 30        Description
     C                     PARM *BLANK    WQ0045  3        Reason Code
     C                     PARM WWC4NB    WQ0046  70       Order Number
     C                     PARM WN0208    WQ0047  1        Shift Number
     C                     PARM WN0200    WQ0048  70       Label Date
     C                     PARM WN0198    WQ0049  3        USR Warehouse C
     C                     PARM WN0203    WQ0050 112       USR Weight Accu
     C                     PARM WN0202    WQ0051 112       USR Quantity
     C                     PARM 'Y'       WQ0052  1        USR Unship Flag
     C                     PARM WN0199    WQ0053  1        Inter-Plant Tra
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWYELDT    WN0201           Production Date
      * RTV Label Date         RT - Item Balance Detail  * 
     C                     EXSR TGRVGN
      * If item bal detail doesn't exist, use manifest label date
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     Z-ADDWYK7DT    WN0200           Label Date
     C                     END                             *FI
     C                     Z-ADD0         WN0202           Quantity Shippe
     C                     Z-ADD0         WN0203           Weight Shipped
     C                     END                             *FI
      * Add up quantity and weight for production date
     C                     ADD  WYFOQT    WN0202           Quantity Shippe
     C                     ADD  WYR0NB    WN0203           Weight Shipped
     C                     ADD  WYR0NB    WN0205           Weight Billed
     C           KRSTE     READE@FNCPEZ                  90*
     C                     ENDDO
      * USER: Exit processing
      * Update inventory for last production date read
      * CASE: PAR.Billing Activity Type is Invoice
     C           WN0013    IFEQ '1'                        *IF
      * Upd Balances Issue/Adj XF - Item Balance  * 
     C                     CALL 'PDQRXFR'              90  Upd Balances Is
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WWAIC3    WQ0054  30       Company Number
     C                     PARM WWHGCD    WQ0055  70       Item Code
     C                     PARM WWAJCD    WQ0056  3        Warehouse Code
     C                     PARM 'I'       WQ0057  1        Inventory Trans
     C                     PARM 'IO'      WQ0058  2        Inventory Trans
     C                     PARM YL0013    WQ0059  70       Transaction Dat
     C                     PARM WN0201    WQ0060  70       Production Date
     C                     PARM 'OP'      WQ0061  2        Item Transactio
     C                     PARM WN0206    WQ0062 30        Description
     C                     PARM *BLANK    WQ0063  3        Reason Code
     C                     PARM *BLANK    WQ0064 10        Lot ID
     C                     PARM WWC4NB    WQ0065  70       Order Number
     C                     PARM WN0208    WQ0066  1        Shift Number
     C                     PARM WN0200    WQ0067  70       Label Date
     C                     PARM WN0203    WQ0068 112       USR Weight Accu
     C                     PARM WN0202    WQ0069 112       Transaction Qty
     C                     PARM 'Y'       WQ0070  1        USR Unship Flag
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: PAR.Billing Activity Type is Warehouse Transfer
     C           WN0013    IFEQ '4'                        *IF
      * Upd Balances Transfer  XF - Item Balance  * 
     C                     CALL 'PDQTXFR'              90  Upd Balances Tr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WWAIC3    WQ0071  30       Company Number
     C                     PARM WWHGCD    WQ0072  70       Item Code
     C                     PARM WWAJCD    WQ0073  3        Warehouse Code
     C                     PARM 'T'       WQ0074  1        Inventory Trans
     C                     PARM 'TW'      WQ0075  2        Inventory Trans
     C                     PARM YL0013    WQ0076  70       Transaction Dat
     C                     PARM WN0201    WQ0077  70       Production Date
     C                     PARM 'OP'      WQ0078  2        Item Transactio
     C                     PARM WN0206    WQ0079 30        Description
     C                     PARM *BLANK    WQ0080  3        Reason Code
     C                     PARM WWC4NB    WQ0081  70       Order Number
     C                     PARM WN0208    WQ0082  1        Shift Number
     C                     PARM WN0200    WQ0083  70       Label Date
     C                     PARM WN0198    WQ0084  3        USR Warehouse C
     C                     PARM WN0203    WQ0085 112       USR Weight Accu
     C                     PARM WN0202    WQ0086 112       USR Quantity
     C                     PARM 'Y'       WQ0087  1        USR Unship Flag
     C                     PARM WN0199    WQ0088  1        Inter-Plant Tra
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDQTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Rtv Base Values        RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           TAAIC3           Company Number
     C                     KFLD           TAHGCD           Item Code
      * Setup key
     C                     Z-ADDWWAIC3    TAAIC3           Company Number
     C                     Z-ADDWWHGCD    TAHGCD           Item Code
      * Establish starting position
     C           KRSTF     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0209           Description Lin
     C                     MOVEL*BLANK    WN0210           Description Lin
     C                     MOVEL*BLANK    WN0211           U/M - Primary
     C                     Z-ADD*ZERO     WN0212           Conversion Fact
     C                     MOVEL*BLANK    WN0213           Operation Facto
     C                     MOVEL*BLANK    WN0214           U/M - Second
     C                     Z-ADD*ZERO     WN0215           Conversion Fact
     C                     MOVEL*BLANK    WN0216           Operation Facto
     C                     MOVEL*BLANK    WN0217           U/M - Third
     C                     MOVEL*BLANK    WN0218           U/M - Pricing
     C                     Z-ADD*ZERO     WN0219           Unit Weight
     C                     MOVEL*BLANK    WN0220           Production Date
     C                     MOVEL*BLANK    WN0221           Catch Weight St
     C                     Z-ADD*ZERO     WN0222           Fresh Chilling
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTAAVNA    WN0209           Description Lin
     C                     MOVELTAAWNA    WN0210           Description Lin
     C                     MOVELTAADCD    WN0211           U/M - Primary
     C                     Z-ADDTAAWPC    WN0212           Conversion Fact
     C                     MOVELTALXST    WN0213           Operation Facto
     C                     MOVELTAAECD    WN0214           U/M - Second
     C                     Z-ADDTAAXPC    WN0215           Conversion Fact
     C                     MOVELTALYST    WN0216           Operation Facto
     C                     MOVELTAAFCD    WN0217           U/M - Third
     C                     MOVELTAAICD    WN0218           U/M - Pricing
     C                     Z-ADDTAAIWG    WN0219           Unit Weight
     C                     MOVELTAFZST    WN0220           Production Date
     C                     MOVELTAAVST    WN0221           Catch Weight St
     C                     Z-ADDTACHTM    WN0222           Fresh Chilling
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * RTV Label Date         RT - Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           TBAIC3           Company Number
     C                     KFLD           TBHGCD           Item Code
     C                     KFLD           TBAJCD           Warehouse Code
     C                     KFLD           TBELDT           Production Date
      * Setup key
     C                     Z-ADDWWAIC3    TBAIC3           Company Number
     C                     Z-ADDWWHGCD    TBHGCD           Item Code
     C                     MOVELWWAJCD    TBAJCD           Warehouse Code
     C                     Z-ADDWN0201    TBELDT           Production Date
      * Establish starting position
     C           KRSTG     CHAIN@B1REJ0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0330' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDTBK7DT    WN0200           Label Date
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THCHRC    BEGSR
      *================================================================
      * CHG for UnShip         CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0226  70       Item Code
     C                     MOVEL*BLANK    WN0227  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0228  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0229  70       Order Group Cod
     C                     Z-ADD*ZERO     WN0230 112       Billing Detail
     C                     Z-ADD*ZERO     WN0231 112       Billing Detail
     C                     Z-ADD*ZERO     WN0232 112       Billing Detail
     C                     Z-ADD*ZERO     WN0233 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0234  1        Comment Print A
     C                     MOVEL*BLANK    WN0235  1        Comment Print I
     C                     MOVEL*BLANK    WN0236  1        Comment Print P
     C                     MOVEL*BLANK    WN0237  1        Comment Print S
     C                     Z-ADD*ZERO     WN0238 112       Extended Amount
     C                     Z-ADD*ZERO     WN0239  70       Market Pricing
     C                     MOVEL*BLANK    WN0240  3        Commodity Marke
     C                     MOVEL*BLANK    WN0241  3        Date Method Cod
     C                     MOVEL*BLANK    WN0242  3        Price Method Co
     C                     Z-ADD*ZERO     WN0243 114       Price Overage O
     C                     Z-ADD*ZERO     WN0244  70       Contract Number
     C                     MOVEL*BLANK    WN0245  1        Price Status
     C                     Z-ADD*ZERO     WN0246  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0247  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0248  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0249  1        Work Confirm St
     C                     MOVEL*BLANK    WN0250  1        Work Over/Short
     C                     MOVEL*BLANK    WN0251  1        OD Production P
     C                     MOVEL*BLANK    WN0252 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0253 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0254  1        Age Code
     C                     MOVEL*BLANK    WN0255  1        Palletize
     C                     MOVEL*BLANK    WN0256  1        Slip Sheet
     C                     MOVEL*BLANK    WN0257  1        Catch Weight St
     C                     MOVEL*BLANK    WN0258  1        Production Date
     C                     Z-ADD*ZERO     WN0259 112       Rated Freight
     C                     Z-ADD*ZERO     WN0260 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0261 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0262 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0263 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0264 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0265 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0266 114       Unit Price
     C                     Z-ADD*ZERO     WN0267 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0268 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0269 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0270 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0271  70       Requested Ship
     C                     Z-ADD*ZERO     WN0272  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0273  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0274  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0275  30       Item Structure
     C                     Z-ADD*ZERO     WN0276  30       Item Structure
     C                     Z-ADD*ZERO     WN0277  30       Item Structure
     C                     MOVEL*BLANK    WN0278  2        Item Level
     C                     MOVEL*BLANK    WN0279  2        Quality Level
     C                     MOVEL*BLANK    WN0280  2        Pricing Product
     C                     MOVEL*BLANK    WN0281  2        Season Product
     C                     Z-ADD*ZERO     WN0282  70       Date of Origina
     C                     MOVEL*BLANK    WN0283 10        User Profile Na
     C                     MOVEL*BLANK    WN0284  6        Country Code
     C                     MOVEL*BLANK    WN0285  3        Reason Code
     C                     MOVEL*BLANK    WN0286  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0287  1        Modified Flag
     C                     MOVEL*BLANK    WN0288  1        Substituted Fla
     C                     MOVEL*BLANK    WN0289  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0290 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0291 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0292  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0293  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0294  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0295  1        Affect Commissi
     C                     MOVEL*BLANK    WN0296  1        Affect Pricing
     C                     MOVEL*BLANK    WN0297  1        Released by Use
     C                     MOVEL*BLANK    WN0298  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0299  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0300  3        Production Ware
     C                     MOVEL*BLANK    WN0301  3        OD Price Type
     C                     Z-ADD*ZERO     WN0302  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0303  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0304  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0305  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0306  70       OD Unused Date
     C                     Z-ADD*ZERO     WN0307  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0308  60       Price Code
     C                     Z-ADD*ZERO     WN0309  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0310  60       Substitution Li
     C                     Z-ADD*ZERO     WN0311  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0312 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0313 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0314 112       OD Item Target
     C                     Z-ADD*ZERO     WN0315 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0316 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0317 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0318 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0319 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0320 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0321 114       OD Unused Prc 5
     C                     Z-ADD*ZERO     WN0322 114       OD Unused Prc 6
     C                     Z-ADD*ZERO     WN0323 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0324 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0325  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0326  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0327  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0328 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0329  40       Item Age Days
     C                     Z-ADD*ZERO     WN0330  70       Production Ovr
     C                     Z-ADD*ZERO     WN0331  70       Production Ovr
     C                     MOVEL*BLANK    WN0332  1        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0333  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0334  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0335  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0336  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0337  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0338  1        EDI Status 1
     C                     MOVEL*BLANK    WN0339  1        EDI Status 2
     C                     MOVEL*BLANK    WN0340  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0341  60       Job Time
     C                     MOVEL*BLANK    WN0342 10        User Id
     C                     MOVEL*BLANK    WN0343 10        Job Name
     C                     Z-ADD*ZERO     WN0344  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWWAIC3    TCAIC3           Company Number
     C                     Z-ADDWWC4NB    TCC4NB           Order Number
     C                     Z-ADDWWDPNB    TCDPNB           Order Sequence
     C                     Z-ADDWWUENB    TCUENB           Order Secondary
      *
     C           KLCHTH    KLIST
     C                     KFLD           TCAIC3           Company Number
     C                     KFLD           TCC4NB           Order Number
     C                     KFLD           TCDPNB           Order Sequence
     C                     KFLD           TCUENB           Order Secondary
     C           KLCHTH    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO THEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YERDCS
      * Move non-key fields to @BGWKL0
     C                     MOVEL'A'       TCGMST    P      Detail Line Sta
     C                     MOVELWN0193    TCGNST    P      Detail Line Sta
     C                     MOVELWN0194    TCU0ST    P      Price Audit
     C                     MOVELWN0195    TCRFCD    P      Price Audit Rea
     C                     Z-ADDWN0196    TCCBQT           Quantity Shippe
     C                     Z-ADDWN0197    TCATWG           Weight Shipped
     C                     Z-ADD0         TCGNDT           Actual Shipped
     C                     MOVELWWAMST    TCAMST    P      Affect Inventor
     C                     MOVELYL0007    TCJPCD    P      Event Code
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) TCAATM' defaulted for 'Job Time'.
      * Field '(DB1) TCAYNA' defaulted for 'User Id'.
      * Field '(DB1) TCA0NA' defaulted for 'Job Name'.
      * Field '(DB1) TCAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     TCAATM           Job Time
     C                     MOVEL##USR     TCAYNA           User Id
     C                     MOVEL##JOB     TCA0NA           Job Name
     C                     Z-ADD##JDT     TCAXDT           Job Date
     C                     MOVEL@CN,003   TCA0NA           Job Name
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * Cnf Order Ship/Unship RT - Order Inv Allocation  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0345  70       Quantity Loc Tr
     C                     Z-ADD*ZERO     WN0346  70       Item Code
     C                     MOVEL*BLANK    WN0347  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0348  70       Production Date
     C                     Z-ADD*ZERO     WN0349  50       Lot Number
     C                     MOVEL*BLANK    WN0350  4        Location Code
     C                     Z-ADD*ZERO     WN0351  20       Location Level
     C                     Z-ADD*ZERO     WN0352  50       LLT Trans Qty
     C                     Z-ADD*ZERO     WN0353 112       LLT Trans Wgt
     C                     Z-ADD*ZERO     WN0354 112       Weight Order 2
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       YL0015           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN TDAIC3    WQTI01           Company Number
     C           *LIKE     DEFN TDC4NB    WQTI02           Order Number
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           WQTI01           Company Number
     C                     KFLD           WQTI02           Order Number
      * Setup key
     C                     Z-ADDWN0003    WQTI01           Company Number
     C                     Z-ADDWN0004    WQTI02           Order Number
      * Establish starting position
     C           KRSTI     SETLL@L8CPZO                    *
     C           KRSTI     READE@L8CPZO                  90*
      * Data record not found
     C   90                MOVEL'USR2640' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD0         WN0345           Quantity Loc Tr
     C                     Z-ADD0         WN0354           Weight Order 2
      * 1ST:  First time process
      * CASE: LCL.First Time Flag is Yes
     C           YL0015    IFEQ 'Y'                        *IF
     C                     Z-ADDTDHGCD    WN0346           Item Code
     C                     MOVELTDAJCD    WN0347           Warehouse Code
     C                     Z-ADDTDELDT    WN0348           Production Date
     C                     Z-ADDTDLXNM    WN0349           Lot Number
     C                     MOVELTDYMCD    WN0350           Location Code
     C                     Z-ADDTDYNCD    WN0351           Location Level
     C                     MOVEL'N'       YL0015           First Time Flag
     C                     END                             *FI
      * CHG: Item, Whs, PDte, Lot, Loc, Level
      * CASE: CHG: Item, Whs, PDte, Lot, Loc, Level
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6
      *   |- c1    : PAR.Item Code NE DB1.Item Code
      *   |- c2    : PAR.Warehouse Code NE DB1.Warehouse Code
      *   |- c3    : PAR.Production Date NE DB1.Production Date
      *   |- c4    : PAR.Lot Number NE DB1.Lot Number
      *   |- c5    : PAR.Location Code NE DB1.Location Code
      *   |- c6    : PAR.Location Level NE DB1.Location Level
      *   '-
     C           WN0346    IFNE TDHGCD                     *IF
     C           WN0347    ORNE TDAJCD                     *OR
     C           WN0348    ORNE TDELDT                     *OR
     C           WN0349    ORNE TDLXNM                     *OR
     C           WN0350    ORNE TDYMCD                     *OR
     C           WN0351    ORNE TDYNCD                     *OR
      * CASE: PAR.LLT Trans Qty is NE Zero
     C           WN0352    IFNE 0                          *IF
      *
     C                     Z-ADD*ZERO     WN0355  30       LLT Sequence #
     C                     MOVEL*BLANK    WN0356  1        EDI Status 1
     C                     MOVEL*BLANK    WN0357  1        EDI Status 2
     C                     MOVEL*BLANK    WN0358  1        EDI Status 3
     C                     MOVEL*BLANK    WN0359  1        Record Status
     C                     Z-ADD*ZERO     WN0360  60       Job Time
     C                     MOVEL*BLANK    WN0361 10        User Id
     C                     MOVEL*BLANK    WN0362 10        Job Name
     C                     Z-ADD*ZERO     WN0363  70       Job Date
      *
      * Crt Item Lot/Loc Trns IF
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTDAIC3    WL0031           Company Number
     C                     Z-ADDWN0346    WL0032           Item Code
     C                     MOVELWN0347    WL0033    P      Warehouse Code
     C                     MOVEL'S'       WL0034    P      LLT Trans Type
     C                     Z-ADD##JDT     WL0035           LLT Trans Date
     C                     EXSR TJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0036    WN0355           LLT Sequence #
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTDAIC3    WL0037           Company Number
     C                     Z-ADDWN0346    WL0038           Item Code
     C                     MOVELWN0347    WL0039    P      Warehouse Code
     C                     MOVEL'S'       WL0040    P      LLT Trans Type
     C                     Z-ADD##JDT     WL0041           LLT Trans Date
     C                     Z-ADDWN0355    WL0042           LLT Sequence #
     C                     Z-ADDWN0348    WL0043           LLT Production
     C                     Z-ADDWN0352    WL0044           LLT Trans Qty
     C                     Z-ADDWN0353    WL0045           LLT Trans Wgt
     C                     Z-ADDWN0349    WL0046           LLT Lot Number
     C                     MOVELWN0350    WL0047    P      Location Code
     C                     Z-ADDWN0351    WL0048           LLT Location Le
     C                     MOVEL*BLANK    WL0049           Transfer Wareho
     C                     Z-ADD0         WL0050           LLT Transfer Lo
     C                     MOVEL*BLANK    WL0051           Transfer Locati
     C                     Z-ADD0         WL0052           LLT Transfer Lo
     C                     Z-ADDTDC4NB    WL0053           Order Number
     C                     MOVEL'P'       WL0054    P      LLT Status
     C                     MOVELWULLTU    WL0055    P      LTT Unused Sts
     C                     MOVELWULLYT    WL0056    P      LTT Unused Sts
     C                     MOVELWN0356    WL0057    P      EDI Status 1
     C                     MOVELWN0357    WL0058    P      EDI Status 2
     C                     MOVELWN0358    WL0059    P      EDI Status 3
     C                     MOVELWN0359    WL0060    P      Record Status
     C                     Z-ADDWN0360    WL0061           Job Time
     C                     MOVELWN0361    WL0062    P      User Id
     C                     MOVELWN0362    WL0063    P      Job Name
     C                     Z-ADDWN0363    WL0064           Job Date
     C                     EXSR TKCRRC
      * Upd Qty On-Hand,wgt   RT - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTDAIC3    WL0065           Company Number
     C                     Z-ADDWN0346    WL0066           Item Code
     C                     MOVELWN0347    WL0067    P      Warehouse Code
     C                     Z-ADDWN0348    WL0068           Production Date
     C                     Z-ADDWN0349    WL0069           Lot Number
     C                     MOVELWN0350    WL0070    P      Location Code
     C                     Z-ADDWN0351    WL0071           Location Level
     C                     Z-ADDWN0352    WL0072           Quantity Loc Tr
     C                     Z-ADDWN0353    WL0073           Weight Order 2
     C                     EXSR TLRVGN
     C                     END                             *FI
     C                     Z-ADDTDHGCD    WN0346           Item Code
     C                     MOVELTDAJCD    WN0347           Warehouse Code
     C                     Z-ADDTDELDT    WN0348           Production Date
     C                     Z-ADDTDLXNM    WN0349           Lot Number
     C                     MOVELTDYMCD    WN0350           Location Code
     C                     Z-ADDTDYNCD    WN0351           Location Level
     C                     Z-ADD0         WN0352           LLT Trans Qty
     C                     Z-ADD0         WN0353           LLT Trans Wgt
     C                     END                             *FI
      * PRC:  Accumulate Quantity
      * CASE: PAR.OIA Allocation Sts is Shipped
     C           'U'       IFEQ 'S'                        *IF
     C           TDJ6QT    MULT -1        WN0345           Quantity Loc Tr
     C                     ADD  WN0345    WN0352           LLT Trans Qty
      * RMC 1/9/17 reduce weight too
     C           TDG9WG    MULT -1        WN0354           Weight Order 2
     C                     ADD  WN0354    WN0353           LLT Trans Wgt
      * Chg Allocation Sts    CH - Order Inv Allocation  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTDAIC3    WL0125           Company Number
     C                     Z-ADDTDC4NB    WL0126           Order Number
     C                     Z-ADDTDDPNB    WL0127           Order Sequence
     C                     Z-ADDTDUENB    WL0128           Order Secondary
     C                     Z-ADDTDALSW    WL0129           Allocation Seq
     C                     MOVEL'U'       WL0130    P      OIA Allocation
     C                     EXSR TUCHRC
     C                     ELSE
      * CASE: PAR.OIA Allocation Sts is Unshipped
     C           'U'       IFEQ 'U'                        *IF
     C                     ADD  TDJ6QT    WN0352           LLT Trans Qty
      * RMC 1/9/17 increase weight too
     C                     ADD  TDG9WG    WN0353           LLT Trans Wgt
      * Chg Allocation Sts    CH - Order Inv Allocation  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTDAIC3    WL0125           Company Number
     C                     Z-ADDTDC4NB    WL0126           Order Number
     C                     Z-ADDTDDPNB    WL0127           Order Sequence
     C                     Z-ADDTDUENB    WL0128           Order Secondary
     C                     Z-ADDTDALSW    WL0129           Allocation Seq
     C                     MOVEL'U'       WL0130    P      OIA Allocation
     C                     EXSR TUCHRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTI     READE@L8CPZO                  90*
     C                     ENDDO
      * USER: Exit processing
      * Do if qty> 0    ----RMC 2/15/06
      * CASE: PAR.LLT Trans Qty is NE Zero
     C           WN0352    IFNE 0                          *IF
      *
     C                     Z-ADD*ZERO     WN0436  30       LLT Sequence #
     C                     MOVEL*BLANK    WN0437  1        EDI Status 1
     C                     MOVEL*BLANK    WN0438  1        EDI Status 2
     C                     MOVEL*BLANK    WN0439  1        EDI Status 3
     C                     MOVEL*BLANK    WN0440  1        Record Status
     C                     Z-ADD*ZERO     WN0441  60       Job Time
     C                     MOVEL*BLANK    WN0442 10        User Id
     C                     MOVEL*BLANK    WN0443 10        Job Name
     C                     Z-ADD*ZERO     WN0444  70       Job Date
      *
      * Crt Item Lot/Loc Trns IF
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTDAIC3    WL0031           Company Number
     C                     Z-ADDWN0346    WL0032           Item Code
     C                     MOVELWN0347    WL0033    P      Warehouse Code
     C                     MOVEL'S'       WL0034    P      LLT Trans Type
     C                     Z-ADD##JDT     WL0035           LLT Trans Date
     C                     EXSR TJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0036    WN0436           LLT Sequence #
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTDAIC3    WL0037           Company Number
     C                     Z-ADDWN0346    WL0038           Item Code
     C                     MOVELWN0347    WL0039    P      Warehouse Code
     C                     MOVEL'S'       WL0040    P      LLT Trans Type
     C                     Z-ADD##JDT     WL0041           LLT Trans Date
     C                     Z-ADDWN0436    WL0042           LLT Sequence #
     C                     Z-ADDWN0348    WL0043           LLT Production
     C                     Z-ADDWN0352    WL0044           LLT Trans Qty
     C                     Z-ADDWN0353    WL0045           LLT Trans Wgt
     C                     Z-ADDWN0349    WL0046           LLT Lot Number
     C                     MOVELWN0350    WL0047    P      Location Code
     C                     Z-ADDWN0351    WL0048           LLT Location Le
     C                     MOVEL*BLANK    WL0049           Transfer Wareho
     C                     Z-ADD0         WL0050           LLT Transfer Lo
     C                     MOVEL*BLANK    WL0051           Transfer Locati
     C                     Z-ADD0         WL0052           LLT Transfer Lo
     C                     Z-ADDTDC4NB    WL0053           Order Number
     C                     MOVEL'P'       WL0054    P      LLT Status
     C                     MOVELWULLTU    WL0055    P      LTT Unused Sts
     C                     MOVELWULLYT    WL0056    P      LTT Unused Sts
     C                     MOVELWN0437    WL0057    P      EDI Status 1
     C                     MOVELWN0438    WL0058    P      EDI Status 2
     C                     MOVELWN0439    WL0059    P      EDI Status 3
     C                     MOVELWN0440    WL0060    P      Record Status
     C                     Z-ADDWN0441    WL0061           Job Time
     C                     MOVELWN0442    WL0062    P      User Id
     C                     MOVELWN0443    WL0063    P      Job Name
     C                     Z-ADDWN0444    WL0064           Job Date
     C                     EXSR TKCRRC
      * Upd Qty On-Hand,wgt   RT - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTDAIC3    WL0065           Company Number
     C                     Z-ADDWN0346    WL0066           Item Code
     C                     MOVELWN0347    WL0067    P      Warehouse Code
     C                     Z-ADDWN0348    WL0068           Production Date
     C                     Z-ADDWN0349    WL0069           Lot Number
     C                     MOVELWN0350    WL0070    P      Location Code
     C                     Z-ADDWN0351    WL0071           Location Level
     C                     Z-ADDWN0352    WL0072           Quantity Loc Tr
     C                     Z-ADDWN0353    WL0073           Weight Order 2
     C                     EXSR TLRVGN
     C                     END                             *FI
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * Rtv Next Seq #        RT - IC Item Lot/Loc Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TEAIC3    WQTJ01           Company Number
     C           *LIKE     DEFN TEHGCD    WQTJ02           Item Code
     C           *LIKE     DEFN TEAJCD    WQTJ03           Warehouse Code
     C           *LIKE     DEFN TELTRT    WQTJ04           LLT Trans Type
     C           *LIKE     DEFN TELRDT    WQTJ05           LLT Trans Date
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WQTJ01           Company Number
     C                     KFLD           WQTJ02           Item Code
     C                     KFLD           WQTJ03           Warehouse Code
     C                     KFLD           WQTJ04           LLT Trans Type
     C                     KFLD           WQTJ05           LLT Trans Date
      * Setup key
     C                     Z-ADDWL0031    WQTJ01           Company Number
     C                     Z-ADDWL0032    WQTJ02           Item Code
     C                     MOVELWL0033    WQTJ03           Warehouse Code
     C                     MOVELWL0034    WQTJ04           LLT Trans Type
     C                     Z-ADDWL0035    WQTJ05           LLT Trans Date
      * Establish starting position
     C           KRSTJ     SETLL@L7CPUK                    *
     C           KRSTJ     READE@L7CPUK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2638' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0036           LLT Sequence #
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           TELLTS    ADD  1         WL0036           LLT Sequence #
     C                     GOTO TJEXIT                     *QUIT
     C           KRSTJ     READE@L7CPUK                  90*
     C                     ENDDO
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKCRRC    BEGSR
      *================================================================
      * Crt Item Lot/Loc Trns CR - Item Lot Loc Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L7CPS3
     C                     Z-ADDWL0037    TFAIC3           Company Number
     C                     Z-ADDWL0038    TFHGCD           Item Code
     C                     MOVELWL0039    TFAJCD           Warehouse Code
     C                     MOVELWL0040    TFLTRT           LLT Trans Type
     C                     Z-ADDWL0041    TFLRDT           LLT Trans Date
     C                     Z-ADDWL0042    TFLLTS           LLT Sequence #
     C                     Z-ADDWL0043    TFLSDT           LLT Production
     C                     Z-ADDWL0044    TFJ5QT           LLT Trans Qty
     C                     Z-ADDWL0045    TFG8WG           LLT Trans Wgt
     C                     Z-ADDWL0046    TFLLTN           LLT Lot Number
     C                     MOVELWL0047    TFYMCD           Location Code
     C                     Z-ADDWL0048    TFLLCL           LLT Location Le
     C                     MOVELWL0049    TFBNAA           Transfer Wareho
     C                     Z-ADDWL0050    TFLLTR           LLT Transfer Lo
     C                     MOVELWL0051    TFY2CD           Transfer Locati
     C                     Z-ADDWL0052    TFLLTL           LLT Transfer Lo
     C                     Z-ADDWL0053    TFC4NB           Order Number
     C                     MOVELWL0054    TFLOST           LLT Status
     C                     MOVELWL0055    TFLLTU           LTT Unused Sts
     C                     MOVELWL0056    TFLLYT           LTT Unused Sts
     C                     MOVELWL0057    TFUVST           EDI Status 1
     C                     MOVELWL0058    TFUWST           EDI Status 2
     C                     MOVELWL0059    TFUXST           EDI Status 3
     C                     MOVELWL0060    TFVSST           Record Status
     C                     Z-ADDWL0061    TFAATM           Job Time
     C                     MOVELWL0062    TFAYNA           User Id
     C                     MOVELWL0063    TFA0NA           Job Name
     C                     Z-ADDWL0064    TFAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       TFVSST           Record Status
     C                     Z-ADD##JTM     TFAATM           Job Time
     C                     MOVEL##USR     TFAYNA           User Id
     C                     MOVEL##JOB     TFA0NA           Job Name
     C                     Z-ADD##JDT     TFAXDT           Job Date
     C           KLCRTK    KLIST
     C                     KFLD           TFAIC3           Company Number
     C                     KFLD           TFHGCD           Item Code
     C                     KFLD           TFAJCD           Warehouse Code
     C                     KFLD           TFLTRT           LLT Trans Type
     C                     KFLD           TFLRDT           LLT Trans Date
     C                     KFLD           TFLLTS           LLT Sequence #
      * Check for duplicate primary key
     C           KLCRTK    SETLL@L7CPS3                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2639' W0RTN   7
      * Send message 'Item Lot Loc Trans     EX'
     C                     MOVEL'USR2639' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C                     WRITE@L7CPS3                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * Upd Qty On-Hand,wgt   RT - Item Lot Location  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0364  50       ILL Item Qty On
     C                     Z-ADD*ZERO     WN0365 112       ILL Unit Weight
     C                     Z-ADD*ZERO     WN0366  50       ILL Co-Packer L
     C                     Z-ADD*ZERO     WN0367 112       ILl Item Wgt On
     C                     Z-ADD*ZERO     WN0368  50       ILL Unused Qty
     C                     Z-ADD*ZERO     WN0369 112       ILL Unused Wgt
     C                     Z-ADD*ZERO     WN0370  70       ILL Avail Ship
     C                     Z-ADD*ZERO     WN0371  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0372  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0373  72       ILL Unused Nbr
     C                     MOVEL*BLANK    WN0374  6        ILL Customer Co
     C                     MOVEL*BLANK    WN0375  1        ILL Status
     C                     MOVEL*BLANK    WN0376  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0377  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0378  2        ILL Unused Sts
     C                     MOVEL*BLANK    WN0379  3        Inv Hold Reason
     C                     MOVEL*BLANK    WN0380  1        EDI Status 1
     C                     MOVEL*BLANK    WN0381  1        EDI Status 2
     C                     MOVEL*BLANK    WN0382  1        EDI Status 3
     C                     MOVEL*BLANK    WN0383  1        Record Status
     C                     Z-ADD*ZERO     WN0384  60       Job Time
     C                     MOVEL*BLANK    WN0385 10        User Id
     C                     MOVEL*BLANK    WN0386 10        Job Name
     C                     Z-ADD*ZERO     WN0387  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           TGAIC3           Company Number
     C                     KFLD           TGHGCD           Item Code
     C                     KFLD           TGAJCD           Warehouse Code
     C                     KFLD           TGELDT           Production Date
     C                     KFLD           TGLXNM           Lot Number
     C                     KFLD           TGYMCD           Location Code
     C                     KFLD           TGYNCD           Location Level
      * Setup key
     C                     Z-ADDWL0065    TGAIC3           Company Number
     C                     Z-ADDWL0066    TGHGCD           Item Code
     C                     MOVELWL0067    TGAJCD           Warehouse Code
     C                     Z-ADDWL0068    TGELDT           Production Date
     C                     Z-ADDWL0069    TGLXNM           Lot Number
     C                     MOVELWL0070    TGYMCD           Location Code
     C                     Z-ADDWL0071    TGYNCD           Location Level
      * Establish starting position
     C           KRSTL     CHAIN@L5CPSV              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2634' W0RTN   7
      * USER: Processing if Data record not found
      *
     C                     MOVEL*BLANK    WN0388  1        WLT Type Code
     C                     Z-ADD*ZERO     WN0389  52       WLT Type Chill
      *
      * Clc Loc Avail Shp Dte IF
      * Rtv Loc Type          RT - Warehouse Location  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWL0067    WL0074    P      Warehouse Code
     C                     MOVELWL0070    WL0075    P      Location Code
     C                     EXSR TMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0076    WN0388    P      WLT Type Code
      * Rtv Chill Time        RT - Warehouse Location Type  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0388    WL0077    P      WLT Type Code
     C                     EXSR TNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0078    WN0389           WLT Type Chill
      * PAR.ILL Avail Ship Date = PAR.Production Date + PAR.WLT Type Chil
     C           WL0068    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0389    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0370
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0370
     C                     END
      * RTV Unit Weight        RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0065    WL0079           Company Number
     C                     Z-ADDWL0066    WL0080           Item Code
     C                     EXSR TORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0081    WN0365           Unit Weight
     C                     MOVELWL0082    YL0016    P      Quality Level
      * Crt Item Loc          CR - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0065    WL0083           Company Number
     C                     Z-ADDWL0066    WL0084           Item Code
     C                     MOVELWL0067    WL0085    P      Warehouse Code
     C                     Z-ADDWL0068    WL0086           Production Date
     C                     Z-ADDWL0069    WL0087           Lot Number
     C                     MOVELWL0070    WL0088    P      Location Code
     C                     Z-ADDWL0071    WL0089           Location Level
     C                     Z-ADDWL0072    WL0090           ILL Item Qty On
     C                     Z-ADDWN0365    WL0091           ILL Unit Weight
     C                     Z-ADDWN0366    WL0092           ILL Co-Packer L
     C                     Z-ADDWN0367    WL0093           ILl Item Wgt On
     C                     Z-ADDWN0368    WL0094           ILL Unused Qty
     C                     Z-ADDWN0369    WL0095           ILL Unused Wgt
     C                     Z-ADDWN0370    WL0096           ILL Avail Ship
     C                     Z-ADDWN0371    WL0097           ILL Unused Date
     C                     Z-ADDWN0372    WL0098           ILL Unused Date
     C                     Z-ADDWN0373    WL0099           ILL Unused Nbr
     C                     MOVELWN0374    WL0100    P      ILL Customer Co
     C                     MOVEL'A'       WL0101    P      ILL Status
     C                     MOVELWN0376    WL0102    P      ILL Unused Sts
     C                     MOVELWN0377    WL0103    P      ILL Unused Sts
     C                     MOVELWN0378    WL0104    P      ILL Unused Sts
     C                     MOVELWN0379    WL0105    P      Inv Hold Reason
     C                     MOVELWN0380    WL0106    P      EDI Status 1
     C                     MOVELWN0381    WL0107    P      EDI Status 2
     C                     MOVELWN0382    WL0108    P      EDI Status 3
     C                     MOVELWN0383    WL0109    P      Record Status
     C                     Z-ADDWN0384    WL0110           Job Time
     C                     MOVELWN0385    WL0111    P      User Id
     C                     MOVELWN0386    WL0112    P      Job Name
     C                     Z-ADDWN0387    WL0113           Job Date
     C                     EXSR TPCRRC
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           TGJ2QT    ADD  WL0072    WN0364           ILL Item Qty On
     C           TGG6WG    ADD  WL0073    WN0367           ILl Item Wgt On
      * CASE: PAR.ILL Item Qty On-Hand is GT Zero
     C           WN0364    IFGT 0                          *IF
      * Chg Quantity On-Hn,wg CH - Item Lot Location  * 
     C                     EXSR TQCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Del Item Location     DL - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTGAIC3    WL0114           Company Number
     C                     Z-ADDTGHGCD    WL0115           Item Code
     C                     MOVELTGAJCD    WL0116    P      Warehouse Code
     C                     Z-ADDTGELDT    WL0117           Production Date
     C                     Z-ADDTGLXNM    WL0118           Lot Number
     C                     MOVELTGYMCD    WL0119    P      Location Code
     C                     Z-ADDTGYNCD    WL0120           Location Level
     C                     EXSR TRDLRC
      * Del Item Balance Dtl  RT - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDTGAIC3    WL0121           Company Number
     C                     Z-ADDTGHGCD    WL0122           Item Code
     C                     MOVELTGAJCD    WL0123    P      Warehouse Code
     C                     Z-ADDTGELDT    WL0124           Production Date
     C                     EXSR TSRVGN
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * Rtv Loc Type          RT - Warehouse Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           THAJCD           Warehouse Code
     C                     KFLD           THYMCD           Location Code
      * Setup key
     C                     MOVELWL0074    THAJCD           Warehouse Code
     C                     MOVELWL0075    THYMCD           Location Code
      * Establish starting position
     C           KRSTM     CHAIN@L2RESM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2628' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0076           WLT Type Code
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTHAGSX    WL0076           WLT Type Code
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * Rtv Chill Time        RT - Warehouse Location Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           TIAGSX           WLT Type Code
      * Setup key
     C                     MOVELWL0077    TIAGSX           WLT Type Code
      * Establish starting position
     C           KRSTN     CHAIN@L3RET8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2660' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0078           WLT Type Chill
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDTISLTY    WL0078           WLT Type Chill
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * RTV Unit Weight        RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           TAAIC3           Company Number
     C                     KFLD           TAHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0079    TAAIC3           Company Number
     C                     Z-ADDWL0080    TAHGCD           Item Code
      * Establish starting position
     C           KRSTO     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0081           Unit Weight
     C                     MOVEL*BLANK    WL0082           Quality Level
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDTAAIWG    WL0081           Unit Weight
     C                     MOVELTAHICD    WL0082           Quality Level
     C                     ENDIF
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPCRRC    BEGSR
      *================================================================
      * Crt Item Loc          CR - Item Lot Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @L5CPSL
     C                     Z-ADDWL0083    TJAIC3           Company Number
     C                     Z-ADDWL0084    TJHGCD           Item Code
     C                     MOVELWL0085    TJAJCD           Warehouse Code
     C                     Z-ADDWL0086    TJELDT           Production Date
     C                     Z-ADDWL0087    TJLXNM           Lot Number
     C                     MOVELWL0088    TJYMCD           Location Code
     C                     Z-ADDWL0089    TJYNCD           Location Level
     C                     Z-ADDWL0090    TJJ2QT           ILL Item Qty On
     C                     Z-ADDWL0091    TJG5WG           ILL Unit Weight
     C                     Z-ADDWL0092    TJJ3QT           ILL Co-Packer L
     C                     Z-ADDWL0093    TJG6WG           ILl Item Wgt On
     C                     Z-ADDWL0094    TJJ4QT           ILL Unused Qty
     C                     Z-ADDWL0095    TJG7WG           ILL Unused Wgt
     C                     Z-ADDWL0096    TJLODT           ILL Avail Ship
     C                     Z-ADDWL0097    TJLPDT           ILL Unused Date
     C                     Z-ADDWL0098    TJLQDT           ILL Unused Date
     C                     Z-ADDWL0099    TJNBR            ILL Unused Nbr
     C                     MOVELWL0100    TJYTCD           ILL Customer Co
     C                     MOVELWL0101    TJAMSX           ILL Status
     C                     MOVELWL0102    TJASSX           ILL Unused Sts
     C                     MOVELWL0103    TJATSX           ILL Unused Sts
     C                     MOVELWL0104    TJAUSX           ILL Unused Sts
     C                     MOVELWL0105    TJYSCD           Inv Hold Reason
     C                     MOVELWL0106    TJUVST           EDI Status 1
     C                     MOVELWL0107    TJUWST           EDI Status 2
     C                     MOVELWL0108    TJUXST           EDI Status 3
     C                     MOVELWL0109    TJVSST           Record Status
     C                     Z-ADDWL0110    TJAATM           Job Time
     C                     MOVELWL0111    TJAYNA           User Id
     C                     MOVELWL0112    TJA0NA           Job Name
     C                     Z-ADDWL0113    TJAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       TJVSST           Record Status
     C                     Z-ADD##JTM     TJAATM           Job Time
     C                     MOVEL##USR     TJAYNA           User Id
     C                     MOVEL##JOB     TJA0NA           Job Name
     C                     Z-ADD##JDT     TJAXDT           Job Date
     C           KLCRTP    KLIST
     C                     KFLD           TJAIC3           Company Number
     C                     KFLD           TJHGCD           Item Code
     C                     KFLD           TJAJCD           Warehouse Code
     C                     KFLD           TJELDT           Production Date
     C                     KFLD           TJLXNM           Lot Number
     C                     KFLD           TJYMCD           Location Code
     C                     KFLD           TJYNCD           Location Level
      * Check for duplicate primary key
     C           KLCRTP    SETLL@L5CPSL                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2635' W0RTN   7
      * Send message 'Item Lot Location      EX'
     C                     MOVEL'USR2635' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C                     WRITE@L5CPSL                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQCHRC    BEGSR
      *================================================================
      * Chg Quantity On-Hn,wg CH - Item Lot Location  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0390 112       ILL Unit Weight
     C                     Z-ADD*ZERO     WN0391  50       ILL Co-Packer L
     C                     Z-ADD*ZERO     WN0392  50       ILL Unused Qty
     C                     Z-ADD*ZERO     WN0393 112       ILL Unused Wgt
     C                     Z-ADD*ZERO     WN0394  70       ILL Avail Ship
     C                     Z-ADD*ZERO     WN0395  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0396  70       ILL Unused Date
     C                     Z-ADD*ZERO     WN0397  72       ILL Unused Nbr
     C                     MOVEL*BLANK    WN0398  6        ILL Customer Co
     C                     MOVEL*BLANK    WN0399  1        ILL Status
     C                     MOVEL*BLANK    WN0400  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0401  1        ILL Unused Sts
     C                     MOVEL*BLANK    WN0402  2        ILL Unused Sts
     C                     MOVEL*BLANK    WN0403  3        Inv Hold Reason
     C                     MOVEL*BLANK    WN0404  1        EDI Status 1
     C                     MOVEL*BLANK    WN0405  1        EDI Status 2
     C                     MOVEL*BLANK    WN0406  1        EDI Status 3
     C                     MOVEL*BLANK    WN0407  1        Record Status
     C                     Z-ADD*ZERO     WN0408  60       Job Time
     C                     MOVEL*BLANK    WN0409 10        User Id
     C                     MOVEL*BLANK    WN0410 10        Job Name
     C                     Z-ADD*ZERO     WN0411  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @L5CPSL
     C                     Z-ADDTGAIC3    TJAIC3           Company Number
     C                     Z-ADDTGHGCD    TJHGCD           Item Code
     C                     MOVELTGAJCD    TJAJCD    P      Warehouse Code
     C                     Z-ADDTGELDT    TJELDT           Production Date
     C                     Z-ADDTGLXNM    TJLXNM           Lot Number
     C                     MOVELTGYMCD    TJYMCD    P      Location Code
     C                     Z-ADDTGYNCD    TJYNCD           Location Level
      *
     C           KLCHTQ    KLIST
     C                     KFLD           TJAIC3           Company Number
     C                     KFLD           TJHGCD           Item Code
     C                     KFLD           TJAJCD           Warehouse Code
     C                     KFLD           TJELDT           Production Date
     C                     KFLD           TJLXNM           Lot Number
     C                     KFLD           TJYMCD           Location Code
     C                     KFLD           TJYNCD           Location Level
     C           KLCHTQ    CHAIN@L5CPSL              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL5CPL0'MDACP
     C                     MOVEL'@L5CPSL' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDL51    YFRDCS
      * Move non-key fields to @L5CPSL
     C                     Z-ADDWN0364    TJJ2QT           ILL Item Qty On
     C                     Z-ADDWN0367    TJG6WG           ILl Item Wgt On
      *
      * Set PGM.*Record Data Changed flag
     C           QPDL51    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     TJAATM           Job Time
     C                     MOVEL##USR     TJAYNA           User Id
     C                     MOVEL##JOB     TJA0NA           Job Name
     C                     Z-ADD##JDT     TJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDL51    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@L5CPSL                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDL5CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRDLRC    BEGSR
      *================================================================
      * Del Item Location     DL - Item Lot Location  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0412  50       ILL Item Qty On
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @L5CPSL
     C                     Z-ADDWL0114    TJAIC3           Company Number
     C                     Z-ADDWL0115    TJHGCD           Item Code
     C                     MOVELWL0116    TJAJCD           Warehouse Code
     C                     Z-ADDWL0117    TJELDT           Production Date
     C                     Z-ADDWL0118    TJLXNM           Lot Number
     C                     MOVELWL0119    TJYMCD           Location Code
     C                     Z-ADDWL0120    TJYNCD           Location Level
      *
     C           KLDLTR    KLIST
     C                     KFLD           TJAIC3           Company Number
     C                     KFLD           TJHGCD           Item Code
     C                     KFLD           TJAJCD           Warehouse Code
     C                     KFLD           TJELDT           Production Date
     C                     KFLD           TJLXNM           Lot Number
     C                     KFLD           TJYMCD           Location Code
     C                     KFLD           TJYNCD           Location Level
     C           KLDLTR    CHAIN@L5CPSL              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL5CPL0'MDACP
     C                     MOVEL'@L5CPSL' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TREXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@L5CPSL                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSRVGN    BEGSR
      *================================================================
      * Del Item Balance Dtl  RT - Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTS     KLIST
     C                     KFLD           TBAIC3           Company Number
     C                     KFLD           TBHGCD           Item Code
     C                     KFLD           TBAJCD           Warehouse Code
     C                     KFLD           TBELDT           Production Date
      * Setup key
     C                     Z-ADDWL0121    TBAIC3           Company Number
     C                     Z-ADDWL0122    TBHGCD           Item Code
     C                     MOVELWL0123    TBAJCD           Warehouse Code
     C                     Z-ADDWL0124    TBELDT           Production Date
      * Establish starting position
     C           KRSTS     CHAIN@B1REJ0              90    *
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Quantity on Hand - U/M1 is Equal to zero
     C           TBARQT    IFEQ 0                          *IF
      * Del Item Balance Dtl  DL - IC Item Balance Detail  * 
     C                     EXSR TTDLRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTDLRC    BEGSR
      *================================================================
      * Del Item Balance Dtl  DL - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B1REJ1
     C                     Z-ADDTBAIC3    TKAIC3           Company Number
     C                     Z-ADDTBHGCD    TKHGCD           Item Code
     C                     MOVELTBAJCD    TKAJCD           Warehouse Code
     C                     Z-ADDTBELDT    TKELDT           Production Date
      *
     C           KLDLTT    KLIST
     C                     KFLD           TKAIC3           Company Number
     C                     KFLD           TKHGCD           Item Code
     C                     KFLD           TKAJCD           Warehouse Code
     C                     KFLD           TKELDT           Production Date
     C           KLDLTT    CHAIN@B1REJ1              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TTEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TTEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B1REJ1                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TUCHRC    BEGSR
      *================================================================
      * Chg Allocation Sts    CH - Order Inv Allocation  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0413  50       OIA Alloc/Shipp
     C                     Z-ADD*ZERO     WN0414 112       OIA Alloc/Shipp
     C                     Z-ADD*ZERO     WN0415  50       OIA Co-Packer L
     C                     Z-ADD*ZERO     WN0416 112       OIA Serial Numb
     C                     MOVEL*BLANK    WN0417  1        OIA Create Sts
     C                     MOVEL*BLANK    WN0418  1        OIA Modified St
     C                     MOVEL*BLANK    WN0419  2        OIA Loc Pick St
     C                     MOVEL*BLANK    WN0420  1        OIA Unused Sts
     C                     MOVEL*BLANK    WN0421  2        OIA Unused Sts
     C                     Z-ADD*ZERO     WN0422  70       Item Code
     C                     MOVEL*BLANK    WN0423  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0424  70       Production Date
     C                     Z-ADD*ZERO     WN0425  50       Lot Number
     C                     MOVEL*BLANK    WN0426  4        Location Code
     C                     Z-ADD*ZERO     WN0427  20       Location Level
     C                     MOVEL*BLANK    WN0428  1        EDI Status 1
     C                     MOVEL*BLANK    WN0429  1        EDI Status 2
     C                     MOVEL*BLANK    WN0430  1        EDI Status 3
     C                     MOVEL*BLANK    WN0431  1        Record Status
     C                     Z-ADD*ZERO     WN0432  60       Job Time
     C                     MOVEL*BLANK    WN0433 10        User Id
     C                     MOVEL*BLANK    WN0434 10        Job Name
     C                     Z-ADD*ZERO     WN0435  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @L8CPSX
     C                     Z-ADDWL0125    WRAIC3           Company Number
     C                     Z-ADDWL0126    WRC4NB           Order Number
     C                     Z-ADDWL0127    WRDPNB           Order Sequence
     C                     Z-ADDWL0128    WRUENB           Order Secondary
     C                     Z-ADDWL0129    WRALSW           Allocation Seq
      *
     C           KLCHTU    KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRC4NB           Order Number
     C                     KFLD           WRDPNB           Order Sequence
     C                     KFLD           WRUENB           Order Secondary
     C                     KFLD           WRALSW           Allocation Seq
     C           KLCHTU    CHAIN@L8CPSX              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDL8CPL0'MDACP
     C                     MOVEL'@L8CPSX' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDL81    YGRDCS
      * Move non-key fields to @L8CPSX
     C                     MOVELWL0130    WRSOAS    P      OIA Allocation
      *
      * Set PGM.*Record Data Changed flag
     C           QPDL81    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WRAATM           Job Time
     C                     MOVEL##USR     WRAYNA           User Id
     C                     MOVEL##JOB     WRA0NA           Job Name
     C                     Z-ADD##JDT     WRAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDL81    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@L8CPSX                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDL8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVRVGN    BEGSR
      *================================================================
      * UPD Unship Load Status RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTV     KLIST
     C                     KFLD           WERMNB           Load ID
      * Setup key
     C                     Z-ADDWN0010    WERMNB           Load ID
      * Establish starting position
     C           KRSTV     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * 11/12/02  zero out actual ship date
      * CASE: DB1.Load Status is Shipped
     C           WEPKST    IFEQ 'S'                        *IF
      * CHG Load when UnshippedCH - Load Header  * 
     C                     EXSR TWCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWCHRC    BEGSR
      *================================================================
      * CHG Load when UnshippedCH - Load Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0445  1        LTL Flag
     C                     Z-ADD*ZERO     WN0446  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0447 15        Seal 1
     C                     MOVEL*BLANK    WN0448 15        Seal 2
     C                     MOVEL*BLANK    WN0449 15        Seal 3
     C                     MOVEL*BLANK    WN0450 15        Seal 4
     C                     MOVEL*BLANK    WN0451 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0452  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0453 112       Flat Amount
     C                     MOVEL*BLANK    WN0454  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0455  50       Total Stops
     C                     MOVEL*BLANK    WN0456 20        Trailer Id
     C                     MOVEL*BLANK    WN0457  3        Transloader Car
     C                     Z-ADD*ZERO     WN0458  40       BOL Time
     C                     MOVEL*BLANK    WN0459  3        Carrier Code
     C                     MOVEL*BLANK    WN0460  7        Truck Size
     C                     Z-ADD*ZERO     WN0461  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0462 112       Rated Freight
     C                     MOVEL*BLANK    WN0463  1        Ship Status
     C                     MOVEL*BLANK    WN0464  1        Load Type
     C                     Z-ADD*ZERO     WN0465  50       Number Pallets
     C                     Z-ADD*ZERO     WN0466  50       Number Pallets
     C                     Z-ADD*ZERO     WN0467 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0468  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0469  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0470  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0471 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0472 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0473  70       Actual Departur
     C                     Z-ADD*ZERO     WN0474  40       Departure Time
     C                     Z-ADD*ZERO     WN0475  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0476  52       Product Tempera
     C                     Z-ADD*ZERO     WN0477  50       Number Spacers
     C                     MOVEL*BLANK    WN0478 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0479  70       Total Load Mile
     C                     MOVEL*BLANK    WN0480 12        Recorder ID
     C                     MOVEL*BLANK    WN0481  2        Shipping Method
     C                     MOVEL*BLANK    WN0482  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0483  2        Ship To State C
     C                     Z-ADD*ZERO     WN0484  70       Gross Weight
     C                     MOVEL*BLANK    WN0485  3        Carrier Broker
     C                     MOVEL*BLANK    WN0486  1        Export Status
     C                     MOVEL*BLANK    WN0487  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0488  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0489  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0490  70       Spotted Date
     C                     Z-ADD*ZERO     WN0491  60       Spotted Time
     C                     Z-ADD*ZERO     WN0492  70       Load Finished D
     C                     Z-ADD*ZERO     WN0493  60       Load Finished T
     C                     Z-ADD*ZERO     WN0494  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0495  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0496  70       Truck Departure
     C                     Z-ADD*ZERO     WN0497  60       Truck Departure
     C                     Z-ADD*ZERO     WN0498  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0499  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0500  3        Shipping Line
     C                     MOVEL*BLANK    WN0501 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0502 30        Vessel Name
     C                     Z-ADD*ZERO     WN0503  50       Voyage
     C                     Z-ADD*ZERO     WN0504  70       Sail Date
     C                     MOVEL*BLANK    WN0505 12        Booking Number
     C                     MOVEL*BLANK    WN0506 20        Discharge Port
     C                     Z-ADD*ZERO     WN0507  70       Arrival Date
     C                     MOVEL*BLANK    WN0508 12        Container Numbe
     C                     Z-ADD*ZERO     WN0509  70       Date In
     C                     Z-ADD*ZERO     WN0510  60       Time In
     C                     Z-ADD*ZERO     WN0511  70       Date Out
     C                     Z-ADD*ZERO     WN0512  60       Time Out
     C                     Z-ADD*ZERO     WN0513 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0514  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0515  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0516  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0517  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0518  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0519  70       Requested Deliv
     C                     MOVEL*BLANK    WN0520  1        Load Acceptance
     C                     MOVEL*BLANK    WN0521  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0522  70       On Yard Date
     C                     Z-ADD*ZERO     WN0523  60       On Yard Time
     C                     Z-ADD*ZERO     WN0524  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0525  60       Deadline Depart
     C                     MOVEL*BLANK    WN0526  1        Load Held Over
     C                     MOVEL*BLANK    WN0527  1        Load Held Over
     C                     MOVEL*BLANK    WN0528 15        Load Held Over
     C                     MOVEL*BLANK    WN0529 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0530 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0531  70       Express Mail Da
     C                     MOVEL*BLANK    WN0532  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0533  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0534  70       Product Complet
     C                     Z-ADD*ZERO     WN0535  60       Product Complet
     C                     Z-ADD*ZERO     WN0536  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0537  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0538  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0539  1        Load Confirmed
     C                     MOVEL*BLANK    WN0540 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0541  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0542  60       Load Door 1
     C                     Z-ADD*ZERO     WN0543  70       Override Total
     C                     Z-ADD*ZERO     WN0544  60       Load Door 2
     C                     MOVEL*BLANK    WN0545  1        Partial Load
     C                     MOVEL*BLANK    WN0546  1        Load Confirmati
     C                     MOVEL*BLANK    WN0547  1        Export Load USD
     C                     MOVEL*BLANK    WN0548  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0549 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0550 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0551 15        Late Billing Em
     C                     MOVEL*BLANK    WN0552 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0553 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0554  1        Multi Company L
     C                     MOVEL*BLANK    WN0555  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0556  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0557  1        LH Power Only L
     C                     MOVEL*BLANK    WN0558  1        MG Created Load
     C                     MOVEL*BLANK    WN0559  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0560  2        Load U/M
     C                     MOVEL*BLANK    WN0561  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0562  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0563  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0564  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0565  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0566  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0567  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0568  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0569  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0570  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0571  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0572  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0573  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0574  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0575  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0576  60       LH Unused Time
     C                     MOVEL*BLANK    WN0577  1        EDI Status 1
     C                     MOVEL*BLANK    WN0578  1        EDI Status 2
     C                     MOVEL*BLANK    WN0579  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0580  60       Job Time
     C                     MOVEL*BLANK    WN0581 10        User Id
     C                     MOVEL*BLANK    WN0582 10        Job Name
     C                     Z-ADD*ZERO     WN0583  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWERMNB    TLRMNB           Load ID
      *
     C           KLCHTW    KLIST
     C                     KFLD           TLRMNB           Load ID
     C           KLCHTW    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL012.
     C                     MOVEL'LBL012'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YHRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWEAIC3    TLAIC3           Company Number
     C                     Z-ADDWEAODT    TLAODT           Scheduled Ship
     C                     MOVEL'L'       TLPKST    P      Load Status
     C                     Z-ADD0         TLF9DT           Actual Ship Dat
     C                     Z-ADD0         TLJ7DT           BOL Complete Da
     C                     Z-ADD0         TLBOTM           BOL Complete Ti
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     TLAATM           Job Time
     C                     MOVEL##USR     TLAYNA           User Id
     C                     MOVEL##JOB     TLA0NA           Job Name
     C                     Z-ADD##JDT     TLAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         TXRVGN    BEGSR
      *================================================================
      * PFS Unship Order      RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTX     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDWN0003    WBAIC3           Company Number
     C                     Z-ADDWN0004    WBC4NB           Order Number
      * Establish starting position
     C           KRSTX     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWBGWST    YL0017           Header Status L
     C                     MOVEL'A'       YL0018           Header Status
      * CHG for Unship         CH - Order Header TRG  * 
     C                     EXSR TYCHRC
     C                     ENDIF
      *================================================================
     CSR         TXEXIT    ENDSR
      /EJECT
     CSR         TYCHRC    BEGSR
      *================================================================
      * CHG for Unship         CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0584  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0585  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0586  70       Ship To Custome
     C                     MOVEL*BLANK    WN0587 30        Ship To Name
     C                     MOVEL*BLANK    WN0588 30        Ship To Address
     C                     MOVEL*BLANK    WN0589 30        Ship To Address
     C                     MOVEL*BLANK    WN0590 30        Ship To Address
     C                     MOVEL*BLANK    WN0591 20        Ship To City
     C                     MOVEL*BLANK    WN0592  2        Ship To State C
     C                     MOVEL*BLANK    WN0593 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0594  70       Bill to Custome
     C                     MOVEL*BLANK    WN0595 30        Bill to Name
     C                     MOVEL*BLANK    WN0596 30        Bill to Address
     C                     MOVEL*BLANK    WN0597 30        Bill to Address
     C                     MOVEL*BLANK    WN0598 30        Bill to Address
     C                     MOVEL*BLANK    WN0599 20        Bill to City
     C                     MOVEL*BLANK    WN0600  2        Bill to State C
     C                     MOVEL*BLANK    WN0601 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0602 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0603  70       Order Date
     C                     Z-ADD*ZERO     WN0604  70       Requested Ship
     C                     Z-ADD*ZERO     WN0605  70       Cancel Date
     C                     MOVEL*BLANK    WN0606  2        Terms Code
     C                     MOVEL*BLANK    WN0607 40        Special Instruc
     C                     MOVEL*BLANK    WN0608 40        Special Instruc
     C                     MOVEL*BLANK    WN0609  3        Carrier Code
     C                     MOVEL*BLANK    WN0610  1        Comment Print A
     C                     MOVEL*BLANK    WN0611  1        Comment Print I
     C                     MOVEL*BLANK    WN0612  1        Comment Print P
     C                     MOVEL*BLANK    WN0613  1        Comment Print S
     C                     MOVEL*BLANK    WN0614  3        Reason Code
     C                     MOVEL*BLANK    WN0615  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0616  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0617 10        User Original E
     C                     Z-ADD*ZERO     WN0618  70       Date of Origina
     C                     Z-ADD*ZERO     WN0619 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0620 112       Order Weight To
     C                     MOVEL*BLANK    WN0621  1        Credit Hold
     C                     MOVEL*BLANK    WN0622  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0623  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0624  40       Requested Deliv
     C                     MOVEL*BLANK    WN0625  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0626 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0627  70       Load ID
     C                     Z-ADD*ZERO     WN0628  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0629 112       Rated Freight
     C                     MOVEL*BLANK    WN0630  1        LTL Flag
     C                     MOVEL*BLANK    WN0631  1        Price Audit
     C                     MOVEL*BLANK    WN0632  1        Price Status
     C                     MOVEL*BLANK    WN0633  2        Shipping Method
     C                     MOVEL*BLANK    WN0634  1        Export Status
     C                     MOVEL*BLANK    WN0635  1        Palletize
     C                     MOVEL*BLANK    WN0636  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0637  1        Slip Sheet
     C                     MOVEL*BLANK    WN0638  1        Age Code
     C                     Z-ADD*ZERO     WN0639  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0640  1        Load Type
     C                     Z-ADD*ZERO     WN0641  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0642  1        Load Plan Order
     C                     MOVEL*BLANK    WN0643  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0644  70       Resell Referenc
     C                     MOVEL*BLANK    WN0645 30        Special Comment
     C                     MOVEL*BLANK    WN0646 30        Special Comment
     C                     MOVEL*BLANK    WN0647  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0648  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0649  2        Manager Level C
     C                     MOVEL*BLANK    WN0650  3        VP Level Code
     C                     Z-ADD*ZERO     WN0651  70       Attach to Order
     C                     MOVEL*BLANK    WN0652  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0653  70       Invoice Number
     C                     MOVEL*BLANK    WN0654  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0655  70       Invoice Date
     C                     MOVEL*BLANK    WN0656  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0657  1        Block Order Fla
     C                     MOVEL*BLANK    WN0658  1        Order Certifica
     C                     Z-ADD*ZERO     WN0659 112       Invoice Order V
     C                     MOVEL*BLANK    WN0660  1        Process Sts for
     C                     MOVEL*BLANK    WN0661  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0662  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0663  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0664  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0665  1        Email Cust On O
     C                     MOVEL*BLANK    WN0666  1        Order Emailed
     C                     MOVEL*BLANK    WN0667  1        Export Docs Go
     C                     MOVEL*BLANK    WN0668  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0669  1        Broker Order St
     C                     MOVEL*BLANK    WN0670  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0671  2        Order Requires
     C                     MOVEL*BLANK    WN0672  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0673  2        Export USDA App
     C                     MOVEL*BLANK    WN0674  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0675  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0676  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0677  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0678  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0679  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0680  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0681  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0682  60       Time of Origina
     C                     Z-ADD*ZERO     WN0683  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0684  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0685  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0686 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0687 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0688 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0689 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0690 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0691  70       Claim Number
     C                     MOVEL*BLANK    WN0692  1        EDI Status 1
     C                     MOVEL*BLANK    WN0693  1        EDI Status 2
     C                     MOVEL*BLANK    WN0694  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0695  60       Job Time
     C                     MOVEL*BLANK    WN0696 10        User Id
     C                     MOVEL*BLANK    WN0697 10        Job Name
     C                     Z-ADD*ZERO     WN0698  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YIRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWBAIC3    WJAIC3           Company Number
     C                     Z-ADDWBC4NB    WJC4NB           Order Number
      *
     C           KLCHTY    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJC4NB           Order Number
     C           KLCHTY    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL013.
     C                     MOVEL'LBL013'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YIRDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADD0         WJGNDT           Actual Shipped
     C                     MOVEL'N'       WJGJST    P      Order in Use
     C                     MOVELYL0018    WJGWST    P      Header Status
     C                     MOVELYL0017    WJGXST    P      Header Status L
     C                     MOVELWBXJST    WJXJST    P      Production Hold
     C                     MOVELYL0007    WJJPCD    P      Event Code
     C                     MOVELWBZ1ST    WJZ1ST    P      Modified Flag
     C                     Z-ADDWBVRVA    WJVRVA           A/R order Value
     C                     MOVELWBOBST    WJOBST    P      Billing Activit
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##PGM     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDWJAIC3    PAAIC3           Company Number
     C                     Z-ADDWJC4NB    PAC4NB           Order Number
     C                     MOVELWJJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDWJANC7    PAANC7           A/R Customer Nu
     C                     Z-ADDWJBKC7    PABKC7           Ship To Custome
     C                     MOVELWJBRTX    PABRTX    P      Ship To Name
     C                     MOVELWJHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWJHONA    PAHONA    P      Ship To Address
     C                     MOVELWJHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWJHNNA    PAHNNA    P      Ship To City
     C                     MOVELWJDBCD    PADBCD    P      Ship To State C
     C                     MOVELWJCKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDWJB0C7    PAB0C7           Bill to Custome
     C                     MOVELWJAETX    PAAETX    P      Bill to Name
     C                     MOVELWJB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWJB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWJB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWJB2NA    PAB2NA    P      Bill to City
     C                     MOVELWJBHCD    PABHCD    P      Bill to State C
     C                     MOVELWJC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELWJBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWJA0DT    PAA0DT           Order Date
     C                     Z-ADDWJA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWJGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWJACDT    PAACDT           Cancel Date
     C                     MOVELWJAQCD    PAAQCD    P      Terms Code
     C                     MOVELWJB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWJBYNA    PABYNA    P      Special Instruc
     C                     MOVELWJBZNA    PABZNA    P      Carrier Code
     C                     MOVELWJGTST    PAGTST    P      Comment Print A
     C                     MOVELWJGVST    PAGVST    P      Comment Print I
     C                     MOVELWJGUST    PAGUST    P      Comment Print P
     C                     MOVELWJQFST    PAQFST    P      Comment Print S
     C                     MOVELWJCQCD    PACQCD    P      Reason Code
     C                     MOVELWJGJST    PAGJST    P      Order in Use
     C                     MOVELWJGWST    PAGWST    P      Header Status
     C                     MOVELWJGXST    PAGXST    P      Header Status L
     C                     MOVELWJGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWJAODT    PAAODT           Scheduled Ship
     C                     MOVELWJAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWJCXDT    PACXDT           Date of Origina
     C                     Z-ADDWJJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWJA1WG    PAA1WG           Order Weight To
     C                     MOVELWJXIST    PAXIST    P      Credit Hold
     C                     MOVELWJXJST    PAXJST    P      Production Hold
     C                     MOVELWJXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWJEIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWJAFTM    PAAFTM           Requested Deliv
     C                     MOVELWJE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWJE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWJRMNB    PARMNB           Load ID
     C                     Z-ADDWJTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWJR1NB    PAR1NB           Rated Freight
     C                     MOVELWJPJST    PAPJST    P      LTL Flag
     C                     MOVELWJU0ST    PAU0ST    P      Price Audit
     C                     MOVELWJU1ST    PAU1ST    P      Price Status
     C                     MOVELWJQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWJU2ST    PAU2ST    P      Export Status
     C                     MOVELWJVEST    PAVEST    P      Palletize
     C                     MOVELWJVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWJVGST    PAVGST    P      Slip Sheet
     C                     MOVELWJRPCD    PARPCD    P      Age Code
     C                     Z-ADDWJRNNB    PARNNB           Reefer Temperat
     C                     MOVELWJVDST    PAVDST    P      Load Type
     C                     Z-ADDWJATIN    PAATIN           Attach to Invoi
     C                     MOVELWJU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWJU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWJRSRN    PARSRN           Resell Referenc
     C                     MOVELWJMHNA    PAMHNA    P      Special Comment
     C                     MOVELWJMINA    PAMINA    P      Special Comment
     C                     MOVELWJWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWJR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWJBFCD    PABFCD    P      Manager Level C
     C                     MOVELWJQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWJT3NB    PAT3NB           Attach to Order
     C                     MOVELWJSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWJCONB    PACONB           Invoice Number
     C                     MOVELWJCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWJAWDT    PAAWDT           Invoice Date
     C                     MOVELWJJPCD    PAJPCD    P      Event Code
     C                     MOVELWJXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWJZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWJVRVA    PAVRVA           A/R order Value
     C                     MOVELWJOBST    PAOBST    P      Billing Activit
     C                     MOVELWJBCST    PABCST    P      Block Order Fla
     C                     MOVELWJBDST    PABDST    P      Order Certifica
     C                     Z-ADDWJB7VL    PAB7VL           Invoice Order V
     C                     MOVELWJGASX    PAGASX    P      Process Sts for
     C                     MOVELWJGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWJGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWJGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWJFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWJFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWJFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWJFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWJFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWJFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWJFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWJFUSX    PAFUSX    P      Order Requires
     C                     MOVELWJFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWJFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWJFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWJFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWJNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWJNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWJNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWJNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWJNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWJBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWJBQTM    PABQTM           Time of Origina
     C                     Z-ADDWJBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWJBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWJBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWJH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWJH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDWJH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWJH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDWJH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWJC0C7    PAC0C7           Claim Number
     C                     MOVELWJUVST    PAUVST    P      EDI Status 1
     C                     MOVELWJUWST    PAUWST    P      EDI Status 2
     C                     MOVELWJUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWJAATM    PAAATM           Job Time
     C                     MOVELWJAYNA    PAAYNA    P      User Id
     C                     MOVELWJA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWJAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YIRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TYEXIT    ENDSR
      /EJECT
     CSR         TZCHRC    BEGSR
      *================================================================
      * CHG Load Status/ActShp CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0699  30       Company Number
     C                     MOVEL*BLANK    WN0700  1        LTL Flag
     C                     Z-ADD*ZERO     WN0701  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0702 15        Seal 1
     C                     MOVEL*BLANK    WN0703 15        Seal 2
     C                     MOVEL*BLANK    WN0704 15        Seal 3
     C                     MOVEL*BLANK    WN0705 15        Seal 4
     C                     MOVEL*BLANK    WN0706 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0707  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0708 112       Flat Amount
     C                     MOVEL*BLANK    WN0709  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0710  50       Total Stops
     C                     MOVEL*BLANK    WN0711 20        Trailer Id
     C                     MOVEL*BLANK    WN0712  3        Transloader Car
     C                     Z-ADD*ZERO     WN0713  40       BOL Time
     C                     MOVEL*BLANK    WN0714  3        Carrier Code
     C                     MOVEL*BLANK    WN0715  7        Truck Size
     C                     Z-ADD*ZERO     WN0716  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0717 112       Rated Freight
     C                     MOVEL*BLANK    WN0718  1        Ship Status
     C                     MOVEL*BLANK    WN0719  1        Load Type
     C                     Z-ADD*ZERO     WN0720  50       Number Pallets
     C                     Z-ADD*ZERO     WN0721  50       Number Pallets
     C                     Z-ADD*ZERO     WN0722 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0723  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0724  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0725  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0726 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0727 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0728  70       Actual Departur
     C                     Z-ADD*ZERO     WN0729  40       Departure Time
     C                     Z-ADD*ZERO     WN0730  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0731  52       Product Tempera
     C                     Z-ADD*ZERO     WN0732  50       Number Spacers
     C                     MOVEL*BLANK    WN0733 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0734  70       Total Load Mile
     C                     MOVEL*BLANK    WN0735 12        Recorder ID
     C                     MOVEL*BLANK    WN0736  2        Shipping Method
     C                     MOVEL*BLANK    WN0737  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0738  2        Ship To State C
     C                     Z-ADD*ZERO     WN0739  70       Gross Weight
     C                     MOVEL*BLANK    WN0740  3        Carrier Broker
     C                     MOVEL*BLANK    WN0741  1        Export Status
     C                     MOVEL*BLANK    WN0742  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0743  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0744  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0745  70       Spotted Date
     C                     Z-ADD*ZERO     WN0746  60       Spotted Time
     C                     Z-ADD*ZERO     WN0747  70       Load Finished D
     C                     Z-ADD*ZERO     WN0748  60       Load Finished T
     C                     Z-ADD*ZERO     WN0749  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0750  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0751  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0752  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0753  70       Truck Departure
     C                     Z-ADD*ZERO     WN0754  60       Truck Departure
     C                     Z-ADD*ZERO     WN0755  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0756  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0757  3        Shipping Line
     C                     MOVEL*BLANK    WN0758 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0759 30        Vessel Name
     C                     Z-ADD*ZERO     WN0760  50       Voyage
     C                     Z-ADD*ZERO     WN0761  70       Sail Date
     C                     MOVEL*BLANK    WN0762 12        Booking Number
     C                     MOVEL*BLANK    WN0763 20        Discharge Port
     C                     Z-ADD*ZERO     WN0764  70       Arrival Date
     C                     MOVEL*BLANK    WN0765 12        Container Numbe
     C                     Z-ADD*ZERO     WN0766  70       Date In
     C                     Z-ADD*ZERO     WN0767  60       Time In
     C                     Z-ADD*ZERO     WN0768  70       Date Out
     C                     Z-ADD*ZERO     WN0769  60       Time Out
     C                     Z-ADD*ZERO     WN0770 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0771  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0772  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0773  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0774  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0775  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0776  70       Requested Deliv
     C                     MOVEL*BLANK    WN0777  1        Load Acceptance
     C                     MOVEL*BLANK    WN0778  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0779  70       On Yard Date
     C                     Z-ADD*ZERO     WN0780  60       On Yard Time
     C                     Z-ADD*ZERO     WN0781  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0782  60       Deadline Depart
     C                     MOVEL*BLANK    WN0783  1        Load Held Over
     C                     MOVEL*BLANK    WN0784  1        Load Held Over
     C                     MOVEL*BLANK    WN0785 15        Load Held Over
     C                     MOVEL*BLANK    WN0786 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0787 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0788  70       Express Mail Da
     C                     MOVEL*BLANK    WN0789  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0790  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0791  70       Product Complet
     C                     Z-ADD*ZERO     WN0792  60       Product Complet
     C                     Z-ADD*ZERO     WN0793  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0794  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0795  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0796  1        Load Confirmed
     C                     MOVEL*BLANK    WN0797 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0798  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0799  60       Load Door 1
     C                     Z-ADD*ZERO     WN0800  70       Override Total
     C                     Z-ADD*ZERO     WN0801  60       Load Door 2
     C                     MOVEL*BLANK    WN0802  1        Partial Load
     C                     MOVEL*BLANK    WN0803  1        Load Confirmati
     C                     MOVEL*BLANK    WN0804  1        Export Load USD
     C                     MOVEL*BLANK    WN0805  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0806 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0807 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0808 15        Late Billing Em
     C                     MOVEL*BLANK    WN0809 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0810 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0811  1        Multi Company L
     C                     MOVEL*BLANK    WN0812  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0813  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0814  1        LH Power Only L
     C                     MOVEL*BLANK    WN0815  1        MG Created Load
     C                     MOVEL*BLANK    WN0816  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0817  2        Load U/M
     C                     MOVEL*BLANK    WN0818  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0819  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0820  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0821  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0822  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0823  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0824  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0825  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0826  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0827  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0828  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0829  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0830  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0831  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0832  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0833  60       LH Unused Time
     C                     MOVEL*BLANK    WN0834  1        EDI Status 1
     C                     MOVEL*BLANK    WN0835  1        EDI Status 2
     C                     MOVEL*BLANK    WN0836  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0837  60       Job Time
     C                     MOVEL*BLANK    WN0838 10        User Id
     C                     MOVEL*BLANK    WN0839 10        Job Name
     C                     Z-ADD*ZERO     WN0840  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YJRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWN0010    TLRMNB           Load ID
      *
     C           KLCHTZ    KLIST
     C                     KFLD           TLRMNB           Load ID
     C           KLCHTZ    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL014.
     C                     MOVEL'LBL014'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YJRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWN0009    TLAODT           Scheduled Ship
     C                     MOVEL'L'       TLPKST    P      Load Status
     C                     Z-ADD0         TLF9DT           Actual Ship Dat
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     TLAATM           Job Time
     C                     MOVEL##USR     TLAYNA           User Id
     C                     MOVEL##JOB     TLA0NA           Job Name
     C                     Z-ADD##JDT     TLAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YJRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * VALIDATE
      *================================================================
     C                     Z-ADDWAY1NX    WN0003           Company Number
     C                     Z-ADDWAZPNX    WN0004           Order Number
     C                     Z-ADDWAZGNX    WN0010           Load ID
      * RTV Order Info PFS    RT - Order Header TRG  * 
     C                     EXSR SBRVGN
      * Get 1st not cancelled line item's whse    3/30/06 RMC
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
     C                     EXSR SCRVGN
      * VAL:  Order Number
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     Z-ADD2         WN0001           PFS Process Sta
     C                     MOVEL'ORDNUM'  WN0002           PFS Error Reaso
     C                     END                             *FI
      * VAL:  Order Load ID
      * CASE: DB1.PFS Load ID NE PAR.Load ID
     C           WAZGNX    IFNE WN0010                     *IF
     C                     Z-ADD2         WN0001           PFS Process Sta
     C                     MOVEL*BLANK    WN0002           PFS Error Reaso
     C                     MOVEL'ORDLD'   WN0002           PFS Error Reaso
     C                     END                             *FI
      * VAL:  Header Status
      * CASE: PAR.Header Status is Closed or Cancelled
     C           WN0008    IFEQ 'X'                        *IF
     C           WN0008    OREQ 'C'
     C                     Z-ADD2         WN0001           PFS Process Sta
     C                     MOVEL'ORDSTS'  WN0002           PFS Error Reaso
     C                     END                             *FI
      * RTV Load Status        RT - Load Header  * 
     C                     EXSR SERVGN
      * VAL:  Load ID
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     Z-ADD2         WN0001           PFS Process Sta
     C                     MOVEL'LOADNF'  WN0002           PFS Error Reaso
     C                     END                             *FI
      * VAL:  Load Status
      * CASE: PAR.Load Status is Invoiced
     C           WN0016    IFEQ 'I'                        *IF
     C                     Z-ADD2         WN0001           PFS Process Sta
     C                     MOVEL*BLANK    WN0002           PFS Error Reaso
     C                     MOVEL'LDINV'   WN0002           PFS Error Reaso
     C                     END                             *FI
      * VAL:  Close Truck
      * CASE: DB1.PFS Ship Status is Close Truck
     C           WAVRSX    IFEQ 'CT'                       *IF
      * RTV All Ords Shipped?  RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0010    WL0001           Load ID
     C                     MOVELYL0001    WL0002    P      Status - Y or N
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0001    P      Status - Y or N
      * VAL:  All Orders Shipped
      * CASE: LCL.Status - Y or N is no
     C           YL0001    IFEQ 'N'                        *IF
     C                     Z-ADD2         WN0001           PFS Process Sta
     C                     MOVEL'ORDSHP'  WN0002           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DB1.PFS Ship Status is Order Transactions
     C           WAVRSX    IFEQ 'CO'                       *IF
     C           WAVRSX    OREQ 'PO'
     C           WAVRSX    OREQ 'UO'
     C           WAVRSX    OREQ 'UP'
      * Rtv Live w/CT LD/ORD  RT - Warehouse  * 
     C                     EXSR SHRVGN
      * VAL:  ACTIVE WAREHOUSE
      * CASE: LCL.WHS Live w/Carlisle is Yes
     C           YL0002    IFEQ 'Y'                        *IF
      * CASE: LCL.WHS PFS Interface is Upload/Both
     C           YL0003    IFEQ 'U'                        *IF
     C           YL0003    OREQ 'B'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD2         WN0001           PFS Process Sta
     C                     MOVEL'INACTV'  WN0002           PFS Error Reaso
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD2         WN0001           PFS Process Sta
     C                     MOVEL'INACTV'  WN0002           PFS Error Reaso
     C                     END                             *FI
      * VAL:  Unpick Order  - new transaction 11/17/06
      * CASE: DB1.PFS Ship Status is Unpick Order
     C           WAVRSX    IFEQ 'UP'                       *IF
      * Check Order Event = 03 = picked
      * CASE: PAR.Event Code is 03 Picked
     C           WN0011    IFEQ '03'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD2         WN0001           PFS Process Sta
     C                     MOVEL'ORDEVT'  WN0002           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ERR:  Do not Select Record
      * CASE: PAR.PFS Process Status is Error
     C           WN0001    IFEQ 2                          *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Change Log
      *================================================================
      * ** 12/17/2013 RMC C2954
      * ** Use system date/time instead of job date /time
      * 02/20/2009 LJB FP1127
      *          Order Number will be used later to retrieve the load id
      *          which will become the lot number for external, lot
      *          located, non-Carlisle controlled warehouses
      * 1/26/98  PLL C3618 Label Date problem
      *          Added Label Date parm; label date set to 1st label date
      *          on manifest rcds for a production date
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WAAID8           PFS Transaction
     C                     Z-ADD*ZERO     WAAFTS           PFS Transaction
     C                     Z-ADD*ZERO     WABCNY           PFS Transaction
     C                     Z-ADD*ZERO     WAZGNX           PFS Load ID
     C                     Z-ADD*ZERO     WAZPNX           PFS Order Numbe
     C                     Z-ADD*ZERO     WAUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WAAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WAAINY           PFS Create Time
     C                     Z-ADD*ZERO     WAAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WAAKNY           PFS Change time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A/R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WBNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WBNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WBNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WBNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WBBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WBBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WCMAVA           Billing Detail
     C                     Z-ADD*ZERO     WCKDVA           Billing Detail
     C                     Z-ADD*ZERO     WCL8VA           Billing Detail
     C                     Z-ADD*ZERO     WCL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WCAYVA           Extended Amount
     C                     Z-ADD*ZERO     WCEXDT           Market Pricing
     C                     Z-ADD*ZERO     WCBZPR           Price Overage O
     C                     Z-ADD*ZERO     WCL6NB           Contract Number
     C                     Z-ADD*ZERO     WCGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WCD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WCCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WCAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WCCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WCATWG           Weight Shipped
     C                     Z-ADD*ZERO     WCAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WCAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WCAKPR           Unit Price
     C                     Z-ADD*ZERO     WCALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WCAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WCAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WCA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCRGNB           Item Structure
     C                     Z-ADD*ZERO     WCRHNB           Item Structure
     C                     Z-ADD*ZERO     WCRINB           Item Structure
     C                     Z-ADD*ZERO     WCCXDT           Date of Origina
     C                     Z-ADD*ZERO     WCDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WCB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WCA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WCNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WCNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WCNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WCNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WCNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WCBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WCBVTM           Price Code
     C                     Z-ADD*ZERO     WCBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WCBXTM           Substitution Li
     C                     Z-ADD*ZERO     WCBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WCH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WCH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WCH7NX           OD Item Target
     C                     Z-ADD*ZERO     WCH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WCH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WCDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WCDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WCDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WCDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WCDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WCGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WCGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WCGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WCPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WCRINY           Item Age Days
     C                     Z-ADD*ZERO     WCTIDT           Production Ovr
     C                     Z-ADD*ZERO     WCTJDT           Production Ovr
     C                     Z-ADD*ZERO     WCTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WCTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WCTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WDBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WDBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WDBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WDBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WERMNB           Load ID
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WERNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WERPNB           Total Load Orde
     C                     Z-ADD*ZERO     WEFLAM           Flat Amount
     C                     Z-ADD*ZERO     WERRNB           Total Stops
     C                     Z-ADD*ZERO     WESBNB           BOL Time
     C                     Z-ADD*ZERO     WESQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WER1NB           Rated Freight
     C                     Z-ADD*ZERO     WESDNB           Number Pallets
     C                     Z-ADD*ZERO     WEPAOU           Number Pallets
     C                     Z-ADD*ZERO     WEDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WESXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WEHADT           Actual Arrival
     C                     Z-ADD*ZERO     WEAART           Actual Arrival
     C                     Z-ADD*ZERO     WEDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WEDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WEAQDT           Actual Departur
     C                     Z-ADD*ZERO     WES6NB           Departure Time
     C                     Z-ADD*ZERO     WET4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WEPRTM           Product Tempera
     C                     Z-ADD*ZERO     WENPSV           Number Spacers
     C                     Z-ADD*ZERO     WETLMI           Total Load Mile
     C                     Z-ADD*ZERO     WEGRWE           Gross Weight
     C                     Z-ADD*ZERO     WEF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WEJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WETRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WEJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WESPTM           Spotted Time
     C                     Z-ADD*ZERO     WEJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WELFTM           Load Finished T
     C                     Z-ADD*ZERO     WEJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WEBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WEJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WEBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WEKIDT           Truck Departure
     C                     Z-ADD*ZERO     WEASTM           Truck Departure
     C                     Z-ADD*ZERO     WEKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WEAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WEVOAG           Voyage
     C                     Z-ADD*ZERO     WEKBDT           Sail Date
     C                     Z-ADD*ZERO     WEEFDT           Arrival Date
     C                     Z-ADD*ZERO     WEKCDT           Date In
     C                     Z-ADD*ZERO     WETMIN           Time In
     C                     Z-ADD*ZERO     WEKDDT           Date Out
     C                     Z-ADD*ZERO     WEVMNB           Time Out
     C                     Z-ADD*ZERO     WEOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WEKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WEATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WEBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WEEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WEKKDT           On Yard Date
     C                     Z-ADD*ZERO     WEAVTM           On Yard Time
     C                     Z-ADD*ZERO     WEKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WEAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WELLDT           Express Mail Da
     C                     Z-ADD*ZERO     WEK0DT           Product Complet
     C                     Z-ADD*ZERO     WEAYTM           Product Complet
     C                     Z-ADD*ZERO     WEKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WEICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WEIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WEK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WEAZTM           Load Door 1
     C                     Z-ADD*ZERO     WEK2DT           Override Total
     C                     Z-ADD*ZERO     WEA0TM           Load Door 2
     C                     Z-ADD*ZERO     WEZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WEPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WECKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WEPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WECLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WEP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WECMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WEP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WECNTM           LH Unused Time
     C                     Z-ADD*ZERO     WEP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WECOTM           LH Unused Time
     C                     Z-ADD*ZERO     WEP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WECQTM           LH Unused Time
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFRMNB           Load ID
     C                     Z-ADD*ZERO     WFRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WFRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WFRWNB           Miles to next s
     C                     Z-ADD*ZERO     WFRXNB           Freight Charge
     C                     Z-ADD*ZERO     WFSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WFT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WFT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WFR1NB           Rated Freight
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WFSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WFKFDT           Appointment Con
     C                     Z-ADD*ZERO     WFACTM           Appointment Con
     C                     Z-ADD*ZERO     WFEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WFAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WFKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WFATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WFHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WFAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WFKKDT           On Yard Date
     C                     Z-ADD*ZERO     WFAVTM           On Yard Time
     C                     Z-ADD*ZERO     WFZ4NB           MPC Number
     C                     Z-ADD*ZERO     WFN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WFN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WFN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WFB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WFB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WFB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field #Sequence Block
     C                     MOVEL*BLANK    WUZRST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGC4NB           Order Number
     C                     Z-ADD*ZERO     WGQ2NB           Event Number
     C                     Z-ADD*ZERO     WGAUC3           Invoice/Memo Co
     C                     Z-ADD*ZERO     WGQ7NB           Invoice/Memo Nu
     C                     Z-ADD*ZERO     WGD2DT           Event Date
     C                     Z-ADD*ZERO     WGAWC3           Cross Event Ref
     C                     Z-ADD*ZERO     WGQ8NB           Cross Event Ref
     C                     Z-ADD*ZERO     WGQ9NB           Cross Event Ref
     C                     Z-ADD*ZERO     WGBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field Event Number
     C                     Z-ADD*ZERO     WUQ2NB  50
      * Clear all neither parameters
      * CRT OP Order Events    CR - OP Order Events  * 
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Text 2
     C                     MOVEL*BLANK    WUHKT1  2
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WMAID8           PFS Transaction
     C                     Z-ADD*ZERO     WMAFTS           PFS Transaction
     C                     Z-ADD*ZERO     WMBCNY           PFS Transaction
     C                     Z-ADD*ZERO     WMZPNX           PFS Order Numbe
     C                     Z-ADD*ZERO     WMZXNX           PFS Order Line
     C                     Z-ADD*ZERO     WMZYNX           PFS Substitutio
     C                     Z-ADD*ZERO     WMY2NX           PFS Item Code
     C                     Z-ADD*ZERO     WMAFD8           PFS Actual Ship
     C                     Z-ADD*ZERO     WMAUNY           PFS Shipped Qua
     C                     Z-ADD*ZERO     WMAVNY           PFS Shipped Wei
     C                     Z-ADD*ZERO     WMUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WMAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WMAINY           PFS Create Time
     C                     Z-ADD*ZERO     WMAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WMAKNY           PFS Change time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOAIC3           Company Number
     C                     Z-ADD*ZERO     WOC4NB           Order Number
     C                     Z-ADD*ZERO     WODPNB           Order Sequence
     C                     Z-ADD*ZERO     WOUENB           Order Secondary
     C                     Z-ADD*ZERO     WOALSW           Allocation Seq
     C                     Z-ADD*ZERO     WOJ6QT           OIA Alloc/Shipp
     C                     Z-ADD*ZERO     WOG9WG           OIA Alloc/Shipp
     C                     Z-ADD*ZERO     WOJ9QT           OIA Co-Packer L
     C                     Z-ADD*ZERO     WOHAWG           OIA Serial Numb
     C                     Z-ADD*ZERO     WOHGCD           Item Code
     C                     Z-ADD*ZERO     WOELDT           Production Date
     C                     Z-ADD*ZERO     WOLXNM           Lot Number
     C                     Z-ADD*ZERO     WOYNCD           Location Level
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WSAID8           PFS Transaction
     C                     Z-ADD*ZERO     WSAFTS           PFS Transaction
     C                     Z-ADD*ZERO     WSBCNY           PFS Transaction
     C                     Z-ADD*ZERO     WSZGNX           PFS Load ID
     C                     Z-ADD*ZERO     WSAQNY           PFS Actual Reef
     C                     Z-ADD*ZERO     WSBGNY           PFS Actual Prod
     C                     Z-ADD*ZERO     WSARNY           PFS Pallets Rec
     C                     Z-ADD*ZERO     WSBFNY           PFS Spacers Loa
     C                     Z-ADD*ZERO     WSAJD8           PFS BOL Complet
     C                     Z-ADD*ZERO     WSAGTS           PFS BOL Complet
     C                     Z-ADD*ZERO     WSAKD8           PFS Actual Depa
     C                     Z-ADD*ZERO     WSAHTS           PFS Actual Depa
     C                     Z-ADD*ZERO     WSASNY           PFS Pallets Loa
     C                     Z-ADD*ZERO     WSBHNY           PFS Total Palle
     C                     Z-ADD*ZERO     WSUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WSAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WSAINY           PFS Create Time
     C                     Z-ADD*ZERO     WSAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WSAKNY           PFS Change time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WXAIC3           Company Number
     C                     Z-ADD*ZERO     WXBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WXR5NB           Deliver after t
     C                     Z-ADD*ZERO     WXR6NB           Deliver before
     C                     Z-ADD*ZERO     WXTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WXMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WXW2NB           Co/Cust Overage
     C                     Z-ADD*ZERO     WXAATM           Job Time
     C                     Z-ADD*ZERO     WXAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WYAIC3           Company Number
     C                     Z-ADD*ZERO     WYC4NB           Order Number
     C                     Z-ADD*ZERO     WYDPNB           Order Sequence
     C                     Z-ADD*ZERO     WYUENB           Order Secondary
     C                     Z-ADD*ZERO     WYRZNB           Case Sequence N
     C                     Z-ADD*ZERO     WYFOQT           Case Quantity
     C                     Z-ADD*ZERO     WYR0NB           Case Weight
     C                     Z-ADD*ZERO     WYK7DT           Label Date
     C                     Z-ADD*ZERO     WYPFNX           PT Serial Numbe
     C                     Z-ADD*ZERO     WYHGCD           Item Code
     C                     Z-ADD*ZERO     WYELDT           Production Date
     C                     Z-ADD*ZERO     WYN5WG           Manifest Gross
     C                     Z-ADD*ZERO     WYH5NY           Manifest Total
     C                     Z-ADD*ZERO     WYH6NY           Manifest Co-Par
     C                     Z-ADD*ZERO     WYH7NY           Manifest Pallet
     C                     Z-ADD*ZERO     WYN6WG           HPB Meter Net G
     C                     Z-ADD*ZERO     WYN7WG           Manifest Net We
     C                     Z-ADD*ZERO     WYRBDT           Manifest Unused
     C                     Z-ADD*ZERO     WYITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WYIVNY           HPB Meter Start
     C                     Z-ADD*ZERO     WYIUNY           HPB Meter Endin
     C                     Z-ADD*ZERO     WYIWNY           HPB Meter Total
     C                     Z-ADD*ZERO     WYIXNY           HPB Meter Net W
     C                     Z-ADD*ZERO     WYIYNY           HPB Density Ref
     C                     Z-ADD*ZERO     WYAATM           Job Time
     C                     Z-ADD*ZERO     WYAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TAAIC3           Company Number
     C                     Z-ADD*ZERO     TAHGCD           Item Code
     C                     Z-ADD*ZERO     TAAWPC           Conversion Fact
     C                     Z-ADD*ZERO     TAAXPC           Conversion Fact
     C                     Z-ADD*ZERO     TAAIWG           Unit Weight
     C                     Z-ADD*ZERO     TACZWG           Minimum Weight
     C                     Z-ADD*ZERO     TAC0WG           Maximum Weight
     C                     Z-ADD*ZERO     TAURTN           Number Cases On
     C                     Z-ADD*ZERO     TAAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     TARINB           Item Structure
     C                     Z-ADD*ZERO     TARHNB           Item Structure
     C                     Z-ADD*ZERO     TARGNB           Item Structure
     C                     Z-ADD*ZERO     TATFNB           Transportation
     C                     Z-ADD*ZERO     TATMVA           Maximum Audit V
     C                     Z-ADD*ZERO     TATNVA           Minimum Audit V
     C                     Z-ADD*ZERO     TABLPR           Market Overage
     C                     Z-ADD*ZERO     TABMPR           Standard Overag
     C                     Z-ADD*ZERO     TACMCO           Item Pricing Co
     C                     Z-ADD*ZERO     TACHTM           Fresh Chilling
     C                     Z-ADD*ZERO     TASWGH           Std Weight/Head
     C                     Z-ADD*ZERO     TAPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     TAICN1           Item Category N
     C                     Z-ADD*ZERO     TAICN2           Item Category N
     C                     Z-ADD*ZERO     TAV2NB           Item Category N
     C                     Z-ADD*ZERO     TAITCN           Item Category N
     C                     Z-ADD*ZERO     TAITC5           Item Category N
     C                     Z-ADD*ZERO     TAICN6           Item Category N
     C                     Z-ADD*ZERO     TAICN7           Item Category N
     C                     Z-ADD*ZERO     TAICN8           Item Category N
     C                     Z-ADD*ZERO     TAICN9           Item Category N
     C                     Z-ADD*ZERO     TAICN0           Item Category N
     C                     Z-ADD*ZERO     TASFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     TAA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     TASJNB           Production Lead
     C                     Z-ADD*ZERO     TASKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     TASLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     TASMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     TACFNB           PM Pounds per H
     C                     Z-ADD*ZERO     TACGNB           Item Frt Overag
     C                     Z-ADD*ZERO     TAILNB           Packages per ca
     C                     Z-ADD*ZERO     TACHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     TACINB           PM Batch Size
     C                     Z-ADD*ZERO     TACJNB           Package Level s
     C                     Z-ADD*ZERO     TACMNB           Partial Item Co
     C                     Z-ADD*ZERO     TACNNB           WIP Item Code
     C                     Z-ADD*ZERO     TACRNB           WIP Reject Code
     C                     Z-ADD*ZERO     TACSNB           Std Costing Uni
     C                     Z-ADD*ZERO     TACVNB           FP Std Green We
     C                     Z-ADD*ZERO     TACWNB           PM Standard LBS
     C                     Z-ADD*ZERO     TACXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     TACZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     TAC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     TAB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     TAB5NB           PM Line Number
     C                     Z-ADD*ZERO     TABDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     TABJNB           Bags Per Unit
     C                     Z-ADD*ZERO     TAF5WG           Item Target Pri
     C                     Z-ADD*ZERO     TAF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     TAF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     TABLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     TABNNB           Production Qty
     C                     Z-ADD*ZERO     TAAATM           Job Time
     C                     Z-ADD*ZERO     TAAXDT           Job Date
      * Define work field Order Number Alpha
     C                     MOVEL*BLANK    WUE7TX  7
      * Define work field Description 14A      USR
     C                     MOVEL*BLANK    WUI6TX 14
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TBAIC3           Company Number
     C                     Z-ADD*ZERO     TBHGCD           Item Code
     C                     Z-ADD*ZERO     TBELDT           Production Date
     C                     Z-ADD*ZERO     TBABWG           Physical Count
     C                     Z-ADD*ZERO     TBAGQT           Physical Count
     C                     Z-ADD*ZERO     TBAHQT           Physical Count
     C                     Z-ADD*ZERO     TBAIQT           Physical Count
     C                     Z-ADD*ZERO     TBACWG           Quantity on Han
     C                     Z-ADD*ZERO     TBARQT           Quantity on Han
     C                     Z-ADD*ZERO     TBASQT           Quantity on Han
     C                     Z-ADD*ZERO     TBATQT           Quantity on Han
     C                     Z-ADD*ZERO     TBHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     TBHEQT           Weight In Chill
     C                     Z-ADD*ZERO     TBBMWG           Physical Start
     C                     Z-ADD*ZERO     TBDSQT           Physical Start
     C                     Z-ADD*ZERO     TBDTQT           Physical Start
     C                     Z-ADD*ZERO     TBDUQT           Physical Start
     C                     Z-ADD*ZERO     TBDHDT           Physical Start
     C                     Z-ADD*ZERO     TBAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     TBAECS           Last Cost
     C                     Z-ADD*ZERO     TBIDVA           Value of On Han
     C                     Z-ADD*ZERO     TBK7DT           Label Date
     C                     Z-ADD*ZERO     TBRINB           Item Structure
     C                     Z-ADD*ZERO     TBRHNB           Item Structure
     C                     Z-ADD*ZERO     TBRGNB           Item Structure
     C                     Z-ADD*ZERO     TBAATM           Job Time
     C                     Z-ADD*ZERO     TBAXDT           Job Date
      * Define work field LTT Unused Sts 1
     C                     MOVEL*BLANK    WULLTU  1
      * Define work field LTT Unused Sts 2
     C                     MOVEL*BLANK    WULLYT  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TEAIC3           Company Number
     C                     Z-ADD*ZERO     TEHGCD           Item Code
     C                     Z-ADD*ZERO     TELRDT           LLT Trans Date
     C                     Z-ADD*ZERO     TELLTS           LLT Sequence #
     C                     Z-ADD*ZERO     TELSDT           LLT Production
     C                     Z-ADD*ZERO     TEJ5QT           LLT Trans Qty
     C                     Z-ADD*ZERO     TEG8WG           LLT Trans Wgt
     C                     Z-ADD*ZERO     TELLTN           LLT Lot Number
     C                     Z-ADD*ZERO     TELLCL           LLT Location Le
     C                     Z-ADD*ZERO     TELLTR           LLT Transfer Lo
     C                     Z-ADD*ZERO     TELLTL           LLT Transfer Lo
     C                     Z-ADD*ZERO     TEC4NB           Order Number
     C                     Z-ADD*ZERO     TEAATM           Job Time
     C                     Z-ADD*ZERO     TEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TGAIC3           Company Number
     C                     Z-ADD*ZERO     TGHGCD           Item Code
     C                     Z-ADD*ZERO     TGELDT           Production Date
     C                     Z-ADD*ZERO     TGLXNM           Lot Number
     C                     Z-ADD*ZERO     TGYNCD           Location Level
     C                     Z-ADD*ZERO     TGJ2QT           ILL Item Qty On
     C                     Z-ADD*ZERO     TGG5WG           ILL Unit Weight
     C                     Z-ADD*ZERO     TGJ3QT           ILL Co-Packer L
     C                     Z-ADD*ZERO     TGG6WG           ILl Item Wgt On
     C                     Z-ADD*ZERO     TGJ4QT           ILL Unused Qty
     C                     Z-ADD*ZERO     TGG7WG           ILL Unused Wgt
     C                     Z-ADD*ZERO     TGLODT           ILL Avail Ship
     C                     Z-ADD*ZERO     TGLPDT           ILL Unused Date
     C                     Z-ADD*ZERO     TGLQDT           ILL Unused Date
     C                     Z-ADD*ZERO     TGNBR            ILL Unused Nbr
     C                     Z-ADD*ZERO     TGAATM           Job Time
     C                     Z-ADD*ZERO     TGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     THLCBY           Location Bay
     C                     Z-ADD*ZERO     THLCCT           Loc Unused Chil
     C                     Z-ADD*ZERO     THAATM           Job Time
     C                     Z-ADD*ZERO     THAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TISLTY           WLT Type Chill
     C                     Z-ADD*ZERO     TIAATM           Job Time
     C                     Z-ADD*ZERO     TIAXDT           Job Date
      * Define work field USR Order Value
     C                     Z-ADD*ZERO     WUJSVA 112
      * Define work field USR Order Weight
     C                     Z-ADD*ZERO     WUAYWG 112
      * Define work field USR Production
     C                     MOVEL*BLANK    WUXPST  1
      * Define work field USR Update Flag
     C                     MOVEL*BLANK    WUR4ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TMAIC3           Company Number
     C                     Z-ADD*ZERO     TMC4NB           Order Number
     C                     Z-ADD*ZERO     TMDPNB           Order Sequence
     C                     Z-ADD*ZERO     TMUENB           Order Secondary
     C                     Z-ADD*ZERO     TMDIC7           ED Item Code
     C                     Z-ADD*ZERO     TMHJWG           ED Product Net
     C                     Z-ADD*ZERO     TMHKWG           ED Product Net
     C                     Z-ADD*ZERO     TMAONX           ED Product Nbr
     C                     Z-ADD*ZERO     TMAMNX           ED Pieces per B
     C                     Z-ADD*ZERO     TMANNX           ED Bags per Uni
     C                     Z-ADD*ZERO     TMAPNX           ED Total Nbr of
     C                     Z-ADD*ZERO     TMDKPR           ED Product Unit
     C                     Z-ADD*ZERO     TMA9VL           ED Producet Ext
     C                     Z-ADD*ZERO     TMAJNX           ED Consignee Ad
     C                     Z-ADD*ZERO     TMW0DT           ED Unused Date
     C                     Z-ADD*ZERO     TMAATM           Job Time
     C                     Z-ADD*ZERO     TMAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TRAIC3           Company Number
     C                     Z-ADD*ZERO     TRHGCD           Item Code
     C                     Z-ADD*ZERO     TRB4DT           Transaction Dat
     C                     Z-ADD*ZERO     TRC4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     TRDXNB           Sequence Number
     C                     Z-ADD*ZERO     TRELDT           Production Date
     C                     Z-ADD*ZERO     TRA5QT           Transaction Qua
     C                     Z-ADD*ZERO     TRAHWG           Transaction Wei
     C                     Z-ADD*ZERO     TRAKCS           USR Transaction
     C                     Z-ADD*ZERO     TRAYVA           Extended Amount
     C                     Z-ADD*ZERO     TRCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     TRTRBN           Transfer Batch
     C                     Z-ADD*ZERO     TRTRBS           Transfer Batch
     C                     Z-ADD*ZERO     TRC4NB           Order Number
     C                     Z-ADD*ZERO     TRRINB           Item Structure
     C                     Z-ADD*ZERO     TRRHNB           Item Structure
     C                     Z-ADD*ZERO     TRRGNB           Item Structure
     C                     Z-ADD*ZERO     TRAWTM           Production Time
     C                     Z-ADD*ZERO     TRK7DT           Label Date
     C                     Z-ADD*ZERO     TRAATM           Job Time
     C                     Z-ADD*ZERO     TRAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TWAIC3           Company Number
     C                     Z-ADD*ZERO     TWM8NB           System Value Nu
     C                     Z-ADD*ZERO     TWAATM           Job Time
     C                     Z-ADD*ZERO     TWAXDT           Job Date
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0001  70
     C                     MOVEL*BLANK    WL0002  1
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  70
     C                     Z-ADD*ZERO     WL0005  50
      * Define local variables for subroutine SLCRRC.
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  70
     C                     Z-ADD*ZERO     WL0008  50
     C                     MOVEL*BLANK    WL0009  2
     C                     Z-ADD*ZERO     WL0010  30
     C                     Z-ADD*ZERO     WL0011  70
     C                     MOVEL*BLANK    WL0012  2
     C                     Z-ADD*ZERO     WL0013  70
     C                     MOVEL*BLANK    WL0014  1
     C                     MOVEL*BLANK    WL0015  1
     C                     MOVEL*BLANK    WL0016  1
     C                     Z-ADD*ZERO     WL0017  30
     C                     Z-ADD*ZERO     WL0018  70
     C                     Z-ADD*ZERO     WL0019  50
     C                     Z-ADD*ZERO     WL0020  70
      * Define local variables for subroutine SWRVGN.
     C                     Z-ADD*ZERO     WL0021  30
     C                     Z-ADD*ZERO     WL0022  70
     C                     Z-ADD*ZERO     WL0023  80
     C                     Z-ADD*ZERO     WL0024  60
      * Define local variables for subroutine SXCHRC.
     C                     Z-ADD*ZERO     WL0025  30
     C                     Z-ADD*ZERO     WL0026  80
     C                     Z-ADD*ZERO     WL0027  60
     C                     Z-ADD*ZERO     WL0028  50
     C                     Z-ADD*ZERO     WL0029  10
     C                     MOVEL*BLANK    WL0030  6
      * Define local variables for subroutine TJRVGN.
     C                     Z-ADD*ZERO     WL0031  30
     C                     Z-ADD*ZERO     WL0032  70
     C                     MOVEL*BLANK    WL0033  3
     C                     MOVEL*BLANK    WL0034  2
     C                     Z-ADD*ZERO     WL0035  70
     C                     Z-ADD*ZERO     WL0036  30
      * Define local variables for subroutine TKCRRC.
     C                     Z-ADD*ZERO     WL0037  30
     C                     Z-ADD*ZERO     WL0038  70
     C                     MOVEL*BLANK    WL0039  3
     C                     MOVEL*BLANK    WL0040  2
     C                     Z-ADD*ZERO     WL0041  70
     C                     Z-ADD*ZERO     WL0042  30
     C                     Z-ADD*ZERO     WL0043  70
     C                     Z-ADD*ZERO     WL0044  50
     C                     Z-ADD*ZERO     WL0045 112
     C                     Z-ADD*ZERO     WL0046  50
     C                     MOVEL*BLANK    WL0047  4
     C                     Z-ADD*ZERO     WL0048  20
     C                     MOVEL*BLANK    WL0049  3
     C                     Z-ADD*ZERO     WL0050  50
     C                     MOVEL*BLANK    WL0051  4
     C                     Z-ADD*ZERO     WL0052  20
     C                     Z-ADD*ZERO     WL0053  70
     C                     MOVEL*BLANK    WL0054  1
     C                     MOVEL*BLANK    WL0055  1
     C                     MOVEL*BLANK    WL0056  1
     C                     MOVEL*BLANK    WL0057  1
     C                     MOVEL*BLANK    WL0058  1
     C                     MOVEL*BLANK    WL0059  1
     C                     MOVEL*BLANK    WL0060  1
     C                     Z-ADD*ZERO     WL0061  60
     C                     MOVEL*BLANK    WL0062 10
     C                     MOVEL*BLANK    WL0063 10
     C                     Z-ADD*ZERO     WL0064  70
      * Define local variables for subroutine TLRVGN.
     C                     Z-ADD*ZERO     WL0065  30
     C                     Z-ADD*ZERO     WL0066  70
     C                     MOVEL*BLANK    WL0067  3
     C                     Z-ADD*ZERO     WL0068  70
     C                     Z-ADD*ZERO     WL0069  50
     C                     MOVEL*BLANK    WL0070  4
     C                     Z-ADD*ZERO     WL0071  20
     C                     Z-ADD*ZERO     WL0072  70
     C                     Z-ADD*ZERO     WL0073 112
      * Define local variables for subroutine TMRVGN.
     C                     MOVEL*BLANK    WL0074  3
     C                     MOVEL*BLANK    WL0075  4
     C                     MOVEL*BLANK    WL0076  1
      * Define local variables for subroutine TNRVGN.
     C                     MOVEL*BLANK    WL0077  1
     C                     Z-ADD*ZERO     WL0078  52
      * Define local variables for subroutine TORVGN.
     C                     Z-ADD*ZERO     WL0079  30
     C                     Z-ADD*ZERO     WL0080  70
     C                     Z-ADD*ZERO     WL0081 112
     C                     MOVEL*BLANK    WL0082  2
      * Define local variables for subroutine TPCRRC.
     C                     Z-ADD*ZERO     WL0083  30
     C                     Z-ADD*ZERO     WL0084  70
     C                     MOVEL*BLANK    WL0085  3
     C                     Z-ADD*ZERO     WL0086  70
     C                     Z-ADD*ZERO     WL0087  50
     C                     MOVEL*BLANK    WL0088  4
     C                     Z-ADD*ZERO     WL0089  20
     C                     Z-ADD*ZERO     WL0090  50
     C                     Z-ADD*ZERO     WL0091 112
     C                     Z-ADD*ZERO     WL0092  50
     C                     Z-ADD*ZERO     WL0093 112
     C                     Z-ADD*ZERO     WL0094  50
     C                     Z-ADD*ZERO     WL0095 112
     C                     Z-ADD*ZERO     WL0096  70
     C                     Z-ADD*ZERO     WL0097  70
     C                     Z-ADD*ZERO     WL0098  70
     C                     Z-ADD*ZERO     WL0099  72
     C                     MOVEL*BLANK    WL0100  6
     C                     MOVEL*BLANK    WL0101  1
     C                     MOVEL*BLANK    WL0102  1
     C                     MOVEL*BLANK    WL0103  1
     C                     MOVEL*BLANK    WL0104  2
     C                     MOVEL*BLANK    WL0105  3
     C                     MOVEL*BLANK    WL0106  1
     C                     MOVEL*BLANK    WL0107  1
     C                     MOVEL*BLANK    WL0108  1
     C                     MOVEL*BLANK    WL0109  1
     C                     Z-ADD*ZERO     WL0110  60
     C                     MOVEL*BLANK    WL0111 10
     C                     MOVEL*BLANK    WL0112 10
     C                     Z-ADD*ZERO     WL0113  70
      * Define local variables for subroutine TRDLRC.
     C                     Z-ADD*ZERO     WL0114  30
     C                     Z-ADD*ZERO     WL0115  70
     C                     MOVEL*BLANK    WL0116  3
     C                     Z-ADD*ZERO     WL0117  70
     C                     Z-ADD*ZERO     WL0118  50
     C                     MOVEL*BLANK    WL0119  4
     C                     Z-ADD*ZERO     WL0120  20
      * Define local variables for subroutine TSRVGN.
     C                     Z-ADD*ZERO     WL0121  30
     C                     Z-ADD*ZERO     WL0122  70
     C                     MOVEL*BLANK    WL0123  3
     C                     Z-ADD*ZERO     WL0124  70
      * Define local variables for subroutine TUCHRC.
     C                     Z-ADD*ZERO     WL0125  30
     C                     Z-ADD*ZERO     WL0126  70
     C                     Z-ADD*ZERO     WL0127  30
     C                     Z-ADD*ZERO     WL0128  30
     C                     Z-ADD*ZERO     WL0129  50
     C                     MOVEL*BLANK    WL0130  1
      * Define null work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    YN0001  1
      * Define local work field Status - Y or N
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field WHS Live w/Carlisle
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field WHS PFS Interface
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Count USR
     C                     Z-ADD*ZERO     YL0005  50
      * Define local work field Event Number
     C                     Z-ADD*ZERO     YL0006  50
      * Define local work field Event Code
     C                     MOVEL*BLANK    YL0007  2
      * Define local work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0010  30
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0011  30
      * Define local work field WHS Live w/Carlisle
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field Current System Date
     C                     Z-ADD*ZERO     YL0013 155
      * Define local work field Current System Time
     C                     Z-ADD*ZERO     YL0014 155
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0015  1
      * Define local work field Quality Level
     C                     MOVEL*BLANK    YL0016  2
      * Define local work field Header Status Last
     C                     MOVEL*BLANK    YL0017  1
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field Condition Name USR
     C                     MOVEL*BLANK    YL0019 25
      * Define local work field Office Message USR
     C                     MOVEL*BLANK    YL0020132
      * Define local work field System Value Alpha
     C                     MOVEL*BLANK    YL0021 40
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0005
00002 Unship Order
00003 UNSHIP
00004 INACTV
00005 ORDSHP
00006 PRKBILLING
