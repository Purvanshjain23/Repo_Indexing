// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PBK3XFR
// ?Date: 14.08.2025 Time: 03:48:21
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(Rtv Item Prod Limit   RT) TYPE(RTVOBJ) FILE(CABZREP)           AC1648488;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Item_Code);
PARAMETER(PAR.Base_Conv_Loss_Item);
PARAMETER(PAR.Production_Date);
PARAMETER(PAR.Production_Qty_Limit_USR);
PARAMETER(PAR.CIE_Capacity_Code);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

 EXECUTE FUNCTION(Rtv CIE Capacity Qty  RT) TYPE(RTVOBJ) FILE(PMFDREP)           AC2079750;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Item_Code);
 PARAMETER(PAR.CIE_Capacity_Code);
 PARAMETER(LCL.PS_Max_Qty_per_Day);
 {
  //?USER: Initialize routine

  //?E2885 RMC 12/9/13 new capacity field in CIE, get qty from PS Prod Cap file
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  CASE;

  // IF DB1.CIE Capacity Code is Entered
  IF DB1.CIE_Capacity_Code <> *BLANK;

  EXECUTE FUNCTION(RTV PS Prod Cap Max   RT) TYPE(RTVOBJ) FILE(PBBFREP)           AC2079751;
  PARAMETER(DB1.CIE_Capacity_Code);
  PARAMETER(PAR.PS_Max_Qty_per_Day);
  {
   //?USER: Processing if Data record not found

   MOVE *ALL (To: PAR From: CON);

   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

  }

  // PAR.CIE Capacity Code = DB1.CIE Capacity Code
  PAR.CIE_Capacity_Code = DB1.CIE_Capacity_Code;

  ENDIF;

 }

 CASE;

 // IF PAR.CIE Capacity Code is Entered
 IF PAR.CIE_Capacity_Code <> *BLANK;

 // PAR.Production Qty Limit USR = LCL.PS Max Qty per Day
 PAR.Production_Qty_Limit_USR = LCL.PS_Max_Qty_per_Day;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // PAR.Production Qty Limit USR = DB1.Production Qty /Shift
 PAR.Production_Qty_Limit_USR = DB1.Production_Qty_Per_Shift;

 ENDIF;

}


