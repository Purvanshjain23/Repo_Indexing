      *****************************************************************
      *
      *  Program number:  E1KIUPR
      *  Program name:    Insert F0911Z1 records from stage table E10911 - 1 batch
      *  Programmer:      Rose Centonze
      *  Date created:    06/17/2020
      *
      *  Program purpose: Insert F0911Z1 records from stage table E10911
      *                   Read 1 batch from E10911 records
      *                   Mark as processed
      ****************************************************************
      * MODIFICATIONS:
      ****************************************************************
      * DATE      PROGRAMMER
      *
      ****************************************************************
      *****************************************************************
      * File specifications
      ****************************************************************
     Fe10911l4  uf   e           k disk
      ****************************************************************
      * DEFINITION SPECIFICATIONS
      ****************************************************************
      *
      *---------------------------------------------------------------
      * Named Constants
     D yes             c                   'Y'
     D no              c                   'N'
     D xxamvn          c                   'GLBATCH   '
     D xxalvn          c                   'E1JIUPR   '
      *
      * Workfields for date manipulation
      *
     d xxactm          s                   like(glactm)
     D wkcymdiso       s               d   datfmt(*iso)
     D xxacdt          s                   like(glacdt)
     D xxccyymmdd      s              8  0
      /eject
      *----------------------------------------------------------------------------------
      * Mainline
      *----------------------------------------------------------------------------------
      *
      * Read records in the e10911 that are unprocessed
      *  -appropriate records seLected in Logical file
      *
     C     k0911         setll     @0911FY
     C                   dou       *in80 = *on                                  Main do
     C     k0911         reade     @0911FY                                80
     C                   if        *in80 = *off                                  If not EOF
      *
     C* Set to Interface - so world to E1 sync wont send the records over since they will be
     c* written to both systems during parallel
JEU56C                   eval      glcff1      = 'I'                             interface
      *
      * Wrte to E1 F0911Z1
      *
JEU56C                   CALL      'E1JFUPR'
JEU56C                   parm                    GLEDUS
JEU56C                   parm                    GLEDTY
JEU56C                   parm                    GLEDSQ
JEU56C                   parm                    GLEDTN
JEU56C                   parm                    GLEDCT
JEU56C                   parm                    GLEDLN
JEU56C                   parm                    GLEDTS
JEU56C                   parm                    GLEDFT
JEU56C                   parm                    GLEDDT
JEU56C                   parm                    GLEDER
JEU56C                   parm                    GLEDDL
JEU56C                   parm                    GLEDSP
JEU56C                   parm                    GLEDTC
JEU56C                   parm                    GLEDTR
JEU56C                   parm                    GLEDBT
JEU56C                   parm                    GLEDGL
JEU56C                   parm                    GLEDAN
JEU56C                   parm                    GLKCO
JEU56C                   parm                    GLDCT
JEU56C                   parm                    GLDOC
JEU56C                   parm                    GLDGJ
JEU56C                   parm                    GLJELN
JEU56C                   parm                    GLEXTL
JEU56C                   parm                    GLPOST
JEU56C                   parm                    GLICU
JEU56C                   parm                    GLICUT
JEU56C                   parm                    GLDICJ
JEU56C                   parm                    GLDSYJ
JEU56C                   parm                    GLTICU
JEU56C                   parm                    GLCO
JEU56C                   parm                    GLANI
JEU56C                   parm                    GLAM
JEU56C                   parm                    GLAID
JEU56C                   parm                    GLMCU
JEU56C                   parm                    GLOBJ
JEU56C                   parm                    GLSUB
JEU56C                   parm                    GLSBL
JEU56C                   parm                    GLSBLT
JEU56C                   parm                    GLLT
JEU56C                   parm                    GLPN
JEU56C                   parm                    GLCTRY
JEU56C                   parm                    GLFY
JEU56C                   parm                    GLFQ
JEU56C                   parm                    GLCRCD
JEU56C                   parm                    GLCRR
JEU56C                   parm                    GLHCRR
JEU56C                   parm                    GLHDGJ
JEU56C                   parm                    GLAA
JEU56C                   parm                    GLU
JEU56C                   parm                    GLUM
JEU56C                   parm                    GLGLC
JEU56C                   parm                    GLRE
JEU56C                   parm                    GLEXA
JEU56C                   parm                    GLEXR
JEU56C                   parm                    GLR1
JEU56C                   parm                    GLR2
JEU56C                   parm                    GLR3
JEU56C                   parm                    GLSFX
JEU56C                   parm                    GLODOC
JEU56C                   parm                    GLODCT
JEU56C                   parm                    GLOSFX
JEU56C                   parm                    GLPKCO
JEU56C                   parm                    GLOKCO
JEU56C                   parm                    GLPDCT
JEU56C                   parm                    GLAN8
JEU56C                   parm                    GLCN
JEU56C                   parm                    GLDKJ
JEU56C                   parm                    GLDKC
JEU56C                   parm                    GLASID
JEU56C                   parm                    GLBRE
JEU56C                   parm                    GLRCND
JEU56C                   parm                    GLSUMM
JEU56C                   parm                    GLPRGE
JEU56C                   parm                    GLTNN
JEU56C                   parm                    GLALT1
JEU56C                   parm                    GLALT2
JEU56C                   parm                    GLALT3
JEU56C                   parm                    GLALT4
JEU56C                   parm                    GLALT5
JEU56C                   parm                    GLALT6
JEU56C                   parm                    GLALT7
JEU56C                   parm                    GLALT8
JEU56C                   parm                    GLALT9
JEU56C                   parm                    GLALT0
JEU56C                   parm                    GLALTT
JEU56C                   parm                    GLALTU
JEU56C                   parm                    GLALTV
JEU56C                   parm                    GLALTW
JEU56C                   parm                    GLALTX
JEU56C                   parm                    GLALTZ
JEU56C                   parm                    GLDLNA
JEU56C                   parm                    GLCFF1
JEU56C                   parm                    GLCFF2
JEU56C                   parm                    GLASM
JEU56C                   parm                    GLBC
JEU56C                   parm                    GLVINV
JEU56C                   parm                    GLIVD                          invoice date
JEU56C                   parm                    GLWR01
JEU56C                   parm                    GLPO
JEU56C                   parm                    GLPSFX
JEU56C                   parm                    GLDCTO
JEU56C                   parm                    GLLNID
JEU56C                   parm                    GLWY
JEU56C                   parm                    GLWN
JEU56C                   parm                    GLFNLP
JEU56C                   parm                    GLOPSQ
JEU56C                   parm                    GLJBCD
JEU56C                   parm                    GLJBST
JEU56C                   parm                    GLHMCU
JEU56C                   parm                    GLDOI
JEU56C                   parm                    GLALID
JEU56C                   parm                    GLALTY
JEU56C                   parm                    GLDSVJ
JEU56C                   parm                    GLTORG
JEU56C                   parm                    GLREG#
JEU56C                   parm                    GLPYID
JEU56C                   parm                    GLUSER
JEU56C                   parm                    GLPID
JEU56C                   parm                    GLJOBN
JEU56C                   parm                    GLUPMJ
JEU56C                   parm                    GLUPMT
JEU56C                   parm                    GLCRRM
JEU56C                   parm                    GLACR
JEU56C                   parm                    GLDGM
JEU56C                   parm                    GLDGD
JEU56C                   parm                    GLDGY
JEU56C                   parm                    GLDG#
JEU56C                   parm                    GLDICM
JEU56C                   parm                    GLDICD
JEU56C                   parm                    GLDICY
JEU56C                   parm                    GLDIC#
JEU56C                   parm                    GLDSYM
JEU56C                   parm                    GLDSYD
JEU56C                   parm                    GLDSYY
JEU56C                   parm                    GLDSY#
JEU56C                   parm                    GLDKM
JEU56C                   parm                    GLDKD
JEU56C                   parm                    GLDKY
JEU56C                   parm                    GLDK#
JEU56C                   parm                    GLDSVM
JEU56C                   parm                    GLDSVD
JEU56C                   parm                    GLDSVY
JEU56C                   parm                    GLDSV#
JEU56C                   parm                    GLHDGM
JEU56C                   parm                    GLHDGD
JEU56C                   parm                    GLHDGY
JEU56C                   parm                    GLHDG#
JEU56C                   parm                    GLDKCM
JEU56C                   parm                    GLDKCD
JEU56C                   parm                    GLDKCY
JEU56C                   parm                    GLDKC#
JEU56C                   parm                    GLdim                          invoice mo
JEU56C                   parm                    GLdid                                  day
JEU56C                   parm                    GLdiy                                  year
JEU56C                   parm                    GLdi#                                  century
     c* added
     C                   parm                    GLABR1
     C                   parm                    GLABR2
     C                   parm                    GLABR3
     C                   parm                    GLABR4
     C                   parm                    GLABT1
     C                   parm                    GLABT2
     C                   parm                    GLABT3
     C                   parm                    GLABT4
     C                   parm                    GLITM
     C                   parm                    GLPM01
     C                   parm                    GLPM02
     C                   parm                    GLPM03
     C                   parm                    GLPM04
     C                   parm                    GLPM05
     C                   parm                    GLPM06
     C                   parm                    GLPM07
     C                   parm                    GLPM08
     C                   parm                    GLPM09
     C                   parm                    GLPM10
     C                   parm                    GLBCRC
     C                   parm                    GLEXR1
     C                   parm                    GLTXA1
     C                   parm                    GLTXIT
     C                   parm                    GLACTB
     C                   parm                    GLSTAM
     C                   parm                    GLCTAM
JEU56C                   parm                    GLAG                            gross amount
     C                   parm                    GLAGF
     C                   parm                    GLTKTX
     C                   parm                    GLDLNI
     C                   parm                    GLCKNU
     C                   parm                    GLBUPC
     C                   parm                    GLAHBU
     C                   parm                    GLEPGC
     C                   parm                    GLJPGC
     C                   parm                    GLRC5
     C                   parm                    GLSFXE
     C                   parm                    GLOFM
      *
JEU56C                   parm                    ERROR             1
JEU56C                   parm                    ERRid             7
JEU56C                   parm                    ERRtext          25
JEU56C*
     C                   if        error = yes
     c                   move      '2'           gledsp
JEU56C                   move      ERRid         glo6tx
JEU56C                   movel     ERRtext       glo7tx
     c                   else
     c                   move      '1'           gledsp
     c                   end
      *
     c                   z-add     xxactm        glactm
     c                   z-add     xxacdt        glacdt
     c                   movel     xxalvn        glalvn                         user
     c                   movel     xxamvn        glamvn                         pgm
      *
     c                   update    @0911FY
     c                   end
     c                   enddo
      *
     c                   seton                                        LR
      /eject
      *---------------------------------------------------------------
      * Initialization subroutine
      *---------------------------------------------------------------
      *
     C     *inzsr        begsr
      *
     c     *entry        plist
     c                   parm                    GLEDUS                        user
     c                   parm                    GLEDBT                        batch
      *
     C                   time                    xxactm
     C     *mdy          movel     udate         wkcymdiso
     C                   movel     wkcymdiso     xxccyymmdd
      *
      * Put system date into an 7,0 workfield for updating the f0911
      *
     C                   call      'HP8008'
     C                   parm                    xxccyymmdd
     C                   parm      0             xxacdt
      *
      *
     c     k0911         klist
     c                   kfld                    GLEDUS
     c                   kfld                    GLEDBT
     c                   endsr
