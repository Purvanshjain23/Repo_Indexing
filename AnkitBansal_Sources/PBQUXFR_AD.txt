// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PBQUXFR
// ?Date: 14.08.2025 Time: 03:49:02
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(Get TP Freight Rate   RT) TYPE(RTVOBJ) FILE(OMHSTPP)           AC2103315;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Shipping_Method);
PARAMETER(PAR.Shipped_Item_Code);
PARAMETER(PAR.Job_Date);
PARAMETER(PAR.Type_Code);
PARAMETER(PAR.Freight_Rate_USR);
PARAMETER(PAR.From_Date_USR);
PARAMETER(PAR.To_Date_USR);
PARAMETER(PAR.Accounting_Company);
{
 //?USER: Initialize routine

 // LCL.Weight Shipped Total = CON.*ZERO
 LCL.Weight_Shipped_Total = *ZERO;

 //?USER: Process Data record

 CASE;

 // IF DB1.Actual Shipped Date GE PAR.From Date             USR
 IF DB1.Actual_Shipped_Date >= PAR.From_Date_USR;

 // AND DB1.Actual Shipped Date LE PAR.To Date               USR
 AND DB1.Actual_Shipped_Date <= PAR.To_Date_USR;

 // AND DB1.Company Number EQ PAR.Company Number
 AND DB1.Company_Number = PAR.Company_Number;

 EXECUTE FUNCTION(RTV AbsFrtRt/Type Cde  RT) TYPE(RTVOBJ) FILE(CAEOREP)          AC1582615;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Ship_To_Customer);
 PARAMETER(PAR.Type_Code);
 PARAMETER(LCL.Absorbed_Freight_Rate_CWT);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 CASE;

 // IF DB1.Commodity Market Code is Prior Week 3rd Party Avg
 IF DB1.Commodity_Market_Code = 'TPA';

 // IF *OTHERWISE
 IF *OTHERWISE;

 // LCL.Transfer Price USR = CON.*ZERO
 LCL.Transfer_Price_USR = *ZERO;

 // PAR.Freight Rate USR = LCL.Absorbed Freight Rate CWT / CON.100 *
 PAR.Freight_Rate_USR = LCL.Absorbed_Freight_Rate_CWT / 100;

 EXECUTE FUNCTION(Rtv Acct Co          RT) TYPE(RTVOBJ) FILE(CAADREP)            AC1802492;
 PARAMETER(DB1.Warehouse_Code);
 PARAMETER(PAR.Accounting_Company);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 ENDIF;

 ENDIF;

 // PAR.Shipping Method = DB1.Shipping Method
 PAR.Shipping_Method = DB1.Shipping_Method;

}


