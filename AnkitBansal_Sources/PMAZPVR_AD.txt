// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PMAZPVR
// ?Date: 14.08.2025 Time: 03:44:38
// ?------------------------------------------------------------------------------------------------

//?USER: Load screen

//?Load Screen Fields
DO;

MOVE *ALL (To: DTL From: PAR);

// DTL.Status - Y or N = CND.yes
DTL.Status_Y_or_N = 'Y';

EXECUTE FUNCTION(RTV Company Name       RT) TYPE(RTVOBJ) FILE(CAABREP)          AC1255767;
PARAMETER(DTL.Company_Number);
PARAMETER(DTL.USR_Company_Name);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


//?5/23/02 Fax to Dispatch office
// DTL.Status Flag 1  Y/N = CND.No
DTL.Status_Flag_1_Y_N = 'N';

ENDDO;

//?USER: Process command keys

CASE;

// IF DTL.*CMD key is *Exit
IF DTL.*CMD_key = '03';

PGM.*Return_code = 'Y2U9999';

RETURN;

ENDIF;

//?USER: User defined action

//?Fax is Yes
CASE;

// IF DTL.Status - Y or N is yes
IF DTL.Status_Y_or_N = 'Y';

// OR DTL.Status Flag 1  Y/N is Yes
OR DTL.Status_Flag_1_Y_N = 'Y';

// PAR.FAX DTL Status 1 = DTL.Status - Y or N
PAR.FAX_DTL_Status_1 = DTL.Status_Y_or_N;

// PAR.FAX DTL Status 2 = DTL.Status Flag 1  Y/N
PAR.FAX_DTL_Status_2 = DTL.Status_Flag_1_Y_N;

//?** Fax Processing
CASE;

// IF PGM.*Return code is *Normal
IF PGM.*Return_code = *BLANK;

// PAR.Company Number Pass   USR = PAR.Company Number
PAR.Company_Number_Pass_USR = PAR.Company_Number;

// PAR.Order Number 1  PASS  USR = PAR.Load ID
PAR.Order_Number_1_PASS_USR = PAR.Load_ID;

EXECUTE FUNCTION(EXC Load Confirm Fax   IF) TYPE(EXCINTFUN)                     AC1595755;
PARAMETER(PAR.Company_Number_Pass_USR);
PARAMETER(PAR.Order_Number_1_PASS_USR);
PARAMETER(DTL.Transloader_Carrier_Code);
PARAMETER(DTL.Carrier_Code);
PARAMETER(DTL.Shipping_Line);
PARAMETER(LCL.OHE_Carrier_SCAC_Code);
PARAMETER(DTL.Status_Flag_1_Y_N);
PARAMETER(LCL.Status_Flag_2_Y_N);
PARAMETER(LCL.Status_Flag_3_Y_N);
PARAMETER(LCL.Status_Flag_4_Y_N);
PARAMETER(LCL.Status_Flag_5_Y_N);
PARAMETER(DTL.Status_Y_or_N);
PARAMETER(*BLANK);
PARAMETER(LCL.USR_Status_Y_N);
PARAMETER(*BLANK);
PARAMETER(*BLANK);
PARAMETER(*NO);
PARAMETER(*NO);
PARAMETER(LCL.PRT_Night_Queue_Run_Sts);
PARAMETER(*BLANK);
PARAMETER(*ZERO);
PARAMETER(*BLANK);
{
 //?Execute internal function

 //?** See comments for explanation of parms.
 // Call program PRC Submit Fax Load Cn UP.
 CALL PROGRAM(PRC Submit Fax Load Cn UP) ('PDVVUPC');
 PARAMETER(WRK.Return_Code_Usr);
 PARAMETER(PAR.Company_Number_Pass_USR);
 PARAMETER(PAR.Order_Number_1_PASS_USR);
 PARAMETER(PAR.Transloader_Carrier_Code);
 PARAMETER(PAR.Carrier_Code);
 PARAMETER(PAR.Shipping_Line);
 PARAMETER(PAR.OHE_Carrier_SCAC_Code);
 PARAMETER(PAR.Status_Flag_1_Y_N);
 PARAMETER(PAR.Status_Flag_2_Y_N);
 PARAMETER(PAR.Status_Flag_3_Y_N);
 PARAMETER(PAR.Status_Flag_4_Y_N);
 PARAMETER(PAR.Status_Flag_5_Y_N);
 PARAMETER(PAR.Status_Y_or_N);
 PARAMETER(PAR.Status_Description_3_USR);
 PARAMETER(PAR.USR_Status_Y_N);
 PARAMETER(PAR.PRT_Printer_Device);
 PARAMETER(PAR.PRT_Hold_Output_Sts);
 PARAMETER(PAR.PRT_Save_Output_Sts);
 PARAMETER(PAR.System_Value_Numeric);
 PARAMETER(PAR.Email_Address);

 //?***** Change Log and Comments
 DO;

 //?*****
 //?** 04/24/2011 LJB P000737
 //?** Pgm PODPUPR replaced with PDVVUPC. Parms changed to either
 //?** Print Only or Fax/Email to all carriers that are passed in.
 //?** *** Parms are:
 //?** Status-Y or N = Fax Carrier, Status Flag 1 Y/N=Fax Dispatcher,
 //?** Status Flag 2 Y/N=Fax Transloader, Status Flag 3 Y/N=Fax Mexican,
 //?** Status Flag 4 Y/N=Fax Exp Coordn, Status Flag 5 Y/N=Fax Ocean Shpr,
 //?** Usr Status (Y/N)=Print Only/Fax, Status Description 3=Printer file
 //?*****
 ENDDO;

}


// Send information message - 'Selected Load(s) have been faxed/emailed to carrier.'
MESSAGE(USR2445 *INFO);

ENDIF;

ENDIF;

