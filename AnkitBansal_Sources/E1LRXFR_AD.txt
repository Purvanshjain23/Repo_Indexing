// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for E1LRXFR
// ?Date: 14.08.2025 Time: 02:43:47
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?Modification history
DO;

//? 7/22/2020 JBB SDN465 - JDE World to JDE Enterprise 1
//?                        Function created.  This function reads the
//?                        Run Log Header Workfile in QTEMP and
//?                        concatenates each Batch Number into a large
//?                        field that is passed to CL program E1LSUCL
//?                        that sends an email to a Distribution List
//?                        with all of the Batch Numbers in the body
//?                        of the email.
ENDDO;

//?Read all records in the Run Log Header Workfile
EXECUTE FUNCTION(Exc Email Batch Nbrs  RT) TYPE(RTVOBJ) FILE(E1B9CPP)           AA1103491;
PARAMETER(PAR.Batch_Source);
PARAMETER(PAR.Batch_Description);
PARAMETER(PAR.Batch_Message_Recipient);
PARAMETER(PAR.Batch_Email_Subject);
{
 //?USER: Initialize routine

 // LCL.Message 500 = CON.*BLANK
 LCL.Message_500 = *BLANK;

 // LCL.Batch Number Index = CON.1
 LCL.Batch_Number_Index = 1;

 //?USER: Process Data record

 //?When Batch Number changes, add it to the message
 CASE;

 // IF DB1.Batch Number NE LCL.Batch Number
 IF DB1.Batch_Number <> LCL.Batch_Number;

 // LCL.Batch Alpha 8 = CVTVAR(DB1.Batch Number)
 LCL.Batch_Alpha_8 = CVTVAR(DB1.Batch_Number);

 // LCL.Message 500 = CONCAT(LCL.Message 500,LCL.Batch Alpha 8,CND.*One)
 LCL.Message_500 = LCL.Message_500 + LCL.Batch_Alpha_8 (1);

 ENDIF;

 //?USER: Exit processing

 //?If Message is not blank, send an email
 CASE;

 // IF LCL.Message 500 is Not Blank
 IF LCL.Message_500 <> *BLANK;

 // Call program Exc Email Batch Nbrs  CL.
 CALL PROGRAM(Exc Email Batch Nbrs  CL) ('E1LSUCL');
 PARAMETER(LCL.Message_500);
 PARAMETER(PAR.Batch_Source);
 PARAMETER(PAR.Batch_Description);
 PARAMETER(PAR.Batch_Message_Recipient);
 PARAMETER(PAR.Batch_Email_Subject);

 ENDIF;

}


