     H/TITLE Rtv Boning/Export Cls XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : 2E  Version:  1181
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 02/22/07  Time  : 15:59:20
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Company Item
      * I :  Quality Level
     I                                        1   2 P1HICD
      * I :  Item Structure Class Code
     I                                    P   3   40P1RINB
      * I :  Item Structure Group Code
     I                                    P   5   60P1RHNB
      * I :  Item Structure Type Code
     I                                    P   7   80P1RGNB
     IP2PARM      DS
      * O :  BoneIn/Boneless
     I                                        1   2 P2MESX
     IP3PARM      DS
      * O :  Export/Domestic
     I                                        1   1 P3SUST
     IP4PARM      DS
      * O :  PFS Item Primal Group
     I                                        1   1 P4Y0SX
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HICD    PARM           WP0001  2        Quality Level
     C           P1RINB    PARM           WP0002  30       Item Structure
     C           P1RHNB    PARM           WP0003  30       Item Structure
     C           P1RGNB    PARM           WP0004  30       Item Structure
     C           P2MESX    PARM P2MESX    WP0005  2        BoneIn/Boneless
     C           P3SUST    PARM P3SUST    WP0006  1        Export/Domestic
     C           P4Y0SX    PARM P4Y0SX    WP0007  1        PFS Item Primal
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Rtv Boning/Export Cls XF
      * Export/Domestic
      * CASE: PAR.Quality Level is Quality Export
     C           P1HICD    IFEQ '01'                       *IF
     C                     MOVEL'E'       P3SUST           Export/Domestic
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'D'       P3SUST           Export/Domestic
     C                     END                             *FI
     C                     MOVELWUGSTX    P2MESX           BoneIn/Boneless
     C                     MOVEL*BLANK    P4Y0SX           PFS Item Primal
      * Bone-In/Boneless & Item Primal Group
      * CASE: PAR.Item Structure Type Code is Loin
     C           P1RGNB    IFEQ 200                        *IF
      * Bone-In & Boneless Loin
      * CASE: Bone-In Loin Group = 210/220/230
      *  - c1 OR c2 OR c3
      *   |- c1    : PAR.Item Structure Group Code is Loin Bone-In
      *   |- c2    : PAR.Item Structure Group Code is Loin Bone In Center
      *   |- c3    : PAR.Item Structure Group Code is Loin Bone In Bladel
      *   '-
     C           P1RHNB    IFEQ 210                        *IF
     C           P1RHNB    OREQ 220                        *OR
     C           P1RHNB    OREQ 230                        *OR
      * BONE-IN Class = 211/212
      * CASE: Class = 211/212
      *  - c1 OR c2
      *   |- c1    : PAR.Item Structure Class Code is Base 22 & Down
      *   |- c2    : PAR.Item Structure Class Code is Base 22 & Up
      *   '-
     C           P1RINB    IFEQ 211                        *IF
     C           P1RINB    OREQ 212                        *OR
     C                     MOVEL'L'       P4Y0SX           PFS Item Primal
     C                     MOVEL'BI'      P2MESX           BoneIn/Boneless
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Item Structure Group Code is WIP - CUT
     C           P1RHNB    IFEQ 998                        *IF
      * BONE-IN Class = 261/900
      * CASE: Class = 261/900
      *  - c1 OR c2
      *   |- c1    : PAR.Item Structure Class Code is Chops
      *   |- c2    : PAR.Item Structure Class Code is Pumped
      *   '-
     C           P1RINB    IFEQ 261                        *IF
     C           P1RINB    OREQ 900                        *OR
     C                     MOVEL'L'       P4Y0SX           PFS Item Primal
     C                     MOVEL'BI'      P2MESX           BoneIn/Boneless
     C                     END                             *FI
     C                     ELSE
      * CASE: Boneless Loin Group = 240/250
      *  - c1 OR c2
      *   |- c1    : PAR.Item Structure Group Code is Loin Bone less Stra
      *   |- c2    : PAR.Item Structure Group Code is Loin Bone less Stra
      *   '-
     C           P1RHNB    IFEQ 240                        *IF
     C           P1RHNB    OREQ 250                        *OR
      * BONELESS Class = 241/251
      * CASE: Class = 241/251
      *  - c1 OR c2
      *   |- c1    : PAR.Item Structure Class Code is BL Strap On
      *   |- c2    : PAR.Item Structure Class Code is BL Strap Off
      *   '-
     C           P1RINB    IFEQ 241                        *IF
     C           P1RINB    OREQ 251                        *OR
     C                     MOVEL'L'       P4Y0SX           PFS Item Primal
     C                     MOVEL'BL'      P2MESX           BoneIn/Boneless
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Item Structure Group Code is WIP - Converting
     C           P1RHNB    IFEQ 999                        *IF
      * BONELESS Class = 241/251
      * CASE: Class = 241/251
      *  - c1 OR c2
      *   |- c1    : PAR.Item Structure Class Code is BL Strap On
      *   |- c2    : PAR.Item Structure Class Code is BL Strap Off
      *   '-
     C           P1RINB    IFEQ 241                        *IF
     C           P1RINB    OREQ 251                        *OR
     C                     MOVEL'L'       P4Y0SX           PFS Item Primal
     C                     MOVEL'BL'      P2MESX           BoneIn/Boneless
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Boneless Tenders
      * CASE: Boneless Tenders Group = 850/999
      *  - c1 OR c2
      *   |- c1    : PAR.Item Structure Group Code is Credit Items
      *   |- c2    : PAR.Item Structure Group Code is WIP - Converting
      *   '-
     C           P1RHNB    IFEQ 850                        *IF
     C           P1RHNB    OREQ 999                        *OR
      * BONELESS Class = 852
      * CASE: PAR.Item Structure Class Code is Tenders
     C           P1RINB    IFEQ 852                        *IF
     C                     MOVEL'T'       P4Y0SX           PFS Item Primal
     C                     MOVEL'BL'      P2MESX           BoneIn/Boneless
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
