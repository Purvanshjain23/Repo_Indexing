     H/TITLE PFS Unlock Load/Order XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 07/12/19  Time  : 10:55:15
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPPBACPL2IF  E           K        DISK
      * RSQ : PFS Load Header           Load/Company
      *
     FPPBBCPL2IF  E           K        DISK
      * RSQ : PFS Order Header          Load/Co/Ord
      *
     FPPBCCPL1IF  E           K        DISK
      * RTV : PFS Order Detail          Retrieval index
      *
     FPPBDCPL1IF  E           K        DISK
      * RTV : PFS Order BOL Comment     Retrieval index
      *
     FPPBCCPL0UF  E           K        DISK
      * UPD : PFS Order Detail          Update index
      *
     FPPBDCPL0UF  E           K        DISK
      * UPD : PFS Order BOL Comment     Update index
      *
     FPPBBCPL0UF  E           K        DISK
      * UPD : PFS Order Header          Update index
      *
     FPPBACPL0UF  E           K        DISK
      * UPD : PFS Load Header           Update index
      *
     I@BACPAG
      * PFS Load Header           Load/Company
      * Renamed input format fields
     I              BAY1NX                          WAY1NX
     I              BAZGNX                          WAZGNX
     I              BAAWNY                          WAAWNY
     I              BAF4AA                          WAF4AA
     I              BAFQT1                          WAFQT1
     I              BAVBSX                          WAVBSX
     I              BAF5AA                          WAF5AA
     I              BAFRT1                          WAFRT1
     I              BAFST1                          WAFST1
     I              BAFTT1                          WAFTT1
     I              BAFUT1                          WAFUT1
     I              BAFVT1                          WAFVT1
     I              BAFWT1                          WAFWT1
     I              BAFXT1                          WAFXT1
     I              BAZLNX                          WAZLNX
     I              BAF7AA                          WAF7AA
     I              BAF6AA                          WAF6AA
     I              BAU7SX                          WAU7SX
     I              BAU9SX                          WAU9SX
     I              BAVASX                          WAVASX
     I              BAZMNX                          WAZMNX
     I              BAZNNX                          WAZNNX
     I              BAZONX                          WAZONX
     I              BAU8SX                          WAU8SX
     I              BAZHNX                          WAZHNX
     I              BAZINX                          WAZINX
     I              BAZJNX                          WAZJNX
     I              BAZKNX                          WAZKNX
     I              BABLNY                          WABLNY
     I              BAFYT1                          WAFYT1
     I              BABKNY                          WABKNY
     I              BAATNY                          WAATNY
     I              BAB4NY                          WAB4NY
     I              BAY7SX                          WAY7SX
     I              BAHST1                          WAHST1
     I              BAF5NY                          WAF5NY
     I              BAY8SX                          WAY8SX
     I              BAY9SX                          WAY9SX
     I              BAZASX                          WAZASX
     I              BAZBSX                          WAZBSX
     I              BAZCSX                          WAZCSX
     I              BAMWU1                          WAMWU1
     I              BAUWSX                          WAUWSX
     I              BAUXSX                          WAUXSX
     I              BAV3SX                          WAV3SX
     I              BAAHNY                          WAAHNY
     I              BAAINY                          WAAINY
     I              BAAJNY                          WAAJNY
     I              BAAKNY                          WAAKNY
      *
     I@BBCPAH
      * PFS Order Header          Load/Co/Ord
      * Renamed input format fields
     I              BBY1NX                          WBY1NX
     I              BBZPNX                          WBZPNX
     I              BBZGNX                          WBZGNX
     I              BBZWNX                          WBZWNX
     I              BBZVNX                          WBZVNX
     I              BBVCSX                          WBVCSX
     I              BBZQNX                          WBZQNX
     I              BBF0T1                          WBF0T1
     I              BBF1T1                          WBF1T1
     I              BBF2T1                          WBF2T1
     I              BBGUT1                          WBGUT1
     I              BBF3T1                          WBF3T1
     I              BBF4T1                          WBF4T1
     I              BBF5T1                          WBF5T1
     I              BBF6T1                          WBF6T1
     I              BBF7T1                          WBF7T1
     I              BBZENX                          WBZENX
     I              BBF8T1                          WBF8T1
     I              BBF9T1                          WBF9T1
     I              BBGAT1                          WBGAT1
     I              BBGVT1                          WBGVT1
     I              BBGBT1                          WBGBT1
     I              BBGCT1                          WBGCT1
     I              BBGDT1                          WBGDT1
     I              BBFZT1                          WBFZT1
     I              BBZRNX                          WBZRNX
     I              BBZSNX                          WBZSNX
     I              BBZTNX                          WBZTNX
     I              BBZUNX                          WBZUNX
     I              BBVBSX                          WBVBSX
     I              BBU3SX                          WBU3SX
     I              BBGET1                          WBGET1
     I              BBGFT1                          WBGFT1
     I              BBA1NY                          WBA1NY
     I              BBBKNY                          WBBKNY
     I              BBATNY                          WBATNY
     I              BBVESX                          WBVESX
     I              BBF8AA                          WBF8AA
     I              BBF9AA                          WBF9AA
     I              BBC5NY                          WBC5NY
     I              BBF5NY                          WBF5NY
     I              BBF5AA                          WBF5AA
     I              BBFRT1                          WBFRT1
     I              BBFST1                          WBFST1
     I              BBFTT1                          WBFTT1
     I              BBFUT1                          WBFUT1
     I              BBFVT1                          WBFVT1
     I              BBFWT1                          WBFWT1
     I              BBFXT1                          WBFXT1
     I              BBZLNX                          WBZLNX
     I              BBF7AA                          WBF7AA
     I              BBF6AA                          WBF6AA
     I              BBS6NA                          WBS6NA
     I              BBZDSX                          WBZDSX
     I              BBZESX                          WBZESX
     I              BBZFSX                          WBZFSX
     I              BBZGSX                          WBZGSX
     I              BBZHSX                          WBZHSX
     I              BBMXU1                          WBMXU1
     I              BBUWSX                          WBUWSX
     I              BBUXSX                          WBUXSX
     I              BBV3SX                          WBV3SX
     I              BBAHNY                          WBAHNY
     I              BBAINY                          WBAINY
     I              BBAJNY                          WBAJNY
     I              BBAKNY                          WBAKNY
      *
     I@BCCPZP
      * PFS Order Detail          Retrieval index
      * Renamed input format fields
     I              BCY1NX                          WCY1NX
     I              BCZPNX                          WCZPNX
     I              BCZXNX                          WCZXNX
     I              BCZYNX                          WCZYNX
     I              BCY2NX                          WCY2NX
     I              BCGIT1                          WCGIT1
     I              BCGGT1                          WCGGT1
     I              BCGHT1                          WCGHT1
     I              BCVFSX                          WCVFSX
     I              BCVGSX                          WCVGSX
     I              BCVHSX                          WCVHSX
     I              BCVISX                          WCVISX
     I              BCF8AA                          WCF8AA
     I              BCV4SX                          WCV4SX
     I              BCF9AA                          WCF9AA
     I              BCZFNX                          WCZFNX
     I              BCZZNX                          WCZZNX
     I              BCZ0NX                          WCZ0NX
     I              BCBINY                          WCBINY
     I              BCBJNY                          WCBJNY
     I              BCBKNY                          WCBKNY
     I              BCATNY                          WCATNY
     I              BCALD8                          WCALD8
     I              BCAMD8                          WCAMD8
     I              BCF5NY                          WCF5NY
     I              BCZISX                          WCZISX
     I              BCZJSX                          WCZJSX
     I              BCZKSX                          WCZKSX
     I              BCZLSX                          WCZLSX
     I              BCZMSX                          WCZMSX
     I              BCUWSX                          WCUWSX
     I              BCUXSX                          WCUXSX
     I              BCV3SX                          WCV3SX
     I              BCAHNY                          WCAHNY
     I              BCAINY                          WCAINY
     I              BCAJNY                          WCAJNY
     I              BCAKNY                          WCAKNY
      *
     I@BCCPZO
      * PFS Order Detail          Update index
      * Renamed input format fields
     I              BCY1NX                          WDY1NX
     I              BCZPNX                          WDZPNX
     I              BCZXNX                          WDZXNX
     I              BCZYNX                          WDZYNX
     I              BCY2NX                          WDY2NX
     I              BCGIT1                          WDGIT1
     I              BCGGT1                          WDGGT1
     I              BCGHT1                          WDGHT1
     I              BCVFSX                          WDVFSX
     I              BCVGSX                          WDVGSX
     I              BCVHSX                          WDVHSX
     I              BCVISX                          WDVISX
     I              BCF8AA                          WDF8AA
     I              BCV4SX                          WDV4SX
     I              BCF9AA                          WDF9AA
     I              BCZFNX                          WDZFNX
     I              BCZZNX                          WDZZNX
     I              BCZ0NX                          WDZ0NX
     I              BCBINY                          WDBINY
     I              BCBJNY                          WDBJNY
     I              BCBKNY                          WDBKNY
     I              BCATNY                          WDATNY
     I              BCALD8                          WDALD8
     I              BCAMD8                          WDAMD8
     I              BCF5NY                          WDF5NY
     I              BCZISX                          WDZISX
     I              BCZJSX                          WDZJSX
     I              BCZKSX                          WDZKSX
     I              BCZLSX                          WDZLSX
     I              BCZMSX                          WDZMSX
     I              BCUWSX                          WDUWSX
     I              BCUXSX                          WDUXSX
     I              BCV3SX                          WDV3SX
     I              BCAHNY                          WDAHNY
     I              BCAINY                          WDAINY
     I              BCAJNY                          WDAJNY
     I              BCAKNY                          WDAKNY
      *
     I@BDCPAB
      * PFS Order BOL Comment     Retrieval index
      * Renamed input format fields
     I              BDY1NX                          WEY1NX
     I              BDZPNX                          WEZPNX
     I              BDIZST                          WEIZST
     I              BDZ1NX                          WEZ1NX
     I              BDGJT1                          WEGJT1
     I              BDUWSX                          WEUWSX
     I              BDUXSX                          WEUXSX
     I              BDV3SX                          WEV3SX
     I              BDAHNY                          WEAHNY
     I              BDAINY                          WEAINY
     I              BDAJNY                          WEAJNY
     I              BDAKNY                          WEAKNY
      *
     I@BDCPAA
      * PFS Order BOL Comment     Update index
      * Renamed input format fields
     I              BDY1NX                          WFY1NX
     I              BDZPNX                          WFZPNX
     I              BDIZST                          WFIZST
     I              BDZ1NX                          WFZ1NX
     I              BDGJT1                          WFGJT1
     I              BDUWSX                          WFUWSX
     I              BDUXSX                          WFUXSX
     I              BDV3SX                          WFV3SX
     I              BDAHNY                          WFAHNY
     I              BDAINY                          WFAINY
     I              BDAJNY                          WFAJNY
     I              BDAKNY                          WFAKNY
      *
     I@BBCPZR
      * PFS Order Header          Update index
      * Renamed input format fields
     I              BBY1NX                          WGY1NX
     I              BBZPNX                          WGZPNX
     I              BBZGNX                          WGZGNX
     I              BBZWNX                          WGZWNX
     I              BBZVNX                          WGZVNX
     I              BBVCSX                          WGVCSX
     I              BBZQNX                          WGZQNX
     I              BBF0T1                          WGF0T1
     I              BBF1T1                          WGF1T1
     I              BBF2T1                          WGF2T1
     I              BBGUT1                          WGGUT1
     I              BBF3T1                          WGF3T1
     I              BBF4T1                          WGF4T1
     I              BBF5T1                          WGF5T1
     I              BBF6T1                          WGF6T1
     I              BBF7T1                          WGF7T1
     I              BBZENX                          WGZENX
     I              BBF8T1                          WGF8T1
     I              BBF9T1                          WGF9T1
     I              BBGAT1                          WGGAT1
     I              BBGVT1                          WGGVT1
     I              BBGBT1                          WGGBT1
     I              BBGCT1                          WGGCT1
     I              BBGDT1                          WGGDT1
     I              BBFZT1                          WGFZT1
     I              BBZRNX                          WGZRNX
     I              BBZSNX                          WGZSNX
     I              BBZTNX                          WGZTNX
     I              BBZUNX                          WGZUNX
     I              BBVBSX                          WGVBSX
     I              BBU3SX                          WGU3SX
     I              BBGET1                          WGGET1
     I              BBGFT1                          WGGFT1
     I              BBA1NY                          WGA1NY
     I              BBBKNY                          WGBKNY
     I              BBATNY                          WGATNY
     I              BBVESX                          WGVESX
     I              BBF8AA                          WGF8AA
     I              BBF9AA                          WGF9AA
     I              BBC5NY                          WGC5NY
     I              BBF5NY                          WGF5NY
     I              BBF5AA                          WGF5AA
     I              BBFRT1                          WGFRT1
     I              BBFST1                          WGFST1
     I              BBFTT1                          WGFTT1
     I              BBFUT1                          WGFUT1
     I              BBFVT1                          WGFVT1
     I              BBFWT1                          WGFWT1
     I              BBFXT1                          WGFXT1
     I              BBZLNX                          WGZLNX
     I              BBF7AA                          WGF7AA
     I              BBF6AA                          WGF6AA
     I              BBS6NA                          WGS6NA
     I              BBZDSX                          WGZDSX
     I              BBZESX                          WGZESX
     I              BBZFSX                          WGZFSX
     I              BBZGSX                          WGZGSX
     I              BBZHSX                          WGZHSX
     I              BBMXU1                          WGMXU1
     I              BBUWSX                          WGUWSX
     I              BBUXSX                          WGUXSX
     I              BBV3SX                          WGV3SX
     I              BBAHNY                          WGAHNY
     I              BBAINY                          WGAINY
     I              BBAJNY                          WGAJNY
     I              BBAKNY                          WGAKNY
      *
     I@BACPZI
      * PFS Load Header           Update index
      * Renamed input format fields
     I              BAY1NX                          WHY1NX
     I              BAZGNX                          WHZGNX
     I              BAAWNY                          WHAWNY
     I              BAF4AA                          WHF4AA
     I              BAFQT1                          WHFQT1
     I              BAVBSX                          WHVBSX
     I              BAF5AA                          WHF5AA
     I              BAFRT1                          WHFRT1
     I              BAFST1                          WHFST1
     I              BAFTT1                          WHFTT1
     I              BAFUT1                          WHFUT1
     I              BAFVT1                          WHFVT1
     I              BAFWT1                          WHFWT1
     I              BAFXT1                          WHFXT1
     I              BAZLNX                          WHZLNX
     I              BAF7AA                          WHF7AA
     I              BAF6AA                          WHF6AA
     I              BAU7SX                          WHU7SX
     I              BAU9SX                          WHU9SX
     I              BAVASX                          WHVASX
     I              BAZMNX                          WHZMNX
     I              BAZNNX                          WHZNNX
     I              BAZONX                          WHZONX
     I              BAU8SX                          WHU8SX
     I              BAZHNX                          WHZHNX
     I              BAZINX                          WHZINX
     I              BAZJNX                          WHZJNX
     I              BAZKNX                          WHZKNX
     I              BABLNY                          WHBLNY
     I              BAFYT1                          WHFYT1
     I              BABKNY                          WHBKNY
     I              BAATNY                          WHATNY
     I              BAB4NY                          WHB4NY
     I              BAY7SX                          WHY7SX
     I              BAHST1                          WHHST1
     I              BAF5NY                          WHF5NY
     I              BAY8SX                          WHY8SX
     I              BAY9SX                          WHY9SX
     I              BAZASX                          WHZASX
     I              BAZBSX                          WHZBSX
     I              BAZCSX                          WHZCSX
     I              BAMWU1                          WHMWU1
     I              BAUWSX                          WHUWSX
     I              BAUXSX                          WHUXSX
     I              BAV3SX                          WHV3SX
     I              BAAHNY                          WHAHNY
     I              BAAINY                          WHAINY
     I              BAAJNY                          WHAJNY
     I              BAAKNY                          WHAKNY
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPPBC1    E DSPPBCCPL0
      * UPD : PFS Order Detail          Update index
      * Renamed input format fields
     I              BCY1NX                          WDY1NX
     I              BCZPNX                          WDZPNX
     I              BCZXNX                          WDZXNX
     I              BCZYNX                          WDZYNX
     I              BCY2NX                          WDY2NX
     I              BCGIT1                          WDGIT1
     I              BCGGT1                          WDGGT1
     I              BCGHT1                          WDGHT1
     I              BCVFSX                          WDVFSX
     I              BCVGSX                          WDVGSX
     I              BCVHSX                          WDVHSX
     I              BCVISX                          WDVISX
     I              BCF8AA                          WDF8AA
     I              BCV4SX                          WDV4SX
     I              BCF9AA                          WDF9AA
     I              BCZFNX                          WDZFNX
     I              BCZZNX                          WDZZNX
     I              BCZ0NX                          WDZ0NX
     I              BCBINY                          WDBINY
     I              BCBJNY                          WDBJNY
     I              BCBKNY                          WDBKNY
     I              BCATNY                          WDATNY
     I              BCALD8                          WDALD8
     I              BCAMD8                          WDAMD8
     I              BCF5NY                          WDF5NY
     I              BCZISX                          WDZISX
     I              BCZJSX                          WDZJSX
     I              BCZKSX                          WDZKSX
     I              BCZLSX                          WDZLSX
     I              BCZMSX                          WDZMSX
     I              BCUWSX                          WDUWSX
     I              BCUXSX                          WDUXSX
     I              BCV3SX                          WDV3SX
     I              BCAHNY                          WDAHNY
     I              BCAINY                          WDAINY
     I              BCAJNY                          WDAJNY
     I              BCAKNY                          WDAKNY
      *
     IYARDCS      DS                            222
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPPBD1    E DSPPBDCPL0
      * UPD : PFS Order BOL Comment     Update index
      * Renamed input format fields
     I              BDY1NX                          WFY1NX
     I              BDZPNX                          WFZPNX
     I              BDIZST                          WFIZST
     I              BDZ1NX                          WFZ1NX
     I              BDGJT1                          WFGJT1
     I              BDUWSX                          WFUWSX
     I              BDUXSX                          WFUXSX
     I              BDV3SX                          WFV3SX
     I              BDAHNY                          WFAHNY
     I              BDAINY                          WFAINY
     I              BDAJNY                          WFAJNY
     I              BDAKNY                          WFAKNY
      *
     IYBRDCS      DS                            111
     IQPPBB1    E DSPPBBCPL0
      * UPD : PFS Order Header          Update index
      * Renamed input format fields
     I              BBY1NX                          WGY1NX
     I              BBZPNX                          WGZPNX
     I              BBZGNX                          WGZGNX
     I              BBZWNX                          WGZWNX
     I              BBZVNX                          WGZVNX
     I              BBVCSX                          WGVCSX
     I              BBZQNX                          WGZQNX
     I              BBF0T1                          WGF0T1
     I              BBF1T1                          WGF1T1
     I              BBF2T1                          WGF2T1
     I              BBGUT1                          WGGUT1
     I              BBF3T1                          WGF3T1
     I              BBF4T1                          WGF4T1
     I              BBF5T1                          WGF5T1
     I              BBF6T1                          WGF6T1
     I              BBF7T1                          WGF7T1
     I              BBZENX                          WGZENX
     I              BBF8T1                          WGF8T1
     I              BBF9T1                          WGF9T1
     I              BBGAT1                          WGGAT1
     I              BBGVT1                          WGGVT1
     I              BBGBT1                          WGGBT1
     I              BBGCT1                          WGGCT1
     I              BBGDT1                          WGGDT1
     I              BBFZT1                          WGFZT1
     I              BBZRNX                          WGZRNX
     I              BBZSNX                          WGZSNX
     I              BBZTNX                          WGZTNX
     I              BBZUNX                          WGZUNX
     I              BBVBSX                          WGVBSX
     I              BBU3SX                          WGU3SX
     I              BBGET1                          WGGET1
     I              BBGFT1                          WGGFT1
     I              BBA1NY                          WGA1NY
     I              BBBKNY                          WGBKNY
     I              BBATNY                          WGATNY
     I              BBVESX                          WGVESX
     I              BBF8AA                          WGF8AA
     I              BBF9AA                          WGF9AA
     I              BBC5NY                          WGC5NY
     I              BBF5NY                          WGF5NY
     I              BBF5AA                          WGF5AA
     I              BBFRT1                          WGFRT1
     I              BBFST1                          WGFST1
     I              BBFTT1                          WGFTT1
     I              BBFUT1                          WGFUT1
     I              BBFVT1                          WGFVT1
     I              BBFWT1                          WGFWT1
     I              BBFXT1                          WGFXT1
     I              BBZLNX                          WGZLNX
     I              BBF7AA                          WGF7AA
     I              BBF6AA                          WGF6AA
     I              BBS6NA                          WGS6NA
     I              BBZDSX                          WGZDSX
     I              BBZESX                          WGZESX
     I              BBZFSX                          WGZFSX
     I              BBZGSX                          WGZGSX
     I              BBZHSX                          WGZHSX
     I              BBMXU1                          WGMXU1
     I              BBUWSX                          WGUWSX
     I              BBUXSX                          WGUXSX
     I              BBV3SX                          WGV3SX
     I              BBAHNY                          WGAHNY
     I              BBAINY                          WGAINY
     I              BBAJNY                          WGAJNY
     I              BBAKNY                          WGAKNY
      *
     IYCRDCS      DS                            861
     IQPPBA1    E DSPPBACPL0
      * UPD : PFS Load Header           Update index
      * Renamed input format fields
     I              BAY1NX                          WHY1NX
     I              BAZGNX                          WHZGNX
     I              BAAWNY                          WHAWNY
     I              BAF4AA                          WHF4AA
     I              BAFQT1                          WHFQT1
     I              BAVBSX                          WHVBSX
     I              BAF5AA                          WHF5AA
     I              BAFRT1                          WHFRT1
     I              BAFST1                          WHFST1
     I              BAFTT1                          WHFTT1
     I              BAFUT1                          WHFUT1
     I              BAFVT1                          WHFVT1
     I              BAFWT1                          WHFWT1
     I              BAFXT1                          WHFXT1
     I              BAZLNX                          WHZLNX
     I              BAF7AA                          WHF7AA
     I              BAF6AA                          WHF6AA
     I              BAU7SX                          WHU7SX
     I              BAU9SX                          WHU9SX
     I              BAVASX                          WHVASX
     I              BAZMNX                          WHZMNX
     I              BAZNNX                          WHZNNX
     I              BAZONX                          WHZONX
     I              BAU8SX                          WHU8SX
     I              BAZHNX                          WHZHNX
     I              BAZINX                          WHZINX
     I              BAZJNX                          WHZJNX
     I              BAZKNX                          WHZKNX
     I              BABLNY                          WHBLNY
     I              BAFYT1                          WHFYT1
     I              BABKNY                          WHBKNY
     I              BAATNY                          WHATNY
     I              BAB4NY                          WHB4NY
     I              BAY7SX                          WHY7SX
     I              BAHST1                          WHHST1
     I              BAF5NY                          WHF5NY
     I              BAY8SX                          WHY8SX
     I              BAY9SX                          WHY9SX
     I              BAZASX                          WHZASX
     I              BAZBSX                          WHZBSX
     I              BAZCSX                          WHZCSX
     I              BAMWU1                          WHMWU1
     I              BAUWSX                          WHUWSX
     I              BAUXSX                          WHUXSX
     I              BAV3SX                          WHV3SX
     I              BAAHNY                          WHAHNY
     I              BAAINY                          WHAINY
     I              BAAJNY                          WHAJNY
     I              BAAKNY                          WHAKNY
      *
     IYDRDCS      DS                            430
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Load Header
      * I :  Load ID
     I                                    P   1   40P1RMNB
     IP2PARM      DS
      * FLD: PFS Load Header
      * N :  PFS Load ID
     I                                        1   70P2ZGNX
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1RMNB    PARM           WP0001  70       Load ID
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PFS Unlock Load/Order XF
     C                     Z-ADDP1RMNB    P2ZGNX           PFS Load ID
      * PFS Unlock Load/Order RT - PFS Load Header  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * PFS Unlock Load/Order RT - PFS Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAZGNX    WQSA01           PFS Load ID
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           PFS Load ID
      * Setup key
     C                     Z-ADDP2ZGNX    WQSA01           PFS Load ID
      * Establish starting position
     C           KRSSA     SETLL@BACPAG                    *
     C           KRSSA     READE@BACPAG                  90*
      * Data record not found
     C   90                MOVEL'USR3484' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * *** ORDER HEADER, ORDER DETAIL, SHIPPING INSTRUCTIONS ***
      * PFS Unlock Load/Order RT - PFS Order Header  * 
     C                     EXSR SBRVGN
      * *** LOAD HEADER ***
      * Chg PFS Record Status CH - PFS Load Header  * 
     C                     EXSR SHCHRC
     C           KRSSA     READE@BACPAG                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * PFS Unlock Load/Order RT - PFS Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBZGNX    WQSB01           PFS Load ID
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           PFS Load ID
      * Setup key
     C                     Z-ADDWAZGNX    WQSB01           PFS Load ID
      * Establish starting position
     C           KRSSB     SETLL@BBCPAH                    *
     C           KRSSB     READE@BBCPAH                  90*
      * Data record not found
     C   90                MOVEL'USR3486' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * *** ORDER DETAIL ***
      * PFS Unlock Load/Order RT - PFS Order Detail  * 
     C                     EXSR SCRVGN
      * *** ORDER BOL Comment    ***
      * PFS Unlock Load/Order RT - PFS Order BOL Comment  * 
     C                     EXSR SERVGN
      * *** ORDER HEADER ***
      * ** Delivery P.O. number was added to the file       FP1303
      * Chg PFS Record Status CH - PFS Order Header  * 
     C                     EXSR SGCHRC
     C           KRSSB     READE@BBCPAH                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * PFS Unlock Load/Order RT - PFS Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCY1NX    WQSC01           PFS Company Num
     C           *LIKE     DEFN WCZPNX    WQSC02           PFS Order Numbe
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           PFS Company Num
     C                     KFLD           WQSC02           PFS Order Numbe
      * Setup key
     C                     Z-ADDWBY1NX    WQSC01           PFS Company Num
     C                     Z-ADDWBZPNX    WQSC02           PFS Order Numbe
      * Establish starting position
     C           KRSSC     SETLL@BCCPZP                    *
     C           KRSSC     READE@BCCPZP                  90*
      * Data record not found
     C   90                MOVEL'USR3488' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg PFS Record Status CH - PFS Order Detail  * 
     C                     EXSR SDCHRC
     C           KRSSC     READE@BCCPZP                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCHRC    BEGSR
      *================================================================
      * Chg PFS Record Status CH - PFS Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       PFS Item Code
     C                     MOVEL*BLANK    WN0002 14        PFS Customer It
     C                     MOVEL*BLANK    WN0003 30        PFS Item Descri
     C                     MOVEL*BLANK    WN0004 30        PFS Item Descri
     C                     MOVEL*BLANK    WN0005  1        PFS Age Code
     C                     MOVEL*BLANK    WN0006  1        PFS Slip Sheet
     C                     MOVEL*BLANK    WN0007  1        PFS Shrink Wrap
     C                     MOVEL*BLANK    WN0008  1        PFS Palletize
     C                     MOVEL*BLANK    WN0009  3        PFS Ship From W
     C                     MOVEL*BLANK    WN0010  2        PFS Ship From W
     C                     MOVEL*BLANK    WN0011  3        PFS Ship To War
     C                     Z-ADD*ZERO     WN0012  70       PFS Scheduled Q
     C                     Z-ADD*ZERO     WN0013  82       PFS Scheduled W
     C                     Z-ADD*ZERO     WN0014  82       PFS Maximum Net
     C                     Z-ADD*ZERO     WN0015  82       PFS Minimum Uni
     C                     Z-ADD*ZERO     WN0016  82       PFS Maximum Uni
     C                     Z-ADD*ZERO     WN0017  50       PFS Estimated P
     C                     Z-ADD*ZERO     WN0018  52       PFS Average Pal
     C                     Z-ADD*ZERO     WN0019  80       PFS Oldest Date
     C                     Z-ADD*ZERO     WN0020  80       PFS Newest Date
     C                     Z-ADD*ZERO     WN0021  90       PFS Sequence No
     C                     MOVEL*BLANK    WN0022  1        PFS Ord Dtl Unu
     C                     MOVEL*BLANK    WN0023  1        PFS Ord Dtl Unu
     C                     MOVEL*BLANK    WN0024  1        PFS Ord Dtl Unu
     C                     MOVEL*BLANK    WN0025  2        PFS Pallet Type
     C                     MOVEL*BLANK    WN0026  2        PFS Ord Dtl Unu
     C                     Z-ADD*ZERO     WN0027  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0028  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0029  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0030  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0031  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0032  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BCCPZO
     C                     Z-ADDWCY1NX    WDY1NX           PFS Company Num
     C                     Z-ADDWCZPNX    WDZPNX           PFS Order Numbe
     C                     Z-ADDWCZXNX    WDZXNX           PFS Order Line
     C                     Z-ADDWCZYNX    WDZYNX           PFS Substitutio
      *
     C           KLCHSD    KLIST
     C                     KFLD           WDY1NX           PFS Company Num
     C                     KFLD           WDZPNX           PFS Order Numbe
     C                     KFLD           WDZXNX           PFS Order Line
     C                     KFLD           WDZYNX           PFS Substitutio
     C           KLCHSD    CHAIN@BCCPZO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBCCPL0'MDACP
     C                     MOVEL'@BCCPZO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPBC1    YARDCS
      * Move non-key fields to @BCCPZO
     C                     MOVEL'D'       WDUWSX    P      PFS Record Stat
      *
      * Set PGM.*Record Data Changed flag
     C           QPPBC1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Change Stamp      IF
     C                     Z-ADD##JDT     WDAJNY           PFS Change Date
     C                     Z-ADD##JTM     WDAKNY           PFS Change time
      * Set PGM.*Record Data Changed flag
     C           QPPBC1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BCCPZO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPBCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * PFS Unlock Load/Order RT - PFS Order BOL Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEY1NX    WQSE01           PFS Company Num
     C           *LIKE     DEFN WEZPNX    WQSE02           PFS Order Numbe
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           PFS Company Num
     C                     KFLD           WQSE02           PFS Order Numbe
      * Setup key
     C                     Z-ADDWBY1NX    WQSE01           PFS Company Num
     C                     Z-ADDWBZPNX    WQSE02           PFS Order Numbe
      * Establish starting position
     C           KRSSE     SETLL@BDCPAB                    *
     C           KRSSE     READE@BDCPAB                  90*
      * Data record not found
     C   90                MOVEL'USR3490' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg PFS Record Status CH - PFS Order BOL Comment  * 
     C                     EXSR SFCHRC
     C           KRSSE     READE@BDCPAB                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * Chg PFS Record Status CH - PFS Order BOL Comment  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0033 60        PFS BOL Comment
     C                     Z-ADD*ZERO     WN0034  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0035  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0036  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0037  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0038  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0039  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BDCPAA
     C                     Z-ADDWEY1NX    WFY1NX           PFS Company Num
     C                     Z-ADDWEZPNX    WFZPNX           PFS Order Numbe
     C                     MOVELWEIZST    WFIZST    P      PFS BOL Comment
     C                     Z-ADDWEZ1NX    WFZ1NX           PFS Sequence Nu
      *
     C           KLCHSF    KLIST
     C                     KFLD           WFY1NX           PFS Company Num
     C                     KFLD           WFZPNX           PFS Order Numbe
     C                     KFLD           WFIZST           PFS BOL Comment
     C                     KFLD           WFZ1NX           PFS Sequence Nu
     C           KLCHSF    CHAIN@BDCPAA              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBDCPL0'MDACP
     C                     MOVEL'@BDCPAA' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPBD1    YBRDCS
      * Move non-key fields to @BDCPAA
     C                     MOVEL'D'       WFUWSX    P      PFS Record Stat
      *
      * Set PGM.*Record Data Changed flag
     C           QPPBD1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Change Stamp      IF
     C                     Z-ADD##JDT     WFAJNY           PFS Change Date
     C                     Z-ADD##JTM     WFAKNY           PFS Change time
      * Set PGM.*Record Data Changed flag
     C           QPPBD1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BDCPAA                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPBDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * Chg PFS Record Status CH - PFS Order Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0040  70       PFS Load ID
     C                     Z-ADD*ZERO     WN0041  20       PFS Loading Seq
     C                     Z-ADD*ZERO     WN0042  20       PFS Load Stop N
     C                     MOVEL*BLANK    WN0043  2        PFS Order Type
     C                     Z-ADD*ZERO     WN0044  70       PFS Ship To Cus
     C                     MOVEL*BLANK    WN0045 30        PFS Ship To Cus
     C                     MOVEL*BLANK    WN0046 30        PFS Ship To Cus
     C                     MOVEL*BLANK    WN0047 30        PFS Ship To Cus
     C                     MOVEL*BLANK    WN0048 30        PFS Ship To Cus
     C                     MOVEL*BLANK    WN0049 20        PFS Ship To Cus
     C                     MOVEL*BLANK    WN0050  2        PFS Ship To Cus
     C                     MOVEL*BLANK    WN0051 11        PFS Ship To Cus
     C                     MOVEL*BLANK    WN0052 50        PFS Ship To Ema
     C                     MOVEL*BLANK    WN0053 25        PFS Ship To Pho
     C                     Z-ADD*ZERO     WN0054  70       PFS Bill To Cus
     C                     MOVEL*BLANK    WN0055 30        PFS Bill To Cus
     C                     MOVEL*BLANK    WN0056 30        PFS Bill To Cus
     C                     MOVEL*BLANK    WN0057 30        PFS Bill To Cus
     C                     MOVEL*BLANK    WN0058 30        PFS Bill To Cus
     C                     MOVEL*BLANK    WN0059 20        PFS Bill To Cus
     C                     MOVEL*BLANK    WN0060  2        PFS Bill To Cus
     C                     MOVEL*BLANK    WN0061 11        PFS Bill To Cus
     C                     MOVEL*BLANK    WN0062 15        PFS Customer PO
     C                     Z-ADD*ZERO     WN0063  80       PFS Order Date
     C                     Z-ADD*ZERO     WN0064  80       PFS Scheduled S
     C                     Z-ADD*ZERO     WN0065  80       PFS Requested D
     C                     Z-ADD*ZERO     WN0066  60       PFS Requested D
     C                     MOVEL*BLANK    WN0067  1        PFS Export Stat
     C                     MOVEL*BLANK    WN0068  6        PFS Country Cod
     C                     MOVEL*BLANK    WN0069 40        PFS Special Ins
     C                     MOVEL*BLANK    WN0070 40        PFS Special Ins
     C                     Z-ADD*ZERO     WN0071  70       PFS Maximum Gro
     C                     Z-ADD*ZERO     WN0072  50       PFS Estimated P
     C                     Z-ADD*ZERO     WN0073  52       PFS Average Pal
     C                     MOVEL*BLANK    WN0074  1        PFS Order Statu
     C                     MOVEL*BLANK    WN0075  3        PFS Ship From W
     C                     Z-ADD*ZERO     WN0076  90       PFS Sequence No
     C                     MOVEL*BLANK    WN0077  3        PFS Shipping Li
     C                     MOVEL*BLANK    WN0078 30        PFS Shipping Li
     C                     MOVEL*BLANK    WN0079 30        PFS Shipping Li
     C                     MOVEL*BLANK    WN0080 30        PFS Shipping Li
     C                     MOVEL*BLANK    WN0081 20        PFS Shipping Li
     C                     MOVEL*BLANK    WN0082  2        PFS Shipping Li
     C                     MOVEL*BLANK    WN0083 11        PFS Shipping LI
     C                     MOVEL*BLANK    WN0084 30        PFS Vessel Name
     C                     MOVEL*BLANK    WN0085 15        PFS Voyage
     C                     MOVEL*BLANK    WN0086 20        PFS Discharge P
     C                     MOVEL*BLANK    WN0087 15        PFS Booking Num
     C                     MOVEL*BLANK    WN0088  1        PFS Order Unuse
     C                     MOVEL*BLANK    WN0089  1        PFS Order Unuse
     C                     MOVEL*BLANK    WN0090  1        PFS Order Unuse
     C                     MOVEL*BLANK    WN0091  2        PFS Order Unuse
     C                     MOVEL*BLANK    WN0092  2        PFS Order Unuse
     C                     MOVEL*BLANK    WN0093 15        PFS Order Unuse
     C                     Z-ADD*ZERO     WN0094  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0095  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0096  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0097  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0098  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0099  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BBCPZR
     C                     Z-ADDWBY1NX    WGY1NX           PFS Company Num
     C                     Z-ADDWBZPNX    WGZPNX           PFS Order Numbe
      *
     C           KLCHSG    KLIST
     C                     KFLD           WGY1NX           PFS Company Num
     C                     KFLD           WGZPNX           PFS Order Numbe
     C           KLCHSG    CHAIN@BBCPZR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBBCPL0'MDACP
     C                     MOVEL'@BBCPZR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPBB1    YCRDCS
      * Move non-key fields to @BBCPZR
     C                     MOVELWBF9AA    WGF9AA    P      PFS Ship To War
     C                     Z-ADDWBC5NY    WGC5NY           PFS Order Detai
     C                     MOVELWBS6NA    WGS6NA    P      PFS Delivery P.
     C                     MOVEL'D'       WGUWSX    P      PFS Record Stat
      *
      * Set PGM.*Record Data Changed flag
     C           QPPBB1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Change Stamp      IF
     C                     Z-ADD##JDT     WGAJNY           PFS Change Date
     C                     Z-ADD##JTM     WGAKNY           PFS Change time
      * Set PGM.*Record Data Changed flag
     C           QPPBB1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BBCPZR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPBBCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCHRC    BEGSR
      *================================================================
      * Chg PFS Record Status CH - PFS Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0100  50       PFS Sched Seque
     C                     MOVEL*BLANK    WN0101  3        PFS Carrier Cod
     C                     MOVEL*BLANK    WN0102 30        PFS Carrier Nam
     C                     MOVEL*BLANK    WN0103  1        PFS Export Stat
     C                     MOVEL*BLANK    WN0104  3        PFS Shipping Li
     C                     MOVEL*BLANK    WN0105 30        PFS Shipping Li
     C                     MOVEL*BLANK    WN0106 30        PFS Shipping Li
     C                     MOVEL*BLANK    WN0107 30        PFS Shipping Li
     C                     MOVEL*BLANK    WN0108 20        PFS Shipping Li
     C                     MOVEL*BLANK    WN0109  2        PFS Shipping Li
     C                     MOVEL*BLANK    WN0110 11        PFS Shipping LI
     C                     MOVEL*BLANK    WN0111 30        PFS Vessel Name
     C                     MOVEL*BLANK    WN0112 15        PFS Voyage
     C                     MOVEL*BLANK    WN0113 20        PFS Discharge P
     C                     MOVEL*BLANK    WN0114 15        PFS Booking Num
     C                     MOVEL*BLANK    WN0115  2        PFS Shipping Me
     C                     MOVEL*BLANK    WN0116  1        PFS Load Shag F
     C                     MOVEL*BLANK    WN0117  1        PFS Load Wash F
     C                     Z-ADD*ZERO     WN0118  20       PFS Load Total
     C                     Z-ADD*ZERO     WN0119  50       PFS Load Total
     C                     Z-ADD*ZERO     WN0120  52       PFS Reefer Temp
     C                     MOVEL*BLANK    WN0121  1        PFS Reefer Temp
     C                     Z-ADD*ZERO     WN0122  80       PFS Load Sched
     C                     Z-ADD*ZERO     WN0123  60       PFS Load Sched
     C                     Z-ADD*ZERO     WN0124  80       PFS Load Deadli
     C                     Z-ADD*ZERO     WN0125  60       PFS Load Deadli
     C                     Z-ADD*ZERO     WN0126  82       PFS Maximum Loa
     C                     MOVEL*BLANK    WN0127 20        PFS Federal Tax
     C                     Z-ADD*ZERO     WN0128  50       PFS Estimated P
     C                     Z-ADD*ZERO     WN0129  52       PFS Average Pal
     C                     Z-ADD*ZERO     WN0130  82       PFS Predicted L
     C                     MOVEL*BLANK    WN0131 20        PFS Trailer Id
     C                     Z-ADD*ZERO     WN0132  90       PFS Sequence No
     C                     MOVEL*BLANK    WN0133  1        PFS Load Unused
     C                     MOVEL*BLANK    WN0134  1        PFS Load Unused
     C                     MOVEL*BLANK    WN0135  1        PFS Load Unused
     C                     MOVEL*BLANK    WN0136  2        PFS Load Unused
     C                     MOVEL*BLANK    WN0137  2        PFS Load Unused
     C                     MOVEL*BLANK    WN0138 15        PFS Load Unused
     C                     MOVEL*BLANK    WN0139  1        PFS Record Stat
     C                     Z-ADD*ZERO     WN0140  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0141  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0142  80       PFS Create Date
     C                     Z-ADD*ZERO     WN0143  60       PFS Create Time
     C                     Z-ADD*ZERO     WN0144  80       PFS Change Date
     C                     Z-ADD*ZERO     WN0145  60       PFS Change time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @BACPZI
     C                     Z-ADDWAY1NX    WHY1NX           PFS Company Num
     C                     Z-ADDWAZGNX    WHZGNX           PFS Load ID
      *
     C           KLCHSH    KLIST
     C                     KFLD           WHY1NX           PFS Company Num
     C                     KFLD           WHZGNX           PFS Load ID
     C           KLCHSH    CHAIN@BACPZI              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPBACPL0'MDACP
     C                     MOVEL'@BACPZI' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPBA1    YDRDCS
      * Move non-key fields to @BACPZI
     C                     MOVELWAY7SX    WHY7SX    P      PFS Load Status
      *
      * Set PGM.*Record Data Changed flag
     C           QPPBA1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Change Stamp      IF
     C                     Z-ADD##JDT     WHAJNY           PFS Change Date
     C                     Z-ADD##JTM     WHAKNY           PFS Change time
      * Set PGM.*Record Data Changed flag
     C           QPPBA1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@BACPZI                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPBACPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P2ZGNX           PFS Load ID
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WAZGNX           PFS Load ID
     C                     Z-ADD*ZERO     WAAWNY           PFS Sched Seque
     C                     Z-ADD*ZERO     WAZMNX           PFS Load Total
     C                     Z-ADD*ZERO     WAZNNX           PFS Load Total
     C                     Z-ADD*ZERO     WAZONX           PFS Reefer Temp
     C                     Z-ADD*ZERO     WAZHNX           PFS Load Sched
     C                     Z-ADD*ZERO     WAZINX           PFS Load Sched
     C                     Z-ADD*ZERO     WAZJNX           PFS Load Deadli
     C                     Z-ADD*ZERO     WAZKNX           PFS Load Deadli
     C                     Z-ADD*ZERO     WABLNY           PFS Maximum Loa
     C                     Z-ADD*ZERO     WABKNY           PFS Estimated P
     C                     Z-ADD*ZERO     WAATNY           PFS Average Pal
     C                     Z-ADD*ZERO     WAB4NY           PFS Predicted L
     C                     Z-ADD*ZERO     WAF5NY           PFS Sequence No
     C                     Z-ADD*ZERO     WAUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WAAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WAAINY           PFS Create Time
     C                     Z-ADD*ZERO     WAAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WAAKNY           PFS Change time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WBZPNX           PFS Order Numbe
     C                     Z-ADD*ZERO     WBZGNX           PFS Load ID
     C                     Z-ADD*ZERO     WBZWNX           PFS Loading Seq
     C                     Z-ADD*ZERO     WBZVNX           PFS Load Stop N
     C                     Z-ADD*ZERO     WBZQNX           PFS Ship To Cus
     C                     Z-ADD*ZERO     WBZENX           PFS Bill To Cus
     C                     Z-ADD*ZERO     WBZRNX           PFS Order Date
     C                     Z-ADD*ZERO     WBZSNX           PFS Scheduled S
     C                     Z-ADD*ZERO     WBZTNX           PFS Requested D
     C                     Z-ADD*ZERO     WBZUNX           PFS Requested D
     C                     Z-ADD*ZERO     WBA1NY           PFS Maximum Gro
     C                     Z-ADD*ZERO     WBBKNY           PFS Estimated P
     C                     Z-ADD*ZERO     WBATNY           PFS Average Pal
     C                     Z-ADD*ZERO     WBC5NY           PFS Order Detai
     C                     Z-ADD*ZERO     WBF5NY           PFS Sequence No
     C                     Z-ADD*ZERO     WBUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WBAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WBAINY           PFS Create Time
     C                     Z-ADD*ZERO     WBAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WBAKNY           PFS Change time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WCZPNX           PFS Order Numbe
     C                     Z-ADD*ZERO     WCZXNX           PFS Order Line
     C                     Z-ADD*ZERO     WCZYNX           PFS Substitutio
     C                     Z-ADD*ZERO     WCY2NX           PFS Item Code
     C                     Z-ADD*ZERO     WCZFNX           PFS Scheduled Q
     C                     Z-ADD*ZERO     WCZZNX           PFS Scheduled W
     C                     Z-ADD*ZERO     WCZ0NX           PFS Maximum Net
     C                     Z-ADD*ZERO     WCBINY           PFS Minimum Uni
     C                     Z-ADD*ZERO     WCBJNY           PFS Maximum Uni
     C                     Z-ADD*ZERO     WCBKNY           PFS Estimated P
     C                     Z-ADD*ZERO     WCATNY           PFS Average Pal
     C                     Z-ADD*ZERO     WCALD8           PFS Oldest Date
     C                     Z-ADD*ZERO     WCAMD8           PFS Newest Date
     C                     Z-ADD*ZERO     WCF5NY           PFS Sequence No
     C                     Z-ADD*ZERO     WCUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WCAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WCAINY           PFS Create Time
     C                     Z-ADD*ZERO     WCAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WCAKNY           PFS Change time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WEZPNX           PFS Order Numbe
     C                     Z-ADD*ZERO     WEZ1NX           PFS Sequence Nu
     C                     Z-ADD*ZERO     WEUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WEAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WEAINY           PFS Create Time
     C                     Z-ADD*ZERO     WEAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WEAKNY           PFS Change time
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
