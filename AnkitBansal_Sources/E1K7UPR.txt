      *****************************************************************
      *
      *  Program number:  E1K7UPR
      *  Program name:    Insert F0411Z1 records from stage table E10411  - 1 batch
      *  Programmer:      Rose Centonze
      *  Date created:    06/17/2020
      *
      *  Program purpose: Insert F0411Z1 records from stage table E10411
      *                   Read 1 batch from E10411 records
      *                   Mark as processed
      ****************************************************************
      * MODIFICATIONS:
      ****************************************************************
      * DATE      PROGRAMMER
      *
      ****************************************************************
      *****************************************************************
      * File specifications
      ****************************************************************
     Fe10411l3  uf   e           k disk
      ****************************************************************
      * DEFINITION SPECIFICATIONS
      ****************************************************************
      *
      *---------------------------------------------------------------
      * Named Constants
     D yes             c                   'Y'
     D no              c                   'N'
     D xxamvn          c                   'APBATCH   '
     D xxalvn          c                   'E1JJUPR   '
      *
      * Workfields for date manipulation
      *
     d xxactm          s                   like(elactm)
     D wkcymdiso       s               d   datfmt(*iso)
     D xxacdt          s                   like(elacdt)
     D xxccyymmdd      s              8  0
      *
      /eject
      *----------------------------------------------------------------------------------
      * Mainline
      *----------------------------------------------------------------------------------
      *
      * Read records in the A/R Detail file.
      *   appropriate records sGLected in Logical file
      *
     C     k0411         setll     @0411F2
     C                   dou       *in80 = *on                                  Main do
     C     k0411         reade     @0411F2                                80
     C                   if        *in80 = *off                                  If not EOF
      *
      * Wrte to E1 F0411Z1
      *
JEU56C                   CALL      'E1JGUPR'
JEU56C                   parm                    ELEDUS
JEU56C                   parm                    ELEDTY
JEU56C                   parm                    ELEDSQ
JEU56C                   parm                    ELEDTN
JEU56C                   parm                    ELEDCT
JEU56C                   parm                    ELEDLN
JEU56C                   parm                    ELEDTS
JEU56C                   parm                    ELEDFT
JEU56C                   parm                    ELEDDT
JEU56C                   parm                    ELEDER
JEU56C                   parm                    ELEDDL
JEU56C                   parm                    ELEDSP
JEU56C                   parm                    ELEDTC
JEU56C                   parm                    ELEDTR
JEU56C                   parm                    ELEDBT
JEU56C                   parm                    ELEDGL
JEU56C                   parm                    ELEDDH
JEU56C                   parm                    ELEDAN
JEU56C                   parm                    ELKCO
JEU56C                   parm                    ELDOC
JEU56C                   parm                    ELDCT
JEU56C                   parm                    ELSFX
JEU56C                   parm                    ELSFXE
JEU56C                   parm                    ELDCTA
JEU56C                   parm                    ELAN8
JEU56C                   parm                    ELPYE
JEU56C                   parm                    ELSNTO
JEU56C                   parm                    ELDIVJ
JEU56C                   parm                    ELDSVJ
JEU56C                   parm                    ELDDJ
JEU56C                   parm                    ELDDNJ
JEU56C                   parm                    ELDGJ
JEU56C                   parm                    ELFY
JEU56C                   parm                    ELCTRY
JEU56C                   parm                    ELPN
JEU56C                   parm                    ELCO
JEU56C                   parm                    ELICU
JEU56C                   parm                    ELicut
JEU56C                   parm                    ELDICJ
JEU56C                   parm                    ELBALJ
JEU56C                   parm                    ELPSTC
JEU56C                   parm                    ELAG
JEU56C                   parm                    ELAAP
JEU56C                   parm                    ELADSC
JEU56C                   parm                    ELADSA
JEU56C                   parm                    ELATXA
JEU56C                   parm                    ELATXN
JEU56C                   parm                    ELSTAM
JEU56C                   parm                    ELTXA1
JEU56C                   parm                    ELEXR1
JEU56C                   parm                    ELCRRM
JEU56C                   parm                    ELCRCD
JEU56C                   parm                    ELCRR
JEU56C                   parm                    ELACR
JEU56C                   parm                    ELFAP
JEU56C                   parm                    ELCDS
JEU56C                   parm                    ELCDSA
JEU56C                   parm                    ELCTXA
JEU56C                   parm                    ELCTXN
JEU56C                   parm                    ELCTAM
JEU56C                   parm                    ELGLC
JEU56C                   parm                    ELGLBA
JEU56C                   parm                    ELPOST
JEU56C                   parm                    ELAM
JEU56C                   parm                    ELAID2
JEU56C                   parm                    ELMCU
JEU56C                   parm                    ELOBJ
JEU56C                   parm                    ELSUB
JEU56C                   parm                    ELSBLT
JEU56C                   parm                    ELSBL
JEU56C                   parm                    ELBAID
JEU56C                   parm                    ELPTC
JEU56C                   parm                    ELVOD
JEU56C                   parm                    ELOKCO
JEU56C                   parm                    ELODCT
JEU56C                   parm                    ELODOC
JEU56C                   parm                    ELOSFX
JEU56C                   parm                    ELCRC
JEU56C                   parm                    ELVINV
JEU56C                   parm                    ELPKCO
JEU56C                   parm                    ELPO
JEU56C                   parm                    ELPDCT
JEU56C                   parm                    ELLNID
JEU56C                   parm                    ELSFXO
JEU56C                   parm                    ELOPSQ
JEU56C                   parm                    ELVR01
JEU56C                   parm                    ELUNIT
JEU56C                   parm                    ELMCU2
JEU56C                   parm                    ELRMK
JEU56C                   parm                    ELRF
JEU56C                   parm                    ELDRF
JEU56C                   parm                    ELCTL
JEU56C                   parm                    ELFNLP
JEU56C                   parm                    ELU
JEU56C                   parm                    ELUM
JEU56C                   parm                    ELPYIN
JEU56C                   parm                    ELTXA3                         invoice date
JEU56C                   parm                    ELEXR3
JEU56C                   parm                    ELRP1
JEU56C                   parm                    ELRP2
JEU56C                   parm                    ELRP3
JEU56C                   parm                    ELAC07
JEU56C                   parm                    ELTNN
JEU56C                   parm                    ELDMCD
JEU56C                   parm                    ELITM
JEU56C                   parm                    ELHCRR
JEU56C                   parm                    ELHDGJ
JEU56C                   parm                    ELURCD
JEU56C                   parm                    ELURDT
JEU56C                   parm                    ELURAT
JEU56C                   parm                    ELURAB
JEU56C                   parm                    ELURRF
JEU56C                   parm                    ELTORG
JEU56C                   parm                    ELUSER
JEU56C                   parm                    ELPID
JEU56C                   parm                    ELUPMJ
JEU56C                   parm                    ELUPMT
JEU56C                   parm                    ELJOBN
JEU56C                   parm                    ELDIM
JEU56C                   parm                    ELDID
JEU56C                   parm                    ELDIY
JEU56C                   parm                    ELDI#
JEU56C                   parm                    ELDSVM
JEU56C                   parm                    ELDSVD
JEU56C                   parm                    ELDSVY
JEU56C                   parm                    ELDSV#
JEU56C                   parm                    ELDIM
JEU56C                   parm                    ELDID
JEU56C                   parm                    ELDIY
JEU56C                   parm                    ELDI#
JEU56C                   parm                    ELDDNM
JEU56C                   parm                    ELDDND
JEU56C                   parm                    ELDDNY
JEU56C                   parm                    ELDDN#
JEU56C                   parm                    ELDGM
JEU56C                   parm                    ELDGD
JEU56C                   parm                    ELDGY
JEU56C                   parm                    ELDG#
JEU56C                   parm                    ELDICM
JEU56C                   parm                    ELDICD
JEU56C                   parm                    ELDICY
JEU56C                   parm                    ELDIC#
JEU56C                   parm                    ELHDGM
JEU56C                   parm                    ELHDGD
JEU56C                   parm                    ELHDGY
JEU56C                   parm                    ELHDG#
JEU56C                   parm                    ELDOCM
JEU56C                   parm                    ERROR             1
JEU56C                   parm                    ERRID             7
JEU56C                   parm                    ERRText          25
JEU56C*
     C                   if        error = yes
     c                   move      '2'           eledsp
     c                   move      errid         elo6tx
     c                   movel     errtext       elo7tx
     c                   else
     c                   move      '1'           eledsp
     c                   move      *blanks       elo6tx
     c                   move      *blanks       elo7tx
     c                   end
      *
     c                   z-add     xxactm        elactm
     c                   z-add     xxacdt        elacdt
     c                   movel     xxalvn        elalvn                         user
     c                   movel     xxamvn        elamvn                         pgm
      *
     c                   update    @0411F2
      *
     c                   end
     c                   enddo
      *
     c                   seton                                        LR
      /eject
      *---------------------------------------------------------------
      * Initialization subroutine
      *---------------------------------------------------------------
      *
     C     *inzsr        begsr
      *
     c     *entry        plist
     c                   parm                    ELEDUS                        user
     c                   parm                    ELEDBT                        batch
      *
     C                   time                    xxactm
     C     *mdy          movel     udate         wkcymdiso
     C                   movel     wkcymdiso     xxccyymmdd
      *
      * Put system date into an 7,0 workfield for updating the f0911
      *
     C                   call      'HP8008'
     C                   parm                    xxccyymmdd
     C                   parm      0             xxacdt
      *
     c     k0411         klist
     c                   kfld                    ELEDUS
     c                   kfld                    ELEDBT
     c                   endsr
