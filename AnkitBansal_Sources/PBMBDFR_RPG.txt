     H/TITLE WW Load Plan Start Tm  DF Display file
     H            Y
     Z* CRTRPGPGM
     Z* OPTION(*SRCDBG) CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Display file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISPJAKH
     H* Date          : 04/12/24  Time  : 08:15:51
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPBMBDFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: WW Load Plan Start Tm  DF Display file
      *
     FOMFJCPMTIF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Load Header               SSD/DDT/TM/Load
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse Codes           Active records only
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FPDL1REL1IF  E           K        DISK
      * RTV : User Warehouse Access     Retrieval index
      *
     FOPBFCPL8IF  E           K        DISK
      * RSQ : Order Header TRG          Load #/All orders
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOPBFCPLGIF  E           K        DISK
      * RSQ : Order Header TRG          Load Id/Order Num
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer Master           Retrieval index       NV
      *
     FOMFLCPL4IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop(Desc)/Order
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPDJEREL2IF  E           K        DISK
      * RTV : Sales Route               Active Records
      *
     FCAAPREL2IF  E           K        DISK
      * RTV : Salesperson               Retrieval index       V
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOMFJCPLLIF  E           K        DISK
      * RSQ : Load Header               Load Only
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * Screen: Field position and name array
     E                    W0BEG   7 024  5 0A
     E                    W0END   7 024  5 0A
     E                    W0NAM   7 024 10
      * Long constants
     E                    @CN#    1  04  6   @CN    25
     I@BFCPRQ
      * Order Header TRG          Load Id/Order Num
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WCRMNB
     I              FJAIC3                          WCAIC3
     I              FJAODT                          WCAODT
     I              FJPJST                          WCPJST
     I              FJPKST                          WCPKST
     I              FJRNNB                          WCRNNB
     I              FJDMTX                          WCDMTX
     I              FJDNTX                          WCDNTX
     I              FJDOTX                          WCDOTX
     I              FJWTTX                          WCWTTX
     I              FJWUTX                          WCWUTX
     I              FJRPNB                          WCRPNB
     I              FJFLAM                          WCFLAM
     I              FJXQST                          WCXQST
     I              FJRRNB                          WCRRNB
     I              FJDXTX                          WCDXTX
     I              FJDYTX                          WCDYTX
     I              FJSBNB                          WCSBNB
     I              FJBZNA                          WCBZNA
     I              FJRONB                          WCRONB
     I              FJSQNB                          WCSQNB
     I              FJR1NB                          WCR1NB
     I              FJVCST                          WCVCST
     I              FJVDST                          WCVDST
     I              FJSDNB                          WCSDNB
     I              FJPAOU                          WCPAOU
     I              FJDGWG                          WCDGWG
     I              FJSXNB                          WCSXNB
     I              FJHADT                          WCHADT
     I              FJAART                          WCAART
     I              FJDHWG                          WCDHWG
     I              FJDIWG                          WCDIWG
     I              FJAQDT                          WCAQDT
     I              FJS6NB                          WCS6NB
     I              FJT4NB                          WCT4NB
     I              FJPRTM                          WCPRTM
     I              FJNPSV                          WCNPSV
     I              FJJ8TX                          WCJ8TX
     I              FJTLMI                          WCTLMI
     I              FJJ9TX                          WCJ9TX
     I              FJQ2CD                          WCQ2CD
     I              FJVPCD                          WCVPCD
     I              FJDBCD                          WCDBCD
     I              FJGRWE                          WCGRWE
     I              FJXCCD                          WCXCCD
     I              FJU2ST                          WCU2ST
     I              FJF9DT                          WCF9DT
     I              FJONTM                          WCONTM
     I              FJJ4DT                          WCJ4DT
     I              FJTRTM                          WCTRTM
     I              FJJ5DT                          WCJ5DT
     I              FJSPTM                          WCSPTM
     I              FJJ6DT                          WCJ6DT
     I              FJLFTM                          WCLFTM
     I              FJJ7DT                          WCJ7DT
     I              FJBOTM                          WCBOTM
     I              FJJ8DT                          WCJ8DT
     I              FJBLTM                          WCBLTM
     I              FJKIDT                          WCKIDT
     I              FJASTM                          WCASTM
     I              FJKADT                          WCKADT
     I              FJAJCM                          WCAJCM
     I              FJXACD                          WCXACD
     I              FJOANA                          WCOANA
     I              FJK4TX                          WCK4TX
     I              FJVOAG                          WCVOAG
     I              FJKBDT                          WCKBDT
     I              FJNBBO                          WCNBBO
     I              FJW4CD                          WCW4CD
     I              FJEFDT                          WCEFDT
     I              FJCNTN                          WCCNTN
     I              FJKCDT                          WCKCDT
     I              FJTMIN                          WCTMIN
     I              FJKDDT                          WCKDDT
     I              FJVMNB                          WCVMNB
     I              FJOCFR                          WCOCFR
     I              FJKJDT                          WCKJDT
     I              FJATTM                          WCATTM
     I              FJOTRS                          WCOTRS
     I              FJRNST                          WCRNST
     I              FJBRBK                          WCBRBK
     I              FJEIDT                          WCEIDT
     I              FJRMST                          WCRMST
     I              FJAJCD                          WCAJCD
     I              FJKKDT                          WCKKDT
     I              FJAVTM                          WCAVTM
     I              FJKZDT                          WCKZDT
     I              FJAXTM                          WCAXTM
     I              FJLHOS                          WCLHOS
     I              FJLHOR                          WCLHOR
     I              FJWNTX                          WCWNTX
     I              FJOITX                          WCOITX
     I              FJOJTX                          WCOJTX
     I              FJLLDT                          WCLLDT
     I              FJLSHG                          WCLSHG
     I              FJYPST                          WCYPST
     I              FJK0DT                          WCK0DT
     I              FJAYTM                          WCAYTM
     I              FJKNNX                          WCKNNX
     I              FJICWG                          WCICWG
     I              FJIDWG                          WCIDWG
     I              FJH9SX                          WCH9SX
     I              FJWOTX                          WCWOTX
     I              FJK1DT                          WCK1DT
     I              FJAZTM                          WCAZTM
     I              FJK2DT                          WCK2DT
     I              FJA0TM                          WCA0TM
     I              FJROST                          WCROST
     I              FJRPST                          WCRPST
     I              FJRQST                          WCRQST
     I              FJRRST                          WCRRST
     I              FJZBVA                          WCZBVA
     I              FJWPTX                          WCWPTX
     I              FJWQTX                          WCWQTX
     I              FJWRTX                          WCWRTX
     I              FJWSTX                          WCWSTX
     I              FJRVSX                          WCRVSX
     I              FJRUSX                          WCRUSX
     I              FJRWSX                          WCRWSX
     I              FJRXSX                          WCRXSX
     I              FJRYSX                          WCRYSX
     I              FJRZSX                          WCRZSX
     I              FJR0SX                          WCR0SX
     I              FJR1SX                          WCR1SX
     I              FJR2SX                          WCR2SX
     I              FJR3SX                          WCR3SX
     I              FJR4SX                          WCR4SX
     I              FJPYDT                          WCPYDT
     I              FJCKTM                          WCCKTM
     I              FJPZDT                          WCPZDT
     I              FJCLTM                          WCCLTM
     I              FJP0DT                          WCP0DT
     I              FJCMTM                          WCCMTM
     I              FJP1DT                          WCP1DT
     I              FJCNTM                          WCCNTM
     I              FJP2DT                          WCP2DT
     I              FJCOTM                          WCCOTM
     I              FJP3DT                          WCP3DT
     I              FJCQTM                          WCCQTM
     I              FJUVST                          WCUVST
     I              FJUWST                          WCUWST
     I              FJUXST                          WCUXST
     I              FJAATM                          WCAATM
     I              FJAYNA                          WCAYNA
     I              FJA0NA                          WCA0NA
     I              FJAXDT                          WCAXDT
      *
     I@FJCPSB
      * Load Header               Load Only
      * Renamed input format fields
     I              FJRMNB                          WDRMNB
     I              FJAIC3                          WDAIC3
     I              FJAODT                          WDAODT
     I              FJPJST                          WDPJST
     I              FJPKST                          WDPKST
     I              FJRNNB                          WDRNNB
     I              FJDMTX                          WDDMTX
     I              FJDNTX                          WDDNTX
     I              FJDOTX                          WDDOTX
     I              FJWTTX                          WDWTTX
     I              FJWUTX                          WDWUTX
     I              FJRPNB                          WDRPNB
     I              FJFLAM                          WDFLAM
     I              FJXQST                          WDXQST
     I              FJRRNB                          WDRRNB
     I              FJDXTX                          WDDXTX
     I              FJDYTX                          WDDYTX
     I              FJSBNB                          WDSBNB
     I              FJBZNA                          WDBZNA
     I              FJRONB                          WDRONB
     I              FJSQNB                          WDSQNB
     I              FJR1NB                          WDR1NB
     I              FJVCST                          WDVCST
     I              FJVDST                          WDVDST
     I              FJSDNB                          WDSDNB
     I              FJPAOU                          WDPAOU
     I              FJDGWG                          WDDGWG
     I              FJSXNB                          WDSXNB
     I              FJHADT                          WDHADT
     I              FJAART                          WDAART
     I              FJDHWG                          WDDHWG
     I              FJDIWG                          WDDIWG
     I              FJAQDT                          WDAQDT
     I              FJS6NB                          WDS6NB
     I              FJT4NB                          WDT4NB
     I              FJPRTM                          WDPRTM
     I              FJNPSV                          WDNPSV
     I              FJJ8TX                          WDJ8TX
     I              FJTLMI                          WDTLMI
     I              FJJ9TX                          WDJ9TX
     I              FJQ2CD                          WDQ2CD
     I              FJVPCD                          WDVPCD
     I              FJDBCD                          WDDBCD
     I              FJGRWE                          WDGRWE
     I              FJXCCD                          WDXCCD
     I              FJU2ST                          WDU2ST
     I              FJF9DT                          WDF9DT
     I              FJONTM                          WDONTM
     I              FJJ4DT                          WDJ4DT
     I              FJTRTM                          WDTRTM
     I              FJJ5DT                          WDJ5DT
     I              FJSPTM                          WDSPTM
     I              FJJ6DT                          WDJ6DT
     I              FJLFTM                          WDLFTM
     I              FJJ7DT                          WDJ7DT
     I              FJBOTM                          WDBOTM
     I              FJJ8DT                          WDJ8DT
     I              FJBLTM                          WDBLTM
     I              FJKIDT                          WDKIDT
     I              FJASTM                          WDASTM
     I              FJKADT                          WDKADT
     I              FJAJCM                          WDAJCM
     I              FJXACD                          WDXACD
     I              FJOANA                          WDOANA
     I              FJK4TX                          WDK4TX
     I              FJVOAG                          WDVOAG
     I              FJKBDT                          WDKBDT
     I              FJNBBO                          WDNBBO
     I              FJW4CD                          WDW4CD
     I              FJEFDT                          WDEFDT
     I              FJCNTN                          WDCNTN
     I              FJKCDT                          WDKCDT
     I              FJTMIN                          WDTMIN
     I              FJKDDT                          WDKDDT
     I              FJVMNB                          WDVMNB
     I              FJOCFR                          WDOCFR
     I              FJKJDT                          WDKJDT
     I              FJATTM                          WDATTM
     I              FJOTRS                          WDOTRS
     I              FJRNST                          WDRNST
     I              FJBRBK                          WDBRBK
     I              FJEIDT                          WDEIDT
     I              FJRMST                          WDRMST
     I              FJAJCD                          WDAJCD
     I              FJKKDT                          WDKKDT
     I              FJAVTM                          WDAVTM
     I              FJKZDT                          WDKZDT
     I              FJAXTM                          WDAXTM
     I              FJLHOS                          WDLHOS
     I              FJLHOR                          WDLHOR
     I              FJWNTX                          WDWNTX
     I              FJOITX                          WDOITX
     I              FJOJTX                          WDOJTX
     I              FJLLDT                          WDLLDT
     I              FJLSHG                          WDLSHG
     I              FJYPST                          WDYPST
     I              FJK0DT                          WDK0DT
     I              FJAYTM                          WDAYTM
     I              FJKNNX                          WDKNNX
     I              FJICWG                          WDICWG
     I              FJIDWG                          WDIDWG
     I              FJH9SX                          WDH9SX
     I              FJWOTX                          WDWOTX
     I              FJK1DT                          WDK1DT
     I              FJAZTM                          WDAZTM
     I              FJK2DT                          WDK2DT
     I              FJA0TM                          WDA0TM
     I              FJROST                          WDROST
     I              FJRPST                          WDRPST
     I              FJRQST                          WDRQST
     I              FJRRST                          WDRRST
     I              FJZBVA                          WDZBVA
     I              FJWPTX                          WDWPTX
     I              FJWQTX                          WDWQTX
     I              FJWRTX                          WDWRTX
     I              FJWSTX                          WDWSTX
     I              FJRVSX                          WDRVSX
     I              FJRUSX                          WDRUSX
     I              FJRWSX                          WDRWSX
     I              FJRXSX                          WDRXSX
     I              FJRYSX                          WDRYSX
     I              FJRZSX                          WDRZSX
     I              FJR0SX                          WDR0SX
     I              FJR1SX                          WDR1SX
     I              FJR2SX                          WDR2SX
     I              FJR3SX                          WDR3SX
     I              FJR4SX                          WDR4SX
     I              FJPYDT                          WDPYDT
     I              FJCKTM                          WDCKTM
     I              FJPZDT                          WDPZDT
     I              FJCLTM                          WDCLTM
     I              FJP0DT                          WDP0DT
     I              FJCMTM                          WDCMTM
     I              FJP1DT                          WDP1DT
     I              FJCNTM                          WDCNTM
     I              FJP2DT                          WDP2DT
     I              FJCOTM                          WDCOTM
     I              FJP3DT                          WDP3DT
     I              FJCQTM                          WDCQTM
     I              FJUVST                          WDUVST
     I              FJUWST                          WDUWST
     I              FJUXST                          WDUXST
     I              FJAATM                          WDAATM
     I              FJAYNA                          WDAYNA
     I              FJA0NA                          WDA0NA
     I              FJAXDT                          WDAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WERMNB
     I              FJAIC3                          WEAIC3
     I              FJAODT                          WEAODT
     I              FJPJST                          WEPJST
     I              FJPKST                          WEPKST
     I              FJRNNB                          WERNNB
     I              FJDMTX                          WEDMTX
     I              FJDNTX                          WEDNTX
     I              FJDOTX                          WEDOTX
     I              FJWTTX                          WEWTTX
     I              FJWUTX                          WEWUTX
     I              FJRPNB                          WERPNB
     I              FJFLAM                          WEFLAM
     I              FJXQST                          WEXQST
     I              FJRRNB                          WERRNB
     I              FJDXTX                          WEDXTX
     I              FJDYTX                          WEDYTX
     I              FJSBNB                          WESBNB
     I              FJBZNA                          WEBZNA
     I              FJRONB                          WERONB
     I              FJSQNB                          WESQNB
     I              FJR1NB                          WER1NB
     I              FJVCST                          WEVCST
     I              FJVDST                          WEVDST
     I              FJSDNB                          WESDNB
     I              FJPAOU                          WEPAOU
     I              FJDGWG                          WEDGWG
     I              FJSXNB                          WESXNB
     I              FJHADT                          WEHADT
     I              FJAART                          WEAART
     I              FJDHWG                          WEDHWG
     I              FJDIWG                          WEDIWG
     I              FJAQDT                          WEAQDT
     I              FJS6NB                          WES6NB
     I              FJT4NB                          WET4NB
     I              FJPRTM                          WEPRTM
     I              FJNPSV                          WENPSV
     I              FJJ8TX                          WEJ8TX
     I              FJTLMI                          WETLMI
     I              FJJ9TX                          WEJ9TX
     I              FJQ2CD                          WEQ2CD
     I              FJVPCD                          WEVPCD
     I              FJDBCD                          WEDBCD
     I              FJGRWE                          WEGRWE
     I              FJXCCD                          WEXCCD
     I              FJU2ST                          WEU2ST
     I              FJF9DT                          WEF9DT
     I              FJONTM                          WEONTM
     I              FJJ4DT                          WEJ4DT
     I              FJTRTM                          WETRTM
     I              FJJ5DT                          WEJ5DT
     I              FJSPTM                          WESPTM
     I              FJJ6DT                          WEJ6DT
     I              FJLFTM                          WELFTM
     I              FJJ7DT                          WEJ7DT
     I              FJBOTM                          WEBOTM
     I              FJJ8DT                          WEJ8DT
     I              FJBLTM                          WEBLTM
     I              FJKIDT                          WEKIDT
     I              FJASTM                          WEASTM
     I              FJKADT                          WEKADT
     I              FJAJCM                          WEAJCM
     I              FJXACD                          WEXACD
     I              FJOANA                          WEOANA
     I              FJK4TX                          WEK4TX
     I              FJVOAG                          WEVOAG
     I              FJKBDT                          WEKBDT
     I              FJNBBO                          WENBBO
     I              FJW4CD                          WEW4CD
     I              FJEFDT                          WEEFDT
     I              FJCNTN                          WECNTN
     I              FJKCDT                          WEKCDT
     I              FJTMIN                          WETMIN
     I              FJKDDT                          WEKDDT
     I              FJVMNB                          WEVMNB
     I              FJOCFR                          WEOCFR
     I              FJKJDT                          WEKJDT
     I              FJATTM                          WEATTM
     I              FJOTRS                          WEOTRS
     I              FJRNST                          WERNST
     I              FJBRBK                          WEBRBK
     I              FJEIDT                          WEEIDT
     I              FJRMST                          WERMST
     I              FJAJCD                          WEAJCD
     I              FJKKDT                          WEKKDT
     I              FJAVTM                          WEAVTM
     I              FJKZDT                          WEKZDT
     I              FJAXTM                          WEAXTM
     I              FJLHOS                          WELHOS
     I              FJLHOR                          WELHOR
     I              FJWNTX                          WEWNTX
     I              FJOITX                          WEOITX
     I              FJOJTX                          WEOJTX
     I              FJLLDT                          WELLDT
     I              FJLSHG                          WELSHG
     I              FJYPST                          WEYPST
     I              FJK0DT                          WEK0DT
     I              FJAYTM                          WEAYTM
     I              FJKNNX                          WEKNNX
     I              FJICWG                          WEICWG
     I              FJIDWG                          WEIDWG
     I              FJH9SX                          WEH9SX
     I              FJWOTX                          WEWOTX
     I              FJK1DT                          WEK1DT
     I              FJAZTM                          WEAZTM
     I              FJK2DT                          WEK2DT
     I              FJA0TM                          WEA0TM
     I              FJROST                          WEROST
     I              FJRPST                          WERPST
     I              FJRQST                          WERQST
     I              FJRRST                          WERRST
     I              FJZBVA                          WEZBVA
     I              FJWPTX                          WEWPTX
     I              FJWQTX                          WEWQTX
     I              FJWRTX                          WEWRTX
     I              FJWSTX                          WEWSTX
     I              FJRVSX                          WERVSX
     I              FJRUSX                          WERUSX
     I              FJRWSX                          WERWSX
     I              FJRXSX                          WERXSX
     I              FJRYSX                          WERYSX
     I              FJRZSX                          WERZSX
     I              FJR0SX                          WER0SX
     I              FJR1SX                          WER1SX
     I              FJR2SX                          WER2SX
     I              FJR3SX                          WER3SX
     I              FJR4SX                          WER4SX
     I              FJPYDT                          WEPYDT
     I              FJCKTM                          WECKTM
     I              FJPZDT                          WEPZDT
     I              FJCLTM                          WECLTM
     I              FJP0DT                          WEP0DT
     I              FJCMTM                          WECMTM
     I              FJP1DT                          WEP1DT
     I              FJCNTM                          WECNTM
     I              FJP2DT                          WEP2DT
     I              FJCOTM                          WECOTM
     I              FJP3DT                          WEP3DT
     I              FJCQTM                          WECQTM
     I              FJUVST                          WEUVST
     I              FJUWST                          WEUWST
     I              FJUXST                          WEUXST
     I              FJAATM                          WEAATM
     I              FJAYNA                          WEAYNA
     I              FJA0NA                          WEA0NA
     I              FJAXDT                          WEAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
      * Outward parameters
     IPARC        DS                            793
      * RCD : Load Header               Retrieval index
      * I :  Company Number
     I                                    P   5   60PAAIC3
      * I :  Scheduled Ship Date
     I                                    P   7  100PAAODT
      * I :  Warehouse Code
     I                                      457 459 PAAJCD
      * I : MAP Load U_M
     I                                      703 704 PAR0SX
      *
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WERMNB
     I              FJAIC3                          WEAIC3
     I              FJAODT                          WEAODT
     I              FJPJST                          WEPJST
     I              FJPKST                          WEPKST
     I              FJRNNB                          WERNNB
     I              FJDMTX                          WEDMTX
     I              FJDNTX                          WEDNTX
     I              FJDOTX                          WEDOTX
     I              FJWTTX                          WEWTTX
     I              FJWUTX                          WEWUTX
     I              FJRPNB                          WERPNB
     I              FJFLAM                          WEFLAM
     I              FJXQST                          WEXQST
     I              FJRRNB                          WERRNB
     I              FJDXTX                          WEDXTX
     I              FJDYTX                          WEDYTX
     I              FJSBNB                          WESBNB
     I              FJBZNA                          WEBZNA
     I              FJRONB                          WERONB
     I              FJSQNB                          WESQNB
     I              FJR1NB                          WER1NB
     I              FJVCST                          WEVCST
     I              FJVDST                          WEVDST
     I              FJSDNB                          WESDNB
     I              FJPAOU                          WEPAOU
     I              FJDGWG                          WEDGWG
     I              FJSXNB                          WESXNB
     I              FJHADT                          WEHADT
     I              FJAART                          WEAART
     I              FJDHWG                          WEDHWG
     I              FJDIWG                          WEDIWG
     I              FJAQDT                          WEAQDT
     I              FJS6NB                          WES6NB
     I              FJT4NB                          WET4NB
     I              FJPRTM                          WEPRTM
     I              FJNPSV                          WENPSV
     I              FJJ8TX                          WEJ8TX
     I              FJTLMI                          WETLMI
     I              FJJ9TX                          WEJ9TX
     I              FJQ2CD                          WEQ2CD
     I              FJVPCD                          WEVPCD
     I              FJDBCD                          WEDBCD
     I              FJGRWE                          WEGRWE
     I              FJXCCD                          WEXCCD
     I              FJU2ST                          WEU2ST
     I              FJF9DT                          WEF9DT
     I              FJONTM                          WEONTM
     I              FJJ4DT                          WEJ4DT
     I              FJTRTM                          WETRTM
     I              FJJ5DT                          WEJ5DT
     I              FJSPTM                          WESPTM
     I              FJJ6DT                          WEJ6DT
     I              FJLFTM                          WELFTM
     I              FJJ7DT                          WEJ7DT
     I              FJBOTM                          WEBOTM
     I              FJJ8DT                          WEJ8DT
     I              FJBLTM                          WEBLTM
     I              FJKIDT                          WEKIDT
     I              FJASTM                          WEASTM
     I              FJKADT                          WEKADT
     I              FJAJCM                          WEAJCM
     I              FJXACD                          WEXACD
     I              FJOANA                          WEOANA
     I              FJK4TX                          WEK4TX
     I              FJVOAG                          WEVOAG
     I              FJKBDT                          WEKBDT
     I              FJNBBO                          WENBBO
     I              FJW4CD                          WEW4CD
     I              FJEFDT                          WEEFDT
     I              FJCNTN                          WECNTN
     I              FJKCDT                          WEKCDT
     I              FJTMIN                          WETMIN
     I              FJKDDT                          WEKDDT
     I              FJVMNB                          WEVMNB
     I              FJOCFR                          WEOCFR
     I              FJKJDT                          WEKJDT
     I              FJATTM                          WEATTM
     I              FJOTRS                          WEOTRS
     I              FJRNST                          WERNST
     I              FJBRBK                          WEBRBK
     I              FJEIDT                          WEEIDT
     I              FJRMST                          WERMST
     I              FJAJCD                          WEAJCD
     I              FJKKDT                          WEKKDT
     I              FJAVTM                          WEAVTM
     I              FJKZDT                          WEKZDT
     I              FJAXTM                          WEAXTM
     I              FJLHOS                          WELHOS
     I              FJLHOR                          WELHOR
     I              FJWNTX                          WEWNTX
     I              FJOITX                          WEOITX
     I              FJOJTX                          WEOJTX
     I              FJLLDT                          WELLDT
     I              FJLSHG                          WELSHG
     I              FJYPST                          WEYPST
     I              FJK0DT                          WEK0DT
     I              FJAYTM                          WEAYTM
     I              FJKNNX                          WEKNNX
     I              FJICWG                          WEICWG
     I              FJIDWG                          WEIDWG
     I              FJH9SX                          WEH9SX
     I              FJWOTX                          WEWOTX
     I              FJK1DT                          WEK1DT
     I              FJAZTM                          WEAZTM
     I              FJK2DT                          WEK2DT
     I              FJA0TM                          WEA0TM
     I              FJROST                          WEROST
     I              FJRPST                          WERPST
     I              FJRQST                          WERQST
     I              FJRRST                          WERRST
     I              FJZBVA                          WEZBVA
     I              FJWPTX                          WEWPTX
     I              FJWQTX                          WEWQTX
     I              FJWRTX                          WEWRTX
     I              FJWSTX                          WEWSTX
     I              FJRVSX                          WERVSX
     I              FJRUSX                          WERUSX
     I              FJRWSX                          WERWSX
     I              FJRXSX                          WERXSX
     I              FJRYSX                          WERYSX
     I              FJRZSX                          WERZSX
     I              FJR0SX                          WER0SX
     I              FJR1SX                          WER1SX
     I              FJR2SX                          WER2SX
     I              FJR3SX                          WER3SX
     I              FJR4SX                          WER4SX
     I              FJPYDT                          WEPYDT
     I              FJCKTM                          WECKTM
     I              FJPZDT                          WEPZDT
     I              FJCLTM                          WECLTM
     I              FJP0DT                          WEP0DT
     I              FJCMTM                          WECMTM
     I              FJP1DT                          WEP1DT
     I              FJCNTM                          WECNTM
     I              FJP2DT                          WEP2DT
     I              FJCOTM                          WECOTM
     I              FJP3DT                          WEP3DT
     I              FJCQTM                          WECQTM
     I              FJUVST                          WEUVST
     I              FJUWST                          WEUWST
     I              FJUXST                          WEUXST
     I              FJAATM                          WEAATM
     I              FJAYNA                          WEAYNA
     I              FJA0NA                          WEA0NA
     I              FJAXDT                          WEAXDT
      *
     IYARDCS      DS                            793
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P1AJCD
      * N :  Company Number
     I                                    P   4   50P1AIC3
      * N :  Enterprise Code 1
     I                                        6   9 P1DQCD
      * N :  Enterprise Code 2
     I                                       10  21 P1DRCD
      * N :  Salesperson Code
     I                                       22  24 P1BCCD
      * N :  System Date Format
     I                                       25  27 P1B8NA
      * N :  User Profile Name
     I                                       28  37 P1AJVN
      * N :  Allow Multi-Company
     I                                       38  38 P1I6ST
      * N :  Allow Multi Warehouse
     I                                       39  39 P1I8ST
      * N :  Default Printer
     I                                       40  49 P1MPNA
      * N :  First Time Flag
     I                                       50  50 P1TAST
      * N :  Requested Delivery Date
     I                                    P  51  540P1EIDT
     IP2PARM      DS
      * FLD: *Arrays
      * N :  PRT Description
     I                                        1  25 P2G3TX
      * N :  PRT Printer Device
     I                                       26  35 P2WRST
      * N :  PRT Hold Output Sts
     I                                       36  39 P2WSST
      * N :  PRT Save Output Sts
     I                                       40  43 P2WTST
      * N :  PRT Number of Copies
     I                                       44  450P2DYNB
      * N :  PRT Night Queue Run Sts
     I                                       46  46 P2WUST
      * N :  PRT Night Queue
     I                                       47  56 P2BVVN
      * N :  Company Number Pass   USR
     I                                    P  57  645P2AJAA
      * N :  Date 1          PASS  USR
     I                                    P  65  725P2AJAB
      * N :  Order Number 1  PASS  USR
     I                                    P  73  805P2AJAE
      * N :  System Value Numeric
     I                                    P  81  885P2M8NB
      * N :  Status - Y or N
     I                                       89  89 P2B8ST
      * N :  Change Flag USR
     I                                       90  90 P2HWSX
     IP3PARM      DS
      * FLD: *Arrays
      * N :  Display Prt Opt Pmt USR
     I                                        1   4 P3XFST
      * N :  USR Output Only Status
     I                                        5   5 P3E5ST
      * N :  USR Print Detail
     I                                        6   6 P3E7ST
      * N :  Seq No 1  PASS        USR
     I                                    P   7  145P3SEQ1
      * N :  USR Update Flag
     I                                       15  15 P3R4ST
      * N :  Error Status
     I                                       16  16 P3ECST
      * N :  USR Weight Accumulated
     I                                    P  17  222P3CDWG
     IP4PARM      DS
      * N :  USR Flag 1
     I                                        1   1 P4D4ST
     IP5PARM      DS
      * N :  Job Name CDE
     I                                        1  10 P5B2VN
     IP6PARM      DS
      * FLD: Load Header
      * N :  Load ID
     I                                    P   1   40P6RMNB
      * N :  Carrier Code
     I                                        5   7 P6BZNA
     IP7PARM      DS
      * N :  Job Name
     I                                        1  10 P7A0NA
     IP8PARM      DS
      * N : MAP Stop_Drop
     I                                    P   1   30P8RVNB
     IP9PARM      DS
      * N :  Numeric 4,0           USR
     I                                    P   1   30P9G0NX
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Warehouse Code Required'
      * Warehouse Code
     I                                        1   3 ZA0001
      * Message data for 'Access Denied: Warehouse'
      * User Profile Name
     I                                        1  10 ZA0002
      * Warehouse Code
     I                                       11  13 ZA0003
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0004
      * Condition Name USR
     I                                       11  35 ZA0005
      * Warehouse Code
     I                                       36  38 ZA0006
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0007
      * Condition Name USR
     I                                       11  35 ZA0008
      * Warehouse Code
     I                                       36  38 ZA0009
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0010
      * Condition Name USR
     I                                       11  35 ZA0011
      * Warehouse Code
     I                                       36  38 ZA0012
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0013
      * Condition Name USR
     I                                       11  35 ZA0014
      * Warehouse Code
     I                                       36  38 ZA0015
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0016
      * Condition Name USR
     I                                       11  35 ZA0017
      * Warehouse Code
     I                                       36  38 ZA0018
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0019
      * Condition Name USR
     I                                       11  35 ZA0020
      * Warehouse Code
     I                                       36  38 ZA0021
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0022
      * Condition Name USR
     I                                       11  35 ZA0023
      * Warehouse Code
     I                                       36  38 ZA0024
      * Message data for 'Access Denied: Area'
      * Condition Name 10 USR
     I                                        1  10 ZA0025
      * Condition Name USR
     I                                       11  35 ZA0026
      * Warehouse Code
     I                                       36  38 ZA0027
      * Message data for 'CD3 Non numeric data'
      * Message data for 'EXE Sequel Ld Plan Time'
      * Email Address
     I                                        1  50 ZA0028
      * Message data for 'Company/whs/date req'
      * Company Number
     I                                        1   3 ZA0029
      * Warehouse Code
     I                                        4   6 ZA0030
      * Scheduled Ship Date
     I                                    P   7  100ZA0031
      * Message data for 'OM Load Header not found'
      * Load ID
     I                                    P   1   40ZA0032
      * Message data for 'Must enter date & time'
      * Date                  USR
     I                                    P   1   40ZA0033
      * USR Time 4.0
     I                                    P   5   70ZA0034
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0035
      * Application Code
     I                                       11  16 ZA0036
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0037
      * Application Code
     I                                       11  16 ZA0038
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
      * CASE: PAR.First Time Flag is Yes
     C           P1TAST    IFEQ 'Y'                        *IF
     C                     Z-ADDP1AIC3    #2AIC3           Company Number
     C                     MOVELP1AJCD    #CCPCD           USR Warehouse C
     C                     MOVEL'N'       P1TAST           First Time Flag
     C                     Z-ADD#CG0NX    P9G0NX           Numeric 4,0
     C                     Z-ADD##JDT     #2AODT           Scheduled Ship
     C                     END                             *FI
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2AIC3    WL0001           Company Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #CADTX    P      Name
     C                     MOVEL#2BZNA    #CR6CD           USR Carrier Cod
     C                     MOVEL*BLANK    #CO6NA           Warehouse Desc
      * Warehouse Desc DRV
      * RTV Whse Descrip       RT - Warehouse  * 
     C                     EXSR SBRVGN
      * Val:  Warehouse Code
      * CASE: CTL.USR Warehouse Code is Warehouse Code Blank
     C           #CCPCD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#CCPCD    ZA0001           USR Warehouse C
      * Send message 'Warehouse Code Required'
     C                     MOVEL'USR2015' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO BAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     MOVEL*BLANK    WN0001  1        UWA Inventory T
     C                     MOVEL*BLANK    WN0002  1        UWA Lot Loc Tra
     C                     MOVEL*BLANK    WN0003  1        UWA Shipping Tr
     C                     MOVEL*BLANK    WN0004  1        UWA Cross Appli
     C                     MOVEL*BLANK    WN0005  1        UWA Unused Stat
     C                     MOVEL*BLANK    WN0006  1        UWA Unused Stat
     C                     MOVEL*BLANK    WN0007  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0008  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0009  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0010  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0011  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0012  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0013  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0014  1        UWA Unused Sts
     C                     MOVEL*BLANK    WN0015  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0016  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0017  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0018  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0019  2        UWA Unused Sts
     C                     MOVEL*BLANK    WN0020 10        User Code Model
     C                     MOVEL*BLANK    WN0021  1        Record Found US
      *
      * Val User Whs Access   IF
      * Rtv Profile Model     RT - User Profile Control  * 
     C                     EXSR SCRVGN
      * Retrieve User Warehouse Access Type
      * CASE: PAR.User Code Model is equal to blank
     C           WN0020    IFEQ *BLANK                     *IF
      * Rtv User Whs Access   RT - User Warehouse Access  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##USR     WL0003    P      User Profile Na
     C                     MOVEL#CCPCD    WL0004    P      Warehouse Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    WN0001    P      UWA Inventory T
     C                     MOVELWL0006    WN0002    P      UWA Lot Loc Tra
     C                     MOVELWL0007    WN0003    P      UWA Shipping Tr
     C                     MOVELWL0008    WN0004    P      UWA Cross Appli
     C                     MOVELWL0009    WN0005    P      UWA Unused Stat
     C                     MOVELWL0010    WN0006    P      UWA Unused Stat
     C                     MOVELWL0011    WN0007    P      UWA Unused Sts
     C                     MOVELWL0012    WN0008    P      UWA Unused Sts
     C                     MOVELWL0013    WN0009    P      UWA Unused Sts
     C                     MOVELWL0014    WN0010    P      UWA Unused Sts
     C                     MOVELWL0015    WN0011    P      UWA Unused Sts
     C                     MOVELWL0016    WN0012    P      UWA Unused Sts
     C                     MOVELWL0017    WN0013    P      UWA Unused Sts
     C                     MOVELWL0018    WN0014    P      UWA Unused Sts
     C                     MOVELWL0019    WN0015    P      UWA Unused Sts
     C                     MOVELWL0020    WN0016    P      UWA Unused Sts
     C                     MOVELWL0021    WN0017    P      UWA Unused Sts
     C                     MOVELWL0022    WN0018    P      UWA Unused Sts
     C                     MOVELWL0023    WN0019    P      UWA Unused Sts
     C                     MOVELWL0024    WN0021    P      Record Found US
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv User Whs Access   RT - User Warehouse Access  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0020    WL0003    P      User Profile Na
     C                     MOVEL#CCPCD    WL0004    P      Warehouse Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    WN0001    P      UWA Inventory T
     C                     MOVELWL0006    WN0002    P      UWA Lot Loc Tra
     C                     MOVELWL0007    WN0003    P      UWA Shipping Tr
     C                     MOVELWL0008    WN0004    P      UWA Cross Appli
     C                     MOVELWL0009    WN0005    P      UWA Unused Stat
     C                     MOVELWL0010    WN0006    P      UWA Unused Stat
     C                     MOVELWL0011    WN0007    P      UWA Unused Sts
     C                     MOVELWL0012    WN0008    P      UWA Unused Sts
     C                     MOVELWL0013    WN0009    P      UWA Unused Sts
     C                     MOVELWL0014    WN0010    P      UWA Unused Sts
     C                     MOVELWL0015    WN0011    P      UWA Unused Sts
     C                     MOVELWL0016    WN0012    P      UWA Unused Sts
     C                     MOVELWL0017    WN0013    P      UWA Unused Sts
     C                     MOVELWL0018    WN0014    P      UWA Unused Sts
     C                     MOVELWL0019    WN0015    P      UWA Unused Sts
     C                     MOVELWL0020    WN0016    P      UWA Unused Sts
     C                     MOVELWL0021    WN0017    P      UWA Unused Sts
     C                     MOVELWL0022    WN0018    P      UWA Unused Sts
     C                     MOVELWL0023    WN0019    P      UWA Unused Sts
     C                     MOVELWL0024    WN0021    P      Record Found US
     C                     END                             *FI
      * Validate Access
      * CASE: PAR.Record Found USR is Record Not Found
     C           WN0021    IFEQ 'N'                        *IF
      * Setup message data for message
     C                     MOVEL##USR     ZA0002           User Profile Na
     C                     MOVEL#CCPCD    ZA0003           Warehouse Code
      * Send message 'Access Denied: Warehouse'
     C                     MOVEL'USR2776' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO BAEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Inventory Transactions
      * CASE: PAR.Access Area Needed USR is Inventory Transactions
     C           'S'       IFEQ 'I'                        *IF
      * CASE: PAR.Access Needed USR is Update
     C           'U'       IFEQ 'U'                        *IF
      * CASE: PAR.UWA Inventory Trans is *Not Update
     C           WN0001    IFEQ 'N'                        *IF
     C           WN0001    OREQ 'R'
      *
     C                     MOVEL*BLANK    WN0022 10        Condition Name
     C                     MOVEL*BLANK    WN0023 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0022    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'S'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0023    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0022    ZA0004           Condition Name
     C                     MOVELWN0023    ZA0005           Condition Name
     C                     MOVEL#CCPCD    ZA0006           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO BAEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Access Needed USR is Read
     C           'U'       IFEQ 'R'                        *IF
      * CASE: PAR.UWA Inventory Trans is None
     C           WN0001    IFEQ 'N'                        *IF
      *
     C                     MOVEL*BLANK    WN0024 10        Condition Name
     C                     MOVEL*BLANK    WN0025 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0024    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'S'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0025    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0024    ZA0007           Condition Name
     C                     MOVELWN0025    ZA0008           Condition Name
     C                     MOVEL#CCPCD    ZA0009           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO BAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Lot Loc Transactions
      * CASE: PAR.Access Area Needed USR is Lot Loc Transactions
     C           'S'       IFEQ 'L'                        *IF
      * CASE: PAR.Access Needed USR is Update
     C           'U'       IFEQ 'U'                        *IF
      * CASE: PAR.UWA Lot Loc Trans is *Not Update
     C           WN0002    IFEQ 'N'                        *IF
     C           WN0002    OREQ 'R'
      *
     C                     MOVEL*BLANK    WN0026 10        Condition Name
     C                     MOVEL*BLANK    WN0027 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0026    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'S'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0027    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0026    ZA0010           Condition Name
     C                     MOVELWN0027    ZA0011           Condition Name
     C                     MOVEL#CCPCD    ZA0012           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO BAEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Access Needed USR is Read
     C           'U'       IFEQ 'R'                        *IF
      * CASE: PAR.UWA Lot Loc Trans is None
     C           WN0002    IFEQ 'N'                        *IF
      *
     C                     MOVEL*BLANK    WN0028 10        Condition Name
     C                     MOVEL*BLANK    WN0029 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0028    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'S'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0029    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0028    ZA0013           Condition Name
     C                     MOVELWN0029    ZA0014           Condition Name
     C                     MOVEL#CCPCD    ZA0015           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO BAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Shipping Transactions
      * CASE: PAR.Access Area Needed USR is Shipping Transactions
     C           'S'       IFEQ 'S'                        *IF
      * CASE: PAR.Access Needed USR is Update
     C           'U'       IFEQ 'U'                        *IF
      * CASE: PAR.UWA Shipping Trans is *Not Update
     C           WN0003    IFEQ 'N'                        *IF
     C           WN0003    OREQ 'R'
      *
     C                     MOVEL*BLANK    WN0030 10        Condition Name
     C                     MOVEL*BLANK    WN0031 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0030    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'S'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0031    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0030    ZA0016           Condition Name
     C                     MOVELWN0031    ZA0017           Condition Name
     C                     MOVEL#CCPCD    ZA0018           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO BAEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Access Needed USR is Read
     C           'U'       IFEQ 'R'                        *IF
      * CASE: PAR.UWA Shipping Trans is None
     C           WN0003    IFEQ 'N'                        *IF
      *
     C                     MOVEL*BLANK    WN0032 10        Condition Name
     C                     MOVEL*BLANK    WN0033 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0032    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'S'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0033    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0032    ZA0019           Condition Name
     C                     MOVELWN0033    ZA0020           Condition Name
     C                     MOVEL#CCPCD    ZA0021           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO BAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Cross Applications
      * CASE: PAR.Access Area Needed USR is Cross Applications
     C           'S'       IFEQ 'C'                        *IF
      * CASE: PAR.Access Needed USR is Update
     C           'U'       IFEQ 'U'                        *IF
      * CASE: PAR.UWA Unused Sts is *Not Update
     C           WN0004    IFEQ 'N'                        *IF
     C           WN0004    OREQ 'R'
      *
     C                     MOVEL*BLANK    WN0034 10        Condition Name
     C                     MOVEL*BLANK    WN0035 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0034    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'S'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0035    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0034    ZA0022           Condition Name
     C                     MOVELWN0035    ZA0023           Condition Name
     C                     MOVEL#CCPCD    ZA0024           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO BAEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Access Needed USR is Read
     C           'U'       IFEQ 'R'                        *IF
      * CASE: PAR.UWA Unused Sts is None
     C           WN0004    IFEQ 'N'                        *IF
      *
     C                     MOVEL*BLANK    WN0036 10        Condition Name
     C                     MOVEL*BLANK    WN0037 25        Condition Name
      *
      * Send error message    IF
      * PAR.Condition Name 10 USR = Condition name of PAR.Access Needed U
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1505100   Y2LSNO  70       List number
     C                     PARM 'U'       W0INVL 25        Access Needed U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0036    PARM           W0CNNM 25        Condition Name
      *
      * PAR.Condition Name USR = Condition name of PAR.Access Area Needed
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1539312   Y2LSNO  70       List number
     C                     PARM 'S'       W0INVL 25        Access Area Nee
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0037    PARM           W0CNNM 25        Condition Name
      *
      * Setup message data for message
     C                     MOVELWN0036    ZA0025           Condition Name
     C                     MOVELWN0037    ZA0026           Condition Name
     C                     MOVEL#CCPCD    ZA0027           Warehouse Code
      * Send message 'Access Denied: Area'
     C                     MOVEL'USR2792' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO BAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           FJAODT           Scheduled Ship
     C                     KFLD           FJKZDT           Deadline Depart
     C                     KFLD           FJAXTM           Deadline Depart
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD#2AODT    FJAODT
     C                     Z-ADD#2KZDT    FJKZDT
     C                     Z-ADD#2AXTM    FJAXTM
     C                     Z-ADD#2RMNB    FJRMNB
     C           KPOS      SETLL@FJCPVB
     C                     READ @FJCPVB                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2T4NB    WZT4NB
     C                     MOVEL#2T4NB    WZT4NB           Schedule Sequen
     C           *LIKE     DEFN #2VDST    WZVDST
     C                     MOVEL#2VDST    WZVDST           Load Type
     C           *LIKE     DEFN #2TLMI    WZTLMI
     C                     MOVEL#2TLMI    WZTLMI           Total Load Mile
     C           *LIKE     DEFN #2RPNB    WZRPNB
     C                     MOVEL#2RPNB    WZRPNB           Total Load Orde
     C           *LIKE     DEFN #2DBCD    WZDBCD
     C                     MOVEL#2DBCD    WZDBCD           Ship To State C
     C           *LIKE     DEFN #2KZDT    WZKZDT
     C                     MOVEL#2KZDT    WZKZDT           Deadline Depart
     C           *LIKE     DEFN #2AXTM    WZAXTM
     C                     MOVEL#2AXTM    WZAXTM           Deadline Depart
     C           *LIKE     DEFN #2DXTX    WZDXTX
     C                     MOVEL#2DXTX    WZDXTX           Trailer Id
     C           *LIKE     DEFN #2AIC3    WZAIC3
     C                     MOVEL#2AIC3    WZAIC3           Company Number
     C           *LIKE     DEFN #CO6NA    WZO6NA
     C                     MOVEL#CO6NA    WZO6NA           Warehouse Desc
     C           *LIKE     DEFN #2RMNB    WZRMNB
     C                     MOVEL#2RMNB    WZRMNB           Load ID
     C           *LIKE     DEFN #2AODT    WZAODT
     C                     MOVEL#2AODT    WZAODT           Scheduled Ship
     C           *LIKE     DEFN #2EIDT    WZEIDT
     C                     MOVEL#2EIDT    WZEIDT           Requested Deliv
     C           *LIKE     DEFN #2PKST    WZPKST
     C                     MOVEL#2PKST    WZPKST           Load Status
     C           *LIKE     DEFN #2R0SX    WZR0SX
     C                     MOVEL#2R0SX    WZR0SX           Load U_M
     C           *LIKE     DEFN #2BZNA    WZBZNA
     C                     MOVEL#2BZNA    WZBZNA           Carrier Code
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@FJCPVB                  90*
     C  N82                READ @FJCPVB                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  2
     C                     MOVEAWKIND0    *IN,40
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2T4NB    IFNE *ZERO                      Schedule Sequen
     C           FJT4NB    CABLT#2T4NB    BB020            Schedule Sequen
     C                     END
     C           #2VDST    IFNE *BLANK                     Load Type
     C           FJVDST    CABNE#2VDST    BB020            Load Type
     C                     END
     C           #2RPNB    IFNE *ZERO                      Total Load Orde
     C           FJRPNB    CABGT#2RPNB    BB020            Total Load Orde
     C                     END
     C           #2AODT    IFEQ *ZERO                      Scheduled Ship
     C           #2KZDT    IFNE *ZERO                      Deadline Depart
     C           FJKZDT    CABNE#2KZDT    BB020            Deadline Depart
     C                     END
     C                     END
     C           #2AODT    IFEQ *ZERO                      Scheduled Ship
     C           #2KZDT    OREQ *ZERO                      Deadline Depart
     C           #2AXTM    IFNE *ZERO                      Deadline Depart
     C           FJAXTM    CABNE#2AXTM    BB020            Deadline Depart
     C                     END
     C                     END
     C           #2AODT    IFEQ *ZERO                      Scheduled Ship
     C           #2KZDT    OREQ *ZERO                      Deadline Depart
     C           #2AXTM    OREQ *ZERO                      Deadline Depart
     C           #2RMNB    IFNE *ZERO                      Load ID
     C           FJRMNB    CABNE#2RMNB    BB020            Load ID
     C                     END
     C                     END
     C           #2EIDT    IFNE *ZERO                      Requested Deliv
     C           FJEIDT    CABNE#2EIDT    BB020            Requested Deliv
     C                     END
     C           #2R0SX    IFNE *BLANK                     Load U_M
     C           FJR0SX    CABNE#2R0SX    BB020            Load U_M
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
      * If company selection is made, then select only that company
      * CASE:
      *  - c1 AND c2
      *   |- c1    : CTL.Company Number is not equal to zero
      *   |- c2    : DB1.Company Number NE CTL.Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #2AIC3    IFNE *ZERO                      *IF
     C           FJAIC3    IFNE #2AIC3                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DB1.Multi Company Load is no
     C           FJRVSX    IFEQ 'N'                        *IF
      * RMC 7/27/06 ADDED THIS CASE FOR MULTI-PICKUP LOADS TO BE SEEN BY
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Sel Load by Whs       IF
     C                     MOVEL'N'       W0RSL            *Record selecte
      * Sel Order by Whs      RT - Order Header TRG  * 
     C                     EXSR SERVGN
      * CASE: RCD.Load Status is Entered,Comb,Unlck,Locked
     C           #1PKST    IFEQ 'C'                        *IF
     C           #1PKST    OREQ 'E'
     C           #1PKST    OREQ 'L'
     C           #1PKST    OREQ 'U'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Get customer name for ALL carrier types/load
      * CASE: RCD.Carrier Code is Buyer's Truck
     C           #1BZNA    IFEQ 'BUY'                      *IF
      * Rtv Load Customer - Order Header TRG  * Ship To Customer
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0025           Load ID
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0026    YN0001           AR Customer Num
     C                     Z-ADDWL0027    #RBKC7           Ship To Custome
     C                     Z-ADDWL0028    YN0002           Parent Customer
     C                     Z-ADDWL0029    YN0003           Bill to Custome
      * RTV Customer Name      RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#RBKC7    WL0030           Ship To Custome
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0031    #RAYTX    P      Customer Name
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Last Stop Info    RT - Load Detail  * 
     C                     EXSR SIRVGN
      * RTV Customer Name      RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#RBKC7    WL0030           Ship To Custome
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0031    #RAYTX    P      Customer Name
     C                     END                             *FI
      * If carrier selection is made, then select only that carrier
      * CASE: CTL.Carrier Code is entered
     C           #2BZNA    IFNE *BLANK                     *IF
      * CASE: CTL.Carrier Code is Select Blank Carriers
     C           #2BZNA    IFEQ '*'                        *IF
      * CASE: DB1.Carrier Code is entered
     C           FJBZNA    IFNE *BLANK                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: CTL.Carrier Code NE DB1.Carrier Code
     C           #2BZNA    IFNE FJBZNA                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Fill trailer ID on screen
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVELFJDXTX    #RS2TX           Trailer ID USR
     C                     END                             *FI
      * RST: Scheduled Ship Date
      * CASE: CTL.Scheduled Ship Date is entered
     C           #2AODT    IFNE *ZERO                      *IF
      * CASE: DB1.Scheduled Ship Date NE CTL.Scheduled Ship Date
     C           FJAODT    IFNE #2AODT                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * *----------------------------------------------------------------
      * *----------------------------------------------------------------
      * OMS203:  no updates will be allowed if load contains block orders
      * RTV Any Ord/Blk  on Ld RT - PD Order Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1RMNB    WL0032           Load ID
     C                     MOVEL#RBCST    WL0034    P      Block Order Fla
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0033    WUG0TX    P      USR Check Y/N S
     C                     MOVELWL0034    #RBCST    P      Block Order Fla
     C                     Z-ADDFJT4NB    #RG0NX           Numeric 4,0
     C           FJCMTM    DIV  100       #RT4TM           USR Time 4.0
     C           FJCMTM    DIV  100       #RHLNX           USR To Time 4.0
     C                     Z-ADDFJP0DT    #RMBDT           Date
     C                     MOVEL'N'       P4D4ST           USR Flag 1
     C                     END                             *FI
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C                     READ @FJCPVB                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
      * Set SFLFOLD/SFLDROP from JOB.*Subfile mode
     C                     MOVE ZZSFM     *IN02
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV2AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #2AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Scheduled Ship Date
      * External date
     C                     Z-ADDV2AODT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9935  *
     C                     END
     C                     Z-ADDXDINDT    #2AODT
      * Validate Requested Delivery Date
      * External date
     C                     Z-ADDV2EIDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9936  *
     C                     END
     C                     Z-ADDXDINDT    #2EIDT
      * Validate Load Status
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#2PKST'  IFEQ YPMTFD
      * Load Status
     C                     MOVEL#2PKST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFPKST
     C                     SELEC
     C           W0INVL    WHEQ 'U'                        U
     C                     Z-ADD1         ZFPKST
     C           W0INVL    WHEQ 'L'                        L
     C                     Z-ADD2         ZFPKST
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD3         ZFPKST
     C           W0INVL    WHEQ 'E'                        E
     C                     Z-ADD4         ZFPKST
     C           W0INVL    WHEQ 'C'                        C
     C                     Z-ADD5         ZFPKST
     C           W0INVL    WHEQ 'I'                        I
     C                     Z-ADD6         ZFPKST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD7         ZFPKST
     C                     ENDSL
     C                     EXFMTZEPKST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFPKST    WHEQ 1
     C                     MOVEL'U'       W0INVL           U
     C           ZFPKST    WHEQ 2
     C                     MOVEL'L'       W0INVL           L
     C           ZFPKST    WHEQ 3
     C                     MOVEL'S'       W0INVL           S
     C           ZFPKST    WHEQ 4
     C                     MOVEL'E'       W0INVL           E
     C           ZFPKST    WHEQ 5
     C                     MOVEL'C'       W0INVL           C
     C           ZFPKST    WHEQ 6
     C                     MOVEL'I'       W0INVL           I
     C           ZFPKST    WHEQ 7
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #2PKST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Subfile control function fields
      * f5=refresh
      * CASE: CTL.*CMD key is *Refresh
     C           *IN05     IFEQ '1'                        *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * CASE: CTL.Numeric 4,0           USR is *Zero
     C           #CG0NX    IFEQ *ZERO                      *IF
      * CASE: CTL.Numeric 4,0           USR NE PAR.Numeric 4,0
     C           #CG0NX    IFNE P9G0NX                     *IF
     C                     Z-ADD*ZERO     #2T4NB           Schedule Sequen
     C                     Z-ADD*ZERO     P9G0NX           Numeric 4,0
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#CG0NX    #2T4NB           Schedule Sequen
     C                     Z-ADD#CG0NX    P9G0NX           Numeric 4,0
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END
     C           YPMTFD    CABNE*BLANKS   DATAG1
      * Change of position specified
     C           WZAIC3    CASNE#2AIC3    FBRQRL
     C           WZRMNB    CASNE#2RMNB    FBRQRL
     C           WZAODT    CASNE#2AODT    FBRQRL
     C           WZEIDT    CASNE#2EIDT    FBRQRL
     C           WZPKST    CASNE#2PKST    FBRQRL
     C           WZR0SX    CASNE#2R0SX    FBRQRL
     C           WZBZNA    CASNE#2BZNA    FBRQRL
     C                     END
     C           DATAG1    TAG
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
      * Select
      * CASE: CTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> CTL.Company Number
     C           W0CFL     IFEQ 'V2AIC3'                   *IF
      * SEL Company - plants   SR - Company Name and Address  * 
     C                     CALL 'PPF2SRR'              90  SEL Company - p
     C                     PARM *BLANK    W0RTN   7
     C           #2AIC3    PARM #2AIC3    WQ0001  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPF2SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> CTL.USR Warehouse Code
     C           W0CFL     IFEQ '#CCPCD'                   *IF
      * SEL Warehouse          SR - Warehouse  * 
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #CCPCD    PARM #CCPCD    WQ0002  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> CTL.Carrier Code
     C           W0CFL     IFEQ '#2BZNA'                   *IF
      * SEL Active Carrier     SR - Carrier  * 
     C                     CALL 'OMY6SRR'              90  SEL Active Carr
     C                     PARM *BLANK    W0RTN   7
     C           #2BZNA    PARM #2BZNA    WQ0003  3        Carrier Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'OMY6SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9939  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Reload Subfile if Warehouse Code changed.
      * CASE: PAR.Warehouse Code NE CTL.USR Warehouse Code
     C           P1AJCD    IFNE #CCPCD                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     MOVEL#CCPCD    P1AJCD           Warehouse Code
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * Reload Subfile if F5
      * CASE: CTL.*CMD key is *Refresh
     C           *IN05     IFEQ '1'                        *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * F10=Dsp loads per item
      * CASE: CTL.*CMD key is CF10
     C           *IN10     IFEQ '1'                        *IF
      * WW Load Plan Start-Itm DF - Load Header  * 
     C                     CALL 'PBMHDFR'              90  WW Load Plan St
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0004  30       Company Number
     C                     PARM #2AODT    WQ0005  70       Scheduled Ship
     C                     PARM #CCPCD    WQ0006  3        Ship From Wareh
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBMHDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993135*
     C                     SETON                     32    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * Email it F21
      * CASE: CTL.*CMD key is *Print 21
     C           *IN21     IFEQ '1'                        *IF
      * Req company/whse/date
      * CASE:
      *  - c1ANDc2ANDc3
      *   |- c1    : CTL.Company Number is greater than zero
      *   |- c2    : CTL.USR Warehouse Code is Not Blanks
      *   |- c3    : CTL.Scheduled Ship Date is entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #2AIC3    IFGT *ZERO                      *IF
     C           #CCPCD    IFNE *BLANK                     *IF
     C           #2AODT    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Pmt Enter Email Addr  PV - /UT Report Prompts  * 
     C                     CALL 'POWGPVR'              90  Pmt Enter Email
     C                     PARM *BLANK    W0RTN   7
     C           YL0003    PARM YL0003    WQ0007 50        Email Address
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POWGPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.Email Address is Entered
     C           YL0003    IFNE *BLANK                     *IF
      * LCL.Numeric Field Needed  USR = CTL.Scheduled Ship Date
     C                     Z-ADD#2AODT    YL0004           Numeric Field N
      * W100270 06/09/22 DN-Set '*ALL' If Load U/M is Blank.
      * CASE: CTL.Load U/M is not entered
     C           #2R0SX    IFEQ *BLANK                     *IF
     C                     MOVEL'*ALL'    YL0005           Load U/M Text U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0005           Load U/M Text U
     C                     MOVEL#2R0SX    YL0005           Load U/M Text U
     C                     END                             *FI
      * W100270 06/09/22 DN-Added Load U/M as input parm.
      * EXC Crt WF Load PLanQTEMP - WF Load Plan Start Time  * 
     C                     CALL 'PVB9UPR'              90  EXC Crt WF Load
     C                     PARM 'S'       WQ0008  1        USR Program Mod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVB9UPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * EXC Loan Plan Work File - WF Load Plan Start Time  * 
     C                     CLEARPARC
     C                     Z-ADD#2AIC3    PAAIC3           Company Number
     C                     Z-ADD#2AODT    PAAODT           Scheduled Ship
     C                     MOVEL#CCPCD    PAAJCD    P      Warehouse Code
     C                     MOVEL#2R0SX    PAR0SX    P      Load U_M
      *
     C                     CALL 'PVB8XFR'              90  EXC Loan Plan W
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Load Heade
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVB8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993135*
     C                     SETON                     3238  *
     C                     END
      * Setup message data for message
     C                     MOVELYL0003    ZA0028           Email Address
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR4696' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
      * EXC Crt WF Load PLanQTEMP - WF Load Plan Start Time  * 
     C                     CALL 'PVB9UPR'              90  EXC Crt WF Load
     C                     PARM 'E'       WQ0009  1        USR Program Mod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PVB9UPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0029           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0029           CD3 Ext Numeric
     C                     END                             *FI
     C                     MOVEL#CCPCD    ZA0030           USR Warehouse C
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #2AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0031
      * Send message 'Company/whs/date req'
     C                     MOVEL'USR4697' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993132*
     C                     SETON                     35    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     MOVEL*BLANK    P3R4ST           USR Update Flag
     C                     MOVEL'N'       P3E7ST           USR Print Detai
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * USER: Final processing (Pre-confirm)
      * CASE: PAR.USR Update Flag is No
     C           P3R4ST    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     MOVEL*BLANK    P3R4ST           USR Update Flag
     C                     END                             *FI
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Process subfile (pass 2)
     C                     EXSR EAPRSF
      * If error during 2nd pass exit:
     C           *IN99     CABEQ'1'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,40
     C                     SETOF                     98    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Validate Date                  USR
      * External date
     C                     Z-ADDVRMBDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9840  *
     C                     END
     C                     Z-ADDXDINDT    #RMBDT
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * SFLNXTCHG
     C                     SETON                     84
      * USER: Process subfile record (Pre-confirm)
      * * Ensure have current data  (put miles into wrk context E00207)
      * RTV WW Screen Fields   RT - Load Header  * 
     C                     EXSR SNRVGN
      * Error if Load Header Not Found
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#1RMNB    ZA0032           Load ID
      * Send message 'OM Load Header not found'
     C                     MOVEL'USR2313' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
     C                     MOVEL#1DXTX    #RS2TX           Trailer ID USR
      * Validate lpt date and time
      * CASE:
      *  - (c1ANDc2) OR (c3ANDc4)
      *   |- c1    : RCD.USR Time 4.0 is Entered
      *   |- c2    : RCD.Date                  USR is Not Entered
      *   |- c3    : RCD.Date                  USR GT WRK.ZERO
      *   |- c4    : RCD.USR Time 4.0 is Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #RT4TM    IFNE 0                          *IF
     C           #RMBDT    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           #RMBDT    IFGT WUW0NB                     *IF
     C           #RT4TM    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
      * Convert Date                  USR to display format
      * Convert date
     C           1000000   ADD  #RMBDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0033
     C                     Z-ADD#RT4TM    ZA0034           USR Time 4.0
      * Send message 'Must enter date & time'
     C                     MOVEL'USR4698' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     984041*
      *
     C                     END                             *FI
      * CASE:
      *  - c1ORc2
      *   |- c1    : RCD.USR Time 4.0 NE RCD.USR To Time 4.0
      *   |- c2    : RCD.LPT Load Plan Start Dt NE RCD.Date
      *   '-
     C           #RT4TM    IFNE #RHLNX                     *IF
     C           #1P0DT    ORNE #RMBDT                     *OR
     C                     MOVEL'Y'       P3R4ST           USR Update Flag
     C                     END                             *FI
      * screen displays state of last stop on load, so get that field aga
      * do this @end of validate, so that processing will use REAL ship t
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
      * Set SFLFOLD/SFLDROP from JOB.*Subfile mode
     C                     MOVE ZZSFM     *IN02
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
     C           *IN81     IFEQ '1'
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END                             WOD *92
     C                     END                             FI *81
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      * USER: Final processing (Post-confirm)
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,40
     C                     SETOF                     98
      * USER: Process subfile record (Post-confirm)
      * CASE: RCD.USR Time 4.0 is Entered
     C           #RT4TM    IFNE 0                          *IF
     C           #RT4TM    MULT 100       YL0006           LPT Load Plan S
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0006           LPT Load Plan S
     C                     END                             *FI
      * RTV Chg LPT Start Tm  RT - Load Header  * 
     C                     EXSR SORVGN
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C                     SETON                     84    SFLNXTCHG
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     GOTO EBEXIT
     C                     ELSE
      * SFLRCD valid
     C                     SETOF                     84    SFLNXTCHG
     C                     END                             FI *IN98
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
     C                     MOVEL'0'       *IN77
     C           #RKOST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C                     MOVEL'0'       *IN79
     C           P1I6ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           P1I8ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @FJCPVB fields to subfile
      *================================================================
     C                     Z-ADDFJAIC3    #1AIC3           Company Number
     C                     Z-ADDFJCMTM    #1CMTM           LPT Load Plan S
     C                     Z-ADDFJT4NB    #1T4NB           Schedule Sequen
     C                     Z-ADDFJPRTM    #1PRTM           Product Tempera
     C                     Z-ADDFJNPSV    #1NPSV           Number Spacers
     C                     MOVELFJJ9TX    #1J9TX           Recorder ID
     C                     MOVELFJQ2CD    #1Q2CD           Shipping Method
     C                     MOVELFJVPCD    #1VPCD           Ship From Wareh
     C                     MOVELFJPJST    #1PJST           LTL Flag
     C                     MOVELFJVDST    #1VDST           Load Type
     C                     Z-ADDFJTLMI    #1TLMI           Total Load Mile
     C                     Z-ADDFJRNNB    #1RNNB           Reefer Temperat
     C                     MOVELFJDMTX    #1DMTX           Seal 1
     C                     MOVELFJDNTX    #1DNTX           Seal 2
     C                     MOVELFJDOTX    #1DOTX           Seal 3
     C                     MOVELFJWTTX    #1WTTX           Seal 4
     C                     MOVELFJWUTX    #1WUTX           Seal 2 Unused
     C                     Z-ADDFJRPNB    #1RPNB           Total Load Orde
     C                     MOVELFJDBCD    #1DBCD           Ship To State C
     C                     Z-ADDFJGRWE    #1GRWE           Gross Weight
     C                     MOVELFJU2ST    #1U2ST           Export Status
     C                     Z-ADDFJF9DT    #1F9DT           Actual Ship Dat
     C                     MOVELFJONTM    #1ONTM           On Time_Y_N
     C                     Z-ADDFJJ4DT    #1J4DT           Truck Ready Dat
     C                     Z-ADDFJTRTM    #1TRTM           Truck Ready Tim
     C                     Z-ADDFJJ5DT    #1J5DT           Spotted Date
     C                     Z-ADDFJSPTM    #1SPTM           Spotted Time
     C                     Z-ADDFJJ6DT    #1J6DT           Load Finished D
     C                     Z-ADDFJLFTM    #1LFTM           Load Finished T
     C                     Z-ADDFJJ7DT    #1J7DT           BOL Complete Da
     C                     Z-ADDFJBOTM    #1BOTM           BOL Complete Ti
     C                     Z-ADDFJJ8DT    #1J8DT           BOL Received Da
     C                     Z-ADDFJBLTM    #1BLTM           BOL Received Ti
     C                     Z-ADDFJKIDT    #1KIDT           Truck Departure
     C                     Z-ADDFJASTM    #1ASTM           Truck Departure
     C                     Z-ADDFJKADT    #1KADT           Adjusted Depart
     C                     Z-ADDFJAJCM    #1AJCM           Adjusted Depart
     C                     MOVELFJXACD    #1XACD           Shipping Line
     C                     MOVELFJOANA    #1OANA           Port Delv Termi
     C                     MOVELFJK4TX    #1K4TX           Vessel Name
     C                     Z-ADDFJVOAG    #1VOAG           Voyage
     C                     Z-ADDFJKBDT    #1KBDT           Sail Date
     C                     MOVELFJNBBO    #1NBBO           Booking Number
     C                     MOVELFJW4CD    #1W4CD           Discharge Port
     C                     Z-ADDFJEFDT    #1EFDT           Arrival Date
     C                     MOVELFJCNTN    #1CNTN           Container Numbe
     C                     Z-ADDFJKCDT    #1KCDT           Date In
     C                     Z-ADDFJTMIN    #1TMIN           Time In
     C                     Z-ADDFJKDDT    #1KDDT           Date Out
     C                     Z-ADDFJVMNB    #1VMNB           Time Out
     C                     Z-ADDFJOCFR    #1OCFR           Load Total Frei
     C                     Z-ADDFJKJDT    #1KJDT           Scheduled Deliv
     C                     Z-ADDFJATTM    #1ATTM           Scheduled Deliv
     C                     MOVELFJOTRS    #1OTRS           LH Unused Sts
     C                     MOVELFJRNST    #1RNST           LH Carrier Paym
     C                     Z-ADDFJBRBK    #1BRBK           Bring Back Mile
     C                     MOVELFJRMST    #1RMST           Load Acceptance
     C                     MOVELFJAJCD    #1AJCD           Warehouse Code
     C                     Z-ADDFJKKDT    #1KKDT           On Yard Date
     C                     Z-ADDFJAVTM    #1AVTM           On Yard Time
     C                     MOVELFJLHOS    #1LHOS           Load Held Over
     C                     MOVELFJLHOR    #1LHOR           Load Held Over
     C                     MOVELFJWNTX    #1WNTX           Load Held Over
     C                     MOVELFJOITX    #1OITX           Ocean BOL Numbe
     C                     MOVELFJOJTX    #1OJTX           Express Mail Nu
     C                     Z-ADDFJLLDT    #1LLDT           Express Mail Da
     C                     MOVELFJLSHG    #1LSHG           Load Shag Flag
     C                     MOVELFJYPST    #1YPST           Load Wash Flag
     C                     Z-ADDFJK0DT    #1K0DT           Product Complet
     C                     Z-ADDFJAYTM    #1AYTM           Product Complet
     C                     Z-ADDFJKNNX    #1KNNX           Pallets Loaded
     C                     Z-ADDFJICWG    #1ICWG           Avg Pallet Tare
     C                     Z-ADDFJIDWG    #1IDWG           Tot Pallet Tare
     C                     MOVELFJH9SX    #1H9SX           Load Confirmed
     C                     MOVELFJWOTX    #1WOTX           Load Confirmed
     C                     Z-ADDFJK1DT    #1K1DT           Load Confirmati
     C                     Z-ADDFJAZTM    #1AZTM           Load Door 1
     C                     Z-ADDFJK2DT    #1K2DT           Override Total
     C                     Z-ADDFJA0TM    #1A0TM           Load Door 2
     C                     MOVELFJROST    #1ROST           Partial Load
     C                     MOVELFJRPST    #1RPST           Load Confirmati
     C                     MOVELFJRQST    #1RQST           Export Load USD
     C                     MOVELFJRRST    #1RRST           Late Delivery E
     C                     Z-ADDFJZBVA    #1ZBVA           Load Actual Fre
     C                     MOVELFJWPTX    #1WPTX           Hide on WW Load
     C                     MOVELFJWQTX    #1WQTX           Late Billing Em
     C                     MOVELFJWRTX    #1WRTX           Shipping Temp C
     C                     MOVELFJWSTX    #1WSTX           LH Held Over Rs
     C                     MOVELFJRVSX    #1RVSX           Multi Company L
     C                     MOVELFJRUSX    #1RUSX           Fax Sent to SSI
     C                     MOVELFJRWSX    #1RWSX           Schedule Pos Lo
     C                     MOVELFJRXSX    #1RXSX           LH Power Only L
     C                     MOVELFJRYSX    #1RYSX           MG Created Load
     C                     MOVELFJRZSX    #1RZSX           LH Unused Sts 5
     C                     MOVELFJR1SX    #1R1SX           TPM Shipment St
     C                     MOVELFJR2SX    #1R2SX           LH Unused Sts 8
     C                     MOVELFJR3SX    #1R3SX           LH On-Time Reas
     C                     MOVELFJR4SX    #1R4SX           LH Held Over Re
     C                     Z-ADDFJPYDT    #1PYDT           LH Carrier Paid
     C                     Z-ADDFJCKTM    #1CKTM           LH Carrier Paid
     C                     Z-ADDFJPZDT    #1PZDT           LH Last Combo P
     C                     Z-ADDFJCLTM    #1CLTM           LH Last Combo P
     C                     Z-ADDFJP0DT    #1P0DT           LPT Load Plan S
     C                     Z-ADDFJCNTM    #1CNTM           LH Unused Time
     C                     Z-ADDFJP2DT    #1P2DT           LH Unused Date
     C                     Z-ADDFJCOTM    #1COTM           LH Unused Time
     C                     Z-ADDFJP3DT    #1P3DT           LH Unused Date
     C                     Z-ADDFJCQTM    #1CQTM           LH Unused Time
     C                     MOVELFJJ8TX    #1J8TX           Car_Veh_Initial
     C                     Z-ADDFJFLAM    #1FLAM           Flat Amount
     C                     MOVELFJXQST    #1XQST           Allocate Pounds
     C                     Z-ADDFJRRNB    #1RRNB           Total Stops
     C                     MOVELFJDXTX    #1DXTX           Trailer Id
     C                     MOVELFJDYTX    #1DYTX           Transloader Car
     C                     Z-ADDFJSBNB    #1SBNB           BOL Time
     C                     Z-ADDFJP1DT    #1P1DT           TPM Planned Shi
     C                     MOVELFJXCCD    #1XCCD           Carrier Broker
     C                     MOVELFJRONB    #1RONB           Truck Size
     C                     Z-ADDFJSQNB    #1SQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADDFJR1NB    #1R1NB           Rated Freight
     C                     MOVELFJVCST    #1VCST           Ship Status
     C                     Z-ADDFJSDNB    #1SDNB           Number Pallets
     C                     Z-ADDFJPAOU    #1PAOU           Number Pallets
     C                     Z-ADDFJDGWG    #1DGWG           Load Carrier Pa
     C                     Z-ADDFJSXNB    #1SXNB           Estimated Arriv
     C                     Z-ADDFJHADT    #1HADT           Actual Arrival
     C                     Z-ADDFJAART    #1AART           Actual Arrival
     C                     Z-ADDFJDHWG    #1DHWG           Trailer IN Weig
     C                     Z-ADDFJDIWG    #1DIWG           Trailer OUT Wei
     C                     Z-ADDFJAQDT    #1AQDT           Actual Departur
     C                     Z-ADDFJS6NB    #1S6NB           Departure Time
     C                     MOVELFJUVST    #1UVST           EDI Status 1
     C                     MOVELFJUWST    #1UWST           EDI Status 2
     C                     MOVELFJUXST    #1UXST           EDI Status 3
     C                     Z-ADDFJAATM    #1AATM           Job Time
     C                     MOVELFJAYNA    #1AYNA           User Id
     C                     MOVELFJA0NA    #1A0NA           Job Name
     C                     Z-ADDFJAXDT    #1AXDT           Job Date
     C                     Z-ADDFJRMNB    #1RMNB           Load ID
     C                     Z-ADDFJAODT    #1AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V1AODT
     C                     Z-ADDFJKZDT    #1KZDT           Deadline Depart
      * Clear external version also
     C                     Z-ADD*ZERO     V1KZDT
     C                     Z-ADDFJAXTM    #1AXTM           Deadline Depart
     C                     Z-ADDFJEIDT    #1EIDT           Requested Deliv
      * Clear external version also
     C                     Z-ADD*ZERO     V1EIDT
     C                     MOVELFJPKST    #1PKST           Load Status
     C                     MOVELFJR0SX    #1R0SX           Load U_M
     C                     MOVELFJBZNA    #1BZNA           Carrier Code
     C                     MOVEL*BLANK    #RHPNA           Ship To Address
     C                     MOVEL*BLANK    #RHONA           Ship To Address
     C                     MOVEL*BLANK    #RHMNA           Ship To Address
     C                     Z-ADD*ZERO     #RBKC7           Ship To Custome
     C                     Z-ADD*ZERO     #RC4NB           Order Number
     C                     Z-ADD*ZERO     #RHLNX           USR To Time 4.0
     C                     MOVEL*BLANK    #RKOST           Include Todays
     C                     MOVEL*BLANK    #RBCST           Block Order Fla
     C                     MOVEL*BLANK    #RXBCD           Sail Port State
     C                     Z-ADD*ZERO     #RG1NX           Total Miles 4,0
     C                     MOVEL*BLANK    #RHWSX           Change Flag USR
     C                     Z-ADD*ZERO     #RG2NX           Weight Adjust 6
     C                     MOVEL*BLANK    #RHNNA           Ship To City
     C                     MOVEL*BLANK    #RLINA           USR Load/Stop 1
     C                     MOVEL*BLANK    #RV9CD           USR State Code
     C                     MOVEL*BLANK    #RB8ST           Status - Y or N
     C                     Z-ADD*ZERO     #RG0NX           Numeric 4,0
     C                     Z-ADD*ZERO     #RMBDT           Date
      * Clear external version also
     C                     Z-ADD*ZERO     VRMBDT
     C                     Z-ADD*ZERO     #RT4TM           USR Time 4.0
     C                     MOVEL*BLANK    #RS2TX           Trailer ID USR
     C                     MOVEL*BLANK    #RAYTX           Customer Name
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     Z-ADDP8RVNB    #PRVNB           Stop_Drop
     C                     MOVEL*BLANK    #CR6CD           USR Carrier Cod
     C                     MOVEL*BLANK    #CVQCD           Include/Exclude
     C                     Z-ADD*ZERO     #2T4NB           Schedule Sequen
     C                     Z-ADD*ZERO     #CG1NX           Total Miles 4,0
     C                     MOVEL*BLANK    #2VDST           Load Type
     C                     Z-ADD*ZERO     #2TLMI           Total Load Mile
     C                     Z-ADD*ZERO     #CG2NX           Weight Adjust 6
     C                     Z-ADD*ZERO     #2RPNB           Total Load Orde
     C                     MOVEL*BLANK    #CHNNA           Ship To City
     C                     MOVEL*BLANK    #CLINA           USR Load/Stop 1
     C                     MOVEL*BLANK    #2DBCD           Ship To State C
     C                     Z-ADD*ZERO     #2KZDT           Deadline Depart
     C                     Z-ADD*ZERO     #2AXTM           Deadline Depart
     C                     MOVEL*BLANK    #2DXTX           Trailer Id
     C                     MOVEL*BLANK    #CS2TX           Trailer ID USR
     C                     MOVEL*BLANK    #CB8ST           Status - Y or N
     C                     Z-ADD*ZERO     #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     MOVEL*BLANK    #CADTX           Name
     C                     MOVEL*BLANK    #CCPCD           USR Warehouse C
     C                     MOVEL*BLANK    #CO6NA           Warehouse Desc
     C                     Z-ADD*ZERO     #2RMNB           Load ID
     C                     Z-ADD*ZERO     #CG0NX           Numeric 4,0
     C                     Z-ADD*ZERO     #2AODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     V2AODT
     C                     Z-ADD*ZERO     #2EIDT           Requested Deliv
      * Clear external version also
     C                     Z-ADD*ZERO     V2EIDT
     C                     MOVEL*BLANK    #2PKST           Load Status
     C                     MOVEL*BLANK    #2R0SX           Load U_M
     C                     MOVEL*BLANK    #2BZNA           Carrier Code
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Date                  USR to display format
      * Convert date
     C           1000000   ADD  #RMBDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VRMBDT
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #1AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1AODT
      * Convert Deadline Departure Date to display format
      * Convert date
     C           1000000   ADD  #1KZDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1KZDT
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #1EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1EIDT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #2AODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2AODT
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #2EIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2EIDT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0001    ABAIC3           Company Number
      * Establish starting position
     C           KRSSA     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Name
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    WL0002           Name
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Whse Descrip       RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#CCPCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSB     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #CO6NA           Warehouse Descr
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELADF8NA    #CO6NA           Warehouse Descr
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Profile Model     RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSC     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0020           User Code Model
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRBUVN    WN0020           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv User Whs Access   RT - User Warehouse Access  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           L1AJVN           User Profile Na
     C                     KFLD           L1AJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0003    L1AJVN           User Profile Na
     C                     MOVELWL0004    L1AJCD           Warehouse Code
      * Establish starting position
     C           KRSSD     CHAIN@L1RESJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2626' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0005           UWA Inventory T
     C                     MOVEL*BLANK    WL0006           UWA Lot Loc Tra
     C                     MOVEL*BLANK    WL0007           UWA Shipping Tr
     C                     MOVEL*BLANK    WL0008           UWA Cross Appli
     C                     MOVEL*BLANK    WL0009           UWA Unused Stat
     C                     MOVEL*BLANK    WL0010           UWA Unused Stat
     C                     MOVEL*BLANK    WL0011           UWA Unused Sts
     C                     MOVEL*BLANK    WL0012           UWA Unused Sts
     C                     MOVEL*BLANK    WL0013           UWA Unused Sts
     C                     MOVEL*BLANK    WL0014           UWA Unused Sts
     C                     MOVEL*BLANK    WL0015           UWA Unused Sts
     C                     MOVEL*BLANK    WL0016           UWA Unused Sts
     C                     MOVEL*BLANK    WL0017           UWA Unused Sts
     C                     MOVEL*BLANK    WL0018           UWA Unused Sts
     C                     MOVEL*BLANK    WL0019           UWA Unused Sts
     C                     MOVEL*BLANK    WL0020           UWA Unused Sts
     C                     MOVEL*BLANK    WL0021           UWA Unused Sts
     C                     MOVEL*BLANK    WL0022           UWA Unused Sts
     C                     MOVEL*BLANK    WL0023           UWA Unused Sts
     C                     MOVEL*BLANK    WL0024           Record Found US
     C                     MOVEL'N'       WL0024           Record Found US
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELL1UWAS    WL0005           UWA Inventory T
     C                     MOVELL1EPSX    WL0006           UWA Lot Loc Tra
     C                     MOVELL1EQSX    WL0007           UWA Shipping Tr
     C                     MOVELL1ERSX    WL0008           UWA Cross Appli
     C                     MOVELL1UWAT    WL0009           UWA Unused Stat
     C                     MOVELL1EKSX    WL0010           UWA Unused Stat
     C                     MOVELL1ECSX    WL0011           UWA Unused Sts
     C                     MOVELL1EDSX    WL0012           UWA Unused Sts
     C                     MOVELL1EESX    WL0013           UWA Unused Sts
     C                     MOVELL1EFSX    WL0014           UWA Unused Sts
     C                     MOVELL1EGSX    WL0015           UWA Unused Sts
     C                     MOVELL1EHSX    WL0016           UWA Unused Sts
     C                     MOVELL1EISX    WL0017           UWA Unused Sts
     C                     MOVELL1EJSX    WL0018           UWA Unused Sts
     C                     MOVELL1UWAU    WL0019           UWA Unused Sts
     C                     MOVELL1ELSX    WL0020           UWA Unused Sts
     C                     MOVELL1EMSX    WL0021           UWA Unused Sts
     C                     MOVELL1ENSX    WL0022           UWA Unused Sts
     C                     MOVELL1EOSX    WL0023           UWA Unused Sts
     C                     MOVEL'Y'       WL0024           Record Found US
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Sel Order by Whs      RT - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0038  1        Whs Ord Found S
     C                     Z-ADD*ZERO     WN0039  50       Count USR
     C                     Z-ADD*ZERO     WN0040  50       Count 2 USR
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
     C                     MOVEL*BLANK    WUD9SX           Whs Ord Ship St
     C                     Z-ADD*ZERO     WN0039           Count USR
     C                     Z-ADD*ZERO     WN0040           Count 2 USR
     C                     MOVEL'N'       WUFBSX           Plant Controlle
      * Declare restrictor key work fields
     C           *LIKE     DEFN BERMNB    WQSE02           Load ID
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSE02           Load ID
      * Establish starting position
     C           KRSSE     SETLL@BFCPD9                    *
     C           KRSSE     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Sel Order by Whs      RT - Order Detail  * 
     C                     EXSR SFRVGN
      * CASE: DB1.Trans Contol AS400/Plant is Plant
     C           BEXUST    IFEQ 'P'                        *IF
     C                     MOVEL'Y'       WUFBSX           Plant Controlle
     C                     END                             *FI
      * CASE: PAR.Whs Ord Found STS is yes
     C           WN0038    IFEQ 'Y'                        *IF
      * CASE: DB1.Header Status is Confirmed & Complete
     C           BEGWST    IFEQ 'C'                        *IF
     C           BEGWST    OREQ 'R'
     C                     ADD  1         WN0039           Count USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WN0040           Count 2 USR
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSE     READE@BFCPD9                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.Count USR is GT 0
     C           WN0039    IFGT 0                          *IF
      * CASE: PAR.Count 2 USR is Greater than zero
     C           WN0040    IFGT 0                          *IF
     C                     MOVEL'P'       WUD9SX           Whs Ord Ship St
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'A'       WUD9SX           Whs Ord Ship St
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Sel Order by Whs      RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WN0038           Whs Ord Found S
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSF01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSF02           Order Number
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Order Number
      * Setup key
     C                     Z-ADDBEAIC3    WQSF01           Company Number
     C                     Z-ADDBEC4NB    WQSF02           Order Number
      * Establish starting position
     C           KRSSF     SETLL@BGWKL1                    *
     C           KRSSF     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           OMGMST    IFEQ 'L'                        *IF
     C           OMGMST    OREQ 'A'
     C           OMGMST    OREQ 'C'
     C           OMGMST    OREQ 'R'
     C           OMGMST    OREQ 'E'
     C           OMGMST    OREQ 'H'
     C           OMGMST    OREQ 'I'
      * CASE: PAR.Warehouse Code EQ DB1.Warehouse Code
     C           #CCPCD    IFEQ OMAJCD                     *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     MOVEL'Y'       WN0038           Whs Ord Found S
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSF     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Load Customer - Order Header TRG  * Ship To Customer
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0026           AR Customer Num
     C                     Z-ADD*ZERO     WL0027           Ship To Custome
     C                     Z-ADD*ZERO     WL0028           Parent Customer
     C                     Z-ADD*ZERO     WL0029           Bill to Custome
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQSG02           Load ID
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG02           Load ID
      * Setup key
     C                     Z-ADDWL0025    WQSG02           Load ID
      * Establish starting position
     C           KRSSG     SETLL@BFCPRQ                    *
     C           KRSSG     READE@BFCPRQ                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAANC7    WL0026           AR Customer Num
     C                     Z-ADDWABKC7    WL0027           Ship To Custome
     C                     Z-ADDWAB0C7    WL0029           Bill to Custome
     C                     GOTO SGEXIT                     *QUIT
     C           KRSSG     READE@BFCPRQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Customer Name      RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0030    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSH     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0031           Customer Name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBAYTX    WL0031           Customer Name
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Last Stop Info    RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSI02           Load ID
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSI02           Load ID
      * Establish starting position
     C           KRSSI     SETLL@FLCPE8                    *
     C           KRSSI     READE@FLCPE8                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Last Stop Info     RT - Order Header TRG  * 
     C                     EXSR SJRVGN
      * RTV Salesman Code      RT - Sales Route  * 
     C                     EXSR SKRVGN
      * RTV Salesperson Name   RT - Salesperson  * 
     C                     EXSR SLRVGN
     C                     GOTO SIEXIT                     *QUIT
     C           KRSSI     READE@FLCPE8                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Last Stop Info     RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    WBAIC3           Company Number
     C                     Z-ADDFLC4NB    WBC4NB           Order Number
      * Establish starting position
     C           KRSSJ     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBBKC7    #RBKC7           Ship To Custome
     C                     MOVELWBBCNA    WUG0TX           Customer Purcha
     C                     MOVELWBB6NA    WUG0TX           Special Instruc
     C                     MOVELWBBYNA    WUG0TX           Special Instruc
     C                     Z-ADDWBEIDT    WUNFNN           Requested Deliv
     C                     Z-ADDWBAFTM    WUNFNN           Requested Deliv
     C                     MOVELWBR4CD    YL0001           Sales Route Cod
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Salesman Code      RT - Sales Route  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           JER4CD           Sales Route Cod
      * Setup key
     C                     MOVELYL0001    JER4CD           Sales Route Cod
      * Establish starting position
     C           KRSSK     CHAIN@JEREWS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1800' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0002           Salesperson Cod
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJEBCCD    YL0002           Salesperson Cod
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Salesperson Name   RT - Salesperson  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           APBCCD           Salesperson Cod
      * Setup key
     C                     MOVELYL0002    APBCCD           Salesperson Cod
      * Establish starting position
     C           KRSSL     CHAIN@APREBU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0002           Salesperson Cod
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAPBCCD    YL0002           Salesperson Cod
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Any Ord/Blk  on Ld RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
     C                     MOVEL*BLANK    WL0033           USR Check Y/N S
      * OMS203:  need to know if there are any Block orders on load
     C                     MOVEL'F'       WL0034           Block Order Fla
      * Declare restrictor key work fields
     C           *LIKE     DEFN BERMNB    WQSM02           Load ID
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM02           Load ID
      * Setup key
     C                     Z-ADDWL0032    WQSM02           Load ID
      * Establish starting position
     C           KRSSM     SETLL@BFCPD9                    *
     C           KRSSM     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0033           USR Check Y/N S
      * CASE: DB1.Block Order Flag is Block Order
     C           BEBCST    IFEQ 'B'                        *IF
     C                     MOVELBEBCST    WL0034           Block Order Fla
     C                     GOTO SMEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSM     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV WW Screen Fields   RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WCRMNB           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WCRMNB           Load ID
      * Establish starting position
     C           KRSSN     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCAODT    #1AODT           Scheduled Ship
     C                     MOVELWCPKST    #1PKST           Load Status
     C                     Z-ADDWCRPNB    #1RPNB           Total Load Orde
     C                     Z-ADDWCFLAM    #1FLAM           Flat Amount
     C                     MOVELWCXQST    #1XQST           Allocate Pounds
     C                     MOVELWCDXTX    #1DXTX           Trailer Id
     C                     MOVELWCBZNA    #1BZNA           Carrier Code
     C                     MOVELWCRONB    #1RONB           Truck Size
     C                     MOVELWCVDST    #1VDST           Load Type
     C                     Z-ADDWCT4NB    #1T4NB           Schedule Sequen
     C                     Z-ADDWCTLMI    WUTLMI           Total Load Mile
     C                     MOVELWCQ2CD    #1Q2CD           Shipping Method
     C                     MOVELWCVPCD    #1VPCD           Ship From Wareh
     C                     MOVELWCDBCD    #1DBCD           Ship To State C
     C                     MOVELWCRMST    #1RMST           Load Acceptance
     C                     Z-ADDWCIDWG    #1IDWG           Tot Pallet Tare
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Chg LPT Start Tm  RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQSO02           Load ID
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO02           Load ID
      * Setup key
     C                     Z-ADD#1RMNB    WQSO02           Load ID
      * Establish starting position
     C           KRSSO     SETLL@FJCPSB                    *
     C           KRSSO     READE@FJCPSB                  90*
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG LPT Start time    CH - Load Header  * 
     C                     EXSR SPCHRC
     C           KRSSO     READE@FJCPSB                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCHRC    BEGSR
      *================================================================
      * CHG LPT Start time    CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0041  30       Company Number
     C                     Z-ADD*ZERO     WN0042  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0043  1        LTL Flag
     C                     MOVEL*BLANK    WN0044  1        Load Status
     C                     Z-ADD*ZERO     WN0045  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0046 15        Seal 1
     C                     MOVEL*BLANK    WN0047 15        Seal 2
     C                     MOVEL*BLANK    WN0048 15        Seal 3
     C                     MOVEL*BLANK    WN0049 15        Seal 4
     C                     MOVEL*BLANK    WN0050 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0051  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0052 112       Flat Amount
     C                     MOVEL*BLANK    WN0053  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0054  50       Total Stops
     C                     MOVEL*BLANK    WN0055 20        Trailer Id
     C                     MOVEL*BLANK    WN0056  3        Transloader Car
     C                     Z-ADD*ZERO     WN0057  40       BOL Time
     C                     MOVEL*BLANK    WN0058  3        Carrier Code
     C                     MOVEL*BLANK    WN0059  7        Truck Size
     C                     Z-ADD*ZERO     WN0060  70       Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WN0061 112       Rated Freight
     C                     MOVEL*BLANK    WN0062  1        Ship Status
     C                     MOVEL*BLANK    WN0063  1        Load Type
     C                     Z-ADD*ZERO     WN0064  50       Number Pallets
     C                     Z-ADD*ZERO     WN0065  50       Number Pallets
     C                     Z-ADD*ZERO     WN0066 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0067  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0068  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0069  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0070 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0071 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0072  70       Actual Departur
     C                     Z-ADD*ZERO     WN0073  40       Departure Time
     C                     Z-ADD*ZERO     WN0074  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0075  52       Product Tempera
     C                     Z-ADD*ZERO     WN0076  50       Number Spacers
     C                     MOVEL*BLANK    WN0077 12        Car_Veh_Initial
     C                     Z-ADD*ZERO     WN0078  70       Total Load Mile
     C                     MOVEL*BLANK    WN0079 12        Recorder ID
     C                     MOVEL*BLANK    WN0080  2        Shipping Method
     C                     MOVEL*BLANK    WN0081  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0082  2        Ship To State C
     C                     Z-ADD*ZERO     WN0083  70       Gross Weight
     C                     MOVEL*BLANK    WN0084  3        Carrier Broker
     C                     MOVEL*BLANK    WN0085  1        Export Status
     C                     Z-ADD*ZERO     WN0086  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0087  1        On Time_Y_N
     C                     Z-ADD*ZERO     WN0088  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0089  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0090  70       Spotted Date
     C                     Z-ADD*ZERO     WN0091  60       Spotted Time
     C                     Z-ADD*ZERO     WN0092  70       Load Finished D
     C                     Z-ADD*ZERO     WN0093  60       Load Finished T
     C                     Z-ADD*ZERO     WN0094  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0095  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0096  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0097  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0098  70       Truck Departure
     C                     Z-ADD*ZERO     WN0099  60       Truck Departure
     C                     Z-ADD*ZERO     WN0100  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0101  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0102  3        Shipping Line
     C                     MOVEL*BLANK    WN0103 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0104 30        Vessel Name
     C                     Z-ADD*ZERO     WN0105  50       Voyage
     C                     Z-ADD*ZERO     WN0106  70       Sail Date
     C                     MOVEL*BLANK    WN0107 12        Booking Number
     C                     MOVEL*BLANK    WN0108 20        Discharge Port
     C                     Z-ADD*ZERO     WN0109  70       Arrival Date
     C                     MOVEL*BLANK    WN0110 12        Container Numbe
     C                     Z-ADD*ZERO     WN0111  70       Date In
     C                     Z-ADD*ZERO     WN0112  60       Time In
     C                     Z-ADD*ZERO     WN0113  70       Date Out
     C                     Z-ADD*ZERO     WN0114  60       Time Out
     C                     Z-ADD*ZERO     WN0115 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0116  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0117  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0118  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0119  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0120  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0121  70       Requested Deliv
     C                     MOVEL*BLANK    WN0122  1        Load Acceptance
     C                     MOVEL*BLANK    WN0123  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0124  70       On Yard Date
     C                     Z-ADD*ZERO     WN0125  60       On Yard Time
     C                     Z-ADD*ZERO     WN0126  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0127  60       Deadline Depart
     C                     MOVEL*BLANK    WN0128  1        Load Held Over
     C                     MOVEL*BLANK    WN0129  1        Load Held Over
     C                     MOVEL*BLANK    WN0130 15        Load Held Over
     C                     MOVEL*BLANK    WN0131 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0132 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0133  70       Express Mail Da
     C                     MOVEL*BLANK    WN0134  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0135  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0136  70       Product Complet
     C                     Z-ADD*ZERO     WN0137  60       Product Complet
     C                     Z-ADD*ZERO     WN0138  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0139  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0140  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0141  1        Load Confirmed
     C                     MOVEL*BLANK    WN0142 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0143  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0144  60       Load Door 1
     C                     Z-ADD*ZERO     WN0145  70       Override Total
     C                     Z-ADD*ZERO     WN0146  60       Load Door 2
     C                     MOVEL*BLANK    WN0147  1        Partial Load
     C                     MOVEL*BLANK    WN0148  1        Load Confirmati
     C                     MOVEL*BLANK    WN0149  1        Export Load USD
     C                     MOVEL*BLANK    WN0150  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0151 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0152 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0153 15        Late Billing Em
     C                     MOVEL*BLANK    WN0154 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0155 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0156  1        Multi Company L
     C                     MOVEL*BLANK    WN0157  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0158  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0159  1        LH Power Only L
     C                     MOVEL*BLANK    WN0160  1        MG Created Load
     C                     MOVEL*BLANK    WN0161  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0162  2        Load U_M
     C                     MOVEL*BLANK    WN0163  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0164  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0165  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0166  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0167  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0168  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0169  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0170  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0171  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0172  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0173  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0174  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0175  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0176  60       LH Unused Time
     C                     MOVEL*BLANK    WN0177  1        EDI Status 1
     C                     MOVEL*BLANK    WN0178  1        EDI Status 2
     C                     MOVEL*BLANK    WN0179  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0180  60       Job Time
     C                     MOVEL*BLANK    WN0181 10        User Id
     C                     MOVEL*BLANK    WN0182 10        Job Name
     C                     Z-ADD*ZERO     WN0183  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWDRMNB    WERMNB           Load ID
      *
     C           KLCHSP    KLIST
     C                     KFLD           WERMNB           Load ID
     C           KLCHSP    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YARDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADD#RMBDT    WEP0DT           LPT Load Plan S
     C                     Z-ADDYL0006    WECMTM           LPT Load Plan S
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * S14625 03/11/19 DN-Create TMS Load Trigger.
      * CASE: DB1.MG Created Load is Yes
     C           WERYSX    IFEQ 'Y'                        *IF
     C                     MOVEL'LPTCHG'  YL0007           Load Change Typ
      * Exc Crt TMS Load Trg  XF - TMS Load Trigger  * 
     C                     CALL 'PBXOXFR'              90  Exc Crt TMS Loa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM ##JDT     WQ0010  70       Job Date
     C                     PARM ##JTM     WQ0011  60       Job Time
     C                     PARM WERMNB    WQ0012  70       Load ID
     C                     PARM WEAIC3    WQ0013  30       TMS LH Load Str
     C                     PARM YL0008    WQ0014 35        TMS LH Field Ch
     C                     PARM 'A'       WQ0015  1        TMS Record Stat
     C                     PARM *ZERO     WQ0016  30       TMS Process Sta
     C                     PARM *BLANK    WQ0017  6        TMS Error Reaso
     C                     PARM *ZERO     WQ0018  80       TMS Change Date
     C                     PARM *ZERO     WQ0019  60       TMS Change time
     C                     PARM YL0007    WQ0020  6        Load Change Typ
     C                     PARM YL0009    WQ0021  6        Load Change Typ
     C                     PARM YL0010    WQ0022  6        Load Change Typ
     C                     PARM YL0011    WQ0023  6        Load Change Typ
     C                     PARM YL0012    WQ0024  6        Load Change Typ
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBXOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWL0035    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSQ     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    WL0036           Allow Multi-Com
     C                     MOVELDRMPNA    WL0037           Default Printer
     C                     MOVELDRBCCD    WL0038           Salesperson Cod
     C                     Z-ADDDRAIC3    WL0039           Company Number
     C                     MOVELDRBUVN    WL0040           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0041    DTAJVN           User Profile Na
     C                     MOVELWL0042    DTDNCD           Application Cod
      * Establish starting position
     C           KRSSR     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0043           Company Number
     C                     MOVELDTAJCD    WL0044           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSS01           Application Cod
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSS01           Application Cod
     C                     MOVEL'OMS'     WQSS01           Application Cod
      * Establish starting position
     C           KRSSS     SETLL@DNRESF                    *
     C           KRSSS     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR STRVGN
     C                     END                             *FI
     C           KRSSS     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQST01           Application Cod
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQST01           Application Cod
      * Establish starting position
     C           KRSST     SETLL@DNRESF                    *
     C           KRSST     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSST     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Allow Multi-Whs   RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSU     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P1I8ST           Allow Multi War
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI8ST    P1I8ST           Allow Multi War
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C           ZINPOS    IFGE 02560
     C           ZINPOS    ANDLE06144
      * Cursor in the subfile record area
      * Reset cursor position to the basic (first) record for lookup
     C           W0CRW     SUB  10        W0CSRR  50
     C           02560     ADD  W0CCL     ZINPOS
      * Calculate rrn of the cursor position
     C                     ADD  ##SFRC    W0CSRR
     C                     ENDIF
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C           W0CFL     IFEQ *BLANK
     C                     Z-ADD0         W0CSRR
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD10        ZHSTRW  40
     C                     Z-ADD23        ZHNDRW  40
     C           ZZSFM     IFEQ '0'
     C                     Z-ADD1         ZHRLEN  40
     C                     ELSE
     C                     Z-ADD1         ZHRLEN
     C                     ENDIF
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           ZHCSRW    IFEQ 009
     C           ZHCSCL    ANDEQ075
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#2PKST'  YPMTFD           Load Status
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1AJCD           Warehouse Code
     C                     Z-ADD*ZERO     P1AIC3           Company Number
     C                     MOVEL*BLANK    P1DQCD           Enterprise Code
     C                     MOVEL*BLANK    P1DRCD           Enterprise Code
     C                     MOVEL*BLANK    P1BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P1B8NA           System Date For
     C                     MOVEL*BLANK    P1AJVN           User Profile Na
     C                     MOVEL*BLANK    P1I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P1I8ST           Allow Multi War
     C                     MOVEL*BLANK    P1MPNA           Default Printer
     C                     MOVEL*BLANK    P1TAST           First Time Flag
     C                     Z-ADD*ZERO     P1EIDT           Requested Deliv
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2G3TX           PRT Description
     C                     MOVEL*BLANK    P2WRST           PRT Printer Dev
     C                     MOVEL*BLANK    P2WSST           PRT Hold Output
     C                     MOVEL*BLANK    P2WTST           PRT Save Output
     C                     Z-ADD*ZERO     P2DYNB           PRT Number of C
     C                     MOVEL*BLANK    P2WUST           PRT Night Queue
     C                     MOVEL*BLANK    P2BVVN           PRT Night Queue
     C                     Z-ADD*ZERO     P2AJAA           Company Number
     C                     Z-ADD*ZERO     P2AJAB           Date 1
     C                     Z-ADD*ZERO     P2AJAE           Order Number 1
     C                     Z-ADD*ZERO     P2M8NB           System Value Nu
     C                     MOVEL*BLANK    P2B8ST           Status - Y or N
     C                     MOVEL*BLANK    P2HWSX           Change Flag USR
      * Clear all neither parameters
     C                     MOVEL*BLANK    P3XFST           Display Prt Opt
     C                     MOVEL*BLANK    P3E5ST           USR Output Only
     C                     MOVEL*BLANK    P3E7ST           USR Print Detai
     C                     Z-ADD*ZERO     P3SEQ1           Seq No 1  PASS
     C                     MOVEL*BLANK    P3R4ST           USR Update Flag
     C                     MOVEL*BLANK    P3ECST           Error Status
     C                     Z-ADD*ZERO     P3CDWG           USR Weight Accu
      * Clear all neither parameters
     C                     MOVEL*BLANK    P4D4ST           USR Flag 1
      * Clear all neither parameters
     C                     MOVEL*BLANK    P5B2VN           Job Name CDE
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P6RMNB           Load ID
     C                     MOVEL*BLANK    P6BZNA           Carrier Code
      * Clear all neither parameters
     C                     MOVEL*BLANK    P7A0NA           Job Name
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P8RVNB           Stop_Drop
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P9G0NX           Numeric 4,0
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Whs Ord Ship Sts USR
     C                     MOVEL*BLANK    WUD9SX  1
      * Define work field Plant Controlled Sts
     C                     MOVEL*BLANK    WUFBSX  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           AR Customer Num
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A_R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non_Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non_Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Total Load Miles
     C                     Z-ADD*ZERO     WUTLMI  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WCRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WCFLAM           Flat Amount
     C                     Z-ADD*ZERO     WCRRNB           Total Stops
     C                     Z-ADD*ZERO     WCSBNB           BOL Time
     C                     Z-ADD*ZERO     WCSQNB           Ld Hdr_Ld Dtl U
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCSDNB           Number Pallets
     C                     Z-ADD*ZERO     WCPAOU           Number Pallets
     C                     Z-ADD*ZERO     WCDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WCSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WCHADT           Actual Arrival
     C                     Z-ADD*ZERO     WCAART           Actual Arrival
     C                     Z-ADD*ZERO     WCDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WCDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WCAQDT           Actual Departur
     C                     Z-ADD*ZERO     WCS6NB           Departure Time
     C                     Z-ADD*ZERO     WCT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WCPRTM           Product Tempera
     C                     Z-ADD*ZERO     WCNPSV           Number Spacers
     C                     Z-ADD*ZERO     WCTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WCGRWE           Gross Weight
     C                     Z-ADD*ZERO     WCF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WCJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WCTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WCJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WCSPTM           Spotted Time
     C                     Z-ADD*ZERO     WCJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WCLFTM           Load Finished T
     C                     Z-ADD*ZERO     WCJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WCBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WCJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WCBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WCKIDT           Truck Departure
     C                     Z-ADD*ZERO     WCASTM           Truck Departure
     C                     Z-ADD*ZERO     WCKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WCAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WCVOAG           Voyage
     C                     Z-ADD*ZERO     WCKBDT           Sail Date
     C                     Z-ADD*ZERO     WCEFDT           Arrival Date
     C                     Z-ADD*ZERO     WCKCDT           Date In
     C                     Z-ADD*ZERO     WCTMIN           Time In
     C                     Z-ADD*ZERO     WCKDDT           Date Out
     C                     Z-ADD*ZERO     WCVMNB           Time Out
     C                     Z-ADD*ZERO     WCOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WCKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WCATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WCBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WCEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WCKKDT           On Yard Date
     C                     Z-ADD*ZERO     WCAVTM           On Yard Time
     C                     Z-ADD*ZERO     WCKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WCAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WCLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WCK0DT           Product Complet
     C                     Z-ADD*ZERO     WCAYTM           Product Complet
     C                     Z-ADD*ZERO     WCKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WCICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WCIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WCK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WCAZTM           Load Door 1
     C                     Z-ADD*ZERO     WCK2DT           Override Total
     C                     Z-ADD*ZERO     WCA0TM           Load Door 2
     C                     Z-ADD*ZERO     WCZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WCPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WCCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WCPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WCCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WCP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WCCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WCP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WCCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WCP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WCCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WCP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WCCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field Allow Unlock if Picked St
     C                     MOVEL*BLANK    WUZUSX  1
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002 30
      * Define local variables for subroutine SDRVGN.
     C                     MOVEL*BLANK    WL0003 10
     C                     MOVEL*BLANK    WL0004  3
     C                     MOVEL*BLANK    WL0005  1
     C                     MOVEL*BLANK    WL0006  1
     C                     MOVEL*BLANK    WL0007  1
     C                     MOVEL*BLANK    WL0008  1
     C                     MOVEL*BLANK    WL0009  1
     C                     MOVEL*BLANK    WL0010  1
     C                     MOVEL*BLANK    WL0011  1
     C                     MOVEL*BLANK    WL0012  1
     C                     MOVEL*BLANK    WL0013  1
     C                     MOVEL*BLANK    WL0014  1
     C                     MOVEL*BLANK    WL0015  1
     C                     MOVEL*BLANK    WL0016  1
     C                     MOVEL*BLANK    WL0017  1
     C                     MOVEL*BLANK    WL0018  1
     C                     MOVEL*BLANK    WL0019  2
     C                     MOVEL*BLANK    WL0020  2
     C                     MOVEL*BLANK    WL0021  2
     C                     MOVEL*BLANK    WL0022  2
     C                     MOVEL*BLANK    WL0023  2
     C                     MOVEL*BLANK    WL0024  1
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0025  70
     C                     Z-ADD*ZERO     WL0026  70
     C                     Z-ADD*ZERO     WL0027  70
     C                     Z-ADD*ZERO     WL0028  70
     C                     Z-ADD*ZERO     WL0029  70
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0030  70
     C                     MOVEL*BLANK    WL0031 30
      * Define local variables for subroutine SMRVGN.
     C                     Z-ADD*ZERO     WL0032  70
     C                     MOVEL*BLANK    WL0033  1
     C                     MOVEL*BLANK    WL0034  1
      * Define local variables for subroutine SQRVGN.
     C                     MOVEL*BLANK    WL0035 10
     C                     MOVEL*BLANK    WL0036  1
     C                     MOVEL*BLANK    WL0037 10
     C                     MOVEL*BLANK    WL0038  3
     C                     Z-ADD*ZERO     WL0039  30
     C                     MOVEL*BLANK    WL0040 10
      * Define local variables for subroutine SRRVGN.
     C                     MOVEL*BLANK    WL0041 10
     C                     MOVEL*BLANK    WL0042  6
     C                     Z-ADD*ZERO     WL0043  30
     C                     MOVEL*BLANK    WL0044  3
      * Define null work field AR Customer Number
     C                     Z-ADD*ZERO     YN0001  70
      * Define null work field Parent Customer
     C                     Z-ADD*ZERO     YN0002  70
      * Define null work field Bill to Customer
     C                     Z-ADD*ZERO     YN0003  70
      * Define null work field Ship To Name
     C                     MOVEL*BLANK    YN0004 30
      * Define null work field Ship To Address Line 1
     C                     MOVEL*BLANK    YN0005 30
      * Define null work field Ship To Address Line 2
     C                     MOVEL*BLANK    YN0006 30
      * Define null work field Ship To Address Line 3
     C                     MOVEL*BLANK    YN0007 30
      * Define null work field Ship To City
     C                     MOVEL*BLANK    YN0008 20
      * Define null work field Ship To State Code
     C                     MOVEL*BLANK    YN0009  2
      * Define null work field Ship To Zip_Postal Code
     C                     MOVEL*BLANK    YN0010 11
      * Define null work field Salesperson Name
     C                     MOVEL*BLANK    YN0011 30
      * Define local work field Sales Route Code
     C                     MOVEL*BLANK    YL0001  3
      * Define local work field Salesperson Code
     C                     MOVEL*BLANK    YL0002  3
      * Define local work field Email Address
     C                     MOVEL*BLANK    YL0003 50
      * Define local work field Numeric Field Needed  USR
     C                     Z-ADD*ZERO     YL0004  70
      * Define local work field Load U/M Text USR
     C                     MOVEL*BLANK    YL0005  4
      * Define local work field LPT Load Plan Start Tm
     C                     Z-ADD*ZERO     YL0006  60
      * Define local work field Load Change Type
     C                     MOVEL*BLANK    YL0007  6
      * Define local work field TMS LH Field Chg Text
     C                     MOVEL*BLANK    YL0008 35
      * Define local work field Load Change Type 2
     C                     MOVEL*BLANK    YL0009  6
      * Define local work field Load Change Type 3
     C                     MOVEL*BLANK    YL0010  6
      * Define local work field Load Change Type 4
     C                     MOVEL*BLANK    YL0011  6
      * Define local work field Load Change Type 5
     C                     MOVEL*BLANK    YL0012  6
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0013  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0014  3
      * Define local work field Live with TPM
     C                     MOVEL*BLANK    YL0015  1
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD14        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
     C                     Z-ADD999999    W0SLM            *Scan limit
      *
     C                     MOVEL*BLANK    WN0184 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0184           User Profile Na
      *
     C                     MOVEL*BLANK    WN0185 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0184    WL0035    P      User Profile Na
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0036    P1I6ST    P      Allow Multi-Com
     C                     MOVELWL0037    P1MPNA    P      Default Printer
     C                     MOVELWL0038    P1BCCD    P      Salesperson Cod
     C                     Z-ADDWL0039    YL0013           Company Number
     C                     MOVELWL0040    WN0185    P      User Code Model
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,002                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0184    ZA0035           User Profile Na
     C                     MOVEL'OMS'     ZA0036           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0185    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0184    WL0041    P      User Profile Na
     C                     MOVEL'OMS'     WL0042    P      Application Cod
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0043    P1AIC3           Company Number
     C                     MOVELWL0044    YL0014    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0185    WL0041    P      User Profile Na
     C                     MOVEL'OMS'     WL0042    P      Application Cod
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0043    P1AIC3           Company Number
     C                     MOVELWL0044    YL0014    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0014    P1AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0184    ZA0037           User Profile Na
     C                     MOVEL'OMS'     ZA0038           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0013    IFNE 0                          *IF
     C                     Z-ADDYL0013    P1AIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0014    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P1AJCD    PARM *BLANK    WQ0025  3        Warehouse Code
     C                     PARM YL0013    WQ0026  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SSRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      * Rtv Allow Multi-Whs   RT - User Profile Control  * 
     C                     EXSR SURVGN
     C                     MOVEL*BLANK    P2WRST           PRT Printer Dev
     C                     MOVEL'N'       P2WUST           PRT Night Queue
     C                     MOVEL'*YES'    P3XFST           Display Prt Opt
     C                     MOVEL'Y'       P3E7ST           USR Print Detai
     C                     MOVEL'Y'       P1TAST           First Time Flag
     C                     MOVEL##JOB     P5B2VN           Job Name CDE
     C                     Z-ADD9         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00010
     C           ZQ        ORGT 00010
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST##JOB:ZQ  P7A0NA    P  90  Job Name
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           P7A0NA    CAT  'P':ZQ    P7A0NA    P      Job Name
     C                     MOVEL'N'       P2HWSX           Change Flag USR
     C                     MOVEL'1'       ZZSFM            *Subfile mode
      * RTV Live w/TPM Sts    XF - System Values  * 
     C                     CALL 'PBEGXFR'              90  RTV Live w/TPM
     C                     PARM *BLANK    W0RTN   7
     C                     PARM @CN,003   WQ0027 10        System Value Co
     C           YL0015    PARM *BLANK    WQ0028  1        Live with TPM
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBEGXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RMC PFS017  Check company value to see if the Unlock when picked
      * Rtv Alpha Value       XF - Company Values  * 
     C                     CALL 'POMTXFR'              90  Rtv Alpha Value
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2AIC3    WQ0029  30       Company Number
     C                     PARM @CN,004   WQ0030 10        Company Value C
     C           WUZUSX    PARM *BLANK    WQ0031 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** W0BEG
01050010570130601313023070231602338
02368023790238202400025630257202579
02587025940260402613026240263502638
026420265602661
** W0END
01052010860130801342023130231902345
02375023790238302402025690257502584
02590026010261102620026310263502639
026530265802690
** W0NAM
V2AIC3    #CADTX    #CCPCD    #CO6NA    #2RMNB    #CG0NX    V2AODT
V2EIDT    #2PKST    #2R0SX    #2BZNA    #1RMNB    #RG0NX    VRMBDT
#RT4TM    V1AODT    V1KZDT    #1AXTM    V1EIDT    #1PKST    #1R0SX
#RS2TX    #1BZNA    #RAYTX
** @CN
00001 USR0752
00002 Y2U0005
00003 LIVE W/TPM
00004 ALLOWUNLCK
