     H/TITLE Cnv Crt Load Frt Chrg XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : COOL:2E  Version:  1000
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 07/24/01  Time  : 10:18:38
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDKYCPL1IF  E           K        DISK
      * RTV : Actual Freight            Retrieval index
      *
     FPOA9REL1IF  E           K        DISK
      * RTV : Freight Charge            Retrieval index
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FPOBCCPL0IF  E           K        DISK                      A
      * UPD : Load Freight Charge       Update index
      *
     I@KYCPJG
      * Actual Freight            Retrieval index
      * Renamed input format fields
     I              KYAIC3                          WAAIC3
     I              KYRMNB                          WARMNB
     I              KYONVA                          WAONVA
     I              KYJZDT                          WAJZDT
     I              KYUVST                          WAUVST
     I              KYUWST                          WAUWST
     I              KYUXST                          WAUXST
     I              KYVSST                          WAVSST
     I              KYAATM                          WAAATM
     I              KYAYNA                          WAAYNA
     I              KYA0NA                          WAA0NA
     I              KYAXDT                          WAAXDT
      *
     I@A9REJZ
      * Freight Charge            Retrieval index
      * Renamed input format fields
     I              A9CDAA                          WBCDAA
     I              A9PNNA                          WBPNNA
     I              A9C3VL                          WBC3VL
     I              A9JUSX                          WBJUSX
     I              A9JZSX                          WBJZSX
     I              A9J5SX                          WBJ5SX
     I              A9JVSX                          WBJVSX
     I              A9JWSX                          WBJWSX
     I              A9JXSX                          WBJXSX
     I              A9JYSX                          WBJYSX
     I              A9KKSX                          WBKKSX
     I              A9J0SX                          WBJ0SX
     I              A9J1SX                          WBJ1SX
     I              A9KRSX                          WBKRSX
     I              A9KPSX                          WBKPSX
     I              A9KQSX                          WBKQSX
     I              A9J2SX                          WBJ2SX
     I              A9J3SX                          WBJ3SX
     I              A9J4SX                          WBJ4SX
     I              A9J6SX                          WBJ6SX
     I              A9J7SX                          WBJ7SX
     I              A9J8SX                          WBJ8SX
     I              A9J9SX                          WBJ9SX
     I              A9KASX                          WBKASX
     I              A9OPDT                          WBOPDT
     I              A9VSST                          WBVSST
     I              A9MJDT                          WBMJDT
     I              A9BETM                          WBBETM
     I              A9CCVN                          WBCCVN
     I              A9CDVN                          WBCDVN
     I              A9MKDT                          WBMKDT
     I              A9BFTM                          WBBFTM
     I              A9CEVN                          WBCEVN
     I              A9CFVN                          WBCFVN
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJAIC3                          WCAIC3
     I              FJRMNB                          WCRMNB
     I              FJAODT                          WCAODT
     I              FJPJST                          WCPJST
     I              FJPKST                          WCPKST
     I              FJRNNB                          WCRNNB
     I              FJDMTX                          WCDMTX
     I              FJDNTX                          WCDNTX
     I              FJDOTX                          WCDOTX
     I              FJWTTX                          WCWTTX
     I              FJWUTX                          WCWUTX
     I              FJRPNB                          WCRPNB
     I              FJFLAM                          WCFLAM
     I              FJXQST                          WCXQST
     I              FJRRNB                          WCRRNB
     I              FJDXTX                          WCDXTX
     I              FJDYTX                          WCDYTX
     I              FJSBNB                          WCSBNB
     I              FJBZNA                          WCBZNA
     I              FJRONB                          WCRONB
     I              FJSQNB                          WCSQNB
     I              FJR1NB                          WCR1NB
     I              FJVCST                          WCVCST
     I              FJVDST                          WCVDST
     I              FJSDNB                          WCSDNB
     I              FJPAOU                          WCPAOU
     I              FJDGWG                          WCDGWG
     I              FJSXNB                          WCSXNB
     I              FJHADT                          WCHADT
     I              FJAART                          WCAART
     I              FJDHWG                          WCDHWG
     I              FJDIWG                          WCDIWG
     I              FJAQDT                          WCAQDT
     I              FJS6NB                          WCS6NB
     I              FJT4NB                          WCT4NB
     I              FJPRTM                          WCPRTM
     I              FJNPSV                          WCNPSV
     I              FJJ8TX                          WCJ8TX
     I              FJTLMI                          WCTLMI
     I              FJJ9TX                          WCJ9TX
     I              FJQ2CD                          WCQ2CD
     I              FJVPCD                          WCVPCD
     I              FJDBCD                          WCDBCD
     I              FJGRWE                          WCGRWE
     I              FJXCCD                          WCXCCD
     I              FJU2ST                          WCU2ST
     I              FJF9DT                          WCF9DT
     I              FJONTM                          WCONTM
     I              FJJ4DT                          WCJ4DT
     I              FJTRTM                          WCTRTM
     I              FJJ5DT                          WCJ5DT
     I              FJSPTM                          WCSPTM
     I              FJJ6DT                          WCJ6DT
     I              FJLFTM                          WCLFTM
     I              FJJ7DT                          WCJ7DT
     I              FJBOTM                          WCBOTM
     I              FJJ8DT                          WCJ8DT
     I              FJBLTM                          WCBLTM
     I              FJKIDT                          WCKIDT
     I              FJASTM                          WCASTM
     I              FJKADT                          WCKADT
     I              FJAJCM                          WCAJCM
     I              FJXACD                          WCXACD
     I              FJOANA                          WCOANA
     I              FJK4TX                          WCK4TX
     I              FJVOAG                          WCVOAG
     I              FJKBDT                          WCKBDT
     I              FJNBBO                          WCNBBO
     I              FJW4CD                          WCW4CD
     I              FJEFDT                          WCEFDT
     I              FJCNTN                          WCCNTN
     I              FJKCDT                          WCKCDT
     I              FJTMIN                          WCTMIN
     I              FJKDDT                          WCKDDT
     I              FJVMNB                          WCVMNB
     I              FJOCFR                          WCOCFR
     I              FJKJDT                          WCKJDT
     I              FJATTM                          WCATTM
     I              FJOTRS                          WCOTRS
     I              FJRNST                          WCRNST
     I              FJBRBK                          WCBRBK
     I              FJEIDT                          WCEIDT
     I              FJRMST                          WCRMST
     I              FJAJCD                          WCAJCD
     I              FJKKDT                          WCKKDT
     I              FJAVTM                          WCAVTM
     I              FJKZDT                          WCKZDT
     I              FJAXTM                          WCAXTM
     I              FJLHOS                          WCLHOS
     I              FJLHOR                          WCLHOR
     I              FJWNTX                          WCWNTX
     I              FJOITX                          WCOITX
     I              FJOJTX                          WCOJTX
     I              FJLLDT                          WCLLDT
     I              FJLSHG                          WCLSHG
     I              FJYPST                          WCYPST
     I              FJK0DT                          WCK0DT
     I              FJAYTM                          WCAYTM
     I              FJKNNX                          WCKNNX
     I              FJICWG                          WCICWG
     I              FJIDWG                          WCIDWG
     I              FJH9SX                          WCH9SX
     I              FJWOTX                          WCWOTX
     I              FJK1DT                          WCK1DT
     I              FJAZTM                          WCAZTM
     I              FJK2DT                          WCK2DT
     I              FJA0TM                          WCA0TM
     I              FJROST                          WCROST
     I              FJRPST                          WCRPST
     I              FJRQST                          WCRQST
     I              FJRRST                          WCRRST
     I              FJZBVA                          WCZBVA
     I              FJWPTX                          WCWPTX
     I              FJWQTX                          WCWQTX
     I              FJWRTX                          WCWRTX
     I              FJWSTX                          WCWSTX
     I              FJUVST                          WCUVST
     I              FJUWST                          WCUWST
     I              FJUXST                          WCUXST
     I              FJAATM                          WCAATM
     I              FJAYNA                          WCAYNA
     I              FJA0NA                          WCA0NA
     I              FJAXDT                          WCAXDT
      *
     I@BCCPJ7
      * Load Freight Charge       Update index
      * Renamed input format fields
     I              BCAIC3                          WDAIC3
     I              BCRMNB                          WDRMNB
     I              BCCDAA                          WDCDAA
     I              BCC5VL                          WDC5VL
     I              BCKBSX                          WDKBSX
     I              BCCFAA                          WDCFAA
     I              BCKDSX                          WDKDSX
     I              BCKESX                          WDKESX
     I              BCKFSX                          WDKFSX
     I              BCKGSX                          WDKGSX
     I              BCKSSX                          WDKSSX
     I              BCKTSX                          WDKTSX
     I              BCKHSX                          WDKHSX
     I              BCKISX                          WDKISX
     I              BCKJSX                          WDKJSX
     I              BCVSST                          WDVSST
     I              BCMJDT                          WDMJDT
     I              BCBETM                          WDBETM
     I              BCCCVN                          WDCCVN
     I              BCCDVN                          WDCDVN
     I              BCMKDT                          WDMKDT
     I              BCBFTM                          WDBFTM
     I              BCCEVN                          WDCEVN
     I              BCCFVN                          WDCFVN
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPOBC1    E DSPOBCCPL0
      * UPD : Load Freight Charge       Update index
      * Renamed input format fields
     I              BCAIC3                          WDAIC3
     I              BCRMNB                          WDRMNB
     I              BCCDAA                          WDCDAA
     I              BCC5VL                          WDC5VL
     I              BCKBSX                          WDKBSX
     I              BCCFAA                          WDCFAA
     I              BCKDSX                          WDKDSX
     I              BCKESX                          WDKESX
     I              BCKFSX                          WDKFSX
     I              BCKGSX                          WDKGSX
     I              BCKSSX                          WDKSSX
     I              BCKTSX                          WDKTSX
     I              BCKHSX                          WDKHSX
     I              BCKISX                          WDKISX
     I              BCKJSX                          WDKJSX
     I              BCVSST                          WDVSST
     I              BCMJDT                          WDMJDT
     I              BCBETM                          WDBETM
     I              BCCCVN                          WDCCVN
     I              BCCDVN                          WDCDVN
     I              BCMKDT                          WDMKDT
     I              BCBFTM                          WDBFTM
     I              BCCEVN                          WDCEVN
     I              BCCFVN                          WDCFVN
      *
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Cnv Crt Load Frt Chrg XF
      * Cnv Crt Load Frt Chrg RT - Actual Freight  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Cnv Crt Load Frt Chrg RT - Actual Freight  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  6        FC Code
     C                     MOVEL*BLANK    WN0002 30        FC Description
     C                     Z-ADD*ZERO     WN0003  72       FC Rate Amount
     C                     MOVEL*BLANK    WN0004  2        FC Unit of Meas
     C                     MOVEL*BLANK    WN0005  1        FC Act Frt Incl
     C                     MOVEL*BLANK    WN0006  1        FC Frt Add/Dedu
     C                     MOVEL*BLANK    WN0007  1        FC Load Type Se
     C                     MOVEL*BLANK    WN0008  1        FC State Select
     C                     MOVEL*BLANK    WN0009  1        FC Export Selec
     C                     MOVEL*BLANK    WN0010  1        FC Shag/Wash Se
     C                     MOVEL*BLANK    WN0011  1        FC Auto Calc St
     C                     MOVEL*BLANK    WN0012  1        FC Unused Sts 1
     C                     MOVEL*BLANK    WN0013  1        FC Shag/Wash Co
     C                     MOVEL*BLANK    WN0014  1        FC Edit Sequenc
     C                     MOVEL*BLANK    WN0015  1        FC Tot Freight
     C                     MOVEL*BLANK    WN0016  1        FC Special Type
     C                     MOVEL*BLANK    WN0017  1        FC Unused Sts 3
     C                     MOVEL*BLANK    WN0018  1        FC Unused Sts 4
     C                     MOVEL*BLANK    WN0019  1        FC Unused Sts 5
     C                     MOVEL*BLANK    WN0020  1        FC Unused Sts 6
     C                     MOVEL*BLANK    WN0021  1        FC Unused Sts 7
     C                     MOVEL*BLANK    WN0022  1        FC Unused Sts 8
     C                     MOVEL*BLANK    WN0023  1        FC Unused Sts 9
     C                     MOVEL*BLANK    WN0024  1        FC Unused Sts 1
     C                     Z-ADD*ZERO     WN0025  70       FC Auto Calc Ef
     C                     MOVEL*BLANK    WN0026  1        Record Status
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'ACTFRT'  WN0001           FC Code
      * Establish starting position
     C           *LOVAL    SETLL@KYCPJG                    *
     C                     READ @KYCPJG                  90*
      * Data record not found
     C   90                MOVEL'USR2344' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Frt Charge Info   RT - Freight Charge  * 
     C                     EXSR SBRVGN
      * RTV Carrier Code       RT - Load Header  * 
     C                     EXSR SCRVGN
      * Crt Load Freight Chrg CR - Load Freight Charge  * 
     C                     EXSR SDCRRC
     C                     READ @KYCPJG                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Frt Charge Info   RT - Freight Charge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBCDAA           FC Code
      * Setup key
     C                     MOVELWN0001    WBCDAA           FC Code
      * Establish starting position
     C           KRSSB     CHAIN@A9REJZ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3052' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0002           FC Description
     C                     Z-ADD*ZERO     WN0003           FC Rate Amount
     C                     MOVEL*BLANK    WN0004           FC Unit of Meas
     C                     MOVEL*BLANK    WN0005           FC Act Frt Incl
     C                     MOVEL*BLANK    WN0006           FC Frt Add/Dedu
     C                     MOVEL*BLANK    WN0007           FC Load Type Se
     C                     MOVEL*BLANK    WN0008           FC State Select
     C                     MOVEL*BLANK    WN0009           FC Export Selec
     C                     MOVEL*BLANK    WN0010           FC Shag/Wash Se
     C                     MOVEL*BLANK    WN0011           FC Auto Calc St
     C                     MOVEL*BLANK    WN0012           FC Unused Sts 1
     C                     MOVEL*BLANK    WN0013           FC Shag/Wash Co
     C                     MOVEL*BLANK    WN0014           FC Edit Sequenc
     C                     MOVEL*BLANK    WN0015           FC Tot Freight
     C                     MOVEL*BLANK    WN0016           FC Special Type
     C                     MOVEL*BLANK    WN0017           FC Unused Sts 3
     C                     MOVEL*BLANK    WN0018           FC Unused Sts 4
     C                     MOVEL*BLANK    WN0019           FC Unused Sts 5
     C                     MOVEL*BLANK    WN0020           FC Unused Sts 6
     C                     MOVEL*BLANK    WN0021           FC Unused Sts 7
     C                     MOVEL*BLANK    WN0022           FC Unused Sts 8
     C                     MOVEL*BLANK    WN0023           FC Unused Sts 9
     C                     MOVEL*BLANK    WN0024           FC Unused Sts 1
     C                     Z-ADD*ZERO     WN0025           FC Auto Calc Ef
     C                     MOVEL*BLANK    WN0026           Record Status
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBPNNA    WN0002           FC Description
     C                     Z-ADDWBC3VL    WN0003           FC Rate Amount
     C                     MOVELWBJUSX    WN0004           FC Unit of Meas
     C                     MOVELWBJZSX    WN0005           FC Act Frt Incl
     C                     MOVELWBJ5SX    WN0006           FC Frt Add/Dedu
     C                     MOVELWBJVSX    WN0007           FC Load Type Se
     C                     MOVELWBJWSX    WN0008           FC State Select
     C                     MOVELWBJXSX    WN0009           FC Export Selec
     C                     MOVELWBJYSX    WN0010           FC Shag/Wash Se
     C                     MOVELWBKKSX    WN0011           FC Auto Calc St
     C                     MOVELWBJ0SX    WN0012           FC Unused Sts 1
     C                     MOVELWBJ1SX    WN0013           FC Shag/Wash Co
     C                     MOVELWBKRSX    WN0014           FC Edit Sequenc
     C                     MOVELWBKPSX    WN0015           FC Tot Freight
     C                     MOVELWBKQSX    WN0016           FC Special Type
     C                     MOVELWBJ2SX    WN0017           FC Unused Sts 3
     C                     MOVELWBJ3SX    WN0018           FC Unused Sts 4
     C                     MOVELWBJ4SX    WN0019           FC Unused Sts 5
     C                     MOVELWBJ6SX    WN0020           FC Unused Sts 6
     C                     MOVELWBJ7SX    WN0021           FC Unused Sts 7
     C                     MOVELWBJ8SX    WN0022           FC Unused Sts 8
     C                     MOVELWBJ9SX    WN0023           FC Unused Sts 9
     C                     MOVELWBKASX    WN0024           FC Unused Sts 1
     C                     Z-ADDWBOPDT    WN0025           FC Auto Calc Ef
     C                     MOVELWBVSST    WN0026           Record Status
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Carrier Code       RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCRMNB           Load ID
      * Setup key
     C                     Z-ADDWAAIC3    WCAIC3           Company Number
     C                     Z-ADDWARMNB    WCRMNB           Load ID
      * Establish starting position
     C           KRSSC     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCBZNA    YL0001           Carrier Code
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCRRC    BEGSR
      *================================================================
      * Crt Load Freight Chrg CR - Load Freight Charge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BCCPJ7
     C                     Z-ADDWAAIC3    WDAIC3           Company Number
     C                     Z-ADDWARMNB    WDRMNB           Load ID
     C                     MOVELWN0001    WDCDAA           FC Code
     C                     Z-ADDWAONVA    WDC5VL           LFC Amount
     C                     MOVELWN0005    WDKBSX           LFC Act Frt Inc
     C                     MOVELYL0001    WDCFAA           LFC Carrier Cod
     C                     MOVEL'A'       WDKDSX           LFC Create Stat
     C                     MOVEL'P'       WDKESX           LFC Payment Sta
     C                     MOVELWN0012    WDKFSX           LFC Unused Sts
     C                     MOVELWN0013    WDKGSX           LFC Shag/Wash C
     C                     MOVELWN0015    WDKSSX           LFC Tot Freight
     C                     MOVELWN0016    WDKTSX           LFC Special Typ
     C                     MOVELWUGSTX    WDKHSX           LFC Unused Sts
     C                     MOVELWUGSTX    WDKISX           LFC Unused Sts
     C                     MOVELWUGSTX    WDKJSX           LFC Unused Sts
     C                     MOVEL'A'       WDVSST           Record Status
     C                     Z-ADD*ZERO     WDMJDT           Create Date
     C                     Z-ADD*ZERO     WDBETM           Create Time
     C                     MOVEL*BLANK    WDCCVN           Create User
     C                     MOVEL*BLANK    WDCDVN           Create Program
     C                     Z-ADD*ZERO     WDMKDT           Change Date
     C                     Z-ADD*ZERO     WDBFTM           Change Time
     C                     MOVEL*BLANK    WDCEVN           Change User
     C                     MOVEL*BLANK    WDCFVN           Change Program
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WDVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WDMJDT           Create Date
     C                     Z-ADD##JTM     WDBETM           Create Time
     C                     MOVEL##USR     WDCCVN           Create User
     C                     MOVEL##PGM     WDCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD*ZERO     WDMKDT           Change Date
     C                     Z-ADD*ZERO     WDBFTM           Change Time
     C                     MOVEL*BLANK    WDCEVN           Change User
     C                     MOVEL*BLANK    WDCFVN           Change Program
     C           KLCRSD    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDRMNB           Load ID
     C                     KFLD           WDCDAA           FC Code
      * Check for duplicate primary key
     C           KLCRSD    SETLL@BCCPJ7                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3059' W0RTN   7
      * Send message 'Load Freight Charge    EX'
     C                     MOVEL'USR3059' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C                     WRITE@BCCPJ7                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WAONVA           Actual Freight
     C                     Z-ADD*ZERO     WAJZDT           Entry Date
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBC3VL           FC Rate Amount
     C                     Z-ADD*ZERO     WBOPDT           FC Auto Calc Ef
     C                     Z-ADD*ZERO     WBMJDT           Create Date
     C                     Z-ADD*ZERO     WBBETM           Create Time
     C                     Z-ADD*ZERO     WBMKDT           Change Date
     C                     Z-ADD*ZERO     WBBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WCRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WCFLAM           Flat Amount
     C                     Z-ADD*ZERO     WCRRNB           Total Stops
     C                     Z-ADD*ZERO     WCSBNB           BOL Time
     C                     Z-ADD*ZERO     WCSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCSDNB           Number Pallets
     C                     Z-ADD*ZERO     WCPAOU           Number Pallets
     C                     Z-ADD*ZERO     WCDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WCSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WCHADT           Actual Arrival
     C                     Z-ADD*ZERO     WCAART           Actual Arrival
     C                     Z-ADD*ZERO     WCDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WCDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WCAQDT           Actual Departur
     C                     Z-ADD*ZERO     WCS6NB           Departure Time
     C                     Z-ADD*ZERO     WCT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WCPRTM           Product Tempera
     C                     Z-ADD*ZERO     WCNPSV           Number Pallets
     C                     Z-ADD*ZERO     WCTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WCGRWE           Gross Weight
     C                     Z-ADD*ZERO     WCF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WCJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WCTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WCJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WCSPTM           Spotted Time
     C                     Z-ADD*ZERO     WCJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WCLFTM           Load Finished T
     C                     Z-ADD*ZERO     WCJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WCBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WCJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WCBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WCKIDT           Truck Departure
     C                     Z-ADD*ZERO     WCASTM           Truck Departure
     C                     Z-ADD*ZERO     WCKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WCAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WCVOAG           Voyage
     C                     Z-ADD*ZERO     WCKBDT           Sail Date
     C                     Z-ADD*ZERO     WCEFDT           Arrival Date
     C                     Z-ADD*ZERO     WCKCDT           Date In
     C                     Z-ADD*ZERO     WCTMIN           Time In
     C                     Z-ADD*ZERO     WCKDDT           Date Out
     C                     Z-ADD*ZERO     WCVMNB           Time Out
     C                     Z-ADD*ZERO     WCOCFR           Ocean Freight
     C                     Z-ADD*ZERO     WCKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WCATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WCBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WCEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WCKKDT           On Yard Date
     C                     Z-ADD*ZERO     WCAVTM           On Yard Time
     C                     Z-ADD*ZERO     WCKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WCAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WCLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WCK0DT           Product Complet
     C                     Z-ADD*ZERO     WCAYTM           Product Complet
     C                     Z-ADD*ZERO     WCKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WCICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WCIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WCK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WCAZTM           Load Door 1
     C                     Z-ADD*ZERO     WCK2DT           Unused Load Dat
     C                     Z-ADD*ZERO     WCA0TM           Load Door 2
     C                     Z-ADD*ZERO     WCZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDC5VL           LFC Amount
     C                     Z-ADD*ZERO     WDMJDT           Create Date
     C                     Z-ADD*ZERO     WDBETM           Create Time
     C                     Z-ADD*ZERO     WDMKDT           Change Date
     C                     Z-ADD*ZERO     WDBFTM           Change Time
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0001  3
      *================================================================
     CSR         ZZEXIT    ENDSR
