     H/TITLE ZZUPS Clc Inv/Shp/AvaiPF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     W* Warning: This program does not set on the LR indicator
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSMASO
     H* Date          : 02/22/10  Time  : 17:09:54
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FCAB0RELJIF  E           K        DISK
      * RTV : Item Balance              Acitve records only
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FCAAFREL6IF  E           K        DISK
      * RSQ : Calendar                  RSQ Co/Date Descending
      *
     FCAAFREL3IF  E           K        DISK
      * RSQ : Calendar                  Co/Date               NV
      *
     FCAB1REL4IF  E           K        DISK
      * RTV : Item Balance Detail       Active only
      *
     FOPBGWKLFIF  E           K        DISK
      * RSQ : Order Detail              Co/Itm/Whs/SSD(d)/Od Omt
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPDI8CPL1IF  E           K        DISK
      * RTV : PS Prod Item Schedule     Retrieval index
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FPDI8CPL0UF  E           K        DISK                      A
      * UPD : PS Prod Item Schedule     Update index
      *
     FPDMVPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: ZZUPS Clc Inv/Shp/AvaiPF  Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L3         3  1
     E                    #L7         7  1
     I@AFREYY
      * Calendar                  Co/Date               NV
      * Renamed input format fields
     I              AFAIC3                          WAAIC3
     I              AFBCDT                          WABCDT
     I              AFCQNB                          WACQNB
     I              AFESNB                          WAESNB
     I              AFETNB                          WAETNB
     I              AFBZNB                          WABZNB
     I              AFA9ST                          WAA9ST
     I              AFEINB                          WAEINB
     I              AFC5ST                          WAC5ST
     I              AFAQNB                          WAAQNB
     I              AFCMST                          WACMST
     I              AFV9ST                          WAV9ST
     I              AFWAST                          WAWAST
     I              AFX2ST                          WAX2ST
     I              AFOJDT                          WAOJDT
     I              AFNQNX                          WANQNX
     I              AFNRNX                          WANRNX
     I              AFI9SX                          WAI9SX
     I              AFJASX                          WAJASX
     I              AFOKDT                          WAOKDT
     I              AFOLDT                          WAOLDT
     I              AFUVST                          WAUVST
     I              AFUWST                          WAUWST
     I              AFUXST                          WAUXST
     I              AFAATM                          WAAATM
     I              AFAYNA                          WAAYNA
     I              AFA0NA                          WAA0NA
     I              AFAXDT                          WAAXDT
      *
     I@I8CPUR
      * PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WBAIC3
     I              I8V5ST                          WBV5ST
     I              I8ELDT                          WBELDT
     I              I8HGCD                          WBHGCD
     I              I8AJCD                          WBAJCD
     I              I8GPDT                          WBGPDT
     I              I8WTSP                          WBWTSP
     I              I8QTSP                          WBQTSP
     I              I8DJPC                          WBDJPC
     I              I8F8WG                          WBF8WG
     I              I8WTIN                          WBWTIN
     I              I8D5NB                          WBD5NB
     I              I8DXWG                          WBDXWG
     I              I8B2NB                          WBB2NB
     I              I8WTCN                          WBWTCN
     I              I8PSCV                          WBPSCV
     I              I8SAWT                          WBSAWT
     I              I8B9NB                          WBB9NB
     I              I8D1WG                          WBD1WG
     I              I8CBNB                          WBCBNB
     I              I8EZWG                          WBEZWG
     I              I8CCNB                          WBCCNB
     I              I8E0WG                          WBE0WG
     I              I8D6NB                          WBD6NB
     I              I8OAWT                          WBOAWT
     I              I8CDNB                          WBCDNB
     I              I8UNW2                          WBUNW2
     I              I8CENB                          WBCENB
     I              I8F9WG                          WBF9WG
     I              I8BPNB                          WBBPNB
     I              I8GAWG                          WBGAWG
     I              I8BQNB                          WBBQNB
     I              I8GBWG                          WBGBWG
     I              I8BRNB                          WBBRNB
     I              I8GCWG                          WBGCWG
     I              I8BSNB                          WBBSNB
     I              I8GDWG                          WBGDWG
     I              I8BWNB                          WBBWNB
     I              I8GEWG                          WBGEWG
     I              I8PS6U                          WBPS6U
     I              I8WCST                          WBWCST
     I              I8WPST                          WBWPST
     I              I8B5ST                          WBB5ST
     I              I8TFST                          WBTFST
     I              I8TEST                          WBTEST
     I              I8THST                          WBTHST
     I              I8UDST                          WBUDST
     I              I8UFST                          WBUFST
     I              I8UGST                          WBUGST
     I              I8UHST                          WBUHST
     I              I8B6ST                          WBB6ST
     I              I8B7ST                          WBB7ST
     I              I8DVWG                          WBDVWG
     I              I8D7NB                          WBD7NB
     I              I8FCAD                          WBFCAD
     I              I8D9NB                          WBD9NB
     I              I8DWWG                          WBDWWG
     I              I8EANB                          WBEANB
     I              I8SHWT                          WBSHWT
     I              I8EBNB                          WBEBNB
     I              I8AVWT                          WBAVWT
     I              I8ECNB                          WBECNB
     I              I8WTON                          WBWTON
     I              I8EDNB                          WBEDNB
     I              I8FNWT                          WBFNWT
     I              I8EENB                          WBEENB
     I              I8QTAS                          WBQTAS
     I              I8EFNB                          WBEFNB
     I              I8WAIO                          WBWAIO
     I              I8EGNB                          WBEGNB
     I              I8R3CD                          WBR3CD
     I              I8RGNB                          WBRGNB
     I              I8RHNB                          WBRHNB
     I              I8RINB                          WBRINB
     I              I8XRCD                          WBXRCD
     I              I8UVST                          WBUVST
     I              I8UWST                          WBUWST
     I              I8UXST                          WBUXST
     I              I8VSST                          WBVSST
     I              I8AATM                          WBAATM
     I              I8AYNA                          WBAYNA
     I              I8A0NA                          WBA0NA
     I              I8AXDT                          WBAXDT
      *
     I@ADRET1
      * Warehouse                 Active records only
      * Renamed input format fields
     I              ADAJCD                          WCAJCD
     I              ADF8NA                          WCF8NA
     I              ADACNA                          WCACNA
     I              ADADNA                          WCADNA
     I              ADAENA                          WCAENA
     I              ADAJNA                          WCAJNA
     I              ADBTTX                          WCBTTX
     I              ADAOCD                          WCAOCD
     I              ADBGCD                          WCBGCD
     I              ADVHST                          WCVHST
     I              ADMPNA                          WCMPNA
     I              ADWPST                          WCWPST
     I              ADXUST                          WCXUST
     I              ADT0ST                          WCT0ST
     I              ADT1ST                          WCT1ST
     I              ADDBNB                          WCDBNB
     I              ADT2ST                          WCT2ST
     I              ADT3ST                          WCT3ST
     I              ADT4ST                          WCT4ST
     I              ADT6ST                          WCT6ST
     I              ADBWC3                          WCBWC3
     I              ADBTC3                          WCBTC3
     I              ADBUC3                          WCBUC3
     I              ADBVC3                          WCBVC3
     I              ADFCAA                          WCFCAA
     I              ADRQSX                          WCRQSX
     I              ADRRSX                          WCRRSX
     I              ADRSSX                          WCRSSX
     I              ADRTSX                          WCRTSX
     I              ADT7ST                          WCT7ST
     I              ADT8ST                          WCT8ST
     I              ADRNSX                          WCRNSX
     I              ADROSX                          WCROSX
     I              ADRPSX                          WCRPSX
     I              ADUVST                          WCUVST
     I              ADUWST                          WCUWST
     I              ADUXST                          WCUXST
     I              ADVSST                          WCVSST
     I              ADAATM                          WCAATM
     I              ADAYNA                          WCAYNA
     I              ADA0NA                          WCA0NA
     I              ADAXDT                          WCAXDT
      *
     I@AFREBE
      * Calendar                  Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WDAIC3
     I              AFBCDT                          WDBCDT
     I              AFCQNB                          WDCQNB
     I              AFESNB                          WDESNB
     I              AFETNB                          WDETNB
     I              AFBZNB                          WDBZNB
     I              AFA9ST                          WDA9ST
     I              AFEINB                          WDEINB
     I              AFC5ST                          WDC5ST
     I              AFAQNB                          WDAQNB
     I              AFCMST                          WDCMST
     I              AFV9ST                          WDV9ST
     I              AFWAST                          WDWAST
     I              AFX2ST                          WDX2ST
     I              AFOJDT                          WDOJDT
     I              AFNQNX                          WDNQNX
     I              AFNRNX                          WDNRNX
     I              AFI9SX                          WDI9SX
     I              AFJASX                          WDJASX
     I              AFOKDT                          WDOKDT
     I              AFOLDT                          WDOLDT
     I              AFUVST                          WDUVST
     I              AFUWST                          WDUWST
     I              AFUXST                          WDUXST
     I              AFAATM                          WDAATM
     I              AFAYNA                          WDAYNA
     I              AFA0NA                          WDA0NA
     I              AFAXDT                          WDAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
     IQPDI81    E DSPDI8CPL0
      * UPD : PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WBAIC3
     I              I8V5ST                          WBV5ST
     I              I8ELDT                          WBELDT
     I              I8HGCD                          WBHGCD
     I              I8AJCD                          WBAJCD
     I              I8GPDT                          WBGPDT
     I              I8WTSP                          WBWTSP
     I              I8QTSP                          WBQTSP
     I              I8DJPC                          WBDJPC
     I              I8F8WG                          WBF8WG
     I              I8WTIN                          WBWTIN
     I              I8D5NB                          WBD5NB
     I              I8DXWG                          WBDXWG
     I              I8B2NB                          WBB2NB
     I              I8WTCN                          WBWTCN
     I              I8PSCV                          WBPSCV
     I              I8SAWT                          WBSAWT
     I              I8B9NB                          WBB9NB
     I              I8D1WG                          WBD1WG
     I              I8CBNB                          WBCBNB
     I              I8EZWG                          WBEZWG
     I              I8CCNB                          WBCCNB
     I              I8E0WG                          WBE0WG
     I              I8D6NB                          WBD6NB
     I              I8OAWT                          WBOAWT
     I              I8CDNB                          WBCDNB
     I              I8UNW2                          WBUNW2
     I              I8CENB                          WBCENB
     I              I8F9WG                          WBF9WG
     I              I8BPNB                          WBBPNB
     I              I8GAWG                          WBGAWG
     I              I8BQNB                          WBBQNB
     I              I8GBWG                          WBGBWG
     I              I8BRNB                          WBBRNB
     I              I8GCWG                          WBGCWG
     I              I8BSNB                          WBBSNB
     I              I8GDWG                          WBGDWG
     I              I8BWNB                          WBBWNB
     I              I8GEWG                          WBGEWG
     I              I8PS6U                          WBPS6U
     I              I8WCST                          WBWCST
     I              I8WPST                          WBWPST
     I              I8B5ST                          WBB5ST
     I              I8TFST                          WBTFST
     I              I8TEST                          WBTEST
     I              I8THST                          WBTHST
     I              I8UDST                          WBUDST
     I              I8UFST                          WBUFST
     I              I8UGST                          WBUGST
     I              I8UHST                          WBUHST
     I              I8B6ST                          WBB6ST
     I              I8B7ST                          WBB7ST
     I              I8DVWG                          WBDVWG
     I              I8D7NB                          WBD7NB
     I              I8FCAD                          WBFCAD
     I              I8D9NB                          WBD9NB
     I              I8DWWG                          WBDWWG
     I              I8EANB                          WBEANB
     I              I8SHWT                          WBSHWT
     I              I8EBNB                          WBEBNB
     I              I8AVWT                          WBAVWT
     I              I8ECNB                          WBECNB
     I              I8WTON                          WBWTON
     I              I8EDNB                          WBEDNB
     I              I8FNWT                          WBFNWT
     I              I8EENB                          WBEENB
     I              I8QTAS                          WBQTAS
     I              I8EFNB                          WBEFNB
     I              I8WAIO                          WBWAIO
     I              I8EGNB                          WBEGNB
     I              I8R3CD                          WBR3CD
     I              I8RGNB                          WBRGNB
     I              I8RHNB                          WBRHNB
     I              I8RINB                          WBRINB
     I              I8XRCD                          WBXRCD
     I              I8UVST                          WBUVST
     I              I8UWST                          WBUWST
     I              I8UXST                          WBUXST
     I              I8VSST                          WBVSST
     I              I8AATM                          WBAATM
     I              I8AYNA                          WBAYNA
     I              I8A0NA                          WBA0NA
     I              I8AXDT                          WBAXDT
      *
     IYARDCS      DS                            326
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS                              9
      * KEY: Item Balance              Active/On-Hand > 0
      * I : RST Company Number
     I                                    P   1   20P1AIC3
     IP2PARM      DS
      * I : MAP Production Date RGF
     I                                    P   1   40P2GVDT
     IP3PARM      DS
      * N :  PS Weight Sched Shipment
     I                                    P   1   52P3SHWT
     IP4PARM      DS
      * N :  PS Weight Avail Prod
     I                                    P   1   52P4AVWT
     IP5PARM      DS
      * FLD: Company Item
      * N :  Unit Weight
     I                                    P   1   62P5AIWG
      * N :  Fresh Chilling Time
     I                                    P   7   92P5CHTM
      * N :  Base/Conv/Loss Item
     I                                       10  11 P5QZCD
      * N :  Credit Item Status
     I                                       12  12 P5VMST
     IP6PARM      DS
      * N :  USR Quantity Accumulated
     I                                    P   1   40P6FVQT
     IP7PARM      DS
      * N :  Date From             USR
     I                                    P   1   40P7JEDT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           KEY: Item Balan
     C           P2GVDT    PARM           WP0001  70       Production Date
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * ZZUPS Clc Inv/Shp/AvaiPF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$DENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * ZZUPS Clc Inv/Shp/AvaiPF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN B0AIC3    WQKA01           Company Number
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQKA01           Company Number
      * Establish starting position
     C           KRSA      SETLL@B0REYY                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Item Code
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDB0AIC3    $BAIC3           Company Number
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDB0AIC3    $CAIC3           Company Number
     C                     Z-ADDB0HGCD    $CHGCD           Item Code
     C                     MOVELB0AJCD    $CAJCD           Warehouse Code
     C                     Z-ADDB0AGCS    $CAGCS           Unit Cost Per P
     C                     Z-ADDB0AECS    $CAECS           Last Cost
     C                     Z-ADDB0BACS    $CBACS           Cost per Primar
     C                     Z-ADDB0BBCS    $CBBCS           Cost per Pricin
     C                     Z-ADDB0CBPR    $CCBPR           Revaluation Cos
     C                     Z-ADDB0GUDT    $CGUDT           Revaluation Eff
     C                     MOVELB0XYST    $CXYST           Revaluation Cos
     C                     Z-ADDB0CTPR    $CCTPR           Last Revaluatio
     C                     Z-ADDB0G4DT    $CG4DT           Last Revaluatio
     C                     Z-ADDB0BOWG    $CBOWG           On Hand Weight
     C                     Z-ADDB0HDQT    $CHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     $CSHWT           PS Weight Sched
     C                     Z-ADDB0DDQT    $CDDQT           On Hand U/M1 Su
     C                     Z-ADDB0DEQT    $CDEQT           On Hand U/M2 Su
     C                     Z-ADDB0DFQT    $CDFQT           On Hand U/M3 Su
     C                     Z-ADDB0HEQT    $CHEQT           Weight In Chill
     C                     Z-ADDB0AJQT    $CAJQT           Quantity Schedu
     C                     Z-ADDB0AQQT    $CAQQT           Quantity on Sal
     C                     Z-ADDB0AUQT    $CAUQT           Quantity on Pur
     C                     Z-ADDB0EMQT    $CEMQT           Quantity on Tra
     C                     Z-ADDB0DOQT    $CDOQT           Quantity Avail.
     C                     MOVELB0ATNA    $CATNA           Cycle Count Cod
     C                     Z-ADDB0AKDT    $CAKDT           Date of Last Or
     C                     Z-ADDB0ANDT    $CANDT           Date of Last Sh
     C                     Z-ADDB0IDVA    $CIDVA           Value of On Han
     C                     MOVELB0JVST    $CJVST           Inventory Plann
     C                     Z-ADDB0BZPC    $CBZPC           Safety Allowanc
     C                     Z-ADDB0DGQT    $CDGQT           Safety Allowanc
     C                     Z-ADDB0DIDT    $CDIDT           Stock Out Date
     C                     MOVELB0ALCD    $CALCD           Buyer Code
     C                     Z-ADDB0BFDY    $CBFDY           Lead Time - Las
     C                     Z-ADDB0DJDT    $CDJDT           Lead Time - Dat
     C                     Z-ADDB0BGDY    $CBGDY           Lead Time - Nex
     C                     Z-ADDB0DKDT    $CDKDT           Lead Time - Dat
     C                     MOVELB0J2ST    $CJ2ST           Lead Time - Exc
     C                     Z-ADDB0DJQT    $CDJQT           Usage Qty per C
     C                     Z-ADDB0BNWG    $CBNWG           Usage Weight pe
     C                     Z-ADDB0DLDT    $CDLDT           Inventory Manag
     C                     Z-ADDB0DPQT    $CDPQT           Minimum Quantit
     C                     Z-ADDB0DQQT    $CDQQT           Maximum Quantit
     C                     Z-ADDB0DMDT    $CDMDT           Last Physical C
     C                     MOVELB0M0ST    $CM0ST           Requisition Mod
     C                     MOVELB0J9ST    $CJ9ST           Cost Update Pen
     C                     MOVELB0KBST    $CKBST           Post G/L Status
     C                     Z-ADDB0AKC8    $CAKC8           Vendor - Item/W
     C                     Z-ADDB0RINB    $CRINB           Item Structure
     C                     Z-ADDB0RHNB    $CRHNB           Item Structure
     C                     Z-ADDB0RGNB    $CRGNB           Item Structure
     C                     MOVELB0UVST    $CUVST           EDI Status 1
     C                     MOVELB0UWST    $CUWST           EDI Status 2
     C                     MOVELB0UXST    $CUXST           EDI Status 3
     C                     MOVELB0VSST    $CVSST           Record Status
     C                     Z-ADDB0AATM    $CAATM           Job Time
     C                     MOVELB0AYNA    $CAYNA           User Id
     C                     MOVELB0A0NA    $CA0NA           Job Name
     C                     Z-ADDB0AXDT    $CAXDT           Job Date
      * USER: Process before print of detail format
      *
     C                     Z-ADD*ZERO     WN0001 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$CAIC3    WL0001           Company Number
     C                     Z-ADD$CHGCD    WL0002           Item Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WUAVNA    P      Description Lin
     C                     MOVELWL0004    WUADCD    P      U/M - Primary
     C                     Z-ADDWL0005    P5AIWG           Unit Weight
     C                     Z-ADDWL0006    WURINB           Item Structure
     C                     Z-ADDWL0007    WURHNB           Item Structure
     C                     Z-ADDWL0008    WURGNB           Item Structure
     C                     MOVELWL0009    WUN0CD    P      Item Type Code
     C                     MOVELWL0010    WUQ1CD    P      Default Warehou
     C                     Z-ADDWL0011    P5CHTM           Fresh Chilling
     C                     MOVELWL0012    WUQZCD    P      Base/Conv/Loss
     C                     MOVELWL0013    WUXWST    P      Variety/Rendere
     C                     MOVELWL0014    WUVMST    P      Credit Item Sta
     C                     Z-ADDWL0015    WUSWGH           Std Weight/Head
     C                     Z-ADDWL0016    WUPPHE           Pieces Per Head
     C                     MOVELWL0017    WUR3CD    P      Department Code
     C                     MOVELWL0018    WUSDCD    P      Group for Packa
     C                     MOVELWL0019    WUX5ST    P      Seconds Item
     C                     MOVELWL0020    WUPCCT    P      Piece Count Ite
     C                     Z-ADDWL0021    WUBDNB           Pieces Per Bag
     C                     Z-ADDWL0022    WUBJNB           Bags Per Unit
     C                     MOVELWL0023    WUSUST    P      Export/Domestic
     C                     MOVELWL0024    WUSVST    P      Print On Schedu
     C                     MOVELWL0025    WUSYST    P      Fresh Inv Alloc
     C                     MOVELWL0026    WUSZST    P      Fresh Sched As
     C                     MOVELWL0027    WUS1ST    P      Frozen Inv Allo
     C                     MOVELWL0028    WUXRCD    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL$CAJCD    WL0029    P      Warehouse Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0030    WUWPST    P      Warehouse Type
     C                     MOVELWL0031    WUXUST    P      Trans Contol AS
     C                     MOVELWL0032    WUT0ST    P      Warehouse Locat
     C                     MOVELWL0033    WUT1ST    P      Warehouse Std C
     C                     Z-ADDWL0034    WUDBNB           Warehouse Chill
      * For Inventory Purpose only.  use chilling time from company/item
      * Rtv Chill Time        RT - Company/Item  * 
     C                     EXSR SERVGN
      * Weight On-Hand
      * CASE: CUR.On Hand U/M1 Summary is Greater than zero
     C           $CDDQT    IFGT *ZERO                      *IF
      * Calculate On-Hand Quantity
      * CASE: PAR.Chilling Time is GT Zero
     C           P5CHTM    IFGT *ZERO                      *IF
      * Chilling Time
      * WRK.Chilling Time =
      *    *COMPUTE ((x1 - x3) * x2)
      * x1    : PAR.Fresh Chilling Time
      * -     : PGM.*Synon (17,7) work field
      * x3    : CON.1
      * *     : PAR.Chilling Time *
      * x2    : CON.-1
     C           P5CHTM    SUB  1         W0WD00           *Synon (17,7) w
     C           W0WD00    MULT -1        P5CHTM           Fresh Chilling
     C                     Z-ADDP5CHTM    WUCHTM           Fresh Chilling
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           WUCHTM    IFLT *ZERO                      *IF
     C           WUCHTM    MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
     C                     EXSR SFRVGN
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           WUCHTM    IFGT *ZERO                      *IF
      * Clc Date (ascending)  RT - Calendar  * 
     C                     EXSR SGRVGN
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           WUCHTM    IFEQ *ZERO                      *IF
     C                     Z-ADDP2GVDT    P7JEDT           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * UPS Clc Unavail Inv   RT - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$CAIC3    WL0035           Company Number
     C                     Z-ADD$CHGCD    WL0036           Item Code
     C                     MOVEL$CAJCD    WL0037    P      Warehouse Code
     C                     Z-ADDP7JEDT    WL0038           Production Date
     C                     Z-ADD$CHDQT    WL0039           Quantity In Chi
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0039    $CHDQT           Quantity In Chi
     C           B0DDQT    SUB  $CHDQT    WUDDQT           On Hand U/M1 Su
     C                     ELSE
      * CASE: *OTHERWISE
      * UPS Clc Unavail Inv   RT - IC Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$CAIC3    WL0035           Company Number
     C                     Z-ADD$CHGCD    WL0036           Item Code
     C                     MOVEL$CAJCD    WL0037    P      Warehouse Code
     C                     Z-ADDP2GVDT    WL0038           Production Date
     C                     Z-ADD$CHDQT    WL0039           Quantity In Chi
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0039    $CHDQT           Quantity In Chi
     C           B0DDQT    SUB  $CHDQT    WUDDQT           On Hand U/M1 Su
     C                     END                             *FI
      * On Hand Weight Summary
      * CASE: WRK.On Hand U/M1 Summary is Greater than zero
     C           WUDDQT    IFGT *ZERO                      *IF
     C           WUDDQT    MULT P5AIWG    $CBOWG           On Hand Weight
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     $CBOWG           On Hand Weight
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     $CBOWG           On Hand Weight
     C                     END                             *FI
      * UPS Rtv Sched Shpmnts RT - PD Order Detail  * 
     C                     EXSR SIRVGN
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
      * CASE: PGM.*Print format is Print format
     C           W0PFM     IFEQ 'Y'                        *IF
      * Update Production Detail w/Inv On-Hand; Sched Shpmnt; Avail Prod.
      * UPS Upd Inv/Shp/Avail RT - PS Production Detail  * 
     C                     EXSR SKRVGN
     C                     END                             *FI
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN B0AIC3    WZA001           Company Number
     C                     Z-ADDB0AIC3    WZA001
     C           *LIKE     DEFN B0HGCD    WZA002           Item Code
     C                     Z-ADDB0HGCD    WZA002
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@B0REYY                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Company Number
     C                     MOVEL*BLANK    W0AL01  1        Item Code
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Item Code
     C                     ELSE
      * Next record - Detect level breaks
     C           B0AIC3    IFNE WZA001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           B0HGCD    IFNE WZA002                     Item Code
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of ZZUPS Clc Inv/Shp/AvaiPF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of ZZUPS Clc Inv/Shp/AvaiPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Company Number of ZZUPS Clc Inv/Shp/AvaiPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Convert fields to external form
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $BAIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$BAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VBAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Print format
     C                     WRITE$BKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print Item Code of ZZUPS Clc Inv/Shp/AvaiPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print Detail line. of ZZUPS Clc Inv/Shp/AvaiPF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * Do not print format if both On-Hand and Sched Ship = Zero.
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : CUR.On Hand Weight Summary is Equal to zero
      *   |- c2    : CUR.PS Weight Sched Shipment is Not Entered
      *   |- c3    : CUR.Quantity In Chill is Equal to zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $CBOWG    IFEQ *ZERO                      *IF
     C           $CSHWT    IFEQ *ZERO                      *IF
     C           $CHDQT    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $CHGCD    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$CHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VCHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCHGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$CCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$CDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of ZZUPS Clc Inv/Shp/AvaiPF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of ZZUPS Clc Inv/Shp/AvaiPF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * Item Code of ZZUPS Clc Inv/Shp/AvaiPF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of ZZUPS Clc Inv/Shp/AvaiPF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD3         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSA01           Application Cod
     C                     MOVEL'P/S'     WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0001    BZAIC3           Company Number
     C                     Z-ADDWL0002    BZHGCD           Item Code
      * Establish starting position
     C           KRSSC     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0003           Description Lin
     C                     MOVEL*BLANK    WL0004           U/M - Primary
     C                     Z-ADD*ZERO     WL0005           Unit Weight
     C                     Z-ADD*ZERO     WL0006           Item Structure
     C                     Z-ADD*ZERO     WL0007           Item Structure
     C                     Z-ADD*ZERO     WL0008           Item Structure
     C                     MOVEL*BLANK    WL0009           Item Type Code
     C                     MOVEL*BLANK    WL0010           Default Warehou
     C                     Z-ADD*ZERO     WL0011           Fresh Chilling
     C                     MOVEL*BLANK    WL0012           Base/Conv/Loss
     C                     MOVEL*BLANK    WL0013           Variety/Rendere
     C                     MOVEL*BLANK    WL0014           Credit Item Sta
     C                     Z-ADD*ZERO     WL0015           Std Weight/Head
     C                     Z-ADD*ZERO     WL0016           Pieces Per Head
     C                     MOVEL*BLANK    WL0017           Department Code
     C                     MOVEL*BLANK    WL0018           Group for Packa
     C                     MOVEL*BLANK    WL0019           Seconds Item
     C                     MOVEL*BLANK    WL0020           Piece Count Ite
     C                     Z-ADD*ZERO     WL0021           Pieces Per Bag
     C                     Z-ADD*ZERO     WL0022           Bags Per Unit
     C                     MOVEL*BLANK    WL0023           Export/Domestic
     C                     MOVEL*BLANK    WL0024           Print On Schedu
     C                     MOVEL*BLANK    WL0025           Fresh Inv Alloc
     C                     MOVEL*BLANK    WL0026           Fresh Sched As
     C                     MOVEL*BLANK    WL0027           Frozen Inv Allo
     C                     MOVEL*BLANK    WL0028           Primal Group Co
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAVNA    WL0003           Description Lin
     C                     MOVELBZADCD    WL0004           U/M - Primary
     C                     Z-ADDBZAIWG    WL0005           Unit Weight
     C                     Z-ADDBZRINB    WL0006           Item Structure
     C                     Z-ADDBZRHNB    WL0007           Item Structure
     C                     Z-ADDBZRGNB    WL0008           Item Structure
     C                     MOVELBZN0CD    WL0009           Item Type Code
     C                     MOVELBZQ1CD    WL0010           Default Warehou
     C                     Z-ADDBZCHTM    WL0011           Fresh Chilling
     C                     MOVELBZQZCD    WL0012           Base/Conv/Loss
     C                     MOVELBZXWST    WL0013           Variety/Rendere
     C                     MOVELBZVMST    WL0014           Credit Item Sta
     C                     Z-ADDBZSWGH    WL0015           Std Weight/Head
     C                     Z-ADDBZPPHE    WL0016           Pieces Per Head
     C                     MOVELBZR3CD    WL0017           Department Code
     C                     MOVELBZSDCD    WL0018           Group for Packa
     C                     MOVELBZX5ST    WL0019           Seconds Item
     C                     MOVELBZPCCT    WL0020           Piece Count Ite
     C                     Z-ADDBZBDNB    WL0021           Pieces Per Bag
     C                     Z-ADDBZBJNB    WL0022           Bags Per Unit
     C                     MOVELBZSUST    WL0023           Export/Domestic
     C                     MOVELBZSVST    WL0024           Print On Schedu
     C                     MOVELBZSYST    WL0025           Fresh Inv Alloc
     C                     MOVELBZSZST    WL0026           Fresh Sched As
     C                     MOVELBZS1ST    WL0027           Frozen Inv Allo
     C                     MOVELBZXRCD    WL0028           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * BPS Rtv Whs Info      RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0029    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSD     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0030           Warehouse Type
     C                     MOVEL*BLANK    WL0031           Trans Contol AS
     C                     MOVEL*BLANK    WL0032           Warehouse Locat
     C                     MOVEL*BLANK    WL0033           Warehouse Std C
     C                     Z-ADD*ZERO     WL0034           Warehouse Chill
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELADWPST    WL0030           Warehouse Type
     C                     MOVELADXUST    WL0031           Trans Contol AS
     C                     MOVELADT0ST    WL0032           Warehouse Locat
     C                     MOVELADT1ST    WL0033           Warehouse Std C
     C                     Z-ADDADDBNB    WL0034           Warehouse Chill
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Chill Time        RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADD$CAIC3    BZAIC3           Company Number
     C                     Z-ADD$CHGCD    BZHGCD           Item Code
      * Establish starting position
     C           KRSSE     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P5CHTM           Fresh Chilling
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBZCHTM    P5CHTM           Fresh Chilling
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Clc Date (descending) RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFAIC3    WQSF01           Company Number
      * Define keylist
     C           KPSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
      * Setup key
     C                     Z-ADD$CAIC3    WQSF01           Company Number
     C                     Z-ADDP2GVDT    AFBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSF     SETLL@AFREPU                    *
     C           KRSSF     READE@AFREPU                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Post to G/L Date EQ DB1.Post to G/L Date
     C           P2GVDT    IFEQ AFBCDT                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
      * CASE: WRK.Count USR EQ PAR.*Duration (factor)
     C           WUCNTU    IFEQ WUDUF                      *IF
     C                     Z-ADDAFBCDT    P7JEDT           *Date1 (ending)
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSF     READE@AFREPU                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Clc Date (ascending)  RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSG01           Company Number
      * Define keylist
     C           KPSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WABCDT           Post to G/L Dat
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
      * Setup key
     C                     Z-ADD$CAIC3    WQSG01           Company Number
     C                     Z-ADDP2GVDT    WABCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSG     SETLL@AFREYY                    *
     C           KRSSG     READE@AFREYY                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Post to G/L Date EQ DB1.Post to G/L Date
     C           P2GVDT    IFEQ WABCDT                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
      * CASE: WRK.Count USR EQ PAR.*Duration (factor)
     C           WUCNTU    IFEQ WUCHTM                     *IF
     C                     Z-ADDWABCDT    P7JEDT           *Date1 (ending)
     C                     GOTO SGEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSG     READE@AFREYY                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * UPS Clc Unavail Inv   RT - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0039           Quantity In Chi
      * Declare restrictor key work fields
     C           *LIKE     DEFN B1AIC3    WQSH01           Company Number
     C           *LIKE     DEFN B1HGCD    WQSH02           Item Code
     C           *LIKE     DEFN B1AJCD    WQSH03           Warehouse Code
      * Define keylist
     C           KPSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Item Code
     C                     KFLD           WQSH03           Warehouse Code
     C                     KFLD           B1ELDT           Production Date
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Item Code
     C                     KFLD           WQSH03           Warehouse Code
      * Setup key
     C                     Z-ADDWL0035    WQSH01           Company Number
     C                     Z-ADDWL0036    WQSH02           Item Code
     C                     MOVELWL0037    WQSH03           Warehouse Code
     C                     Z-ADDWL0038    B1ELDT           Production Date
      * Establish starting position
     C           KPSSH     SETLLCAB1RL4                    *
     C           KRSSH     READECAB1RL4                  90*
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  B1ARQT    WL0039           Quantity In Chi
     C           KRSSH     READECAB1RL4                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * UPS Rtv Sched Shpmnts RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     $CSHWT           PS Weight Sched
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSI01           Company Number
     C           *LIKE     DEFN OMHGCD    WQSI02           Item Code
     C           *LIKE     DEFN OMAJCD    WQSI03           Warehouse Code
      * Define keylist
     C           KPSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Item Code
     C                     KFLD           WQSI03           Warehouse Code
     C                     KFLD           OMAODT           Scheduled Ship
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Item Code
     C                     KFLD           WQSI03           Warehouse Code
      * Setup key
     C                     Z-ADD$CAIC3    WQSI01           Company Number
     C                     Z-ADD$CHGCD    WQSI02           Item Code
     C                     MOVEL$CAJCD    WQSI03           Warehouse Code
     C                     Z-ADDP2GVDT    OMAODT           Scheduled Ship
      * Establish starting position
     C           KPSSI     SETLL@BGWKKG                    *
     C           KRSSI     READE@BGWKKG                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Hdr Sts,BillActTy RT - Order Header TRG  * 
     C                     EXSR SJRVGN
      * CASE:
      *  - c1ANDc2
      *   |- c1    : WRK.Header Status is Not Comp/Canc/Conf
      *   |- c2    : WRK.Billing Activity Type is Invoice or Transfer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUGWST    IFEQ 'L'                        *IF
     C           WUGWST    OREQ 'A'
     C           WUGWST    OREQ 'E'
     C           WUGWST    OREQ 'H'
     C           WUOBST    IFEQ '1'                        *IF
     C           WUOBST    OREQ '4'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  OMAUWG    $CSHWT           PS Weight Sched
     C                     END                             *FI
     C           KRSSI     READE@BGWKKG                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Hdr Sts,BillActTy RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDOMAIC3    BEAIC3           Company Number
     C                     Z-ADDOMC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSJ     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEGWST    WUGWST           Header Status
     C                     MOVELBEOBST    WUOBST           Billing Activit
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * UPS Upd Inv/Shp/Avail RT - PS Production Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0002  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0003  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0004  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0005  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0006  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0007  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0008  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0009  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0010  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0011  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0012  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0013  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0014  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0015  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0016  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0017  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0018  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0019  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0020  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0021  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0022  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0023  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0024 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0025  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0026 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0027  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0028 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0029  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0030 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0031  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0032 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0033  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0034 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0035  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0036  3        PS Item Id
     C                     MOVEL*BLANK    WN0037  2        Warehouse Type
     C                     MOVEL*BLANK    WN0038  1        PS Lock Status
     C                     MOVEL*BLANK    WN0039  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0040  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0041  1        PS Piece Count
     C                     MOVEL*BLANK    WN0042  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0043  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0044  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0045  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0046  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0047  3        PS Production W
     C                     Z-ADD*ZERO     WN0048  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0049  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0050  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0051  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0052  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0053  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0054  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0055  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0056  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0057  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0058  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0059  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0060  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0061  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0062  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0063  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0064  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0065  6        Department Code
     C                     Z-ADD*ZERO     WN0066  30       Item Structure
     C                     Z-ADD*ZERO     WN0067  30       Item Structure
     C                     Z-ADD*ZERO     WN0068  30       Item Structure
     C                     MOVEL*BLANK    WN0069  6        Primal Group Co
     C                     MOVEL*BLANK    WN0070  1        EDI Status 1
     C                     MOVEL*BLANK    WN0071  1        EDI Status 2
     C                     MOVEL*BLANK    WN0072  1        EDI Status 3
     C                     MOVEL*BLANK    WN0073  1        Record Status
     C                     Z-ADD*ZERO     WN0074  60       Job Time
     C                     MOVEL*BLANK    WN0075 10        User Id
     C                     MOVEL*BLANK    WN0076 10        Job Name
     C                     Z-ADD*ZERO     WN0077  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           I8AIC3           Company Number
     C                     KFLD           I8V5ST           Production Type
     C                     KFLD           I8ELDT           Production Date
     C                     KFLD           I8HGCD           Item Code
     C                     KFLD           I8AJCD           Warehouse Code
      * Setup key
     C                     Z-ADD$CAIC3    I8AIC3           Company Number
     C                     MOVEL'S'       I8V5ST           Production Type
     C                     Z-ADDP2GVDT    I8ELDT           Production Date
     C                     Z-ADD$CHGCD    I8HGCD           Item Code
     C                     MOVEL$CAJCD    I8AJCD           Warehouse Code
      * Establish starting position
     C           KRSSK     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
      * CASE: PAR.Chilling Time is GT Zero
     C           P5CHTM    IFGT *ZERO                      *IF
     C           $CBOWG    SUB  $CSHWT    WN0055           PS Weight Avail
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD$CBOWG    WN0055           PS Weight Avail
     C                     END                             *FI
      * CASE: PAR.PS Weight Avail Prod is LT Zero
     C           WN0055    IFLT *ZERO                      *IF
     C                     Z-ADD*ZERO     WN0055           PS Weight Avail
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) WN0006' defaulted for 'PS Avg Piece Wgt'.
      * Field '(PAR) WN0007' defaulted for 'PS Pieces Inv On-Hand'.
      * Field '(PAR) WN0009' defaulted for 'PS Pieces Standard'.
      * Field '(PAR) WN0011' defaulted for 'PS Pieces Converted'.
      * Field '(PAR) WN0013' defaulted for 'PS Pieces Shipping Adj'.
      * Field '(PAR) WN0015' defaulted for 'PS Pieces Prod Adj'.
      * Field '(PAR) WN0017' defaulted for 'PS Pieces Inv Adj'.
      * Field '(PAR) WN0019' defaulted for 'PS Pieces Ship Cut Adj'.
      * Field '(PAR) WN0021' defaulted for 'PS Pieces Prod Allocated'.
      * Field '(PAR) WN0023' defaulted for 'PS Pieces Inv Allocated'.
      * Field '(PAR) WN0024' defaulted for 'PS Unit Weight'.
      * Field '(PAR) WN0025' defaulted for 'PS Pieces Whse Tfr Adj'.
      * Field '(PAR) WN0026' defaulted for 'PS Weight Whse Tfr Adj'.
      * Field '(PAR) WN0027' defaulted for 'PS Pieces Unused 2'.
      * Field '(PAR) WN0028' defaulted for 'PS Weight Unused 3'.
      * Field '(PAR) WN0029' defaulted for 'PS Pieces Unused 3'.
      * Field '(PAR) WN0030' defaulted for 'PS Weight Unused 4'.
      * Field '(PAR) WN0031' defaulted for 'PS Pieces Unused 4'.
      * Field '(PAR) WN0032' defaulted for 'PS Weight Unused 5'.
      * Field '(PAR) WN0033' defaulted for 'PS Pieces Unused 5'.
      * Field '(PAR) WN0034' defaulted for 'PS Weight Unused 6'.
      * Field '(PAR) WN0035' defaulted for 'PS Pieces Unused 6'.
      * Field '(PAR) WN0039' defaulted for 'PS Export/Domestic'.
      * Field '(PAR) WN0040' defaulted for 'PS Print On Schedule'.
      * Field '(PAR) WN0041' defaulted for 'PS Piece Count Item'.
      * Field '(PAR) WN0042' defaulted for 'PS Unused Sts 1'.
      * Field '(PAR) WN0043' defaulted for 'PS Unused Sts 2'.
      * Field '(PAR) WN0044' defaulted for 'PS Unused Sts 3'.
      * Field '(PAR) WN0045' defaulted for 'PS Unused Sts 4'.
      * Field '(PAR) WN0049' defaulted for 'PS Pieces Ordered'.
      * Field '(PAR) WN0051' defaulted for 'PS Pieces FC Adjusted'.
      * Field '(PAR) WN0053' defaulted for 'PS Pieces FX Adjusted'.
      * Field '(PAR) WN0054' defaulted for 'PS Pieces Sched Shipment'.
      * Field '(PAR) WN0056' defaulted for 'PS Pieces Avail Prod'.
      * Field '(PAR) WN0058' defaulted for 'PS Pieces Production Need'.
      * Field '(PAR) WN0060' defaulted for 'PS Pieces Fab Needs'.
      * Field '(PAR) WN0062' defaulted for 'PS Pieces Sched Prod'.
      * Field '(PAR) WN0064' defaulted for 'PS Pieces Sched Need'.
      * Field '(PAR) WN0069' defaulted for 'Primal Group Code'.
      * UPS Crt Prod Detail   CR - PS Production Detail  * 
     C                     EXSR SLCRRC
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: PAR.Chilling Time is GT Zero
     C           P5CHTM    IFGT *ZERO                      *IF
     C           $CBOWG    SUB  $CSHWT    WN0055           PS Weight Avail
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD$CBOWG    WN0055           PS Weight Avail
     C                     END                             *FI
      * CASE: PAR.PS Weight Avail Prod is LT Zero
     C           WN0055    IFLT *ZERO                      *IF
     C                     Z-ADD*ZERO     WN0055           PS Weight Avail
     C                     END                             *FI
      * UPS Chg Inv/Shp/Avail CH - PS Production Detail  * 
     C                     EXSR SOCHRC
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCRRC    BEGSR
      *================================================================
      * UPS Crt Prod Detail   CR - PS Production Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @I8CPUR
     C                     Z-ADD$CAIC3    WBAIC3           Company Number
     C                     MOVEL'S'       WBV5ST           Production Type
     C                     Z-ADDP2GVDT    WBELDT           Production Date
     C                     Z-ADD$CHGCD    WBHGCD           Item Code
     C                     MOVEL$CAJCD    WBAJCD           Warehouse Code
     C                     Z-ADDWN0002    WBGPDT           PS Available Sh
     C                     Z-ADDWN0003    WBWTSP           PS Weight Plann
     C                     Z-ADDWN0004    WBQTSP           PS Pieces Plann
     C                     Z-ADDWN0005    WBDJPC           PS % of Carcass
     C                     Z-ADDWN0006    WBF8WG           PS Avg Piece Wg
     C                     Z-ADD$CBOWG    WBWTIN           PS Weight Inv O
     C                     Z-ADDWN0007    WBD5NB           PS Pieces Inv O
     C                     Z-ADDWN0008    WBDXWG           PS Weight Stand
     C                     Z-ADDWN0009    WBB2NB           PS Pieces Stand
     C                     Z-ADDWN0010    WBWTCN           PS Weight Conve
     C                     Z-ADDWN0011    WBPSCV           PS Pieces Conve
     C                     Z-ADDWN0012    WBSAWT           PS Weight Shipp
     C                     Z-ADDWN0013    WBB9NB           PS Pieces Shipp
     C                     Z-ADDWN0014    WBD1WG           PS Weight Prod
     C                     Z-ADDWN0015    WBCBNB           PS Pieces Prod
     C                     Z-ADDWN0016    WBEZWG           PS Weight Inv A
     C                     Z-ADDWN0017    WBCCNB           PS Pieces Inv A
     C                     Z-ADDWN0018    WBE0WG           PS Weight Ship
     C                     Z-ADDWN0019    WBD6NB           PS Pieces Ship
     C                     Z-ADDWN0020    WBOAWT           PS Weight Prod
     C                     Z-ADDWN0021    WBCDNB           PS Pieces Prod
     C                     Z-ADDWN0022    WBUNW2           PS Weight Inv A
     C                     Z-ADDWN0023    WBCENB           PS Pieces Inv A
     C                     Z-ADDWN0024    WBF9WG           PS Unit Weight
     C                     Z-ADDWN0025    WBBPNB           PS Pieces Whse
     C                     Z-ADDWN0026    WBGAWG           PS Weight Whse
     C                     Z-ADDWN0027    WBBQNB           PS Pieces Unuse
     C                     Z-ADDWN0028    WBGBWG           PS Weight Unuse
     C                     Z-ADDWN0029    WBBRNB           PS Pieces Unuse
     C                     Z-ADDWN0030    WBGCWG           PS Weight Unuse
     C                     Z-ADDWN0031    WBBSNB           PS Pieces Unuse
     C                     Z-ADDWN0032    WBGDWG           PS Weight Unuse
     C                     Z-ADDWN0033    WBBWNB           PS Pieces Unuse
     C                     Z-ADDWN0034    WBGEWG           PS Weight Unuse
     C                     Z-ADDWN0035    WBPS6U           PS Pieces Unuse
     C                     MOVELWN0036    WBWCST           PS Item Id
     C                     MOVELWN0037    WBWPST           Warehouse Type
     C                     MOVELWN0038    WBB5ST           PS Lock Status
     C                     MOVELWN0039    WBTFST           PS Export/Domes
     C                     MOVELWN0040    WBTEST           PS Print On Sch
     C                     MOVELWN0041    WBTHST           PS Piece Count
     C                     MOVELWN0042    WBUDST           PS Unused Sts 1
     C                     MOVELWN0043    WBUFST           PS Unused Sts 2
     C                     MOVELWN0044    WBUGST           PS Unused Sts 3
     C                     MOVELWN0045    WBUHST           PS Unused Sts 4
     C                     MOVELWN0046    WBB6ST           PS Item Sched N
     C                     MOVELWN0047    WBB7ST           PS Production W
     C                     Z-ADDWN0048    WBDVWG           PS Weight Order
     C                     Z-ADDWN0049    WBD7NB           PS Pieces Order
     C                     Z-ADDWN0050    WBFCAD           PS Weight FC Ad
     C                     Z-ADDWN0051    WBD9NB           PS Pieces FC Ad
     C                     Z-ADDWN0052    WBDWWG           PS Weight FX Ad
     C                     Z-ADDWN0053    WBEANB           PS Pieces FX Ad
     C                     Z-ADD$CSHWT    WBSHWT           PS Weight Sched
     C                     Z-ADDWN0054    WBEBNB           PS Pieces Sched
     C                     Z-ADDWN0055    WBAVWT           PS Weight Avail
     C                     Z-ADDWN0056    WBECNB           PS Pieces Avail
     C                     Z-ADDWN0057    WBWTON           PS Weight Produ
     C                     Z-ADDWN0058    WBEDNB           PS Pieces Produ
     C                     Z-ADDWN0059    WBFNWT           PS Weight Fab N
     C                     Z-ADDWN0060    WBEENB           PS Pieces Fab N
     C                     Z-ADDWN0061    WBQTAS           PS Weight Sched
     C                     Z-ADDWN0062    WBEFNB           PS Pieces Sched
     C                     Z-ADDWN0063    WBWAIO           PS Weight Sched
     C                     Z-ADDWN0064    WBEGNB           PS Pieces Sched
     C                     MOVELWN0065    WBR3CD           Department Code
     C                     Z-ADDWN0066    WBRGNB           Item Structure
     C                     Z-ADDWN0067    WBRHNB           Item Structure
     C                     Z-ADDWN0068    WBRINB           Item Structure
     C                     MOVELWN0069    WBXRCD           Primal Group Co
     C                     MOVELWN0070    WBUVST           EDI Status 1
     C                     MOVELWN0071    WBUWST           EDI Status 2
     C                     MOVELWN0072    WBUXST           EDI Status 3
     C                     MOVELWN0073    WBVSST           Record Status
     C                     Z-ADDWN0074    WBAATM           Job Time
     C                     MOVELWN0075    WBAYNA           User Id
     C                     MOVELWN0076    WBA0NA           Job Name
     C                     Z-ADDWN0077    WBAXDT           Job Date
      *
      * USER: Processing before Data update
      * BPS Setup Item Info   IF
      *
     C                     Z-ADD*ZERO     WN0078 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0001           Company Number
     C                     Z-ADDWBHGCD    WL0002           Item Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    WUAVNA    P      Description Lin
     C                     MOVELWL0004    WUADCD    P      U/M - Primary
     C                     Z-ADDWL0005    WUAIWG           Unit Weight
     C                     Z-ADDWL0006    WBRINB           Item Structure
     C                     Z-ADDWL0007    WBRHNB           Item Structure
     C                     Z-ADDWL0008    WBRGNB           Item Structure
     C                     MOVELWL0009    WUN0CD    P      Item Type Code
     C                     MOVELWL0010    WUQ1CD    P      Default Warehou
     C                     Z-ADDWL0011    WUCHTM           Fresh Chilling
     C                     MOVELWL0012    WUQZCD    P      Base/Conv/Loss
     C                     MOVELWL0013    WUXWST    P      Variety/Rendere
     C                     MOVELWL0014    WUVMST    P      Credit Item Sta
     C                     Z-ADDWL0015    WUSWGH           Std Weight/Head
     C                     Z-ADDWL0016    WUPPHE           Pieces Per Head
     C                     MOVELWL0017    WBR3CD    P      Department Code
     C                     MOVELWL0018    WUSDCD    P      Group for Packa
     C                     MOVELWL0019    WUX5ST    P      Seconds Item
     C                     MOVELWL0020    WBTHST    P      Piece Count Ite
     C                     Z-ADDWL0021    WUBDNB           Pieces Per Bag
     C                     Z-ADDWL0022    WUBJNB           Bags Per Unit
     C                     MOVELWL0023    WBTFST    P      Export/Domestic
     C                     MOVELWL0024    WBTEST    P      Print On Schedu
     C                     MOVELWL0025    WUSYST    P      Fresh Inv Alloc
     C                     MOVELWL0026    WUSZST    P      Fresh Sched As
     C                     MOVELWL0027    WUS1ST    P      Frozen Inv Allo
     C                     MOVELWL0028    WBXRCD    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWBAJCD    WL0029    P      Warehouse Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0030    WBWPST    P      Warehouse Type
     C                     MOVELWL0031    WUXUST    P      Trans Contol AS
     C                     MOVELWL0032    WUT0ST    P      Warehouse Locat
     C                     MOVELWL0033    WUT1ST    P      Warehouse Std C
     C                     Z-ADDWL0034    WUDBNB           Warehouse Chill
      * BPS Set Up Item Id    IF
      * CASE: PAR.Item Type Code is Raw Materials
     C           WUN0CD    IFEQ 'RM'                       *IF
     C                     MOVEL'RMB'     WBWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Seconds Item is Yes
     C           WUX5ST    IFEQ 'Y'                        *IF
     C                     MOVEL'FSC'     WBWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Variety/Rendered/Cut is Variety
     C           WUXWST    IFEQ 'V'                        *IF
     C                     MOVEL'FVR'     WBWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Rendered
     C           WUXWST    IFEQ 'R'                        *IF
     C                     MOVEL'FRD'     WBWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Cut
     C           WUXWST    IFEQ 'C'                        *IF
      * Base/Converted/Fabricated
      * CASE: PAR.Credit Item Status is yes
     C           WUVMST    IFEQ 'Y'                        *IF
      * Setup Base/Converted/Fabricated Credit
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FBC'     WBWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCC'     WBWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFC'     WBWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLC'     WBWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup Base/Converted/Fabricated
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FGB'     WBWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCV'     WBWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFB'     WBWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLS'     WBWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Output PS Prod Warehouse
      * Rtv Productin Whs     RT - Warehouse  * 
     C                     EXSR SMRVGN
      * Available Ship Date
      * CASE: WRK.Warehouse Std Chill Time is yes
     C           WUT1ST    IFEQ 'Y'                        *IF
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0040           Company Number
     C                     Z-ADDP2GVDT    WL0041           Post to G/L Dat
     C                     Z-ADDWUDBNB    WL0042           Fresh Chilling
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0043    WBGPDT           PS Available Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0040           Company Number
     C                     Z-ADDP2GVDT    WL0041           Post to G/L Dat
     C                     Z-ADDWUCHTM    WL0042           Fresh Chilling
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0043    WBGPDT           PS Available Sh
     C                     END                             *FI
      * Average Piece Weight
      * CASE: PAR.PS Pieces Planned Prod is GT Zero
     C           WN0004    IFGT *ZERO                      *IF
     C           WN0003    DIV  WN0004    WBF8WG           PS Avg Piece Wg
     C                     END                             *FI
      * UPS CRTOBJ Stamp      IF
     C                     MOVEL'A'       WBVSST           Record Status
     C                     Z-ADD##JTM     WBAATM           Job Time
     C                     MOVEL##USR     WBAYNA           User Id
     C                     MOVEL##PGM     WBA0NA           Job Name
     C                     Z-ADD##JDT     WBAXDT           Job Date
     C                     MOVEL'N'       WBB5ST           PS Lock Status
     C           KLCRSL    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBV5ST           Production Type
     C                     KFLD           WBELDT           Production Date
     C                     KFLD           WBHGCD           Item Code
     C                     KFLD           WBAJCD           Warehouse Code
      * Check for duplicate primary key
     C           KLCRSL    SETLL@I8CPUR                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1764' W0RTN   7
      * Send message 'PS Prod Item Schedule  EX'
     C                     MOVEL'USR1764' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C                     WRITE@I8CPUR                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Productin Whs     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWBAJCD    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSM     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WBB7ST           Production Ware
     C                     Z-ADD*ZERO     YL0001           Accounting Comp
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCAOCD    WBB7ST           Production Ware
     C                     Z-ADDWCBTC3    YL0001           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSN01           Company Number
      * Define keylist
     C           KPSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WDBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Company Number
      * Setup key
     C                     Z-ADDWL0040    WQSN01           Company Number
     C                     Z-ADDWL0041    WDBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSN     SETLL@AFREBE                    *
     C           KRSSN     READE@AFREBE                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Count USR EQ PAR.Chilling Time
     C           WUCNTU    IFEQ WL0042                     *IF
     C                     Z-ADDWDBCDT    WL0043           PS Available Sh
     C                     GOTO SNEXIT                     *QUIT
     C                     END                             *FI
      * Skip Saturday
      * CASE: DB1.Day of Week is Saturday
     C           WDA9ST    IFEQ '7'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C           KRSSN     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCHRC    BEGSR
      *================================================================
      * UPS Chg Inv/Shp/Avail CH - PS Production Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0079  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0080  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0081  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0082  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0083  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0084  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0085  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0086  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0087  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0088  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0089  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0090  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0091  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0092  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0093  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0094  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0095  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0096  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0097  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0098  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0099  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0100  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0101 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0102  70       PS Pieces Whse
     C                     Z-ADD*ZERO     WN0103 112       PS Weight Whse
     C                     Z-ADD*ZERO     WN0104  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0105 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0106  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0107 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0108  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0109 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0110  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0111 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0112  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0113  3        PS Item Id
     C                     MOVEL*BLANK    WN0114  2        Warehouse Type
     C                     MOVEL*BLANK    WN0115  1        PS Lock Status
     C                     MOVEL*BLANK    WN0116  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0117  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0118  1        PS Piece Count
     C                     MOVEL*BLANK    WN0119  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0120  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0121  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0122  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0123  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0124  3        PS Production W
     C                     Z-ADD*ZERO     WN0125  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0126  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0127  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0128  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0129  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0130  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0131  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0132  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0133  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0134  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0135  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0136  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0137  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0138  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0139  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0140  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0141  6        Department Code
     C                     Z-ADD*ZERO     WN0142  30       Item Structure
     C                     Z-ADD*ZERO     WN0143  30       Item Structure
     C                     Z-ADD*ZERO     WN0144  30       Item Structure
     C                     MOVEL*BLANK    WN0145  6        Primal Group Co
     C                     MOVEL*BLANK    WN0146  1        EDI Status 1
     C                     MOVEL*BLANK    WN0147  1        EDI Status 2
     C                     MOVEL*BLANK    WN0148  1        EDI Status 3
     C                     MOVEL*BLANK    WN0149  1        Record Status
     C                     Z-ADD*ZERO     WN0150  60       Job Time
     C                     MOVEL*BLANK    WN0151 10        User Id
     C                     MOVEL*BLANK    WN0152 10        Job Name
     C                     Z-ADD*ZERO     WN0153  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDI8AIC3    WBAIC3           Company Number
     C                     MOVELI8V5ST    WBV5ST    P      Production Type
     C                     Z-ADDI8ELDT    WBELDT           Production Date
     C                     Z-ADDI8HGCD    WBHGCD           Item Code
     C                     MOVELI8AJCD    WBAJCD    P      Warehouse Code
      *
     C           KLCHSO    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBV5ST           Production Type
     C                     KFLD           WBELDT           Production Date
     C                     KFLD           WBHGCD           Item Code
     C                     KFLD           WBAJCD           Warehouse Code
     C           KLCHSO    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YARDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADD$CBOWG    WBWTIN           PS Weight Inv O
     C                     Z-ADD$CSHWT    WBSHWT           PS Weight Sched
     C                     Z-ADDWN0055    WBAVWT           PS Weight Avail
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WBAATM           Job Time
     C                     MOVEL##USR     WBAYNA           User Id
     C                     MOVEL##JOB     WBA0NA           Job Name
     C                     Z-ADD##JDT     WBAXDT           Job Date
     C                     MOVEL##PGM     WBA0NA           Job Name
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P3SHWT           PS Weight Sched
     C                     Z-ADD*ZERO     P4AVWT           PS Weight Avail
     C                     Z-ADD*ZERO     P5AIWG           Unit Weight
     C                     Z-ADD*ZERO     P5CHTM           Fresh Chilling
     C                     MOVEL*BLANK    P5QZCD           Base/Conv/Loss
     C                     MOVEL*BLANK    P5VMST           Credit Item Sta
     C                     Z-ADD*ZERO     P6FVQT           USR Quantity Ac
     C                     Z-ADD*ZERO     P7JEDT           Date From
      *
      * Initialise indicators for re-entry
     C                     MOVE '0'       *IN
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    B0AIC3           Company Number
     C                     MOVEL*LOVAL    B0HGCD           Item Code
     C                     MOVEL*LOVAL    B0AJCD           Warehouse Code
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field U/M - Primary
     C                     MOVEL*BLANK    WUADCD  2
      * Define work field Item Structure Class Code
     C                     Z-ADD*ZERO     WURINB  30
      * Define work field Item Structure Group Code
     C                     Z-ADD*ZERO     WURHNB  30
      * Define work field Item Structure Type Code
     C                     Z-ADD*ZERO     WURGNB  30
      * Define work field Item Type Code
     C                     MOVEL*BLANK    WUN0CD  3
      * Define work field Default Warehouse
     C                     MOVEL*BLANK    WUQ1CD  3
      * Define work field Base/Conv/Loss Item
     C                     MOVEL*BLANK    WUQZCD  2
      * Define work field Variety/Rendered/Cut
     C                     MOVEL*BLANK    WUXWST  1
      * Define work field Credit Item Status
     C                     MOVEL*BLANK    WUVMST  1
      * Define work field Std Weight/Head (Var/Ren)
     C                     Z-ADD*ZERO     WUSWGH 112
      * Define work field Pieces Per Head
     C                     Z-ADD*ZERO     WUPPHE  70
      * Define work field Department Code
     C                     MOVEL*BLANK    WUR3CD  6
      * Define work field Group for Packaging
     C                     MOVEL*BLANK    WUSDCD  1
      * Define work field Seconds Item
     C                     MOVEL*BLANK    WUX5ST  1
      * Define work field Piece Count Item
     C                     MOVEL*BLANK    WUPCCT  1
      * Define work field Pieces Per Bag
     C                     Z-ADD*ZERO     WUBDNB  70
      * Define work field Bags Per Unit
     C                     Z-ADD*ZERO     WUBJNB  70
      * Define work field Export/Domestic
     C                     MOVEL*BLANK    WUSUST  1
      * Define work field Print On Schedule
     C                     MOVEL*BLANK    WUSVST  1
      * Define work field Fresh Inv Allocation Seq
     C                     MOVEL*BLANK    WUSYST  1
      * Define work field Fresh Sched As Ordered
     C                     MOVEL*BLANK    WUSZST  1
      * Define work field Frozen Inv Allocation Seq
     C                     MOVEL*BLANK    WUS1ST  1
      * Define work field Primal Group Code
     C                     MOVEL*BLANK    WUXRCD  6
      * Define work field Warehouse Type
     C                     MOVEL*BLANK    WUWPST  2
      * Define work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field Warehouse Location
     C                     MOVEL*BLANK    WUT0ST  1
      * Define work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    WUT1ST  1
      * Define work field Warehouse Chill Time
     C                     Z-ADD*ZERO     WUDBNB  52
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Define work field *Duration (factor)
     C                     Z-ADD*ZERO     WUDUF   80
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUCNTU  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WABCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WACQNB           Julian Date
     C                     Z-ADD*ZERO     WAESNB           Accounting Year
     C                     Z-ADD*ZERO     WAETNB           Accounting Peri
     C                     Z-ADD*ZERO     WABZNB           OM Week
     C                     Z-ADD*ZERO     WAEINB           Week Number
     C                     Z-ADD*ZERO     WAAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WAOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WANQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WANRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WAOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WAOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field On Hand U/M1 Summary
     C                     Z-ADD*ZERO     WUDDQT 112
      * Define work field Header Status
     C                     MOVEL*BLANK    WUGWST  1
      * Define work field Billing Activity Type
     C                     MOVEL*BLANK    WUOBST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBELDT           Production Date
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBGPDT           PS Available Sh
     C                     Z-ADD*ZERO     WBWTSP           PS Weight Plann
     C                     Z-ADD*ZERO     WBQTSP           PS Pieces Plann
     C                     Z-ADD*ZERO     WBDJPC           PS % of Carcass
     C                     Z-ADD*ZERO     WBF8WG           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WBWTIN           PS Weight Inv O
     C                     Z-ADD*ZERO     WBD5NB           PS Pieces Inv O
     C                     Z-ADD*ZERO     WBDXWG           PS Weight Stand
     C                     Z-ADD*ZERO     WBB2NB           PS Pieces Stand
     C                     Z-ADD*ZERO     WBWTCN           PS Weight Conve
     C                     Z-ADD*ZERO     WBPSCV           PS Pieces Conve
     C                     Z-ADD*ZERO     WBSAWT           PS Weight Shipp
     C                     Z-ADD*ZERO     WBB9NB           PS Pieces Shipp
     C                     Z-ADD*ZERO     WBD1WG           PS Weight Prod
     C                     Z-ADD*ZERO     WBCBNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WBEZWG           PS Weight Inv A
     C                     Z-ADD*ZERO     WBCCNB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WBE0WG           PS Weight Ship
     C                     Z-ADD*ZERO     WBD6NB           PS Pieces Ship
     C                     Z-ADD*ZERO     WBOAWT           PS Weight Prod
     C                     Z-ADD*ZERO     WBCDNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WBUNW2           PS Weight Inv A
     C                     Z-ADD*ZERO     WBCENB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WBF9WG           PS Unit Weight
     C                     Z-ADD*ZERO     WBBPNB           PS Pieces Whse
     C                     Z-ADD*ZERO     WBGAWG           PS Weight Whse
     C                     Z-ADD*ZERO     WBBQNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WBGBWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WBBRNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WBGCWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WBBSNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WBGDWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WBBWNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WBGEWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WBPS6U           PS Pieces Unuse
     C                     Z-ADD*ZERO     WBDVWG           PS Weight Order
     C                     Z-ADD*ZERO     WBD7NB           PS Pieces Order
     C                     Z-ADD*ZERO     WBFCAD           PS Weight FC Ad
     C                     Z-ADD*ZERO     WBD9NB           PS Pieces FC Ad
     C                     Z-ADD*ZERO     WBDWWG           PS Weight FX Ad
     C                     Z-ADD*ZERO     WBEANB           PS Pieces FX Ad
     C                     Z-ADD*ZERO     WBSHWT           PS Weight Sched
     C                     Z-ADD*ZERO     WBEBNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WBAVWT           PS Weight Avail
     C                     Z-ADD*ZERO     WBECNB           PS Pieces Avail
     C                     Z-ADD*ZERO     WBWTON           PS Weight Produ
     C                     Z-ADD*ZERO     WBEDNB           PS Pieces Produ
     C                     Z-ADD*ZERO     WBFNWT           PS Weight Fab N
     C                     Z-ADD*ZERO     WBEENB           PS Pieces Fab N
     C                     Z-ADD*ZERO     WBQTAS           PS Weight Sched
     C                     Z-ADD*ZERO     WBEFNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WBWAIO           PS Weight Sched
     C                     Z-ADD*ZERO     WBEGNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Unit Weight
     C                     Z-ADD*ZERO     WUAIWG 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WCBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WCBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WCBUC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WCBVC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003 30
     C                     MOVEL*BLANK    WL0004  2
     C                     Z-ADD*ZERO     WL0005 112
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  30
     C                     Z-ADD*ZERO     WL0008  30
     C                     MOVEL*BLANK    WL0009  3
     C                     MOVEL*BLANK    WL0010  3
     C                     Z-ADD*ZERO     WL0011  52
     C                     MOVEL*BLANK    WL0012  2
     C                     MOVEL*BLANK    WL0013  1
     C                     MOVEL*BLANK    WL0014  1
     C                     Z-ADD*ZERO     WL0015 112
     C                     Z-ADD*ZERO     WL0016  70
     C                     MOVEL*BLANK    WL0017  6
     C                     MOVEL*BLANK    WL0018  1
     C                     MOVEL*BLANK    WL0019  1
     C                     MOVEL*BLANK    WL0020  1
     C                     Z-ADD*ZERO     WL0021  70
     C                     Z-ADD*ZERO     WL0022  70
     C                     MOVEL*BLANK    WL0023  1
     C                     MOVEL*BLANK    WL0024  1
     C                     MOVEL*BLANK    WL0025  1
     C                     MOVEL*BLANK    WL0026  1
     C                     MOVEL*BLANK    WL0027  1
     C                     MOVEL*BLANK    WL0028  6
      * Define local variables for subroutine SDRVGN.
     C                     MOVEL*BLANK    WL0029  3
     C                     MOVEL*BLANK    WL0030  2
     C                     MOVEL*BLANK    WL0031  1
     C                     MOVEL*BLANK    WL0032  1
     C                     MOVEL*BLANK    WL0033  1
     C                     Z-ADD*ZERO     WL0034  52
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0035  30
     C                     Z-ADD*ZERO     WL0036  70
     C                     MOVEL*BLANK    WL0037  3
     C                     Z-ADD*ZERO     WL0038  70
     C                     Z-ADD*ZERO     WL0039 112
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0040  30
     C                     Z-ADD*ZERO     WL0041  70
     C                     Z-ADD*ZERO     WL0042  52
     C                     Z-ADD*ZERO     WL0043  70
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0001  30
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
      *================================================================
     CSR         ZZEXIT    ENDSR
