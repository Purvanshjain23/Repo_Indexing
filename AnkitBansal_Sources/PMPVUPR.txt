/***************************************************************** */
/*  SYSTEM:          DAILYS                                        */
/*  PROGRAM NUMBER:  PMPVUPR                                       */
/*  PROGRAM NAME:    WEEKLY, MONTHLY, QUARTERLY, YEARLY, ILYS COST */
/*                             REPORTS                             */
/*  PROGRAMMER:      PURVA DROGE                                   */
/*  CREATE DATE:     11/25/07                                      */
/*                                                                 */
/*  FUNCTION:                                                      */
/*    RETRIEVE PERIOD BEGIN AND END DATE                           */
/*    REPORTS                                                      */
/*    -----------------------------------------                    */
/*    PRE COOKED SUMMARIES                                         */
/*    SALES SUMMARY                                                */
/*    INTER PLANT SALES                                            */
/*    -----------------------------------------                    */
/*  MODIFIED:  07/28/08 SHARON ZURN                                */
/*             ADDED CALL  TO THE PRECOOKED SUMMARY QUERIES        */
/*             ADDED CALL  TO THE TONNAGE BY GROUP  QUERIES        */
/*                                                                 */
/*******************************************************************/
             PGM        PARM(&AIC3 &WMQY &PDEV)

             DCL        VAR(&AIC3)    TYPE(*DEC)  LEN(3)
             DCL        VAR(&WMQY)    TYPE(*CHAR) LEN(1)
             DCL        VAR(&RETURN)  TYPE(*CHAR) LEN(1)
             DCL        VAR(&FRSYNDT) TYPE(*DEC)  LEN(7)
             DCL        VAR(&TOSYNDT) TYPE(*DEC)  LEN(7)
             DCL        VAR(&PDEV) TYPE(*CHAR) LEN(10)
             DCL        VAR(&HOLD) TYPE(*CHAR) LEN(4) VALUE(*YES)
             DCL        VAR(&SAVE) TYPE(*CHAR) LEN(4) VALUE(*YES)
             DCL        VAR(&COPIES) TYPE(*DEC) LEN(2 0) VALUE(1)

             DCL        VAR(&MMDD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&YY) TYPE(*CHAR) LEN(2)
             DCL        VAR(&FRDTE) TYPE(*CHAR)  LEN(6)
             DCL        VAR(&TODTE) TYPE(*CHAR)  LEN(6)
             DCL        VAR(&WRKFDTE) TYPE(*CHAR)  LEN(7)
             DCL        VAR(&WRKTDTE) TYPE(*CHAR)  LEN(7)
             DCL        VAR(&CO) TYPE(*CHAR)  LEN(3)

             DCL        VAR(&COMP)    TYPE(*DEC)  LEN(15 5)
             DCL        VAR(&FDTE) TYPE(*DEC)  LEN(15 5)
             DCL        VAR(&TDTE) TYPE(*DEC)  LEN(15 5)
             DCL        VAR(&COPY) TYPE(*DEC)  LEN(15 5)
             DCL        VAR(&CUST) TYPE(*DEC)  LEN(15 5)

/*------------------------------------------------------------------*/
/* Pass in the Week/Month/Quarter/Year value to tell the Synon program */
/* which 'date range' you need. Also, pass in Company.                 */
/*------------------------------------------------------------------*/

             CHGVAR     VAR(&COMP) VALUE(&AIC3)
             CHGVAR     VAR(&COPY) VALUE(&COPIES)

             CALL       PGM(PMI2XFR) PARM(&RETURN &AIC3 &WMQY  +
                          &FRSYNDT &TOSYNDT)
             CHGVAR     VAR(&FDTE) VALUE(&FRSYNDT)
             CHGVAR     VAR(&TDTE) VALUE(&TOSYNDT)

/*------------------------------------------------------------------*/
/* SALES SUMMARY */
/*------------------------------------------------------------------*/

             CALL       PGM(PMPLUPC) PARM(&AIC3 &FRSYNDT &TOSYNDT +
                         &PDEV &HOLD &SAVE &COPIES)

             IF         COND(&PDEV *EQ 'MSOPRT04') THEN(DO)
             CHGSPLFA   FILE(PMPJPFR$) SPLNBR(*ANY) DRAWER(3)
             ENDDO
/*------------------------------------------------------------------*/
/* INTER PLANT SALES */
/*------------------------------------------------------------------*/
             IF         COND(&AIC3 *EQ 364) THEN(DO)
             CHGVAR     VAR(&CUST) VALUE(4000240.00000)
             ENDDO

             IF         COND(&AIC3 *EQ 363) THEN(DO)
             CHGVAR     VAR(&CUST) VALUE(4000242.00000)
             ENDDO

             CALL       PGM(PDLAPCLP) PARM('PDLAPFR' &COMP &FDTE +
                          &TDTE 0.00000 &PDEV &HOLD &SAVE &COPY +
                          'GUYNIGHTQ' 'S' 'A' '1' &CUST ' ' +
                          'A' 'N' ' ' ' ' ' ')

             IF         COND(&PDEV *EQ 'MSOPRT04') THEN(DO)
             CHGSPLFA   FILE(PDLAPFR$) SPLNBR(*ANY) DRAWER(3)
             ENDDO

/*------------------------------------------------------------------*/
    /*CALL PRE-COOKED LABOR/HOURS REPORTS*/
    /*PASS THE DATES IN AS MMDDYY                                    */
/*------------------------------------------------------------------*/
             CHGVAR     VAR(&WRKFDTE) VALUE(&FRSYNDT)
             CHGVAR     VAR(&WRKTDTE) VALUE(&TOSYNDT)
             CHGVAR     VAR(&MMDD) VALUE(%SST(&WRKFDTE 4 4))
             CHGVAR     VAR(&YY) VALUE(%SST(&WRKFDTE 2 2))
             CHGVAR     VAR(&FRDTE) VALUE(&MMDD *CAT &YY)
             CHGVAR     VAR(&MMDD) VALUE(%SST(&WRKTDTE 4 4))
             CHGVAR     VAR(&YY) VALUE(%SST(&WRKTDTE 2 2))
             CHGVAR     VAR(&TODTE) VALUE(&MMDD *CAT &YY)
             CHGVAR     VAR(&CO) VALUE(&AIC3)

             CALL       PGM(PMW5UPR) PARM(&FRDTE &TODTE &CO)
             MONMSG     MSGID(CPF0000)

/*------------------------------------------------------------------*/
    /*CALL TONNAGE BY GROUP REPORTS*/
    /*PASS THE DATES IN AS MMDDYY                                    */
/*------------------------------------------------------------------*/
/*MISSOULA TONNAGE BY GOURP  */
             CALL       PGM(PMW8UPR) PARM(&FRDTE &TODTE)
             MONMSG     MSGID(CPF0000)

/*SALT LAKE CITY                    */
             CALL       PGM(PMW9UPR) PARM(&FRDTE &TODTE)
             MONMSG     MSGID(CPF0000)

             ENDPGM

