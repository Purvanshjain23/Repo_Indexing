     H/TITLE PRT Bill of Lading-HPBYPF Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 08/06/19  Time  : 12:04:59
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOMFNCPL1IF  E           K        DISK
      * RTV : Manifest Detail           Retrieval index
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FCAAOREL0IF  E           K        DISK
      * RTV : Terms                     Retrieval index       NV
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FPMCAREL1IF  E           K        DISK
      * RTV : COA Property Define Hdr   Retrieval index
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FPDNIREL1IF  E           K        DISK
      * RTV : Company Customer EXT      Retrieval index
      *
     FCABZREL7IF  E           K        DISK
      * RSQ : Company Item              RSQ by Item only      NV
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FPMQBPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: PRT Bill of Lading-HPBYPF Print file
      *
     E                    #L7         7  1
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@FLCPBW
      * Load Detail               Retrieval index
      * Renamed input format fields
     I              FLRMNB                          WARMNB
     I              FLRUNB                          WARUNB
     I              FLRVNB                          WARVNB
     I              FLDQTX                          WADQTX
     I              FLRWNB                          WARWNB
     I              FLRXNB                          WARXNB
     I              FLSQNB                          WASQNB
     I              FLT0NB                          WAT0NB
     I              FLT1NB                          WAT1NB
     I              FLR1NB                          WAR1NB
     I              FLAIC3                          WAAIC3
     I              FLC4NB                          WAC4NB
     I              FLVCST                          WAVCST
     I              FLKEDT                          WAKEDT
     I              FLSXNB                          WASXNB
     I              FLKFDT                          WAKFDT
     I              FLACTM                          WAACTM
     I              FLK5TX                          WAK5TX
     I              FLW5CD                          WAW5CD
     I              FLEJDT                          WAEJDT
     I              FLAGTM                          WAAGTM
     I              FLKJDT                          WAKJDT
     I              FLATTM                          WAATTM
     I              FLHDDT                          WAHDDT
     I              FLAUTM                          WAAUTM
     I              FLKKDT                          WAKKDT
     I              FLAVTM                          WAAVTM
     I              FLZ4NB                          WAZ4NB
     I              FLY7ST                          WAY7ST
     I              FLY2ST                          WAY2ST
     I              FLWHTX                          WAWHTX
     I              FLWITX                          WAWITX
     I              FLWJTX                          WAWJTX
     I              FLWKTX                          WAWKTX
     I              FLWLTX                          WAWLTX
     I              FLN7DT                          WAN7DT
     I              FLN8DT                          WAN8DT
     I              FLN9DT                          WAN9DT
     I              FLB3TM                          WAB3TM
     I              FLB4TM                          WAB4TM
     I              FLB5TM                          WAB5TM
     I              FLIASX                          WAIASX
     I              FLIBSX                          WAIBSX
     I              FLICSX                          WAICSX
     I              FLWVTX                          WAWVTX
     I              FLWWTX                          WAWWTX
     I              FLWXTX                          WAWXTX
     I              FLUVST                          WAUVST
     I              FLUWST                          WAUWST
     I              FLUXST                          WAUXST
     I              FLAATM                          WAAATM
     I              FLAYNA                          WAAYNA
     I              FLA0NA                          WAA0NA
     I              FLAXDT                          WAAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WBAIC3
     I              OMC4NB                          WBC4NB
     I              OMDPNB                          WBDPNB
     I              OMUENB                          WBUENB
     I              OMHGCD                          WBHGCD
     I              OMAJCD                          WBAJCD
     I              OMBKC7                          WBBKC7
     I              OMCFC7                          WBCFC7
     I              OMGMST                          WBGMST
     I              OMGNST                          WBGNST
     I              OMMAVA                          WBMAVA
     I              OMKDVA                          WBKDVA
     I              OML8VA                          WBL8VA
     I              OML9VA                          WBL9VA
     I              OMGTST                          WBGTST
     I              OMGVST                          WBGVST
     I              OMGUST                          WBGUST
     I              OMQFST                          WBQFST
     I              OMAYVA                          WBAYVA
     I              OMEXDT                          WBEXDT
     I              OMLQCD                          WBLQCD
     I              OMRDCD                          WBRDCD
     I              OMQ7CD                          WBQ7CD
     I              OMBZPR                          WBBZPR
     I              OML6NB                          WBL6NB
     I              OMU1ST                          WBU1ST
     I              OMGIDT                          WBGIDT
     I              OMCRCD                          WBCRCD
     I              OMAGCD                          WBAGCD
     I              OMRZST                          WBRZST
     I              OMR0ST                          WBR0ST
     I              OMR1ST                          WBR1ST
     I              OMG7NA                          WBG7NA
     I              OMG8NA                          WBG8NA
     I              OMRPCD                          WBRPCD
     I              OMVEST                          WBVEST
     I              OMVGST                          WBVGST
     I              OMAVST                          WBAVST
     I              OMU0ST                          WBU0ST
     I              OMRFCD                          WBRFCD
     I              OMFZST                          WBFZST
     I              OMR1NB                          WBR1NB
     I              OMAVQT                          WBAVQT
     I              OMD0WG                          WBD0WG
     I              OMCCQT                          WBCCQT
     I              OMAUWG                          WBAUWG
     I              OMCBQT                          WBCBQT
     I              OMATWG                          WBATWG
     I              OMAQCS                          WBAQCS
     I              OMAGCS                          WBAGCS
     I              OMAKPR                          WBAKPR
     I              OMALPR                          WBALPR
     I              OMAUPR                          WBAUPR
     I              OMAVWG                          WBAVWG
     I              OMA4WG                          WBA4WG
     I              OMA5DT                          WBA5DT
     I              OMAODT                          WBAODT
     I              OMGNDT                          WBGNDT
     I              OMAMST                          WBAMST
     I              OMANST                          WBANST
     I              OMVAST                          WBVAST
     I              OMRGNB                          WBRGNB
     I              OMRHNB                          WBRHNB
     I              OMRINB                          WBRINB
     I              OMRBCD                          WBRBCD
     I              OMHICD                          WBHICD
     I              OMRNCD                          WBRNCD
     I              OMROCD                          WBROCD
     I              OMCXDT                          WBCXDT
     I              OMAJVN                          WBAJVN
     I              OMKXCD                          WBKXCD
     I              OMJPCD                          WBJPCD
     I              OMCQCD                          WBCQCD
     I              OMR4CD                          WBR4CD
     I              OMZ1ST                          WBZ1ST
     I              OMZ3ST                          WBZ3ST
     I              OMZ4ST                          WBZ4ST
     I              OMDUPR                          WBDUPR
     I              OMB6VL                          WBB6VL
     I              OMA1AA                          WBA1AA
     I              OMFZSX                          WBFZSX
     I              OMF0SX                          WBF0SX
     I              OMF1SX                          WBF1SX
     I              OMF2SX                          WBF2SX
     I              OMF3SX                          WBF3SX
     I              OMF4SX                          WBF4SX
     I              OMF5SX                          WBF5SX
     I              OMF6SX                          WBF6SX
     I              OMF7SX                          WBF7SX
     I              OMNTDT                          WBNTDT
     I              OMNUDT                          WBNUDT
     I              OMNVDT                          WBNVDT
     I              OMNWDT                          WBNWDT
     I              OMNXDT                          WBNXDT
     I              OMBUTM                          WBBUTM
     I              OMBVTM                          WBBVTM
     I              OMBWTM                          WBBWTM
     I              OMBXTM                          WBBXTM
     I              OMBYTM                          WBBYTM
     I              OMH5NX                          WBH5NX
     I              OMH6NX                          WBH6NX
     I              OMH7NX                          WBH7NX
     I              OMH8NX                          WBH8NX
     I              OMH9NX                          WBH9NX
     I              OMDVPR                          WBDVPR
     I              OMDWPR                          WBDWPR
     I              OMDXPR                          WBDXPR
     I              OMDYPR                          WBDYPR
     I              OMDZPR                          WBDZPR
     I              OMGSPR                          WBGSPR
     I              OMGTPR                          WBGTPR
     I              OMGUPR                          WBGUPR
     I              OMHOST                          WBHOST
     I              OMHPST                          WBHPST
     I              OMIOST                          WBIOST
     I              OMPEWG                          WBPEWG
     I              OMRINY                          WBRINY
     I              OMTIDT                          WBTIDT
     I              OMTJDT                          WBTJDT
     I              OMH2ST                          WBH2ST
     I              OMH0ST                          WBH0ST
     I              OMH1ST                          WBH1ST
     I              OMTKDT                          WBTKDT
     I              OMTLDT                          WBTLDT
     I              OMTMDT                          WBTMDT
     I              OMUVST                          WBUVST
     I              OMUWST                          WBUWST
     I              OMUXST                          WBUXST
     I              OMAATM                          WBAATM
     I              OMAYNA                          WBAYNA
     I              OMA0NA                          WBA0NA
     I              OMAXDT                          WBAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS                              7
      * KEY: Load Detail               Retrieval index
      * I : RST Load ID
     I                                    P   1   40P1RMNB
     IP2PARM      DS
      * I :  Company Number
     I                                    P   1   20P2AIC3
     IP3PARM      DS
      * I :  Export Status
     I                                        1   1 P3U2ST
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           KEY: Load Detai
     C           P2AIC3    PARM           WP0001  30       Company Number
     C           P3U2ST    PARM           WP0002  1        Export Status
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PRT Bill of Lading-HPBYPF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$EENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * PRT Bill of Lading-HPBYPF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQKA01           Load ID
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQKA01           Load ID
      * Establish starting position
     C           KRSA      SETLL@FLCPBW                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Load ID
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADD*ZERO     $BBQDT           USR Date - ATR
     C                     MOVEL*BLANK    $BDXTX           Trailer Id
     C                     Z-ADD*ZERO     $BBKC7           Ship To Custome
     C                     Z-ADDWAC4NB    $BC4NB           Order Number
     C                     MOVEL*BLANK    $BBCNA           Customer Purcha
     C                     MOVEL*BLANK    $BAUNA           Description
     C                     Z-ADDWARMNB    $BRMNB           Load ID
     C                     MOVEL*BLANK    $BKGTX           @Blank for 5
     C                     MOVEL*BLANK    $BADTX           Name
     C                     MOVEL*BLANK    $BO7TX           @Text 8
     C                     MOVEL*BLANK    $BGNNA           USR Compressed
     C                     MOVEL*BLANK    $BGONA           USR Compressed
     C                     MOVEL*BLANK    $BHLTX           Condition Desc.
     C                     MOVEL*BLANK    $BL2T1           COA Producer Re
     C                     MOVEL*BLANK    $BNLTX           USR 15 Text
     C                     MOVEL*BLANK    $BL3T1           COA Employer ID
     C                     MOVEL*BLANK    $BD3T1           Text 35 USR
     C                     MOVEL*BLANK    $BL6T1           COA ULSD Compan
     C                     MOVEL*BLANK    $BL7T1           COA ULSD Facili
     C                     MOVEL*BLANK    $BKNTX           @Blank for 6
     C                     MOVEL*BLANK    $BGPNA           USR Compressed
     C                     MOVEL*BLANK    $BYPTX           Generic Heading
     C                     MOVEL*BLANK    $BAETX           Bill to Name
     C                     MOVEL*BLANK    $BYYTX           Generic Heading
     C                     MOVEL*BLANK    $BBRTX           Ship To Name
     C                     MOVEL*BLANK    $BM5TX           Generic Heading
     C                     MOVEL*BLANK    $BB1NA           Bill to Address
     C                     MOVEL*BLANK    $BM6TX           Generic Heading
     C                     MOVEL*BLANK    $BHMNA           Ship To Address
     C                     MOVEL*BLANK    $BB3NA           Bill to Address
     C                     MOVEL*BLANK    $BHONA           Ship To Address
     C                     MOVEL*BLANK    $BB4NA           Bill to Address
     C                     MOVEL*BLANK    $BHPNA           Ship To Address
     C                     MOVEL*BLANK    $BDMT1           Fax Area Code #
     C                     MOVEL*BLANK    $BMZT1           Employer ID bil
     C                     MOVEL*BLANK    $BM3T1           Employer ID bil
     C                     MOVEL*BLANK    $BM0T1           Employer ID shi
     C                     MOVEL*BLANK    $BM4T1           Employer ID shi
     C                     MOVEL*BLANK    $BM1T1           ULSD Comp bill
     C                     MOVEL*BLANK    $BM5T1           ULSD Comp bill
     C                     MOVEL*BLANK    $BM7T1           ULSD Facility b
     C                     MOVEL*BLANK    $BM2T1           ULSD Comp ship
     C                     MOVEL*BLANK    $BM6T1           ULSD Comp ship
     C                     MOVEL*BLANK    $BM8T1           ULSD Facility s
     C                     MOVEL*BLANK    $BBVTX           Telephone Numbe
     C                     MOVEL*BLANK    $BDQT1           Fax Area Code #
     C                     MOVEL*BLANK    $BEWT1           CDD Sender Phon
      * USER: Process before print of detail format
      * Load header line and get data for other fields
      * CASE: *OTHERWISE
      * RTV Trailer Number     RT - Load Header  * 
     C                     EXSR SERVGN
      * RTV All Fields         RT - Order Header TRG  * 
     C                     EXSR SFRVGN
      * RTV Desc, status       RT - Terms  * 
     C                     EXSR SGRVGN
      * RTV HPB fields         RT - Order Header Extension  * 
     C                     EXSR SHRVGN
      * RTV Co infor w/o FuelCdRT - COA Property Define Hdr  * 
     C                     EXSR SIRVGN
      * Load producer address and other details
      * CASE: *OTHERWISE
     C                     MOVELYL0028    $BADTX           Name
     C                     MOVEL@CN,001   $BKNTX           @Blank for 6
      * RTV Co Addr & Phone FaxRT - Company Name and Address  * 
     C                     EXSR SJRVGN
     C                     Z-ADD1         ZQ      50
     C           YL0047    CAT  YL0051:ZQ YL0052    P      USR Compressed
     C                     Z-ADD1         ZQ      50
     C           YL0052    CAT  YL0048:ZQ $BGONA    P      USR Compressed
     C                     MOVEL*BLANK    $BGPNA           USR Compressed
     C                     MOVELYL0049    $BGPNA           USR Compressed
      * Load Bill-to and Ship-to addresses
      * CASE: *OTHERWISE
     C                     MOVELYL0016    $BAETX           Bill to Name
     C                     MOVELYL0017    $BB1NA           Bill to Address
      * Squash out blank line if address line 2 is blank
      * CASE: LCL.Bill to Address Line 2 is Blank
     C           YL0018    IFEQ *BLANK                     *IF
     C                     Z-ADD1         ZQ      50
     C           YL0020    CAT  YL0021:ZQ YL0018    P      Bill to Address
     C                     Z-ADD1         ZQ      50
     C           YL0018    CAT  YL0022:ZQ $BB3NA    P      Bill to Address
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELYL0018    $BB3NA           Bill to Address
     C                     Z-ADD1         ZQ      50
     C           YL0020    CAT  YL0021:ZQ YL0019    P      Bill to Address
     C                     Z-ADD1         ZQ      50
     C           YL0019    CAT  YL0022:ZQ $BB4NA    P      Bill to Address
     C                     END                             *FI
     C                     MOVELYL0008    $BBRTX           Ship To Name
     C                     MOVELYL0009    $BHMNA           Ship To Address
      * Squash out blank line if address line 2 is blank
      * CASE: LCL.Ship To Address Line 2 is Blank
     C           YL0010    IFEQ *BLANK                     *IF
     C                     Z-ADD1         ZQ      50
     C           YL0012    CAT  YL0013:ZQ YL0010    P      Ship To Address
     C                     Z-ADD1         ZQ      50
     C           YL0010    CAT  YL0014:ZQ $BHONA    P      Ship To Address
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELYL0010    $BHONA           Ship To Address
     C                     Z-ADD1         ZQ      50
     C           YL0012    CAT  YL0013:ZQ YL0011    P      Ship To Address
     C                     Z-ADD1         ZQ      50
     C           YL0011    CAT  YL0014:ZQ $BHPNA    P      Ship To Address
     C                     END                             *FI
      * RTV Customer A/R Cust  RT - Customer  * 
     C                     EXSR SKRVGN
      * Rtv HPB Cust Fields   RT - Comp Cust Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADDYL0053    WL0002           Ship To Custome
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0054    P      HPB Employer ID
     C                     MOVELWL0004    YL0055    P      HPB ULSD Compan
     C                     MOVELWL0005    YL0056    P      HPB ULSD Facili
      * Rtv HPB Cust Fields   RT - Comp Cust Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     Z-ADD$BBKC7    WL0002           Ship To Custome
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0003    YL0054    P      HPB Employer ID
     C                     MOVELWL0004    YL0055    P      HPB ULSD Compan
     C                     MOVELWL0005    YL0056    P      HPB ULSD Facili
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : PRT HPB BOL Byproduct PO
     C                     EXSR UASUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WARMNB    WZA001           Load ID
     C                     Z-ADDWARMNB    WZA001
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@FLCPBW                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Load ID
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Load ID
     C                     ELSE
      * Next record - Detect level breaks
     C           WARMNB    IFNE WZA001                     Load ID
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * PRT HPB BOL Byproduct PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN FNAIC3    WQKB01           Company Number
     C           *LIKE     DEFN FNC4NB    WQKB02           Order Number
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           Company Number
     C                     KFLD           WQKB02           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WQKB01           Company Number
     C                     Z-ADD$BC4NB    WQKB02           Order Number
      * Establish starting position
     C           KRSB      SETLL@FNCPCT                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Order Number
     C                     MOVEL'Y'       W0BL02  1        Order Sequence
     C                     MOVEL'Y'       W0BL03  1        Order Secondary
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $DGMPC           COA BOL Percent
     C                     MOVEL*BLANK    $DPFTX           Text 1 Length U
     C                     MOVEL*BLANK    $DY0TX           Generic Heading
     C                     Z-ADD*ZERO     $DJJNY           Page Nbr - of (
     C                     MOVEL*BLANK    $DHKT1           Text 2
     C                     Z-ADD*ZERO     $DJKNY           Page Nbr - Tota
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP03  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDFNAIC3    $CAIC3           Company Number
     C                     Z-ADDFNC4NB    $CC4NB           Order Number
     C                     Z-ADDFNDPNB    $CDPNB           Order Sequence
     C                     Z-ADDFNUENB    $CUENB           Order Secondary
     C                     Z-ADDFNHGCD    $CHGCD           Item Code
     C                     Z-ADDFNN6WG    $CN6WG           HPB Meter Net G
     C                     MOVEL*BLANK    $CIDAA           COA Bio-diesel
     C                     MOVEL*BLANK    $CR2NA           COA Bio-dsl Fue
     C                     Z-ADDFNFOQT    $CFOQT           Case Quantity
     C                     Z-ADDFNR0NB    $CR0NB           Case Weight
     C                     Z-ADDFNITNY    $CITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     $CJENY           COA Temperature
     C                     Z-ADDFNIYNY    $CIYNY           HPB Density Ref
     C                     Z-ADDFNIUNY    $CIUNY           HPB Meter Endin
     C                     Z-ADDFNIWNY    $CIWNY           HPB Meter Total
     C                     Z-ADDFNIXNY    $CIXNY           HPB Meter Net W
      * USER: Process before print of detail format
      * CASE: LCL.USR Count is eq 12
     C           YL0058    IFEQ 12                         *IF
      * User Source to print Order total and New detail page
      * PRT HPB BOL NP & Hds   US - Load Detail  * 
     C                     MOVE 'Y'       W0BL01
     C                     EXSR B4PTOT
     C                     MOVE 'Y'       W0NEWP
     C                     MOVE 'Y'       W0APDT
     C                     Z-ADD*ZERO     YL0058           USR Count
     C                     ADD  1         YL0059           Page Nbr - of (
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN FNAIC3    WZB001           Company Number
     C                     Z-ADDFNAIC3    WZB001
     C           *LIKE     DEFN FNC4NB    WZB002           Order Number
     C                     Z-ADDFNC4NB    WZB002
     C           *LIKE     DEFN FNDPNB    WZB003           Order Sequence
     C                     Z-ADDFNDPNB    WZB003
     C           *LIKE     DEFN FNUENB    WZB004           Order Secondary
     C                     Z-ADDFNUENB    WZB004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@FNCPCT                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        Company Number
     C                     MOVEL*BLANK    W0BL01  1        Order Number
     C                     MOVEL*BLANK    W0BL02  1        Order Sequence
     C                     MOVEL*BLANK    W0BL03  1        Order Secondary
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Order Number
     C                     MOVEL'Y'       W0BL02  1        Order Sequence
     C                     MOVEL'Y'       W0BL03  1        Order Secondary
     C                     ELSE
      * Next record - Detect level breaks
     C           FNAIC3    IFNE WZB001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           FNC4NB    IFNE WZB002                     Order Number
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           FNDPNB    IFNE WZB003                     Order Sequence
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C           FNUENB    IFNE WZB004                     Order Secondary
     C           W0BL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL03
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP03
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * USER: Process before print of Order Number format
      * TPA Before print
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Order Number format
     C                     MOVEL'%'       $DPFTX           Text 1 Length U
     C                     ADD  1         YL0062           USR Counter
     C                     MOVEL'Page:'   $DY0TX           Generic Heading
     C           1         ADD  YL0057    $DJJNY           Page Nbr - of (
     C                     Z-ADD$DJJNY    YL0057           Page Nbr - of (
     C                     MOVEL'of'      $DHKT1           Text 2
     C                     Z-ADDYL0001    $DJKNY           Page Nbr - Tota
     C           W0PFM     IFEQ 'Y'
      * If we are already passed the nominated
      * Start line for this format
     C           @$CLN     IFGE 82
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$DKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of PRT Bill of Lading-HPBYPF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of PRT Bill of Lading-HPBYPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Load ID of PRT Bill of Lading-HPBYPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print Detail line. of PRT Bill of Lading-HPBYPF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
      * Convert fields to external form
      * Convert USR Date - ATR to display format
      * Convert date
     C           1000000   ADD  $BBQDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBBQDT
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $BBKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$BBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VBBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBBKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $BC4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$BC4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VBC4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBC4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$BCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$BDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of PRT HPB BOL Byproduct PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print Company Number of PRT HPB BOL Byproduct PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print Order Number of PRT HPB BOL Byproduct PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print Order Sequence Number of PRT HPB BOL Byproduct PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print Order Secondary Line Seq of PRT HPB BOL Byproduct PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP03
     C                     END                             FI
      * Print Detail line. of PRT HPB BOL Byproduct PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     ADD  1         YL0058           USR Count
      * Rtv Item Description   RT - Company Item  * 
     C                     EXSR SMRVGN
      * PRINT QTY IF UM Base Price A QTY -> GALLONS
      * RTV Unit Price ORD UM RT - Order Detail  * 
     C                     EXSR SNRVGN
      * CASE: LCL.U/M - Base Price is Gallon
     C           YL0060    IFEQ 'GL'                       *IF
     C                     Z-ADD$CFOQT    $CR0NB           Case Weight
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $CHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$CHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VCHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VCHGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$CCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$CDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     MOVEL*BLANK    W0SKP   1
      * Cascade skip to new page requests upwards
     C           W0APDT    IFEQ 'Y'
     C                     MOVEL'Y'       W0SKP
     C                     END
      * Request new page if required
     C           W0SKP     IFEQ 'Y'                        IF
     C                     MOVE 'Y'       W0NEWP
     C                     END                             FI
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of PRT Bill of Lading-HPBYPF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Load ID of PRT Bill of Lading-HPBYPF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Bill of Lading-HPBYPF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD31        W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT HPB BOL Byproduct PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT HPB BOL Byproduct PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Number of PRT HPB BOL Byproduct PO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Sequence Number of PRT HPB BOL Byproduct PO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Order Secondary Line Seq of PRT HPB BOL Byproduct PO
     C           W0BP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT HPB BOL Byproduct PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV calc BOL pages-BY  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         YL0003           USR Counter
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSA02           Load ID
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA02           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSA02           Load ID
      * Establish starting position
     C           KRSSA     SETLL@FLCPKF                    *
     C           KRSSA     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         YL0003           USR Counter
      * Drill down to the Manifest detail to see if there will be overflo
      * RTV calc pages for BOL RT - Order Header TRG  * 
     C                     EXSR SBRVGN
     C                     ADD  YL0004    YL0003           USR Counter
     C           KRSSA     READE@FLCPKF                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     Z-ADDYL0003    YL0001           Page Nbr - Tota
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV calc pages for BOL RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         YL0004           Page Overflow
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDFLAIC3    BEAIC3           Company Number
     C                     Z-ADDFLC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSB     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV calc pages for BOL RT - Order Detail  * 
     C                     EXSR SCRVGN
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV calc pages for BOL RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSC01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSC02           Order Number
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
      * Setup key
     C                     Z-ADDBEAIC3    WQSC01           Company Number
     C                     Z-ADDBEC4NB    WQSC02           Order Number
      * Establish starting position
     C           KRSSC     SETLL@BGWKL1                    *
     C           KRSSC     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV calc pages for BOL RT - Manifest Detail  * 
     C                     EXSR SDRVGN
     C           KRSSC     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV calc pages for BOL RT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Declare restrictor key work fields
     C           *LIKE     DEFN FNAIC3    WQSD01           Company Number
     C           *LIKE     DEFN FNC4NB    WQSD02           Order Number
     C           *LIKE     DEFN FNDPNB    WQSD03           Order Sequence
     C           *LIKE     DEFN FNUENB    WQSD04           Order Secondary
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Order Number
     C                     KFLD           WQSD03           Order Sequence
     C                     KFLD           WQSD04           Order Secondary
      * Setup key
     C                     Z-ADDOMAIC3    WQSD01           Company Number
     C                     Z-ADDOMC4NB    WQSD02           Order Number
     C                     Z-ADDOMDPNB    WQSD03           Order Sequence
     C                     Z-ADDOMUENB    WQSD04           Order Secondary
      * Establish starting position
     C           KRSSD     SETLL@FNCPCT                    *
     C           KRSSD     READE@FNCPCT                  90*
      * Data record not found
     C   90                MOVEL'USR1196' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         YL0005           USR Count
     C                     ADD  1         YL0002           Manifest Dtl Re
     C           KRSSD     READE@FNCPCT                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: LCL.USR Count GT PAR.ED Nbr of prods on 1st pg
     C           YL0005    IFGT 11                         *IF
     C           YL0005    DIV  11        YL0006           USR Page Number
     C                     MVR            YL0007           Remaining Bal 8
      * CASE: LCL.Remaining Bal 8.2 USR is Zero
     C           YL0007    IFEQ 0                          *IF
     C           YL0006    SUB  1         YL0004           Page Overflow
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0006    YL0004           Page Overflow
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Trailer Number     RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWARMNB    FJRMNB           Load ID
      * Establish starting position
     C           KRSSE     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFJDXTX    $BDXTX           Trailer Id
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV All Fields         RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    BEAIC3           Company Number
     C                     Z-ADDWAC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSF     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     $BBKC7           Ship To Custome
     C                     MOVEL*BLANK    YL0008           Ship To Name
     C                     MOVEL*BLANK    YL0009           Ship To Address
     C                     MOVEL*BLANK    YL0010           Ship To Address
     C                     MOVEL*BLANK    YL0011           Ship To Address
     C                     MOVEL*BLANK    YL0012           Ship To City
     C                     MOVEL*BLANK    YL0013           Ship To State C
     C                     MOVEL*BLANK    YL0014           Ship To Zip/Pos
     C                     Z-ADD*ZERO     YL0015           Bill to Custome
     C                     MOVEL*BLANK    YL0016           Bill to Name
     C                     MOVEL*BLANK    YL0017           Bill to Address
     C                     MOVEL*BLANK    YL0018           Bill to Address
     C                     MOVEL*BLANK    YL0019           Bill to Address
     C                     MOVEL*BLANK    YL0020           Bill to City
     C                     MOVEL*BLANK    YL0021           Bill to State C
     C                     MOVEL*BLANK    YL0022           Bill to Zip/Pos
     C                     MOVEL*BLANK    $BBCNA           Customer Purcha
     C                     Z-ADD*ZERO     $BBQDT           Actual Shipped
     C                     MOVEL*BLANK    YL0023           Terms Code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBEBKC7    $BBKC7           Ship To Custome
     C                     MOVELBEBRTX    YL0008           Ship To Name
     C                     MOVELBEHMNA    YL0009           Ship To Address
     C                     MOVELBEHONA    YL0010           Ship To Address
     C                     MOVELBEHPNA    YL0011           Ship To Address
     C                     MOVELBEHNNA    YL0012           Ship To City
     C                     MOVELBEDBCD    YL0013           Ship To State C
     C                     MOVELBECKTX    YL0014           Ship To Zip/Pos
     C                     Z-ADDBEB0C7    YL0015           Bill to Custome
     C                     MOVELBEAETX    YL0016           Bill to Name
     C                     MOVELBEB1NA    YL0017           Bill to Address
     C                     MOVELBEB3NA    YL0018           Bill to Address
     C                     MOVELBEB4NA    YL0019           Bill to Address
     C                     MOVELBEB2NA    YL0020           Bill to City
     C                     MOVELBEBHCD    YL0021           Bill to State C
     C                     MOVELBEC8TX    YL0022           Bill to Zip/Pos
     C                     MOVELBEBCNA    $BBCNA           Customer Purcha
     C                     Z-ADDBEGNDT    $BBQDT           Actual Shipped
     C                     MOVELBEAQCD    YL0023           Terms Code
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Desc, status       RT - Terms  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           AOAIC3           Company Number
     C                     KFLD           AOAQCD           Terms Code
      * Setup key
     C                     Z-ADDWAAIC3    AOAIC3           Company Number
     C                     MOVELYL0023    AOAQCD           Terms Code
      * Establish starting position
     C           KRSSG     CHAIN@AOREB3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0037' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $BAUNA           Description
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAOAUNA    $BAUNA           Description
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV HPB fields         RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    AMAIC3           Company Number
     C                     Z-ADDWAC4NB    AMC4NB           Order Number
      * Establish starting position
     C           KRSSH     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0024           HPB COA Batch N
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAMITNY    YL0024           HPB COA Batch N
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Co infor w/o FuelCdRT - COA Property Define Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0025           COA Bio-dsl Fue
     C                     MOVEL*BLANK    YL0026           COA Producer Re
     C                     MOVEL*BLANK    YL0027           COA Employer ID
     C                     MOVEL*BLANK    YL0028           COA Sold From N
     C                     MOVEL*BLANK    YL0029           COA ULSD Compan
     C                     MOVEL*BLANK    YL0030           COA ULSD Facili
     C                     MOVEL*BLANK    YL0031           COA RIN Equival
     C                     MOVEL*BLANK    YL0032           COA RIN Renewab
     C                     MOVEL*BLANK    YL0033           COA RIN Type Fl
     C                     Z-ADD*ZERO     YL0034           COA Density Loa
     C                     Z-ADD*ZERO     YL0035           COA Density Ref
     C                     Z-ADD*ZERO     YL0036           COA Temperature
     C                     Z-ADD*ZERO     YL0037           COA Temperature
     C                     Z-ADD*ZERO     YL0038           COA BOL Percent
     C                     Z-ADD*ZERO     YL0039           COA Temp Conv F
     C                     MOVEL*BLANK    YL0040           Operation Facto
     C                     Z-ADD*ZERO     YL0041           COA Temp Conv F
     C                     MOVEL*BLANK    YL0042           Operation Facto
     C                     MOVEL*BLANK    YL0043           COA RFS Renew F
     C                     MOVEL*BLANK    YL0044           COA RFS Rnwbl F
      * Declare restrictor key work fields
     C           *LIKE     DEFN CAAIC3    WQSI01           Company Number
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
      * Setup key
     C                     Z-ADDWAAIC3    WQSI01           Company Number
      * Establish starting position
     C           KRSSI     SETLL@CAREOB                    *
     C           KRSSI     READE@CAREOB                  90*
      * Data record not found
     C   90                MOVEL'USR3799' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * get 1st rcd with matching input company
      * PAR = DB1 By name
     C                     MOVELCAR2NA    YL0025           COA Bio-dsl Fue
     C                     MOVELCAL2T1    YL0026           COA Producer Re
     C                     MOVELCAL3T1    YL0027           COA Employer ID
     C                     MOVELCAL5T1    YL0028           COA Sold From N
     C                     MOVELCAL6T1    YL0029           COA ULSD Compan
     C                     MOVELCAL7T1    YL0030           COA ULSD Facili
     C                     MOVELCAL8T1    YL0031           COA RIN Equival
     C                     MOVELCAL9T1    YL0032           COA RIN Renewab
     C                     MOVELCAMAT1    YL0033           COA RIN Type Fl
     C                     Z-ADDCAJCNY    YL0034           COA Density Loa
     C                     Z-ADDCAJDNY    YL0035           COA Density Ref
     C                     Z-ADDCAJENY    YL0036           COA Temperature
     C                     Z-ADDCAJFNY    YL0037           COA Temperature
     C                     Z-ADDCAGMPC    YL0038           COA BOL Percent
     C                     Z-ADDCAJQNY    YL0039           COA Temp Conv F
     C                     MOVELCALXST    YL0040           Operation Facto
     C                     Z-ADDCAJRNY    YL0041           COA Temp Conv F
     C                     MOVELCALYST    YL0042           Operation Facto
     C                     MOVELCAIMTX    YL0043           COA RFS Renew F
     C                     MOVELCAFEDS    YL0044           COA RFS Rnwbl F
     C                     GOTO SIEXIT                     *QUIT
     C           KRSSI     READE@CAREOB                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Co Addr & Phone FaxRT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADDWAAIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSJ     CHAIN@ABREG3              90    *
      * Data record not found
     C   90                MOVEL'USR0003' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABACNA    $BGNNA           Address Line 1
     C                     MOVELABADNA    YL0045           Address Line 2
     C                     MOVELABAENA    YL0046           Address Line 3
     C                     MOVELABAJNA    YL0047           City
     C                     MOVELABBTTX    YL0048           Zip/Postal Code
     C                     MOVELABBVTX    YL0049           Telephone Numbe
     C                     MOVELABBWTX    YL0050           Fax Number FF
     C                     MOVELABBGCD    YL0051           State Code
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Customer A/R Cust  RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD$BBKC7    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSK     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBBANC7    YL0053           A/R Customer Nu
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv HPB Cust Fields   RT - Comp Cust Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           NIAIC3           Company Number
     C                     KFLD           NIBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0001    NIAIC3           Company Number
     C                     Z-ADDWL0002    NIBKC7           Ship To Custome
      * Establish starting position
     C           KRSSL     CHAIN@NIREBO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2904' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0003           HPB Employer ID
     C                     MOVEL*BLANK    WL0004           HPB ULSD Compan
     C                     MOVEL*BLANK    WL0005           HPB ULSD Facili
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELNINCT1    WL0003           HPB Employer ID
     C                     MOVELNIM9T1    WL0004           HPB ULSD Compan
     C                     MOVELNINAT1    WL0005           HPB ULSD Facili
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Item Description   RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BZHGCD    WQSM01           Item Code
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Item Code
      * Setup key
     C                     Z-ADDFNHGCD    WQSM01           Item Code
      * Establish starting position
     C           KRSSM     SETLL@BZRED0                    *
     C           KRSSM     READE@BZRED0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $CR2NA           Description Lin
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAVNA    $CR2NA           Description Lin
     C           KRSSM     READE@BZRED0                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Unit Price ORD UM RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSN01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSN02           Order Number
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           Order Number
      * Setup key
     C                     Z-ADD$CAIC3    WQSN01           Company Number
     C                     Z-ADD$CC4NB    WQSN02           Order Number
      * Establish starting position
     C           KRSSN     SETLL@BGWKAE                    *
     C           KRSSN     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBCRCD    YL0060           U/M - Base Pric
     C                     MOVELWBAGCD    YL0061           U/M - Ordered
     C           KRSSN     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT HPB BOL Byproduct PO
      *================================================================
      * PRT HPB BOL Byproduct PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WARUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WARVNB           Stop/Drop
     C                     Z-ADD*ZERO     WARWNB           Miles to next s
     C                     Z-ADD*ZERO     WARXNB           Freight Charge
     C                     Z-ADD*ZERO     WASQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WAT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WAT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WASXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WAKFDT           Appointment Con
     C                     Z-ADD*ZERO     WAACTM           Appointment Con
     C                     Z-ADD*ZERO     WAEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WAAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WAKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WAATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WAHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WAAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WAKKDT           On Yard Date
     C                     Z-ADD*ZERO     WAAVTM           On Yard Time
     C                     Z-ADD*ZERO     WAZ4NB           MPC Number
     C                     Z-ADD*ZERO     WAN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WAN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WAN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WAB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WAB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WAB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WARMNB           Load ID
     C                     MOVEL*LOVAL    WARUNB           Stop/Drop Seque
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    FNAIC3           Company Number
     C                     MOVEL*LOVAL    FNC4NB           Order Number
     C                     MOVEL*LOVAL    FNDPNB           Order Sequence
     C                     MOVEL*LOVAL    FNUENB           Order Secondary
     C                     MOVEL*LOVAL    FNRZNB           Case Sequence N
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WBMAVA           Billing Detail
     C                     Z-ADD*ZERO     WBKDVA           Billing Detail
     C                     Z-ADD*ZERO     WBL8VA           Billing Detail
     C                     Z-ADD*ZERO     WBL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WBAYVA           Extended Amount
     C                     Z-ADD*ZERO     WBEXDT           Market Pricing
     C                     Z-ADD*ZERO     WBBZPR           Price Overage O
     C                     Z-ADD*ZERO     WBL6NB           Contract Number
     C                     Z-ADD*ZERO     WBGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WBD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WBCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WBAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WBCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WBATWG           Weight Shipped
     C                     Z-ADD*ZERO     WBAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WBAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WBAKPR           Unit Price
     C                     Z-ADD*ZERO     WBALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WBAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WBAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WBA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WBB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WBA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WBNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WBNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WBNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WBNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WBNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WBBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WBBVTM           Price Code
     C                     Z-ADD*ZERO     WBBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WBBXTM           Substitution Li
     C                     Z-ADD*ZERO     WBBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WBH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WBH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WBH7NX           OD Item Target
     C                     Z-ADD*ZERO     WBH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WBH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WBDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WBDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WBDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WBDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WBDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WBGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WBGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WBGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WBPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WBRINY           Item Age Days
     C                     Z-ADD*ZERO     WBTIDT           Production Ovr
     C                     Z-ADD*ZERO     WBTJDT           Production Ovr
     C                     Z-ADD*ZERO     WBTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WBTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WBTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003 20
     C                     MOVEL*BLANK    WL0004  4
     C                     MOVEL*BLANK    WL0005  5
      * Define local work field Page Nbr - Total (2.0)USR
     C                     Z-ADD*ZERO     YL0001  20
      * Define local work field Manifest Dtl Record Count
     C                     Z-ADD*ZERO     YL0002  50
      * Define local work field USR Counter
     C                     Z-ADD*ZERO     YL0003  50
      * Define local work field Page Overflow
     C                     Z-ADD*ZERO     YL0004  30
      * Define local work field USR Count
     C                     Z-ADD*ZERO     YL0005  30
      * Define local work field USR Page Number 3.0
     C                     Z-ADD*ZERO     YL0006  30
      * Define local work field Remaining Bal 8.2 USR
     C                     Z-ADD*ZERO     YL0007  82
      * Define null work field Order Type - Sales
     C                     MOVEL*BLANK    YN0001  2
      * Define null work field A/R Customer Number
     C                     Z-ADD*ZERO     YN0002  70
      * Define local work field Ship To Name
     C                     MOVEL*BLANK    YL0008 30
      * Define local work field Ship To Address Line 1
     C                     MOVEL*BLANK    YL0009 30
      * Define local work field Ship To Address Line 2
     C                     MOVEL*BLANK    YL0010 30
      * Define local work field Ship To Address Line 3
     C                     MOVEL*BLANK    YL0011 30
      * Define local work field Ship To City
     C                     MOVEL*BLANK    YL0012 20
      * Define local work field Ship To State Code
     C                     MOVEL*BLANK    YL0013  2
      * Define local work field Ship To Zip/Postal Code
     C                     MOVEL*BLANK    YL0014 11
      * Define local work field Bill to Customer
     C                     Z-ADD*ZERO     YL0015  70
      * Define local work field Bill to Name
     C                     MOVEL*BLANK    YL0016 30
      * Define local work field Bill to Address Line 1
     C                     MOVEL*BLANK    YL0017 30
      * Define local work field Bill to Address Line 2
     C                     MOVEL*BLANK    YL0018 30
      * Define local work field Bill to Address Line 3
     C                     MOVEL*BLANK    YL0019 30
      * Define local work field Bill to City
     C                     MOVEL*BLANK    YL0020 20
      * Define local work field Bill to State Code
     C                     MOVEL*BLANK    YL0021  2
      * Define local work field Bill to Zip/Postal Code
     C                     MOVEL*BLANK    YL0022 11
      * Define null work field Order Date
     C                     Z-ADD*ZERO     YN0003  70
      * Define null work field Requested Ship Date
     C                     Z-ADD*ZERO     YN0004  70
      * Define null work field Cancel Date
     C                     Z-ADD*ZERO     YN0005  70
      * Define local work field Terms Code
     C                     MOVEL*BLANK    YL0023  2
      * Define null work field Special Instructions
     C                     MOVEL*BLANK    YN0006 40
      * Define null work field Special Instructions 2
     C                     MOVEL*BLANK    YN0007 40
      * Define null work field Carrier Code
     C                     MOVEL*BLANK    YN0008  3
      * Define null work field Comment Print Acknowledge
     C                     MOVEL*BLANK    YN0009  1
      * Define null work field Comment Print Inv/Cr.Memo
     C                     MOVEL*BLANK    YN0010  1
      * Define null work field Comment Print Pick Slip
     C                     MOVEL*BLANK    YN0011  1
      * Define null work field Comment Print Ship Doc
     C                     MOVEL*BLANK    YN0012  1
      * Define null work field Reason Code
     C                     MOVEL*BLANK    YN0013  3
      * Define null work field Order in Use
     C                     MOVEL*BLANK    YN0014  1
      * Define null work field Header Status
     C                     MOVEL*BLANK    YN0015  1
      * Define null work field Header Status Last
     C                     MOVEL*BLANK    YN0016  1
      * Define null work field Order Type Print Status
     C                     MOVEL*BLANK    YN0017  1
      * Define null work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YN0018  70
      * Define null work field User Original Entry
     C                     MOVEL*BLANK    YN0019 10
      * Define null work field Date of Original Entry
     C                     Z-ADD*ZERO     YN0020  70
      * Define null work field Order Value Total
     C                     Z-ADD*ZERO     YN0021 112
      * Define null work field Order Weight Total
     C                     Z-ADD*ZERO     YN0022 112
      * Define null work field Credit Hold
     C                     MOVEL*BLANK    YN0023  1
      * Define null work field Production Hold
     C                     MOVEL*BLANK    YN0024  1
      * Define null work field New Customer Hold
     C                     MOVEL*BLANK    YN0025  1
      * Define null work field Requested Delivery Date
     C                     Z-ADD*ZERO     YN0026  70
      * Define null work field Requested Delivery Time
     C                     Z-ADD*ZERO     YN0027  40
      * Define null work field Accounts Receiv. Ent 1
     C                     MOVEL*BLANK    YN0028  4
      * Define null work field Accounts Receiv. Ent 2
     C                     MOVEL*BLANK    YN0029 12
      * Define null work field Load ID
     C                     Z-ADD*ZERO     YN0030  70
      * Define null work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YN0031  52
      * Define null work field Rated Freight
     C                     Z-ADD*ZERO     YN0032 112
      * Define null work field LTL Flag
     C                     MOVEL*BLANK    YN0033  1
      * Define null work field Price Audit
     C                     MOVEL*BLANK    YN0034  1
      * Define null work field Price Status
     C                     MOVEL*BLANK    YN0035  1
      * Define null work field Shipping Method
     C                     MOVEL*BLANK    YN0036  2
      * Define null work field Export Status
     C                     MOVEL*BLANK    YN0037  1
      * Define null work field Palletize
     C                     MOVEL*BLANK    YN0038  1
      * Define null work field Shrink Wrap
     C                     MOVEL*BLANK    YN0039  1
      * Define null work field Slip Sheet
     C                     MOVEL*BLANK    YN0040  1
      * Define null work field Age Code
     C                     MOVEL*BLANK    YN0041  1
      * Define null work field Reefer Temperature
     C                     Z-ADD*ZERO     YN0042  52
      * Define null work field Load Type
     C                     MOVEL*BLANK    YN0043  1
      * Define null work field Attach to Invoice Number
     C                     Z-ADD*ZERO     YN0044  70
      * Define null work field Load Plan Order
     C                     MOVEL*BLANK    YN0045  1
      * Define null work field Print Pick Slip
     C                     MOVEL*BLANK    YN0046  1
      * Define null work field Resell Reference Number
     C                     Z-ADD*ZERO     YN0047  70
      * Define null work field Special Comment 1
     C                     MOVEL*BLANK    YN0048 30
      * Define null work field Special Comment 2
     C                     MOVEL*BLANK    YN0049 30
      * Define null work field Affect Auto Accruals
     C                     MOVEL*BLANK    YN0050  1
      * Define null work field Sales Route Code
     C                     MOVEL*BLANK    YN0051  3
      * Define null work field Manager Level Code
     C                     MOVEL*BLANK    YN0052  2
      * Define null work field VP Level Code
     C                     MOVEL*BLANK    YN0053  3
      * Define null work field Attach to Order Number
     C                     Z-ADD*ZERO     YN0054  70
      * Define null work field Reason for Price Audit
     C                     MOVEL*BLANK    YN0055  3
      * Define null work field Invoice Number
     C                     Z-ADD*ZERO     YN0056  70
      * Define null work field Invoice Suffix
     C                     MOVEL*BLANK    YN0057  2
      * Define null work field Invoice Date
     C                     Z-ADD*ZERO     YN0058  70
      * Define null work field Event Code
     C                     MOVEL*BLANK    YN0059  2
      * Define null work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    YN0060  1
      * Define null work field Modified Flag
     C                     MOVEL*BLANK    YN0061  1
      * Define null work field A/R order Value Total
     C                     Z-ADD*ZERO     YN0062 112
      * Define null work field Billing Activity Type
     C                     MOVEL*BLANK    YN0063  1
      * Define null work field Block Order Flag
     C                     MOVEL*BLANK    YN0064  1
      * Define null work field Order Certification Flag
     C                     MOVEL*BLANK    YN0065  1
      * Define null work field Invoice Order Value Tot
     C                     Z-ADD*ZERO     YN0066 112
      * Define null work field Process Sts for 3C
     C                     MOVEL*BLANK    YN0067  1
      * Define null work field Order Conf Fax Sts
     C                     MOVEL*BLANK    YN0068  1
      * Define null work field Manifest Fax Sts
     C                     MOVEL*BLANK    YN0069  1
      * Define null work field Invoice Fax Sts
     C                     MOVEL*BLANK    YN0070  1
      * Define null work field Transfer in Storage Ind
     C                     MOVEL*BLANK    YN0071  1
      * Define null work field Email Cust On Order Ship
     C                     MOVEL*BLANK    YN0072  1
      * Define null work field Order Emailed
     C                     MOVEL*BLANK    YN0073  1
      * Define null work field Export Docs Go w/Driver
     C                     MOVEL*BLANK    YN0074  1
      * Define null work field Shipping Temp Code C/F
     C                     MOVEL*BLANK    YN0075  1
      * Define null work field Broker Order Status
     C                     MOVEL*BLANK    YN0076  1
      * Define null work field Air Freight Order
     C                     MOVEL*BLANK    YN0077  1
      * Define null work field Order Requires Review
     C                     MOVEL*BLANK    YN0078  2
      * Define null work field OH Load Plan Ready
     C                     MOVEL*BLANK    YN0079  2
      * Define null work field Export USDA Approved
     C                     MOVEL*BLANK    YN0080  2
      * Define null work field HPB Ship to Warehouse
     C                     MOVEL*BLANK    YN0081  3
      * Define null work field OH TF Exempt Code
     C                     MOVEL*BLANK    YN0082  3
      * Define null work field OH Appt Confirmation Dt
     C                     Z-ADD*ZERO     YN0083  70
      * Define null work field JPN Invoice Issuance Date
     C                     Z-ADD*ZERO     YN0084  70
      * Define null work field Load Actual Shipped Date
     C                     Z-ADD*ZERO     YN0085  70
      * Define null work field Load BOL Complete Date
     C                     Z-ADD*ZERO     YN0086  70
      * Define null work field Load Truck Departure Date
     C                     Z-ADD*ZERO     YN0087  70
      * Define null work field Maximum Gross Weight
     C                     Z-ADD*ZERO     YN0088  60
      * Define null work field Time of Original Entry
     C                     Z-ADD*ZERO     YN0089  60
      * Define null work field OH Appt Confirmation Tm
     C                     Z-ADD*ZERO     YN0090  60
      * Define null work field Load BOL Complete Time
     C                     Z-ADD*ZERO     YN0091  60
      * Define null work field Load Truck Departure Time
     C                     Z-ADD*ZERO     YN0092  60
      * Define null work field Act Frt Reference Amount
     C                     Z-ADD*ZERO     YN0093 112
      * Define null work field Act Non-Ref Frt Amount
     C                     Z-ADD*ZERO     YN0094 112
      * Define null work field OH Fuel Surcharge Amount
     C                     Z-ADD*ZERO     YN0095 112
      * Define null work field OH Total Non-Ref Frt Amt
     C                     Z-ADD*ZERO     YN0096 112
      * Define null work field OH Total Ref Frt Amt
     C                     Z-ADD*ZERO     YN0097 112
      * Define null work field Claim Number
     C                     Z-ADD*ZERO     YN0098  70
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0099  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0100  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0101  1
      * Define null work field Job Time
     C                     Z-ADD*ZERO     YN0102  60
      * Define null work field User Id
     C                     MOVEL*BLANK    YN0103 10
      * Define null work field Job Name
     C                     MOVEL*BLANK    YN0104 10
      * Define null work field Job Date
     C                     Z-ADD*ZERO     YN0105  70
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0106  1
      * Define local work field HPB COA Batch Number
     C                     Z-ADD*ZERO     YL0024  50
      * Define local work field COA Bio-dsl Fuel Cd Descr
     C                     MOVEL*BLANK    YL0025 30
      * Define local work field COA Producer Regist Nbr
     C                     MOVEL*BLANK    YL0026 25
      * Define local work field COA Employer ID
     C                     MOVEL*BLANK    YL0027 20
      * Define null work field COA Sold From Address
     C                     MOVEL*BLANK    YN0107 40
      * Define local work field COA Sold From Name
     C                     MOVEL*BLANK    YL0028 40
      * Define local work field COA ULSD Company #
     C                     MOVEL*BLANK    YL0029  4
      * Define local work field COA ULSD Facility #
     C                     MOVEL*BLANK    YL0030  5
      * Define local work field COA RIN Equivalence Valu
     C                     MOVEL*BLANK    YL0031  2
      * Define local work field COA RIN Renewable Enrgy
     C                     MOVEL*BLANK    YL0032  1
      * Define local work field COA RIN Type Flag
     C                     MOVEL*BLANK    YL0033  1
      * Define local work field COA Density Loadout
     C                     Z-ADD*ZERO     YL0034  75
      * Define local work field COA Density Reference
     C                     Z-ADD*ZERO     YL0035  75
      * Define local work field COA Temperature Loadout
     C                     Z-ADD*ZERO     YL0036  30
      * Define local work field COA Temperature Ref
     C                     Z-ADD*ZERO     YL0037  30
      * Define local work field COA BOL Percent
     C                     Z-ADD*ZERO     YL0038  41
      * Define null work field COA Sale Location
     C                     MOVEL*BLANK    YN0108 30
      * Define null work field COA Active Whse/Tank 1
     C                     MOVEL*BLANK    YN0109  3
      * Define null work field COA Active Whse/Tank 2
     C                     MOVEL*BLANK    YN0110  3
      * Define null work field COA Active Whse/Tank 3
     C                     MOVEL*BLANK    YN0111  3
      * Define null work field COA Active Whse/Tank 4
     C                     MOVEL*BLANK    YN0112  3
      * Define null work field COA Active Whse/Tank 5
     C                     MOVEL*BLANK    YN0113  3
      * Define null work field COA Active Whse/Tank 6
     C                     MOVEL*BLANK    YN0114  3
      * Define local work field COA Temp Conv Factor 1
     C                     Z-ADD*ZERO     YL0039 118
      * Define local work field Operation Factor 1
     C                     MOVEL*BLANK    YL0040  1
      * Define local work field COA Temp Conv Factor 2
     C                     Z-ADD*ZERO     YL0041 118
      * Define local work field Operation Factor 2
     C                     MOVEL*BLANK    YL0042  1
      * Define local work field COA RFS Renew Fuel Code
     C                     MOVEL*BLANK    YL0043  3
      * Define local work field COA RFS Rnwbl Feedstock
     C                     MOVEL*BLANK    YL0044  3
      * Define null work field Name
     C                     MOVEL*BLANK    YN0115 30
      * Define local work field Address Line 2
     C                     MOVEL*BLANK    YL0045 30
      * Define local work field Address Line 3
     C                     MOVEL*BLANK    YL0046 30
      * Define local work field City
     C                     MOVEL*BLANK    YL0047 20
      * Define local work field Zip/Postal Code
     C                     MOVEL*BLANK    YL0048 11
      * Define local work field Telephone Number FF
     C                     MOVEL*BLANK    YL0049 25
      * Define local work field Fax Number FF
     C                     MOVEL*BLANK    YL0050 25
      * Define local work field State Code
     C                     MOVEL*BLANK    YL0051  2
      * Define local work field USR Compressed Address 2
     C                     MOVEL*BLANK    YL0052 34
      * Define local work field A/R Customer Number
     C                     Z-ADD*ZERO     YL0053  70
      * Define local work field HPB Employer ID #
     C                     MOVEL*BLANK    YL0054 20
      * Define local work field HPB ULSD Company #
     C                     MOVEL*BLANK    YL0055  4
      * Define local work field HPB ULSD Facility ID
     C                     MOVEL*BLANK    YL0056  5
      * Define local work field Page Nbr - of (2.0)   USR
     C                     Z-ADD*ZERO     YL0057  20
      * Define local work field USR Count
     C                     Z-ADD*ZERO     YL0058  30
      * Define local work field Page Nbr - of (2.0)   USR
     C                     Z-ADD*ZERO     YL0059  20
      * Define local work field U/M - Base Price
     C                     MOVEL*BLANK    YL0060  2
      * Define local work field U/M - Ordered
     C                     MOVEL*BLANK    YL0061  2
      * Define local work field USR Counter
     C                     Z-ADD*ZERO     YL0062  50
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * Calculate the number of pages the report will need.
      * RTV calc BOL pages-BY  RT - Load Detail  * 
     C                     EXSR SARVGN
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Phone:
