     H/TITLE PRT Aging by Inv Nite  ZZ Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by  : COOL:2E  Version:  1000
     H* Function type : Print file
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 05/24/01  Time  : 11:29:23
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FCABBRELDIF  E           K        DISK
      * RSQ : Customer                  RSQ By Name, Ship #
      *
     FARBCREL1IF  E           K        DISK
      * RTV : A/R Summary               Retrieval index       NV
      *
     FCAASREL2IF  E           K        DISK
      * RTV : Company Control           Retrieval index       NV
      *
     FARBCREL6IF  E           K        DISK
      * RSQ : A/R Summary               Co/Cust
      *
     FCAEOREL2IF  E           K        DISK
      * RTV : Company/Customer          Active Records         N
      *
     FCABBRELAIF  E           K        DISK
      * RTV : Customer                  Active Only
      *
     FARBDCPL6IF  E           K        DISK
      * RSQ : A/R Header                Co/Customer AR        V
      *
     FOPBFCPLWIF  E           K        DISK
      * RTV : Order Header TRG          Orders not Cancelled
      *
     FPDN4PFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: PRT Aging by Inv Nite  ZZ Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L3         3  1
     E                    #L7         7  1
     E                    YDOW        7  1               *Days of week
     I@BCREEJ
      * A/R Summary               Co/Cust
      * Renamed input format fields
     I              BCAIC3                          WAAIC3
     I              BCANC7                          WAANC7
     I              BCAGVA                          WAAGVA
     I              BCACVA                          WAACVA
     I              BCADVA                          WAADVA
     I              BCAEVA                          WAAEVA
     I              BCAFVA                          WAAFVA
     I              BCAHVA                          WAAHVA
     I              BCVIVA                          WAVIVA
     I              BCVJVA                          WAVJVA
     I              BCVKVA                          WAVKVA
     I              BCVLVA                          WAVLVA
     I              BCVMVA                          WAVMVA
     I              BCVNVA                          WAVNVA
     I              BCEEVA                          WAEEVA
     I              BCAKTM                          WAAKTM
     I              BCAHDT                          WAAHDT
     I              BCANDT                          WAANDT
     I              BCANVA                          WAANVA
     I              BCALDT                          WAALDT
     I              BCAMVA                          WAAMVA
     I              BCAIDT                          WAAIDT
     I              BCALVA                          WAALVA
     I              BCDJNB                          WADJNB
     I              BCDLNB                          WADLNB
     I              BCDDNB                          WADDNB
     I              BCDMNB                          WADMNB
     I              BCDUDT                          WADUDT
     I              BCLYNO                          WALYNO
     I              BCLYNC                          WALYNC
     I              BCLYNP                          WALYNP
     I              BCLYNI                          WALYNI
     I              BCADPM                          WAADPM
     I              BCVOVA                          WAVOVA
     I              BCBTDY                          WABTDY
     I              BCBUDY                          WABUDY
     I              BCVPVA                          WAVPVA
     I              BCVQVA                          WAVQVA
     I              BCBCCD                          WABCCD
     I              BCR4CD                          WAR4CD
     I              BCCUMO                          WACUMO
     I              BCUVST                          WAUVST
     I              BCUWST                          WAUWST
     I              BCUXST                          WAUXST
     I              BCAATM                          WAAATM
     I              BCAYNA                          WAAYNA
     I              BCA0NA                          WAA0NA
     I              BCAXDT                          WAAXDT
      *
     I@BBREWG
      * Customer                  Active Only
      * Renamed input format fields
     I              BBBKC7                          WBBKC7
     I              BBAYTX                          WBAYTX
     I              BBACNA                          WBACNA
     I              BBADNA                          WBADNA
     I              BBAENA                          WBAENA
     I              BBAJNA                          WBAJNA
     I              BBBGCD                          WBBGCD
     I              BBG5CD                          WBG5CD
     I              BBBTTX                          WBBTTX
     I              BBBVTX                          WBBVTX
     I              BBBWTX                          WBBWTX
     I              BBABTX                          WBABTX
     I              BBA2NA                          WBA2NA
     I              BBCBST                          WBCBST
     I              BBB0NA                          WBB0NA
     I              BBP3NB                          WBP3NB
     I              BBAXNA                          WBAXNA
     I              BBI6DT                          WBI6DT
     I              BBAYDT                          WBAYDT
     I              BBANC7                          WBANC7
     I              BBBTC7                          WBBTC7
     I              BBK6ST                          WBK6ST
     I              BBUZST                          WBUZST
     I              BBKXCD                          WBKXCD
     I              BBLTCD                          WBLTCD
     I              BBQNST                          WBQNST
     I              BBS2NB                          WBS2NB
     I              BBVHVA                          WBVHVA
     I              BBI7DT                          WBI7DT
     I              BBRJST                          WBRJST
     I              BBRKST                          WBRKST
     I              BBQWST                          WBQWST
     I              BBQXST                          WBQXST
     I              BBQYST                          WBQYST
     I              BBUNCS                          WBUNCS
     I              BBUVST                          WBUVST
     I              BBUWST                          WBUWST
     I              BBUXST                          WBUXST
     I              BBVSST                          WBVSST
     I              BBAATM                          WBAATM
     I              BBAYNA                          WBAYNA
     I              BBA0NA                          WBA0NA
     I              BBAXDT                          WBAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: A/R Summary
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * N :  Age $ Due - Current - CB
     I                                    P   3   82P1AGVA
      * N :  Age $ Due - Aging 1 - CB
     I                                    P   9  142P1ACVA
      * N :  Age $ Due - Aging 2 - CB
     I                                    P  15  202P1ADVA
      * N :  Age $ Due - Aging 3 - CB
     I                                    P  21  262P1AEVA
      * N :  Age $ Due - Aging 4 - CB
     I                                    P  27  322P1AFVA
      * N :  Age $ Due - Aging 5 - CB
     I                                    P  33  382P1AHVA
      * N :  Age $ Due-Current-W/O CB
     I                                    P  39  442P1VIVA
      * N :  Age $ Due-Aging 1-W/O CB
     I                                    P  45  502P1VJVA
      * N :  Age $ Due-Aging 2-W/O CB
     I                                    P  51  562P1VKVA
      * N :  Age $ Due-Aging 3-W/O CB
     I                                    P  57  622P1VLVA
      * N :  Age $ Due-Aging 4-W/O CB
     I                                    P  63  682P1VMVA
      * N :  Age $ Due-Aging 5-W/O CB
     I                                    P  69  742P1VNVA
      * N :  Time of Last Aging
     I                                    P  75  780P1AKTM
      * N : MAP Date of Last Payment
     I                                    P  79  820P1ALDT
      * N : MAP Date of Highest A/R Bal.
     I                                    P  83  860P1AIDT
      * N : MAP Amount of Highest A/R Bal
     I                                    P  87  922P1ALVA
      * N :  Date of Last Aging
     I                                    P  93  960P1DUDT
      * N :  MTD Invoices Paid
     I                                    P  97  990P1ADPM
      * N :  YTD Invoices Paid
     I                                    P 100 1020P1VOVA
      * N :  MTD Days Paid
     I                                    P 103 1050P1BTDY
      * N :  YTD Days Paid
     I                                    P 106 1080P1BUDY
      * N : MAP YTD Sales Invoiced
     I                                    P 109 1142P1VPVA
     IP2PARM      DS
      * FLD: *Arrays
      * N :  USR Age Current B
     I                                    P   1   62P2E5VA
      * N :  USR Age Value 1 B
     I                                    P   7  122P2E0VA
      * N :  USR Age Value 2 B
     I                                    P  13  182P2E1VA
      * N :  USR Age Value 3 B
     I                                    P  19  242P2E2VA
      * N :  USR Age Value 4 B
     I                                    P  25  302P2E3VA
      * N :  USR Age Value 5 B
     I                                    P  31  362P2E4VA
      * N :  USR Tot. Due W/O CB
     I                                    P  37  422P2WBVA
      * N :  USR Tot. Due with CB
     I                                    P  43  482P2WAVA
      * N :  Tot. Current % Calc
     I                                    P  49  536P2EDPC
      * N :  Tot. Age 1 % Calc
     I                                    P  54  586P2EEPC
      * N :  Tot. Age 2 % Calc
     I                                    P  59  636P2EFPC
      * N :  Tot. Age 3 % Calc
     I                                    P  64  686P2EGPC
      * N :  Tot. Age 4 % Calc
     I                                    P  69  736P2EHPC
      * N :  Tot. Age 5 % Calc
     I                                    P  74  786P2EIPC
     IP3PARM      DS
      * FLD: Customer
      * N :  Parent Customer
     I                                    P   1   40P3BTC7
      * N :  A/R Credit Limit
     I                                    P   5  102P3VHVA
     IP4PARM      DS
      * FLD: Company/Customer
      * N :  Credit Contact Name
     I                                        1  30 P4NJNA
      * N :  Credit Contact Telephone
     I                                       31  55 P4I0TX
      * N :  Credit Contact Fax Number
     I                                       56  80 P4I1TX
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PRT Aging by Inv Nite  ZZ: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$PENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * PRT Aging by Inv Nite  ZZ: Mainline
      *================================================================
      * Establish starting position
     C           *LOVAL    SETLL@BBREJU                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Customer Name
     C                     MOVEL'Y'       W0AL01  1        Ship To Custome
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $OEIPC           Tot. Age 5 % Ca
     C                     Z-ADD*ZERO     $OEHPC           Tot. Age 4 % Ca
     C                     Z-ADD*ZERO     $OEGPC           Tot. Age 3 % Ca
     C                     Z-ADD*ZERO     $OEFPC           Tot. Age 2 % Ca
     C                     Z-ADD*ZERO     $OEEPC           Tot. Age 1 % Ca
     C                     Z-ADD*ZERO     $OEDPC           Tot. Current %
     C                     Z-ADD*ZERO     $OVZVA           USR Tot. Curren
     C                     Z-ADD*ZERO     $OVUVA           USR Tot. Age 1
     C                     Z-ADD*ZERO     $OVVVA           USR Tot. Age 2
     C                     Z-ADD*ZERO     $OVWVA           USR Tot. Age 3
     C                     Z-ADD*ZERO     $OVXVA           USR Tot. Age 4
     C                     Z-ADD*ZERO     $OVYVA           USR Tot. Age 5
     C                     Z-ADD*ZERO     $OWAVA           USR Tot. Due wi
     C                     Z-ADD*ZERO     $OD7PC           Tot. Current %
     C                     Z-ADD*ZERO     $OD8PC           Tot. Age 1 %
     C                     Z-ADD*ZERO     $OD9PC           Tot. Age 2 %
     C                     Z-ADD*ZERO     $OEAPC           Tot. Age 3 %
     C                     Z-ADD*ZERO     $OEBPC           Tot. Age 4 %
     C                     Z-ADD*ZERO     $OECPC           Tot. Age 5 %
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDBBBKC7    $DBKC7           Ship To Custome
     C                     MOVELBBAYTX    $DAYTX           Customer Name
     C                     MOVEL*BLANK    $DNJNA           Credit Contact
     C                     MOVEL*BLANK    $DI0TX           Credit Contact
     C                     MOVEL*BLANK    $DI1TX           Credit Contact
     C                     MOVELBBACNA    $DACNA           Address Line 1
     C                     MOVELBBADNA    $DADNA           Address Line 2
     C                     MOVELBBAENA    $DAENA           Address Line 3
     C                     MOVELBBAJNA    $DAJNA           City
     C                     MOVELBBBGCD    $DBGCD           State Code
     C                     Z-ADD*ZERO     $DALDT           Date of Last Pa
     C                     Z-ADD*ZERO     $DALVA           Amount of Highe
     C                     Z-ADD*ZERO     $DAIDT           Date of Highest
     C                     Z-ADD*ZERO     $DVPVA           YTD Sales Invoi
     C                     MOVELBBG5CD    $DG5CD           County Code
     C                     MOVELBBBTTX    $DBTTX           Zip/Postal Code
     C                     MOVELBBBVTX    $DBVTX           Telephone Numbe
     C                     MOVELBBBWTX    $DBWTX           Fax Number FF
     C                     MOVELBBABTX    $DABTX           Alpha Search
     C                     MOVELBBA2NA    $DA2NA           Federal Tax Id.
     C                     MOVELBBCBST    $DCBST           New Customer St
     C                     MOVELBBB0NA    $DB0NA           SIC Number
     C                     Z-ADDBBP3NB    $DP3NB           D & B Number
     C                     MOVELBBAXNA    $DAXNA           D & B Rating
     C                     Z-ADDBBI6DT    $DI6DT           Date of D & B R
     C                     Z-ADDBBAYDT    $DAYDT           Credit Line Exp
     C                     Z-ADDBBANC7    $DANC7           A/R Customer Nu
     C                     Z-ADDBBBTC7    $DBTC7           Parent Customer
     C                     MOVEL*BLANK    $DK2TX           USR Parent Name
     C                     Z-ADDBBS2NB    $DS2NB           Parent Credit L
     C                     Z-ADD*ZERO     $DEJPC           MTD Avg Days to
     C                     Z-ADD*ZERO     $DEKPC           YTD Avg Days to
     C                     MOVELBBK6ST    $DK6ST           Credit Check A/
     C                     MOVELBBUZST    $DUZST           Credit Check Pa
     C                     MOVELBBKXCD    $DKXCD           Country Code
     C                     MOVELBBLTCD    $DLTCD           EDI Invoice Sts
     C                     MOVELBBQNST    $DQNST           Order Entry Hol
     C                     Z-ADDBBVHVA    $DVHVA           A/R Credit Limi
     C                     Z-ADDBBI7DT    $DI7DT           Order Entry Hol
     C                     MOVELBBRJST    $DRJST           Ship To Custome
     C                     MOVELBBRKST    $DRKST           Secured Terms F
     C                     MOVELBBQWST    $DQWST           Email When Orde
     C                     MOVELBBQXST    $DQXST           Print Invoice S
     C                     MOVELBBQYST    $DQYST           Unused Customer
     C                     MOVELBBUNCS    $DUNCS           Unused Customer
     C                     MOVELBBUVST    $DUVST           EDI Status 1
     C                     MOVELBBUWST    $DUWST           EDI Status 2
     C                     MOVELBBUXST    $DUXST           EDI Status 3
     C                     MOVELBBVSST    $DVSST           Record Status
     C                     Z-ADDBBAATM    $DAATM           Job Time
     C                     MOVELBBAYNA    $DAYNA           User Id
     C                     MOVELBBA0NA    $DA0NA           Job Name
     C                     Z-ADDBBAXDT    $DAXDT           Job Date
      * Load related totals format
     C                     Z-ADDBBBKC7    $NBKC7           Ship To Custome
     C                     MOVELBBAYTX    $NAYTX           Customer Name
     C                     MOVELBBACNA    $NACNA           Address Line 1
     C                     MOVELBBADNA    $NADNA           Address Line 2
     C                     MOVELBBAENA    $NAENA           Address Line 3
     C                     MOVELBBAJNA    $NAJNA           City
     C                     MOVELBBBGCD    $NBGCD           State Code
     C                     MOVELBBG5CD    $NG5CD           County Code
     C                     MOVELBBBTTX    $NBTTX           Zip/Postal Code
     C                     MOVELBBBVTX    $NBVTX           Telephone Numbe
     C                     MOVELBBBWTX    $NBWTX           Fax Number FF
     C                     MOVELBBABTX    $NABTX           Alpha Search
     C                     MOVELBBA2NA    $NA2NA           Federal Tax Id.
     C                     MOVELBBCBST    $NCBST           New Customer St
     C                     MOVELBBB0NA    $NB0NA           SIC Number
     C                     Z-ADDBBP3NB    $NP3NB           D & B Number
     C                     MOVELBBAXNA    $NAXNA           D & B Rating
     C                     Z-ADDBBI6DT    $NI6DT           Date of D & B R
     C                     Z-ADDBBAYDT    $NAYDT           Credit Line Exp
     C                     Z-ADDBBANC7    $NANC7           A/R Customer Nu
     C                     Z-ADDBBBTC7    $NBTC7           Parent Customer
     C                     MOVELBBK6ST    $NK6ST           Credit Check A/
     C                     MOVELBBUZST    $NUZST           Credit Check Pa
     C                     MOVELBBKXCD    $NKXCD           Country Code
     C                     MOVELBBLTCD    $NLTCD           EDI Invoice Sts
     C                     MOVELBBQNST    $NQNST           Order Entry Hol
     C                     Z-ADDBBS2NB    $NS2NB           Parent Credit L
     C                     Z-ADDBBVHVA    $NVHVA           A/R Credit Limi
     C                     Z-ADDBBI7DT    $NI7DT           Order Entry Hol
     C                     MOVELBBRJST    $NRJST           Ship To Custome
     C                     MOVELBBRKST    $NRKST           Secured Terms F
     C                     MOVELBBQWST    $NQWST           Email When Orde
     C                     MOVELBBQXST    $NQXST           Print Invoice S
     C                     MOVELBBQYST    $NQYST           Unused Customer
     C                     MOVELBBUNCS    $NUNCS           Unused Customer
     C                     MOVELBBUVST    $NUVST           EDI Status 1
     C                     MOVELBBUWST    $NUWST           EDI Status 2
     C                     MOVELBBUXST    $NUXST           EDI Status 3
     C                     MOVELBBVSST    $NVSST           Record Status
     C                     Z-ADDBBAATM    $NAATM           Job Time
     C                     MOVELBBAYNA    $NAYNA           User Id
     C                     MOVELBBA0NA    $NA0NA           Job Name
     C                     Z-ADDBBAXDT    $NAXDT           Job Date
      * USER: Process before print of Ship To Customer format
      * RTV Alpha Age by Inv   RT - A/R Summary  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0008           Company Number
     C                     Z-ADD$DANC7    WL0009           A/R Customer Nu
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0010    P1VIVA           Age $ Due-Curre
     C                     Z-ADDWL0011    P1VJVA           Age $ Due-Aging
     C                     Z-ADDWL0012    P1VKVA           Age $ Due-Aging
     C                     Z-ADDWL0013    P1VLVA           Age $ Due-Aging
     C                     Z-ADDWL0014    P1VMVA           Age $ Due-Aging
     C                     Z-ADDWL0015    P1VNVA           Age $ Due-Aging
     C                     Z-ADDWL0016    $DALDT           Date of Last Pa
     C                     Z-ADDWL0017    $DAIDT           Date of Highest
     C                     Z-ADDWL0018    $DALVA           Amount of Highe
     C                     Z-ADDWL0019    P1DUDT           Date of Last Ag
     C                     Z-ADDWL0020    P1ADPM           MTD Invoices Pa
     C                     Z-ADDWL0021    P1VOVA           YTD Invoices Pa
     C                     Z-ADDWL0022    P1BTDY           MTD Days Paid
     C                     Z-ADDWL0023    P1BUDY           YTD Days Paid
     C                     Z-ADDWL0024    $DVPVA           YTD Sales Invoi
      * CLC Avg Days to Pay    XF - A/R Summary  * 
     C                     CALL 'PDNAXFR'              90  CLC Avg Days to
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1ADPM    WQ0001  50       MTD Invoices Pa
     C                     PARM P1VOVA    WQ0002  50       YTD Invoices Pa
     C                     PARM P1BTDY    WQ0003  50       MTD Days Paid
     C                     PARM P1BUDY    WQ0004  50       YTD Days Paid
     C           $DEJPC    PARM *ZERO     WQ0005  52       MTD Avg Days to
     C           $DEKPC    PARM *ZERO     WQ0006  52       YTD Avg Days to
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDNAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RTV Cust Age Inv Nite  RT - Company/Customer  * 
     C                     EXSR SGRVGN
      * RTV Credit Limits,Name RT - Customer  * 
     C                     EXSR SHRVGN
      * Print *HOLD* if customer order entry hold flag is yes
      * CASE: DB1.Order Entry Hold is New Order Hold
     C           BBQNST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUD4ST           USR Flag 1
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUD4ST           USR Flag 1
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDBBBKC7    $EBKC7           Ship To Custome
     C                     MOVELBBAYTX    $EAYTX           Customer Name
     C                     MOVELBBACNA    $EACNA           Address Line 1
     C                     MOVELBBADNA    $EADNA           Address Line 2
     C                     MOVELBBAENA    $EAENA           Address Line 3
     C                     MOVELBBAJNA    $EAJNA           City
     C                     MOVELBBBGCD    $EBGCD           State Code
     C                     MOVELBBG5CD    $EG5CD           County Code
     C                     MOVELBBBTTX    $EBTTX           Zip/Postal Code
     C                     MOVELBBBVTX    $EBVTX           Telephone Numbe
     C                     MOVELBBBWTX    $EBWTX           Fax Number FF
     C                     MOVELBBABTX    $EABTX           Alpha Search
     C                     MOVELBBA2NA    $EA2NA           Federal Tax Id.
     C                     MOVELBBCBST    $ECBST           New Customer St
     C                     MOVELBBB0NA    $EB0NA           SIC Number
     C                     Z-ADDBBP3NB    $EP3NB           D & B Number
     C                     MOVELBBAXNA    $EAXNA           D & B Rating
     C                     Z-ADDBBI6DT    $EI6DT           Date of D & B R
     C                     Z-ADDBBAYDT    $EAYDT           Credit Line Exp
     C                     Z-ADDBBANC7    $EANC7           A/R Customer Nu
     C                     Z-ADDBBBTC7    $EBTC7           Parent Customer
     C                     MOVELBBK6ST    $EK6ST           Credit Check A/
     C                     MOVELBBUZST    $EUZST           Credit Check Pa
     C                     MOVELBBKXCD    $EKXCD           Country Code
     C                     MOVELBBLTCD    $ELTCD           EDI Invoice Sts
     C                     MOVELBBQNST    $EQNST           Order Entry Hol
     C                     Z-ADDBBS2NB    $ES2NB           Parent Credit L
     C                     Z-ADDBBVHVA    $EVHVA           A/R Credit Limi
     C                     Z-ADDBBI7DT    $EI7DT           Order Entry Hol
     C                     MOVELBBRJST    $ERJST           Ship To Custome
     C                     MOVELBBRKST    $ERKST           Secured Terms F
     C                     MOVELBBQWST    $EQWST           Email When Orde
     C                     MOVELBBQXST    $EQXST           Print Invoice S
     C                     MOVELBBQYST    $EQYST           Unused Customer
     C                     MOVELBBUNCS    $EUNCS           Unused Customer
     C                     MOVELBBUVST    $EUVST           EDI Status 1
     C                     MOVELBBUWST    $EUWST           EDI Status 2
     C                     MOVELBBUXST    $EUXST           EDI Status 3
     C                     MOVELBBVSST    $EVSST           Record Status
     C                     Z-ADDBBAATM    $EAATM           Job Time
     C                     MOVELBBAYNA    $EAYNA           User Id
     C                     MOVELBBA0NA    $EA0NA           Job Name
     C                     Z-ADDBBAXDT    $EAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : PRT Nite Age by Inv    PO
     C                     EXSR UASUBR                     Embedded PRTOBJ
      * USER: Process after print of detail format
     C                     ADD  P2E5VA    WUVZVA           USR Tot. Curren
     C                     ADD  P2E0VA    WUVUVA           USR Tot. Age 1
     C                     ADD  P2E1VA    WUVVVA           USR Tot. Age 2
     C                     ADD  P2E2VA    WUVWVA           USR Tot. Age 3
     C                     ADD  P2E3VA    WUVXVA           USR Tot. Age 4
     C                     ADD  P2E4VA    WUVYVA           USR Tot. Age 5
     C                     Z-ADD*ZERO     P2E5VA           USR Age Current
     C                     Z-ADD*ZERO     P2E0VA           USR Age Value 1
     C                     Z-ADD*ZERO     P2E1VA           USR Age Value 2
     C                     Z-ADD*ZERO     P2E2VA           USR Age Value 3
     C                     Z-ADD*ZERO     P2E3VA           USR Age Value 4
     C                     Z-ADD*ZERO     P2E4VA           USR Age Value 5
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN BBAYTX    WZA001           Customer Name
     C                     MOVELBBAYTX    WZA001
     C           *LIKE     DEFN BBBKC7    WZA002           Ship To Custome
     C                     Z-ADDBBBKC7    WZA002
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C                     READ @BBREJU                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * Per project ARS019 this program has been changed to use customer
      *   Name as the primary file.  A new program has been created over
      * CASE: DB1.Ship To Customer EQ DB1.A/R Customer Number
     C           BBBKC7    IFEQ BBANC7                     *IF
      * RTV Alpha Age by Inv   RT - A/R Summary  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0008           Company Number
     C                     Z-ADDBBANC7    WL0009           A/R Customer Nu
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0010    P1VIVA           Age $ Due-Curre
     C                     Z-ADDWL0011    P1VJVA           Age $ Due-Aging
     C                     Z-ADDWL0012    P1VKVA           Age $ Due-Aging
     C                     Z-ADDWL0013    P1VLVA           Age $ Due-Aging
     C                     Z-ADDWL0014    P1VMVA           Age $ Due-Aging
     C                     Z-ADDWL0015    P1VNVA           Age $ Due-Aging
     C                     Z-ADDWL0016    P1ALDT           Date of Last Pa
     C                     Z-ADDWL0017    P1AIDT           Date of Highest
     C                     Z-ADDWL0018    P1ALVA           Amount of Highe
     C                     Z-ADDWL0019    P1DUDT           Date of Last Ag
     C                     Z-ADDWL0020    P1ADPM           MTD Invoices Pa
     C                     Z-ADDWL0021    P1VOVA           YTD Invoices Pa
     C                     Z-ADDWL0022    P1BTDY           MTD Days Paid
     C                     Z-ADDWL0023    P1BUDY           YTD Days Paid
     C                     Z-ADDWL0024    P1VPVA           YTD Sales Invoi
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     P2WBVA           USR Tot. Due W/
     C           P1VIVA    ADD  P1VJVA    P2WBVA           USR Tot. Due W/
     C                     ADD  P1VKVA    P2WBVA           USR Tot. Due W/
     C                     ADD  P1VLVA    P2WBVA           USR Tot. Due W/
     C                     ADD  P1VMVA    P2WBVA           USR Tot. Due W/
     C                     ADD  P1VNVA    P2WBVA           USR Tot. Due W/
      * Only Print Customers that have a balance due
      * CASE: PAR.USR Tot. Due W/O CB is Zero
     C           P2WBVA    IFEQ *ZERO                      *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Customer Name
     C                     MOVEL*BLANK    W0AL01  1        Ship To Custome
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Customer Name
     C                     MOVEL'Y'       W0AL01  1        Ship To Custome
     C                     ELSE
      * Next record - Detect level breaks
     C           BBAYTX    IFNE WZA001                     Customer Name
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           BBBKC7    IFNE WZA002                     Ship To Custome
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL01    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$NKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of final totals format
     C                     Z-ADDWUVZVA    $OVZVA           USR Tot. Curren
     C                     Z-ADDWUVUVA    $OVUVA           USR Tot. Age 1
     C                     Z-ADDWUVVVA    $OVVVA           USR Tot. Age 2
     C                     Z-ADDWUVWVA    $OVWVA           USR Tot. Age 3
     C                     Z-ADDWUVXVA    $OVXVA           USR Tot. Age 4
     C                     Z-ADDWUVYVA    $OVYVA           USR Tot. Age 5
     C           $OVZVA    ADD  $OVUVA    $OWAVA           USR Tot. Due wi
     C                     ADD  $OVVVA    $OWAVA           USR Tot. Due wi
     C                     ADD  $OVWVA    $OWAVA           USR Tot. Due wi
     C                     ADD  $OVXVA    $OWAVA           USR Tot. Due wi
     C                     ADD  $OVYVA    $OWAVA           USR Tot. Due wi
      * Current Percentage  of Total
      * CASE: CUR.USR Tot. Current is Not Zero
     C           $OVZVA    IFNE *ZERO                      *IF
     C           $OVZVA    DIV  $OWAVA    P2EDPC    H      Tot. Current %
     C           P2EDPC    MULT 100       $OD7PC    H      Tot. Current %
     C                     END                             *FI
      * Age 1 Percentage  of Total
      * CASE: CUR.USR Tot. Age 1 is Not Zero
     C           $OVUVA    IFNE *ZERO                      *IF
     C           $OVUVA    DIV  $OWAVA    P2EEPC    H      Tot. Age 1 % Ca
     C           P2EEPC    MULT 100       $OD8PC    H      Tot. Age 1 %
     C                     END                             *FI
      * Age 2 Percentage  of Total
      * CASE: CUR.USR Tot. Age 2 is Not Zero
     C           $OVVVA    IFNE *ZERO                      *IF
     C           $OVVVA    DIV  $OWAVA    P2EFPC    H      Tot. Age 2 % Ca
     C           P2EFPC    MULT 100       $OD9PC    H      Tot. Age 2 %
     C                     END                             *FI
      * Age 3 Percentage  of Total
      * CASE: CUR.USR Tot. Age 3 is Not Zero
     C           $OVWVA    IFNE *ZERO                      *IF
     C           $OVWVA    DIV  $OWAVA    P2EGPC    H      Tot. Age 3 % Ca
     C           P2EGPC    MULT 100       $OEAPC    H      Tot. Age 3 %
     C                     END                             *FI
      * Age 4 Percentage  of Total
      * CASE: CUR.USR Tot. Age 4 is Not Zero
     C           $OVXVA    IFNE *ZERO                      *IF
     C           $OVXVA    DIV  $OWAVA    P2EHPC    H      Tot. Age 4 % Ca
     C           P2EHPC    MULT 100       $OEBPC    H      Tot. Age 4 %
     C                     END                             *FI
      * Age 5 Percentage  of Total
      * CASE: CUR.USR Tot. Age 5 is Not Zero
     C           $OVYVA    IFNE *ZERO                      *IF
     C           $OVYVA    DIV  $OWAVA    P2EIPC    H      Tot. Age 5 % Ca
     C           P2EIPC    MULT 100       $OECPC    H      Tot. Age 5 %
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 4
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$OFINTTL
     C                     END
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * PRT Nite Age by Inv    PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN BDAIC3    WQKB01           Company Number
     C           *LIKE     DEFN BDANC7    WQKB02           A/R Customer Nu
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           Company Number
     C                     KFLD           WQKB02           A/R Customer Nu
      * Setup key
     C                     Z-ADDP1AIC3    WQKB01           Company Number
     C                     Z-ADD$EANC7    WQKB02           A/R Customer Nu
      * Establish starting position
     C           KRSB      SETLL@BDCPGB                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        A/R Customer Nu
     C                     MOVEL'Y'       W0BL02  1        Invoice Number
     C                     MOVEL'Y'       W0BL03  1        Invoice Suffix
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $MWJVA           USR Fin Cur Due
     C                     Z-ADD*ZERO     $MWKVA           USR Fin Age 1 w
     C                     Z-ADD*ZERO     $MWLVA           USR Fin Age 2 w
     C                     Z-ADD*ZERO     $MWMVA           USR Fin Age 3 w
     C                     Z-ADD*ZERO     $MWNVA           USR Fin Age 4 w
     C                     Z-ADD*ZERO     $MWOVA           USR Fin Age 5 w
     C                     Z-ADD*ZERO     $MVEVA           USR Final Total
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDBDAIC3    $GAIC3           Company Number
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDBDAIC3    $HAIC3           Company Number
     C                     Z-ADDBDANC7    $HANC7           A/R Customer Nu
      * Load related totals format
     C                     Z-ADDBDAIC3    $LAIC3           Company Number
     C                     Z-ADDBDANC7    $LANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     $LVZVA           USR Tot. Curren
     C                     Z-ADD*ZERO     $LVUVA           USR Tot. Age 1
     C                     Z-ADD*ZERO     $LVVVA           USR Tot. Age 2
     C                     Z-ADD*ZERO     $LVWVA           USR Tot. Age 3
     C                     Z-ADD*ZERO     $LVXVA           USR Tot. Age 4
     C                     Z-ADD*ZERO     $LVYVA           USR Tot. Age 5
     C                     Z-ADD*ZERO     $LV0VA           USR Tot. Credit
     C                     Z-ADD*ZERO     $LV5VA           USR Tot. Curren
     C                     Z-ADD*ZERO     $LV1VA           USR Tot. Age 1
     C                     Z-ADD*ZERO     $LV2VA           USR Tot. Age 2
     C                     Z-ADD*ZERO     $LV3VA           USR Tot. Age 3
     C                     Z-ADD*ZERO     $LV4VA           USR Tot. Age 4
     C                     Z-ADD*ZERO     $LV6VA           USR Tot. Age 5
     C                     Z-ADD*ZERO     $LFPVA           USR Total Bal D
     C                     Z-ADD*ZERO     $LV7VA           USR Total Due
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDBDAIC3    $IAIC3           Company Number
     C                     Z-ADDBDCONB    $ICONB           Invoice Number
     C                     Z-ADDBDANC7    $IANC7           A/R Customer Nu
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDBDAIC3    $JAIC3           Company Number
     C                     Z-ADDBDCONB    $JCONB           Invoice Number
     C                     MOVELBDCEST    $JCEST           Invoice Suffix
     C                     MOVELBDUHCD    $JUHCD           Adjustment Type
     C                     Z-ADDBDBSVA    $JBSVA           Transaction Amo
     C                     Z-ADDBDAIVA    $JAIVA           Adjustment Amou
     C                     Z-ADDBDAOVA    $JAOVA           Amount Paid
     C                     Z-ADDBDBGVA    $JBGVA           Remaining Balan
     C                     MOVELBDAJST    $JAJST           A/R Processing
     C                     MOVELBDE3ST    $JE3ST           Purge Status
     C                     MOVELBDG4CD    $JG4CD           Bank Code
     C                     Z-ADDBDCKNB    $JCKNB           G/L Document Nu
     C                     Z-ADDBDCAC7    $JCAC7           Order Number Re
     C                     Z-ADDBDBKC7    $JBKC7           Ship To Custome
     C                     MOVELBDBCCD    $JBCCD           Salesperson Cod
     C                     MOVELBDR4CD    $JR4CD           Sales Route Cod
     C                     Z-ADDBDB4DT    $JB4DT           Transaction Dat
     C                     Z-ADDBDATDT    $JATDT           Due Date
     C                     Z-ADDBDH0DT    $JH0DT           Last Payment Da
     C                     Z-ADDBDH3DT    $JH3DT           Unused Date Cod
     C                     Z-ADDBDH4DT    $JH4DT           Paid in Full Da
     C                     Z-ADDBDH5DT    $JH5DT           Last G/L Post D
     C                     Z-ADDBDANC7    $JANC7           A/R Customer Nu
     C                     MOVELBDCPTX    $JCPTX           A/R Check Numbe
     C                     Z-ADDBDBSDY    $JBSDY           Days to Pay
     C                     MOVELBDUVST    $JUVST           EDI Status 1
     C                     MOVELBDUWST    $JUWST           EDI Status 2
     C                     MOVELBDUXST    $JUXST           EDI Status 3
     C                     Z-ADDBDAATM    $JAATM           Job Time
     C                     MOVELBDAYNA    $JAYNA           User Id
     C                     MOVELBDA0NA    $JA0NA           Job Name
     C                     Z-ADDBDAXDT    $JAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP03  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDBDAIC3    $KAIC3           Company Number
     C                     Z-ADDBDCONB    $KCONB           Invoice Number
     C                     MOVELBDCEST    $KCEST           Invoice Suffix
     C                     MOVELBDUHCD    $KUHCD           Adjustment Type
     C                     Z-ADDBDBSVA    $KBSVA           Transaction Amo
     C                     Z-ADDBDAIVA    $KAIVA           Adjustment Amou
     C                     Z-ADDBDAOVA    $KAOVA           Amount Paid
     C                     Z-ADDBDBGVA    $KBGVA           Remaining Balan
     C                     MOVELBDAJST    $KAJST           A/R Processing
     C                     MOVELBDE3ST    $KE3ST           Purge Status
     C                     MOVELBDG4CD    $KG4CD           Bank Code
     C                     Z-ADDBDCKNB    $KCKNB           G/L Document Nu
     C                     Z-ADDBDCAC7    $KCAC7           Order Number Re
     C                     Z-ADDBDBKC7    $KBKC7           Ship To Custome
     C                     MOVELBDBCCD    $KBCCD           Salesperson Cod
     C                     MOVELBDR4CD    $KR4CD           Sales Route Cod
     C                     Z-ADDBDB4DT    $KB4DT           Transaction Dat
     C                     Z-ADDBDATDT    $KATDT           Due Date
     C                     MOVEL*BLANK    $KPOXX           P.O. Number. .
     C                     Z-ADD*ZERO     $KVIVA           Age $ Due-Curre
     C                     Z-ADD*ZERO     $KVJVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     $KVKVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     $KVLVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     $KVMVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     $KVNVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     $KAGVA           Age $ Due - Cur
     C                     Z-ADD*ZERO     $KACVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     $KADVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     $KAEVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     $KAFVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     $KAHVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     $KCKVA           USR Credit Amou
     C                     Z-ADD*ZERO     $KBFNB           USR Credit Amou
     C                     Z-ADDBDH0DT    $KH0DT           Last Payment Da
     C                     Z-ADDBDH3DT    $KH3DT           Unused Date Cod
     C                     Z-ADDBDH4DT    $KH4DT           Paid in Full Da
     C                     Z-ADDBDH5DT    $KH5DT           Last G/L Post D
     C                     Z-ADDBDANC7    $KANC7           A/R Customer Nu
     C                     MOVELBDCPTX    $KCPTX           A/R Check Numbe
     C                     Z-ADDBDBSDY    $KBSDY           Days to Pay
     C                     MOVELBDUVST    $KUVST           EDI Status 1
     C                     MOVELBDUWST    $KUWST           EDI Status 2
     C                     MOVELBDUXST    $KUXST           EDI Status 3
     C                     Z-ADDBDAATM    $KAATM           Job Time
     C                     MOVELBDAYNA    $KAYNA           User Id
     C                     MOVELBDA0NA    $KA0NA           Job Name
     C                     Z-ADDBDAXDT    $KAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
     C                     ADD  $KVIVA    $LVZVA           USR Tot. Curren
     C                     ADD  $KVJVA    $LVUVA           USR Tot. Age 1
     C                     ADD  $KVKVA    $LVVVA           USR Tot. Age 2
     C                     ADD  $KVLVA    $LVWVA           USR Tot. Age 3
     C                     ADD  $KVMVA    $LVXVA           USR Tot. Age 4
     C                     ADD  $KVNVA    $LVYVA           USR Tot. Age 5
     C                     ADD  $KCKVA    $LV0VA           USR Tot. Credit
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN BDAIC3    WZB001           Company Number
     C                     Z-ADDBDAIC3    WZB001
     C           *LIKE     DEFN BDANC7    WZB002           A/R Customer Nu
     C                     Z-ADDBDANC7    WZB002
     C           *LIKE     DEFN BDCONB    WZB003           Invoice Number
     C                     Z-ADDBDCONB    WZB003
     C           *LIKE     DEFN BDCEST    WZB004           Invoice Suffix
     C                     MOVELBDCEST    WZB004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@BDCPGB                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * There is a balance Due
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Remaining Balance Due is not equal to zeros
      *   |- c2    : DB1.Invoice Suffix is All Except Chargebacks
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           BDBGVA    IFNE *ZERO                      *IF
     C           BDCEST    IFEQ 'CM'                       *IF
     C           BDCEST    OREQ 'DM'
     C           BDCEST    OREQ 'IN'
     C           BDCEST    OREQ 'NA'
     C           BDCEST    OREQ 'OA'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        Company Number
     C                     MOVEL*BLANK    W0BL01  1        A/R Customer Nu
     C                     MOVEL*BLANK    W0BL02  1        Invoice Number
     C                     MOVEL*BLANK    W0BL03  1        Invoice Suffix
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        A/R Customer Nu
     C                     MOVEL'Y'       W0BL02  1        Invoice Number
     C                     MOVEL'Y'       W0BL03  1        Invoice Suffix
     C                     ELSE
      * Next record - Detect level breaks
     C           BDAIC3    IFNE WZB001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           BDANC7    IFNE WZB002                     A/R Customer Nu
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           BDCONB    IFNE WZB003                     Invoice Number
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C           BDCEST    IFNE WZB004                     Invoice Suffix
     C           W0BL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL03
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP03
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of A/R Customer Number format
     C                     Z-ADD$LVZVA    $LV5VA           USR Tot. Curren
     C                     Z-ADD$LVUVA    $LV1VA           USR Tot. Age 1
     C                     Z-ADD$LVVVA    $LV2VA           USR Tot. Age 2
     C                     Z-ADD$LVWVA    $LV3VA           USR Tot. Age 3
     C                     Z-ADD$LVXVA    $LV4VA           USR Tot. Age 4
     C                     Z-ADD$LVYVA    $LV6VA           USR Tot. Age 5
     C           *ZERO     SUB  $LV0VA    WN0011           USR Cash Appl A
     C           $LV6VA    SUB  WN0011    WN0012           Aging Amount pa
      * Apply credit to Aged Values for invoices
      * CASE: PAR.Aging Amount past Buckt 2 GE PAR.USR Work Amount 1
     C           WN0012    IFGE WN0026                     *IF
     C                     Z-ADDWN0012    $LV6VA           USR Tot. Age 5
     C                     Z-ADD*ZERO     WN0012           Aging Amount pa
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Aging Amount past Buckt 2 LE PAR.USR Work Amount 1
     C           WN0012    IFLE WN0026                     *IF
     C                     Z-ADD*ZERO     $LV6VA           USR Tot. Age 5
     C           *ZERO     SUB  WN0012    WN0012           Aging Amount pa
     C           $LV4VA    SUB  WN0012    WN0012           Aging Amount pa
      * CASE: PAR.Aging Amount past Buckt 2 GE PAR.USR Work Amount 1
     C           WN0012    IFGE WN0026                     *IF
     C                     Z-ADDWN0012    $LV4VA           USR Tot. Age 4
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Aging Amount past Buckt 2 LT PAR.USR Work Amount 1
     C           WN0012    IFLT WN0026                     *IF
     C                     Z-ADD*ZERO     $LV4VA           USR Tot. Age 4
     C           *ZERO     SUB  WN0012    WN0012           Aging Amount pa
     C           $LV3VA    SUB  WN0012    WN0012           Aging Amount pa
      * CASE: PAR.Aging Amount past Buckt 2 GE PAR.USR Work Amount 1
     C           WN0012    IFGE WN0026                     *IF
     C                     Z-ADDWN0012    $LV3VA           USR Tot. Age 3
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Aging Amount past Buckt 2 LT PAR.USR Work Amount 1
     C           WN0012    IFLT WN0026                     *IF
     C                     Z-ADD*ZERO     $LV3VA           USR Tot. Age 3
     C           *ZERO     SUB  WN0012    WN0012           Aging Amount pa
     C           $LV2VA    SUB  WN0012    WN0012           Aging Amount pa
      * CASE: PAR.Aging Amount past Buckt 2 GE PAR.USR Work Amount 1
     C           WN0012    IFGE WN0026                     *IF
     C                     Z-ADDWN0012    $LV2VA           USR Tot. Age 2
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Aging Amount past Buckt 2 LT PAR.USR Work Amount 1
     C           WN0012    IFLT WN0026                     *IF
     C                     Z-ADD*ZERO     $LV2VA           USR Tot. Age 2
     C           *ZERO     SUB  WN0012    WN0012           Aging Amount pa
     C           $LV1VA    SUB  WN0012    WN0012           Aging Amount pa
      * CASE: PAR.Aging Amount past Buckt 2 GE PAR.USR Work Amount 1
     C           WN0012    IFGE WN0026                     *IF
     C                     Z-ADDWN0012    $LV1VA           USR Tot. Age 1
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     $LV1VA           USR Tot. Age 1
     C                     ADD  WN0012    $LV5VA           USR Tot. Curren
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           $LV6VA    ADD  $LV4VA    $LV7VA           USR Total Due
     C                     ADD  $LV3VA    $LV7VA           USR Total Due
     C                     ADD  $LV2VA    $LV7VA           USR Total Due
     C                     ADD  $LV1VA    $LV7VA           USR Total Due
     C                     ADD  $LV5VA    $LV7VA           USR Total Due
     C                     Z-ADD$LV5VA    P2E5VA           USR Age Current
     C                     Z-ADD$LV1VA    P2E0VA           USR Age Value 1
     C                     Z-ADD$LV2VA    P2E1VA           USR Age Value 2
     C                     Z-ADD$LV3VA    P2E2VA           USR Age Value 3
     C                     Z-ADD$LV4VA    P2E3VA           USR Age Value 4
     C                     Z-ADD$LV6VA    P2E4VA           USR Age Value 5
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 4
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Convert A/R Customer Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $LANC7    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$LANC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VLANC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VLANC7           CD7 Ext Numeric
     C                     END                             *FI
      * Print format
     C                     WRITE$LKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$MFINTTL
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of PRT Aging by Inv Nite  ZZ
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of PRT Aging by Inv Nite  ZZ
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Print format
     C                     WRITE$C1STPAG
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Customer Name of PRT Aging by Inv Nite  ZZ
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print Ship To Customer of PRT Aging by Inv Nite  ZZ
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Convert fields to external form
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $DBKC7    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$DBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VDBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDBKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Date of Last Payment to display format
      * Convert date
     C           1000000   ADD  $DALDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDALDT
      * Convert Date of Highest A/R Bal. to display format
      * Convert date
     C           1000000   ADD  $DAIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDAIDT
      * Convert Parent Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $DBTC7    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$DBTC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VDBTC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDBTC7           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL'0'       *IN79
     C           WUD4ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$DKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print Detail line. of PRT Aging by Inv Nite  ZZ
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$ECOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$EDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of PRT Nite Age by Inv    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$F1STPAG
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print Company Number of PRT Nite Age by Inv    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$GKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print A/R Customer Number of PRT Nite Age by Inv    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * USER: On print of A/R Customer Number format
     C                     Z-ADD*ZERO     P2E5VA           USR Age Current
     C                     Z-ADD*ZERO     P2E0VA           USR Age Value 1
     C                     Z-ADD*ZERO     P2E1VA           USR Age Value 2
     C                     Z-ADD*ZERO     P2E3VA           USR Age Value 4
     C                     Z-ADD*ZERO     P2E4VA           USR Age Value 5
      * Mention hidden format
     C   99N99             WRITE$HKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print Invoice Number of PRT Nite Age by Inv    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$IKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print Invoice Suffix of PRT Nite Age by Inv    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP03    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$JKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0BP03
     C                     END                             FI
      * Print Detail line. of PRT Nite Age by Inv    PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * Purchase order numbers were retreived for INV and DM only
      *     This was changed 6/26/96 by call number 1433.  Now gets for a
     C                     MOVEL*BLANK    $KPOXX           P.O. Number. .
     C                     MOVEL*BLANK    WUBCNA           Customer Purcha
      * RTV Purchase Order     RT - OP Order Header  * 
     C                     EXSR SIRVGN
     C                     MOVELWUBCNA    $KPOXX           P.O. Number. .
      * Clear all Aging related fields
     C                     Z-ADD*ZERO     WN0018           USR Age Value 1
     C                     Z-ADD*ZERO     WN0019           USR Age Value 2
     C                     Z-ADD*ZERO     WN0020           USR Age Value 3
     C                     Z-ADD*ZERO     WN0021           USR Age Value 4
     C                     Z-ADD*ZERO     WN0022           USR Age Value 5
     C                     Z-ADD*ZERO     WN0024           USR Age Current
     C                     Z-ADD*ZERO     $KVIVA           Age $ Due-Curre
     C                     Z-ADD*ZERO     $KVJVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     $KVKVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     $KVLVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     $KVMVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     $KVNVA           Age $ Due-Aging
      * Compute Aging Day Ranges
      * RTV A/R Aging info     RT - Company Control  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0003           Company Number
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0004    WN0007           A/R Aging Days
     C                     Z-ADDWL0005    WN0008           A/R Aging Days
     C                     Z-ADDWL0006    WN0009           A/R Aging Days
     C                     Z-ADDWL0007    WN0010           A/R Aging Days
      * Current Date as Julian
      * PAR.USR Aging date - 1 = DB1.Due Date + PAR.A/R Aging Days - 1 *D
     C           BDATDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0007    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0013
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0013
     C                     END
      * PAR.USR Aging date - 2 = DB1.Due Date + PAR.A/R Aging Days - 2 *D
     C           BDATDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0008    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0014
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0014
     C                     END
      * PAR.USR Aging date - 3 = DB1.Due Date + PAR.A/R Aging Days - 3 *D
     C           BDATDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0009    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0015
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0015
     C                     END
      * PAR.USR Aging date - 4 = DB1.Due Date + PAR.A/R Aging Days - 4 *D
     C           BDATDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0010    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0016
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0016
     C                     END
     C                     Z-ADDWN0016    WN0017           USR Aging date
      * Age Invoices and Debit Memos
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Invoice Suffix is Invoices
      *   |- c2    : DB1.Invoice Suffix is Debit Memos
      *   '-
     C           BDCEST    IFEQ 'IN'                       *IF
     C           BDCEST    OREQ 'DM'                       *OR
      * Current Due for Inv DM
      * CASE: JOB.*Job date LE DB1.Due Date
     C           ##JDT     IFLE BDATDT                     *IF
     C                     ADD  BDBGVA    WN0024           USR Age Current
     C                     END                             *FI
      * Past Due Date 1 for INV and CM
      * CASE:
      *  - c1 AND c2
      *   |- c1    : JOB.*Job date GT DB1.Due Date
      *   |- c2    : JOB.*Job date LE PAR.USR Aging date - 1
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           ##JDT     IFGT BDATDT                     *IF
     C           ##JDT     IFLE WN0013                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  BDBGVA    WN0018           USR Age Value 1
     C                     END                             *FI
      * Past Due 2 for INV and DM
      * CASE:
      *  - c1 AND c2
      *   |- c1    : JOB.*Job date GT PAR.USR Aging date - 1
      *   |- c2    : JOB.*Job date LE PAR.USR Aging date - 2
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           ##JDT     IFGT WN0013                     *IF
     C           ##JDT     IFLE WN0014                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  BDBGVA    WN0019           USR Age Value 2
     C                     END                             *FI
      * Past Due date 3 for INV and DM
      * CASE:
      *  - c1 AND c2
      *   |- c1    : JOB.*Job date GT PAR.USR Aging date - 2
      *   |- c2    : JOB.*Job date LE PAR.USR Aging date - 3
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           ##JDT     IFGT WN0014                     *IF
     C           ##JDT     IFLE WN0015                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  BDBGVA    WN0020           USR Age Value 3
     C                     END                             *FI
      * Aging Value 4 for INV and DM
      * CASE:
      *  - c1 AND c2
      *   |- c1    : JOB.*Job date GT PAR.USR Aging date - 3
      *   |- c2    : JOB.*Job date LE PAR.USR Aging date - 4
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           ##JDT     IFGT WN0015                     *IF
     C           ##JDT     IFLE WN0016                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  BDBGVA    WN0021           USR Age Value 4
     C                     END                             *FI
      * Age 5 is anything over date 4 for INV and DM
      * CASE: JOB.*Job date GT PAR.USR Aging date - 4
     C           ##JDT     IFGT WN0016                     *IF
     C                     ADD  BDBGVA    WN0022           USR Age Value 5
     C                     END                             *FI
     C                     END                             *FI
      * Accumilate Credits to apply
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Invoice Suffix is Credit Memos
      *   |- c2    : DB1.Invoice Suffix is On Account Cash
      *   '-
     C           BDCEST    IFEQ 'CM'                       *IF
     C           BDCEST    OREQ 'OA'                       *OR
     C                     ADD  BDBGVA    WN0023           USR Total Credi
     C                     Z-ADD*ZERO     WN0025           Number Value -
     C           WN0025    SUB  WN0023    $KCKVA           USR Credit Amou
     C                     Z-ADD*ZERO     WN0023           USR Total Credi
     C                     END                             *FI
     C                     Z-ADD*ZERO     WN0026           USR Work Amount
      * Apply Credits to Oldest Inv. without CB
     C                     Z-ADDWN0024    $KVIVA           Age $ Due-Curre
     C                     Z-ADDWN0018    $KVJVA           Age $ Due-Aging
     C                     Z-ADDWN0019    $KVKVA           Age $ Due-Aging
     C                     Z-ADDWN0020    $KVLVA           Age $ Due-Aging
     C                     Z-ADDWN0021    $KVMVA           Age $ Due-Aging
     C                     Z-ADDWN0022    $KVNVA           Age $ Due-Aging
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Order Number Ref to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $KCAC7    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$KCAC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VKCAC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VKCAC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Due Date to display format
      * Convert date
     C           1000000   ADD  $KATDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VKATDT
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$KCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$KDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of PRT Aging by Inv Nite  ZZ
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  1         W0FSUM
     C                     END                             FI
      *
      * * Customer Name of PRT Aging by Inv Nite  ZZ
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Ship To Customer of PRT Aging by Inv Nite  ZZ
     C           W0AP01    IFEQ 'Y'
     C                     ADD  3         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Aging by Inv Nite  ZZ
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PRT Nite Age by Inv    PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of PRT Nite Age by Inv    PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * A/R Customer Number of PRT Nite Age by Inv    PO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Invoice Number of PRT Nite Age by Inv    PO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Invoice Suffix of PRT Nite Age by Inv    PO
     C           W0BP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PRT Nite Age by Inv    PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    $BAPTX    P      Name
      * RTV Aging Heading Info RT - A/R Summary  * 
     C                     EXSR SDRVGN
      * RTV A/R Aging info     RT - Company Control  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0003           Company Number
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0004    WUAEDY           A/R Aging Days
     C                     Z-ADDWL0005    WUAFDY           A/R Aging Days
     C                     Z-ADDWL0006    WUAGDY           A/R Aging Days
     C                     Z-ADDWL0007    WUAHDY           A/R Aging Days
     C                     Z-ADDP1AIC3    $BAIC3           Company Number
     C                     Z-ADDWUAEDY    $BAGHA           USR Age Heading
     C           $BAGHA    ADD  1         $BAGHB           USR Age Heading
     C                     Z-ADDWUAFDY    $BAGHC           USR Age Heading
     C           $BAGHC    ADD  1         $BAGHD           USR Age Heading
     C                     Z-ADDWUAGDY    $BAGHE           USR Age Heading
     C           $BAGHE    ADD  1         $BAGHF           USR Age Heading
     C                     Z-ADDWUAHDY    $BAGHG           USR Age Heading
     C                     Z-ADDWUAHDY    $BAGHH           USR Age Heading
      * Convert fields to external form
      * Convert Date of Last Aging to display format
      * Convert date
     C           1000000   ADD  $BDUDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBDUDT
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $BAIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$BAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VBAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBAIC3           CD3 Ext Numeric
     C                     END                             *FI
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSA01           Application Cod
     C                     MOVEL'A/R'     WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0001    ABAIC3           Company Number
      * Establish starting position
     C           KRSSC     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Name
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    WL0002           Name
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Aging Heading Info RT - A/R Summary  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BCAIC3    WQSD01           Company Number
      * Define keylist
     C           KPSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           BCANC7           A/R Customer Nu
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSD01           Company Number
     C                     Z-ADD*ZERO     BCANC7           A/R Customer Nu
      * Establish starting position
     C           KPSSD     SETLL@BCREFE                    *
     C           KRSSD     READE@BCREFE                  90*
      * Data record not found
     C   90                MOVEL'USR0172' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBCAKTM    $BAKTM           Time of Last Ag
     C                     Z-ADDBCDUDT    $BDUDT           Date of Last Ag
     C                     GOTO SDEXIT                     *QUIT
     C           KRSSD     READE@BCREFE                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV A/R Aging info     RT - Company Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           ASAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0003    ASAIC3           Company Number
      * Establish starting position
     C           KRSSE     CHAIN@ASREGT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0049' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0004           A/R Aging Days
     C                     Z-ADD*ZERO     WL0005           A/R Aging Days
     C                     Z-ADD*ZERO     WL0006           A/R Aging Days
     C                     Z-ADD*ZERO     WL0007           A/R Aging Days
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDASAEDY    WL0004           A/R Aging Days
     C                     Z-ADDASAFDY    WL0005           A/R Aging Days
     C                     Z-ADDASAGDY    WL0006           A/R Aging Days
     C                     Z-ADDASAHDY    WL0007           A/R Aging Days
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Alpha Age by Inv   RT - A/R Summary  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WAANC7    WQSF02           A/R Customer Nu
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           A/R Customer Nu
      * Setup key
     C                     Z-ADDWL0008    WQSF01           Company Number
     C                     Z-ADDWL0009    WQSF02           A/R Customer Nu
      * Establish starting position
     C           KRSSF     SETLL@BCREEJ                    *
     C           KRSSF     READE@BCREEJ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0172' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAVIVA    WL0010           Age $ Due-Curre
     C                     Z-ADDWAVJVA    WL0011           Age $ Due-Aging
     C                     Z-ADDWAVKVA    WL0012           Age $ Due-Aging
     C                     Z-ADDWAVLVA    WL0013           Age $ Due-Aging
     C                     Z-ADDWAVMVA    WL0014           Age $ Due-Aging
     C                     Z-ADDWAVNVA    WL0015           Age $ Due-Aging
     C                     Z-ADDWAALDT    WL0016           Date of Last Pa
     C                     Z-ADDWAAIDT    WL0017           Date of Highest
     C                     Z-ADDWAALVA    WL0018           Amount of Highe
     C                     Z-ADDWADUDT    WL0019           Date of Last Ag
     C                     Z-ADDWAADPM    WL0020           MTD Invoices Pa
     C                     Z-ADDWAVOVA    WL0021           YTD Invoices Pa
     C                     Z-ADDWABTDY    WL0022           MTD Days Paid
     C                     Z-ADDWABUDY    WL0023           YTD Days Paid
     C                     Z-ADDWAVPVA    WL0024           YTD Sales Invoi
     C           KRSSF     READE@BCREEJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Cust Age Inv Nite  RT - Company/Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           EOAIC3           Company Number
     C                     KFLD           EOBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDP1AIC3    EOAIC3           Company Number
     C                     Z-ADD$DANC7    EOBKC7           Ship To Custome
      * Establish starting position
     C           KRSSG     CHAIN@EOREUB              90    *
      * Data record not found
     C   90                MOVEL'USR1007' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELEONJNA    $DNJNA           Credit Contact
     C                     MOVELEOI0TX    $DI0TX           Credit Contact
     C                     MOVELEOI1TX    $DI1TX           Credit Contact
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Credit Limits,Name RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADD$DBTC7    WBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSH     CHAIN@BBREWG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBAYTX    $DK2TX           Customer Name
     C                     Z-ADDWBBTC7    WUNFNN           Parent Customer
     C                     MOVELWBK6ST    WUG0TX           Credit Check A/
     C                     MOVELWBUZST    WUG0TX           Credit Check Pa
     C                     Z-ADDWBS2NB    $DS2NB           Parent Credit L
     C                     Z-ADDWBVHVA    WUNFNN           A/R Credit Limi
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Purchase Order     RT - OP Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    BEAIC3           Company Number
     C                     Z-ADDBDCAC7    BEC4NB           Order Number
      * Establish starting position
     C           KRSSI     CHAIN@BFCPZ9              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEBCNA    WUBCNA           Customer Purcha
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PRT Nite Age by Inv    PO
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001 112       Age $ Due-Curre
     C                     Z-ADD*ZERO     WN0002 112       Age $ Due-Aging
     C                     Z-ADD*ZERO     WN0003 112       Age $ Due-Aging
     C                     Z-ADD*ZERO     WN0004 112       Age $ Due-Aging
     C                     Z-ADD*ZERO     WN0005 112       Age $ Due-Aging
     C                     Z-ADD*ZERO     WN0006 112       Age $ Due-Aging
     C                     Z-ADD*ZERO     WN0007  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0008  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0009  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0010  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0011 112       USR Cash Appl A
     C                     Z-ADD*ZERO     WN0012 112       Aging Amount pa
     C                     Z-ADD*ZERO     WN0013  70       USR Aging date
     C                     Z-ADD*ZERO     WN0014  70       USR Aging date
     C                     Z-ADD*ZERO     WN0015  70       USR Aging date
     C                     Z-ADD*ZERO     WN0016  70       USR Aging date
     C                     Z-ADD*ZERO     WN0017  70       USR Aging date
     C                     Z-ADD*ZERO     WN0018 112       USR Age Value 1
     C                     Z-ADD*ZERO     WN0019 112       USR Age Value 2
     C                     Z-ADD*ZERO     WN0020 112       USR Age Value 3
     C                     Z-ADD*ZERO     WN0021 112       USR Age Value 4
     C                     Z-ADD*ZERO     WN0022 112       USR Age Value 5
     C                     Z-ADD*ZERO     WN0023 112       USR Total Credi
     C                     Z-ADD*ZERO     WN0024 112       USR Age Current
     C                     Z-ADD*ZERO     WN0025  70       Number Value -
     C                     Z-ADD*ZERO     WN0026 112       USR Work Amount
      *
      * PRT Nite Age by Inv    PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1AGVA           Age $ Due - Cur
     C                     Z-ADD*ZERO     P1ACVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     P1ADVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     P1AEVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     P1AFVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     P1AHVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     P1VIVA           Age $ Due-Curre
     C                     Z-ADD*ZERO     P1VJVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     P1VKVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     P1VLVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     P1VMVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     P1VNVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     P1AKTM           Time of Last Ag
     C                     Z-ADD*ZERO     P1ALDT           Date of Last Pa
     C                     Z-ADD*ZERO     P1AIDT           Date of Highest
     C                     Z-ADD*ZERO     P1ALVA           Amount of Highe
     C                     Z-ADD*ZERO     P1DUDT           Date of Last Ag
     C                     Z-ADD*ZERO     P1ADPM           MTD Invoices Pa
     C                     Z-ADD*ZERO     P1VOVA           YTD Invoices Pa
     C                     Z-ADD*ZERO     P1BTDY           MTD Days Paid
     C                     Z-ADD*ZERO     P1BUDY           YTD Days Paid
     C                     Z-ADD*ZERO     P1VPVA           YTD Sales Invoi
     C                     Z-ADD*ZERO     P2E5VA           USR Age Current
     C                     Z-ADD*ZERO     P2E0VA           USR Age Value 1
     C                     Z-ADD*ZERO     P2E1VA           USR Age Value 2
     C                     Z-ADD*ZERO     P2E2VA           USR Age Value 3
     C                     Z-ADD*ZERO     P2E3VA           USR Age Value 4
     C                     Z-ADD*ZERO     P2E4VA           USR Age Value 5
     C                     Z-ADD*ZERO     P2WBVA           USR Tot. Due W/
     C                     Z-ADD*ZERO     P2WAVA           USR Tot. Due wi
     C                     Z-ADD*ZERO     P2EDPC           Tot. Current %
     C                     Z-ADD*ZERO     P2EEPC           Tot. Age 1 % Ca
     C                     Z-ADD*ZERO     P2EFPC           Tot. Age 2 % Ca
     C                     Z-ADD*ZERO     P2EGPC           Tot. Age 3 % Ca
     C                     Z-ADD*ZERO     P2EHPC           Tot. Age 4 % Ca
     C                     Z-ADD*ZERO     P2EIPC           Tot. Age 5 % Ca
     C                     Z-ADD*ZERO     P3BTC7           Parent Customer
     C                     Z-ADD*ZERO     P3VHVA           A/R Credit Limi
     C                     MOVEL*BLANK    P4NJNA           Credit Contact
     C                     MOVEL*BLANK    P4I0TX           Credit Contact
     C                     MOVEL*BLANK    P4I1TX           Credit Contact
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    BBAYTX           Customer Name
     C                     MOVEL*LOVAL    BBBKC7           Ship To Custome
      * Define work field A/R Aging Days - 1
     C                     Z-ADD*ZERO     WUAEDY  30
      * Define work field A/R Aging Days - 2
     C                     Z-ADD*ZERO     WUAFDY  30
      * Define work field A/R Aging Days - 3
     C                     Z-ADD*ZERO     WUAGDY  30
      * Define work field A/R Aging Days - 4
     C                     Z-ADD*ZERO     WUAHDY  30
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WAAGVA           Age $ Due - Cur
     C                     Z-ADD*ZERO     WAACVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WAADVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WAAEVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WAAFVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WAAHVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WAVIVA           Age $ Due-Curre
     C                     Z-ADD*ZERO     WAVJVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WAVKVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WAVLVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WAVMVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WAVNVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WAEEVA           Value of Open O
     C                     Z-ADD*ZERO     WAAKTM           Time of Last Ag
     C                     Z-ADD*ZERO     WAAHDT           Date of First S
     C                     Z-ADD*ZERO     WAANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WAANVA           Amount of Last
     C                     Z-ADD*ZERO     WAALDT           Date of Last Pa
     C                     Z-ADD*ZERO     WAAMVA           Amount of Last
     C                     Z-ADD*ZERO     WAAIDT           Date of Highest
     C                     Z-ADD*ZERO     WAALVA           Amount of Highe
     C                     Z-ADD*ZERO     WADJNB           Number of Invoi
     C                     Z-ADD*ZERO     WADLNB           Number of Order
     C                     Z-ADD*ZERO     WADDNB           Number of Credi
     C                     Z-ADD*ZERO     WADMNB           Number of Payme
     C                     Z-ADD*ZERO     WADUDT           Date of Last Ag
     C                     Z-ADD*ZERO     WALYNO           Last YTD Nbr of
     C                     Z-ADD*ZERO     WALYNC           Last YTD Nbr of
     C                     Z-ADD*ZERO     WALYNP           Last YTD Nbr of
     C                     Z-ADD*ZERO     WALYNI           Last YTD Nbr of
     C                     Z-ADD*ZERO     WAADPM           MTD Invoices Pa
     C                     Z-ADD*ZERO     WAVOVA           YTD Invoices Pa
     C                     Z-ADD*ZERO     WABTDY           MTD Days Paid
     C                     Z-ADD*ZERO     WABUDY           YTD Days Paid
     C                     Z-ADD*ZERO     WAVPVA           YTD Sales Invoi
     C                     Z-ADD*ZERO     WAVQVA           Last Year Sales
     C                     Z-ADD*ZERO     WACUMO           Current Month
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBP3NB           D & B Number
     C                     Z-ADD*ZERO     WBI6DT           Date of D & B R
     C                     Z-ADD*ZERO     WBAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBTC7           Parent Customer
     C                     Z-ADD*ZERO     WBS2NB           Parent Credit L
     C                     Z-ADD*ZERO     WBVHVA           A/R Credit Limi
     C                     Z-ADD*ZERO     WBI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field USR Flag 1
     C                     MOVEL*BLANK    WUD4ST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    BDAIC3           Company Number
     C                     MOVEL*LOVAL    BDANC7           A/R Customer Nu
     C                     MOVEL*LOVAL    BDCONB           Invoice Number
     C                     MOVEL*LOVAL    BDCEST           Invoice Suffix
      * Define work field Customer Purchase Order #
     C                     MOVEL*BLANK    WUBCNA 15
      * Define work field USR Tot. Current
     C                     Z-ADD*ZERO     WUVZVA 112
      * Define work field USR Tot. Age 1
     C                     Z-ADD*ZERO     WUVUVA 112
      * Define work field USR Tot. Age 2
     C                     Z-ADD*ZERO     WUVVVA 112
      * Define work field USR Tot. Age 3
     C                     Z-ADD*ZERO     WUVWVA 112
      * Define work field USR Tot. Age 4
     C                     Z-ADD*ZERO     WUVXVA 112
      * Define work field USR Tot. Age 5
     C                     Z-ADD*ZERO     WUVYVA 112
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002 30
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  30
     C                     Z-ADD*ZERO     WL0005  30
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  30
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0008  30
     C                     Z-ADD*ZERO     WL0009  70
     C                     Z-ADD*ZERO     WL0010 112
     C                     Z-ADD*ZERO     WL0011 112
     C                     Z-ADD*ZERO     WL0012 112
     C                     Z-ADD*ZERO     WL0013 112
     C                     Z-ADD*ZERO     WL0014 112
     C                     Z-ADD*ZERO     WL0015 112
     C                     Z-ADD*ZERO     WL0016  70
     C                     Z-ADD*ZERO     WL0017  70
     C                     Z-ADD*ZERO     WL0018 112
     C                     Z-ADD*ZERO     WL0019  70
     C                     Z-ADD*ZERO     WL0020  50
     C                     Z-ADD*ZERO     WL0021  50
     C                     Z-ADD*ZERO     WL0022  50
     C                     Z-ADD*ZERO     WL0023  50
     C                     Z-ADD*ZERO     WL0024 112
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * ARS039 - 11/21/96 - S. Schertz
      * Print *HOLD* for customers who have the Order Entry Hold Flag in
      * customer record set to 'Y'.
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * Move Appl Desc to Prt co - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$BAIC3    WL0001           Company Number
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    $BAPTX    P      Name
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
