             PGM        PARM(&COMPANY &PYMTDATE &PYMTSTEP &REPAY +
                          &HPELIB)

             DCL        VAR(&RETURN)   TYPE(*CHAR) LEN(7)
             DCL        VAR(&COMPANY)  TYPE(*DEC)  LEN(3 0)
             DCL        VAR(&PYMTDATE) TYPE(*DEC)  LEN(7 0)
             DCL        VAR(&PYMTSTEP) TYPE(*DEC)  LEN(5 0)
             DCL        VAR(&REPAY)    TYPE(*CHAR) LEN(1)
             DCL        VAR(&HPELIB)   TYPE(*CHAR) LEN(10)
             DCL        VAR(&RMVLIB)   TYPE(*CHAR) LEN(1)

             /* Default Remove Library flag to 'Y'  */
             CHGVAR     VAR(&RMVLIB) VALUE('Y')

             /* Add company library to library list */
             ADDLIBLE   LIB(&HPELIB)

             /* If library already in library list, set RMVLIB to 'N' */
             MONMSG     MSGID(CPF2103) EXEC(CHGVAR VAR(&RMVLIB) +
                          VALUE('N'))

             /* Retrieve Payment Processing Parm values for company   */
             CALL       PGM(PWIOXFR) PARM(&RETURN &COMPANY &PYMTDATE +
                          &PYMTSTEP &REPAY)

             /* If Remove Library flag is 'Y', remove from library list */
             IF         COND(&RMVLIB = 'Y') THEN(RMVLIBLE LIB(&HPELIB))

             ENDPGM
