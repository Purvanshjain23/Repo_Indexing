// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for POYXXFR
// ?Date: 14.08.2025 Time: 03:39:35
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(RTV Day of Week No.   RT) TYPE(RTVOBJ) FILE(CAAFREP)           AC1658821;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Scheduled_Ship_Date);
PARAMETER(LCL.Day_of_Week);
{
 //?USER: Process Data record

 // PGM.*Return code = CND.*Normal
 PGM.*Return_code = *BLANK;

 MOVE *ALL (To: PAR From: DB1);

}


CASE;

// IF LCL.Day of Week is Monday
IF LCL.Day_of_Week = '2';

// LCL.Date Mon USR = PAR.Scheduled Ship Date
LCL.Date_Mon_USR = PAR.Scheduled_Ship_Date;

// IF *OTHERWISE
IF *OTHERWISE;

EXECUTE FUNCTION(Rtv Prior Monday      RT) TYPE(RTVOBJ) FILE(CAAFREP)           AC1674394;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Scheduled_Ship_Date);
PARAMETER(LCL.Date_Mon_USR);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 CASE;

 // IF DB1.Day of Week is Monday
 IF DB1.Day_of_Week = '2';

 // PAR.Date Mon USR = DB1.Post to G/L Date
 PAR.Date_Mon_USR = DB1.Post_to_G_L_Date;

 QUIT;

 ENDIF;

}


ENDIF;

CASE;

// IF LCL.Day of Week is Sunday
IF LCL.Day_of_Week = '1';

// LCL.Date Sun USR = PAR.Scheduled Ship Date
LCL.Date_Sun_USR = PAR.Scheduled_Ship_Date;

// IF *OTHERWISE
IF *OTHERWISE;

EXECUTE FUNCTION(RTV Next Sunday        RT) TYPE(RTVOBJ) FILE(CAAFREP)          AC1672814;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Scheduled_Ship_Date);
PARAMETER(LCL.Date_Sun_USR);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 CASE;

 // IF DB1.Day of Week is Sunday
 IF DB1.Day_of_Week = '1';

 // PAR.Scheduled Ship Date = DB1.Post to G/L Date
 PAR.Scheduled_Ship_Date = DB1.Post_to_G_L_Date;

 QUIT;

 ENDIF;

}


ENDIF;

EXECUTE FUNCTION(Rtv Week Number       RT) TYPE(RTVOBJ) FILE(CAAFREP)           AC1386894;
PARAMETER(PAR.Company_Number);
PARAMETER(LCL.Date_Mon_USR);
PARAMETER(LCL.ERS_Accounting_Year_Code);
PARAMETER(LCL.ERS_Week_Number);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


EXECUTE FUNCTION(RTV Crt Exp Sum Week   RT) TYPE(RTVOBJ) FILE(OPBFCPP)          AC1674390;
PARAMETER(PAR.Company_Number);
PARAMETER(LCL.Date_Mon_USR);
PARAMETER(LCL.Date_Mon_USR);
PARAMETER(LCL.Date_Sun_USR);
PARAMETER(LCL.ERS_Weight_Ordered_Total);
{
 //?USER: Initialize routine

 // PAR.ERS Weight Ordered Total = CON.*ZERO
 PAR.ERS_Weight_Ordered_Total = *ZERO;

 //?USER: Process Data record

 CASE;

 // IF DB1.Scheduled Ship Date GE PAR.ERS Sched Ship Date From
 IF DB1.Scheduled_Ship_Date >= PAR.ERS_Sched_Ship_Date_From;

 // AND DB1.Scheduled Ship Date LE PAR.ERS Sched Ship Date To
 AND DB1.Scheduled_Ship_Date <= PAR.ERS_Sched_Ship_Date_To;

 CASE;

 // IF DB1.Order Type - Sales is Regular Order
 IF DB1.Order_Type_Sales = 'OR';

 // AND DB1.Export Status is yes
 AND DB1.Export_Status = 'Y';

 EXECUTE FUNCTION(Rtv Crt Exp Sum Weekly RT) TYPE(RTVOBJ) FILE(OPBGWKP)          AC1674391;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(PAR.ERS_Weight_Ordered_Total);
 {
  //?USER: Process Data record

  CASE;

  // IF DB1.Item Structure Type Code is Cooked Products
  IF DB1.Item_Structure_Type_Code = 200;

  // PAR.ERS Weight Ordered Total = PAR.ERS Weight Ordered Total + DB1.Weight Ordered
  PAR.ERS_Weight_Ordered_Total = PAR.ERS_Weight_Ordered_Total + DB1.Weight_Ordered;

  ENDIF;

 }

 ENDIF;

 ENDIF;

}


EXECUTE FUNCTION(Rtv Bld Exp Rate Summ RT) TYPE(RTVOBJ) FILE(POC4CPP)           AC1674396;
PARAMETER(PAR.Company_Number);
PARAMETER(LCL.ERS_Accounting_Year_Code);
PARAMETER(LCL.ERS_Week_Number);
PARAMETER(200);
PARAMETER(LCL.Date_Mon_USR);
PARAMETER(LCL.Date_Sun_USR);
PARAMETER(LCL.ERS_Weight_Ordered_Total);
{
 //?USER: Processing if Data record not found

 EXECUTE FUNCTION(Crt Export Rate Summ  CR) TYPE(CRTOBJ) FILE(POC4CPP)           AC1674385;
 PARAMETER(PAR.Company_Number);
 PARAMETER(PAR.ERS_Accounting_Year_Code);
 PARAMETER(PAR.ERS_Week_Number);
 PARAMETER(PAR.ERS_Item_Str_Type_Code);
 PARAMETER(PAR.ERS_Sched_Ship_Date_From);
 PARAMETER(PAR.ERS_Sched_Ship_Date_To);
 PARAMETER(PAR.ERS_Weight_Ordered_Total);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER(WRK.EDI_Status_1);
 PARAMETER(WRK.EDI_Status_2);
 PARAMETER(WRK.EDI_Status_3);
 PARAMETER('A');
 PARAMETER(*ZERO);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*ZERO);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(SET Record Stamp CRTOB IF) TYPE(EXCINTFUN)                     AC1282865;
  PARAMETER(DB1.Record_Status);
  PARAMETER(DB1.Job_Time);
  PARAMETER(DB1.User_Id);
  PARAMETER(DB1.Job_Name);
  PARAMETER(DB1.Job_Date);
  {
   //?Execute internal function

   // PAR.Record Status = CND.Active
   PAR.Record_Status = 'A';

   // PAR.Job Time = JOB.*Job time
   PAR.Job_Time = JOB.*Job_time;

   // PAR.User Id = JOB.*USER
   PAR.User_Id = JOB.*USER;

   // PAR.Job Name = JOB.*PROGRAM
   PAR.Job_Name = JOB.*PROGRAM;

   // PAR.Job Date = JOB.*Job date
   PAR.Job_Date = JOB.*Job_date;

  }

 }

 //?USER: Process Data record

 EXECUTE FUNCTION(Chg Export Rate Summ  CH) TYPE(CHGOBJ) FILE(POC4CPP)           AC1674386;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.ERS_Accounting_Year_Code);
 PARAMETER(DB1.ERS_Week_Number);
 PARAMETER(DB1.ERS_Item_Str_Type_Code);
 PARAMETER(DB1.ERS_Sched_Ship_Date_From);
 PARAMETER(DB1.ERS_Sched_Ship_Date_To);
 PARAMETER(PAR.ERS_Weight_Ordered_Total);
 PARAMETER(DB1.ERS_Unused_Weight);
 PARAMETER(DB1.ERS_Unused_Number);
 PARAMETER(DB1.ERS_Unused_Number_2);
 PARAMETER(DB1.EDI_Status_1);
 PARAMETER(DB1.EDI_Status_2);
 PARAMETER(DB1.EDI_Status_3);
 PARAMETER(DB1.Record_Status);
 PARAMETER(DB1.Job_Time);
 PARAMETER(DB1.User_Id);
 PARAMETER(DB1.Job_Name);
 PARAMETER(DB1.Job_Date);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Set Record Stamp CHGOB IF) TYPE(EXCINTFUN)                     AC1283156;
  PARAMETER(DB1.Job_Time);
  PARAMETER(DB1.User_Id);
  PARAMETER(DB1.Job_Name);
  PARAMETER(DB1.Job_Date);
  {
   //?Execute internal function

   // PAR.Job Time = JOB.*Job time
   PAR.Job_Time = JOB.*Job_time;

   // PAR.User Id = JOB.*USER
   PAR.User_Id = JOB.*USER;

   // PAR.Job Name = JOB.*PROGRAM
   PAR.Job_Name = JOB.*PROGRAM;

   // PAR.Job Date = JOB.*Job date
   PAR.Job_Date = JOB.*Job_date;

  }

 }

}


