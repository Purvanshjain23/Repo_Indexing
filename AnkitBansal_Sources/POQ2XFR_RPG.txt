     H/TITLE Prc Fax A/R Stmt      XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISLBUSE
     H* Date          : 06/11/12  Time  : 11:50:54
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FPNF7REL1IF  E           K        DISK
      * RTV : Cust Distribution Entry   Retrieval index
      *
      * Long constants
     E                    @CN#    1  06  6   @CN    25
     I@BBREE9
      * Customer                  Retrieval index       NV
      * Renamed input format fields
     I              BBBKC7                          WABKC7
     I              BBAYTX                          WAAYTX
     I              BBACNA                          WAACNA
     I              BBADNA                          WAADNA
     I              BBAENA                          WAAENA
     I              BBAJNA                          WAAJNA
     I              BBBGCD                          WABGCD
     I              BBG5CD                          WAG5CD
     I              BBBTTX                          WABTTX
     I              BBBVTX                          WABVTX
     I              BBBWTX                          WABWTX
     I              BBABTX                          WAABTX
     I              BBA2NA                          WAA2NA
     I              BBCBST                          WACBST
     I              BBB0NA                          WAB0NA
     I              BBP3NB                          WAP3NB
     I              BBAXNA                          WAAXNA
     I              BBI6DT                          WAI6DT
     I              BBAYDT                          WAAYDT
     I              BBANC7                          WAANC7
     I              BBBTC7                          WABTC7
     I              BBK6ST                          WAK6ST
     I              BBUZST                          WAUZST
     I              BBKXCD                          WAKXCD
     I              BBLTCD                          WALTCD
     I              BBQNST                          WAQNST
     I              BBS2NB                          WAS2NB
     I              BBVHVA                          WAVHVA
     I              BBI7DT                          WAI7DT
     I              BBRJST                          WARJST
     I              BBRKST                          WARKST
     I              BBQWST                          WAQWST
     I              BBQXST                          WAQXST
     I              BBQYST                          WAQYST
     I              BBUNCS                          WAUNCS
     I              BBUVST                          WAUVST
     I              BBUWST                          WAUWST
     I              BBUXST                          WAUXST
     I              BBVSST                          WAVSST
     I              BBAATM                          WAAATM
     I              BBAYNA                          WAAYNA
     I              BBA0NA                          WAA0NA
     I              BBAXDT                          WAAXDT
      *
     I@F7REFP
      * Cust Distribution Entry   Retrieval index
      * Renamed input format fields
     I              F7BKC7                          WBBKC7
     I              F7MNAA                          WBMNAA
     I              F7RNNY                          WBRNNY
     I              F7WLT1                          WBWLT1
     I              F7IRST                          WBIRST
     I              F7WMT1                          WBWMT1
     I              F7VSST                          WBVSST
     I              F7MJDT                          WBMJDT
     I              F7BETM                          WBBETM
     I              F7CCVN                          WBCCVN
     I              F7CDVN                          WBCDVN
     I              F7MKDT                          WBMKDT
     I              F7BFTM                          WBBFTM
     I              F7CEVN                          WBCEVN
     I              F7CFVN                          WBCFVN
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Company Customer
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Ship To Customer
     I                                    P   3   60P1BKC7
      * N :  Credit Contact Fax Number
     I                                        7  31 P1I1TX
     IP2PARM      DS
      * I :  Use Credit Contact Info
     I                                        1   1 P2
     IP3PARM      DS
      * I :  Statement Type
     I                                        1   1 P3MYSX
     IP4PARM      DS
      * FLD: *Arrays
      * N :  Spool File Selection
     I                                        1  10 P4LHTX
      * N :  Display Fax Select Screen
     I                                       11  11 P4PHST
      * N :  Send Date
     I                                    P  12  150P4KXDT
      * N :  Printer Name or Outq
     I                                       16  25 P4LJTX
      * N :  Outq Library
     I                                       26  35 P4LKTX
      * N :  Company Recipient Name
     I                                       36  65 P4LMTX
      * N :  Address Line 1
     I                                       66  95 P4ACNA
      * N :  Address Line 2
     I                                       96 125 P4ADNA
      * N :  City for Fax
     I                                      126 155 P4LOTX
      * N :  State Code
     I                                      156 157 P4BGCD
      * N :  Zip Code for Fax
     I                                      158 167 P4LPTX
      * N :  Country Description
     I                                      168 197 P4DATX
     IP5PARM      DS
      * FLD: Company Document Defaults
      * N :  CDD Type
     I                                        1   2 P5ESTX
      * N :  CDD Department Code
     I                                        3   8 P5FPAA
      * N :  CDD Name of Overlay
     I                                        9  16 P5RPNA
     IP6PARM      DS
      * FLD: *Arrays
      * I :  Status Flag 1  Y/N
     I                                        1   1 P6Q1ST
      * I :  Status Flag 3  Y/N
     I                                        2   2 P6Q3ST
      * I :  Status Flag 4  Y/N
     I                                        3   3 P6FMST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1BKC7    PARM           WP0002  70       Ship To Custome
     C           P2        PARM           WP0003  1        Use Credit Cont
     C           P3MYSX    PARM           WP0004  1        Statement Type
     C           P6Q1ST    PARM           WP0005  1        Status Flag 1
     C           P6Q3ST    PARM           WP0006  1        Status Flag 3
     C           P6FMST    PARM           WP0007  1        Status Flag 4
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prc Fax A/R Stmt      XF
      * ** Pass in A/R Customer Number
      * RTV Name.Address,Fax   RT - Customer  * 
     C                     EXSR SARVGN
      * Send fax if customer is valid
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     MOVEL*BLANK    WN0002  6        Date (Char-6) U
     C                     MOVEL*BLANK    WN0003  7        Date (Alpha) US
     C                     MOVEL*BLANK    WN0004  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0005  2        Month (Char) US
     C                     MOVEL*BLANK    WN0006  2        Day   (Char) US
      *
      * CNV cyymmdd to mmddyy
      * convert numeric date to character date.
     C                     MOVEL*BLANK    WN0003           Date (Alpha) US
     C                     MOVEL##JDT     WN0003           Date (Alpha) US
      * extract month, day, and year.
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0003:ZQ WN0004    P  90  Year  (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0003:ZQ WN0005    P  90  Month (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0003:ZQ WN0006    P  90  Day   (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * reconstruct date in mmddyy format.
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0005    CAT  WN0006:ZQ WN0002    P      Date (Char-6) U
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0002    CAT  WN0004:ZQ WN0002    P      Date (Char-6) U
      * convert character date to numeric date.
     C                     MOVE WN0002    P4KXDT           Date Out (6,0)
     C                     MOVEL*BLANK    P4LJTX           Printer Name or
     C                     MOVEL'FAXQ'    P4LJTX           Printer Name or
     C                     MOVEL*BLANK    P4DATX           Country Descrip
     C                     MOVEL@CN,002   P4DATX           Country Descrip
     C                     MOVELP3MYSX    P4PHST           Display Fax Sel
      * ** Spool File Selection is received as &PRTF in the CL
      * ** Spool file based on Statement type (from the menu)
      * CASE: PAR.Statement Type is Aged Statement
     C           P3MYSX    IFEQ 'A'                        *IF
     C                     MOVEL@CN,003   P4LHTX           Spool File Sele
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL@CN,004   P4LHTX           Spool File Sele
     C                     END                             *FI
      * ** Rtv fax number and fax statement if requested      E002121
      * CASE: PAR.Status Flag 1  Y/N is Yes
     C           P6Q1ST    IFEQ 'Y'                        *IF
      * RTV Snd CDE Faxes only RT - Cust Distribution Entry  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
      * ** Rtv email address and email if requested           E002121
      * CASE: PAR.Status Flag 3  Y/N is Yes
     C           P6Q3ST    IFEQ 'Y'                        *IF
      * RTV Snd CDE Email only RT - Cust Distribution Entry  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
     C                     END                             *FI
      * ***** Change Log and Comments
     C                     EXSR UASUBR                     ***** Change Lo
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Name.Address,Fax   RT - Customer  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001 25        Fax Number FF
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WABKC7           Ship To Custome
      * Setup key
     C                     Z-ADDP1BKC7    WABKC7           Ship To Custome
      * Establish starting position
     C           KRSSA     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0001           Fax Number FF
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWABWTX    WN0001           Fax Number FF
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Snd CDE Faxes only RT - Cust Distribution Entry  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0007  2        CDD Type
     C                     MOVEL*BLANK    WN0008  6        CDD Department
     C                     MOVEL*BLANK    WN0009  8        CDD Name of Ove
     C                     MOVEL*BLANK    WN0010 25        Fax Invoice Fax
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBBKC7    WQSB01           Ship To Custome
     C           *LIKE     DEFN WBMNAA    WQSB02           Distribution Co
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Ship To Custome
     C                     KFLD           WQSB02           Distribution Co
      * Setup key
     C                     Z-ADDP1BKC7    WQSB01           Ship To Custome
     C                     MOVEL@CN,005   WQSB02           Distribution Co
      * Establish starting position
     C           KRSSB     SETLL@F7REFP                    *
     C           KRSSB     READE@F7REFP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4289' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0007           CDD Type
     C                     MOVEL*BLANK    WN0008           CDD Department
     C                     MOVEL*BLANK    WN0009           CDD Name of Ove
     C                     MOVEL*BLANK    WN0010           Fax Invoice Fax
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WBVSST    IFEQ 'A'                        *IF
      * ** Customer name
      * RTV Customer Name      RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBBKC7    WL0001           Ship To Custome
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    WUAYTX    P      Customer Name
      * Fax Routine
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.CDE Destination Type is Fax
      *   |- c2    : DB1.CDE Destination Type EQ PAR.CDE Destination Type
      *   |- c3    : DB1.Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           'F'       IFEQ 'F'                        *IF
     C           WBIRST    IFEQ 'F'                        *IF
     C           WBVSST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** Cover sheet default values:
     C                     MOVEL'FX'      WN0007           CDD Type
     C                     MOVEL*BLANK    WN0008           CDD Department
     C                     MOVEL'ACCTG'   WN0008           CDD Department
     C                     MOVELWBWMT1    WN0010           Fax Invoice Fax
      * ** Fax invoice for Invoices or for Statements
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Distribution Code is Invoice
      *   |- c2    : PAR.Distribution Code is Statements
      *   '-
     C           @CN,005   IFEQ @CN,006                    *IF
     C           @CN,005   OREQ @CN,005                    *OR
      * PRC Call Telex Invoice UP - /UT User Programs  * 
     C                     CALL 'POD2UPC'              90  PRC Call Telex
     C                     PARM P4LHTX    WQ0001 10        Spool File Sele
     C                     PARM P4PHST    WQ0002  1        Display Fax Sel
     C                     PARM P4KXDT    WQ0003  60       Send Date
     C                     PARM P4LJTX    WQ0004 10        Printer Name or
     C                     PARM P4LKTX    WQ0005 10        Outq Library
     C                     PARM P4DATX    WQ0006 30        Country Descrip
     C                     PARM *BLANK    WQ0007 10        Spool File Sele
     C                     PARM P1AIC3    WQ0008  30       Company Number
     C                     PARM WN0007    WQ0009  2        CDD Type
     C                     PARM WN0008    WQ0010  6        CDD Department
     C                     PARM WBWLT1    WQ0011 30        CDE Name
     C                     PARM WBWMT1    WQ0012 50        CDE Destination
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POD2UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSB     READE@F7REFP                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Customer Name      RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WABKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0001    WABKC7           Ship To Custome
      * Establish starting position
     C           KRSSC     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Customer Name
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAAYTX    WL0002           Customer Name
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Snd CDE Email only RT - Cust Distribution Entry  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0011  2        CDD Type
     C                     MOVEL*BLANK    WN0012  6        CDD Department
     C                     MOVEL*BLANK    WN0013  8        CDD Name of Ove
     C                     MOVEL*BLANK    WN0014 25        Fax Invoice Fax
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBBKC7    WQSD01           Ship To Custome
     C           *LIKE     DEFN WBMNAA    WQSD02           Distribution Co
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Ship To Custome
     C                     KFLD           WQSD02           Distribution Co
      * Setup key
     C                     Z-ADDP1BKC7    WQSD01           Ship To Custome
     C                     MOVEL@CN,005   WQSD02           Distribution Co
      * Establish starting position
     C           KRSSD     SETLL@F7REFP                    *
     C           KRSSD     READE@F7REFP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4289' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0011           CDD Type
     C                     MOVEL*BLANK    WN0012           CDD Department
     C                     MOVEL*BLANK    WN0013           CDD Name of Ove
     C                     MOVEL*BLANK    WN0014           Fax Invoice Fax
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WBVSST    IFEQ 'A'                        *IF
      * ** Customer name
      * RTV Customer Name      RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBBKC7    WL0001           Ship To Custome
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    WUAYTX    P      Customer Name
      * Email Routine
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.CDE Destination Type is Email
      *   |- c2    : DB1.CDE Destination Type EQ PAR.CDE Destination Type
      *   |- c3    : DB1.Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           'E'       IFEQ 'E'                        *IF
     C           WBIRST    IFEQ 'E'                        *IF
     C           WBVSST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Invoice, Statement, BOL
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Distribution Code is Invoice
      *   |- c2    : PAR.Distribution Code is Statements
      *   '-
     C           @CN,005   IFEQ @CN,006                    *IF
     C           @CN,005   OREQ @CN,005                    *OR
      * Invoice or Statement:
      * CASE: PAR.Spool File Selection is Entered
     C           P4LHTX    IFNE *BLANK                     *IF
      * Exc ESNDMAIL w/Attchmt UP - /UT User Programs  * 
     C                     CALL 'PMB8UPC'              90  Exc ESNDMAIL w/
     C                     PARM P4LHTX    WQ0013 10        Printer File
     C                     PARM WBWLT1    WQ0014 50        Text Usr 50
     C                     PARM WBWMT1    WQ0015 50        Email Address
     C                     PARM '*PDF'    WQ0016  5        Email Format
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMB8UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * BOL:
      * CASE: PAR.Spool File Selection 2 is Entered
     C           *BLANK    IFNE *BLANK                     *IF
      * Exc ESNDMAIL w/Attchmt UP - /UT User Programs  * 
     C                     CALL 'PMB8UPC'              90  Exc ESNDMAIL w/
     C                     PARM *BLANK    WQ0017 10        Printer File
     C                     PARM WBWLT1    WQ0018 50        Text Usr 50
     C                     PARM WBWMT1    WQ0019 50        Email Address
     C                     PARM '*PDF'    WQ0020  5        Email Format
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMB8UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSD     READE@F7REFP                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** NOTE:  Be sure to pass Blanks, not zeros, in spool file 2.
      * *****
      * ** 06/01/2012 LJB E002121
      * ** Pass in new Fax or Email flag.
      * ** Rtv fax # and email addresses separately since Soni may want t
      * ** do one but not the other, based on passed in flag.
      * *****
      * ** 05/04/2012 LJB E000909
      * ** Dup spool files to A/R outq per Soni Martin. She needs them.
      * ** The spooled file will delete after it has
      * ** printed. Soni wants her statements to fax and to print from
      * ** her A/R output queue.
      * *****
      * ** 04/01/2010 LJB P000198 (sub task: E000673)
      * ** Stmts can now be faxed or emailed to one or multiple customers
      * ** Fax/Email is now stored in Cust Distr Entry file. The RTV will
      * ** retrieve the number/address and send to all entries.
      * *****
      * FP1110 RMC 7/22/08 Pass *blank for spool file selection 2 -- its
      *  used to HPB invoice faxing
      * *****
      * ** 05/17/2007 LJB DLY029
      * ** Added retrieve of Company Document Defaults to get overlay inf
      * ** for Company sepcific overlay information. Updated parms to mat
      * ** the called program. Removed unused Cover Sheet Name parm.
      * *****
      * 7/18/2006 SLM L060606   -- FAX PRINTER FILE PPRKPFR$
      * *****
      * ** 05/16/2006 LJB T00008
      * ** Result field length for fax number work field was changed
      * ** to 25 characters to accommodate international fax numbers.
      * *****
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1I1TX           Credit Contact
     C                     MOVEL*BLANK    P4LHTX           Spool File Sele
     C                     MOVEL*BLANK    P4PHST           Display Fax Sel
     C                     Z-ADD*ZERO     P4KXDT           Send Date
     C                     MOVEL*BLANK    P4LJTX           Printer Name or
     C                     MOVEL*BLANK    P4LKTX           Outq Library
     C                     MOVEL*BLANK    P4LMTX           Company Recipie
     C                     MOVEL*BLANK    P4ACNA           Address Line 1
     C                     MOVEL*BLANK    P4ADNA           Address Line 2
     C                     MOVEL*BLANK    P4LOTX           City for Fax
     C                     MOVEL*BLANK    P4BGCD           State Code
     C                     MOVEL*BLANK    P4LPTX           Zip Code for Fa
     C                     MOVEL*BLANK    P4DATX           Country Descrip
     C                     MOVEL*BLANK    P5ESTX           CDD Type
     C                     MOVEL*BLANK    P5FPAA           CDD Department
     C                     MOVEL*BLANK    P5RPNA           CDD Name of Ove
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAP3NB           D & B Number
     C                     Z-ADD*ZERO     WAI6DT           Date of D & B R
     C                     Z-ADD*ZERO     WAAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABTC7           Parent Customer
     C                     Z-ADD*ZERO     WAS2NB           Parent Credit L
     C                     Z-ADD*ZERO     WAVHVA           A/R Credit Limi
     C                     Z-ADD*ZERO     WAI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBRNNY           CDE Sequence Nu
     C                     Z-ADD*ZERO     WBMJDT           Create Date
     C                     Z-ADD*ZERO     WBBETM           Create Time
     C                     Z-ADD*ZERO     WBMKDT           Change Date
     C                     Z-ADD*ZERO     WBBFTM           Change Time
      * Define work field Customer Name
     C                     MOVEL*BLANK    WUAYTX 30
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  70
     C                     MOVEL*BLANK    WL0002 30
      * Define null work field Customer Name
     C                     MOVEL*BLANK    YN0001 30
      * Define null work field Address Line 1
     C                     MOVEL*BLANK    YN0002 30
      * Define null work field Address Line 2
     C                     MOVEL*BLANK    YN0003 30
      * Define null work field City
     C                     MOVEL*BLANK    YN0004 20
      * Define null work field State Code
     C                     MOVEL*BLANK    YN0005  2
      * Define null work field Zip/Postal Code
     C                     MOVEL*BLANK    YN0006 11
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0005
00002 A/R Statements
00003 PPRKPFR$
00004 QPRINT
00005 AR-STMTS
00006 AR-INVOICE
