     H/TITLE Prc Cmp/Frt/Da's/Net 1TXF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 01:10:45
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKARREL4IF  E           K        DISK
      * RSQ : Carcass Merit Program     CMP Competitors only
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKDGCPL2IF  E           K        DISK
      * RSQ : Competitors Tattoo        Tattoo/Cmp
      *
     FPKAWCPL1IF  E           K        DISK
      * RTV : Buy Order Header          Retrieval index
      *
     FPKDEREL1IF  E           K        DISK
      * RTV : Competitors Commodity     Retrieval index
      *
     FPKARREL0IF  E           K        DISK
      * RTV : Carcass Merit Program     Retrieval index
      *
     FPKAQCPL0IF  E           K        DISK
      * RTV : Producer Sub-Contract     Retrieval index
      *
     FPKARREL2IF  E           K        DISK
      * RSQ : Carcass Merit Program     CMP SBD Standard pgm onl
      *
     FPKDGCPL0UF  E           K        DISK
      * UPD : Competitors Tattoo        Update index
      *
     FPKA1CPL1UF  E           K        DISK
      * UPD : Tattoo Header             Update index
      *
     I@ARRETN
      * Carcass Merit Program     CMP Competitors only
      * Renamed input format fields
     I              ARAMCD                          WAAMCD
     I              ARA3TX                          WAA3TX
     I              ARDLST                          WADLST
     I              ARDMST                          WADMST
     I              ARDOST                          WADOST
     I              ARDQST                          WADQST
     I              ARAZPC                          WAAZPC
     I              ARA0PC                          WAA0PC
     I              ARDTST                          WADTST
     I              ARF5ST                          WAF5ST
     I              ARI1PR                          WAI1PR
     I              ARVEPR                          WAVEPR
     I              ARVFPR                          WAVFPR
     I              ARVHPR                          WAVHPR
     I              ARVIPR                          WAVIPR
     I              ARVJPR                          WAVJPR
     I              ARZ2ST                          WAZ2ST
     I              ARZ3ST                          WAZ3ST
     I              ARZ4ST                          WAZ4ST
     I              ARAAVN                          WAAAVN
     I              ARAADT                          WAAADT
     I              ARAMTM                          WAAMTM
     I              ARAJST                          WAAJST
     I              ARAHVN                          WAAHVN
     I              ARAGVN                          WAAGVN
     I              ARABVN                          WAABVN
     I              ARABDT                          WAABDT
     I              ARABTM                          WAABTM
      *
     I@A1CPC4
      * Tattoo Header             Retrieval index
      * Renamed input format fields
     I              A1HMNB                          WBHMNB
     I              A1BNNB                          WBBNNB
     I              A1BONB                          WBBONB
     I              A1CVNB                          WBCVNB
     I              A1B0DT                          WBB0DT
     I              A1AWDT                          WBAWDT
     I              A1BICD                          WBBICD
     I              A1CPST                          WBCPST
     I              A1ACPR                          WBACPR
     I              A1B9PR                          WBB9PR
     I              A1CAPR                          WBCAPR
     I              A1C4ST                          WBC4ST
     I              A1AIPR                          WBAIPR
     I              A1A6DT                          WBA6DT
     I              A1C2ST                          WBC2ST
     I              A1CXNB                          WBCXNB
     I              A1CWNB                          WBCWNB
     I              A1FCNB                          WBFCNB
     I              A1H9NB                          WBH9NB
     I              A1FDNB                          WBFDNB
     I              A1FENB                          WBFENB
     I              A1HENB                          WBHENB
     I              A1HFNB                          WBHFNB
     I              A1CYNB                          WBCYNB
     I              A1LRNB                          WBLRNB
     I              A1E0NB                          WBE0NB
     I              A1A5PC                          WBA5PC
     I              A1FBNB                          WBFBNB
     I              A1A4PC                          WBA4PC
     I              A1F7NB                          WBF7NB
     I              A1HDNB                          WBHDNB
     I              A1F5NB                          WBF5NB
     I              A1F4NB                          WBF4NB
     I              A1F3NB                          WBF3NB
     I              A1F2NB                          WBF2NB
     I              A1AVPC                          WBAVPC
     I              A1AWPC                          WBAWPC
     I              A1CWPC                          WBCWPC
     I              A1A8PC                          WBA8PC
     I              A1A7PC                          WBA7PC
     I              A1B8PR                          WBB8PR
     I              A1AMPR                          WBAMPR
     I              A1ANPR                          WBANPR
     I              A1AYVA                          WBAYVA
     I              A1AWVA                          WBAWVA
     I              A1AOPR                          WBAOPR
     I              A1AXVA                          WBAXVA
     I              A1APPR                          WBAPPR
     I              A1ASPR                          WBASPR
     I              A1A4VA                          WBA4VA
     I              A1ATPR                          WBATPR
     I              A1A5VA                          WBA5VA
     I              A1CBPR                          WBCBPR
     I              A1CCPR                          WBCCPR
     I              A1LPNB                          WBLPNB
     I              A1CDPR                          WBCDPR
     I              A1A7VA                          WBA7VA
     I              A1A2PR                          WBA2PR
     I              A1JWST                          WBJWST
     I              A1CWST                          WBCWST
     I              A1D7ST                          WBD7ST
     I              A1D8ST                          WBD8ST
     I              A1DWST                          WBDWST
     I              A1D6ST                          WBD6ST
     I              A1GHNB                          WBGHNB
     I              A1BYDT                          WBBYDT
     I              A1E0ST                          WBE0ST
     I              A1E1ST                          WBE1ST
     I              A1E2ST                          WBE2ST
     I              A1BSDT                          WBBSDT
     I              A1BTDT                          WBBTDT
     I              A1BUDT                          WBBUDT
     I              A1HGNB                          WBHGNB
     I              A1HHNB                          WBHHNB
     I              A1HINB                          WBHINB
     I              A1A3PR                          WBA3PR
     I              A1A4PR                          WBA4PR
     I              A1A6PR                          WBA6PR
     I              A1J9NB                          WBJ9NB
     I              A1D6PR                          WBD6PR
     I              A1D7PR                          WBD7PR
     I              A1D8PR                          WBD8PR
     I              A1D9PR                          WBD9PR
     I              A1EAPR                          WBEAPR
     I              A1EBPR                          WBEBPR
     I              A1ECPR                          WBECPR
     I              A1EDPR                          WBEDPR
     I              A1EEPR                          WBEEPR
     I              A1EFPR                          WBEFPR
     I              A1EGPR                          WBEGPR
     I              A1EHPR                          WBEHPR
     I              A1KAST                          WBKAST
     I              A1J7ST                          WBJ7ST
     I              A1J9ST                          WBJ9ST
     I              A1OXNB                          WBOXNB
     I              A1LKST                          WBLKST
     I              A1LLST                          WBLLST
     I              A1J8ST                          WBJ8ST
     I              A1LIST                          WBLIST
     I              A1LJST                          WBLJST
     I              A1NZTX                          WBNZTX
     I              A1HJCD                          WBHJCD
     I              A1R4ST                          WBR4ST
     I              A1R5ST                          WBR5ST
     I              A1R6ST                          WBR6ST
     I              A1R7ST                          WBR7ST
     I              A1THWT                          WBTHWT
     I              A1T2WT                          WBT2WT
     I              A1THHD                          WBTHHD
     I              A1T2HD                          WBT2HD
     I              A1OBPR                          WBOBPR
     I              A1KOER                          WBKOER
     I              A1OPIR                          WBOPIR
     I              A1OPEM                          WBOPEM
     I              A1IORP                          WBIORP
     I              A1OWEO                          WBOWEO
     I              A1OQET                          WBOQET
     I              A1URST                          WBURST
     I              A1USST                          WBUSST
     I              A1HHPC                          WBHHPC
     I              A1S9PR                          WBS9PR
     I              A1TAPR                          WBTAPR
     I              A1TBPR                          WBTBPR
     I              A1JFUR                          WBJFUR
     I              A1KRIF                          WBKRIF
     I              A1KORF                          WBKORF
     I              A1KAPR                          WBKAPR
     I              A1KROT                          WBKROT
     I              A1OTJG                          WBOTJG
     I              A1IRJG                          WBIRJG
     I              A1IMJF                          WBIMJF
     I              A1IRGF                          WBIRGF
     I              A1KRJF                          WBKRJF
     I              A1OJRF                          WBOJRF
     I              A1KFOR                          WBKFOR
     I              A1ORJK                          WBORJK
     I              A1OMVJ                          WBOMVJ
     I              A1MVNF                          WBMVNF
     I              A1MCNF                          WBMCNF
     I              A1NCNF                          WBNCNF
     I              A1NCHF                          WBNCHF
     I              A1IGIR                          WBIGIR
     I              A1KFJR                          WBKFJR
     I              A1EADT                          WBEADT
     I              A1EBDT                          WBEBDT
     I              A1ECDT                          WBECDT
     I              A1EDDT                          WBEDDT
     I              A1EEDT                          WBEEDT
     I              A1U4ST                          WBU4ST
     I              A1U5ST                          WBU5ST
     I              A1U6ST                          WBU6ST
     I              A1U7ST                          WBU7ST
     I              A1U8ST                          WBU8ST
     I              A1U9ST                          WBU9ST
     I              A1VAST                          WBVAST
     I              A1VBST                          WBVBST
     I              A1BDCD                          WBBDCD
     I              A1CSCD                          WBCSCD
     I              A1ABCD                          WBABCD
     I              A1AECD                          WBAECD
     I              A1ACCD                          WBACCD
     I              A1AGCD                          WBAGCD
     I              A1BECD                          WBBECD
     I              A1AAVN                          WBAAVN
     I              A1AADT                          WBAADT
     I              A1AMTM                          WBAMTM
     I              A1AJST                          WBAJST
     I              A1AHVN                          WBAHVN
     I              A1AGVN                          WBAGVN
     I              A1ABVN                          WBABVN
     I              A1ABDT                          WBABDT
     I              A1ABTM                          WBABTM
      *
     I@DGCPTP
      * Competitors Tattoo        Tattoo/Cmp
      * Renamed input format fields
     I              DGAMCD                          WCAMCD
     I              DGHMNB                          WCHMNB
     I              DGBNNB                          WCBNNB
     I              DGBONB                          WCBONB
     I              DGCVNB                          WCCVNB
     I              DGB0DT                          WCB0DT
     I              DGMHST                          WCMHST
     I              DGF4PC                          WCF4PC
     I              DGG5PR                          WCG5PR
     I              DGJPPR                          WCJPPR
     I              DGG6PR                          WCG6PR
     I              DGJQPR                          WCJQPR
     I              DGG7PR                          WCG7PR
     I              DGJRPR                          WCJRPR
     I              DGJUPR                          WCJUPR
     I              DGJVPR                          WCJVPR
     I              DGG8PR                          WCG8PR
     I              DGJSPR                          WCJSPR
     I              DGG9PR                          WCG9PR
     I              DGJTPR                          WCJTPR
     I              DGAAVN                          WCAAVN
     I              DGAADT                          WCAADT
     I              DGAMTM                          WCAMTM
     I              DGAJST                          WCAJST
     I              DGAHVN                          WCAHVN
     I              DGAGVN                          WCAGVN
     I              DGABVN                          WCABVN
     I              DGABDT                          WCABDT
     I              DGABTM                          WCABTM
      *
     I@DGCPTJ
      * Competitors Tattoo        Update index
      * Renamed input format fields
     I              DGAMCD                          WDAMCD
     I              DGHMNB                          WDHMNB
     I              DGBNNB                          WDBNNB
     I              DGBONB                          WDBONB
     I              DGCVNB                          WDCVNB
     I              DGB0DT                          WDB0DT
     I              DGMHST                          WDMHST
     I              DGF4PC                          WDF4PC
     I              DGG5PR                          WDG5PR
     I              DGJPPR                          WDJPPR
     I              DGG6PR                          WDG6PR
     I              DGJQPR                          WDJQPR
     I              DGG7PR                          WDG7PR
     I              DGJRPR                          WDJRPR
     I              DGJUPR                          WDJUPR
     I              DGJVPR                          WDJVPR
     I              DGG8PR                          WDG8PR
     I              DGJSPR                          WDJSPR
     I              DGG9PR                          WDG9PR
     I              DGJTPR                          WDJTPR
     I              DGAAVN                          WDAAVN
     I              DGAADT                          WDAADT
     I              DGAMTM                          WDAMTM
     I              DGAJST                          WDAJST
     I              DGAHVN                          WDAHVN
     I              DGAGVN                          WDAGVN
     I              DGABVN                          WDABVN
     I              DGABDT                          WDABDT
     I              DGABTM                          WDABTM
      *
     I@AWCPBI
      * Buy Order Header          Retrieval index
      * Renamed input format fields
     I              AWHMNB                          WEHMNB
     I              AWBNNB                          WEBNNB
     I              AWARDT                          WEARDT
     I              AWASDT                          WEASDT
     I              AWA4ST                          WEA4ST
     I              AWA5ST                          WEA5ST
     I              AWAAPR                          WEAAPR
     I              AWA6ST                          WEA6ST
     I              AWA7ST                          WEA7ST
     I              AWB3ST                          WEB3ST
     I              AWALPR                          WEALPR
     I              AWETCD                          WEETCD
     I              AWEUCD                          WEEUCD
     I              AWJ5TX                          WEJ5TX
     I              AWD5DT                          WED5DT
     I              AWD6DT                          WED6DT
     I              AWD7DT                          WED7DT
     I              AWD8DT                          WED8DT
     I              AWD9DT                          WED9DT
     I              AWJOEJ                          WEJOEJ
     I              AWKOFF                          WEKOFF
     I              AWKWPE                          WEKWPE
     I              AWIMBF                          WEIMBF
     I              AWOPTR                          WEOPTR
     I              AWOEJD                          WEOEJD
     I              AWIRMF                          WEIRMF
     I              AWJIRM                          WEJIRM
     I              AWJRKF                          WEJRKF
     I              AWKFIR                          WEKFIR
     I              AWUZST                          WEUZST
     I              AWU0ST                          WEU0ST
     I              AWU1ST                          WEU1ST
     I              AWU2ST                          WEU2ST
     I              AWU3ST                          WEU3ST
     I              AWHXNB                          WEHXNB
     I              AWGANB                          WEGANB
     I              AWGBNB                          WEGBNB
     I              AWABCD                          WEABCD
     I              AWAECD                          WEAECD
     I              AWAKCD                          WEAKCD
     I              AWALCD                          WEALCD
     I              AWAGCD                          WEAGCD
     I              AWAICD                          WEAICD
     I              AWAMCD                          WEAMCD
     I              AWACCD                          WEACCD
     I              AWAAVN                          WEAAVN
     I              AWAADT                          WEAADT
     I              AWAMTM                          WEAMTM
     I              AWAJST                          WEAJST
     I              AWAHVN                          WEAHVN
     I              AWAGVN                          WEAGVN
     I              AWABVN                          WEABVN
     I              AWABDT                          WEABDT
     I              AWABTM                          WEABTM
      *
     I@A1CPC5
      * Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WFHMNB
     I              A1BNNB                          WFBNNB
     I              A1BONB                          WFBONB
     I              A1CVNB                          WFCVNB
     I              A1B0DT                          WFB0DT
     I              A1AWDT                          WFAWDT
     I              A1BICD                          WFBICD
     I              A1CPST                          WFCPST
     I              A1ACPR                          WFACPR
     I              A1B9PR                          WFB9PR
     I              A1CAPR                          WFCAPR
     I              A1C4ST                          WFC4ST
     I              A1AIPR                          WFAIPR
     I              A1A6DT                          WFA6DT
     I              A1C2ST                          WFC2ST
     I              A1CXNB                          WFCXNB
     I              A1CWNB                          WFCWNB
     I              A1FCNB                          WFFCNB
     I              A1H9NB                          WFH9NB
     I              A1FDNB                          WFFDNB
     I              A1FENB                          WFFENB
     I              A1HENB                          WFHENB
     I              A1HFNB                          WFHFNB
     I              A1CYNB                          WFCYNB
     I              A1LRNB                          WFLRNB
     I              A1E0NB                          WFE0NB
     I              A1A5PC                          WFA5PC
     I              A1FBNB                          WFFBNB
     I              A1A4PC                          WFA4PC
     I              A1F7NB                          WFF7NB
     I              A1HDNB                          WFHDNB
     I              A1F5NB                          WFF5NB
     I              A1F4NB                          WFF4NB
     I              A1F3NB                          WFF3NB
     I              A1F2NB                          WFF2NB
     I              A1AVPC                          WFAVPC
     I              A1AWPC                          WFAWPC
     I              A1CWPC                          WFCWPC
     I              A1A8PC                          WFA8PC
     I              A1A7PC                          WFA7PC
     I              A1B8PR                          WFB8PR
     I              A1AMPR                          WFAMPR
     I              A1ANPR                          WFANPR
     I              A1AYVA                          WFAYVA
     I              A1AWVA                          WFAWVA
     I              A1AOPR                          WFAOPR
     I              A1AXVA                          WFAXVA
     I              A1APPR                          WFAPPR
     I              A1ASPR                          WFASPR
     I              A1A4VA                          WFA4VA
     I              A1ATPR                          WFATPR
     I              A1A5VA                          WFA5VA
     I              A1CBPR                          WFCBPR
     I              A1CCPR                          WFCCPR
     I              A1LPNB                          WFLPNB
     I              A1CDPR                          WFCDPR
     I              A1A7VA                          WFA7VA
     I              A1A2PR                          WFA2PR
     I              A1JWST                          WFJWST
     I              A1CWST                          WFCWST
     I              A1D7ST                          WFD7ST
     I              A1D8ST                          WFD8ST
     I              A1DWST                          WFDWST
     I              A1D6ST                          WFD6ST
     I              A1GHNB                          WFGHNB
     I              A1BYDT                          WFBYDT
     I              A1E0ST                          WFE0ST
     I              A1E1ST                          WFE1ST
     I              A1E2ST                          WFE2ST
     I              A1BSDT                          WFBSDT
     I              A1BTDT                          WFBTDT
     I              A1BUDT                          WFBUDT
     I              A1HGNB                          WFHGNB
     I              A1HHNB                          WFHHNB
     I              A1HINB                          WFHINB
     I              A1A3PR                          WFA3PR
     I              A1A4PR                          WFA4PR
     I              A1A6PR                          WFA6PR
     I              A1J9NB                          WFJ9NB
     I              A1D6PR                          WFD6PR
     I              A1D7PR                          WFD7PR
     I              A1D8PR                          WFD8PR
     I              A1D9PR                          WFD9PR
     I              A1EAPR                          WFEAPR
     I              A1EBPR                          WFEBPR
     I              A1ECPR                          WFECPR
     I              A1EDPR                          WFEDPR
     I              A1EEPR                          WFEEPR
     I              A1EFPR                          WFEFPR
     I              A1EGPR                          WFEGPR
     I              A1EHPR                          WFEHPR
     I              A1KAST                          WFKAST
     I              A1J7ST                          WFJ7ST
     I              A1J9ST                          WFJ9ST
     I              A1OXNB                          WFOXNB
     I              A1LKST                          WFLKST
     I              A1LLST                          WFLLST
     I              A1J8ST                          WFJ8ST
     I              A1LIST                          WFLIST
     I              A1LJST                          WFLJST
     I              A1NZTX                          WFNZTX
     I              A1HJCD                          WFHJCD
     I              A1R4ST                          WFR4ST
     I              A1R5ST                          WFR5ST
     I              A1R6ST                          WFR6ST
     I              A1R7ST                          WFR7ST
     I              A1THWT                          WFTHWT
     I              A1T2WT                          WFT2WT
     I              A1THHD                          WFTHHD
     I              A1T2HD                          WFT2HD
     I              A1OBPR                          WFOBPR
     I              A1KOER                          WFKOER
     I              A1OPIR                          WFOPIR
     I              A1OPEM                          WFOPEM
     I              A1IORP                          WFIORP
     I              A1OWEO                          WFOWEO
     I              A1OQET                          WFOQET
     I              A1URST                          WFURST
     I              A1USST                          WFUSST
     I              A1HHPC                          WFHHPC
     I              A1S9PR                          WFS9PR
     I              A1TAPR                          WFTAPR
     I              A1TBPR                          WFTBPR
     I              A1JFUR                          WFJFUR
     I              A1KRIF                          WFKRIF
     I              A1KORF                          WFKORF
     I              A1KAPR                          WFKAPR
     I              A1KROT                          WFKROT
     I              A1OTJG                          WFOTJG
     I              A1IRJG                          WFIRJG
     I              A1IMJF                          WFIMJF
     I              A1IRGF                          WFIRGF
     I              A1KRJF                          WFKRJF
     I              A1OJRF                          WFOJRF
     I              A1KFOR                          WFKFOR
     I              A1ORJK                          WFORJK
     I              A1OMVJ                          WFOMVJ
     I              A1MVNF                          WFMVNF
     I              A1MCNF                          WFMCNF
     I              A1NCNF                          WFNCNF
     I              A1NCHF                          WFNCHF
     I              A1IGIR                          WFIGIR
     I              A1KFJR                          WFKFJR
     I              A1EADT                          WFEADT
     I              A1EBDT                          WFEBDT
     I              A1ECDT                          WFECDT
     I              A1EDDT                          WFEDDT
     I              A1EEDT                          WFEEDT
     I              A1U4ST                          WFU4ST
     I              A1U5ST                          WFU5ST
     I              A1U6ST                          WFU6ST
     I              A1U7ST                          WFU7ST
     I              A1U8ST                          WFU8ST
     I              A1U9ST                          WFU9ST
     I              A1VAST                          WFVAST
     I              A1VBST                          WFVBST
     I              A1BDCD                          WFBDCD
     I              A1CSCD                          WFCSCD
     I              A1ABCD                          WFABCD
     I              A1AECD                          WFAECD
     I              A1ACCD                          WFACCD
     I              A1AGCD                          WFAGCD
     I              A1BECD                          WFBECD
     I              A1AAVN                          WFAAVN
     I              A1AADT                          WFAADT
     I              A1AMTM                          WFAMTM
     I              A1AJST                          WFAJST
     I              A1AHVN                          WFAHVN
     I              A1AGVN                          WFAGVN
     I              A1ABVN                          WFABVN
     I              A1ABDT                          WFABDT
     I              A1ABTM                          WFABTM
      *
     I@DERETE
      * Competitors Commodity     Retrieval index
      * Renamed input format fields
     I              DETNNB                          WGTNNB
     I              DEE5CD                          WGE5CD
     I              DEE6CD                          WGE6CD
     I              DEJ9TX                          WGJ9TX
     I              DEGAPR                          WGGAPR
     I              DEAAVN                          WGAAVN
     I              DEAADT                          WGAADT
     I              DEAMTM                          WGAMTM
     I              DEAJST                          WGAJST
     I              DEAHVN                          WGAHVN
     I              DEAGVN                          WGAGVN
     I              DEABVN                          WGABVN
     I              DEABDT                          WGABDT
     I              DEABTM                          WGABTM
      *
     I@ARREBF
      * Carcass Merit Program     Retrieval index
      * Renamed input format fields
     I              ARAMCD                          WHAMCD
     I              ARA3TX                          WHA3TX
     I              ARDLST                          WHDLST
     I              ARDMST                          WHDMST
     I              ARDOST                          WHDOST
     I              ARDQST                          WHDQST
     I              ARAZPC                          WHAZPC
     I              ARA0PC                          WHA0PC
     I              ARDTST                          WHDTST
     I              ARF5ST                          WHF5ST
     I              ARI1PR                          WHI1PR
     I              ARVEPR                          WHVEPR
     I              ARVFPR                          WHVFPR
     I              ARVHPR                          WHVHPR
     I              ARVIPR                          WHVIPR
     I              ARVJPR                          WHVJPR
     I              ARZ2ST                          WHZ2ST
     I              ARZ3ST                          WHZ3ST
     I              ARZ4ST                          WHZ4ST
     I              ARAAVN                          WHAAVN
     I              ARAADT                          WHAADT
     I              ARAMTM                          WHAMTM
     I              ARAJST                          WHAJST
     I              ARAHVN                          WHAHVN
     I              ARAGVN                          WHAGVN
     I              ARABVN                          WHABVN
     I              ARABDT                          WHABDT
     I              ARABTM                          WHABTM
      *
     I@AQCPA0
      * Producer Sub-Contract     Retrieval index
      * Renamed input format fields
     I              AQAKCD                          WIAKCD
     I              AQALCD                          WIALCD
     I              AQAHDT                          WIAHDT
     I              AQA2ST                          WIA2ST
     I              AQAZPR                          WIAZPR
     I              AQA0PR                          WIA0PR
     I              AQA9PC                          WIA9PC
     I              AQA7PR                          WIA7PR
     I              AQA8PR                          WIA8PR
     I              AQF3ST                          WIF3ST
     I              AQA9PR                          WIA9PR
     I              AQERCD                          WIERCD
     I              AQESCD                          WIESCD
     I              AQF6PR                          WIF6PR
     I              AQJ3TX                          WIJ3TX
     I              AQABCD                          WIABCD
     I              AQAECD                          WIAECD
     I              AQAGCD                          WIAGCD
     I              AQAICD                          WIAICD
     I              AQAMCD                          WIAMCD
     I              AQAAVN                          WIAAVN
     I              AQAADT                          WIAADT
     I              AQAMTM                          WIAMTM
     I              AQAJST                          WIAJST
     I              AQAHVN                          WIAHVN
     I              AQAGVN                          WIAGVN
     I              AQABVN                          WIABVN
     I              AQABDT                          WIABDT
     I              AQABTM                          WIABTM
      *
     I@ARREK1
      * Carcass Merit Program     CMP SBD Standard pgm onl
      * Renamed input format fields
     I              ARAMCD                          WJAMCD
     I              ARA3TX                          WJA3TX
     I              ARDLST                          WJDLST
     I              ARDMST                          WJDMST
     I              ARDOST                          WJDOST
     I              ARDQST                          WJDQST
     I              ARAZPC                          WJAZPC
     I              ARA0PC                          WJA0PC
     I              ARDTST                          WJDTST
     I              ARF5ST                          WJF5ST
     I              ARI1PR                          WJI1PR
     I              ARVEPR                          WJVEPR
     I              ARVFPR                          WJVFPR
     I              ARVHPR                          WJVHPR
     I              ARVIPR                          WJVIPR
     I              ARVJPR                          WJVJPR
     I              ARZ2ST                          WJZ2ST
     I              ARZ3ST                          WJZ3ST
     I              ARZ4ST                          WJZ4ST
     I              ARAAVN                          WJAAVN
     I              ARAADT                          WJAADT
     I              ARAMTM                          WJAMTM
     I              ARAJST                          WJAJST
     I              ARAHVN                          WJAHVN
     I              ARAGVN                          WJAGVN
     I              ARABVN                          WJABVN
     I              ARABDT                          WJABDT
     I              ARABTM                          WJABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKDG1    E DSPKDGCPL0
      * UPD : Competitors Tattoo        Update index
      * Renamed input format fields
     I              DGAMCD                          WDAMCD
     I              DGHMNB                          WDHMNB
     I              DGBNNB                          WDBNNB
     I              DGBONB                          WDBONB
     I              DGCVNB                          WDCVNB
     I              DGB0DT                          WDB0DT
     I              DGMHST                          WDMHST
     I              DGF4PC                          WDF4PC
     I              DGG5PR                          WDG5PR
     I              DGJPPR                          WDJPPR
     I              DGG6PR                          WDG6PR
     I              DGJQPR                          WDJQPR
     I              DGG7PR                          WDG7PR
     I              DGJRPR                          WDJRPR
     I              DGJUPR                          WDJUPR
     I              DGJVPR                          WDJVPR
     I              DGG8PR                          WDG8PR
     I              DGJSPR                          WDJSPR
     I              DGG9PR                          WDG9PR
     I              DGJTPR                          WDJTPR
     I              DGAAVN                          WDAAVN
     I              DGAADT                          WDAADT
     I              DGAMTM                          WDAMTM
     I              DGAJST                          WDAJST
     I              DGAHVN                          WDAHVN
     I              DGAGVN                          WDAGVN
     I              DGABVN                          WDABVN
     I              DGABDT                          WDABDT
     I              DGABTM                          WDABTM
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKA11    E DSPKA1CPL1
      * UPD : Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WFHMNB
     I              A1BNNB                          WFBNNB
     I              A1BONB                          WFBONB
     I              A1CVNB                          WFCVNB
     I              A1B0DT                          WFB0DT
     I              A1AWDT                          WFAWDT
     I              A1BICD                          WFBICD
     I              A1CPST                          WFCPST
     I              A1ACPR                          WFACPR
     I              A1B9PR                          WFB9PR
     I              A1CAPR                          WFCAPR
     I              A1C4ST                          WFC4ST
     I              A1AIPR                          WFAIPR
     I              A1A6DT                          WFA6DT
     I              A1C2ST                          WFC2ST
     I              A1CXNB                          WFCXNB
     I              A1CWNB                          WFCWNB
     I              A1FCNB                          WFFCNB
     I              A1H9NB                          WFH9NB
     I              A1FDNB                          WFFDNB
     I              A1FENB                          WFFENB
     I              A1HENB                          WFHENB
     I              A1HFNB                          WFHFNB
     I              A1CYNB                          WFCYNB
     I              A1LRNB                          WFLRNB
     I              A1E0NB                          WFE0NB
     I              A1A5PC                          WFA5PC
     I              A1FBNB                          WFFBNB
     I              A1A4PC                          WFA4PC
     I              A1F7NB                          WFF7NB
     I              A1HDNB                          WFHDNB
     I              A1F5NB                          WFF5NB
     I              A1F4NB                          WFF4NB
     I              A1F3NB                          WFF3NB
     I              A1F2NB                          WFF2NB
     I              A1AVPC                          WFAVPC
     I              A1AWPC                          WFAWPC
     I              A1CWPC                          WFCWPC
     I              A1A8PC                          WFA8PC
     I              A1A7PC                          WFA7PC
     I              A1B8PR                          WFB8PR
     I              A1AMPR                          WFAMPR
     I              A1ANPR                          WFANPR
     I              A1AYVA                          WFAYVA
     I              A1AWVA                          WFAWVA
     I              A1AOPR                          WFAOPR
     I              A1AXVA                          WFAXVA
     I              A1APPR                          WFAPPR
     I              A1ASPR                          WFASPR
     I              A1A4VA                          WFA4VA
     I              A1ATPR                          WFATPR
     I              A1A5VA                          WFA5VA
     I              A1CBPR                          WFCBPR
     I              A1CCPR                          WFCCPR
     I              A1LPNB                          WFLPNB
     I              A1CDPR                          WFCDPR
     I              A1A7VA                          WFA7VA
     I              A1A2PR                          WFA2PR
     I              A1JWST                          WFJWST
     I              A1CWST                          WFCWST
     I              A1D7ST                          WFD7ST
     I              A1D8ST                          WFD8ST
     I              A1DWST                          WFDWST
     I              A1D6ST                          WFD6ST
     I              A1GHNB                          WFGHNB
     I              A1BYDT                          WFBYDT
     I              A1E0ST                          WFE0ST
     I              A1E1ST                          WFE1ST
     I              A1E2ST                          WFE2ST
     I              A1BSDT                          WFBSDT
     I              A1BTDT                          WFBTDT
     I              A1BUDT                          WFBUDT
     I              A1HGNB                          WFHGNB
     I              A1HHNB                          WFHHNB
     I              A1HINB                          WFHINB
     I              A1A3PR                          WFA3PR
     I              A1A4PR                          WFA4PR
     I              A1A6PR                          WFA6PR
     I              A1J9NB                          WFJ9NB
     I              A1D6PR                          WFD6PR
     I              A1D7PR                          WFD7PR
     I              A1D8PR                          WFD8PR
     I              A1D9PR                          WFD9PR
     I              A1EAPR                          WFEAPR
     I              A1EBPR                          WFEBPR
     I              A1ECPR                          WFECPR
     I              A1EDPR                          WFEDPR
     I              A1EEPR                          WFEEPR
     I              A1EFPR                          WFEFPR
     I              A1EGPR                          WFEGPR
     I              A1EHPR                          WFEHPR
     I              A1KAST                          WFKAST
     I              A1J7ST                          WFJ7ST
     I              A1J9ST                          WFJ9ST
     I              A1OXNB                          WFOXNB
     I              A1LKST                          WFLKST
     I              A1LLST                          WFLLST
     I              A1J8ST                          WFJ8ST
     I              A1LIST                          WFLIST
     I              A1LJST                          WFLJST
     I              A1NZTX                          WFNZTX
     I              A1HJCD                          WFHJCD
     I              A1R4ST                          WFR4ST
     I              A1R5ST                          WFR5ST
     I              A1R6ST                          WFR6ST
     I              A1R7ST                          WFR7ST
     I              A1THWT                          WFTHWT
     I              A1T2WT                          WFT2WT
     I              A1THHD                          WFTHHD
     I              A1T2HD                          WFT2HD
     I              A1OBPR                          WFOBPR
     I              A1KOER                          WFKOER
     I              A1OPIR                          WFOPIR
     I              A1OPEM                          WFOPEM
     I              A1IORP                          WFIORP
     I              A1OWEO                          WFOWEO
     I              A1OQET                          WFOQET
     I              A1URST                          WFURST
     I              A1USST                          WFUSST
     I              A1HHPC                          WFHHPC
     I              A1S9PR                          WFS9PR
     I              A1TAPR                          WFTAPR
     I              A1TBPR                          WFTBPR
     I              A1JFUR                          WFJFUR
     I              A1KRIF                          WFKRIF
     I              A1KORF                          WFKORF
     I              A1KAPR                          WFKAPR
     I              A1KROT                          WFKROT
     I              A1OTJG                          WFOTJG
     I              A1IRJG                          WFIRJG
     I              A1IMJF                          WFIMJF
     I              A1IRGF                          WFIRGF
     I              A1KRJF                          WFKRJF
     I              A1OJRF                          WFOJRF
     I              A1KFOR                          WFKFOR
     I              A1ORJK                          WFORJK
     I              A1OMVJ                          WFOMVJ
     I              A1MVNF                          WFMVNF
     I              A1MCNF                          WFMCNF
     I              A1NCNF                          WFNCNF
     I              A1NCHF                          WFNCHF
     I              A1IGIR                          WFIGIR
     I              A1KFJR                          WFKFJR
     I              A1EADT                          WFEADT
     I              A1EBDT                          WFEBDT
     I              A1ECDT                          WFECDT
     I              A1EDDT                          WFEDDT
     I              A1EEDT                          WFEEDT
     I              A1U4ST                          WFU4ST
     I              A1U5ST                          WFU5ST
     I              A1U6ST                          WFU6ST
     I              A1U7ST                          WFU7ST
     I              A1U8ST                          WFU8ST
     I              A1U9ST                          WFU9ST
     I              A1VAST                          WFVAST
     I              A1VBST                          WFVBST
     I              A1BDCD                          WFBDCD
     I              A1CSCD                          WFCSCD
     I              A1ABCD                          WFABCD
     I              A1AECD                          WFAECD
     I              A1ACCD                          WFACCD
     I              A1AGCD                          WFAGCD
     I              A1BECD                          WFBECD
     I              A1AAVN                          WFAAVN
     I              A1AADT                          WFAADT
     I              A1AMTM                          WFAMTM
     I              A1AJST                          WFAJST
     I              A1AHVN                          WFAHVN
     I              A1AGVN                          WFAGVN
     I              A1ABVN                          WFABVN
     I              A1ABDT                          WFABDT
     I              A1ABTM                          WFABTM
      *
     IYARDCS      DS                            583
      * Outward parameters
     IPARC        DS                             16
      * KEY : Tattoo Header             Retrieval index
      * I : RST BOH Company Number
     I                                    P   1   20PAHMNB
      * I : RST BOH Buy Order Number
     I                                    P   3   60PABNNB
      * I : RST BOL Load Number
     I                                    P   7   90PABONB
      * I : RST TH Tattoo Number
     I                                    P  10  120PACVNB
      * I : RST TH Kill Date
     I                                    P  13  160PAB0DT
      *
     IYBRDCS      DS                            583
     IYCRDCS      DS                            583
     IYDRDCS      DS                            583
     IYERDCS      DS                            583
     IYFRDCS      DS                            583
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Tattoo Header
      * I : MAP BOH Company Number
     I                                    P   1   20P1HMNB
      * I : MAP BOH Buy Order Number
     I                                    P   3   60P1BNNB
      * I : MAP BOL Load Number
     I                                    P   7   90P1BONB
      * I : MAP TH Tattoo Number
     I                                    P  10  120P1CVNB
      * I : MAP TH Kill Date
     I                                    P  13  160P1B0DT
     IP2PARM      DS
      * I : MAP Oms System Value Alpha
     I                                        1  40 P2EVTX
     IP3PARM      DS
      * I : MAP Pmt Current Payment Date
     I                                    P   1   40P3CKDT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HMNB    PARM           WP0001  30       BOH Company Num
     C           P1BNNB    PARM           WP0002  70       BOH Buy Order N
     C           P1BONB    PARM           WP0003  50       BOL Load Number
     C           P1CVNB    PARM           WP0004  50       TH Tattoo Numbe
     C           P1B0DT    PARM           WP0005  70       TH Kill Date
     C           P2EVTX    PARM           WP0006 40        Oms System Valu
     C           P3CKDT    PARM           WP0007  70       Pmt Current Pay
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prc Cmp/Frt/Da's/Net 1TXF
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * HPE056 Payment Type
      * 1/10/96  HPE056   Allow payment type to be update based on
      *                   what the payment status is at the time this
      *                   tattoo is being updated
      * HPE063 Frt Exp/Accruals
      * 2/26/96  HPE063   Allow the expense for freight to be paid
      *                   by either Seaboard(us) or the producer
      *                   Allow the system to process accruals thru
      *                   the General Ledger.
      * Remove the updating of the payment type by the fix program
      * The payment type should be populated by now
      * Rtv the Competitors Carcass Merit codes only 3 allowed
      * Rtv Cmp Competitors   RT - Carcass Merit Program  * 
     C                     EXSR SARVGN
      * Read each Tattoo that are unpaid, and Recalc Net
      * and Process Carcass Merit Program, Freight Allocation, D/A's
      * and Calculate Net.
      * HPE053p:  Read TH FOR THE TATTOO
      *  and call the routine to calc the CrMrt/frt/da/net amounts
      * Rtv Clc CrMr/Ft/Da 1T RT - Tattoo Header  * 
     C                     EXSR SBRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Cmp Competitors   RT - Carcass Merit Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUP0NB           Count USR
     C                     MOVEL*BLANK    WUE7CD           Competitors Cod
     C                     MOVEL*BLANK    WUE8CD           Competitors Cod
     C                     MOVEL*BLANK    WUE9CD           Competitors Cod
      * Establish starting position
     C           *LOVAL    SETLL@ARRETN                    *
     C                     READ @ARRETN                  90*
      * Data record not found
     C   90                MOVEL'PRK0039' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  001       WUP0NB           Count USR
      * CASE: WRK.Count USR is One
     C           WUP0NB    IFEQ 1                          *IF
     C                     MOVELWAAMCD    WUE7CD           Competitors Cod
     C                     ELSE
      * CASE: WRK.Count USR is Two
     C           WUP0NB    IFEQ 2                          *IF
     C                     MOVELWAAMCD    WUE8CD           Competitors Cod
     C                     ELSE
      * CASE: WRK.Count USR is Three
     C           WUP0NB    IFEQ 3                          *IF
     C                     MOVELWAAMCD    WUE9CD           Competitors Cod
     C                     GOTO SAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @ARRETN                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Clc CrMr/Ft/Da 1T RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUDUNB           Last BOH BuyOrd
     C                     Z-ADD*ZERO     WUDVNB           Last BOL Load n
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBHMNB           BOH Company Num
     C                     KFLD           WBBNNB           BOH Buy Order N
     C                     KFLD           WBBONB           BOL Load Number
     C                     KFLD           WBCVNB           TH Tattoo Numbe
     C                     KFLD           WBB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WBHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WBBONB           BOL Load Number
     C                     Z-ADDP1CVNB    WBCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WBB0DT           TH Kill Date
      * Establish starting position
     C           KRSSB     CHAIN@A1CPC4              90    *
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.TH Payment Sts is Paid Anything
     C           WBCWST    IFEQ 'PL'                       *IF
     C           WBCWST    OREQ 'PC'
     C           WBCWST    OREQ 'NC'
     C           WBCWST    OREQ 'NL'
     C                     ELSE
      * CASE: *OTHERWISE
      * Break in BOL, delete unpaid Tattoo D/A's for the load
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.BOH Buy Order Number NE WRK.Last BOH BuyOrder Nb
      *   |- c2    : DB1.BOL Load Number NE WRK.Last BOL Load number  USR
      *   '-
     C           WBBNNB    IFNE WUDUNB                     *IF
     C           WBBONB    ORNE WUDVNB                     *OR
      * Dlt Tattoo D/A 1 TTT  XF - Tattoo Ded/Add  * 
     C                     CALL 'PKFZXFR'              90  Dlt Tattoo D/A
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBHMNB    WQ0001  30       BOH Company Num
     C                     PARM WBBNNB    WQ0002  70       BOH Buy Order N
     C                     PARM WBBONB    WQ0003  50       BOL Load Number
     C                     PARM WBCVNB    WQ0004  50       TH Tattoo Numbe
     C                     PARM WBB0DT    WQ0005  70       TH Kill Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKFZXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDWBBNNB    WUDUNB           Last BOH BuyOrd
     C                     Z-ADDWBBONB    WUDVNB           Last BOL Load n
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWBTAPR    YL0001           TH VC Gross Val
      * Clc CrM/Frt/Da/Net 1T IF
      * CASE: PAR.TH Kill Date LE PAR.Pmt Current Payment Date
     C           WBB0DT    IFLE P3CKDT                     *IF
      * Must be equal to payment date or in the past and not been paid
      * carcass merit calculations ONE AT A TIME
      * Live/CARCASS  Calculate Live and Carcass Merit for Live
      * CASE: PAR.TH Hog Class Type is Market
     C           WBLLST    IFEQ 'M'                        *IF
      * Carcass only --  processing of live will be done in live/live car
      * Rtv/Dlt Comptitors Tat RT - Competitors Tattoo  * 
     C                     EXSR SCRVGN
      * *Retrieve Purchase Price calculation information.
      * Rtv PrchPrc Clc Info  RT - Buy Order Header  * 
     C                     EXSR SERVGN
      * Chg Tattoo Summary    CH - Tattoo Header  * 
     C                     EXSR SFCHRC
      * Competitors will be using CASH BASIC Pricing, and no pricing opit
      * Competitor 1
     C                     EXSR UBSUBR                     Competitor 1
      * Competitor 2
     C                     EXSR UCSUBR                     Competitor 2
      * Competitor 3
     C                     EXSR UDSUBR                     Competitor 3
      * *Retrieve Purchase Price calculation information.
      * Rtv PrchPrc Clc Info  RT - Buy Order Header  * 
     C                     EXSR SORVGN
      * Retrieve Sub-Contract information.
      * Rtv PurchPrc Clc Info RT - Producer Sub-Contract  * 
     C                     EXSR SPRVGN
      * CASE: PAR.TH Payment Sts is Live anything
     C           WBCWST    IFEQ 'ML'                       *IF
     C           WBCWST    OREQ 'PL'
     C           WBCWST    OREQ 'NL'
     C           WBCWST    OREQ 'SL'
     C           WBCWST    OREQ 'IL'
      * Rtv CMP SBD Standard  RT - Carcass Merit Program  * 
     C                     EXSR SQRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
      * CASE: PAR.TH Payment Type is Live
     C           WBJ9ST    IFEQ 'L'                        *IF
      * Analysis
     C                     EXSR UESUBR                     Analysis
     C                     ELSE
      * CASE: PAR.TH Payment Type is Carcass Merit
     C           WBJ9ST    IFEQ 'C'                        *IF
      * *****************
      * Commented 01/31/97 for C2343. Per Rick Hoffman
      * We are not going through Analysis because it will be the same
      * as what we are going to pay now.
      * ****
      * If Pork decides to make the Average Competitor the Analysis,
      * this case would be uncommented.  See Clc Carcass Analysis  XF
      * for further instructions.  PKD/SLM
      * *****************
      * NO Competitors last time with rules of payment
     C                     EXSR UFSUBR                     NO Competitors
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Tattoo Summary    CH - Tattoo Header  * 
     C                     EXSR STCHRC
     C                     END                             *FI
      * Freight
     C                     EXSR UGSUBR                     Freight
      * CASE: PAR.TH Payment Sts is Paid Anything
     C           WBCWST    IFEQ 'PL'                       *IF
     C           WBCWST    OREQ 'PC'
     C           WBCWST    OREQ 'NC'
     C           WBCWST    OREQ 'NL'
     C                     MOVEL'P'       WUJGST           Ded/Add/Net Pay
      * Clc Ded/Add/Net Pay   XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKREXFR'              90  Clc Ded/Add/Net
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBHMNB    WQ0232  30       BOH Company Num
     C                     PARM WBBNNB    WQ0233  70       BOH Buy Order N
     C                     PARM WBBONB    WQ0234  50       BOL Load Number
     C                     PARM WBCVNB    WQ0235  50       TH Tattoo Numbe
     C                     PARM WBB0DT    WQ0236  70       TH Kill Date
     C                     PARM WUJGST    WQ0237  1        Ded/Add/Net Pay
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKREXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Second time to create da
     C                     MOVEL'C'       WUJGST           Ded/Add/Net Pay
      * Clc Ded/Add/Net Pay   XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKREXFR'              90  Clc Ded/Add/Net
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBHMNB    WQ0238  30       BOH Company Num
     C                     PARM WBBNNB    WQ0239  70       BOH Buy Order N
     C                     PARM WBBONB    WQ0240  50       BOL Load Number
     C                     PARM WBCVNB    WQ0241  50       TH Tattoo Numbe
     C                     PARM WBB0DT    WQ0242  70       TH Kill Date
     C                     PARM WUJGST    WQ0243  1        Ded/Add/Net Pay
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKREXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv/Dlt Comptitors Tat RT - Competitors Tattoo  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSC01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQSC02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQSC03           BOL Load Number
     C           *LIKE     DEFN WCCVNB    WQSC04           TH Tattoo Numbe
     C           *LIKE     DEFN WCB0DT    WQSC05           TH Kill Date
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           BOH Company Num
     C                     KFLD           WQSC02           BOH Buy Order N
     C                     KFLD           WQSC03           BOL Load Number
     C                     KFLD           WQSC04           TH Tattoo Numbe
     C                     KFLD           WQSC05           TH Kill Date
      * Setup key
     C                     Z-ADDWBHMNB    WQSC01           BOH Company Num
     C                     Z-ADDWBBNNB    WQSC02           BOH Buy Order N
     C                     Z-ADDWBBONB    WQSC03           BOL Load Number
     C                     Z-ADDWBCVNB    WQSC04           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WQSC05           TH Kill Date
      * Establish starting position
     C           KRSSC     SETLL@DGCPTP                    *
     C           KRSSC     READE@DGCPTP                  90*
      * Data record not found
     C   90                MOVEL'PRK0570' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Dlt Competitors Tattoo DO - Competitors Tattoo  * 
     C                     EXSR SDDLRC
     C           KRSSC     READE@DGCPTP                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDDLRC    BEGSR
      *================================================================
      * Dlt Competitors Tattoo DO - Competitors Tattoo  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @DGCPTJ
     C                     MOVELWCAMCD    WDAMCD           CMP Program Cod
     C                     Z-ADDWCHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWCBNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWCBONB    WDBONB           BOL Load Number
     C                     Z-ADDWCCVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDWCB0DT    WDB0DT           TH Kill Date
      *
     C           KLDLSD    KLIST
     C                     KFLD           WDAMCD           CMP Program Cod
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
     C                     KFLD           WDCVNB           TH Tattoo Numbe
     C                     KFLD           WDB0DT           TH Kill Date
     C           KLDLSD    CHAIN@DGCPTJ              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDGCPL0'MDACP
     C                     MOVEL'@DGCPTJ' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@DGCPTJ                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv PrchPrc Clc Info  RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADDWBHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WEBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSSE     CHAIN@AWCPBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0049' W0RTN   7
      * USER: Processing if Data record not found
      * 1/28/08 SLM LEFT OVER INFORMATION MAY HAVE CAUSED ISSUES
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAAPR           BOH Market Add/
     C                     MOVEL*BLANK    WUB3ST           BOH Quote Price
     C                     Z-ADD*ZERO     WUALPR           BOH Quoted Base
     C                     MOVEL*BLANK    WUETCD           BOH Commodity M
     C                     MOVEL*BLANK    WUEUCD           BOH Commodity P
     C                     MOVEL*BLANK    WUJ5TX           BOH Market Date
     C                     MOVEL*BLANK    WUAKCD           PC Contract Cod
     C                     MOVEL*BLANK    WUALCD           PSC Sub-Contrac
     C                     MOVEL*BLANK    WUAICD           PO Option Code
     C                     MOVEL*BLANK    WUAMCD           CMP Program Cod
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEAAPR    WUAAPR           BOH Market Add/
     C                     MOVELWEB3ST    WUB3ST           BOH Quote Price
     C                     Z-ADDWEALPR    WUALPR           BOH Quoted Base
     C                     MOVELWEETCD    WUETCD           BOH Commodity M
     C                     MOVELWEEUCD    WUEUCD           BOH Commodity P
     C                     MOVELWEJ5TX    WUJ5TX           BOH Market Date
     C                     MOVELWEAKCD    WUAKCD           PC Contract Cod
     C                     MOVELWEALCD    WUALCD           PSC Sub-Contrac
     C                     MOVELWEAICD    WUAICD           PO Option Code
     C                     MOVELWEAMCD    WUAMCD           CMP Program Cod
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * Chg Tattoo Summary    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0002 10        TH Group Refere
     C                     MOVEL*BLANK    WN0003  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0004  52       TH Live Purchas
     C                     MOVEL*BLANK    WN0005  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0006  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0007  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0008  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0009  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0010  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0011  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0012  50       TH Held Over
     C                     Z-ADD*ZERO     WN0013  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0014  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0015  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0016  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0017  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0018  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0019  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0020  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0021  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0022  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0023  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0024  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0025  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0026  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0027  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0028  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0029  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0030  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0031  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0032  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0033  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0034  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0035  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0036  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0037  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0038  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0039  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0040  1        TH Header Error
     C                     MOVEL*BLANK    WN0041  1        TH Detail Error
     C                     MOVEL*BLANK    WN0042  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0043  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0044  80       TH Commission A
     C                     Z-ADD*ZERO     WN0045  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0046  1        TH User Error O
     C                     MOVEL*BLANK    WN0047  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0048  1        TH Sex
     C                     Z-ADD*ZERO     WN0049  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0050  70       TH Commission P
     C                     Z-ADD*ZERO     WN0051  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0052  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0053  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0054  31       TH FFLI
     C                     Z-ADD*ZERO     WN0055  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0056  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0057  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0058  50       TH Head Exclude
     C                     MOVEL*BLANK    WN0059  1        TH Source Type
     C                     MOVEL*BLANK    WN0060  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0061  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0062  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0063  3        TH Source Code
     C                     MOVEL*BLANK    WN0064  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0065  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0066  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0067  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0068  3        TH State
     C                     MOVEL*BLANK    WN0069  3        TH Unused Code
     C                     MOVEL*BLANK    WN0070  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0071  1        TH Commission S
     C                     MOVEL*BLANK    WN0072  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0073  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0074  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0075  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0076  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0077  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0078  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0079  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0080  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0081  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0082  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0083  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0084  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0085  3        TH PHA Average
     C                     MOVEL*BLANK    WN0086  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0087  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0088  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0089  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0090  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0091  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0092  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0093  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0094  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0095  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0096  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0097  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0098  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0099 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0100 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0101 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0102 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0103  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0104  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0105  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0106  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0107  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0108  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0109  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0110  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0111  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0112  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0113  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0114  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0115  70       TH Unused Date
     C                     MOVEL*BLANK    WN0116  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0117  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0118  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0119  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0120  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0121  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0122  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0123  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0124  6        DF Defect Code
     C                     MOVEL*BLANK    WN0125  6        THP Process Cod
     C                     MOVEL*BLANK    WN0126  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0127  6        PL Location Cod
     C                     MOVEL*BLANK    WN0128  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0129  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0130  3        HC Class Code
     C                     MOVEL*BLANK    WN0131 10        RS User Changed
     C                     Z-ADD*ZERO     WN0132  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0133  60       RS Time Changed
     C                     MOVEL*BLANK    WN0134  1        RS Record Statu
     C                     MOVEL*BLANK    WN0135 10        RS Job
     C                     MOVEL*BLANK    WN0136 10        RS Program
     C                     MOVEL*BLANK    WN0137 10        RS User Added
     C                     Z-ADD*ZERO     WN0138  70       RS Date Added
     C                     Z-ADD*ZERO     WN0139  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWBHMNB    WFHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WFBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WFBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WFCVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WFB0DT           TH Kill Date
      *
     C           KLCHSF    KLIST
     C                     KFLD           WFHMNB           BOH Company Num
     C                     KFLD           WFBNNB           BOH Buy Order N
     C                     KFLD           WFBONB           BOL Load Number
     C                     KFLD           WFCVNB           TH Tattoo Numbe
     C                     KFLD           WFB0DT           TH Kill Date
     C           KLCHSF    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YARDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWBB9PR    WFB9PR           TH Live Gross A
     C                     Z-ADDWBCAPR    WFCAPR           TH LIve Net Amt
     C                     Z-ADDWBAVPC    WFAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WFA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WFB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WFAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WFANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WFAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WFAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WFAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WFAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WFAPPR           TH CM Carcass G
     C                     Z-ADDWBCBPR    WFCBPR           TH Payment Gros
     C                     Z-ADDWBCCPR    WFCCPR           Th Payment Net
     C                     Z-ADDWBLPNB    WFLPNB           TH AP Voucher/D
     C                     Z-ADDWBCDPR    WFCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WFD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WFD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WFD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WFD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WFEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WFEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WFECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WFEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WFEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WFEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WFEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WFEHPR           TH CM Gross Car
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WFAAVN           RS User Changed
     C                     Z-ADD##JDT     WFAADT           RS Date Changed
     C                     Z-ADD##JTM     WFAMTM           RS Time Changed
     C                     MOVEL##JOB     WFAHVN           RS Job
     C                     MOVEL##PGM     WFAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Competitors Comm   RT - Competitors Commodity  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGTNNB           CCC Record
      * Setup key
     C                     Z-ADD00001     WGTNNB           CCC Record
      * Establish starting position
     C           KRSSG     CHAIN@DERETE              90    *
      * Data record not found
     C   90                MOVEL'PRK0566' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGE5CD    WUE5CD           CCC Commodity M
     C                     MOVELWGE6CD    WUE6CD           CCC Commodity P
     C                     MOVELWGJ9TX    WUJ9TX           CCC Market Date
      * Rtv CMP Info          RT - Carcass Merit Program  * 
     C                     EXSR SHRVGN
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv CMP Info          RT - Carcass Merit Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WHAMCD           CMP Program Cod
      * Setup key
     C                     MOVELWUE7CD    WHAMCD           CMP Program Cod
      * Establish starting position
     C           KRSSH     CHAIN@ARREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUA3TX           CMP Description
     C                     MOVEL*BLANK    WUDLST           CMP Grading Typ
     C                     MOVEL*BLANK    WUDMST           CMP Sort Basis
     C                     MOVEL*BLANK    WUDQST           CMP Carc Wgt Ty
     C                     Z-ADD*ZERO     WUAZPC           CMP Std Lean Pe
     C                     Z-ADD*ZERO     WUA0PC           CMP Lean Factor
     C                     MOVEL*BLANK    WUDTST           CMP Optimal Row
     C                     MOVEL*BLANK    WUF5ST           CMP Type
     C                     Z-ADD*ZERO     WUI1PR           CMP Market Add/
     C                     MOVEL*BLANK    WUAJST           RS Record Statu
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHA3TX    WUA3TX           CMP Description
     C                     MOVELWHDLST    WUDLST           CMP Grading Typ
     C                     MOVELWHDMST    WUDMST           CMP Sort Basis
     C                     MOVELWHDQST    WUDQST           CMP Carc Wgt Ty
     C                     Z-ADDWHAZPC    WUAZPC           CMP Std Lean Pe
     C                     Z-ADDWHA0PC    WUA0PC           CMP Lean Factor
     C                     MOVELWHDTST    WUDTST           CMP Optimal Row
     C                     MOVELWHF5ST    WUF5ST           CMP Type
     C                     Z-ADDWHI1PR    WUI1PR           CMP Market Add/
     C                     MOVELWHAJST    WUAJST           RS Record Statu
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * Chg Tattoo Summary    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0140  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0141 10        TH Group Refere
     C                     MOVEL*BLANK    WN0142  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0143  52       TH Live Purchas
     C                     MOVEL*BLANK    WN0144  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0145  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0146  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0147  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0148  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0149  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0150  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0151  50       TH Held Over
     C                     Z-ADD*ZERO     WN0152  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0153  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0154  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0155  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0156  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0157  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0158  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0159  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0160  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0161  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0162  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0163  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0164  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0165  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0166  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0167  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0168  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0169  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0170  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0171  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0172  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0173  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0174  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0175  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0176  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0177  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0178  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0179  1        TH Header Error
     C                     MOVEL*BLANK    WN0180  1        TH Detail Error
     C                     MOVEL*BLANK    WN0181  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0182  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0183  80       TH Commission A
     C                     Z-ADD*ZERO     WN0184  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0185  1        TH User Error O
     C                     MOVEL*BLANK    WN0186  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0187  1        TH Sex
     C                     Z-ADD*ZERO     WN0188  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0189  70       TH Commission P
     C                     Z-ADD*ZERO     WN0190  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0191  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0192  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0193  31       TH FFLI
     C                     Z-ADD*ZERO     WN0194  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0195  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0196  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0197  50       TH Head Exclude
     C                     MOVEL*BLANK    WN0198  1        TH Source Type
     C                     MOVEL*BLANK    WN0199  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0200  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0201  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0202  3        TH Source Code
     C                     MOVEL*BLANK    WN0203  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0204  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0205  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0206  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0207  3        TH State
     C                     MOVEL*BLANK    WN0208  3        TH Unused Code
     C                     MOVEL*BLANK    WN0209  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0210  1        TH Commission S
     C                     MOVEL*BLANK    WN0211  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0212  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0213  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0214  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0215  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0216  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0217  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0218  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0219  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0220  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0221  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0222  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0223  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0224  3        TH PHA Average
     C                     MOVEL*BLANK    WN0225  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0226  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0227  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0228  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0229  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0230  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0231  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0232  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0233  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0234  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0235  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0236  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0237  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0238 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0239 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0240 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0241 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0242  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0243  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0244  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0245  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0246  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0247  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0248  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0249  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0250  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0251  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0252  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0253  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0254  70       TH Unused Date
     C                     MOVEL*BLANK    WN0255  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0256  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0257  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0258  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0259  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0260  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0261  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0262  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0263  6        DF Defect Code
     C                     MOVEL*BLANK    WN0264  6        THP Process Cod
     C                     MOVEL*BLANK    WN0265  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0266  6        PL Location Cod
     C                     MOVEL*BLANK    WN0267  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0268  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0269  3        HC Class Code
     C                     MOVEL*BLANK    WN0270 10        RS User Changed
     C                     Z-ADD*ZERO     WN0271  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0272  60       RS Time Changed
     C                     MOVEL*BLANK    WN0273  1        RS Record Statu
     C                     MOVEL*BLANK    WN0274 10        RS Job
     C                     MOVEL*BLANK    WN0275 10        RS Program
     C                     MOVEL*BLANK    WN0276 10        RS User Added
     C                     Z-ADD*ZERO     WN0277  70       RS Date Added
     C                     Z-ADD*ZERO     WN0278  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWBHMNB    WFHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WFBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WFBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WFCVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WFB0DT           TH Kill Date
      *
     C           KLCHSI    KLIST
     C                     KFLD           WFHMNB           BOH Company Num
     C                     KFLD           WFBNNB           BOH Buy Order N
     C                     KFLD           WFBONB           BOL Load Number
     C                     KFLD           WFCVNB           TH Tattoo Numbe
     C                     KFLD           WFB0DT           TH Kill Date
     C           KLCHSI    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YBRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWBB9PR    WFB9PR           TH Live Gross A
     C                     Z-ADDWBCAPR    WFCAPR           TH LIve Net Amt
     C                     Z-ADDWBAVPC    WFAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WFA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WFB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WFAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WFANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WFAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WFAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WFAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WFAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WFAPPR           TH CM Carcass G
     C                     Z-ADDWBCBPR    WFCBPR           TH Payment Gros
     C                     Z-ADDWBCCPR    WFCCPR           Th Payment Net
     C                     Z-ADDWBLPNB    WFLPNB           TH AP Voucher/D
     C                     Z-ADDWBCDPR    WFCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WFD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WFD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WFD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WFD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WFEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WFEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WFECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WFEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WFEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WFEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WFEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WFEHPR           TH CM Gross Car
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WFAAVN           RS User Changed
     C                     Z-ADD##JDT     WFAADT           RS Date Changed
     C                     Z-ADD##JTM     WFAMTM           RS Time Changed
     C                     MOVEL##JOB     WFAHVN           RS Job
     C                     MOVEL##PGM     WFAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Competitors Comm   RT - Competitors Commodity  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WGTNNB           CCC Record
      * Setup key
     C                     Z-ADD00001     WGTNNB           CCC Record
      * Establish starting position
     C           KRSSJ     CHAIN@DERETE              90    *
      * Data record not found
     C   90                MOVEL'PRK0566' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGE5CD    WUE5CD           CCC Commodity M
     C                     MOVELWGE6CD    WUE6CD           CCC Commodity P
     C                     MOVELWGJ9TX    WUJ9TX           CCC Market Date
      * Rtv CMP Info          RT - Carcass Merit Program  * 
     C                     EXSR SKRVGN
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv CMP Info          RT - Carcass Merit Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WHAMCD           CMP Program Cod
      * Setup key
     C                     MOVELWUE8CD    WHAMCD           CMP Program Cod
      * Establish starting position
     C           KRSSK     CHAIN@ARREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUA3TX           CMP Description
     C                     MOVEL*BLANK    WUDLST           CMP Grading Typ
     C                     MOVEL*BLANK    WUDMST           CMP Sort Basis
     C                     MOVEL*BLANK    WUDQST           CMP Carc Wgt Ty
     C                     Z-ADD*ZERO     WUAZPC           CMP Std Lean Pe
     C                     Z-ADD*ZERO     WUA0PC           CMP Lean Factor
     C                     MOVEL*BLANK    WUDTST           CMP Optimal Row
     C                     MOVEL*BLANK    WUF5ST           CMP Type
     C                     Z-ADD*ZERO     WUI1PR           CMP Market Add/
     C                     MOVEL*BLANK    WUAJST           RS Record Statu
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHA3TX    WUA3TX           CMP Description
     C                     MOVELWHDLST    WUDLST           CMP Grading Typ
     C                     MOVELWHDMST    WUDMST           CMP Sort Basis
     C                     MOVELWHDQST    WUDQST           CMP Carc Wgt Ty
     C                     Z-ADDWHAZPC    WUAZPC           CMP Std Lean Pe
     C                     Z-ADDWHA0PC    WUA0PC           CMP Lean Factor
     C                     MOVELWHDTST    WUDTST           CMP Optimal Row
     C                     MOVELWHF5ST    WUF5ST           CMP Type
     C                     Z-ADDWHI1PR    WUI1PR           CMP Market Add/
     C                     MOVELWHAJST    WUAJST           RS Record Statu
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * Chg Tattoo Summary    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0279  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0280 10        TH Group Refere
     C                     MOVEL*BLANK    WN0281  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0282  52       TH Live Purchas
     C                     MOVEL*BLANK    WN0283  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0284  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0285  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0286  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0287  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0288  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0289  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0290  50       TH Held Over
     C                     Z-ADD*ZERO     WN0291  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0292  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0293  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0294  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0295  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0296  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0297  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0298  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0299  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0300  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0301  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0302  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0303  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0304  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0305  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0306  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0307  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0308  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0309  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0310  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0311  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0312  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0313  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0314  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0315  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0316  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0317  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0318  1        TH Header Error
     C                     MOVEL*BLANK    WN0319  1        TH Detail Error
     C                     MOVEL*BLANK    WN0320  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0321  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0322  80       TH Commission A
     C                     Z-ADD*ZERO     WN0323  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0324  1        TH User Error O
     C                     MOVEL*BLANK    WN0325  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0326  1        TH Sex
     C                     Z-ADD*ZERO     WN0327  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0328  70       TH Commission P
     C                     Z-ADD*ZERO     WN0329  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0330  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0331  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0332  31       TH FFLI
     C                     Z-ADD*ZERO     WN0333  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0334  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0335  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0336  50       TH Head Exclude
     C                     MOVEL*BLANK    WN0337  1        TH Source Type
     C                     MOVEL*BLANK    WN0338  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0339  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0340  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0341  3        TH Source Code
     C                     MOVEL*BLANK    WN0342  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0343  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0344  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0345  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0346  3        TH State
     C                     MOVEL*BLANK    WN0347  3        TH Unused Code
     C                     MOVEL*BLANK    WN0348  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0349  1        TH Commission S
     C                     MOVEL*BLANK    WN0350  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0351  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0352  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0353  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0354  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0355  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0356  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0357  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0358  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0359  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0360  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0361  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0362  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0363  3        TH PHA Average
     C                     MOVEL*BLANK    WN0364  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0365  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0366  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0367  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0368  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0369  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0370  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0371  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0372  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0373  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0374  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0375  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0376  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0377 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0378 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0379 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0380 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0381  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0382  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0383  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0384  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0385  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0386  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0387  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0388  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0389  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0390  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0391  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0392  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0393  70       TH Unused Date
     C                     MOVEL*BLANK    WN0394  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0395  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0396  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0397  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0398  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0399  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0400  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0401  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0402  6        DF Defect Code
     C                     MOVEL*BLANK    WN0403  6        THP Process Cod
     C                     MOVEL*BLANK    WN0404  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0405  6        PL Location Cod
     C                     MOVEL*BLANK    WN0406  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0407  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0408  3        HC Class Code
     C                     MOVEL*BLANK    WN0409 10        RS User Changed
     C                     Z-ADD*ZERO     WN0410  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0411  60       RS Time Changed
     C                     MOVEL*BLANK    WN0412  1        RS Record Statu
     C                     MOVEL*BLANK    WN0413 10        RS Job
     C                     MOVEL*BLANK    WN0414 10        RS Program
     C                     MOVEL*BLANK    WN0415 10        RS User Added
     C                     Z-ADD*ZERO     WN0416  70       RS Date Added
     C                     Z-ADD*ZERO     WN0417  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWBHMNB    WFHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WFBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WFBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WFCVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WFB0DT           TH Kill Date
      *
     C           KLCHSL    KLIST
     C                     KFLD           WFHMNB           BOH Company Num
     C                     KFLD           WFBNNB           BOH Buy Order N
     C                     KFLD           WFBONB           BOL Load Number
     C                     KFLD           WFCVNB           TH Tattoo Numbe
     C                     KFLD           WFB0DT           TH Kill Date
     C           KLCHSL    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YCRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWBB9PR    WFB9PR           TH Live Gross A
     C                     Z-ADDWBCAPR    WFCAPR           TH LIve Net Amt
     C                     Z-ADDWBAVPC    WFAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WFA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WFB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WFAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WFANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WFAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WFAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WFAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WFAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WFAPPR           TH CM Carcass G
     C                     Z-ADDWBCBPR    WFCBPR           TH Payment Gros
     C                     Z-ADDWBCCPR    WFCCPR           Th Payment Net
     C                     Z-ADDWBLPNB    WFLPNB           TH AP Voucher/D
     C                     Z-ADDWBCDPR    WFCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WFD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WFD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WFD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WFD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WFEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WFEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WFECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WFEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WFEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WFEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WFEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WFEHPR           TH CM Gross Car
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WFAAVN           RS User Changed
     C                     Z-ADD##JDT     WFAADT           RS Date Changed
     C                     Z-ADD##JTM     WFAMTM           RS Time Changed
     C                     MOVEL##JOB     WFAHVN           RS Job
     C                     MOVEL##PGM     WFAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Competitors Comm   RT - Competitors Commodity  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WGTNNB           CCC Record
      * Setup key
     C                     Z-ADD00001     WGTNNB           CCC Record
      * Establish starting position
     C           KRSSM     CHAIN@DERETE              90    *
      * Data record not found
     C   90                MOVEL'PRK0566' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGE5CD    WUE5CD           CCC Commodity M
     C                     MOVELWGE6CD    WUE6CD           CCC Commodity P
     C                     MOVELWGJ9TX    WUJ9TX           CCC Market Date
      * Rtv CMP Info          RT - Carcass Merit Program  * 
     C                     EXSR SNRVGN
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv CMP Info          RT - Carcass Merit Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WHAMCD           CMP Program Cod
      * Setup key
     C                     MOVELWUE9CD    WHAMCD           CMP Program Cod
      * Establish starting position
     C           KRSSN     CHAIN@ARREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUA3TX           CMP Description
     C                     MOVEL*BLANK    WUDLST           CMP Grading Typ
     C                     MOVEL*BLANK    WUDMST           CMP Sort Basis
     C                     MOVEL*BLANK    WUDQST           CMP Carc Wgt Ty
     C                     Z-ADD*ZERO     WUAZPC           CMP Std Lean Pe
     C                     Z-ADD*ZERO     WUA0PC           CMP Lean Factor
     C                     MOVEL*BLANK    WUDTST           CMP Optimal Row
     C                     MOVEL*BLANK    WUF5ST           CMP Type
     C                     Z-ADD*ZERO     WUI1PR           CMP Market Add/
     C                     MOVEL*BLANK    WUAJST           RS Record Statu
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHA3TX    WUA3TX           CMP Description
     C                     MOVELWHDLST    WUDLST           CMP Grading Typ
     C                     MOVELWHDMST    WUDMST           CMP Sort Basis
     C                     MOVELWHDQST    WUDQST           CMP Carc Wgt Ty
     C                     Z-ADDWHAZPC    WUAZPC           CMP Std Lean Pe
     C                     Z-ADDWHA0PC    WUA0PC           CMP Lean Factor
     C                     MOVELWHDTST    WUDTST           CMP Optimal Row
     C                     MOVELWHF5ST    WUF5ST           CMP Type
     C                     Z-ADDWHI1PR    WUI1PR           CMP Market Add/
     C                     MOVELWHAJST    WUAJST           RS Record Statu
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv PrchPrc Clc Info  RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADDWBHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WEBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSSO     CHAIN@AWCPBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0049' W0RTN   7
      * USER: Processing if Data record not found
      * 1/28/08 SLM LEFT OVER INFORMATION MAY HAVE CAUSED ISSUES
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAAPR           BOH Market Add/
     C                     MOVEL*BLANK    WUB3ST           BOH Quote Price
     C                     Z-ADD*ZERO     WUALPR           BOH Quoted Base
     C                     MOVEL*BLANK    WUETCD           BOH Commodity M
     C                     MOVEL*BLANK    WUEUCD           BOH Commodity P
     C                     MOVEL*BLANK    WUJ5TX           BOH Market Date
     C                     MOVEL*BLANK    WUAKCD           PC Contract Cod
     C                     MOVEL*BLANK    WUALCD           PSC Sub-Contrac
     C                     MOVEL*BLANK    WUAICD           PO Option Code
     C                     MOVEL*BLANK    WUAMCD           CMP Program Cod
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEAAPR    WUAAPR           BOH Market Add/
     C                     MOVELWEB3ST    WUB3ST           BOH Quote Price
     C                     Z-ADDWEALPR    WUALPR           BOH Quoted Base
     C                     MOVELWEETCD    WUETCD           BOH Commodity M
     C                     MOVELWEEUCD    WUEUCD           BOH Commodity P
     C                     MOVELWEJ5TX    WUJ5TX           BOH Market Date
     C                     MOVELWEAKCD    WUAKCD           PC Contract Cod
     C                     MOVELWEALCD    WUALCD           PSC Sub-Contrac
     C                     MOVELWEAICD    WUAICD           PO Option Code
     C                     MOVELWEAMCD    WUAMCD           CMP Program Cod
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv PurchPrc Clc Info RT - Producer Sub-Contract  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WIAKCD           PC Contract Cod
     C                     KFLD           WIALCD           PSC Sub-Contrac
      * Setup key
     C                     MOVELWUAKCD    WIAKCD           PC Contract Cod
     C                     MOVELWUALCD    WIALCD           PSC Sub-Contrac
      * Establish starting position
     C           KRSSP     CHAIN@AQCPA0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0037' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAZPR           PSC Floor Price
     C                     Z-ADD*ZERO     WUA0PR           PSC Ceiling Pri
     C                     Z-ADD*ZERO     WUA9PC           PSC Market Perc
     C                     Z-ADD*ZERO     WUA7PR           PSC Break Even
     C                     Z-ADD*ZERO     WUA8PR           PSC FLoor Price
     C                     MOVEL*BLANK    WUF3ST           PSC Sub-Contrac
     C                     Z-ADD*ZERO     WUA9PR           PSC Mkt Percent
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWIAZPR    WUAZPR           PSC Floor Price
     C                     Z-ADDWIA0PR    WUA0PR           PSC Ceiling Pri
     C                     Z-ADDWIA9PC    WUA9PC           PSC Market Perc
     C                     Z-ADDWIA7PR    WUA7PR           PSC Break Even
     C                     Z-ADDWIA8PR    WUA8PR           PSC FLoor Price
     C                     MOVELWIF3ST    WUF3ST           PSC Sub-Contrac
     C                     Z-ADDWIA9PR    WUA9PR           PSC Mkt Percent
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv CMP SBD Standard  RT - Carcass Merit Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJF5ST    WQSQ01           CMP Type
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           CMP Type
      * Setup key
     C                     MOVEL'S'       WQSQ01           CMP Type
      * Establish starting position
     C           KRSSQ     SETLL@ARREK1                    *
     C           KRSSQ     READE@ARREK1                  90*
      * Data record not found
     C   90                MOVEL'PRK0039' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELWJAMCD    WUAMCD           CMP Program Cod
     C           KRSSQ     READE@ARREK1                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCHRC    BEGSR
      *================================================================
      * Chg Tattoo Summary    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0418  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0419 10        TH Group Refere
     C                     MOVEL*BLANK    WN0420  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0421  52       TH Live Purchas
     C                     MOVEL*BLANK    WN0422  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0423  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0424  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0425  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0426  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0427  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0428  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0429  50       TH Held Over
     C                     Z-ADD*ZERO     WN0430  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0431  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0432  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0433  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0434  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0435  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0436  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0437  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0438  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0439  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0440  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0441  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0442  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0443  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0444  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0445  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0446  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0447  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0448  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0449  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0450  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0451  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0452  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0453  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0454  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0455  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0456  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0457  1        TH Header Error
     C                     MOVEL*BLANK    WN0458  1        TH Detail Error
     C                     MOVEL*BLANK    WN0459  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0460  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0461  80       TH Commission A
     C                     Z-ADD*ZERO     WN0462  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0463  1        TH User Error O
     C                     MOVEL*BLANK    WN0464  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0465  1        TH Sex
     C                     Z-ADD*ZERO     WN0466  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0467  70       TH Commission P
     C                     Z-ADD*ZERO     WN0468  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0469  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0470  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0471  31       TH FFLI
     C                     Z-ADD*ZERO     WN0472  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0473  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0474  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0475  50       TH Head Exclude
     C                     MOVEL*BLANK    WN0476  1        TH Source Type
     C                     MOVEL*BLANK    WN0477  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0478  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0479  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0480  3        TH Source Code
     C                     MOVEL*BLANK    WN0481  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0482  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0483  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0484  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0485  3        TH State
     C                     MOVEL*BLANK    WN0486  3        TH Unused Code
     C                     MOVEL*BLANK    WN0487  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0488  1        TH Commission S
     C                     MOVEL*BLANK    WN0489  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0490  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0491  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0492  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0493  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0494  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0495  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0496  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0497  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0498  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0499  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0500  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0501  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0502  3        TH PHA Average
     C                     MOVEL*BLANK    WN0503  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0504  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0505  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0506  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0507  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0508  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0509  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0510  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0511  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0512  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0513  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0514  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0515  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0516 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0517 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0518 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0519 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0520  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0521  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0522  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0523  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0524  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0525  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0526  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0527  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0528  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0529  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0530  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0531  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0532  70       TH Unused Date
     C                     MOVEL*BLANK    WN0533  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0534  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0535  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0536  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0537  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0538  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0539  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0540  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0541  6        DF Defect Code
     C                     MOVEL*BLANK    WN0542  6        THP Process Cod
     C                     MOVEL*BLANK    WN0543  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0544  6        PL Location Cod
     C                     MOVEL*BLANK    WN0545  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0546  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0547  3        HC Class Code
     C                     MOVEL*BLANK    WN0548 10        RS User Changed
     C                     Z-ADD*ZERO     WN0549  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0550  60       RS Time Changed
     C                     MOVEL*BLANK    WN0551  1        RS Record Statu
     C                     MOVEL*BLANK    WN0552 10        RS Job
     C                     MOVEL*BLANK    WN0553 10        RS Program
     C                     MOVEL*BLANK    WN0554 10        RS User Added
     C                     Z-ADD*ZERO     WN0555  70       RS Date Added
     C                     Z-ADD*ZERO     WN0556  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWBHMNB    WFHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WFBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WFBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WFCVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WFB0DT           TH Kill Date
      *
     C           KLCHSR    KLIST
     C                     KFLD           WFHMNB           BOH Company Num
     C                     KFLD           WFBNNB           BOH Buy Order N
     C                     KFLD           WFBONB           BOL Load Number
     C                     KFLD           WFCVNB           TH Tattoo Numbe
     C                     KFLD           WFB0DT           TH Kill Date
     C           KLCHSR    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YDRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWBB9PR    WFB9PR           TH Live Gross A
     C                     Z-ADDWBCAPR    WFCAPR           TH LIve Net Amt
     C                     Z-ADDWBAVPC    WFAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WFA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WFB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WFAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WFANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WFAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WFAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WFAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WFAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WFAPPR           TH CM Carcass G
     C                     Z-ADDWBCBPR    WFCBPR           TH Payment Gros
     C                     Z-ADDWBCCPR    WFCCPR           Th Payment Net
     C                     Z-ADDWBLPNB    WFLPNB           TH AP Voucher/D
     C                     Z-ADDWBCDPR    WFCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WFD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WFD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WFD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WFD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WFEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WFEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WFECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WFEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WFEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WFEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WFEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WFEHPR           TH CM Gross Car
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WFAAVN           RS User Changed
     C                     Z-ADD##JDT     WFAADT           RS Date Changed
     C                     Z-ADD##JTM     WFAMTM           RS Time Changed
     C                     MOVEL##JOB     WFAHVN           RS Job
     C                     MOVEL##PGM     WFAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCHRC    BEGSR
      *================================================================
      * Chg Tattoo Summary    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0557  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0558 10        TH Group Refere
     C                     MOVEL*BLANK    WN0559  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0560  52       TH Live Purchas
     C                     MOVEL*BLANK    WN0561  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0562  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0563  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0564  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0565  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0566  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0567  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0568  50       TH Held Over
     C                     Z-ADD*ZERO     WN0569  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0570  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0571  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0572  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0573  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0574  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0575  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0576  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0577  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0578  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0579  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0580  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0581  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0582  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0583  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0584  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0585  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0586  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0587  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0588  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0589  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0590  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0591  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0592  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0593  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0594  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0595  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0596  1        TH Header Error
     C                     MOVEL*BLANK    WN0597  1        TH Detail Error
     C                     MOVEL*BLANK    WN0598  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0599  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0600  80       TH Commission A
     C                     Z-ADD*ZERO     WN0601  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0602  1        TH User Error O
     C                     MOVEL*BLANK    WN0603  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0604  1        TH Sex
     C                     Z-ADD*ZERO     WN0605  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0606  70       TH Commission P
     C                     Z-ADD*ZERO     WN0607  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0608  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0609  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0610  31       TH FFLI
     C                     Z-ADD*ZERO     WN0611  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0612  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0613  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0614  50       TH Head Exclude
     C                     MOVEL*BLANK    WN0615  1        TH Source Type
     C                     MOVEL*BLANK    WN0616  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0617  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0618  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0619  3        TH Source Code
     C                     MOVEL*BLANK    WN0620  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0621  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0622  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0623  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0624  3        TH State
     C                     MOVEL*BLANK    WN0625  3        TH Unused Code
     C                     MOVEL*BLANK    WN0626  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0627  1        TH Commission S
     C                     MOVEL*BLANK    WN0628  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0629  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0630  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0631  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0632  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0633  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0634  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0635  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0636  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0637  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0638  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0639  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0640  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0641  3        TH PHA Average
     C                     MOVEL*BLANK    WN0642  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0643  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0644  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0645  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0646  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0647  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0648  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0649  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0650  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0651  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0652  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0653  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0654  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0655 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0656 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0657 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0658 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0659  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0660  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0661  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0662  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0663  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0664  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0665  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0666  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0667  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0668  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0669  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0670  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0671  70       TH Unused Date
     C                     MOVEL*BLANK    WN0672  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0673  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0674  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0675  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0676  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0677  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0678  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0679  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0680  6        DF Defect Code
     C                     MOVEL*BLANK    WN0681  6        THP Process Cod
     C                     MOVEL*BLANK    WN0682  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0683  6        PL Location Cod
     C                     MOVEL*BLANK    WN0684  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0685  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0686  3        HC Class Code
     C                     MOVEL*BLANK    WN0687 10        RS User Changed
     C                     Z-ADD*ZERO     WN0688  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0689  60       RS Time Changed
     C                     MOVEL*BLANK    WN0690  1        RS Record Statu
     C                     MOVEL*BLANK    WN0691 10        RS Job
     C                     MOVEL*BLANK    WN0692 10        RS Program
     C                     MOVEL*BLANK    WN0693 10        RS User Added
     C                     Z-ADD*ZERO     WN0694  70       RS Date Added
     C                     Z-ADD*ZERO     WN0695  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWBHMNB    WFHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WFBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WFBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WFCVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WFB0DT           TH Kill Date
      *
     C           KLCHSS    KLIST
     C                     KFLD           WFHMNB           BOH Company Num
     C                     KFLD           WFBNNB           BOH Buy Order N
     C                     KFLD           WFBONB           BOL Load Number
     C                     KFLD           WFCVNB           TH Tattoo Numbe
     C                     KFLD           WFB0DT           TH Kill Date
     C           KLCHSS    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YERDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWBB9PR    WFB9PR           TH Live Gross A
     C                     Z-ADDWBCAPR    WFCAPR           TH LIve Net Amt
     C                     Z-ADDWBAVPC    WFAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WFA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WFB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WFAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WFANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WFAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WFAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WFAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WFAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WFAPPR           TH CM Carcass G
     C                     Z-ADDWBCBPR    WFCBPR           TH Payment Gros
     C                     Z-ADDWBCCPR    WFCCPR           Th Payment Net
     C                     Z-ADDWBLPNB    WFLPNB           TH AP Voucher/D
     C                     Z-ADDWBCDPR    WFCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WFD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WFD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WFD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WFD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WFEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WFEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WFECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WFEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WFEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WFEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WFEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WFEHPR           TH CM Gross Car
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WFAAVN           RS User Changed
     C                     Z-ADD##JDT     WFAADT           RS Date Changed
     C                     Z-ADD##JTM     WFAMTM           RS Time Changed
     C                     MOVEL##JOB     WFAHVN           RS Job
     C                     MOVEL##PGM     WFAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCHRC    BEGSR
      *================================================================
      * Chg Tattoo Summary    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0696  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0697 10        TH Group Refere
     C                     MOVEL*BLANK    WN0698  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0699  52       TH Live Purchas
     C                     MOVEL*BLANK    WN0700  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0701  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0702  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0703  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0704  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0705  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0706  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0707  50       TH Held Over
     C                     Z-ADD*ZERO     WN0708  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0709  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0710  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0711  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0712  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0713  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0714  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0715  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0716  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0717  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0718  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0719  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0720  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0721  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0722  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0723  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0724  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0725  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0726  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0727  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0728  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0729  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0730  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0731  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0732  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0733  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0734  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0735  1        TH Header Error
     C                     MOVEL*BLANK    WN0736  1        TH Detail Error
     C                     MOVEL*BLANK    WN0737  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0738  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0739  80       TH Commission A
     C                     Z-ADD*ZERO     WN0740  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0741  1        TH User Error O
     C                     MOVEL*BLANK    WN0742  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0743  1        TH Sex
     C                     Z-ADD*ZERO     WN0744  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0745  70       TH Commission P
     C                     Z-ADD*ZERO     WN0746  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0747  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0748  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0749  31       TH FFLI
     C                     Z-ADD*ZERO     WN0750  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0751  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0752  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0753  50       TH Head Exclude
     C                     MOVEL*BLANK    WN0754  1        TH Source Type
     C                     MOVEL*BLANK    WN0755  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0756  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0757  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0758  3        TH Source Code
     C                     MOVEL*BLANK    WN0759  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0760  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0761  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0762  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0763  3        TH State
     C                     MOVEL*BLANK    WN0764  3        TH Unused Code
     C                     MOVEL*BLANK    WN0765  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0766  1        TH Commission S
     C                     MOVEL*BLANK    WN0767  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0768  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0769  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0770  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0771  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0772  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0773  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0774  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0775  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0776  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0777  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0778  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0779  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0780  3        TH PHA Average
     C                     MOVEL*BLANK    WN0781  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0782  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0783  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0784  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0785  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0786  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0787  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0788  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0789  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0790  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0791  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0792  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0793  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0794 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0795 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0796 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0797 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0798  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0799  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0800  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0801  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0802  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0803  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0804  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0805  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0806  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0807  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0808  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0809  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0810  70       TH Unused Date
     C                     MOVEL*BLANK    WN0811  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0812  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0813  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0814  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0815  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0816  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0817  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0818  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0819  6        DF Defect Code
     C                     MOVEL*BLANK    WN0820  6        THP Process Cod
     C                     MOVEL*BLANK    WN0821  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0822  6        PL Location Cod
     C                     MOVEL*BLANK    WN0823  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0824  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0825  3        HC Class Code
     C                     MOVEL*BLANK    WN0826 10        RS User Changed
     C                     Z-ADD*ZERO     WN0827  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0828  60       RS Time Changed
     C                     MOVEL*BLANK    WN0829  1        RS Record Statu
     C                     MOVEL*BLANK    WN0830 10        RS Job
     C                     MOVEL*BLANK    WN0831 10        RS Program
     C                     MOVEL*BLANK    WN0832 10        RS User Added
     C                     Z-ADD*ZERO     WN0833  70       RS Date Added
     C                     Z-ADD*ZERO     WN0834  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWBHMNB    WFHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WFBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WFBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WFCVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WFB0DT           TH Kill Date
      *
     C           KLCHST    KLIST
     C                     KFLD           WFHMNB           BOH Company Num
     C                     KFLD           WFBNNB           BOH Buy Order N
     C                     KFLD           WFBONB           BOL Load Number
     C                     KFLD           WFCVNB           TH Tattoo Numbe
     C                     KFLD           WFB0DT           TH Kill Date
     C           KLCHST    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YFRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWBB9PR    WFB9PR           TH Live Gross A
     C                     Z-ADDWBCAPR    WFCAPR           TH LIve Net Amt
     C                     Z-ADDWBAVPC    WFAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WFA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WFB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WFAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WFANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WFAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WFAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WFAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WFAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WFAPPR           TH CM Carcass G
     C                     Z-ADDWBCBPR    WFCBPR           TH Payment Gros
     C                     Z-ADDWBCCPR    WFCCPR           Th Payment Net
     C                     Z-ADDWBLPNB    WFLPNB           TH AP Voucher/D
     C                     Z-ADDWBCDPR    WFCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WFD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WFD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WFD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WFD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WFEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WFEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WFECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WFEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WFEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WFEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WFEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WFEHPR           TH CM Gross Car
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WFAAVN           RS User Changed
     C                     Z-ADD##JDT     WFAADT           RS Date Changed
     C                     Z-ADD##JTM     WFAMTM           RS Time Changed
     C                     MOVEL##JOB     WFAHVN           RS Job
     C                     MOVEL##PGM     WFAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * E3814 JJH 10/07/15 - Recompile because PS Premises ID added to
      *   Producer Site. - No logic changes.
      * H16853 ISE 11/02/2020 CHANGE BUY ORDER NUMBER FIELD LENGTH FROM 5
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Competitor 1
      *================================================================
      * CASE: PAR.Competitors Code 1 Usr NE WRK.Blank USR
     C           WUE7CD    IFNE WUCRTX                     *IF
      * CASE: PAR.TH Head Killed is Not Zero
     C           WBFENB    IFNE 0                          *IF
      * Rtv Competitors Comm   RT - Competitors Commodity  * 
     C                     EXSR SGRVGN
      * Carcass Merit Process  XF - STR Batch Processing  * 
     C                     CALL 'PKXNXFR'              90  Carcass Merit P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBBNNB    WQ0006  70       BOH Buy Order N
     C                     PARM WBBONB    WQ0007  50       BOL Load Number
     C                     PARM WBCVNB    WQ0008  50       TH Tattoo Numbe
     C                     PARM WBAWDT    WQ0009  70       TH Purchase Dat
     C                     PARM WBCYNB    WQ0010  71       TH Live Wgt
     C           WUAMPR    PARM WUAMPR    WQ0011  52       TH CM Base Mkt
     C                     PARM WBB0DT    WQ0012  70       TH Kill Date
     C                     PARM WBHMNB    WQ0013  30       BOH Company Num
     C                     PARM *ZERO     WQ0014  52       PSC Floor Price
     C                     PARM *ZERO     WQ0015  52       PSC Ceiling Pri
     C                     PARM *ZERO     WQ0016  30       PSC Market Perc
     C                     PARM *ZERO     WQ0017  52       PSC Mkt Percent
     C           WUB8PR    PARM WUB8PR    WQ0018  52       Market Price US
     C                     PARM 'CBP'     WQ0019  3        PO Option Code
     C                     PARM *BLANK    WQ0020  5        PC Contract Cod
     C                     PARM *BLANK    WQ0021  5        PSC Sub-Contrac
     C                     PARM WUI1PR    WQ0022  52       BOH Market Add/
     C                     PARM WUE7CD    WQ0023  3        CMP Program Cod
     C                     PARM 'LP'      WQ0024  2        BOH Quote Price
     C                     PARM *ZERO     WQ0025  52       BOH Quoted Base
     C                     PARM WUE5CD    WQ0026  3        BOH Commodity M
     C                     PARM WUE6CD    WQ0027  7        BOH Commodity P
     C                     PARM WUJ9TX    WQ0028  3        BOH Market Date
     C                     PARM WBFENB    WQ0029  50       TH Head Killed
     C                     PARM WBHENB    WQ0030  50       TH Head Adds
     C                     PARM WBAWPC    WQ0031  52       TH Actual Yield
     C                     PARM WBCWPC    WQ0032  52       TH Adj Actual Y
     C                     PARM WBB8PR    WQ0033  52       TH CM Market Pr
     C                     PARM WBHHNB    WQ0034  71       TH Avg Hot Wgt
     C                     PARM WBJ9NB    WQ0035  50       TH Head Exclude
     C                     PARM WBKAST    WQ0036  1        TH Source Type
     C                     PARM WBJ9ST    WQ0037  1        TH Payment Type
     C                     PARM WBS9PR    WQ0038  52       TH PHA Lean Prm
     C           YL0001    PARM YL0001    WQ0039  52       TH VC Gross Val
     C                     PARM WBOMVJ    WQ0040  52       TH PHA Sort Dis
     C                     PARM 'Y'       WQ0041  1        Competitors Pro
     C                     PARM 'P'       WQ0042  1        CM Processing T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKXNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PRT Tattoo Header - Tattoo Header  * 
     C                     CLEARPARC
     C                     Z-ADDWBHMNB    PAHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    PABNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    PABONB           BOL Load Number
     C                     Z-ADDWBCVNB    PACVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    PAB0DT           TH Kill Date
      *
     C                     CALL 'PKXUPFR'              90  PRT Tattoo Head
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Tattoo Hea
     C                     PARM WUE7CD    WQ0043  3        CMP Program Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKXUPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Competitor 2
      *================================================================
      * CASE: PAR.Competitors Code 2 Usr NE WRK.Blank USR
     C           WUE8CD    IFNE WUCRTX                     *IF
      * Chg Tattoo Summary    CH - Tattoo Header  * 
     C                     EXSR SICHRC
      * CASE: PAR.TH Head Killed is Not Zero
     C           WBFENB    IFNE 0                          *IF
      * Rtv Competitors Comm   RT - Competitors Commodity  * 
     C                     EXSR SJRVGN
      * Carcass Merit Process  XF - STR Batch Processing  * 
     C                     CALL 'PKXNXFR'              90  Carcass Merit P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBBNNB    WQ0044  70       BOH Buy Order N
     C                     PARM WBBONB    WQ0045  50       BOL Load Number
     C                     PARM WBCVNB    WQ0046  50       TH Tattoo Numbe
     C                     PARM WBAWDT    WQ0047  70       TH Purchase Dat
     C                     PARM WBCYNB    WQ0048  71       TH Live Wgt
     C           WUAMPR    PARM WUAMPR    WQ0049  52       TH CM Base Mkt
     C                     PARM WBB0DT    WQ0050  70       TH Kill Date
     C                     PARM WBHMNB    WQ0051  30       BOH Company Num
     C                     PARM *ZERO     WQ0052  52       PSC Floor Price
     C                     PARM *ZERO     WQ0053  52       PSC Ceiling Pri
     C                     PARM *ZERO     WQ0054  30       PSC Market Perc
     C                     PARM *ZERO     WQ0055  52       PSC Mkt Percent
     C           WUB8PR    PARM WUB8PR    WQ0056  52       Market Price US
     C                     PARM 'CBP'     WQ0057  3        PO Option Code
     C                     PARM *BLANK    WQ0058  5        PC Contract Cod
     C                     PARM *BLANK    WQ0059  5        PSC Sub-Contrac
     C                     PARM WUI1PR    WQ0060  52       BOH Market Add/
     C                     PARM WUE8CD    WQ0061  3        CMP Program Cod
     C                     PARM 'LP'      WQ0062  2        BOH Quote Price
     C                     PARM *ZERO     WQ0063  52       BOH Quoted Base
     C                     PARM WUE5CD    WQ0064  3        BOH Commodity M
     C                     PARM WUE6CD    WQ0065  7        BOH Commodity P
     C                     PARM WUJ9TX    WQ0066  3        BOH Market Date
     C                     PARM WBFENB    WQ0067  50       TH Head Killed
     C                     PARM WBHENB    WQ0068  50       TH Head Adds
     C                     PARM WBAWPC    WQ0069  52       TH Actual Yield
     C                     PARM WBCWPC    WQ0070  52       TH Adj Actual Y
     C                     PARM WBB8PR    WQ0071  52       TH CM Market Pr
     C                     PARM WBHHNB    WQ0072  71       TH Avg Hot Wgt
     C                     PARM WBJ9NB    WQ0073  50       TH Head Exclude
     C                     PARM WBKAST    WQ0074  1        TH Source Type
     C                     PARM WBJ9ST    WQ0075  1        TH Payment Type
     C                     PARM WBS9PR    WQ0076  52       TH PHA Lean Prm
     C           YL0001    PARM YL0001    WQ0077  52       TH VC Gross Val
     C                     PARM WBOMVJ    WQ0078  52       TH PHA Sort Dis
     C                     PARM 'Y'       WQ0079  1        Competitors Pro
     C                     PARM 'P'       WQ0080  1        CM Processing T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKXNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PRT Tattoo Header - Tattoo Header  * 
     C                     CLEARPARC
     C                     Z-ADDWBHMNB    PAHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    PABNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    PABONB           BOL Load Number
     C                     Z-ADDWBCVNB    PACVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    PAB0DT           TH Kill Date
      *
     C                     CALL 'PKXUPFR'              90  PRT Tattoo Head
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Tattoo Hea
     C                     PARM WUE8CD    WQ0081  3        CMP Program Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKXUPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Competitor 3
      *================================================================
      * CASE: PAR.Competitors Code 3 Usr NE WRK.Blank USR
     C           WUE9CD    IFNE WUCRTX                     *IF
      * Chg Tattoo Summary    CH - Tattoo Header  * 
     C                     EXSR SLCHRC
      * CASE: PAR.TH Head Killed is Not Zero
     C           WBFENB    IFNE 0                          *IF
      * Rtv Competitors Comm   RT - Competitors Commodity  * 
     C                     EXSR SMRVGN
      * Carcass Merit Process  XF - STR Batch Processing  * 
     C                     CALL 'PKXNXFR'              90  Carcass Merit P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBBNNB    WQ0082  70       BOH Buy Order N
     C                     PARM WBBONB    WQ0083  50       BOL Load Number
     C                     PARM WBCVNB    WQ0084  50       TH Tattoo Numbe
     C                     PARM WBAWDT    WQ0085  70       TH Purchase Dat
     C                     PARM WBCYNB    WQ0086  71       TH Live Wgt
     C           WUAMPR    PARM WUAMPR    WQ0087  52       TH CM Base Mkt
     C                     PARM WBB0DT    WQ0088  70       TH Kill Date
     C                     PARM WBHMNB    WQ0089  30       BOH Company Num
     C                     PARM *ZERO     WQ0090  52       PSC Floor Price
     C                     PARM *ZERO     WQ0091  52       PSC Ceiling Pri
     C                     PARM *ZERO     WQ0092  30       PSC Market Perc
     C                     PARM *ZERO     WQ0093  52       PSC Mkt Percent
     C           WUB8PR    PARM WUB8PR    WQ0094  52       Market Price US
     C                     PARM 'CBP'     WQ0095  3        PO Option Code
     C                     PARM *BLANK    WQ0096  5        PC Contract Cod
     C                     PARM *BLANK    WQ0097  5        PSC Sub-Contrac
     C                     PARM WUI1PR    WQ0098  52       BOH Market Add/
     C                     PARM WUE9CD    WQ0099  3        CMP Program Cod
     C                     PARM 'LP'      WQ0100  2        BOH Quote Price
     C                     PARM *ZERO     WQ0101  52       BOH Quoted Base
     C                     PARM WUE5CD    WQ0102  3        BOH Commodity M
     C                     PARM WUE6CD    WQ0103  7        BOH Commodity P
     C                     PARM WUJ9TX    WQ0104  3        BOH Market Date
     C                     PARM WBFENB    WQ0105  50       TH Head Killed
     C                     PARM WBHENB    WQ0106  50       TH Head Adds
     C                     PARM WBAWPC    WQ0107  52       TH Actual Yield
     C                     PARM WBCWPC    WQ0108  52       TH Adj Actual Y
     C                     PARM WBB8PR    WQ0109  52       TH CM Market Pr
     C                     PARM WBHHNB    WQ0110  71       TH Avg Hot Wgt
     C                     PARM WBJ9NB    WQ0111  50       TH Head Exclude
     C                     PARM WBKAST    WQ0112  1        TH Source Type
     C                     PARM WBJ9ST    WQ0113  1        TH Payment Type
     C                     PARM WBS9PR    WQ0114  52       TH PHA Lean Prm
     C           YL0001    PARM YL0001    WQ0115  52       TH VC Gross Val
     C                     PARM WBOMVJ    WQ0116  52       TH PHA Sort Dis
     C                     PARM 'Y'       WQ0117  1        Competitors Pro
     C                     PARM 'P'       WQ0118  1        CM Processing T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKXNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PRT Tattoo Header - Tattoo Header  * 
     C                     CLEARPARC
     C                     Z-ADDWBHMNB    PAHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    PABNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    PABONB           BOL Load Number
     C                     Z-ADDWBCVNB    PACVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    PAB0DT           TH Kill Date
      *
     C                     CALL 'PKXUPFR'              90  PRT Tattoo Head
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Tattoo Hea
     C                     PARM WUE9CD    WQ0119  3        CMP Program Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKXUPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Analysis
      *================================================================
      * Chg Tattoo Summary    CH - Tattoo Header  * 
     C                     EXSR SRCHRC
      * CASE: PAR.TH Head Killed is Not Zero
     C           WBFENB    IFNE 0                          *IF
      * Carcass Merit Process  XF - STR Batch Processing  * 
     C                     CALL 'PKXNXFR'              90  Carcass Merit P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBBNNB    WQ0120  70       BOH Buy Order N
     C                     PARM WBBONB    WQ0121  50       BOL Load Number
     C                     PARM WBCVNB    WQ0122  50       TH Tattoo Numbe
     C                     PARM WBAWDT    WQ0123  70       TH Purchase Dat
     C                     PARM WBCYNB    WQ0124  71       TH Live Wgt
     C           WUAMPR    PARM WUAMPR    WQ0125  52       TH CM Base Mkt
     C                     PARM WBB0DT    WQ0126  70       TH Kill Date
     C                     PARM WBHMNB    WQ0127  30       BOH Company Num
     C                     PARM WUAZPR    WQ0128  52       PSC Floor Price
     C                     PARM WUA0PR    WQ0129  52       PSC Ceiling Pri
     C                     PARM WUA9PC    WQ0130  30       PSC Market Perc
     C                     PARM WUA9PR    WQ0131  52       PSC Mkt Percent
     C           WUB8PR    PARM WUB8PR    WQ0132  52       Market Price US
     C                     PARM WUAICD    WQ0133  3        PO Option Code
     C                     PARM WUAKCD    WQ0134  5        PC Contract Cod
     C                     PARM WUALCD    WQ0135  5        PSC Sub-Contrac
     C                     PARM WUAAPR    WQ0136  52       BOH Market Add/
     C                     PARM WUAMCD    WQ0137  3        CMP Program Cod
     C                     PARM WUB3ST    WQ0138  2        BOH Quote Price
     C                     PARM WUALPR    WQ0139  52       BOH Quoted Base
     C                     PARM WUETCD    WQ0140  3        BOH Commodity M
     C                     PARM WUEUCD    WQ0141  7        BOH Commodity P
     C                     PARM WUJ5TX    WQ0142  3        BOH Market Date
     C                     PARM WBFENB    WQ0143  50       TH Head Killed
     C                     PARM WBHENB    WQ0144  50       TH Head Adds
     C                     PARM WBAWPC    WQ0145  52       TH Actual Yield
     C                     PARM WBCWPC    WQ0146  52       TH Adj Actual Y
     C                     PARM WBB8PR    WQ0147  52       TH CM Market Pr
     C                     PARM WBHHNB    WQ0148  71       TH Avg Hot Wgt
     C                     PARM WBJ9NB    WQ0149  50       TH Head Exclude
     C                     PARM WBKAST    WQ0150  1        TH Source Type
     C                     PARM WBJ9ST    WQ0151  1        TH Payment Type
     C                     PARM WBS9PR    WQ0152  52       TH PHA Lean Prm
     C           YL0001    PARM YL0001    WQ0153  52       TH VC Gross Val
     C                     PARM WBOMVJ    WQ0154  52       TH PHA Sort Dis
     C                     PARM 'N'       WQ0155  1        Competitors Pro
     C                     PARM 'A'       WQ0156  1        CM Processing T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKXNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PRT Tattoo Header - Tattoo Header  * 
     C                     CLEARPARC
     C                     Z-ADDWBHMNB    PAHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    PABNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    PABONB           BOL Load Number
     C                     Z-ADDWBCVNB    PACVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    PAB0DT           TH Kill Date
      *
     C                     CALL 'PKXUPFR'              90  PRT Tattoo Head
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Tattoo Hea
     C                     PARM WUAMCD    WQ0157  3        CMP Program Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKXUPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * NO Competitors last time with rules of payment
      *================================================================
      * Chg Tattoo Summary    CH - Tattoo Header  * 
     C                     EXSR SSCHRC
      *   ** HPE053P
      * FOR Carcass, call the XF even if Head Killed is 0, because
      *  we need the th cm base mkt price if Ins Reimb is to be calcd.
      * Head Killed is checked in the XF.
      * Carcass Merit Process  XF - STR Batch Processing  * 
     C                     CALL 'PKXNXFR'              90  Carcass Merit P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBBNNB    WQ0158  70       BOH Buy Order N
     C                     PARM WBBONB    WQ0159  50       BOL Load Number
     C                     PARM WBCVNB    WQ0160  50       TH Tattoo Numbe
     C                     PARM WBAWDT    WQ0161  70       TH Purchase Dat
     C                     PARM WBCYNB    WQ0162  71       TH Live Wgt
     C           WUAMPR    PARM WUAMPR    WQ0163  52       TH CM Base Mkt
     C                     PARM WBB0DT    WQ0164  70       TH Kill Date
     C                     PARM WBHMNB    WQ0165  30       BOH Company Num
     C                     PARM WUAZPR    WQ0166  52       PSC Floor Price
     C                     PARM WUA0PR    WQ0167  52       PSC Ceiling Pri
     C                     PARM WUA9PC    WQ0168  30       PSC Market Perc
     C                     PARM WUA9PR    WQ0169  52       PSC Mkt Percent
     C           WUB8PR    PARM WUB8PR    WQ0170  52       Market Price US
     C                     PARM WUAICD    WQ0171  3        PO Option Code
     C                     PARM WUAKCD    WQ0172  5        PC Contract Cod
     C                     PARM WUALCD    WQ0173  5        PSC Sub-Contrac
     C                     PARM WUAAPR    WQ0174  52       BOH Market Add/
     C                     PARM WUAMCD    WQ0175  3        CMP Program Cod
     C                     PARM WUB3ST    WQ0176  2        BOH Quote Price
     C                     PARM WUALPR    WQ0177  52       BOH Quoted Base
     C                     PARM WUETCD    WQ0178  3        BOH Commodity M
     C                     PARM WUEUCD    WQ0179  7        BOH Commodity P
     C                     PARM WUJ5TX    WQ0180  3        BOH Market Date
     C                     PARM WBFENB    WQ0181  50       TH Head Killed
     C                     PARM WBHENB    WQ0182  50       TH Head Adds
     C                     PARM WBAWPC    WQ0183  52       TH Actual Yield
     C                     PARM WBCWPC    WQ0184  52       TH Adj Actual Y
     C                     PARM WBB8PR    WQ0185  52       TH CM Market Pr
     C                     PARM WBHHNB    WQ0186  71       TH Avg Hot Wgt
     C                     PARM WBJ9NB    WQ0187  50       TH Head Exclude
     C                     PARM WBKAST    WQ0188  1        TH Source Type
     C                     PARM WBJ9ST    WQ0189  1        TH Payment Type
     C                     PARM WBS9PR    WQ0190  52       TH PHA Lean Prm
     C           YL0001    PARM YL0001    WQ0191  52       TH VC Gross Val
     C                     PARM WBOMVJ    WQ0192  52       TH PHA Sort Dis
     C                     PARM 'N'       WQ0193  1        Competitors Pro
     C                     PARM 'P'       WQ0194  1        CM Processing T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKXNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PRT Tattoo Header - Tattoo Header  * 
     C                     CLEARPARC
     C                     Z-ADDWBHMNB    PAHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    PABNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    PABONB           BOL Load Number
     C                     Z-ADDWBCVNB    PACVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    PAB0DT           TH Kill Date
      *
     C                     CALL 'PKXUPFR'              90  PRT Tattoo Head
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Tattoo Hea
     C                     PARM WUAMCD    WQ0195  3        CMP Program Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKXUPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Freight
      *================================================================
      * Get bol frt fields, and find out if any tattoo for this
      * load has been paid.
      * if tattoo is paid bring this back and also cor hld over pgm on fr
      * Rtv Frt All f/BOL/TTO  XF - Buy Order Load  * 
     C                     CALL 'PKEHXFR'              90  Rtv Frt All f/B
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBHMNB    WQ0196  30       BOH Company Num
     C                     PARM WBBNNB    WQ0197  70       BOH Buy Order N
     C                     PARM WBBONB    WQ0198  50       BOL Load Number
     C           WUCMST    PARM WUCMST    WQ0199  2        BOL Freight UOM
     C           WUAGPR    PARM WUAGPR    WQ0200  72       BOL Freight Uni
     C           WUATVA    PARM WUATVA    WQ0201  72       BOL Freight Amt
     C           WUI1ST    PARM WUI1ST    WQ0202  1        BOL Freight All
     C           WUDHNB    PARM WUDHNB    WQ0203  70       BOL Head Receiv
     C           WUDINB    PARM WUDINB    WQ0204  71       BOL Live Wgt Re
     C           WUIOJR    PARM WUIOJR    WQ0205  70       BOL Head Receiv
     C           WUNPST    PARM WUNPST    WQ0206  1        Tattoo is paid
     C           WUNFST    PARM WUNFST    WQ0207  1        Held Over Recor
     C           WUK4PR    PARM WUK4PR    WQ0208  72       Tot Frt Spdb af
     C           WUK7PR    PARM WUK7PR    WQ0209  72       Frt Amt spread
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKEHXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * If allocated but no paid then allow to re spread of frt
      * If not allocated allow spread of frt
      * CASE: not paid tattoo but allocated frt allow reallocate
      *  - c1 AND c2
      *   |- c1    : WRK.Tattoo is paid Usr is No
      *   |- c2    : WRK.BOL Freight Allocation is Freight is Allocated
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUNPST    IFEQ 'N'                        *IF
     C           WUI1ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUI5ST           Freight Allocia
      * Clc Frght Allctn/UnAl  XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKQ6XFR'              90  Clc Frght Allct
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBHMNB    WQ0210  30       BOH Company Num
     C                     PARM WBBNNB    WQ0211  70       BOH Buy Order N
     C                     PARM WBBONB    WQ0212  50       BOL Load Number
     C                     PARM WUCMST    WQ0213  2        BOL Freight UOM
     C                     PARM WUAGPR    WQ0214  72       BOL Freight Uni
     C                     PARM WUATVA    WQ0215  72       BOL Freight Amt
     C                     PARM WUI1ST    WQ0216  1        BOL Freight All
     C                     PARM WUDHNB    WQ0217  70       BOL Head Receiv
     C                     PARM WUDINB    WQ0218  71       BOL Live Wgt Re
     C                     PARM WUIOJR    WQ0219  70       BOL Head Receiv
     C                     PARM WUI5ST    WQ0220  1        Freight Allocia
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKQ6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: WRK.BOL Freight Allocation is Freight is not Allocated
     C           WUI1ST    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WUI5ST           Freight Allocia
      * Clc Frght Allctn/UnAl  XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKQ6XFR'              90  Clc Frght Allct
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBHMNB    WQ0221  30       BOH Company Num
     C                     PARM WBBNNB    WQ0222  70       BOH Buy Order N
     C                     PARM WBBONB    WQ0223  50       BOL Load Number
     C                     PARM WUCMST    WQ0224  2        BOL Freight UOM
     C                     PARM WUAGPR    WQ0225  72       BOL Freight Uni
     C                     PARM WUATVA    WQ0226  72       BOL Freight Amt
     C                     PARM WUI1ST    WQ0227  1        BOL Freight All
     C                     PARM WUDHNB    WQ0228  70       BOL Head Receiv
     C                     PARM WUDINB    WQ0229  71       BOL Live Wgt Re
     C                     PARM WUIOJR    WQ0230  70       BOL Head Receiv
     C                     PARM WUI5ST    WQ0231  1        Freight Allocia
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKQ6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Competitors Code 1 Usr
     C                     MOVEL*BLANK    WUE7CD  3
      * Define work field Competitors Code 2 Usr
     C                     MOVEL*BLANK    WUE8CD  3
      * Define work field Competitors Code 3 Usr
     C                     MOVEL*BLANK    WUE9CD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAZPC           CMP Std Lean Pe
     C                     Z-ADD*ZERO     WAA0PC           CMP Lean Factor
     C                     Z-ADD*ZERO     WAI1PR           CMP Market Add/
     C                     Z-ADD*ZERO     WAVEPR           CMP % of Carcas
     C                     Z-ADD*ZERO     WAVFPR           CMP Fixed Cost
     C                     Z-ADD*ZERO     WAVHPR           CMP Grade Type
     C                     Z-ADD*ZERO     WAVIPR           CMP Unused Pric
     C                     Z-ADD*ZERO     WAVJPR           CMP Unused Pric
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUP0NB  30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBBONB           BOL Load Number
     C                     Z-ADD*ZERO     WBCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WBB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WBAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WBACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WBB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WBCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WBAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WBA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WBCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WBCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WBFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WBH9NB           TH Held Over
     C                     Z-ADD*ZERO     WBFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WBFENB           TH Head Killed
     C                     Z-ADD*ZERO     WBHENB           TH Head Adds
     C                     Z-ADD*ZERO     WBHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WBCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WBLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WBE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WBA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WBFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WBA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WBF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WBHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WBF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WBF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WBF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WBF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WBAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WBAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WBCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WBA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WBA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WBB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WBAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WBANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WBAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WBAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WBAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WBAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WBAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WBASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WBA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WBATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WBA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WBCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WBCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WBLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WBCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WBA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WBA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WBGHNB           TH Commission A
     C                     Z-ADD*ZERO     WBBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WBBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WBBTDT           TH Commission P
     C                     Z-ADD*ZERO     WBBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WBHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WBHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WBHINB           TH FFLI
     C                     Z-ADD*ZERO     WBA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WBA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WBA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WBJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WBD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WBD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WBD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WBD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WBEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WBEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WBECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WBEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WBEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WBEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WBEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WBEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WBOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WBTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WBT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WBTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WBT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WBOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WBKOER           TH Head Identif
     C                     Z-ADD*ZERO     WBOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WBOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WBIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WBOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WBHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WBS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WBTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WBTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WBJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WBKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WBKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WBKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WBKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WBOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WBIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WBIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WBIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WBKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WBOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WBKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WBORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WBOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WBMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WBMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WBNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WBNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WBIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WBKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WBEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WBEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WBECDT           TH Head LFT
     C                     Z-ADD*ZERO     WBEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WBEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Define work field Last BOH BuyOrder Nbr USR
     C                     Z-ADD*ZERO     WUDUNB  70
      * Define work field Last BOL Load number  USR
     C                     Z-ADD*ZERO     WUDVNB  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WCBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WCBONB           BOL Load Number
     C                     Z-ADD*ZERO     WCCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WCB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WCF4PC           CCT Std Yield
     C                     Z-ADD*ZERO     WCG5PR           CCT Base /Live
     C                     Z-ADD*ZERO     WCJPPR           CCT Base /Carc
     C                     Z-ADD*ZERO     WCG6PR           CCT Lean Prem /
     C                     Z-ADD*ZERO     WCJQPR           CCT Lean Prem /
     C                     Z-ADD*ZERO     WCG7PR           CCT Yield G/L /
     C                     Z-ADD*ZERO     WCJRPR           CCT Yield G/L /
     C                     Z-ADD*ZERO     WCJUPR           CCT Carc Val /L
     C                     Z-ADD*ZERO     WCJVPR           CCT Carc Val /C
     C                     Z-ADD*ZERO     WCG8PR           CCT Sort Dsc /L
     C                     Z-ADD*ZERO     WCJSPR           CCT Sort Dsc /C
     C                     Z-ADD*ZERO     WCG9PR           CCT Gross /Live
     C                     Z-ADD*ZERO     WCJTPR           CCT Gross /Carc
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Define work field BOH Market Add/Deduct
     C                     Z-ADD*ZERO     WUAAPR  52
      * Define work field BOH Quote Price Type
     C                     MOVEL*BLANK    WUB3ST  2
      * Define work field BOH Quoted Base Mkt Price
     C                     Z-ADD*ZERO     WUALPR  52
      * Define work field BOH Commodity Market Code
     C                     MOVEL*BLANK    WUETCD  3
      * Define work field BOH Commodity Price Group
     C                     MOVEL*BLANK    WUEUCD  7
      * Define work field BOH Market Date Method
     C                     MOVEL*BLANK    WUJ5TX  3
      * Define work field PC Contract Code
     C                     MOVEL*BLANK    WUAKCD  5
      * Define work field PSC Sub-Contract Code
     C                     MOVEL*BLANK    WUALCD  5
      * Define work field PO Option Code
     C                     MOVEL*BLANK    WUAICD  3
      * Define work field CMP Program Code
     C                     MOVEL*BLANK    WUAMCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WEBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WEARDT           BOH Buy Order D
     C                     Z-ADD*ZERO     WEASDT           BOH Kill Date
     C                     Z-ADD*ZERO     WEAAPR           BOH Market Add/
     C                     Z-ADD*ZERO     WEALPR           BOH Quoted Base
     C                     Z-ADD*ZERO     WED5DT           BOH MPR Reporti
     C                     Z-ADD*ZERO     WED6DT           BOH Hedge Date
     C                     Z-ADD*ZERO     WED7DT           BOH Unused Date
     C                     Z-ADD*ZERO     WED8DT           BOH Unused Date
     C                     Z-ADD*ZERO     WED9DT           BOH Unused Date
     C                     Z-ADD*ZERO     WEJOEJ           BOH Hedge Head
     C                     Z-ADD*ZERO     WEKOFF           BOH Hedge Refer
     C                     Z-ADD*ZERO     WEKWPE           BOH Hedge Time
     C                     Z-ADD*ZERO     WEIMBF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WEOPTR           BOH Unused Nbr
     C                     Z-ADD*ZERO     WEOEJD           BOH Unused Nbr
     C                     Z-ADD*ZERO     WEIRMF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WEJIRM           BOH Unused Nbr
     C                     Z-ADD*ZERO     WEJRKF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WEKFIR           BOH Unused Nbr
     C                     Z-ADD*ZERO     WEHXNB           PPWS Company Nu
     C                     Z-ADD*ZERO     WEGANB           CW Year
     C                     Z-ADD*ZERO     WEGBNB           CW Week Number
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Define work field CCC Commodity Mrkt Code
     C                     MOVEL*BLANK    WUE5CD  3
      * Define work field CCC Commodity Price Group
     C                     MOVEL*BLANK    WUE6CD  7
      * Define work field CCC Market Date Method
     C                     MOVEL*BLANK    WUJ9TX  3
      * Define work field CMP Market Add/Deduct
     C                     Z-ADD*ZERO     WUI1PR  52
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGTNNB           CCC Record
     C                     Z-ADD*ZERO     WGGAPR           CCC +/- Market
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
      * Define work field CMP Description
     C                     MOVEL*BLANK    WUA3TX 25
      * Define work field CMP Grading Type
     C                     MOVEL*BLANK    WUDLST  1
      * Define work field CMP Sort Basis
     C                     MOVEL*BLANK    WUDMST  1
      * Define work field CMP Carc Wgt Type
     C                     MOVEL*BLANK    WUDQST  2
      * Define work field CMP Std Lean Percent
     C                     Z-ADD*ZERO     WUAZPC  31
      * Define work field CMP Lean Factor
     C                     Z-ADD*ZERO     WUA0PC  31
      * Define work field CMP Optimal Row Nbr f/srt
     C                     MOVEL*BLANK    WUDTST  1
      * Define work field CMP Type
     C                     MOVEL*BLANK    WUF5ST  1
      * Define work field RS Record Status
     C                     MOVEL*BLANK    WUAJST  1
      * Define work field TH CM Base Mkt Price
     C                     Z-ADD*ZERO     WUAMPR  52
      * Define work field TH CM Market Price
     C                     Z-ADD*ZERO     WUB8PR  52
      * Define work field PSC Floor Price
     C                     Z-ADD*ZERO     WUAZPR  52
      * Define work field PSC Ceiling Price
     C                     Z-ADD*ZERO     WUA0PR  52
      * Define work field PSC Market Percent   NU
     C                     Z-ADD*ZERO     WUA9PC  30
      * Define work field PSC Break Even Percent
     C                     Z-ADD*ZERO     WUA7PR  52
      * Define work field PSC FLoor Price +/-
     C                     Z-ADD*ZERO     WUA8PR  52
      * Define work field PSC Sub-Contract Type
     C                     MOVEL*BLANK    WUF3ST  1
      * Define work field PSC Mkt Percent
     C                     Z-ADD*ZERO     WUA9PR  52
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAHDT           PSC Date
     C                     Z-ADD*ZERO     WIAZPR           PSC Floor Price
     C                     Z-ADD*ZERO     WIA0PR           PSC Ceiling Pri
     C                     Z-ADD*ZERO     WIA9PC           PSC Market Perc
     C                     Z-ADD*ZERO     WIA7PR           PSC Break Even
     C                     Z-ADD*ZERO     WIA8PR           PSC FLoor Price
     C                     Z-ADD*ZERO     WIA9PR           PSC Mkt Percent
     C                     Z-ADD*ZERO     WIF6PR           PSC Mkt + or -
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WIABDT           RS Date Added
     C                     Z-ADD*ZERO     WIABTM           RS Time Added
      * Define work field BOL Freight UOM
     C                     MOVEL*BLANK    WUCMST  2
      * Define work field BOL Freight Unit Amt
     C                     Z-ADD*ZERO     WUAGPR  72
      * Define work field BOL Freight Amt
     C                     Z-ADD*ZERO     WUATVA  72
      * Define work field BOL Freight Allocation
     C                     MOVEL*BLANK    WUI1ST  1
      * Define work field BOL Head Received
     C                     Z-ADD*ZERO     WUDHNB  70
      * Define work field BOL Live Wgt Received
     C                     Z-ADD*ZERO     WUDINB  71
      * Define work field BOL Head Received Market
     C                     Z-ADD*ZERO     WUIOJR  70
      * Define work field Tattoo is paid Usr
     C                     MOVEL*BLANK    WUNPST  1
      * Define work field Held Over Records Y/N
     C                     MOVEL*BLANK    WUNFST  1
      * Define work field Tot Frt Spdb aft pay Usr
     C                     Z-ADD*ZERO     WUK4PR  72
      * Define work field Frt Amt spread Usr
     C                     Z-ADD*ZERO     WUK7PR  72
      * Define work field Freight Allociation Apply
     C                     MOVEL*BLANK    WUI5ST  1
      * Define work field Ded/Add/Net Pay Usr
     C                     MOVEL*BLANK    WUJGST  1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field TH VC Gross Value /HD
     C                     Z-ADD*ZERO     YL0001  52
      *================================================================
     CSR         ZZEXIT    ENDSR
