/********************************************************************/
/*                                                                  */
/*  SYNOPSIS -  SUBMIT THE PROGRAM THAT WILL UPDATE CARRIER         */
/*              DESTINATION RATES FOR 1 CARRIER                     */
/*                                                                  */
/*  SYSTEM    - ORDER MANAGEMENT SYSTEM                             */
/*  PROGRAM   - SUBMITS THE UPDATE CARRIER RATES PROGRAM            */
/*  DATE      - 05/19/2014                                          */
/*  PROGRAMMER- LARA BUSER                                          */
/*                                                                  */
/*  PARAMETERS:                                                     */
/*  O    &RETURN     - RETURN CODE                                  */
/*  B    &COMPNYN    - COMPANY NUMBER  15.5                         */
/*  B    &CARRIER    - CARRIER CODE                                 */
/*  B    &REGION     - REGION CODE                                  */
/*  B    &WHSE       - WAREHOUSE CODE                               */
/*  B    &ADJUSTN    - ADJUSTMENT TO RATE 15.5                      */
/*  B    &ADJTYPE    - ADJUSTMENT TYPE  INCR, DECR, PERCENT         */
/*  B    &SELECT     - SELECT TYPE (1, 2, OR 3)                     */
/********************************************************************/
/* MODIFICATIONS:                                                   */
/* XXX 66/66/6666 E666666  DESCRIPTION OF CHANGES                   */
/*                                                                  */
/********************************************************************/
 PBMSUPC:    PGM        PARM(&RETURN &CARRIER &WAREHOUSE &STATE      +
                          &SELECT &ADJUSTN &ADJTYPE)

             DCL        VAR(&RETURN)    TYPE(*CHAR) LEN(7)
             DCL        VAR(&CARRIER)   TYPE(*CHAR) LEN(3)
             DCL        VAR(&WAREHOUSE) TYPE(*CHAR) LEN(3)
             DCL        VAR(&STATE )    TYPE(*CHAR) LEN(2)
             DCL        VAR(&SELECT)    TYPE(*CHAR) LEN(1)
             DCL        VAR(&ADJUSTN)   TYPE(*DEC )
             DCL        VAR(&ADJTYPE)   TYPE(*CHAR) LEN(1)
/* ERROR MESSAGE FIELDS                                             */
             DCL        VAR(&MSG)       TYPE(*CHAR) LEN(512)
             DCL        VAR(&MSGID)     TYPE(*CHAR) LEN(7)
             DCL        VAR(&MSGL)      TYPE(*DEC) LEN(5 0)

             MONMSG     MSGID(CPF0000)

             CHGVAR     VAR(&RETURN) VALUE('       ')

             GOTO CALL
/*-------------------------------------------------------------------*/
/* SUBMIT PRINT CL PROGRAM TO BUILD THE WORK FILE AND TO PRINT       */
/*  THE JCO REPORT (PMW3UPC)                                         */
/*-------------------------------------------------------------------*/
/* SUBMIT:     SBMJOB     CMD(CALL PGM(PBMTUPC) PARM(&RETURN &CARRIER +
                          &WAREHOUSE &STATE &SELECT &ADJUSTN +
                          &ADJTYPE)) JOB(SBMDESTRTE)              ***/

             GOTO       CMDLBL(END)

 CALL:       CALL       PGM(PBMTUPC) PARM(&RETURN &CARRIER +
                          &WAREHOUSE &STATE &SELECT &ADJUSTN &ADJTYPE)
             IF         COND(&RETURN *NE '       ') THEN(GOTO +
                          CMDLBL(MSGTRAP))

             GOTO       CMDLBL(END)

/*-------------------------USER QUIT--------------------------------*/
 USERQUIT:   CHGVAR     VAR(&RETURN) VALUE('Y2U0005')
             GOTO       CMDLBL(END)

/*----------------------RECEIVE MESSAGES----------------------------*/
 MSGTRAP:    RCVMSG     MSGTYPE(*EXCP) MSGDTA(&MSG) MSGDTALEN(&MSGL) +
                          MSGID(&MSGID)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))

             SNDPGMMSG  MSGID(&MSGID) MSGF(QCPFMSG) MSGDTA(%SST(&MSG +
                          1 &MSGL)) MSGTYPE(*ESCAPE)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))

 END:        ENDPGM
