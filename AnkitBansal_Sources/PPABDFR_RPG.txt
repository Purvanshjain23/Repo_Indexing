     H/TITLE Dsp Approve/Deny Clm  DF  Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Display file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 08/10/18  Time  : 09:34:10
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPPABDFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: Dsp Approve/Deny Clm  DF  Display file
      *
     FPDMOCPL1IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : A/R Claim Product         Retrieval index
      *
     FOPBGWKL6IF  E           K        DISK
      * RSQ : Order Detail              Co/Order/Item
      *
     FPDMPCPL1IF  E           K        DISK
      * RTV : A/R Claim Resale Product  Retrieval index
      *
     FPPAYCPL1IF  E           K        DISK
      * RTV : A/R Claim Approval        Retrieval index
      *
     FPDMKCPL1IF  E           K        DISK
      * RTV : A/R Claim                 Retrieval index
      *
     FOMBYREL1IF  E           K        DISK
      * RTV : Item Default              Retrieval index
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPPAYCPL0UF  E           K        DISK
      * UPD : A/R Claim Approval        Update index
      *
     FPDMKCPL0UF  E           K        DISK
      * UPD : A/R Claim                 Update index
      *
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    #L7         7  1
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     I@AYCPXM
      * A/R Claim Approval        Update index
      * Renamed input format fields
     I              AYC0C7                          WAC0C7
     I              AYF0AA                          WAF0AA
     I              AYDXNB                          WADXNB
     I              AYQ7NA                          WAQ7NA
     I              AYFDT1                          WAFDT1
     I              AYFET1                          WAFET1
     I              AYYZNX                          WAYZNX
     I              AYTUSX                          WATUSX
     I              AYMODT                          WAMODT
     I              AYBHTM                          WABHTM
     I              AYTVSX                          WATVSX
     I              AYTWSX                          WATWSX
     I              AYP4DT                          WAP4DT
     I              AYP5DT                          WAP5DT
     I              AYVSST                          WAVSST
     I              AYMJDT                          WAMJDT
     I              AYBETM                          WABETM
     I              AYCCVN                          WACCVN
     I              AYCDVN                          WACDVN
     I              AYMKDT                          WAMKDT
     I              AYBFTM                          WABFTM
     I              AYCEVN                          WACEVN
     I              AYCFVN                          WACFVN
      *
     I@MKCPWA
      * A/R Claim                 Update index
      * Renamed input format fields
     I              MKC0C7                          WBC0C7
     I              MKZLCD                          WBZLCD
     I              MKBIC3                          WBBIC3
     I              MKALNX                          WBALNX
     I              MKRMNB                          WBRMNB
     I              MKC3C7                          WBC3C7
     I              MKRFTX                          WBRFTX
     I              MKCHSX                          WBCHSX
     I              MKCJSX                          WBCJSX
     I              MKAYVL                          WBAYVL
     I              MKAZVL                          WBAZVL
     I              MKA0VL                          WBA0VL
     I              MKPQTX                          WBPQTX
     I              MKCNSX                          WBCNSX
     I              MKPLTX                          WBPLTX
     I              MKCOSX                          WBCOSX
     I              MKPMTX                          WBPMTX
     I              MKCPSX                          WBCPSX
     I              MKA1VL                          WBA1VL
     I              MKPNTX                          WBPNTX
     I              MKPOTX                          WBPOTX
     I              MKMLDT                          WBMLDT
     I              MKEJDT                          WBEJDT
     I              MKCQSX                          WBCQSX
     I              MKPPTX                          WBPPTX
     I              MKMMDT                          WBMMDT
     I              MKMNDT                          WBMNDT
     I              MKBGTM                          WBBGTM
     I              MKCGVN                          WBCGVN
     I              MKC4C7                          WBC4C7
     I              MKO2NA                          WBO2NA
     I              MKNFDT                          WBNFDT
     I              MKBJTM                          WBBJTM
     I              MKCQVN                          WBCQVN
     I              MKMODT                          WBMODT
     I              MKBHTM                          WBBHTM
     I              MKCHVN                          WBCHVN
     I              MKCRSX                          WBCRSX
     I              MKMPDT                          WBMPDT
     I              MKBITM                          WBBITM
     I              MKCIVN                          WBCIVN
     I              MKTBTX                          WBTBTX
     I              MKEOVL                          WBEOVL
     I              MKEPVL                          WBEPVL
     I              MKP6DT                          WBP6DT
     I              MKCRTM                          WBCRTM
     I              MKYSNX                          WBYSNX
     I              MKT5SX                          WBT5SX
     I              MKF7PC                          WBF7PC
     I              MKF8PC                          WBF8PC
     I              MKF9PC                          WBF9PC
     I              MKEQVL                          WBEQVL
     I              MKERVL                          WBERVL
     I              MKESVL                          WBESVL
     I              MKETVL                          WBETVL
     I              MKT7SX                          WBT7SX
     I              MKT8SX                          WBT8SX
     I              MKT9SX                          WBT9SX
     I              MKUASX                          WBUASX
     I              MKUBSX                          WBUBSX
     I              MKGAPC                          WBGAPC
     I              MKGBPC                          WBGBPC
     I              MKVSST                          WBVSST
     I              MKMJDT                          WBMJDT
     I              MKBETM                          WBBETM
     I              MKCCVN                          WBCCVN
     I              MKCDVN                          WBCDVN
     I              MKMKDT                          WBMKDT
     I              MKBFTM                          WBBFTM
     I              MKCEVN                          WBCEVN
     I              MKCFVN                          WBCFVN
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     IQPPAY1    E DSPPAYCPL0
      * UPD : A/R Claim Approval        Update index
      * Renamed input format fields
     I              AYC0C7                          WAC0C7
     I              AYF0AA                          WAF0AA
     I              AYDXNB                          WADXNB
     I              AYQ7NA                          WAQ7NA
     I              AYFDT1                          WAFDT1
     I              AYFET1                          WAFET1
     I              AYYZNX                          WAYZNX
     I              AYTUSX                          WATUSX
     I              AYMODT                          WAMODT
     I              AYBHTM                          WABHTM
     I              AYTVSX                          WATVSX
     I              AYTWSX                          WATWSX
     I              AYP4DT                          WAP4DT
     I              AYP5DT                          WAP5DT
     I              AYVSST                          WAVSST
     I              AYMJDT                          WAMJDT
     I              AYBETM                          WABETM
     I              AYCCVN                          WACCVN
     I              AYCDVN                          WACDVN
     I              AYMKDT                          WAMKDT
     I              AYBFTM                          WABFTM
     I              AYCEVN                          WACEVN
     I              AYCFVN                          WACFVN
      *
     IYARDCS      DS                            201
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPDMK1    E DSPDMKCPL0
      * UPD : A/R Claim                 Update index
      * Renamed input format fields
     I              MKC0C7                          WBC0C7
     I              MKZLCD                          WBZLCD
     I              MKBIC3                          WBBIC3
     I              MKALNX                          WBALNX
     I              MKRMNB                          WBRMNB
     I              MKC3C7                          WBC3C7
     I              MKRFTX                          WBRFTX
     I              MKCHSX                          WBCHSX
     I              MKCJSX                          WBCJSX
     I              MKAYVL                          WBAYVL
     I              MKAZVL                          WBAZVL
     I              MKA0VL                          WBA0VL
     I              MKPQTX                          WBPQTX
     I              MKCNSX                          WBCNSX
     I              MKPLTX                          WBPLTX
     I              MKCOSX                          WBCOSX
     I              MKPMTX                          WBPMTX
     I              MKCPSX                          WBCPSX
     I              MKA1VL                          WBA1VL
     I              MKPNTX                          WBPNTX
     I              MKPOTX                          WBPOTX
     I              MKMLDT                          WBMLDT
     I              MKEJDT                          WBEJDT
     I              MKCQSX                          WBCQSX
     I              MKPPTX                          WBPPTX
     I              MKMMDT                          WBMMDT
     I              MKMNDT                          WBMNDT
     I              MKBGTM                          WBBGTM
     I              MKCGVN                          WBCGVN
     I              MKC4C7                          WBC4C7
     I              MKO2NA                          WBO2NA
     I              MKNFDT                          WBNFDT
     I              MKBJTM                          WBBJTM
     I              MKCQVN                          WBCQVN
     I              MKMODT                          WBMODT
     I              MKBHTM                          WBBHTM
     I              MKCHVN                          WBCHVN
     I              MKCRSX                          WBCRSX
     I              MKMPDT                          WBMPDT
     I              MKBITM                          WBBITM
     I              MKCIVN                          WBCIVN
     I              MKTBTX                          WBTBTX
     I              MKEOVL                          WBEOVL
     I              MKEPVL                          WBEPVL
     I              MKP6DT                          WBP6DT
     I              MKCRTM                          WBCRTM
     I              MKYSNX                          WBYSNX
     I              MKT5SX                          WBT5SX
     I              MKF7PC                          WBF7PC
     I              MKF8PC                          WBF8PC
     I              MKF9PC                          WBF9PC
     I              MKEQVL                          WBEQVL
     I              MKERVL                          WBERVL
     I              MKESVL                          WBESVL
     I              MKETVL                          WBETVL
     I              MKT7SX                          WBT7SX
     I              MKT8SX                          WBT8SX
     I              MKT9SX                          WBT9SX
     I              MKUASX                          WBUASX
     I              MKUBSX                          WBUBSX
     I              MKGAPC                          WBGAPC
     I              MKGBPC                          WBGBPC
     I              MKVSST                          WBVSST
     I              MKMJDT                          WBMJDT
     I              MKBETM                          WBBETM
     I              MKCCVN                          WBCCVN
     I              MKCDVN                          WBCDVN
     I              MKMKDT                          WBMKDT
     I              MKBFTM                          WBBFTM
     I              MKCEVN                          WBCEVN
     I              MKCFVN                          WBCFVN
      *
     IYBRDCS      DS                            510
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: A/R Claim Product
      * I : RST Claim Number
     I                                    P   1   40P1C0C7
     IP2PARM      DS
      * FLD: A/R Claim
      * I :  Claim Company Number
     I                                    P   1   20P2BIC3
      * I :  Claim Order Number
     I                                    P   3   60P2ALNX
      * I :  Claim Ship to Customer
     I                                    P   7  100P2C3C7
      * I :  Claim Status
     I                                       11  11 P2CJSX
      * I : MAP Claim Amount
     I                                    P  12  172P2AYVL
      * N :  Sales Approved Date
     I                                    P  18  210P2NFDT
      * N :  Sales Approved Time
     I                                    P  22  250P2BJTM
      * N :  Sales Approved User
     I                                       26  35 P2CQVN
      * N :  Approved/Denied Date
     I                                    P  36  390P2MODT
      * N :  Approved/Denied Time
     I                                    P  40  430P2BHTM
      * N :  Approved/Denied User
     I                                       44  53 P2CHVN
      * B :  Claim Resolution Explan.
     I                                       54  93 P2TBTX
     IP3PARM      DS
      * I :  Company Number
     I                                    P   1   20P3AIC3
     IP4PARM      DS
      * I :  Salesperson to Rvw Claim
     I                                        1   3 P4ZLCD
     IP5PARM      DS
      * I :  Sales Type Code
     I                                        1   3 P5KZCD
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Claim cant be deny,RslPrd'
      * Message data for 'Explanation is required'
      * @Explanation Text
     I                                        1  40 ZA0001
      * Message data for 'Claim Status must be S/D'
      * Claim Status
     I                                        1   1 ZA0002
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1C0C7    PARM           WP0001  70       Claim Number
     C           P2BIC3    PARM           WP0002  30       Claim Company N
     C           P2ALNX    PARM           WP0003  70       Claim Order Num
     C           P2C3C7    PARM           WP0004  70       Claim Ship to C
     C           P2CJSX    PARM           WP0005  1        Claim Status
     C           P2AYVL    PARM           WP0006 112       Claim Amount
     C           P2TBTX    PARM P2TBTX    WP0007 40        Claim Resolutio
     C           P3AIC3    PARM           WP0008  30       Company Number
     C           P4ZLCD    PARM           WP0009  3        Salesperson to
     C           P5KZCD    PARM           WP0010  3        Sales Type Code
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
     C                     MOVELP2CJSX    #CCJSX           Claim Status
     C                     MOVELP2TBTX    #CTBTX           Claim Resolutio
     C                     Z-ADDP2ALNX    #2ALNX           Claim Order Num
     C                     Z-ADDP2AYVL    #CA0VL           Claim Approved
     C                     Z-ADDP2BIC3    #2BIC3           Claim Company N
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           MOC0C7           Claim Number
     C                     KFLD           MOAFNX           Claim Item Line
      * Setup key
     C                     Z-ADD#2C0C7    MOC0C7
     C                     Z-ADD#2AFNX    MOAFNX
     C           KPOS      SETLL@MOCPWK
     C           KRST      KLIST
     C                     KFLD           MOC0C7           Claim Number
      * Setup key
     C                     Z-ADD#2C0C7    MOC0C7
     C           KRST      READE@MOCPWK                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2YTNX    WZYTNX
     C                     MOVEL#2YTNX    WZYTNX           Claim Memo Numb
     C           *LIKE     DEFN #2CISX    WZCISX
     C                     MOVEL#2CISX    WZCISX           Responsible Dep
     C           *LIKE     DEFN #2HHCD    WZHHCD
     C                     MOVEL#2HHCD    WZHHCD           U/M - Primary D
     C           *LIKE     DEFN #2F0SX    WZF0SX
     C                     MOVEL#2F0SX    WZF0SX           Affect Trade Fu
     C           *LIKE     DEFN #2F1SX    WZF1SX
     C                     MOVEL#2F1SX    WZF1SX           Affect Commissi
     C           *LIKE     DEFN #2F2SX    WZF2SX
     C                     MOVEL#2F2SX    WZF2SX           Affect Pricing
     C           *LIKE     DEFN #2AMST    WZAMST
     C                     MOVEL#2AMST    WZAMST           Affect Inventor
     C           *LIKE     DEFN #2AFNX    WZAFNX
     C                     MOVEL#2AFNX    WZAFNX           Claim Item Line
     C           *LIKE     DEFN #2C0C7    WZC0C7
     C                     MOVEL#2C0C7    WZC0C7           Claim Number
     C           *LIKE     DEFN #2C1C7    WZC1C7
     C                     MOVEL#2C1C7    WZC1C7           Claim Item Code
     C           *LIKE     DEFN #2ALNX    WZALNX
     C                     MOVEL#2ALNX    WZALNX           Claim Order Num
     C           *LIKE     DEFN #2BIC3    WZBIC3
     C                     MOVEL#2BIC3    WZBIC3           Claim Company N
     C           *LIKE     DEFN #2FUAA    WZFUAA
     C                     MOVEL#2FUAA    WZFUAA           Claim Departmen
     C           *LIKE     DEFN #2CQCD    WZCQCD
     C                     MOVEL#2CQCD    WZCQCD           Reason Code
     C           *LIKE     DEFN #2TNSX    WZTNSX
     C                     MOVEL#2TNSX    WZTNSX           Claim Responsib
     C           *LIKE     DEFN #2BNVL    WZBNVL
     C                     MOVEL#2BNVL    WZBNVL           Claim Item Amou
     C           *LIKE     DEFN #2ANST    WZANST
     C                     MOVEL#2ANST    WZANST           Affect Sales Do
     C           *LIKE     DEFN #2VAST    WZVAST
     C                     MOVEL#2VAST    WZVAST           Affect Sales Pn
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@MOCPWK                  90*
     C  N82                READ @MOCPWK                  90*
     C                     END
      *
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2HHCD    IFNE *BLANK                     U/M - Primary D
     C           MOHHCD    CABNE#2HHCD    BB020            U/M - Primary D
     C                     END
     C           #2C1C7    IFNE *ZERO                      Claim Item Code
     C           MOC1C7    CABLT#2C1C7    BB020            Claim Item Code
     C                     END
     C           #2TNSX    IFNE *BLANK                     Claim Responsib
     C           MOTNSX    CABNE#2TNSX    BB020            Claim Responsib
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
     C                     EXSR MC#1FN
     C                     SUB  1         ##RR
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
      * E4057 JJH 04/05/15 - Fields no longer used
     C                     MOVELMOVAST    #RZ1SX           Affect Sales Pn
      * 042005 slm OMS012A Added logic for the Affect fields on each
      * individual record
      * E4057 JJH 04/05/15 - Fields no longer used
     C                     MOVEL'1'       *IN84            *Re-read Subfil
      * Chk DEV Priced Itm    RT - Order Detail  * 
     C                     EXSR SARVGN
      * CASE: RCD.Price Method Code is Deviated
     C           #RQ7CD    IFEQ 'DEV'                      *IF
     C                     MOVEL*BLANK    #RP9NA           Description USR
     C                     MOVEL@CN,001   #RP9NA           Description USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #RP9NA           Description USR
     C                     END                             *FI
      * E4057 JJH 04/05/15 - Fields no longer used
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C           KRST      READE@MOCPWK                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate Claim Status
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#CCJSX'  IFEQ YPMTFD
      * Claim Status
     C                     MOVEL#CCJSX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFCJSX
     C                     SELEC
     C           W0INVL    WHEQ 'D'                        D
     C                     Z-ADD1         ZFCJSX
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD2         ZFCJSX
     C           W0INVL    WHEQ 'P'                        P
     C                     Z-ADD3         ZFCJSX
     C                     ENDSL
     C                     EXFMTZECJSX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFCJSX    WHEQ 1
     C                     MOVEL'D'       W0INVL           D
     C           ZFCJSX    WHEQ 2
     C                     MOVEL'S'       W0INVL           S
     C           ZFCJSX    WHEQ 3
     C                     MOVEL'P'       W0INVL           P
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #CCJSX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Claim Item Code and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2C1C7    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2C1C7    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,002                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD0         #2C1C7           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2C1C7           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    CABNE*BLANKS   DATAG1
      * Change of position specified
     C           WZC1C7    CASNE#2C1C7    FBRQRL
     C                     END
     C           DATAG1    TAG
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
      * CASE: CTL.Claim Status is Sls Approved
     C           #CCJSX    IFEQ 'S'                        *IF
      * Claim is sales person approved.
     C                     EXSR UASUBR                     Claim is sales
     C                     ELSE
      * CASE: CTL.Claim Status is Denied
     C           #CCJSX    IFEQ 'D'                        *IF
      * Val Resale for claim  RT - A/R Claim Resale Product  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2C0C7    WL0001           Claim Number
     C                     EXSR SBRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Setup message data for message
      * Send message 'Claim cant be deny,RslPrd'
     C                     MOVEL'USR3322' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    W0RTN            *Return code
      * Claim is denied.
     C                     EXSR UBSUBR                     Claim is denied
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#CCJSX    ZA0002           Claim Status
      * Send message 'Claim Status must be S/D'
     C                     MOVEL'USR2784' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * CTL.Claim Status Desc     USR = Condition name of CTL.Claim Statu
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1523237   Y2LSNO  70       List number
     C                     PARM #CCJSX    W0INVL 25        Claim Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #CRQTX    PARM           W0CNNM 25        Claim Status De
      *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Process subfile (pass 2)
     C                     EXSR EAPRSF
      * If error during 2nd pass exit:
     C           *IN99     CABEQ'1'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     SETOF                     98    *
     C           YPMTFD    CABNE*BLANKS   DCEXIT
     C                     EXSR MC#1FN
      * SFLNXTCHG
     C                     SETON                     84
      * USER: Process subfile record (Pre-confirm)
     C                     MOVEL'N'       W0DCF            *Defer confirm
      * E4057 JJH 04/05/15 - Fields no longer used
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MOCV#2
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
      * USER: Process subfile control (Post-confirm)
      * CASE: PGM.*Defer confirm is Proceed to confirm
     C           W0DCF     IFEQ 'N'                        *IF
      * Val Resale for claim  RT - A/R Claim Resale Product  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#2C0C7    WL0001           Claim Number
     C                     EXSR SBRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Dsp Claim Resale Ap/Dn DF - A/R Claim Resale Product  * 
     C                     CALL 'PPA9DFR'              90  Dsp Claim Resal
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #2C0C7    WQ0001  70       Claim Number
     C                     PARM P2C3C7    WQ0002  70       Claim Ship to C
     C           YL0002    PARM YL0002    WQ0003  7        Return Code Usr
     C                     PARM P5KZCD    WQ0004  3        Sales Type Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPA9DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0002           Return Code Usr
     C                     END                             *FI
      * If return code *normal, update
      * CASE: LCL.Return Code Usr is *Blank
     C           YL0002    IFEQ *BLANK                     *IF
      * CASE: CTL.Claim Status is Sls Approved
     C           #CCJSX    IFEQ 'S'                        *IF
      * Sales Approved.
     C                     EXSR UCSUBR                     Sales Approved.
     C                     ELSE
      * CASE: CTL.Claim Status is Denied
     C           #CCJSX    IFEQ 'D'                        *IF
      * Denied.
     C                     EXSR UDSUBR                     Denied.
     C                     END                             *FI
     C                     END                             *FI
      * 042105 slm oms012a -
      * Update the Approval for the sales person
      * If sales is approval then flag the A/R Claim approval with  A app
      * If sales deny then flag the A/R Claim appr with the claim status
      * Chg Apprv/Den For Sls RT - A/R Claim Approval  * 
     C                     EXSR SCRVGN
      * Rtv Approved/Denied   RT - A/R Claim  * 
     C                     EXSR SERVGN
     C                     END                             *FI
     C                     END                             *FI
     C           *IN81     IFEQ '1'
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END                             WOD *92
     C                     END                             FI *81
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      * USER: Final processing (Post-confirm)
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     SETOF                     98
      * USER: Process subfile record (Post-confirm)
      * E4057 JJH 04/05/15 - No longer required because these fields
      *  are no longer required.
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C                     SETON                     84    SFLNXTCHG
     C  N99                Z-ADD##RR      ##SFRC     99    *
     C                     GOTO EBEXIT
     C                     ELSE
      * SFLRCD valid
     C                     SETOF                     84    SFLNXTCHG
     C                     END                             FI *IN98
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @MOCPWK fields to subfile
      *================================================================
     C                     Z-ADDMOC0C7    #1C0C7           Claim Number
     C                     Z-ADDMOAFNX    #1AFNX           Claim Item Line
     C                     MOVELMOCISX    #1CISX           Responsible Dep
     C                     MOVELMOHHCD    #1HHCD           U/M - Primary D
     C                     Z-ADDMODPNB    #1DPNB           Order Sequence
     C                     Z-ADDMOUENB    #1UENB           Order Secondary
     C                     Z-ADDMOKUQT    #1KUQT           Claim Item Quan
     C                     Z-ADDMOHHWG    #1HHWG           Claim Item Weig
     C                     Z-ADDMODIPR    #1DIPR           Claim Item Unit
     C                     MOVELMOF0SX    #1F0SX           Affect Trade Fu
     C                     MOVELMOF1SX    #1F1SX           Affect Commissi
     C                     MOVELMOF2SX    #1F2SX           Affect Pricing
     C                     Z-ADDMOFXPR    #1FXPR           Inventory Value
     C                     MOVELMOAMST    #1AMST           Affect Inventor
     C                     MOVELMOVAST    #1VAST           Affect Sales Pn
     C                     Z-ADDMORMNB    #1RMNB           Load ID
     C                     Z-ADDMOYTNX    #1YTNX           Claim Memo Numb
     C                     MOVELMON0CD    #1N0CD           Item Type Code
     C                     MOVELMOQYSX    #1QYSX           Claim Product R
     C                     MOVELMOQZSX    #1QZSX           CP Require CM A
     C                     MOVELMOQ0SX    #1Q0SX           Clm Item TF Exe
     C                     MOVELMOUCSX    #1UCSX           CP Unused Sts 4
     C                     MOVELMOUDSX    #1UDSX           CP Unused Sts 5
     C                     MOVELMOUESX    #1UESX           CP Unused Sts 6
     C                     Z-ADDMOFYPR    #1FYPR           CP Unused Price
     C                     Z-ADDMOFZPR    #1FZPR           CP Unused Price
     C                     Z-ADDMOF0PR    #1F0PR           CP Unused Price
     C                     Z-ADDMOF1PR    #1F1PR           CP Unused Price
     C                     Z-ADDMOF2PR    #1F2PR           CP Unused Price
     C                     Z-ADDMOEUVL    #1EUVL           CP Unused Value
     C                     Z-ADDMOEVVL    #1EVVL           CP Unused Value
     C                     Z-ADDMOEWVL    #1EWVL           CP Unused Value
     C                     Z-ADDMOEXVL    #1EXVL           CP Unused Value
     C                     Z-ADDMOEYVL    #1EYVL           CP Unused Value
     C                     MOVELMOVSST    #1VSST           Record Status
     C                     Z-ADDMOMJDT    #1MJDT           Create Date
     C                     Z-ADDMOBETM    #1BETM           Create Time
     C                     MOVELMOCCVN    #1CCVN           Create User
     C                     MOVELMOCDVN    #1CDVN           Create Program
     C                     Z-ADDMOMKDT    #1MKDT           Change Date
     C                     Z-ADDMOBFTM    #1BFTM           Change Time
     C                     MOVELMOCEVN    #1CEVN           Change User
     C                     MOVELMOCFVN    #1CFVN           Change Program
     C                     Z-ADDMOC1C7    #1C1C7           Claim Item Code
      * Clear external version also
     C                     MOVEL*BLANK    V1C1C7
     C                     Z-ADDMOALNX    #1ALNX           Claim Order Num
      * Clear external version also
     C                     MOVEL*BLANK    V1ALNX
     C                     Z-ADDMOBIC3    #1BIC3           Claim Company N
      * Clear external version also
     C                     MOVEL*BLANK    V1BIC3
     C                     MOVELMOCQCD    #1CQCD           Reason Code
     C                     MOVELMOFUAA    #1FUAA           Claim Departmen
     C                     MOVELMOTNSX    #1TNSX           Claim Responsib
     C                     Z-ADDMOBNVL    #1BNVL           Claim Item Amou
     C                     MOVELMOANST    #1ANST           Affect Sales Do
     C                     MOVEL*BLANK    #RV0SX           Commission Chec
     C                     MOVEL*BLANK    #RTMCD           Commodity Marke
     C                     MOVEL*BLANK    #RQ1SX           Affect Trade Fu
     C                     MOVEL*BLANK    #RQ2SX           Affect Commissi
     C                     MOVEL*BLANK    #RQ3SX           Affect Pricing
     C                     MOVEL*BLANK    #RQ7CD           Price Method Co
     C                     MOVEL*BLANK    #RRGSX           Tradefund Accru
     C                     MOVEL*BLANK    #RRHSX           Commission Usr
     C                     MOVEL*BLANK    #RV2SX           Org Affect Pric
     C                     MOVEL*BLANK    #RZ1SX           Affect Sales Pn
     C                     MOVEL*BLANK    #RP9NA           Description USR
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MC#1FN    BEGSR
      *================================================================
      * CALC: Subfile record function fields
      *================================================================
      * CALC: Subfile record function fields
     C                     MOVEL*BLANK    #ROONA           Item Desc DRV
      * Item Desc DRV
      * Rtv Item Descriptions  RT - OM Item  * 
     C                     EXSR SGRVGN
      *================================================================
     CSR         MCEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     Z-ADDP2AYVL    #PAYVL           Claim Amount
     C                     Z-ADD*ZERO     #2YTNX           Claim Memo Numb
     C                     MOVEL*BLANK    #CRSTX           Claim Explan. T
     C                     MOVEL*BLANK    #2CISX           Responsible Dep
     C                     MOVEL*BLANK    #2HHCD           U/M - Primary D
     C                     MOVEL*BLANK    #CRGSX           Tradefund Accru
     C                     MOVEL*BLANK    #CRHSX           Commission Usr
     C                     MOVEL*BLANK    #CV2SX           Org Affect Pric
     C                     MOVEL*BLANK    #2F0SX           Affect Trade Fu
     C                     MOVEL*BLANK    #2F1SX           Affect Commissi
     C                     MOVEL*BLANK    #2F2SX           Affect Pricing
     C                     MOVEL*BLANK    #2AMST           Affect Inventor
     C                     Z-ADD*ZERO     #2AFNX           Claim Item Line
     C                     Z-ADDP1C0C7    #2C0C7           Claim Number
      * Clear external version also
     C                     MOVEL*BLANK    V2C0C7
     C                     Z-ADD*ZERO     #CA0VL           Claim Approved
     C                     MOVEL*BLANK    #CCJSX           Claim Status
     C                     MOVEL*BLANK    #CRQTX           Claim Status De
     C                     MOVEL*BLANK    #CTBTX           Claim Resolutio
     C                     Z-ADD*ZERO     #2C1C7           Claim Item Code
      * Clear external version also
     C                     MOVEL*BLANK    V2C1C7
     C                     Z-ADD*ZERO     #2ALNX           Claim Order Num
      * Clear external version also
     C                     MOVEL*BLANK    V2ALNX
     C                     Z-ADD*ZERO     #2BIC3           Claim Company N
      * Clear external version also
     C                     MOVEL*BLANK    V2BIC3
     C                     MOVEL*BLANK    #2FUAA           Claim Departmen
     C                     MOVEL*BLANK    #2CQCD           Reason Code
     C                     MOVEL*BLANK    #2TNSX           Claim Responsib
     C                     MOVEL*BLANK    #CGENA           Item Descriptio
     C                     Z-ADD*ZERO     #2BNVL           Claim Item Amou
     C                     MOVEL*BLANK    #2ANST           Affect Sales Do
     C                     MOVEL*BLANK    #2VAST           Affect Sales Pn
      * Check restriction within
     C                     EXSR VACKRL
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Claim Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C1C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C1C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C1C7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C1C7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Claim Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1ALNX    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1ALNX    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1ALNX           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1ALNX           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Claim Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1BIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1BIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1BIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1BIC3           CD3 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Claim Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C0C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C0C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2C0C7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2C0C7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Claim Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C1C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C1C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2C1C7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2C1C7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Claim Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2ALNX    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2ALNX    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2ALNX           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2ALNX           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Claim Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2BIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2BIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2BIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2BIC3           CD3 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Chk DEV Priced Itm    RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       YL0001           Record Found -O
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSA01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSA02           Order Number
     C           *LIKE     DEFN OMHGCD    WQSA03           Item Code
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Order Number
     C                     KFLD           WQSA03           Item Code
      * Setup key
     C                     Z-ADDP3AIC3    WQSA01           Company Number
     C                     Z-ADDP2ALNX    WQSA02           Order Number
     C                     Z-ADDMOC1C7    WQSA03           Item Code
      * Establish starting position
     C           KRSSA     SETLL@BGWKZL                    *
     C           KRSSA     READE@BGWKZL                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELOMQ7CD    #RQ7CD           Price Method Co
     C                     MOVEL'Y'       YL0001           Record Found -O
     C           KRSSA     READE@BGWKZL                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Val Resale for claim  RT - A/R Claim Resale Product  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN MPC0C7    WQSB01           Claim Number
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Claim Number
      * Setup key
     C                     Z-ADDWL0001    WQSB01           Claim Number
      * Establish starting position
     C           KRSSB     SETLL@MPCPWQ                    *
     C           KRSSB     READE@MPCPWQ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2739' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SBEXIT                     *QUIT
     C           KRSSB     READE@MPCPWQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Chg Apprv/Den For Sls RT - A/R Claim Approval  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * At the time the claim is approved or deny by sls then update the
      * approval record
      * Declare restrictor key work fields
     C           *LIKE     DEFN AYC0C7    WQSC01           Claim Number
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Claim Number
      * Setup key
     C                     Z-ADD#2C0C7    WQSC01           Claim Number
      * Establish starting position
     C           KRSSC     SETLL@AYCPXN                    *
     C           KRSSC     READE@AYCPXN                  90*
      * Data record not found
     C   90                MOVEL'USR3431' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Approval Person Type is Order Salesperson
     C           AYTUSX    IFEQ 'O'                        *IF
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) AYF0AA' defaulted for 'Approval Title Code'.
      * Field '(DB1) AYDXNB' defaulted for 'Sequence Number'.
      * Chg Apprv/Den For Sls CH - A/R Claim Approval  * 
     C                     EXSR SDCHRC
     C                     END                             *FI
     C           KRSSC     READE@AYCPXN                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCHRC    BEGSR
      *================================================================
      * Chg Apprv/Den For Sls CH - A/R Claim Approval  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001 30        Approval Title
     C                     MOVEL*BLANK    WN0002 30        Approval Person
     C                     MOVEL*BLANK    WN0003 50        Approval Person
     C                     Z-ADD*ZERO     WN0004 110       Approval Person
     C                     MOVEL*BLANK    WN0005  1        Approval Person
     C                     MOVEL*BLANK    WN0006  1        Approval Requir
     C                     Z-ADD*ZERO     WN0007  70       Emailed Date
     C                     Z-ADD*ZERO     WN0008  60       Emailed Time
     C                     MOVEL*BLANK    WN0009  1        Record Status
     C                     Z-ADD*ZERO     WN0010  70       Create Date
     C                     Z-ADD*ZERO     WN0011  60       Create Time
     C                     MOVEL*BLANK    WN0012 10        Create User
     C                     MOVEL*BLANK    WN0013 10        Create Program
     C                     Z-ADD*ZERO     WN0014  70       Change Date
     C                     Z-ADD*ZERO     WN0015  60       Change Time
     C                     MOVEL*BLANK    WN0016 10        Change User
     C                     MOVEL*BLANK    WN0017 10        Change Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @AYCPXM
     C                     Z-ADDAYC0C7    WAC0C7           Claim Number
     C                     MOVELAYF0AA    WAF0AA    P      Approval Title
     C                     Z-ADDAYDXNB    WADXNB           Sequence Number
      *
     C           KLCHSD    KLIST
     C                     KFLD           WAC0C7           Claim Number
     C                     KFLD           WAF0AA           Approval Title
     C                     KFLD           WADXNB           Sequence Number
     C           KLCHSD    CHAIN@AYCPXM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPAYCPL0'MDACP
     C                     MOVEL'@AYCPXM' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPAY1    YARDCS
      * Move non-key fields to @AYCPXM
     C                     Z-ADDYL0004    WAMODT           Approved/Denied
     C                     Z-ADDYL0005    WABHTM           Approved/Denied
     C                     MOVELYL0003    WATWSX    P      Approval Status
      *
      * Set PGM.*Record Data Changed flag
     C           QPPAY1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Chg Date/Time      IF
     C                     Z-ADD##JDT     WAMKDT           Change Date
     C                     Z-ADD##JTM     WABFTM           Change Time
     C                     MOVEL##USR     WACEVN           Change User
     C                     MOVEL##PGM     WACFVN           Change Program
      * Set PGM.*Record Data Changed flag
     C           QPPAY1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@AYCPXM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPAYCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Approved/Denied   RT - A/R Claim  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           MKC0C7           Claim Number
      * Setup key
     C                     Z-ADD#2C0C7    MKC0C7           Claim Number
      * Establish starting position
     C           KRSSE     CHAIN@MKCPWB              90    *
      * Data record not found
     C   90                MOVEL'USR2729' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CHG A/R Claim          CH - A/R Claim  * 
     C                     EXSR SFCHRC
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * CHG A/R Claim          CH - A/R Claim  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0018  1        Record Status
     C                     Z-ADD*ZERO     WN0019  70       Create Date
     C                     Z-ADD*ZERO     WN0020  60       Create Time
     C                     MOVEL*BLANK    WN0021 10        Create User
     C                     MOVEL*BLANK    WN0022 10        Create Program
     C                     Z-ADD*ZERO     WN0023  70       Change Date
     C                     Z-ADD*ZERO     WN0024  60       Change Time
     C                     MOVEL*BLANK    WN0025 10        Change User
     C                     MOVEL*BLANK    WN0026 10        Change Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @MKCPWA
     C                     Z-ADDMKC0C7    WBC0C7           Claim Number
      *
     C           KLCHSF    KLIST
     C                     KFLD           WBC0C7           Claim Number
     C           KLCHSF    CHAIN@MKCPWA              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDMKCPL0'MDACP
     C                     MOVEL'@MKCPWA' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDMK1    YBRDCS
      * Move non-key fields to @MKCPWA
     C                     MOVELMKZLCD    WBZLCD    P      Salesperson to
     C                     Z-ADDMKBIC3    WBBIC3           Claim Company N
     C                     Z-ADDMKALNX    WBALNX           Claim Order Num
     C                     Z-ADDMKRMNB    WBRMNB           Load ID
     C                     Z-ADDMKC3C7    WBC3C7           Claim Ship to C
     C                     MOVELMKRFTX    WBRFTX    P      Claim Customer
     C                     MOVELMKCHSX    WBCHSX    P      Claim Type
     C                     MOVEL#CCJSX    WBCJSX    P      Claim Status
     C                     Z-ADDMKAYVL    WBAYVL           Claim Amount
     C                     Z-ADDMKAZVL    WBAZVL           Claim Net Loss
     C                     Z-ADDMKA0VL    WBA0VL           Claim Approved
     C                     MOVELMKPQTX    WBPQTX    P      Claim Contact N
     C                     MOVELMKCNSX    WBCNSX    P      Product Inspect
     C                     MOVELMKPLTX    WBPLTX    P      Product Inspect
     C                     MOVELMKCOSX    WBCOSX    P      Rep Inspection
     C                     MOVELMKPMTX    WBPMTX    P      Rep Inspection
     C                     MOVELMKCPSX    WBCPSX    P      Lab Fee Involve
     C                     Z-ADDMKA1VL    WBA1VL           Lab Fee
     C                     MOVELMKPNTX    WBPNTX    P      Driver Name
     C                     MOVELMKPOTX    WBPOTX    P      Lab Name
     C                     Z-ADDMKMLDT    WBMLDT           Resolve Claim b
     C                     Z-ADDMKEJDT    WBEJDT           Actual Delivery
     C                     MOVELMKCQSX    WBCQSX    P      Claim Called in
     C                     MOVELMKPPTX    WBPPTX    P      Claim Called in
     C                     Z-ADDMKMMDT    WBMMDT           Claim Called in
     C                     Z-ADDMKMNDT    WBMNDT           Claim Entry Dat
     C                     Z-ADDMKBGTM    WBBGTM           Claim Entry Tim
     C                     MOVELMKCGVN    WBCGVN    P      Claim Entry Use
     C                     Z-ADDMKC4C7    WBC4C7           Resale Ship to
     C                     MOVELMKO2NA    WBO2NA    P      Resale Purchase
     C                     Z-ADDP2NFDT    WBNFDT           Sales Approved
     C                     Z-ADDP2BJTM    WBBJTM           Sales Approved
     C                     MOVELP2CQVN    WBCQVN    P      Sales Approved
     C                     Z-ADDP2MODT    WBMODT           Approved/Denied
     C                     Z-ADDP2BHTM    WBBHTM           Approved/Denied
     C                     MOVELP2CHVN    WBCHVN    P      Approved/Denied
     C                     MOVELMKCRSX    WBCRSX    P      Memo Created
     C                     Z-ADDMKMPDT    WBMPDT           Memo Created Da
     C                     Z-ADDMKBITM    WBBITM           Memo Created Ti
     C                     MOVELMKCIVN    WBCIVN    P      Memo Created Us
     C                     MOVELP2TBTX    WBTBTX    P      Claim Resolutio
     C                     Z-ADDMKEOVL    WBEOVL           Approved Net Lo
     C                     Z-ADDMKEPVL    WBEPVL           Total Expense A
     C                     Z-ADDMKP6DT    WBP6DT           Memo Post Date
     C                     Z-ADDMKCRTM    WBCRTM           Memo Post Time
     C                     Z-ADDMKYSNX    WBYSNX           TFS Batch Numbe
     C                     MOVELMKT5SX    WBT5SX    P      TFS Process Sta
     C                     Z-ADDMKF7PC    WBF7PC           Avg TF Responsi
     C                     Z-ADDMKF8PC    WBF8PC           Avg SBF Respons
     C                     Z-ADDMKF9PC    WBF9PC           Unused % field
     C                     Z-ADDMKEQVL    WBEQVL           FPR ID
     C                     Z-ADDMKERVL    WBERVL           AC Unused Value
     C                     Z-ADDMKESVL    WBESVL           AC Unused Value
     C                     Z-ADDMKETVL    WBETVL           AC Unused Value
     C                     MOVELMKT7SX    WBT7SX    P      Claim Prod Affe
     C                     MOVELMKT8SX    WBT8SX    P      ARC Unused Stat
     C                     MOVELMKT9SX    WBT9SX    P      ARC Unused Stat
     C                     MOVELMKUASX    WBUASX    P      AC Shipping Met
     C                     MOVELMKUBSX    WBUBSX    P      AC Full Return
     C                     Z-ADDMKGAPC    WBGAPC           AC Unused % 1
     C                     Z-ADDMKGBPC    WBGBPC           AC Unused % 2
      *
      * Set PGM.*Record Data Changed flag
     C           QPDMK1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * CASE: PAR.Claim Amount is less than zero
     C           MKAYVL    IFLT 0                          *IF
     C                     MOVEL'CM'      WBCHSX           Claim Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'DM'      WBCHSX           Claim Type
     C                     END                             *FI
      * Set Chg Date/Time      IF
     C                     Z-ADD##JDT     WBMKDT           Change Date
     C                     Z-ADD##JTM     WBBFTM           Change Time
     C                     MOVEL##USR     WBCEVN           Change User
     C                     MOVEL##PGM     WBCFVN           Change Program
      * Set PGM.*Record Data Changed flag
     C           QPDMK1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@MKCPWA                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDMKCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Item Descriptions  RT - OM Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           BYHGCD           Item Code
      * Setup key
     C                     Z-ADD#1C1C7    BYHGCD           Item Code
      * Establish starting position
     C           KRSSG     CHAIN@BYREA1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1160' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #ROONA           Description Lin
     C                     MOVEL*BLANK    WUAWNA           Description Lin
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBYAVNA    #ROONA           Description Lin
     C                     MOVELBYAWNA    WUAWNA           Description Lin
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSH01           Application Cod
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSH01           Application Cod
     C                     MOVEL'OMS'     WQSH01           Application Cod
      * Establish starting position
     C           KRSSH     SETLL@DNRESF                    *
     C           KRSSH     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SIRVGN
     C                     END                             *FI
     C           KRSSH     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSI01           Application Cod
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSI01           Application Cod
      * Establish starting position
     C           KRSSI     SETLL@DNRESF                    *
     C           KRSSI     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSI     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Claim is sales person approved.
      *================================================================
     C                     Z-ADDP2AYVL    #CA0VL           Claim Approved
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Claim is denied.
      *================================================================
     C                     Z-ADD*ZERO     #CA0VL           Claim Approved
      * CASE: CTL.Claim Resolution Explan. is Blank
     C           #CTBTX    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#CRSTX    ZA0001           Claim Explan. T
      * Send message 'Explanation is required'
     C                     MOVEL'USR2827' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Sales Approved.
      *================================================================
     C                     Z-ADD##JDT     P2NFDT           Sales Approved
     C                     Z-ADD##JTM     P2BJTM           Sales Approved
     C                     MOVEL##USR     P2CQVN           Sales Approved
     C                     Z-ADD*ZERO     P2MODT           Approved/Denied
     C                     Z-ADD*ZERO     P2BHTM           Approved/Denied
     C                     MOVEL*BLANK    P2CHVN           Approved/Denied
     C                     MOVEL*BLANK    P2TBTX           Claim Resolutio
     C                     MOVEL'A'       YL0003           Claim Status
     C                     Z-ADDP2NFDT    YL0004           Approved/Denied
     C                     Z-ADDP2BJTM    YL0005           Approved/Denied
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Denied.
      *================================================================
     C                     Z-ADD*ZERO     P2NFDT           Sales Approved
     C                     Z-ADD*ZERO     P2BJTM           Sales Approved
     C                     MOVEL*BLANK    P2CQVN           Sales Approved
     C                     Z-ADD##JDT     P2MODT           Approved/Denied
     C                     Z-ADD##JTM     P2BHTM           Approved/Denied
     C                     MOVEL##USR     P2CHVN           Approved/Denied
     C                     MOVEL#CTBTX    P2TBTX           Claim Resolutio
     C                     MOVEL#CCJSX    YL0003           Claim Status
     C                     Z-ADDP2MODT    YL0004           Approved/Denied
     C                     Z-ADDP2BHTM    YL0005           Approved/Denied
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * 042005 slm OMS012A Added logic for the Affect fields on each
      * individual record.
      * Expand the screen to allow for Org fields.
      * 100108 slm E00488  CLAIM RESOLUTION EXP,...input field  was 70
      * change to allow user to only have 40 chars since we only store 40
      * E4057 JJH 04/05/15 - Price Credit Memo Fixes
      * - Display Department before Reason Code.
      * - Affect Sales Pnds Sts Usr - Change Input to Output
      * - The following fields are hidden because they are no longer used
      *   Affect Trade Fund Usr, Affect Commission USR, Affect Pricing
      *   USR, AffectInventory Status, Commission USR, and Org Affect
      *   USR.
      * - Chg App/Deny RT - A/R Claim Product - Commented Out
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVELV2C0C7    WK1X01  1
     C           WK1X01    IFEQ '?'                        Claim Number
     C           YPMTFD    OREQ '#2C0C7'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #2C0C7' defaulted for 'Claim Number'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(CTL) #2BIC3' defaulted for 'Claim Company Number'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0006' defaulted for 'Claim Ship to Customer'.
     C                     CALL 'PMCSSRR'              90  Sel A/R Claim
     C                     PARM *BLANK    W0RTN   7
     C           #2C0C7    PARM #2C0C7    WQ0005  70       Claim Number
     C           #2BIC3    PARM #2BIC3    WQ0006  30       Claim Company N
     C           YL0006    PARM YL0006    WQ0007  70       Claim Ship to C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #2C0C7    IFNE *ZERO                      Claim Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VA999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVAMK    KLIST
     C                     KFLD           MKC0C7           Claim Number
      * Setup key
     C                     Z-ADD#2C0C7    MKC0C7
     C           KLVAMK    CHAIN@MKCPWB              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
     C           VA999     TAG
      * Restrictor relation not satisfied
      * Send message 'A/R Claim              NF'
     C                     MOVEL'USR2729' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR2729' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD11        ZHSTRW  40
     C                     Z-ADD22        ZHNDRW  40
     C                     Z-ADD2         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           ZHCSRW    IFEQ 005
     C           ZHCSCL    ANDEQ022
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CCJSX'  YPMTFD           Claim Status
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P2NFDT           Sales Approved
     C                     Z-ADD*ZERO     P2BJTM           Sales Approved
     C                     MOVEL*BLANK    P2CQVN           Sales Approved
     C                     Z-ADD*ZERO     P2MODT           Approved/Denied
     C                     Z-ADD*ZERO     P2BHTM           Approved/Denied
     C                     MOVEL*BLANK    P2CHVN           Approved/Denied
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WADXNB           Sequence Number
     C                     Z-ADD*ZERO     WAYZNX           Approval Person
     C                     Z-ADD*ZERO     WAMODT           Approved/Denied
     C                     Z-ADD*ZERO     WABHTM           Approved/Denied
     C                     Z-ADD*ZERO     WAP4DT           Emailed Date
     C                     Z-ADD*ZERO     WAP5DT           Emailed Time
     C                     Z-ADD*ZERO     WAMJDT           Create Date
     C                     Z-ADD*ZERO     WABETM           Create Time
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBBIC3           Claim Company N
     C                     Z-ADD*ZERO     WBALNX           Claim Order Num
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBC3C7           Claim Ship to C
     C                     Z-ADD*ZERO     WBAYVL           Claim Amount
     C                     Z-ADD*ZERO     WBAZVL           Claim Net Loss
     C                     Z-ADD*ZERO     WBA0VL           Claim Approved
     C                     Z-ADD*ZERO     WBA1VL           Lab Fee
     C                     Z-ADD*ZERO     WBMLDT           Resolve Claim b
     C                     Z-ADD*ZERO     WBEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WBMMDT           Claim Called in
     C                     Z-ADD*ZERO     WBMNDT           Claim Entry Dat
     C                     Z-ADD*ZERO     WBBGTM           Claim Entry Tim
     C                     Z-ADD*ZERO     WBC4C7           Resale Ship to
     C                     Z-ADD*ZERO     WBNFDT           Sales Approved
     C                     Z-ADD*ZERO     WBBJTM           Sales Approved
     C                     Z-ADD*ZERO     WBMODT           Approved/Denied
     C                     Z-ADD*ZERO     WBBHTM           Approved/Denied
     C                     Z-ADD*ZERO     WBMPDT           Memo Created Da
     C                     Z-ADD*ZERO     WBBITM           Memo Created Ti
     C                     Z-ADD*ZERO     WBEOVL           Approved Net Lo
     C                     Z-ADD*ZERO     WBEPVL           Total Expense A
     C                     Z-ADD*ZERO     WBP6DT           Memo Post Date
     C                     Z-ADD*ZERO     WBCRTM           Memo Post Time
     C                     Z-ADD*ZERO     WBYSNX           TFS Batch Numbe
     C                     Z-ADD*ZERO     WBF7PC           Avg TF Responsi
     C                     Z-ADD*ZERO     WBF8PC           Avg SBF Respons
     C                     Z-ADD*ZERO     WBF9PC           Unused % field
     C                     Z-ADD*ZERO     WBEQVL           FPR ID
     C                     Z-ADD*ZERO     WBERVL           AC Unused Value
     C                     Z-ADD*ZERO     WBESVL           AC Unused Value
     C                     Z-ADD*ZERO     WBETVL           AC Unused Value
     C                     Z-ADD*ZERO     WBGAPC           AC Unused % 1
     C                     Z-ADD*ZERO     WBGBPC           AC Unused % 2
     C                     Z-ADD*ZERO     WBMJDT           Create Date
     C                     Z-ADD*ZERO     WBBETM           Create Time
     C                     Z-ADD*ZERO     WBMKDT           Change Date
     C                     Z-ADD*ZERO     WBBFTM           Change Time
      * Define work field Description Line Two
     C                     MOVEL*BLANK    WUAWNA 30
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0001  70
      * Define local work field Record Found -OrdDtlUSR
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Return Code Usr
     C                     MOVEL*BLANK    YL0002  7
      * Define local work field Claim Status
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Approved/Denied Date
     C                     Z-ADD*ZERO     YL0004  70
      * Define local work field Approved/Denied Time
     C                     Z-ADD*ZERO     YL0005  60
      * Define local work field Claim Ship to Customer
     C                     Z-ADD*ZERO     YL0006  70
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD06        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Modifications and Comments
     C                     EXSR UESUBR                     Modifications a
      * VAL Rtv and Center Hdg IF
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SHRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 DEVIATED PRICED ITEM
00002 USR0752
