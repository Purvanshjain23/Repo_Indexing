     H/TITLE Edt Acct C/O/S/D   E1 XF  Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : E1IDEVMDL
     H* System        : E1IDEVMDL
     H* User name     : ISRCENT
     H* Date          : 12/17/21  Time  : 15:12:47
     H* Copyright     : E1IDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FE10901LB  IF   E           K DISK
      * RSQ : Account Master     F0901  Biz Unit/Obj Acct/Subsid
      *
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  WP0001         S              3
     D  WP0002         S             12
     D  WP0003         S              6
     D  WP0004         S              8
     D  WP0005         S              8
     D  WP0006         S              1
     D  WP0007         S             30
     D  WP0008         S              7
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  YL0001         S              7
     D  WQSA01         S                   LIKE(WAMCU)
     D  WQSA02         S                   LIKE(WAOBJ)
     D  WQSA03         S                   LIKE(WASUB)
     D  YL0002         S              7
     D  W0PMT          S              1
      /EJECT
      * Parameter declarations
     D P1PARM          DS
      * I :  OMS Company Number Alpha
     D  P1LVTX                 1      3
     D P2PARM          DS
      * I :  Business Unit/Cost Center
     D  P2MCU                  1     12
     D P3PARM          DS
      * I :  Object Account
     D  P3OBJ                  1      6
     D P4PARM          DS
      * I :  Subsidiary
     D  P4SUB                  1      8
     D P5PARM          DS
      * O :  Account ID
     D  P5AID                  1      8
     D P6PARM          DS
      * O :  Posting Edit
     D  P6PEC                  1      1
     D P7PARM          DS
      * O :  Description
     D  P7DL01                 1     30
     D P8PARM          DS
      * O :  Return Code
     D  P8LLTX                 1      7
     II0901LB
      * Account Master     F0901  Biz Unit/Obj Acct/Subsid
      * Renamed input format fields
     I              GMCO                        WACO
     I              GMAID                       WAAID
     I              GMMCU                       WAMCU
     I              GMOBJ                       WAOBJ
     I              GMSUB                       WASUB
     I              GMANS                       WAANS
     I              GMDL01                      WADL01
     I              GMLDA                       WALDA
     I              GMBPC                       WABPC
     I              GMPEC                       WAPEC
     I              GMBILL                      WABILL
     I              GMCRCD                      WACRCD
     I              GMUM                        WAUM
     I              GMR001                      WAR001
     I              GMR002                      WAR002
     I              GMR003                      WAR003
     I              GMR004                      WAR004
     I              GMR005                      WAR005
     I              GMR006                      WAR006
     I              GMR007                      WAR007
     I              GMR008                      WAR008
     I              GMR009                      WAR009
     I              GMR010                      WAR010
     I              GMR011                      WAR011
     I              GMR012                      WAR012
     I              GMR013                      WAR013
     I              GMR014                      WAR014
     I              GMR015                      WAR015
     I              GMR016                      WAR016
     I              GMR017                      WAR017
     I              GMR018                      WAR018
     I              GMR019                      WAR019
     I              GMR020                      WAR020
     I              GMR021                      WAR021
     I              GMR022                      WAR022
     I              GMR023                      WAR023
     I              GMOBJA                      WAOBJA
     I              GMSUBA                      WASUBA
     I              GMWCMP                      WAWCMP
     I              GMCCT                       WACCT
     I              GMERC                       WAERC
     I              GMHTC                       WAHTC
     I              GMQLDA                      WAQLDA
     I              GMCCC                       WACCC
     I              GMFMOD                      WAFMOD
     I              GMUSER                      WAUSER
     I              GMPID                       WAPID
     I              GMJOBN                      WAJOBN
     I              GMUPMJ                      WAUPMJ
     I              GMUPMT                      WAUPMT
     I              GMCEC1                      WACEC1
     I              GMCEC2                      WACEC2
     I              GMCEC3                      WACEC3
     I              GMCEC4                      WACEC4
     I              GMIEC                       WAIEC
     I              GMFPEC                      WAFPEC
     I              GMSTPC                      WASTPC
     I              GMTXGL                      WATXGL
     I              GMTOBJ                      WATOBJ
     I              GMTSUB                      WATSUB
     I              GMPRGF                      WAPRGF
     I              GMTXA1                      WATXA1
     I              GMR024                      WAR024
     I              GMR025                      WAR025
     I              GMR026                      WAR026
     I              GMR027                      WAR027
     I              GMR028                      WAR028
     I              GMR029                      WAR029
     I              GMR030                      WAR030
     I              GMR031                      WAR031
     I              GMR032                      WAR032
     I              GMR033                      WAR033
     I              GMR034                      WAR034
     I              GMR035                      WAR035
     I              GMR036                      WAR036
     I              GMR037                      WAR037
     I              GMR038                      WAR038
     I              GMR039                      WAR039
     I              GMR040                      WAR040
     I              GMR041                      WAR041
     I              GMR042                      WAR042
     I              GMR043                      WAR043
     I              GMADJE                      WAADJE
     I              GMUAFL                      WAUAFL
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
     C     P1LVTX        PARM                    WP0001                         OMS Company Num
     C     P2MCU         PARM                    WP0002                         Business Unit/C
     C     P3OBJ         PARM                    WP0003                         Object Account
     C     P4SUB         PARM                    WP0004                         Subsidiary
     C     P5AID         PARM      P5AID         WP0005                         Account ID
     C     P6PEC         PARM      P6PEC         WP0006                         Posting Edit
     C     P7DL01        PARM      P7DL01        WP0007                         Description
     C     P8LLTX        PARM      P8LLTX        WP0008                         Return Code
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Edt Acct C/O/S/D   E1 XF
      * Modification history
     C                   EXSR      UASUBR                                       Modification hi
      * Edt Acct C/O/S/D   E1 RT - Account Master     F0901  * 
     C                   EXSR      SARVGN
     C                   MOVEL     YL0001        P8LLTX                         Return Code
     C                   MOVEL     YL0002        P0RTN                          *Return code
     C                   EXSR      ZYEXPG
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * Edt Acct C/O/S/D   E1 RT - Account Master     F0901  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSA         KLIST
     C                   KFLD                    WQSA01                         Business Unit/C
     C                   KFLD                    WQSA02                         Object Account
     C                   KFLD                    WQSA03                         Subsidiary
      * Setup key
     C                   MOVEL     P2MCU         WQSA01                         Business Unit/C
     C                   MOVEL     P3OBJ         WQSA02                         Object Account
     C                   MOVEL     P4SUB         WQSA03                         Subsidiary
      * Establish starting position
     C     KRSSA         SETLL     I0901LB                                      *
     C     KRSSA         READE     I0901LB                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'E1I0096'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   EVAL      P5AID = ' '                                  Account ID
     C                   EVAL      P6PEC = ' '                                  Posting Edit
     C                   EVAL      P7DL01 = ' '                                 Description
     C                   EVAL      YL0001 = ' '                                 Return Code
     C                   EVAL      YL0001 = ' '                                 Return Code
     C                   MOVEL     'ERR'         YL0001                         Return Code
     C                   GOTO      SAEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * Error is Posting Edit is Inactive OR Non-Post
      * CASE: Posting Edit is Inactive OR Non-Post
      *  - c1 OR c2
      *   |- c1    : DB1.Posting Edit is Inactive
      *   |- c2    : DB1.Posting Edit is Non-Post
      *   '-
     C                   DOW       NOT *IN90
      * PAR = CON By name
     C                   IF        WAPEC = 'I' OR
     C                             WAPEC = 'N'
     C                   EVAL      P5AID = ' '                                  Account ID
     C                   EVAL      P6PEC = ' '                                  Posting Edit
     C                   EVAL      P7DL01 = ' '                                 Description
     C                   EVAL      YL0001 = ' '                                 Return Code
     C                   EVAL      YL0001 = ' '                                 Return Code
     C                   MOVEL     'ERR'         YL0001                         Return Code
     C                   ELSE
      * CASE: *OTHERWISE
      * PAR = DB1 By name
     C                   MOVEL     WAAID         P5AID                          Account ID
     C                   MOVEL     WAPEC         P6PEC                          Posting Edit
     C                   MOVEL     WADL01        P7DL01                         Description
     C                   EVAL      YL0001 = ' '                                 Return Code
     C                   END                                                    *FI
     C     KRSSA         READE     I0901LB                                90    *
     C                   ENDDO
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   UASUBR        BEGSR
      *================================================================
      * Modification history
      *================================================================
      *  6/11/2020 JBB SDN465 - JDE World to JDE Enterprise 1 conversion
      *                         This program calls the JDE Enterprise 1
      *                         version.
      *================================================================
     CSR   UAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      *
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAUPMJ                         Date - Updated
     C                   Z-ADD     *ZERO         WAUPMT                         Time - Last Upd
     C                   MOVEL     'N'           W0PMT
      * Define local work field Return Code
     C                   EVAL      YL0001 = ' '
      * Define local work field *Return code
     C                   EVAL      YL0002 = ' '
      *================================================================
     CSR   ZZEXIT        ENDSR
