     H/TITLE VAL Delv Track ArrvRl PV  Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Prompt & validate record
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISJBADE
     H* Date          : 03/23/21  Time  : 08:52:54
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPLQPPVR#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: VAL Delv Track ArrvRl PV  Prompt & validate record
      *
     FPKAXCPL0IF  E           K        DISK
      * RTV : Buy Order Load            Retrieval index
      *
     FPLAFCPL2IF  E           K        DISK
      * RSQ : Delivery Tracking         BOH CO/BO/BOL/KillDt
      *
     FPKEJCPL2IF  E           K        DISK
      * RSQ : Buy Order Load Weight     Co/BOL
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@AXCPBX
      * Buy Order Load            Retrieval index
      * Renamed input format fields
     I              AXHMNB                          WAHMNB
     I              AXBNNB                          WABNNB
     I              AXBONB                          WABONB
     I              AXCQDT                          WACQDT
     I              AXABTH                          WAABTH
     I              AXACTH                          WAACTH
     I              AXBPNB                          WABPNB
     I              AXCSNB                          WACSNB
     I              AXAUDT                          WAAUDT
     I              AXCMST                          WACMST
     I              AXAGPR                          WAAGPR
     I              AXATVA                          WAATVA
     I              AXI1ST                          WAI1ST
     I              AXDHNB                          WADHNB
     I              AXDINB                          WADINB
     I              AXCNST                          WACNST
     I              AXGINB                          WAGINB
     I              AXBZDT                          WABZDT
     I              AXLSNB                          WALSNB
     I              AXF3TX                          WAF3TX
     I              AXO8ST                          WAO8ST
     I              AXO9ST                          WAO9ST
     I              AXPAST                          WAPAST
     I              AXLDSH                          WALDSH
     I              AXPBST                          WAPBST
     I              AXPCST                          WAPCST
     I              AXPDST                          WAPDST
     I              AXUWST                          WAUWST
     I              AXUXST                          WAUXST
     I              AXUYST                          WAUYST
     I              AXJKRU                          WAJKRU
     I              AXKEOR                          WAKEOR
     I              AXIOEW                          WAIOEW
     I              AXKJIO                          WAKJIO
     I              AXIOJR                          WAIOJR
     I              AXEIRR                          WAEIRR
     I              AXITMF                          WAITMF
     I              AXODJE                          WAODJE
     I              AXRJIF                          WARJIF
     I              AXOEJF                          WAOEJF
     I              AXD0DT                          WAD0DT
     I              AXD1DT                          WAD1DT
     I              AXD2DT                          WAD2DT
     I              AXD3DT                          WAD3DT
     I              AXD4DT                          WAD4DT
     I              AXBNCD                          WABNCD
     I              AXABCD                          WAABCD
     I              AXAECD                          WAAECD
     I              AXAAVN                          WAAAVN
     I              AXAADT                          WAAADT
     I              AXAMTM                          WAAMTM
     I              AXAJST                          WAAJST
     I              AXAHVN                          WAAHVN
     I              AXAGVN                          WAAGVN
     I              AXABVN                          WAABVN
     I              AXABDT                          WAABDT
     I              AXABTM                          WAABTM
      *
     I@AFCPI4
      * Delivery Tracking         BOH CO/BO/BOL/KillDt
      * Renamed input format fields
     I              AFHONB                          WBHONB
     I              AFE0DT                          WBE0DT
     I              AFE9DT                          WBE9DT
     I              AFAJTH                          WBAJTH
     I              AFH4A1                          WBH4A1
     I              AFFXDT                          WBFXDT
     I              AFJIA1                          WBJIA1
     I              AFIBA1                          WBIBA1
     I              AFW5ST                          WBW5ST
     I              AFICA1                          WBICA1
     I              AFK0CD                          WBK0CD
     I              AFK1CD                          WBK1CD
     I              AFLFCD                          WBLFCD
     I              AFLGCD                          WBLGCD
     I              AFIDA1                          WBIDA1
     I              AFIPA1                          WBIPA1
     I              AFLICD                          WBLICD
     I              AFJ8CD                          WBJ8CD
     I              AFJ9CD                          WBJ9CD
     I              AFMGCD                          WBMGCD
     I              AFXHST                          WBXHST
     I              AFXIST                          WBXIST
     I              AFIEA1                          WBIEA1
     I              AFKBCD                          WBKBCD
     I              AFKZCD                          WBKZCD
     I              AFLHCD                          WBLHCD
     I              AFFADT                          WBFADT
     I              AFAKTH                          WBAKTH
     I              AFBYTH                          WBBYTH
     I              AFW6ST                          WBW6ST
     I              AFXXST                          WBXXST
     I              AFFBDT                          WBFBDT
     I              AFALTH                          WBALTH
     I              AFBVTH                          WBBVTH
     I              AFAMTH                          WBAMTH
     I              AFFCDT                          WBFCDT
     I              AFANTH                          WBANTH
     I              AFBHTH                          WBBHTH
     I              AFFDDT                          WBFDDT
     I              AFAOTH                          WBAOTH
     I              AFBWTH                          WBBWTH
     I              AFAPTH                          WBAPTH
     I              AFFEDT                          WBFEDT
     I              AFAQTH                          WBAQTH
     I              AFARTH                          WBARTH
     I              AFFFDT                          WBFFDT
     I              AFASTH                          WBASTH
     I              AFATTH                          WBATTH
     I              AFFGDT                          WBFGDT
     I              AFAUTH                          WBAUTH
     I              AFFHDT                          WBFHDT
     I              AFAVTH                          WBAVTH
     I              AFAWTH                          WBAWTH
     I              AFBKTH                          WBBKTH
     I              AFBLTH                          WBBLTH
     I              AFXJST                          WBXJST
     I              AFK3CD                          WBK3CD
     I              AFFIDT                          WBFIDT
     I              AFAXTH                          WBAXTH
     I              AFAYTH                          WBAYTH
     I              AFFJDT                          WBFJDT
     I              AFAZTH                          WBAZTH
     I              AFA0TH                          WBA0TH
     I              AFFKDT                          WBFKDT
     I              AFA1TH                          WBA1TH
     I              AFA2TH                          WBA2TH
     I              AFFLDT                          WBFLDT
     I              AFA3TH                          WBA3TH
     I              AFA4TH                          WBA4TH
     I              AFBTTH                          WBBTTH
     I              AFFMDT                          WBFMDT
     I              AFA5TH                          WBA5TH
     I              AFA6TH                          WBA6TH
     I              AFBXTH                          WBBXTH
     I              AFXKST                          WBXKST
     I              AFYDST                          WBYDST
     I              AFFYDT                          WBFYDT
     I              AFB0TH                          WBB0TH
     I              AFBZTH                          WBBZTH
     I              AFH2A1                          WBH2A1
     I              AFJ2A1                          WBJ2A1
     I              AFJ3A1                          WBJ3A1
     I              AFKMA1                          WBKMA1
     I              AFJ4A1                          WBJ4A1
     I              AFJ5A1                          WBJ5A1
     I              AFJ6A1                          WBJ6A1
     I              AFJ7A1                          WBJ7A1
     I              AFJ8A1                          WBJ8A1
     I              AFJ9A1                          WBJ9A1
     I              AFKAA1                          WBKAA1
     I              AFKBA1                          WBKBA1
     I              AFKCA1                          WBKCA1
     I              AFKDA1                          WBKDA1
     I              AFKEA1                          WBKEA1
     I              AFKFA1                          WBKFA1
     I              AFKNA1                          WBKNA1
     I              AFKGA1                          WBKGA1
     I              AFKHA1                          WBKHA1
     I              AFKOA1                          WBKOA1
     I              AFKIA1                          WBKIA1
     I              AFKJA1                          WBKJA1
     I              AFKKA1                          WBKKA1
     I              AFKLA1                          WBKLA1
     I              AFYNST                          WBYNST
     I              AFYOST                          WBYOST
     I              AFABCD                          WBABCD
     I              AFAECD                          WBAECD
     I              AFAACD                          WBAACD
     I              AFHMNB                          WBHMNB
     I              AFBNNB                          WBBNNB
     I              AFBONB                          WBBONB
     I              AFAAVN                          WBAAVN
     I              AFAADT                          WBAADT
     I              AFAMTM                          WBAMTM
     I              AFAJST                          WBAJST
     I              AFAHVN                          WBAHVN
     I              AFAGVN                          WBAGVN
     I              AFABVN                          WBABVN
     I              AFABDT                          WBABDT
     I              AFABTM                          WBABTM
      *
     I@EJCPBK
      * Buy Order Load Weight     Co/BOL
      * Renamed input format fields
     I              EJHONB                          WCHONB
     I              EJABCD                          WCABCD
     I              EJAECD                          WCAECD
     I              EJBOMV                          WCBOMV
     I              EJSRST                          WCSRST
     I              EJBOSW                          WCBOSW
     I              EJDQDT                          WCDQDT
     I              EJA2TM                          WCA2TM
     I              EJSSST                          WCSSST
     I              EJSTST                          WCSTST
     I              EJSUST                          WCSUST
     I              EJHMNB                          WCHMNB
     I              EJBNNB                          WCBNNB
     I              EJBONB                          WCBONB
     I              EJAAVN                          WCAAVN
     I              EJAADT                          WCAADT
     I              EJAMTM                          WCAMTM
     I              EJAJST                          WCAJST
     I              EJAHVN                          WCAHVN
     I              EJAGVN                          WCAGVN
     I              EJABVN                          WCABVN
     I              EJABDT                          WCABDT
     I              EJABTM                          WCABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Buy Order Load
      * I : MAP BOH Company Number
     I                                    P   1   20P1HMNB
      * I : MAP BOH Buy Order Number
     I                                    P   3   60P1BNNB
      * I : MAP BOL Load Number
     I                                    P   7   90P1BONB
      * I : MAP BOL Kill Date
     I                                    P  10  130P1CQDT
      * N : MAP BOL Truck Scale Weigh Sts
     I                                       14  14 P1PAST
     IP2PARM      DS
      * FLD: Delivery Tracking
      * N : MAP DSH Kill Date
     I                                    P   1   40P2E0DT
      * N : MAP DT Delivery Date
     I                                    P   5   80P2E9DT
      * N : MAP DT Delivery Time
     I                                    P   9  110P2AJTH
      * N : MAP DT Delivery Time Seq
     I                                    P  12  130P2H4A1
      * N :  DT Arrive @ Plant Date
     I                                    P  14  170P2FHDT
      * N :  DT Arrive @ Plant Time
     I                                    P  18  200P2AVTH
      * N : MAP DT Wait @ TrkWsh
     I                                    P  21  230P2AWTH
      * N : MAP DT TrkScl Weigh-In Date
     I                                    P  24  270P2FIDT
      * N : MAP DT TrkScl Weigh-In Time
     I                                    P  28  300P2AXTH
      * N : MAP DT Wait @ TrkScl
     I                                    P  31  330P2AYTH
      * N : MAP DT To Recv Dock Date
     I                                    P  34  370P2FJDT
      * N : MAP DT To Recv Dock Time
     I                                    P  38  400P2AZTH
      * N : MAP DT Wait-Rcv Dock
     I                                    P  41  430P2A0TH
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Invalid Company Number'
      * CC Company Number
     I                                    P   1   20ZA0001
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HMNB    PARM           WP0001  30       BOH Company Num
     C           P1BNNB    PARM           WP0002  70       BOH Buy Order N
     C           P1BONB    PARM           WP0003  50       BOL Load Number
     C           P1CQDT    PARM           WP0004  70       BOL Kill Date
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Enable PUTOVR
     C                     SETON                     86
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPMCF
      * Quit if not confirmed
     C           *IN99     CABEQ'1'       DAEXIT
      * Exit program
     C                     EXSR ZXEXPG
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
      * Select existing record
     C                     EXSR VACKRL
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DHPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Update screen time
     C                     TIME           ##TME
      * Enable PUTOVR
     C                     SETON                         86*
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     Z-ADD*ZERO     #1HONB           CC Company Numb
     C                     Z-ADD*ZERO     #DWTIN           BOLW Scale Wt I
     C                     Z-ADD*ZERO     #DWTOU           BOLW Scale Wt O
     C                     Z-ADD*ZERO     #1BSNB           Next Buy Order
     C                     Z-ADD*ZERO     #1B1DT           Current Kill Da
     C                     Z-ADD*ZERO     #1B2DT           Next Kill Date
     C                     Z-ADD*ZERO     #1H4NB           Last Drive Card
     C                     Z-ADD*ZERO     #1K3NB           Last Tattoo Nbr
     C                     Z-ADD*ZERO     #1CDDT           Current Product
     C                     Z-ADD*ZERO     #1CEDT           Next Production
     C                     MOVEL*BLANK    #1AAVN           RS User Changed
     C                     Z-ADD*ZERO     #1AADT           RS Date Changed
     C                     Z-ADD*ZERO     #1AMTM           RS Time Changed
     C                     MOVEL*BLANK    #1AJST           RS Record Statu
     C                     MOVEL*BLANK    #1AHVN           RS Job
     C                     MOVEL*BLANK    #1AGVN           RS Program
     C                     MOVEL*BLANK    #1ABVN           RS User Added
     C                     Z-ADD*ZERO     #1ABDT           RS Date Added
     C                     Z-ADD*ZERO     #1ABTM           RS Time Added
     C                     MOVEL*BLANK    #DSWST           BOL IN  record
     C                     MOVEL*BLANK    #DKKTX           Description 30
     C                     MOVEL*BLANK    #DSXST           BOL OUT record
     C                     Z-ADDP1HMNB    #PHMNB           BOH Company Num
     C                     Z-ADD*ZERO     #DLDSH           BOL Shipped Hea
     C                     Z-ADDP1BNNB    #PBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     #DDHNB           BOL Head Receiv
     C                     Z-ADDP1BONB    #PBONB           BOL Load Number
     C                     Z-ADDP1CQDT    #PCQDT           BOL Kill Date
      * Clear external version also
     C                     Z-ADD*ZERO     VPCQDT
     C                     Z-ADDP2E9DT    #PE9DT           DT Delivery Dat
      * Clear external version also
     C                     Z-ADD*ZERO     VPE9DT
     C                     Z-ADDP2AJTH    #PAJTH           DT Delivery Tim
     C                     Z-ADDP2H4A1    #PH4A1           DT Delivery Tim
     C                     MOVELP1PAST    #PPAST           BOL Truck Scale
     C                     Z-ADDP2E0DT    #PE0DT           DSH Kill Date
      * Clear external version also
     C                     Z-ADD*ZERO     VPE0DT
     C                     Z-ADD*ZERO     #DFHDT           DT Arrive @ Pla
      * Clear external version also
     C                     Z-ADD*ZERO     VDFHDT
     C                     Z-ADD*ZERO     #DAVTH           DT Arrive @ Pla
     C                     Z-ADDP2AWTH    #PAWTH           DT Wait @ TrkWs
     C                     Z-ADDP2FIDT    #PFIDT           DT TrkScl Weigh
      * Clear external version also
     C                     Z-ADD*ZERO     VPFIDT
     C                     Z-ADDP2AXTH    #PAXTH           DT TrkScl Weigh
     C                     Z-ADDP2AYTH    #PAYTH           DT Wait @ TrkSc
     C                     Z-ADDP2FJDT    #PFJDT           DT To Recv Dock
      * Clear external version also
     C                     Z-ADD*ZERO     VPFJDT
     C                     Z-ADDP2AZTH    #PAZTH           DT To Recv Dock
     C                     Z-ADDP2A0TH    #PA0TH           DT Wait-Rcv Doc
      * USER: Load screen
      * CASE: WRK.First Time Flag Usr EQ WRK.Blank USR
     C           WUHBST    IFEQ WUCRTX                     *IF
     C                     Z-ADDWUHONB    #PHMNB           BOH Company Num
     C                     MOVEL'Y'       WUHJST           Display Print P
     C                     MOVEL'Y'       WUHBST           First Time Flag
     C                     END                             *FI
      * Val Company Number    IF
      * Val Company Number    XF - STR Order Management Sys  * 
     C                     CALL 'PDGZXFR'              90  Val Company Num
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #PHMNB    WQ0006  30       CC Company Numb
     C           YL0001    PARM *BLANK    WQ0007 30        Oms Name
     C           WUG3ST    PARM *BLANK    WQ0008  1        Invalid Y/N USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGZXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Invalid Y/N USR is Yes
     C           WUG3ST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADD#PHMNB    ZA0001           CC Company Numb
      * Send message 'Invalid Company Number'
     C                     MOVEL'PRK0299' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     MOVELWUG3ST    WUG3ST           Invalid Y/N USR
      * Rtv ShipHd/Spr/RecHd  RT - Buy Order Load  * 
     C                     EXSR SARVGN
      * Val DT per BOL ARRIVINRT - Delivery Tracking  * 
     C                     EXSR SBRVGN
      * Val Buy Order Load    RT - Buy Order Load Weight  * 
     C                     EXSR SCRVGN
     C                     MOVEL*BLANK    #DKKTX           Description 30
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DKKTX           Description 30
     C                     MOVEL@CN,001   #DKKTX           Description 30
     C                     END                             *FI
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert BOL Kill Date to display format
      * Convert date
     C           1000000   ADD  #PCQDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VPCQDT
      * Convert DT Delivery Date to display format
      * Convert date
     C           1000000   ADD  #PE9DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VPE9DT
      * Convert DSH Kill Date to display format
      * Convert date
     C           1000000   ADD  #PE0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VPE0DT
      * Convert DT Arrive @ Plant Date to display format
      * Convert date
     C           1000000   ADD  #DFHDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDFHDT
      * Convert DT TrkScl Weigh-In Date to display format
      * Convert date
     C           1000000   ADD  #PFIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VPFIDT
      * Convert DT To Recv Dock Date to display format
      * Convert date
     C           1000000   ADD  #PFJDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VPFJDT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv ShipHd/Spr/RecHd  RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAHMNB           BOH Company Num
     C                     KFLD           WABNNB           BOH Buy Order N
     C                     KFLD           WABONB           BOL Load Number
      * Setup key
     C                     Z-ADD#PHMNB    WAHMNB           BOH Company Num
     C                     Z-ADD#PBNNB    WABNNB           BOH Buy Order N
     C                     Z-ADD#PBONB    WABONB           BOL Load Number
      * Establish starting position
     C           KRSSA     CHAIN@AXCPBX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0051' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #DDHNB           BOL Head Receiv
     C                     MOVEL*BLANK    #PPAST           BOL Truck Scale
     C                     Z-ADD*ZERO     #DLDSH           BOL Shipped Hea
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWADHNB    #DDHNB           BOL Head Receiv
     C                     MOVELWAPAST    #PPAST           BOL Truck Scale
     C                     Z-ADDWALDSH    #DLDSH           BOL Shipped Hea
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Val DT per BOL ARRIVINRT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQSB01           BOH Company Num
     C           *LIKE     DEFN WBBNNB    WQSB02           BOH Buy Order N
     C           *LIKE     DEFN WBBONB    WQSB03           BOL Load Number
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           BOH Company Num
     C                     KFLD           WQSB02           BOH Buy Order N
     C                     KFLD           WQSB03           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    WQSB01           BOH Company Num
     C                     Z-ADDP1BNNB    WQSB02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQSB03           BOL Load Number
      * Establish starting position
     C           KRSSB     SETLL@AFCPI4                    *
     C           KRSSB     READE@AFCPI4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1030' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #1HONB           CC Company Numb
     C                     Z-ADD*ZERO     #PE0DT           DSH Kill Date
     C                     Z-ADD*ZERO     #PE9DT           DT Delivery Dat
     C                     Z-ADD*ZERO     #PAJTH           DT Delivery Tim
     C                     Z-ADD*ZERO     #PH4A1           DT Delivery Tim
     C                     Z-ADD*ZERO     WUFXDT           DT Actual Kill
     C                     Z-ADD*ZERO     WUJIA1           DT Actual Deliv
     C                     Z-ADD*ZERO     WUIBA1           DT Scheduled Ho
     C                     MOVEL*BLANK    WUW5ST           DT Delivery Ini
     C                     Z-ADD*ZERO     WUICA1           DT Farm Site Co
     C                     MOVEL*BLANK    WUK0CD           DT Building
     C                     MOVEL*BLANK    WUK1CD           DT Room
     C                     MOVEL*BLANK    WULFCD           DT Sire Line Co
     C                     MOVEL*BLANK    WULGCD           DT Hog Group Re
     C                     Z-ADD*ZERO     WUIDA1           DT Delivered He
     C                     Z-ADD*ZERO     WUIPA1           DT Delivered We
     C                     MOVEL*BLANK    WULICD           DT Trucker Code
     C                     MOVEL*BLANK    WUJ8CD           DT Driver
     C                     MOVEL*BLANK    WUJ9CD           DT Loading Crew
     C                     MOVEL*BLANK    WUMGCD           CHR Code
     C                     MOVEL*BLANK    WUXHST           DT Load Type
     C                     MOVEL*BLANK    WUXIST           DT Full/Split L
     C                     Z-ADD*ZERO     WUIEA1           DT Movement Num
     C                     MOVEL*BLANK    WUKBCD           DT Truck ID
     C                     MOVEL*BLANK    WUKZCD           DT Trailer ID
     C                     MOVEL*BLANK    WULHCD           DT Transportati
     C                     Z-ADD*ZERO     WUFADT           DT Transprtn Of
     C                     Z-ADD*ZERO     WUAKTH           DT Transprtn Of
     C                     Z-ADD*ZERO     WUBYTH           DT Arrive@Frm v
     C                     MOVEL*BLANK    WUW6ST           DT On-Time Farm
     C                     MOVEL*BLANK    WUXXST           DT Route Start
     C                     Z-ADD*ZERO     WUFBDT           DT Route Start
     C                     Z-ADD*ZERO     WUALTH           DT Route Start
     C                     Z-ADD*ZERO     WUBVTH           DT Route Start
     C                     Z-ADD*ZERO     WUAMTH           DT Wait @ Trans
     C                     Z-ADD*ZERO     WUFCDT           DT Arrive @ Far
     C                     Z-ADD*ZERO     WUANTH           DT Arrive @ Far
     C                     Z-ADD*ZERO     WUBHTH           DT Drive Time T
     C                     Z-ADD*ZERO     WUFDDT           DT Start Loadin
     C                     Z-ADD*ZERO     WUAOTH           DT Start Loadin
     C                     Z-ADD*ZERO     WUBWTH           DT Start Loadin
     C                     Z-ADD*ZERO     WUAPTH           DT Wait @ Farm
     C                     Z-ADD*ZERO     WUFEDT           DT Frm End Load
     C                     Z-ADD*ZERO     WUAQTH           DT Frm End Load
     C                     Z-ADD*ZERO     WUARTH           DT Load Time
     C                     Z-ADD*ZERO     WUFFDT           DT Leave Farm D
     C                     Z-ADD*ZERO     WUASTH           DT Leave Farm T
     C                     Z-ADD*ZERO     WUATTH           DT Wait-Depart
     C                     Z-ADD*ZERO     WUFGDT           DT Plt TrkWsh A
     C                     Z-ADD*ZERO     WUAUTH           DT Plt TrkWsh A
     C                     Z-ADD*ZERO     #DFHDT           DT Arrive @ Pla
     C                     Z-ADD*ZERO     #DAVTH           DT Arrive @ Pla
     C                     Z-ADD*ZERO     #PAWTH           DT Wait @ TrkWs
     C                     Z-ADD*ZERO     WUBKTH           DT Drive Time T
     C                     Z-ADD*ZERO     WUBLTH           DT Delv Time Va
     C                     MOVEL*BLANK    WUXJST           DT On Time Deli
     C                     MOVEL*BLANK    WUK3CD           Delivery Reason
     C                     Z-ADD*ZERO     #PFIDT           DT TrkScl Weigh
     C                     Z-ADD*ZERO     #PAXTH           DT TrkScl Weigh
     C                     Z-ADD*ZERO     #PAYTH           DT Wait @ TrkSc
     C                     Z-ADD*ZERO     #PFJDT           DT To Recv Dock
     C                     Z-ADD*ZERO     #PAZTH           DT To Recv Dock
     C                     Z-ADD*ZERO     #PA0TH           DT Wait-Rcv Doc
     C                     Z-ADD*ZERO     WUFKDT           DT Start Unload
     C                     Z-ADD*ZERO     WUA1TH           DT Start Unload
     C                     Z-ADD*ZERO     WUA2TH           DT Wait @ Rcv D
     C                     Z-ADD*ZERO     WUFLDT           DT End Unload D
     C                     Z-ADD*ZERO     WUA3TH           DT End Unload T
     C                     Z-ADD*ZERO     WUA4TH           DT Unload Time
     C                     Z-ADD*ZERO     WUBTTH           DT Unload Varia
     C                     Z-ADD*ZERO     WUFMDT           DT TrkScl Weigh
     C                     Z-ADD*ZERO     WUA5TH           DT TrkScl Weigh
     C                     Z-ADD*ZERO     WUA6TH           DT Wait Time @
     C                     Z-ADD*ZERO     WUBXTH           DT Formula Wait
     C                     MOVEL*BLANK    WUXKST           DT Source Type
     C                     MOVEL*BLANK    WUYDST           DT GATE UPDATE
     C                     Z-ADD*ZERO     WUFYDT           DT Unused Date
     C                     Z-ADD*ZERO     WUB0TH           DT Unused Time
     C                     Z-ADD*ZERO     WUBZTH           DT Unused Wait
     C                     Z-ADD*ZERO     WUH2A1           DSD Scheduled D
     C                     Z-ADD*ZERO     WUJ2A1           DT Head Receive
     C                     Z-ADD*ZERO     WUJ3A1           DT Weight Recei
     C                     Z-ADD*ZERO     WUKMA1           DT Avg Weight R
     C                     Z-ADD*ZERO     WUJ4A1           DT Head DOA
     C                     Z-ADD*ZERO     WUJ5A1           DT Weight DOA
     C                     Z-ADD*ZERO     WUJ6A1           DT Head Yard De
     C                     Z-ADD*ZERO     WUJ7A1           DT Weight Yard
     C                     Z-ADD*ZERO     WUJ8A1           DT Head Condemn
     C                     Z-ADD*ZERO     WUJ9A1           DT Weight Conde
     C                     Z-ADD*ZERO     WUKAA1           DT Head Held Ov
     C                     Z-ADD*ZERO     WUKBA1           DT Weight Held
     C                     Z-ADD*ZERO     WUKCA1           DT Head Killed
     C                     Z-ADD*ZERO     WUKDA1           DT Weight Kille
     C                     Z-ADD*ZERO     WUKEA1           DT Head Market
     C                     Z-ADD*ZERO     WUKFA1           DT Weight Marke
     C                     Z-ADD*ZERO     WUKNA1           DT Avg Weight M
     C                     Z-ADD*ZERO     WUKGA1           DT Head Resale
     C                     Z-ADD*ZERO     WUKHA1           DT Weight Resal
     C                     Z-ADD*ZERO     WUKOA1           DT Avg Weight R
     C                     Z-ADD*ZERO     WUKIA1           DT Head Unused
     C                     Z-ADD*ZERO     WUKJA1           DT Weight Unuse
     C                     Z-ADD*ZERO     WUKKA1           DT Head Unused
     C                     Z-ADD*ZERO     WUKLA1           DT Weight Unuse
     C                     MOVEL*BLANK    WUYNST           DT Error Sts
     C                     MOVEL*BLANK    WUYOST           DT Error Reason
     C                     MOVEL*BLANK    WUABCD           PD Producer Cod
     C                     MOVEL*BLANK    WUAECD           PL Location Cod
     C                     MOVEL*BLANK    WUAACD           SR Source Code
     C                     MOVEL*BLANK    YL0002           Return Code USR
     C                     MOVEL'Y2U0005' YL0002           Return Code USR
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBHONB    #1HONB           CC Company Numb
     C                     Z-ADDWBE0DT    #PE0DT           DSH Kill Date
     C                     Z-ADDWBE9DT    #PE9DT           DT Delivery Dat
     C                     Z-ADDWBAJTH    #PAJTH           DT Delivery Tim
     C                     Z-ADDWBH4A1    #PH4A1           DT Delivery Tim
     C                     Z-ADDWBFXDT    WUFXDT           DT Actual Kill
     C                     Z-ADDWBJIA1    WUJIA1           DT Actual Deliv
     C                     Z-ADDWBIBA1    WUIBA1           DT Scheduled Ho
     C                     MOVELWBW5ST    WUW5ST           DT Delivery Ini
     C                     Z-ADDWBICA1    WUICA1           DT Farm Site Co
     C                     MOVELWBK0CD    WUK0CD           DT Building
     C                     MOVELWBK1CD    WUK1CD           DT Room
     C                     MOVELWBLFCD    WULFCD           DT Sire Line Co
     C                     MOVELWBLGCD    WULGCD           DT Hog Group Re
     C                     Z-ADDWBIDA1    WUIDA1           DT Delivered He
     C                     Z-ADDWBIPA1    WUIPA1           DT Delivered We
     C                     MOVELWBLICD    WULICD           DT Trucker Code
     C                     MOVELWBJ8CD    WUJ8CD           DT Driver
     C                     MOVELWBJ9CD    WUJ9CD           DT Loading Crew
     C                     MOVELWBMGCD    WUMGCD           CHR Code
     C                     MOVELWBXHST    WUXHST           DT Load Type
     C                     MOVELWBXIST    WUXIST           DT Full/Split L
     C                     Z-ADDWBIEA1    WUIEA1           DT Movement Num
     C                     MOVELWBKBCD    WUKBCD           DT Truck ID
     C                     MOVELWBKZCD    WUKZCD           DT Trailer ID
     C                     MOVELWBLHCD    WULHCD           DT Transportati
     C                     Z-ADDWBFADT    WUFADT           DT Transprtn Of
     C                     Z-ADDWBAKTH    WUAKTH           DT Transprtn Of
     C                     Z-ADDWBBYTH    WUBYTH           DT Arrive@Frm v
     C                     MOVELWBW6ST    WUW6ST           DT On-Time Farm
     C                     MOVELWBXXST    WUXXST           DT Route Start
     C                     Z-ADDWBFBDT    WUFBDT           DT Route Start
     C                     Z-ADDWBALTH    WUALTH           DT Route Start
     C                     Z-ADDWBBVTH    WUBVTH           DT Route Start
     C                     Z-ADDWBAMTH    WUAMTH           DT Wait @ Trans
     C                     Z-ADDWBFCDT    WUFCDT           DT Arrive @ Far
     C                     Z-ADDWBANTH    WUANTH           DT Arrive @ Far
     C                     Z-ADDWBBHTH    WUBHTH           DT Drive Time T
     C                     Z-ADDWBFDDT    WUFDDT           DT Start Loadin
     C                     Z-ADDWBAOTH    WUAOTH           DT Start Loadin
     C                     Z-ADDWBBWTH    WUBWTH           DT Start Loadin
     C                     Z-ADDWBAPTH    WUAPTH           DT Wait @ Farm
     C                     Z-ADDWBFEDT    WUFEDT           DT Frm End Load
     C                     Z-ADDWBAQTH    WUAQTH           DT Frm End Load
     C                     Z-ADDWBARTH    WUARTH           DT Load Time
     C                     Z-ADDWBFFDT    WUFFDT           DT Leave Farm D
     C                     Z-ADDWBASTH    WUASTH           DT Leave Farm T
     C                     Z-ADDWBATTH    WUATTH           DT Wait-Depart
     C                     Z-ADDWBFGDT    WUFGDT           DT Plt TrkWsh A
     C                     Z-ADDWBAUTH    WUAUTH           DT Plt TrkWsh A
     C                     Z-ADDWBFHDT    #DFHDT           DT Arrive @ Pla
     C                     Z-ADDWBAVTH    #DAVTH           DT Arrive @ Pla
     C                     Z-ADDWBAWTH    #PAWTH           DT Wait @ TrkWs
     C                     Z-ADDWBBKTH    WUBKTH           DT Drive Time T
     C                     Z-ADDWBBLTH    WUBLTH           DT Delv Time Va
     C                     MOVELWBXJST    WUXJST           DT On Time Deli
     C                     MOVELWBK3CD    WUK3CD           Delivery Reason
     C                     Z-ADDWBFIDT    #PFIDT           DT TrkScl Weigh
     C                     Z-ADDWBAXTH    #PAXTH           DT TrkScl Weigh
     C                     Z-ADDWBAYTH    #PAYTH           DT Wait @ TrkSc
     C                     Z-ADDWBFJDT    #PFJDT           DT To Recv Dock
     C                     Z-ADDWBAZTH    #PAZTH           DT To Recv Dock
     C                     Z-ADDWBA0TH    #PA0TH           DT Wait-Rcv Doc
     C                     Z-ADDWBFKDT    WUFKDT           DT Start Unload
     C                     Z-ADDWBA1TH    WUA1TH           DT Start Unload
     C                     Z-ADDWBA2TH    WUA2TH           DT Wait @ Rcv D
     C                     Z-ADDWBFLDT    WUFLDT           DT End Unload D
     C                     Z-ADDWBA3TH    WUA3TH           DT End Unload T
     C                     Z-ADDWBA4TH    WUA4TH           DT Unload Time
     C                     Z-ADDWBBTTH    WUBTTH           DT Unload Varia
     C                     Z-ADDWBFMDT    WUFMDT           DT TrkScl Weigh
     C                     Z-ADDWBA5TH    WUA5TH           DT TrkScl Weigh
     C                     Z-ADDWBA6TH    WUA6TH           DT Wait Time @
     C                     Z-ADDWBBXTH    WUBXTH           DT Formula Wait
     C                     MOVELWBXKST    WUXKST           DT Source Type
     C                     MOVELWBYDST    WUYDST           DT GATE UPDATE
     C                     Z-ADDWBFYDT    WUFYDT           DT Unused Date
     C                     Z-ADDWBB0TH    WUB0TH           DT Unused Time
     C                     Z-ADDWBBZTH    WUBZTH           DT Unused Wait
     C                     Z-ADDWBH2A1    WUH2A1           DSD Scheduled D
     C                     Z-ADDWBJ2A1    WUJ2A1           DT Head Receive
     C                     Z-ADDWBJ3A1    WUJ3A1           DT Weight Recei
     C                     Z-ADDWBKMA1    WUKMA1           DT Avg Weight R
     C                     Z-ADDWBJ4A1    WUJ4A1           DT Head DOA
     C                     Z-ADDWBJ5A1    WUJ5A1           DT Weight DOA
     C                     Z-ADDWBJ6A1    WUJ6A1           DT Head Yard De
     C                     Z-ADDWBJ7A1    WUJ7A1           DT Weight Yard
     C                     Z-ADDWBJ8A1    WUJ8A1           DT Head Condemn
     C                     Z-ADDWBJ9A1    WUJ9A1           DT Weight Conde
     C                     Z-ADDWBKAA1    WUKAA1           DT Head Held Ov
     C                     Z-ADDWBKBA1    WUKBA1           DT Weight Held
     C                     Z-ADDWBKCA1    WUKCA1           DT Head Killed
     C                     Z-ADDWBKDA1    WUKDA1           DT Weight Kille
     C                     Z-ADDWBKEA1    WUKEA1           DT Head Market
     C                     Z-ADDWBKFA1    WUKFA1           DT Weight Marke
     C                     Z-ADDWBKNA1    WUKNA1           DT Avg Weight M
     C                     Z-ADDWBKGA1    WUKGA1           DT Head Resale
     C                     Z-ADDWBKHA1    WUKHA1           DT Weight Resal
     C                     Z-ADDWBKOA1    WUKOA1           DT Avg Weight R
     C                     Z-ADDWBKIA1    WUKIA1           DT Head Unused
     C                     Z-ADDWBKJA1    WUKJA1           DT Weight Unuse
     C                     Z-ADDWBKKA1    WUKKA1           DT Head Unused
     C                     Z-ADDWBKLA1    WUKLA1           DT Weight Unuse
     C                     MOVELWBYNST    WUYNST           DT Error Sts
     C                     MOVELWBYOST    WUYOST           DT Error Reason
     C                     MOVELWBABCD    WUABCD           PD Producer Cod
     C                     MOVELWBAECD    WUAECD           PL Location Cod
     C                     MOVELWBAACD    WUAACD           SR Source Code
     C                     MOVEL*BLANK    YL0002           Return Code USR
     C           KRSSB     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Val Buy Order Load    RT - Buy Order Load Weight  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       #DSWST           BOL IN  record
     C                     MOVEL'N'       #DSXST           BOL OUT record
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHONB    WQSC01           CC Company Numb
     C           *LIKE     DEFN WCBNNB    WQSC02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQSC03           BOL Load Number
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           CC Company Numb
     C                     KFLD           WQSC02           BOH Buy Order N
     C                     KFLD           WQSC03           BOL Load Number
      * Setup key
     C                     Z-ADD#1HONB    WQSC01           CC Company Numb
     C                     Z-ADD#PBNNB    WQSC02           BOH Buy Order N
     C                     Z-ADD#PBONB    WQSC03           BOL Load Number
      * Establish starting position
     C           KRSSC     SETLL@EJCPBK                    *
     C           KRSSC     READE@EJCPBK                  90*
      * Data record not found
     C   90                MOVEL'PRK0841' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.BOLW Weight Type is In(En)
     C           WCSRST    IFEQ 'I'                        *IF
     C                     MOVEL'Y'       #DSWST           BOL IN  record
     C                     ELSE
      * CASE: DB1.BOLW Weight Type is Out(Fuera)
     C           WCSRST    IFEQ 'O'                        *IF
     C                     MOVEL'Y'       #DSXST           BOL OUT record
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSC     READE@EJCPBK                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C           YPMTFD    IFEQ '#1HONB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1HONB' defaulted for 'CC Company Number'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BSNB' defaulted for 'Next Buy Order Number'.
      * Field '(DTL) #1B1DT' defaulted for 'Current Kill Date'.
      * Field '(DTL) #1B2DT' defaulted for 'Next Kill Date'.
      * Field '(DTL) #1H4NB' defaulted for 'Last Drive Card Number'.
     C                     CALL 'PKLFSRR'              90  Sel Company Con
     C                     PARM *BLANK    W0RTN   7
     C           #1HONB    PARM #1HONB    WQ0001  30       CC Company Numb
     C           #1BSNB    PARM *ZERO     WQ0002  70       Next Buy Order
     C           #1B1DT    PARM *ZERO     WQ0003  70       Current Kill Da
     C           #1B2DT    PARM *ZERO     WQ0004  70       Next Kill Date
     C           #1H4NB    PARM *ZERO     WQ0005  30       Last Drive Card
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKLFSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1HONB    IFNE *ZERO                      CC Company Numb
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1PAST           BOL Truck Scale
     C                     Z-ADD*ZERO     P2E0DT           DSH Kill Date
     C                     Z-ADD*ZERO     P2E9DT           DT Delivery Dat
     C                     Z-ADD*ZERO     P2AJTH           DT Delivery Tim
     C                     Z-ADD*ZERO     P2H4A1           DT Delivery Tim
     C                     Z-ADD*ZERO     P2FHDT           DT Arrive @ Pla
     C                     Z-ADD*ZERO     P2AVTH           DT Arrive @ Pla
     C                     Z-ADD*ZERO     P2AWTH           DT Wait @ TrkWs
     C                     Z-ADD*ZERO     P2FIDT           DT TrkScl Weigh
     C                     Z-ADD*ZERO     P2AXTH           DT TrkScl Weigh
     C                     Z-ADD*ZERO     P2AYTH           DT Wait @ TrkSc
     C                     Z-ADD*ZERO     P2FJDT           DT To Recv Dock
     C                     Z-ADD*ZERO     P2AZTH           DT To Recv Dock
     C                     Z-ADD*ZERO     P2A0TH           DT Wait-Rcv Doc
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field First Time Flag Usr
     C                     MOVEL*BLANK    WUHBST  1
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Define work field CC Company Number
     C                     Z-ADD*ZERO     WUHONB  30
      * Define work field Display Print Prompt  Usr
     C                     MOVEL*BLANK    WUHJST  1
      * Define work field Invalid Y/N USR
     C                     MOVEL*BLANK    WUG3ST  1
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACQDT           BOL Kill Date
     C                     Z-ADD*ZERO     WAABTH           BOL Pln Delv St
     C                     Z-ADD*ZERO     WAACTH           BOL Pln Delv En
     C                     Z-ADD*ZERO     WABPNB           BOL Pln Head De
     C                     Z-ADD*ZERO     WACSNB           BOL Shipped Wgt
     C                     Z-ADD*ZERO     WAAUDT           BOL Pln Delv Da
     C                     Z-ADD*ZERO     WAAGPR           BOL Freight Uni
     C                     Z-ADD*ZERO     WAATVA           BOL Freight Amt
     C                     Z-ADD*ZERO     WADHNB           BOL Head Receiv
     C                     Z-ADD*ZERO     WADINB           BOL Live Wgt Re
     C                     Z-ADD*ZERO     WAGINB           BOL Trucker Che
     C                     Z-ADD*ZERO     WABZDT           BOL Trucker Che
     C                     Z-ADD*ZERO     WALSNB           BOL AP Voucher
     C                     Z-ADD*ZERO     WALDSH           BOL Shipped Hea
     C                     Z-ADD*ZERO     WAJKRU           BOL HPS Movemen
     C                     Z-ADD*ZERO     WAKEOR           BOL Head LFT
     C                     Z-ADD*ZERO     WAIOEW           BOL Head EUT/KO
     C                     Z-ADD*ZERO     WAKJIO           BOL Auth Gate E
     C                     Z-ADD*ZERO     WAIOJR           BOL Head Receiv
     C                     Z-ADD*ZERO     WAEIRR           BOL Unused Wgt
     C                     Z-ADD*ZERO     WAITMF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WAODJE           BOL Unused Wgt
     C                     Z-ADD*ZERO     WARJIF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WAOEJF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WAD0DT           BOL Auth Gate E
     C                     Z-ADD*ZERO     WAD1DT           BOL Unused Date
     C                     Z-ADD*ZERO     WAD2DT           BOL Unused Date
     C                     Z-ADD*ZERO     WAD3DT           BOL Unused Date
     C                     Z-ADD*ZERO     WAD4DT           BOL Unused Date
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field DT Actual Kill Date
     C                     Z-ADD*ZERO     WUFXDT  70
      * Define work field DT Actual Delivery Hour
     C                     Z-ADD*ZERO     WUJIA1  20
      * Define work field DT Scheduled Hour
     C                     Z-ADD*ZERO     WUIBA1  20
      * Define work field DT Delivery Initiation
     C                     MOVEL*BLANK    WUW5ST  1
      * Define work field DT Farm Site Code
     C                     Z-ADD*ZERO     WUICA1  50
      * Define work field DT Building
     C                     MOVEL*BLANK    WUK0CD  5
      * Define work field DT Room
     C                     MOVEL*BLANK    WUK1CD  5
      * Define work field DT Sire Line Code
     C                     MOVEL*BLANK    WULFCD  5
      * Define work field DT Hog Group Reference
     C                     MOVEL*BLANK    WULGCD 10
      * Define work field DT Delivered Head
     C                     Z-ADD*ZERO     WUIDA1  30
      * Define work field DT Delivered Weight lbs
     C                     Z-ADD*ZERO     WUIPA1  71
      * Define work field DT Trucker Code HPS
     C                     MOVEL*BLANK    WULICD  5
      * Define work field DT Driver
     C                     MOVEL*BLANK    WUJ8CD  5
      * Define work field DT Loading Crew
     C                     MOVEL*BLANK    WUJ9CD  5
      * Define work field CHR Code
     C                     MOVEL*BLANK    WUMGCD  6
      * Define work field DT Load Type
     C                     MOVEL*BLANK    WUXHST  2
      * Define work field DT Full/Split Load
     C                     MOVEL*BLANK    WUXIST  1
      * Define work field DT Movement Number
     C                     Z-ADD*ZERO     WUIEA1  70
      * Define work field DT Truck ID
     C                     MOVEL*BLANK    WUKBCD 15
      * Define work field DT Trailer ID
     C                     MOVEL*BLANK    WUKZCD 15
      * Define work field DT Transportation Office
     C                     MOVEL*BLANK    WULHCD  5
      * Define work field DT Transprtn Office Date
     C                     Z-ADD*ZERO     WUFADT  70
      * Define work field DT Transprtn Office Time
     C                     Z-ADD*ZERO     WUAKTH  40
      * Define work field DT Arrive@Frm v StartLd
     C                     Z-ADD*ZERO     WUBYTH  40
      * Define work field DT On-Time Farm Arrvl Sts
     C                     MOVEL*BLANK    WUW6ST  1
      * Define work field DT Route Start Pnt
     C                     MOVEL*BLANK    WUXXST  1
      * Define work field DT Route Start Date
     C                     Z-ADD*ZERO     WUFBDT  70
      * Define work field DT Route Start Time
     C                     Z-ADD*ZERO     WUALTH  40
      * Define work field DT Route Start Variance
     C                     Z-ADD*ZERO     WUBVTH  40
      * Define work field DT Wait @ Transp Offc Tm
     C                     Z-ADD*ZERO     WUAMTH  40
      * Define work field DT Arrive @ Farm Date
     C                     Z-ADD*ZERO     WUFCDT  70
      * Define work field DT Arrive @ Farm Time
     C                     Z-ADD*ZERO     WUANTH  40
      * Define work field DT Drive Time To Farm
     C                     Z-ADD*ZERO     WUBHTH  40
      * Define work field DT Start Loading Date
     C                     Z-ADD*ZERO     WUFDDT  70
      * Define work field DT Start Loading Time
     C                     Z-ADD*ZERO     WUAOTH  40
      * Define work field DT Start Loading Variance
     C                     Z-ADD*ZERO     WUBWTH  40
      * Define work field DT Wait @ Farm
     C                     Z-ADD*ZERO     WUAPTH  40
      * Define work field DT Frm End Loading Date
     C                     Z-ADD*ZERO     WUFEDT  70
      * Define work field DT Frm End Loading Time
     C                     Z-ADD*ZERO     WUAQTH  40
      * Define work field DT Load Time
     C                     Z-ADD*ZERO     WUARTH  40
      * Define work field DT Leave Farm Date
     C                     Z-ADD*ZERO     WUFFDT  70
      * Define work field DT Leave Farm Time
     C                     Z-ADD*ZERO     WUASTH  40
      * Define work field DT Wait-Depart Frm
     C                     Z-ADD*ZERO     WUATTH  40
      * Define work field DT Plt TrkWsh Arvl Date
     C                     Z-ADD*ZERO     WUFGDT  70
      * Define work field DT Plt TrkWsh Arvl Time
     C                     Z-ADD*ZERO     WUAUTH  40
      * Define work field DT Drive Time To Plant
     C                     Z-ADD*ZERO     WUBKTH  40
      * Define work field DT Delv Time Variance
     C                     Z-ADD*ZERO     WUBLTH  40
      * Define work field DT On Time Delivery
     C                     MOVEL*BLANK    WUXJST  1
      * Define work field Delivery Reason Code
     C                     MOVEL*BLANK    WUK3CD  6
      * Define work field DT Start Unloading Date
     C                     Z-ADD*ZERO     WUFKDT  70
      * Define work field DT Start Unloading Time
     C                     Z-ADD*ZERO     WUA1TH  40
      * Define work field DT Wait @ Rcv Dock
     C                     Z-ADD*ZERO     WUA2TH  40
      * Define work field DT End Unload Date
     C                     Z-ADD*ZERO     WUFLDT  70
      * Define work field DT End Unload Time
     C                     Z-ADD*ZERO     WUA3TH  40
      * Define work field DT Unload Time
     C                     Z-ADD*ZERO     WUA4TH  40
      * Define work field DT Unload Variance Time
     C                     Z-ADD*ZERO     WUBTTH  40
      * Define work field DT TrkScl Weigh-Out Date
     C                     Z-ADD*ZERO     WUFMDT  70
      * Define work field DT TrkScl Weigh-Out Time
     C                     Z-ADD*ZERO     WUA5TH  40
      * Define work field DT Wait Time @ the Plant
     C                     Z-ADD*ZERO     WUA6TH  40
      * Define work field DT Formula Wait Tm @ Plt
     C                     Z-ADD*ZERO     WUBXTH  40
      * Define work field DT Source Type
     C                     MOVEL*BLANK    WUXKST  1
      * Define work field DT GATE UPDATE *YES
     C                     MOVEL*BLANK    WUYDST  4
      * Define work field DT Unused Date
     C                     Z-ADD*ZERO     WUFYDT  70
      * Define work field DT Unused Time
     C                     Z-ADD*ZERO     WUB0TH  40
      * Define work field DT Unused Wait Time
     C                     Z-ADD*ZERO     WUBZTH  40
      * Define work field DSD Scheduled Delv Head
     C                     Z-ADD*ZERO     WUH2A1  30
      * Define work field DT Head Received
     C                     Z-ADD*ZERO     WUJ2A1  50
      * Define work field DT Weight Received
     C                     Z-ADD*ZERO     WUJ3A1  71
      * Define work field DT Avg Weight Received
     C                     Z-ADD*ZERO     WUKMA1  51
      * Define work field DT Head DOA
     C                     Z-ADD*ZERO     WUJ4A1  50
      * Define work field DT Weight DOA
     C                     Z-ADD*ZERO     WUJ5A1  71
      * Define work field DT Head Yard Dead
     C                     Z-ADD*ZERO     WUJ6A1  50
      * Define work field DT Weight Yard Dead
     C                     Z-ADD*ZERO     WUJ7A1  71
      * Define work field DT Head Condemned
     C                     Z-ADD*ZERO     WUJ8A1  50
      * Define work field DT Weight Condemned
     C                     Z-ADD*ZERO     WUJ9A1  71
      * Define work field DT Head Held Over
     C                     Z-ADD*ZERO     WUKAA1  50
      * Define work field DT Weight Held Over
     C                     Z-ADD*ZERO     WUKBA1  71
      * Define work field DT Head Killed
     C                     Z-ADD*ZERO     WUKCA1  50
      * Define work field DT Weight Killed
     C                     Z-ADD*ZERO     WUKDA1  71
      * Define work field DT Head Market
     C                     Z-ADD*ZERO     WUKEA1  50
      * Define work field DT Weight Market
     C                     Z-ADD*ZERO     WUKFA1  71
      * Define work field DT Avg Weight Market
     C                     Z-ADD*ZERO     WUKNA1  51
      * Define work field DT Head Resale
     C                     Z-ADD*ZERO     WUKGA1  50
      * Define work field DT Weight Resale
     C                     Z-ADD*ZERO     WUKHA1  71
      * Define work field DT Avg Weight Resale
     C                     Z-ADD*ZERO     WUKOA1  51
      * Define work field DT Head Unused 1
     C                     Z-ADD*ZERO     WUKIA1  50
      * Define work field DT Weight Unused 1
     C                     Z-ADD*ZERO     WUKJA1  71
      * Define work field DT Head Unused 2
     C                     Z-ADD*ZERO     WUKKA1  50
      * Define work field DT Weight Unused 2
     C                     Z-ADD*ZERO     WUKLA1  71
      * Define work field DT Error Sts
     C                     MOVEL*BLANK    WUYNST  1
      * Define work field DT Error Reason
     C                     MOVEL*BLANK    WUYOST  2
      * Define work field PD Producer Code
     C                     MOVEL*BLANK    WUABCD  6
      * Define work field PL Location Code
     C                     MOVEL*BLANK    WUAECD  6
      * Define work field SR Source Code
     C                     MOVEL*BLANK    WUAACD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHONB           CC Company Numb
     C                     Z-ADD*ZERO     WBE0DT           DSH Kill Date
     C                     Z-ADD*ZERO     WBE9DT           DT Delivery Dat
     C                     Z-ADD*ZERO     WBAJTH           DT Delivery Tim
     C                     Z-ADD*ZERO     WBH4A1           DT Delivery Tim
     C                     Z-ADD*ZERO     WBFXDT           DT Actual Kill
     C                     Z-ADD*ZERO     WBJIA1           DT Actual Deliv
     C                     Z-ADD*ZERO     WBIBA1           DT Scheduled Ho
     C                     Z-ADD*ZERO     WBICA1           DT Farm Site Co
     C                     Z-ADD*ZERO     WBIDA1           DT Delivered He
     C                     Z-ADD*ZERO     WBIPA1           DT Delivered We
     C                     Z-ADD*ZERO     WBIEA1           DT Movement Num
     C                     Z-ADD*ZERO     WBFADT           DT Transprtn Of
     C                     Z-ADD*ZERO     WBAKTH           DT Transprtn Of
     C                     Z-ADD*ZERO     WBBYTH           DT Arrive@Frm v
     C                     Z-ADD*ZERO     WBFBDT           DT Route Start
     C                     Z-ADD*ZERO     WBALTH           DT Route Start
     C                     Z-ADD*ZERO     WBBVTH           DT Route Start
     C                     Z-ADD*ZERO     WBAMTH           DT Wait @ Trans
     C                     Z-ADD*ZERO     WBFCDT           DT Arrive @ Far
     C                     Z-ADD*ZERO     WBANTH           DT Arrive @ Far
     C                     Z-ADD*ZERO     WBBHTH           DT Drive Time T
     C                     Z-ADD*ZERO     WBFDDT           DT Start Loadin
     C                     Z-ADD*ZERO     WBAOTH           DT Start Loadin
     C                     Z-ADD*ZERO     WBBWTH           DT Start Loadin
     C                     Z-ADD*ZERO     WBAPTH           DT Wait @ Farm
     C                     Z-ADD*ZERO     WBFEDT           DT Frm End Load
     C                     Z-ADD*ZERO     WBAQTH           DT Frm End Load
     C                     Z-ADD*ZERO     WBARTH           DT Load Time
     C                     Z-ADD*ZERO     WBFFDT           DT Leave Farm D
     C                     Z-ADD*ZERO     WBASTH           DT Leave Farm T
     C                     Z-ADD*ZERO     WBATTH           DT Wait-Depart
     C                     Z-ADD*ZERO     WBFGDT           DT Plt TrkWsh A
     C                     Z-ADD*ZERO     WBAUTH           DT Plt TrkWsh A
     C                     Z-ADD*ZERO     WBFHDT           DT Arrive @ Pla
     C                     Z-ADD*ZERO     WBAVTH           DT Arrive @ Pla
     C                     Z-ADD*ZERO     WBAWTH           DT Wait @ TrkWs
     C                     Z-ADD*ZERO     WBBKTH           DT Drive Time T
     C                     Z-ADD*ZERO     WBBLTH           DT Delv Time Va
     C                     Z-ADD*ZERO     WBFIDT           DT TrkScl Weigh
     C                     Z-ADD*ZERO     WBAXTH           DT TrkScl Weigh
     C                     Z-ADD*ZERO     WBAYTH           DT Wait @ TrkSc
     C                     Z-ADD*ZERO     WBFJDT           DT To Recv Dock
     C                     Z-ADD*ZERO     WBAZTH           DT To Recv Dock
     C                     Z-ADD*ZERO     WBA0TH           DT Wait-Rcv Doc
     C                     Z-ADD*ZERO     WBFKDT           DT Start Unload
     C                     Z-ADD*ZERO     WBA1TH           DT Start Unload
     C                     Z-ADD*ZERO     WBA2TH           DT Wait @ Rcv D
     C                     Z-ADD*ZERO     WBFLDT           DT End Unload D
     C                     Z-ADD*ZERO     WBA3TH           DT End Unload T
     C                     Z-ADD*ZERO     WBA4TH           DT Unload Time
     C                     Z-ADD*ZERO     WBBTTH           DT Unload Varia
     C                     Z-ADD*ZERO     WBFMDT           DT TrkScl Weigh
     C                     Z-ADD*ZERO     WBA5TH           DT TrkScl Weigh
     C                     Z-ADD*ZERO     WBA6TH           DT Wait Time @
     C                     Z-ADD*ZERO     WBBXTH           DT Formula Wait
     C                     Z-ADD*ZERO     WBFYDT           DT Unused Date
     C                     Z-ADD*ZERO     WBB0TH           DT Unused Time
     C                     Z-ADD*ZERO     WBBZTH           DT Unused Wait
     C                     Z-ADD*ZERO     WBH2A1           DSD Scheduled D
     C                     Z-ADD*ZERO     WBJ2A1           DT Head Receive
     C                     Z-ADD*ZERO     WBJ3A1           DT Weight Recei
     C                     Z-ADD*ZERO     WBKMA1           DT Avg Weight R
     C                     Z-ADD*ZERO     WBJ4A1           DT Head DOA
     C                     Z-ADD*ZERO     WBJ5A1           DT Weight DOA
     C                     Z-ADD*ZERO     WBJ6A1           DT Head Yard De
     C                     Z-ADD*ZERO     WBJ7A1           DT Weight Yard
     C                     Z-ADD*ZERO     WBJ8A1           DT Head Condemn
     C                     Z-ADD*ZERO     WBJ9A1           DT Weight Conde
     C                     Z-ADD*ZERO     WBKAA1           DT Head Held Ov
     C                     Z-ADD*ZERO     WBKBA1           DT Weight Held
     C                     Z-ADD*ZERO     WBKCA1           DT Head Killed
     C                     Z-ADD*ZERO     WBKDA1           DT Weight Kille
     C                     Z-ADD*ZERO     WBKEA1           DT Head Market
     C                     Z-ADD*ZERO     WBKFA1           DT Weight Marke
     C                     Z-ADD*ZERO     WBKNA1           DT Avg Weight M
     C                     Z-ADD*ZERO     WBKGA1           DT Head Resale
     C                     Z-ADD*ZERO     WBKHA1           DT Weight Resal
     C                     Z-ADD*ZERO     WBKOA1           DT Avg Weight R
     C                     Z-ADD*ZERO     WBKIA1           DT Head Unused
     C                     Z-ADD*ZERO     WBKJA1           DT Weight Unuse
     C                     Z-ADD*ZERO     WBKKA1           DT Head Unused
     C                     Z-ADD*ZERO     WBKLA1           DT Weight Unuse
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBBONB           BOL Load Number
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHONB           CC Company Numb
     C                     Z-ADD*ZERO     WCBOMV           BOLW Movement N
     C                     Z-ADD*ZERO     WCBOSW           BOLW Scale Weig
     C                     Z-ADD*ZERO     WCDQDT           BOLW Scale Weig
     C                     Z-ADD*ZERO     WCA2TM           BOLW Scale Weig
     C                     Z-ADD*ZERO     WCHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WCBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WCBONB           BOL Load Number
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Oms Name
     C                     MOVEL*BLANK    YL0001 30
      * Define local work field Return Code USR
     C                     MOVEL*BLANK    YL0002  7
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * MODIFICATIONS
      * 01/23/2021 ISE H16853 - Increased the length from 5 to 7 and
      *                         corrected the alignment of Buy Order Numb
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 BOLW not found
