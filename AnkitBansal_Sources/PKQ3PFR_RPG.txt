     H/TITLE Prt Hot Scl Upl Summ  PF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Print file
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 02/02/21  Time  : 13:02:25
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKBOREL1IF  E           K        DISK
      * RTV : Evaluation Validation     Retrieval index
      *
     FPKA1CPNCIF  E           K        DISK
      * RSQ : Tattoo Header             Co/KDte/Prd/BOL/Tto
      *
     FPKACREL1IF  E           K        DISK
      * RTV : Producer                  Retrieval index
      *
     FPKCPCPLBIF  E           K        DISK
      * RSQ : Eval Trans UPL            Co/Tattoo/KDte
      *
     FPKBVCPL9IF  E           K        DISK
      * RSQ : Eval Trans                Co/Bol/KillDt/Tattoo
      *
     FPKB1CPLGIF  E           K        DISK
      * RSQ : Carcass Detail            Co/BOL/Tto/KDte/Grs$(d)
      *
     FPKCDCPL1IF  E           K        DISK
      * RTV : Tattoo Ded/Add            Retrieval index
      *
     FPKAWCPL1IF  E           K        DISK
      * RTV : Buy Order Header          Retrieval index
      *
     FPKB1CPL5IF  E           K        DISK
      * RSQ : Carcass Detail            Co/BOL/Tto/kDte/Crno
      *
     FPKAQCPL0IF  E           K        DISK
      * RTV : Producer Sub-Contract     Retrieval index
      *
     FPKARREL0IF  E           K        DISK
      * RTV : Carcass Merit Program     Retrieval index
      *
     FPKBYREL2IF  E           K        DISK
      * RSQ : Carcass Merit Matrix Row  Cmp/MinCrc(d)
      *
     FPKBZREL2IF  E           K        DISK
      * RSQ : Carcass Merit Matrix Col  Cmp/Row/Lean%
      *
     FPKBZREL3IF  E           K        DISK
      * RSQ : Carcass Merit Matrix Col  Cmp/Row/Lean%(a)
      *
     FPKBZREL6IF  E           K        DISK
      * RSQ : Carcass Merit Matrix Col  Cmp/RoW/Bckft(d)
      *
     FPKBZREL5IF  E           K        DISK
      * RSQ : Carcass Merit Matrix Col  Cmp/Row/Bckft(a)
      *
     FPKA1CPNDIF  E           K        DISK
      * RTV : Tattoo Header             Retrieval Index 2
      *
     FPKEQCPL1IF  E           K        DISK
      * RTV : Hot Scale Upl Summ OUTF   Retrieval index
      *
     FPKCQCPL6IF  E           K        DISK
      * RSQ : Eval Trans Invalid UPL    Co/Kill/Shift
      *
     FPKB1CPL0UF  E           K        DISK                      A
      * UPD : Carcass Detail            Update index
      *
     FPKERCPL0IF  E           K        DISK                      A
      * UPD : Eval Tran Value Dtl OUTF  Update index
      *
     FPKESCPL1IF  E           K        DISK                      A
      * UPD : Eval Tran Value Hdr OUTF  Update index
      *
     FPKEQCPL0UF  E           K        DISK                      A
      * UPD : Hot Scale Upl Summ OUTF   Update index
      *
     FPKQ3PFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Prt Hot Scl Upl Summ  PF  Print file
      *
      * Long constants
     E                    @CN#    1  09  6   @CN    25
     I@B1CPC3
      * Carcass Detail            Co/BOL/Tto/KDte/Grs$(d)
      * Renamed input format fields
     I              B1HMNB                          WAHMNB
     I              B1BNNB                          WABNNB
     I              B1BONB                          WABONB
     I              B1CVNB                          WACVNB
     I              B1B0DT                          WAB0DT
     I              B1LGNB                          WALGNB
     I              B1EUNB                          WAEUNB
     I              B1LHNB                          WALHNB
     I              B1INST                          WAINST
     I              B1BEPR                          WABEPR
     I              B1ASPC                          WAASPC
     I              B1EWNB                          WAEWNB
     I              B1B4PR                          WAB4PR
     I              B1EYNB                          WAEYNB
     I              B1B1PR                          WAB1PR
     I              B1AVPR                          WAAVPR
     I              B1AUPC                          WAAUPC
     I              B1AWPR                          WAAWPR
     I              B1AXPR                          WAAXPR
     I              B1EZNB                          WAEZNB
     I              B1AYPR                          WAAYPR
     I              B1BBDT                          WABBDT
     I              B1AKTM                          WAAKTM
     I              B1IQST                          WAIQST
     I              B1EFST                          WAEFST
     I              B1H6NB                          WAH6NB
     I              B1BEPC                          WABEPC
     I              B1GCST                          WAGCST
     I              B1GDST                          WAGDST
     I              B1GEST                          WAGEST
     I              B1BHPC                          WABHPC
     I              B1IOST                          WAIOST
     I              B1IPST                          WAIPST
     I              B1LTNB                          WALTNB
     I              B1JNST                          WAJNST
     I              B1X4NB                          WAX4NB
     I              B1FNPC                          WAFNPC
     I              B1FOPC                          WAFOPC
     I              B1FPPC                          WAFPPC
     I              B1K2ST                          WAK2ST
     I              B1K3ST                          WAK3ST
     I              B1JWPR                          WAJWPR
     I              B1F5PC                          WAF5PC
     I              B1JXPR                          WAJXPR
     I              B1JYPR                          WAJYPR
     I              B1JZPR                          WAJZPR
     I              B1J0PR                          WAJ0PR
     I              B1J1PR                          WAJ1PR
     I              B1J2PR                          WAJ2PR
     I              B1J3PR                          WAJ3PR
     I              B1J4PR                          WAJ4PR
     I              B1UTST                          WAUTST
     I              B1HVCD                          WAHVCD
     I              B1DKJR                          WADKJR
     I              B1ITJF                          WAITJF
     I              B1IJGR                          WAIJGR
     I              B1ORJE                          WAORJE
     I              B1OTJR                          WAOTJR
     I              B1PEIR                          WAPEIR
     I              B1IEUF                          WAIEUF
     I              B1ORUE                          WAORUE
     I              B1IUTR                          WAIUTR
     I              B1IJRR                          WAIJRR
     I              B1VCST                          WAVCST
     I              B1VDST                          WAVDST
     I              B1VEST                          WAVEST
     I              B1VFST                          WAVFST
     I              B1VGST                          WAVGST
     I              B1ABCD                          WAABCD
     I              B1AACD                          WAAACD
     I              B1AAVN                          WAAAVN
     I              B1AADT                          WAAADT
     I              B1AMTM                          WAAMTM
     I              B1AJST                          WAAJST
     I              B1AHVN                          WAAHVN
     I              B1AGVN                          WAAGVN
     I              B1ABVN                          WAABVN
     I              B1ABDT                          WAABDT
     I              B1ABTM                          WAABTM
      *
     I@B1CPNX
      * Carcass Detail            Co/BOL/Tto/kDte/Crno
      * Renamed input format fields
     I              B1HMNB                          WBHMNB
     I              B1BNNB                          WBBNNB
     I              B1BONB                          WBBONB
     I              B1CVNB                          WBCVNB
     I              B1B0DT                          WBB0DT
     I              B1LGNB                          WBLGNB
     I              B1EUNB                          WBEUNB
     I              B1LHNB                          WBLHNB
     I              B1INST                          WBINST
     I              B1BEPR                          WBBEPR
     I              B1ASPC                          WBASPC
     I              B1EWNB                          WBEWNB
     I              B1B4PR                          WBB4PR
     I              B1EYNB                          WBEYNB
     I              B1B1PR                          WBB1PR
     I              B1AVPR                          WBAVPR
     I              B1AUPC                          WBAUPC
     I              B1AWPR                          WBAWPR
     I              B1AXPR                          WBAXPR
     I              B1EZNB                          WBEZNB
     I              B1AYPR                          WBAYPR
     I              B1BBDT                          WBBBDT
     I              B1AKTM                          WBAKTM
     I              B1IQST                          WBIQST
     I              B1EFST                          WBEFST
     I              B1H6NB                          WBH6NB
     I              B1BEPC                          WBBEPC
     I              B1GCST                          WBGCST
     I              B1GDST                          WBGDST
     I              B1GEST                          WBGEST
     I              B1BHPC                          WBBHPC
     I              B1IOST                          WBIOST
     I              B1IPST                          WBIPST
     I              B1LTNB                          WBLTNB
     I              B1JNST                          WBJNST
     I              B1X4NB                          WBX4NB
     I              B1FNPC                          WBFNPC
     I              B1FOPC                          WBFOPC
     I              B1FPPC                          WBFPPC
     I              B1K2ST                          WBK2ST
     I              B1K3ST                          WBK3ST
     I              B1JWPR                          WBJWPR
     I              B1F5PC                          WBF5PC
     I              B1JXPR                          WBJXPR
     I              B1JYPR                          WBJYPR
     I              B1JZPR                          WBJZPR
     I              B1J0PR                          WBJ0PR
     I              B1J1PR                          WBJ1PR
     I              B1J2PR                          WBJ2PR
     I              B1J3PR                          WBJ3PR
     I              B1J4PR                          WBJ4PR
     I              B1UTST                          WBUTST
     I              B1HVCD                          WBHVCD
     I              B1DKJR                          WBDKJR
     I              B1ITJF                          WBITJF
     I              B1IJGR                          WBIJGR
     I              B1ORJE                          WBORJE
     I              B1OTJR                          WBOTJR
     I              B1PEIR                          WBPEIR
     I              B1IEUF                          WBIEUF
     I              B1ORUE                          WBORUE
     I              B1IUTR                          WBIUTR
     I              B1IJRR                          WBIJRR
     I              B1VCST                          WBVCST
     I              B1VDST                          WBVDST
     I              B1VEST                          WBVEST
     I              B1VFST                          WBVFST
     I              B1VGST                          WBVGST
     I              B1ABCD                          WBABCD
     I              B1AACD                          WBAACD
     I              B1AAVN                          WBAAVN
     I              B1AADT                          WBAADT
     I              B1AMTM                          WBAMTM
     I              B1AJST                          WBAJST
     I              B1AHVN                          WBAHVN
     I              B1AGVN                          WBAGVN
     I              B1ABVN                          WBABVN
     I              B1ABDT                          WBABDT
     I              B1ABTM                          WBABTM
      *
     I@BZREPO
      * Carcass Merit Matrix Col  Cmp/Row/Lean%(a)
      * Renamed input format fields
     I              BZAMCD                          WCAMCD
     I              BZE8NB                          WCE8NB
     I              BZE4NB                          WCE4NB
     I              BZA1PC                          WCA1PC
     I              BZE7NB                          WCE7NB
     I              BZCHCD                          WCCHCD
     I              BZERNB                          WCERNB
     I              BZAAVN                          WCAAVN
     I              BZAADT                          WCAADT
     I              BZAMTM                          WCAMTM
     I              BZAJST                          WCAJST
     I              BZAHVN                          WCAHVN
     I              BZAGVN                          WCAGVN
     I              BZABVN                          WCABVN
     I              BZABDT                          WCABDT
     I              BZABTM                          WCABTM
      *
     I@BZRETM
      * Carcass Merit Matrix Col  Cmp/RoW/Bckft(d)
      * Renamed input format fields
     I              BZAMCD                          WDAMCD
     I              BZE8NB                          WDE8NB
     I              BZE4NB                          WDE4NB
     I              BZA1PC                          WDA1PC
     I              BZE7NB                          WDE7NB
     I              BZCHCD                          WDCHCD
     I              BZERNB                          WDERNB
     I              BZAAVN                          WDAAVN
     I              BZAADT                          WDAADT
     I              BZAMTM                          WDAMTM
     I              BZAJST                          WDAJST
     I              BZAHVN                          WDAHVN
     I              BZAGVN                          WDAGVN
     I              BZABVN                          WDABVN
     I              BZABDT                          WDABDT
     I              BZABTM                          WDABTM
      *
     I@BZRETL
      * Carcass Merit Matrix Col  Cmp/Row/Bckft(a)
      * Renamed input format fields
     I              BZAMCD                          WEAMCD
     I              BZE8NB                          WEE8NB
     I              BZE4NB                          WEE4NB
     I              BZA1PC                          WEA1PC
     I              BZE7NB                          WEE7NB
     I              BZCHCD                          WECHCD
     I              BZERNB                          WEERNB
     I              BZAAVN                          WEAAVN
     I              BZAADT                          WEAADT
     I              BZAMTM                          WEAMTM
     I              BZAJST                          WEAJST
     I              BZAHVN                          WEAHVN
     I              BZAGVN                          WEAGVN
     I              BZABVN                          WEABVN
     I              BZABDT                          WEABDT
     I              BZABTM                          WEABTM
      *
     I@A1CPC7
      * Tattoo Header             Retrieval Index 2
      * Renamed input format fields
     I              A1HMNB                          WFHMNB
     I              A1BNNB                          WFBNNB
     I              A1BONB                          WFBONB
     I              A1CVNB                          WFCVNB
     I              A1B0DT                          WFB0DT
     I              A1AWDT                          WFAWDT
     I              A1BICD                          WFBICD
     I              A1CPST                          WFCPST
     I              A1ACPR                          WFACPR
     I              A1B9PR                          WFB9PR
     I              A1CAPR                          WFCAPR
     I              A1C4ST                          WFC4ST
     I              A1AIPR                          WFAIPR
     I              A1A6DT                          WFA6DT
     I              A1C2ST                          WFC2ST
     I              A1CXNB                          WFCXNB
     I              A1CWNB                          WFCWNB
     I              A1FCNB                          WFFCNB
     I              A1H9NB                          WFH9NB
     I              A1FDNB                          WFFDNB
     I              A1FENB                          WFFENB
     I              A1HENB                          WFHENB
     I              A1HFNB                          WFHFNB
     I              A1CYNB                          WFCYNB
     I              A1LRNB                          WFLRNB
     I              A1E0NB                          WFE0NB
     I              A1A5PC                          WFA5PC
     I              A1FBNB                          WFFBNB
     I              A1A4PC                          WFA4PC
     I              A1F7NB                          WFF7NB
     I              A1HDNB                          WFHDNB
     I              A1F5NB                          WFF5NB
     I              A1F4NB                          WFF4NB
     I              A1F3NB                          WFF3NB
     I              A1F2NB                          WFF2NB
     I              A1AVPC                          WFAVPC
     I              A1AWPC                          WFAWPC
     I              A1CWPC                          WFCWPC
     I              A1A8PC                          WFA8PC
     I              A1A7PC                          WFA7PC
     I              A1B8PR                          WFB8PR
     I              A1AMPR                          WFAMPR
     I              A1ANPR                          WFANPR
     I              A1AYVA                          WFAYVA
     I              A1AWVA                          WFAWVA
     I              A1AOPR                          WFAOPR
     I              A1AXVA                          WFAXVA
     I              A1APPR                          WFAPPR
     I              A1ASPR                          WFASPR
     I              A1A4VA                          WFA4VA
     I              A1ATPR                          WFATPR
     I              A1A5VA                          WFA5VA
     I              A1CBPR                          WFCBPR
     I              A1CCPR                          WFCCPR
     I              A1LPNB                          WFLPNB
     I              A1CDPR                          WFCDPR
     I              A1A7VA                          WFA7VA
     I              A1A2PR                          WFA2PR
     I              A1JWST                          WFJWST
     I              A1CWST                          WFCWST
     I              A1D7ST                          WFD7ST
     I              A1D8ST                          WFD8ST
     I              A1DWST                          WFDWST
     I              A1D6ST                          WFD6ST
     I              A1GHNB                          WFGHNB
     I              A1BYDT                          WFBYDT
     I              A1E0ST                          WFE0ST
     I              A1E1ST                          WFE1ST
     I              A1E2ST                          WFE2ST
     I              A1BSDT                          WFBSDT
     I              A1BTDT                          WFBTDT
     I              A1BUDT                          WFBUDT
     I              A1HGNB                          WFHGNB
     I              A1HHNB                          WFHHNB
     I              A1HINB                          WFHINB
     I              A1A3PR                          WFA3PR
     I              A1A4PR                          WFA4PR
     I              A1A6PR                          WFA6PR
     I              A1J9NB                          WFJ9NB
     I              A1D6PR                          WFD6PR
     I              A1D7PR                          WFD7PR
     I              A1D8PR                          WFD8PR
     I              A1D9PR                          WFD9PR
     I              A1EAPR                          WFEAPR
     I              A1EBPR                          WFEBPR
     I              A1ECPR                          WFECPR
     I              A1EDPR                          WFEDPR
     I              A1EEPR                          WFEEPR
     I              A1EFPR                          WFEFPR
     I              A1EGPR                          WFEGPR
     I              A1EHPR                          WFEHPR
     I              A1KAST                          WFKAST
     I              A1J7ST                          WFJ7ST
     I              A1J9ST                          WFJ9ST
     I              A1OXNB                          WFOXNB
     I              A1LKST                          WFLKST
     I              A1LLST                          WFLLST
     I              A1J8ST                          WFJ8ST
     I              A1LIST                          WFLIST
     I              A1LJST                          WFLJST
     I              A1NZTX                          WFNZTX
     I              A1HJCD                          WFHJCD
     I              A1R4ST                          WFR4ST
     I              A1R5ST                          WFR5ST
     I              A1R6ST                          WFR6ST
     I              A1R7ST                          WFR7ST
     I              A1THWT                          WFTHWT
     I              A1T2WT                          WFT2WT
     I              A1THHD                          WFTHHD
     I              A1T2HD                          WFT2HD
     I              A1OBPR                          WFOBPR
     I              A1KOER                          WFKOER
     I              A1OPIR                          WFOPIR
     I              A1OPEM                          WFOPEM
     I              A1IORP                          WFIORP
     I              A1OWEO                          WFOWEO
     I              A1OQET                          WFOQET
     I              A1URST                          WFURST
     I              A1USST                          WFUSST
     I              A1HHPC                          WFHHPC
     I              A1S9PR                          WFS9PR
     I              A1TAPR                          WFTAPR
     I              A1TBPR                          WFTBPR
     I              A1JFUR                          WFJFUR
     I              A1KRIF                          WFKRIF
     I              A1KORF                          WFKORF
     I              A1KAPR                          WFKAPR
     I              A1KROT                          WFKROT
     I              A1OTJG                          WFOTJG
     I              A1IRJG                          WFIRJG
     I              A1IMJF                          WFIMJF
     I              A1IRGF                          WFIRGF
     I              A1KRJF                          WFKRJF
     I              A1OJRF                          WFOJRF
     I              A1KFOR                          WFKFOR
     I              A1ORJK                          WFORJK
     I              A1OMVJ                          WFOMVJ
     I              A1MVNF                          WFMVNF
     I              A1MCNF                          WFMCNF
     I              A1NCNF                          WFNCNF
     I              A1NCHF                          WFNCHF
     I              A1IGIR                          WFIGIR
     I              A1KFJR                          WFKFJR
     I              A1EADT                          WFEADT
     I              A1EBDT                          WFEBDT
     I              A1ECDT                          WFECDT
     I              A1EDDT                          WFEDDT
     I              A1EEDT                          WFEEDT
     I              A1U4ST                          WFU4ST
     I              A1U5ST                          WFU5ST
     I              A1U6ST                          WFU6ST
     I              A1U7ST                          WFU7ST
     I              A1U8ST                          WFU8ST
     I              A1U9ST                          WFU9ST
     I              A1VAST                          WFVAST
     I              A1VBST                          WFVBST
     I              A1BDCD                          WFBDCD
     I              A1CSCD                          WFCSCD
     I              A1ABCD                          WFABCD
     I              A1AECD                          WFAECD
     I              A1ACCD                          WFACCD
     I              A1AGCD                          WFAGCD
     I              A1BECD                          WFBECD
     I              A1AAVN                          WFAAVN
     I              A1AADT                          WFAADT
     I              A1AMTM                          WFAMTM
     I              A1AJST                          WFAJST
     I              A1AHVN                          WFAHVN
     I              A1AGVN                          WFAGVN
     I              A1ABVN                          WFABVN
     I              A1ABDT                          WFABDT
     I              A1ABTM                          WFABTM
      *
     I@EQCPC5
      * Hot Scale Upl Summ OUTF   Update index
      * Renamed input format fields
     I              EQHMNB                          WGHMNB
     I              EQBNNB                          WGBNNB
     I              EQBONB                          WGBONB
     I              EQCVNB                          WGCVNB
     I              EQB0DT                          WGB0DT
     I              EQJ9ST                          WGJ9ST
     I              EQLLST                          WGLLST
     I              EQCXNB                          WGCXNB
     I              EQCWNB                          WGCWNB
     I              EQFCNB                          WGFCNB
     I              EQFDNB                          WGFDNB
     I              EQFENB                          WGFENB
     I              EQVLCR                          WGVLCR
     I              EQEXCR                          WGEXCR
     I              EQVARC                          WGVARC
     I              EQADCR                          WGADCR
     I              EQVLDL                          WGVLDL
     I              EQEXDL                          WGEXDL
     I              EQTRCR                          WGTRCR
     I              EQPDVC                          WGPDVC
     I              EQAVAD                          WGAVAD
     I              EQLVNB                          WGLVNB
     I              EQLZNB                          WGLZNB
     I              EQGZPC                          WGGZPC
     I              EQG0PC                          WGG0PC
     I              EQQGPR                          WGQGPR
     I              EQQHPR                          WGQHPR
     I              EQQIPR                          WGQIPR
     I              EQQJPR                          WGQJPR
     I              EQF7NB                          WGF7NB
     I              EQHDNB                          WGHDNB
     I              EQF2NB                          WGF2NB
     I              EQF3NB                          WGF3NB
     I              EQF4NB                          WGF4NB
     I              EQAWPC                          WGAWPC
     I              EQCBPR                          WGCBPR
     I              EQQFPR                          WGQFPR
     I              EQABCD                          WGABCD
     I              EQAECD                          WGAECD
     I              EQAACD                          WGAACD
     I              EQKAST                          WGKAST
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IQPKB11    E DSPKB1CPL0
      * UPD : Carcass Detail            Update index
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKER1    E DSPKERCPL0
      * UPD : Eval Tran Value Dtl OUTF  Update index
      *
     IQPKES1    E DSPKESCPL1
      * UPD : Eval Tran Value Hdr OUTF  Update index
      *
     IQPKEQ1    E DSPKEQCPL0
      * UPD : Hot Scale Upl Summ OUTF   Update index
      * Renamed input format fields
     I              EQHMNB                          WGHMNB
     I              EQBNNB                          WGBNNB
     I              EQBONB                          WGBONB
     I              EQCVNB                          WGCVNB
     I              EQB0DT                          WGB0DT
     I              EQJ9ST                          WGJ9ST
     I              EQLLST                          WGLLST
     I              EQCXNB                          WGCXNB
     I              EQCWNB                          WGCWNB
     I              EQFCNB                          WGFCNB
     I              EQFDNB                          WGFDNB
     I              EQFENB                          WGFENB
     I              EQVLCR                          WGVLCR
     I              EQEXCR                          WGEXCR
     I              EQVARC                          WGVARC
     I              EQADCR                          WGADCR
     I              EQVLDL                          WGVLDL
     I              EQEXDL                          WGEXDL
     I              EQTRCR                          WGTRCR
     I              EQPDVC                          WGPDVC
     I              EQAVAD                          WGAVAD
     I              EQLVNB                          WGLVNB
     I              EQLZNB                          WGLZNB
     I              EQGZPC                          WGGZPC
     I              EQG0PC                          WGG0PC
     I              EQQGPR                          WGQGPR
     I              EQQHPR                          WGQHPR
     I              EQQIPR                          WGQIPR
     I              EQQJPR                          WGQJPR
     I              EQF7NB                          WGF7NB
     I              EQHDNB                          WGHDNB
     I              EQF2NB                          WGF2NB
     I              EQF3NB                          WGF3NB
     I              EQF4NB                          WGF4NB
     I              EQAWPC                          WGAWPC
     I              EQCBPR                          WGCBPR
     I              EQQFPR                          WGQFPR
     I              EQABCD                          WGABCD
     I              EQAECD                          WGAECD
     I              EQAACD                          WGAACD
     I              EQKAST                          WGKAST
      *
     IYARDCS      DS                            121
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Tattoo Header
      * I : RST BOH Company Number
     I                                    P   1   20P1HMNB
      * I : POS TH Kill Date
     I                                    P   3   60P1B0DT
      * I :  PD Producer Code
     I                                        7  12 P1ABCD
     IP2PARM      DS
      * I :  Date To   USR
     I                                    P   1   40P2B4DT
     IP3PARM      DS
      * FLD: *Arrays
      * I :  TH Payment Type
     I                                        1   1 P3J9ST
      * I :  Variance Type USR
     I                                        2   2 P3TVST
      * I :  Analysis Type USR
     I                                        3   4 P3T6ST
      * I :  Include Market USR
     I                                        5   5 P3TXST
      * I :  Include Subject USR
     I                                        6   6 P3TYST
      * I :  Include Resale USR
     I                                        7   7 P3TWST
      * I :  Report Type Sum/Dtl USR
     I                                        8   8 P3M1ST
      * I :  Payment Data Type USR
     I                                        9  10 P3T5ST
      * I :  TH Tattoo Number
     I                                    P  11  130P3CVNB
      * I :  Create OUTF EvlTrnVl USR
     I                                       14  14 P3UDST
     IP4PARM      DS
      * I :  Print Invalid Carcs USR
     I                                        1   1 P4T8ST
     IP5PARM      DS
      * I :  Create Outfile USR
     I                                        1   1 P5T9ST
     IP6PARM      DS
      * I :  Oms System Value Alpha
     I                                        1  40 P6EVTX
     IP7PARM      DS
      * N :  Difference +/-
     I                                    P   1   40P7IINB
     IP8PARM      DS
      * N :  Count USR
     I                                    P   1   20P8P0NB
     IP9PARM      DS
      * FLD: *Arrays
      * N :  Avg Hot Wgt           USR
     I                                    P   1   41P9QFNB
      * N :  Avg Backfat           USR
     I                                    P   5   61P9P8NB
      * N :  Avg Loin eye          USR
     I                                    P   7   81P9ENPC
      * N :  Avg Lean Percent      USR
     I                                    P   9  101P9EOPC
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HMNB    PARM           WP0001  30       BOH Company Num
     C           P1B0DT    PARM           WP0002  70       TH Kill Date
     C           P1ABCD    PARM           WP0003  6        PD Producer Cod
     C           P2B4DT    PARM           WP0004  70       Date To   USR
     C           P3J9ST    PARM           WP0005  1        TH Payment Type
     C           P3TVST    PARM           WP0006  1        Variance Type U
     C           P3T6ST    PARM           WP0007  2        Analysis Type U
     C           P3TXST    PARM           WP0008  1        Include Market
     C           P3TYST    PARM           WP0009  1        Include Subject
     C           P3TWST    PARM           WP0010  1        Include Resale
     C           P3M1ST    PARM           WP0011  1        Report Type Sum
     C           P3T5ST    PARM           WP0012  2        Payment Data Ty
     C           P3CVNB    PARM           WP0013  50       TH Tattoo Numbe
     C           P3UDST    PARM           WP0014  1        Create OUTF Evl
     C           P4T8ST    PARM           WP0015  1        Print Invalid C
     C           P5T9ST    PARM           WP0016  1        Create Outfile
     C           P6EVTX    PARM           WP0017 40        Oms System Valu
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prt Hot Scl Upl Summ  PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$WENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Prt Hot Scl Upl Summ  PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQKA01           BOH Company Num
      * Define keylist
     C           KPSA      KLIST
     C                     KFLD           WQKA01           BOH Company Num
     C                     KFLD           A1B0DT           TH Kill Date
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           BOH Company Num
      * Setup key
     C                     Z-ADDP1HMNB    WQKA01           BOH Company Num
     C                     Z-ADDP1B0DT    A1B0DT           TH Kill Date
      * Establish starting position
     C           KPSA      SETLL@A1CPCH                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        BOH Company Num
     C                     MOVEL'Y'       W0AL01  1        TH Kill Date
     C                     MOVEL'Y'       W0AL02  1        PD Producer Cod
     C                     MOVEL'Y'       W0AL03  1        BOH Buy Order N
     C                     MOVEL'Y'       W0AL04  1        BOL Load Number
     C                     MOVEL'Y'       W0AL05  1        TH Tattoo Numbe
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Load key header format
     C                     Z-ADD*ZERO     $BHMNB           BOH Company Num
     C                     MOVEL*BLANK    $BEUTX           Oms Name
     C                     Z-ADD*ZERO     $BB3DT           Date From USR
     C                     Z-ADD*ZERO     $BB4DT           Date To   USR
     C                     MOVEL*BLANK    $BM1ST           Report Type Sum
     C                     MOVEL*BLANK    $BOFTX           Text 25 2 USR
     C                     MOVEL*BLANK    $BTXST           Include Market
     C                     MOVEL*BLANK    $BI2TX           Condition Name
     C                     MOVEL*BLANK    $BTYST           Include Subject
     C                     MOVEL*BLANK    $BI3TX           Condition Name
     C                     MOVEL*BLANK    $BTWST           Include Resale
     C                     MOVEL*BLANK    $BI4TX           Condition Name
     C                     MOVEL*BLANK    $BABCD           PD Producer Cod
     C                     MOVEL*BLANK    $BA4TX           Producer Name
     C                     MOVEL*BLANK    $BJ9ST           TH Payment Type
     C                     MOVEL*BLANK    $BC4TX           Condition Name
     C                     MOVEL*BLANK    $BTVST           Variance Type U
     C                     MOVEL*BLANK    $BI1TX           Condition Name
     C                     Z-ADD*ZERO     $BCVNB           TH Tattoo Numbe
     C                     MOVEL*BLANK    $BT6ST           Analysis Type U
     C                     MOVEL*BLANK    $BO4TX           Text 25 3 USR
     C                     MOVEL*BLANK    $BT5ST           Payment Data Ty
     C                     MOVEL*BLANK    $BOETX           Text 25 1 USR
      * Load related totals format
     C                     Z-ADD*ZERO     $QHD5U           DOA Head Total
     C                     Z-ADD*ZERO     $QWWNB           Head Received 1
     C                     Z-ADD*ZERO     $QYDSM           Yard Dead SUM
     C                     Z-ADD*ZERO     $QGONB           HEad Condemned
     C                     Z-ADD*ZERO     $QWUNB           Head Killed 1 S
     C                     Z-ADD*ZERO     $QB4NB           Head Total SUM
     C                     Z-ADD*ZERO     $QXRNB           Head Total Sum2
     C                     Z-ADD*ZERO     $QHTS3           Head Total Sum3
     C                     Z-ADD*ZERO     $QH3SM           Head 3 SUM
     C                     Z-ADD*ZERO     $QHD4S           Head 4 SUM
     C                     Z-ADD*ZERO     $QHD5S           Head 5 SUM
     C                     MOVEL*BLANK    $QHDST           Display Field U
     C                     Z-ADD*ZERO     $QHTS4           Head Total Sum4
     C                     Z-ADD*ZERO     $QH1SM           Head 1 SUM
     C                     Z-ADD*ZERO     $QH2SM           Head 2 SUM
     C                     Z-ADD*ZERO     $QDXVA           Ded Amount 4 1
     C                     Z-ADD*ZERO     $QDYVA           Ded Amount 4 2
     C                     Z-ADD*ZERO     $QF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     $QX5NB           Live Weight SUM
     C                     Z-ADD*ZERO     $QWTNB           Hot Weight 1 SU
     C                     Z-ADD*ZERO     $QHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     $QC6VA           Lean % * Wgt SU
     C                     Z-ADD*ZERO     $QF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     $QBTVA           Loin eye * wgt
     C                     Z-ADD*ZERO     $QF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     $QBSVA           Backfat * Wgt
     C                     Z-ADD*ZERO     $QF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     $QAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     $QQBPR           Cost /Hd USR
     C                     Z-ADD*ZERO     $QDCVA           Gross Ttl 1 Sum
     C                     Z-ADD*ZERO     $QDQVA           Gross Total 12.
     C                     Z-ADD*ZERO     $QHCSM           Head Count SUM
     C                     Z-ADD*ZERO     $QQCPR           Cost /Hd Top US
     C                     Z-ADD*ZERO     $QDHVA           Gross Total 12.
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDA1HMNB    $CHMNB           BOH Company Num
     C                     MOVEL*BLANK    $CIXTX           Blank Usr 1 fld
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDA1HMNB    $PHMNB           BOH Company Num
     C                     Z-ADDA1B0DT    $PB0DT           TH Kill Date
     C                     Z-ADD*ZERO     $PHD5U           DOA Head Total
     C                     Z-ADD*ZERO     $PWWNB           Head Received 1
     C                     Z-ADD*ZERO     $PYDSM           Yard Dead SUM
     C                     Z-ADD*ZERO     $PGONB           HEad Condemned
     C                     Z-ADD*ZERO     $PWUNB           Head Killed 1 S
     C                     Z-ADD*ZERO     $PB4NB           Head Total SUM
     C                     Z-ADD*ZERO     $PXRNB           Head Total Sum2
     C                     Z-ADD*ZERO     $PHTS3           Head Total Sum3
     C                     Z-ADD*ZERO     $PH3SM           Head 3 SUM
     C                     Z-ADD*ZERO     $PHD4S           Head 4 SUM
     C                     Z-ADD*ZERO     $PHD5S           Head 5 SUM
     C                     MOVEL*BLANK    $PHDST           Display Field U
     C                     Z-ADD*ZERO     $PHTS4           Head Total Sum4
     C                     Z-ADD*ZERO     $PH1SM           Head 1 SUM
     C                     Z-ADD*ZERO     $PH2SM           Head 2 SUM
     C                     Z-ADD*ZERO     $PDXVA           Ded Amount 4 1
     C                     Z-ADD*ZERO     $PDYVA           Ded Amount 4 2
     C                     Z-ADDA1F7NB    $PF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     $PX5NB           Live Weight SUM
     C                     Z-ADD*ZERO     $PWTNB           Hot Weight 1 SU
     C                     Z-ADDA1HDNB    $PHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     $PC6VA           Lean % * Wgt SU
     C                     Z-ADDA1F4NB    $PF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     $PBTVA           Loin eye * wgt
     C                     Z-ADDA1F3NB    $PF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     $PBSVA           Backfat * Wgt
     C                     Z-ADDA1F2NB    $PF2NB           TH Avg Backfat
     C                     Z-ADDA1AWPC    $PAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     $PQBPR           Cost /Hd USR
     C                     Z-ADD*ZERO     $PDCVA           Gross Ttl 1 Sum
     C                     Z-ADD*ZERO     $PDQVA           Gross Total 12.
     C                     Z-ADD*ZERO     $PHCSM           Head Count SUM
     C                     Z-ADD*ZERO     $PQCPR           Cost /Hd Top US
     C                     Z-ADD*ZERO     $PDHVA           Gross Total 12.
     C                     MOVEL*BLANK    $PIXTX           Blank Usr 1 fld
     C                     MOVELA1ABCD    $PABCD           PD Producer Cod
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDA1HMNB    $OHMNB           BOH Company Num
     C                     MOVELA1ABCD    $OABCD           PD Producer Cod
     C                     Z-ADD*ZERO     $OHD5U           DOA Head Total
     C                     Z-ADD*ZERO     $OWWNB           Head Received 1
     C                     Z-ADD*ZERO     $OYDSM           Yard Dead SUM
     C                     Z-ADD*ZERO     $OGONB           HEad Condemned
     C                     Z-ADD*ZERO     $OWUNB           Head Killed 1 S
     C                     Z-ADD*ZERO     $OB4NB           Head Total SUM
     C                     Z-ADD*ZERO     $OXRNB           Head Total Sum2
     C                     Z-ADD*ZERO     $OHTS3           Head Total Sum3
     C                     Z-ADD*ZERO     $OH3SM           Head 3 SUM
     C                     Z-ADD*ZERO     $OHD4S           Head 4 SUM
     C                     Z-ADD*ZERO     $OHD5S           Head 5 SUM
     C                     Z-ADD*ZERO     $OHTS4           Head Total Sum4
     C                     Z-ADD*ZERO     $OH1SM           Head 1 SUM
     C                     Z-ADD*ZERO     $OH2SM           Head 2 SUM
     C                     Z-ADD*ZERO     $ODXVA           Ded Amount 4 1
     C                     Z-ADD*ZERO     $ODYVA           Ded Amount 4 2
     C                     Z-ADDA1F7NB    $OF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     $OX5NB           Live Weight SUM
     C                     Z-ADD*ZERO     $OWTNB           Hot Weight 1 SU
     C                     Z-ADDA1HDNB    $OHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     $OC6VA           Lean % * Wgt SU
     C                     Z-ADDA1F4NB    $OF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     $OBTVA           Loin eye * wgt
     C                     Z-ADDA1F3NB    $OF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     $OBSVA           Backfat * Wgt
     C                     Z-ADDA1F2NB    $OF2NB           TH Avg Backfat
     C                     Z-ADDA1AWPC    $OAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     $OQBPR           Cost /Hd USR
     C                     Z-ADD*ZERO     $ODCVA           Gross Ttl 1 Sum
     C                     Z-ADD*ZERO     $ODQVA           Gross Total 12.
     C                     Z-ADD*ZERO     $OHCSM           Head Count SUM
     C                     Z-ADD*ZERO     $OQCPR           Cost /Hd Top US
     C                     Z-ADD*ZERO     $ODHVA           Gross Total 12.
     C                     MOVEL*BLANK    $OIXTX           Blank Usr 1 fld
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP03  1
     C                     END
      *
     C           W0AL04    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDA1HMNB    $DHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    $DBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    $DBONB           BOL Load Number
     C                     Z-ADDA1B0DT    $DB0DT           TH Kill Date
     C                     MOVELA1ABCD    $DABCD           PD Producer Cod
      * Load related totals format
     C                     Z-ADDA1HMNB    $NHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    $NBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    $NBONB           BOL Load Number
     C                     Z-ADD*ZERO     $NHD5U           DOA Head Total
     C                     Z-ADD*ZERO     $NQENB           Head Received
     C                     Z-ADD*ZERO     $NYDSM           Yard Dead SUM
     C                     Z-ADD*ZERO     $NGONB           HEad Condemned
     C                     Z-ADD*ZERO     $NNINB           Head Killed SUM
     C                     Z-ADD*ZERO     $NB4NB           Head Total SUM
     C                     Z-ADD*ZERO     $NXRNB           Head Total Sum2
     C                     Z-ADD*ZERO     $NHTS3           Head Total Sum3
     C                     Z-ADD*ZERO     $NH3SM           Head 3 SUM
     C                     Z-ADD*ZERO     $NHD4S           Head 4 SUM
     C                     Z-ADD*ZERO     $NHD5S           Head 5 SUM
     C                     MOVEL*BLANK    $NHDST           Display Field U
     C                     Z-ADD*ZERO     $NHTS4           Head Total Sum4
     C                     Z-ADD*ZERO     $NH1SM           Head 1 SUM
     C                     Z-ADD*ZERO     $NH2SM           Head 2 SUM
     C                     Z-ADD*ZERO     $NDXVA           Ded Amount 4 1
     C                     Z-ADD*ZERO     $NDYVA           Ded Amount 4 2
     C                     Z-ADDA1F7NB    $NF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     $NX5NB           Live Weight SUM
     C                     Z-ADD*ZERO     $NWTNB           Hot Weight 1 SU
     C                     Z-ADDA1HDNB    $NHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     $NC6VA           Lean % * Wgt SU
     C                     Z-ADDA1F4NB    $NF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     $NBTVA           Loin eye * wgt
     C                     Z-ADDA1F3NB    $NF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     $NBSVA           Backfat * Wgt
     C                     Z-ADDA1F2NB    $NF2NB           TH Avg Backfat
     C                     Z-ADDA1AWPC    $NAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     $NQBPR           Cost /Hd USR
     C                     Z-ADD*ZERO     $NDCVA           Gross Ttl 1 Sum
     C                     Z-ADD*ZERO     $NDQVA           Gross Total 12.
     C                     Z-ADD*ZERO     $NHCSM           Head Count SUM
     C                     Z-ADD*ZERO     $NQCPR           Cost /Hd Top US
     C                     Z-ADD*ZERO     $NDHVA           Gross Total 12.
     C                     MOVEL*BLANK    $NIXTX           Blank Usr 1 fld
     C                     Z-ADDA1B0DT    $NB0DT           TH Kill Date
     C                     MOVELA1ABCD    $NABCD           PD Producer Cod
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP04  1
     C                     END
      *
     C           W0AL05    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP05  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDA1HMNB    $EHMNB           BOH Company Num
     C                     MOVELA1ABCD    $EABCD           PD Producer Cod
     C                     Z-ADDA1B0DT    $EB0DT           TH Kill Date
     C                     Z-ADDA1BNNB    $EBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    $EBONB           BOL Load Number
     C                     Z-ADDA1CVNB    $ECVNB           TH Tattoo Numbe
     C                     MOVELA1J9ST    $EJ9ST           TH Payment Type
     C                     MOVEL*BLANK    $EIYTX           Th Payment Type
     C                     MOVEL*BLANK    $EJPTX           Text 10 1 USR
     C                     Z-ADDA1AWDT    $EAWDT           TH Purchase Dat
     C                     MOVELA1BICD    $EBICD           TH Group Refere
     C                     MOVELA1CPST    $ECPST           TH Live Purchas
     C                     Z-ADDA1ACPR    $EACPR           TH Live Purchas
     C                     Z-ADDA1B9PR    $EB9PR           TH Live Gross A
     C                     Z-ADDA1CAPR    $ECAPR           TH LIve Net Amt
     C                     MOVELA1C4ST    $EC4ST           TH Resale UOM
     C                     Z-ADDA1AIPR    $EAIPR           TH Recalc Live
     C                     Z-ADDA1A6DT    $EA6DT           TH Pricing Date
     C                     MOVELA1C2ST    $EC2ST           TH Resale Sprea
     C                     Z-ADDA1CXNB    $ECXNB           TH Dead On Arri
     C                     Z-ADDA1CWNB    $ECWNB           TH Head Receive
     C                     Z-ADDA1FCNB    $EFCNB           TH Yard Deads
     C                     Z-ADDA1H9NB    $EH9NB           TH Held Over
     C                     Z-ADDA1FDNB    $EFDNB           TH Head Condemn
     C                     Z-ADDA1FENB    $EFENB           TH Head Killed
     C                     Z-ADD*ZERO     $ELFNB           TDE Head Condem
     C                     Z-ADD*ZERO     $ELINB           Head 2
     C                     Z-ADD*ZERO     $EIINB           Difference +/-
     C                     Z-ADD*ZERO     $EHD3C           Head 3
     C                     Z-ADD*ZERO     $EHD4C           Head 4
     C                     Z-ADD*ZERO     $EHD5C           Head 5
     C                     MOVEL*BLANK    $EHDST           Display Field U
     C                     Z-ADD*ZERO     $EMWNB           Trim Head 1 USR
     C                     Z-ADD*ZERO     $EH1US           Head 1 USR
     C                     Z-ADD*ZERO     $EH2US           Head 2 USR
     C                     Z-ADD*ZERO     $EETPR           Ded Amount 1 Us
     C                     Z-ADD*ZERO     $EEUPR           Ded Amount 2 Us
     C                     Z-ADDA1HENB    $EHENB           TH Head Adds
     C                     Z-ADDA1HFNB    $EHFNB           TH Head Accepte
     C                     Z-ADDA1CYNB    $ECYNB           TH Live Wgt
     C                     Z-ADDA1LRNB    $ELRNB           TH Adj Live Wgt
     C                     Z-ADDA1E0NB    $EE0NB           TH Hot Wgt
     C                     Z-ADDA1A5PC    $EA5PC           TH Tot Loin Eye
     C                     Z-ADDA1FBNB    $EFBNB           TH Tot Backfat
     C                     Z-ADDA1A4PC    $EA4PC           TH Tot Light Re
     C                     Z-ADDA1F7NB    $EF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     $EKGNB           Hot Weight Tot
     C                     Z-ADDA1HDNB    $EHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     $EJONB           Hot Wgt/Lean %
     C                     Z-ADDA1F5NB    $EF5NB           TH Avg Light Re
     C                     Z-ADDA1F4NB    $EF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     $EL1NB           Hot Wgt/Loine A
     C                     Z-ADDA1F3NB    $EF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     $EL0NB           Hot Wgt/Backf A
     C                     Z-ADDA1F2NB    $EF2NB           TH Avg Backfat
     C                     Z-ADDA1AVPC    $EAVPC           TH Std Yield Pe
     C                     Z-ADDA1AWPC    $EAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     $EQBPR           Cost /Hd USR
     C                     Z-ADDA1CBPR    $ECBPR           TH Payment Gros
     C                     Z-ADD*ZERO     $EK2PR           Gross Pay Amt 2
     C                     Z-ADD*ZERO     $EB5NB           Head Total USR
     C                     Z-ADD*ZERO     $EQCPR           Cost /Hd Top US
     C                     Z-ADD*ZERO     $ECUPR           Gross Pay Amt T
     C                     Z-ADDA1CWPC    $ECWPC           TH Adj Actual Y
     C                     Z-ADDA1A8PC    $EA8PC           TH Yield Differ
     C                     Z-ADDA1A7PC    $EA7PC           TH Recalc Live
     C                     Z-ADDA1B8PR    $EB8PR           TH CM Market Pr
     C                     Z-ADDA1AMPR    $EAMPR           TH CM Base Mkt
     C                     Z-ADDA1ANPR    $EANPR           TH CM Base Mkt
     C                     Z-ADDA1AYVA    $EAYVA           TH CM Sort Disc
     C                     Z-ADDA1AWVA    $EAWVA           TH CM Yield Gai
     C                     Z-ADDA1AOPR    $EAOPR           TH CM Base Carc
     C                     Z-ADDA1AXVA    $EAXVA           TH CM LN AddOn/
     C                     Z-ADDA1APPR    $EAPPR           TH CM Carcass G
     C                     Z-ADDA1ASPR    $EASPR           TH Deduction Am
     C                     Z-ADDA1A4VA    $EA4VA           TH Total Net WO
     C                     Z-ADDA1ATPR    $EATPR           TH Carcass Net
     C                     Z-ADDA1A5VA    $EA5VA           TH Additions Am
     C                     Z-ADDA1CCPR    $ECCPR           Th Payment Net
     C                     Z-ADDA1LPNB    $ELPNB           TH AP Voucher/D
     C                     Z-ADDA1CDPR    $ECDPR           TH Freight Amou
     C                     Z-ADDA1A7VA    $EA7VA           TH Accrual Amou
     C                     Z-ADDA1A2PR    $EA2PR           TH Fixed Cost A
     C                     MOVELA1JWST    $EJWST           TH Calc Net Sts
     C                     MOVELA1CWST    $ECWST           TH Payment Sts
     C                     MOVELA1D7ST    $ED7ST           TH Header Error
     C                     MOVELA1D8ST    $ED8ST           TH Detail Error
     C                     MOVELA1DWST    $EDWST           TH Kill Balanci
     C                     MOVELA1D6ST    $ED6ST           TH Bal to Kill
     C                     Z-ADDA1GHNB    $EGHNB           TH Commission A
     C                     Z-ADDA1BYDT    $EBYDT           TH Voucher Paym
     C                     MOVELA1E0ST    $EE0ST           TH User Error O
     C                     MOVELA1E1ST    $EE1ST           TH Held Over Re
     C                     MOVELA1E2ST    $EE2ST           TH Sex
     C                     Z-ADDA1BSDT    $EBSDT           TH Held/Ovr Com
     C                     Z-ADDA1BTDT    $EBTDT           TH Commission P
     C                     Z-ADDA1BUDT    $EBUDT           TH Actual Check
     C                     Z-ADDA1HGNB    $EHGNB           TH Shipped Weig
     C                     Z-ADDA1HHNB    $EHHNB           TH Avg Hot Wgt
     C                     Z-ADDA1HINB    $EHINB           TH FFLI
     C                     Z-ADDA1A3PR    $EA3PR           TH Kill Product
     C                     Z-ADDA1A4PR    $EA4PR           TH Cut Product
     C                     Z-ADDA1A6PR    $EA6PR           TH Render Produ
     C                     Z-ADDA1J9NB    $EJ9NB           TH Head Exclude
     C                     Z-ADDA1D6PR    $ED6PR           TH CM Bse Mkt L
     C                     Z-ADDA1D7PR    $ED7PR           TH CM Bse Mkt C
     C                     Z-ADDA1D8PR    $ED8PR           TH CM Srt Dsc L
     C                     Z-ADDA1D9PR    $ED9PR           TH CM Srt Dsc C
     C                     Z-ADDA1EAPR    $EEAPR           TH CM Yld G/L L
     C                     Z-ADDA1EBPR    $EEBPR           TH CM Yld G/L C
     C                     Z-ADDA1ECPR    $EECPR           TH CM Crc Val L
     C                     Z-ADDA1EDPR    $EEDPR           TH CM Crc Val C
     C                     Z-ADDA1EEPR    $EEEPR           TH CM Lean Prem
     C                     Z-ADDA1EFPR    $EEFPR           TH CM Lean Prem
     C                     Z-ADDA1EGPR    $EEGPR           TH CM Gross Liv
     C                     Z-ADDA1EHPR    $EEHPR           TH CM Gross Car
     C                     MOVELA1KAST    $EKAST           TH Source Type
     C                     MOVELA1J7ST    $EJ7ST           TH Scale Ticket
     C                     Z-ADDA1OXNB    $EOXNB           TH HPS Movement
     C                     MOVELA1LKST    $ELKST           TH Source Code
     C                     MOVELA1LLST    $ELLST           TH Hog Class Ty
     C                     MOVELA1J8ST    $EJ8ST           TH Posted to HP
     C                     MOVELA1LIST    $ELIST           TH Schedule Kil
     C                     MOVELA1LJST    $ELJST           TH Shift Held O
     C                     MOVELA1NZTX    $ENZTX           TH State
     C                     MOVELA1HJCD    $EHJCD           TH Unused Code
     C                     MOVELA1R4ST    $ER4ST           TH Unused Sts 2
     C                     MOVELA1R5ST    $ER5ST           TH Commission S
     C                     MOVELA1R6ST    $ER6ST           TH Paid 2 Week
     C                     MOVELA1R7ST    $ER7ST           TH Unused Sts 1
     C                     Z-ADDA1THWT    $ETHWT           TH DOA Weight
     C                     Z-ADDA1T2WT    $ET2WT           TH Avg Lean % E
     C                     Z-ADDA1THHD    $ETHHD           TH HPS Farm Sit
     C                     Z-ADDA1T2HD    $ET2HD           TH Shift Held O
     C                     Z-ADDA1OBPR    $EOBPR           TH Sorting Amou
     C                     Z-ADDA1KOER    $EKOER           TH Head Identif
     C                     Z-ADDA1OPIR    $EOPIR           TH Percent Iden
     C                     Z-ADDA1OPEM    $EOPEM           TH Percent Acce
     C                     Z-ADDA1IORP    $EIORP           TH Head Adjuste
     C                     Z-ADDA1OWEO    $EOWEO           TH PHA Head Add
     C                     MOVELA1OQET    $EOQET           TH PHA Add Type
     C                     MOVELA1URST    $EURST           TH PHA Average
     C                     MOVELA1USST    $EUSST           TH PHA Add Reas
     C                     Z-ADDA1HHPC    $EHHPC           TH PHA Yield Pe
     C                     Z-ADDA1S9PR    $ES9PR           TH PHA Lean Prm
     C                     Z-ADDA1TAPR    $ETAPR           TH VC Gross Val
     C                     Z-ADDA1TBPR    $ETBPR           TH Excluded Gro
     C                     Z-ADDA1JFUR    $EJFUR           TH Avg Lean %
     C                     Z-ADDA1KRIF    $EKRIF           TH Broken Back
     C                     Z-ADDA1KORF    $EKORF           TH Hot Scl Uplo
     C                     Z-ADDA1KAPR    $EKAPR           TH Unused Nbr 4
     C                     Z-ADDA1KROT    $EKROT           TH Excluded Car
     C                     Z-ADDA1OTJG    $EOTJG           TH Excluded Pre
     C                     Z-ADDA1IRJG    $EIRJG           TH Unused Nbr 7
     C                     Z-ADDA1IMJF    $EIMJF           TH Unused Nbr 8
     C                     Z-ADDA1IRGF    $EIRGF           TH Unused Nbr 9
     C                     Z-ADDA1KRJF    $EKRJF           TH Unused Nbr 1
     C                     Z-ADDA1OJRF    $EOJRF           TH Break Even P
     C                     Z-ADDA1KFOR    $EKFOR           TH Meat Value F
     C                     Z-ADDA1ORJK    $EORJK           TH Yld Parm Adj
     C                     Z-ADDA1OMVJ    $EOMVJ           TH PHA Sort Dis
     C                     Z-ADDA1MVNF    $EMVNF           TH Avg Loin Eye
     C                     Z-ADDA1MCNF    $EMCNF           TH Avg Backfat
     C                     Z-ADDA1NCNF    $ENCNF           TH HITCH Old Pa
     C                     Z-ADDA1NCHF    $ENCHF           TH MPR Sort Los
     C                     Z-ADDA1IGIR    $EIGIR           TH Unused Nbr 1
     C                     Z-ADDA1KFJR    $EKFJR           TH Unused Nbr 2
     C                     Z-ADDA1EADT    $EEADT           TH Cold Scl Upl
     C                     Z-ADDA1EBDT    $EEBDT           TH Cold Scl Upl
     C                     Z-ADDA1ECDT    $EECDT           TH Head LFT
     C                     Z-ADDA1EDDT    $EEDDT           TH Head EUT/KOA
     C                     Z-ADDA1EEDT    $EEEDT           TH Unused Date
     C                     MOVELA1U4ST    $EU4ST           TH Unused Sts 1
     C                     MOVELA1U5ST    $EU5ST           TH Unused Sts 2
     C                     MOVELA1U6ST    $EU6ST           TH Unused Sts 3
     C                     MOVELA1U7ST    $EU7ST           TH Unused Sts 4
     C                     MOVELA1U8ST    $EU8ST           TH Unused Sts 5
     C                     MOVELA1U9ST    $EU9ST           TH Unused Sts 6
     C                     MOVELA1VAST    $EVAST           TH Unused Sts 7
     C                     MOVELA1VBST    $EVBST           TH Unused Sts 8
     C                     MOVELA1AGCD    $EAGCD           GN Genetic Code
     C                     MOVELA1BECD    $EBECD           HC Class Code
     C                     MOVELA1BDCD    $EBDCD           DF Defect Code
     C                     MOVELA1CSCD    $ECSCD           THP Process Cod
     C                     MOVELA1AECD    $EAECD           PL Location Cod
     C                     MOVELA1ACCD    $EACCD           HB Buyer Code
     C                     MOVELA1AAVN    $EAAVN           RS User Changed
     C                     Z-ADDA1AADT    $EAADT           RS Date Changed
     C                     Z-ADDA1AMTM    $EAMTM           RS Time Changed
     C                     MOVELA1AJST    $EAJST           RS Record Statu
     C                     MOVELA1AHVN    $EAHVN           RS Job
     C                     MOVELA1AGVN    $EAGVN           RS Program
     C                     MOVELA1ABVN    $EABVN           RS User Added
     C                     Z-ADDA1ABDT    $EABDT           RS Date Added
     C                     Z-ADDA1ABTM    $EABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : Prt Eval Trans w/FOM  PO
     C                     EXSR UHSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : Prt Eval Trans wo/FOM PO
     C                     EXSR UMSUBR                     Embedded PRTOBJ
      * USER: Process after print of detail format
      * Only add if printing the detail.
      * CASE: LCL.*Record selected is *YES
     C           YL0005    IFEQ 'Y'                        *IF
      * Rtv Hot SclUPL ActPAY RT - Tattoo Header  * 
     C                     EXSR TNRVGN
      * CASE: PAR.Create Outfile USR is Yes
     C           P5T9ST    IFEQ 'Y'                        *IF
      * Upd Hot Scl Sum OUTF  RT - Hot Scale Upl Summ OUTF  * 
     C                     EXSR TORVGN
     C                     END                             *FI
     C                     ADD  1         P8P0NB           Count USR
     C                     ADD  $ECXNB    $NHD5U           DOA Head Total
     C                     ADD  $ECWNB    $NQENB           Head Received
     C                     ADD  $EFCNB    $NYDSM           Yard Dead SUM
     C                     ADD  $EFDNB    $NGONB           HEad Condemned
     C                     ADD  $EFENB    $NNINB           Head Killed SUM
     C                     ADD  $ELFNB    $NB4NB           Head Total SUM
     C                     ADD  $ELINB    $NXRNB           Head Total Sum2
     C                     ADD  $EIINB    $NHTS3           Head Total Sum3
     C                     ADD  $EHD3C    $NH3SM           Head 3 SUM
     C                     ADD  $EHD4C    $NHD4S           Head 4 SUM
     C                     ADD  $EHD5C    $NHD5S           Head 5 SUM
     C                     ADD  $EMWNB    $NHTS4           Head Total Sum4
     C                     ADD  $EETPR    $NDXVA           Ded Amount 4 1
     C                     ADD  $EEUPR    $NDYVA           Ded Amount 4 2
     C                     ADD  $EKGNB    $NWTNB           Hot Weight 1 SU
     C                     ADD  $ECYNB    $NX5NB           Live Weight SUM
     C                     ADD  $EJONB    $NC6VA           Lean % * Wgt SU
     C                     ADD  $EL1NB    $NBTVA           Loin eye * wgt
     C                     ADD  $EL0NB    $NBSVA           Backfat * Wgt
     C                     ADD  $ECBPR    $NDCVA           Gross Ttl 1 Sum
     C                     ADD  $EH1US    $NH1SM           Head 1 SUM
     C                     ADD  $EH2US    $NH2SM           Head 2 SUM
     C                     ADD  $ECUPR    $NDHVA           Gross Total 12.
     C                     ADD  $EB5NB    $NHCSM           Head Count SUM
     C                     ADD  $EK2PR    $NDQVA           Gross Total 12.
     C                     END                             *FI
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN A1HMNB    WZA001           BOH Company Num
     C                     Z-ADDA1HMNB    WZA001
     C           *LIKE     DEFN A1B0DT    WZA002           TH Kill Date
     C                     Z-ADDA1B0DT    WZA002
     C           *LIKE     DEFN A1ABCD    WZA003           PD Producer Cod
     C                     MOVELA1ABCD    WZA003
     C           *LIKE     DEFN A1BNNB    WZA004           BOH Buy Order N
     C                     Z-ADDA1BNNB    WZA004
     C           *LIKE     DEFN A1BONB    WZA005           BOL Load Number
     C                     Z-ADDA1BONB    WZA005
     C           *LIKE     DEFN A1CVNB    WZA006           TH Tattoo Numbe
     C                     Z-ADDA1CVNB    WZA006
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@A1CPCH                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * EOFSEL:  Kill Date
      * CASE: DB1.TH Kill Date GT PAR.Date To   USR
     C           A1B0DT    IFGT P2B4DT                     *IF
      * EOF File A            US - STR User Source Functions  * 
     C                     MOVEL'1'       W0EOFA           END OF FILE
     C                     END                             *FI
      * REQSEL:  Include Market
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Include Market USR is No
      *   |- c2    : DB1.TH Hog Class Type is Market
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3TXST    IFEQ 'N'                        *IF
     C           A1LLST    IFEQ 'M'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * REQSEL:  Include Subject
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Include Subject USR is No
      *   |- c2    : DB1.TH Hog Class Type is Subject
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3TYST    IFEQ 'N'                        *IF
     C           A1LLST    IFEQ 'S'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * REQSEL:  Include Resale
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Include Resale USR is No
      *   |- c2    : DB1.TH Hog Class Type is Resale
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3TWST    IFEQ 'N'                        *IF
     C           A1LLST    IFEQ 'R'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * OPTSEL:  Producer
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.PD Producer Code is Entered
      *   |- c2    : PAR.PD Producer Code NE DB1.PD Producer Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1ABCD    IFNE *BLANK                     *IF
     C           P1ABCD    IFNE A1ABCD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * OPTSEL:  Payment Type
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.TH Payment Type is Carcass/Live
      *   |- c2    : PAR.TH Payment Type NE DB1.TH Payment Type
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3J9ST    IFEQ 'C'                        *IF
     C           P3J9ST    OREQ 'L'
     C           P3J9ST    IFNE A1J9ST                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * OPTSEL:  Tattoo Number
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.TH Tattoo Number is NE Zero
      *   |- c2    : PAR.TH Tattoo Number NE DB1.TH Tattoo Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3CVNB    IFNE *ZERO                      *IF
     C           P3CVNB    IFNE A1CVNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * INTSEL:  Head Received
      * CASE: DB1.TH Head Received is *Zeros
     C           A1CWNB    IFEQ *ZERO                      *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0AL01  1        TH Kill Date
     C                     MOVEL*BLANK    W0AL02  1        PD Producer Cod
     C                     MOVEL*BLANK    W0AL03  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0AL04  1        BOL Load Number
     C                     MOVEL*BLANK    W0AL05  1        TH Tattoo Numbe
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        BOH Company Num
     C                     MOVEL'Y'       W0AL01  1        TH Kill Date
     C                     MOVEL'Y'       W0AL02  1        PD Producer Cod
     C                     MOVEL'Y'       W0AL03  1        BOH Buy Order N
     C                     MOVEL'Y'       W0AL04  1        BOL Load Number
     C                     MOVEL'Y'       W0AL05  1        TH Tattoo Numbe
     C                     ELSE
      * Next record - Detect level breaks
     C           A1HMNB    IFNE WZA001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           A1B0DT    IFNE WZA002                     TH Kill Date
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           A1ABCD    IFNE WZA003                     PD Producer Cod
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C           A1BNNB    IFNE WZA004                     BOH Buy Order N
     C           W0AL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL03
     C                     END
     C           A1BONB    IFNE WZA005                     BOL Load Number
     C           W0AL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL04
     C                     END
     C           A1CVNB    IFNE WZA006                     TH Tattoo Numbe
     C           W0AL04    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL05
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL05    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP05
     C                     END
      *
     C           W0AL04    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of BOL Load Number format
      * < 0.00>
      * CASE: CUR.Head Total Sum3 is GE ZERO
     C           $NHTS3    IFGE *ZERO                      *IF
     C                     MOVEL*BLANK    WUHDST           Display Field U
     C                     MOVEL'*NO'     WUHDST           Display Field U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'*YES'    WUHDST           Display Field U
     C                     END                             *FI
      * LCL.Head Killed Total Usr
      * CASE: PAR.Analysis Type USR is Eval Trans UPL Valid
     C           P3T6ST    IFEQ 'UV'                       *IF
     C                     Z-ADD$NB4NB    YL0030           Head Killed Tot
     C                     ELSE
      * CASE: PAR.Analysis Type USR is Eval Trans UPL Excep
     C           P3T6ST    IFEQ 'UE'                       *IF
     C                     Z-ADD$NXRNB    YL0030           Head Killed Tot
     C                     ELSE
      * CASE: PAR.Analysis Type USR is Eval Trans Adds
     C           P3T6ST    IFEQ 'EA'                       *IF
     C                     Z-ADD$NH3SM    YL0030           Head Killed Tot
     C                     ELSE
      * CASE: PAR.Analysis Type USR is Eval Trans Valid
     C           P3T6ST    IFEQ 'EV'                       *IF
     C                     Z-ADD$NHD4S    YL0030           Head Killed Tot
     C                     ELSE
      * CASE: PAR.Analysis Type USR is Eval Trans Excep
     C           P3T6ST    IFEQ 'EE'                       *IF
     C                     Z-ADD$NHD5S    YL0030           Head Killed Tot
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD$NNINB    YL0030           Head Killed Tot
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CUR.TH Avg Hot Wgt / Cost/Hd
      * CASE: LCL.Head Killed Total Usr is Greater then Zero
     C           YL0030    IFGT *ZERO                      *IF
     C           $NWTNB    DIV  YL0030    $NHDNB           TH Avg Hot Wgt
     C           $NDCVA    DIV  YL0030    $NQBPR           Cost /Hd USR
     C                     END                             *FI
      * CUR.Backfat, Loin Eye, Light Ref, Lean %
      * CASE: CUR.Hot Weight 1 SUM is Not zero
     C           $NWTNB    IFNE *ZERO                      *IF
     C           $NC6VA    DIV  $NWTNB    $NF4NB           TH Avg Lean Per
     C           $NBSVA    DIV  $NWTNB    $NF2NB           TH Avg Backfat
     C           $NBTVA    DIV  $NWTNB    $NF3NB           TH Avg Loin Eye
     C                     END                             *FI
      * CUR.Actual Yield
      * CASE: CUR.Live Weight SUM is Not zero
     C           $NX5NB    IFNE *ZERO                      *IF
      * CUR. TH Actual Yield
      * CUR.TH Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.Hot Weight 1 SUM
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : CUR.Live Weight SUM
      * *     : PGM.*Synon (17,7) work field
      * x3    : CON.100
     C           $NWTNB    DIV  $NX5NB    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    $NAWPC           TH Actual Yield
     C                     END                             *FI
      * TH Avg Live Wgt
      * CASE: CUR.Head Received  SUM is Not Zero
     C           $NQENB    IFNE *ZERO                      *IF
     C           $NX5NB    DIV  $NQENB    $NF7NB           TH Avg Live Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * Top Carc $/Hd
      * CASE: CUR.Head Killed SUM is Not Zero
     C           $NNINB    IFNE *ZERO                      *IF
     C           $NDHVA    DIV  $NNINB    $NQCPR           Cost /Hd Top US
     C                     END                             *FI
      * More then one Tattoo.
      * CASE: PAR.Count USR is Greater than 1
     C           P8P0NB    IFGT 1                          *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * Report Type = Summary
      * CASE: PAR.Report Type Sum/Dtl USR is Summary
     C           P3M1ST    IFEQ 'S'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 3
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
     C                     MOVEL'0'       *IN79
     C           WUHDST    IFEQ '*NO'                      *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$NKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP04
      * USER: Process after print of BOL Load Number format
     C                     ADD  $NHD5U    $OHD5U           DOA Head Total
     C                     ADD  $NQENB    $OWWNB           Head Received 1
     C                     ADD  $NYDSM    $OYDSM           Yard Dead SUM
     C                     ADD  $NGONB    $OGONB           HEad Condemned
     C                     ADD  $NNINB    $OWUNB           Head Killed 1 S
     C                     ADD  $NB4NB    $OB4NB           Head Total SUM
     C                     ADD  $NXRNB    $OXRNB           Head Total Sum2
     C                     ADD  $NHTS3    $OHTS3           Head Total Sum3
     C                     ADD  $NHTS4    $OHTS4           Head Total Sum4
     C                     ADD  $NDXVA    $ODXVA           Ded Amount 4 1
     C                     ADD  $NDYVA    $ODYVA           Ded Amount 4 2
     C                     ADD  $NH1SM    $OH1SM           Head 1 SUM
     C                     ADD  $NH2SM    $OH2SM           Head 2 SUM
     C                     ADD  $NH3SM    $OH3SM           Head 3 SUM
     C                     ADD  $NHD4S    $OHD4S           Head 4 SUM
     C                     ADD  $NHD5S    $OHD5S           Head 5 SUM
     C                     ADD  $NWTNB    $OWTNB           Hot Weight 1 SU
     C                     ADD  $NX5NB    $OX5NB           Live Weight SUM
     C                     ADD  $NC6VA    $OC6VA           Lean % * Wgt SU
     C                     ADD  $NBTVA    $OBTVA           Loin eye * wgt
     C                     ADD  $NBSVA    $OBSVA           Backfat * Wgt
     C                     ADD  $NHCSM    $OHCSM           Head Count SUM
     C                     ADD  $NDCVA    $ODCVA           Gross Ttl 1 Sum
     C                     ADD  $NDHVA    $ODHVA           Gross Total 12.
     C                     ADD  $NDQVA    $ODQVA           Gross Total 12.
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP03
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of PD Producer Code format
      * < 0.00>
      * CASE: CUR.Head Total Sum3 is GE ZERO
     C           $OHTS3    IFGE *ZERO                      *IF
     C                     MOVEL*BLANK    WUHDST           Display Field U
     C                     MOVEL'*NO'     WUHDST           Display Field U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'*YES'    WUHDST           Display Field U
     C                     END                             *FI
      * LCL.Head Killed Total Usr
      * CASE: PAR.Analysis Type USR is Eval Trans UPL Valid
     C           P3T6ST    IFEQ 'UV'                       *IF
     C                     Z-ADD$OB4NB    YL0030           Head Killed Tot
     C                     ELSE
      * CASE: PAR.Analysis Type USR is Eval Trans UPL Excep
     C           P3T6ST    IFEQ 'UE'                       *IF
     C                     Z-ADD$OXRNB    YL0030           Head Killed Tot
     C                     ELSE
      * CASE: PAR.Analysis Type USR is Eval Trans Adds
     C           P3T6ST    IFEQ 'EA'                       *IF
     C                     Z-ADD$OH3SM    YL0030           Head Killed Tot
     C                     ELSE
      * CASE: PAR.Analysis Type USR is Eval Trans Valid
     C           P3T6ST    IFEQ 'EV'                       *IF
     C                     Z-ADD$OHD4S    YL0030           Head Killed Tot
     C                     ELSE
      * CASE: PAR.Analysis Type USR is Eval Trans Excep
     C           P3T6ST    IFEQ 'EE'                       *IF
     C                     Z-ADD$OHD5S    YL0030           Head Killed Tot
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD$OWUNB    YL0030           Head Killed Tot
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CUR.TH Avg Hot Wgt & Cost/Hd
      * CASE: LCL.Head Killed Total Usr is Greater then Zero
     C           YL0030    IFGT *ZERO                      *IF
     C           $OWTNB    DIV  YL0030    $OHDNB           TH Avg Hot Wgt
     C           $ODCVA    DIV  YL0030    $OQBPR           Cost /Hd USR
     C                     END                             *FI
      * CUR.Backfat, Loin Eye, Light Ref, Lean %
      * CASE: CUR.Hot Weight 1 SUM is Not zero
     C           $OWTNB    IFNE *ZERO                      *IF
     C           $OC6VA    DIV  $OWTNB    $OF4NB           TH Avg Lean Per
     C           $OBSVA    DIV  $OWTNB    $OF2NB           TH Avg Backfat
     C           $OBTVA    DIV  $OWTNB    $OF3NB           TH Avg Loin Eye
     C                     END                             *FI
      * CUR.Actual Yield
      * CASE: CUR.Live Weight SUM is Not zero
     C           $OX5NB    IFNE *ZERO                      *IF
      * CUR. TH Actual Yield
      * CUR.TH Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.Hot Weight 1 SUM
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : CUR.Live Weight SUM
      * *     : PGM.*Synon (17,7) work field
      * x3    : CON.100
     C           $OWTNB    DIV  $OX5NB    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    $OAWPC           TH Actual Yield
     C                     END                             *FI
      * TH Avg Live Wgt
      * CASE: CUR.Head Received 1 SUM is Not 0
     C           $OWWNB    IFNE *ZERO                      *IF
     C           $OX5NB    DIV  $OWWNB    $OF7NB           TH Avg Live Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * Top Carc $/Hd
      * CASE: CUR.Head Killed 1 SUM is GT Zero
     C           $OWUNB    IFGT *ZERO                      *IF
     C           $ODHVA    DIV  $OWUNB    $OQCPR           Cost /Hd Top US
     C                     END                             *FI
      * CASE: PAR.PD Producer Code is Entered
     C           P1ABCD    IFNE *BLANK                     *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * CASE: PAR.Report Type Sum/Dtl USR is Summary
     C           P3M1ST    IFEQ 'S'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 5
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
     C                     MOVEL'0'       *IN79
     C           WUHDST    IFEQ '*NO'                      *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$OKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
      * USER: Process after print of PD Producer Code format
     C                     ADD  $OHD5U    $PHD5U           DOA Head Total
     C                     ADD  $OYDSM    $PYDSM           Yard Dead SUM
     C                     ADD  $OWWNB    $PWWNB           Head Received 1
     C                     ADD  $OGONB    $PGONB           HEad Condemned
     C                     ADD  $OWUNB    $PWUNB           Head Killed 1 S
     C                     ADD  $OB4NB    $PB4NB           Head Total SUM
     C                     ADD  $OXRNB    $PXRNB           Head Total Sum2
     C                     ADD  $OHTS3    $PHTS3           Head Total Sum3
     C                     ADD  $OHTS4    $PHTS4           Head Total Sum4
     C                     ADD  $OH1SM    $PH1SM           Head 1 SUM
     C                     ADD  $OH2SM    $PH2SM           Head 2 SUM
     C                     ADD  $ODXVA    $PDXVA           Ded Amount 4 1
     C                     ADD  $ODYVA    $PDYVA           Ded Amount 4 2
     C                     ADD  $OH3SM    $PH3SM           Head 3 SUM
     C                     ADD  $OHD4S    $PHD4S           Head 4 SUM
     C                     ADD  $OHD5S    $PHD5S           Head 5 SUM
     C                     ADD  $OWTNB    $PWTNB           Hot Weight 1 SU
     C                     ADD  $OX5NB    $PX5NB           Live Weight SUM
     C                     ADD  $OC6VA    $PC6VA           Lean % * Wgt SU
     C                     ADD  $OBTVA    $PBTVA           Loin eye * wgt
     C                     ADD  $OBSVA    $PBSVA           Backfat * Wgt
     C                     ADD  $OHCSM    $PHCSM           Head Count SUM
     C                     ADD  $ODHVA    $PDHVA           Gross Total 12.
     C                     ADD  $ODCVA    $PDCVA           Gross Ttl 1 Sum
     C                     ADD  $ODQVA    $PDQVA           Gross Total 12.
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of TH Kill Date format
      * < 0.00>
      * CASE: CUR.Head Total Sum3 is GE ZERO
     C           $PHTS3    IFGE *ZERO                      *IF
     C                     MOVEL*BLANK    WUHDST           Display Field U
     C                     MOVEL'*NO'     WUHDST           Display Field U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'*YES'    WUHDST           Display Field U
     C                     END                             *FI
      * LCL.Head Killed Total Usr
      * CASE: PAR.Analysis Type USR is Eval Trans UPL Valid
     C           P3T6ST    IFEQ 'UV'                       *IF
     C                     Z-ADD$PB4NB    YL0030           Head Killed Tot
     C                     ELSE
      * CASE: PAR.Analysis Type USR is Eval Trans UPL Excep
     C           P3T6ST    IFEQ 'UE'                       *IF
     C                     Z-ADD$PXRNB    YL0030           Head Killed Tot
     C                     ELSE
      * CASE: PAR.Analysis Type USR is Eval Trans Adds
     C           P3T6ST    IFEQ 'EA'                       *IF
     C                     Z-ADD$PH3SM    YL0030           Head Killed Tot
     C                     ELSE
      * CASE: PAR.Analysis Type USR is Eval Trans Valid
     C           P3T6ST    IFEQ 'EV'                       *IF
     C                     Z-ADD$PHD4S    YL0030           Head Killed Tot
     C                     ELSE
      * CASE: PAR.Analysis Type USR is Eval Trans Excep
     C           P3T6ST    IFEQ 'EE'                       *IF
     C                     Z-ADD$PHD5S    YL0030           Head Killed Tot
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD$PWUNB    YL0030           Head Killed Tot
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CUR.TH Avg Hot Wgt & Cost/Hd
      * CASE: LCL.Head Killed Total Usr is Greater then Zero
     C           YL0030    IFGT *ZERO                      *IF
     C           $PWTNB    DIV  YL0030    $PHDNB           TH Avg Hot Wgt
     C           $PDCVA    DIV  YL0030    $PQBPR           Cost /Hd USR
     C                     END                             *FI
      * CUR.Backfat, Loin Eye, Light Ref, Lean %
      * CASE: CUR.Hot Weight 1 SUM is Not zero
     C           $PWTNB    IFNE *ZERO                      *IF
     C           $PC6VA    DIV  $PWTNB    $PF4NB           TH Avg Lean Per
     C           $PBSVA    DIV  $PWTNB    $PF2NB           TH Avg Backfat
     C           $PBTVA    DIV  $PWTNB    $PF3NB           TH Avg Loin Eye
     C                     END                             *FI
      * CUR.Actual Yield
      * CASE: CUR.Live Weight SUM is Not zero
     C           $PX5NB    IFNE *ZERO                      *IF
      * CUR. TH Actual Yield
      * CUR.TH Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.Hot Weight 1 SUM
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : CUR.Live Weight SUM
      * *     : PGM.*Synon (17,7) work field
      * x3    : CON.100
     C           $PWTNB    DIV  $PX5NB    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    $PAWPC           TH Actual Yield
     C                     END                             *FI
      * TH Avg Live Wgt
      * CASE: CUR.Head Received 1 SUM is Not 0
     C           $PWWNB    IFNE *ZERO                      *IF
     C           $PX5NB    DIV  $PWWNB    $PF7NB           TH Avg Live Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * Top Carc $/Hd
      * CASE: CUR.Head Killed 1 SUM is GT Zero
     C           $PWUNB    IFGT *ZERO                      *IF
     C           $PDHVA    DIV  $PWUNB    $PQCPR           Cost /Hd Top US
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 5
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  $PB0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VPB0DT
     C                     MOVEL'0'       *IN79
     C           P3M1ST    IFEQ 'S'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WUHDST    IFEQ '*NO'                      *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      * Print format
     C                     WRITE$PKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
      * USER: Process after print of TH Kill Date format
     C                     ADD  $PHD5U    $QHD5U           DOA Head Total
     C                     ADD  $PYDSM    $QYDSM           Yard Dead SUM
     C                     ADD  $PGONB    $QGONB           HEad Condemned
     C                     ADD  $PB4NB    $QB4NB           Head Total SUM
     C                     ADD  $PXRNB    $QXRNB           Head Total Sum2
     C                     ADD  $PHTS3    $QHTS3           Head Total Sum3
     C                     ADD  $PHTS4    $QHTS4           Head Total Sum4
     C                     ADD  $PWWNB    $QWWNB           Head Received 1
     C                     ADD  $PWUNB    $QWUNB           Head Killed 1 S
     C                     ADD  $PDXVA    $QDXVA           Ded Amount 4 1
     C                     ADD  $PDYVA    $QDYVA           Ded Amount 4 2
     C                     ADD  $PH1SM    $QH1SM           Head 1 SUM
     C                     ADD  $PH2SM    $QH2SM           Head 2 SUM
     C                     ADD  $PH3SM    $QH3SM           Head 3 SUM
     C                     ADD  $PHD4S    $QHD4S           Head 4 SUM
     C                     ADD  $PHD5S    $QHD5S           Head 5 SUM
     C                     ADD  $PWTNB    $QWTNB           Hot Weight 1 SU
     C                     ADD  $PX5NB    $QX5NB           Live Weight SUM
     C                     ADD  $PC6VA    $QC6VA           Lean % * Wgt SU
     C                     ADD  $PBTVA    $QBTVA           Loin eye * wgt
     C                     ADD  $PBSVA    $QBSVA           Backfat * Wgt
     C                     ADD  $PHCSM    $QHCSM           Head Count SUM
     C                     ADD  $PDHVA    $QDHVA           Gross Total 12.
     C                     ADD  $PDCVA    $QDCVA           Gross Ttl 1 Sum
     C                     ADD  $PDQVA    $QDQVA           Gross Total 12.
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of final totals format
      * < 0.00>
      * CASE: CUR.Head Total Sum3 is GE ZERO
     C           $QHTS3    IFGE *ZERO                      *IF
     C                     MOVEL*BLANK    WUHDST           Display Field U
     C                     MOVEL'*NO'     WUHDST           Display Field U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'*YES'    WUHDST           Display Field U
     C                     END                             *FI
      * LCL.Head Killed Total Usr
      * CASE: PAR.Analysis Type USR is Eval Trans UPL Valid
     C           P3T6ST    IFEQ 'UV'                       *IF
     C                     Z-ADD$QB4NB    YL0030           Head Killed Tot
     C                     ELSE
      * CASE: PAR.Analysis Type USR is Eval Trans UPL Excep
     C           P3T6ST    IFEQ 'UE'                       *IF
     C                     Z-ADD$QXRNB    YL0030           Head Killed Tot
     C                     ELSE
      * CASE: PAR.Analysis Type USR is Eval Trans Adds
     C           P3T6ST    IFEQ 'EA'                       *IF
     C                     Z-ADD$QH3SM    YL0030           Head Killed Tot
     C                     ELSE
      * CASE: PAR.Analysis Type USR is Eval Trans Valid
     C           P3T6ST    IFEQ 'EV'                       *IF
     C                     Z-ADD$QHD4S    YL0030           Head Killed Tot
     C                     ELSE
      * CASE: PAR.Analysis Type USR is Eval Trans Excep
     C           P3T6ST    IFEQ 'EE'                       *IF
     C                     Z-ADD$QHD5S    YL0030           Head Killed Tot
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD$QWUNB    YL0030           Head Killed Tot
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CUR.TH Avg Hot Wgt & Cost/Hd
      * CASE: LCL.Head Killed Total Usr is Greater then Zero
     C           YL0030    IFGT *ZERO                      *IF
     C           $QWTNB    DIV  YL0030    $QHDNB           TH Avg Hot Wgt
     C           $QDCVA    DIV  YL0030    $QQBPR           Cost /Hd USR
     C                     END                             *FI
      * CUR.Backfat, Loin Eye, Light Ref, Lean %
      * CASE: CUR.Hot Weight 1 SUM is Not zero
     C           $QWTNB    IFNE *ZERO                      *IF
     C           $QC6VA    DIV  $QWTNB    $QF4NB           TH Avg Lean Per
     C           $QBSVA    DIV  $QWTNB    $QF2NB           TH Avg Backfat
     C           $QBTVA    DIV  $QWTNB    $QF3NB           TH Avg Loin Eye
     C                     END                             *FI
      * CUR.Actual Yield
      * CASE: CUR.Live Weight SUM is Not zero
     C           $QX5NB    IFNE *ZERO                      *IF
      * CUR. TH Actual Yield
      * CUR.TH Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.Hot Weight 1 SUM
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : CUR.Live Weight SUM
      * *     : PGM.*Synon (17,7) work field
      * x3    : CON.100
     C           $QWTNB    DIV  $QX5NB    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    $QAWPC           TH Actual Yield
     C                     END                             *FI
      * TH Avg Live Wgt
      * CASE: CUR.Head Received 1 SUM is Not 0
     C           $QWWNB    IFNE *ZERO                      *IF
     C           $QX5NB    DIV  $QWWNB    $QF7NB           TH Avg Live Wgt
     C                     END                             *FI
      * Top Carc $/Hd
      * CASE: CUR.Head Killed 1 SUM is GT Zero
     C           $QWUNB    IFGT *ZERO                      *IF
     C           $QDHVA    DIV  $QWUNB    $QQCPR           Cost /Hd Top US
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
     C                     MOVEL'0'       *IN79
     C           WUHDST    IFEQ '*NO'                      *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$QFINTTL
     C                     END
      * PRTOBJ calls after print of final totals format
      * Embedded PRTOBJ : Prt Eval Trans Inv    PO
     C                     EXSR URSUBR                     Embedded PRTOBJ
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * Prt Eval Trans w/FOM  PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN BVHMNB    WQKB01           BOH Company Num
     C           *LIKE     DEFN BVBNNB    WQKB02           BOH Buy Order N
     C           *LIKE     DEFN BVBONB    WQKB03           BOL Load Number
     C           *LIKE     DEFN BVCVNB    WQKB04           TH Tattoo Numbe
     C           *LIKE     DEFN BVB0DT    WQKB05           TH Kill Date
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           BOH Company Num
     C                     KFLD           WQKB02           BOH Buy Order N
     C                     KFLD           WQKB03           BOL Load Number
     C                     KFLD           WQKB04           TH Tattoo Numbe
     C                     KFLD           WQKB05           TH Kill Date
      * Setup key
     C                     Z-ADD$EHMNB    WQKB01           BOH Company Num
     C                     Z-ADD$EBNNB    WQKB02           BOH Buy Order N
     C                     Z-ADD$EBONB    WQKB03           BOL Load Number
     C                     Z-ADD$ECVNB    WQKB04           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    WQKB05           TH Kill Date
      * Establish starting position
     C           KRSB      SETLL@BVCPQ9                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        BOH Company Num
     C                     MOVEL'Y'       W0BL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0BL02  1        BOL Load Number
     C                     MOVEL'Y'       W0BL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0BL04  1        TH Kill Date
     C                     MOVEL'Y'       W0BL05  1        ET Scale Sequen
     C                     MOVEL'Y'       W0BL06  1        ET Carcass Numb
     C                     MOVEL'Y'       W0BL07  1        ET Carcass Numb
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $IQFNB           Avg Hot Wgt
     C                     Z-ADD*ZERO     $IWTNB           Hot Weight 1 SU
     C                     Z-ADD*ZERO     $IBSVA           Backfat * Wgt
     C                     Z-ADD*ZERO     $IP8NB           Avg Backfat
     C                     Z-ADD*ZERO     $IBTVA           Loin eye * wgt
     C                     Z-ADD*ZERO     $IENPC           Avg Loin eye
     C                     Z-ADD*ZERO     $IC6VA           Lean % * Wgt SU
     C                     Z-ADD*ZERO     $IEOPC           Avg Lean Percen
     C                     Z-ADD*ZERO     $ICRCT           Carcass Count C
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDBVHMNB    $FHMNB           BOH Company Num
     C                     Z-ADDBVBNNB    $FBNNB           BOH Buy Order N
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDBVHMNB    $GHMNB           BOH Company Num
     C                     Z-ADDBVBNNB    $GBNNB           BOH Buy Order N
     C                     Z-ADDBVBONB    $GBONB           BOL Load Number
     C                     Z-ADDBVCVNB    $GCVNB           TH Tattoo Numbe
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP03  1
     C                     END
      *
     C           W0BL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP04  1
     C                     END
      *
     C           W0BL05    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP05  1
     C                     END
      *
     C           W0BL06    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP06  1
     C                     END
      *
     C           W0BL07    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP07  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDBVHSNB    $HHSNB           ET Company Numb
     C                     Z-ADDBVA9DT    $HA9DT           ET Kill Date
     C                     Z-ADDBVFJNB    $HFJNB           ET Scale Sequen
     C                     Z-ADDBVHCNB    $HHCNB           ET Carcass Numb
     C                     Z-ADDBVGDNB    $HGDNB           ET Carcass Numb
     C                     Z-ADDBVFINB    $HFINB           ET Tattoo Numbe
     C                     Z-ADDBVLKNB    $HLKNB           ET Lot
     C                     MOVELBVEAST    $HEAST           ET Shift
     C                     Z-ADDBVAMPC    $HAMPC           ET Hot Wgt
     C                     MOVELBVDIST    $HDIST           ET Trim Area
     C                     Z-ADDBVX8NB    $HX8NB           ET Backfat Thic
     C                     Z-ADDBVFVPC    $HFVPC           ET Loineye Dept
     C                     Z-ADDBVAIPC    $HAIPC           ET Backfat Thic
     C                     Z-ADD*ZERO     $HNONB           Backfat * Wgt U
     C                     Z-ADDBVAJPC    $HAJPC           ET Loin-Eye Dep
     C                     Z-ADD*ZERO     $HNPNB           Loin-Eye * Wgt
     C                     Z-ADDBVAKPC    $HAKPC           ET Lean Percent
     C                     Z-ADD*ZERO     $HNNNB           Lean % * Wgt US
     C                     Z-ADDBVFWPC    $HFWPC           ET Light Reflec
     C                     Z-ADDBVFXPC    $HFXPC           ET Lean Percent
     C                     Z-ADDBVALPC    $HALPC           ET Light Reflec
     C                     MOVELBVFYST    $HFYST           ET Carcass Sex
     C                     MOVELBVD2ST    $HD2ST           ET Error Sts
     C                     MOVELBVEHST    $HEHST           ET Record Add/D
     C                     MOVELBVG1ST    $HG1ST           ET Record Creat
     C                     MOVELBVH4ST    $HH4ST           ET Record Creat
     C                     MOVELBVJLST    $HJLST           ET User Error O
     C                     MOVELBVUUST    $HUUST           ET Adjust/Add T
     C                     MOVELBVVHST    $HVHST           ET Broken Back
     C                     MOVELBVVIST    $HVIST           ET Unused Sts 2
     C                     MOVELBVVJST    $HVJST           ET Adjust/Add S
     C                     MOVELBVVKST    $HVKST           ET Unused Sts 4
     C                     MOVELBVVLST    $HVLST           ET Unused Sts 5
     C                     Z-ADDBVHMNB    $HHMNB           BOH Company Num
     C                     Z-ADDBVBNNB    $HBNNB           BOH Buy Order N
     C                     Z-ADDBVBONB    $HBONB           BOL Load Number
     C                     Z-ADDBVCVNB    $HCVNB           TH Tattoo Numbe
     C                     Z-ADDBVB0DT    $HB0DT           TH Kill Date
     C                     MOVELBVAAVN    $HAAVN           RS User Changed
     C                     Z-ADDBVAADT    $HAADT           RS Date Changed
     C                     Z-ADDBVAMTM    $HAMTM           RS Time Changed
     C                     MOVELBVAJST    $HAJST           RS Record Statu
     C                     Z-ADD*ZERO     $HAYPR           CD Gross Value
     C                     MOVEL*BLANK    $HOETX           Text 25 1 USR
     C                     MOVELBVAHVN    $HAHVN           RS Job
     C                     MOVELBVAGVN    $HAGVN           RS Program
     C                     MOVELBVABVN    $HABVN           RS User Added
     C                     Z-ADDBVABDT    $HABDT           RS Date Added
     C                     Z-ADDBVABTM    $HABTM           RS Time Added
     C                     Z-ADDBVB8DT    $HB8DT           RU Date
     C                     Z-ADDBVAOTM    $HAOTM           RU Time
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
      * CASE: PAR.Create OUTF EvlTrnVl USR is Yes
     C           P3UDST    IFEQ 'Y'                        *IF
      * ETV NonExcep/Excep
      * CASE: PAR.Exception Status USR is Yes
     C           WN0347    IFEQ 'Y'                        *IF
     C                     MOVEL'E'       YL0013           ETV NonExcep/Ex
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0013           ETV NonExcep/Ex
     C                     END                             *FI
      * ETV Accepted/Deleted
      * CASE: CUR.RS Record Status is Active
     C           $HAJST    IFEQ 'A'                        *IF
     C                     MOVEL'A'       YL0014           ETV Accepted/De
     C                     ELSE
      * CASE: CUR.RS Record Status is Flag for Purge
     C           $HAJST    IFEQ 'D'                        *IF
     C                     MOVEL'D'       YL0014           ETV Accepted/De
     C                     END                             *FI
     C                     END                             *FI
      * Crt Eval Tran Val Dtl CR - Eval Tran Value Dtl OUTF  * 
     C                     EXSR TACRRC
     C                     END                             *FI
     C                     ADD  $HNONB    $IBSVA           Backfat * Wgt
     C                     ADD  $HNPNB    $IBTVA           Loin eye * wgt
     C                     ADD  $HNNNB    $IC6VA           Lean % * Wgt SU
     C                     ADD  1         $ICRCT           Carcass Count C
     C                     ADD  $HAMPC    $IWTNB           Hot Weight 1 SU
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN BVHMNB    WZB001           BOH Company Num
     C                     Z-ADDBVHMNB    WZB001
     C           *LIKE     DEFN BVBNNB    WZB002           BOH Buy Order N
     C                     Z-ADDBVBNNB    WZB002
     C           *LIKE     DEFN BVBONB    WZB003           BOL Load Number
     C                     Z-ADDBVBONB    WZB003
     C           *LIKE     DEFN BVCVNB    WZB004           TH Tattoo Numbe
     C                     Z-ADDBVCVNB    WZB004
     C           *LIKE     DEFN BVB0DT    WZB005           TH Kill Date
     C                     Z-ADDBVB0DT    WZB005
     C           *LIKE     DEFN BVFJNB    WZB006           ET Scale Sequen
     C                     Z-ADDBVFJNB    WZB006
     C           *LIKE     DEFN BVHCNB    WZB007           ET Carcass Numb
     C                     Z-ADDBVHCNB    WZB007
     C           *LIKE     DEFN BVGDNB    WZB008           ET Carcass Numb
     C                     Z-ADDBVGDNB    WZB008
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@BVCPQ9                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : DB1.ET Hot Wgt is EQ Zero
      *   |- c2    : DB1.ET Backfat Thickness MM is Zero
      *   |- c3    : DB1.ET Loineye Depth MM is zero
      *   '-
     C           BVAMPC    IFEQ *ZERO                      *IF
     C           BVX8NB    OREQ *ZERO                      *OR
     C           BVFVPC    OREQ *ZERO                      *OR
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * CASE: DB1.ET Record Created W/Avg is Created With Average Rtn
     C           BVG1ST    IFEQ 'C'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * CASE: DB1.ET Record Add/Del Sts is Add
     C           BVEHST    IFEQ 'A'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0BL01  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0BL02  1        BOL Load Number
     C                     MOVEL*BLANK    W0BL03  1        TH Tattoo Numbe
     C                     MOVEL*BLANK    W0BL04  1        TH Kill Date
     C                     MOVEL*BLANK    W0BL05  1        ET Scale Sequen
     C                     MOVEL*BLANK    W0BL06  1        ET Carcass Numb
     C                     MOVEL*BLANK    W0BL07  1        ET Carcass Numb
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        BOH Company Num
     C                     MOVEL'Y'       W0BL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0BL02  1        BOL Load Number
     C                     MOVEL'Y'       W0BL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0BL04  1        TH Kill Date
     C                     MOVEL'Y'       W0BL05  1        ET Scale Sequen
     C                     MOVEL'Y'       W0BL06  1        ET Carcass Numb
     C                     MOVEL'Y'       W0BL07  1        ET Carcass Numb
     C                     ELSE
      * Next record - Detect level breaks
     C           BVHMNB    IFNE WZB001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           BVBNNB    IFNE WZB002                     BOH Buy Order N
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           BVBONB    IFNE WZB003                     BOL Load Number
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C           BVCVNB    IFNE WZB004                     TH Tattoo Numbe
     C           W0BL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL03
     C                     END
     C           BVB0DT    IFNE WZB005                     TH Kill Date
     C           W0BL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL04
     C                     END
     C           BVFJNB    IFNE WZB006                     ET Scale Sequen
     C           W0BL04    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL05
     C                     END
     C           BVHCNB    IFNE WZB007                     ET Carcass Numb
     C           W0BL05    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL06
     C                     END
     C           BVGDNB    IFNE WZB008                     ET Carcass Numb
     C           W0BL06    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL07
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL07    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP07
     C                     END
      *
     C           W0BL06    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP06
     C                     END
      *
     C           W0BL05    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP05
     C                     END
      *
     C           W0BL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP04
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP03
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of final totals format
      * CASE: CUR.Carcass Count CNT NE WRK.Zero USR
     C           $ICRCT    IFNE WUE9NB                     *IF
     C           $IWTNB    DIV  $ICRCT    $IQFNB           Avg Hot Wgt
     C                     END                             *FI
      * CASE: CUR.Hot Weight 1 SUM is Not zero
     C           $IWTNB    IFNE *ZERO                      *IF
     C           $IBSVA    DIV  $IWTNB    $IP8NB           Avg Backfat
     C           $IBTVA    DIV  $IWTNB    $IENPC           Avg Loin eye
     C           $IC6VA    DIV  $IWTNB    $IEOPC           Avg Lean Percen
     C                     END                             *FI
      * PAR = CUR By name
     C                     Z-ADD$IQFNB    P9QFNB           Avg Hot Wgt
     C                     Z-ADD$IP8NB    P9P8NB           Avg Backfat
     C                     Z-ADD$IENPC    P9ENPC           Avg Loin eye
     C                     Z-ADD$IEOPC    P9EOPC           Avg Lean Percen
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 3
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$IFINTTL
     C                     END
      * USER: Process after print of final totals format
      * Crt Eval Tran Val Hdr CR - Eval Tran Value Hdr OUTF  * 
     C                     EXSR TBCRRC
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         C0MAIN    BEGSR
      *================================================================
      * Prt Eval Trans wo/FOM PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN BVHMNB    WQKC01           BOH Company Num
     C           *LIKE     DEFN BVBNNB    WQKC02           BOH Buy Order N
     C           *LIKE     DEFN BVBONB    WQKC03           BOL Load Number
     C           *LIKE     DEFN BVCVNB    WQKC04           TH Tattoo Numbe
     C           *LIKE     DEFN BVB0DT    WQKC05           TH Kill Date
      * Define keylist
     C           KRSC      KLIST
     C                     KFLD           WQKC01           BOH Company Num
     C                     KFLD           WQKC02           BOH Buy Order N
     C                     KFLD           WQKC03           BOL Load Number
     C                     KFLD           WQKC04           TH Tattoo Numbe
     C                     KFLD           WQKC05           TH Kill Date
      * Setup key
     C                     Z-ADD$EHMNB    WQKC01           BOH Company Num
     C                     Z-ADD$EBNNB    WQKC02           BOH Buy Order N
     C                     Z-ADD$EBONB    WQKC03           BOL Load Number
     C                     Z-ADD$ECVNB    WQKC04           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    WQKC05           TH Kill Date
      * Establish starting position
     C           KRSC      SETLL@BVCPQ9                    *
      * Read first record with user selection
     C                     EXSR C3READ
     C           W0EOFC    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0CL1P  1        First page
     C                     MOVEL'Y'       W0CL00  1        BOH Company Num
     C                     MOVEL'Y'       W0CL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0CL02  1        BOL Load Number
     C                     MOVEL'Y'       W0CL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0CL04  1        TH Kill Date
     C                     MOVEL'Y'       W0CL05  1        ET Scale Sequen
     C                     MOVEL'Y'       W0CL06  1        ET Carcass Numb
     C                     MOVEL'Y'       W0CL07  1        ET Carcass Numb
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      * Print report body
     C           W0EOFC    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR C1PHDR
      * Print report detail line
     C                     EXSR C2PDTL
      * Read next record with user selection
     C                     EXSR C3READ
      * Print totals
     C                     EXSR C4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         C0EXIT    ENDSR
      /EJECT
     CSR         C1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0CL1P    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $MQFNB           Avg Hot Wgt
     C                     Z-ADD*ZERO     $MBSVA           Backfat * Wgt
     C                     Z-ADD*ZERO     $MP8NB           Avg Backfat
     C                     Z-ADD*ZERO     $MBTVA           Loin eye * wgt
     C                     Z-ADD*ZERO     $MENPC           Avg Loin eye
     C                     Z-ADD*ZERO     $MC6VA           Lean % * Wgt SU
     C                     Z-ADD*ZERO     $MEOPC           Avg Lean Percen
     C                     Z-ADD*ZERO     $MCRCT           Carcass Count C
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP1P  1
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP00  1
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDBVHMNB    $JHMNB           BOH Company Num
     C                     Z-ADDBVBNNB    $JBNNB           BOH Buy Order N
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP01  1
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP02  1
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDBVHMNB    $KHMNB           BOH Company Num
     C                     Z-ADDBVBNNB    $KBNNB           BOH Buy Order N
     C                     Z-ADDBVBONB    $KBONB           BOL Load Number
     C                     Z-ADDBVCVNB    $KCVNB           TH Tattoo Numbe
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP03  1
     C                     END
      *
     C           W0CL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP04  1
     C                     END
      *
     C           W0CL05    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP05  1
     C                     END
      *
     C           W0CL06    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP06  1
     C                     END
      *
     C           W0CL07    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP07  1
     C                     END
      *
      *================================================================
     CSR         C1EXIT    ENDSR
      /EJECT
     CSR         C2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDBVHSNB    $LHSNB           ET Company Numb
     C                     Z-ADDBVA9DT    $LA9DT           ET Kill Date
     C                     Z-ADDBVFJNB    $LFJNB           ET Scale Sequen
     C                     Z-ADDBVHCNB    $LHCNB           ET Carcass Numb
     C                     Z-ADDBVGDNB    $LGDNB           ET Carcass Numb
     C                     Z-ADDBVFINB    $LFINB           ET Tattoo Numbe
     C                     Z-ADDBVLKNB    $LLKNB           ET Lot
     C                     MOVELBVEAST    $LEAST           ET Shift
     C                     Z-ADDBVAMPC    $LAMPC           ET Hot Wgt
     C                     MOVELBVDIST    $LDIST           ET Trim Area
     C                     Z-ADDBVX8NB    $LX8NB           ET Backfat Thic
     C                     Z-ADDBVFVPC    $LFVPC           ET Loineye Dept
     C                     Z-ADDBVAIPC    $LAIPC           ET Backfat Thic
     C                     Z-ADD*ZERO     $LNONB           Backfat * Wgt U
     C                     Z-ADDBVAJPC    $LAJPC           ET Loin-Eye Dep
     C                     Z-ADD*ZERO     $LNPNB           Loin-Eye * Wgt
     C                     Z-ADDBVAKPC    $LAKPC           ET Lean Percent
     C                     Z-ADD*ZERO     $LNNNB           Lean % * Wgt US
     C                     Z-ADDBVFWPC    $LFWPC           ET Light Reflec
     C                     Z-ADDBVFXPC    $LFXPC           ET Lean Percent
     C                     Z-ADDBVALPC    $LALPC           ET Light Reflec
     C                     MOVELBVFYST    $LFYST           ET Carcass Sex
     C                     MOVELBVD2ST    $LD2ST           ET Error Sts
     C                     MOVELBVEHST    $LEHST           ET Record Add/D
     C                     MOVELBVG1ST    $LG1ST           ET Record Creat
     C                     MOVELBVH4ST    $LH4ST           ET Record Creat
     C                     MOVELBVJLST    $LJLST           ET User Error O
     C                     MOVELBVUUST    $LUUST           ET Adjust/Add T
     C                     MOVELBVVHST    $LVHST           ET Broken Back
     C                     MOVELBVVIST    $LVIST           ET Unused Sts 2
     C                     MOVELBVVJST    $LVJST           ET Adjust/Add S
     C                     MOVELBVVKST    $LVKST           ET Unused Sts 4
     C                     MOVELBVVLST    $LVLST           ET Unused Sts 5
     C                     Z-ADDBVHMNB    $LHMNB           BOH Company Num
     C                     Z-ADDBVBNNB    $LBNNB           BOH Buy Order N
     C                     Z-ADDBVBONB    $LBONB           BOL Load Number
     C                     Z-ADDBVCVNB    $LCVNB           TH Tattoo Numbe
     C                     Z-ADDBVB0DT    $LB0DT           TH Kill Date
     C                     MOVELBVAAVN    $LAAVN           RS User Changed
     C                     Z-ADDBVAADT    $LAADT           RS Date Changed
     C                     Z-ADDBVAMTM    $LAMTM           RS Time Changed
     C                     MOVELBVAJST    $LAJST           RS Record Statu
     C                     Z-ADD*ZERO     $LAYPR           CD Gross Value
     C                     MOVEL*BLANK    $LOETX           Text 25 1 USR
     C                     MOVELBVAHVN    $LAHVN           RS Job
     C                     MOVELBVAGVN    $LAGVN           RS Program
     C                     MOVELBVABVN    $LABVN           RS User Added
     C                     Z-ADDBVABDT    $LABDT           RS Date Added
     C                     Z-ADDBVABTM    $LABTM           RS Time Added
     C                     Z-ADDBVB8DT    $LB8DT           RU Date
     C                     Z-ADDBVAOTM    $LAOTM           RU Time
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
      * CASE: PAR.Create OUTF EvlTrnVl USR is Yes
     C           P3UDST    IFEQ 'Y'                        *IF
      * ETV NonExcep/Excep
      * CASE: PAR.Exception Status USR is Yes
     C           WN0389    IFEQ 'Y'                        *IF
     C                     MOVEL'E'       YL0018           ETV NonExcep/Ex
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0018           ETV NonExcep/Ex
     C                     END                             *FI
      * ETV Accepted/Deleted
      * CASE: CUR.RS Record Status is Active
     C           $LAJST    IFEQ 'A'                        *IF
     C                     MOVEL'A'       YL0019           ETV Accepted/De
     C                     ELSE
      * CASE: CUR.RS Record Status is Flag for Purge
     C           $LAJST    IFEQ 'D'                        *IF
     C                     MOVEL'D'       YL0019           ETV Accepted/De
     C                     END                             *FI
     C                     END                             *FI
      * Crt Eval Tran Val Dtl CR - Eval Tran Value Dtl OUTF  * 
     C                     EXSR TMCRRC
     C                     END                             *FI
     C                     ADD  $LNONB    $MBSVA           Backfat * Wgt
     C                     ADD  $LNPNB    $MBTVA           Loin eye * wgt
     C                     ADD  $LNNNB    $MC6VA           Lean % * Wgt SU
     C                     ADD  1         $MCRCT           Carcass Count C
      *
      *================================================================
     CSR         C2EXIT    ENDSR
      /EJECT
     CSR         C3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN BVHMNB    WZC001           BOH Company Num
     C                     Z-ADDBVHMNB    WZC001
     C           *LIKE     DEFN BVBNNB    WZC002           BOH Buy Order N
     C                     Z-ADDBVBNNB    WZC002
     C           *LIKE     DEFN BVBONB    WZC003           BOL Load Number
     C                     Z-ADDBVBONB    WZC003
     C           *LIKE     DEFN BVCVNB    WZC004           TH Tattoo Numbe
     C                     Z-ADDBVCVNB    WZC004
     C           *LIKE     DEFN BVB0DT    WZC005           TH Kill Date
     C                     Z-ADDBVB0DT    WZC005
     C           *LIKE     DEFN BVFJNB    WZC006           ET Scale Sequen
     C                     Z-ADDBVFJNB    WZC006
     C           *LIKE     DEFN BVHCNB    WZC007           ET Carcass Numb
     C                     Z-ADDBVHCNB    WZC007
     C           *LIKE     DEFN BVGDNB    WZC008           ET Carcass Numb
     C                     Z-ADDBVGDNB    WZC008
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFC    OREQ '1'
     C           KRSC      READE@BVCPQ9                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFC  1
      * Quit if no record read
     C           W0EOFC    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : DB1.ET Hot Wgt is EQ Zero
      *   |- c2    : DB1.ET Backfat Thickness MM is Zero
      *   |- c3    : DB1.ET Loineye Depth MM is zero
      *   '-
     C           BVAMPC    IFEQ *ZERO                      *IF
     C           BVX8NB    OREQ *ZERO                      *OR
     C           BVFVPC    OREQ *ZERO                      *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0CL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0CL01  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0CL02  1        BOL Load Number
     C                     MOVEL*BLANK    W0CL03  1        TH Tattoo Numbe
     C                     MOVEL*BLANK    W0CL04  1        TH Kill Date
     C                     MOVEL*BLANK    W0CL05  1        ET Scale Sequen
     C                     MOVEL*BLANK    W0CL06  1        ET Carcass Numb
     C                     MOVEL*BLANK    W0CL07  1        ET Carcass Numb
     C           W0EOFC    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0CL00  1        BOH Company Num
     C                     MOVEL'Y'       W0CL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0CL02  1        BOL Load Number
     C                     MOVEL'Y'       W0CL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0CL04  1        TH Kill Date
     C                     MOVEL'Y'       W0CL05  1        ET Scale Sequen
     C                     MOVEL'Y'       W0CL06  1        ET Carcass Numb
     C                     MOVEL'Y'       W0CL07  1        ET Carcass Numb
     C                     ELSE
      * Next record - Detect level breaks
     C           BVHMNB    IFNE WZC001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL00
     C                     END
     C           BVBNNB    IFNE WZC002                     BOH Buy Order N
     C           W0CL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL01
     C                     END
     C           BVBONB    IFNE WZC003                     BOL Load Number
     C           W0CL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL02
     C                     END
     C           BVCVNB    IFNE WZC004                     TH Tattoo Numbe
     C           W0CL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL03
     C                     END
     C           BVB0DT    IFNE WZC005                     TH Kill Date
     C           W0CL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL04
     C                     END
     C           BVFJNB    IFNE WZC006                     ET Scale Sequen
     C           W0CL04    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL05
     C                     END
     C           BVHCNB    IFNE WZC007                     ET Carcass Numb
     C           W0CL05    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL06
     C                     END
     C           BVGDNB    IFNE WZC008                     ET Carcass Numb
     C           W0CL06    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL07
     C                     END
     C                     END
      *================================================================
     CSR         C3EXIT    ENDSR
      /EJECT
     CSR         C4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0CL07    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP07
     C                     END
      *
     C           W0CL06    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP06
     C                     END
      *
     C           W0CL05    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP05
     C                     END
      *
     C           W0CL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP04
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP03
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP02
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP01
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP00
     C                     END
      *
     C           W0EOFC    IFEQ '1'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$MFINTTL
     C                     END
      *
      *================================================================
     CSR         C4EXIT    ENDSR
      /EJECT
     CSR         D0MAIN    BEGSR
      *================================================================
      * Prt Eval Trans Inv    PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN CQKMNB    WQKD01           EB Company Numb
      * Define keylist
     C           KPSD      KLIST
     C                     KFLD           WQKD01           EB Company Numb
     C                     KFLD           CQB9DT           EB Kill Date
      * Define keylist
     C           KRSD      KLIST
     C                     KFLD           WQKD01           EB Company Numb
      * Setup key
     C                     Z-ADDP1HMNB    WQKD01           EB Company Numb
     C                     Z-ADDP1B0DT    CQB9DT           EB Kill Date
      * Establish starting position
     C           KPSD      SETLL@CQCPCU                    *
      * Read first record with user selection
     C                     EXSR D3READ
     C           W0EOFD    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0DL1P  1        First page
     C                     MOVEL'Y'       W0DL00  1        EB Company Numb
     C                     MOVEL'Y'       W0DL01  1        EB Kill Date
     C                     MOVEL'Y'       W0DL02  1        EB Shift
     C                     MOVEL'Y'       W0DL03  1        EB Scale Sequen
      * Set column headings flag
     C                     MOVE 'Y'       W0DCDT
      * Print report body
     C           W0EOFD    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR D1PHDR
      * Print report detail line
     C                     EXSR D2PDTL
      * Read next record with user selection
     C                     EXSR D3READ
      * Print totals
     C                     EXSR D4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         D0EXIT    ENDSR
      /EJECT
     CSR         D1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0DL1P    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $VCRSM           Carcass Count S
     C                     Z-ADD*ZERO     $VB5NB           Head Total USR
     C                     Z-ADD*ZERO     $VS0NB           Head Killed Tot
     C                     Z-ADD*ZERO     $VT4TS           Head 4 Tattoo S
     C                     Z-ADD*ZERO     $VZYNB           Head Total Usr
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP1P  1
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP00  1
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDCQKMNB    $RKMNB           EB Company Numb
     C                     Z-ADDCQB9DT    $RB9DT           EB Kill Date
      * Load related totals format
     C                     Z-ADDCQKMNB    $UKMNB           EB Company Numb
     C                     Z-ADDCQB9DT    $UB9DT           EB Kill Date
     C                     Z-ADD*ZERO     $UH0TS           Head 0 Tattoo S
     C                     Z-ADD*ZERO     $UH1TS           Head 1 Tattoo S
     C                     Z-ADD*ZERO     $UH2TS           Head 2 Tattoo S
     C                     Z-ADD*ZERO     $UH3TS           Head 3 Tattoo S
     C                     Z-ADD*ZERO     $UT4TS           Head 4 Tattoo S
     C                     Z-ADD*ZERO     $UH5SN           Head 5 Tattoo S
     C                     Z-ADD*ZERO     $UHOTS           Head Other Tatt
     C                     Z-ADD*ZERO     $UCRSM           Carcass Count S
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP01  1
     C                     END
      *
     C           W0DL02    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDCQKMNB    $TKMNB           EB Company Numb
     C                     Z-ADDCQB9DT    $TB9DT           EB Kill Date
     C                     MOVELCQHOST    $THOST           EB Shift
     C                     Z-ADD*ZERO     $TH0CT           Head 0 Tattoo C
     C                     Z-ADD*ZERO     $TH1CT           Head 1 Tattoo C
     C                     Z-ADD*ZERO     $TH2CT           Head 2 Tattoo C
     C                     Z-ADD*ZERO     $TH3CT           Head 3 Tattoo C
     C                     Z-ADD*ZERO     $TH4CT           Head 4 Tattoo C
     C                     Z-ADD*ZERO     $TH5CT           Head 5 Tattoo C
     C                     Z-ADD*ZERO     $THOCT           Head Other Tatt
     C                     Z-ADD*ZERO     $TCRCT           Carcass Count C
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP02  1
     C                     END
      *
     C           W0DL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP03  1
     C                     END
      *
      *================================================================
     CSR         D1EXIT    ENDSR
      /EJECT
     CSR         D2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDCQKMNB    $SKMNB           EB Company Numb
     C                     Z-ADDCQB9DT    $SB9DT           EB Kill Date
     C                     Z-ADDCQKONB    $SKONB           EB Scale Sequen
     C                     Z-ADDCQKNNB    $SKNNB           EB Tattoo Numbe
     C                     Z-ADDCQLMNB    $SLMNB           EB Lot
     C                     MOVELCQHOST    $SHOST           EB Shift
     C                     Z-ADDCQKPNB    $SKPNB           EB Hot Weight
     C                     Z-ADDCQX7NB    $SX7NB           EB Backfat Thic
     C                     Z-ADDCQFTPC    $SFTPC           EB Loineye Dept
     C                     Z-ADDCQBTPC    $SBTPC           EB Light Reflec
     C                     Z-ADDCQKQNB    $SKQNB           EB Backfat Thic
     C                     Z-ADDCQBSPC    $SBSPC           EB Loin-Eye Dep
     C                     Z-ADDCQFUPC    $SFUPC           EB Light Reflec
     C                     MOVELCQHPST    $SHPST           EB Trim Area
     C                     MOVELCQHQST    $SHQST           EB Carcass Sex
     C                     MOVELCQHSST    $SHSST           EB Record Creat
     C                     MOVELCQIFST    $SIFST           EB Error Type
     C                     MOVELCQM8CD    $SM8CD           EB Trolley Id
     C                     MOVELCQZMST    $SZMST           EB Broken Back
     C                     MOVELCQZNST    $SZNST           EB Unused Sts 1
     C                     MOVELCQZOST    $SZOST           EB Unused Sts 2
     C                     MOVELCQZPST    $SZPST           EB Unused Sts 3
     C                     MOVELCQZQST    $SZQST           EB Unused Sts 4
     C                     MOVELCQZRST    $SZRST           EB Unused Sts 5
     C                     MOVELCQZSST    $SZSST           EB Unused Sts 6
     C                     MOVELCQZTST    $SZTST           EB Unused Sts 7
     C                     MOVELCQZUST    $SZUST           EB Unused Sts 8
     C                     Z-ADDCQB8DT    $SB8DT           RU Date
     C                     Z-ADDCQAOTM    $SAOTM           RU Time
     C                     MOVEL*BLANK    $SFUTX           Error Status De
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
     C                     ADD  1         $TCRCT           Carcass Count C
      * CASE: CUR.EB Tattoo Number EQ WRK.Zero USR
     C           $SKNNB    IFEQ WUE9NB                     *IF
     C                     ADD  1         $TH0CT           Head 0 Tattoo C
     C                     ELSE
      * CASE: CUR.EB Tattoo Number is Carcass Doubled
     C           $SKNNB    IFEQ 1                          *IF
     C                     ADD  1         $TH1CT           Head 1 Tattoo C
     C                     ELSE
      * CASE: CUR.EB Tattoo Number is Turned Around
     C           $SKNNB    IFEQ 2                          *IF
     C                     ADD  1         $TH2CT           Head 2 Tattoo C
     C                     ELSE
      * CASE: CUR.EB Tattoo Number is Skinned Carcass
     C           $SKNNB    IFEQ 3                          *IF
     C                     ADD  1         $TH3CT           Head 3 Tattoo C
     C                     ELSE
      * CASE: CUR.EB Tattoo Number is Rerail
     C           $SKNNB    IFEQ 4                          *IF
     C                     ADD  1         $TH4CT           Head 4 Tattoo C
     C                     ELSE
      * CASE: CUR.EB Tattoo Number is Light Tattoo No
     C           $SKNNB    IFEQ 5                          *IF
     C                     ADD  1         $TH5CT           Head 5 Tattoo C
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         $THOCT           Head Other Tatt
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *
      *================================================================
     CSR         D2EXIT    ENDSR
      /EJECT
     CSR         D3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN CQKMNB    WZD001           EB Company Numb
     C                     Z-ADDCQKMNB    WZD001
     C           *LIKE     DEFN CQB9DT    WZD002           EB Kill Date
     C                     Z-ADDCQB9DT    WZD002
     C           *LIKE     DEFN CQHOST    WZD003           EB Shift
     C                     MOVELCQHOST    WZD003
     C           *LIKE     DEFN CQKONB    WZD004           EB Scale Sequen
     C                     Z-ADDCQKONB    WZD004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFD    OREQ '1'
     C           KRSD      READE@CQCPCU                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFD  1
      * Quit if no record read
     C           W0EOFD    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * CASE:
      *  - c1 AND c2 AND c3 AND c4 AND c5
      *   |- c1    : DB1.EB Tattoo Number EQ WRK.Zero USR
      *   |- c2    : DB1.EB Hot Weight is EQ Zero
      *   |- c3    : DB1.EB Backfat Thickness MM is Zero
      *   |- c4    : DB1.EB Loineye Depth MM is zero
      *   |- c5    : DB1.EB Light Reflectance MM EQ WRK.Zero USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           CQKNNB    IFEQ WUE9NB                     *IF
     C           CQKPNB    IFEQ *ZERO                      *IF
     C           CQX7NB    IFEQ *ZERO                      *IF
     C           CQFTPC    IFEQ *ZERO                      *IF
     C           CQFUPC    IFEQ WUE9NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * CASE: DB1.EB Kill Date GT PAR.Date To   USR
     C           CQB9DT    IFGT P2B4DT                     *IF
      * EOF File B            US - STR User Source Functions  * 
     C                     MOVEL'1'       W0EOFB           END OF FILE
     C                     END                             *FI
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.TH Schedule Kill Shift is *ALL values
      *   |- c2    : PAR.TH Schedule Kill Shift NE DB1.EB Shift
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0032    IFEQ '1'                        *IF
     C           YL0032    OREQ '2'
     C           YL0032    OREQ '3'
     C           YL0032    OREQ *BLANK
     C           YL0032    IFNE CQHOST                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0DL00  1        EB Company Numb
     C                     MOVEL*BLANK    W0DL01  1        EB Kill Date
     C                     MOVEL*BLANK    W0DL02  1        EB Shift
     C                     MOVEL*BLANK    W0DL03  1        EB Scale Sequen
     C           W0EOFD    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0DL00  1        EB Company Numb
     C                     MOVEL'Y'       W0DL01  1        EB Kill Date
     C                     MOVEL'Y'       W0DL02  1        EB Shift
     C                     MOVEL'Y'       W0DL03  1        EB Scale Sequen
     C                     ELSE
      * Next record - Detect level breaks
     C           CQKMNB    IFNE WZD001                     EB Company Numb
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL00
     C                     END
     C           CQB9DT    IFNE WZD002                     EB Kill Date
     C           W0DL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL01
     C                     END
     C           CQHOST    IFNE WZD003                     EB Shift
     C           W0DL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL02
     C                     END
     C           CQKONB    IFNE WZD004                     EB Scale Sequen
     C           W0DL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL03
     C                     END
     C                     END
      *================================================================
     CSR         D3EXIT    ENDSR
      /EJECT
     CSR         D4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0DL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP03
     C                     END
      *
     C           W0DL02    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 10
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Print format
     C                     WRITE$TKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP02
      * USER: Process after print of EB Shift format
     C                     ADD  $TH0CT    $UH0TS           Head 0 Tattoo S
     C                     ADD  $TH1CT    $UH1TS           Head 1 Tattoo S
     C                     ADD  $TH2CT    $UH2TS           Head 2 Tattoo S
     C                     ADD  $TH3CT    $UH3TS           Head 3 Tattoo S
     C                     ADD  $TH4CT    $UT4TS           Head 4 Tattoo S
     C                     ADD  $THOCT    $UHOTS           Head Other Tatt
     C                     ADD  $TCRCT    $UCRSM           Carcass Count S
     C                     ADD  $TH5CT    $UH5SN           Head 5 Tattoo S
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 10
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Convert EB Kill Date to display format
      * Convert date
     C           1000000   ADD  $UB9DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VUB9DT
      * Print format
     C                     WRITE$UKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP01
      * USER: Process after print of EB Kill Date format
     C                     ADD  $UT4TS    $VT4TS           Head 4 Tattoo S
     C                     ADD  $UCRSM    $VCRSM           Carcass Count S
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP00
     C                     END
      *
     C           W0EOFD    IFEQ '1'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of final totals format
     C           YL0031    ADD  $VCRSM    $VB5NB           Head Total USR
     C                     Z-ADD$QWUNB    $VS0NB           Head Killed Tot
      * Short/Over
      * CUR.Head Total Usr 2 =
      *    *COMPUTE (x1 - x2 - x3)
      * x1    : CUR.Head Total USR
      * -     : PGM.*Synon (15,0) work field
      * x2    : CUR.Head Killed Total Usr
      * -     : PGM.*Synon (15,0) work field
      * x3    : CUR.Head 4 Tattoo SUM
     C           $VB5NB    SUB  $VS0NB    W0WJ01           *Synon (15,0) w
     C           W0WJ01    SUB  $VT4TS    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    $VZYNB           Head Total Usr
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 6
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$VFINTTL
     C                     END
     C                     END
      *
      *================================================================
     CSR         D4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of Prt Hot Scl Upl Summ  PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Prt Hot Scl Upl Summ  PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of first page format
      * 1PG = PAR By name
     C                     Z-ADDP1HMNB    $BHMNB           BOH Company Num
     C                     Z-ADDP2B4DT    $BB4DT           Date To   USR
     C                     MOVELP3M1ST    $BM1ST           Report Type Sum
     C                     MOVELP3TXST    $BTXST           Include Market
     C                     MOVELP3TYST    $BTYST           Include Subject
     C                     MOVELP3TWST    $BTWST           Include Resale
     C                     MOVELP1ABCD    $BABCD           PD Producer Cod
     C                     MOVELP3J9ST    $BJ9ST           TH Payment Type
     C                     MOVELP3TVST    $BTVST           Variance Type U
     C                     Z-ADDP3CVNB    $BCVNB           TH Tattoo Numbe
     C                     MOVELP3T6ST    $BT6ST           Analysis Type U
     C                     MOVELP3T5ST    $BT5ST           Payment Data Ty
     C                     Z-ADDP1B0DT    $BB3DT           Date From USR
      * Val Company Number    XF - STR Order Management Sys  * 
     C                     CALL 'PDGZXFR'              90  Val Company Num
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0001  30       CC Company Numb
     C           $BEUTX    PARM *BLANK    WQ0002 30        Oms Name
     C           WUG3ST    PARM *BLANK    WQ0003  1        Invalid Y/N USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGZXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Producer Name
      * CASE: PAR.PD Producer Code is Entered
     C           P1ABCD    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    $BA4TX           Producer Name
      * Producer Name         DRV
      * Rtv Producer Name     RT - Producer  * 
     C                     EXSR SBRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $BA4TX           Producer Name
     C                     MOVEL'*All'    $BA4TX           Producer Name
     C                     END                             *FI
      * Payment Type
      * CASE: 1PG.TH Payment Type is Carcass/Live
     C           $BJ9ST    IFEQ 'C'                        *IF
     C           $BJ9ST    OREQ 'L'
      * 1PG.Condition Name USR = Condition name of 1PG.TH Payment Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100717   Y2LSNO  70       List number
     C                     PARM $BJ9ST    W0INVL 25        TH Payment Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BC4TX    PARM           W0CNNM 25        Condition Name
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $BC4TX           Condition Name
     C                     MOVEL'*All'    $BC4TX           Condition Name
     C                     END                             *FI
      * Variance Type
      * CASE: 1PG.Variance Type USR is *ALL values
     C           $BTVST    IFEQ '+'                        *IF
     C           $BTVST    OREQ '-'
      * 1PG.Condition Name 1 USR = Condition name of 1PG.Variance Type US
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1219297   Y2LSNO  70       List number
     C                     PARM $BTVST    W0INVL 25        Variance Type U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BI1TX    PARM           W0CNNM 25        Condition Name
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $BI1TX           Condition Name
     C                     MOVEL'*All'    $BI1TX           Condition Name
     C                     END                             *FI
      * 1PG.Condition Name 2 USR = Condition name of 1PG.Include Market U
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100042   Y2LSNO  70       List number
     C                     PARM $BTXST    W0INVL 25        Include Market
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BI2TX    PARM           W0CNNM 25        Condition Name
      *
      * 1PG.Condition Name 3 USR = Condition name of 1PG.Include Subject
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100042   Y2LSNO  70       List number
     C                     PARM $BTYST    W0INVL 25        Include Subject
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BI3TX    PARM           W0CNNM 25        Condition Name
      *
      * 1PG.Condition Name 4 USR = Condition name of 1PG.Include Resale U
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100042   Y2LSNO  70       List number
     C                     PARM $BTWST    W0INVL 25        Include Resale
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BI4TX    PARM           W0CNNM 25        Condition Name
      *
      * 1PG.Text 25 1 USR = Condition name of 1PG.Payment Data Type USR
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1220432   Y2LSNO  70       List number
     C                     PARM $BT5ST    W0INVL 25        Payment Data Ty
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BOETX    PARM           W0CNNM 25        Text 25 1 USR
      *
      * 1PG.Text 25 2 USR = Condition name of 1PG.Report Type Sum/Dtl USR
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1174633   Y2LSNO  70       List number
     C                     PARM $BM1ST    W0INVL 25        Report Type Sum
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BOFTX    PARM           W0CNNM 25        Text 25 2 USR
      *
      * 1PG.Text 25 3 USR = Condition name of 1PG.Analysis Type USR
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1220432   Y2LSNO  70       List number
     C                     PARM $BT6ST    W0INVL 25        Analysis Type U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BO4TX    PARM           W0CNNM 25        Text 25 3 USR
      *
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Date From USR to display format
      * Convert date
     C           1000000   ADD  $BB3DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBB3DT
      * Convert Date To   USR to display format
      * Convert date
     C           1000000   ADD  $BB4DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBB4DT
      * Print format
     C                     WRITE$B1STPAG
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print BOH Company Number of Prt Hot Scl Upl Summ  PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Print format
     C                     WRITE$CKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      *
      * Reset format print flag
     C                     MOVE 'P'       W0AP00
     C                     END                             FI
      * Print TH Kill Date of Prt Hot Scl Upl Summ  PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print PD Producer Code of Prt Hot Scl Upl Summ  PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print BOH Buy Order Number of Prt Hot Scl Upl Summ  PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP03
     C                     END                             FI
      * Print BOL Load Number of Prt Hot Scl Upl Summ  PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP04    ANDEQ'P'
      * USER: On print of BOL Load Number format
     C                     Z-ADD*ZERO     P8P0NB           Count USR
      * Mention hidden format
     C   99N99             WRITE$DKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0AP04
     C                     END                             FI
      * Print TH Tattoo Number of Prt Hot Scl Upl Summ  PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP05    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP05    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP05
     C                     END                             FI
      * Print Detail line of Prt Hot Scl Upl Summ  PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * CUR.Text 10 1 USR = Condition name of CUR.TH Hog Class Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1110255   Y2LSNO  70       List number
     C                     PARM $ELLST    W0INVL 25        TH Hog Class Ty
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $EJPTX    PARM           W0CNNM 25        Text 10 1 USR
      *
      * CUR.Th Payment Type Desc Usr = Condition name of CUR.TH Payment T
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100717   Y2LSNO  70       List number
     C                     PARM $EJ9ST    W0INVL 25        TH Payment Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $EIYTX    PARM           W0CNNM 25        Th Payment Type
      *
      * Valid/Invalid Carcasses
      * CASE: DB1.TH Hog Class Type is Not Resale
     C           A1LLST    IFEQ 'M'                        *IF
     C           A1LLST    OREQ 'S'
      * BP = Business Practice
      * Prt Hot Scl Upl Summ  RT - Eval Trans UPL  * 
     C                     EXSR SCRVGN
     C                     ADD  YL0002    $ELINB           Head 2
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     $ELFNB           TDE Head Condem
     C                     Z-ADD*ZERO     $ELINB           Head 2
     C                     Z-ADD*ZERO     $EIINB           Difference +/-
     C                     END                             *FI
      * Difference +/-
      * PAR.Difference +/- =
      *    *COMPUTE (x1 - x2 - x3)
      * x1    : CUR.TH Head Killed
      * -     : PGM.*Synon (15,0) work field
      * x2    : CUR.TDE Head Condemned
      * -     : PGM.*Synon (15,0) work field
      * x3    : CUR.Head 2
     C           $EFENB    SUB  $ELFNB    W0WJ01           *Synon (15,0) w
     C           W0WJ01    SUB  $ELINB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    P7IINB           Difference +/-
      * < 0.00>
      * CASE: PAR.Difference +/- is GE ZERO
     C           P7IINB    IFGE *ZERO                      *IF
     C                     MOVEL*BLANK    WUHDST           Display Field U
     C                     MOVEL'*NO'     WUHDST           Display Field U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'*YES'    WUHDST           Display Field U
     C                     END                             *FI
     C                     Z-ADDP7IINB    $EIINB           Difference +/-
      * Prt Hot Scl Upl Summ  RT - Eval Trans  * 
     C                     EXSR SFRVGN
      * Prt Hot Scl Upl Summ  RT - Carcass Detail  * 
     C                     EXSR SJRVGN
      * Rtv Tattoo Ded/Add    RT - Tattoo Ded/Add  * 
     C                     EXSR SLRVGN
      * Rtv Tattoo Ded/Add    RT - Tattoo Ded/Add  * 
     C                     EXSR SMRVGN
     C                     MOVEL'Y'       YL0005           *Record selecte
      * Print Format/Record Selected
      * CASE: PAR.Variance Type USR is *ALL values
     C           P3TVST    IFEQ '+'                        *IF
     C           P3TVST    OREQ '-'
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Variance Type USR is Negative
      *   |- c2    : CUR.Difference +/- is GE ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3TVST    IFEQ '-'                        *IF
     C           $EIINB    IFGE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     MOVEL'N'       YL0005           *Record selecte
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Variance Type USR is Positive
      *   |- c2    : CUR.Difference +/- is LT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3TVST    IFEQ '+'                        *IF
     C           $EIINB    IFLT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     MOVEL'N'       YL0005           *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Unpay Tattoo
      * CASE: PAR.Payment Data Type USR is *ALL values
     C           P3T5ST    IFEQ 'UV'                       *IF
     C           P3T5ST    OREQ 'UE'
     C           P3T5ST    OREQ 'EV'
     C           P3T5ST    OREQ 'EE'
     C           P3T5ST    OREQ 'EA'
     C           P3T5ST    OREQ 'PC'
      * CASE: PGM.*Print format is Print format
     C           W0PFM     IFEQ 'Y'                        *IF
      * Rtv BoH  Quot/Cmp     RT - Buy Order Header  * 
     C                     EXSR SNRVGN
      * Chg Re-Evl UnpTatNoCarcXF - Tattoo Header  * 
     C                     CALL 'PKA9XFR'              90  Chg Re-Evl UnpT
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $EHMNB    WQ0016  30       BOH Company Num
     C                     PARM $ECVNB    WQ0017  50       TH Tattoo Numbe
     C                     PARM $EB0DT    WQ0018  70       TH Kill Date
     C                     PARM $EABCD    WQ0019  6        PD Producer Cod
     C                     PARM $EAECD    WQ0020  6        PL Location Cod
     C                     PARM YL0006    WQ0021  2        BOH Quote Price
     C                     PARM YL0007    WQ0022  52       BOH Quoted Base
     C                     PARM YL0008    WQ0023  3        CMP Program Cod
     C                     PARM 'T'       WQ0024  1        Re-Env Sel Prod
     C                     PARM $EB0DT    WQ0025  70       Kill Date 2 USR
     C                     PARM '*NO'     WQ0026  4        Carcass Detail
     C                     PARM 'N'       WQ0027  1        Re-Pay 1 Tattoo
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKA9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Dlt Crcs Dtl By Tatto/dte - Carcass Detail  * 
     C                     EXSR SORVGN
     C                     END                             *FI
     C                     END                             *FI
      * Analysis
      * CASE: LCL.*Record selected is *YES
     C           YL0005    IFEQ 'Y'                        *IF
      * CUR.TH Avg Live Wgt = DB1.TH Avg Live Wgt
      * LCL.TH Head Killed / Actual Values
      * CASE: PAR.Analysis Type USR is Eval Trans UPL Valid
     C           P3T6ST    IFEQ 'UV'                       *IF
     C                     Z-ADD$ELFNB    YL0009           TH Head Killed
     C                     ELSE
      * CASE: PAR.Analysis Type USR is Eval Trans UPL Excep
     C           P3T6ST    IFEQ 'UE'                       *IF
     C                     Z-ADD$ELINB    YL0009           TH Head Killed
     C                     ELSE
      * CASE: PAR.Analysis Type USR is Eval Trans Adds
     C           P3T6ST    IFEQ 'EA'                       *IF
     C                     Z-ADD$EHD3C    YL0009           TH Head Killed
     C                     ELSE
      * CASE: PAR.Analysis Type USR is Eval Trans Valid
     C           P3T6ST    IFEQ 'EV'                       *IF
     C                     Z-ADD$EHD4C    YL0009           TH Head Killed
     C                     ELSE
      * CASE: PAR.Analysis Type USR is Eval Trans Excep
     C           P3T6ST    IFEQ 'EE'                       *IF
     C                     Z-ADD$EHD5C    YL0009           TH Head Killed
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD$EFENB    YL0009           TH Head Killed
     C                     Z-ADD$EE0NB    $EKGNB           Hot Weight Tot
     C           $EKGNB    MULT A1F4NB    $EJONB           Hot Wgt/Lean %
     C           $EKGNB    MULT A1F3NB    $EL1NB           Hot Wgt/Loine A
     C           $EKGNB    MULT A1F2NB    $EL0NB           Hot Wgt/Backf A
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CUR.TH Avg Hot Wgt
      * CASE: LCL.TH Head Killed is Not Zero
     C           YL0009    IFNE *ZERO                      *IF
     C           $EKGNB    DIV  YL0009    $EHDNB           TH Avg Hot Wgt
     C           $ECBPR    DIV  YL0009    $EQBPR           Cost /Hd USR
     C           $EQBPR    MULT $EFENB    $EK2PR           Gross Pay Amt 2
     C                     END                             *FI
      * CUR.Backfat, Loin Eye, Lean %
      * CASE: CUR.Hot Weight Tot USR is Not zero
     C           $EKGNB    IFNE *ZERO                      *IF
     C           $EJONB    DIV  $EKGNB    $EF4NB           TH Avg Lean Per
     C           $EL0NB    DIV  $EKGNB    $EF2NB           TH Avg Backfat
     C           $EL1NB    DIV  $EKGNB    $EF3NB           TH Avg Loin Eye
     C                     END                             *FI
      * CUR.Actual Yield
      * CASE: CUR.TH Live Wgt is Not Zero
     C           $ECYNB    IFGT *ZERO                      *IF
      * CUR. TH Actual Yield
      * CUR.TH Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : CUR.Hot Weight Tot USR
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : CUR.TH Live Wgt
      * *     : PGM.*Synon (17,7) work field
      * x3    : CON.100
     C           $EKGNB    DIV  $ECYNB    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    $EAWPC           TH Actual Yield
     C                     END                             *FI
      * Top Carc $/Hd
      * CASE: CUR.TH Head Killed is Not Zero
     C           $EFENB    IFNE *ZERO                      *IF
      * CASE: CUR.Head Total USR LT CUR.TH Head Killed
     C           $EB5NB    IFLT $EFENB                     *IF
      * Top Carc Gross
      * CUR.Gross Pay Amt Tot USR =
      *    *COMPUTE (x1 + (x2 * (x3 - x4)))
      * x1    : CUR.Gross Pay Amt Tot USR
      * +     : PGM.*Synon (15,2) work field
      * x2    : CUR.Cost /Hd USR
      * *     : PGM.*Synon (15,2) work field *
      * x3    : CUR.TH Head Killed
      * -     : PGM.*Synon (15,2) work field
      * x4    : CUR.Head Total USR
     C           $EFENB    SUB  $EB5NB    W0WA02           *Synon (15,2) w
     C           $EQBPR    MULT W0WA02    W0WA01           *Synon (15,2) w
     C           $ECUPR    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    $ECUPR           Gross Pay Amt T
     C                     END                             *FI
     C           $ECUPR    DIV  $EFENB    $EQCPR           Cost /Hd Top US
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Report Type Sum/Dtl USR is Summary
     C           P3M1ST    IFEQ 'S'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  $EB0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VEB0DT
     C                     MOVEL'0'       *IN79
     C           WUHDST    IFEQ '*NO'                      *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$ECOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$EDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of Prt Eval Trans w/FOM  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print BOH Company Number of Prt Eval Trans w/FOM  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print BOH Buy Order Number of Prt Eval Trans w/FOM  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$FKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print BOL Load Number of Prt Eval Trans w/FOM  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print TH Tattoo Number of Prt Eval Trans w/FOM  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP03    ANDEQ'P'
      * USER: On print of TH Tattoo Number format
      * Rtv PrchPrc Clc Info  RT - Buy Order Header  * 
     C                     EXSR SQRVGN
      * Rtv PurchPrc Clc Info RT - Producer Sub-Contract  * 
     C                     EXSR SRRVGN
      * Rtv CMP Info          RT - Carcass Merit Program  * 
     C                     EXSR SSRVGN
      * CASE: PAR.TH Payment Type is Live
     C           $EJ9ST    IFEQ 'L'                        *IF
      * Clc Base Mkt Price    XF - Pricing Option  * 
     C                     CALL 'PKJ7XFR'              90  Clc Base Mkt Pr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $GBNNB    WQ0028  70       BOH Buy Order N
     C                     PARM $GBONB    WQ0029  50       BOL Load Number
     C                     PARM $GCVNB    WQ0030  50       TH Tattoo Numbe
     C                     PARM $EAWDT    WQ0031  70       TH Purchase Dat
     C                     PARM $ECYNB    WQ0032  71       TH Live Wgt
     C           $EAMPR    PARM *ZERO     WQ0033  52       TH CM Base Mkt
     C                     PARM BVB0DT    WQ0034  70       TH Kill Date
     C                     PARM $GHMNB    WQ0035  30       BOH Company Num
     C                     PARM WN0340    WQ0036  52       PSC Floor Price
     C                     PARM WN0341    WQ0037  52       PSC Ceiling Pri
     C                     PARM WN0342    WQ0038  30       PSC Market Perc
     C                     PARM WN0346    WQ0039  52       PSC Mkt Percent
     C           YL0010    PARM YL0010    WQ0040  52       Market Price US
     C           YL0011    PARM *BLANK    WQ0041  2        Pricing UOM USR
     C           YL0012    PARM *ZERO     WQ0042  70       Pricing Date US
     C                     PARM WN0327    WQ0043  3        PO Option Code
     C                     PARM *BLANK    WQ0044  5        PC Contract Cod
     C                     PARM *BLANK    WQ0045  5        PSC Sub-Contrac
     C                     PARM *ZERO     WQ0046  52       BOH Market Add/
     C                     PARM WN0328    WQ0047  3        CMP Program Cod
     C                     PARM WN0320    WQ0048  2        BOH Quote Price
     C                     PARM WN0321    WQ0049  52       BOH Quoted Base
     C                     PARM WN0322    WQ0050  3        BOH Commodity M
     C                     PARM WN0323    WQ0051  7        BOH Commodity P
     C                     PARM WN0324    WQ0052  3        BOH Market Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKJ7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Mention hidden format
     C   99N99             WRITE$GKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0BP03
     C                     END                             FI
      * Print TH Kill Date of Prt Eval Trans w/FOM  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP04
     C                     END                             FI
      * Print ET Scale Sequence Number of Prt Eval Trans w/FOM  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP05    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP05    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP05
     C                     END                             FI
      * Print ET Carcass Number of Prt Eval Trans w/FOM  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP06    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP06    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP06
     C                     END                             FI
      * Print ET Carcass Number Insert of Prt Eval Trans w/FOM  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP07    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP07    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP07
     C                     END                             FI
      * Print Detail line. of Prt Eval Trans w/FOM  PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     MOVEL'N'       WN0347           Exception Statu
      * Determine Status of Carcass
      * CASE: BAL: Valid Carcass
      *  - c1 AND c2 AND c3 AND c4 AND c5
      *   |- c1    : CUR.ET Error Sts is Balance
      *   |- c2    : CUR.ET Record Add/Del Sts is Blanks
      *   |- c3    : CUR.ET Record Created W/Avg is Not Created With Aver
      *   |- c4    : CUR.ET User Error Override is No
      *   |- c5    : CUR.RS Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $HD2ST    IFEQ 'B'                        *IF
     C           $HEHST    IFEQ *BLANK                     *IF
     C           $HG1ST    IFEQ *BLANK                     *IF
     C           $HJLST    IFEQ 'N'                        *IF
     C           $HAJST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL@CN,001   $HOETX           Text 25 1 USR
     C                     ELSE
      * CASE: BAL: Exception Accepted
      *  - c1 AND c2 AND c3 AND c4 AND c5
      *   |- c1    : CUR.ET Error Sts is Balance
      *   |- c2    : CUR.ET Record Add/Del Sts is Blanks
      *   |- c3    : CUR.ET Record Created W/Avg is Not Created With Aver
      *   |- c4    : CUR.ET User Error Override is Yes
      *   |- c5    : CUR.RS Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $HD2ST    IFEQ 'B'                        *IF
     C           $HEHST    IFEQ *BLANK                     *IF
     C           $HG1ST    IFEQ *BLANK                     *IF
     C           $HJLST    IFEQ 'Y'                        *IF
     C           $HAJST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WN0347           Exception Statu
     C                     MOVEL@CN,002   $HOETX           Text 25 1 USR
     C                     ELSE
      * CASE: BAL: Added At Average
      *  - c1 AND c2 AND c3 AND c4 AND c5
      *   |- c1    : CUR.ET Error Sts is Balance
      *   |- c2    : CUR.ET Record Add/Del Sts is Add
      *   |- c3    : CUR.ET Record Created W/Avg is Not Created With Aver
      *   |- c4    : CUR.ET User Error Override is No
      *   |- c5    : CUR.RS Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $HD2ST    IFEQ 'B'                        *IF
     C           $HEHST    IFEQ 'A'                        *IF
     C           $HG1ST    IFEQ *BLANK                     *IF
     C           $HJLST    IFEQ 'N'                        *IF
     C           $HAJST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL@CN,003   $HOETX           Text 25 1 USR
     C                     ELSE
      * CASE: BAL: Valid Deleted
      *  - c1 AND c2 AND c3 AND c4 AND c5
      *   |- c1    : CUR.ET Error Sts is Balance
      *   |- c2    : CUR.ET Record Add/Del Sts is Blanks
      *   |- c3    : CUR.ET Record Created W/Avg is Not Created With Aver
      *   |- c4    : CUR.ET User Error Override is No
      *   |- c5    : CUR.RS Record Status is Flag for Purge
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $HD2ST    IFEQ 'B'                        *IF
     C           $HEHST    IFEQ *BLANK                     *IF
     C           $HG1ST    IFEQ *BLANK                     *IF
     C           $HJLST    IFEQ 'N'                        *IF
     C           $HAJST    IFEQ 'D'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL@CN,004   $HOETX           Text 25 1 USR
     C                     ELSE
      * CASE: ERR: Original Carcass Replaced with Average
      *  - c1 AND c2 AND c3 AND c4 AND c5
      *   |- c1    : CUR.ET Error Sts is Error
      *   |- c2    : CUR.ET Record Add/Del Sts is Org Record OverRiden W/
      *   |- c3    : CUR.ET Record Created W/Avg is Not Created With Aver
      *   |- c4    : CUR.ET User Error Override is No
      *   |- c5    : CUR.RS Record Status is Flag for Purge
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $HD2ST    IFEQ 'E'                        *IF
     C           $HEHST    IFEQ 'O'                        *IF
     C           $HG1ST    IFEQ *BLANK                     *IF
     C           $HJLST    IFEQ 'N'                        *IF
     C           $HAJST    IFEQ 'D'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WN0347           Exception Statu
     C                     MOVEL@CN,005   $HOETX           Text 25 1 USR
     C                     ELSE
      * CASE: ERR: Exception Deleted
      *  - c1 AND c2 AND c3 AND c4 AND c5
      *   |- c1    : CUR.ET Error Sts is Error
      *   |- c2    : CUR.ET Record Add/Del Sts is Blanks
      *   |- c3    : CUR.ET Record Created W/Avg is Not Created With Aver
      *   |- c4    : CUR.ET User Error Override is No
      *   |- c5    : CUR.RS Record Status is Flag for Purge
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $HD2ST    IFEQ 'E'                        *IF
     C           $HEHST    IFEQ *BLANK                     *IF
     C           $HG1ST    IFEQ *BLANK                     *IF
     C           $HJLST    IFEQ 'N'                        *IF
     C           $HAJST    IFEQ 'D'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WN0347           Exception Statu
     C                     MOVEL@CN,006   $HOETX           Text 25 1 USR
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0348  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0349  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0350  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0351  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0352  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0353  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0354  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0355  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0356  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0357  30       CMMR Row Number
     C                     Z-ADD*ZERO     WN0358  52       CMMR Std Dressi
     C                     Z-ADD*ZERO     WN0359  31       CMMC Lean Perce
     C                     Z-ADD*ZERO     WN0360  53       CMMC Premium Va
      *
      * Clc Carc Anal 1 Carc  IF
      * Rtv StdYld/SortDisc   RT - Carcass Merit Matrix Row  * 
     C                     EXSR STRVGN
      * CD Base Carcass CWT  12/16/98 PKD
      * CASE: PAR.Pricing UOM USR is Live Hundred Weight
     C           'LW'      IFEQ 'LW'                       *IF
      * CASE: PAR.CMMR Std Dressing Yield% is ne 0
     C           WN0358    IFNE 0                          *IF
      * CD Base Carcass CWT
      * PAR.CD Base Carcass CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Base Mkt Price
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CMMR Std Dressing Yield%
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WN0358    DIV  100       W0WD01    H      *Synon (17,7) w
     C           $EAMPR    DIV  W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0350           CD Base Carcass
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0350           CD Base Carcass
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Pricing UOM USR is Carcass Hundred Weight
     C           'LW'      IFEQ 'CW'                       *IF
     C                     Z-ADD$EAMPR    WN0350           CD Base Carcass
     C                     END                             *FI
     C                     END                             *FI
      * CD Base Carc Value
      * PAR.CD Base Carc Value =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Base Carcass CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           $HAMPC    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0350    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0352           CD Base Carc Va
      * CAS: Calc CD Crc Value Per CWT w/ Quote Type.   08/03/95 PKP
      * CASE: PAR.CMP Sort Basis is Live
     C           WN0331    IFEQ 'L'                        *IF
      * CASE: PAR.Pricing UOM USR is Live Hundred Weight
     C           'LW'      IFEQ 'LW'                       *IF
      * CD Crc Value Per CWT
      * PAR.CD Crc Value Per CWT =
      *    *COMPUTE ((x1 + x2) / (x3 / x4))
      * x1    : PAR.TH CM Base Mkt Price
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Sort Loss
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.CMMR Std Dressing Yield%
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x4    : CON.100
     C           $EAMPR    ADD  WN0348    W0WA01           *Synon (15,2) w
     C           WN0358    DIV  100       W0WD02    H      *Synon (17,7) w
     C           W0WA01    DIV  W0WD02    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0351           CD Crc Value Pe
     C                     ELSE
      * CASE: PAR.Pricing UOM USR is Carcass Hundred Weight
     C           'LW'      IFEQ 'CW'                       *IF
      * CD Crc Value Per CWT
      * PAR.CD Crc Value Per CWT =
      *    *COMPUTE (x1 + (x2 / (x3 / x4)))
      * x1    : PAR.CD Base Carcass CWT
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Sort Loss
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : PAR.CMMR Std Dressing Yield%
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x4    : CON.100
     C           WN0358    DIV  100       W0WD02    H      *Synon (17,7) w
     C           WN0348    DIV  W0WD02    W0WB01    H      *Synon (15,5) w
     C           WN0350    ADD  W0WB01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0351           CD Crc Value Pe
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.CMP Sort Basis is Meat
     C           WN0331    IFEQ 'M'                        *IF
      * CASE: PAR.Pricing UOM USR is Live Hundred Weight
     C           'LW'      IFEQ 'LW'                       *IF
      * CD Crc Value Per CWT NEW
      * PAR.CD Crc Value Per CWT =
      *    *COMPUTE ((x1 + (x2 * (x3 / x4))) / (x5 / x6))
      * x1    : PAR.TH CM Base Mkt Price
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Sort Loss
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.CMMR Std Dressing Yield%
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x5    : PAR.CMMR Std Dressing Yield%
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x6    : CON.100
     C           WN0358    DIV  100       W0WB03    H      *Synon (15,5) w
     C           WN0348    MULT W0WB03    W0WA02    H      *Synon (15,2) w
     C           $EAMPR    ADD  W0WA02    W0WA01           *Synon (15,2) w
     C           WN0358    DIV  100       W0WB04    H      *Synon (15,5) w
     C           W0WA01    DIV  W0WB04    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0351           CD Crc Value Pe
     C                     ELSE
      * CASE: PAR.Pricing UOM USR is Carcass Hundred Weight
     C           'LW'      IFEQ 'CW'                       *IF
      * CD Crc Value Per CWT
      * PAR.CD Crc Value Per CWT =
      *    *COMPUTE (x1 + x2)
      * x1    : PAR.CD Base Carcass CWT
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Sort Loss
     C           WN0350    ADD  WN0348    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0351           CD Crc Value Pe
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.CMP Sort Basis is None
     C           WN0331    IFEQ *BLANK                     *IF
     C                     Z-ADDWN0350    WN0351           CD Crc Value Pe
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CD Crc Value $ Per Hd
      * PAR.CD Crc Value $ Per Hd =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Crc Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           $HAMPC    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0351    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0353           CD Crc Value $
      * Grade/Premium
      * CASE: PAR.CMP Grading Type is Lean Percent NPPC
     C           WN0330    IFEQ 'L'                        *IF
      * LEAN PERCENT NPPC
     C                     EXSR UISUBR                     LEAN PERCENT NP
     C                     ELSE
      * CASE: PAR.CMP Grading Type is Lean Percent FOM
     C           WN0330    IFEQ 'P'                        *IF
      * LEAN PERCENT  FAT O METER
     C                     EXSR UJSUBR                     LEAN PERCENT  F
     C                     ELSE
      * CASE: PAR.CMP Grading Type is Backfat
     C           WN0330    IFEQ 'B'                        *IF
      * Backfat
     C                     EXSR UKSUBR                     Backfat
     C                     ELSE
      * CASE: PAR.CMP Grading Type is Lean Factor
     C           WN0330    IFEQ 'F'                        *IF
      * Lean Factor
     C                     EXSR ULSUBR                     Lean Factor
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0358    WN0349           CD STD Yield
     C           $HAIPC    MULT $HAMPC    $HNONB           Backfat * Wgt U
     C           $HAJPC    MULT $HAMPC    $HNPNB           Loin-Eye * Wgt
     C           $HAKPC    MULT $HAMPC    $HNNNB           Lean % * Wgt US
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$HCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$HDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print First Page Format of Prt Eval Trans wo/FOM PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0CL1P
     C                     END                             FI
      * Print BOH Company Number of Prt Eval Trans wo/FOM PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP00
     C                     END                             FI
      * Print BOH Buy Order Number of Prt Eval Trans wo/FOM PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP01    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$JKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0CP01
     C                     END                             FI
      * Print BOL Load Number of Prt Eval Trans wo/FOM PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP02
     C                     END                             FI
      * Print TH Tattoo Number of Prt Eval Trans wo/FOM PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP03    ANDEQ'P'
      * USER: On print of TH Tattoo Number format
      * Rtv PrchPrc Clc Info  RT - Buy Order Header  * 
     C                     EXSR TCRVGN
      * Rtv PurchPrc Clc Info RT - Producer Sub-Contract  * 
     C                     EXSR TDRVGN
      * Rtv CMP Info          RT - Carcass Merit Program  * 
     C                     EXSR TERVGN
      * CASE: PAR.TH Payment Type is Live
     C           $EJ9ST    IFEQ 'L'                        *IF
      * Clc Base Mkt Price    XF - Pricing Option  * 
     C                     CALL 'PKJ7XFR'              90  Clc Base Mkt Pr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $KBNNB    WQ0053  70       BOH Buy Order N
     C                     PARM $KBONB    WQ0054  50       BOL Load Number
     C                     PARM $KCVNB    WQ0055  50       TH Tattoo Numbe
     C                     PARM $EAWDT    WQ0056  70       TH Purchase Dat
     C                     PARM $ECYNB    WQ0057  71       TH Live Wgt
     C           $EAMPR    PARM *ZERO     WQ0058  52       TH CM Base Mkt
     C                     PARM BVB0DT    WQ0059  70       TH Kill Date
     C                     PARM $KHMNB    WQ0060  30       BOH Company Num
     C                     PARM WN0382    WQ0061  52       PSC Floor Price
     C                     PARM WN0383    WQ0062  52       PSC Ceiling Pri
     C                     PARM WN0384    WQ0063  30       PSC Market Perc
     C                     PARM WN0388    WQ0064  52       PSC Mkt Percent
     C           YL0015    PARM YL0015    WQ0065  52       Market Price US
     C           YL0016    PARM *BLANK    WQ0066  2        Pricing UOM USR
     C           YL0017    PARM *ZERO     WQ0067  70       Pricing Date US
     C                     PARM WN0369    WQ0068  3        PO Option Code
     C                     PARM *BLANK    WQ0069  5        PC Contract Cod
     C                     PARM *BLANK    WQ0070  5        PSC Sub-Contrac
     C                     PARM *ZERO     WQ0071  52       BOH Market Add/
     C                     PARM WN0370    WQ0072  3        CMP Program Cod
     C                     PARM WN0362    WQ0073  2        BOH Quote Price
     C                     PARM WN0363    WQ0074  52       BOH Quoted Base
     C                     PARM WN0364    WQ0075  3        BOH Commodity M
     C                     PARM WN0365    WQ0076  7        BOH Commodity P
     C                     PARM WN0366    WQ0077  3        BOH Market Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKJ7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Mention hidden format
     C   99N99             WRITE$KKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0CP03
     C                     END                             FI
      * Print TH Kill Date of Prt Eval Trans wo/FOM PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP04
     C                     END                             FI
      * Print ET Scale Sequence Number of Prt Eval Trans wo/FOM PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP05    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP05    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP05
     C                     END                             FI
      * Print ET Carcass Number of Prt Eval Trans wo/FOM PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP06    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP06    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP06
     C                     END                             FI
      * Print ET Carcass Number Insert of Prt Eval Trans wo/FOM PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP07    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP07    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP07
     C                     END                             FI
      * Print Detail line. of Prt Eval Trans wo/FOM PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0CCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     MOVEL'N'       WN0389           Exception Statu
      * Determine Status of Carcass
      * CASE: BAL: Valid Carcass
      *  - c1 AND c2 AND c3 AND c4 AND c5
      *   |- c1    : CUR.ET Error Sts is Balance
      *   |- c2    : CUR.ET Record Add/Del Sts is Blanks
      *   |- c3    : CUR.ET Record Created W/Avg is Not Created With Aver
      *   |- c4    : CUR.ET User Error Override is No
      *   |- c5    : CUR.RS Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $LD2ST    IFEQ 'B'                        *IF
     C           $LEHST    IFEQ *BLANK                     *IF
     C           $LG1ST    IFEQ *BLANK                     *IF
     C           $LJLST    IFEQ 'N'                        *IF
     C           $LAJST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL@CN,001   $LOETX           Text 25 1 USR
     C                     ELSE
      * CASE: BAL: Exception Accepted
      *  - c1 AND c2 AND c3 AND c4 AND c5
      *   |- c1    : CUR.ET Error Sts is Balance
      *   |- c2    : CUR.ET Record Add/Del Sts is Blanks
      *   |- c3    : CUR.ET Record Created W/Avg is Not Created With Aver
      *   |- c4    : CUR.ET User Error Override is Yes
      *   |- c5    : CUR.RS Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $LD2ST    IFEQ 'B'                        *IF
     C           $LEHST    IFEQ *BLANK                     *IF
     C           $LG1ST    IFEQ *BLANK                     *IF
     C           $LJLST    IFEQ 'Y'                        *IF
     C           $LAJST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WN0389           Exception Statu
     C                     MOVEL@CN,002   $LOETX           Text 25 1 USR
     C                     ELSE
      * CASE: BAL: Added At Average
      *  - c1 AND c2 AND c3 AND c4 AND c5
      *   |- c1    : CUR.ET Error Sts is Balance
      *   |- c2    : CUR.ET Record Add/Del Sts is Add
      *   |- c3    : CUR.ET Record Created W/Avg is Not Created With Aver
      *   |- c4    : CUR.ET User Error Override is No
      *   |- c5    : CUR.RS Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $LD2ST    IFEQ 'B'                        *IF
     C           $LEHST    IFEQ 'A'                        *IF
     C           $LG1ST    IFEQ *BLANK                     *IF
     C           $LJLST    IFEQ 'N'                        *IF
     C           $LAJST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL@CN,003   $LOETX           Text 25 1 USR
     C                     ELSE
      * CASE: BAL: Valid Deleted
      *  - c1 AND c2 AND c3 AND c4 AND c5
      *   |- c1    : CUR.ET Error Sts is Balance
      *   |- c2    : CUR.ET Record Add/Del Sts is Blanks
      *   |- c3    : CUR.ET Record Created W/Avg is Not Created With Aver
      *   |- c4    : CUR.ET User Error Override is No
      *   |- c5    : CUR.RS Record Status is Flag for Purge
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $LD2ST    IFEQ 'B'                        *IF
     C           $LEHST    IFEQ *BLANK                     *IF
     C           $LG1ST    IFEQ *BLANK                     *IF
     C           $LJLST    IFEQ 'N'                        *IF
     C           $LAJST    IFEQ 'D'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL@CN,004   $LOETX           Text 25 1 USR
     C                     ELSE
      * CASE: ERR: Original Carcass Replaced with Average
      *  - c1 AND c2 AND c3 AND c4 AND c5
      *   |- c1    : CUR.ET Error Sts is Error
      *   |- c2    : CUR.ET Record Add/Del Sts is Org Record OverRiden W/
      *   |- c3    : CUR.ET Record Created W/Avg is Not Created With Aver
      *   |- c4    : CUR.ET User Error Override is No
      *   |- c5    : CUR.RS Record Status is Flag for Purge
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $LD2ST    IFEQ 'E'                        *IF
     C           $LEHST    IFEQ 'O'                        *IF
     C           $LG1ST    IFEQ *BLANK                     *IF
     C           $LJLST    IFEQ 'N'                        *IF
     C           $LAJST    IFEQ 'D'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WN0389           Exception Statu
     C                     MOVEL@CN,005   $LOETX           Text 25 1 USR
     C                     ELSE
      * CASE: ERR: Exception Deleted
      *  - c1 AND c2 AND c3 AND c4 AND c5
      *   |- c1    : CUR.ET Error Sts is Error
      *   |- c2    : CUR.ET Record Add/Del Sts is Blanks
      *   |- c3    : CUR.ET Record Created W/Avg is Not Created With Aver
      *   |- c4    : CUR.ET User Error Override is No
      *   |- c5    : CUR.RS Record Status is Flag for Purge
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $LD2ST    IFEQ 'E'                        *IF
     C           $LEHST    IFEQ *BLANK                     *IF
     C           $LG1ST    IFEQ *BLANK                     *IF
     C           $LJLST    IFEQ 'N'                        *IF
     C           $LAJST    IFEQ 'D'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WN0389           Exception Statu
     C                     MOVEL@CN,006   $LOETX           Text 25 1 USR
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Replace:  Lean Percent
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : CUR.ET Backfat Thickness MM is Zero
      *   |- c2    : CUR.ET Hot Wgt is EQ Zero
      *   |- c3    : CUR.ET Loineye Depth MM is zero
      *   '-
     C           $LX8NB    IFEQ *ZERO                      *IF
     C           $LAMPC    OREQ *ZERO                      *OR
     C           $LFVPC    OREQ *ZERO                      *OR
     C                     Z-ADDP9EOPC    $LAKPC           ET Lean Percent
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0390  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0391  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0392  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0393  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0394  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0395  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0396  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0397  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0398  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0399  30       CMMR Row Number
     C                     Z-ADD*ZERO     WN0400  52       CMMR Std Dressi
     C                     Z-ADD*ZERO     WN0401  31       CMMC Lean Perce
     C                     Z-ADD*ZERO     WN0402  53       CMMC Premium Va
      *
      * Clc Carc Anal 1 Carc  IF
      * Rtv StdYld/SortDisc   RT - Carcass Merit Matrix Row  * 
     C                     EXSR TFRVGN
      * CD Base Carcass CWT  12/16/98 PKD
      * CASE: PAR.Pricing UOM USR is Live Hundred Weight
     C           'LW'      IFEQ 'LW'                       *IF
      * CASE: PAR.CMMR Std Dressing Yield% is ne 0
     C           WN0400    IFNE 0                          *IF
      * CD Base Carcass CWT
      * PAR.CD Base Carcass CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Base Mkt Price
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CMMR Std Dressing Yield%
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WN0400    DIV  100       W0WD01    H      *Synon (17,7) w
     C           $EAMPR    DIV  W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0392           CD Base Carcass
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0392           CD Base Carcass
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Pricing UOM USR is Carcass Hundred Weight
     C           'LW'      IFEQ 'CW'                       *IF
     C                     Z-ADD$EAMPR    WN0392           CD Base Carcass
     C                     END                             *FI
     C                     END                             *FI
      * CD Base Carc Value
      * PAR.CD Base Carc Value =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Base Carcass CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           $LAMPC    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0392    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0394           CD Base Carc Va
      * CAS: Calc CD Crc Value Per CWT w/ Quote Type.   08/03/95 PKP
      * CASE: PAR.CMP Sort Basis is Live
     C           WN0373    IFEQ 'L'                        *IF
      * CASE: PAR.Pricing UOM USR is Live Hundred Weight
     C           'LW'      IFEQ 'LW'                       *IF
      * CD Crc Value Per CWT
      * PAR.CD Crc Value Per CWT =
      *    *COMPUTE ((x1 + x2) / (x3 / x4))
      * x1    : PAR.TH CM Base Mkt Price
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Sort Loss
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.CMMR Std Dressing Yield%
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x4    : CON.100
     C           $EAMPR    ADD  WN0390    W0WA01           *Synon (15,2) w
     C           WN0400    DIV  100       W0WD02    H      *Synon (17,7) w
     C           W0WA01    DIV  W0WD02    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0393           CD Crc Value Pe
     C                     ELSE
      * CASE: PAR.Pricing UOM USR is Carcass Hundred Weight
     C           'LW'      IFEQ 'CW'                       *IF
      * CD Crc Value Per CWT
      * PAR.CD Crc Value Per CWT =
      *    *COMPUTE (x1 + (x2 / (x3 / x4)))
      * x1    : PAR.CD Base Carcass CWT
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Sort Loss
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : PAR.CMMR Std Dressing Yield%
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x4    : CON.100
     C           WN0400    DIV  100       W0WD02    H      *Synon (17,7) w
     C           WN0390    DIV  W0WD02    W0WB01    H      *Synon (15,5) w
     C           WN0392    ADD  W0WB01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0393           CD Crc Value Pe
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.CMP Sort Basis is Meat
     C           WN0373    IFEQ 'M'                        *IF
      * CASE: PAR.Pricing UOM USR is Live Hundred Weight
     C           'LW'      IFEQ 'LW'                       *IF
      * CD Crc Value Per CWT NEW
      * PAR.CD Crc Value Per CWT =
      *    *COMPUTE ((x1 + (x2 * (x3 / x4))) / (x5 / x6))
      * x1    : PAR.TH CM Base Mkt Price
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Sort Loss
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.CMMR Std Dressing Yield%
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x5    : PAR.CMMR Std Dressing Yield%
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x6    : CON.100
     C           WN0400    DIV  100       W0WB03    H      *Synon (15,5) w
     C           WN0390    MULT W0WB03    W0WA02    H      *Synon (15,2) w
     C           $EAMPR    ADD  W0WA02    W0WA01           *Synon (15,2) w
     C           WN0400    DIV  100       W0WB04    H      *Synon (15,5) w
     C           W0WA01    DIV  W0WB04    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0393           CD Crc Value Pe
     C                     ELSE
      * CASE: PAR.Pricing UOM USR is Carcass Hundred Weight
     C           'LW'      IFEQ 'CW'                       *IF
      * CD Crc Value Per CWT
      * PAR.CD Crc Value Per CWT =
      *    *COMPUTE (x1 + x2)
      * x1    : PAR.CD Base Carcass CWT
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Sort Loss
     C           WN0392    ADD  WN0390    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0393           CD Crc Value Pe
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.CMP Sort Basis is None
     C           WN0373    IFEQ *BLANK                     *IF
     C                     Z-ADDWN0392    WN0393           CD Crc Value Pe
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CD Crc Value $ Per Hd
      * PAR.CD Crc Value $ Per Hd =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Crc Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           $LAMPC    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0393    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0395           CD Crc Value $
      * Grade/Premium
      * CASE: PAR.CMP Grading Type is Lean Percent NPPC
     C           WN0372    IFEQ 'L'                        *IF
      * LEAN PERCENT NPPC
     C                     EXSR UNSUBR                     LEAN PERCENT NP
     C                     ELSE
      * CASE: PAR.CMP Grading Type is Lean Percent FOM
     C           WN0372    IFEQ 'P'                        *IF
      * LEAN PERCENT  FAT O METER
     C                     EXSR UOSUBR                     LEAN PERCENT  F
     C                     ELSE
      * CASE: PAR.CMP Grading Type is Backfat
     C           WN0372    IFEQ 'B'                        *IF
      * Backfat
     C                     EXSR UPSUBR                     Backfat
     C                     ELSE
      * CASE: PAR.CMP Grading Type is Lean Factor
     C           WN0372    IFEQ 'F'                        *IF
      * Lean Factor
     C                     EXSR UQSUBR                     Lean Factor
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0400    WN0391           CD STD Yield
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Print column headings if required
     C           W0CCDT    IFEQ 'Y'
     C                     WRITE$LCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0CCDT
     C                     END                             FI
      * Print format
     C                     WRITE$LDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CPDT
     C                     END                             FI
      * Print First Page Format of Prt Eval Trans Inv    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0DL1P
     C                     END                             FI
      * Print EB Company Number of Prt Eval Trans Inv    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP00
     C                     END                             FI
      * Print EB Kill Date of Prt Eval Trans Inv    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP01    ANDEQ'P'
      * Convert fields to external form
      * Convert EB Kill Date to display format
      * Convert date
     C           1000000   ADD  $RB9DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VRB9DT
      * Print format
     C                     WRITE$RKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0DCDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0DP01
     C                     END                             FI
      * Print EB Shift of Prt Eval Trans Inv    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP02
     C                     END                             FI
      * Print EB Scale Sequence Number of Prt Eval Trans Inv    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP03
     C                     END                             FI
      * Print Detail line. of Prt Eval Trans Inv    PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0DCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     MOVEL*BLANK    $SFUTX           Error Status De
      * CASE: DB1.EB Error Type is Invalid Tattoo
     C           CQIFST    IFEQ 'T'                        *IF
     C                     MOVEL@CN,007   $SFUTX           Error Status De
     C                     ELSE
      * CASE: DB1.EB Error Type is TH Proc not/Recv or Slg
     C           CQIFST    IFEQ 'P'                        *IF
     C                     MOVEL@CN,008   $SFUTX           Error Status De
     C                     ELSE
      * CASE: DB1.EB Error Type is Tattoo is Resale
     C           CQIFST    IFEQ 'R'                        *IF
     C                     MOVEL@CN,009   $SFUTX           Error Status De
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Report Type Sum/Dtl USR is Summary
     C           P3M1ST    IFEQ 'S'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Print column headings if required
     C           W0DCDT    IFEQ 'Y'
     C                     WRITE$SCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0DCDT
     C                     END                             FI
      * Print format
     C                     WRITE$SDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0DPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of Prt Hot Scl Upl Summ  PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  13        W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt Hot Scl Upl Summ  PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  7         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Prt Hot Scl Upl Summ  PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * PD Producer Code of Prt Hot Scl Upl Summ  PF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of Prt Hot Scl Upl Summ  PF
     C           W0AP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of Prt Hot Scl Upl Summ  PF
     C           W0AP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt Hot Scl Upl Summ  PF
     C           W0AP05    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line of Prt Hot Scl Upl Summ  PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Eval Trans w/FOM  PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt Eval Trans w/FOM  PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of Prt Eval Trans w/FOM  PO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of Prt Eval Trans w/FOM  PO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt Eval Trans w/FOM  PO
     C           W0BP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Prt Eval Trans w/FOM  PO
     C           W0BP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * ET Scale Sequence Number of Prt Eval Trans w/FOM  PO
     C           W0BP05    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * ET Carcass Number of Prt Eval Trans w/FOM  PO
     C           W0BP06    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * ET Carcass Number Insert of Prt Eval Trans w/FOM  PO
     C           W0BP07    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Eval Trans w/FOM  PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD3         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Eval Trans wo/FOM PO
     C           W0CP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt Eval Trans wo/FOM PO
     C           W0CP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of Prt Eval Trans wo/FOM PO
     C           W0CP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of Prt Eval Trans wo/FOM PO
     C           W0CP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt Eval Trans wo/FOM PO
     C           W0CP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Prt Eval Trans wo/FOM PO
     C           W0CP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * ET Scale Sequence Number of Prt Eval Trans wo/FOM PO
     C           W0CP05    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * ET Carcass Number of Prt Eval Trans wo/FOM PO
     C           W0CP06    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * ET Carcass Number Insert of Prt Eval Trans wo/FOM PO
     C           W0CP07    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Eval Trans wo/FOM PO
     C           W0CPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0CCDT    IFEQ 'Y'
     C                     Z-ADD3         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Eval Trans Inv    PO
     C           W0DP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * EB Company Number of Prt Eval Trans Inv    PO
     C           W0DP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * EB Kill Date of Prt Eval Trans Inv    PO
     C           W0DP01    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * EB Shift of Prt Eval Trans Inv    PO
     C           W0DP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * EB Scale Sequence Number of Prt Eval Trans Inv    PO
     C           W0DP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Eval Trans Inv    PO
     C           W0DPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0DCDT    IFEQ 'Y'
     C                     Z-ADD4         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Validation Rules  RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUI7NB           Carcass Dbw Min
     C                     Z-ADD*ZERO     WUI8NB           Carcass Dbw Max
     C                     Z-ADD*ZERO     WUI9NB           Carcass Lgt Min
     C                     Z-ADD*ZERO     WUJANB           Carcass Lgt Max
     C                     Z-ADD*ZERO     WUJBNB           %Lean High Min
     C                     Z-ADD*ZERO     WUJLNB           %Lean High Max
     C                     Z-ADD*ZERO     WUJMNB           %Lean Low Min
     C                     Z-ADD*ZERO     WUJCNB           %Lean Low Max
     C                     Z-ADD*ZERO     WUJDNB           High Yield Min
     C                     Z-ADD*ZERO     WUJENB           High Yield Max
     C                     Z-ADD*ZERO     WUJFNB           Low Yield Min
     C                     Z-ADD*ZERO     WUJGNB           Low Yield Max
     C                     Z-ADD*ZERO     WUJHNB           Head < Percent
     C                     Z-ADD*ZERO     WUJINB           Head < Percent
     C                     Z-ADD*ZERO     WUJJNB           Head > Percent
     C                     Z-ADD*ZERO     WUJKNB           Head > Percent
     C                     Z-ADD*ZERO     WUK5NB           BackFat High Mi
     C                     Z-ADD*ZERO     WUK6NB           BackFat High Ma
     C                     Z-ADD*ZERO     WUK7NB           BackFat Low Min
     C                     Z-ADD*ZERO     WUK8NB           Backfat Low Max
     C                     Z-ADD*ZERO     WUK9NB           LoinEye High Mi
     C                     Z-ADD*ZERO     WULANB           LoinEye High Ma
     C                     Z-ADD*ZERO     WULBNB           LoinEye Low Min
     C                     Z-ADD*ZERO     WULCNB           LoinEye Low Max
      * Establish starting position
     C           *LOVAL    SETLL@BOREFN                    *
     C                     READ @BOREFN                  90*
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.EV Validation Code is Carcass has Double Weight
     C           BOBVCD    IFEQ 'CDB'                      *IF
      * Carcass double weight
     C                     Z-ADDBOAFPC    WUI7NB           Carcass Dbw Min
     C                     Z-ADDBOAGPC    WUI8NB           Carcass Dbw Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Carcass is Light Weight
     C           BOBVCD    IFEQ 'CLT'                      *IF
      * Carcass light weight
     C                     Z-ADDBOAFPC    WUI9NB           Carcass Lgt Min
     C                     Z-ADDBOAGPC    WUJANB           Carcass Lgt Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Backfat is high
     C           BOBVCD    IFEQ 'BHI'                      *IF
      * backfat is high
     C                     Z-ADDBOAFPC    WUK5NB           BackFat High Mi
     C                     Z-ADDBOAGPC    WUK6NB           BackFat High Ma
     C                     ELSE
      * CASE: DB1.EV Validation Code is Backfat is Low
     C           BOBVCD    IFEQ 'BLW'                      *IF
      * Backfat is low
     C                     Z-ADDBOAFPC    WUK7NB           BackFat Low Min
     C                     Z-ADDBOAGPC    WUK8NB           Backfat Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Loineye is High
     C           BOBVCD    IFEQ 'LHI'                      *IF
      * loineye is high
     C                     Z-ADDBOAFPC    WUK9NB           LoinEye High Mi
     C                     Z-ADDBOAGPC    WULANB           LoinEye High Ma
     C                     ELSE
      * CASE: DB1.EV Validation Code is Loineye is Low
     C           BOBVCD    IFEQ 'LLW'                      *IF
      * loineye is low
     C                     Z-ADDBOAFPC    WULBNB           LoinEye Low Min
     C                     Z-ADDBOAGPC    WULCNB           LoinEye Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Percent Lean is high
     C           BOBVCD    IFEQ 'PLH'                      *IF
      * % Lean High
     C                     Z-ADDBOAFPC    WUJBNB           %Lean High Min
     C                     Z-ADDBOAGPC    WUJLNB           %Lean High Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Percent Lean is Low
     C           BOBVCD    IFEQ 'PLL'                      *IF
      * % Lean Low
     C                     Z-ADDBOAFPC    WUJMNB           %Lean Low Min
     C                     Z-ADDBOAGPC    WUJCNB           %Lean Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is #Head is < % Allowed
     C           BOBVCD    IFEQ 'HLP'                      *IF
      * Head < Percent
     C                     Z-ADDBOAFPC    WUJHNB           Head < Percent
     C                     Z-ADDBOAGPC    WUJINB           Head < Percent
     C                     ELSE
      * CASE: DB1.EV Validation Code is #Head is > % Allowed
     C           BOBVCD    IFEQ 'HHP'                      *IF
      * Head > Percent
     C                     Z-ADDBOAFPC    WUJJNB           Head > Percent
     C                     Z-ADDBOAGPC    WUJKNB           Head > Percent
     C                     ELSE
      * CASE: DB1.EV Validation Code is Yield Amount is High
     C           BOBVCD    IFEQ 'YHI'                      *IF
      * Yield High
     C                     Z-ADDBOAFPC    WUJDNB           High Yield Min
     C                     Z-ADDBOAGPC    WUJENB           High Yield Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Yield Amount is Low
     C           BOBVCD    IFEQ 'YLW'                      *IF
      * Yield Low
     C                     Z-ADDBOAFPC    WUJFNB           Low Yield Min
     C                     Z-ADDBOAGPC    WUJGNB           Low Yield Max
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @BOREFN                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Producer Name     RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVEL$BABCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSSB     CHAIN@ACREAI              90    *
      * Data record not found
     C   90                MOVEL'PRK0009' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELACAGTX    $BA4TX           PD Name
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Prt Hot Scl Upl Summ  RT - Eval Trans UPL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     $ELFNB           TDE Head Condem
     C                     Z-ADD*ZERO     $ELINB           Head 2
     C                     Z-ADD*ZERO     $EMWNB           Trim Head 1 USR
     C                     Z-ADD*ZERO     $EJONB           Hot Wgt/Lean %
     C                     Z-ADD*ZERO     $EL0NB           Hot Wgt/Backf A
     C                     Z-ADD*ZERO     $EL1NB           Hot Wgt/Loine A
     C                     Z-ADD*ZERO     YL0001           Hot Wgt/LghtR A
     C                     Z-ADD*ZERO     $EKGNB           Hot Weight Tot
     C                     Z-ADD*ZERO     YL0002           Head No Probe U
      * Declare restrictor key work fields
     C           *LIKE     DEFN CPHKST    WQSC01           EA Company Numb
     C           *LIKE     DEFN CPKHNB    WQSC02           EA Tattoo Numbe
     C           *LIKE     DEFN CPB7DT    WQSC03           EA Kill Date
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           EA Company Numb
     C                     KFLD           WQSC02           EA Tattoo Numbe
     C                     KFLD           WQSC03           EA Kill Date
      * Setup key
     C                     Z-ADDA1HMNB    WQSC01           EA Company Numb
     C                     Z-ADDA1CVNB    WQSC02           EA Tattoo Numbe
     C                     Z-ADDA1B0DT    WQSC03           EA Kill Date
      * Establish starting position
     C           KRSSC     SETLL@CPCPCI                    *
     C           KRSSC     READE@CPCPCI                  90*
      * Data record not found
     C   90                MOVEL'PRK0341' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WUD2ST           ET Error Sts
      * COMPUTE LEAN % Morrison Hot Scale
     C                     EXSR UBSUBR                     COMPUTE LEAN %
      * Validate Hot Weight
      * CASE: DB1.EA Hot Weight LE PAR.Carcass Lgt Max
     C           CPKJNB    IFLE WUJANB                     *IF
      * Carcass Light Weight Error
     C                     MOVEL'CLT'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     ELSE
      * CASE: DB1.EA Hot Weight GE PAR.Carcass Dbw Min
     C           CPKJNB    IFGE WUI7NB                     *IF
     C                     MOVEL'CDB'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     END                             *FI
     C                     END                             *FI
      * Validate Backfat
      * CASE: DB1.EA Backfat Thickness Inch LE PAR.Backfat Low Max
     C           CPKKNB    IFLE WUK8NB                     *IF
      * backfat to low  Error
     C                     MOVEL'BLW'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     ELSE
      * CASE: DB1.EA Backfat Thickness Inch GE PAR.BackFat High Min
     C           CPKKNB    IFGE WUK5NB                     *IF
      * backfat high error
     C                     MOVEL'BHI'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     END                             *FI
     C                     END                             *FI
      * Validate Loineye
      * CASE: DB1.EA Loin-Eye Depth Inches LE PAR.LoinEye Low Max
     C           CPBQPC    IFLE WULCNB                     *IF
      * Loin eye  Light Error
     C                     MOVEL'LLW'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     ELSE
      * CASE: DB1.EA Loin-Eye Depth Inches GE PAR.LoinEye High Min
     C           CPBQPC    IFGE WUK9NB                     *IF
      * Loin eye  High Error
     C                     MOVEL'LHI'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     END                             *FI
     C                     END                             *FI
      * Validate  % Lean
      * CASE: WRK.ET Lean Percent NPPC LE PAR.%Lean Low Max
     C           WUAKPC    IFLE WUJCNB                     *IF
      * % Lean low  Error
     C                     MOVEL'PLL'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     ELSE
      * CASE: WRK.ET Lean Percent NPPC GE PAR.%Lean High Min
     C           WUAKPC    IFGE WUJBNB                     *IF
      * % Lean High Error
     C                     MOVEL'PLH'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     END                             *FI
     C                     END                             *FI
      * Trimmed Carcasses
      * CASE: DB1.EA Trim Area NE WRK.Blank USR
     C           CPHMST    IFNE WUCRTX                     *IF
     C                     ADD  1         $EMWNB           Trim Head 1 USR
     C                     END                             *FI
      * Valid/Exception Carcasses
      * CASE: WRK.ET Error Sts is Error
     C           WUD2ST    IFEQ 'E'                        *IF
      * Exception Carcasses
      * Positive FOM Reading
      * CASE: Hot Weight, Back Fat, Loin Eye > 0
      *  - c1 AND c2 AND c3
      *   |- c1    : DB1.EA Hot Weight is Not Zero
      *   |- c2    : DB1.EA Backfat Thickness Inch is GT Zero
      *   |- c3    : DB1.EA Loin-Eye Depth Inches is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           CPKJNB    IFNE 0                          *IF
     C           CPKKNB    IFGT 0                          *IF
     C           CPBQPC    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  1         $ELINB           Head 2
      * CASE: PAR.Payment Data Type USR is Eval Trans UPL Excep
     C           P3T5ST    IFEQ 'UE'                       *IF
      *
     C                     Z-ADD*ZERO     WN0001  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0002  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0003  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0004  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0005  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0006  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0007  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0008  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0009  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0010  72       CD Gross Value
     C                     MOVEL*BLANK    WN0011  1        CD Carcass Acti
     C                     MOVEL*BLANK    WN0012  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN0013  31       CD FFLI
     C                     MOVEL*BLANK    WN0014  1        CD Record Creat
     C                     MOVEL*BLANK    WN0015  1        CD Record Creat
     C                     Z-ADD*ZERO     WN0016  50       CD LOT
     C                     MOVEL*BLANK    WN0017  1        CD User Error O
     C                     Z-ADD*ZERO     WN0018  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0019  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN0020  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0021  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0022  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0023  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0024  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0025  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0026  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0027  72       CD CA Gross Val
     C                     MOVEL*BLANK    WN0028  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN0029  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN0030  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN0031  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN0032  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN0033  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN0034  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0035  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN0036  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN0037  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0038  72       CD Gross Before
     C                     Z-ADD*ZERO     WN0039  72       CD Gross Before
     C                     MOVEL*BLANK    WN0040  1        CD Broken Back
     C                     MOVEL*BLANK    WN0041  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN0042  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN0043  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN0044  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN0045 10        RS User Changed
     C                     Z-ADD*ZERO     WN0046  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0047  60       RS Time Changed
     C                     MOVEL*BLANK    WN0048  1        RS Record Statu
     C                     MOVEL*BLANK    WN0049 10        RS Job
     C                     MOVEL*BLANK    WN0050 10        RS Program
     C                     MOVEL*BLANK    WN0051 10        RS User Added
     C                     Z-ADD*ZERO     WN0052  70       RS Date Added
     C                     Z-ADD*ZERO     WN0053  60       RS Time Added
      *
      * Crt Crc HotSclUpl Sum IF
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR SDCRRC
     C                     END                             *FI
      * CASE: PAR.Analysis Type USR is Eval Trans UPL Excep
     C           P3T6ST    IFEQ 'UE'                       *IF
      * Accumulation
     C                     EXSR UCSUBR                     Accumulation
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         YL0002           Head No Probe U
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Valid Carcasses
     C                     ADD  1         $ELFNB           TDE Head Condem
      * CASE: PAR.Payment Data Type USR is Eval Trans UPL Valid
     C           P3T5ST    IFEQ 'UV'                       *IF
      *
     C                     Z-ADD*ZERO     WN0054  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0055  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0056  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0057  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0058  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0059  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0060  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0061  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0062  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0063  72       CD Gross Value
     C                     MOVEL*BLANK    WN0064  1        CD Carcass Acti
     C                     MOVEL*BLANK    WN0065  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN0066  31       CD FFLI
     C                     MOVEL*BLANK    WN0067  1        CD Record Creat
     C                     MOVEL*BLANK    WN0068  1        CD Record Creat
     C                     Z-ADD*ZERO     WN0069  50       CD LOT
     C                     MOVEL*BLANK    WN0070  1        CD User Error O
     C                     Z-ADD*ZERO     WN0071  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0072  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN0073  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0074  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0075  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0076  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0077  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0078  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0079  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0080  72       CD CA Gross Val
     C                     MOVEL*BLANK    WN0081  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN0082  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN0083  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN0084  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN0085  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN0086  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN0087  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0088  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN0089  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN0090  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0091  72       CD Gross Before
     C                     Z-ADD*ZERO     WN0092  72       CD Gross Before
     C                     MOVEL*BLANK    WN0093  1        CD Broken Back
     C                     MOVEL*BLANK    WN0094  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN0095  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN0096  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN0097  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN0098 10        RS User Changed
     C                     Z-ADD*ZERO     WN0099  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0100  60       RS Time Changed
     C                     MOVEL*BLANK    WN0101  1        RS Record Statu
     C                     MOVEL*BLANK    WN0102 10        RS Job
     C                     MOVEL*BLANK    WN0103 10        RS Program
     C                     MOVEL*BLANK    WN0104 10        RS User Added
     C                     Z-ADD*ZERO     WN0105  70       RS Date Added
     C                     Z-ADD*ZERO     WN0106  60       RS Time Added
      *
      * Crt Crc HotSclUpl Sum IF
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR SECRRC
     C                     END                             *FI
      * CASE: PAR.Analysis Type USR is Eval Trans UPL Valid
     C           P3T6ST    IFEQ 'UV'                       *IF
      * Accumulation
     C                     EXSR UDSUBR                     Accumulation
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSC     READE@CPCPCI                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADD$EHMNB    B1HMNB           BOH Company Num
     C                     Z-ADD$EBNNB    B1BNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    B1BONB           BOL Load Number
     C                     Z-ADD$ECVNB    B1CVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    B1B0DT           TH Kill Date
     C                     Z-ADDCPKINB    B1LGNB           CD Scale Sequen
     C                     Z-ADDCPKINB    B1EUNB           CD Carcass Numb
     C                     Z-ADD1         B1LHNB           CD Carcass Numb
     C                     MOVEL*BLANK    B1INST           CD Record Add/D
     C                     Z-ADDWN0001    B1BEPR           CD Sort Loss
     C                     Z-ADDWN0002    B1ASPC           CD STD Yield
     C                     Z-ADDCPKJNB    B1EWNB           CD Carcass/Hot
     C                     Z-ADDWN0003    B1B4PR           CD Base Carcass
     C                     Z-ADDWN0004    B1EYNB           CD Crc Value Pe
     C                     Z-ADDWN0005    B1B1PR           CD Base Carc Va
     C                     Z-ADDWN0006    B1AVPR           CD Crc Value $
     C                     Z-ADDWUAKPC    B1AUPC           CD Lean Percent
     C                     Z-ADDWN0007    B1AWPR           CD Lean Premium
     C                     Z-ADDWN0008    B1AXPR           CD Lean Premium
     C                     Z-ADDWN0009    B1EZNB           CD Gross Value
     C                     Z-ADDWN0010    B1AYPR           CD Gross Value
     C                     Z-ADDCPB7DT    B1BBDT           CD Kill Date
     C                     Z-ADDCPAOTM    B1AKTM           CD Kill Time
     C                     MOVELWUIQST    B1IQST           CD Shift
     C                     MOVELWN0011    B1EFST           CD Carcass Acti
     C                     Z-ADDCPKKNB    B1H6NB           CD Backfat Thic
     C                     Z-ADDCPBQPC    B1BEPC           CD Loin-Eye Dep
     C                     Z-ADDCPBRPC    B1GCST           CD Light Reflec
     C                     MOVELCPHMST    B1GDST           CD Trim Area
     C                     MOVELWN0012    B1GEST           CD Carcass Sex
     C                     Z-ADDWN0013    B1BHPC           CD FFLI
     C                     MOVELWN0014    B1IOST           CD Record Creat
     C                     MOVELWN0015    B1IPST           CD Record Creat
     C                     Z-ADDWN0016    B1LTNB           CD LOT
     C                     MOVELWN0017    B1JNST           CD User Error O
     C                     Z-ADDCPX6NB    B1X4NB           CD Backfat Thic
     C                     Z-ADDCPFQPC    B1FNPC           CD Loin-Eye Dep
     C                     Z-ADDCPFRPC    B1FOPC           CD Light Reflec
     C                     Z-ADD*ZERO     B1FPPC           CD Lean Percent
     C                     MOVEL$EKAST    B1K2ST           CD Source Type
     C                     MOVEL$EJ9ST    B1K3ST           CD Payment Type
     C                     Z-ADDWN0018    B1JWPR           CD CA Sort Loss
     C                     Z-ADDWN0019    B1F5PC           CD CA Std Yield
     C                     Z-ADDWN0020    B1JXPR           CD CA Base Carc
     C                     Z-ADDWN0021    B1JYPR           CD CA Crc Value
     C                     Z-ADDWN0022    B1JZPR           CD CA Base Carc
     C                     Z-ADDWN0023    B1J0PR           CD CA Crc Value
     C                     Z-ADDWN0024    B1J1PR           CD CA Lean Prem
     C                     Z-ADDWN0025    B1J2PR           CD CA Lean Prem
     C                     Z-ADDWN0026    B1J3PR           CD CA Gross Val
     C                     Z-ADDWN0027    B1J4PR           CD CA Gross Val
     C                     MOVELWN0028    B1UTST           CD Adjust/Add T
     C                     MOVELWN0029    B1HVCD           CD Producer Loc
     C                     Z-ADDWN0030    B1DKJR           CD Loin Eye Inc
     C                     Z-ADDWN0031    B1ITJF           CD Backfat Inch
     C                     Z-ADDWN0032    B1IJGR           CD Meat Value F
     C                     Z-ADDWN0033    B1ORJE           CD Lean Prem/Di
     C                     Z-ADDWN0034    B1OTJR           CD Fixed Cost F
     C                     Z-ADDWN0035    B1PEIR           CD MPR Sort Los
     C                     Z-ADDWN0036    B1IEUF           CD Meat Value F
     C                     Z-ADDWN0037    B1ORUE           CD Fixed Cost F
     C                     Z-ADDWN0038    B1IUTR           CD Gross Before
     C                     Z-ADDWN0039    B1IJRR           CD Gross Before
     C                     MOVELWN0040    B1VCST           CD Broken Back
     C                     MOVELWN0041    B1VDST           CD Adjust/Add S
     C                     MOVELWN0042    B1VEST           CD Unused Sts 3
     C                     MOVELWN0043    B1VFST           CD Unused Sts 4
     C                     MOVELWN0044    B1VGST           CD Unused Sts 5
     C                     MOVEL$EABCD    B1ABCD           PD Producer Cod
     C                     MOVEL$ELKST    B1AACD           SR Source Code
     C                     MOVELWN0045    B1AAVN           RS User Changed
     C                     Z-ADDWN0046    B1AADT           RS Date Changed
     C                     Z-ADDWN0047    B1AMTM           RS Time Changed
     C                     MOVELWN0048    B1AJST           RS Record Statu
     C                     MOVELWN0049    B1AHVN           RS Job
     C                     MOVELWN0050    B1AGVN           RS Program
     C                     MOVELWN0051    B1ABVN           RS User Added
     C                     Z-ADDWN0052    B1ABDT           RS Date Added
     C                     Z-ADDWN0053    B1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       B1AJST           RS Record Statu
     C                     MOVEL##USR     B1ABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           B1ABDT    PARM *ZERO     WQ0004  70       *DATE
     C           B1ABTM    PARM *ZERO     WQ0005  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     B1AGVN           RS Program
     C                     MOVEL##JOB     B1AHVN           RS Job
     C           KLCRSD    KLIST
     C                     KFLD           B1HMNB           BOH Company Num
     C                     KFLD           B1BNNB           BOH Buy Order N
     C                     KFLD           B1BONB           BOL Load Number
     C                     KFLD           B1CVNB           TH Tattoo Numbe
     C                     KFLD           B1B0DT           TH Kill Date
     C                     KFLD           B1LGNB           CD Scale Sequen
     C                     KFLD           B1EUNB           CD Carcass Numb
     C                     KFLD           B1LHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRSD    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADD$EHMNB    B1HMNB           BOH Company Num
     C                     Z-ADD$EBNNB    B1BNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    B1BONB           BOL Load Number
     C                     Z-ADD$ECVNB    B1CVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    B1B0DT           TH Kill Date
     C                     Z-ADDCPKINB    B1LGNB           CD Scale Sequen
     C                     Z-ADDCPKINB    B1EUNB           CD Carcass Numb
     C                     Z-ADD1         B1LHNB           CD Carcass Numb
     C                     MOVEL*BLANK    B1INST           CD Record Add/D
     C                     Z-ADDWN0054    B1BEPR           CD Sort Loss
     C                     Z-ADDWN0055    B1ASPC           CD STD Yield
     C                     Z-ADDCPKJNB    B1EWNB           CD Carcass/Hot
     C                     Z-ADDWN0056    B1B4PR           CD Base Carcass
     C                     Z-ADDWN0057    B1EYNB           CD Crc Value Pe
     C                     Z-ADDWN0058    B1B1PR           CD Base Carc Va
     C                     Z-ADDWN0059    B1AVPR           CD Crc Value $
     C                     Z-ADDWUAKPC    B1AUPC           CD Lean Percent
     C                     Z-ADDWN0060    B1AWPR           CD Lean Premium
     C                     Z-ADDWN0061    B1AXPR           CD Lean Premium
     C                     Z-ADDWN0062    B1EZNB           CD Gross Value
     C                     Z-ADDWN0063    B1AYPR           CD Gross Value
     C                     Z-ADDCPB7DT    B1BBDT           CD Kill Date
     C                     Z-ADDCPAOTM    B1AKTM           CD Kill Time
     C                     MOVELWUIQST    B1IQST           CD Shift
     C                     MOVELWN0064    B1EFST           CD Carcass Acti
     C                     Z-ADDCPKKNB    B1H6NB           CD Backfat Thic
     C                     Z-ADDCPBQPC    B1BEPC           CD Loin-Eye Dep
     C                     Z-ADDCPBRPC    B1GCST           CD Light Reflec
     C                     MOVELCPHMST    B1GDST           CD Trim Area
     C                     MOVELWN0065    B1GEST           CD Carcass Sex
     C                     Z-ADDWN0066    B1BHPC           CD FFLI
     C                     MOVELWN0067    B1IOST           CD Record Creat
     C                     MOVELWN0068    B1IPST           CD Record Creat
     C                     Z-ADDWN0069    B1LTNB           CD LOT
     C                     MOVELWN0070    B1JNST           CD User Error O
     C                     Z-ADDCPX6NB    B1X4NB           CD Backfat Thic
     C                     Z-ADDCPFQPC    B1FNPC           CD Loin-Eye Dep
     C                     Z-ADDCPFRPC    B1FOPC           CD Light Reflec
     C                     Z-ADD*ZERO     B1FPPC           CD Lean Percent
     C                     MOVEL$EKAST    B1K2ST           CD Source Type
     C                     MOVEL$EJ9ST    B1K3ST           CD Payment Type
     C                     Z-ADDWN0071    B1JWPR           CD CA Sort Loss
     C                     Z-ADDWN0072    B1F5PC           CD CA Std Yield
     C                     Z-ADDWN0073    B1JXPR           CD CA Base Carc
     C                     Z-ADDWN0074    B1JYPR           CD CA Crc Value
     C                     Z-ADDWN0075    B1JZPR           CD CA Base Carc
     C                     Z-ADDWN0076    B1J0PR           CD CA Crc Value
     C                     Z-ADDWN0077    B1J1PR           CD CA Lean Prem
     C                     Z-ADDWN0078    B1J2PR           CD CA Lean Prem
     C                     Z-ADDWN0079    B1J3PR           CD CA Gross Val
     C                     Z-ADDWN0080    B1J4PR           CD CA Gross Val
     C                     MOVELWN0081    B1UTST           CD Adjust/Add T
     C                     MOVELWN0082    B1HVCD           CD Producer Loc
     C                     Z-ADDWN0083    B1DKJR           CD Loin Eye Inc
     C                     Z-ADDWN0084    B1ITJF           CD Backfat Inch
     C                     Z-ADDWN0085    B1IJGR           CD Meat Value F
     C                     Z-ADDWN0086    B1ORJE           CD Lean Prem/Di
     C                     Z-ADDWN0087    B1OTJR           CD Fixed Cost F
     C                     Z-ADDWN0088    B1PEIR           CD MPR Sort Los
     C                     Z-ADDWN0089    B1IEUF           CD Meat Value F
     C                     Z-ADDWN0090    B1ORUE           CD Fixed Cost F
     C                     Z-ADDWN0091    B1IUTR           CD Gross Before
     C                     Z-ADDWN0092    B1IJRR           CD Gross Before
     C                     MOVELWN0093    B1VCST           CD Broken Back
     C                     MOVELWN0094    B1VDST           CD Adjust/Add S
     C                     MOVELWN0095    B1VEST           CD Unused Sts 3
     C                     MOVELWN0096    B1VFST           CD Unused Sts 4
     C                     MOVELWN0097    B1VGST           CD Unused Sts 5
     C                     MOVEL$EABCD    B1ABCD           PD Producer Cod
     C                     MOVEL$ELKST    B1AACD           SR Source Code
     C                     MOVELWN0098    B1AAVN           RS User Changed
     C                     Z-ADDWN0099    B1AADT           RS Date Changed
     C                     Z-ADDWN0100    B1AMTM           RS Time Changed
     C                     MOVELWN0101    B1AJST           RS Record Statu
     C                     MOVELWN0102    B1AHVN           RS Job
     C                     MOVELWN0103    B1AGVN           RS Program
     C                     MOVELWN0104    B1ABVN           RS User Added
     C                     Z-ADDWN0105    B1ABDT           RS Date Added
     C                     Z-ADDWN0106    B1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       B1AJST           RS Record Statu
     C                     MOVEL##USR     B1ABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           B1ABDT    PARM *ZERO     WQ0006  70       *DATE
     C           B1ABTM    PARM *ZERO     WQ0007  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     B1AGVN           RS Program
     C                     MOVEL##JOB     B1AHVN           RS Job
     C           KLCRSE    KLIST
     C                     KFLD           B1HMNB           BOH Company Num
     C                     KFLD           B1BNNB           BOH Buy Order N
     C                     KFLD           B1BONB           BOL Load Number
     C                     KFLD           B1CVNB           TH Tattoo Numbe
     C                     KFLD           B1B0DT           TH Kill Date
     C                     KFLD           B1LGNB           CD Scale Sequen
     C                     KFLD           B1EUNB           CD Carcass Numb
     C                     KFLD           B1LHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRSE    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Prt Hot Scl Upl Summ  RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BVHMNB    WQSF01           BOH Company Num
     C           *LIKE     DEFN BVBNNB    WQSF02           BOH Buy Order N
     C           *LIKE     DEFN BVBONB    WQSF03           BOL Load Number
     C           *LIKE     DEFN BVCVNB    WQSF04           TH Tattoo Numbe
     C           *LIKE     DEFN BVB0DT    WQSF05           TH Kill Date
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           BOH Company Num
     C                     KFLD           WQSF02           BOH Buy Order N
     C                     KFLD           WQSF03           BOL Load Number
     C                     KFLD           WQSF04           TH Tattoo Numbe
     C                     KFLD           WQSF05           TH Kill Date
      * Setup key
     C                     Z-ADD$EHMNB    WQSF01           BOH Company Num
     C                     Z-ADD$EBNNB    WQSF02           BOH Buy Order N
     C                     Z-ADD$EBONB    WQSF03           BOL Load Number
     C                     Z-ADD$ECVNB    WQSF04           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    WQSF05           TH Kill Date
      * Establish starting position
     C           KRSSF     SETLL@BVCPQ9                    *
     C           KRSSF     READE@BVCPQ9                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Add Average Adds
      * CASE: DB1.ET Record Add/Del Sts is Add
     C           BVEHST    IFEQ 'A'                        *IF
     C                     ADD  1         WULKIR           Head 6
     C                     END                             *FI
      * CASE: DB1.RS Record Status is Active
     C           BVAJST    IFEQ 'A'                        *IF
      * CASE: DB1.ET Record Add/Del Sts is Add
     C           BVEHST    IFEQ 'A'                        *IF
      * Added Carcasses
     C                     ADD  1         $EHD3C           Head 3
      * CASE: PAR.Payment Data Type USR is Eval Trans Adds
     C           P3T5ST    IFEQ 'EA'                       *IF
      *
     C                     Z-ADD*ZERO     WN0107  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0108  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0109  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0110  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0111  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0112  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0113  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0114  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0115  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0116  72       CD Gross Value
     C                     MOVEL*BLANK    WN0117  1        CD Carcass Acti
     C                     MOVEL*BLANK    WN0118  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN0119  31       CD FFLI
     C                     MOVEL*BLANK    WN0120  1        CD Record Creat
     C                     MOVEL*BLANK    WN0121  1        CD Record Creat
     C                     Z-ADD*ZERO     WN0122  50       CD LOT
     C                     MOVEL*BLANK    WN0123  1        CD User Error O
     C                     Z-ADD*ZERO     WN0124  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0125  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN0126  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0127  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0128  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0129  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0130  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0131  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0132  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0133  72       CD CA Gross Val
     C                     MOVEL*BLANK    WN0134  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN0135  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN0136  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN0137  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN0138  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN0139  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN0140  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0141  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN0142  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN0143  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0144  72       CD Gross Before
     C                     Z-ADD*ZERO     WN0145  72       CD Gross Before
     C                     MOVEL*BLANK    WN0146  1        CD Broken Back
     C                     MOVEL*BLANK    WN0147  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN0148  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN0149  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN0150  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN0151 10        RS User Changed
     C                     Z-ADD*ZERO     WN0152  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0153  60       RS Time Changed
     C                     MOVEL*BLANK    WN0154  1        RS Record Statu
     C                     MOVEL*BLANK    WN0155 10        RS Job
     C                     MOVEL*BLANK    WN0156 10        RS Program
     C                     MOVEL*BLANK    WN0157 10        RS User Added
     C                     Z-ADD*ZERO     WN0158  70       RS Date Added
     C                     Z-ADD*ZERO     WN0159  60       RS Time Added
      *
      * Crt Crc HotSclUpl Sum IF
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR SGCRRC
     C                     END                             *FI
      * CASE: PAR.Analysis Type USR is Eval Trans Adds
     C           P3T6ST    IFEQ 'EA'                       *IF
      * Accumulation
     C                     EXSR UESUBR                     Accumulation
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.ET Record Add/Del Sts is Delete
     C           BVEHST    IFEQ 'D'                        *IF
      * Flagged for Delete
     C                     ADD  1         $EHD4C           Head 4
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Deleted/Inactive
      * CASE: DB1.RS Record Status is Flag for Purge
     C           BVAJST    IFEQ 'D'                        *IF
      * CASE: DB1.ET Record Add/Del Sts is Not Original Record
     C           BVEHST    IFEQ 'A'                        *IF
     C           BVEHST    OREQ *BLANK
     C           BVEHST    OREQ 'D'
      * CASE: DB1.ET Error Sts is Balance
     C           BVD2ST    IFEQ 'B'                        *IF
      * Valid Deleted
     C                     ADD  1         $EHD4C           Head 4
      * CASE: PAR.Payment Data Type USR is Eval Trans Valid Deletes
     C           P3T5ST    IFEQ 'EV'                       *IF
      *
     C                     Z-ADD*ZERO     WN0160  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0161  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0162  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0163  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0164  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0165  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0166  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0167  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0168  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0169  72       CD Gross Value
     C                     MOVEL*BLANK    WN0170  1        CD Carcass Acti
     C                     MOVEL*BLANK    WN0171  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN0172  31       CD FFLI
     C                     MOVEL*BLANK    WN0173  1        CD Record Creat
     C                     MOVEL*BLANK    WN0174  1        CD Record Creat
     C                     Z-ADD*ZERO     WN0175  50       CD LOT
     C                     MOVEL*BLANK    WN0176  1        CD User Error O
     C                     Z-ADD*ZERO     WN0177  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0178  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN0179  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0180  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0181  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0182  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0183  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0184  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0185  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0186  72       CD CA Gross Val
     C                     MOVEL*BLANK    WN0187  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN0188  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN0189  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN0190  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN0191  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN0192  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN0193  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0194  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN0195  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN0196  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0197  72       CD Gross Before
     C                     Z-ADD*ZERO     WN0198  72       CD Gross Before
     C                     MOVEL*BLANK    WN0199  1        CD Broken Back
     C                     MOVEL*BLANK    WN0200  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN0201  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN0202  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN0203  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN0204 10        RS User Changed
     C                     Z-ADD*ZERO     WN0205  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0206  60       RS Time Changed
     C                     MOVEL*BLANK    WN0207  1        RS Record Statu
     C                     MOVEL*BLANK    WN0208 10        RS Job
     C                     MOVEL*BLANK    WN0209 10        RS Program
     C                     MOVEL*BLANK    WN0210 10        RS User Added
     C                     Z-ADD*ZERO     WN0211  70       RS Date Added
     C                     Z-ADD*ZERO     WN0212  60       RS Time Added
      *
      * Crt Crc HotSclUpl Sum IF
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR SHCRRC
     C                     END                             *FI
      * CASE: PAR.Analysis Type USR is Eval Trans Valid Deletes
     C           P3T6ST    IFEQ 'EV'                       *IF
      * Accumulation
     C                     EXSR UFSUBR                     Accumulation
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Exceptions Deleted
     C                     ADD  1         $EHD5C           Head 5
      * Positive FOM Reading
      * CASE: Hot Wgt, Backfat, Loin Eye, Lean% > 0
      *  - c1 AND c2 AND c3 AND c4
      *   |- c1    : DB1.ET Hot Wgt is Not Zero
      *   |- c2    : DB1.ET Backfat Thickness Inch is GT Zero
      *   |- c3    : DB1.ET Loin-Eye Depth Inches is GT Zero
      *   |- c4    : DB1.ET Lean Percent NPPC is Greater than 0
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           BVAMPC    IFNE 0                          *IF
     C           BVAIPC    IFGT 0                          *IF
     C           BVAJPC    IFGT 0                          *IF
     C           BVAKPC    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: PAR.Payment Data Type USR is Eval Trans Excep Deletes
     C           P3T5ST    IFEQ 'EE'                       *IF
      *
     C                     Z-ADD*ZERO     WN0213  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0214  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0215  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0216  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0217  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0218  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0219  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0220  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0221  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0222  72       CD Gross Value
     C                     MOVEL*BLANK    WN0223  1        CD Carcass Acti
     C                     MOVEL*BLANK    WN0224  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN0225  31       CD FFLI
     C                     MOVEL*BLANK    WN0226  1        CD Record Creat
     C                     MOVEL*BLANK    WN0227  1        CD Record Creat
     C                     Z-ADD*ZERO     WN0228  50       CD LOT
     C                     MOVEL*BLANK    WN0229  1        CD User Error O
     C                     Z-ADD*ZERO     WN0230  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0231  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN0232  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0233  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0234  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0235  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0236  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0237  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0238  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0239  72       CD CA Gross Val
     C                     MOVEL*BLANK    WN0240  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN0241  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN0242  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN0243  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN0244  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN0245  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN0246  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0247  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN0248  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN0249  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0250  72       CD Gross Before
     C                     Z-ADD*ZERO     WN0251  72       CD Gross Before
     C                     MOVEL*BLANK    WN0252  1        CD Broken Back
     C                     MOVEL*BLANK    WN0253  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN0254  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN0255  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN0256  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN0257 10        RS User Changed
     C                     Z-ADD*ZERO     WN0258  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0259  60       RS Time Changed
     C                     MOVEL*BLANK    WN0260  1        RS Record Statu
     C                     MOVEL*BLANK    WN0261 10        RS Job
     C                     MOVEL*BLANK    WN0262 10        RS Program
     C                     MOVEL*BLANK    WN0263 10        RS User Added
     C                     Z-ADD*ZERO     WN0264  70       RS Date Added
     C                     Z-ADD*ZERO     WN0265  60       RS Time Added
      *
      * Crt Crc HotSclUpl Sum IF
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR SICRRC
     C                     END                             *FI
      * CASE: PAR.Analysis Type USR is Eval Trans Excep Deletes
     C           P3T6ST    IFEQ 'EE'                       *IF
      * Accumulation
     C                     EXSR UGSUBR                     Accumulation
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSF     READE@BVCPQ9                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADD$EHMNB    B1HMNB           BOH Company Num
     C                     Z-ADD$EBNNB    B1BNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    B1BONB           BOL Load Number
     C                     Z-ADD$ECVNB    B1CVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    B1B0DT           TH Kill Date
     C                     Z-ADDBVFJNB    B1LGNB           CD Scale Sequen
     C                     Z-ADDBVHCNB    B1EUNB           CD Carcass Numb
     C                     Z-ADD1         B1LHNB           CD Carcass Numb
     C                     MOVEL*BLANK    B1INST           CD Record Add/D
     C                     Z-ADDWN0107    B1BEPR           CD Sort Loss
     C                     Z-ADDWN0108    B1ASPC           CD STD Yield
     C                     Z-ADDBVAMPC    B1EWNB           CD Carcass/Hot
     C                     Z-ADDWN0109    B1B4PR           CD Base Carcass
     C                     Z-ADDWN0110    B1EYNB           CD Crc Value Pe
     C                     Z-ADDWN0111    B1B1PR           CD Base Carc Va
     C                     Z-ADDWN0112    B1AVPR           CD Crc Value $
     C                     Z-ADDBVAKPC    B1AUPC           CD Lean Percent
     C                     Z-ADDWN0113    B1AWPR           CD Lean Premium
     C                     Z-ADDWN0114    B1AXPR           CD Lean Premium
     C                     Z-ADDWN0115    B1EZNB           CD Gross Value
     C                     Z-ADDWN0116    B1AYPR           CD Gross Value
     C                     Z-ADDBVA9DT    B1BBDT           CD Kill Date
     C                     Z-ADDBVAOTM    B1AKTM           CD Kill Time
     C                     MOVELBVEAST    B1IQST           CD Shift
     C                     MOVELWN0117    B1EFST           CD Carcass Acti
     C                     Z-ADDBVAIPC    B1H6NB           CD Backfat Thic
     C                     Z-ADDBVAJPC    B1BEPC           CD Loin-Eye Dep
     C                     Z-ADDBVALPC    B1GCST           CD Light Reflec
     C                     MOVELBVDIST    B1GDST           CD Trim Area
     C                     MOVELWN0118    B1GEST           CD Carcass Sex
     C                     Z-ADDWN0119    B1BHPC           CD FFLI
     C                     MOVELWN0120    B1IOST           CD Record Creat
     C                     MOVELWN0121    B1IPST           CD Record Creat
     C                     Z-ADDWN0122    B1LTNB           CD LOT
     C                     MOVELWN0123    B1JNST           CD User Error O
     C                     Z-ADDBVX8NB    B1X4NB           CD Backfat Thic
     C                     Z-ADDBVFVPC    B1FNPC           CD Loin-Eye Dep
     C                     Z-ADDBVFWPC    B1FOPC           CD Light Reflec
     C                     Z-ADDBVFXPC    B1FPPC           CD Lean Percent
     C                     MOVEL$EKAST    B1K2ST           CD Source Type
     C                     MOVEL$EJ9ST    B1K3ST           CD Payment Type
     C                     Z-ADDWN0124    B1JWPR           CD CA Sort Loss
     C                     Z-ADDWN0125    B1F5PC           CD CA Std Yield
     C                     Z-ADDWN0126    B1JXPR           CD CA Base Carc
     C                     Z-ADDWN0127    B1JYPR           CD CA Crc Value
     C                     Z-ADDWN0128    B1JZPR           CD CA Base Carc
     C                     Z-ADDWN0129    B1J0PR           CD CA Crc Value
     C                     Z-ADDWN0130    B1J1PR           CD CA Lean Prem
     C                     Z-ADDWN0131    B1J2PR           CD CA Lean Prem
     C                     Z-ADDWN0132    B1J3PR           CD CA Gross Val
     C                     Z-ADDWN0133    B1J4PR           CD CA Gross Val
     C                     MOVELWN0134    B1UTST           CD Adjust/Add T
     C                     MOVELWN0135    B1HVCD           CD Producer Loc
     C                     Z-ADDWN0136    B1DKJR           CD Loin Eye Inc
     C                     Z-ADDWN0137    B1ITJF           CD Backfat Inch
     C                     Z-ADDWN0138    B1IJGR           CD Meat Value F
     C                     Z-ADDWN0139    B1ORJE           CD Lean Prem/Di
     C                     Z-ADDWN0140    B1OTJR           CD Fixed Cost F
     C                     Z-ADDWN0141    B1PEIR           CD MPR Sort Los
     C                     Z-ADDWN0142    B1IEUF           CD Meat Value F
     C                     Z-ADDWN0143    B1ORUE           CD Fixed Cost F
     C                     Z-ADDWN0144    B1IUTR           CD Gross Before
     C                     Z-ADDWN0145    B1IJRR           CD Gross Before
     C                     MOVELWN0146    B1VCST           CD Broken Back
     C                     MOVELWN0147    B1VDST           CD Adjust/Add S
     C                     MOVELWN0148    B1VEST           CD Unused Sts 3
     C                     MOVELWN0149    B1VFST           CD Unused Sts 4
     C                     MOVELWN0150    B1VGST           CD Unused Sts 5
     C                     MOVEL$EABCD    B1ABCD           PD Producer Cod
     C                     MOVEL$ELKST    B1AACD           SR Source Code
     C                     MOVELWN0151    B1AAVN           RS User Changed
     C                     Z-ADDWN0152    B1AADT           RS Date Changed
     C                     Z-ADDWN0153    B1AMTM           RS Time Changed
     C                     MOVELWN0154    B1AJST           RS Record Statu
     C                     MOVELWN0155    B1AHVN           RS Job
     C                     MOVELWN0156    B1AGVN           RS Program
     C                     MOVELWN0157    B1ABVN           RS User Added
     C                     Z-ADDWN0158    B1ABDT           RS Date Added
     C                     Z-ADDWN0159    B1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       B1AJST           RS Record Statu
     C                     MOVEL##USR     B1ABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           B1ABDT    PARM *ZERO     WQ0008  70       *DATE
     C           B1ABTM    PARM *ZERO     WQ0009  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     B1AGVN           RS Program
     C                     MOVEL##JOB     B1AHVN           RS Job
     C           KLCRSG    KLIST
     C                     KFLD           B1HMNB           BOH Company Num
     C                     KFLD           B1BNNB           BOH Buy Order N
     C                     KFLD           B1BONB           BOL Load Number
     C                     KFLD           B1CVNB           TH Tattoo Numbe
     C                     KFLD           B1B0DT           TH Kill Date
     C                     KFLD           B1LGNB           CD Scale Sequen
     C                     KFLD           B1EUNB           CD Carcass Numb
     C                     KFLD           B1LHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRSG    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADD$EHMNB    B1HMNB           BOH Company Num
     C                     Z-ADD$EBNNB    B1BNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    B1BONB           BOL Load Number
     C                     Z-ADD$ECVNB    B1CVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    B1B0DT           TH Kill Date
     C                     Z-ADDBVFJNB    B1LGNB           CD Scale Sequen
     C                     Z-ADDBVHCNB    B1EUNB           CD Carcass Numb
     C                     Z-ADD1         B1LHNB           CD Carcass Numb
     C                     MOVEL*BLANK    B1INST           CD Record Add/D
     C                     Z-ADDWN0160    B1BEPR           CD Sort Loss
     C                     Z-ADDWN0161    B1ASPC           CD STD Yield
     C                     Z-ADDBVAMPC    B1EWNB           CD Carcass/Hot
     C                     Z-ADDWN0162    B1B4PR           CD Base Carcass
     C                     Z-ADDWN0163    B1EYNB           CD Crc Value Pe
     C                     Z-ADDWN0164    B1B1PR           CD Base Carc Va
     C                     Z-ADDWN0165    B1AVPR           CD Crc Value $
     C                     Z-ADDBVAKPC    B1AUPC           CD Lean Percent
     C                     Z-ADDWN0166    B1AWPR           CD Lean Premium
     C                     Z-ADDWN0167    B1AXPR           CD Lean Premium
     C                     Z-ADDWN0168    B1EZNB           CD Gross Value
     C                     Z-ADDWN0169    B1AYPR           CD Gross Value
     C                     Z-ADDBVA9DT    B1BBDT           CD Kill Date
     C                     Z-ADDBVAOTM    B1AKTM           CD Kill Time
     C                     MOVELBVEAST    B1IQST           CD Shift
     C                     MOVELWN0170    B1EFST           CD Carcass Acti
     C                     Z-ADDBVAIPC    B1H6NB           CD Backfat Thic
     C                     Z-ADDBVAJPC    B1BEPC           CD Loin-Eye Dep
     C                     Z-ADDBVALPC    B1GCST           CD Light Reflec
     C                     MOVELBVDIST    B1GDST           CD Trim Area
     C                     MOVELWN0171    B1GEST           CD Carcass Sex
     C                     Z-ADDWN0172    B1BHPC           CD FFLI
     C                     MOVELWN0173    B1IOST           CD Record Creat
     C                     MOVELWN0174    B1IPST           CD Record Creat
     C                     Z-ADDWN0175    B1LTNB           CD LOT
     C                     MOVELWN0176    B1JNST           CD User Error O
     C                     Z-ADDBVX8NB    B1X4NB           CD Backfat Thic
     C                     Z-ADDBVFVPC    B1FNPC           CD Loin-Eye Dep
     C                     Z-ADDBVFWPC    B1FOPC           CD Light Reflec
     C                     Z-ADDBVFXPC    B1FPPC           CD Lean Percent
     C                     MOVEL$EKAST    B1K2ST           CD Source Type
     C                     MOVEL$EJ9ST    B1K3ST           CD Payment Type
     C                     Z-ADDWN0177    B1JWPR           CD CA Sort Loss
     C                     Z-ADDWN0178    B1F5PC           CD CA Std Yield
     C                     Z-ADDWN0179    B1JXPR           CD CA Base Carc
     C                     Z-ADDWN0180    B1JYPR           CD CA Crc Value
     C                     Z-ADDWN0181    B1JZPR           CD CA Base Carc
     C                     Z-ADDWN0182    B1J0PR           CD CA Crc Value
     C                     Z-ADDWN0183    B1J1PR           CD CA Lean Prem
     C                     Z-ADDWN0184    B1J2PR           CD CA Lean Prem
     C                     Z-ADDWN0185    B1J3PR           CD CA Gross Val
     C                     Z-ADDWN0186    B1J4PR           CD CA Gross Val
     C                     MOVELWN0187    B1UTST           CD Adjust/Add T
     C                     MOVELWN0188    B1HVCD           CD Producer Loc
     C                     Z-ADDWN0189    B1DKJR           CD Loin Eye Inc
     C                     Z-ADDWN0190    B1ITJF           CD Backfat Inch
     C                     Z-ADDWN0191    B1IJGR           CD Meat Value F
     C                     Z-ADDWN0192    B1ORJE           CD Lean Prem/Di
     C                     Z-ADDWN0193    B1OTJR           CD Fixed Cost F
     C                     Z-ADDWN0194    B1PEIR           CD MPR Sort Los
     C                     Z-ADDWN0195    B1IEUF           CD Meat Value F
     C                     Z-ADDWN0196    B1ORUE           CD Fixed Cost F
     C                     Z-ADDWN0197    B1IUTR           CD Gross Before
     C                     Z-ADDWN0198    B1IJRR           CD Gross Before
     C                     MOVELWN0199    B1VCST           CD Broken Back
     C                     MOVELWN0200    B1VDST           CD Adjust/Add S
     C                     MOVELWN0201    B1VEST           CD Unused Sts 3
     C                     MOVELWN0202    B1VFST           CD Unused Sts 4
     C                     MOVELWN0203    B1VGST           CD Unused Sts 5
     C                     MOVEL$EABCD    B1ABCD           PD Producer Cod
     C                     MOVEL$ELKST    B1AACD           SR Source Code
     C                     MOVELWN0204    B1AAVN           RS User Changed
     C                     Z-ADDWN0205    B1AADT           RS Date Changed
     C                     Z-ADDWN0206    B1AMTM           RS Time Changed
     C                     MOVELWN0207    B1AJST           RS Record Statu
     C                     MOVELWN0208    B1AHVN           RS Job
     C                     MOVELWN0209    B1AGVN           RS Program
     C                     MOVELWN0210    B1ABVN           RS User Added
     C                     Z-ADDWN0211    B1ABDT           RS Date Added
     C                     Z-ADDWN0212    B1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       B1AJST           RS Record Statu
     C                     MOVEL##USR     B1ABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           B1ABDT    PARM *ZERO     WQ0010  70       *DATE
     C           B1ABTM    PARM *ZERO     WQ0011  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     B1AGVN           RS Program
     C                     MOVEL##JOB     B1AHVN           RS Job
     C           KLCRSH    KLIST
     C                     KFLD           B1HMNB           BOH Company Num
     C                     KFLD           B1BNNB           BOH Buy Order N
     C                     KFLD           B1BONB           BOL Load Number
     C                     KFLD           B1CVNB           TH Tattoo Numbe
     C                     KFLD           B1B0DT           TH Kill Date
     C                     KFLD           B1LGNB           CD Scale Sequen
     C                     KFLD           B1EUNB           CD Carcass Numb
     C                     KFLD           B1LHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRSH    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADD$EHMNB    B1HMNB           BOH Company Num
     C                     Z-ADD$EBNNB    B1BNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    B1BONB           BOL Load Number
     C                     Z-ADD$ECVNB    B1CVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    B1B0DT           TH Kill Date
     C                     Z-ADDBVFJNB    B1LGNB           CD Scale Sequen
     C                     Z-ADDBVHCNB    B1EUNB           CD Carcass Numb
     C                     Z-ADD1         B1LHNB           CD Carcass Numb
     C                     MOVEL*BLANK    B1INST           CD Record Add/D
     C                     Z-ADDWN0213    B1BEPR           CD Sort Loss
     C                     Z-ADDWN0214    B1ASPC           CD STD Yield
     C                     Z-ADDBVAMPC    B1EWNB           CD Carcass/Hot
     C                     Z-ADDWN0215    B1B4PR           CD Base Carcass
     C                     Z-ADDWN0216    B1EYNB           CD Crc Value Pe
     C                     Z-ADDWN0217    B1B1PR           CD Base Carc Va
     C                     Z-ADDWN0218    B1AVPR           CD Crc Value $
     C                     Z-ADDBVAKPC    B1AUPC           CD Lean Percent
     C                     Z-ADDWN0219    B1AWPR           CD Lean Premium
     C                     Z-ADDWN0220    B1AXPR           CD Lean Premium
     C                     Z-ADDWN0221    B1EZNB           CD Gross Value
     C                     Z-ADDWN0222    B1AYPR           CD Gross Value
     C                     Z-ADDBVA9DT    B1BBDT           CD Kill Date
     C                     Z-ADDBVAOTM    B1AKTM           CD Kill Time
     C                     MOVELBVEAST    B1IQST           CD Shift
     C                     MOVELWN0223    B1EFST           CD Carcass Acti
     C                     Z-ADDBVAIPC    B1H6NB           CD Backfat Thic
     C                     Z-ADDBVAJPC    B1BEPC           CD Loin-Eye Dep
     C                     Z-ADDBVALPC    B1GCST           CD Light Reflec
     C                     MOVELBVDIST    B1GDST           CD Trim Area
     C                     MOVELWN0224    B1GEST           CD Carcass Sex
     C                     Z-ADDWN0225    B1BHPC           CD FFLI
     C                     MOVELWN0226    B1IOST           CD Record Creat
     C                     MOVELWN0227    B1IPST           CD Record Creat
     C                     Z-ADDWN0228    B1LTNB           CD LOT
     C                     MOVELWN0229    B1JNST           CD User Error O
     C                     Z-ADDBVX8NB    B1X4NB           CD Backfat Thic
     C                     Z-ADDBVFVPC    B1FNPC           CD Loin-Eye Dep
     C                     Z-ADDBVFWPC    B1FOPC           CD Light Reflec
     C                     Z-ADDBVFXPC    B1FPPC           CD Lean Percent
     C                     MOVEL$EKAST    B1K2ST           CD Source Type
     C                     MOVEL$EJ9ST    B1K3ST           CD Payment Type
     C                     Z-ADDWN0230    B1JWPR           CD CA Sort Loss
     C                     Z-ADDWN0231    B1F5PC           CD CA Std Yield
     C                     Z-ADDWN0232    B1JXPR           CD CA Base Carc
     C                     Z-ADDWN0233    B1JYPR           CD CA Crc Value
     C                     Z-ADDWN0234    B1JZPR           CD CA Base Carc
     C                     Z-ADDWN0235    B1J0PR           CD CA Crc Value
     C                     Z-ADDWN0236    B1J1PR           CD CA Lean Prem
     C                     Z-ADDWN0237    B1J2PR           CD CA Lean Prem
     C                     Z-ADDWN0238    B1J3PR           CD CA Gross Val
     C                     Z-ADDWN0239    B1J4PR           CD CA Gross Val
     C                     MOVELWN0240    B1UTST           CD Adjust/Add T
     C                     MOVELWN0241    B1HVCD           CD Producer Loc
     C                     Z-ADDWN0242    B1DKJR           CD Loin Eye Inc
     C                     Z-ADDWN0243    B1ITJF           CD Backfat Inch
     C                     Z-ADDWN0244    B1IJGR           CD Meat Value F
     C                     Z-ADDWN0245    B1ORJE           CD Lean Prem/Di
     C                     Z-ADDWN0246    B1OTJR           CD Fixed Cost F
     C                     Z-ADDWN0247    B1PEIR           CD MPR Sort Los
     C                     Z-ADDWN0248    B1IEUF           CD Meat Value F
     C                     Z-ADDWN0249    B1ORUE           CD Fixed Cost F
     C                     Z-ADDWN0250    B1IUTR           CD Gross Before
     C                     Z-ADDWN0251    B1IJRR           CD Gross Before
     C                     MOVELWN0252    B1VCST           CD Broken Back
     C                     MOVELWN0253    B1VDST           CD Adjust/Add S
     C                     MOVELWN0254    B1VEST           CD Unused Sts 3
     C                     MOVELWN0255    B1VFST           CD Unused Sts 4
     C                     MOVELWN0256    B1VGST           CD Unused Sts 5
     C                     MOVEL$EABCD    B1ABCD           PD Producer Cod
     C                     MOVEL$ELKST    B1AACD           SR Source Code
     C                     MOVELWN0257    B1AAVN           RS User Changed
     C                     Z-ADDWN0258    B1AADT           RS Date Changed
     C                     Z-ADDWN0259    B1AMTM           RS Time Changed
     C                     MOVELWN0260    B1AJST           RS Record Statu
     C                     MOVELWN0261    B1AHVN           RS Job
     C                     MOVELWN0262    B1AGVN           RS Program
     C                     MOVELWN0263    B1ABVN           RS User Added
     C                     Z-ADDWN0264    B1ABDT           RS Date Added
     C                     Z-ADDWN0265    B1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       B1AJST           RS Record Statu
     C                     MOVEL##USR     B1ABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           B1ABDT    PARM *ZERO     WQ0012  70       *DATE
     C           B1ABTM    PARM *ZERO     WQ0013  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     B1AGVN           RS Program
     C                     MOVEL##JOB     B1AHVN           RS Job
     C           KLCRSI    KLIST
     C                     KFLD           B1HMNB           BOH Company Num
     C                     KFLD           B1BNNB           BOH Buy Order N
     C                     KFLD           B1BONB           BOL Load Number
     C                     KFLD           B1CVNB           TH Tattoo Numbe
     C                     KFLD           B1B0DT           TH Kill Date
     C                     KFLD           B1LGNB           CD Scale Sequen
     C                     KFLD           B1EUNB           CD Carcass Numb
     C                     KFLD           B1LHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRSI    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Prt Hot Scl Upl Summ  RT - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     $EH1US           Head 1 USR
     C                     Z-ADD*ZERO     $EH2US           Head 2 USR
     C                     Z-ADD*ZERO     $ECUPR           Gross Pay Amt T
     C                     Z-ADD*ZERO     $EB5NB           Head Total USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQSJ01           BOH Company Num
     C           *LIKE     DEFN WABNNB    WQSJ02           BOH Buy Order N
     C           *LIKE     DEFN WABONB    WQSJ03           BOL Load Number
     C           *LIKE     DEFN WACVNB    WQSJ04           TH Tattoo Numbe
     C           *LIKE     DEFN WAB0DT    WQSJ05           TH Kill Date
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           BOH Company Num
     C                     KFLD           WQSJ02           BOH Buy Order N
     C                     KFLD           WQSJ03           BOL Load Number
     C                     KFLD           WQSJ04           TH Tattoo Numbe
     C                     KFLD           WQSJ05           TH Kill Date
      * Setup key
     C                     Z-ADD$EHMNB    WQSJ01           BOH Company Num
     C                     Z-ADD$EBNNB    WQSJ02           BOH Buy Order N
     C                     Z-ADD$EBONB    WQSJ03           BOL Load Number
     C                     Z-ADD$ECVNB    WQSJ04           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    WQSJ05           TH Kill Date
      * Establish starting position
     C           KRSSJ     SETLL@B1CPC3                    *
     C           KRSSJ     READE@B1CPC3                  90*
      * Data record not found
     C   90                MOVEL'PRK0138' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.CD Record Add/Del Sts is Add
     C           WAINST    IFEQ 'A'                        *IF
     C                     ADD  1         $EH2US           Head 2 USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         $EH1US           Head 1 USR
     C                     END                             *FI
      * CASE: PAR.Payment Data Type USR is Paid Carcasses
     C           P3T5ST    IFEQ 'PC'                       *IF
      *
     C                     Z-ADD*ZERO     WN0266  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0267  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0268  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0269  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0270  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0271  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0272  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0273  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0274  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0275  72       CD Gross Value
     C                     MOVEL*BLANK    WN0276  1        CD Carcass Acti
     C                     MOVEL*BLANK    WN0277  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN0278  31       CD FFLI
     C                     MOVEL*BLANK    WN0279  1        CD Record Creat
     C                     MOVEL*BLANK    WN0280  1        CD Record Creat
     C                     Z-ADD*ZERO     WN0281  50       CD LOT
     C                     MOVEL*BLANK    WN0282  1        CD User Error O
     C                     Z-ADD*ZERO     WN0283  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0284  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN0285  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0286  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0287  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0288  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0289  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0290  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0291  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0292  72       CD CA Gross Val
     C                     MOVEL*BLANK    WN0293  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN0294  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN0295  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN0296  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN0297  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN0298  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN0299  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0300  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN0301  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN0302  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0303  72       CD Gross Before
     C                     Z-ADD*ZERO     WN0304  72       CD Gross Before
     C                     MOVEL*BLANK    WN0305  1        CD Broken Back
     C                     MOVEL*BLANK    WN0306  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN0307  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN0308  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN0309  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN0310 10        RS User Changed
     C                     Z-ADD*ZERO     WN0311  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0312  60       RS Time Changed
     C                     MOVEL*BLANK    WN0313  1        RS Record Statu
     C                     MOVEL*BLANK    WN0314 10        RS Job
     C                     MOVEL*BLANK    WN0315 10        RS Program
     C                     MOVEL*BLANK    WN0316 10        RS User Added
     C                     Z-ADD*ZERO     WN0317  70       RS Date Added
     C                     Z-ADD*ZERO     WN0318  60       RS Time Added
      *
      * Crt Crc HotSclUpl Sum IF
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR SKCRRC
     C                     END                             *FI
     C                     ADD  1         $EB5NB           Head Total USR
      * Accumulate Top Paid Carcasses
      * CASE: PAR.Head Total USR LE PAR.TH Head Killed
     C           $EB5NB    IFLE $EFENB                     *IF
     C                     ADD  WAAYPR    $ECUPR           Gross Pay Amt T
     C                     END                             *FI
     C           KRSSJ     READE@B1CPC3                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADDWAHMNB    B1HMNB           BOH Company Num
     C                     Z-ADDWABNNB    B1BNNB           BOH Buy Order N
     C                     Z-ADDWABONB    B1BONB           BOL Load Number
     C                     Z-ADDWACVNB    B1CVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    B1B0DT           TH Kill Date
     C                     Z-ADDWALGNB    B1LGNB           CD Scale Sequen
     C                     Z-ADDWAEUNB    B1EUNB           CD Carcass Numb
     C                     Z-ADDWALHNB    B1LHNB           CD Carcass Numb
     C                     MOVELWAINST    B1INST           CD Record Add/D
     C                     Z-ADDWN0266    B1BEPR           CD Sort Loss
     C                     Z-ADDWN0267    B1ASPC           CD STD Yield
     C                     Z-ADDWAEWNB    B1EWNB           CD Carcass/Hot
     C                     Z-ADDWN0268    B1B4PR           CD Base Carcass
     C                     Z-ADDWN0269    B1EYNB           CD Crc Value Pe
     C                     Z-ADDWN0270    B1B1PR           CD Base Carc Va
     C                     Z-ADDWN0271    B1AVPR           CD Crc Value $
     C                     Z-ADDWAAUPC    B1AUPC           CD Lean Percent
     C                     Z-ADDWN0272    B1AWPR           CD Lean Premium
     C                     Z-ADDWN0273    B1AXPR           CD Lean Premium
     C                     Z-ADDWN0274    B1EZNB           CD Gross Value
     C                     Z-ADDWN0275    B1AYPR           CD Gross Value
     C                     Z-ADDWABBDT    B1BBDT           CD Kill Date
     C                     Z-ADDWAAKTM    B1AKTM           CD Kill Time
     C                     MOVELWAIQST    B1IQST           CD Shift
     C                     MOVELWN0276    B1EFST           CD Carcass Acti
     C                     Z-ADDWAH6NB    B1H6NB           CD Backfat Thic
     C                     Z-ADDWABEPC    B1BEPC           CD Loin-Eye Dep
     C                     Z-ADDWAGCST    B1GCST           CD Light Reflec
     C                     MOVELWAGDST    B1GDST           CD Trim Area
     C                     MOVELWN0277    B1GEST           CD Carcass Sex
     C                     Z-ADDWN0278    B1BHPC           CD FFLI
     C                     MOVELWN0279    B1IOST           CD Record Creat
     C                     MOVELWN0280    B1IPST           CD Record Creat
     C                     Z-ADDWN0281    B1LTNB           CD LOT
     C                     MOVELWN0282    B1JNST           CD User Error O
     C                     Z-ADDWAX4NB    B1X4NB           CD Backfat Thic
     C                     Z-ADDWAFNPC    B1FNPC           CD Loin-Eye Dep
     C                     Z-ADDWAFOPC    B1FOPC           CD Light Reflec
     C                     Z-ADDWAFPPC    B1FPPC           CD Lean Percent
     C                     MOVELWAK2ST    B1K2ST           CD Source Type
     C                     MOVELWAK3ST    B1K3ST           CD Payment Type
     C                     Z-ADDWN0283    B1JWPR           CD CA Sort Loss
     C                     Z-ADDWN0284    B1F5PC           CD CA Std Yield
     C                     Z-ADDWN0285    B1JXPR           CD CA Base Carc
     C                     Z-ADDWN0286    B1JYPR           CD CA Crc Value
     C                     Z-ADDWN0287    B1JZPR           CD CA Base Carc
     C                     Z-ADDWN0288    B1J0PR           CD CA Crc Value
     C                     Z-ADDWN0289    B1J1PR           CD CA Lean Prem
     C                     Z-ADDWN0290    B1J2PR           CD CA Lean Prem
     C                     Z-ADDWN0291    B1J3PR           CD CA Gross Val
     C                     Z-ADDWN0292    B1J4PR           CD CA Gross Val
     C                     MOVELWN0293    B1UTST           CD Adjust/Add T
     C                     MOVELWN0294    B1HVCD           CD Producer Loc
     C                     Z-ADDWN0295    B1DKJR           CD Loin Eye Inc
     C                     Z-ADDWN0296    B1ITJF           CD Backfat Inch
     C                     Z-ADDWN0297    B1IJGR           CD Meat Value F
     C                     Z-ADDWN0298    B1ORJE           CD Lean Prem/Di
     C                     Z-ADDWN0299    B1OTJR           CD Fixed Cost F
     C                     Z-ADDWN0300    B1PEIR           CD MPR Sort Los
     C                     Z-ADDWN0301    B1IEUF           CD Meat Value F
     C                     Z-ADDWN0302    B1ORUE           CD Fixed Cost F
     C                     Z-ADDWN0303    B1IUTR           CD Gross Before
     C                     Z-ADDWN0304    B1IJRR           CD Gross Before
     C                     MOVELWN0305    B1VCST           CD Broken Back
     C                     MOVELWN0306    B1VDST           CD Adjust/Add S
     C                     MOVELWN0307    B1VEST           CD Unused Sts 3
     C                     MOVELWN0308    B1VFST           CD Unused Sts 4
     C                     MOVELWN0309    B1VGST           CD Unused Sts 5
     C                     MOVELWAABCD    B1ABCD           PD Producer Cod
     C                     MOVELWAAACD    B1AACD           SR Source Code
     C                     MOVELWN0310    B1AAVN           RS User Changed
     C                     Z-ADDWN0311    B1AADT           RS Date Changed
     C                     Z-ADDWN0312    B1AMTM           RS Time Changed
     C                     MOVELWN0313    B1AJST           RS Record Statu
     C                     MOVELWN0314    B1AHVN           RS Job
     C                     MOVELWN0315    B1AGVN           RS Program
     C                     MOVELWN0316    B1ABVN           RS User Added
     C                     Z-ADDWN0317    B1ABDT           RS Date Added
     C                     Z-ADDWN0318    B1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       B1AJST           RS Record Statu
     C                     MOVEL##USR     B1ABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           B1ABDT    PARM *ZERO     WQ0014  70       *DATE
     C           B1ABTM    PARM *ZERO     WQ0015  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     B1AGVN           RS Program
     C                     MOVEL##JOB     B1AHVN           RS Job
     C           KLCRSK    KLIST
     C                     KFLD           B1HMNB           BOH Company Num
     C                     KFLD           B1BNNB           BOH Buy Order N
     C                     KFLD           B1BONB           BOL Load Number
     C                     KFLD           B1CVNB           TH Tattoo Numbe
     C                     KFLD           B1B0DT           TH Kill Date
     C                     KFLD           B1LGNB           CD Scale Sequen
     C                     KFLD           B1EUNB           CD Carcass Numb
     C                     KFLD           B1LHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRSK    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Tattoo Ded/Add    RT - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           CDHMNB           BOH Company Num
     C                     KFLD           CDBNNB           BOH Buy Order N
     C                     KFLD           CDBONB           BOL Load Number
     C                     KFLD           CDCVNB           TH Tattoo Numbe
     C                     KFLD           CDB0DT           TH Kill Date
     C                     KFLD           CDBQCD           DED D/A Code
      * Setup key
     C                     Z-ADD$EHMNB    CDHMNB           BOH Company Num
     C                     Z-ADD$EBNNB    CDBNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    CDBONB           BOL Load Number
     C                     Z-ADD$ECVNB    CDCVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    CDB0DT           TH Kill Date
     C                     MOVE *BLANK    CDBQCD           DED D/A Code
     C                     MOVEL'INS'     CDBQCD           DED D/A Code
      * Establish starting position
     C           KRSSL     CHAIN@CDCPIU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0174' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     $EETPR           THD Ded/Add Amo
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDCDA0VA    $EETPR           THD Ded/Add Amo
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Tattoo Ded/Add    RT - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           CDHMNB           BOH Company Num
     C                     KFLD           CDBNNB           BOH Buy Order N
     C                     KFLD           CDBONB           BOL Load Number
     C                     KFLD           CDCVNB           TH Tattoo Numbe
     C                     KFLD           CDB0DT           TH Kill Date
     C                     KFLD           CDBQCD           DED D/A Code
      * Setup key
     C                     Z-ADD$EHMNB    CDHMNB           BOH Company Num
     C                     Z-ADD$EBNNB    CDBNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    CDBONB           BOL Load Number
     C                     Z-ADD$ECVNB    CDCVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    CDB0DT           TH Kill Date
     C                     MOVEL'INSRE'   CDBQCD           DED D/A Code
      * Establish starting position
     C           KRSSM     CHAIN@CDCPIU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0174' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     $EEUPR           THD Ded/Add Amo
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDCDA0VA    $EEUPR           THD Ded/Add Amo
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv BoH  Quot/Cmp     RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           AWHMNB           BOH Company Num
     C                     KFLD           AWBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADD$EHMNB    AWHMNB           BOH Company Num
     C                     Z-ADD$EBNNB    AWBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSSN     CHAIN@AWCPBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0049' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0006           BOH Quote Price
     C                     Z-ADD*ZERO     YL0007           BOH Quoted Base
     C                     MOVEL*BLANK    YL0008           CMP Program Cod
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAWB3ST    YL0006           BOH Quote Price
     C                     Z-ADDAWALPR    YL0007           BOH Quoted Base
     C                     MOVELAWAMCD    YL0008           CMP Program Cod
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Dlt Crcs Dtl By Tatto/dte - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQSO01           BOH Company Num
     C           *LIKE     DEFN WBBNNB    WQSO02           BOH Buy Order N
     C           *LIKE     DEFN WBBONB    WQSO03           BOL Load Number
     C           *LIKE     DEFN WBCVNB    WQSO04           TH Tattoo Numbe
     C           *LIKE     DEFN WBB0DT    WQSO05           TH Kill Date
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           BOH Company Num
     C                     KFLD           WQSO02           BOH Buy Order N
     C                     KFLD           WQSO03           BOL Load Number
     C                     KFLD           WQSO04           TH Tattoo Numbe
     C                     KFLD           WQSO05           TH Kill Date
      * Setup key
     C                     Z-ADD$EHMNB    WQSO01           BOH Company Num
     C                     Z-ADD$EBNNB    WQSO02           BOH Buy Order N
     C                     Z-ADD$EBONB    WQSO03           BOL Load Number
     C                     Z-ADD$ECVNB    WQSO04           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    WQSO05           TH Kill Date
      * Establish starting position
     C           KRSSO     SETLL@B1CPNX                    *
     C           KRSSO     READE@B1CPNX                  90*
      * Data record not found
     C   90                MOVEL'PRK0138' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Dlt Carcass Detail    DL - Carcass Detail  * 
     C                     EXSR SPDLRC
     C           KRSSO     READE@B1CPNX                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPDLRC    BEGSR
      *================================================================
      * Dlt Carcass Detail    DL - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B1CPG6
     C                     Z-ADDWBHMNB    B1HMNB           BOH Company Num
     C                     Z-ADDWBBNNB    B1BNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    B1BONB           BOL Load Number
     C                     Z-ADDWBCVNB    B1CVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    B1B0DT           TH Kill Date
     C                     Z-ADDWBLGNB    B1LGNB           CD Scale Sequen
     C                     Z-ADDWBEUNB    B1EUNB           CD Carcass Numb
     C                     Z-ADDWBLHNB    B1LHNB           CD Carcass Numb
      *
     C           KLDLSP    KLIST
     C                     KFLD           B1HMNB           BOH Company Num
     C                     KFLD           B1BNNB           BOH Buy Order N
     C                     KFLD           B1BONB           BOL Load Number
     C                     KFLD           B1CVNB           TH Tattoo Numbe
     C                     KFLD           B1B0DT           TH Kill Date
     C                     KFLD           B1LGNB           CD Scale Sequen
     C                     KFLD           B1EUNB           CD Carcass Numb
     C                     KFLD           B1LHNB           CD Carcass Numb
     C           KLDLSP    CHAIN@B1CPG6              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKB1CPL0'MDACP
     C                     MOVEL'@B1CPG6' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B1CPG6                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv PrchPrc Clc Info  RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           AWHMNB           BOH Company Num
     C                     KFLD           AWBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADD$GHMNB    AWHMNB           BOH Company Num
     C                     Z-ADD$GBNNB    AWBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSSQ     CHAIN@AWCPBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0049' W0RTN   7
      * USER: Processing if Data record not found
      * 1/28/08 SLM LEFT OVER INFORMATION MAY HAVE CAUSED ISSUES
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0319           BOH Market Add/
     C                     MOVEL*BLANK    WN0320           BOH Quote Price
     C                     Z-ADD*ZERO     WN0321           BOH Quoted Base
     C                     MOVEL*BLANK    WN0322           BOH Commodity M
     C                     MOVEL*BLANK    WN0323           BOH Commodity P
     C                     MOVEL*BLANK    WN0324           BOH Market Date
     C                     MOVEL*BLANK    WN0325           PC Contract Cod
     C                     MOVEL*BLANK    WN0326           PSC Sub-Contrac
     C                     MOVEL*BLANK    WN0327           PO Option Code
     C                     MOVEL*BLANK    WN0328           CMP Program Cod
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAWAAPR    WN0319           BOH Market Add/
     C                     MOVELAWB3ST    WN0320           BOH Quote Price
     C                     Z-ADDAWALPR    WN0321           BOH Quoted Base
     C                     MOVELAWETCD    WN0322           BOH Commodity M
     C                     MOVELAWEUCD    WN0323           BOH Commodity P
     C                     MOVELAWJ5TX    WN0324           BOH Market Date
     C                     MOVELAWAKCD    WN0325           PC Contract Cod
     C                     MOVELAWALCD    WN0326           PSC Sub-Contrac
     C                     MOVELAWAICD    WN0327           PO Option Code
     C                     MOVELAWAMCD    WN0328           CMP Program Cod
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv PurchPrc Clc Info RT - Producer Sub-Contract  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           AQAKCD           PC Contract Cod
     C                     KFLD           AQALCD           PSC Sub-Contrac
      * Setup key
     C                     MOVELWN0325    AQAKCD           PC Contract Cod
     C                     MOVELWN0326    AQALCD           PSC Sub-Contrac
      * Establish starting position
     C           KRSSR     CHAIN@AQCPA0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0037' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0340           PSC Floor Price
     C                     Z-ADD*ZERO     WN0341           PSC Ceiling Pri
     C                     Z-ADD*ZERO     WN0342           PSC Market Perc
     C                     Z-ADD*ZERO     WN0343           PSC Break Even
     C                     Z-ADD*ZERO     WN0344           PSC FLoor Price
     C                     MOVEL*BLANK    WN0345           PSC Sub-Contrac
     C                     Z-ADD*ZERO     WN0346           PSC Mkt Percent
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAQAZPR    WN0340           PSC Floor Price
     C                     Z-ADDAQA0PR    WN0341           PSC Ceiling Pri
     C                     Z-ADDAQA9PC    WN0342           PSC Market Perc
     C                     Z-ADDAQA7PR    WN0343           PSC Break Even
     C                     Z-ADDAQA8PR    WN0344           PSC FLoor Price
     C                     MOVELAQF3ST    WN0345           PSC Sub-Contrac
     C                     Z-ADDAQA9PR    WN0346           PSC Mkt Percent
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv CMP Info          RT - Carcass Merit Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           ARAMCD           CMP Program Cod
      * Setup key
     C                     MOVELWN0328    ARAMCD           CMP Program Cod
      * Establish starting position
     C           KRSSS     CHAIN@ARREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0329           CMP Description
     C                     MOVEL*BLANK    WN0330           CMP Grading Typ
     C                     MOVEL*BLANK    WN0331           CMP Sort Basis
     C                     MOVEL*BLANK    WN0333           CMP Carc Wgt Ty
     C                     Z-ADD*ZERO     WN0334           CMP Std Lean Pe
     C                     Z-ADD*ZERO     WN0335           CMP Lean Factor
     C                     MOVEL*BLANK    WN0336           CMP Optimal Row
     C                     MOVEL*BLANK    WN0337           CMP Type
     C                     Z-ADD*ZERO     WN0338           CMP Market Add/
     C                     MOVEL*BLANK    WN0339           RS Record Statu
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELARA3TX    WN0329           CMP Description
     C                     MOVELARDLST    WN0330           CMP Grading Typ
     C                     MOVELARDMST    WN0331           CMP Sort Basis
     C                     MOVELARDQST    WN0333           CMP Carc Wgt Ty
     C                     Z-ADDARAZPC    WN0334           CMP Std Lean Pe
     C                     Z-ADDARA0PC    WN0335           CMP Lean Factor
     C                     MOVELARDTST    WN0336           CMP Optimal Row
     C                     MOVELARF5ST    WN0337           CMP Type
     C                     Z-ADDARI1PR    WN0338           CMP Market Add/
     C                     MOVELARAJST    WN0339           RS Record Statu
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv StdYld/SortDisc   RT - Carcass Merit Matrix Row  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BYAMCD    WQST01           CMP Program Cod
      * Define keylist
     C           KPSST     KLIST
     C                     KFLD           WQST01           CMP Program Cod
     C                     KFLD           BYEGNB           CMMR Carc Wgt M
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           CMP Program Cod
      * Setup key
     C                     MOVELWN0328    WQST01           CMP Program Cod
     C                     Z-ADD$HAMPC    BYEGNB           CMMR Carc Wgt M
      * Establish starting position
     C           KPSST     SETLL@BYREJ9                    *
     C           KRSST     READE@BYREJ9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0132' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0357           CMMR Row Number
     C                     Z-ADD*ZERO     WN0358           CMMR Std Dressi
     C                     Z-ADD*ZERO     WN0348           CD Sort Loss
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBYE8NB    WN0357           CMMR Row Number
     C                     Z-ADDBYAQPC    WN0358           CMMR Std Dressi
     C                     Z-ADDBYEMNB    WN0348           CD Sort Loss
     C                     GOTO STEXIT                     *QUIT
     C           KRSST     READE@BYREJ9                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BZAMCD    WQSU01           CMP Program Cod
     C           *LIKE     DEFN BZE8NB    WQSU02           CMMR Row Number
      * Define keylist
     C           KPSSU     KLIST
     C                     KFLD           WQSU01           CMP Program Cod
     C                     KFLD           WQSU02           CMMR Row Number
     C                     KFLD           BZA1PC           CMMC Lean Perce
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           CMP Program Cod
     C                     KFLD           WQSU02           CMMR Row Number
      * Setup key
     C                     MOVELWN0328    WQSU01           CMP Program Cod
     C                     Z-ADDWN0357    WQSU02           CMMR Row Number
     C                     Z-ADD$HAKPC    BZA1PC           CMMC Lean Perce
      * Establish starting position
     C           KPSSU     SETLL@BZREKA                    *
     C           KRSSU     READE@BZREKA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0360           CMMC Premium Va
     C                     MOVEL*BLANK    WUF6ST           Record Found CM
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDBZERNB    WN0360           CMMC Premium Va
     C                     GOTO SUEXIT                     *QUIT
     C           KRSSU     READE@BZREKA                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Lean Premium % Frc RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAMCD    WQSV01           CMP Program Cod
     C           *LIKE     DEFN WCE8NB    WQSV02           CMMR Row Number
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           CMP Program Cod
     C                     KFLD           WQSV02           CMMR Row Number
      * Setup key
     C                     MOVELWN0328    WQSV01           CMP Program Cod
     C                     Z-ADDWN0357    WQSV02           CMMR Row Number
      * Establish starting position
     C           KRSSV     SETLL@BZREPO                    *
     C           KRSSV     READE@BZREPO                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWCERNB    WN0360           CMMC Premium Va
     C                     GOTO SVEXIT                     *QUIT
     C           KRSSV     READE@BZREPO                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BZAMCD    WQSW01           CMP Program Cod
     C           *LIKE     DEFN BZE8NB    WQSW02           CMMR Row Number
      * Define keylist
     C           KPSSW     KLIST
     C                     KFLD           WQSW01           CMP Program Cod
     C                     KFLD           WQSW02           CMMR Row Number
     C                     KFLD           BZA1PC           CMMC Lean Perce
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           CMP Program Cod
     C                     KFLD           WQSW02           CMMR Row Number
      * Setup key
     C                     MOVELWN0328    WQSW01           CMP Program Cod
     C                     Z-ADDWN0357    WQSW02           CMMR Row Number
     C                     Z-ADDWN0359    BZA1PC           CMMC Lean Perce
      * Establish starting position
     C           KPSSW     SETLL@BZREKA                    *
     C           KRSSW     READE@BZREKA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0360           CMMC Premium Va
     C                     MOVEL*BLANK    WUF6ST           Record Found CM
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDBZERNB    WN0360           CMMC Premium Va
     C                     GOTO SWEXIT                     *QUIT
     C           KRSSW     READE@BZREKA                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Rtv Lean Premium % Frc RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAMCD    WQSX01           CMP Program Cod
     C           *LIKE     DEFN WCE8NB    WQSX02           CMMR Row Number
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           CMP Program Cod
     C                     KFLD           WQSX02           CMMR Row Number
      * Setup key
     C                     MOVELWN0328    WQSX01           CMP Program Cod
     C                     Z-ADDWN0357    WQSX02           CMMR Row Number
      * Establish starting position
     C           KRSSX     SETLL@BZREPO                    *
     C           KRSSX     READE@BZREPO                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWCERNB    WN0360           CMMC Premium Va
     C                     GOTO SXEXIT                     *QUIT
     C           KRSSX     READE@BZREPO                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv BckF Premium       RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAMCD    WQSY01           CMP Program Cod
     C           *LIKE     DEFN WDE8NB    WQSY02           CMMR Row Number
      * Define keylist
     C           KPSSY     KLIST
     C                     KFLD           WQSY01           CMP Program Cod
     C                     KFLD           WQSY02           CMMR Row Number
     C                     KFLD           WDE7NB           CMMC Backfat In
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           CMP Program Cod
     C                     KFLD           WQSY02           CMMR Row Number
      * Setup key
     C                     MOVELWN0328    WQSY01           CMP Program Cod
     C                     Z-ADDWN0357    WQSY02           CMMR Row Number
     C                     Z-ADDWUVENB    WDE7NB           CMMC Backfat In
      * Establish starting position
     C           KPSSY     SETLL@BZRETM                    *
     C           KRSSY     READE@BZRETM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0360           CMMC Premium Va
     C                     MOVEL*BLANK    WUF6ST           Record Found CM
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWDERNB    WN0360           CMMC Premium Va
     C                     GOTO SYEXIT                     *QUIT
     C           KRSSY     READE@BZRETM                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Rtv BckF Premium % Frc RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAMCD    WQSZ01           CMP Program Cod
     C           *LIKE     DEFN WEE8NB    WQSZ02           CMMR Row Number
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           CMP Program Cod
     C                     KFLD           WQSZ02           CMMR Row Number
      * Setup key
     C                     MOVELWN0328    WQSZ01           CMP Program Cod
     C                     Z-ADDWN0357    WQSZ02           CMMR Row Number
      * Establish starting position
     C           KRSSZ     SETLL@BZRETL                    *
     C           KRSSZ     READE@BZRETL                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWEERNB    WN0360           CMMC Premium Va
     C                     GOTO SZEXIT                     *QUIT
     C           KRSSZ     READE@BZRETL                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TACRRC    BEGSR
      *================================================================
      * Crt Eval Tran Val Dtl CR - Eval Tran Value Dtl OUTF  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @ERCPDA
     C                     Z-ADD$HHMNB    ERHMNB           BOH Company Num
     C                     Z-ADD$HBNNB    ERBNNB           BOH Buy Order N
     C                     Z-ADD$HBONB    ERBONB           BOL Load Number
     C                     Z-ADD$HCVNB    ERCVNB           TH Tattoo Numbe
     C                     Z-ADD$HB0DT    ERB0DT           TH Kill Date
     C                     Z-ADDBVFJNB    ERLGNB           CD Scale Sequen
     C                     MOVELYL0013    ERUBST           ETV NonExcep/Ex
     C                     MOVELYL0014    ERUCST           ETV Accepted/De
     C                     Z-ADD$HAMPC    ERAMPC           ET Hot Wgt
     C                     Z-ADD$HAIPC    ERAIPC           ET Backfat Thic
     C                     Z-ADD$HAJPC    ERAJPC           ET Loin-Eye Dep
     C                     Z-ADD$HAKPC    ERAKPC           ET Lean Percent
     C                     Z-ADD$HX8NB    ERX8NB           ET Backfat Thic
     C                     Z-ADD$HFVPC    ERFVPC           ET Loineye Dept
     C                     Z-ADD$HFXPC    ERFXPC           ET Lean Percent
     C                     MOVEL$HDIST    ERDIST           ET Trim Area
     C                     Z-ADD$HAYPR    ERJ4PR           CD CA Gross Val
      *
     C           KLCRTA    KLIST
     C                     KFLD           ERHMNB           BOH Company Num
     C                     KFLD           ERBNNB           BOH Buy Order N
     C                     KFLD           ERBONB           BOL Load Number
     C                     KFLD           ERCVNB           TH Tattoo Numbe
     C                     KFLD           ERB0DT           TH Kill Date
     C                     KFLD           ERLGNB           CD Scale Sequen
      * Check for duplicate primary key
     C           KLCRTA    SETLL@ERCPDA                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0898' W0RTN   7
      * Send message 'Eval Tran Value Dtl OU EX'
     C                     MOVEL'PRK0898' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C                     WRITE@ERCPDA                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBCRRC    BEGSR
      *================================================================
      * Crt Eval Tran Val Hdr CR - Eval Tran Value Hdr OUTF  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @ESCPDD
     C                     Z-ADD$EHMNB    ESHMNB           BOH Company Num
     C                     Z-ADD$EBNNB    ESBNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    ESBONB           BOL Load Number
     C                     Z-ADD$ECVNB    ESCVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    ESB0DT           TH Kill Date
     C                     Z-ADD$IEOPC    ESF4NB           TH Avg Lean Per
     C                     Z-ADD$IP8NB    ESF2NB           TH Avg Backfat
     C                     Z-ADD$IENPC    ESF3NB           TH Avg Loin Eye
     C                     Z-ADD$IQFNB    ESHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     ESFMVL           FOM Valid Head
     C                     Z-ADD*ZERO     ESRYPR           FOM Valid $
     C                     Z-ADD*ZERO     ESRZPR           FOM Valid $/Hd
     C                     Z-ADD*ZERO     ESWYNB           FOM Excep Head
     C                     Z-ADD*ZERO     ESR0PR           FOM Excep $
     C                     Z-ADD*ZERO     ESR1PR           FOM Excep $/Hd
     C                     Z-ADD*ZERO     ESFMTL           FOM Total Head
     C                     Z-ADD*ZERO     ESR2PR           FOM Total $
     C                     Z-ADD*ZERO     ESR3PR           FOM Total $/Hd
     C                     Z-ADD*ZERO     ESDLVD           DEL Valid Head
     C                     Z-ADD*ZERO     ESR4PR           DEL Valid $
     C                     Z-ADD*ZERO     ESR5PR           DEL Valid $/Hd
     C                     Z-ADD*ZERO     ESDLEX           DEL Excep Head
     C                     Z-ADD*ZERO     ESR6PR           DEL Exceo $
     C                     Z-ADD*ZERO     ESR7PR           DEL Excep $/Hd
     C                     Z-ADD*ZERO     ESELTL           DEL Total Head
     C                     Z-ADD*ZERO     ESR8PR           DEL Total $
     C                     Z-ADD*ZERO     ESR9PR           DEL Total $/Hd
     C                     Z-ADD*ZERO     ESPAID           PAID Adds Head
     C                     Z-ADD*ZERO     ESSAPR           PAID Adds $
     C                     Z-ADD*ZERO     ESSBPR           PAID Adds $/Hd
     C                     Z-ADD*ZERO     ESPDTL           PAID Total Head
     C                     Z-ADD*ZERO     ESSCPR           PAID Total $
     C                     Z-ADD*ZERO     ESSDPR           PAID Total $/Hd
     C                     Z-ADD*ZERO     ESXXNB           DIFF Total Head
     C                     Z-ADD*ZERO     ESSEPR           DIFF Total $
     C                     Z-ADD*ZERO     ESSFPR           DIFF Total $/Hd
     C                     MOVEL$EJ9ST    ESJ9ST           TH Payment Type
     C                     MOVEL*BLANK    ESABCD           PD Producer Cod
      *
     C           KLCRTB    KLIST
     C                     KFLD           ESHMNB           BOH Company Num
     C                     KFLD           ESBNNB           BOH Buy Order N
     C                     KFLD           ESBONB           BOL Load Number
     C                     KFLD           ESCVNB           TH Tattoo Numbe
     C                     KFLD           ESB0DT           TH Kill Date
      * Check for duplicate primary key
     C           KLCRTB    SETLL@ESCPDD                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0900' W0RTN   7
      * Send message 'Eval Tran Value Hdr OU EX'
     C                     MOVEL'PRK0900' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C                     WRITE@ESCPDD                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Rtv PrchPrc Clc Info  RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           AWHMNB           BOH Company Num
     C                     KFLD           AWBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADD$KHMNB    AWHMNB           BOH Company Num
     C                     Z-ADD$KBNNB    AWBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSTC     CHAIN@AWCPBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0049' W0RTN   7
      * USER: Processing if Data record not found
      * 1/28/08 SLM LEFT OVER INFORMATION MAY HAVE CAUSED ISSUES
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0361           BOH Market Add/
     C                     MOVEL*BLANK    WN0362           BOH Quote Price
     C                     Z-ADD*ZERO     WN0363           BOH Quoted Base
     C                     MOVEL*BLANK    WN0364           BOH Commodity M
     C                     MOVEL*BLANK    WN0365           BOH Commodity P
     C                     MOVEL*BLANK    WN0366           BOH Market Date
     C                     MOVEL*BLANK    WN0367           PC Contract Cod
     C                     MOVEL*BLANK    WN0368           PSC Sub-Contrac
     C                     MOVEL*BLANK    WN0369           PO Option Code
     C                     MOVEL*BLANK    WN0370           CMP Program Cod
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAWAAPR    WN0361           BOH Market Add/
     C                     MOVELAWB3ST    WN0362           BOH Quote Price
     C                     Z-ADDAWALPR    WN0363           BOH Quoted Base
     C                     MOVELAWETCD    WN0364           BOH Commodity M
     C                     MOVELAWEUCD    WN0365           BOH Commodity P
     C                     MOVELAWJ5TX    WN0366           BOH Market Date
     C                     MOVELAWAKCD    WN0367           PC Contract Cod
     C                     MOVELAWALCD    WN0368           PSC Sub-Contrac
     C                     MOVELAWAICD    WN0369           PO Option Code
     C                     MOVELAWAMCD    WN0370           CMP Program Cod
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv PurchPrc Clc Info RT - Producer Sub-Contract  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           AQAKCD           PC Contract Cod
     C                     KFLD           AQALCD           PSC Sub-Contrac
      * Setup key
     C                     MOVELWN0367    AQAKCD           PC Contract Cod
     C                     MOVELWN0368    AQALCD           PSC Sub-Contrac
      * Establish starting position
     C           KRSTD     CHAIN@AQCPA0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0037' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0382           PSC Floor Price
     C                     Z-ADD*ZERO     WN0383           PSC Ceiling Pri
     C                     Z-ADD*ZERO     WN0384           PSC Market Perc
     C                     Z-ADD*ZERO     WN0385           PSC Break Even
     C                     Z-ADD*ZERO     WN0386           PSC FLoor Price
     C                     MOVEL*BLANK    WN0387           PSC Sub-Contrac
     C                     Z-ADD*ZERO     WN0388           PSC Mkt Percent
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAQAZPR    WN0382           PSC Floor Price
     C                     Z-ADDAQA0PR    WN0383           PSC Ceiling Pri
     C                     Z-ADDAQA9PC    WN0384           PSC Market Perc
     C                     Z-ADDAQA7PR    WN0385           PSC Break Even
     C                     Z-ADDAQA8PR    WN0386           PSC FLoor Price
     C                     MOVELAQF3ST    WN0387           PSC Sub-Contrac
     C                     Z-ADDAQA9PR    WN0388           PSC Mkt Percent
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Rtv CMP Info          RT - Carcass Merit Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           ARAMCD           CMP Program Cod
      * Setup key
     C                     MOVELWN0370    ARAMCD           CMP Program Cod
      * Establish starting position
     C           KRSTE     CHAIN@ARREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0371           CMP Description
     C                     MOVEL*BLANK    WN0372           CMP Grading Typ
     C                     MOVEL*BLANK    WN0373           CMP Sort Basis
     C                     MOVEL*BLANK    WN0375           CMP Carc Wgt Ty
     C                     Z-ADD*ZERO     WN0376           CMP Std Lean Pe
     C                     Z-ADD*ZERO     WN0377           CMP Lean Factor
     C                     MOVEL*BLANK    WN0378           CMP Optimal Row
     C                     MOVEL*BLANK    WN0379           CMP Type
     C                     Z-ADD*ZERO     WN0380           CMP Market Add/
     C                     MOVEL*BLANK    WN0381           RS Record Statu
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELARA3TX    WN0371           CMP Description
     C                     MOVELARDLST    WN0372           CMP Grading Typ
     C                     MOVELARDMST    WN0373           CMP Sort Basis
     C                     MOVELARDQST    WN0375           CMP Carc Wgt Ty
     C                     Z-ADDARAZPC    WN0376           CMP Std Lean Pe
     C                     Z-ADDARA0PC    WN0377           CMP Lean Factor
     C                     MOVELARDTST    WN0378           CMP Optimal Row
     C                     MOVELARF5ST    WN0379           CMP Type
     C                     Z-ADDARI1PR    WN0380           CMP Market Add/
     C                     MOVELARAJST    WN0381           RS Record Statu
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Rtv StdYld/SortDisc   RT - Carcass Merit Matrix Row  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BYAMCD    WQTF01           CMP Program Cod
      * Define keylist
     C           KPSTF     KLIST
     C                     KFLD           WQTF01           CMP Program Cod
     C                     KFLD           BYEGNB           CMMR Carc Wgt M
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WQTF01           CMP Program Cod
      * Setup key
     C                     MOVELWN0370    WQTF01           CMP Program Cod
     C                     Z-ADD$LAMPC    BYEGNB           CMMR Carc Wgt M
      * Establish starting position
     C           KPSTF     SETLL@BYREJ9                    *
     C           KRSTF     READE@BYREJ9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0132' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0399           CMMR Row Number
     C                     Z-ADD*ZERO     WN0400           CMMR Std Dressi
     C                     Z-ADD*ZERO     WN0390           CD Sort Loss
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBYE8NB    WN0399           CMMR Row Number
     C                     Z-ADDBYAQPC    WN0400           CMMR Std Dressi
     C                     Z-ADDBYEMNB    WN0390           CD Sort Loss
     C                     GOTO TFEXIT                     *QUIT
     C           KRSTF     READE@BYREJ9                  90*
     C                     ENDDO
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BZAMCD    WQTG01           CMP Program Cod
     C           *LIKE     DEFN BZE8NB    WQTG02           CMMR Row Number
      * Define keylist
     C           KPSTG     KLIST
     C                     KFLD           WQTG01           CMP Program Cod
     C                     KFLD           WQTG02           CMMR Row Number
     C                     KFLD           BZA1PC           CMMC Lean Perce
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WQTG01           CMP Program Cod
     C                     KFLD           WQTG02           CMMR Row Number
      * Setup key
     C                     MOVELWN0370    WQTG01           CMP Program Cod
     C                     Z-ADDWN0399    WQTG02           CMMR Row Number
     C                     Z-ADD$LAKPC    BZA1PC           CMMC Lean Perce
      * Establish starting position
     C           KPSTG     SETLL@BZREKA                    *
     C           KRSTG     READE@BZREKA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0402           CMMC Premium Va
     C                     MOVEL*BLANK    WUF6ST           Record Found CM
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDBZERNB    WN0402           CMMC Premium Va
     C                     GOTO TGEXIT                     *QUIT
     C           KRSTG     READE@BZREKA                  90*
     C                     ENDDO
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Rtv Lean Premium % Frc RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAMCD    WQTH01           CMP Program Cod
     C           *LIKE     DEFN WCE8NB    WQTH02           CMMR Row Number
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WQTH01           CMP Program Cod
     C                     KFLD           WQTH02           CMMR Row Number
      * Setup key
     C                     MOVELWN0370    WQTH01           CMP Program Cod
     C                     Z-ADDWN0399    WQTH02           CMMR Row Number
      * Establish starting position
     C           KRSTH     SETLL@BZREPO                    *
     C           KRSTH     READE@BZREPO                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWCERNB    WN0402           CMMC Premium Va
     C                     GOTO THEXIT                     *QUIT
     C           KRSTH     READE@BZREPO                  90*
     C                     ENDDO
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BZAMCD    WQTI01           CMP Program Cod
     C           *LIKE     DEFN BZE8NB    WQTI02           CMMR Row Number
      * Define keylist
     C           KPSTI     KLIST
     C                     KFLD           WQTI01           CMP Program Cod
     C                     KFLD           WQTI02           CMMR Row Number
     C                     KFLD           BZA1PC           CMMC Lean Perce
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           WQTI01           CMP Program Cod
     C                     KFLD           WQTI02           CMMR Row Number
      * Setup key
     C                     MOVELWN0370    WQTI01           CMP Program Cod
     C                     Z-ADDWN0399    WQTI02           CMMR Row Number
     C                     Z-ADDWN0401    BZA1PC           CMMC Lean Perce
      * Establish starting position
     C           KPSTI     SETLL@BZREKA                    *
     C           KRSTI     READE@BZREKA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0402           CMMC Premium Va
     C                     MOVEL*BLANK    WUF6ST           Record Found CM
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDBZERNB    WN0402           CMMC Premium Va
     C                     GOTO TIEXIT                     *QUIT
     C           KRSTI     READE@BZREKA                  90*
     C                     ENDDO
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * Rtv Lean Premium % Frc RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAMCD    WQTJ01           CMP Program Cod
     C           *LIKE     DEFN WCE8NB    WQTJ02           CMMR Row Number
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WQTJ01           CMP Program Cod
     C                     KFLD           WQTJ02           CMMR Row Number
      * Setup key
     C                     MOVELWN0370    WQTJ01           CMP Program Cod
     C                     Z-ADDWN0399    WQTJ02           CMMR Row Number
      * Establish starting position
     C           KRSTJ     SETLL@BZREPO                    *
     C           KRSTJ     READE@BZREPO                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWCERNB    WN0402           CMMC Premium Va
     C                     GOTO TJEXIT                     *QUIT
     C           KRSTJ     READE@BZREPO                  90*
     C                     ENDDO
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * Rtv BckF Premium       RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAMCD    WQTK01           CMP Program Cod
     C           *LIKE     DEFN WDE8NB    WQTK02           CMMR Row Number
      * Define keylist
     C           KPSTK     KLIST
     C                     KFLD           WQTK01           CMP Program Cod
     C                     KFLD           WQTK02           CMMR Row Number
     C                     KFLD           WDE7NB           CMMC Backfat In
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           WQTK01           CMP Program Cod
     C                     KFLD           WQTK02           CMMR Row Number
      * Setup key
     C                     MOVELWN0370    WQTK01           CMP Program Cod
     C                     Z-ADDWN0399    WQTK02           CMMR Row Number
     C                     Z-ADDWUVENB    WDE7NB           CMMC Backfat In
      * Establish starting position
     C           KPSTK     SETLL@BZRETM                    *
     C           KRSTK     READE@BZRETM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0402           CMMC Premium Va
     C                     MOVEL*BLANK    WUF6ST           Record Found CM
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWDERNB    WN0402           CMMC Premium Va
     C                     GOTO TKEXIT                     *QUIT
     C           KRSTK     READE@BZRETM                  90*
     C                     ENDDO
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * Rtv BckF Premium % Frc RT - Carcass Merit Matrix Col  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAMCD    WQTL01           CMP Program Cod
     C           *LIKE     DEFN WEE8NB    WQTL02           CMMR Row Number
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WQTL01           CMP Program Cod
     C                     KFLD           WQTL02           CMMR Row Number
      * Setup key
     C                     MOVELWN0370    WQTL01           CMP Program Cod
     C                     Z-ADDWN0399    WQTL02           CMMR Row Number
      * Establish starting position
     C           KRSTL     SETLL@BZRETL                    *
     C           KRSTL     READE@BZRETL                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0134' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WUF6ST           Record Found CM
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUF6ST           Record Found CM
      * PAR = DB1 By name
     C                     Z-ADDWEERNB    WN0402           CMMC Premium Va
     C                     GOTO TLEXIT                     *QUIT
     C           KRSTL     READE@BZRETL                  90*
     C                     ENDDO
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMCRRC    BEGSR
      *================================================================
      * Crt Eval Tran Val Dtl CR - Eval Tran Value Dtl OUTF  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @ERCPDA
     C                     Z-ADD$LHMNB    ERHMNB           BOH Company Num
     C                     Z-ADD$LBNNB    ERBNNB           BOH Buy Order N
     C                     Z-ADD$LBONB    ERBONB           BOL Load Number
     C                     Z-ADD$LCVNB    ERCVNB           TH Tattoo Numbe
     C                     Z-ADD$LB0DT    ERB0DT           TH Kill Date
     C                     Z-ADDBVFJNB    ERLGNB           CD Scale Sequen
     C                     MOVELYL0018    ERUBST           ETV NonExcep/Ex
     C                     MOVELYL0019    ERUCST           ETV Accepted/De
     C                     Z-ADD$LAMPC    ERAMPC           ET Hot Wgt
     C                     Z-ADD$LAIPC    ERAIPC           ET Backfat Thic
     C                     Z-ADD$LAJPC    ERAJPC           ET Loin-Eye Dep
     C                     Z-ADD$LAKPC    ERAKPC           ET Lean Percent
     C                     Z-ADD$LX8NB    ERX8NB           ET Backfat Thic
     C                     Z-ADD$LFVPC    ERFVPC           ET Loineye Dept
     C                     Z-ADD$LFXPC    ERFXPC           ET Lean Percent
     C                     MOVEL$LDIST    ERDIST           ET Trim Area
     C                     Z-ADD$LAYPR    ERJ4PR           CD CA Gross Val
      *
     C           KLCRTM    KLIST
     C                     KFLD           ERHMNB           BOH Company Num
     C                     KFLD           ERBNNB           BOH Buy Order N
     C                     KFLD           ERBONB           BOL Load Number
     C                     KFLD           ERCVNB           TH Tattoo Numbe
     C                     KFLD           ERB0DT           TH Kill Date
     C                     KFLD           ERLGNB           CD Scale Sequen
      * Check for duplicate primary key
     C           KLCRTM    SETLL@ERCPDA                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0898' W0RTN   7
      * Send message 'Eval Tran Value Dtl OU EX'
     C                     MOVEL'PRK0898' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C                     WRITE@ERCPDA                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * Rtv Hot SclUPL ActPAY RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           WFHMNB           BOH Company Num
     C                     KFLD           WFBNNB           BOH Buy Order N
     C                     KFLD           WFBONB           BOL Load Number
     C                     KFLD           WFCVNB           TH Tattoo Numbe
     C                     KFLD           WFB0DT           TH Kill Date
      * Setup key
     C                     Z-ADD$EHMNB    WFHMNB           BOH Company Num
     C                     Z-ADD$EBNNB    WFBNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    WFBONB           BOL Load Number
     C                     Z-ADD$ECVNB    WFCVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    WFB0DT           TH Kill Date
      * Establish starting position
     C           KRSTN     CHAIN@A1CPC7              90    *
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFHENB    YL0020           TH Head Adds
     C                     Z-ADDWFF7NB    YL0021           TH Avg Live Wgt
     C                     Z-ADDWFHDNB    YL0022           TH Avg Hot Wgt
     C                     Z-ADDWFF4NB    YL0023           TH Avg Lean Per
     C                     Z-ADDWFF3NB    YL0024           TH Avg Loin Eye
     C                     Z-ADDWFF2NB    YL0025           TH Avg Backfat
     C                     Z-ADDWFAWPC    YL0026           TH Actual Yield
     C                     Z-ADDWFCBPR    YL0027           TH Payment Gros
     C           WFFENB    SUB  WFHENB    YL0028           HS Paid Valid C
      * CASE: DB1.TH Head Killed is Not Zero
     C           WFFENB    IFNE 0                          *IF
     C           WFCBPR    DIV  WFFENB    YL0029           HS Act Gross $/
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * Upd Hot Scl Sum OUTF  RT - Hot Scale Upl Summ OUTF  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           EQHMNB           BOH Company Num
     C                     KFLD           EQBNNB           BOH Buy Order N
     C                     KFLD           EQBONB           BOL Load Number
     C                     KFLD           EQCVNB           TH Tattoo Numbe
     C                     KFLD           EQB0DT           TH Kill Date
      * Setup key
     C                     Z-ADD$EHMNB    EQHMNB           BOH Company Num
     C                     Z-ADD$EBNNB    EQBNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    EQBONB           BOL Load Number
     C                     Z-ADD$ECVNB    EQCVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    EQB0DT           TH Kill Date
      * Establish starting position
     C           KRSTO     CHAIN@EQCPC6              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0895' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Hot Scl Sum OUTF  CR - Hot Scale Upl Summ OUTF  * 
     C                     EXSR TPCRRC
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Hot Scl Sum OUTF  CH - Hot Scale Upl Summ OUTF  * 
     C                     EXSR TQCHRC
     C                     ENDIF
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPCRRC    BEGSR
      *================================================================
      * Crt Hot Scl Sum OUTF  CR - Hot Scale Upl Summ OUTF  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EQCPC5
     C                     Z-ADD$EHMNB    WGHMNB           BOH Company Num
     C                     Z-ADD$EBNNB    WGBNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    WGBONB           BOL Load Number
     C                     Z-ADD$ECVNB    WGCVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    WGB0DT           TH Kill Date
     C                     MOVEL$EJ9ST    WGJ9ST           TH Payment Type
     C                     MOVEL$ELLST    WGLLST           TH Hog Class Ty
     C                     Z-ADD$ECXNB    WGCXNB           TH Dead On Arri
     C                     Z-ADD$ECWNB    WGCWNB           TH Head Receive
     C                     Z-ADD$EFCNB    WGFCNB           TH Yard Deads
     C                     Z-ADD$EFDNB    WGFDNB           TH Head Condemn
     C                     Z-ADD$EFENB    WGFENB           TH Head Killed
     C                     Z-ADD$ELFNB    WGVLCR           HS Valid Carcs
     C                     Z-ADD$ELINB    WGEXCR           HS Excep Carcs
     C                     Z-ADD$EIINB    WGVARC           HS Variance
     C                     Z-ADD$EHD3C    WGADCR           HS Added Carcs
     C                     Z-ADD$EHD4C    WGVLDL           HS Valid Delete
     C                     Z-ADD$EHD5C    WGEXDL           HS Excep Delete
     C                     Z-ADD$EMWNB    WGTRCR           HS Trimmed Carc
     C                     Z-ADDYL0028    WGPDVC           HS Paid Valid C
     C                     Z-ADDYL0020    WGAVAD           HS Paid Avg Add
     C                     Z-ADD$EHDNB    WGLVNB           HS Anl Avg Hot
     C                     Z-ADD$EF2NB    WGLZNB           HS Anl Avg Back
     C                     Z-ADD$EF3NB    WGGZPC           HS Anl Avg Loin
     C                     Z-ADD$EF4NB    WGG0PC           HS Anl Avg Lean
     C                     Z-ADD$EQBPR    WGQGPR           HS Anl Cost $/H
     C                     Z-ADD$EK2PR    WGQHPR           HS Anl Prop Gro
     C                     Z-ADD$EQCPR    WGQIPR           HS Anl Best Cos
     C                     Z-ADD$ECUPR    WGQJPR           HS Anl Best Gro
     C                     Z-ADDYL0021    WGF7NB           TH Avg Live Wgt
     C                     Z-ADDYL0022    WGHDNB           TH Avg Hot Wgt
     C                     Z-ADDYL0025    WGF2NB           TH Avg Backfat
     C                     Z-ADDYL0024    WGF3NB           TH Avg Loin Eye
     C                     Z-ADDYL0023    WGF4NB           TH Avg Lean Per
     C                     Z-ADDYL0026    WGAWPC           TH Actual Yield
     C                     Z-ADDYL0027    WGCBPR           TH Payment Gros
     C                     Z-ADDYL0029    WGQFPR           HS Act Gross $/
     C                     MOVEL$EABCD    WGABCD           PD Producer Cod
     C                     MOVEL$EAECD    WGAECD           PL Location Cod
     C                     MOVEL$ELKST    WGAACD           SR Source Code
     C                     MOVEL$EKAST    WGKAST           TH Source Type
      *
     C           KLCRTP    KLIST
     C                     KFLD           WGHMNB           BOH Company Num
     C                     KFLD           WGBNNB           BOH Buy Order N
     C                     KFLD           WGBONB           BOL Load Number
     C                     KFLD           WGCVNB           TH Tattoo Numbe
     C                     KFLD           WGB0DT           TH Kill Date
      * Check for duplicate primary key
     C           KLCRTP    SETLL@EQCPC5                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0896' W0RTN   7
      * Send message 'Hot Scale Upl Summ OUT EX'
     C                     MOVEL'PRK0896' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C                     WRITE@EQCPC5                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQCHRC    BEGSR
      *================================================================
      * Chg Hot Scl Sum OUTF  CH - Hot Scale Upl Summ OUTF  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @EQCPC5
     C                     Z-ADDEQHMNB    WGHMNB           BOH Company Num
     C                     Z-ADDEQBNNB    WGBNNB           BOH Buy Order N
     C                     Z-ADDEQBONB    WGBONB           BOL Load Number
     C                     Z-ADDEQCVNB    WGCVNB           TH Tattoo Numbe
     C                     Z-ADDEQB0DT    WGB0DT           TH Kill Date
      *
     C           KLCHTQ    KLIST
     C                     KFLD           WGHMNB           BOH Company Num
     C                     KFLD           WGBNNB           BOH Buy Order N
     C                     KFLD           WGBONB           BOL Load Number
     C                     KFLD           WGCVNB           TH Tattoo Numbe
     C                     KFLD           WGB0DT           TH Kill Date
     C           KLCHTQ    CHAIN@EQCPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKEQCPL0'MDACP
     C                     MOVEL'@EQCPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKEQ1    YARDCS
      * Move non-key fields to @EQCPC5
     C                     MOVEL$EJ9ST    WGJ9ST    P      TH Payment Type
     C                     MOVEL$ELLST    WGLLST    P      TH Hog Class Ty
     C                     Z-ADD$ECXNB    WGCXNB           TH Dead On Arri
     C                     Z-ADD$ECWNB    WGCWNB           TH Head Receive
     C                     Z-ADD$EFCNB    WGFCNB           TH Yard Deads
     C                     Z-ADD$EFDNB    WGFDNB           TH Head Condemn
     C                     Z-ADD$EFENB    WGFENB           TH Head Killed
     C                     Z-ADD$ELFNB    WGVLCR           HS Valid Carcs
     C                     Z-ADD$ELINB    WGEXCR           HS Excep Carcs
     C                     Z-ADD$EIINB    WGVARC           HS Variance
     C                     Z-ADD$EHD3C    WGADCR           HS Added Carcs
     C                     Z-ADD$EHD4C    WGVLDL           HS Valid Delete
     C                     Z-ADD$EHD5C    WGEXDL           HS Excep Delete
     C                     Z-ADD$EMWNB    WGTRCR           HS Trimmed Carc
     C                     Z-ADDYL0028    WGPDVC           HS Paid Valid C
     C                     Z-ADDYL0020    WGAVAD           HS Paid Avg Add
     C                     Z-ADD$EHDNB    WGLVNB           HS Anl Avg Hot
     C                     Z-ADD$EF2NB    WGLZNB           HS Anl Avg Back
     C                     Z-ADD$EF3NB    WGGZPC           HS Anl Avg Loin
     C                     Z-ADD$EF4NB    WGG0PC           HS Anl Avg Lean
     C                     Z-ADD$EQBPR    WGQGPR           HS Anl Cost $/H
     C                     Z-ADD$EK2PR    WGQHPR           HS Anl Prop Gro
     C                     Z-ADD$EQCPR    WGQIPR           HS Anl Best Cos
     C                     Z-ADD$ECUPR    WGQJPR           HS Anl Best Gro
     C                     Z-ADDYL0021    WGF7NB           TH Avg Live Wgt
     C                     Z-ADDYL0022    WGHDNB           TH Avg Hot Wgt
     C                     Z-ADDYL0025    WGF2NB           TH Avg Backfat
     C                     Z-ADDYL0024    WGF3NB           TH Avg Loin Eye
     C                     Z-ADDYL0023    WGF4NB           TH Avg Lean Per
     C                     Z-ADDYL0026    WGAWPC           TH Actual Yield
     C                     Z-ADDYL0027    WGCBPR           TH Payment Gros
     C                     Z-ADDYL0029    WGQFPR           HS Act Gross $/
     C                     MOVEL$EABCD    WGABCD    P      PD Producer Cod
     C                     MOVEL$EAECD    WGAECD    P      PL Location Cod
     C                     MOVEL$ELKST    WGAACD    P      SR Source Code
     C                     MOVEL$EKAST    WGKAST    P      TH Source Type
      *
      * Set PGM.*Record Data Changed flag
     C           QPKEQ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@EQCPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKEQCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * E3851 JJH 01/20/15 - Recompile so that it can call the
      *  "Chg Re-Evlto Unp TaT XF" funciton with new I-Parm:
      *  Carcass Detail Remove Usr.
      * H16853 ISE 01/23/21 - Increased the length from 5 to 7 and correc
      *                       alignment of Buy Order Number field.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * COMPUTE LEAN % Morrison Hot Scale
      *================================================================
      * Calculate Lean % per Pork Rules
      * Backfat/loin are in inches
      * 2.827
      * + (0.469 * Carcass Weight)
      * - (0.7271657 * Backfat MM)
      * + (0.3867718 * Loin Eye MM)
      * -----------------------------
      * / Carcass Weight
      * * 100
     C           1         MULT 2.827     WUJVNB           Lean % Fld 1 Us
     C           1         MULT 0.469     WUJYNB           Lean % Fld 2 Us
     C                     Z-ADD0.7271657 WUJWNB           Lean % Fld 3 Us
     C                     Z-ADD0.3867718 WUJXNB           Lean % Fld 4 Us
      * CASE: DB1.EA Hot Weight NE WRK.Zero USR
     C           CPKJNB    IFNE WUE9NB                     *IF
      * LEAN % COMPUTE
      * WRK.Lean % Fld 5 Usr =
      *    *COMPUTE (((x1 + (x2 * x5) - (x3 * x6) + (x4 * x7)) / x5 * x8
      *    ))
      * x1    : WRK.Lean % Fld 1 Usr
      * +     : WRK.Lean @ Ext 4 Usr
      * x2    : WRK.Lean % Fld 2 Usr
      * *     : WRK.Lean @ Ext 1 Usr *
      * x5    : DB1.EA Hot Weight
      * -     : WRK.Lean @ Ext 4 Usr
      * x3    : WRK.Lean % Fld 3 Usr
      * *     : WRK.Lean @ Ext 2 Usr *
      * x6    : DB1.EA Backfat MM
      * +     : WRK.Lean @ Ext 4 Usr
      * x4    : WRK.Lean % Fld 4 Usr
      * *     : WRK.Lean @ Ext 3 Usr *
      * x7    : DB1.EA LoinEye MM
      * /     : WRK.Lean % Fld 5 Usr *
      * x5    : DB1.EA Hot Weight
      * *     : WRK.Lean @ Ext 5 Usr *
      * x8    : CON.100
     C           WUJYNB    MULT CPKJNB    WUJ2NB           Lean @ Ext 1 Us
     C           WUJVNB    ADD  WUJ2NB    WUJ5NB           Lean @ Ext 4 Us
     C           WUJWNB    MULT CPX6NB    WUJ3NB           Lean @ Ext 2 Us
     C                     SUB  WUJ3NB    WUJ5NB           Lean @ Ext 4 Us
     C           WUJXNB    MULT CPFQPC    WUJ4NB           Lean @ Ext 3 Us
     C                     ADD  WUJ4NB    WUJ5NB           Lean @ Ext 4 Us
     C           WUJ5NB    DIV  CPKJNB    WUJZNB           Lean % Fld 5 Us
     C           WUJZNB    MULT 100       WUJ6NB           Lean @ Ext 5 Us
     C                     Z-ADDWUJ6NB    WUJZNB           Lean % Fld 5 Us
     C                     END                             *FI
     C           WUJZNB    MULT 1         WUAKPC    H      ET Lean Percent
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Accumulation
      *================================================================
     C                     ADD  CPKJNB    $EKGNB           Hot Weight Tot
      * Weighted accumulated Lean%
     C           WUAKPC    MULT CPKJNB    YL0003           Hot Wgt/Weight
     C                     ADD  YL0003    $EJONB           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           CPKKNB    MULT CPKJNB    YL0003           Hot Wgt/Weight
     C                     ADD  YL0003    $EL0NB           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           CPBQPC    MULT CPKJNB    YL0003           Hot Wgt/Weight
     C                     ADD  YL0003    $EL1NB           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           CPBRPC    MULT CPKJNB    YL0003           Hot Wgt/Weight
     C                     ADD  YL0003    YL0001           Hot Wgt/LghtR A
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Accumulation
      *================================================================
     C                     ADD  CPKJNB    $EKGNB           Hot Weight Tot
      * Weighted accumulated Lean%
     C           WUAKPC    MULT CPKJNB    YL0003           Hot Wgt/Weight
     C                     ADD  YL0003    $EJONB           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           CPKKNB    MULT CPKJNB    YL0003           Hot Wgt/Weight
     C                     ADD  YL0003    $EL0NB           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           CPBQPC    MULT CPKJNB    YL0003           Hot Wgt/Weight
     C                     ADD  YL0003    $EL1NB           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           CPBRPC    MULT CPKJNB    YL0003           Hot Wgt/Weight
     C                     ADD  YL0003    YL0001           Hot Wgt/LghtR A
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Accumulation
      *================================================================
     C                     ADD  BVAMPC    $EKGNB           Hot Weight Tot
      * Weighted accumulated Lean%
     C           BVAKPC    MULT BVAMPC    YL0004           Hot Wgt/Weight
     C                     ADD  YL0004    $EJONB           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           BVAIPC    MULT BVAMPC    YL0004           Hot Wgt/Weight
     C                     ADD  YL0004    $EL0NB           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           BVAJPC    MULT BVAMPC    YL0004           Hot Wgt/Weight
     C                     ADD  YL0004    $EL1NB           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           BVALPC    MULT BVAMPC    YL0004           Hot Wgt/Weight
     C                     ADD  YL0004    YL0001           Hot Wgt/LghtR A
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Accumulation
      *================================================================
     C                     ADD  BVAMPC    $EKGNB           Hot Weight Tot
      * Weighted accumulated Lean%
     C           BVAKPC    MULT BVAMPC    YL0004           Hot Wgt/Weight
     C                     ADD  YL0004    $EJONB           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           BVAIPC    MULT BVAMPC    YL0004           Hot Wgt/Weight
     C                     ADD  YL0004    $EL0NB           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           BVAJPC    MULT BVAMPC    YL0004           Hot Wgt/Weight
     C                     ADD  YL0004    $EL1NB           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           BVALPC    MULT BVAMPC    YL0004           Hot Wgt/Weight
     C                     ADD  YL0004    YL0001           Hot Wgt/LghtR A
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Accumulation
      *================================================================
     C                     ADD  BVAMPC    $EKGNB           Hot Weight Tot
      * Weighted accumulated Lean%
     C           BVAKPC    MULT BVAMPC    YL0004           Hot Wgt/Weight
     C                     ADD  YL0004    $EJONB           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           BVAIPC    MULT BVAMPC    YL0004           Hot Wgt/Weight
     C                     ADD  YL0004    $EL0NB           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           BVAJPC    MULT BVAMPC    YL0004           Hot Wgt/Weight
     C                     ADD  YL0004    $EL1NB           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           BVALPC    MULT BVAMPC    YL0004           Hot Wgt/Weight
     C                     ADD  YL0004    YL0001           Hot Wgt/LghtR A
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Eval Trans w/FOM  PO
      *================================================================
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.*Record selected is *NO
      *   |- c2    : PAR.Print Invalid Carcs USR is No
      *   '-
     C           YL0005    IFEQ 'N'                        *IF
     C           P4T8ST    OREQ 'N'                        *OR
     C                     GOTO UHEXIT                     *QUIT
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0319  52       BOH Market Add/
     C                     MOVEL*BLANK    WN0320  2        BOH Quote Price
     C                     Z-ADD*ZERO     WN0321  52       BOH Quoted Base
     C                     MOVEL*BLANK    WN0322  3        BOH Commodity M
     C                     MOVEL*BLANK    WN0323  7        BOH Commodity P
     C                     MOVEL*BLANK    WN0324  3        BOH Market Date
     C                     MOVEL*BLANK    WN0325  5        PC Contract Cod
     C                     MOVEL*BLANK    WN0326  5        PSC Sub-Contrac
     C                     MOVEL*BLANK    WN0327  3        PO Option Code
     C                     MOVEL*BLANK    WN0328  3        CMP Program Cod
     C                     MOVEL*BLANK    WN0329 25        CMP Description
     C                     MOVEL*BLANK    WN0330  1        CMP Grading Typ
     C                     MOVEL*BLANK    WN0331  1        CMP Sort Basis
     C                     MOVEL*BLANK    WN0332  1        CMP Sts
     C                     MOVEL*BLANK    WN0333  2        CMP Carc Wgt Ty
     C                     Z-ADD*ZERO     WN0334  31       CMP Std Lean Pe
     C                     Z-ADD*ZERO     WN0335  31       CMP Lean Factor
     C                     MOVEL*BLANK    WN0336  1        CMP Optimal Row
     C                     MOVEL*BLANK    WN0337  1        CMP Type
     C                     Z-ADD*ZERO     WN0338  52       CMP Market Add/
     C                     MOVEL*BLANK    WN0339  1        RS Record Statu
     C                     Z-ADD*ZERO     WN0340  52       PSC Floor Price
     C                     Z-ADD*ZERO     WN0341  52       PSC Ceiling Pri
     C                     Z-ADD*ZERO     WN0342  30       PSC Market Perc
     C                     Z-ADD*ZERO     WN0343  52       PSC Break Even
     C                     Z-ADD*ZERO     WN0344  52       PSC FLoor Price
     C                     MOVEL*BLANK    WN0345  1        PSC Sub-Contrac
     C                     Z-ADD*ZERO     WN0346  52       PSC Mkt Percent
     C                     MOVEL*BLANK    WN0347  1        Exception Statu
      *
      * Prt Eval Trans w/FOM  PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * LEAN PERCENT NPPC
      *================================================================
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
     C                     EXSR SURVGN
      * Rtv Lean% Premium if not found in table, then use lowest
      * CASE: WRK.Record Found CMMC USR is No
     C           WUF6ST    IFEQ 'N'                        *IF
      * Rtv Lean Premium % Frc RT - Carcass Merit Matrix Col  * 
     C                     EXSR SVRVGN
     C                     END                             *FI
      * Total Carcss Per CWT MULT
      * PAR.CD Gross Value Per CWT =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.CD Crc Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CMMC Premium Value
     C           WN0351    MULT WN0360    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0356           CD Gross Value
      * Total Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Gross Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           $HAMPC    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0356    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $HAYPR           CD Gross Value
      * Lean Premium Per CWT
      * PAR.CD Lean Premium CWT =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value Per CWT
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value Per CWT
     C           WN0356    SUB  WN0351    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0354           CD Lean Premium
      * Lean Premium Value
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value $ Per HD
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value $ Per Hd
     C           $HAYPR    SUB  WN0353    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0355           CD Lean Premium
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * LEAN PERCENT  FAT O METER
      *================================================================
      * ---------------------------------------------------------------
      * Added 6/11/99 by Purva for C0007557.
      * Add Lean Factor/Lean % +/- to Lean Percent MM
      * CASE: PAR.CMP Lean Factor is Greater than 0
     C           WN0335    IFGT 0                          *IF
     C           $HFXPC    ADD  WN0335    WN0359           CMMC Lean Perce
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD$HFXPC    WN0359           CMMC Lean Perce
     C                     END                             *FI
      * ---------------------------------------------------------------
     C                     Z-ADD*ZERO     WN0360           CMMC Premium Va
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
     C                     EXSR SWRVGN
      * Rtv Lean% Premium if not found in table, then use lowest
      * CASE: WRK.Record Found CMMC USR is No
     C           WUF6ST    IFEQ 'N'                        *IF
      * Rtv Lean Premium % Frc RT - Carcass Merit Matrix Col  * 
     C                     EXSR SXRVGN
     C                     END                             *FI
      * Add the meat premium
      * Total Carcass Per CWT add
      * PAR.CD Gross Value Per CWT =
      *    *COMPUTE (x1 + x2)
      * x1    : PAR.CD Crc Value Per CWT
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.CMMC Premium Value
     C           WN0351    ADD  WN0360    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0356           CD Gross Value
      * Total Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Gross Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           $HAMPC    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0356    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $HAYPR           CD Gross Value
      * Lean Premium Per CWT
      * PAR.CD Lean Premium CWT =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value Per CWT
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value Per CWT
     C           WN0356    SUB  WN0351    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0354           CD Lean Premium
      * Lean Premium Value
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value $ Per HD
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value $ Per Hd
     C           $HAYPR    SUB  WN0353    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0355           CD Lean Premium
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * Backfat
      *================================================================
      * CASE: PAR.CMP Program Code is IBP
     C           WN0328    IFEQ 'IBP'                      *IF
     C           $HAIPC    ADD  .1        WUVENB           Backfat USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD$HAIPC    WUVENB           Backfat USR
     C                     END                             *FI
      * Rtv BckF Premium       RT - Carcass Merit Matrix Col  * 
     C                     EXSR SYRVGN
      * Rtv Bckf Premium if not found in table, then use lowest
      * CASE: WRK.Record Found CMMC USR is No
     C           WUF6ST    IFEQ 'N'                        *IF
      * Rtv BckF Premium % Frc RT - Carcass Merit Matrix Col  * 
     C                     EXSR SZRVGN
     C                     END                             *FI
      * Lean Premium Per Cwt
     C                     Z-ADDWN0360    WN0354           CD Lean Premium
      * Lean Premium Value
      * Lean Premium Value
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE ((x1 * (x2 / x3)))
      * x1    : PAR.CD Lean Premium CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           $HAMPC    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0354    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0355           CD Lean Premium
      * Gross Value Per cwt
      * Total Carcass Per CWT
      * PAR.CD Gross Value Per CWT =
      *    *COMPUTE (x1 + x2)
      * x1    : PAR.CD Crc Value Per CWT
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Lean Premium CWT
     C           WN0351    ADD  WN0354    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0356           CD Gross Value
      * Gross Value $
      * Total Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 + x2)
      * x1    : PAR.CD Crc Value $ Per Hd
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Lean Premium $ Per Hd
     C           WN0353    ADD  WN0355    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    $HAYPR           CD Gross Value
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * Lean Factor
      *================================================================
      * Diff actual/Std Lean%
      * PAR.CMMC Premium Value =
      *    *COMPUTE ((x1 - x2) / x3)
      * x1    : PAR.CD Lean Percent
      * -     : PGM.*Synon (17,7) work field
      * x2    : PAR.CMP Std Lean Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $HAKPC    SUB  WN0334    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  100       W0WB00    H      *Synon (15,5) w
     C                     Z-ADDW0WB00    WN0360           CMMC Premium Va
      * multiple by lean factor
      * PAR.CMMC Premium Value =
      *    *COMPUTE ((x1 * x2) / x3)
      * x1    : PAR.CMMC Premium Value
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x2    : PAR.CMP Lean Factor
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WN0360    MULT WN0335    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  100       W0WB00    H      *Synon (15,5) w
     C                     Z-ADDW0WB00    WN0360           CMMC Premium Va
      * Lean Premium Per Cwt
     C           WN0360    MULT $EAMPR    WN0354    H      CD Lean Premium
      * Lean Premium Value
      * Lean Premium Value
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE ((x1 * (x2 / x3)))
      * x1    : PAR.CD Lean Premium CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           $HAMPC    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0354    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0355           CD Lean Premium
      * Gross Value Per cwt
      * Total Carcass Per CWT
      * PAR.CD Gross Value Per CWT =
      *    *COMPUTE (x1 + x2)
      * x1    : PAR.CD Crc Value Per CWT
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Lean Premium CWT
     C           WN0351    ADD  WN0354    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0356           CD Gross Value
      * Gross Value $
      * Total Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 + x2)
      * x1    : PAR.CD Crc Value $ Per Hd
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Lean Premium $ Per Hd
     C           WN0353    ADD  WN0355    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    $HAYPR           CD Gross Value
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Eval Trans wo/FOM PO
      *================================================================
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.*Record selected is *NO
      *   |- c2    : PAR.Print Invalid Carcs USR is No
      *   '-
     C           YL0005    IFEQ 'N'                        *IF
     C           P4T8ST    OREQ 'N'                        *OR
     C                     GOTO UMEXIT                     *QUIT
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0361  52       BOH Market Add/
     C                     MOVEL*BLANK    WN0362  2        BOH Quote Price
     C                     Z-ADD*ZERO     WN0363  52       BOH Quoted Base
     C                     MOVEL*BLANK    WN0364  3        BOH Commodity M
     C                     MOVEL*BLANK    WN0365  7        BOH Commodity P
     C                     MOVEL*BLANK    WN0366  3        BOH Market Date
     C                     MOVEL*BLANK    WN0367  5        PC Contract Cod
     C                     MOVEL*BLANK    WN0368  5        PSC Sub-Contrac
     C                     MOVEL*BLANK    WN0369  3        PO Option Code
     C                     MOVEL*BLANK    WN0370  3        CMP Program Cod
     C                     MOVEL*BLANK    WN0371 25        CMP Description
     C                     MOVEL*BLANK    WN0372  1        CMP Grading Typ
     C                     MOVEL*BLANK    WN0373  1        CMP Sort Basis
     C                     MOVEL*BLANK    WN0374  1        CMP Sts
     C                     MOVEL*BLANK    WN0375  2        CMP Carc Wgt Ty
     C                     Z-ADD*ZERO     WN0376  31       CMP Std Lean Pe
     C                     Z-ADD*ZERO     WN0377  31       CMP Lean Factor
     C                     MOVEL*BLANK    WN0378  1        CMP Optimal Row
     C                     MOVEL*BLANK    WN0379  1        CMP Type
     C                     Z-ADD*ZERO     WN0380  52       CMP Market Add/
     C                     MOVEL*BLANK    WN0381  1        RS Record Statu
     C                     Z-ADD*ZERO     WN0382  52       PSC Floor Price
     C                     Z-ADD*ZERO     WN0383  52       PSC Ceiling Pri
     C                     Z-ADD*ZERO     WN0384  30       PSC Market Perc
     C                     Z-ADD*ZERO     WN0385  52       PSC Break Even
     C                     Z-ADD*ZERO     WN0386  52       PSC FLoor Price
     C                     MOVEL*BLANK    WN0387  1        PSC Sub-Contrac
     C                     Z-ADD*ZERO     WN0388  52       PSC Mkt Percent
     C                     MOVEL*BLANK    WN0389  1        Exception Statu
      *
      * Prt Eval Trans wo/FOM PO: Mainline
     C                     EXSR C0MAIN
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         UNSUBR    BEGSR
      *================================================================
      * LEAN PERCENT NPPC
      *================================================================
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
     C                     EXSR TGRVGN
      * Rtv Lean% Premium if not found in table, then use lowest
      * CASE: WRK.Record Found CMMC USR is No
     C           WUF6ST    IFEQ 'N'                        *IF
      * Rtv Lean Premium % Frc RT - Carcass Merit Matrix Col  * 
     C                     EXSR THRVGN
     C                     END                             *FI
      * Total Carcss Per CWT MULT
      * PAR.CD Gross Value Per CWT =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.CD Crc Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CMMC Premium Value
     C           WN0393    MULT WN0402    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0398           CD Gross Value
      * Total Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Gross Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           $LAMPC    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0398    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $LAYPR           CD Gross Value
      * Lean Premium Per CWT
      * PAR.CD Lean Premium CWT =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value Per CWT
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value Per CWT
     C           WN0398    SUB  WN0393    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0396           CD Lean Premium
      * Lean Premium Value
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value $ Per HD
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value $ Per Hd
     C           $LAYPR    SUB  WN0395    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0397           CD Lean Premium
      *================================================================
     CSR         UNEXIT    ENDSR
      /EJECT
     CSR         UOSUBR    BEGSR
      *================================================================
      * LEAN PERCENT  FAT O METER
      *================================================================
      * ---------------------------------------------------------------
      * Added 6/11/99 by Purva for C0007557.
      * Add Lean Factor/Lean % +/- to Lean Percent MM
      * CASE: PAR.CMP Lean Factor is Greater than 0
     C           WN0377    IFGT 0                          *IF
     C           $LFXPC    ADD  WN0377    WN0401           CMMC Lean Perce
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD$LFXPC    WN0401           CMMC Lean Perce
     C                     END                             *FI
      * ---------------------------------------------------------------
     C                     Z-ADD*ZERO     WN0402           CMMC Premium Va
      * Rtv Lean Premium %    RT - Carcass Merit Matrix Col  * 
     C                     EXSR TIRVGN
      * Rtv Lean% Premium if not found in table, then use lowest
      * CASE: WRK.Record Found CMMC USR is No
     C           WUF6ST    IFEQ 'N'                        *IF
      * Rtv Lean Premium % Frc RT - Carcass Merit Matrix Col  * 
     C                     EXSR TJRVGN
     C                     END                             *FI
      * Add the meat premium
      * Total Carcass Per CWT add
      * PAR.CD Gross Value Per CWT =
      *    *COMPUTE (x1 + x2)
      * x1    : PAR.CD Crc Value Per CWT
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.CMMC Premium Value
     C           WN0393    ADD  WN0402    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0398           CD Gross Value
      * Total Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.CD Gross Value Per CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           $LAMPC    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0398    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    $LAYPR           CD Gross Value
      * Lean Premium Per CWT
      * PAR.CD Lean Premium CWT =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value Per CWT
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value Per CWT
     C           WN0398    SUB  WN0393    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0396           CD Lean Premium
      * Lean Premium Value
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE (x1 - x2)
      * x1    : PAR.CD Gross Value $ Per HD
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Crc Value $ Per Hd
     C           $LAYPR    SUB  WN0395    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0397           CD Lean Premium
      *================================================================
     CSR         UOEXIT    ENDSR
      /EJECT
     CSR         UPSUBR    BEGSR
      *================================================================
      * Backfat
      *================================================================
      * CASE: PAR.CMP Program Code is IBP
     C           WN0370    IFEQ 'IBP'                      *IF
     C           $LAIPC    ADD  .1        WUVENB           Backfat USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD$LAIPC    WUVENB           Backfat USR
     C                     END                             *FI
      * Rtv BckF Premium       RT - Carcass Merit Matrix Col  * 
     C                     EXSR TKRVGN
      * Rtv Bckf Premium if not found in table, then use lowest
      * CASE: WRK.Record Found CMMC USR is No
     C           WUF6ST    IFEQ 'N'                        *IF
      * Rtv BckF Premium % Frc RT - Carcass Merit Matrix Col  * 
     C                     EXSR TLRVGN
     C                     END                             *FI
      * Lean Premium Per Cwt
     C                     Z-ADDWN0402    WN0396           CD Lean Premium
      * Lean Premium Value
      * Lean Premium Value
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE ((x1 * (x2 / x3)))
      * x1    : PAR.CD Lean Premium CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           $LAMPC    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0396    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0397           CD Lean Premium
      * Gross Value Per cwt
      * Total Carcass Per CWT
      * PAR.CD Gross Value Per CWT =
      *    *COMPUTE (x1 + x2)
      * x1    : PAR.CD Crc Value Per CWT
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Lean Premium CWT
     C           WN0393    ADD  WN0396    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0398           CD Gross Value
      * Gross Value $
      * Total Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 + x2)
      * x1    : PAR.CD Crc Value $ Per Hd
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Lean Premium $ Per Hd
     C           WN0395    ADD  WN0397    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    $LAYPR           CD Gross Value
      *================================================================
     CSR         UPEXIT    ENDSR
      /EJECT
     CSR         UQSUBR    BEGSR
      *================================================================
      * Lean Factor
      *================================================================
      * Diff actual/Std Lean%
      * PAR.CMMC Premium Value =
      *    *COMPUTE ((x1 - x2) / x3)
      * x1    : PAR.CD Lean Percent
      * -     : PGM.*Synon (17,7) work field
      * x2    : PAR.CMP Std Lean Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           $LAKPC    SUB  WN0376    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  100       W0WB00    H      *Synon (15,5) w
     C                     Z-ADDW0WB00    WN0402           CMMC Premium Va
      * multiple by lean factor
      * PAR.CMMC Premium Value =
      *    *COMPUTE ((x1 * x2) / x3)
      * x1    : PAR.CMMC Premium Value
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x2    : PAR.CMP Lean Factor
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WN0402    MULT WN0377    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  100       W0WB00    H      *Synon (15,5) w
     C                     Z-ADDW0WB00    WN0402           CMMC Premium Va
      * Lean Premium Per Cwt
     C           WN0402    MULT $EAMPR    WN0396    H      CD Lean Premium
      * Lean Premium Value
      * Lean Premium Value
      * PAR.CD Lean Premium $ Per Hd =
      *    *COMPUTE ((x1 * (x2 / x3)))
      * x1    : PAR.CD Lean Premium CWT
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.CD Carcass/Hot Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           $LAMPC    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WN0396    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0397           CD Lean Premium
      * Gross Value Per cwt
      * Total Carcass Per CWT
      * PAR.CD Gross Value Per CWT =
      *    *COMPUTE (x1 + x2)
      * x1    : PAR.CD Crc Value Per CWT
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Lean Premium CWT
     C           WN0393    ADD  WN0396    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0398           CD Gross Value
      * Gross Value $
      * Total Carcass Value
      * PAR.CD Gross Value $ Per HD =
      *    *COMPUTE (x1 + x2)
      * x1    : PAR.CD Crc Value $ Per Hd
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.CD Lean Premium $ Per Hd
     C           WN0395    ADD  WN0397    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    $LAYPR           CD Gross Value
      *================================================================
     CSR         UQEXIT    ENDSR
      /EJECT
     CSR         URSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Eval Trans Inv    PO
      *================================================================
     C                     GOTO UREXIT                     *QUIT
      * CASE: PAR.Print Invalid Carcs USR is No
     C           P4T8ST    IFEQ 'N'                        *IF
     C                     GOTO UREXIT                     *QUIT
     C                     END                             *FI
     C           $QB4NB    ADD  $QXRNB    YL0031           Head Total Sum5
     C                     MOVELWUCRTX    YL0032           TH Schedule Kil
      * Prt Eval Trans Inv    PO: Mainline
     C                     EXSR D0MAIN
      *================================================================
     CSR         UREXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P7IINB           Difference +/-
     C                     Z-ADD*ZERO     P8P0NB           Count USR
     C                     Z-ADD*ZERO     P9QFNB           Avg Hot Wgt
     C                     Z-ADD*ZERO     P9P8NB           Avg Backfat
     C                     Z-ADD*ZERO     P9ENPC           Avg Loin eye
     C                     Z-ADD*ZERO     P9EOPC           Avg Lean Percen
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Carcass Dbw Min
     C                     Z-ADD*ZERO     WUI7NB  71
      * Define work field Carcass Dbw Max
     C                     Z-ADD*ZERO     WUI8NB  71
      * Define work field Carcass Lgt Min
     C                     Z-ADD*ZERO     WUI9NB  71
      * Define work field Carcass Lgt Max
     C                     Z-ADD*ZERO     WUJANB  71
      * Define work field %Lean High Min
     C                     Z-ADD*ZERO     WUJBNB  71
      * Define work field %Lean High Max
     C                     Z-ADD*ZERO     WUJLNB  71
      * Define work field %Lean Low Min
     C                     Z-ADD*ZERO     WUJMNB  71
      * Define work field %Lean Low Max
     C                     Z-ADD*ZERO     WUJCNB  71
      * Define work field High Yield Min
     C                     Z-ADD*ZERO     WUJDNB  71
      * Define work field High Yield Max
     C                     Z-ADD*ZERO     WUJENB  71
      * Define work field Low Yield Min
     C                     Z-ADD*ZERO     WUJFNB  71
      * Define work field Low Yield Max
     C                     Z-ADD*ZERO     WUJGNB  71
      * Define work field Head < Percent Min
     C                     Z-ADD*ZERO     WUJHNB  71
      * Define work field Head < Percent Max
     C                     Z-ADD*ZERO     WUJINB  71
      * Define work field Head > Percent Min
     C                     Z-ADD*ZERO     WUJJNB  71
      * Define work field Head > Percent Max
     C                     Z-ADD*ZERO     WUJKNB  71
      * Define work field BackFat High Min
     C                     Z-ADD*ZERO     WUK5NB  71
      * Define work field BackFat High Max
     C                     Z-ADD*ZERO     WUK6NB  71
      * Define work field BackFat Low Min
     C                     Z-ADD*ZERO     WUK7NB  71
      * Define work field Backfat Low Max
     C                     Z-ADD*ZERO     WUK8NB  71
      * Define work field LoinEye High Min
     C                     Z-ADD*ZERO     WUK9NB  71
      * Define work field LoinEye High Max
     C                     Z-ADD*ZERO     WULANB  71
      * Define work field LoinEye Low Min
     C                     Z-ADD*ZERO     WULBNB  71
      * Define work field LoinEye Low Max
     C                     Z-ADD*ZERO     WULCNB  71
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    A1HMNB           BOH Company Num
     C                     MOVEL*LOVAL    A1B0DT           TH Kill Date
     C                     MOVEL*LOVAL    A1ABCD           PD Producer Cod
     C                     MOVEL*LOVAL    A1BNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    A1BONB           BOL Load Number
     C                     MOVEL*LOVAL    A1CVNB           TH Tattoo Numbe
      * Define work field Invalid Y/N USR
     C                     MOVEL*BLANK    WUG3ST  1
      * Define work field ET Error Sts
     C                     MOVEL*BLANK    WUD2ST  1
      * Define work field Lean % Fld 1 Usr
     C                     Z-ADD*ZERO     WUJVNB 177
      * Define work field Lean % Fld 2 Usr
     C                     Z-ADD*ZERO     WUJYNB 177
      * Define work field Lean % Fld 3 Usr
     C                     Z-ADD*ZERO     WUJWNB 177
      * Define work field Lean % Fld 4 Usr
     C                     Z-ADD*ZERO     WUJXNB 177
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Define work field Lean @ Ext 1 Usr
     C                     Z-ADD*ZERO     WUJ2NB 177
      * Define work field Lean @ Ext 4 Usr
     C                     Z-ADD*ZERO     WUJ5NB 177
      * Define work field Lean @ Ext 2 Usr
     C                     Z-ADD*ZERO     WUJ3NB 177
      * Define work field Lean @ Ext 3 Usr
     C                     Z-ADD*ZERO     WUJ4NB 177
      * Define work field Lean % Fld 5 Usr
     C                     Z-ADD*ZERO     WUJZNB 177
      * Define work field Lean @ Ext 5 Usr
     C                     Z-ADD*ZERO     WUJ6NB 177
      * Define work field ET Lean Percent NPPC
     C                     Z-ADD*ZERO     WUAKPC  31
      * Define work field KV Error Code
     C                     MOVEL*BLANK    WUDXST  3
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Define work field CD Shift
     C                     MOVEL*BLANK    WUIQST  1
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Display Field Usr
     C                     MOVEL*BLANK    WUHDST  4
      * Define work field Head 6
     C                     Z-ADD*ZERO     WULKIR  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WALGNB           CD Scale Sequen
     C                     Z-ADD*ZERO     WAEUNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WALHNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WABEPR           CD Sort Loss
     C                     Z-ADD*ZERO     WAASPC           CD STD Yield
     C                     Z-ADD*ZERO     WAEWNB           CD Carcass/Hot
     C                     Z-ADD*ZERO     WAB4PR           CD Base Carcass
     C                     Z-ADD*ZERO     WAEYNB           CD Crc Value Pe
     C                     Z-ADD*ZERO     WAB1PR           CD Base Carc Va
     C                     Z-ADD*ZERO     WAAVPR           CD Crc Value $
     C                     Z-ADD*ZERO     WAAUPC           CD Lean Percent
     C                     Z-ADD*ZERO     WAAWPR           CD Lean Premium
     C                     Z-ADD*ZERO     WAAXPR           CD Lean Premium
     C                     Z-ADD*ZERO     WAEZNB           CD Gross Value
     C                     Z-ADD*ZERO     WAAYPR           CD Gross Value
     C                     Z-ADD*ZERO     WABBDT           CD Kill Date
     C                     Z-ADD*ZERO     WAAKTM           CD Kill Time
     C                     Z-ADD*ZERO     WAH6NB           CD Backfat Thic
     C                     Z-ADD*ZERO     WABEPC           CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WAGCST           CD Light Reflec
     C                     Z-ADD*ZERO     WABHPC           CD FFLI
     C                     Z-ADD*ZERO     WALTNB           CD LOT
     C                     Z-ADD*ZERO     WAX4NB           CD Backfat Thic
     C                     Z-ADD*ZERO     WAFNPC           CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WAFOPC           CD Light Reflec
     C                     Z-ADD*ZERO     WAFPPC           CD Lean Percent
     C                     Z-ADD*ZERO     WAJWPR           CD CA Sort Loss
     C                     Z-ADD*ZERO     WAF5PC           CD CA Std Yield
     C                     Z-ADD*ZERO     WAJXPR           CD CA Base Carc
     C                     Z-ADD*ZERO     WAJYPR           CD CA Crc Value
     C                     Z-ADD*ZERO     WAJZPR           CD CA Base Carc
     C                     Z-ADD*ZERO     WAJ0PR           CD CA Crc Value
     C                     Z-ADD*ZERO     WAJ1PR           CD CA Lean Prem
     C                     Z-ADD*ZERO     WAJ2PR           CD CA Lean Prem
     C                     Z-ADD*ZERO     WAJ3PR           CD CA Gross Val
     C                     Z-ADD*ZERO     WAJ4PR           CD CA Gross Val
     C                     Z-ADD*ZERO     WADKJR           CD Loin Eye Inc
     C                     Z-ADD*ZERO     WAITJF           CD Backfat Inch
     C                     Z-ADD*ZERO     WAIJGR           CD Meat Value F
     C                     Z-ADD*ZERO     WAORJE           CD Lean Prem/Di
     C                     Z-ADD*ZERO     WAOTJR           CD Fixed Cost F
     C                     Z-ADD*ZERO     WAPEIR           CD MPR Sort Los
     C                     Z-ADD*ZERO     WAIEUF           CD Meat Value F
     C                     Z-ADD*ZERO     WAORUE           CD Fixed Cost F
     C                     Z-ADD*ZERO     WAIUTR           CD Gross Before
     C                     Z-ADD*ZERO     WAIJRR           CD Gross Before
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    BVHMNB           BOH Company Num
     C                     MOVEL*LOVAL    BVBNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    BVBONB           BOL Load Number
     C                     MOVEL*LOVAL    BVCVNB           TH Tattoo Numbe
     C                     MOVEL*LOVAL    BVB0DT           TH Kill Date
     C                     MOVEL*LOVAL    BVFJNB           ET Scale Sequen
     C                     MOVEL*LOVAL    BVHCNB           ET Carcass Numb
     C                     MOVEL*LOVAL    BVGDNB           ET Carcass Numb
      * Define work field Record Found CMMC USR
     C                     MOVEL*BLANK    WUF6ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCE8NB           CMMR Row Number
     C                     Z-ADD*ZERO     WCE4NB           CMMC Column Num
     C                     Z-ADD*ZERO     WCA1PC           CMMC Lean Perce
     C                     Z-ADD*ZERO     WCE7NB           CMMC Backfat In
     C                     Z-ADD*ZERO     WCERNB           CMMC Premium Va
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Define work field Backfat USR
     C                     Z-ADD*ZERO     WUVENB  31
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    BVHMNB           BOH Company Num
     C                     MOVEL*LOVAL    BVBNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    BVBONB           BOL Load Number
     C                     MOVEL*LOVAL    BVCVNB           TH Tattoo Numbe
     C                     MOVEL*LOVAL    BVB0DT           TH Kill Date
     C                     MOVEL*LOVAL    BVFJNB           ET Scale Sequen
     C                     MOVEL*LOVAL    BVHCNB           ET Carcass Numb
     C                     MOVEL*LOVAL    BVGDNB           ET Carcass Numb
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WFBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WFBONB           BOL Load Number
     C                     Z-ADD*ZERO     WFCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WFB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WFAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WFACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WFB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WFCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WFAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WFA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WFCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WFCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WFFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WFH9NB           TH Held Over
     C                     Z-ADD*ZERO     WFFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WFFENB           TH Head Killed
     C                     Z-ADD*ZERO     WFHENB           TH Head Adds
     C                     Z-ADD*ZERO     WFHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WFCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WFLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WFE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WFA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WFFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WFA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WFF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WFHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WFF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WFF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WFF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WFF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WFAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WFAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WFCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WFA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WFA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WFB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WFAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WFANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WFAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WFAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WFAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WFAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WFAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WFASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WFA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WFATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WFA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WFCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WFCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WFLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WFCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WFA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WFA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WFGHNB           TH Commission A
     C                     Z-ADD*ZERO     WFBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WFBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WFBTDT           TH Commission P
     C                     Z-ADD*ZERO     WFBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WFHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WFHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WFHINB           TH FFLI
     C                     Z-ADD*ZERO     WFA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WFA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WFA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WFJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WFD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WFD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WFD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WFD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WFEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WFEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WFECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WFEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WFEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WFEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WFEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WFEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WFOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WFTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WFT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WFTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WFT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WFOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WFKOER           TH Head Identif
     C                     Z-ADD*ZERO     WFOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WFOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WFIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WFOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WFHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WFS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WFTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WFTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WFJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WFKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WFKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WFKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WFKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WFOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WFIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WFIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WFIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WFKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WFOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WFKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WFORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WFOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WFMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WFMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WFNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WFNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WFIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WFKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WFEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WFEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WFECDT           TH Head LFT
     C                     Z-ADD*ZERO     WFEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WFEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WFAADT           RS Date Changed
     C                     Z-ADD*ZERO     WFAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WFABDT           RS Date Added
     C                     Z-ADD*ZERO     WFABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WGBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WGBONB           BOL Load Number
     C                     Z-ADD*ZERO     WGCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WGB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WGCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WGCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WGFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WGFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WGFENB           TH Head Killed
     C                     Z-ADD*ZERO     WGVLCR           HS Valid Carcs
     C                     Z-ADD*ZERO     WGEXCR           HS Excep Carcs
     C                     Z-ADD*ZERO     WGVARC           HS Variance
     C                     Z-ADD*ZERO     WGADCR           HS Added Carcs
     C                     Z-ADD*ZERO     WGVLDL           HS Valid Delete
     C                     Z-ADD*ZERO     WGEXDL           HS Excep Delete
     C                     Z-ADD*ZERO     WGTRCR           HS Trimmed Carc
     C                     Z-ADD*ZERO     WGPDVC           HS Paid Valid C
     C                     Z-ADD*ZERO     WGAVAD           HS Paid Avg Add
     C                     Z-ADD*ZERO     WGLVNB           HS Anl Avg Hot
     C                     Z-ADD*ZERO     WGLZNB           HS Anl Avg Back
     C                     Z-ADD*ZERO     WGGZPC           HS Anl Avg Loin
     C                     Z-ADD*ZERO     WGG0PC           HS Anl Avg Lean
     C                     Z-ADD*ZERO     WGQGPR           HS Anl Cost $/H
     C                     Z-ADD*ZERO     WGQHPR           HS Anl Prop Gro
     C                     Z-ADD*ZERO     WGQIPR           HS Anl Best Cos
     C                     Z-ADD*ZERO     WGQJPR           HS Anl Best Gro
     C                     Z-ADD*ZERO     WGF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WGHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WGF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WGF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WGF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WGAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WGCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WGQFPR           HS Act Gross $/
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    CQKMNB           EB Company Numb
     C                     MOVEL*LOVAL    CQB9DT           EB Kill Date
     C                     MOVEL*LOVAL    CQHOST           EB Shift
     C                     MOVEL*LOVAL    CQKONB           EB Scale Sequen
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WJ01 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WA02 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WB03 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB04 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB00 155       *Synon (15,5) w
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Hot Wgt/LghtR Accum Usr
     C                     Z-ADD*ZERO     YL0001  91
      * Define local work field Head No Probe USR
     C                     Z-ADD*ZERO     YL0002  50
      * Define local work field Hot Wgt/Weight Ext Usr
     C                     Z-ADD*ZERO     YL0003  91
      * Define local work field Hot Wgt/Weight Ext Usr
     C                     Z-ADD*ZERO     YL0004  91
      * Define local work field *Record selected
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field BOH Quote Price Type
     C                     MOVEL*BLANK    YL0006  2
      * Define local work field BOH Quoted Base Mkt Price
     C                     Z-ADD*ZERO     YL0007  52
      * Define local work field CMP Program Code
     C                     MOVEL*BLANK    YL0008  3
      * Define local work field TH Head Killed
     C                     Z-ADD*ZERO     YL0009  50
      * Define local work field Market Price USR
     C                     Z-ADD*ZERO     YL0010  52
      * Define local work field Pricing UOM USR
     C                     MOVEL*BLANK    YL0011  2
      * Define local work field Pricing Date USR
     C                     Z-ADD*ZERO     YL0012  70
      * Define local work field ETV NonExcep/Excep
     C                     MOVEL*BLANK    YL0013  1
      * Define local work field ETV Accepted/Deleted
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field Market Price USR
     C                     Z-ADD*ZERO     YL0015  52
      * Define local work field Pricing UOM USR
     C                     MOVEL*BLANK    YL0016  2
      * Define local work field Pricing Date USR
     C                     Z-ADD*ZERO     YL0017  70
      * Define local work field ETV NonExcep/Excep
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field ETV Accepted/Deleted
     C                     MOVEL*BLANK    YL0019  1
      * Define local work field HS Paid Avg Adds
     C                     Z-ADD*ZERO     YL0020  50
      * Define local work field TH Avg Live Wgt
     C                     Z-ADD*ZERO     YL0021  51
      * Define local work field TH Avg Hot Wgt
     C                     Z-ADD*ZERO     YL0022  51
      * Define local work field TH Avg Lean Percent
     C                     Z-ADD*ZERO     YL0023  31
      * Define local work field TH Avg Loin Eye Depth
     C                     Z-ADD*ZERO     YL0024  31
      * Define local work field TH Avg Backfat
     C                     Z-ADD*ZERO     YL0025  31
      * Define local work field TH Actual Yield %
     C                     Z-ADD*ZERO     YL0026  52
      * Define local work field TH Payment Gross
     C                     Z-ADD*ZERO     YL0027  72
      * Define local work field HS Paid Valid Carcs
     C                     Z-ADD*ZERO     YL0028  50
      * Define local work field HS Act Gross $/Hd
     C                     Z-ADD*ZERO     YL0029  52
      * Define local work field Head Killed Total Usr
     C                     Z-ADD*ZERO     YL0030  70
      * Define local work field Head Total Sum5
     C                     Z-ADD*ZERO     YL0031  70
      * Define local work field TH Schedule Kill Shift
     C                     MOVEL*BLANK    YL0032  1
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * Mov ApplN to Co-PRINT US - STR User Source Functions  * 
     C***   MOVE USER SOURCE                      ***
     C                     MOVELP6EVTX    $ACMP
      * Rtv Validation Rules  RT - Evaluation Validation  * 
     C                     EXSR SARVGN
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Pd: Valid
00002 Pd: Exception accepted
00003 Pd: Added Average
00004 Valid deleted
00005 Orig Carc Replaced w/Avg
00006 Exception Deleted
00007 Invalid Tattoo Number
00008 Process Cde Invalid
00009 Tattoo is a Resale
