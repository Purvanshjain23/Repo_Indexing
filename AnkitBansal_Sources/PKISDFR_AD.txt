// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKISDFR
// ?Date: 14.08.2025 Time: 02:51:50
// ?------------------------------------------------------------------------------------------------

//?USER: Initialize program

//?Modifications and Comments
DO;

//?H16853 ISE 11/02/20 - Increased the Buy Order Number field
//? length from 5 to 7.
ENDDO;

// Execute function Set In78/79 Seton     Us.
EXECUTE FUNCTION(Set In78/79 Seton     Us) TYPE(EXCUSRSRC) ('PKI3UFR');
{
 C                     MOVE '1'       *IN78
 C                     MOVE '1'       *IN79
}


CASE;

// IF PAR.View/Review Messages Usr is View
IF PAR.View_Review_Messages_Usr = 'V';

// WRK.Dsp View/Review Line = CND.View
WRK.Dsp_View_Review_Line = 'V';

// Execute function Set In78 to Off       US.
EXECUTE FUNCTION(Set In78 to Off       US) TYPE(EXCUSRSRC) ('PKI2UFR');
{
 C                     MOVE '0'       *IN78
}


// IF PAR.View/Review Messages Usr is Review
IF PAR.View_Review_Messages_Usr = 'R';

// WRK.Dsp View/Review Line = CND.Review
WRK.Dsp_View_Review_Line = 'R';

// Execute function Set In79 To Off       Us.
EXECUTE FUNCTION(Set In79 To Off       Us) TYPE(EXCUSRSRC) ('PKI1UFR');
{
 C                     MOVE '0'       *IN79
}


ENDIF;

// Execute function Mov ApplN to Company  US.
EXECUTE FUNCTION(Mov ApplN to Company  US) TYPE(EXCUSRSRC) ('PKMFUFR');
PARAMETER(PAR.Oms_System_Value_Alpha);
{
 C***   MOVE USER SOURCE                      ***
 C                     MOVEL#IEVTX    ##CMP
}


//?USER: Process subfile control (Pre-confirm)

CASE;

// IF PAR.View/Review Messages Usr is View
IF PAR.View_Review_Messages_Usr = 'V';

// PGM.*Defer confirm = CND.Defer confirm
PGM.*Defer_confirm = 'Y';

CASE;

// IF CTL.*CMD key is CF03
IF CTL.*CMD_key = '03';

//?Exit but keep records
// PAR.*Return code = CND.*Normal
PAR.*Return_code = *BLANK;

// PGM.*Defer confirm = CND.Proceed to confirm
PGM.*Defer_confirm = 'N';

RETURN;

// IF CTL.*CMD key is CF12
IF CTL.*CMD_key = '12';

// IF CTL.*CMD key is CF09
IF CTL.*CMD_key = '09';

// AND JOB.*USER is Susan Mason
AND JOB.*USER = 'ISSMASO';

// CTL.*Return code = CND.*Normal
CTL.*Return_code = *BLANK;

// Call program Edt - Company Values  UP.
CALL PROGRAM(Edt - Company Values  UP) ('PDEJEFR');
PARAMETER(CTL.*Return_code);

// CTL.*Return code = CND.*Normal
CTL.*Return_code = *BLANK;

ENDIF;

// IF PAR.View/Review Messages Usr is Review
IF PAR.View_Review_Messages_Usr = 'R';

// PGM.*Defer confirm = CND.Defer confirm
PGM.*Defer_confirm = 'Y';

CASE;

// IF CTL.*CMD key is CF03
IF CTL.*CMD_key = '03';

// IF CTL.*CMD key is CF12
IF CTL.*CMD_key = '12';

//?Exit delete records
// PAR.*Return code = CND.Re-Weigh
PAR.*Return_code = 'REWEIGH';

// PGM.*Defer confirm = CND.Proceed to confirm
PGM.*Defer_confirm = 'N';

RETURN;

// IF CTL.*CMD key is CF09
IF CTL.*CMD_key = '09';

// AND JOB.*USER is Susan Mason
AND JOB.*USER = 'ISSMASO';

// CTL.*Return code = CND.*Normal
CTL.*Return_code = *BLANK;

// Call program Edt - Company Values  UP.
CALL PROGRAM(Edt - Company Values  UP) ('PDEJEFR');
PARAMETER(CTL.*Return_code);

// CTL.*Return code = CND.*Normal
CTL.*Return_code = *BLANK;

// IF *OTHERWISE
IF *OTHERWISE;

// PGM.*Defer confirm = CND.Proceed to confirm
PGM.*Defer_confirm = 'N';

ENDIF;

ENDIF;

//?USER: Final processing (Post-confirm)

CASE;

// IF PAR.View/Review Messages Usr is Review
IF PAR.View_Review_Messages_Usr = 'R';

// PAR.*Return code = CND.*Normal
PAR.*Return_code = *BLANK;

RETURN;

ENDIF;

//?USER: Exit program processing

CASE;

// IF PAR.View/Review Messages Usr is Review
IF PAR.View_Review_Messages_Usr = 'R';

CASE;

// IF CTL.*CMD key is *Exit
IF CTL.*CMD_key = '03';

QUIT;

ENDIF;

ENDIF;

