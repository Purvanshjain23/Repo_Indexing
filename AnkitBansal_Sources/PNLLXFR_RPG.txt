     H/TITLE CRT OHE w/no chg       XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 08/01/19  Time  : 14:20:54
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPMAMREL0IF  E           K        DISK                      A
      * UPD : Order Header Extension    Update index
      *
     I@AMREJE
      * Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WAAIC3
     I              AMC4NB                          WAC4NB
     I              AMRMNB                          WARMNB
     I              AMRUNB                          WARUNB
     I              AMXACD                          WAXACD
     I              AMOANA                          WAOANA
     I              AMHBAA                          WAHBAA
     I              AMJ0T1                          WAJ0T1
     I              AMGENY                          WAGENY
     I              AMJ1T1                          WAJ1T1
     I              AMHCAA                          WAHCAA
     I              AMQWDT                          WAQWDT
     I              AMQXDT                          WAQXDT
     I              AMQYDT                          WAQYDT
     I              AMHDAA                          WAHDAA
     I              AMCCTX                          WACCTX
     I              AMJ2T1                          WAJ2T1
     I              AMRLNA                          WARLNA
     I              AMRMNA                          WARMNA
     I              AMGINY                          WAGINY
     I              AMGFNY                          WAGFNY
     I              AMGGNY                          WAGGNY
     I              AMGHNY                          WAGHNY
     I              AMHEVL                          WAHEVL
     I              AMHFVL                          WAHFVL
     I              AMHGVL                          WAHGVL
     I              AMQZDT                          WAQZDT
     I              AMQ0DT                          WAQ0DT
     I              AMQ1DT                          WAQ1DT
     I              AMQ2DT                          WAQ2DT
     I              AMC2TX                          WAC2TX
     I              AMC3TX                          WAC3TX
     I              AMC6TX                          WAC6TX
     I              AMCHTX                          WACHTX
     I              AMCITX                          WACITX
     I              AMCLTX                          WACLTX
     I              AMB4TX                          WAB4TX
     I              AMCUTX                          WACUTX
     I              AMCVTX                          WACVTX
     I              AMB9TX                          WAB9TX
     I              AMJWSC                          WAJWSC
     I              AMITNY                          WAITNY
     I              AMLMT1                          WALMT1
     I              AMLWAA                          WALWAA
     I              AMFVST                          WAFVST
     I              AMF0ST                          WAF0ST
     I              AMF2ST                          WAF2ST
     I              AMF3ST                          WAF3ST
     I              AMJUSC                          WAJUSC
     I              AMJVSC                          WAJVSC
     I              AMV3T1                          WAV3T1
     I              AMV4T1                          WAV4T1
     I              AMV5T1                          WAV5T1
     I              AMV6T1                          WAV6T1
     I              AMV7T1                          WAV7T1
     I              AMV8T1                          WAV8T1
     I              AMV9T1                          WAV9T1
     I              AMWAT1                          WAWAT1
     I              AMWBT1                          WAWBT1
     I              AMWCT1                          WAWCT1
     I              AMWDT1                          WAWDT1
     I              AMQJNY                          WAQJNY
     I              AMQKNY                          WAQKNY
     I              AMQLNY                          WAQLNY
     I              AMP8NY                          WAP8NY
     I              AMP9NY                          WAP9NY
     I              AMQANY                          WAQANY
     I              AMQCNY                          WAQCNY
     I              AMQDNY                          WAQDNY
     I              AMQENY                          WAQENY
     I              AMQFNY                          WAQFNY
     I              AMQGNY                          WAQGNY
     I              AMQHNY                          WAQHNY
     I              AMQINY                          WAQINY
     I              AMQMNY                          WAQMNY
     I              AMMYU1                          WAMYU1
     I              AMJXSC                          WAJXSC
     I              AMJYSC                          WAJYSC
     I              AMJZSC                          WAJZSC
     I              AMJ0SC                          WAJ0SC
     I              AMMZU1                          WAMZU1
     I              AMM0U1                          WAM0U1
     I              AMM1U1                          WAM1U1
     I              AMM2U1                          WAM2U1
     I              AMM3U1                          WAM3U1
     I              AMW5DT                          WAW5DT
     I              AMW6DT                          WAW6DT
     I              AMUVST                          WAUVST
     I              AMUWST                          WAUWST
     I              AMUXST                          WAUXST
     I              AMVSST                          WAVSST
     I              AMAATM                          WAAATM
     I              AMAYNA                          WAAYNA
     I              AMA0NA                          WAA0NA
     I              AMAXDT                          WAAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPMAM1    E DSPMAMREL0
      * UPD : Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WAAIC3
     I              AMC4NB                          WAC4NB
     I              AMRMNB                          WARMNB
     I              AMRUNB                          WARUNB
     I              AMXACD                          WAXACD
     I              AMOANA                          WAOANA
     I              AMHBAA                          WAHBAA
     I              AMJ0T1                          WAJ0T1
     I              AMGENY                          WAGENY
     I              AMJ1T1                          WAJ1T1
     I              AMHCAA                          WAHCAA
     I              AMQWDT                          WAQWDT
     I              AMQXDT                          WAQXDT
     I              AMQYDT                          WAQYDT
     I              AMHDAA                          WAHDAA
     I              AMCCTX                          WACCTX
     I              AMJ2T1                          WAJ2T1
     I              AMRLNA                          WARLNA
     I              AMRMNA                          WARMNA
     I              AMGINY                          WAGINY
     I              AMGFNY                          WAGFNY
     I              AMGGNY                          WAGGNY
     I              AMGHNY                          WAGHNY
     I              AMHEVL                          WAHEVL
     I              AMHFVL                          WAHFVL
     I              AMHGVL                          WAHGVL
     I              AMQZDT                          WAQZDT
     I              AMQ0DT                          WAQ0DT
     I              AMQ1DT                          WAQ1DT
     I              AMQ2DT                          WAQ2DT
     I              AMC2TX                          WAC2TX
     I              AMC3TX                          WAC3TX
     I              AMC6TX                          WAC6TX
     I              AMCHTX                          WACHTX
     I              AMCITX                          WACITX
     I              AMCLTX                          WACLTX
     I              AMB4TX                          WAB4TX
     I              AMCUTX                          WACUTX
     I              AMCVTX                          WACVTX
     I              AMB9TX                          WAB9TX
     I              AMJWSC                          WAJWSC
     I              AMITNY                          WAITNY
     I              AMLMT1                          WALMT1
     I              AMLWAA                          WALWAA
     I              AMFVST                          WAFVST
     I              AMF0ST                          WAF0ST
     I              AMF2ST                          WAF2ST
     I              AMF3ST                          WAF3ST
     I              AMJUSC                          WAJUSC
     I              AMJVSC                          WAJVSC
     I              AMV3T1                          WAV3T1
     I              AMV4T1                          WAV4T1
     I              AMV5T1                          WAV5T1
     I              AMV6T1                          WAV6T1
     I              AMV7T1                          WAV7T1
     I              AMV8T1                          WAV8T1
     I              AMV9T1                          WAV9T1
     I              AMWAT1                          WAWAT1
     I              AMWBT1                          WAWBT1
     I              AMWCT1                          WAWCT1
     I              AMWDT1                          WAWDT1
     I              AMQJNY                          WAQJNY
     I              AMQKNY                          WAQKNY
     I              AMQLNY                          WAQLNY
     I              AMP8NY                          WAP8NY
     I              AMP9NY                          WAP9NY
     I              AMQANY                          WAQANY
     I              AMQCNY                          WAQCNY
     I              AMQDNY                          WAQDNY
     I              AMQENY                          WAQENY
     I              AMQFNY                          WAQFNY
     I              AMQGNY                          WAQGNY
     I              AMQHNY                          WAQHNY
     I              AMQINY                          WAQINY
     I              AMQMNY                          WAQMNY
     I              AMMYU1                          WAMYU1
     I              AMJXSC                          WAJXSC
     I              AMJYSC                          WAJYSC
     I              AMJZSC                          WAJZSC
     I              AMJ0SC                          WAJ0SC
     I              AMMZU1                          WAMZU1
     I              AMM0U1                          WAM0U1
     I              AMM1U1                          WAM1U1
     I              AMM2U1                          WAM2U1
     I              AMM3U1                          WAM3U1
     I              AMW5DT                          WAW5DT
     I              AMW6DT                          WAW6DT
     I              AMUVST                          WAUVST
     I              AMUWST                          WAUWST
     I              AMUXST                          WAUXST
     I              AMVSST                          WAVSST
     I              AMAATM                          WAAATM
     I              AMAYNA                          WAAYNA
     I              AMA0NA                          WAA0NA
     I              AMAXDT                          WAAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header Extension
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * I : RST Order Number
     I                                    P   3   60P1C4NB
      * I :  Load ID
     I                                    P   7  100P1RMNB
      * I :  Stop/Drop Sequence Number
     I                                    P  11  130P1RUNB
      * I :  Shipping Line
     I                                       14  16 P1XACD
      * I :  Port Delv Terminal
     I                                       17  36 P1OANA
      * I :  OHE City
     I                                       37  61 P1HBAA
      * I :  OHE Vessel/Airline
     I                                       62  91 P1J0T1
      * I :  OHE Voyage/Flight
     I                                       92 106 P1GENY
      * I :  OHE Booking Number
     I                                      107 121 P1J1T1
      * I :  OHE Discharge Port/Airprt
     I                                      122 141 P1HCAA
      * I :  OHE Sail/Flight Date
     I                                    P 142 1450P1QWDT
      * I :  OHE Port Cut Date
     I                                    P 146 1490P1QXDT
      * I :  OHE Arrival Date
     I                                    P 150 1530P1QYDT
      * I :  OHE Late Delivery Code
     I                                      154 156 P1HDAA
      * I :  OHE Ship Status
     I                                      157 157 P1CCTX
      * I :  OHE Container Number
     I                                      158 169 P1J2T1
      * I :  OHE Comment 1
     I                                      170 204 P1RLNA
      * I :  OHE Comment 2
     I                                      205 279 P1RMNA
      * I :  OHE Unused Number 1-11.0
     I                                    P 280 2850P1GINY
      * I :  OHE Unused Number 2-11.0
     I                                    P 286 2910P1GFNY
      * I :  OHE Unused Number 3-11.0
     I                                    P 292 2970P1GGNY
      * I :  OHE Unused Number 4-11.0
     I                                    P 298 3030P1GHNY
      * I :  OHE HPB RIN Equiv Value
     I                                    P 304 3092P1HEVL
      * I :  OHE HPB RIN Price
     I                                    P 310 3152P1HFVL
      * I :  Transload Terminal Fees
     I                                    P 316 3212P1HGVL
      * I :  OHE Est Arrv at Dest Date
     I                                    P 322 3250P1QZDT
      * I :  OHE Backhaul ETA RtrnDate
     I                                    P 326 3290P1Q0DT
      * I :  OHE Port/Pier Paid Date
     I                                    P 330 3330P1Q1DT
      * I :  OHE Actual Ship Date
     I                                    P 334 3370P1Q2DT
      * I :  OHE Carrier SCAC Code
     I                                      338 341 P1C2TX
      * I :  OHE Spot Buy
     I                                      342 345 P1C3TX
      * I :  OHE PO ACK Flag
     I                                      346 349 P1C6TX
      * I :  OHE Override Type Code
     I                                      350 351 P1CHTX
      * I :  OHE Backhaul Status
     I                                      352 353 P1CITX
      * I :  OHE Backhaul ETA AM/PM
     I                                      354 355 P1CLTX
      * I :  OHE Load Haul Type
     I                                      356 358 P1B4TX
      * I :  OHE Backhaul Carrier Code
     I                                      359 361 P1CUTX
      * I :  OHE Bookings Confirmed
     I                                      362 364 P1CVTX
      * I :  OHE EDI Error Reasons
     I                                      365 369 P1B9TX
      * I :  OHE EDI Error Reasons 2
     I                                      370 374 P1JWSC
      * I :  HPB COA Batch Number
     I                                    P 375 3770P1ITNY
      * I :  Delivery P.O. Number
     I                                      378 415 P1LMT1
      * I :  OHE Intended for ExportCC
     I                                      416 421 P1LWAA
      * I :  OHE EDI 943 Action
     I                                      422 427 P1FVST
      * I :  OHE EDI 944 Action
     I                                      428 433 P1F0ST
      * I :  OHE EDI 940 Action
     I                                      434 439 P1F2ST
      * I :  OHE EDI 945 Action
     I                                      440 445 P1F3ST
      * I :  OHE EDI 856 Action
     I                                      446 446 P1JUSC
      * I :  OHE EDI 824 Action
     I                                      447 447 P1JVSC
      * I :  OHE Transload Seal Nbr
     I                                      448 457 P1V3T1
      * I :  OHE Abs Rate Override Rsn
     I                                      458 467 P1V4T1
      * I :  OHE Appt Confirmation #
     I                                      468 477 P1V5T1
      * I :  OHE Backhaul Container#
     I                                      478 492 P1V6T1
      * I :  OHE Backhaul Chassis #
     I                                      493 507 P1V7T1
      * I :  OHE Transload Container#
     I                                      508 522 P1V8T1
      * I :  OHE Pier Pass Invoice
     I                                      523 552 P1V9T1
      * I :  OHE Carrier Nm
     I                                      553 582 P1WAT1
      * I :  OHE Appt Confirmation Nm
     I                                      583 612 P1WBT1
      * I :  OHE Backhaul Comment
     I                                      613 662 P1WCT1
      * I :  Letter of Credit Number
     I                                      663 712 P1WDT1
      * I :  OHE Backhaul Return to Co
     I                                    P 713 7140P1QJNY
      * I :  LD Stop/Drop
     I                                    P 715 7160P1QKNY
      * I :  OHE Unused Number 3.0
     I                                    P 717 7180P1QLNY
      * I :  OHE Pier Pass Fee Amount
     I                                    P 719 7212P1P8NY
      * I :  OHE Port Check Fee Amount
     I                                    P 722 7242P1P9NY
      * I :  OHE Port Cut Time
     I                                    P 725 7270P1QANY
      * I :  OHE Backhaul Truck Number
     I                                    P 728 7310P1QCNY
      * I :  OHE Load Sched Seq Num
     I                                    P 732 7350P1QDNY
      * I :  Original Appointment Date
     I                                    P 736 7390P1QENY
      * I :  Original Appointment Time
     I                                    P 740 7430P1QFNY
      * I :  OHE PowerPro Load#-Outbnd
     I                                    P 744 7480P1QGNY
      * I :  OHE PowerPro Load#-Bckhl
     I                                    P 749 7530P1QHNY
      * I :  OHE Unused Numeric 9,0 3
     I                                    P 754 7580P1QINY
      * I :  OHE Orig ABS Freight Rate
     I                                    P 759 7636P1QMNY
      * I :  OHE Genset Number
     I                                      764 778 P1MYU1
      * I :  OHE Unused Status 1
     I                                      779 779 P1JXSC
      * I :  OHE Unused Status 2
     I                                      780 780 P1JYSC
      * I :  OHE Unused Status 3
     I                                      781 782 P1JZSC
      * I :  OHE Unused Status 4
     I                                      783 784 P1J0SC
      * I :  OHE Unused Text 1
     I                                      785 789 P1MZU1
      * I :  OHE Unused Text 2
     I                                      790 794 P1M0U1
      * I :  OHE Unused Text 3
     I                                      795 809 P1M1U1
      * I :  OHE Unused Text 4
     I                                      810 824 P1M2U1
      * I :  OHE Unused Text 5
     I                                      825 854 P1M3U1
      * I :  OHE Unused Date 1
     I                                    P 855 8580P1W5DT
      * I :  OHE Unused Date 2
     I                                    P 859 8620P1W6DT
      * I :  EDI Status 1
     I                                      863 863 P1UVST
      * I :  EDI Status 2
     I                                      864 864 P1UWST
      * I :  EDI Status 3
     I                                      865 865 P1UXST
      * I :  Record Status
     I                                      866 866 P1VSST
      * I :  Job Time
     I                                    P 867 8700P1AATM
      * I :  User Id
     I                                      871 880 P1AYNA
      * I :  Job Name
     I                                      881 890 P1A0NA
      * I :  Job Date
     I                                    P 891 8940P1AXDT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1RMNB    PARM           WP0003  70       Load ID
     C           P1RUNB    PARM           WP0004  50       Stop/Drop Seque
     C           P1XACD    PARM           WP0005  3        Shipping Line
     C           P1OANA    PARM           WP0006 20        Port Delv Termi
     C           P1HBAA    PARM           WP0007 25        OHE City
     C           P1J0T1    PARM           WP0008 30        OHE Vessel/Airl
     C           P1GENY    PARM           WP0009 15        OHE Voyage/Flig
     C           P1J1T1    PARM           WP0010 15        OHE Booking Num
     C           P1HCAA    PARM           WP0011 20        OHE Discharge P
     C           P1QWDT    PARM           WP0012  70       OHE Sail/Flight
     C           P1QXDT    PARM           WP0013  70       OHE Port Cut Da
     C           P1QYDT    PARM           WP0014  70       OHE Arrival Dat
     C           P1HDAA    PARM           WP0015  3        OHE Late Delive
     C           P1CCTX    PARM           WP0016  1        OHE Ship Status
     C           P1J2T1    PARM           WP0017 12        OHE Container N
     C           P1RLNA    PARM           WP0018 35        OHE Comment 1
     C           P1RMNA    PARM           WP0019 75        OHE Comment 2
     C           P1GINY    PARM           WP0020 110       OHE Unused Numb
     C           P1GFNY    PARM           WP0021 110       OHE Unused Numb
     C           P1GGNY    PARM           WP0022 110       OHE Unused Numb
     C           P1GHNY    PARM           WP0023 110       OHE Unused Numb
     C           P1HEVL    PARM           WP0024 112       OHE HPB RIN Equ
     C           P1HFVL    PARM           WP0025 112       OHE HPB RIN Pri
     C           P1HGVL    PARM           WP0026 112       Transload Termi
     C           P1QZDT    PARM           WP0027  70       OHE Est Arrv at
     C           P1Q0DT    PARM           WP0028  70       OHE Backhaul ET
     C           P1Q1DT    PARM           WP0029  70       OHE Port/Pier P
     C           P1Q2DT    PARM           WP0030  70       OHE Actual Ship
     C           P1C2TX    PARM           WP0031  4        OHE Carrier SCA
     C           P1C3TX    PARM           WP0032  4        OHE Spot Buy
     C           P1C6TX    PARM           WP0033  4        OHE PO ACK Flag
     C           P1CHTX    PARM           WP0034  2        OHE Override Ty
     C           P1CITX    PARM           WP0035  2        OHE Backhaul St
     C           P1CLTX    PARM           WP0036  2        OHE Backhaul ET
     C           P1B4TX    PARM           WP0037  3        OHE Load Haul T
     C           P1CUTX    PARM           WP0038  3        OHE Backhaul Ca
     C           P1CVTX    PARM           WP0039  3        OHE Bookings Co
     C           P1B9TX    PARM           WP0040  5        OHE EDI Error R
     C           P1JWSC    PARM           WP0041  5        OHE EDI Error R
     C           P1ITNY    PARM           WP0042  50       HPB COA Batch N
     C           P1LMT1    PARM           WP0043 38        Delivery P.O. N
     C           P1LWAA    PARM           WP0044  6        OHE Intended fo
     C           P1FVST    PARM           WP0045  6        OHE EDI 943 Act
     C           P1F0ST    PARM           WP0046  6        OHE EDI 944 Act
     C           P1F2ST    PARM           WP0047  6        OHE EDI 940 Act
     C           P1F3ST    PARM           WP0048  6        OHE EDI 945 Act
     C           P1JUSC    PARM           WP0049  1        OHE EDI 856 Act
     C           P1JVSC    PARM           WP0050  1        OHE EDI 824 Act
     C           P1V3T1    PARM           WP0051 10        OHE Transload S
     C           P1V4T1    PARM           WP0052 10        OHE Abs Rate Ov
     C           P1V5T1    PARM           WP0053 10        OHE Appt Confir
     C           P1V6T1    PARM           WP0054 15        OHE Backhaul Co
     C           P1V7T1    PARM           WP0055 15        OHE Backhaul Ch
     C           P1V8T1    PARM           WP0056 15        OHE Transload C
     C           P1V9T1    PARM           WP0057 30        OHE Pier Pass I
     C           P1WAT1    PARM           WP0058 30        OHE Carrier Nm
     C           P1WBT1    PARM           WP0059 30        OHE Appt Confir
     C           P1WCT1    PARM           WP0060 50        OHE Backhaul Co
     C           P1WDT1    PARM           WP0061 50        Letter of Credi
     C           P1QJNY    PARM           WP0062  30       OHE Backhaul Re
     C           P1QKNY    PARM           WP0063  30       LD Stop/Drop
     C           P1QLNY    PARM           WP0064  30       OHE Unused Numb
     C           P1P8NY    PARM           WP0065  52       OHE Pier Pass F
     C           P1P9NY    PARM           WP0066  52       OHE Port Check
     C           P1QANY    PARM           WP0067  50       OHE Port Cut Ti
     C           P1QCNY    PARM           WP0068  60       OHE Backhaul Tr
     C           P1QDNY    PARM           WP0069  60       OHE Load Sched
     C           P1QENY    PARM           WP0070  60       Original Appoin
     C           P1QFNY    PARM           WP0071  60       Original Appoin
     C           P1QGNY    PARM           WP0072  90       OHE PowerPro Lo
     C           P1QHNY    PARM           WP0073  90       OHE PowerPro Lo
     C           P1QINY    PARM           WP0074  90       OHE Unused Nume
     C           P1QMNY    PARM           WP0075  96       OHE Orig ABS Fr
     C           P1MYU1    PARM           WP0076 15        OHE Genset Numb
     C           P1JXSC    PARM           WP0077  1        OHE Unused Stat
     C           P1JYSC    PARM           WP0078  1        OHE Unused Stat
     C           P1JZSC    PARM           WP0079  2        OHE Unused Stat
     C           P1J0SC    PARM           WP0080  2        OHE Unused Stat
     C           P1MZU1    PARM           WP0081  5        OHE Unused Text
     C           P1M0U1    PARM           WP0082  5        OHE Unused Text
     C           P1M1U1    PARM           WP0083 15        OHE Unused Text
     C           P1M2U1    PARM           WP0084 15        OHE Unused Text
     C           P1M3U1    PARM           WP0085 30        OHE Unused Text
     C           P1W5DT    PARM           WP0086  70       OHE Unused Date
     C           P1W6DT    PARM           WP0087  70       OHE Unused Date
     C           P1UVST    PARM           WP0088  1        EDI Status 1
     C           P1UWST    PARM           WP0089  1        EDI Status 2
     C           P1UXST    PARM           WP0090  1        EDI Status 3
     C           P1VSST    PARM           WP0091  1        Record Status
     C           P1AATM    PARM           WP0092  60       Job Time
     C           P1AYNA    PARM           WP0093 10        User Id
     C           P1A0NA    PARM           WP0094 10        Job Name
     C           P1AXDT    PARM           WP0095  70       Job Date
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * CRT OHE w/no chg       XF
      * CRT OHE w/no chg       CR - Order Header Extension  * 
     C                     EXSR SACRRC
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SACRRC    BEGSR
      *================================================================
      * CRT OHE w/no chg       CR - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AMREJE
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP1C4NB    WAC4NB           Order Number
     C                     Z-ADDP1RMNB    WARMNB           Load ID
     C                     Z-ADDP1RUNB    WARUNB           Stop/Drop Seque
     C                     MOVELP1XACD    WAXACD           Shipping Line
     C                     MOVELP1OANA    WAOANA           Port Delv Termi
     C                     MOVELP1HBAA    WAHBAA           OHE City
     C                     MOVELP1J0T1    WAJ0T1           OHE Vessel/Airl
     C                     MOVELP1GENY    WAGENY           OHE Voyage/Flig
     C                     MOVELP1J1T1    WAJ1T1           OHE Booking Num
     C                     MOVELP1HCAA    WAHCAA           OHE Discharge P
     C                     Z-ADDP1QWDT    WAQWDT           OHE Sail/Flight
     C                     Z-ADDP1QXDT    WAQXDT           OHE Port Cut Da
     C                     Z-ADDP1QYDT    WAQYDT           OHE Arrival Dat
     C                     MOVELP1HDAA    WAHDAA           OHE Late Delive
     C                     MOVELP1CCTX    WACCTX           OHE Ship Status
     C                     MOVELP1J2T1    WAJ2T1           OHE Container N
     C                     MOVELP1RLNA    WARLNA           OHE Comment 1
     C                     MOVELP1RMNA    WARMNA           OHE Comment 2
     C                     Z-ADDP1GINY    WAGINY           OHE Unused Numb
     C                     Z-ADDP1GFNY    WAGFNY           OHE Unused Numb
     C                     Z-ADDP1GGNY    WAGGNY           OHE Unused Numb
     C                     Z-ADDP1GHNY    WAGHNY           OHE Unused Numb
     C                     Z-ADDP1HEVL    WAHEVL           OHE HPB RIN Equ
     C                     Z-ADDP1HFVL    WAHFVL           OHE HPB RIN Pri
     C                     Z-ADDP1HGVL    WAHGVL           Transload Termi
     C                     Z-ADDP1QZDT    WAQZDT           OHE Est Arrv at
     C                     Z-ADDP1Q0DT    WAQ0DT           OHE Backhaul ET
     C                     Z-ADDP1Q1DT    WAQ1DT           OHE Port/Pier P
     C                     Z-ADDP1Q2DT    WAQ2DT           OHE Actual Ship
     C                     MOVELP1C2TX    WAC2TX           OHE Carrier SCA
     C                     MOVELP1C3TX    WAC3TX           OHE Spot Buy
     C                     MOVELP1C6TX    WAC6TX           OHE PO ACK Flag
     C                     MOVELP1CHTX    WACHTX           OHE Override Ty
     C                     MOVELP1CITX    WACITX           OHE Backhaul St
     C                     MOVELP1CLTX    WACLTX           OHE Backhaul ET
     C                     MOVELP1B4TX    WAB4TX           OHE Load Haul T
     C                     MOVELP1CUTX    WACUTX           OHE Backhaul Ca
     C                     MOVELP1CVTX    WACVTX           OHE Bookings Co
     C                     MOVELP1B9TX    WAB9TX           OHE EDI Error R
     C                     MOVELP1JWSC    WAJWSC           OHE EDI Error R
     C                     Z-ADDP1ITNY    WAITNY           HPB COA Batch N
     C                     MOVELP1LMT1    WALMT1           Delivery P.O. N
     C                     MOVELP1LWAA    WALWAA           OHE Intended fo
     C                     MOVELP1FVST    WAFVST           OHE EDI 943 Act
     C                     MOVELP1F0ST    WAF0ST           OHE EDI 944 Act
     C                     MOVELP1F2ST    WAF2ST           OHE EDI 940 Act
     C                     MOVELP1F3ST    WAF3ST           OHE EDI 945 Act
     C                     MOVELP1JUSC    WAJUSC           OHE EDI 856 Act
     C                     MOVELP1JVSC    WAJVSC           OHE EDI 824 Act
     C                     MOVELP1V3T1    WAV3T1           OHE Transload S
     C                     MOVELP1V4T1    WAV4T1           OHE Abs Rate Ov
     C                     MOVELP1V5T1    WAV5T1           OHE Appt Confir
     C                     MOVELP1V6T1    WAV6T1           OHE Backhaul Co
     C                     MOVELP1V7T1    WAV7T1           OHE Backhaul Ch
     C                     MOVELP1V8T1    WAV8T1           OHE Transload C
     C                     MOVELP1V9T1    WAV9T1           OHE Pier Pass I
     C                     MOVELP1WAT1    WAWAT1           OHE Carrier Nm
     C                     MOVELP1WBT1    WAWBT1           OHE Appt Confir
     C                     MOVELP1WCT1    WAWCT1           OHE Backhaul Co
     C                     MOVELP1WDT1    WAWDT1           Letter of Credi
     C                     Z-ADDP1QJNY    WAQJNY           OHE Backhaul Re
     C                     Z-ADDP1QKNY    WAQKNY           LD Stop/Drop
     C                     Z-ADDP1QLNY    WAQLNY           OHE Unused Numb
     C                     Z-ADDP1P8NY    WAP8NY           OHE Pier Pass F
     C                     Z-ADDP1P9NY    WAP9NY           OHE Port Check
     C                     Z-ADDP1QANY    WAQANY           OHE Port Cut Ti
     C                     Z-ADDP1QCNY    WAQCNY           OHE Backhaul Tr
     C                     Z-ADDP1QDNY    WAQDNY           OHE Load Sched
     C                     Z-ADDP1QENY    WAQENY           Original Appoin
     C                     Z-ADDP1QFNY    WAQFNY           Original Appoin
     C                     Z-ADDP1QGNY    WAQGNY           OHE PowerPro Lo
     C                     Z-ADDP1QHNY    WAQHNY           OHE PowerPro Lo
     C                     Z-ADDP1QINY    WAQINY           OHE Unused Nume
     C                     Z-ADDP1QMNY    WAQMNY           OHE Orig ABS Fr
     C                     MOVELP1MYU1    WAMYU1           OHE Genset Numb
     C                     MOVELP1JXSC    WAJXSC           OHE Unused Stat
     C                     MOVELP1JYSC    WAJYSC           OHE Unused Stat
     C                     MOVELP1JZSC    WAJZSC           OHE Unused Stat
     C                     MOVELP1J0SC    WAJ0SC           OHE Unused Stat
     C                     MOVELP1MZU1    WAMZU1           OHE Unused Text
     C                     MOVELP1M0U1    WAM0U1           OHE Unused Text
     C                     MOVELP1M1U1    WAM1U1           OHE Unused Text
     C                     MOVELP1M2U1    WAM2U1           OHE Unused Text
     C                     MOVELP1M3U1    WAM3U1           OHE Unused Text
     C                     Z-ADDP1W5DT    WAW5DT           OHE Unused Date
     C                     Z-ADDP1W6DT    WAW6DT           OHE Unused Date
     C                     MOVELP1UVST    WAUVST           EDI Status 1
     C                     MOVELP1UWST    WAUWST           EDI Status 2
     C                     MOVELP1UXST    WAUXST           EDI Status 3
     C                     MOVELP1VSST    WAVSST           Record Status
     C                     Z-ADDP1AATM    WAAATM           Job Time
     C                     MOVELP1AYNA    WAAYNA           User Id
     C                     MOVELP1A0NA    WAA0NA           Job Name
     C                     Z-ADDP1AXDT    WAAXDT           Job Date
      *
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WAAATM           Job Time
     C                     Z-ADD##JDT     WAAXDT           Job Date
     C                     MOVEL##PGM     WAA0NA           Job Name
     C                     MOVEL##USR     WAAYNA           User Id
     C           KLCRSA    KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
      * Check for duplicate primary key
     C           KLCRSA    SETLL@AMREJE                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3698' W0RTN   7
      * Send message 'Order Header Extension EX'
     C                     MOVEL'USR3698' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C                     WRITE@AMREJE                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WARUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WAQWDT           OHE Sail/Flight
     C                     Z-ADD*ZERO     WAQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WAQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WAGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WAGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WAGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WAGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WAHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WAHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WAHGVL           Transload Termi
     C                     Z-ADD*ZERO     WAQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WAQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WAQ1DT           OHE Port/Pier P
     C                     Z-ADD*ZERO     WAQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WAITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WAQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WAQKNY           LD Stop/Drop
     C                     Z-ADD*ZERO     WAQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WAP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WAP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WAQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WAQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WAQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WAQENY           Original Appoin
     C                     Z-ADD*ZERO     WAQFNY           Original Appoin
     C                     Z-ADD*ZERO     WAQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WAQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WAQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WAQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WAW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WAW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
