     H/TITLE ZZTrns Weight          PV Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Prompt & validate record
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISJBADE
     H* Date          : 03/11/21  Time  : 14:01:08
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPKQIPVR#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: ZZTrns Weight          PV Prompt & validate record
      *
     FPKEJCPL1IF  E           K        DISK
      * RTV : Buy Order Load Weight     Retrieval index
      *
     FPKAXCPL0IF  E           K        DISK
      * RTV : Buy Order Load            Retrieval index
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKEJCPL2IF  E           K        DISK
      * RSQ : Buy Order Load Weight     Co/BOL
      *
     FPKAZREL1IF  E           K        DISK
      * RTV : Company Control HPE       Retrieval index
      *
     FPKAFREL0IF  E           K        DISK
      * RTV : Producer Location         Retrieval index
      *
     FPKEJCPL0UF  E           K        DISK                      A
      * UPD : Buy Order Load Weight     Update index
      *
     FPKAXCPL1UF  E           K        DISK
      * UPD : Buy Order Load            Update index
      *
     FPKA1CPL1UF  E           K        DISK
      * UPD : Tattoo Header             Update index
      *
      * DETAIL Screen: Field position and name array
     E                    W0BEG   7 013  5 0A
     E                    W0END   7 013  5 0A
     E                    W0NAM   7 013 10
      * Set wdw location allowed?
     E                    YSL         1  1
     I@EJCPBH
      * Buy Order Load Weight     Update index
      * Renamed input format fields
     I              EJHONB                          WAHONB
     I              EJABCD                          WAABCD
     I              EJAECD                          WAAECD
     I              EJBOMV                          WABOMV
     I              EJSRST                          WASRST
     I              EJBOSW                          WABOSW
     I              EJDQDT                          WADQDT
     I              EJA2TM                          WAA2TM
     I              EJSSST                          WASSST
     I              EJSTST                          WASTST
     I              EJSUST                          WASUST
     I              EJHMNB                          WAHMNB
     I              EJBNNB                          WABNNB
     I              EJBONB                          WABONB
     I              EJAAVN                          WAAAVN
     I              EJAADT                          WAAADT
     I              EJAMTM                          WAAMTM
     I              EJAJST                          WAAJST
     I              EJAHVN                          WAAHVN
     I              EJAGVN                          WAAGVN
     I              EJABVN                          WAABVN
     I              EJABDT                          WAABDT
     I              EJABTM                          WAABTM
      *
     I@AXCPBX
      * Buy Order Load            Retrieval index
      * Renamed input format fields
     I              AXHMNB                          WBHMNB
     I              AXBNNB                          WBBNNB
     I              AXBONB                          WBBONB
     I              AXCQDT                          WBCQDT
     I              AXABTH                          WBABTH
     I              AXACTH                          WBACTH
     I              AXBPNB                          WBBPNB
     I              AXCSNB                          WBCSNB
     I              AXAUDT                          WBAUDT
     I              AXCMST                          WBCMST
     I              AXAGPR                          WBAGPR
     I              AXATVA                          WBATVA
     I              AXI1ST                          WBI1ST
     I              AXDHNB                          WBDHNB
     I              AXDINB                          WBDINB
     I              AXCNST                          WBCNST
     I              AXGINB                          WBGINB
     I              AXBZDT                          WBBZDT
     I              AXLSNB                          WBLSNB
     I              AXF3TX                          WBF3TX
     I              AXO8ST                          WBO8ST
     I              AXO9ST                          WBO9ST
     I              AXPAST                          WBPAST
     I              AXLDSH                          WBLDSH
     I              AXPBST                          WBPBST
     I              AXPCST                          WBPCST
     I              AXPDST                          WBPDST
     I              AXUWST                          WBUWST
     I              AXUXST                          WBUXST
     I              AXUYST                          WBUYST
     I              AXJKRU                          WBJKRU
     I              AXKEOR                          WBKEOR
     I              AXIOEW                          WBIOEW
     I              AXKJIO                          WBKJIO
     I              AXIOJR                          WBIOJR
     I              AXEIRR                          WBEIRR
     I              AXITMF                          WBITMF
     I              AXODJE                          WBODJE
     I              AXRJIF                          WBRJIF
     I              AXOEJF                          WBOEJF
     I              AXD0DT                          WBD0DT
     I              AXD1DT                          WBD1DT
     I              AXD2DT                          WBD2DT
     I              AXD3DT                          WBD3DT
     I              AXD4DT                          WBD4DT
     I              AXBNCD                          WBBNCD
     I              AXABCD                          WBABCD
     I              AXAECD                          WBAECD
     I              AXAAVN                          WBAAVN
     I              AXAADT                          WBAADT
     I              AXAMTM                          WBAMTM
     I              AXAJST                          WBAJST
     I              AXAHVN                          WBAHVN
     I              AXAGVN                          WBAGVN
     I              AXABVN                          WBABVN
     I              AXABDT                          WBABDT
     I              AXABTM                          WBABTM
      *
     I@AXCPBY
      * Buy Order Load            Update index
      * Renamed input format fields
     I              AXHMNB                          WCHMNB
     I              AXBNNB                          WCBNNB
     I              AXBONB                          WCBONB
     I              AXCQDT                          WCCQDT
     I              AXABTH                          WCABTH
     I              AXACTH                          WCACTH
     I              AXBPNB                          WCBPNB
     I              AXCSNB                          WCCSNB
     I              AXAUDT                          WCAUDT
     I              AXCMST                          WCCMST
     I              AXAGPR                          WCAGPR
     I              AXATVA                          WCATVA
     I              AXI1ST                          WCI1ST
     I              AXDHNB                          WCDHNB
     I              AXDINB                          WCDINB
     I              AXCNST                          WCCNST
     I              AXGINB                          WCGINB
     I              AXBZDT                          WCBZDT
     I              AXLSNB                          WCLSNB
     I              AXF3TX                          WCF3TX
     I              AXO8ST                          WCO8ST
     I              AXO9ST                          WCO9ST
     I              AXPAST                          WCPAST
     I              AXLDSH                          WCLDSH
     I              AXPBST                          WCPBST
     I              AXPCST                          WCPCST
     I              AXPDST                          WCPDST
     I              AXUWST                          WCUWST
     I              AXUXST                          WCUXST
     I              AXUYST                          WCUYST
     I              AXJKRU                          WCJKRU
     I              AXKEOR                          WCKEOR
     I              AXIOEW                          WCIOEW
     I              AXKJIO                          WCKJIO
     I              AXIOJR                          WCIOJR
     I              AXEIRR                          WCEIRR
     I              AXITMF                          WCITMF
     I              AXODJE                          WCODJE
     I              AXRJIF                          WCRJIF
     I              AXOEJF                          WCOEJF
     I              AXD0DT                          WCD0DT
     I              AXD1DT                          WCD1DT
     I              AXD2DT                          WCD2DT
     I              AXD3DT                          WCD3DT
     I              AXD4DT                          WCD4DT
     I              AXBNCD                          WCBNCD
     I              AXABCD                          WCABCD
     I              AXAECD                          WCAECD
     I              AXAAVN                          WCAAVN
     I              AXAADT                          WCAADT
     I              AXAMTM                          WCAMTM
     I              AXAJST                          WCAJST
     I              AXAHVN                          WCAHVN
     I              AXAGVN                          WCAGVN
     I              AXABVN                          WCABVN
     I              AXABDT                          WCABDT
     I              AXABTM                          WCABTM
      *
     I@A1CPC4
      * Tattoo Header             Retrieval index
      * Renamed input format fields
     I              A1HMNB                          WDHMNB
     I              A1BNNB                          WDBNNB
     I              A1BONB                          WDBONB
     I              A1CVNB                          WDCVNB
     I              A1B0DT                          WDB0DT
     I              A1AWDT                          WDAWDT
     I              A1BICD                          WDBICD
     I              A1CPST                          WDCPST
     I              A1ACPR                          WDACPR
     I              A1B9PR                          WDB9PR
     I              A1CAPR                          WDCAPR
     I              A1C4ST                          WDC4ST
     I              A1AIPR                          WDAIPR
     I              A1A6DT                          WDA6DT
     I              A1C2ST                          WDC2ST
     I              A1CXNB                          WDCXNB
     I              A1CWNB                          WDCWNB
     I              A1FCNB                          WDFCNB
     I              A1H9NB                          WDH9NB
     I              A1FDNB                          WDFDNB
     I              A1FENB                          WDFENB
     I              A1HENB                          WDHENB
     I              A1HFNB                          WDHFNB
     I              A1CYNB                          WDCYNB
     I              A1LRNB                          WDLRNB
     I              A1E0NB                          WDE0NB
     I              A1A5PC                          WDA5PC
     I              A1FBNB                          WDFBNB
     I              A1A4PC                          WDA4PC
     I              A1F7NB                          WDF7NB
     I              A1HDNB                          WDHDNB
     I              A1F5NB                          WDF5NB
     I              A1F4NB                          WDF4NB
     I              A1F3NB                          WDF3NB
     I              A1F2NB                          WDF2NB
     I              A1AVPC                          WDAVPC
     I              A1AWPC                          WDAWPC
     I              A1CWPC                          WDCWPC
     I              A1A8PC                          WDA8PC
     I              A1A7PC                          WDA7PC
     I              A1B8PR                          WDB8PR
     I              A1AMPR                          WDAMPR
     I              A1ANPR                          WDANPR
     I              A1AYVA                          WDAYVA
     I              A1AWVA                          WDAWVA
     I              A1AOPR                          WDAOPR
     I              A1AXVA                          WDAXVA
     I              A1APPR                          WDAPPR
     I              A1ASPR                          WDASPR
     I              A1A4VA                          WDA4VA
     I              A1ATPR                          WDATPR
     I              A1A5VA                          WDA5VA
     I              A1CBPR                          WDCBPR
     I              A1CCPR                          WDCCPR
     I              A1LPNB                          WDLPNB
     I              A1CDPR                          WDCDPR
     I              A1A7VA                          WDA7VA
     I              A1A2PR                          WDA2PR
     I              A1JWST                          WDJWST
     I              A1CWST                          WDCWST
     I              A1D7ST                          WDD7ST
     I              A1D8ST                          WDD8ST
     I              A1DWST                          WDDWST
     I              A1D6ST                          WDD6ST
     I              A1GHNB                          WDGHNB
     I              A1BYDT                          WDBYDT
     I              A1E0ST                          WDE0ST
     I              A1E1ST                          WDE1ST
     I              A1E2ST                          WDE2ST
     I              A1BSDT                          WDBSDT
     I              A1BTDT                          WDBTDT
     I              A1BUDT                          WDBUDT
     I              A1HGNB                          WDHGNB
     I              A1HHNB                          WDHHNB
     I              A1HINB                          WDHINB
     I              A1A3PR                          WDA3PR
     I              A1A4PR                          WDA4PR
     I              A1A6PR                          WDA6PR
     I              A1J9NB                          WDJ9NB
     I              A1D6PR                          WDD6PR
     I              A1D7PR                          WDD7PR
     I              A1D8PR                          WDD8PR
     I              A1D9PR                          WDD9PR
     I              A1EAPR                          WDEAPR
     I              A1EBPR                          WDEBPR
     I              A1ECPR                          WDECPR
     I              A1EDPR                          WDEDPR
     I              A1EEPR                          WDEEPR
     I              A1EFPR                          WDEFPR
     I              A1EGPR                          WDEGPR
     I              A1EHPR                          WDEHPR
     I              A1KAST                          WDKAST
     I              A1J7ST                          WDJ7ST
     I              A1J9ST                          WDJ9ST
     I              A1OXNB                          WDOXNB
     I              A1LKST                          WDLKST
     I              A1LLST                          WDLLST
     I              A1J8ST                          WDJ8ST
     I              A1LIST                          WDLIST
     I              A1LJST                          WDLJST
     I              A1NZTX                          WDNZTX
     I              A1HJCD                          WDHJCD
     I              A1R4ST                          WDR4ST
     I              A1R5ST                          WDR5ST
     I              A1R6ST                          WDR6ST
     I              A1R7ST                          WDR7ST
     I              A1THWT                          WDTHWT
     I              A1T2WT                          WDT2WT
     I              A1THHD                          WDTHHD
     I              A1T2HD                          WDT2HD
     I              A1OBPR                          WDOBPR
     I              A1KOER                          WDKOER
     I              A1OPIR                          WDOPIR
     I              A1OPEM                          WDOPEM
     I              A1IORP                          WDIORP
     I              A1OWEO                          WDOWEO
     I              A1OQET                          WDOQET
     I              A1URST                          WDURST
     I              A1USST                          WDUSST
     I              A1HHPC                          WDHHPC
     I              A1S9PR                          WDS9PR
     I              A1TAPR                          WDTAPR
     I              A1TBPR                          WDTBPR
     I              A1JFUR                          WDJFUR
     I              A1KRIF                          WDKRIF
     I              A1KORF                          WDKORF
     I              A1KAPR                          WDKAPR
     I              A1KROT                          WDKROT
     I              A1OTJG                          WDOTJG
     I              A1IRJG                          WDIRJG
     I              A1IMJF                          WDIMJF
     I              A1IRGF                          WDIRGF
     I              A1KRJF                          WDKRJF
     I              A1OJRF                          WDOJRF
     I              A1KFOR                          WDKFOR
     I              A1ORJK                          WDORJK
     I              A1OMVJ                          WDOMVJ
     I              A1MVNF                          WDMVNF
     I              A1MCNF                          WDMCNF
     I              A1NCNF                          WDNCNF
     I              A1NCHF                          WDNCHF
     I              A1IGIR                          WDIGIR
     I              A1KFJR                          WDKFJR
     I              A1EADT                          WDEADT
     I              A1EBDT                          WDEBDT
     I              A1ECDT                          WDECDT
     I              A1EDDT                          WDEDDT
     I              A1EEDT                          WDEEDT
     I              A1U4ST                          WDU4ST
     I              A1U5ST                          WDU5ST
     I              A1U6ST                          WDU6ST
     I              A1U7ST                          WDU7ST
     I              A1U8ST                          WDU8ST
     I              A1U9ST                          WDU9ST
     I              A1VAST                          WDVAST
     I              A1VBST                          WDVBST
     I              A1BDCD                          WDBDCD
     I              A1CSCD                          WDCSCD
     I              A1ABCD                          WDABCD
     I              A1AECD                          WDAECD
     I              A1ACCD                          WDACCD
     I              A1AGCD                          WDAGCD
     I              A1BECD                          WDBECD
     I              A1AAVN                          WDAAVN
     I              A1AADT                          WDAADT
     I              A1AMTM                          WDAMTM
     I              A1AJST                          WDAJST
     I              A1AHVN                          WDAHVN
     I              A1AGVN                          WDAGVN
     I              A1ABVN                          WDABVN
     I              A1ABDT                          WDABDT
     I              A1ABTM                          WDABTM
      *
     I@A1CPC5
      * Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WEHMNB
     I              A1BNNB                          WEBNNB
     I              A1BONB                          WEBONB
     I              A1CVNB                          WECVNB
     I              A1B0DT                          WEB0DT
     I              A1AWDT                          WEAWDT
     I              A1BICD                          WEBICD
     I              A1CPST                          WECPST
     I              A1ACPR                          WEACPR
     I              A1B9PR                          WEB9PR
     I              A1CAPR                          WECAPR
     I              A1C4ST                          WEC4ST
     I              A1AIPR                          WEAIPR
     I              A1A6DT                          WEA6DT
     I              A1C2ST                          WEC2ST
     I              A1CXNB                          WECXNB
     I              A1CWNB                          WECWNB
     I              A1FCNB                          WEFCNB
     I              A1H9NB                          WEH9NB
     I              A1FDNB                          WEFDNB
     I              A1FENB                          WEFENB
     I              A1HENB                          WEHENB
     I              A1HFNB                          WEHFNB
     I              A1CYNB                          WECYNB
     I              A1LRNB                          WELRNB
     I              A1E0NB                          WEE0NB
     I              A1A5PC                          WEA5PC
     I              A1FBNB                          WEFBNB
     I              A1A4PC                          WEA4PC
     I              A1F7NB                          WEF7NB
     I              A1HDNB                          WEHDNB
     I              A1F5NB                          WEF5NB
     I              A1F4NB                          WEF4NB
     I              A1F3NB                          WEF3NB
     I              A1F2NB                          WEF2NB
     I              A1AVPC                          WEAVPC
     I              A1AWPC                          WEAWPC
     I              A1CWPC                          WECWPC
     I              A1A8PC                          WEA8PC
     I              A1A7PC                          WEA7PC
     I              A1B8PR                          WEB8PR
     I              A1AMPR                          WEAMPR
     I              A1ANPR                          WEANPR
     I              A1AYVA                          WEAYVA
     I              A1AWVA                          WEAWVA
     I              A1AOPR                          WEAOPR
     I              A1AXVA                          WEAXVA
     I              A1APPR                          WEAPPR
     I              A1ASPR                          WEASPR
     I              A1A4VA                          WEA4VA
     I              A1ATPR                          WEATPR
     I              A1A5VA                          WEA5VA
     I              A1CBPR                          WECBPR
     I              A1CCPR                          WECCPR
     I              A1LPNB                          WELPNB
     I              A1CDPR                          WECDPR
     I              A1A7VA                          WEA7VA
     I              A1A2PR                          WEA2PR
     I              A1JWST                          WEJWST
     I              A1CWST                          WECWST
     I              A1D7ST                          WED7ST
     I              A1D8ST                          WED8ST
     I              A1DWST                          WEDWST
     I              A1D6ST                          WED6ST
     I              A1GHNB                          WEGHNB
     I              A1BYDT                          WEBYDT
     I              A1E0ST                          WEE0ST
     I              A1E1ST                          WEE1ST
     I              A1E2ST                          WEE2ST
     I              A1BSDT                          WEBSDT
     I              A1BTDT                          WEBTDT
     I              A1BUDT                          WEBUDT
     I              A1HGNB                          WEHGNB
     I              A1HHNB                          WEHHNB
     I              A1HINB                          WEHINB
     I              A1A3PR                          WEA3PR
     I              A1A4PR                          WEA4PR
     I              A1A6PR                          WEA6PR
     I              A1J9NB                          WEJ9NB
     I              A1D6PR                          WED6PR
     I              A1D7PR                          WED7PR
     I              A1D8PR                          WED8PR
     I              A1D9PR                          WED9PR
     I              A1EAPR                          WEEAPR
     I              A1EBPR                          WEEBPR
     I              A1ECPR                          WEECPR
     I              A1EDPR                          WEEDPR
     I              A1EEPR                          WEEEPR
     I              A1EFPR                          WEEFPR
     I              A1EGPR                          WEEGPR
     I              A1EHPR                          WEEHPR
     I              A1KAST                          WEKAST
     I              A1J7ST                          WEJ7ST
     I              A1J9ST                          WEJ9ST
     I              A1OXNB                          WEOXNB
     I              A1LKST                          WELKST
     I              A1LLST                          WELLST
     I              A1J8ST                          WEJ8ST
     I              A1LIST                          WELIST
     I              A1LJST                          WELJST
     I              A1NZTX                          WENZTX
     I              A1HJCD                          WEHJCD
     I              A1R4ST                          WER4ST
     I              A1R5ST                          WER5ST
     I              A1R6ST                          WER6ST
     I              A1R7ST                          WER7ST
     I              A1THWT                          WETHWT
     I              A1T2WT                          WET2WT
     I              A1THHD                          WETHHD
     I              A1T2HD                          WET2HD
     I              A1OBPR                          WEOBPR
     I              A1KOER                          WEKOER
     I              A1OPIR                          WEOPIR
     I              A1OPEM                          WEOPEM
     I              A1IORP                          WEIORP
     I              A1OWEO                          WEOWEO
     I              A1OQET                          WEOQET
     I              A1URST                          WEURST
     I              A1USST                          WEUSST
     I              A1HHPC                          WEHHPC
     I              A1S9PR                          WES9PR
     I              A1TAPR                          WETAPR
     I              A1TBPR                          WETBPR
     I              A1JFUR                          WEJFUR
     I              A1KRIF                          WEKRIF
     I              A1KORF                          WEKORF
     I              A1KAPR                          WEKAPR
     I              A1KROT                          WEKROT
     I              A1OTJG                          WEOTJG
     I              A1IRJG                          WEIRJG
     I              A1IMJF                          WEIMJF
     I              A1IRGF                          WEIRGF
     I              A1KRJF                          WEKRJF
     I              A1OJRF                          WEOJRF
     I              A1KFOR                          WEKFOR
     I              A1ORJK                          WEORJK
     I              A1OMVJ                          WEOMVJ
     I              A1MVNF                          WEMVNF
     I              A1MCNF                          WEMCNF
     I              A1NCNF                          WENCNF
     I              A1NCHF                          WENCHF
     I              A1IGIR                          WEIGIR
     I              A1KFJR                          WEKFJR
     I              A1EADT                          WEEADT
     I              A1EBDT                          WEEBDT
     I              A1ECDT                          WEECDT
     I              A1EDDT                          WEEDDT
     I              A1EEDT                          WEEEDT
     I              A1U4ST                          WEU4ST
     I              A1U5ST                          WEU5ST
     I              A1U6ST                          WEU6ST
     I              A1U7ST                          WEU7ST
     I              A1U8ST                          WEU8ST
     I              A1U9ST                          WEU9ST
     I              A1VAST                          WEVAST
     I              A1VBST                          WEVBST
     I              A1BDCD                          WEBDCD
     I              A1CSCD                          WECSCD
     I              A1ABCD                          WEABCD
     I              A1AECD                          WEAECD
     I              A1ACCD                          WEACCD
     I              A1AGCD                          WEAGCD
     I              A1BECD                          WEBECD
     I              A1AAVN                          WEAAVN
     I              A1AADT                          WEAADT
     I              A1AMTM                          WEAMTM
     I              A1AJST                          WEAJST
     I              A1AHVN                          WEAHVN
     I              A1AGVN                          WEAGVN
     I              A1ABVN                          WEABVN
     I              A1ABDT                          WEABDT
     I              A1ABTM                          WEABTM
      *
     I@EJCPBK
      * Buy Order Load Weight     Co/BOL
      * Renamed input format fields
     I              EJHONB                          WFHONB
     I              EJABCD                          WFABCD
     I              EJAECD                          WFAECD
     I              EJBOMV                          WFBOMV
     I              EJSRST                          WFSRST
     I              EJBOSW                          WFBOSW
     I              EJDQDT                          WFDQDT
     I              EJA2TM                          WFA2TM
     I              EJSSST                          WFSSST
     I              EJSTST                          WFSTST
     I              EJSUST                          WFSUST
     I              EJHMNB                          WFHMNB
     I              EJBNNB                          WFBNNB
     I              EJBONB                          WFBONB
     I              EJAAVN                          WFAAVN
     I              EJAADT                          WFAADT
     I              EJAMTM                          WFAMTM
     I              EJAJST                          WFAJST
     I              EJAHVN                          WFAHVN
     I              EJAGVN                          WFAGVN
     I              EJABVN                          WFABVN
     I              EJABDT                          WFABDT
     I              EJABTM                          WFABTM
      *
     I@AZCPCN
      * Company Control HPE       Retrieval index
      * Renamed input format fields
     I              AZHONB                          WGHONB
     I              AZBSNB                          WGBSNB
     I              AZB1DT                          WGB1DT
     I              AZB2DT                          WGB2DT
     I              AZH4NB                          WGH4NB
     I              AZK3NB                          WGK3NB
     I              AZCDDT                          WGCDDT
     I              AZCEDT                          WGCEDT
     I              AZAAVN                          WGAAVN
     I              AZAADT                          WGAADT
     I              AZAMTM                          WGAMTM
     I              AZAJST                          WGAJST
     I              AZAHVN                          WGAHVN
     I              AZAGVN                          WGAGVN
     I              AZABVN                          WGABVN
     I              AZABDT                          WGABDT
     I              AZABTM                          WGABTM
      *
     I@AFREAR
      * Producer Location         Retrieval index
      * Renamed input format fields
     I              AFABCD                          WHABCD
     I              AFAECD                          WHAECD
     I              AFA8TX                          WHA8TX
     I              AFGLNB                          WHGLNB
     I              AFATST                          WHATST
     I              AFASNB                          WHASNB
     I              AFAUST                          WHAUST
     I              AFQNST                          WHQNST
     I              AFQOST                          WHQOST
     I              AFQPST                          WHQPST
     I              AFQQST                          WHQQST
     I              AFQRST                          WHQRST
     I              AFN0TX                          WHN0TX
     I              AFQSST                          WHQSST
     I              AFQTST                          WHQTST
     I              AFQUST                          WHQUST
     I              AFQVST                          WHQVST
     I              AFR8ST                          WHR8ST
     I              AFR9ST                          WHR9ST
     I              AFSAST                          WHSAST
     I              AFSBST                          WHSBST
     I              AFSDST                          WHSDST
     I              AFSEST                          WHSEST
     I              AFSFST                          WHSFST
     I              AFHWNB                          WHHWNB
     I              AFFUCD                          WHFUCD
     I              AFAAVN                          WHAAVN
     I              AFAADT                          WHAADT
     I              AFAMTM                          WHAMTM
     I              AFAJST                          WHAJST
     I              AFAHVN                          WHAHVN
     I              AFAGVN                          WHAGVN
     I              AFABVN                          WHABVN
     I              AFABDT                          WHABDT
     I              AFABTM                          WHABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IQPKEJ1    E DSPKEJCPL0
      * UPD : Buy Order Load Weight     Update index
      * Renamed input format fields
     I              EJHONB                          WAHONB
     I              EJABCD                          WAABCD
     I              EJAECD                          WAAECD
     I              EJBOMV                          WABOMV
     I              EJSRST                          WASRST
     I              EJBOSW                          WABOSW
     I              EJDQDT                          WADQDT
     I              EJA2TM                          WAA2TM
     I              EJSSST                          WASSST
     I              EJSTST                          WASTST
     I              EJSUST                          WASUST
     I              EJHMNB                          WAHMNB
     I              EJBNNB                          WABNNB
     I              EJBONB                          WABONB
     I              EJAAVN                          WAAAVN
     I              EJAADT                          WAAADT
     I              EJAMTM                          WAAMTM
     I              EJAJST                          WAAJST
     I              EJAHVN                          WAAHVN
     I              EJAGVN                          WAAGVN
     I              EJABVN                          WAABVN
     I              EJABDT                          WAABDT
     I              EJABTM                          WAABTM
      *
     IYARDCS      DS                            102
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKAX1    E DSPKAXCPL1
      * UPD : Buy Order Load            Update index
      * Renamed input format fields
     I              AXHMNB                          WCHMNB
     I              AXBNNB                          WCBNNB
     I              AXBONB                          WCBONB
     I              AXCQDT                          WCCQDT
     I              AXABTH                          WCABTH
     I              AXACTH                          WCACTH
     I              AXBPNB                          WCBPNB
     I              AXCSNB                          WCCSNB
     I              AXAUDT                          WCAUDT
     I              AXCMST                          WCCMST
     I              AXAGPR                          WCAGPR
     I              AXATVA                          WCATVA
     I              AXI1ST                          WCI1ST
     I              AXDHNB                          WCDHNB
     I              AXDINB                          WCDINB
     I              AXCNST                          WCCNST
     I              AXGINB                          WCGINB
     I              AXBZDT                          WCBZDT
     I              AXLSNB                          WCLSNB
     I              AXF3TX                          WCF3TX
     I              AXO8ST                          WCO8ST
     I              AXO9ST                          WCO9ST
     I              AXPAST                          WCPAST
     I              AXLDSH                          WCLDSH
     I              AXPBST                          WCPBST
     I              AXPCST                          WCPCST
     I              AXPDST                          WCPDST
     I              AXUWST                          WCUWST
     I              AXUXST                          WCUXST
     I              AXUYST                          WCUYST
     I              AXJKRU                          WCJKRU
     I              AXKEOR                          WCKEOR
     I              AXIOEW                          WCIOEW
     I              AXKJIO                          WCKJIO
     I              AXIOJR                          WCIOJR
     I              AXEIRR                          WCEIRR
     I              AXITMF                          WCITMF
     I              AXODJE                          WCODJE
     I              AXRJIF                          WCRJIF
     I              AXOEJF                          WCOEJF
     I              AXD0DT                          WCD0DT
     I              AXD1DT                          WCD1DT
     I              AXD2DT                          WCD2DT
     I              AXD3DT                          WCD3DT
     I              AXD4DT                          WCD4DT
     I              AXBNCD                          WCBNCD
     I              AXABCD                          WCABCD
     I              AXAECD                          WCAECD
     I              AXAAVN                          WCAAVN
     I              AXAADT                          WCAADT
     I              AXAMTM                          WCAMTM
     I              AXAJST                          WCAJST
     I              AXAHVN                          WCAHVN
     I              AXAGVN                          WCAGVN
     I              AXABVN                          WCABVN
     I              AXABDT                          WCABDT
     I              AXABTM                          WCABTM
      *
     IYBRDCS      DS                            237
     IQPKA11    E DSPKA1CPL1
      * UPD : Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WEHMNB
     I              A1BNNB                          WEBNNB
     I              A1BONB                          WEBONB
     I              A1CVNB                          WECVNB
     I              A1B0DT                          WEB0DT
     I              A1AWDT                          WEAWDT
     I              A1BICD                          WEBICD
     I              A1CPST                          WECPST
     I              A1ACPR                          WEACPR
     I              A1B9PR                          WEB9PR
     I              A1CAPR                          WECAPR
     I              A1C4ST                          WEC4ST
     I              A1AIPR                          WEAIPR
     I              A1A6DT                          WEA6DT
     I              A1C2ST                          WEC2ST
     I              A1CXNB                          WECXNB
     I              A1CWNB                          WECWNB
     I              A1FCNB                          WEFCNB
     I              A1H9NB                          WEH9NB
     I              A1FDNB                          WEFDNB
     I              A1FENB                          WEFENB
     I              A1HENB                          WEHENB
     I              A1HFNB                          WEHFNB
     I              A1CYNB                          WECYNB
     I              A1LRNB                          WELRNB
     I              A1E0NB                          WEE0NB
     I              A1A5PC                          WEA5PC
     I              A1FBNB                          WEFBNB
     I              A1A4PC                          WEA4PC
     I              A1F7NB                          WEF7NB
     I              A1HDNB                          WEHDNB
     I              A1F5NB                          WEF5NB
     I              A1F4NB                          WEF4NB
     I              A1F3NB                          WEF3NB
     I              A1F2NB                          WEF2NB
     I              A1AVPC                          WEAVPC
     I              A1AWPC                          WEAWPC
     I              A1CWPC                          WECWPC
     I              A1A8PC                          WEA8PC
     I              A1A7PC                          WEA7PC
     I              A1B8PR                          WEB8PR
     I              A1AMPR                          WEAMPR
     I              A1ANPR                          WEANPR
     I              A1AYVA                          WEAYVA
     I              A1AWVA                          WEAWVA
     I              A1AOPR                          WEAOPR
     I              A1AXVA                          WEAXVA
     I              A1APPR                          WEAPPR
     I              A1ASPR                          WEASPR
     I              A1A4VA                          WEA4VA
     I              A1ATPR                          WEATPR
     I              A1A5VA                          WEA5VA
     I              A1CBPR                          WECBPR
     I              A1CCPR                          WECCPR
     I              A1LPNB                          WELPNB
     I              A1CDPR                          WECDPR
     I              A1A7VA                          WEA7VA
     I              A1A2PR                          WEA2PR
     I              A1JWST                          WEJWST
     I              A1CWST                          WECWST
     I              A1D7ST                          WED7ST
     I              A1D8ST                          WED8ST
     I              A1DWST                          WEDWST
     I              A1D6ST                          WED6ST
     I              A1GHNB                          WEGHNB
     I              A1BYDT                          WEBYDT
     I              A1E0ST                          WEE0ST
     I              A1E1ST                          WEE1ST
     I              A1E2ST                          WEE2ST
     I              A1BSDT                          WEBSDT
     I              A1BTDT                          WEBTDT
     I              A1BUDT                          WEBUDT
     I              A1HGNB                          WEHGNB
     I              A1HHNB                          WEHHNB
     I              A1HINB                          WEHINB
     I              A1A3PR                          WEA3PR
     I              A1A4PR                          WEA4PR
     I              A1A6PR                          WEA6PR
     I              A1J9NB                          WEJ9NB
     I              A1D6PR                          WED6PR
     I              A1D7PR                          WED7PR
     I              A1D8PR                          WED8PR
     I              A1D9PR                          WED9PR
     I              A1EAPR                          WEEAPR
     I              A1EBPR                          WEEBPR
     I              A1ECPR                          WEECPR
     I              A1EDPR                          WEEDPR
     I              A1EEPR                          WEEEPR
     I              A1EFPR                          WEEFPR
     I              A1EGPR                          WEEGPR
     I              A1EHPR                          WEEHPR
     I              A1KAST                          WEKAST
     I              A1J7ST                          WEJ7ST
     I              A1J9ST                          WEJ9ST
     I              A1OXNB                          WEOXNB
     I              A1LKST                          WELKST
     I              A1LLST                          WELLST
     I              A1J8ST                          WEJ8ST
     I              A1LIST                          WELIST
     I              A1LJST                          WELJST
     I              A1NZTX                          WENZTX
     I              A1HJCD                          WEHJCD
     I              A1R4ST                          WER4ST
     I              A1R5ST                          WER5ST
     I              A1R6ST                          WER6ST
     I              A1R7ST                          WER7ST
     I              A1THWT                          WETHWT
     I              A1T2WT                          WET2WT
     I              A1THHD                          WETHHD
     I              A1T2HD                          WET2HD
     I              A1OBPR                          WEOBPR
     I              A1KOER                          WEKOER
     I              A1OPIR                          WEOPIR
     I              A1OPEM                          WEOPEM
     I              A1IORP                          WEIORP
     I              A1OWEO                          WEOWEO
     I              A1OQET                          WEOQET
     I              A1URST                          WEURST
     I              A1USST                          WEUSST
     I              A1HHPC                          WEHHPC
     I              A1S9PR                          WES9PR
     I              A1TAPR                          WETAPR
     I              A1TBPR                          WETBPR
     I              A1JFUR                          WEJFUR
     I              A1KRIF                          WEKRIF
     I              A1KORF                          WEKORF
     I              A1KAPR                          WEKAPR
     I              A1KROT                          WEKROT
     I              A1OTJG                          WEOTJG
     I              A1IRJG                          WEIRJG
     I              A1IMJF                          WEIMJF
     I              A1IRGF                          WEIRGF
     I              A1KRJF                          WEKRJF
     I              A1OJRF                          WEOJRF
     I              A1KFOR                          WEKFOR
     I              A1ORJK                          WEORJK
     I              A1OMVJ                          WEOMVJ
     I              A1MVNF                          WEMVNF
     I              A1MCNF                          WEMCNF
     I              A1NCNF                          WENCNF
     I              A1NCHF                          WENCHF
     I              A1IGIR                          WEIGIR
     I              A1KFJR                          WEKFJR
     I              A1EADT                          WEEADT
     I              A1EBDT                          WEEBDT
     I              A1ECDT                          WEECDT
     I              A1EDDT                          WEEDDT
     I              A1EEDT                          WEEEDT
     I              A1U4ST                          WEU4ST
     I              A1U5ST                          WEU5ST
     I              A1U6ST                          WEU6ST
     I              A1U7ST                          WEU7ST
     I              A1U8ST                          WEU8ST
     I              A1U9ST                          WEU9ST
     I              A1VAST                          WEVAST
     I              A1VBST                          WEVBST
     I              A1BDCD                          WEBDCD
     I              A1CSCD                          WECSCD
     I              A1ABCD                          WEABCD
     I              A1AECD                          WEAECD
     I              A1ACCD                          WEACCD
     I              A1AGCD                          WEAGCD
     I              A1BECD                          WEBECD
     I              A1AAVN                          WEAAVN
     I              A1AADT                          WEAADT
     I              A1AMTM                          WEAMTM
     I              A1AJST                          WEAJST
     I              A1AHVN                          WEAHVN
     I              A1AGVN                          WEAGVN
     I              A1ABVN                          WEABVN
     I              A1ABDT                          WEABDT
     I              A1ABTM                          WEABTM
      *
     IYCRDCS      DS                            583
     IYDRDCS      DS                            237
     IYERDCS      DS                            583
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Buy Order Load Weight
      * I : MAP CC Company Number
     I                                    P   1   20P1HONB
      * I : MAP PD Producer Code
     I                                        3   8 P1ABCD
      * I : MAP PL Location Code
     I                                        9  14 P1AECD
      * I : MAP BOLW Movement Number
     I                                    P  15  190P1BOMV
      * I : MAP BOLW Weight Type
     I                                       20  20 P1SRST
      * I : MAP BOLW Scale Weight
     I                                    P  21  241P1BOSW
      * I : MAP BOLW Scale Weight Date
     I                                    P  25  280P1DQDT
      * I : MAP BOLW Scale Weight Time
     I                                    P  29  320P1A2TM
      * I : MAP BOLW Spread Status
     I                                       33  33 P1SSST
      * I : MAP BOLW Unused Sts 1
     I                                       34  34 P1STST
      * I : MAP BOLW Unused Sts 2
     I                                       35  36 P1SUST
      * I : MAP BOH Company Number
     I                                    P  37  380P1HMNB
      * I : MAP BOH Buy Order Number
     I                                    P  39  420P1BNNB
      * I : MAP BOL Load Number
     I                                    P  43  450P1BONB
     IP2PARM      DS
      * FLD: *Arrays
      * N :  Oms Warehouse Code
     I                                        1   3 P2J8NB
      * N :  Oms Application Code
     I                                        4   9 P2C7CD
      * N :  Oms SalesPerson Code
     I                                       10  12 P2C8CD
      * N :  Oms Allow Multi-Company
     I                                       13  13 P2G8ST
      * N :  Oms Default Printer
     I                                       14  23 P2G9ST
      * N :  Oms Name
     I                                       24  53 P2EUTX
      * N :  Oms System Value Alpha
     I                                       54  93 P2EVTX
      * N :  Oms Access Denied (Y/N)
     I                                       94  94 P2HAST
     IP3PARM      DS
      * N :  Record Found USR
     I                                        1   1 P3H7ST
     IP4PARM      DS
      * FLD: Buy Order Load
      * N :  BOL Truck Scale Weigh Sts
     I                                        1   1 P4PAST
     IP5PARM      DS
      * N :  BOL IN  record found  USR
     I                                        1   1 P5SWST
     IP6PARM      DS
      * N :  BOL OUT record found  USR
     I                                        1   1 P6SXST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Movement # is not valid'
      * BOLW Movement Number
     I                                    P   1   50ZA0001
      * Message data for 'Buy Order Load NF'
      * BOH Buy Order Number
     I                                    P   1   40ZA0002
      * BOL Load Number
     I                                    P   5   70ZA0003
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HONB    PARM           WP0001  30       CC Company Numb
     C           P1ABCD    PARM           WP0002  6        PD Producer Cod
     C           P1AECD    PARM           WP0003  6        PL Location Cod
     C           P1BOMV    PARM           WP0004  90       BOLW Movement N
     C           P1SRST    PARM           WP0005  1        BOLW Weight Typ
     C           P1BOSW    PARM           WP0006  71       BOLW Scale Weig
     C           P1DQDT    PARM           WP0007  70       BOLW Scale Weig
     C           P1A2TM    PARM           WP0008  60       BOLW Scale Weig
     C           P1SSST    PARM           WP0009  1        BOLW Spread Sta
     C           P1STST    PARM           WP0010  1        BOLW Unused Sts
     C           P1SUST    PARM           WP0011  2        BOLW Unused Sts
     C           P1HMNB    PARM           WP0012  30       BOH Company Num
     C           P1BNNB    PARM           WP0013  70       BOH Buy Order N
     C           P1BONB    PARM           WP0014  50       BOL Load Number
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Reposition window
     C   26                CAS            ZRRPWD
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Enable PUTOVR
     C                     SETON                     86
     C                     Z-ADD1         YWPNNO  10       Panel number
     C                     MOVEL'R'       YWLCTP  1        Locate action t
     C                     EXSR ZSSTLC                     Set window loca
     C                     Z-ADD1         W0WASM  10
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPMCF
      * Quit if not confirmed
     C           *IN99     CABEQ'1'       DAEXIT
      * USER: User defined action
      * Trns BOL Weight       RT - Buy Order Load Weight  * 
     C                     EXSR SARVGN
      * Exit program
     C                     EXSR ZXEXPG
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
      * Validate Weight Type USR
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DSZST'  IFEQ YPMTFD
      * Weight Type USR
     C                     MOVEL#DSZST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHSZST
     C                     SELEC
     C           W0INVL    WHEQ 'I'                        I
     C                     Z-ADD1         ZHSZST
     C           W0INVL    WHEQ 'O'                        O
     C                     Z-ADD2         ZHSZST
     C                     ENDSL
     C                     EXFMTZGSZST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHSZST    WHEQ 1
     C                     MOVEL'I'       W0INVL           I
     C           ZHSZST    WHEQ 2
     C                     MOVEL'O'       W0INVL           O
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DSZST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate fields
      * Sel: Buy Order Load
      * CASE: DTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PGM.*Cursor field <IS> DTL.Buy Order Number USR
      *   |- c2    : PGM.*Cursor field <IS> DTL.Buy Order Load USR
      *   '-
     C           W0CFL     IFEQ '#DSXNB'                   *IF
     C           W0CFL     OREQ '#DXWNB'                   *OR
      * Sel Buy Orde Load     SR - Buy Order Load  * 
     C                     CALL 'PKQJSRR'              90  Sel Producer BO
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0001  30       BOH Company Num
     C           #1BNNB    PARM #1BNNB    WQ0002  70       BOH Buy Order N
     C           #1BONB    PARM #1BONB    WQ0003  50       BOL Load Number
     C                     PARM #1ABCD    WQ0004  6        PD Producer Cod
     C                     PARM #1AECD    WQ0005  6        PL Location Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKQJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * Z1l HPS Movement Rfrn UP - STR HPS Interface  * 
     C                     CALL 'HP251'                90  Z1l HPS Movemen
     C           WULMST    PARM WULMST    WQ0006  7        Return Code USR
     C                     PARM #DCCNZ    WQ0007  70       TH HPS Movement
     C           WUSHDT    PARM *ZERO     WQ0008  80       Scheduled Kill
     C           YL0001    PARM *ZERO     WQ0009  50       Scheduled Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP251'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
     C                     END
      * Validate Movement Number
      * CASE: WRK.*Return code is HPS Movement Rfrnc Err 1
     C           WURTN     IFEQ 'HPSM1'                    *IF
      * Setup message data for message
     C                     Z-ADD#DCCNZ    ZA0001           Movement # 9.0
      * Send message 'Movement # is not valid'
     C                     MOVEL'PRK0868' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
      * Val Buy Order Load    RT - Buy Order Load Weight  * 
     C                     EXSR SMRVGN
      * CASE: DTL.Weight Type USR is Out(Fuera)
     C           #DSZST    IFEQ 'O'                        *IF
      * CASE: PAR.BOL IN  record found  USR is No
     C           P5SWST    IFEQ 'N'                        *IF
     C                     END                             *FI
     C                     END                             *FI
      * Val Buy Order Load    RT - Buy Order Load  * 
     C                     EXSR SNRVGN
      * Validate Buy Order Load
      * CASE: PAR.Record Found USR is Record Not Found
     C           P3H7ST    IFEQ 'N'                        *IF
      * Setup message data for message
     C                     Z-ADD#DSXNB    ZA0002           Buy Order Numbe
     C                     Z-ADD#DXWNB    ZA0003           Buy Order Load
      * Send message 'Buy Order Load NF'
     C                     MOVEL'PRK0872' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993334*
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
     C                     END
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
      * Check reference to Company Control HPE
     C                     EXSR VACKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Producer Location
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Buy Order Load
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Movement # 9.0 USE required
     C           #DCCNZ    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Weight Type USR required
     C           #DSZST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Buy Order Number USR required
     C           #DSXNB    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9933  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Buy Order Load USR required
     C           #DXWNB    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9934  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DHPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Update screen time
     C                     TIME           ##TME
      * Enable PUTOVR
     C                     SETON                         86*
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     EXSR ZVCFPM
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'PKVLLWR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     Z-ADDP1DQDT    #1DQDT           BOLW Scale Weig
     C                     Z-ADDP1A2TM    #1A2TM           BOLW Scale Weig
     C                     MOVELP1SSST    #1SSST           BOLW Spread Sta
     C                     MOVELP1STST    #1STST           BOLW Unused Sts
     C                     MOVELP1SUST    #1SUST           BOLW Unused Sts
     C                     Z-ADDP1HMNB    #1HMNB           BOH Company Num
     C                     MOVEL*BLANK    #1AAVN           RS User Changed
     C                     Z-ADD*ZERO     #1AADT           RS Date Changed
     C                     Z-ADD*ZERO     #1AMTM           RS Time Changed
     C                     MOVEL*BLANK    #1AJST           RS Record Statu
     C                     MOVEL*BLANK    #1AHVN           RS Job
     C                     MOVEL*BLANK    #1AGVN           RS Program
     C                     MOVEL*BLANK    #1ABVN           RS User Added
     C                     Z-ADD*ZERO     #1ABDT           RS Date Added
     C                     Z-ADD*ZERO     #1ABTM           RS Time Added
     C                     Z-ADDP1HONB    #1HONB           CC Company Numb
     C                     MOVELP1ABCD    #1ABCD           PD Producer Cod
     C                     Z-ADDP1BOMV    #1BOMV           BOLW Movement N
     C                     MOVELP1AECD    #1AECD           PL Location Cod
     C                     MOVELP1SRST    #1SRST           BOLW Weight Typ
     C                     Z-ADDP1BOSW    #1BOSW           BOLW Scale Weig
     C                     Z-ADDP1BNNB    #1BNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    #1BONB           BOL Load Number
     C                     Z-ADD*ZERO     #DCCNZ           Movement # 9.0
     C                     MOVEL*BLANK    #DSZST           Weight Type USR
     C                     MOVEL*BLANK    #DC4TX           Condition Name
     C                     Z-ADD*ZERO     #DSXNB           Buy Order Numbe
     C                     Z-ADD*ZERO     #DXWNB           Buy Order Load
      * USER: Load screen
      * DTL = PAR By name
     C                     Z-ADDP1HONB    #1HONB           CC Company Numb
     C                     MOVELP1ABCD    #1ABCD           PD Producer Cod
     C                     Z-ADDP1BOMV    #1BOMV           BOLW Movement N
     C                     MOVELP1AECD    #1AECD           PL Location Cod
     C                     MOVELP1SRST    #1SRST           BOLW Weight Typ
     C                     Z-ADDP1BOSW    #1BOSW           BOLW Scale Weig
     C                     Z-ADDP1DQDT    #1DQDT           BOLW Scale Weig
     C                     Z-ADDP1A2TM    #1A2TM           BOLW Scale Weig
     C                     MOVELP1SSST    #1SSST           BOLW Spread Sta
     C                     MOVELP1STST    #1STST           BOLW Unused Sts
     C                     MOVELP1SUST    #1SUST           BOLW Unused Sts
     C                     Z-ADDP1HMNB    #1HMNB           BOH Company Num
     C                     Z-ADDP1BNNB    #1BNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    #1BONB           BOL Load Number
     C                     Z-ADD#1BOMV    #DCCNZ           Movement # 9.0
     C                     MOVEL#1SRST    #DSZST           Weight Type USR
     C                     Z-ADD#1BNNB    #DSXNB           Buy Order Numbe
     C                     Z-ADD#1BONB    #DXWNB           Buy Order Load
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Trns BOL Weight       RT - Buy Order Load Weight  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           EJHONB           CC Company Numb
     C                     KFLD           EJABCD           PD Producer Cod
     C                     KFLD           EJAECD           PL Location Cod
     C                     KFLD           EJBOMV           BOLW Movement N
     C                     KFLD           EJSRST           BOLW Weight Typ
      * Setup key
     C                     Z-ADD#1HONB    EJHONB           CC Company Numb
     C                     MOVEL#1ABCD    EJABCD           PD Producer Cod
     C                     MOVEL#1AECD    EJAECD           PL Location Cod
     C                     Z-ADD#1BOMV    EJBOMV           BOLW Movement N
     C                     MOVEL#1SRST    EJSRST           BOLW Weight Typ
      * Establish starting position
     C           KRSSA     CHAIN@EJCPBI              90    *
      * Data record not found
     C   90                MOVEL'PRK0841' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Movement number new usr EQ DB1.BOLW Movement Num
      *   |- c2    : PAR.Weight Type USR EQ DB1.BOLW Weight Type
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DCCNZ    IFEQ EJBOMV                     *IF
     C           #DSZST    IFEQ EJSRST                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Trns BOL Weight       CH - Buy Order Load Weight  * 
     C                     EXSR SBCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Trns BOL Weight       CR - Buy Order Load Weight  * 
     C                     EXSR SCCRRC
      * Trns BOL Weight       DL - Buy Order Load Weight  * 
     C                     EXSR SDDLRC
     C                     END                             *FI
     C                     ENDIF
      * USER: Exit processing
      * CASE: PAR.Weight Type USR is In(En)
     C           #DSZST    IFEQ 'I'                        *IF
      * Upd Trk Scl Weigh Sts RT - Buy Order Load  * 
     C                     EXSR SERVGN
     C                     ELSE
      * CASE: PAR.Weight Type USR is Out(Fuera)
     C           #DSZST    IFEQ 'O'                        *IF
      * Upd Trk Scl Weigh Sts RT - Buy Order Load  * 
     C                     EXSR SIRVGN
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCHRC    BEGSR
      *================================================================
      * Trns BOL Weight       CH - Buy Order Load Weight  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  71       BOLW Scale Weig
     C                     Z-ADD*ZERO     WN0002  70       BOLW Scale Weig
     C                     Z-ADD*ZERO     WN0003  60       BOLW Scale Weig
     C                     MOVEL*BLANK    WN0004  1        BOLW Spread Sta
     C                     MOVEL*BLANK    WN0005  1        BOLW Unused Sts
     C                     MOVEL*BLANK    WN0006  2        BOLW Unused Sts
     C                     Z-ADD*ZERO     WN0007  30       BOH Company Num
     C                     MOVEL*BLANK    WN0008 10        RS User Changed
     C                     Z-ADD*ZERO     WN0009  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0010  60       RS Time Changed
     C                     MOVEL*BLANK    WN0011  1        RS Record Statu
     C                     MOVEL*BLANK    WN0012 10        RS Job
     C                     MOVEL*BLANK    WN0013 10        RS Program
     C                     MOVEL*BLANK    WN0014 10        RS User Added
     C                     Z-ADD*ZERO     WN0015  70       RS Date Added
     C                     Z-ADD*ZERO     WN0016  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @EJCPBH
     C                     Z-ADDEJHONB    WAHONB           CC Company Numb
     C                     MOVELEJABCD    WAABCD    P      PD Producer Cod
     C                     MOVELEJAECD    WAAECD    P      PL Location Cod
     C                     Z-ADDEJBOMV    WABOMV           BOLW Movement N
     C                     MOVELEJSRST    WASRST    P      BOLW Weight Typ
      *
     C           KLCHSB    KLIST
     C                     KFLD           WAHONB           CC Company Numb
     C                     KFLD           WAABCD           PD Producer Cod
     C                     KFLD           WAAECD           PL Location Cod
     C                     KFLD           WABOMV           BOLW Movement N
     C                     KFLD           WASRST           BOLW Weight Typ
     C           KLCHSB    CHAIN@EJCPBH              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKEJCPL0'MDACP
     C                     MOVEL'@EJCPBH' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKEJ1    YARDCS
      * Move non-key fields to @EJCPBH
     C                     Z-ADD#1BNNB    WABNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    WABONB           BOL Load Number
      *
      * Set PGM.*Record Data Changed flag
     C           QPKEJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WAAAVN           RS User Changed
     C                     Z-ADD##JDT     WAAADT           RS Date Changed
     C                     Z-ADD##JTM     WAAMTM           RS Time Changed
     C                     MOVEL##JOB     WAAHVN           RS Job
     C                     MOVEL##PGM     WAAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKEJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@EJCPBH                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKEJCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCRRC    BEGSR
      *================================================================
      * Trns BOL Weight       CR - Buy Order Load Weight  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EJCPBH
     C                     Z-ADDEJHONB    WAHONB           CC Company Numb
     C                     MOVELEJABCD    WAABCD           PD Producer Cod
     C                     MOVELEJAECD    WAAECD           PL Location Cod
     C                     Z-ADD#DCCNZ    WABOMV           BOLW Movement N
     C                     MOVEL#DSZST    WASRST           BOLW Weight Typ
     C                     Z-ADDEJBOSW    WABOSW           BOLW Scale Weig
     C                     Z-ADDEJDQDT    WADQDT           BOLW Scale Weig
     C                     Z-ADDEJA2TM    WAA2TM           BOLW Scale Weig
     C                     MOVELEJSSST    WASSST           BOLW Spread Sta
     C                     MOVELEJSTST    WASTST           BOLW Unused Sts
     C                     MOVELEJSUST    WASUST           BOLW Unused Sts
     C                     Z-ADDEJHMNB    WAHMNB           BOH Company Num
     C                     Z-ADD#DSXNB    WABNNB           BOH Buy Order N
     C                     Z-ADD#DXWNB    WABONB           BOL Load Number
     C                     MOVELEJAAVN    WAAAVN           RS User Changed
     C                     Z-ADDEJAADT    WAAADT           RS Date Changed
     C                     Z-ADDEJAMTM    WAAMTM           RS Time Changed
     C                     MOVELEJAJST    WAAJST           RS Record Statu
     C                     MOVELEJAHVN    WAAHVN           RS Job
     C                     MOVELEJAGVN    WAAGVN           RS Program
     C                     MOVELEJABVN    WAABVN           RS User Added
     C                     Z-ADDEJABDT    WAABDT           RS Date Added
     C                     Z-ADDEJABTM    WAABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WAAJST           RS Record Statu
     C                     MOVEL##USR     WAABVN           RS User Added
     C                     Z-ADD##JDT     WAABDT           RS Date Added
     C                     Z-ADD##JTM     WAABTM           RS Time Added
     C                     MOVEL##PGM     WAAGVN           RS Program
     C                     MOVEL##JOB     WAAHVN           RS Job
     C           KLCRSC    KLIST
     C                     KFLD           WAHONB           CC Company Numb
     C                     KFLD           WAABCD           PD Producer Cod
     C                     KFLD           WAAECD           PL Location Cod
     C                     KFLD           WABOMV           BOLW Movement N
     C                     KFLD           WASRST           BOLW Weight Typ
      * Check for duplicate primary key
     C           KLCRSC    SETLL@EJCPBH                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0842' W0RTN   7
      * Send message 'Buy Order Load Weight  EX'
     C                     MOVEL'PRK0842' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C                     WRITE@EJCPBH                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDDLRC    BEGSR
      *================================================================
      * Trns BOL Weight       DL - Buy Order Load Weight  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @EJCPBH
     C                     Z-ADDEJHONB    WAHONB           CC Company Numb
     C                     MOVELEJABCD    WAABCD           PD Producer Cod
     C                     MOVELEJAECD    WAAECD           PL Location Cod
     C                     Z-ADDEJBOMV    WABOMV           BOLW Movement N
     C                     MOVELEJSRST    WASRST           BOLW Weight Typ
      *
     C           KLDLSD    KLIST
     C                     KFLD           WAHONB           CC Company Numb
     C                     KFLD           WAABCD           PD Producer Cod
     C                     KFLD           WAAECD           PL Location Cod
     C                     KFLD           WABOMV           BOLW Movement N
     C                     KFLD           WASRST           BOLW Weight Typ
     C           KLDLSD    CHAIN@EJCPBH              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKEJCPL0'MDACP
     C                     MOVEL'@EJCPBH' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@EJCPBH                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Upd Trk Scl Weigh Sts RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WBHMNB           BOH Company Num
     C                     KFLD           WBBNNB           BOH Buy Order N
     C                     KFLD           WBBONB           BOL Load Number
      * Setup key
     C                     Z-ADDEJHMNB    WBHMNB           BOH Company Num
     C                     Z-ADDEJBNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADDEJBONB    WBBONB           BOL Load Number
      * Establish starting position
     C           KRSSE     CHAIN@AXCPBX              90    *
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.BOL Truck Scale Weigh Sts is Respread
      *   |- c2    : DB1.BOL Truck Scale Weigh Sts is Not Spread
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           'I'       IFEQ 'R'                        *IF
     C           WBPAST    IFEQ 'I'                        *IF
     C           WBPAST    OREQ 'N'
     C           WBPAST    OREQ *BLANK
     C           WBPAST    OREQ 'O'
     C           WBPAST    OREQ 'R'
     C           WBPAST    OREQ 'A'
     C           WBPAST    OREQ 'C'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Trk Scl Weigh Sts CH - Buy Order Load  * 
     C                     EXSR SFCHRC
     C                     END                             *FI
      * CASE: PAR.BOL Truck Scale Weigh Sts is Respread
     C           'I'       IFEQ 'R'                        *IF
      * Upd Hdr/Bal Status    RT - Tattoo Header  * 
     C                     EXSR SGRVGN
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * Chg Trk Scl Weigh Sts CH - Buy Order Load  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0017  70       BOL Kill Date
     C                     Z-ADD*ZERO     WN0018  40       BOL Pln Delv St
     C                     Z-ADD*ZERO     WN0019  40       BOL Pln Delv En
     C                     Z-ADD*ZERO     WN0020  50       BOL Pln Head De
     C                     Z-ADD*ZERO     WN0021  71       BOL Shipped Wgt
     C                     Z-ADD*ZERO     WN0022  70       BOL Pln Delv Da
     C                     MOVEL*BLANK    WN0023  2        BOL Freight UOM
     C                     Z-ADD*ZERO     WN0024  72       BOL Freight Uni
     C                     Z-ADD*ZERO     WN0025  72       BOL Freight Amt
     C                     MOVEL*BLANK    WN0026  1        BOL Freight All
     C                     Z-ADD*ZERO     WN0027  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0028  71       BOL Live Wgt Re
     C                     MOVEL*BLANK    WN0029  2        BOL Trucker Pay
     C                     Z-ADD*ZERO     WN0030  80       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0031  70       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0032  80       BOL AP Voucher
     C                     MOVEL*BLANK    WN0033 11        BOL Trailer
     C                     MOVEL*BLANK    WN0034  1        BOL Freight Exp
     C                     MOVEL*BLANK    WN0035  1        BOL Scheduled K
     C                     MOVEL*BLANK    WN0036  1        Reported to USD
     C                     MOVEL*BLANK    WN0037  1        BOL MPR Prior D
     C                     MOVEL*BLANK    WN0038  1        BOL Violated Au
     C                     MOVEL*BLANK    WN0039  2        BOL Status 5
     C                     MOVEL*BLANK    WN0040  2        BOL Status 6
     C                     MOVEL*BLANK    WN0041  3        BOL Status 7
     C                     Z-ADD*ZERO     WN0042  70       BOL HPS Movemen
     C                     Z-ADD*ZERO     WN0043  70       BOL Head LFT
     C                     Z-ADD*ZERO     WN0044  70       BOL Head EUT/KO
     C                     Z-ADD*ZERO     WN0045  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN0046  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0047 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0048 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0049 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0050 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0051 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0052  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN0053  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0054  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0055  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0056  70       BOL Unused Date
     C                     MOVEL*BLANK    WN0057  3        TRK Trucker Cod
     C                     MOVEL*BLANK    WN0058  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0059  6        PL Location Cod
     C                     MOVEL*BLANK    WN0060 10        RS User Changed
     C                     Z-ADD*ZERO     WN0061  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0062  60       RS Time Changed
     C                     MOVEL*BLANK    WN0063  1        RS Record Statu
     C                     MOVEL*BLANK    WN0064 10        RS Job
     C                     MOVEL*BLANK    WN0065 10        RS Program
     C                     MOVEL*BLANK    WN0066 10        RS User Added
     C                     Z-ADD*ZERO     WN0067  70       RS Date Added
     C                     Z-ADD*ZERO     WN0068  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @AXCPBY
     C                     Z-ADDWBHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WCBONB           BOL Load Number
      *
     C           KLCHSF    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C           KLCHSF    CHAIN@AXCPBY              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAXCPL1'MDACP
     C                     MOVEL'@AXCPBY' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAX1    YBRDCS
      * Move non-key fields to @AXCPBY
     C                     MOVEL'I'       WCPAST    P      BOL Truck Scale
     C                     Z-ADDWBLDSH    WCLDSH           BOL Shipped Hea
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@AXCPBY                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAXCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Upd Hdr/Bal Status    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHMNB    WQSG01           BOH Company Num
     C           *LIKE     DEFN WDBNNB    WQSG02           BOH Buy Order N
     C           *LIKE     DEFN WDBONB    WQSG03           BOL Load Number
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           BOH Company Num
     C                     KFLD           WQSG02           BOH Buy Order N
     C                     KFLD           WQSG03           BOL Load Number
      * Setup key
     C                     Z-ADDWBHMNB    WQSG01           BOH Company Num
     C                     Z-ADDWBBNNB    WQSG02           BOH Buy Order N
     C                     Z-ADDWBBONB    WQSG03           BOL Load Number
      * Establish starting position
     C           KRSSG     SETLL@A1CPC4                    *
     C           KRSSG     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TH Hog Class Type is Not Resale
     C           WDLLST    IFEQ 'M'                        *IF
     C           WDLLST    OREQ 'S'
      * Chg Hdr/Bal Status    CH - Tattoo Header  * 
     C                     EXSR SHCHRC
     C                     END                             *FI
     C           KRSSG     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCHRC    BEGSR
      *================================================================
      * Chg Hdr/Bal Status    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0069  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0070 10        TH Group Refere
     C                     MOVEL*BLANK    WN0071  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0072  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0073  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0074  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0075  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0076  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0077  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0078  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0079  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0080  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0081  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0082  50       TH Held Over
     C                     Z-ADD*ZERO     WN0083  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0084  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0085  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0086  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0087  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0088  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0089  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0090  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0091  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0092  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0093  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0094  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0095  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0096  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0097  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0098  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0099  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0100  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0101  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0102  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0103  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0104  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0105  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0106  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0107  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0108  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0109  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0110  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0111  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0112  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0113  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0114  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0115  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0116  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0117  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0118  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0119  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0120  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0121  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0122  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0123  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0124  1        TH Detail Error
     C                     MOVEL*BLANK    WN0125  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0126  80       TH Commission A
     C                     Z-ADD*ZERO     WN0127  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0128  1        TH User Error O
     C                     MOVEL*BLANK    WN0129  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0130  1        TH Sex
     C                     Z-ADD*ZERO     WN0131  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0132  70       TH Commission P
     C                     Z-ADD*ZERO     WN0133  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0134  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0135  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0136  31       TH FFLI
     C                     Z-ADD*ZERO     WN0137  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0138  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0139  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0140  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0141  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0142  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0143  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0144  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0145  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0146  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0147  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0148  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0149  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0150  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0151  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0152  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0153  1        TH Source Type
     C                     MOVEL*BLANK    WN0154  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0155  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0156  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0157  3        TH Source Code
     C                     MOVEL*BLANK    WN0158  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0159  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0160  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0161  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0162  3        TH State
     C                     MOVEL*BLANK    WN0163  3        TH Unused Code
     C                     MOVEL*BLANK    WN0164  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0165  1        TH Commission S
     C                     MOVEL*BLANK    WN0166  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0167  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0168  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0169  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0170  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0171  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0172  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0173  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0174  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0175  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0176  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0177  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0178  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0179  3        TH PHA Average
     C                     MOVEL*BLANK    WN0180  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0181  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0182  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0183  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0184  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0185  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0186  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0187  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0188  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0189  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0190  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0191  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0192  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0193 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0194 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0195 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0196 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0197  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0198  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0199  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0200  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0201  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0202  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0203  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0204  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0205  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0206  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0207  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0208  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0209  70       TH Unused Date
     C                     MOVEL*BLANK    WN0210  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0211  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0212  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0213  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0214  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0215  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0216  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0217  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0218  6        DF Defect Code
     C                     MOVEL*BLANK    WN0219  6        THP Process Cod
     C                     MOVEL*BLANK    WN0220  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0221  6        PL Location Cod
     C                     MOVEL*BLANK    WN0222  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0223  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0224  3        HC Class Code
     C                     MOVEL*BLANK    WN0225 10        RS User Changed
     C                     Z-ADD*ZERO     WN0226  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0227  60       RS Time Changed
     C                     MOVEL*BLANK    WN0228  1        RS Record Statu
     C                     MOVEL*BLANK    WN0229 10        RS Job
     C                     MOVEL*BLANK    WN0230 10        RS Program
     C                     MOVEL*BLANK    WN0231 10        RS User Added
     C                     Z-ADD*ZERO     WN0232  70       RS Date Added
     C                     Z-ADD*ZERO     WN0233  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWDHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WEBONB           BOL Load Number
     C                     Z-ADDWDCVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WEB0DT           TH Kill Date
      *
     C           KLCHSH    KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
     C           KLCHSH    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YCRDCS
      * Move non-key fields to @A1CPC5
     C                     MOVEL'E'       WED7ST    P      TH Header Error
     C                     MOVEL'E'       WEDWST    P      TH Kill Balanci
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Upd Trk Scl Weigh Sts RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WBHMNB           BOH Company Num
     C                     KFLD           WBBNNB           BOH Buy Order N
     C                     KFLD           WBBONB           BOL Load Number
      * Setup key
     C                     Z-ADDEJHMNB    WBHMNB           BOH Company Num
     C                     Z-ADDEJBNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADDEJBONB    WBBONB           BOL Load Number
      * Establish starting position
     C           KRSSI     CHAIN@AXCPBX              90    *
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.BOL Truck Scale Weigh Sts is Respread
      *   |- c2    : DB1.BOL Truck Scale Weigh Sts is Not Spread
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           'I'       IFEQ 'R'                        *IF
     C           WBPAST    IFEQ 'I'                        *IF
     C           WBPAST    OREQ 'N'
     C           WBPAST    OREQ *BLANK
     C           WBPAST    OREQ 'O'
     C           WBPAST    OREQ 'R'
     C           WBPAST    OREQ 'A'
     C           WBPAST    OREQ 'C'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Trk Scl Weigh Sts CH - Buy Order Load  * 
     C                     EXSR SJCHRC
     C                     END                             *FI
      * CASE: PAR.BOL Truck Scale Weigh Sts is Respread
     C           'I'       IFEQ 'R'                        *IF
      * Upd Hdr/Bal Status    RT - Tattoo Header  * 
     C                     EXSR SKRVGN
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCHRC    BEGSR
      *================================================================
      * Chg Trk Scl Weigh Sts CH - Buy Order Load  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0234  70       BOL Kill Date
     C                     Z-ADD*ZERO     WN0235  40       BOL Pln Delv St
     C                     Z-ADD*ZERO     WN0236  40       BOL Pln Delv En
     C                     Z-ADD*ZERO     WN0237  50       BOL Pln Head De
     C                     Z-ADD*ZERO     WN0238  71       BOL Shipped Wgt
     C                     Z-ADD*ZERO     WN0239  70       BOL Pln Delv Da
     C                     MOVEL*BLANK    WN0240  2        BOL Freight UOM
     C                     Z-ADD*ZERO     WN0241  72       BOL Freight Uni
     C                     Z-ADD*ZERO     WN0242  72       BOL Freight Amt
     C                     MOVEL*BLANK    WN0243  1        BOL Freight All
     C                     Z-ADD*ZERO     WN0244  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0245  71       BOL Live Wgt Re
     C                     MOVEL*BLANK    WN0246  2        BOL Trucker Pay
     C                     Z-ADD*ZERO     WN0247  80       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0248  70       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0249  80       BOL AP Voucher
     C                     MOVEL*BLANK    WN0250 11        BOL Trailer
     C                     MOVEL*BLANK    WN0251  1        BOL Freight Exp
     C                     MOVEL*BLANK    WN0252  1        BOL Scheduled K
     C                     MOVEL*BLANK    WN0253  1        Reported to USD
     C                     MOVEL*BLANK    WN0254  1        BOL MPR Prior D
     C                     MOVEL*BLANK    WN0255  1        BOL Violated Au
     C                     MOVEL*BLANK    WN0256  2        BOL Status 5
     C                     MOVEL*BLANK    WN0257  2        BOL Status 6
     C                     MOVEL*BLANK    WN0258  3        BOL Status 7
     C                     Z-ADD*ZERO     WN0259  70       BOL HPS Movemen
     C                     Z-ADD*ZERO     WN0260  70       BOL Head LFT
     C                     Z-ADD*ZERO     WN0261  70       BOL Head EUT/KO
     C                     Z-ADD*ZERO     WN0262  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN0263  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0264 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0265 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0266 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0267 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0268 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0269  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN0270  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0271  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0272  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0273  70       BOL Unused Date
     C                     MOVEL*BLANK    WN0274  3        TRK Trucker Cod
     C                     MOVEL*BLANK    WN0275  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0276  6        PL Location Cod
     C                     MOVEL*BLANK    WN0277 10        RS User Changed
     C                     Z-ADD*ZERO     WN0278  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0279  60       RS Time Changed
     C                     MOVEL*BLANK    WN0280  1        RS Record Statu
     C                     MOVEL*BLANK    WN0281 10        RS Job
     C                     MOVEL*BLANK    WN0282 10        RS Program
     C                     MOVEL*BLANK    WN0283 10        RS User Added
     C                     Z-ADD*ZERO     WN0284  70       RS Date Added
     C                     Z-ADD*ZERO     WN0285  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @AXCPBY
     C                     Z-ADDWBHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WCBONB           BOL Load Number
      *
     C           KLCHSJ    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C           KLCHSJ    CHAIN@AXCPBY              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAXCPL1'MDACP
     C                     MOVEL'@AXCPBY' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAX1    YDRDCS
      * Move non-key fields to @AXCPBY
     C                     MOVEL'I'       WCPAST    P      BOL Truck Scale
     C                     Z-ADDWBLDSH    WCLDSH           BOL Shipped Hea
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@AXCPBY                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAXCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Upd Hdr/Bal Status    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHMNB    WQSK01           BOH Company Num
     C           *LIKE     DEFN WDBNNB    WQSK02           BOH Buy Order N
     C           *LIKE     DEFN WDBONB    WQSK03           BOL Load Number
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           BOH Company Num
     C                     KFLD           WQSK02           BOH Buy Order N
     C                     KFLD           WQSK03           BOL Load Number
      * Setup key
     C                     Z-ADDWBHMNB    WQSK01           BOH Company Num
     C                     Z-ADDWBBNNB    WQSK02           BOH Buy Order N
     C                     Z-ADDWBBONB    WQSK03           BOL Load Number
      * Establish starting position
     C           KRSSK     SETLL@A1CPC4                    *
     C           KRSSK     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TH Hog Class Type is Not Resale
     C           WDLLST    IFEQ 'M'                        *IF
     C           WDLLST    OREQ 'S'
      * Chg Hdr/Bal Status    CH - Tattoo Header  * 
     C                     EXSR SLCHRC
     C                     END                             *FI
     C           KRSSK     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * Chg Hdr/Bal Status    CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0286  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0287 10        TH Group Refere
     C                     MOVEL*BLANK    WN0288  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0289  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0290  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0291  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0292  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0293  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0294  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0295  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0296  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0297  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0298  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0299  50       TH Held Over
     C                     Z-ADD*ZERO     WN0300  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0301  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0302  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0303  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0304  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0305  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0306  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0307  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0308  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0309  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0310  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0311  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0312  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0313  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0314  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0315  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0316  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0317  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0318  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0319  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0320  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0321  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0322  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0323  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0324  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0325  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0326  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0327  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0328  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0329  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0330  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0331  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0332  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0333  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0334  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0335  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0336  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0337  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0338  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0339  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0340  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0341  1        TH Detail Error
     C                     MOVEL*BLANK    WN0342  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0343  80       TH Commission A
     C                     Z-ADD*ZERO     WN0344  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0345  1        TH User Error O
     C                     MOVEL*BLANK    WN0346  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0347  1        TH Sex
     C                     Z-ADD*ZERO     WN0348  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0349  70       TH Commission P
     C                     Z-ADD*ZERO     WN0350  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0351  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0352  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0353  31       TH FFLI
     C                     Z-ADD*ZERO     WN0354  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0355  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0356  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0357  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0358  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0359  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0360  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0361  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0362  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0363  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0364  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0365  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0366  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0367  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0368  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0369  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0370  1        TH Source Type
     C                     MOVEL*BLANK    WN0371  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0372  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0373  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0374  3        TH Source Code
     C                     MOVEL*BLANK    WN0375  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0376  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0377  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0378  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0379  3        TH State
     C                     MOVEL*BLANK    WN0380  3        TH Unused Code
     C                     MOVEL*BLANK    WN0381  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0382  1        TH Commission S
     C                     MOVEL*BLANK    WN0383  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0384  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0385  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0386  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0387  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0388  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0389  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0390  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0391  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0392  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0393  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0394  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0395  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0396  3        TH PHA Average
     C                     MOVEL*BLANK    WN0397  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0398  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0399  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0400  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0401  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0402  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0403  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0404  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0405  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0406  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0407  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0408  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0409  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0410 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0411 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0412 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0413 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0414  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0415  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0416  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0417  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0418  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0419  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0420  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0421  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0422  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0423  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0424  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0425  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0426  70       TH Unused Date
     C                     MOVEL*BLANK    WN0427  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0428  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0429  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0430  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0431  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0432  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0433  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0434  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0435  6        DF Defect Code
     C                     MOVEL*BLANK    WN0436  6        THP Process Cod
     C                     MOVEL*BLANK    WN0437  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0438  6        PL Location Cod
     C                     MOVEL*BLANK    WN0439  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0440  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0441  3        HC Class Code
     C                     MOVEL*BLANK    WN0442 10        RS User Changed
     C                     Z-ADD*ZERO     WN0443  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0444  60       RS Time Changed
     C                     MOVEL*BLANK    WN0445  1        RS Record Statu
     C                     MOVEL*BLANK    WN0446 10        RS Job
     C                     MOVEL*BLANK    WN0447 10        RS Program
     C                     MOVEL*BLANK    WN0448 10        RS User Added
     C                     Z-ADD*ZERO     WN0449  70       RS Date Added
     C                     Z-ADD*ZERO     WN0450  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWDHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WEBONB           BOL Load Number
     C                     Z-ADDWDCVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WEB0DT           TH Kill Date
      *
     C           KLCHSL    KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
     C           KLCHSL    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YERDCS
      * Move non-key fields to @A1CPC5
     C                     MOVEL'E'       WED7ST    P      TH Header Error
     C                     MOVEL'E'       WEDWST    P      TH Kill Balanci
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Val Buy Order Load    RT - Buy Order Load Weight  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       P5SWST           BOL IN  record
     C                     MOVEL'N'       P6SXST           BOL OUT record
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFHONB    WQSM01           CC Company Numb
     C           *LIKE     DEFN WFBNNB    WQSM02           BOH Buy Order N
     C           *LIKE     DEFN WFBONB    WQSM03           BOL Load Number
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           CC Company Numb
     C                     KFLD           WQSM02           BOH Buy Order N
     C                     KFLD           WQSM03           BOL Load Number
      * Setup key
     C                     Z-ADD#1HONB    WQSM01           CC Company Numb
     C                     Z-ADD#DSXNB    WQSM02           BOH Buy Order N
     C                     Z-ADD#DXWNB    WQSM03           BOL Load Number
      * Establish starting position
     C           KRSSM     SETLL@EJCPBK                    *
     C           KRSSM     READE@EJCPBK                  90*
      * Data record not found
     C   90                MOVEL'PRK0841' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.BOLW Weight Type is In(En)
     C           WFSRST    IFEQ 'I'                        *IF
     C                     MOVEL'Y'       P5SWST           BOL IN  record
     C                     ELSE
      * CASE: DB1.BOLW Weight Type is Out(Fuera)
     C           WFSRST    IFEQ 'O'                        *IF
     C                     MOVEL'Y'       P6SXST           BOL OUT record
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSM     READE@EJCPBK                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Val Buy Order Load    RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WBHMNB           BOH Company Num
     C                     KFLD           WBBNNB           BOH Buy Order N
     C                     KFLD           WBBONB           BOL Load Number
      * Setup key
     C                     Z-ADD#1HONB    WBHMNB           BOH Company Num
     C                     Z-ADD#DSXNB    WBBNNB           BOH Buy Order N
     C                     Z-ADD#DXWNB    WBBONB           BOL Load Number
      * Establish starting position
     C           KRSSN     CHAIN@AXCPBX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0051' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P4PAST           BOL Truck Scale
     C                     MOVEL*BLANK    P3H7ST           Record Found US
     C                     MOVEL'N'       P3H7ST           Record Found US
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBPAST    P4PAST           BOL Truck Scale
     C                     MOVEL'Y'       P3H7ST           Record Found US
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * H16853 ISE 01/23/21 - Increased the length from 5 to 7 and correc
      *                       alignment of Buy Order Number field.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check reference to Company Control HPE
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1HONB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1HONB' defaulted for 'CC Company Number'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(WRK) WUBSNB' defaulted for 'Next Buy Order Number'.
      * Field '(WRK) WUB1DT' defaulted for 'Current Kill Date'.
      * Field '(WRK) WUB2DT' defaulted for 'Next Kill Date'.
      * Field '(WRK) WUH4NB' defaulted for 'Last Drive Card Number'.
     C                     CALL 'PKLFSRR'              90  Sel Company Con
     C                     PARM *BLANK    W0RTN   7
     C           #1HONB    PARM #1HONB    WQ0010  30       CC Company Numb
     C           WUBSNB    PARM *ZERO     WQ0011  70       Next Buy Order
     C           WUB1DT    PARM *ZERO     WQ0012  70       Current Kill Da
     C           WUB2DT    PARM *ZERO     WQ0013  70       Next Kill Date
     C           WUH4NB    PARM *ZERO     WQ0014  30       Last Drive Card
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKLFSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1HONB    IFNE *ZERO                      CC Company Numb
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VAEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1HONB    IFEQ *ZERO                      CC Company Numb
     C                     GOTO VAEXIT
     C                     END
      *
     C           KLVAWG    KLIST
     C                     KFLD           WGHONB           CC Company Numb
      * Setup key
     C                     Z-ADD#1HONB    WGHONB
     C           KLVAWG    CHAIN@AZCPCN              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
      * Send message 'Company Control HPE    NF'
     C                     MOVEL'PRK0055' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0055' W0RTN
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Producer Location
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1ABCD    WK1X01  1
     C                     MOVEL#1AECD    WK1X02  1
     C           WK1X01    IFEQ '?'                        PD Producer Cod
     C           YPMTFD    OREQ '#1ABCD'
     C           WK1X02    OREQ '?'                        PL Location Cod
     C           YPMTFD    OREQ '#1AECD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ABCD' defaulted for 'PD Producer Code'.
      * Field '(DTL) #1AECD' defaulted for 'PL Location Code'.
     C                     CALL 'PWF5SRR'              90  Sel Prod Loc by
     C                     PARM *BLANK    W0RTN   7
     C           #1ABCD    PARM #1ABCD    WQ0015  6        PD Producer Cod
     C           #1AECD    PARM #1AECD    WQ0016  6        PL Location Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWF5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1ABCD    IFNE *BLANK                     PD Producer Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1AECD    IFNE *BLANK                     PL Location Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ABCD    IFEQ *BLANK                     PD Producer Cod
     C           #1AECD    ANDEQ*BLANK                     PL Location Cod
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBWH    KLIST
     C                     KFLD           WHABCD           PD Producer Cod
     C                     KFLD           WHAECD           PL Location Cod
      * Setup key
     C                     MOVEL#1ABCD    WHABCD
     C                     MOVEL#1AECD    WHAECD
     C           KLVBWH    CHAIN@AFREAR              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Producer Location      NF'
     C                     MOVEL'PRK0015' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0015' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Buy Order Load
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1HMNB'
     C           YPMTFD    OREQ '#1BNNB'
     C           YPMTFD    OREQ '#1BONB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1HMNB' defaulted for 'BOH Company Number'.
      * Field '(DTL) #1BNNB' defaulted for 'BOH Buy Order Number'.
      * Field '(DTL) #1BONB' defaulted for 'BOL Load Number'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ABCD' defaulted for 'PD Producer Code'.
      * Field '(DTL) #1AECD' defaulted for 'PL Location Code'.
     C                     CALL 'PKQJSRR'              90  Sel Producer BO
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0017  30       BOH Company Num
     C           #1BNNB    PARM #1BNNB    WQ0018  70       BOH Buy Order N
     C           #1BONB    PARM #1BONB    WQ0019  50       BOL Load Number
     C                     PARM #1ABCD    WQ0020  6        PD Producer Cod
     C                     PARM #1AECD    WQ0021  6        PL Location Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKQJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1HMNB    IFNE *ZERO                      BOH Company Num
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BNNB    IFNE *ZERO                      BOH Buy Order N
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BONB    IFNE *ZERO                      BOL Load Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1HMNB    IFEQ *ZERO                      BOH Company Num
     C           #1BNNB    ANDEQ*ZERO                      BOH Buy Order N
     C           #1BONB    ANDEQ*ZERO                      BOL Load Number
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCWB    KLIST
     C                     KFLD           WBHMNB           BOH Company Num
     C                     KFLD           WBBNNB           BOH Buy Order N
     C                     KFLD           WBBONB           BOL Load Number
      * Setup key
     C                     Z-ADD#1HMNB    WBHMNB
     C                     Z-ADD#1BNNB    WBBNNB
     C                     Z-ADD#1BONB    WBBONB
     C           KLVCWB    CHAIN@AXCPBX              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Buy Order Load         NF'
     C                     MOVEL'PRK0051' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0051' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         YKDDW1    BEGSR
      *================================================================
      * Calculate window location for drop down lists on screen 1
      *================================================================
      *
      * Calculate window location for DDL - Weight Type USR
      * Window width
     C                     Z-ADD15        YWWDWD
      * Window depth
     C                     Z-ADD2         YWWDDP
      * Window reference corner
     C                     MOVEL'*TL  '   YWWDCR
      * Window start row
     C                     Z-ADD##WSR     YWWDRW
     C                     ADD  12        YWWDRW
      * Window start column
     C                     Z-ADD##WSC     YWWDCL
     C                     ADD  23        YWWDCL
      * Retrieve window location
     C                     EXSR ZURTLC
      * Window start row
     C                     Z-ADDYWWDRW    ZG01RW
      * Window start column
     C                     Z-ADDYWWDCL    ZG01CL
      *================================================================
     CSR         YKEXT1    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ##WSR     MULT 256       ZWORK   50
     C                     ADD  ##WSC     ZWORK
     C                     SUB  ZWORK     ZINPOS
     C                     SUB  1         ZINPOS
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C           @#WWRC    DIV  256       ZZCSRW  30       Row
     C                     MVR            ZZCSCL  30       Column
      *
      *
      * Calculate window offset
     C           012       ADD  ##WSR     YWPORW  30
     C           022       ADD  ##WSC     YWPOC1  30
     C                     ADD  1         YWPOC1
     C           ZHCSRW    IFEQ YWPORW
     C           ZHCSCL    ANDEQYWPOC1
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DSZST'  YPMTFD           Weight Type USR
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C           @#WWRC    DIV  256       ZZCSRW  30       Row
     C                     MVR            ZZCSCL  30       Column
      *
     C           ZHCSRW    SUB  ##WSR     YWPORW  30
     C           ZHCSCL    SUB  ##WSC     YWPOC1  30
     C                     SUB  1         YWPOC1
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM YWPORW    YYRW    50       Row
     C                     PARM YWPOC1    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZRRPWD    BEGSR
      *================================================================
      * *Reposition window
      *================================================================
     C                     MOVEL'Y'       YSL,1            Set wdw locatio
     C                     MOVEL'R'       YWLCTP  1        Locate action t
     C                     EXSR ZSSTLC                     Set window loca
      *
      * Redisplay previous panel
     C                     WRITEASSUME
      *================================================================
     CSR         ZREXIT    ENDSR
      /EJECT
     CSR         ZSSTLC    BEGSR
      *================================================================
      * Set window location
      *================================================================
     C           YSL,1     IFEQ 'Y'                        Set wdw locatio
     C                     MOVEL'*CALC'   YWWDCR           Window referenc
     C                     Z-ADD-3        YWWDRW           Window start ro
     C                     Z-ADD-3        YWWDCL           Window start co
     C                     Z-ADD062       YWWDWD           Window width
     C                     Z-ADD018       YWWDDP           Window depth
     C                     MOVEL'N'       YSL,1            Set wdw locatio
      *
     C                     EXSR ZURTLC                     Retrieve window
     C                     EXSR ZTWDFD                     Move window fie
     C                     END
      *================================================================
     CSR         ZSEXIT    ENDSR
      /EJECT
     CSR         ZTWDFD    BEGSR
      *================================================================
      * Move window fields by panel
      *================================================================
     C                     Z-ADDYWWDRW    ##WSR            Window start ro
     C                     Z-ADDYWWDCL    ##WSC            Window start co
     C                     EXSR YKDDW1
      *================================================================
     CSR         ZTEXIT    ENDSR
      /EJECT
     CSR         ZURTLC    BEGSR
      *================================================================
      * Retrieve window location
      *================================================================
      *
      * Set up parameters to API
      *
      * Return code
     C                     MOVEL*BLANKS   W0RTN
      * Retrieval Function
     C                     MOVEL*BLANKS   YWRTFN
     C                     MOVEL'*WDWLOC' YWRTFN
      *
     C                     SETOF                       90  *
      *
     C                     CALL 'YWRTLCI'              90  *
     C                     PARM           YWRTFN 10        Retrieval Funct
     C                     PARM           YWWDWD  30       Window width
     C                     PARM           YWWDDP  30       Window depth
     C                     PARM           YWWDCR  5        Window referenc
     C                     PARM           YWWDRW  30       *Window start r
     C                     PARM           YWWDCL  30       *Window start c
     C                     PARM           W0RTN            Return code
      * If error on call to API - default window location to top left cor
     C           *IN90     IFEQ '1'
     C           W0RTN     ORNE *BLANKS
     C                     Z-ADD2         YWWDRW           *Window start r
     C                     Z-ADD2         YWWDCL           *Window start c
     C                     END
      *
      *================================================================
     CSR         ZUEXIT    ENDSR
      /EJECT
     CSR         ZVCFPM    BEGSR
      *================================================================
      * Set Confirm Prompt window location
      *================================================================
      *
     C           ##WSR     ADD  018       YWWDRW
     C           ##WSC     ADD  062       YWWDCL
      *
     C                     ADD  1         YWWDCL
     C                     SUB  1         YWWDRW           Window start ro
     C                     SUB  21        YWWDCL           Window start co
     C                     Z-ADD18        YWWDWD           Window width
     C                     Z-ADD2         YWWDDP           Window depth
     C                     MOVEL'*TL  '   YWWDCR           Window referenc
     C                     MOVEL*BLANKS   YWRTFN
     C                     MOVEL'*WDWLOC' YWRTFN           Retrieval Funct
     C                     EXSR ZURTLC                     Retrieve window
     C                     Z-ADDYWWDRW    ##WSRC           *Window start r
     C                     Z-ADDYWWDCL    ##WSCC           *Window start c
      *
      *================================================================
     CSR         ZVEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2J8NB           Oms Warehouse C
     C                     MOVEL*BLANK    P2C7CD           Oms Application
     C                     MOVEL*BLANK    P2C8CD           Oms SalesPerson
     C                     MOVEL*BLANK    P2G8ST           Oms Allow Multi
     C                     MOVEL*BLANK    P2G9ST           Oms Default Pri
     C                     MOVEL*BLANK    P2EUTX           Oms Name
     C                     MOVEL*BLANK    P2EVTX           Oms System Valu
     C                     MOVEL*BLANK    P2HAST           Oms Access Deni
     C                     MOVEL*BLANK    P3H7ST           Record Found US
     C                     MOVEL*BLANK    P4PAST           BOL Truck Scale
     C                     MOVEL*BLANK    P5SWST           BOL IN  record
     C                     MOVEL*BLANK    P6SXST           BOL OUT record
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialise Allow Set Window Location flags
     C                     MOVEA*ALL'Y'   YSL
      * Set display size
     C                     SETOF                         93*
     C           @#SCRW    COMP 27                       93*
      * Initialise window location variables.
     C                     Z-ADD*ZEROS    ##WSR
     C                     Z-ADD*ZEROS    ##WSC
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHONB           CC Company Numb
     C                     Z-ADD*ZERO     WABOMV           BOLW Movement N
     C                     Z-ADD*ZERO     WABOSW           BOLW Scale Weig
     C                     Z-ADD*ZERO     WADQDT           BOLW Scale Weig
     C                     Z-ADD*ZERO     WAA2TM           BOLW Scale Weig
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBBONB           BOL Load Number
     C                     Z-ADD*ZERO     WBCQDT           BOL Kill Date
     C                     Z-ADD*ZERO     WBABTH           BOL Pln Delv St
     C                     Z-ADD*ZERO     WBACTH           BOL Pln Delv En
     C                     Z-ADD*ZERO     WBBPNB           BOL Pln Head De
     C                     Z-ADD*ZERO     WBCSNB           BOL Shipped Wgt
     C                     Z-ADD*ZERO     WBAUDT           BOL Pln Delv Da
     C                     Z-ADD*ZERO     WBAGPR           BOL Freight Uni
     C                     Z-ADD*ZERO     WBATVA           BOL Freight Amt
     C                     Z-ADD*ZERO     WBDHNB           BOL Head Receiv
     C                     Z-ADD*ZERO     WBDINB           BOL Live Wgt Re
     C                     Z-ADD*ZERO     WBGINB           BOL Trucker Che
     C                     Z-ADD*ZERO     WBBZDT           BOL Trucker Che
     C                     Z-ADD*ZERO     WBLSNB           BOL AP Voucher
     C                     Z-ADD*ZERO     WBLDSH           BOL Shipped Hea
     C                     Z-ADD*ZERO     WBJKRU           BOL HPS Movemen
     C                     Z-ADD*ZERO     WBKEOR           BOL Head LFT
     C                     Z-ADD*ZERO     WBIOEW           BOL Head EUT/KO
     C                     Z-ADD*ZERO     WBKJIO           BOL Auth Gate E
     C                     Z-ADD*ZERO     WBIOJR           BOL Head Receiv
     C                     Z-ADD*ZERO     WBEIRR           BOL Unused Wgt
     C                     Z-ADD*ZERO     WBITMF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WBODJE           BOL Unused Wgt
     C                     Z-ADD*ZERO     WBRJIF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WBOEJF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WBD0DT           BOL Auth Gate E
     C                     Z-ADD*ZERO     WBD1DT           BOL Unused Date
     C                     Z-ADD*ZERO     WBD2DT           BOL Unused Date
     C                     Z-ADD*ZERO     WBD3DT           BOL Unused Date
     C                     Z-ADD*ZERO     WBD4DT           BOL Unused Date
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WDBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WDBONB           BOL Load Number
     C                     Z-ADD*ZERO     WDCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WDB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WDAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WDACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WDB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WDCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WDAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WDA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WDCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WDCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WDFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WDH9NB           TH Held Over
     C                     Z-ADD*ZERO     WDFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WDFENB           TH Head Killed
     C                     Z-ADD*ZERO     WDHENB           TH Head Adds
     C                     Z-ADD*ZERO     WDHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WDCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WDLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WDE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WDA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WDFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WDA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WDF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WDHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WDF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WDF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WDF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WDF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WDAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WDAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WDCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WDA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WDA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WDB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WDAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WDANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WDAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WDAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WDAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WDAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WDAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WDASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WDA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WDATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WDA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WDCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WDCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WDLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WDCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WDA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WDA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WDGHNB           TH Commission A
     C                     Z-ADD*ZERO     WDBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WDBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WDBTDT           TH Commission P
     C                     Z-ADD*ZERO     WDBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WDHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WDHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WDHINB           TH FFLI
     C                     Z-ADD*ZERO     WDA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WDA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WDA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WDJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WDD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WDD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WDD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WDD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WDEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WDEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WDECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WDEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WDEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WDEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WDEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WDEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WDOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WDTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WDT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WDTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WDT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WDOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WDKOER           TH Head Identif
     C                     Z-ADD*ZERO     WDOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WDOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WDIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WDOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WDHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WDS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WDTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WDTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WDJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WDKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WDKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WDKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WDKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WDOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WDIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WDIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WDIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WDKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WDOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WDKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WDORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WDOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WDMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WDMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WDNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WDNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WDIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WDKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WDEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WDEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WDECDT           TH Head LFT
     C                     Z-ADD*ZERO     WDEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WDEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Define work field Return Code USR
     C                     MOVEL*BLANK    WULMST  7
      * Define work field Scheduled Kill Dt 8.0 USR
     C                     Z-ADD*ZERO     WUSHDT  80
      * Define work field *Return code
     C                     MOVEL*BLANK    WURTN   7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGHONB           CC Company Numb
     C                     Z-ADD*ZERO     WGBSNB           Next Buy Order
     C                     Z-ADD*ZERO     WGB1DT           Current Kill Da
     C                     Z-ADD*ZERO     WGB2DT           Next Kill Date
     C                     Z-ADD*ZERO     WGH4NB           Last Drive Card
     C                     Z-ADD*ZERO     WGK3NB           Last Tattoo Nbr
     C                     Z-ADD*ZERO     WGCDDT           Current Product
     C                     Z-ADD*ZERO     WGCEDT           Next Production
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
      * Define work field Next Buy Order Number
     C                     Z-ADD*ZERO     WUBSNB  70
      * Define work field Current Kill Date
     C                     Z-ADD*ZERO     WUB1DT  70
      * Define work field Next Kill Date
     C                     Z-ADD*ZERO     WUB2DT  70
      * Define work field Last Drive Card Number
     C                     Z-ADD*ZERO     WUH4NB  30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHGLNB           Pl VND Address
     C                     Z-ADD*ZERO     WHASNB           PL Miles/Unused
     C                     Z-ADD*ZERO     WHHWNB           PL Primary Comp
     C                     Z-ADD*ZERO     WHAADT           RS Date Changed
     C                     Z-ADD*ZERO     WHAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WHABDT           RS Date Added
     C                     Z-ADD*ZERO     WHABTM           RS Time Added
      * Define work field CC Company Number
     C                     Z-ADD*ZERO     WUHONB  30
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'Y'       W0PMT   1
      * Define local work field Scheduled Head USR
     C                     Z-ADD*ZERO     YL0001  50
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * Val Appl/User Only    IF
      * Val Application/User  XF - STR Order Management Sys  * 
     C                     CALL 'PDGXXFR'              90  Val Application
     C                     PARM *BLANK    W0RTN   7
     C           P2J8NB    PARM *BLANK    WQ0022  3        Oms Warehouse C
     C           WUHONB    PARM *ZERO     WQ0023  30       CC Company Numb
     C                     PARM 'HPE'     WQ0024  6        Oms Application
     C           P2C8CD    PARM *BLANK    WQ0025  3        Oms SalesPerson
     C           P2G8ST    PARM *BLANK    WQ0026  1        Oms Allow Multi
     C           P2G9ST    PARM *BLANK    WQ0027 10        Oms Default Pri
     C           P2EUTX    PARM *BLANK    WQ0028 30        Oms Name
     C           P2EVTX    PARM *BLANK    WQ0029 40        Oms System Valu
     C           P2HAST    PARM *BLANK    WQ0030  1        Oms Access Deni
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.Oms Access Denied (Y/N) is Yes
     C           P2HAST    IFEQ 'Y'                        *IF
      * Send message 'Access Denied for User'
     C                     MOVEL'PRK0298' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
** W0BEG
01302013310155801589018140184302070
020990283803094031030335003606
** W0END
01304013360156601594018140185002076
021030284603094031220335603610
** W0NAM
#1HONB    #1ABCD    #1BOMV    #1AECD    #1SRST    #1BOSW    #1BNNB
#1BONB    #DCCNZ    #DSZST    #DC4TX    #DSXNB    #DXWNB
