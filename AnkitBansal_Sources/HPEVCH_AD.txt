// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for HPEVCH
// ?Date: 14.08.2025 Time: 02:43:41
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?Modification history
DO;

//? 3/20/2020 RMC P16169 - JDE World to JDE E1
//?     Project SDN465     Function created.  Use Company Values to
//?                        determine whether to call JDE World or JDE
//?                        Enterprise 1 programs.
//?   if INTCO is Yes, then check the E1Live for company 350
//?   and call hpevchw or -e1 for it. only process intercos on this call.
//?     Change par.return code to pgm.*return code  - remove from parm list
ENDDO;

// LCL.OMS Company Number = CVTVAR(PAR.OMS Company Number Alpha)
LCL.OMS_Company_Number = CVTVAR(PAR.OMS_Company_Number_Alpha);

//?Retrieve "Run In environment" value based on Company value
EXECUTE FUNCTION(Rtv Live In/Parallel  IF) TYPE(EXCINTFUN)                      AA1102412;
PARAMETER(LCL.OMS_Company_Number);
PARAMETER(LCL.E1_Live);
PARAMETER(LCL.JW_Live);
PARAMETER(LCL.M3_Live);
PARAMETER(LCL.E1_Parallel);
PARAMETER(LCL.JW_Parallel);
PARAMETER(LCL.M3_Parallel);
{
 //?Execute internal function

 //?Retrieve E1 Live value
 // Call program Rtv OMS Co Value Alpha XF.
 CALL PROGRAM(Rtv OMS Co Value Alpha XF) ('POMTXFR');
 PARAMETER(PAR.OMS_Company_Number);
 PARAMETER('E1LIVE');
 PARAMETER(LCL.OMS_System_Value_Alpha);

 // PAR.E1 Live = LCL.OMS System Value Alpha
 PAR.E1_Live = LCL.OMS_System_Value_Alpha;

 //?Retrieve JW Live value
 // Call program Rtv OMS Co Value Alpha XF.
 CALL PROGRAM(Rtv OMS Co Value Alpha XF) ('POMTXFR');
 PARAMETER(PAR.OMS_Company_Number);
 PARAMETER('JWLIVE');
 PARAMETER(LCL.OMS_System_Value_Alpha);

 // PAR.JW Live = LCL.OMS System Value Alpha
 PAR.JW_Live = LCL.OMS_System_Value_Alpha;

 //?Retrieve M3 Live value
 // Call program Rtv OMS Co Value Alpha XF.
 CALL PROGRAM(Rtv OMS Co Value Alpha XF) ('POMTXFR');
 PARAMETER(PAR.OMS_Company_Number);
 PARAMETER('M3LIVE');
 PARAMETER(LCL.OMS_System_Value_Alpha);

 // PAR.M3 Live = LCL.OMS System Value Alpha
 PAR.M3_Live = LCL.OMS_System_Value_Alpha;

}


// LCL.E1 Live - InterCo = CND.Not Applicable
LCL.E1_Live_InterCo = *BLANK;

CASE;

// IF LCL.E1 Live is Yes or Parallel
IF LCL.E1_Live = 'P'/'Y';

// Call program Crt HPE IntrCo/Vch E1 UP.
CALL PROGRAM(Crt HPE IntrCo/Vch E1 UP) ('HPEVCHE1');
PARAMETER(PAR.Return_Code);
PARAMETER(PAR.OMS_Company_Number_Alpha);
PARAMETER(PAR.Batch_Alpha_5);
PARAMETER(PAR.Error_Flag);
PARAMETER(PAR.Internal_Co_Sales_USR);

ENDIF;

CASE;

// IF LCL.JW Live is Yes or Parallel
IF LCL.JW_Live = 'P'/'Y';

// Call program Crt HPE IntrCo/Vch W  UP.
CALL PROGRAM(Crt HPE IntrCo/Vch W  UP) ('HPEVCHW');
PARAMETER(PAR.Return_Code);
PARAMETER(PAR.OMS_Company_Number_Alpha);
PARAMETER(PAR.Batch_Alpha_5);
PARAMETER(PAR.Error_Flag);
PARAMETER(PAR.Internal_Co_Sales_USR);

ENDIF;

//?Retrieve E1 Live value for Inter Co G/L entries for Guymon only
//?Co 350 INTCO Journal Entries--- will be live with E1 when nothing else is
CASE;

// IF LCL.OMS Company Number is Guymon
IF LCL.OMS_Company_Number = 360;

// AND PAR.Internal Co Sales USR is Yes
AND PAR.Internal_Co_Sales_USR = 'Y';

// Call program Rtv OMS Co Value Alpha XF.
CALL PROGRAM(Rtv OMS Co Value Alpha XF) ('POMTXFR');
PARAMETER(350);
PARAMETER('E1LIVE');
PARAMETER(LCL.E1_Live_InterCo);

// Call program Rtv OMS Co Value Alpha XF.
CALL PROGRAM(Rtv OMS Co Value Alpha XF) ('POMTXFR');
PARAMETER(350);
PARAMETER('JWLIVE');
PARAMETER(LCL.JW_Live);

//?E1 live parallel| yes  --> Call E1
CASE;

// IF LCL.E1 Live - InterCo is Parallel
IF LCL.E1_Live_InterCo = 'P';

// OR LCL.E1 Live - InterCo is Yes
OR LCL.E1_Live_InterCo = 'Y';

// Call program Crt HPE IntrCo/Vch E1 UP.
CALL PROGRAM(Crt HPE IntrCo/Vch E1 UP) ('HPEVCHE1');
PARAMETER(PAR.Return_Code);
PARAMETER(PAR.OMS_Company_Number_Alpha);
PARAMETER(PAR.Batch_Alpha_5);
PARAMETER(PAR.Error_Flag);
PARAMETER(PAR.Internal_Co_Sales_USR);

ENDIF;

//?E1 Live - parallel|no --> call World
CASE;

// IF LCL.E1 Live - InterCo is No
IF LCL.E1_Live_InterCo = 'N';

// OR LCL.E1 Live - InterCo is Parallel
OR LCL.E1_Live_InterCo = 'P';

// OR LCL.JW Live is Parallel
OR LCL.JW_Live = 'P';

// Call program Crt HPE IntrCo/Vch W  UP.
CALL PROGRAM(Crt HPE IntrCo/Vch W  UP) ('HPEVCHW');
PARAMETER(PAR.Return_Code);
PARAMETER(PAR.OMS_Company_Number_Alpha);
PARAMETER(PAR.Batch_Alpha_5);
PARAMETER(PAR.Error_Flag);
PARAMETER(PAR.Internal_Co_Sales_USR);

ENDIF;

ENDIF;

PGM.*Return_code = PAR.Return_Code;

RETURN;

