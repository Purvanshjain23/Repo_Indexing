PGM  (&V1 &V2 &V3)
DCL &V1 *CHAR 10
DCL &V2 *CHAR 10
DCL &V3 *CHAR 2
DCLF SEQUEL_OLD
MONMSG (CPF6801 CPF9810 CPD0032)
MONMSG (CPF0000 QRY0000) EXEC(GOTO START)
CHGVAR &V3 X'FFFE'
CHGVAR &WRKLIB '*LIBL'
CHGVAR &PGMQ 'SEQUEL'
START:
       SNDF RCDFMT(SEQUELMC)
       RCVMSG MSGTYPE(*LAST) RMV(*YES)
       SNDRCVF RCDFMT(SEQUEL01)
       IF &IN01 THEN(GOTO END)
          IF (&OPTION¬=1 & &OPTION¬=2 & &OPTION¬=3 & &OPTION¬=4 & +
              &OPTION¬=5 & &OPTION¬=6 & &OPTION¬=90) THEN(DO)
             SNDPGMMSG  MSGID(CPF9898) MSGF(QCPFMSG) MSGDTA('Option +
                          invalid. Valid options are 1, 2, 3, 4, 5, 6 +
                          and 90') TOPGMQ(*SAME) MSGTYPE(*ESCAPE)
             GOTO  START
             ENDDO
       IF (&OPTION=90) THEN(SIGNOFF)
          IF (&WRKLIB = ' ') CHGVAR &WRKLIB '*LIBL'
       IF (&OPTION >= 1 *AND &OPTION <= 5) THEN(DO)
          IF (&WRKLIB ¬= '*LIBL' *AND &WRKLIB ¬= QTEMP) THEN(DO)
             CHKOBJ QSYS/&WRKLIB *LIB
             MONMSG CPF0000 EXEC(DO)
                    CHGVAR &IN60 '1'
                    GOTO START
                    ENDDO
             ENDDO
          IF (&OPTION=1) THEN(DO)
             IF (&IN04) THEN(DO)
               ?DSNVIEW  ??VIEW(&WRKLIB/*CREATE)
               ENDDO
             ELSE (DSNVIEW &WRKLIB/*CREATE)
             ENDDO
          IF (&OPTION=2) THEN(DO)
             IF (&IN04) THEN(DO)
               ?WRKVIEW ??VIEW(&WRKLIB/*ALL)
               ENDDO
             ELSE  (WRKVIEW &WRKLIB/*ALL)
             ENDDO
          IF (&OPTION=3) THEN(DO)
             IF (&IN04) THEN(DO)
               ?WRKREPORT ??REPORT(&WRKLIB/*ALL)
               ENDDO
             ELSE  (WRKREPORT &WRKLIB/*ALL)
             ENDDO
          ENDDO
          IF (&OPTION=4) THEN(DO)
             IF (&IN04) THEN(DO)
               ?WRKSCRIPT ??SCRIPT(&WRKLIB/*ALL)
               ENDDO
             ELSE  (WRKSCRIPT &WRKLIB/*ALL)
             ENDDO
          IF (&OPTION=5) THEN(DO)
             IF (&IN04) THEN(DO)
               ?WRKSEQUEL ??OBJ(&WRKLIB/*ALL)
               ENDDO
             ELSE  (WRKSEQUEL &WRKLIB/*ALL)
             ENDDO
          ELSE (IF (&OPTION=6) THEN(SETDFT))
          CHGVAR &OPTION 0
          GOTO START
END: ENDPGM
