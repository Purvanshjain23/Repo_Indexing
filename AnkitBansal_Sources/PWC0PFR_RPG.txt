     H/TITLE Upd Push TO Errors    PF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Print file
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 02/02/21  Time  : 13:06:09
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKAAREL0IF  E           K        DISK
      * RTV : Source                    Retrieval index
      *
     FPKBLCPL4IF  E           K        DISK
      * RSQ : Hog Voucher Detail       Co/BOL/Ttt/KillDt/PSts<>Y
      *
     FPWADCPL2IF  E           K        DISK
      * RSQ : Producer Location From/TO To Prod/Loc/From Prod/Lo
      *
     FPKAWCPL1IF  E           K        DISK
      * RTV : Buy Order Header          Retrieval index
      *
     FPKAQCPL9IF  E           K        DISK
      * RSQ : Producer Sub-Contract     Producer Loc/Dte/Cont/Su
      *
     FPKDNCPL1IF  E           K        DISK
      * RTV : Tattoo Header EXT         Retrieval index
      *
     FPLATREL1IF  E           K        DISK
      * RTV : Producer Site             Retrieval index
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPWC0PFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Upd Push TO Errors    PF  Print file
      *
      * Long constants
     E                    @CN#    1  10  6   @CN    25
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Hog Voucher Detail
      * N :  VCD Source Code
     I                                        1   3 P1OTCD
      * I : RST BOH Company Number
     I                                    P   4   50P1HMNB
     IP2PARM      DS
      * I :  Push To Company
     I                                    P   1   20P2Y9A1
     IP3PARM      DS
      * O :  Continue Process USR
     I                                        1   1 P3VQST
     IP4PARM      DS
      * B :  @Count
     I                                    P   1   30P4YTNB
     IP5PARM      DS
      * I :  Push Type
     I                                        1   1 P5KTSS
     IP6PARM      DS
      * N :  Record Cnt usr
     I                                    P   1   30P6TWA1
     IP7PARM      DS
      * N :  SR Type
     I                                        1   1 P7IXST
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HMNB    PARM           WP0001  30       BOH Company Num
     C           P2Y9A1    PARM           WP0002  30       Push To Company
     C           P3VQST    PARM P3VQST    WP0003  1        Continue Proces
     C           P4YTNB    PARM P4YTNB    WP0004  50       @Count
     C           P5KTSS    PARM           WP0005  1        Push Type
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Upd Push TO Errors    PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$EENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Upd Push TO Errors    PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN BLHMNB    WQKA01           BOH Company Num
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           BOH Company Num
      * Setup key
     C                     Z-ADDP1HMNB    WQKA01           BOH Company Num
      * Establish starting position
     C           KRSA      SETLL@BLCPXY                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        BOH Company Num
     C                     MOVEL'Y'       W0AL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0AL02  1        BOL Load Number
     C                     MOVEL'Y'       W0AL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0AL04  1        TH Kill Date
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $DYTNB           @Count
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP03  1
     C                     END
      *
     C           W0AL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP04  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDBLHNNB    $CHNNB           VCH Company num
     C                     Z-ADDBLLWNB    $CLWNB           VCH Batch Numbe
     C                     Z-ADDBLG9NB    $CG9NB           VCH Header Numb
     C                     Z-ADDBLDLNB    $CDLNB           VCD Line
     C                     MOVELBLOTCD    $COTCD           VCD Source Code
     C                     MOVEL*BLANK    $CIXST           SR Type
     C                     MOVELBLJPST    $CJPST           VCD BO Type
     C                     MOVELBLJQST    $CJQST           VCD Push Paymen
     C                     Z-ADDBLHMNB    $CHMNB           BOH Company Num
     C                     Z-ADDBLBNNB    $CBNNB           BOH Buy Order N
     C                     Z-ADDBLBONB    $CBONB           BOL Load Number
     C                     Z-ADDBLCVNB    $CCVNB           TH Tattoo Numbe
     C                     Z-ADDBLB0DT    $CB0DT           TH Kill Date
     C                     MOVEL*BLANK    $CSDCD           Producer From
     C                     MOVEL*BLANK    $CSECD           Producer Locati
     C                     MOVEL*BLANK    $CSOCD           Contract Code -
     C                     MOVEL*BLANK    $CSQCD           Sub-Contract  -
     C                     MOVEL*BLANK    $CNYCD           PS Site ID
     C                     MOVEL*BLANK    $CBECD           HC Class Code
     C                     MOVEL*BLANK    $CDWST           TH Kill Balanci
     C                     Z-ADD*ZERO     $CARDT           BOH Buy Order D
     C                     MOVEL*BLANK    $CSFCD           Producer To
     C                     MOVEL*BLANK    $CSGCD           Producer Locati
     C                     MOVEL*BLANK    $CSPCD           Contract Code -
     C                     MOVEL*BLANK    $CSSCD           Sub-Contract  -
     C                     MOVELBLABCD    $CABCD           PD Producer Cod
     C                     MOVELBLAECD    $CAECD           PL Location Cod
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN BLHMNB    WZA001           BOH Company Num
     C                     Z-ADDBLHMNB    WZA001
     C           *LIKE     DEFN BLBNNB    WZA002           BOH Buy Order N
     C                     Z-ADDBLBNNB    WZA002
     C           *LIKE     DEFN BLBONB    WZA003           BOL Load Number
     C                     Z-ADDBLBONB    WZA003
     C           *LIKE     DEFN BLCVNB    WZA004           TH Tattoo Numbe
     C                     Z-ADDBLCVNB    WZA004
     C           *LIKE     DEFN BLB0DT    WZA005           TH Kill Date
     C                     Z-ADDBLB0DT    WZA005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@BLCPXY                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * Default Record Selected flag to *NO. It may change to *YES later.
     C                     MOVEL'N'       W0RSL            *Record selecte
      * Only check Triumph Owned records
      * CASE: DB1.VCD Source Code is Triumph Owned
     C           BLOTCD    IFEQ 'TO'                       *IF
      * Check Push Type and Repayment Flag
      * CASE: Push Type = Manual AND Repayment Flag <> Repayment
      *  - c1 AND NOTc2
      *   |- c1    : PAR.Push Type is Manual
      *   |- c2    : DB1.VCD Repayment Flag is Repayment
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5KTSS    IFEQ 'M'                        *IF
     C           BLC4SS    IFEQ 'R'                        *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: Push Type = Auto AND Repayment Flag = Repayment
      *  - c1 AND c2
      *   |- c1    : PAR.Push Type is Automatic
      *   |- c2    : DB1.VCD Repayment Flag is Repayment
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5KTSS    IFEQ 'A'                        *IF
     C           BLC4SS    IFEQ 'R'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Check Producer and Producer Location values are not blank
      * CASE: If Producer AND Location Code values are not blank
      *  - c1 AND c2
      *   |- c1    : DB1.PD Producer Code is Entered
      *   |- c2    : DB1.PL Location Code is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           BLABCD    IFNE *BLANK                     *IF
     C           BLAECD    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Validate Buy Order#, Producer/Location, and Contract values
      * CASE: Buy Order# OR Producer/Location values change
      *  - c1 OR c2 OR c3
      *   |- c1    : DB1.BOH Buy Order Number NE LCL.BOH Buy Order Number
      *   |- c2    : DB1.PD Producer Code NE LCL.Producer Code         US
      *   |- c3    : DB1.PL Location Code NE LCL.Location Code USR
      *   '-
     C           BLBNNB    IFNE YL0040                     *IF
     C           BLABCD    ORNE YL0041                     *OR
     C           BLAECD    ORNE YL0042                     *OR
     C                     MOVEL'N'       YL0043           @Status Detail
      * Save current values to check for next change
     C                     Z-ADDBLBNNB    YL0040           BOH Buy Order N
     C                     MOVELBLABCD    YL0041           Producer Code
     C                     MOVELBLAECD    YL0042           Location Code U
      * Validate Producer
      * CASE: *OTHERWISE
     C                     MOVELBLABCD    YL0027           Producer To
     C                     MOVELBLAECD    YL0028           Producer Locati
      * Rtv From Vals for To  RT - Producer Location From/TO  * Check XRE
     C                     EXSR SIRVGN
      * If Producer Location From/TO record found, check values
      * CASE: LCL.Producer From is Entered
     C           YL0025    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    YL0037           Push Error - Pr
     C                     MOVEL'*NO'     YL0037           Push Error - Pr
     C                     MOVEL'*YES'    YL0044           Hide Producer F
      * If From and To values are different, then override from value
      * CASE: Producer Code OR Producer Location values differ
      *  - c1 OR c2
      *   |- c1    : LCL.Producer To NE LCL.Producer From
      *   |- c2    : LCL.Producer Location To NE LCL.Producer Location Fr
      *   '-
     C           YL0027    IFNE YL0025                     *IF
     C           YL0028    ORNE YL0026                     *OR
     C                     MOVELYL0025    YL0045           PD Producer Cod
     C                     MOVELYL0026    YL0046           PL Location Cod
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELYL0027    YL0045           PD Producer Cod
     C                     MOVELYL0028    YL0046           PL Location Cod
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELBLABCD    YL0025           Producer From
     C                     MOVELBLAECD    YL0026           Producer Locati
     C                     MOVEL'*YES'    YL0037           Push Error - Pr
     C                     MOVEL*BLANK    YL0044           Hide Producer F
     C                     MOVEL'*NO'     YL0044           Hide Producer F
     C                     MOVEL'Y'       YL0043           @Status Detail
     C                     END                             *FI
      * Validate Sub-Contract
      * CASE: *OTHERWISE
      * Rtv Buy Ord Info ALL  RT - Buy Order Header  * From CAK/Sub Cak
     C                     EXSR SJRVGN
      * If From Contract and Sub-Contract values exist
      * CASE: From Contract Code OR Sub-Contract Code are blank
      *  - c1 OR c2
      *   |- c1    : LCL.Contract Code - From USR is *BLANKS
      *   |- c2    : LCL.Sub-Contract  - From USR is *BLANKS
      *   '-
     C           YL0031    IFEQ *BLANK                     *IF
     C           YL0032    OREQ *BLANK                     *OR
     C                     MOVEL'*YES'    YL0038           Push Error - Co
     C                     MOVEL'Y'       YL0043           @Status Detail
     C                     ELSE
      * CASE: *OTHERWISE
      * Retrieve Balancing Status, Hog Class, and Pricing Date
      * Rtv Tattoo All Fields RT - Tattoo Header  * 
     C                     EXSR SKRVGN
      * Rtv Sub-Cak Rcd Sts=A RT - Producer Sub-Contract  * To Location
     C                     EXSR SLRVGN
      * If record not found, set detail error flag = Yes
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    YL0038           Push Error - Co
     C                     MOVEL'*NO'     YL0038           Push Error - Co
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'*YES'    YL0038           Push Error - Co
     C                     MOVEL'Y'       YL0043           @Status Detail
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate Producer Site exists if Tattoo is not a Resale
      * CASE:
      *  - NOTc1
      *   |- c1    : LCL.HC Class Code is Resale
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0029    IFEQ 'RSL'                      *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Site ID            RT - Tattoo Header EXT  * From Location
     C                     EXSR SMRVGN
      * If Site ID is blank, this is an error
      * CASE: LCL.PS Site ID is *Blank
     C           YL0035    IFEQ *BLANK                     *IF
     C                     MOVEL'*YES'    YL0039           Push Error - Si
     C                     MOVEL'Y'       YL0043           @Status Detail
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0039           Push Error - Si
     C                     MOVEL'*NO'     YL0039           Push Error - Si
     C                     END                             *FI
     C                     END                             *FI
      * 2/19/18 JH E12581 - Set error if Tattoo Header is not Balanced.
      * Validate Tattoo Header is Balanced
      * CASE: LCL.TH Kill Balancing Sts is Error
     C           YL0036    IFEQ 'E'                        *IF
     C                     MOVEL'Y'       YL0043           @Status Detail
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0043           @Status Detail
     C                     END                             *FI
      * If Detail Error flag is Yes, select record for processing
      * CASE: LCL.@Status Detail Error is Yes
     C           YL0043    IFEQ 'Y'                        *IF
      * Note: Even if there are no errors on the current record, the Buy
      *       Order Number and the Producer/Producer Location values may
      *       not have changed, so the current record is in error as was
      *       the previous record.
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       P3VQST           Continue Proces
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0AL01  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0AL02  1        BOL Load Number
     C                     MOVEL*BLANK    W0AL03  1        TH Tattoo Numbe
     C                     MOVEL*BLANK    W0AL04  1        TH Kill Date
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        BOH Company Num
     C                     MOVEL'Y'       W0AL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0AL02  1        BOL Load Number
     C                     MOVEL'Y'       W0AL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0AL04  1        TH Kill Date
     C                     ELSE
      * Next record - Detect level breaks
     C           BLHMNB    IFNE WZA001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           BLBNNB    IFNE WZA002                     BOH Buy Order N
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           BLBONB    IFNE WZA003                     BOL Load Number
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C           BLCVNB    IFNE WZA004                     TH Tattoo Numbe
     C           W0AL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL03
     C                     END
     C           BLB0DT    IFNE WZA005                     TH Kill Date
     C           W0AL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL04
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP04
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP03
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of final totals format
     C                     Z-ADDP4YTNB    $DYTNB           @Count
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$DFINTTL
     C                     END
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of Upd Push TO Errors    PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Upd Push TO Errors    PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print BOH Company Number of Upd Push TO Errors    PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE 'P'       W0AP00
     C                     END                             FI
      * Print BOH Buy Order Number of Upd Push TO Errors    PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print BOL Load Number of Upd Push TO Errors    PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print TH Tattoo Number of Upd Push TO Errors    PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP03
     C                     END                             FI
      * Print TH Kill Date of Upd Push TO Errors    PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP04
     C                     END                             FI
      * Print Detail line. of Upd Push TO Errors    PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     ADD  1         P4YTNB           @Count
      * Move values to report fields
      * CASE: *OTHERWISE
     C                     MOVELYL0025    $CSDCD           Producer From
     C                     MOVELYL0026    $CSECD           Producer Locati
     C                     MOVELYL0027    $CSFCD           Producer To
     C                     MOVELYL0028    $CSGCD           Producer Locati
     C                     MOVELYL0029    $CBECD           HC Class Code
     C                     Z-ADDYL0030    $CARDT           BOH Buy Order D
     C                     MOVELP7IXST    $CIXST           SR Type
     C                     MOVELYL0031    $CSOCD           Contract Code -
     C                     MOVELYL0032    $CSQCD           Sub-Contract  -
     C                     MOVELYL0033    $CSPCD           Contract Code -
     C                     MOVELYL0034    $CSSCD           Sub-Contract  -
     C                     MOVELYL0035    $CNYCD           PS Site ID
      * 2/19/18 JH E12581 - Set error if Tattoo Header is not Balanced.
     C                     MOVELYL0036    $CDWST           TH Kill Balanci
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  $CB0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCB0DT
      * Convert BOH Buy Order Date to display format
      * Convert date
     C           1000000   ADD  $CARDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCARDT
     C                     MOVEL'0'       *IN79
     C           YL0037    IFEQ '*NO'                      *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           YL0038    IFEQ '*NO'                      *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           YL0039    IFEQ '*NO'                      *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN76
     C           $CDWST    IFEQ 'B'                        *IF
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$CCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$CDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of Upd Push TO Errors    PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Upd Push TO Errors    PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of Upd Push TO Errors    PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of Upd Push TO Errors    PF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Upd Push TO Errors    PF
     C           W0AP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Upd Push TO Errors    PF
     C           W0AP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Upd Push TO Errors    PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD3         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
     C                     Z-ADDP1HMNB    $BY8A1           Push From Compa
     C                     Z-ADDP2Y9A1    $BY9A1           Push To Company
     C                     MOVELP5KTSS    $BKTSS           Push Type
      * Load Push Type text
      * CASE: TOP.Push Type is Automatic
     C           $BKTSS    IFEQ 'A'                        *IF
     C                     MOVEL@CN,009   $BJPTX           Text 10 1 USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL@CN,010   $BJPTX           Text 10 1 USR
     C                     END                             *FI
      * Convert fields to external form
     C                     MOVEL'0'       *IN79
     C           YL0024    IFEQ '0'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Source Type       RT - Source  * PAR.SR Type
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           AAAACD           SR Source Code
      * Setup key
     C                     MOVELP1OTCD    AAAACD           SR Source Code
      * Establish starting position
     C           KRSSA     CHAIN@AAREAC              90    *
      * Data record not found
     C   90                MOVEL'PRK0005' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAAIXST    P7IXST           SR Type
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Upd Push TO Count Rcds RT - Hog Voucher Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Modifications and Comments
     C                     EXSR UBSUBR                     Modifications a
     C                     Z-ADD*ZERO     YL0001           Count of Eligib
     C                     Z-ADD*ZERO     YL0002           Count of Valid
     C                     Z-ADD*ZERO     YL0003           Count of Errors
      * Declare restrictor key work fields
     C           *LIKE     DEFN BLHMNB    WQSB01           BOH Company Num
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           BOH Company Num
      * Setup key
     C                     Z-ADDP1HMNB    WQSB01           BOH Company Num
      * Establish starting position
     C           KRSSB     SETLL@BLCPXY                    *
     C           KRSSB     READE@BLCPXY                  90*
      * Data record not found
     C   90                MOVEL'PRK0101' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Only check Triumph Owned records
      * CASE: DB1.VCD Source Code is Triumph Owned
     C           BLOTCD    IFEQ 'TO'                       *IF
      * Check Producer and Producer Location values are not blank
      * CASE: If Producer AND Location Code values are not blank
      *  - c1 AND c2
      *   |- c1    : DB1.PD Producer Code is Entered
      *   |- c2    : DB1.PL Location Code is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           BLABCD    IFNE *BLANK                     *IF
     C           BLAECD    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  1         YL0001           Count of Eligib
      * Validate Buy Order#, Producer/Location, and Contract values
      * CASE: Buy Order# OR Producer/Location values change
      *  - c1 OR c2 OR c3
      *   |- c1    : DB1.BOH Buy Order Number NE LCL.BOH Buy Order Number
      *   |- c2    : DB1.PD Producer Code NE LCL.Producer Code         US
      *   |- c3    : DB1.PL Location Code NE LCL.Location Code USR
      *   '-
     C           BLBNNB    IFNE YL0004                     *IF
     C           BLABCD    ORNE YL0005                     *OR
     C           BLAECD    ORNE YL0006                     *OR
     C                     MOVEL'N'       YL0007           @Status Detail
      * Save current values to check for next change
     C                     Z-ADDBLBNNB    YL0004           BOH Buy Order N
     C                     MOVELBLABCD    YL0005           Producer Code
     C                     MOVELBLAECD    YL0006           Location Code U
      * Validate Producer
      * CASE: *OTHERWISE
     C                     MOVELBLABCD    YL0008           Producer To
     C                     MOVELBLAECD    YL0009           Producer Locati
      * Rtv From Vals for To  RT - Producer Location From/TO  * Check XRE
     C                     EXSR SCRVGN
      * If Producer Location From/TO record found, check values
      * CASE: LCL.Producer From is Entered
     C           YL0010    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    YL0012           Push Error - Pr
     C                     MOVEL'*NO'     YL0012           Push Error - Pr
     C                     MOVEL'*YES'    YL0013           Hide Producer F
      * If From and To values are different, then override from value
      * CASE: Producer Code OR Producer Location values differ
      *  - c1 OR c2
      *   |- c1    : LCL.Producer To NE LCL.Producer From
      *   |- c2    : LCL.Producer Location To NE LCL.Producer Location Fr
      *   '-
     C           YL0008    IFNE YL0010                     *IF
     C           YL0009    ORNE YL0011                     *OR
     C                     MOVELYL0010    YL0014           PD Producer Cod
     C                     MOVELYL0011    YL0015           PL Location Cod
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELYL0008    YL0014           PD Producer Cod
     C                     MOVELYL0009    YL0015           PL Location Cod
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'*YES'    YL0012           Push Error - Pr
     C                     MOVEL*BLANK    YL0013           Hide Producer F
     C                     MOVEL'*NO'     YL0013           Hide Producer F
     C                     MOVEL'Y'       YL0007           @Status Detail
     C                     END                             *FI
      * Validate Buy Order Date and Contract
      * CASE: *OTHERWISE
      * Rtv Buy Ord Info ALL  RT - Buy Order Header  * BO Date and Contra
     C                     EXSR SDRVGN
      * If Contract and Sub-Contract values exist
      * CASE: Contract Code OR Sub-Contract Code are blank
      *  - c1 OR c2
      *   |- c1    : LCL.PC Contract Code is *BLANKS
      *   |- c2    : LCL.PSC Sub-Contract Code is *BLANKS
      *   '-
     C           YL0017    IFEQ *BLANK                     *IF
     C           YL0018    OREQ *BLANK                     *OR
     C                     MOVEL'*YES'    YL0019           Push Error - Co
     C                     MOVEL'Y'       YL0007           @Status Detail
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Sub-Cak Rcd Sts=A RT - Producer Sub-Contract  * To Location
     C                     EXSR SERVGN
      * If record not found, set detail error flag = Yes
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    YL0019           Push Error - Co
     C                     MOVEL'*NO'     YL0019           Push Error - Co
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'*YES'    YL0019           Push Error - Co
     C                     MOVEL'Y'       YL0007           @Status Detail
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate Buy Order Type = C (Contract)
      * CASE: DB1.VCD BO Type is Contract
     C           BLJPST    IFEQ 'C'                        *IF
     C                     MOVEL*BLANK    YL0020           Push Error - BO
     C                     MOVEL'*NO'     YL0020           Push Error - BO
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'*YES'    YL0020           Push Error - BO
     C                     MOVEL'Y'       YL0007           @Status Detail
     C                     END                             *FI
      * Validate Producer Site exists
      * CASE: *OTHERWISE
      * Rtv Site ID            RT - Tattoo Header EXT  * From Location
     C                     EXSR SFRVGN
      * If Site ID not blank, check if it exists in To Location
      * CASE: LCL.PS Site ID is Not Blank
     C           YL0021    IFNE *BLANK                     *IF
      * Rtv PrdSite Inform    RT - Producer Site  * To Producer Site
     C                     EXSR SGRVGN
      * If record not found in To Location
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    YL0022           Push Error - Si
     C                     MOVEL'*NO'     YL0022           Push Error - Si
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'*YES'    YL0022           Push Error - Si
     C                     MOVEL'Y'       YL0007           @Status Detail
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'*YES'    YL0022           Push Error - Si
     C                     MOVEL'Y'       YL0007           @Status Detail
     C                     END                             *FI
      * 2/19/18 JH E12581 - Set error if Tattoo Header is not Balanced.
      * Validate Tattoo Header is Balanced
      * CASE: *OTHERWISE
      * Rtv Kill Balancing StsRT - Tattoo Header  * 
     C                     EXSR SHRVGN
      * CASE: LCL.TH Kill Balancing Sts is Error
     C           YL0023    IFEQ 'E'                        *IF
     C                     MOVEL'Y'       YL0007           @Status Detail
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0007           @Status Detail
     C                     END                             *FI
      * If Detail Error flag is Yes, select record for processing
      * CASE: LCL.@Status Detail Error is Yes
     C           YL0007    IFEQ 'Y'                        *IF
     C                     ADD  1         YL0003           Count of Errors
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         YL0002           Count of Valid
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSB     READE@BLCPXY                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv From Vals for To  RT - Producer Location From/TO  * Check XR
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0010           Producer From
     C                     MOVEL*BLANK    YL0011           Producer Locati
      * Declare restrictor key work fields
     C           *LIKE     DEFN ADSFCD    WQSC01           Producer To
     C           *LIKE     DEFN ADSGCD    WQSC02           Producer Locati
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Producer To
     C                     KFLD           WQSC02           Producer Locati
      * Setup key
     C                     MOVELYL0008    WQSC01           Producer To
     C                     MOVELYL0009    WQSC02           Producer Locati
      * Establish starting position
     C           KRSSC     SETLL@ADCPXJ                    *
     C           KRSSC     READE@ADCPXJ                  90*
      * Data record not found
     C   90                MOVEL'PRK1426' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If record is active
      * CASE: DB1.RS Record Status is Active
     C           ADAJST    IFEQ 'A'                        *IF
      * PAR = DB1 By name
     C                     MOVELADSDCD    YL0010           Producer From
     C                     MOVELADSECD    YL0011           Producer Locati
     C                     END                             *FI
     C           KRSSC     READE@ADCPXJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Buy Ord Info ALL  RT - Buy Order Header  * BO Date and Contr
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           AWHMNB           BOH Company Num
     C                     KFLD           AWBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADDBLHMNB    AWHMNB           BOH Company Num
     C                     Z-ADDBLBNNB    AWBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSSD     CHAIN@AWCPBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0049' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0016           BOH Buy Order D
     C                     MOVEL*BLANK    YL0017           PC Contract Cod
     C                     MOVEL*BLANK    YL0018           PSC Sub-Contrac
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAWARDT    YL0016           BOH Buy Order D
     C                     MOVELAWAKCD    YL0017           PC Contract Cod
     C                     MOVELAWALCD    YL0018           PSC Sub-Contrac
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Sub-Cak Rcd Sts=A RT - Producer Sub-Contract  * To Location
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AQABCD    WQSE01           PD Producer Cod
     C           *LIKE     DEFN AQAECD    WQSE02           PL Location Cod
      * Define keylist
     C           KPSSE     KLIST
     C                     KFLD           WQSE01           PD Producer Cod
     C                     KFLD           WQSE02           PL Location Cod
     C                     KFLD           AQAHDT           PSC Date
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           PD Producer Cod
     C                     KFLD           WQSE02           PL Location Cod
      * Setup key
     C                     MOVELBLABCD    WQSE01           PD Producer Cod
     C                     MOVELBLAECD    WQSE02           PL Location Cod
     C                     Z-ADD##JDT     AQAHDT           PSC Date
      * Establish starting position
     C           KPSSE     SETLL@AQCPLQ                    *
     C           KRSSE     READE@AQCPLQ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0037' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0017           PC Contract Cod
     C                     MOVEL*BLANK    YL0018           PSC Sub-Contrac
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Get the most recent record, and then quit
      * PAR = DB1 By name
     C                     MOVELAQAKCD    YL0017           PC Contract Cod
     C                     MOVELAQALCD    YL0018           PSC Sub-Contrac
     C                     GOTO SEEXIT                     *QUIT
     C           KRSSE     READE@AQCPLQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Site ID            RT - Tattoo Header EXT  * From Location
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           DNHMNB           BOH Company Num
     C                     KFLD           DNBNNB           BOH Buy Order N
     C                     KFLD           DNBONB           BOL Load Number
     C                     KFLD           DNCVNB           TH Tattoo Numbe
     C                     KFLD           DNB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDBLHMNB    DNHMNB           BOH Company Num
     C                     Z-ADDBLBNNB    DNBNNB           BOH Buy Order N
     C                     Z-ADDBLBONB    DNBONB           BOL Load Number
     C                     Z-ADDBLCVNB    DNCVNB           TH Tattoo Numbe
     C                     Z-ADDBLB0DT    DNB0DT           TH Kill Date
      * Establish starting position
     C           KRSSF     CHAIN@DNCPUY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0637' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0021           PS Site ID
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNNYCD    YL0021           PS Site ID
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv PrdSite Inform    RT - Producer Site  * To Producer Site
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           ATABCD           PD Producer Cod
     C                     KFLD           ATNYCD           PS Site ID
      * Setup key
     C                     MOVELYL0014    ATABCD           PD Producer Cod
     C                     MOVELYL0021    ATNYCD           PS Site ID
      * Establish starting position
     C           KRSSG     CHAIN@ATRELM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1137' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Kill Balancing StsRT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Setup key
     C                     Z-ADDBLHMNB    A1HMNB           BOH Company Num
     C                     Z-ADDBLBNNB    A1BNNB           BOH Buy Order N
     C                     Z-ADDBLBONB    A1BONB           BOL Load Number
     C                     Z-ADDBLCVNB    A1CVNB           TH Tattoo Numbe
     C                     Z-ADDBLB0DT    A1B0DT           TH Kill Date
      * Establish starting position
     C           KRSSH     CHAIN@A1CPC4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0023           TH Kill Balanci
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA1DWST    YL0023           TH Kill Balanci
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv From Vals for To  RT - Producer Location From/TO  * Check XR
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0025           Producer From
     C                     MOVEL*BLANK    YL0026           Producer Locati
      * Declare restrictor key work fields
     C           *LIKE     DEFN ADSFCD    WQSI01           Producer To
     C           *LIKE     DEFN ADSGCD    WQSI02           Producer Locati
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Producer To
     C                     KFLD           WQSI02           Producer Locati
      * Setup key
     C                     MOVELYL0027    WQSI01           Producer To
     C                     MOVELYL0028    WQSI02           Producer Locati
      * Establish starting position
     C           KRSSI     SETLL@ADCPXJ                    *
     C           KRSSI     READE@ADCPXJ                  90*
      * Data record not found
     C   90                MOVEL'PRK1426' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If record is active
      * CASE: DB1.RS Record Status is Active
     C           ADAJST    IFEQ 'A'                        *IF
      * PAR = DB1 By name
     C                     MOVELADSDCD    YL0025           Producer From
     C                     MOVELADSECD    YL0026           Producer Locati
     C                     END                             *FI
     C           KRSSI     READE@ADCPXJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Buy Ord Info ALL  RT - Buy Order Header  * From CAK/Sub Cak
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           AWHMNB           BOH Company Num
     C                     KFLD           AWBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADDBLHMNB    AWHMNB           BOH Company Num
     C                     Z-ADDBLBNNB    AWBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSSJ     CHAIN@AWCPBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0049' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0031           PC Contract Cod
     C                     MOVEL*BLANK    YL0032           PSC Sub-Contrac
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAWAKCD    YL0031           PC Contract Cod
     C                     MOVELAWALCD    YL0032           PSC Sub-Contrac
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Tattoo All Fields RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQSK01           BOH Company Num
     C           *LIKE     DEFN A1BNNB    WQSK02           BOH Buy Order N
     C           *LIKE     DEFN A1BONB    WQSK03           BOL Load Number
     C           *LIKE     DEFN A1CVNB    WQSK04           TH Tattoo Numbe
      * Define keylist
     C           KPSSK     KLIST
     C                     KFLD           WQSK01           BOH Company Num
     C                     KFLD           WQSK02           BOH Buy Order N
     C                     KFLD           WQSK03           BOL Load Number
     C                     KFLD           WQSK04           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           BOH Company Num
     C                     KFLD           WQSK02           BOH Buy Order N
     C                     KFLD           WQSK03           BOL Load Number
     C                     KFLD           WQSK04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDBLHMNB    WQSK01           BOH Company Num
     C                     Z-ADDBLBNNB    WQSK02           BOH Buy Order N
     C                     Z-ADDBLBONB    WQSK03           BOL Load Number
     C                     Z-ADDBLCVNB    WQSK04           TH Tattoo Numbe
     C                     Z-ADDBLB0DT    A1B0DT           TH Kill Date
      * Establish starting position
     C           KPSSK     SETLL@A1CPC4                    *
     C           KRSSK     READE@A1CPC4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0047           TH Pricing Date
     C                     MOVEL*BLANK    YL0036           TH Kill Balanci
     C                     MOVEL*BLANK    YL0029           HC Class Code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  A1CCPR    YL0048           Net Amount
     C           KRSSK     READE@A1CPC4                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     Z-ADDYL0049    YN0109           Th Payment Net
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Sub-Cak Rcd Sts=A RT - Producer Sub-Contract  * To Location
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AQABCD    WQSL01           PD Producer Cod
     C           *LIKE     DEFN AQAECD    WQSL02           PL Location Cod
      * Define keylist
     C           KPSSL     KLIST
     C                     KFLD           WQSL01           PD Producer Cod
     C                     KFLD           WQSL02           PL Location Cod
     C                     KFLD           AQAHDT           PSC Date
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           PD Producer Cod
     C                     KFLD           WQSL02           PL Location Cod
      * Setup key
     C                     MOVELBLABCD    WQSL01           PD Producer Cod
     C                     MOVELBLAECD    WQSL02           PL Location Cod
     C                     Z-ADDYL0047    AQAHDT           PSC Date
      * Establish starting position
     C           KPSSL     SETLL@AQCPLQ                    *
     C           KRSSL     READE@AQCPLQ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0037' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0033           PC Contract Cod
     C                     MOVEL*BLANK    YL0034           PSC Sub-Contrac
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Get the most recent record, and then quit
      * PAR = DB1 By name
     C                     MOVELAQAKCD    YL0033           PC Contract Cod
     C                     MOVELAQALCD    YL0034           PSC Sub-Contrac
     C                     GOTO SLEXIT                     *QUIT
     C           KRSSL     READE@AQCPLQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Site ID            RT - Tattoo Header EXT  * From Location
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           DNHMNB           BOH Company Num
     C                     KFLD           DNBNNB           BOH Buy Order N
     C                     KFLD           DNBONB           BOL Load Number
     C                     KFLD           DNCVNB           TH Tattoo Numbe
     C                     KFLD           DNB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDBLHMNB    DNHMNB           BOH Company Num
     C                     Z-ADDBLBNNB    DNBNNB           BOH Buy Order N
     C                     Z-ADDBLBONB    DNBONB           BOL Load Number
     C                     Z-ADDBLCVNB    DNCVNB           TH Tattoo Numbe
     C                     Z-ADDBLB0DT    DNB0DT           TH Kill Date
      * Establish starting position
     C           KRSSM     CHAIN@DNCPUY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0637' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0035           PS Site ID
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNNYCD    YL0035           PS Site ID
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modification history
      *================================================================
      * 2/19/18 JH E12581 - Set error if Tattoo Header is not Balanced.
      *                     Added the TH Killing Balancing Sts field.
      *                     Print "<" when TH Kill Balancing Sts = E.
      * 4/27/17 JBB E9044 - MHP to TF2 2nd Payent
      *                     This report prints before the push of the
      *                     Seaboard Foods (440) payments to Company 961.
      *                     The report will list Producer Location errors
      *                     Before calling the program, an override to
      *                     the Producer Location is done to point to the
      *                     correct library for Company 961.
      *  9/06/17 JBB E9044 - MHP to TF2 2nd Payent
      *                     Remove Kill Date from processing.  All record
      *                     with a Payment Push Status of blank are
      *                     processed.
      *  9/06/17 JBB E13291 - Repayment Project
      *                      Retrieve TH Pricing Date from the Tattoo
      *                      Header and use the value to get the Producer
      *                      Sub-Contract based on the date.
      * 01/23/20 ISE H16853 - Increased the length from 5 to 7 and correc
      *                       the alignment of Buy Order Number field
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * 2/19/18 JH E12581 - Set error if Tattoo Header is not Balanced.
      *                     Added the TH Killing Balancing Sts field.
      *                     Print "<" when TH Kill Balancing Sts = E.
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1OTCD           VCD Source Code
     C                     Z-ADD*ZERO     P6TWA1           Record Cnt usr
     C                     MOVEL*BLANK    P7IXST           SR Type
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    BLHMNB           BOH Company Num
     C                     MOVEL*LOVAL    BLBNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    BLBONB           BOL Load Number
     C                     MOVEL*LOVAL    BLCVNB           TH Tattoo Numbe
     C                     MOVEL*LOVAL    BLB0DT           TH Kill Date
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Count of Eligible Records
     C                     Z-ADD*ZERO     YL0001 110
      * Define local work field Count of Valid Records
     C                     Z-ADD*ZERO     YL0002 110
      * Define local work field Count of Errors Found
     C                     Z-ADD*ZERO     YL0003 110
      * Define local work field BOH Buy Order Number
     C                     Z-ADD*ZERO     YL0004  70
      * Define local work field Producer Code         USR
     C                     MOVEL*BLANK    YL0005  6
      * Define local work field Location Code USR
     C                     MOVEL*BLANK    YL0006  6
      * Define local work field @Status Detail Error
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field Producer To
     C                     MOVEL*BLANK    YL0008  6
      * Define local work field Producer Location To
     C                     MOVEL*BLANK    YL0009  6
      * Define local work field Producer From
     C                     MOVEL*BLANK    YL0010  6
      * Define local work field Producer Location From
     C                     MOVEL*BLANK    YL0011  6
      * Define null work field PLF Status 1
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field PLF Status 2
     C                     MOVEL*BLANK    YN0002  1
      * Define null work field PLF Status 3
     C                     MOVEL*BLANK    YN0003  1
      * Define local work field Push Error - Producer
     C                     MOVEL*BLANK    YL0012  4
      * Define local work field Hide Producer Field
     C                     MOVEL*BLANK    YL0013  4
      * Define local work field PD Producer Code
     C                     MOVEL*BLANK    YL0014  6
      * Define local work field PL Location Code
     C                     MOVEL*BLANK    YL0015  6
      * Define local work field BOH Buy Order Date
     C                     Z-ADD*ZERO     YL0016  70
      * Define null work field BOH Kill Date
     C                     Z-ADD*ZERO     YN0004  70
      * Define null work field BOH Payment Type
     C                     MOVEL*BLANK    YN0005  1
      * Define null work field BOH Buy Order Type
     C                     MOVEL*BLANK    YN0006  1
      * Define null work field BOH Market Add/Deduct
     C                     Z-ADD*ZERO     YN0007  52
      * Define null work field BOH Status
     C                     MOVEL*BLANK    YN0008  1
      * Define null work field BOH Delv Plan Printed
     C                     MOVEL*BLANK    YN0009  1
      * Define null work field BOH Quote Price Type
     C                     MOVEL*BLANK    YN0010  2
      * Define null work field BOH Quoted Base Mkt Price
     C                     Z-ADD*ZERO     YN0011  52
      * Define null work field PPWS Company Number
     C                     Z-ADD*ZERO     YN0012  30
      * Define null work field CW Year
     C                     Z-ADD*ZERO     YN0013  40
      * Define null work field CW Week Number
     C                     Z-ADD*ZERO     YN0014  20
      * Define null work field PD Producer Code
     C                     MOVEL*BLANK    YN0015  6
      * Define null work field PL Location Code
     C                     MOVEL*BLANK    YN0016  6
      * Define local work field PC Contract Code
     C                     MOVEL*BLANK    YL0017  5
      * Define local work field PSC Sub-Contract Code
     C                     MOVEL*BLANK    YL0018  5
      * Define null work field GN Genetic Code
     C                     MOVEL*BLANK    YN0017  5
      * Define null work field PO Option Code
     C                     MOVEL*BLANK    YN0018  3
      * Define null work field CMP Program Code
     C                     MOVEL*BLANK    YN0019  3
      * Define null work field HB Buyer Code
     C                     MOVEL*BLANK    YN0020  3
      * Define null work field RS Record Status
     C                     MOVEL*BLANK    YN0021  1
      * Define local work field Push Error - Contract
     C                     MOVEL*BLANK    YL0019  4
      * Define local work field Push Error - BO Type
     C                     MOVEL*BLANK    YL0020  4
      * Define local work field PS Site ID
     C                     MOVEL*BLANK    YL0021 10
      * Define null work field PS Site Name
     C                     MOVEL*BLANK    YN0022 40
      * Define null work field PS Manager
     C                     MOVEL*BLANK    YN0023 40
      * Define null work field PS Address
     C                     MOVEL*BLANK    YN0024 40
      * Define null work field PS City
     C                     MOVEL*BLANK    YN0025 40
      * Define null work field PS State
     C                     MOVEL*BLANK    YN0026  3
      * Define null work field PS Zip Code
     C                     MOVEL*BLANK    YN0027 12
      * Define null work field PS Latitude
     C                     MOVEL*BLANK    YN0028 30
      * Define null work field PS Longitude
     C                     MOVEL*BLANK    YN0029 30
      * Define null work field PS User Mileage 1
     C                     Z-ADD*ZERO     YN0030  50
      * Define null work field PS User Mileage 2
     C                     Z-ADD*ZERO     YN0031  50
      * Define null work field PS Facility Type/County
     C                     MOVEL*BLANK    YN0032 30
      * Define null work field PS Status 1
     C                     MOVEL*BLANK    YN0033  1
      * Define null work field PS Status 2
     C                     MOVEL*BLANK    YN0034  1
      * Define null work field PS Status 3
     C                     MOVEL*BLANK    YN0035  1
      * Define null work field PS Trace Sequence #
     C                     Z-ADD*ZERO     YN0036  60
      * Define null work field PS Veterinarian
     C                     MOVEL*BLANK    YN0037 40
      * Define null work field PS Nutritionist
     C                     MOVEL*BLANK    YN0038 40
      * Define null work field PS Premises ID
     C                     MOVEL*BLANK    YN0039  7
      * Define local work field Push Error - Site ID
     C                     MOVEL*BLANK    YL0022  4
      * Define local work field TH Kill Balancing Sts
     C                     MOVEL*BLANK    YL0023  1
      * Define local work field Print on Form
     C                     MOVEL*BLANK    YL0024  1
      * Define local work field Producer From
     C                     MOVEL*BLANK    YL0025  6
      * Define local work field Producer Location From
     C                     MOVEL*BLANK    YL0026  6
      * Define local work field Producer To
     C                     MOVEL*BLANK    YL0027  6
      * Define local work field Producer Location To
     C                     MOVEL*BLANK    YL0028  6
      * Define local work field HC Class Code
     C                     MOVEL*BLANK    YL0029  3
      * Define local work field BOH Buy Order Date
     C                     Z-ADD*ZERO     YL0030  70
      * Define local work field Contract Code - From USR
     C                     MOVEL*BLANK    YL0031  5
      * Define local work field Sub-Contract  - From USR
     C                     MOVEL*BLANK    YL0032  5
      * Define local work field Contract Code - To   USR
     C                     MOVEL*BLANK    YL0033  5
      * Define local work field Sub-Contract  - To   USR
     C                     MOVEL*BLANK    YL0034  5
      * Define local work field PS Site ID
     C                     MOVEL*BLANK    YL0035 10
      * Define local work field TH Kill Balancing Sts
     C                     MOVEL*BLANK    YL0036  1
      * Define local work field Push Error - Producer
     C                     MOVEL*BLANK    YL0037  4
      * Define local work field Push Error - Contract
     C                     MOVEL*BLANK    YL0038  4
      * Define local work field Push Error - Site ID
     C                     MOVEL*BLANK    YL0039  4
      * Define local work field BOH Buy Order Number
     C                     Z-ADD*ZERO     YL0040  70
      * Define local work field Producer Code         USR
     C                     MOVEL*BLANK    YL0041  6
      * Define local work field Location Code USR
     C                     MOVEL*BLANK    YL0042  6
      * Define local work field @Status Detail Error
     C                     MOVEL*BLANK    YL0043  1
      * Define null work field PLF Status 1
     C                     MOVEL*BLANK    YN0040  1
      * Define null work field PLF Status 2
     C                     MOVEL*BLANK    YN0041  1
      * Define null work field PLF Status 3
     C                     MOVEL*BLANK    YN0042  1
      * Define local work field Hide Producer Field
     C                     MOVEL*BLANK    YL0044  4
      * Define local work field PD Producer Code
     C                     MOVEL*BLANK    YL0045  6
      * Define local work field PL Location Code
     C                     MOVEL*BLANK    YL0046  6
      * Define null work field BOH Buy Order Date
     C                     Z-ADD*ZERO     YN0043  70
      * Define null work field BOH Kill Date
     C                     Z-ADD*ZERO     YN0044  70
      * Define null work field BOH Payment Type
     C                     MOVEL*BLANK    YN0045  1
      * Define null work field BOH Buy Order Type
     C                     MOVEL*BLANK    YN0046  1
      * Define null work field BOH Market Add/Deduct
     C                     Z-ADD*ZERO     YN0047  52
      * Define null work field BOH Status
     C                     MOVEL*BLANK    YN0048  1
      * Define null work field BOH Delv Plan Printed
     C                     MOVEL*BLANK    YN0049  1
      * Define null work field BOH Quote Price Type
     C                     MOVEL*BLANK    YN0050  2
      * Define null work field BOH Quoted Base Mkt Price
     C                     Z-ADD*ZERO     YN0051  52
      * Define null work field PPWS Company Number
     C                     Z-ADD*ZERO     YN0052  30
      * Define null work field CW Year
     C                     Z-ADD*ZERO     YN0053  40
      * Define null work field CW Week Number
     C                     Z-ADD*ZERO     YN0054  20
      * Define null work field PD Producer Code
     C                     MOVEL*BLANK    YN0055  6
      * Define null work field PL Location Code
     C                     MOVEL*BLANK    YN0056  6
      * Define null work field GN Genetic Code
     C                     MOVEL*BLANK    YN0057  5
      * Define null work field PO Option Code
     C                     MOVEL*BLANK    YN0058  3
      * Define null work field CMP Program Code
     C                     MOVEL*BLANK    YN0059  3
      * Define null work field HB Buyer Code
     C                     MOVEL*BLANK    YN0060  3
      * Define null work field RS Record Status
     C                     MOVEL*BLANK    YN0061  1
      * Define null work field TH Purchase Date
     C                     Z-ADD*ZERO     YN0062  70
      * Define null work field TH Group Reference
     C                     MOVEL*BLANK    YN0063 10
      * Define null work field TH Live Purchase UOM
     C                     MOVEL*BLANK    YN0064  2
      * Define null work field TH Live Purchase Price
     C                     Z-ADD*ZERO     YN0065  52
      * Define null work field TH Live Gross Amt
     C                     Z-ADD*ZERO     YN0066  72
      * Define null work field TH LIve Net Amt
     C                     Z-ADD*ZERO     YN0067  72
      * Define null work field TH Resale UOM
     C                     MOVEL*BLANK    YN0068  2
      * Define null work field TH Recalc Live Wgt Yld
     C                     Z-ADD*ZERO     YN0069  52
      * Define local work field TH Pricing Date
     C                     Z-ADD*ZERO     YL0047  70
      * Define null work field TH Resale Spread Sts
     C                     MOVEL*BLANK    YN0070  1
      * Define null work field TH Dead On Arrival
     C                     Z-ADD*ZERO     YN0071  50
      * Define null work field TH Head Received
     C                     Z-ADD*ZERO     YN0072  50
      * Define null work field TH Yard Deads
     C                     Z-ADD*ZERO     YN0073  50
      * Define null work field TH Held Over
     C                     Z-ADD*ZERO     YN0074  50
      * Define null work field TH Head Condemned
     C                     Z-ADD*ZERO     YN0075  50
      * Define null work field TH Head Killed
     C                     Z-ADD*ZERO     YN0076  50
      * Define null work field TH Head Adds
     C                     Z-ADD*ZERO     YN0077  50
      * Define null work field TH Head Accepted
     C                     Z-ADD*ZERO     YN0078  50
      * Define null work field TH Live Wgt
     C                     Z-ADD*ZERO     YN0079  71
      * Define null work field TH Adj Live Wgt
     C                     Z-ADD*ZERO     YN0080  71
      * Define null work field TH Hot Wgt
     C                     Z-ADD*ZERO     YN0081  71
      * Define null work field TH Tot Loin Eye Depth
     C                     Z-ADD*ZERO     YN0082  61
      * Define null work field TH Tot Backfat Inches
     C                     Z-ADD*ZERO     YN0083  61
      * Define null work field TH Tot Light Reflectance
     C                     Z-ADD*ZERO     YN0084  61
      * Define null work field TH Avg Live Wgt
     C                     Z-ADD*ZERO     YN0085  51
      * Define null work field TH Avg Hot Wgt
     C                     Z-ADD*ZERO     YN0086  51
      * Define null work field TH Avg Light Reflectance
     C                     Z-ADD*ZERO     YN0087  31
      * Define null work field TH Avg Lean Percent
     C                     Z-ADD*ZERO     YN0088  31
      * Define null work field TH Avg Loin Eye Depth
     C                     Z-ADD*ZERO     YN0089  31
      * Define null work field TH Avg Backfat
     C                     Z-ADD*ZERO     YN0090  31
      * Define null work field TH Std Yield Percent
     C                     Z-ADD*ZERO     YN0091  52
      * Define null work field TH Actual Yield %
     C                     Z-ADD*ZERO     YN0092  52
      * Define null work field TH Adj Actual Yield %
     C                     Z-ADD*ZERO     YN0093  52
      * Define null work field TH Yield Difference
     C                     Z-ADD*ZERO     YN0094  52
      * Define null work field TH Recalc Live Wgt
     C                     Z-ADD*ZERO     YN0095  31
      * Define null work field TH CM Market Price
     C                     Z-ADD*ZERO     YN0096  52
      * Define null work field TH CM Base Mkt Price
     C                     Z-ADD*ZERO     YN0097  52
      * Define null work field TH CM Base Mkt Price Amt
     C                     Z-ADD*ZERO     YN0098  72
      * Define null work field TH CM Sort Discount Amt
     C                     Z-ADD*ZERO     YN0099  72
      * Define null work field TH CM Yield Gain/Loss Amt
     C                     Z-ADD*ZERO     YN0100  72
      * Define null work field TH CM Base Carcass Value
     C                     Z-ADD*ZERO     YN0101  72
      * Define null work field TH CM LN AddOn/Deduct Amt
     C                     Z-ADD*ZERO     YN0102  72
      * Define null work field TH CM Carcass Gross Amt
     C                     Z-ADD*ZERO     YN0103  72
      * Define null work field TH Deduction Amt
     C                     Z-ADD*ZERO     YN0104  72
      * Define null work field TH Total Net WO Adds
     C                     Z-ADD*ZERO     YN0105  72
      * Define null work field TH Carcass Net Amt
     C                     Z-ADD*ZERO     YN0106  72
      * Define null work field TH Additions Amt
     C                     Z-ADD*ZERO     YN0107  72
      * Define null work field TH Payment Gross
     C                     Z-ADD*ZERO     YN0108  72
      * Define null work field Th Payment Net Amt
     C                     Z-ADD*ZERO     YN0109  72
      * Define null work field TH AP Voucher/Document#
     C                     Z-ADD*ZERO     YN0110  80
      * Define null work field TH Freight Amount
     C                     Z-ADD*ZERO     YN0111  72
      * Define null work field TH Accrual Amount
     C                     Z-ADD*ZERO     YN0112  72
      * Define null work field TH Fixed Cost Amount
     C                     Z-ADD*ZERO     YN0113  72
      * Define null work field TH Calc Net Sts
     C                     MOVEL*BLANK    YN0114  1
      * Define null work field TH Payment Sts
     C                     MOVEL*BLANK    YN0115  2
      * Define null work field TH Header Error Sts
     C                     MOVEL*BLANK    YN0116  1
      * Define null work field TH Detail Error Sts
     C                     MOVEL*BLANK    YN0117  1
      * Define null work field TH Bal to Kill Gen
     C                     MOVEL*BLANK    YN0118  1
      * Define null work field TH Commission A/P Voucher
     C                     Z-ADD*ZERO     YN0119  80
      * Define null work field TH Voucher Payment Date
     C                     Z-ADD*ZERO     YN0120  70
      * Define null work field TH User Error Override
     C                     MOVEL*BLANK    YN0121  1
      * Define null work field TH Held Over Record
     C                     MOVEL*BLANK    YN0122  1
      * Define null work field TH Sex
     C                     MOVEL*BLANK    YN0123  1
      * Define null work field TH Held/Ovr Completed Dte
     C                     Z-ADD*ZERO     YN0124  70
      * Define null work field TH Commission Paid Date
     C                     Z-ADD*ZERO     YN0125  70
      * Define null work field TH Actual Check Date
     C                     Z-ADD*ZERO     YN0126  70
      * Define null work field TH Shipped Weight
     C                     Z-ADD*ZERO     YN0127  71
      * Define null work field TH Avg Hot Wgt EXC/ADD
     C                     Z-ADD*ZERO     YN0128  71
      * Define null work field TH FFLI
     C                     Z-ADD*ZERO     YN0129  31
      * Define null work field TH Kill Product Value
     C                     Z-ADD*ZERO     YN0130  72
      * Define null work field TH Cut Product Value
     C                     Z-ADD*ZERO     YN0131  72
      * Define null work field TH Render Product Value
     C                     Z-ADD*ZERO     YN0132  72
      * Define null work field TH Head Excluded
     C                     Z-ADD*ZERO     YN0133  50
      * Define null work field TH CM Bse Mkt Live /CWT
     C                     Z-ADD*ZERO     YN0134  52
      * Define null work field TH CM Bse Mkt Carc /CWT
     C                     Z-ADD*ZERO     YN0135  52
      * Define null work field TH CM Srt Dsc Live /CWT
     C                     Z-ADD*ZERO     YN0136  52
      * Define null work field TH CM Srt Dsc Carc /CWT
     C                     Z-ADD*ZERO     YN0137  52
      * Define null work field TH CM Yld G/L Live /CWT
     C                     Z-ADD*ZERO     YN0138  52
      * Define null work field TH CM Yld G/L Carc /CWT
     C                     Z-ADD*ZERO     YN0139  52
      * Define null work field TH CM Crc Val Live /CWT
     C                     Z-ADD*ZERO     YN0140  52
      * Define null work field TH CM Crc Val Carc /CWT
     C                     Z-ADD*ZERO     YN0141  52
      * Define null work field TH CM Lean Prem Live /CWT
     C                     Z-ADD*ZERO     YN0142  52
      * Define null work field TH CM Lean Prem Carc /CWT
     C                     Z-ADD*ZERO     YN0143  52
      * Define null work field TH CM Gross Live /CWT
     C                     Z-ADD*ZERO     YN0144  52
      * Define null work field TH CM Gross Carc /CWT
     C                     Z-ADD*ZERO     YN0145  52
      * Define null work field TH Source Type
     C                     MOVEL*BLANK    YN0146  1
      * Define null work field TH Scale Ticket Sts
     C                     MOVEL*BLANK    YN0147  1
      * Define null work field TH Payment Type
     C                     MOVEL*BLANK    YN0148  1
      * Define null work field TH HPS Movement Ref #
     C                     Z-ADD*ZERO     YN0149  70
      * Define null work field TH Source Code
     C                     MOVEL*BLANK    YN0150  3
      * Define null work field TH Hog Class Type
     C                     MOVEL*BLANK    YN0151  1
      * Define null work field TH Posted to HPS Flag
     C                     MOVEL*BLANK    YN0152  1
      * Define null work field TH Schedule Kill Shift
     C                     MOVEL*BLANK    YN0153  1
      * Define null work field TH Shift Held Over
     C                     MOVEL*BLANK    YN0154  1
      * Define null work field TH State
     C                     MOVEL*BLANK    YN0155  3
      * Define null work field TH Unused Code
     C                     MOVEL*BLANK    YN0156  3
      * Define null work field TH Unused Sts 2 Pos
     C                     MOVEL*BLANK    YN0157  2
      * Define null work field TH Commission Status
     C                     MOVEL*BLANK    YN0158  1
      * Define null work field TH Paid 2 Week Avg Y/N
     C                     MOVEL*BLANK    YN0159  1
      * Define null work field TH Unused Sts 1 Pos -3
     C                     MOVEL*BLANK    YN0160  1
      * Define null work field TH DOA Weight
     C                     Z-ADD*ZERO     YN0161  71
      * Define null work field TH Avg Lean % EXC/ADD
     C                     Z-ADD*ZERO     YN0162  71
      * Define null work field TH HPS Farm Site
     C                     Z-ADD*ZERO     YN0163  50
      * Define null work field TH Shift Held Over Head
     C                     Z-ADD*ZERO     YN0164  50
      * Define null work field TH Sorting Amount
     C                     Z-ADD*ZERO     YN0165  72
      * Define null work field TH Head Identified
     C                     Z-ADD*ZERO     YN0166  50
      * Define null work field TH Percent Identified
     C                     Z-ADD*ZERO     YN0167  52
      * Define null work field TH Percent Accepted
     C                     Z-ADD*ZERO     YN0168  52
      * Define null work field TH Head Adjusted-LN%
     C                     Z-ADD*ZERO     YN0169  50
      * Define null work field TH PHA Head Adds
     C                     Z-ADD*ZERO     YN0170  50
      * Define null work field TH PHA Add Type
     C                     MOVEL*BLANK    YN0171  1
      * Define null work field TH PHA Average Type
     C                     MOVEL*BLANK    YN0172  3
      * Define null work field TH PHA Add Reason
     C                     MOVEL*BLANK    YN0173  1
      * Define null work field TH PHA Yield Percent
     C                     Z-ADD*ZERO     YN0174  52
      * Define null work field TH PHA Lean Prm /Crc CWT
     C                     Z-ADD*ZERO     YN0175  52
      * Define null work field TH VC Gross Value /HD
     C                     Z-ADD*ZERO     YN0176  52
      * Define null work field TH Excluded Gross Value
     C                     Z-ADD*ZERO     YN0177  72
      * Define null work field TH Avg Lean %
     C                     Z-ADD*ZERO     YN0178  50
      * Define null work field TH Broken Back Hd Count
     C                     Z-ADD*ZERO     YN0179  50
      * Define null work field TH Hot Scl Upload Time
     C                     Z-ADD*ZERO     YN0180  70
      * Define null work field TH Unused Nbr 4
     C                     Z-ADD*ZERO     YN0181  70
      * Define null work field TH Excluded Carc Val
     C                     Z-ADD*ZERO     YN0182  72
      * Define null work field TH Excluded Premium
     C                     Z-ADD*ZERO     YN0183  72
      * Define null work field TH Unused Nbr 7
     C                     Z-ADD*ZERO     YN0184  71
      * Define null work field TH Unused Nbr 8
     C                     Z-ADD*ZERO     YN0185  71
      * Define null work field TH Unused Nbr 9
     C                     Z-ADD*ZERO     YN0186 111
      * Define null work field TH Unused Nbr 10
     C                     Z-ADD*ZERO     YN0187 111
      * Define null work field TH Break Even Price/CWT
     C                     Z-ADD*ZERO     YN0188 112
      * Define null work field TH Meat Value Factor Amt
     C                     Z-ADD*ZERO     YN0189 112
      * Define null work field TH Yld Parm Adj Yield%
     C                     Z-ADD*ZERO     YN0190  52
      * Define null work field TH PHA Sort Disc Fctr %
     C                     Z-ADD*ZERO     YN0191  52
      * Define null work field TH Avg Loin Eye - 2 dec
     C                     Z-ADD*ZERO     YN0192  52
      * Define null work field TH Avg Backfat - 2 Dec
     C                     Z-ADD*ZERO     YN0193  52
      * Define null work field TH HITCH Old Pay Net Amt
     C                     Z-ADD*ZERO     YN0194  92
      * Define null work field TH MPR Sort Loss
     C                     Z-ADD*ZERO     YN0195  92
      * Define null work field TH Unused Nbr 19
     C                     Z-ADD*ZERO     YN0196  90
      * Define null work field TH Unused Nbr 20
     C                     Z-ADD*ZERO     YN0197  90
      * Define null work field TH Cold Scl Upload Date
     C                     Z-ADD*ZERO     YN0198  70
      * Define null work field TH Cold Scl Upload Time
     C                     Z-ADD*ZERO     YN0199  70
      * Define null work field TH Head LFT
     C                     Z-ADD*ZERO     YN0200  70
      * Define null work field TH Head EUT/KOA
     C                     Z-ADD*ZERO     YN0201  70
      * Define null work field TH Unused Date 5
     C                     Z-ADD*ZERO     YN0202  70
      * Define null work field TH Unused Sts 1
     C                     MOVEL*BLANK    YN0203  1
      * Define null work field TH Unused Sts 2
     C                     MOVEL*BLANK    YN0204  1
      * Define null work field TH Unused Sts 3
     C                     MOVEL*BLANK    YN0205  1
      * Define null work field TH Unused Sts 4
     C                     MOVEL*BLANK    YN0206  2
      * Define null work field TH Unused Sts 5
     C                     MOVEL*BLANK    YN0207  2
      * Define null work field TH Unused Sts 6
     C                     MOVEL*BLANK    YN0208  3
      * Define null work field TH Unused Sts 7
     C                     MOVEL*BLANK    YN0209  3
      * Define null work field TH Unused Sts 8
     C                     MOVEL*BLANK    YN0210  1
      * Define null work field DF Defect Code
     C                     MOVEL*BLANK    YN0211  6
      * Define null work field THP Process Code
     C                     MOVEL*BLANK    YN0212  6
      * Define null work field RS User Changed
     C                     MOVEL*BLANK    YN0213 10
      * Define null work field RS Date Changed
     C                     Z-ADD*ZERO     YN0214  70
      * Define null work field RS Time Changed
     C                     Z-ADD*ZERO     YN0215  60
      * Define null work field RS Job
     C                     MOVEL*BLANK    YN0216 10
      * Define null work field RS Program
     C                     MOVEL*BLANK    YN0217 10
      * Define null work field RS User Added
     C                     MOVEL*BLANK    YN0218 10
      * Define null work field RS Date Added
     C                     Z-ADD*ZERO     YN0219  70
      * Define null work field RS Time Added
     C                     Z-ADD*ZERO     YN0220  60
      * Define local work field Net Amount           USR
     C                     Z-ADD*ZERO     YL0048  92
      * Define local work field Th Payment Net Amt
     C                     Z-ADD*ZERO     YL0049  72
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * Modification history
     C                     EXSR UASUBR                     Modification hi
      * Since this report only processes Hog Voucher Detail records where
      * the Source Code is TO, retrieve the Source Type that is associate
      * with the Triumph Owned Source Code.
     C                     MOVEL*BLANK    P1OTCD           VCD Source Code
     C                     MOVEL'TO'      P1OTCD           VCD Source Code
      * Rtv Source Type       RT - Source  * PAR.SR Type
     C                     EXSR SARVGN
      * Initally set the Continue Process flag to No
     C                     MOVEL'N'       P3VQST           Continue Proces
     C                     Z-ADD*ZERO     P4YTNB           @Count
      * 2/19/18 JH E12581 - Set error if Tattoo Header is not Balanced.
      * Upd Push TO Count Rcds RT - Hog Voucher Detail  * 
     C                     EXSR SBRVGN
      * Text to print if no records selected or no errors
      * CASE: LCL.Count of Eligible Records is Zero
     C           YL0001    IFEQ *ZERO                      *IF
     C                     Z-ADD*ZEROS    ZQ      50
     C           @CN,001   CAT  @CN,002:ZQ$BPYTX    P      Text 130 USR
     C                     Z-ADD1         ZQ      50
     C           $BPYTX    CAT  @CN,003:ZQ$BPYTX    P      Text 130 USR
     C                     Z-ADD*ZEROS    ZQ      50
     C           $BPYTX    CAT  @CN,004:ZQ$BPYTX    P      Text 130 USR
     C                     ELSE
      * CASE: LCL.Count of Errors Found is Zero
     C           YL0003    IFEQ *ZERO                      *IF
     C                     Z-ADD*ZEROS    ZQ      50
     C           @CN,005   CAT  @CN,006:ZQ$BPYTX    P      Text 130 USR
     C                     Z-ADD*ZEROS    ZQ      50
     C           $BPYTX    CAT  @CN,007:ZQ$BPYTX    P      Text 130 USR
     C                     Z-ADD*ZEROS    ZQ      50
     C           $BPYTX    CAT  @CN,008:ZQ$BPYTX    P      Text 130 USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'0'       YL0024           Print on Form
     C                     END                             *FI
     C                     END                             *FI
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 No Triumph Owned Hog Vouc
00002 her Detail records found
00003 that are in a status of R
00004 eady to Push.
00005 No errors found on the Tr
00006 iumph Owned Hog Voucher D
00007 etail records processed f
00008 or the payment push.
00009 Automatic
00010 Manual
