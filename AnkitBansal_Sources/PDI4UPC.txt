/*********************************************************************/
/*     Program: PDI4UPC                                              */
/*       Title: Print Lockbox Proof Report.                          */
/*        Date: 02/13/98                                             */
/* Description: - Override Printer File                              */
/*              - Call Report Program                                */
/*                                                                   */
/*  Parameters:                                                      */
/*  Usage   Field       Field Description                            */
/*  -----   ---------   ------------------------------------------   */
/*    I     &COMPANY    Company Number   - 4/6/05 NOT USED           */
/*    I     &LCKBOX     Lockbox Number                               */
/*    I     &DDATE      Deposit Date                                 */
/*    I     &OUTQ       Output Queue for Spool File                  */
/*    I     &HOLD       Hold Spool File (Yes/No)                     */
/*    I     &SAVE       Save Spool File (Yes/No)                     */
/*    I     &COPY       Number of Copies for Spool File              */
/*    I     &DDATE      Deposit TIME                                 */
/*                                                                   */
/*********************************************************************/
/* Modifications:                                                    */
/*                                                                   */
/*   Date     Pgmr     Description                                   */
/* -------- ---------- --------------------------------------------  */
/* 4/6/05   RMC        REMOVED CO AND ADDED DEPOSIT TIME TO KEY     */
/*********************************************************************/
             PGM  PARM(&LCKBOX &DDATE &DTIME &OUTQ &HOLD &SAVE &COPY)

   /*-------------------*/
   /* Declare Variables */
   /*-------------------*/

             /* Parameter Fields */
    /*       DCL  VAR(&COMPANY) TYPE(*CHAR) LEN(3)      */
             DCL  VAR(&LCKBOX)  TYPE(*CHAR) LEN(7)
             DCL  VAR(&DDATE)   TYPE(*CHAR) LEN(7)
             DCL  VAR(&DTIME)   TYPE(*CHAR) LEN(4)
             DCL  VAR(&OUTQ)    TYPE(*CHAR) LEN(10)
             DCL  VAR(&HOLD)    TYPE(*CHAR) LEN(4)
             DCL        VAR(&SAVE) TYPE(*CHAR) LEN(4) VALUE(*YES)
             DCL  VAR(&COPY)    TYPE(*CHAR) LEN(2)

             /* Internal Work Fields */
  /*         DCL  VAR(&CMPYN)   TYPE(*DEC)  LEN(3 0)   */
             DCL  VAR(&LCKBOXN) TYPE(*DEC)  LEN(7 0)
             DCL  VAR(&DDATEN)  TYPE(*DEC)  LEN(7 0)
             DCL  VAR(&DTIMEN)   TYPE(*DEC) LEN(4 0)
             DCL  VAR(&COPYN)   TYPE(*DEC)  LEN(2 0)
             DCL  VAR(&COMMAND) TYPE(*CHAR) LEN(512)

   /*-----------------------------*/
   /* Initialize & Load Variables */
   /*-----------------------------*/
  /*         CHGVAR VAR(&CMPYN)   VALUE(&COMPANY)    */
             CHGVAR VAR(&LCKBOXN) VALUE(&LCKBOX)
             CHGVAR VAR(&DDATEN)  VALUE(&DDATE)
             CHGVAR VAR(&DTIMEN)  VALUE(&DTIME)
             CHGVAR VAR(&COPYN)   VALUE(&COPY)

   /*-----------------------*/
   /* Override Printer File */
   /*-----------------------*/
             SBDPRTOVR CMDVAR(&COMMAND) +
                       FILE(PDI1PFR$) +
                       OUTQ(&OUTQ) +
                       COPIES(&COPYN) +
                       HOLD(&HOLD) +
                       SAVE(&SAVE)
             CALL PGM(QCMDEXC) PARM(&COMMAND 512)

   /*---------------------*/
   /* Call Report Program */
   /*---------------------*/
             CALL PGM(PDI1PFR) PARM(' ' &LCKBOXN &DDATEN &DTIMEN)

   /*----------------*/
   /* End of Program */
   /*----------------*/
ENDPGM:
            ENDPGM
