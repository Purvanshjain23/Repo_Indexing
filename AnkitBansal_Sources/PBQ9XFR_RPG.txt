     H/TITLE Build History file    XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJBADE
     H* Date          : 03/07/17  Time  : 15:56:09
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDJYREL3IF  E           K        DISK
      * RTV : Company Defaults Internal Plant Companies Only CO
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FCAB0RELCIF  E           K        DISK
      * RSQ : Item Balance              Co/Whse/Item
      *
     FCAB1RELAIF  E           K        DISK
      * RSQ : Item Balance Detail       Co/Item/Whse/Prod Date(D
      *
     FCAB1REL0IF  E           K        DISK
      * RTV : Item Balance Detail       Retrieval index       NV
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FOMBYREL1IF  E           K        DISK
      * RTV : Item Default              Retrieval index
      *
     FPOB5CPL4IF  E           K        DISK
      * RSQ : Order Detail Sched-Inv    Co/Itm/Whs/PDte(d)/Ord
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPBBZREL1IF  E           K        DISK
      * RTV : Item Age Invent History   Retrieval index
      *
     FPOB5CPL3IF  E           K        DISK
      * RSQ : Order Detail Sched-Inv    Co/Itm/Whs/PDte/Ord
      *
     FPBBZREL0IF  E           K        DISK                      A
      * UPD : Item Age Invent History   Update index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@JYREEY
      * Company Defaults Internal Plant Companies Only CO
      * Renamed input format fields
     I              JYAIC3                          WAAIC3
     I              JYZ9ST                          WAZ9ST
     I              JYCSST                          WACSST
     I              JYZ8ST                          WAZ8ST
     I              JYCXST                          WACXST
     I              JYSWST                          WASWST
     I              JYXXTM                          WAXXTM
     I              JYUECD                          WAUECD
     I              JYHSST                          WAHSST
     I              JYAMEO                          WAAMEO
     I              JYSSDF                          WASSDF
     I              JYPDFT                          WAPDFT
     I              JYYISX                          WAYISX
     I              JYYJSX                          WAYJSX
     I              JYYKSX                          WAYKSX
     I              JYYLSX                          WAYLSX
     I              JYYMSX                          WAYMSX
     I              JYYNSX                          WAYNSX
     I              JYUVST                          WAUVST
     I              JYUWST                          WAUWST
     I              JYUXST                          WAUXST
     I              JYVSST                          WAVSST
     I              JYAATM                          WAAATM
     I              JYAYNA                          WAAYNA
     I              JYA0NA                          WAA0NA
     I              JYAXDT                          WAAXDT
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WBAIC3
     I              KMV8CD                          WBV8CD
     I              KMAUNA                          WBAUNA
     I              KMI5ST                          WBI5ST
     I              KMBXTX                          WBBXTX
     I              KMM8NB                          WBM8NB
     I              KMUVST                          WBUVST
     I              KMUWST                          WBUWST
     I              KMUXST                          WBUXST
     I              KMVSST                          WBVSST
     I              KMAATM                          WBAATM
     I              KMAYNA                          WBAYNA
     I              KMA0NA                          WBA0NA
     I              KMAXDT                          WBAXDT
      *
     I@B0REHD
      * Item Balance              Co/Whse/Item
      * Renamed input format fields
     I              B0AIC3                          WCAIC3
     I              B0HGCD                          WCHGCD
     I              B0AJCD                          WCAJCD
     I              B0AGCS                          WCAGCS
     I              B0AECS                          WCAECS
     I              B0BACS                          WCBACS
     I              B0BBCS                          WCBBCS
     I              B0CBPR                          WCCBPR
     I              B0GUDT                          WCGUDT
     I              B0XYST                          WCXYST
     I              B0CTPR                          WCCTPR
     I              B0G4DT                          WCG4DT
     I              B0BOWG                          WCBOWG
     I              B0DDQT                          WCDDQT
     I              B0DEQT                          WCDEQT
     I              B0DFQT                          WCDFQT
     I              B0HDQT                          WCHDQT
     I              B0HEQT                          WCHEQT
     I              B0AJQT                          WCAJQT
     I              B0AQQT                          WCAQQT
     I              B0AUQT                          WCAUQT
     I              B0EMQT                          WCEMQT
     I              B0DOQT                          WCDOQT
     I              B0ATNA                          WCATNA
     I              B0AKDT                          WCAKDT
     I              B0ANDT                          WCANDT
     I              B0IDVA                          WCIDVA
     I              B0JVST                          WCJVST
     I              B0BZPC                          WCBZPC
     I              B0DGQT                          WCDGQT
     I              B0DIDT                          WCDIDT
     I              B0ALCD                          WCALCD
     I              B0BFDY                          WCBFDY
     I              B0DJDT                          WCDJDT
     I              B0BGDY                          WCBGDY
     I              B0DKDT                          WCDKDT
     I              B0J2ST                          WCJ2ST
     I              B0DJQT                          WCDJQT
     I              B0BNWG                          WCBNWG
     I              B0DLDT                          WCDLDT
     I              B0DPQT                          WCDPQT
     I              B0DQQT                          WCDQQT
     I              B0DMDT                          WCDMDT
     I              B0M0ST                          WCM0ST
     I              B0J9ST                          WCJ9ST
     I              B0KBST                          WCKBST
     I              B0AKC8                          WCAKC8
     I              B0RINB                          WCRINB
     I              B0RHNB                          WCRHNB
     I              B0RGNB                          WCRGNB
     I              B0UVST                          WCUVST
     I              B0UWST                          WCUWST
     I              B0UXST                          WCUXST
     I              B0VSST                          WCVSST
     I              B0AATM                          WCAATM
     I              B0AYNA                          WCAYNA
     I              B0A0NA                          WCA0NA
     I              B0AXDT                          WCAXDT
      *
     I@B1REIW
      * Item Balance Detail       Co/Item/Whse/Prod Date(D
      * Renamed input format fields
     I              B1AIC3                          WDAIC3
     I              B1HGCD                          WDHGCD
     I              B1AJCD                          WDAJCD
     I              B1ELDT                          WDELDT
     I              B1ABWG                          WDABWG
     I              B1AGQT                          WDAGQT
     I              B1AHQT                          WDAHQT
     I              B1AIQT                          WDAIQT
     I              B1CTST                          WDCTST
     I              B1ACWG                          WDACWG
     I              B1ARQT                          WDARQT
     I              B1ASQT                          WDASQT
     I              B1ATQT                          WDATQT
     I              B1HDQT                          WDHDQT
     I              B1HEQT                          WDHEQT
     I              B1F6ST                          WDF6ST
     I              B1BMWG                          WDBMWG
     I              B1DSQT                          WDDSQT
     I              B1DTQT                          WDDTQT
     I              B1DUQT                          WDDUQT
     I              B1DHDT                          WDDHDT
     I              B1AGCS                          WDAGCS
     I              B1AECS                          WDAECS
     I              B1IDVA                          WDIDVA
     I              B1K7DT                          WDK7DT
     I              B1RINB                          WDRINB
     I              B1RHNB                          WDRHNB
     I              B1RGNB                          WDRGNB
     I              B1UVST                          WDUVST
     I              B1UWST                          WDUWST
     I              B1UXST                          WDUXST
     I              B1VSST                          WDVSST
     I              B1AATM                          WDAATM
     I              B1AYNA                          WDAYNA
     I              B1A0NA                          WDA0NA
     I              B1AXDT                          WDAXDT
      *
     I@B1REJ0
      * Item Balance Detail       Retrieval index       NV
      * Renamed input format fields
     I              B1AIC3                          WEAIC3
     I              B1HGCD                          WEHGCD
     I              B1AJCD                          WEAJCD
     I              B1ELDT                          WEELDT
     I              B1ABWG                          WEABWG
     I              B1AGQT                          WEAGQT
     I              B1AHQT                          WEAHQT
     I              B1AIQT                          WEAIQT
     I              B1CTST                          WECTST
     I              B1ACWG                          WEACWG
     I              B1ARQT                          WEARQT
     I              B1ASQT                          WEASQT
     I              B1ATQT                          WEATQT
     I              B1HDQT                          WEHDQT
     I              B1HEQT                          WEHEQT
     I              B1F6ST                          WEF6ST
     I              B1BMWG                          WEBMWG
     I              B1DSQT                          WEDSQT
     I              B1DTQT                          WEDTQT
     I              B1DUQT                          WEDUQT
     I              B1DHDT                          WEDHDT
     I              B1AGCS                          WEAGCS
     I              B1AECS                          WEAECS
     I              B1IDVA                          WEIDVA
     I              B1K7DT                          WEK7DT
     I              B1RINB                          WERINB
     I              B1RHNB                          WERHNB
     I              B1RGNB                          WERGNB
     I              B1UVST                          WEUVST
     I              B1UWST                          WEUWST
     I              B1UXST                          WEUXST
     I              B1VSST                          WEVSST
     I              B1AATM                          WEAATM
     I              B1AYNA                          WEAYNA
     I              B1A0NA                          WEA0NA
     I              B1AXDT                          WEAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WFAIC3
     I              BZHGCD                          WFHGCD
     I              BZAVNA                          WFAVNA
     I              BZAWNA                          WFAWNA
     I              BZL7NA                          WFL7NA
     I              BZL8NA                          WFL8NA
     I              BZL6NA                          WFL6NA
     I              BZMFNA                          WFMFNA
     I              BZADCD                          WFADCD
     I              BZAWPC                          WFAWPC
     I              BZLXST                          WFLXST
     I              BZAECD                          WFAECD
     I              BZAXPC                          WFAXPC
     I              BZLYST                          WFLYST
     I              BZAFCD                          WFAFCD
     I              BZAICD                          WFAICD
     I              BZAIWG                          WFAIWG
     I              BZHICD                          WFHICD
     I              BZRBCD                          WFRBCD
     I              BZFZST                          WFFZST
     I              BZAVST                          WFAVST
     I              BZCZWG                          WFCZWG
     I              BZC0WG                          WFC0WG
     I              BZURTN                          WFURTN
     I              BZAJC8                          WFAJC8
     I              BZRINB                          WFRINB
     I              BZRHNB                          WFRHNB
     I              BZRGNB                          WFRGNB
     I              BZLNCD                          WFLNCD
     I              BZTFNB                          WFTFNB
     I              BZN0CD                          WFN0CD
     I              BZX4ST                          WFX4ST
     I              BZTMVA                          WFTMVA
     I              BZTNVA                          WFTNVA
     I              BZBLPR                          WFBLPR
     I              BZBMPR                          WFBMPR
     I              BZLRCD                          WFLRCD
     I              BZU9ST                          WFU9ST
     I              BZCMCO                          WFCMCO
     I              BZQ1CD                          WFQ1CD
     I              BZQ8CD                          WFQ8CD
     I              BZCHTM                          WFCHTM
     I              BZQZCD                          WFQZCD
     I              BZXWST                          WFXWST
     I              BZXXST                          WFXXST
     I              BZVMST                          WFVMST
     I              BZSWGH                          WFSWGH
     I              BZPPHE                          WFPPHE
     I              BZR3CD                          WFR3CD
     I              BZSDCD                          WFSDCD
     I              BZICN1                          WFICN1
     I              BZSVCD                          WFSVCD
     I              BZICN2                          WFICN2
     I              BZSWCD                          WFSWCD
     I              BZV2NB                          WFV2NB
     I              BZSXCD                          WFSXCD
     I              BZITCN                          WFITCN
     I              BZSYCD                          WFSYCD
     I              BZITC5                          WFITC5
     I              BZSZCD                          WFSZCD
     I              BZICN6                          WFICN6
     I              BZS0CD                          WFS0CD
     I              BZICN7                          WFICN7
     I              BZS1CD                          WFS1CD
     I              BZICN8                          WFICN8
     I              BZS2CD                          WFS2CD
     I              BZICN9                          WFICN9
     I              BZS3CD                          WFS3CD
     I              BZICN0                          WFICN0
     I              BZS4CD                          WFS4CD
     I              BZSFNB                          WFSFNB
     I              BZA3WG                          WFA3WG
     I              BZSJNB                          WFSJNB
     I              BZLLCD                          WFLLCD
     I              BZLMCD                          WFLMCD
     I              BZP3ST                          WFP3ST
     I              BZSKNB                          WFSKNB
     I              BZSLNB                          WFSLNB
     I              BZSMNB                          WFSMNB
     I              BZP4ST                          WFP4ST
     I              BZCFNB                          WFCFNB
     I              BZCGNB                          WFCGNB
     I              BZILNB                          WFILNB
     I              BZCHNB                          WFCHNB
     I              BZCINB                          WFCINB
     I              BZCJNB                          WFCJNB
     I              BZCMNB                          WFCMNB
     I              BZCNNB                          WFCNNB
     I              BZCRNB                          WFCRNB
     I              BZCSNB                          WFCSNB
     I              BZCVNB                          WFCVNB
     I              BZCWNB                          WFCWNB
     I              BZCXNB                          WFCXNB
     I              BZCZNB                          WFCZNB
     I              BZC0NB                          WFC0NB
     I              BZN1CD                          WFN1CD
     I              BZB4NB                          WFB4NB
     I              BZB5NB                          WFB5NB
     I              BZX5ST                          WFX5ST
     I              BZX6ST                          WFX6ST
     I              BZX7ST                          WFX7ST
     I              BZPCCT                          WFPCCT
     I              BZBDNB                          WFBDNB
     I              BZBJNB                          WFBJNB
     I              BZSUST                          WFSUST
     I              BZSVST                          WFSVST
     I              BZSYST                          WFSYST
     I              BZSZST                          WFSZST
     I              BZS1ST                          WFS1ST
     I              BZXRCD                          WFXRCD
     I              BZXTCD                          WFXTCD
     I              BZXUCD                          WFXUCD
     I              BZF5WG                          WFF5WG
     I              BZF6WG                          WFF6WG
     I              BZF7WG                          WFF7WG
     I              BZBLNB                          WFBLNB
     I              BZBNNB                          WFBNNB
     I              BZS2ST                          WFS2ST
     I              BZS4ST                          WFS4ST
     I              BZS5ST                          WFS5ST
     I              BZS6ST                          WFS6ST
     I              BZS8ST                          WFS8ST
     I              BZS9ST                          WFS9ST
     I              BZTCST                          WFTCST
     I              BZTDST                          WFTDST
     I              BZUVST                          WFUVST
     I              BZUWST                          WFUWST
     I              BZUXST                          WFUXST
     I              BZVSST                          WFVSST
     I              BZAATM                          WFAATM
     I              BZAYNA                          WFAYNA
     I              BZA0NA                          WFA0NA
     I              BZAXDT                          WFAXDT
      *
     I@BYREA1
      * Item Default              Retrieval index
      * Renamed input format fields
     I              BYHGCD                          WGHGCD
     I              BYAVNA                          WGAVNA
     I              BYAWNA                          WGAWNA
     I              BYL7NA                          WGL7NA
     I              BYL8NA                          WGL8NA
     I              BYL6NA                          WGL6NA
     I              BYMFNA                          WGMFNA
     I              BYHHCD                          WGHHCD
     I              BYAWPC                          WGAWPC
     I              BYLXST                          WGLXST
     I              BYLGCD                          WGLGCD
     I              BYAXPC                          WGAXPC
     I              BYLYST                          WGLYST
     I              BYLHCD                          WGLHCD
     I              BYLICD                          WGLICD
     I              BYAIWG                          WGAIWG
     I              BYHICD                          WGHICD
     I              BYRBCD                          WGRBCD
     I              BYFZST                          WGFZST
     I              BYAVST                          WGAVST
     I              BYCZWG                          WGCZWG
     I              BYC0WG                          WGC0WG
     I              BYURTN                          WGURTN
     I              BYACC8                          WGACC8
     I              BYRINB                          WGRINB
     I              BYRHNB                          WGRHNB
     I              BYRGNB                          WGRGNB
     I              BYLNCD                          WGLNCD
     I              BYTFNB                          WGTFNB
     I              BYN0CD                          WGN0CD
     I              BYX4ST                          WGX4ST
     I              BYCHTM                          WGCHTM
     I              BYQZCD                          WGQZCD
     I              BYXWST                          WGXWST
     I              BYXXST                          WGXXST
     I              BYVMST                          WGVMST
     I              BYSWGH                          WGSWGH
     I              BYPPHE                          WGPPHE
     I              BYLRCD                          WGLRCD
     I              BYSFNB                          WGSFNB
     I              BYA3WG                          WGA3WG
     I              BYSJNB                          WGSJNB
     I              BYLLCD                          WGLLCD
     I              BYLMCD                          WGLMCD
     I              BYP3ST                          WGP3ST
     I              BYSKNB                          WGSKNB
     I              BYSLNB                          WGSLNB
     I              BYSMNB                          WGSMNB
     I              BYP4ST                          WGP4ST
     I              BYCFNB                          WGCFNB
     I              BYCGNB                          WGCGNB
     I              BYILNB                          WGILNB
     I              BYCHNB                          WGCHNB
     I              BYCINB                          WGCINB
     I              BYCJNB                          WGCJNB
     I              BYCMNB                          WGCMNB
     I              BYCNNB                          WGCNNB
     I              BYCRNB                          WGCRNB
     I              BYCSNB                          WGCSNB
     I              BYCVNB                          WGCVNB
     I              BYCWNB                          WGCWNB
     I              BYCXNB                          WGCXNB
     I              BYCZNB                          WGCZNB
     I              BYC0NB                          WGC0NB
     I              BYN1CD                          WGN1CD
     I              BYB4NB                          WGB4NB
     I              BYX5ST                          WGX5ST
     I              BYX6ST                          WGX6ST
     I              BYX7ST                          WGX7ST
     I              BYTMVA                          WGTMVA
     I              BYTNVA                          WGTNVA
     I              BYBLPR                          WGBLPR
     I              BYBMPR                          WGBMPR
     I              BYU9ST                          WGU9ST
     I              BYCMCO                          WGCMCO
     I              BYQ1CD                          WGQ1CD
     I              BYAIC3                          WGAIC3
     I              BYQ8CD                          WGQ8CD
     I              BYR3CD                          WGR3CD
     I              BYSDCD                          WGSDCD
     I              BYICN1                          WGICN1
     I              BYSVCD                          WGSVCD
     I              BYICN2                          WGICN2
     I              BYSWCD                          WGSWCD
     I              BYV2NB                          WGV2NB
     I              BYSXCD                          WGSXCD
     I              BYITCN                          WGITCN
     I              BYSYCD                          WGSYCD
     I              BYITC5                          WGITC5
     I              BYSZCD                          WGSZCD
     I              BYICN6                          WGICN6
     I              BYS0CD                          WGS0CD
     I              BYICN7                          WGICN7
     I              BYS1CD                          WGS1CD
     I              BYICN8                          WGICN8
     I              BYS2CD                          WGS2CD
     I              BYICN9                          WGICN9
     I              BYS3CD                          WGS3CD
     I              BYICN0                          WGICN0
     I              BYS4CD                          WGS4CD
     I              BYB5NB                          WGB5NB
     I              BYXRCD                          WGXRCD
     I              BYPCCT                          WGPCCT
     I              BYBDNB                          WGBDNB
     I              BYBJNB                          WGBJNB
     I              BYSUST                          WGSUST
     I              BYSVST                          WGSVST
     I              BYSYST                          WGSYST
     I              BYSZST                          WGSZST
     I              BYS1ST                          WGS1ST
     I              BYXTCD                          WGXTCD
     I              BYXUCD                          WGXUCD
     I              BYF5WG                          WGF5WG
     I              BYF6WG                          WGF6WG
     I              BYF7WG                          WGF7WG
     I              BYBLNB                          WGBLNB
     I              BYBNNB                          WGBNNB
     I              BYS2ST                          WGS2ST
     I              BYS4ST                          WGS4ST
     I              BYS5ST                          WGS5ST
     I              BYS6ST                          WGS6ST
     I              BYS8ST                          WGS8ST
     I              BYS9ST                          WGS9ST
     I              BYTCST                          WGTCST
     I              BYTDST                          WGTDST
     I              BYUVST                          WGUVST
     I              BYUWST                          WGUWST
     I              BYUXST                          WGUXST
     I              BYVSST                          WGVSST
     I              BYAHTM                          WGAHTM
     I              BYBEVN                          WGBEVN
     I              BYBFVN                          WGBFVN
     I              BYEKDT                          WGEKDT
      *
     I@B5CPM5
      * Order Detail Sched-Inv    Co/Itm/Whs/PDte(d)/Ord
      * Renamed input format fields
     I              B5AIC3                          WHAIC3
     I              B5C4NB                          WHC4NB
     I              B5DPNB                          WHDPNB
     I              B5UENB                          WHUENB
     I              B5JGDT                          WHJGDT
     I              B5AODT                          WHAODT
     I              B5AJCD                          WHAJCD
     I              B5HGCD                          WHHGCD
     I              B5IUQT                          WHIUQT
     I              B5F3WG                          WHF3WG
     I              B5UVST                          WHUVST
     I              B5UWST                          WHUWST
     I              B5UXST                          WHUXST
     I              B5VSST                          WHVSST
     I              B5AATM                          WHAATM
     I              B5AYNA                          WHAYNA
     I              B5A0NA                          WHA0NA
     I              B5AXDT                          WHAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WIAIC3
     I              BEC4NB                          WIC4NB
     I              BEJNCD                          WIJNCD
     I              BEANC7                          WIANC7
     I              BEBKC7                          WIBKC7
     I              BEBRTX                          WIBRTX
     I              BEHMNA                          WIHMNA
     I              BEHONA                          WIHONA
     I              BEHPNA                          WIHPNA
     I              BEHNNA                          WIHNNA
     I              BEDBCD                          WIDBCD
     I              BECKTX                          WICKTX
     I              BEB0C7                          WIB0C7
     I              BEAETX                          WIAETX
     I              BEB1NA                          WIB1NA
     I              BEB3NA                          WIB3NA
     I              BEB4NA                          WIB4NA
     I              BEB2NA                          WIB2NA
     I              BEBHCD                          WIBHCD
     I              BEC8TX                          WIC8TX
     I              BEBCNA                          WIBCNA
     I              BEA0DT                          WIA0DT
     I              BEA5DT                          WIA5DT
     I              BEGNDT                          WIGNDT
     I              BEACDT                          WIACDT
     I              BEAQCD                          WIAQCD
     I              BEB6NA                          WIB6NA
     I              BEBYNA                          WIBYNA
     I              BEBZNA                          WIBZNA
     I              BEGTST                          WIGTST
     I              BEGVST                          WIGVST
     I              BEGUST                          WIGUST
     I              BEQFST                          WIQFST
     I              BECQCD                          WICQCD
     I              BEGJST                          WIGJST
     I              BEGWST                          WIGWST
     I              BEGXST                          WIGXST
     I              BEGYST                          WIGYST
     I              BEAODT                          WIAODT
     I              BEAIVN                          WIAIVN
     I              BECXDT                          WICXDT
     I              BEJZVA                          WIJZVA
     I              BEA1WG                          WIA1WG
     I              BEXIST                          WIXIST
     I              BEXJST                          WIXJST
     I              BEXKST                          WIXKST
     I              BEEIDT                          WIEIDT
     I              BEAFTM                          WIAFTM
     I              BEE8CD                          WIE8CD
     I              BEE9CD                          WIE9CD
     I              BERMNB                          WIRMNB
     I              BETBNB                          WITBNB
     I              BER1NB                          WIR1NB
     I              BEPJST                          WIPJST
     I              BEU0ST                          WIU0ST
     I              BEU1ST                          WIU1ST
     I              BEQ2CD                          WIQ2CD
     I              BEU2ST                          WIU2ST
     I              BEVEST                          WIVEST
     I              BEVFST                          WIVFST
     I              BEVGST                          WIVGST
     I              BERPCD                          WIRPCD
     I              BERNNB                          WIRNNB
     I              BEVDST                          WIVDST
     I              BEATIN                          WIATIN
     I              BEU4ST                          WIU4ST
     I              BEU5ST                          WIU5ST
     I              BERSRN                          WIRSRN
     I              BEMHNA                          WIMHNA
     I              BEMINA                          WIMINA
     I              BEWBST                          WIWBST
     I              BER4CD                          WIR4CD
     I              BEBFCD                          WIBFCD
     I              BEQ4CD                          WIQ4CD
     I              BET3NB                          WIT3NB
     I              BESICD                          WISICD
     I              BECONB                          WICONB
     I              BECEST                          WICEST
     I              BEAWDT                          WIAWDT
     I              BEJPCD                          WIJPCD
     I              BEXUST                          WIXUST
     I              BEZ1ST                          WIZ1ST
     I              BEVRVA                          WIVRVA
     I              BEOBST                          WIOBST
     I              BEBCST                          WIBCST
     I              BEBDST                          WIBDST
     I              BEB7VL                          WIB7VL
     I              BEGASX                          WIGASX
     I              BEGBSX                          WIGBSX
     I              BEGCSX                          WIGCSX
     I              BEGDSX                          WIGDSX
     I              BEFNSX                          WIFNSX
     I              BEFOSX                          WIFOSX
     I              BEFPSX                          WIFPSX
     I              BEFQSX                          WIFQSX
     I              BEFRSX                          WIFRSX
     I              BEFSSX                          WIFSSX
     I              BEFTSX                          WIFTSX
     I              BEFUSX                          WIFUSX
     I              BEFVSX                          WIFVSX
     I              BEFWSX                          WIFWSX
     I              BEFXSX                          WIFXSX
     I              BEFYSX                          WIFYSX
     I              BENODT                          WINODT
     I              BENPDT                          WINPDT
     I              BENQDT                          WINQDT
     I              BENRDT                          WINRDT
     I              BENSDT                          WINSDT
     I              BEBPTM                          WIBPTM
     I              BEBQTM                          WIBQTM
     I              BEBRTM                          WIBRTM
     I              BEBSTM                          WIBSTM
     I              BEBTTM                          WIBTTM
     I              BEH0NX                          WIH0NX
     I              BEH1NX                          WIH1NX
     I              BEH2NX                          WIH2NX
     I              BEH3NX                          WIH3NX
     I              BEH4NX                          WIH4NX
     I              BEC0C7                          WIC0C7
     I              BEUVST                          WIUVST
     I              BEUWST                          WIUWST
     I              BEUXST                          WIUXST
     I              BEAATM                          WIAATM
     I              BEAYNA                          WIAYNA
     I              BEA0NA                          WIA0NA
     I              BEAXDT                          WIAXDT
      *
     I@BZREUJ
      * Item Age Invent History   Retrieval index
      * Renamed input format fields
     I              BZAIC3                          WJAIC3
     I              BZAJCD                          WJAJCD
     I              BZHGCD                          WJHGCD
     I              BZVRDT                          WJVRDT
     I              BZELDT                          WJELDT
     I              BZGENA                          WJGENA
     I              BZRXQT                          WJRXQT
     I              BZADCD                          WJADCD
     I              BZVSST                          WJVSST
     I              BZMJDT                          WJMJDT
     I              BZBETM                          WJBETM
     I              BZCCVN                          WJCCVN
     I              BZCDVN                          WJCDVN
     I              BZMKDT                          WJMKDT
     I              BZBFTM                          WJBFTM
     I              BZCEVN                          WJCEVN
     I              BZCFVN                          WJCFVN
      *
     I@BZREUI
      * Item Age Invent History   Update index
      * Renamed input format fields
     I              BZAIC3                          WKAIC3
     I              BZAJCD                          WKAJCD
     I              BZHGCD                          WKHGCD
     I              BZVRDT                          WKVRDT
     I              BZELDT                          WKELDT
     I              BZGENA                          WKGENA
     I              BZRXQT                          WKRXQT
     I              BZADCD                          WKADCD
     I              BZVSST                          WKVSST
     I              BZMJDT                          WKMJDT
     I              BZBETM                          WKBETM
     I              BZCCVN                          WKCCVN
     I              BZCDVN                          WKCDVN
     I              BZMKDT                          WKMKDT
     I              BZBFTM                          WKBFTM
     I              BZCEVN                          WKCEVN
     I              BZCFVN                          WKCFVN
      *
     I@B5CPM4
      * Order Detail Sched-Inv    Co/Itm/Whs/PDte/Ord
      * Renamed input format fields
     I              B5AIC3                          WLAIC3
     I              B5C4NB                          WLC4NB
     I              B5DPNB                          WLDPNB
     I              B5UENB                          WLUENB
     I              B5JGDT                          WLJGDT
     I              B5AODT                          WLAODT
     I              B5AJCD                          WLAJCD
     I              B5HGCD                          WLHGCD
     I              B5IUQT                          WLIUQT
     I              B5F3WG                          WLF3WG
     I              B5UVST                          WLUVST
     I              B5UWST                          WLUWST
     I              B5UXST                          WLUXST
     I              B5VSST                          WLVSST
     I              B5AATM                          WLAATM
     I              B5AYNA                          WLAYNA
     I              B5A0NA                          WLA0NA
     I              B5AXDT                          WLAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPBBZ1    E DSPBBZREL0
      * UPD : Item Age Invent History   Update index
      * Renamed input format fields
     I              BZAIC3                          WKAIC3
     I              BZAJCD                          WKAJCD
     I              BZHGCD                          WKHGCD
     I              BZVRDT                          WKVRDT
     I              BZELDT                          WKELDT
     I              BZGENA                          WKGENA
     I              BZRXQT                          WKRXQT
     I              BZADCD                          WKADCD
     I              BZVSST                          WKVSST
     I              BZMJDT                          WKMJDT
     I              BZBETM                          WKBETM
     I              BZCCVN                          WKCCVN
     I              BZCDVN                          WKCDVN
     I              BZMKDT                          WKMKDT
     I              BZBFTM                          WKBFTM
     I              BZCEVN                          WKCEVN
     I              BZCFVN                          WKCFVN
      *
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Build History file    XF
      * Modification history
     C                     EXSR UASUBR                     Modification hi
      *  2/18/17 JBB E9064 - Old code replaced with reading all plant
      *                      company records
      * Bld Item Age Invent Hist - Company Defaults Internal  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Bld Item Age Invent Hist - Company Defaults Internal  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Modification history
     C                     EXSR UBSUBR                     Modification hi
      * Establish starting position
     C           *LOVAL    SETLL@JYREEY                    *
     C                     READ @JYREEY                  90*
      * Data record not found
     C   90                MOVEL'USR2025' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If Plant Company record is active, process the Company Number
      * CASE: DB1.Record Status is Active
     C           WAVSST    IFEQ 'A'                        *IF
      * RTV Alpha Value        RT - Company Values  * PFSWHSE
     C                     EXSR SBRVGN
      * RTV Bld Item Age Hist RT - Item Balance  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0001           Company Number
     C                     MOVELYL0001    WL0002    P      Warehouse Code
     C                     EXSR SCRVGN
     C                     END                             *FI
     C                     READ @JYREEY                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * PFSWHSE
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBV8CD           Company Value C
      * Setup key
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     MOVE *BLANK    WBV8CD           Company Value C
     C                     MOVEL'PFSWHSE' WBV8CD           Company Value C
      * Establish starting position
     C           KRSSB     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBBXTX    YL0001           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Bld Item Age Hist RT - Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Modification history
     C                     EXSR UCSUBR                     Modification hi
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCAJCD    WQSC02           Warehouse Code
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Warehouse Code
      * Setup key
     C                     Z-ADDWL0001    WQSC01           Company Number
     C                     MOVELWL0002    WQSC02           Warehouse Code
      * Establish starting position
     C           KRSSC     SETLL@B0REHD                    *
     C           KRSSC     READE@B0REHD                  90*
      * Data record not found
     C   90                MOVEL'USR0328' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Bld Age Quantity  RT - Item Balance Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0003           Company Number
     C                     Z-ADDWCHGCD    WL0004           Item Code
     C                     MOVELWCAJCD    WL0005    P      Warehouse Code
     C                     EXSR SDRVGN
     C           KRSSC     READE@B0REHD                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Bld Age Quantity  RT - Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       Production Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0001           Production Date
     C                     Z-ADD0         YL0002           Production Date
     C                     Z-ADD0         YL0003           Quantity Age Da
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSD01           Company Number
     C           *LIKE     DEFN WDHGCD    WQSD02           Item Code
     C           *LIKE     DEFN WDAJCD    WQSD03           Warehouse Code
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Item Code
     C                     KFLD           WQSD03           Warehouse Code
      * Setup key
     C                     Z-ADDWL0003    WQSD01           Company Number
     C                     Z-ADDWL0004    WQSD02           Item Code
     C                     MOVELWL0005    WQSD03           Warehouse Code
      * Establish starting position
     C           KRSSD     SETLL@B1REIW                    *
     C           KRSSD     READE@B1REIW                  90*
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Build History - Item Balance Detail  * 
     C                     EXSR SERVGN
     C           KRSSD     READE@B1REIW                  90*
     C                     ENDDO
      * USER: Exit processing
      * RTV Read all by item - Order Detail Sched-Inv  * 
     C                     EXSR SMRVGN
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Build History - Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         YL0004           Quantity Age Da
     C                     MOVEL'N'       YL0005           Include Todays
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
     C                     KFLD           WEELDT           Production Date
      * Setup key
     C                     Z-ADDWDAIC3    WEAIC3           Company Number
     C                     Z-ADDWDHGCD    WEHGCD           Item Code
     C                     MOVELWDAJCD    WEAJCD           Warehouse Code
     C                     Z-ADDWDELDT    WEELDT           Production Date
      * Establish starting position
     C           KRSSE     CHAIN@B1REJ0              90    *
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * If company is selected, rtv co/item else rtv item
      * CASE: DB1.Company Number is not equal to zero
     C           WEAIC3    IFNE 0                          *IF
      * Rtv Descriptions      RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0006           Company Number
     C                     Z-ADDWEHGCD    WL0007           Item Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    YL0006    P      Description Lin
     C                     MOVELWL0009    WUAWNA    P      Description Lin
     C                     MOVELWL0010    WUADCD    P      U/M - Primary
     C                     MOVELWL0011    WUAECD    P      U/M - Second
     C                     MOVELWL0012    WUAFCD    P      U/M - Third
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Item Descriptions  RT - Item Default  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEHGCD    WL0013           Item Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    YL0006    P      Description Lin
     C                     MOVELWL0015    WUAWNA    P      Description Lin
     C                     END                             *FI
      * Rtv Item Type Code     RT - Item Default  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEHGCD    WL0016           Item Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0017    YL0007    P      Item Type Code
      * Check record selection for include todays transactions
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Include Todays Trans is no
      *   |- c2    : JOB.*Job date EQ DB1.Production Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0005    IFEQ 'N'                        *IF
     C           ##JDT     IFEQ WEELDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       YL0008           Record Selected
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0008           Record Selected
     C                     END                             *FI
      * If record selected is yes then process
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Record Selected       USR is yes
      *   |- c2    : LCL.Item Type Code is Finished Goods
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0008    IFEQ 'Y'                        *IF
     C           YL0007    IFEQ 'FG'                       *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  WEARQT    YL0004           Quantity Age Da
     C                     END                             *FI
     C                     ENDIF
      * USER: Exit processing
      * RTV Build Non-Alloc   RT - Order Detail Sched-Inv  * 
     C                     EXSR SIRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * Build History file    IF
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Age Quantity is Greater than zero
      *   |- c2    : PAR.Age Quantity is Less than zero
      *   '-
     C           YL0004    IFGT 0                          *IF
     C           YL0004    ORLT 0                          *OR
      * RTV Build History     RT - Item Age Invent History  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0022           Company Number
     C                     MOVELWEAJCD    WL0023    P      Warehouse Code
     C                     Z-ADDWEHGCD    WL0024           Item Code
     C                     Z-ADD##JDT     WL0025           Archive Date
     C                     Z-ADDWEELDT    WL0026           Production Date
     C                     MOVELYL0006    WL0027    P      Item Descriptio
     C                     Z-ADDYL0004    WL0028           Age Quantity
     C                     MOVELWUADCD    WL0029    P      U/M - Primary
     C                     EXSR SKRVGN
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Descriptions      RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0006    WFAIC3           Company Number
     C                     Z-ADDWL0007    WFHGCD           Item Code
      * Establish starting position
     C           KRSSF     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFAVNA    WL0008           Description Lin
     C                     MOVELWFAWNA    WL0009           Description Lin
     C                     MOVELWFADCD    WL0010           U/M - Primary
     C                     MOVELWFAECD    WL0011           U/M - Second
     C                     MOVELWFAFCD    WL0012           U/M - Third
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Item Descriptions  RT - Item Default  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0013    WGHGCD           Item Code
      * Establish starting position
     C           KRSSG     CHAIN@BYREA1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1160' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0014           Description Lin
     C                     MOVEL*BLANK    WL0015           Description Lin
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGAVNA    WL0014           Description Lin
     C                     MOVELWGAWNA    WL0015           Description Lin
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Item Type Code     RT - Item Default  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WGHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0016    WGHGCD           Item Code
      * Establish starting position
     C           KRSSH     CHAIN@BYREA1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1160' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0017           Item Type Code
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGN0CD    WL0017           Item Type Code
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Build Non-Alloc   RT - Order Detail Sched-Inv  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         YL0009           Day 1 Sales USR
     C                     MOVEL'N'       YL0010           Include Todays
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSI01           Company Number
     C           *LIKE     DEFN WHHGCD    WQSI02           Item Code
     C           *LIKE     DEFN WHAJCD    WQSI03           Warehouse Code
     C           *LIKE     DEFN WHJGDT    WQSI04           OD Production D
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Item Code
     C                     KFLD           WQSI03           Warehouse Code
     C                     KFLD           WQSI04           OD Production D
      * Setup key
     C                     Z-ADDWEAIC3    WQSI01           Company Number
     C                     Z-ADDWEHGCD    WQSI02           Item Code
     C                     MOVELWEAJCD    WQSI03           Warehouse Code
     C                     Z-ADDWEELDT    WQSI04           OD Production D
      * Establish starting position
     C           KRSSI     SETLL@B5CPM5                    *
     C           KRSSI     READE@B5CPM5                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3150' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWHJGDT    YL0011           OD Production D
      * If company is selected, rtv co/item else rtv item
      * CASE: DB1.Company Number is not equal to zero
     C           WHAIC3    IFNE 0                          *IF
      * Rtv Descriptions      RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWHAIC3    WL0006           Company Number
     C                     Z-ADDWHHGCD    WL0007           Item Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    YL0012    P      Description Lin
     C                     MOVELWL0009    WUAWNA    P      Description Lin
     C                     MOVELWL0010    WUADCD    P      U/M - Primary
     C                     MOVELWL0011    WUAECD    P      U/M - Second
     C                     MOVELWL0012    WUAFCD    P      U/M - Third
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Item Descriptions  RT - Item Default  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWHHGCD    WL0013           Item Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    YL0012    P      Description Lin
     C                     MOVELWL0015    WUAWNA    P      Description Lin
     C                     END                             *FI
      * RTV Order Status       RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWHAIC3    WL0018           Company Number
     C                     Z-ADDWHC4NB    WL0019           Order Number
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0020    YL0013    P      Header Status
     C                     MOVELWL0021    YL0014    P      Header Status L
      * Rtv Item Type Code     RT - Item Default  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWHHGCD    WL0016           Item Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0017    YL0015    P      Item Type Code
     C                     MOVEL'Y'       YL0016           Record Selected
      * Check record selection for include todays transactions
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Include Todays Trans is no
      *   |- c2    : DB1.OD Production Date EQ JOB.*Job date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0010    IFEQ 'N'                        *IF
     C           WHJGDT    IFEQ ##JDT                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       YL0016           Record Selected
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0016           Record Selected
     C                     END                             *FI
      * CASE:
      *  - c1ANDc2ANDc3
      *   |- c1    : LCL.Header Status is Avail/Entered/Held
      *   |- c2    : LCL.Item Type Code is Finished Goods
      *   |- c3    : LCL.Record Selected       USR is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0013    IFEQ 'A'                        *IF
     C           YL0013    OREQ 'E'
     C           YL0013    OREQ 'H'
     C           YL0015    IFEQ 'FG'                       *IF
     C           YL0016    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  WHIUQT    YL0009           Day 1 Sales USR
     C                     END                             *FI
     C           KRSSI     READE@B5CPM5                  90*
     C                     ENDDO
      * USER: Exit processing
     C           YL0004    SUB  YL0009    YL0017           Quantity Age Da
      * Build History file    IF
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Age Quantity is Greater than zero
      *   |- c2    : PAR.Age Quantity is Less than zero
      *   '-
     C           YL0017    IFGT 0                          *IF
     C           YL0017    ORLT 0                          *OR
      * RTV Build History     RT - Item Age Invent History  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWHAIC3    WL0022           Company Number
     C                     MOVELWHAJCD    WL0023    P      Warehouse Code
     C                     Z-ADDWHHGCD    WL0024           Item Code
     C                     Z-ADD##JDT     WL0025           Archive Date
     C                     Z-ADDYL0011    WL0026           Production Date
     C                     MOVELYL0012    WL0027    P      Item Descriptio
     C                     Z-ADDYL0017    WL0028           Age Quantity
     C                     MOVELWUADCD    WL0029    P      U/M - Primary
     C                     EXSR SKRVGN
     C                     END                             *FI
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Order Status       RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0018    WIAIC3           Company Number
     C                     Z-ADDWL0019    WIC4NB           Order Number
      * Establish starting position
     C           KRSSJ     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIGWST    WL0020           Header Status
     C                     MOVELWIGXST    WL0021           Header Status L
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Build History     RT - Item Age Invent History  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJAJCD           Warehouse Code
     C                     KFLD           WJHGCD           Item Code
     C                     KFLD           WJVRDT           Archive Date
     C                     KFLD           WJELDT           Production Date
      * Setup key
     C                     Z-ADDWL0022    WJAIC3           Company Number
     C                     MOVELWL0023    WJAJCD           Warehouse Code
     C                     Z-ADDWL0024    WJHGCD           Item Code
     C                     Z-ADDWL0025    WJVRDT           Archive Date
     C                     Z-ADDWL0026    WJELDT           Production Date
      * Establish starting position
     C           KRSSK     CHAIN@BZREUJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4786' W0RTN   7
      * USER: Processing if Data record not found
      * Create Item Age Invent Hi - Item Age Invent History  * 
     C                     EXSR SLCRRC
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     GOTO SKEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCRRC    BEGSR
      *================================================================
      * Create Item Age Invent Hi - Item Age Invent History  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BZREUI
     C                     Z-ADDWL0022    WKAIC3           Company Number
     C                     MOVELWL0023    WKAJCD           Warehouse Code
     C                     Z-ADDWL0024    WKHGCD           Item Code
     C                     Z-ADDWL0025    WKVRDT           Archive Date
     C                     Z-ADDWL0026    WKELDT           Production Date
     C                     MOVELWL0027    WKGENA           Item Descriptio
     C                     Z-ADDWL0028    WKRXQT           Age Quantity
     C                     MOVELWL0029    WKADCD           U/M - Primary
     C                     MOVEL'A'       WKVSST           Record Status
     C                     Z-ADD##JDT     WKMJDT           Create Date
     C                     Z-ADD##JTM     WKBETM           Create Time
     C                     MOVEL##USR     WKCCVN           Create User
     C                     MOVEL##PGM     WKCDVN           Create Program
     C                     Z-ADD0         WKMKDT           Change Date
     C                     Z-ADD0         WKBFTM           Change Time
     C                     MOVEL*BLANK    WKCEVN           Change User
     C                     MOVEL*BLANK    WKCFVN           Change Program
      *
     C           KLCRSL    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKAJCD           Warehouse Code
     C                     KFLD           WKHGCD           Item Code
     C                     KFLD           WKVRDT           Archive Date
     C                     KFLD           WKELDT           Production Date
      * Check for duplicate primary key
     C           KLCRSL    SETLL@BZREUI                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR4787' W0RTN   7
      * Send message 'Item Age Invent Histor EX'
     C                     MOVEL'USR4787' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C                     WRITE@BZREUI                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Read all by item - Order Detail Sched-Inv  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLAIC3    WQSM01           Company Number
     C           *LIKE     DEFN WLHGCD    WQSM02           Item Code
     C           *LIKE     DEFN WLAJCD    WQSM03           Warehouse Code
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Item Code
     C                     KFLD           WQSM03           Warehouse Code
      * Setup key
     C                     Z-ADDWDAIC3    WQSM01           Company Number
     C                     Z-ADDWDHGCD    WQSM02           Item Code
     C                     MOVELWDAJCD    WQSM03           Warehouse Code
      * Establish starting position
     C           KRSSM     SETLL@B5CPM4                    *
     C           KRSSM     READE@B5CPM4                  90*
      * Data record not found
     C   90                MOVEL'USR3150' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * VAL Item Bal Dtl Exist RT - Item Balance Detail  * 
     C                     EXSR SNRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * RTV Build Non-Alloc2  RT - Order Detail Sched-Inv  * 
     C                     EXSR SORVGN
     C                     END                             *FI
     C           KRSSM     READE@B5CPM4                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * VAL Item Bal Dtl Exist RT - Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
     C                     KFLD           WEELDT           Production Date
      * Setup key
     C                     Z-ADDWLAIC3    WEAIC3           Company Number
     C                     Z-ADDWLHGCD    WEHGCD           Item Code
     C                     MOVELWLAJCD    WEAJCD           Warehouse Code
     C                     Z-ADDWLJGDT    WEELDT           Production Date
      * Establish starting position
     C           KRSSN     CHAIN@B1REJ0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0330' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Build Non-Alloc2  RT - Order Detail Sched-Inv  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         YL0018           Day 1 Sales USR
     C                     MOVEL'N'       YL0019           Include Todays
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSO01           Company Number
     C           *LIKE     DEFN WHHGCD    WQSO02           Item Code
     C           *LIKE     DEFN WHAJCD    WQSO03           Warehouse Code
     C           *LIKE     DEFN WHJGDT    WQSO04           OD Production D
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Company Number
     C                     KFLD           WQSO02           Item Code
     C                     KFLD           WQSO03           Warehouse Code
     C                     KFLD           WQSO04           OD Production D
      * Setup key
     C                     Z-ADDWLAIC3    WQSO01           Company Number
     C                     Z-ADDWLHGCD    WQSO02           Item Code
     C                     MOVELWLAJCD    WQSO03           Warehouse Code
     C                     Z-ADDWLJGDT    WQSO04           OD Production D
      * Establish starting position
     C           KRSSO     SETLL@B5CPM5                    *
     C           KRSSO     READE@B5CPM5                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3150' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWHJGDT    YL0020           OD Production D
      * If company is selected, rtv co/item else rtv item
      * CASE: DB1.Company Number is not equal to zero
     C           WHAIC3    IFNE 0                          *IF
      * Rtv Descriptions      RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWHAIC3    WL0006           Company Number
     C                     Z-ADDWHHGCD    WL0007           Item Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    YL0021    P      Description Lin
     C                     MOVELWL0009    WUAWNA    P      Description Lin
     C                     MOVELWL0010    WUADCD    P      U/M - Primary
     C                     MOVELWL0011    WUAECD    P      U/M - Second
     C                     MOVELWL0012    WUAFCD    P      U/M - Third
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Item Descriptions  RT - Item Default  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWHHGCD    WL0013           Item Code
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    YL0021    P      Description Lin
     C                     MOVELWL0015    WUAWNA    P      Description Lin
     C                     END                             *FI
      * RTV Order Status       RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWHAIC3    WL0018           Company Number
     C                     Z-ADDWHC4NB    WL0019           Order Number
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0020    YL0022    P      Header Status
     C                     MOVELWL0021    YL0023    P      Header Status L
      * Rtv Item Type Code     RT - Item Default  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWHHGCD    WL0016           Item Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0017    YL0024    P      Item Type Code
     C                     MOVEL'Y'       YL0025           Record Selected
      * Check record selection for include todays transactions
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Include Todays Trans is no
      *   |- c2    : DB1.OD Production Date EQ JOB.*Job date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0019    IFEQ 'N'                        *IF
     C           WHJGDT    IFEQ ##JDT                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       YL0025           Record Selected
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0025           Record Selected
     C                     END                             *FI
      * CASE:
      *  - c1ANDc2ANDc3
      *   |- c1    : LCL.Header Status is Avail/Entered/Held
      *   |- c2    : LCL.Item Type Code is Finished Goods
      *   |- c3    : LCL.Record Selected       USR is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0022    IFEQ 'A'                        *IF
     C           YL0022    OREQ 'E'
     C           YL0022    OREQ 'H'
     C           YL0024    IFEQ 'FG'                       *IF
     C           YL0025    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  WHIUQT    YL0018           Day 1 Sales USR
     C                     END                             *FI
     C           KRSSO     READE@B5CPM5                  90*
     C                     ENDDO
      * USER: Exit processing
      * Build History file    IF
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Age Quantity is Greater than zero
      *   |- c2    : PAR.Age Quantity is Less than zero
      *   '-
     C           YL0018    IFGT 0                          *IF
     C           YL0018    ORLT 0                          *OR
      * RTV Build History     RT - Item Age Invent History  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWHAIC3    WL0022           Company Number
     C                     MOVELWHAJCD    WL0023    P      Warehouse Code
     C                     Z-ADDWHHGCD    WL0024           Item Code
     C                     Z-ADD##JDT     WL0025           Archive Date
     C                     Z-ADDYL0020    WL0026           Production Date
     C                     MOVELYL0021    WL0027    P      Item Descriptio
     C                     Z-ADDYL0018    WL0028           Age Quantity
     C                     MOVELWUADCD    WL0029    P      U/M - Primary
     C                     EXSR SKRVGN
     C                     END                             *FI
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modification history
      *================================================================
      *  2/18/17 Brad Baden E9064 - Add company 440 processing
      *          This will be accomplished by removing the hard coding of
      *          company numbers, and replacing it with reading the
      *          Company Defaults Internal file for plant companies only.
      * ISCLYNC - 5/15/15 - This program is used to build history
      * for the Item age Inventory non-allocated.  It is run as part of
      * the job schedule with AGEINVT. Current job TFAGEDINV - runs at 5
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Modification history
      *================================================================
      *  2/18/17 Brad Baden E9064 - Add company 440 processing
      *          Process Item Balance file for each specific Company.
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Modification history
      *================================================================
      *  2/18/17 Brad Baden E9064 - Add company 440 processing
      *          Modified this RTVOBJ to restrict on Company Number,
      *          instead of reading all records.
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAXXTM           Departure Time
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBM8NB           System Value Nu
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WCAECS           Last Cost
     C                     Z-ADD*ZERO     WCBACS           Cost per Primar
     C                     Z-ADD*ZERO     WCBBCS           Cost per Pricin
     C                     Z-ADD*ZERO     WCCBPR           Revaluation Cos
     C                     Z-ADD*ZERO     WCGUDT           Revaluation Eff
     C                     Z-ADD*ZERO     WCCTPR           Last Revaluatio
     C                     Z-ADD*ZERO     WCG4DT           Last Revaluatio
     C                     Z-ADD*ZERO     WCBOWG           On Hand Weight
     C                     Z-ADD*ZERO     WCDDQT           On Hand U/M1 Su
     C                     Z-ADD*ZERO     WCDEQT           On Hand U/M2 Su
     C                     Z-ADD*ZERO     WCDFQT           On Hand U/M3 Su
     C                     Z-ADD*ZERO     WCHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WCHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WCAJQT           Quantity Schedu
     C                     Z-ADD*ZERO     WCAQQT           Quantity on Sal
     C                     Z-ADD*ZERO     WCAUQT           Quantity on Pur
     C                     Z-ADD*ZERO     WCEMQT           Quantity on Tra
     C                     Z-ADD*ZERO     WCDOQT           Quantity Avail.
     C                     Z-ADD*ZERO     WCAKDT           Date of Last Or
     C                     Z-ADD*ZERO     WCANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WCIDVA           Value of On Han
     C                     Z-ADD*ZERO     WCBZPC           Safety Allowanc
     C                     Z-ADD*ZERO     WCDGQT           Safety Allowanc
     C                     Z-ADD*ZERO     WCDIDT           Stock Out Date
     C                     Z-ADD*ZERO     WCBFDY           Lead Time - Las
     C                     Z-ADD*ZERO     WCDJDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WCBGDY           Lead Time - Nex
     C                     Z-ADD*ZERO     WCDKDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WCDJQT           Usage Qty per C
     C                     Z-ADD*ZERO     WCBNWG           Usage Weight pe
     C                     Z-ADD*ZERO     WCDLDT           Inventory Manag
     C                     Z-ADD*ZERO     WCDPQT           Minimum Quantit
     C                     Z-ADD*ZERO     WCDQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WCDMDT           Last Physical C
     C                     Z-ADD*ZERO     WCAKC8           Vendor - Item/W
     C                     Z-ADD*ZERO     WCRINB           Item Structure
     C                     Z-ADD*ZERO     WCRHNB           Item Structure
     C                     Z-ADD*ZERO     WCRGNB           Item Structure
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDELDT           Production Date
     C                     Z-ADD*ZERO     WDABWG           Physical Count
     C                     Z-ADD*ZERO     WDAGQT           Physical Count
     C                     Z-ADD*ZERO     WDAHQT           Physical Count
     C                     Z-ADD*ZERO     WDAIQT           Physical Count
     C                     Z-ADD*ZERO     WDACWG           Quantity on Han
     C                     Z-ADD*ZERO     WDARQT           Quantity on Han
     C                     Z-ADD*ZERO     WDASQT           Quantity on Han
     C                     Z-ADD*ZERO     WDATQT           Quantity on Han
     C                     Z-ADD*ZERO     WDHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WDHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WDBMWG           Physical Start
     C                     Z-ADD*ZERO     WDDSQT           Physical Start
     C                     Z-ADD*ZERO     WDDTQT           Physical Start
     C                     Z-ADD*ZERO     WDDUQT           Physical Start
     C                     Z-ADD*ZERO     WDDHDT           Physical Start
     C                     Z-ADD*ZERO     WDAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WDAECS           Last Cost
     C                     Z-ADD*ZERO     WDIDVA           Value of On Han
     C                     Z-ADD*ZERO     WDK7DT           Label Date
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Description Line Two
     C                     MOVEL*BLANK    WUAWNA 30
      * Define work field U/M - Primary
     C                     MOVEL*BLANK    WUADCD  2
      * Define work field U/M - Second
     C                     MOVEL*BLANK    WUAECD  2
      * Define work field U/M - Third
     C                     MOVEL*BLANK    WUAFCD  2
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WFAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WFAIWG           Unit Weight
     C                     Z-ADD*ZERO     WFCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WFC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WFURTN           Number Cases On
     C                     Z-ADD*ZERO     WFAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WFRINB           Item Structure
     C                     Z-ADD*ZERO     WFRHNB           Item Structure
     C                     Z-ADD*ZERO     WFRGNB           Item Structure
     C                     Z-ADD*ZERO     WFTFNB           Transportation
     C                     Z-ADD*ZERO     WFTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WFTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WFBLPR           Market Overage
     C                     Z-ADD*ZERO     WFBMPR           Standard Overag
     C                     Z-ADD*ZERO     WFCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WFCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WFSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WFPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WFICN1           Item Category N
     C                     Z-ADD*ZERO     WFICN2           Item Category N
     C                     Z-ADD*ZERO     WFV2NB           Item Category N
     C                     Z-ADD*ZERO     WFITCN           Item Category N
     C                     Z-ADD*ZERO     WFITC5           Item Category N
     C                     Z-ADD*ZERO     WFICN6           Item Category N
     C                     Z-ADD*ZERO     WFICN7           Item Category N
     C                     Z-ADD*ZERO     WFICN8           Item Category N
     C                     Z-ADD*ZERO     WFICN9           Item Category N
     C                     Z-ADD*ZERO     WFICN0           Item Category N
     C                     Z-ADD*ZERO     WFSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WFA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WFSJNB           Production Lead
     C                     Z-ADD*ZERO     WFSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WFSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WFSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WFCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WFCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WFILNB           Packages per ca
     C                     Z-ADD*ZERO     WFCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WFCINB           PM Batch Size
     C                     Z-ADD*ZERO     WFCJNB           Package Level s
     C                     Z-ADD*ZERO     WFCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WFCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WFCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WFCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WFCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WFCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WFCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WFCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WFC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WFB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WFB5NB           PM Line Number
     C                     Z-ADD*ZERO     WFBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WFBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WFF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WFF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WFF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WFBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WFBNNB           Production Qty
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WGAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WGAIWG           Unit Weight
     C                     Z-ADD*ZERO     WGCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WGC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WGURTN           Number Cases On
     C                     Z-ADD*ZERO     WGACC8           Vendor item Def
     C                     Z-ADD*ZERO     WGRINB           Item Structure
     C                     Z-ADD*ZERO     WGRHNB           Item Structure
     C                     Z-ADD*ZERO     WGRGNB           Item Structure
     C                     Z-ADD*ZERO     WGTFNB           Transportation
     C                     Z-ADD*ZERO     WGCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WGSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WGPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WGSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WGA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WGSJNB           Production Lead
     C                     Z-ADD*ZERO     WGSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WGSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WGSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WGCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WGCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WGILNB           Packages per ca
     C                     Z-ADD*ZERO     WGCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WGCINB           PM Batch Size
     C                     Z-ADD*ZERO     WGCJNB           Package Level s
     C                     Z-ADD*ZERO     WGCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WGCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WGCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WGCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WGCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WGCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WGCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WGCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WGC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WGB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WGTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WGTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WGBLPR           Market Overage
     C                     Z-ADD*ZERO     WGBMPR           Standard Overag
     C                     Z-ADD*ZERO     WGCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGICN1           Item Category N
     C                     Z-ADD*ZERO     WGICN2           Item Category N
     C                     Z-ADD*ZERO     WGV2NB           Item Category N
     C                     Z-ADD*ZERO     WGITCN           Item Category N
     C                     Z-ADD*ZERO     WGITC5           Item Category N
     C                     Z-ADD*ZERO     WGICN6           Item Category N
     C                     Z-ADD*ZERO     WGICN7           Item Category N
     C                     Z-ADD*ZERO     WGICN8           Item Category N
     C                     Z-ADD*ZERO     WGICN9           Item Category N
     C                     Z-ADD*ZERO     WGICN0           Item Category N
     C                     Z-ADD*ZERO     WGB5NB           PM Line Number
     C                     Z-ADD*ZERO     WGBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WGBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WGF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WGF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WGF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WGBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WGBNNB           Production Qty
     C                     Z-ADD*ZERO     WGAHTM           Job Time
     C                     Z-ADD*ZERO     WGEKDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHC4NB           Order Number
     C                     Z-ADD*ZERO     WHDPNB           Order Sequence
     C                     Z-ADD*ZERO     WHUENB           Order Secondary
     C                     Z-ADD*ZERO     WHJGDT           OD Production D
     C                     Z-ADD*ZERO     WHAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WHHGCD           Item Code
     C                     Z-ADD*ZERO     WHIUQT           OD Quantity Inv
     C                     Z-ADD*ZERO     WHF3WG           OD Weight Inv S
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIC4NB           Order Number
     C                     Z-ADD*ZERO     WIANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WIBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WIB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WIA0DT           Order Date
     C                     Z-ADD*ZERO     WIA5DT           Requested Ship
     C                     Z-ADD*ZERO     WIGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WIACDT           Cancel Date
     C                     Z-ADD*ZERO     WIAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WICXDT           Date of Origina
     C                     Z-ADD*ZERO     WIJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WIA1WG           Order Weight To
     C                     Z-ADD*ZERO     WIEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WIAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WIRMNB           Load ID
     C                     Z-ADD*ZERO     WITBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WIR1NB           Rated Freight
     C                     Z-ADD*ZERO     WIRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WIATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WIRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WIT3NB           Attach to Order
     C                     Z-ADD*ZERO     WICONB           Invoice Number
     C                     Z-ADD*ZERO     WIAWDT           Invoice Date
     C                     Z-ADD*ZERO     WIVRVA           A/R order Value
     C                     Z-ADD*ZERO     WIB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WINODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WINPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WINQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WINRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WINSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WIBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WIBQTM           Time of Origina
     C                     Z-ADD*ZERO     WIBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WIBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WIBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WIH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WIH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WIH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WIH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WIH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WIC0C7           Claim Number
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002  3
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  70
     C                     MOVEL*BLANK    WL0005  3
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  70
     C                     MOVEL*BLANK    WL0008 30
     C                     MOVEL*BLANK    WL0009 30
     C                     MOVEL*BLANK    WL0010  2
     C                     MOVEL*BLANK    WL0011  2
     C                     MOVEL*BLANK    WL0012  2
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0013  70
     C                     MOVEL*BLANK    WL0014 30
     C                     MOVEL*BLANK    WL0015 30
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0016  70
     C                     MOVEL*BLANK    WL0017  3
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0018  30
     C                     Z-ADD*ZERO     WL0019  70
     C                     MOVEL*BLANK    WL0020  1
     C                     MOVEL*BLANK    WL0021  1
      * Define local variables for subroutine SKRVGN.
     C                     Z-ADD*ZERO     WL0022  30
     C                     MOVEL*BLANK    WL0023  3
     C                     Z-ADD*ZERO     WL0024  70
     C                     Z-ADD*ZERO     WL0025  70
     C                     Z-ADD*ZERO     WL0026  70
     C                     MOVEL*BLANK    WL0027 30
     C                     Z-ADD*ZERO     WL0028 112
     C                     MOVEL*BLANK    WL0029  2
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0001  3
      * Define local work field Production Date USR
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field Quantity Age Day 1   USR
     C                     Z-ADD*ZERO     YL0003 112
      * Define local work field Quantity Age Day 1   USR
     C                     Z-ADD*ZERO     YL0004 112
      * Define local work field Include Todays Trans
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field Item Description
     C                     MOVEL*BLANK    YL0006 30
      * Define local work field Item Type Code
     C                     MOVEL*BLANK    YL0007  3
      * Define local work field Record Selected       USR
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field Day 1 Sales USR
     C                     Z-ADD*ZERO     YL0009  61
      * Define local work field Include Todays Trans
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field OD Production Date
     C                     Z-ADD*ZERO     YL0011  70
      * Define local work field Item Description
     C                     MOVEL*BLANK    YL0012 30
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0013  1
      * Define local work field Header Status Last
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field Item Type Code
     C                     MOVEL*BLANK    YL0015  3
      * Define local work field Record Selected       USR
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field Quantity Age Day 1   USR
     C                     Z-ADD*ZERO     YL0017 112
      * Define local work field Day 1 Sales USR
     C                     Z-ADD*ZERO     YL0018  61
      * Define local work field Include Todays Trans
     C                     MOVEL*BLANK    YL0019  1
      * Define local work field OD Production Date
     C                     Z-ADD*ZERO     YL0020  70
      * Define local work field Item Description
     C                     MOVEL*BLANK    YL0021 30
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0022  1
      * Define local work field Header Status Last
     C                     MOVEL*BLANK    YL0023  1
      * Define local work field Item Type Code
     C                     MOVEL*BLANK    YL0024  3
      * Define local work field Record Selected       USR
     C                     MOVEL*BLANK    YL0025  1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0005
