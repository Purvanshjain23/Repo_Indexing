     H/TITLE Edt Ttt Hdr (create)  PV  Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Prompt & validate record
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISELOUC
     H* Date          : 05/06/22  Time  : 16:58:11
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKO6PVR#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Edt Ttt Hdr (create)  PV  Prompt & validate record
      *
     FPKA1CPLAIF  E           K        DISK
      * RSQ : Tattoo Header             Co/Kill/Tattoo Active
      *
     FPKA1CPLIIF  E           K        DISK
      * RSQ : Tattoo Header             Co/Bol/Ttt
      *
     FPKFJCPL2IF  E           K        DISK
      * RTV : Tattoo Pending            Pending Tattoo
      *
     FPKFJCPL1IF  E           K        DISK
      * RTV : Tattoo Pending            Retrieval index
      *
     FPKAXCPL0IF  E           K        DISK
      * RTV : Buy Order Load            Retrieval index
      *
     FPKA7REL1IF  E           K        DISK
      * RTV : Hog Defect                Retrieval index
      *
     FPKCCREL0IF  E           K        DISK
      * RTV : Tattoo Header Process     Retrieval index
      *
     FPKAFREL0IF  E           K        DISK
      * RTV : Producer Location         Retrieval index
      *
     FPKADREL0IF  E           K        DISK
      * RTV : Hog Buyer                 Retrieval index
      *
     FPKAIREL0IF  E           K        DISK
      * RTV : Genetic                   Retrieval index
      *
     FPKA8REL1IF  E           K        DISK
      * RTV : Hog Classification        Retrieval index
      *
     FPKACREL1IF  E           K        DISK
      * RTV : Producer                  Retrieval index
      *
     FPKAAREL0IF  E           K        DISK
      * RTV : Source                    Retrieval index
      *
     FPKFJCPL0UF  E           K        DISK
      * UPD : Tattoo Pending            Update index
      *
      * DETAIL Screen: Field position and name array
     E                    W0BEG   7 011  5 0A
     E                    W0END   7 011  5 0A
     E                    W0NAM   7 011 10
      * Long constants
     E                    @CN#    1  03  6   @CN    25
     I@A1CPL0
      * Tattoo Header             Co/Kill/Tattoo Active
      * Renamed input format fields
     I              A1HMNB                          WAHMNB
     I              A1BNNB                          WABNNB
     I              A1BONB                          WABONB
     I              A1CVNB                          WACVNB
     I              A1B0DT                          WAB0DT
     I              A1AWDT                          WAAWDT
     I              A1BICD                          WABICD
     I              A1CPST                          WACPST
     I              A1ACPR                          WAACPR
     I              A1B9PR                          WAB9PR
     I              A1CAPR                          WACAPR
     I              A1C4ST                          WAC4ST
     I              A1AIPR                          WAAIPR
     I              A1A6DT                          WAA6DT
     I              A1C2ST                          WAC2ST
     I              A1CXNB                          WACXNB
     I              A1CWNB                          WACWNB
     I              A1FCNB                          WAFCNB
     I              A1H9NB                          WAH9NB
     I              A1FDNB                          WAFDNB
     I              A1FENB                          WAFENB
     I              A1HENB                          WAHENB
     I              A1HFNB                          WAHFNB
     I              A1CYNB                          WACYNB
     I              A1LRNB                          WALRNB
     I              A1E0NB                          WAE0NB
     I              A1A5PC                          WAA5PC
     I              A1FBNB                          WAFBNB
     I              A1A4PC                          WAA4PC
     I              A1F7NB                          WAF7NB
     I              A1HDNB                          WAHDNB
     I              A1F5NB                          WAF5NB
     I              A1F4NB                          WAF4NB
     I              A1F3NB                          WAF3NB
     I              A1F2NB                          WAF2NB
     I              A1AVPC                          WAAVPC
     I              A1AWPC                          WAAWPC
     I              A1CWPC                          WACWPC
     I              A1A8PC                          WAA8PC
     I              A1A7PC                          WAA7PC
     I              A1B8PR                          WAB8PR
     I              A1AMPR                          WAAMPR
     I              A1ANPR                          WAANPR
     I              A1AYVA                          WAAYVA
     I              A1AWVA                          WAAWVA
     I              A1AOPR                          WAAOPR
     I              A1AXVA                          WAAXVA
     I              A1APPR                          WAAPPR
     I              A1ASPR                          WAASPR
     I              A1A4VA                          WAA4VA
     I              A1ATPR                          WAATPR
     I              A1A5VA                          WAA5VA
     I              A1CBPR                          WACBPR
     I              A1CCPR                          WACCPR
     I              A1LPNB                          WALPNB
     I              A1CDPR                          WACDPR
     I              A1A7VA                          WAA7VA
     I              A1A2PR                          WAA2PR
     I              A1JWST                          WAJWST
     I              A1CWST                          WACWST
     I              A1D7ST                          WAD7ST
     I              A1D8ST                          WAD8ST
     I              A1DWST                          WADWST
     I              A1D6ST                          WAD6ST
     I              A1GHNB                          WAGHNB
     I              A1BYDT                          WABYDT
     I              A1E0ST                          WAE0ST
     I              A1E1ST                          WAE1ST
     I              A1E2ST                          WAE2ST
     I              A1BSDT                          WABSDT
     I              A1BTDT                          WABTDT
     I              A1BUDT                          WABUDT
     I              A1HGNB                          WAHGNB
     I              A1HHNB                          WAHHNB
     I              A1HINB                          WAHINB
     I              A1A3PR                          WAA3PR
     I              A1A4PR                          WAA4PR
     I              A1A6PR                          WAA6PR
     I              A1J9NB                          WAJ9NB
     I              A1D6PR                          WAD6PR
     I              A1D7PR                          WAD7PR
     I              A1D8PR                          WAD8PR
     I              A1D9PR                          WAD9PR
     I              A1EAPR                          WAEAPR
     I              A1EBPR                          WAEBPR
     I              A1ECPR                          WAECPR
     I              A1EDPR                          WAEDPR
     I              A1EEPR                          WAEEPR
     I              A1EFPR                          WAEFPR
     I              A1EGPR                          WAEGPR
     I              A1EHPR                          WAEHPR
     I              A1KAST                          WAKAST
     I              A1J7ST                          WAJ7ST
     I              A1J9ST                          WAJ9ST
     I              A1OXNB                          WAOXNB
     I              A1LKST                          WALKST
     I              A1LLST                          WALLST
     I              A1J8ST                          WAJ8ST
     I              A1LIST                          WALIST
     I              A1LJST                          WALJST
     I              A1NZTX                          WANZTX
     I              A1HJCD                          WAHJCD
     I              A1R4ST                          WAR4ST
     I              A1R5ST                          WAR5ST
     I              A1R6ST                          WAR6ST
     I              A1R7ST                          WAR7ST
     I              A1THWT                          WATHWT
     I              A1T2WT                          WAT2WT
     I              A1THHD                          WATHHD
     I              A1T2HD                          WAT2HD
     I              A1OBPR                          WAOBPR
     I              A1KOER                          WAKOER
     I              A1OPIR                          WAOPIR
     I              A1OPEM                          WAOPEM
     I              A1IORP                          WAIORP
     I              A1OWEO                          WAOWEO
     I              A1OQET                          WAOQET
     I              A1URST                          WAURST
     I              A1USST                          WAUSST
     I              A1HHPC                          WAHHPC
     I              A1S9PR                          WAS9PR
     I              A1TAPR                          WATAPR
     I              A1TBPR                          WATBPR
     I              A1JFUR                          WAJFUR
     I              A1KRIF                          WAKRIF
     I              A1KORF                          WAKORF
     I              A1KAPR                          WAKAPR
     I              A1KROT                          WAKROT
     I              A1OTJG                          WAOTJG
     I              A1IRJG                          WAIRJG
     I              A1IMJF                          WAIMJF
     I              A1IRGF                          WAIRGF
     I              A1KRJF                          WAKRJF
     I              A1OJRF                          WAOJRF
     I              A1KFOR                          WAKFOR
     I              A1ORJK                          WAORJK
     I              A1OMVJ                          WAOMVJ
     I              A1MVNF                          WAMVNF
     I              A1MCNF                          WAMCNF
     I              A1NCNF                          WANCNF
     I              A1NCHF                          WANCHF
     I              A1IGIR                          WAIGIR
     I              A1KFJR                          WAKFJR
     I              A1EADT                          WAEADT
     I              A1EBDT                          WAEBDT
     I              A1ECDT                          WAECDT
     I              A1EDDT                          WAEDDT
     I              A1EEDT                          WAEEDT
     I              A1U4ST                          WAU4ST
     I              A1U5ST                          WAU5ST
     I              A1U6ST                          WAU6ST
     I              A1U7ST                          WAU7ST
     I              A1U8ST                          WAU8ST
     I              A1U9ST                          WAU9ST
     I              A1VAST                          WAVAST
     I              A1VBST                          WAVBST
     I              A1BDCD                          WABDCD
     I              A1CSCD                          WACSCD
     I              A1ABCD                          WAABCD
     I              A1AECD                          WAAECD
     I              A1ACCD                          WAACCD
     I              A1AGCD                          WAAGCD
     I              A1BECD                          WABECD
     I              A1AAVN                          WAAAVN
     I              A1AADT                          WAAADT
     I              A1AMTM                          WAAMTM
     I              A1AJST                          WAAJST
     I              A1AHVN                          WAAHVN
     I              A1AGVN                          WAAGVN
     I              A1ABVN                          WAABVN
     I              A1ABDT                          WAABDT
     I              A1ABTM                          WAABTM
      *
     I@A1CPOI
      * Tattoo Header             Co/Bol/Ttt
      * Renamed input format fields
     I              A1HMNB                          WBHMNB
     I              A1BNNB                          WBBNNB
     I              A1BONB                          WBBONB
     I              A1CVNB                          WBCVNB
     I              A1B0DT                          WBB0DT
     I              A1AWDT                          WBAWDT
     I              A1BICD                          WBBICD
     I              A1CPST                          WBCPST
     I              A1ACPR                          WBACPR
     I              A1B9PR                          WBB9PR
     I              A1CAPR                          WBCAPR
     I              A1C4ST                          WBC4ST
     I              A1AIPR                          WBAIPR
     I              A1A6DT                          WBA6DT
     I              A1C2ST                          WBC2ST
     I              A1CXNB                          WBCXNB
     I              A1CWNB                          WBCWNB
     I              A1FCNB                          WBFCNB
     I              A1H9NB                          WBH9NB
     I              A1FDNB                          WBFDNB
     I              A1FENB                          WBFENB
     I              A1HENB                          WBHENB
     I              A1HFNB                          WBHFNB
     I              A1CYNB                          WBCYNB
     I              A1LRNB                          WBLRNB
     I              A1E0NB                          WBE0NB
     I              A1A5PC                          WBA5PC
     I              A1FBNB                          WBFBNB
     I              A1A4PC                          WBA4PC
     I              A1F7NB                          WBF7NB
     I              A1HDNB                          WBHDNB
     I              A1F5NB                          WBF5NB
     I              A1F4NB                          WBF4NB
     I              A1F3NB                          WBF3NB
     I              A1F2NB                          WBF2NB
     I              A1AVPC                          WBAVPC
     I              A1AWPC                          WBAWPC
     I              A1CWPC                          WBCWPC
     I              A1A8PC                          WBA8PC
     I              A1A7PC                          WBA7PC
     I              A1B8PR                          WBB8PR
     I              A1AMPR                          WBAMPR
     I              A1ANPR                          WBANPR
     I              A1AYVA                          WBAYVA
     I              A1AWVA                          WBAWVA
     I              A1AOPR                          WBAOPR
     I              A1AXVA                          WBAXVA
     I              A1APPR                          WBAPPR
     I              A1ASPR                          WBASPR
     I              A1A4VA                          WBA4VA
     I              A1ATPR                          WBATPR
     I              A1A5VA                          WBA5VA
     I              A1CBPR                          WBCBPR
     I              A1CCPR                          WBCCPR
     I              A1LPNB                          WBLPNB
     I              A1CDPR                          WBCDPR
     I              A1A7VA                          WBA7VA
     I              A1A2PR                          WBA2PR
     I              A1JWST                          WBJWST
     I              A1CWST                          WBCWST
     I              A1D7ST                          WBD7ST
     I              A1D8ST                          WBD8ST
     I              A1DWST                          WBDWST
     I              A1D6ST                          WBD6ST
     I              A1GHNB                          WBGHNB
     I              A1BYDT                          WBBYDT
     I              A1E0ST                          WBE0ST
     I              A1E1ST                          WBE1ST
     I              A1E2ST                          WBE2ST
     I              A1BSDT                          WBBSDT
     I              A1BTDT                          WBBTDT
     I              A1BUDT                          WBBUDT
     I              A1HGNB                          WBHGNB
     I              A1HHNB                          WBHHNB
     I              A1HINB                          WBHINB
     I              A1A3PR                          WBA3PR
     I              A1A4PR                          WBA4PR
     I              A1A6PR                          WBA6PR
     I              A1J9NB                          WBJ9NB
     I              A1D6PR                          WBD6PR
     I              A1D7PR                          WBD7PR
     I              A1D8PR                          WBD8PR
     I              A1D9PR                          WBD9PR
     I              A1EAPR                          WBEAPR
     I              A1EBPR                          WBEBPR
     I              A1ECPR                          WBECPR
     I              A1EDPR                          WBEDPR
     I              A1EEPR                          WBEEPR
     I              A1EFPR                          WBEFPR
     I              A1EGPR                          WBEGPR
     I              A1EHPR                          WBEHPR
     I              A1KAST                          WBKAST
     I              A1J7ST                          WBJ7ST
     I              A1J9ST                          WBJ9ST
     I              A1OXNB                          WBOXNB
     I              A1LKST                          WBLKST
     I              A1LLST                          WBLLST
     I              A1J8ST                          WBJ8ST
     I              A1LIST                          WBLIST
     I              A1LJST                          WBLJST
     I              A1NZTX                          WBNZTX
     I              A1HJCD                          WBHJCD
     I              A1R4ST                          WBR4ST
     I              A1R5ST                          WBR5ST
     I              A1R6ST                          WBR6ST
     I              A1R7ST                          WBR7ST
     I              A1THWT                          WBTHWT
     I              A1T2WT                          WBT2WT
     I              A1THHD                          WBTHHD
     I              A1T2HD                          WBT2HD
     I              A1OBPR                          WBOBPR
     I              A1KOER                          WBKOER
     I              A1OPIR                          WBOPIR
     I              A1OPEM                          WBOPEM
     I              A1IORP                          WBIORP
     I              A1OWEO                          WBOWEO
     I              A1OQET                          WBOQET
     I              A1URST                          WBURST
     I              A1USST                          WBUSST
     I              A1HHPC                          WBHHPC
     I              A1S9PR                          WBS9PR
     I              A1TAPR                          WBTAPR
     I              A1TBPR                          WBTBPR
     I              A1JFUR                          WBJFUR
     I              A1KRIF                          WBKRIF
     I              A1KORF                          WBKORF
     I              A1KAPR                          WBKAPR
     I              A1KROT                          WBKROT
     I              A1OTJG                          WBOTJG
     I              A1IRJG                          WBIRJG
     I              A1IMJF                          WBIMJF
     I              A1IRGF                          WBIRGF
     I              A1KRJF                          WBKRJF
     I              A1OJRF                          WBOJRF
     I              A1KFOR                          WBKFOR
     I              A1ORJK                          WBORJK
     I              A1OMVJ                          WBOMVJ
     I              A1MVNF                          WBMVNF
     I              A1MCNF                          WBMCNF
     I              A1NCNF                          WBNCNF
     I              A1NCHF                          WBNCHF
     I              A1IGIR                          WBIGIR
     I              A1KFJR                          WBKFJR
     I              A1EADT                          WBEADT
     I              A1EBDT                          WBEBDT
     I              A1ECDT                          WBECDT
     I              A1EDDT                          WBEDDT
     I              A1EEDT                          WBEEDT
     I              A1U4ST                          WBU4ST
     I              A1U5ST                          WBU5ST
     I              A1U6ST                          WBU6ST
     I              A1U7ST                          WBU7ST
     I              A1U8ST                          WBU8ST
     I              A1U9ST                          WBU9ST
     I              A1VAST                          WBVAST
     I              A1VBST                          WBVBST
     I              A1BDCD                          WBBDCD
     I              A1CSCD                          WBCSCD
     I              A1ABCD                          WBABCD
     I              A1AECD                          WBAECD
     I              A1ACCD                          WBACCD
     I              A1AGCD                          WBAGCD
     I              A1BECD                          WBBECD
     I              A1AAVN                          WBAAVN
     I              A1AADT                          WBAADT
     I              A1AMTM                          WBAMTM
     I              A1AJST                          WBAJST
     I              A1AHVN                          WBAHVN
     I              A1AGVN                          WBAGVN
     I              A1ABVN                          WBABVN
     I              A1ABDT                          WBABDT
     I              A1ABTM                          WBABTM
      *
     I@FJCPH0
      * Tattoo Pending            Pending Tattoo
      * Renamed input format fields
     I              FJHONB                          WCHONB
     I              FJEZDT                          WCEZDT
     I              FJHSA1                          WCHSA1
     I              FJHMNB                          WCHMNB
     I              FJBNNB                          WCBNNB
     I              FJBONB                          WCBONB
     I              FJHRA1                          WCHRA1
     I              FJBKTM                          WCBKTM
     I              FJWPST                          WCWPST
     I              FJWQST                          WCWQST
     I              FJMIA1                          WCMIA1
     I              FJAAVN                          WCAAVN
     I              FJAADT                          WCAADT
     I              FJAMTM                          WCAMTM
     I              FJAJST                          WCAJST
     I              FJAHVN                          WCAHVN
     I              FJAGVN                          WCAGVN
     I              FJABVN                          WCABVN
     I              FJABDT                          WCABDT
     I              FJABTM                          WCABTM
      *
     I@FJCPHW
      * Tattoo Pending            Retrieval index
      * Renamed input format fields
     I              FJHONB                          WDHONB
     I              FJEZDT                          WDEZDT
     I              FJHSA1                          WDHSA1
     I              FJHMNB                          WDHMNB
     I              FJBNNB                          WDBNNB
     I              FJBONB                          WDBONB
     I              FJHRA1                          WDHRA1
     I              FJBKTM                          WDBKTM
     I              FJWPST                          WDWPST
     I              FJWQST                          WDWQST
     I              FJMIA1                          WDMIA1
     I              FJAAVN                          WDAAVN
     I              FJAADT                          WDAADT
     I              FJAMTM                          WDAMTM
     I              FJAJST                          WDAJST
     I              FJAHVN                          WDAHVN
     I              FJAGVN                          WDAGVN
     I              FJABVN                          WDABVN
     I              FJABDT                          WDABDT
     I              FJABTM                          WDABTM
      *
     I@FJCPHV
      * Tattoo Pending            Update index
      * Renamed input format fields
     I              FJHONB                          WEHONB
     I              FJEZDT                          WEEZDT
     I              FJHSA1                          WEHSA1
     I              FJHMNB                          WEHMNB
     I              FJBNNB                          WEBNNB
     I              FJBONB                          WEBONB
     I              FJHRA1                          WEHRA1
     I              FJBKTM                          WEBKTM
     I              FJWPST                          WEWPST
     I              FJWQST                          WEWQST
     I              FJMIA1                          WEMIA1
     I              FJAAVN                          WEAAVN
     I              FJAADT                          WEAADT
     I              FJAMTM                          WEAMTM
     I              FJAJST                          WEAJST
     I              FJAHVN                          WEAHVN
     I              FJAGVN                          WEAGVN
     I              FJABVN                          WEABVN
     I              FJABDT                          WEABDT
     I              FJABTM                          WEABTM
      *
     I@AXCPBX
      * Buy Order Load            Retrieval index
      * Renamed input format fields
     I              AXHMNB                          WFHMNB
     I              AXBNNB                          WFBNNB
     I              AXBONB                          WFBONB
     I              AXCQDT                          WFCQDT
     I              AXABTH                          WFABTH
     I              AXACTH                          WFACTH
     I              AXBPNB                          WFBPNB
     I              AXCSNB                          WFCSNB
     I              AXAUDT                          WFAUDT
     I              AXCMST                          WFCMST
     I              AXAGPR                          WFAGPR
     I              AXATVA                          WFATVA
     I              AXI1ST                          WFI1ST
     I              AXDHNB                          WFDHNB
     I              AXDINB                          WFDINB
     I              AXCNST                          WFCNST
     I              AXGINB                          WFGINB
     I              AXBZDT                          WFBZDT
     I              AXLSNB                          WFLSNB
     I              AXF3TX                          WFF3TX
     I              AXO8ST                          WFO8ST
     I              AXO9ST                          WFO9ST
     I              AXPAST                          WFPAST
     I              AXLDSH                          WFLDSH
     I              AXPBST                          WFPBST
     I              AXPCST                          WFPCST
     I              AXPDST                          WFPDST
     I              AXUWST                          WFUWST
     I              AXUXST                          WFUXST
     I              AXUYST                          WFUYST
     I              AXJKRU                          WFJKRU
     I              AXKEOR                          WFKEOR
     I              AXIOEW                          WFIOEW
     I              AXKJIO                          WFKJIO
     I              AXIOJR                          WFIOJR
     I              AXEIRR                          WFEIRR
     I              AXITMF                          WFITMF
     I              AXODJE                          WFODJE
     I              AXRJIF                          WFRJIF
     I              AXOEJF                          WFOEJF
     I              AXD0DT                          WFD0DT
     I              AXD1DT                          WFD1DT
     I              AXD2DT                          WFD2DT
     I              AXD3DT                          WFD3DT
     I              AXD4DT                          WFD4DT
     I              AXBNCD                          WFBNCD
     I              AXABCD                          WFABCD
     I              AXAECD                          WFAECD
     I              AXAAVN                          WFAAVN
     I              AXAADT                          WFAADT
     I              AXAMTM                          WFAMTM
     I              AXAJST                          WFAJST
     I              AXAHVN                          WFAHVN
     I              AXAGVN                          WFAGVN
     I              AXABVN                          WFABVN
     I              AXABDT                          WFABDT
     I              AXABTM                          WFABTM
      *
     I@A7REC1
      * Hog Defect                Retrieval index
      * Renamed input format fields
     I              A7BDCD                          WGBDCD
     I              A7BCTX                          WGBCTX
     I              A7RXST                          WGRXST
     I              A7R2ST                          WGR2ST
     I              A7RYST                          WGRYST
     I              A7RZST                          WGRZST
     I              A7R0ST                          WGR0ST
     I              A7R1ST                          WGR1ST
     I              A7HYCD                          WGHYCD
     I              A7HZCD                          WGHZCD
     I              A7VYST                          WGVYST
     I              A7AEA1                          WGAEA1
     I              A7UOPR                          WGUOPR
     I              A7UPPR                          WGUPPR
     I              A7UQPR                          WGUQPR
     I              A7AAVN                          WGAAVN
     I              A7AADT                          WGAADT
     I              A7AMTM                          WGAMTM
     I              A7AJST                          WGAJST
     I              A7AHVN                          WGAHVN
     I              A7AGVN                          WGAGVN
     I              A7ABVN                          WGABVN
     I              A7ABDT                          WGABDT
     I              A7ABTM                          WGABTM
      *
     I@CCREH3
      * Tattoo Header Process     Retrieval index
      * Renamed input format fields
     I              CCCSCD                          WHCSCD
     I              CCCETX                          WHCETX
     I              CCAAVN                          WHAAVN
     I              CCAADT                          WHAADT
     I              CCAMTM                          WHAMTM
     I              CCAJST                          WHAJST
     I              CCAHVN                          WHAHVN
     I              CCAGVN                          WHAGVN
     I              CCABVN                          WHABVN
     I              CCABDT                          WHABDT
     I              CCABTM                          WHABTM
      *
     I@AFREAR
      * Producer Location         Retrieval index
      * Renamed input format fields
     I              AFABCD                          WIABCD
     I              AFAECD                          WIAECD
     I              AFA8TX                          WIA8TX
     I              AFGLNB                          WIGLNB
     I              AFATST                          WIATST
     I              AFASNB                          WIASNB
     I              AFAUST                          WIAUST
     I              AFQNST                          WIQNST
     I              AFQOST                          WIQOST
     I              AFQPST                          WIQPST
     I              AFQQST                          WIQQST
     I              AFQRST                          WIQRST
     I              AFN0TX                          WIN0TX
     I              AFQSST                          WIQSST
     I              AFQTST                          WIQTST
     I              AFQUST                          WIQUST
     I              AFQVST                          WIQVST
     I              AFR8ST                          WIR8ST
     I              AFR9ST                          WIR9ST
     I              AFSAST                          WISAST
     I              AFSBST                          WISBST
     I              AFSDST                          WISDST
     I              AFSEST                          WISEST
     I              AFSFST                          WISFST
     I              AFHWNB                          WIHWNB
     I              AFFUCD                          WIFUCD
     I              AFAAVN                          WIAAVN
     I              AFAADT                          WIAADT
     I              AFAMTM                          WIAMTM
     I              AFAJST                          WIAJST
     I              AFAHVN                          WIAHVN
     I              AFAGVN                          WIAGVN
     I              AFABVN                          WIABVN
     I              AFABDT                          WIABDT
     I              AFABTM                          WIABTM
      *
     I@ADREAF
      * Hog Buyer                 Retrieval index
      * Renamed input format fields
     I              ADACCD                          WJACCD
     I              ADALTX                          WJALTX
     I              ADAQST                          WJAQST
     I              ADARST                          WJARST
     I              ADAAVN                          WJAAVN
     I              ADAADT                          WJAADT
     I              ADAMTM                          WJAMTM
     I              ADAJST                          WJAJST
     I              ADAHVN                          WJAHVN
     I              ADAGVN                          WJAGVN
     I              ADABVN                          WJABVN
     I              ADABDT                          WJABDT
     I              ADABTM                          WJABTM
      *
     I@AIREA9
      * Genetic                   Retrieval index
      * Renamed input format fields
     I              AIAGCD                          WKAGCD
     I              AIAWTX                          WKAWTX
     I              AIAAVN                          WKAAVN
     I              AIAADT                          WKAADT
     I              AIAMTM                          WKAMTM
     I              AIAJST                          WKAJST
     I              AIAHVN                          WKAHVN
     I              AIAGVN                          WKAGVN
     I              AIABVN                          WKABVN
     I              AIABDT                          WKABDT
     I              AIABTM                          WKABTM
      *
     I@A8REDA
      * Hog Classification        Retrieval index
      * Renamed input format fields
     I              A8BECD                          WLBECD
     I              A8BDTX                          WLBDTX
     I              A8BXST                          WLBXST
     I              A8BYST                          WLBYST
     I              A8BITX                          WLBITX
     I              A8B0ST                          WLB0ST
     I              A8FBST                          WLFBST
     I              A8AAVN                          WLAAVN
     I              A8AADT                          WLAADT
     I              A8AMTM                          WLAMTM
     I              A8AJST                          WLAJST
     I              A8AHVN                          WLAHVN
     I              A8AGVN                          WLAGVN
     I              A8ABVN                          WLABVN
     I              A8ABDT                          WLABDT
     I              A8ABTM                          WLABTM
      *
     I@ACREAI
      * Producer                  Retrieval index
      * Renamed input format fields
     I              ACABCD                          WMABCD
     I              ACAGTX                          WMAGTX
     I              ACALNB                          WMALNB
     I              ACAATH                          WMAATH
     I              ACAMNB                          WMAMNB
     I              ACIWST                          WMIWST
     I              ACAPST                          WMAPST
     I              ACGCNB                          WMGCNB
     I              ACGJNB                          WMGJNB
     I              ACC2TX                          WMC2TX
     I              ACAACD                          WMAACD
     I              ACACCD                          WMACCD
     I              ACADCD                          WMADCD
     I              ACAAVN                          WMAAVN
     I              ACAADT                          WMAADT
     I              ACAMTM                          WMAMTM
     I              ACAJST                          WMAJST
     I              ACAHVN                          WMAHVN
     I              ACAGVN                          WMAGVN
     I              ACABVN                          WMABVN
     I              ACABDT                          WMABDT
     I              ACABTM                          WMABTM
      *
     I@AAREAC
      * Source                    Retrieval index
      * Renamed input format fields
     I              AAAACD                          WOAACD
     I              AAAFTX                          WOAFTX
     I              AAIXST                          WOIXST
     I              AACYSS                          WOCYSS
     I              AACZSS                          WOCZSS
     I              AAC0SS                          WOC0SS
     I              AAC1SS                          WOC1SS
     I              AAAAVN                          WOAAVN
     I              AAAADT                          WOAADT
     I              AAAMTM                          WOAMTM
     I              AAAJST                          WOAJST
     I              AAAHVN                          WOAHVN
     I              AAAGVN                          WOAGVN
     I              AAABVN                          WOABVN
     I              AAABDT                          WOABDT
     I              AAABTM                          WOABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
      * Outward parameters
     IPARC        DS                             12
      * KEY : Tattoo Header             Co/KD/FS/Tto
      * I : RST BOH Company Number
     I                                    P   1   20PAHMNB
      * I : RST TH Kill Date
     I                                    P   3   60PAB0DT
      * I :  TH Tattoo Number
     I                                    P  10  120PACVNB
      *
     IQPKFJ1    E DSPKFJCPL0
      * UPD : Tattoo Pending            Update index
      * Renamed input format fields
     I              FJHONB                          WEHONB
     I              FJEZDT                          WEEZDT
     I              FJHSA1                          WEHSA1
     I              FJHMNB                          WEHMNB
     I              FJBNNB                          WEBNNB
     I              FJBONB                          WEBONB
     I              FJHRA1                          WEHRA1
     I              FJBKTM                          WEBKTM
     I              FJWPST                          WEWPST
     I              FJWQST                          WEWQST
     I              FJMIA1                          WEMIA1
     I              FJAAVN                          WEAAVN
     I              FJAADT                          WEAADT
     I              FJAMTM                          WEAMTM
     I              FJAJST                          WEAJST
     I              FJAHVN                          WEAHVN
     I              FJAGVN                          WEAGVN
     I              FJABVN                          WEABVN
     I              FJABDT                          WEABDT
     I              FJABTM                          WEABTM
      *
     IYARDCS      DS                             87
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                             87
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Tattoo Header
      * I : MAP BOH Company Number
     I                                    P   1   20P1HMNB
      * I : MAP BOH Buy Order Number
     I                                    P   3   60P1BNNB
      * I : MAP BOL Load Number
     I                                    P   7   90P1BONB
      * I : MAP TH Tattoo Number
     I                                    P  10  120P1CVNB
      * I : MAP TH Kill Date
     I                                    P  13  160P1B0DT
      * I :  TH Group Reference
     I                                       17  26 P1BICD
      * I :  TH Sex
     I                                       27  27 P1E2ST
      * I :  TH HPS Movement Ref #
     I                                    P  28  310P1OXNB
      * I : MAP TH Hog Class Type
     I                                       32  32 P1LLST
      * I : MAP PD Producer Code
     I                                       33  38 P1ABCD
      * I : MAP PL Location Code
     I                                       39  44 P1AECD
      * I :  GN Genetic Code
     I                                       45  49 P1AGCD
     IP2PARM      DS
      * I :  Oms System Value Alpha
     I                                        1  40 P2EVTX
     IP3PARM      DS
      * I :  Name USR
     I                                        1  40 P3BSTX
     IP4PARM      DS
      * I :  BOL Pln Delv Date
     I                                    P   1   40P4AUDT
     IP5PARM      DS
      * I : MAP PD Name
     I                                        1  40 P5AGTX
     IP6PARM      DS
      * I : MAP PL Name
     I                                        1  40 P6A8TX
     IP7PARM      DS
      * I :  SBD Top Load Sts
     I                                        1   1 P7WEST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Tattoo &1 has been added.'
      * TH Tattoo Number
     I                                    P   1   30ZA0001
      * Message data for 'Tattoo nbr <1111 or >8998'
      * TH Tattoo Number
     I                                    P   1   30ZA0002
      * Message data for 'Tattoo nbr (Internal)'
      * TH Tattoo Number
     I                                    P   1   30ZA0003
      * Message data for 'Tattoo Pending         NF'
      * TH Tattoo Number
     I                                    P   1   30ZA0004
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HMNB    PARM           WP0001  30       BOH Company Num
     C           P1BNNB    PARM           WP0002  70       BOH Buy Order N
     C           P1BONB    PARM           WP0003  50       BOL Load Number
     C           P1CVNB    PARM           WP0004  50       TH Tattoo Numbe
     C           P1B0DT    PARM           WP0005  70       TH Kill Date
     C           P1BICD    PARM           WP0006 10        TH Group Refere
     C           P1E2ST    PARM           WP0007  1        TH Sex
     C           P1OXNB    PARM           WP0008  70       TH HPS Movement
     C           P1LLST    PARM           WP0009  1        TH Hog Class Ty
     C           P1ABCD    PARM           WP0010  6        PD Producer Cod
     C           P1AECD    PARM           WP0011  6        PL Location Cod
     C           P1AGCD    PARM           WP0012  5        GN Genetic Code
     C           P2EVTX    PARM           WP0013 40        Oms System Valu
     C           P3BSTX    PARM           WP0014 40        Name USR
     C           P4AUDT    PARM           WP0015  70       BOL Pln Delv Da
     C           P5AGTX    PARM           WP0016 40        PD Name
     C           P6A8TX    PARM           WP0017 40        PL Name
     C           P7WEST    PARM           WP0018  1        SBD Top Load St
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Enable PUTOVR
     C                     SETON                     86
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process command keys
      * CASE: DTL.*CMD key is CF19
     C           *IN19     IFEQ '1'                        *IF
      * Display Internal Deliv DF - Tattoo Header  * 
     C                     CLEARPARC
     C                     Z-ADD#1HMNB    PAHMNB           BOH Company Num
     C                     Z-ADD#1B0DT    PAB0DT           TH Kill Date
     C                     Z-ADD#1CVNB    PACVNB           TH Tattoo Numbe
      *
     C                     CALL 'PKSVDFR'              90  Display Interna
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Tattoo Hea
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKSVDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
     C                     END
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * USER: User defined action
     C                     MOVEL'N'       WUIHST           Record Added Us
      * Edt Tattoo Hdr/Defect  ER - Tattoo Header  * 
     C                     CALL 'PKKIE1R'              90  Edt Tattoo Hdr/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0001  30       BOH Company Num
     C                     PARM #1BNNB    WQ0002  70       BOH Buy Order N
     C                     PARM #1BONB    WQ0003  50       BOL Load Number
     C           #1CVNB    PARM #1CVNB    WQ0004  50       TH Tattoo Numbe
     C                     PARM #1B0DT    WQ0005  70       TH Kill Date
     C                     PARM P1BICD    WQ0006 10        TH Group Refere
     C                     PARM P1E2ST    WQ0007  1        TH Sex
     C                     PARM P1OXNB    WQ0008  70       TH HPS Movement
     C                     PARM #1LLST    WQ0009  1        TH Hog Class Ty
     C                     PARM #1ABCD    WQ0010  6        PD Producer Cod
     C                     PARM #1AECD    WQ0011  6        PL Location Cod
     C                     PARM P1AGCD    WQ0012  5        GN Genetic Code
     C                     PARM P2EVTX    WQ0013 40        Oms System Valu
     C                     PARM #DBSTX    WQ0014 40        Name USR
     C                     PARM P4AUDT    WQ0015  70       BOL Pln Delv Da
     C           WUIHST    PARM WUIHST    WQ0016  1        Record Added Us
     C                     PARM #PAGTX    WQ0017 40        PD Name
     C                     PARM #PA8TX    WQ0018 40        PL Name
     C                     PARM WUUMOD    WQ0019  1        User modified:
     C                     PARM WUFACD    WQ0020 10        Company Value C
     C                     PARM P7WEST    WQ0021  1        SBD Top Load St
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKKIE1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * CASE: 960 + Resale + Tattoo >0
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.BOH Company Number is Triumph Foods Market
      *   |- c2    : PAR.TH Hog Class Type is Resale
      *   |- c3    : DTL.TH Tattoo Number is NE Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1HMNB    IFEQ 960                        *IF
     C           P1LLST    IFEQ 'R'                        *IF
     C           #1CVNB    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Upd Tattoo Nbr Usage  XF - Tattoo Nbr Created by Plt  * 
     C                     CALL 'PWK0XFR'              90  Upd Tattoo Nbr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0022  30       Company
     C                     PARM #1CVNB    WQ0023  50       TH Tattoo Numbe
     C                     PARM WUB3NZ    WQ0024  50       Tattoo Nbr Grou
     C                     PARM WUB4NZ    WQ0025  50       Tattoo Nbr Grou
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWK0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * Setup message data for message
     C                     Z-ADD#1CVNB    ZA0001           TH Tattoo Numbe
      * Send message 'Tattoo &1 has been added.'
     C                     MOVEL'PRK0359' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     GOTO DAEXIT                     *QUIT
     C                     END                             *FI
      * 10/09/02  PKD  PK0419: Commented out
      * 10/09/02  PKD  PK0419:  Changed to only get the Next Tattoo
      *                if not Market and Not Tattooing off of the Truck.
      * Next Tattoo Number
      * CASE: LCL.Tattoo Off Truck USR is Yes
     C           YL0001    IFEQ 'Y'                        *IF
      * CASE: DTL.TH Hog Class Type is Not Market
     C           #1LLST    IFEQ 'R'                        *IF
     C           #1LLST    OREQ 'S'
      * Get Next Tattoo Number into key screen field.
      * RTV Next Tattoo Nbrs  XF - Tattoo Header  * 
     C                     CALL 'PKY4XFR'              90  RTV Next Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0026  30       BOH Company Num
     C                     PARM #1LLST    WQ0027  1        HC Class Type
     C           #1CVNB    PARM #1CVNB    WQ0028  50       Tattoo Number U
     C           WUFACD    PARM WUFACD    WQ0029 10        Company Value C
     C                     PARM 'R'       WQ0030  1        Creation Point
     C                     PARM #1B0DT    WQ0031  70       TH Kill Date
     C           WULMST    PARM WULMST    WQ0032  7        Return Code USR
     C                     PARM WUIXST    WQ0033  1        SR Type
     C                     PARM P7WEST    WQ0034  1        SBD Top Load St
     C                     PARM *BLANK    WQ0035  1        Tattoo Type USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKY4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     #1CVNB           TH Tattoo Numbe
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Next Tattoo Nbrs  XF - Tattoo Header  * 
     C                     CALL 'PKY4XFR'              90  RTV Next Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0036  30       BOH Company Num
     C                     PARM #1LLST    WQ0037  1        HC Class Type
     C           #1CVNB    PARM #1CVNB    WQ0038  50       Tattoo Number U
     C           WUFACD    PARM WUFACD    WQ0039 10        Company Value C
     C                     PARM 'R'       WQ0040  1        Creation Point
     C                     PARM #1B0DT    WQ0041  70       TH Kill Date
     C           WULMST    PARM WULMST    WQ0042  7        Return Code USR
     C                     PARM WUIXST    WQ0043  1        SR Type
     C                     PARM P7WEST    WQ0044  1        SBD Top Load St
     C                     PARM *BLANK    WQ0045  1        Tattoo Type USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKY4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     END                             *FI
      * Get Next Tattoo Number into work field for later comparison.
     C                     Z-ADD#1CVNB    WUCVNB           TH Tattoo Numbe
      * Request new transaction
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate fields
      * 10/09/02  PKD  PK0419:  Added new validation for Tattooing off of
      *                the Truck.
      * CASE: LCL.Tattoo Off Truck USR is Yes
     C           YL0001    IFEQ 'Y'                        *IF
     C                     Z-ADD*ZERO     YL0002           TP Tattoo Date
      * F4=Prompt Tattoo Number
      * CASE: DTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> DTL.TH Tattoo Number
     C           W0CFL     IFEQ '#1CVNB'                   *IF
      * Sel Pending Tattoo    SR - Tattoo Pending  * 
     C                     CALL 'PLAGSRR'              90  Sel Pending Tat
     C                     PARM *BLANK    W0RTN   7
     C           #1HMNB    PARM #1HMNB    WQ0046  30       CC Company Numb
     C           YL0002    PARM YL0002    WQ0047  70       TP Tattoo Date
     C           #1CVNB    PARM #1CVNB    WQ0048  50       TP Tattoo Numbe
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLAGSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * F6=Next Tattoo
      * CASE: DTL.*CMD key is CF06
     C           *IN06     IFEQ '1'                        *IF
      * CASE: LCL.Tattoo Off Truck USR is Yes
     C           YL0001    IFEQ 'Y'                        *IF
      * CASE: TF + Resale: call PWKWXFR (skip PKPKPVR)
      *  - c1 AND c2
      *   |- c1    : DTL.TH Hog Class Type is Resale
      *   |- c2    : PAR.BOH Company Number is Triumph Foods Market
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1LLST    IFEQ 'R'                        *IF
     C           P1HMNB    IFEQ 960                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD*ZERO     WUKENB           Tattoo Number U
     C                     MOVEL*BLANK    WUFACD           Company Value C
     C                     MOVEL'*ZERO'   WUFACD           Company Value C
     C                     MOVEL*BLANK    WULMST           Return Code USR
     C                     Z-ADD*ZERO     WUB3NZ           Tattoo Nbr Grou
     C                     Z-ADD*ZERO     WUB4NZ           Tattoo Nbr Grou
      * RTV Next Tattoo Nbrs RFXF - Tattoo Nbr Created by Plt  * 
     C                     CALL 'PWKWXFR'              90  RTV Next Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0049  30       BOH Company Num
     C                     PARM 'R'       WQ0050  1        HC Class Type
     C           WUKENB    PARM WUKENB    WQ0051  50       Tattoo Number U
     C           WUFACD    PARM WUFACD    WQ0052 10        Company Value C
     C                     PARM 'R'       WQ0053  1        Creation Point
     C                     PARM #1B0DT    WQ0054  70       TH Kill Date
     C           WULMST    PARM WULMST    WQ0055  7        Return Code USR
     C                     PARM 'E'       WQ0056  1        SR Type
     C                     PARM P7WEST    WQ0057  1        SBD Top Load St
     C                     PARM *BLANK    WQ0058  1        Tattoo Type USR
     C           WUB3NZ    PARM WUB3NZ    WQ0059  50       Tattoo Nbr Grou
     C           WUB4NZ    PARM WUB4NZ    WQ0060  50       Tattoo Nbr Grou
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWKWXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDWUKENB    #1CVNB           TH Tattoo Numbe
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Next Tattoo       PV - Tattoo Pending  * 
     C                     CALL 'PKPKPVR'              90  Rtv Next Tattoo
     C                     PARM *BLANK    W0RTN   7
     C           YL0002    PARM YL0002    WQ0061  70       TP Tattoo Date
     C           #1CVNB    PARM #1CVNB    WQ0062  50       TP Tattoo Numbe
     C                     PARM '5'       WQ0063  1        TP Alley Number
     C           #1LLST    PARM #1LLST    WQ0064  1        TH Hog Class Ty
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKPKPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: Resale + TF960 + Rtved Tattoo >0
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.BOH Company Number is Triumph Foods Market
      *   |- c2    : PAR.TH Hog Class Type is Resale
      *   |- c3    : WRK.Tattoo Number USR is NE Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1HMNB    IFEQ 960                        *IF
     C           P1LLST    IFEQ 'R'                        *IF
     C           WUKENB    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL:  Seaboard Top Load Range
      * CASE: PAR.SBD Top Load Sts is Yes
     C           P7WEST    IFEQ 'Y'                        *IF
      * CASE: DTL.TH Tattoo Number is Seaboard Top Loads
     C           #1CVNB    IFGE 8000                       *IF
     C           #1CVNB    ANDLE8999
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
     C                     EXSR SARVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Tattoo nbr <8000 or >8999'
     C                     MOVEL'PRK0992' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * VAL:  Not Market (Random Range)
      * CASE: DTL.TH Hog Class Type is Not Market
     C           #1LLST    IFEQ 'R'                        *IF
     C           #1LLST    OREQ 'S'
      * CASE: DTL.TH Tattoo Number is Random Range
     C           #1CVNB    IFGE 1111                       *IF
     C           #1CVNB    ANDLE8999
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
     C                     EXSR SBRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#1CVNB    ZA0002           TH Tattoo Numbe
      * Send message 'Tattoo nbr <1111 or >8998'
     C                     MOVEL'PRK1016' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * VAL:  Market (Randon Range or Internal Pre-Tattooed)
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.TH Hog Class Type is Market
      *   |- c2    : PAR.SBD Top Load Sts is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1LLST    IFEQ 'M'                        *IF
     C           P7WEST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: WRK.SR Type is Internal
     C           WUIXST    IFEQ 'I'                        *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DTL.TH Tattoo Number is Random Range
      *   |- c2    : DTL.TH Tattoo Number is Internal Research
      *   '-
     C           #1CVNB    IFGE 1111                       *IF
     C           #1CVNB    ANDLE8999
     C           #1CVNB    ORGE 9500                       *OR
     C           #1CVNB    ANDLE9850
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
     C                     EXSR SCRVGN
     C                     ELSE
      * CASE: DTL.TH Tattoo Number is Internal Pre-tattooed
     C           #1CVNB    IFGE 9100                       *IF
     C           #1CVNB    ANDLE9499
      * Rtv Val Ttt,Kll/bohld RT - Tattoo Header  * 
     C                     EXSR SDRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#1CVNB    ZA0003           TH Tattoo Numbe
      * Send message 'Tattoo nbr (Internal)'
     C                     MOVEL'PRK1017' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.SR Type is External
     C           WUIXST    IFEQ 'E'                        *IF
      * 10/07/04 PKD Per Jancie, we want to allow External's in the
      *              Random Range.
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
     C                     EXSR SERVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VAL:  Tattoo Header Existance
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Send message 'Tattoo Header          EX'
     C                     MOVEL'PRK0062' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL:  Tattoo Pending Existance
      * CASE:
      *  - c1 AND (c2 OR c3)
      *   |- c1    : DTL.TH Hog Class Type is Market
      *   |- c2    : DTL.TH Tattoo Number is Random Range
      *   |- c3    : DTL.TH Tattoo Number is Internal Research
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1LLST    IFEQ 'M'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           #1CVNB    IFGE 1111                       *IF
     C           #1CVNB    ANDLE8999
     C           #1CVNB    ORGE 9500                       *OR
     C           #1CVNB    ANDLE9850
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Val Tattoo Existance  RT - Tattoo Pending  * 
     C                     EXSR SFRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     Z-ADD*ZERO     #1CVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     YL0002           TP Tattoo Date
      * Sel Pending Tattoo    SR - Tattoo Pending  * 
     C                     CALL 'PLAGSRR'              90  Sel Pending Tat
     C                     PARM *BLANK    W0RTN   7
     C           #1HMNB    PARM #1HMNB    WQ0065  30       CC Company Numb
     C           YL0002    PARM YL0002    WQ0066  70       TP Tattoo Date
     C           #1CVNB    PARM #1CVNB    WQ0067  50       TP Tattoo Numbe
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLAGSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.TP Tattoo Date is Entered
      *   |- c2    : DTL.TH Tattoo Number is NE Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0002    IFGT *ZERO                      *IF
     C           #1CVNB    IFNE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Upd Tattoo Pending    RT - Tattoo Pending  * 
     C                     EXSR SGRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#1CVNB    ZA0004           TH Tattoo Numbe
      * Send message 'Tattoo Pending         NF'
     C                     MOVEL'PRK1012' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Upd Tattoo Pending    RT - Tattoo Pending  * 
     C                     EXSR SIRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Special check for internals and tattoo numbers
      * CASE: PAR.TH Hog Class Type is Market
     C           P1LLST    IFEQ 'M'                        *IF
      * CASE: PAR.SBD Top Load Sts is No
     C           P7WEST    IFEQ 'N'                        *IF
      * CASE: WRK.SR Type is Internal
     C           WUIXST    IFEQ 'I'                        *IF
     C                     MOVEL'I'       WUP8ST           Tto Nbr Chk Int
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'O'       WUP8ST           Tto Nbr Chk Int
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'O'       WUP8ST           Tto Nbr Chk Int
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'O'       WUP8ST           Tto Nbr Chk Int
     C                     END                             *FI
      * Tattoo number change
      * CASE: DTL.TH Tattoo Number NE WRK.TH Tattoo Number
     C           #1CVNB    IFNE WUCVNB                     *IF
      * CASE: WRK.Tto Nbr Chk Int/Other Usr is Internal Check
     C           WUP8ST    IFEQ 'I'                        *IF
      * NEW: 10/07/98  internal pretattoos 9100-9850 check for bol and ki
      * NEW: 07/19/04  internal pretattoos 9100-9499 check for bol and ki
      * CASE: DTL.TH Tattoo Number is Internal Pre-tattooed
     C           #1CVNB    IFGE 9100                       *IF
     C           #1CVNB    ANDLE9499
      * Rtv Val Ttt,Kll/bohld RT - Tattoo Header  * 
     C                     EXSR SKRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * NEW: 10/07/98  else just check for kill dt
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
     C                     EXSR SLRVGN
     C                     END                             *FI
      * Validation
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Send message 'Tattoo Header          EX'
     C                     MOVEL'PRK0062' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'1'       WUUMOD           User modified:
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.Tto Nbr Chk Int/Other Usr is Other Check
     C           WUP8ST    IFEQ 'O'                        *IF
      * CASE: PAR.SBD Top Load Sts is No
     C           P7WEST    IFEQ 'N'                        *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DTL.TH Tattoo Number is Less than 9000
      *   |- c2    : DTL.TH Tattoo Number is Greater than 9999
      *   '-
     C           #1CVNB    IFLT 9000                       *IF
     C           #1CVNB    ORGT 9999                       *OR
      * Send message 'Tattoo nbr <9000 or >9999'
     C                     MOVEL'PRK0358' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
     C                     EXSR SMRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Send message 'Tattoo Header          EX'
     C                     MOVEL'PRK0062' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'1'       WUUMOD           User modified:
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * PK0313 10/16/01  SBD Top Tattoos
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DTL.TH Tattoo Number is Less than 8000
      *   |- c2    : DTL.TH Tattoo Number is Greater than 8999
      *   '-
     C           #1CVNB    IFLT 8000                       *IF
     C           #1CVNB    ORGT 8999                       *OR
      * Send message 'Tattoo nbr <8000 or >8999'
     C                     MOVEL'PRK0992' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
     C                     EXSR SNRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Send message 'Tattoo Header          EX'
     C                     MOVEL'PRK0062' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'1'       WUUMOD           User modified:
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'0'       WUUMOD           User modified:
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
      * Select existing record
     C                     EXSR VACKRL
      * Check reference to Buy Order Load
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Hog Defect
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Tattoo Header Process
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Producer Location
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Hog Buyer
     C                     EXSR VFCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Genetic
     C                     EXSR VGCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Hog Classification
     C                     EXSR VHCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * TH Tattoo Number required
     C           #1CVNB    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     Z-ADDP1HMNB    #1HMNB           BOH Company Num
     C                     MOVEL*BLANK    #DBSTX           Name USR
     C                     MOVEL*BLANK    #1BICD           TH Group Refere
     C                     MOVEL*BLANK    #1CPST           TH Live Purchas
     C                     Z-ADD*ZERO     #1ACPR           TH Live Purchas
     C                     Z-ADD*ZERO     #1B9PR           TH Live Gross A
     C                     Z-ADD*ZERO     #1CAPR           TH LIve Net Amt
     C                     MOVEL*BLANK    #1C4ST           TH Resale UOM
     C                     Z-ADD*ZERO     #1AIPR           TH Recalc Live
     C                     Z-ADD*ZERO     #1A6DT           TH Pricing Date
     C                     MOVEL*BLANK    #1C2ST           TH Resale Sprea
     C                     Z-ADD*ZERO     #1CXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     #1CWNB           TH Head Receive
     C                     Z-ADD*ZERO     #1FCNB           TH Yard Deads
     C                     Z-ADD*ZERO     #1H9NB           TH Held Over
     C                     Z-ADD*ZERO     #1FDNB           TH Head Condemn
     C                     Z-ADD*ZERO     #1FENB           TH Head Killed
     C                     Z-ADD*ZERO     #1LRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     #1HENB           TH Head Adds
     C                     Z-ADD*ZERO     #1HFNB           TH Head Accepte
     C                     Z-ADD*ZERO     #1CYNB           TH Live Wgt
     C                     Z-ADD*ZERO     #1E0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     #1A5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     #1FBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     #1A4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     #1F7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     #1HDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     #1F5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     #1F4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     #1F3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     #1F2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     #1AVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     #1AWPC           TH Actual Yield
     C                     Z-ADD*ZERO     #1CWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     #1A8PC           TH Yield Differ
     C                     Z-ADD*ZERO     #1A7PC           TH Recalc Live
     C                     Z-ADD*ZERO     #1B8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     #1AMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     #1ANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     #1AYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     #1AWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     #1AOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     #1AXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     #1APPR           TH CM Carcass G
     C                     Z-ADD*ZERO     #1ASPR           TH Deduction Am
     C                     Z-ADD*ZERO     #1A4VA           TH Total Net WO
     C                     Z-ADD*ZERO     #1A5VA           TH Additions Am
     C                     Z-ADD*ZERO     #1CBPR           TH Payment Gros
     C                     Z-ADD*ZERO     #1CCPR           Th Payment Net
     C                     Z-ADD*ZERO     #1LPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     #1CDPR           TH Freight Amou
     C                     Z-ADD*ZERO     #1ATPR           TH Carcass Net
     C                     Z-ADD*ZERO     #1A7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     #1A2PR           TH Fixed Cost A
     C                     MOVEL*BLANK    #1JWST           TH Calc Net Sts
     C                     MOVEL*BLANK    #1CWST           TH Payment Sts
     C                     MOVEL*BLANK    #1D7ST           TH Header Error
     C                     MOVEL*BLANK    #1D8ST           TH Detail Error
     C                     MOVEL*BLANK    #1DWST           TH Kill Balanci
     C                     MOVEL*BLANK    #1D6ST           TH Bal to Kill
     C                     Z-ADD*ZERO     #1GHNB           TH Commission A
     C                     Z-ADD*ZERO     #1BYDT           TH Voucher Paym
     C                     MOVEL*BLANK    #1E0ST           TH User Error O
     C                     MOVEL*BLANK    #1E1ST           TH Held Over Re
     C                     MOVEL*BLANK    #1E2ST           TH Sex
     C                     Z-ADD*ZERO     #1BSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     #1BTDT           TH Commission P
     C                     Z-ADD*ZERO     #1BUDT           TH Actual Check
     C                     Z-ADD*ZERO     #1HGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     #1HHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     #1HINB           TH FFLI
     C                     Z-ADD*ZERO     #1A3PR           TH Kill Product
     C                     Z-ADD*ZERO     #1A4PR           TH Cut Product
     C                     Z-ADD*ZERO     #1A6PR           TH Render Produ
     C                     Z-ADD*ZERO     #1J9NB           TH Head Exclude
     C                     Z-ADD*ZERO     #1D6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     #1D7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     #1D8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     #1D9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     #1EAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     #1EBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     #1ECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     #1EDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     #1EEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     #1EFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     #1EGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     #1EHPR           TH CM Gross Car
     C                     MOVEL*BLANK    #1KAST           TH Source Type
     C                     MOVEL*BLANK    #1J7ST           TH Scale Ticket
     C                     MOVEL*BLANK    #1J8ST           TH Posted to HP
     C                     MOVEL*BLANK    #1LIST           TH Schedule Kil
     C                     MOVEL*BLANK    #1LJST           TH Shift Held O
     C                     MOVEL*BLANK    #1NZTX           TH State
     C                     MOVEL*BLANK    #1HJCD           TH Unused Code
     C                     MOVEL*BLANK    #1R4ST           TH Unused Sts 2
     C                     MOVEL*BLANK    #1R5ST           TH Commission S
     C                     MOVEL*BLANK    #1R6ST           TH Paid 2 Week
     C                     MOVEL*BLANK    #1R7ST           TH Unused Sts 1
     C                     Z-ADD*ZERO     #1THWT           TH DOA Weight
     C                     Z-ADD*ZERO     #1T2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     #1THHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     #1T2HD           TH Shift Held O
     C                     Z-ADD*ZERO     #1OBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     #1KOER           TH Head Identif
     C                     Z-ADD*ZERO     #1OPIR           TH Percent Iden
     C                     Z-ADD*ZERO     #1OPEM           TH Percent Acce
     C                     Z-ADD*ZERO     #1IORP           TH Head Adjuste
     C                     Z-ADD*ZERO     #1OWEO           TH PHA Head Add
     C                     MOVEL*BLANK    #1OQET           TH PHA Add Type
     C                     MOVEL*BLANK    #1URST           TH PHA Average
     C                     MOVEL*BLANK    #1USST           TH PHA Add Reas
     C                     Z-ADD*ZERO     #1HHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     #1S9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     #1TAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     #1TBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     #1JFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     #1KRIF           TH Broken Back
     C                     Z-ADD*ZERO     #1KORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     #1KAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     #1KROT           TH Excluded Car
     C                     Z-ADD*ZERO     #1OTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     #1IRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     #1IMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     #1IRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     #1KRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     #1OJRF           TH Break Even P
     C                     Z-ADD*ZERO     #1KFOR           TH Meat Value F
     C                     Z-ADD*ZERO     #1ORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     #1OMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     #1MVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     #1MCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     #1NCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     #1NCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     #1IGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     #1KFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     #1EADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     #1EBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     #1ECDT           TH Head LFT
     C                     Z-ADD*ZERO     #1EDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     #1EEDT           TH Unused Date
     C                     MOVEL*BLANK    #1U4ST           TH Unused Sts 1
     C                     MOVEL*BLANK    #1U5ST           TH Unused Sts 2
     C                     MOVEL*BLANK    #1U6ST           TH Unused Sts 3
     C                     MOVEL*BLANK    #1U7ST           TH Unused Sts 4
     C                     MOVEL*BLANK    #1U8ST           TH Unused Sts 5
     C                     MOVEL*BLANK    #1U9ST           TH Unused Sts 6
     C                     MOVEL*BLANK    #1VAST           TH Unused Sts 7
     C                     MOVEL*BLANK    #1VBST           TH Unused Sts 8
     C                     MOVEL*BLANK    #1J9ST           TH Payment Type
     C                     Z-ADD*ZERO     #1OXNB           TH HPS Movement
     C                     MOVEL*BLANK    #1LKST           TH Source Code
     C                     MOVEL*BLANK    #1AGCD           GN Genetic Code
     C                     MOVEL*BLANK    #1BECD           HC Class Code
     C                     MOVEL*BLANK    #1BDCD           DF Defect Code
     C                     MOVEL*BLANK    #1CSCD           THP Process Cod
     C                     MOVEL*BLANK    #1ACCD           HB Buyer Code
     C                     MOVEL*BLANK    #1AAVN           RS User Changed
     C                     Z-ADD*ZERO     #1AADT           RS Date Changed
     C                     Z-ADD*ZERO     #1AMTM           RS Time Changed
     C                     MOVEL*BLANK    #1AJST           RS Record Statu
     C                     MOVEL*BLANK    #1AHVN           RS Job
     C                     MOVEL*BLANK    #1AGVN           RS Program
     C                     MOVEL*BLANK    #1ABVN           RS User Added
     C                     Z-ADD*ZERO     #1ABDT           RS Date Added
     C                     Z-ADD*ZERO     #1ABTM           RS Time Added
     C                     MOVELP1ABCD    #1ABCD           PD Producer Cod
     C                     MOVELP5AGTX    #PAGTX           PD Name
     C                     MOVELP1AECD    #1AECD           PL Location Cod
     C                     MOVELP6A8TX    #PA8TX           PL Name
     C                     Z-ADDP1BNNB    #1BNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    #1BONB           BOL Load Number
     C                     Z-ADDP1B0DT    #1B0DT           TH Kill Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1B0DT
     C                     Z-ADD*ZERO     #1AWDT           TH Purchase Dat
      * Clear external version also
     C                     Z-ADD*ZERO     V1AWDT
     C                     MOVELP1LLST    #1LLST           TH Hog Class Ty
     C                     MOVEL*BLANK    #DE6TX           HC Class Type D
     C                     Z-ADDP1CVNB    #1CVNB           TH Tattoo Numbe
      * USER: Load screen
      * Rtv Producer Nm, Srce RT - Producer  * 
     C                     EXSR SORVGN
      * Rtv Source Type       RT - Source  * 
     C                     EXSR SPRVGN
     C                     Z-ADD#1B0DT    #1AWDT           TH Purchase Dat
      * DTL.HC Class Type Desc Usr = Condition name of PAR.TH Hog Class T
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1110255   Y2LSNO  70       List number
     C                     PARM P1LLST    W0INVL 25        TH Hog Class Ty
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DE6TX    PARM           W0CNNM 25        HC Class Type D
      *
      * 10/09/02  PKD  PK0419:  Changed to only get the Next Tattoo
      *                if not Market and Not Tattooing off of the Truck.
      * Next Tattoo Number
      * CASE: LCL.Tattoo Off Truck USR is Yes
     C           YL0001    IFEQ 'Y'                        *IF
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0086  30       BOH Company Num
     C                     PARM @CN,002   WQ0087 10        Company Value C
     C           YL0003    PARM *BLANK    WQ0088 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.System Value Alpha    USR is Yes
     C           YL0003    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: LCL.System Value Alpha    USR is No
     C           YL0003    IFEQ 'N'                        *IF
      * CASE: PAR.TH Hog Class Type is Not Market
     C           P1LLST    IFEQ 'R'                        *IF
     C           P1LLST    OREQ 'S'
      * Get Next Tattoo Number into key screen field.
      * RTV Next Tattoo Nbrs  XF - Tattoo Header  * 
     C                     CALL 'PKY4XFR'              90  RTV Next Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0089  30       BOH Company Num
     C                     PARM #1LLST    WQ0090  1        HC Class Type
     C           #1CVNB    PARM #1CVNB    WQ0091  50       Tattoo Number U
     C           WUFACD    PARM WUFACD    WQ0092 10        Company Value C
     C                     PARM 'R'       WQ0093  1        Creation Point
     C                     PARM #1B0DT    WQ0094  70       TH Kill Date
     C           WULMST    PARM WULMST    WQ0095  7        Return Code USR
     C                     PARM WUIXST    WQ0096  1        SR Type
     C                     PARM P7WEST    WQ0097  1        SBD Top Load St
     C                     PARM *BLANK    WQ0098  1        Tattoo Type USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKY4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Next Tattoo Nbrs  XF - Tattoo Header  * 
     C                     CALL 'PKY4XFR'              90  RTV Next Tattoo
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0099  30       BOH Company Num
     C                     PARM #1LLST    WQ0100  1        HC Class Type
     C           #1CVNB    PARM #1CVNB    WQ0101  50       Tattoo Number U
     C           WUFACD    PARM WUFACD    WQ0102 10        Company Value C
     C                     PARM 'R'       WQ0103  1        Creation Point
     C                     PARM #1B0DT    WQ0104  70       TH Kill Date
     C           WULMST    PARM WULMST    WQ0105  7        Return Code USR
     C                     PARM WUIXST    WQ0106  1        SR Type
     C                     PARM P7WEST    WQ0107  1        SBD Top Load St
     C                     PARM *BLANK    WQ0108  1        Tattoo Type USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKY4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     END                             *FI
      * Get Next Tattoo Number into work field for later comparison.
     C                     Z-ADD#1CVNB    WUCVNB           TH Tattoo Numbe
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  #1B0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1B0DT
      * Convert TH Purchase Date to display format
      * Convert date
     C           1000000   ADD  #1AWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1AWDT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQSA01           BOH Company Num
     C           *LIKE     DEFN WAB0DT    WQSA02           TH Kill Date
     C           *LIKE     DEFN WACVNB    WQSA03           TH Tattoo Numbe
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           BOH Company Num
     C                     KFLD           WQSA02           TH Kill Date
     C                     KFLD           WQSA03           TH Tattoo Numbe
      * Setup key
     C                     Z-ADD#1HMNB    WQSA01           BOH Company Num
     C                     Z-ADD#1B0DT    WQSA02           TH Kill Date
     C                     Z-ADD#1CVNB    WQSA03           TH Tattoo Numbe
      * Establish starting position
     C           KRSSA     SETLL@A1CPL0                    *
     C           KRSSA     READE@A1CPL0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQSB01           BOH Company Num
     C           *LIKE     DEFN WAB0DT    WQSB02           TH Kill Date
     C           *LIKE     DEFN WACVNB    WQSB03           TH Tattoo Numbe
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           BOH Company Num
     C                     KFLD           WQSB02           TH Kill Date
     C                     KFLD           WQSB03           TH Tattoo Numbe
      * Setup key
     C                     Z-ADD#1HMNB    WQSB01           BOH Company Num
     C                     Z-ADD#1B0DT    WQSB02           TH Kill Date
     C                     Z-ADD#1CVNB    WQSB03           TH Tattoo Numbe
      * Establish starting position
     C           KRSSB     SETLL@A1CPL0                    *
     C           KRSSB     READE@A1CPL0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQSC01           BOH Company Num
     C           *LIKE     DEFN WAB0DT    WQSC02           TH Kill Date
     C           *LIKE     DEFN WACVNB    WQSC03           TH Tattoo Numbe
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           BOH Company Num
     C                     KFLD           WQSC02           TH Kill Date
     C                     KFLD           WQSC03           TH Tattoo Numbe
      * Setup key
     C                     Z-ADD#1HMNB    WQSC01           BOH Company Num
     C                     Z-ADD#1B0DT    WQSC02           TH Kill Date
     C                     Z-ADD#1CVNB    WQSC03           TH Tattoo Numbe
      * Establish starting position
     C           KRSSC     SETLL@A1CPL0                    *
     C           KRSSC     READE@A1CPL0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Val Ttt,Kll/bohld RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQSD01           BOH Company Num
     C           *LIKE     DEFN WBBNNB    WQSD02           BOH Buy Order N
     C           *LIKE     DEFN WBBONB    WQSD03           BOL Load Number
     C           *LIKE     DEFN WBCVNB    WQSD04           TH Tattoo Numbe
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           BOH Company Num
     C                     KFLD           WQSD02           BOH Buy Order N
     C                     KFLD           WQSD03           BOL Load Number
     C                     KFLD           WQSD04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADD#1HMNB    WQSD01           BOH Company Num
     C                     Z-ADD#1BNNB    WQSD02           BOH Buy Order N
     C                     Z-ADD#1BONB    WQSD03           BOL Load Number
     C                     Z-ADD#1CVNB    WQSD04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSD     SETLL@A1CPOI                    *
     C           KRSSD     READE@A1CPOI                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQSE01           BOH Company Num
     C           *LIKE     DEFN WAB0DT    WQSE02           TH Kill Date
     C           *LIKE     DEFN WACVNB    WQSE03           TH Tattoo Numbe
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           BOH Company Num
     C                     KFLD           WQSE02           TH Kill Date
     C                     KFLD           WQSE03           TH Tattoo Numbe
      * Setup key
     C                     Z-ADD#1HMNB    WQSE01           BOH Company Num
     C                     Z-ADD#1B0DT    WQSE02           TH Kill Date
     C                     Z-ADD#1CVNB    WQSE03           TH Tattoo Numbe
      * Establish starting position
     C           KRSSE     SETLL@A1CPL0                    *
     C           KRSSE     READE@A1CPL0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Val Tattoo Existance  RT - Tattoo Pending  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C                     KFLD           WCEZDT           TP Tattoo Date
     C                     KFLD           WCHSA1           TP Tattoo Numbe
      * Setup key
     C                     Z-ADD#1HMNB    WCHONB           CC Company Numb
     C                     Z-ADDYL0002    WCEZDT           TP Tattoo Date
     C                     Z-ADD#1CVNB    WCHSA1           TP Tattoo Numbe
      * Establish starting position
     C           KRSSF     CHAIN@FJCPH0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1012' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Upd Tattoo Pending    RT - Tattoo Pending  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WDHONB           CC Company Numb
     C                     KFLD           WDEZDT           TP Tattoo Date
     C                     KFLD           WDHSA1           TP Tattoo Numbe
      * Setup key
     C                     Z-ADD#1HMNB    WDHONB           CC Company Numb
     C                     Z-ADDYL0002    WDEZDT           TP Tattoo Date
     C                     Z-ADD#1CVNB    WDHSA1           TP Tattoo Numbe
      * Establish starting position
     C           KRSSG     CHAIN@FJCPHW              90    *
      * Data record not found
     C   90                MOVEL'PRK1012' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Tattoo Assigned   CH - Tattoo Pending  * 
     C                     EXSR SHCHRC
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCHRC    BEGSR
      *================================================================
      * Chg Tattoo Assigned   CH - Tattoo Pending  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  50       Employee ID
     C                     Z-ADD*ZERO     WN0002  60       TP Tattoo Creat
     C                     MOVEL*BLANK    WN0003  1        TP Alley Number
     C                     Z-ADD*ZERO     WN0004  50       Employee Number
     C                     MOVEL*BLANK    WN0005 10        RS User Changed
     C                     Z-ADD*ZERO     WN0006  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0007  60       RS Time Changed
     C                     MOVEL*BLANK    WN0008  1        RS Record Statu
     C                     MOVEL*BLANK    WN0009 10        RS Job
     C                     MOVEL*BLANK    WN0010 10        RS Program
     C                     MOVEL*BLANK    WN0011 10        RS User Added
     C                     Z-ADD*ZERO     WN0012  70       RS Date Added
     C                     Z-ADD*ZERO     WN0013  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FJCPHV
     C                     Z-ADDWDHONB    WEHONB           CC Company Numb
     C                     Z-ADDWDEZDT    WEEZDT           TP Tattoo Date
     C                     Z-ADDWDHSA1    WEHSA1           TP Tattoo Numbe
      *
     C           KLCHSH    KLIST
     C                     KFLD           WEHONB           CC Company Numb
     C                     KFLD           WEEZDT           TP Tattoo Date
     C                     KFLD           WEHSA1           TP Tattoo Numbe
     C           KLCHSH    CHAIN@FJCPHV              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFJCPL0'MDACP
     C                     MOVEL'@FJCPHV' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFJ1    YARDCS
      * Move non-key fields to @FJCPHV
     C                     Z-ADD#1HMNB    WEHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    WEBONB           BOL Load Number
     C                     MOVEL'A'       WEWQST    P      TP Tattoo Statu
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WEAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WEAADT    PARM *ZERO     WQ0068  70       *DATE
     C           WEAMTM    PARM *ZERO     WQ0069  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FJCPHV                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFJCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Upd Tattoo Pending    RT - Tattoo Pending  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WDHONB           CC Company Numb
     C                     KFLD           WDEZDT           TP Tattoo Date
     C                     KFLD           WDHSA1           TP Tattoo Numbe
      * Setup key
     C                     Z-ADD#1HMNB    WDHONB           CC Company Numb
     C                     Z-ADDYL0002    WDEZDT           TP Tattoo Date
     C                     Z-ADD#1CVNB    WDHSA1           TP Tattoo Numbe
      * Establish starting position
     C           KRSSI     CHAIN@FJCPHW              90    *
      * Data record not found
     C   90                MOVEL'PRK1012' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Tattoo Assigned   CH - Tattoo Pending  * 
     C                     EXSR SJCHRC
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCHRC    BEGSR
      *================================================================
      * Chg Tattoo Assigned   CH - Tattoo Pending  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0014  50       Employee ID
     C                     Z-ADD*ZERO     WN0015  60       TP Tattoo Creat
     C                     MOVEL*BLANK    WN0016  1        TP Alley Number
     C                     Z-ADD*ZERO     WN0017  50       Employee Number
     C                     MOVEL*BLANK    WN0018 10        RS User Changed
     C                     Z-ADD*ZERO     WN0019  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0020  60       RS Time Changed
     C                     MOVEL*BLANK    WN0021  1        RS Record Statu
     C                     MOVEL*BLANK    WN0022 10        RS Job
     C                     MOVEL*BLANK    WN0023 10        RS Program
     C                     MOVEL*BLANK    WN0024 10        RS User Added
     C                     Z-ADD*ZERO     WN0025  70       RS Date Added
     C                     Z-ADD*ZERO     WN0026  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @FJCPHV
     C                     Z-ADDWDHONB    WEHONB           CC Company Numb
     C                     Z-ADDWDEZDT    WEEZDT           TP Tattoo Date
     C                     Z-ADDWDHSA1    WEHSA1           TP Tattoo Numbe
      *
     C           KLCHSJ    KLIST
     C                     KFLD           WEHONB           CC Company Numb
     C                     KFLD           WEEZDT           TP Tattoo Date
     C                     KFLD           WEHSA1           TP Tattoo Numbe
     C           KLCHSJ    CHAIN@FJCPHV              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFJCPL0'MDACP
     C                     MOVEL'@FJCPHV' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFJ1    YBRDCS
      * Move non-key fields to @FJCPHV
     C                     Z-ADD#1HMNB    WEHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    WEBONB           BOL Load Number
     C                     MOVEL'A'       WEWQST    P      TP Tattoo Statu
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WEAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WEAADT    PARM *ZERO     WQ0070  70       *DATE
     C           WEAMTM    PARM *ZERO     WQ0071  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@FJCPHV                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFJCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Val Ttt,Kll/bohld RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQSK01           BOH Company Num
     C           *LIKE     DEFN WBBNNB    WQSK02           BOH Buy Order N
     C           *LIKE     DEFN WBBONB    WQSK03           BOL Load Number
     C           *LIKE     DEFN WBCVNB    WQSK04           TH Tattoo Numbe
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           BOH Company Num
     C                     KFLD           WQSK02           BOH Buy Order N
     C                     KFLD           WQSK03           BOL Load Number
     C                     KFLD           WQSK04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADD#1HMNB    WQSK01           BOH Company Num
     C                     Z-ADD#1BNNB    WQSK02           BOH Buy Order N
     C                     Z-ADD#1BONB    WQSK03           BOL Load Number
     C                     Z-ADD#1CVNB    WQSK04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSK     SETLL@A1CPOI                    *
     C           KRSSK     READE@A1CPOI                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQSL01           BOH Company Num
     C           *LIKE     DEFN WAB0DT    WQSL02           TH Kill Date
     C           *LIKE     DEFN WACVNB    WQSL03           TH Tattoo Numbe
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           BOH Company Num
     C                     KFLD           WQSL02           TH Kill Date
     C                     KFLD           WQSL03           TH Tattoo Numbe
      * Setup key
     C                     Z-ADD#1HMNB    WQSL01           BOH Company Num
     C                     Z-ADD#1B0DT    WQSL02           TH Kill Date
     C                     Z-ADD#1CVNB    WQSL03           TH Tattoo Numbe
      * Establish starting position
     C           KRSSL     SETLL@A1CPL0                    *
     C           KRSSL     READE@A1CPL0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQSM01           BOH Company Num
     C           *LIKE     DEFN WAB0DT    WQSM02           TH Kill Date
     C           *LIKE     DEFN WACVNB    WQSM03           TH Tattoo Numbe
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           BOH Company Num
     C                     KFLD           WQSM02           TH Kill Date
     C                     KFLD           WQSM03           TH Tattoo Numbe
      * Setup key
     C                     Z-ADD#1HMNB    WQSM01           BOH Company Num
     C                     Z-ADD#1B0DT    WQSM02           TH Kill Date
     C                     Z-ADD#1CVNB    WQSM03           TH Tattoo Numbe
      * Establish starting position
     C           KRSSM     SETLL@A1CPL0                    *
     C           KRSSM     READE@A1CPL0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Val Ttt,Kll Dt    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQSN01           BOH Company Num
     C           *LIKE     DEFN WAB0DT    WQSN02           TH Kill Date
     C           *LIKE     DEFN WACVNB    WQSN03           TH Tattoo Numbe
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           BOH Company Num
     C                     KFLD           WQSN02           TH Kill Date
     C                     KFLD           WQSN03           TH Tattoo Numbe
      * Setup key
     C                     Z-ADD#1HMNB    WQSN01           BOH Company Num
     C                     Z-ADD#1B0DT    WQSN02           TH Kill Date
     C                     Z-ADD#1CVNB    WQSN03           TH Tattoo Numbe
      * Establish starting position
     C           KRSSN     SETLL@A1CPL0                    *
     C           KRSSN     READE@A1CPL0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Producer Nm, Srce RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WMABCD           PD Producer Cod
      * Setup key
     C                     MOVEL#1ABCD    WMABCD           PD Producer Cod
      * Establish starting position
     C           KRSSO     CHAIN@ACREAI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0009' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #PAGTX           PD Name
     C                     MOVEL*BLANK    WUAACD           SR Source Code
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWMAGTX    #PAGTX           PD Name
     C                     MOVELWMAACD    WUAACD           SR Source Code
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Source Type       RT - Source  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WOAACD           SR Source Code
      * Setup key
     C                     MOVELWUAACD    WOAACD           SR Source Code
      * Establish starting position
     C           KRSSP     CHAIN@AAREAC              90    *
      * Data record not found
     C   90                MOVEL'PRK0005' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWOIXST    WUIXST           SR Type
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * H16853 ISE 01/23/21 - Increased the length from 5 to 7 and correc
      *                       alignment of Buy Order Number field.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C           YPMTFD    IFEQ '#1HMNB'
     C           YPMTFD    OREQ '#1BNNB'
     C           YPMTFD    OREQ '#1BONB'
     C           YPMTFD    OREQ '#1CVNB'
     C           YPMTFD    OREQ '#1B0DT'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1HMNB' defaulted for 'BOH Company Number'.
      * Field '(DTL) #1CVNB' defaulted for 'TH Tattoo Number'.
      * Field '(DTL) #1B0DT' defaulted for 'TH Kill Date'.
     C                     CALL 'PKB7SRR'              90  Sel Kill/Tattoo
     C                     PARM *BLANK    W0RTN   7
     C           #1HMNB    PARM #1HMNB    WQ0072  30       BOH Company Num
     C           #1CVNB    PARM #1CVNB    WQ0073  50       TH Tattoo Numbe
     C           #1B0DT    PARM #1B0DT    WQ0074  70       TH Kill Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKB7SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9931  *
     C                     END
      *
     C           #1HMNB    IFNE *ZERO                      BOH Company Num
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BNNB    IFNE *ZERO                      BOH Buy Order N
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BONB    IFNE *ZERO                      BOL Load Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1CVNB    IFNE *ZERO                      TH Tattoo Numbe
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1B0DT    IFNE *ZERO                      TH Kill Date
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Buy Order Load
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1HMNB'
     C           YPMTFD    OREQ '#1BNNB'
     C           YPMTFD    OREQ '#1BONB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1HMNB' defaulted for 'BOH Company Number'.
      * Field '(DTL) #1BNNB' defaulted for 'BOH Buy Order Number'.
      * Field '(DTL) #1BONB' defaulted for 'BOL Load Number'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ABCD' defaulted for 'PD Producer Code'.
      * Field '(DTL) #1AECD' defaulted for 'PL Location Code'.
     C                     CALL 'PKQJSRR'              90  Sel Producer BO
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0075  30       BOH Company Num
     C           #1BNNB    PARM #1BNNB    WQ0076  70       BOH Buy Order N
     C           #1BONB    PARM #1BONB    WQ0077  50       BOL Load Number
     C                     PARM #1ABCD    WQ0078  6        PD Producer Cod
     C                     PARM #1AECD    WQ0079  6        PL Location Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKQJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1HMNB    IFNE *ZERO                      BOH Company Num
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BNNB    IFNE *ZERO                      BOH Buy Order N
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BONB    IFNE *ZERO                      BOL Load Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1HMNB    IFEQ *ZERO                      BOH Company Num
     C           #1BNNB    ANDEQ*ZERO                      BOH Buy Order N
     C           #1BONB    ANDEQ*ZERO                      BOL Load Number
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBWF    KLIST
     C                     KFLD           WFHMNB           BOH Company Num
     C                     KFLD           WFBNNB           BOH Buy Order N
     C                     KFLD           WFBONB           BOL Load Number
      * Setup key
     C                     Z-ADD#1HMNB    WFHMNB
     C                     Z-ADD#1BNNB    WFBNNB
     C                     Z-ADD#1BONB    WFBONB
     C           KLVBWF    CHAIN@AXCPBX              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Buy Order Load         NF'
     C                     MOVEL'PRK0051' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0051' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Hog Defect
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BDCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        DF Defect Code
     C           YPMTFD    OREQ '#1BDCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BDCD' defaulted for 'DF Defect Code'.
     C                     CALL 'PKCWSRR'              90  Sel Hog Defect
     C                     PARM *BLANK    W0RTN   7
     C           #1BDCD    PARM #1BDCD    WQ0080  6        DF Defect Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKCWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1BDCD    IFNE *BLANK                     DF Defect Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BDCD    IFEQ *BLANK                     DF Defect Code
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCWG    KLIST
     C                     KFLD           WGBDCD           DF Defect Code
      * Setup key
     C                     MOVEL#1BDCD    WGBDCD
     C           KLVCWG    CHAIN@A7REC1              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Hog Defect             NF'
     C                     MOVEL'PRK0073' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0073' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Tattoo Header Process
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1CSCD    IFEQ *BLANK                     THP Process Cod
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDWH    KLIST
     C                     KFLD           WHCSCD           THP Process Cod
      * Setup key
     C                     MOVEL#1CSCD    WHCSCD
     C           KLVDWH    CHAIN@CCREH3              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Tattoo Header Process  NF'
     C                     MOVEL'PRK0172' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0172' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to Producer Location
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1ABCD    WK1X01  1
     C                     MOVEL#1AECD    WK1X02  1
     C           WK1X01    IFEQ '?'                        PD Producer Cod
     C           YPMTFD    OREQ '#1ABCD'
     C           WK1X02    OREQ '?'                        PL Location Cod
     C           YPMTFD    OREQ '#1AECD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ABCD' defaulted for 'PD Producer Code'.
      * Field '(DTL) #1AECD' defaulted for 'PL Location Code'.
     C                     CALL 'PWF5SRR'              90  Sel Prod Loc by
     C                     PARM *BLANK    W0RTN   7
     C           #1ABCD    PARM #1ABCD    WQ0081  6        PD Producer Cod
     C           #1AECD    PARM #1AECD    WQ0082  6        PL Location Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWF5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1ABCD    IFNE *BLANK                     PD Producer Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1AECD    IFNE *BLANK                     PL Location Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ABCD    IFEQ *BLANK                     PD Producer Cod
     C           #1AECD    ANDEQ*BLANK                     PL Location Cod
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEWI    KLIST
     C                     KFLD           WIABCD           PD Producer Cod
     C                     KFLD           WIAECD           PL Location Cod
      * Setup key
     C                     MOVEL#1ABCD    WIABCD
     C                     MOVEL#1AECD    WIAECD
     C           KLVEWI    CHAIN@AFREAR              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      * Send message 'Producer Location      NF'
     C                     MOVEL'PRK0015' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0015' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to Hog Buyer
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1ACCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        HB Buyer Code
     C           YPMTFD    OREQ '#1ACCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ACCD' defaulted for 'HB Buyer Code'.
     C                     CALL 'PKD3SRR'              90  Sel Hog Buyer
     C                     PARM *BLANK    W0RTN   7
     C           #1ACCD    PARM #1ACCD    WQ0083  3        HB Buyer Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKD3SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1ACCD    IFNE *BLANK                     HB Buyer Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VFEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ACCD    IFEQ *BLANK                     HB Buyer Code
     C                     GOTO VFEXIT
     C                     END
      *
     C           KLVFWJ    KLIST
     C                     KFLD           WJACCD           HB Buyer Code
      * Setup key
     C                     MOVEL#1ACCD    WJACCD
     C           KLVFWJ    CHAIN@ADREAF              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VFEXIT
     C                     END
      * Send message 'Hog Buyer              NF'
     C                     MOVEL'PRK0011' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0011' W0RTN
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         VGCKRL    BEGSR
      *================================================================
      * Check reference to Genetic
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AGCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        GN Genetic Code
     C           YPMTFD    OREQ '#1AGCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AGCD' defaulted for 'GN Genetic Code'.
     C                     CALL 'PKNASRR'              90  Sel Genetic Act
     C                     PARM *BLANK    W0RTN   7
     C           #1AGCD    PARM #1AGCD    WQ0084  5        GN Genetic Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKNASRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AGCD    IFNE *BLANK                     GN Genetic Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VGEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AGCD    IFEQ *BLANK                     GN Genetic Code
     C                     GOTO VGEXIT
     C                     END
      *
     C           KLVGWK    KLIST
     C                     KFLD           WKAGCD           GN Genetic Code
      * Setup key
     C                     MOVEL#1AGCD    WKAGCD
     C           KLVGWK    CHAIN@AIREA9              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VGEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VGEXIT
     C                     END
      * Send message 'Genetic                NF'
     C                     MOVEL'PRK0021' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0021' W0RTN
      *================================================================
     CSR         VGEXIT    ENDSR
      /EJECT
     CSR         VHCKRL    BEGSR
      *================================================================
      * Check reference to Hog Classification
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BECD    WK1X01  1
     C           WK1X01    IFEQ '?'                        HC Class Code
     C           YPMTFD    OREQ '#1BECD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BECD' defaulted for 'HC Class Code'.
     C                     CALL 'PKC0SRR'              90  Sel Hog Classif
     C                     PARM *BLANK    W0RTN   7
     C           #1BECD    PARM #1BECD    WQ0085  3        HC Class Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKC0SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1BECD    IFNE *BLANK                     HC Class Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VHEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BECD    IFEQ *BLANK                     HC Class Code
     C                     GOTO VHEXIT
     C                     END
      *
     C           KLVHWL    KLIST
     C                     KFLD           WLBECD           HC Class Code
      * Setup key
     C                     MOVEL#1BECD    WLBECD
     C           KLVHWL    CHAIN@A8REDA              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VHEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VHEXIT
     C                     END
      * Send message 'Hog Classification     NF'
     C                     MOVEL'PRK0075' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0075' W0RTN
      *================================================================
     CSR         VHEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 012
     C           ZHCSCL    ANDGE024
     C           ZHCSCL    ANDLE028
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1CVNB'  YPMTFD           TH Tattoo Numbe
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM 'PKO6PVRH'W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Record Added Usr
     C                     MOVEL*BLANK    WUIHST  1
      * Define work field User modified: 0-not modi
     C                     MOVEL*BLANK    WUUMOD  1
      * Define work field Company Value Code    USR
     C                     MOVEL*BLANK    WUFACD 10
      * Define work field Tattoo Nbr Group
     C                     Z-ADD*ZERO     WUB3NZ  50
      * Define work field Tattoo Nbr Group Seq
     C                     Z-ADD*ZERO     WUB4NZ  50
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Return Code USR
     C                     MOVEL*BLANK    WULMST  7
      * Define work field SR Type
     C                     MOVEL*BLANK    WUIXST  1
      * Define work field TH Tattoo Number
     C                     Z-ADD*ZERO     WUCVNB  50
      * Define work field Tattoo Number USR
     C                     Z-ADD*ZERO     WUKENB  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WAAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WAACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WAB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WACAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WAAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WAA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WACXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WACWNB           TH Head Receive
     C                     Z-ADD*ZERO     WAFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WAH9NB           TH Held Over
     C                     Z-ADD*ZERO     WAFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WAFENB           TH Head Killed
     C                     Z-ADD*ZERO     WAHENB           TH Head Adds
     C                     Z-ADD*ZERO     WAHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WACYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WALRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WAE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WAA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WAFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WAA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WAF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WAHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WAF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WAF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WAF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WAF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WAAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WAAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WACWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WAA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WAA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WAB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WAAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WAANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WAAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WAAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WAAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WAAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WAAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WAASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WAA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WAATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WAA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WACBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WACCPR           Th Payment Net
     C                     Z-ADD*ZERO     WALPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WACDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WAA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WAA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WAGHNB           TH Commission A
     C                     Z-ADD*ZERO     WABYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WABSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WABTDT           TH Commission P
     C                     Z-ADD*ZERO     WABUDT           TH Actual Check
     C                     Z-ADD*ZERO     WAHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WAHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WAHINB           TH FFLI
     C                     Z-ADD*ZERO     WAA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WAA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WAA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WAJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WAD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WAD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WAD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WAD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WAEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WAEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WAECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WAEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WAEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WAEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WAEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WAEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WAOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WATHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WAT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WATHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WAT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WAOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WAKOER           TH Head Identif
     C                     Z-ADD*ZERO     WAOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WAOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WAIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WAOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WAHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WAS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WATAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WATBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WAJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WAKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WAKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WAKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WAKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WAOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WAIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WAIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WAIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WAKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WAOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WAKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WAORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WAOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WAMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WAMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WANCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WANCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WAIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WAKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WAEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WAEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WAECDT           TH Head LFT
     C                     Z-ADD*ZERO     WAEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WAEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHONB           CC Company Numb
     C                     Z-ADD*ZERO     WCEZDT           TP Tattoo Date
     C                     Z-ADD*ZERO     WCHSA1           TP Tattoo Numbe
     C                     Z-ADD*ZERO     WCHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WCBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WCBONB           BOL Load Number
     C                     Z-ADD*ZERO     WCHRA1           Employee ID
     C                     Z-ADD*ZERO     WCBKTM           TP Tattoo Creat
     C                     Z-ADD*ZERO     WCMIA1           Employee Number
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Define work field Tto Nbr Chk Int/Other Usr
     C                     MOVEL*BLANK    WUP8ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WFBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WFBONB           BOL Load Number
     C                     Z-ADD*ZERO     WFCQDT           BOL Kill Date
     C                     Z-ADD*ZERO     WFABTH           BOL Pln Delv St
     C                     Z-ADD*ZERO     WFACTH           BOL Pln Delv En
     C                     Z-ADD*ZERO     WFBPNB           BOL Pln Head De
     C                     Z-ADD*ZERO     WFCSNB           BOL Shipped Wgt
     C                     Z-ADD*ZERO     WFAUDT           BOL Pln Delv Da
     C                     Z-ADD*ZERO     WFAGPR           BOL Freight Uni
     C                     Z-ADD*ZERO     WFATVA           BOL Freight Amt
     C                     Z-ADD*ZERO     WFDHNB           BOL Head Receiv
     C                     Z-ADD*ZERO     WFDINB           BOL Live Wgt Re
     C                     Z-ADD*ZERO     WFGINB           BOL Trucker Che
     C                     Z-ADD*ZERO     WFBZDT           BOL Trucker Che
     C                     Z-ADD*ZERO     WFLSNB           BOL AP Voucher
     C                     Z-ADD*ZERO     WFLDSH           BOL Shipped Hea
     C                     Z-ADD*ZERO     WFJKRU           BOL HPS Movemen
     C                     Z-ADD*ZERO     WFKEOR           BOL Head LFT
     C                     Z-ADD*ZERO     WFIOEW           BOL Head EUT/KO
     C                     Z-ADD*ZERO     WFKJIO           BOL Auth Gate E
     C                     Z-ADD*ZERO     WFIOJR           BOL Head Receiv
     C                     Z-ADD*ZERO     WFEIRR           BOL Unused Wgt
     C                     Z-ADD*ZERO     WFITMF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WFODJE           BOL Unused Wgt
     C                     Z-ADD*ZERO     WFRJIF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WFOEJF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WFD0DT           BOL Auth Gate E
     C                     Z-ADD*ZERO     WFD1DT           BOL Unused Date
     C                     Z-ADD*ZERO     WFD2DT           BOL Unused Date
     C                     Z-ADD*ZERO     WFD3DT           BOL Unused Date
     C                     Z-ADD*ZERO     WFD4DT           BOL Unused Date
     C                     Z-ADD*ZERO     WFAADT           RS Date Changed
     C                     Z-ADD*ZERO     WFAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WFABDT           RS Date Added
     C                     Z-ADD*ZERO     WFABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAEA1           DF Market Perce
     C                     Z-ADD*ZERO     WGUOPR           DF Unused Price
     C                     Z-ADD*ZERO     WGUPPR           DF Unused Price
     C                     Z-ADD*ZERO     WGUQPR           DF Unused Price
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAADT           RS Date Changed
     C                     Z-ADD*ZERO     WHAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WHABDT           RS Date Added
     C                     Z-ADD*ZERO     WHABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIGLNB           Pl VND Address
     C                     Z-ADD*ZERO     WIASNB           PL Miles/Unused
     C                     Z-ADD*ZERO     WIHWNB           PL Primary Comp
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WIABDT           RS Date Added
     C                     Z-ADD*ZERO     WIABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAADT           RS Date Changed
     C                     Z-ADD*ZERO     WJAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WJABDT           RS Date Added
     C                     Z-ADD*ZERO     WJABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAADT           RS Date Changed
     C                     Z-ADD*ZERO     WKAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WKABDT           RS Date Added
     C                     Z-ADD*ZERO     WKABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAADT           RS Date Changed
     C                     Z-ADD*ZERO     WLAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WLABDT           RS Date Added
     C                     Z-ADD*ZERO     WLABTM           RS Time Added
      * Define work field SR Source Code
     C                     MOVEL*BLANK    WUAACD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMALNB           PD Production C
     C                     Z-ADD*ZERO     WMAATH           PD Std Delv Tim
     C                     Z-ADD*ZERO     WMAMNB           PD Std Truck Si
     C                     Z-ADD*ZERO     WMGCNB           PD VND Address
     C                     Z-ADD*ZERO     WMGJNB           PD EDI Trading
     C                     Z-ADD*ZERO     WMAADT           RS Date Changed
     C                     Z-ADD*ZERO     WMAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WMABDT           RS Date Added
     C                     Z-ADD*ZERO     WMABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local work field Tattoo Off Truck USR
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field TP Tattoo Date
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field System Value Alpha    USR
     C                     MOVEL*BLANK    YL0003 40
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * HPE076
      * C1108 -- Duplicate Tattoo Problem
      *   PKLYDTR -- WW Tattoo
      *   PKL0E1R -- Edt TTt Hdr
      *   PKO6PVR-- Edt Ttt Hdr (PV)
      * Mov ApplN to Company  US - STR User Source Functions  * 
     C***   MOVE USER SOURCE                      ***
     C                     MOVELP2EVTX    ##CMP
      * Tattoo Off Truck Company Value
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0109  30       BOH Company Num
     C                     PARM @CN,003   WQ0110 10        Company Value C
     C           YL0001    PARM *BLANK    WQ0111 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
** W0BEG
01048010570130401313015600158501816
02072025840258803096
** W0END
01053010960130901352015660158901823
02079025840260203100
** W0NAM
#1ABCD    #PAGTX    #1AECD    #PA8TX    #1BNNB    #1BONB    V1B0DT
V1AWDT    #1LLST    #DE6TX    #1CVNB
** @CN
00001 Y2U0005
00002 TATTASSGN
00003 TTOOFFTRK
