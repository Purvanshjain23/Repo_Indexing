     H/TITLE EDT Post Opn Japan Ord XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     W* Warning: This program does not set on the LR indicator
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 06/16/21  Time  : 15:56:01
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAASREL2IF  E           K        DISK
      * RTV : Company Control           Retrieval index       NV
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCABBRELAIF  E           K        DISK
      * RTV : Customer                  Active Only
      *
     FOMFLCPL2IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop/Order
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FPDLGCPL2IF  E           K        DISK
      * RSQ : Legal Run Mileage Hours   Rtv Index w/ Desc Miles
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FPDLHCPLHIF  E           K        DISK
      * RSQ : Load Order Change Log     Load/Order/Type
      *
     FARBCREL5IF  E           K        DISK
      * RSQ : A/R Summary               RSQ Cust/Company       N
      *
     FCABBRELCIF  E           K        DISK
      * RSQ : Customer                  RSQ Parent # Active
      *
     FOPBGWKLJIF  E           K        DISK
      * RSQ : Order Detail              Co/Ord/Seqs/not Canc/Cnf
      *
     FPPBUREL1IF  E           K        DISK
      * RTV : PFS Interface             Retrieval index
      *
     FPDNDCPL3IF  E           K        DISK
      * RSQ : Ham Group Order           Co/Ord/HamGrp
      *
     FOMFJCPLLIF  E           K        DISK
      * RSQ : Load Header               Load Only
      *
     FOPEXREL2IF  E           K        DISK
      * RTV : Order Types               Active order Types
      *
     FARBCREL1IF  E           K        DISK
      * RTV : A/R Summary               Retrieval index       NV
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     FOMFLCPL0UF  E           K        DISK
      * UPD : Load Detail               Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FPDNDCPL0UF  E           K        DISK                      A
      * UPD : Ham Group Order           Update index
      *
     FPDNCCPL0IF  E           K        DISK                      A
      * UPD : Ham Group Customer        Update index
      *
     FARBCREL0UF  E           K        DISK                      A
      * UPD : A/R Summary               Update index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@ASREGT
      * Company Control           Retrieval index       NV
      * Renamed input format fields
     I              ASAIC3                          WAAIC3
     I              ASAXNB                          WAAXNB
     I              ASNGNB                          WANGNB
     I              ASBZNB                          WABZNB
     I              ASC5NB                          WAC5NB
     I              ASC3NB                          WAC3NB
     I              ASCYNB                          WACYNB
     I              ASIONB                          WAIONB
     I              ASI6NB                          WAI6NB
     I              ASDCNB                          WADCNB
     I              ASC7NB                          WAC7NB
     I              ASC2NB                          WAC2NB
     I              ASC1NB                          WAC1NB
     I              ASL8NB                          WAL8NB
     I              ASBANB                          WABANB
     I              ASCHST                          WACHST
     I              ASCKST                          WACKST
     I              ASCIST                          WACIST
     I              ASCGST                          WACGST
     I              ASAIPC                          WAAIPC
     I              ASASPC                          WAASPC
     I              ASA2VA                          WAA2VA
     I              ASC2ST                          WAC2ST
     I              ASD8ST                          WAD8ST
     I              ASD7ST                          WAD7ST
     I              ASA8NA                          WAA8NA
     I              ASA9NA                          WAA9NA
     I              ASBANA                          WABANA
     I              ASBBNA                          WABBNA
     I              ASEUST                          WAEUST
     I              ASAADY                          WAAADY
     I              ASABDY                          WAABDY
     I              ASACDY                          WAACDY
     I              ASADDY                          WAADDY
     I              ASAEDY                          WAAEDY
     I              ASAFDY                          WAAFDY
     I              ASAGDY                          WAAGDY
     I              ASAHDY                          WAAHDY
     I              ASAENB                          WAAENB
     I              ASALNB                          WAALNB
     I              ASEVNB                          WAEVNB
     I              ASRPOP                          WARPOP
     I              ASDWNB                          WADWNB
     I              ASR3NB                          WAR3NB
     I              ASPNST                          WAPNST
     I              ASR4NB                          WAR4NB
     I              ASPOST                          WAPOST
     I              ASSCNB                          WASCNB
     I              ASVIST                          WAVIST
     I              ASVJST                          WAVJST
     I              ASBVVN                          WABVVN
     I              ASUVST                          WAUVST
     I              ASUWST                          WAUWST
     I              ASUXST                          WAUXST
     I              ASVSST                          WAVSST
     I              ASAATM                          WAAATM
     I              ASAYNA                          WAAYNA
     I              ASA0NA                          WAA0NA
     I              ASAXDT                          WAAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WCRMNB
     I              FJAIC3                          WCAIC3
     I              FJAODT                          WCAODT
     I              FJPJST                          WCPJST
     I              FJPKST                          WCPKST
     I              FJRNNB                          WCRNNB
     I              FJDMTX                          WCDMTX
     I              FJDNTX                          WCDNTX
     I              FJDOTX                          WCDOTX
     I              FJWTTX                          WCWTTX
     I              FJWUTX                          WCWUTX
     I              FJRPNB                          WCRPNB
     I              FJFLAM                          WCFLAM
     I              FJXQST                          WCXQST
     I              FJRRNB                          WCRRNB
     I              FJDXTX                          WCDXTX
     I              FJDYTX                          WCDYTX
     I              FJSBNB                          WCSBNB
     I              FJBZNA                          WCBZNA
     I              FJRONB                          WCRONB
     I              FJSQNB                          WCSQNB
     I              FJR1NB                          WCR1NB
     I              FJVCST                          WCVCST
     I              FJVDST                          WCVDST
     I              FJSDNB                          WCSDNB
     I              FJPAOU                          WCPAOU
     I              FJDGWG                          WCDGWG
     I              FJSXNB                          WCSXNB
     I              FJHADT                          WCHADT
     I              FJAART                          WCAART
     I              FJDHWG                          WCDHWG
     I              FJDIWG                          WCDIWG
     I              FJAQDT                          WCAQDT
     I              FJS6NB                          WCS6NB
     I              FJT4NB                          WCT4NB
     I              FJPRTM                          WCPRTM
     I              FJNPSV                          WCNPSV
     I              FJJ8TX                          WCJ8TX
     I              FJTLMI                          WCTLMI
     I              FJJ9TX                          WCJ9TX
     I              FJQ2CD                          WCQ2CD
     I              FJVPCD                          WCVPCD
     I              FJDBCD                          WCDBCD
     I              FJGRWE                          WCGRWE
     I              FJXCCD                          WCXCCD
     I              FJU2ST                          WCU2ST
     I              FJF9DT                          WCF9DT
     I              FJONTM                          WCONTM
     I              FJJ4DT                          WCJ4DT
     I              FJTRTM                          WCTRTM
     I              FJJ5DT                          WCJ5DT
     I              FJSPTM                          WCSPTM
     I              FJJ6DT                          WCJ6DT
     I              FJLFTM                          WCLFTM
     I              FJJ7DT                          WCJ7DT
     I              FJBOTM                          WCBOTM
     I              FJJ8DT                          WCJ8DT
     I              FJBLTM                          WCBLTM
     I              FJKIDT                          WCKIDT
     I              FJASTM                          WCASTM
     I              FJKADT                          WCKADT
     I              FJAJCM                          WCAJCM
     I              FJXACD                          WCXACD
     I              FJOANA                          WCOANA
     I              FJK4TX                          WCK4TX
     I              FJVOAG                          WCVOAG
     I              FJKBDT                          WCKBDT
     I              FJNBBO                          WCNBBO
     I              FJW4CD                          WCW4CD
     I              FJEFDT                          WCEFDT
     I              FJCNTN                          WCCNTN
     I              FJKCDT                          WCKCDT
     I              FJTMIN                          WCTMIN
     I              FJKDDT                          WCKDDT
     I              FJVMNB                          WCVMNB
     I              FJOCFR                          WCOCFR
     I              FJKJDT                          WCKJDT
     I              FJATTM                          WCATTM
     I              FJOTRS                          WCOTRS
     I              FJRNST                          WCRNST
     I              FJBRBK                          WCBRBK
     I              FJEIDT                          WCEIDT
     I              FJRMST                          WCRMST
     I              FJAJCD                          WCAJCD
     I              FJKKDT                          WCKKDT
     I              FJAVTM                          WCAVTM
     I              FJKZDT                          WCKZDT
     I              FJAXTM                          WCAXTM
     I              FJLHOS                          WCLHOS
     I              FJLHOR                          WCLHOR
     I              FJWNTX                          WCWNTX
     I              FJOITX                          WCOITX
     I              FJOJTX                          WCOJTX
     I              FJLLDT                          WCLLDT
     I              FJLSHG                          WCLSHG
     I              FJYPST                          WCYPST
     I              FJK0DT                          WCK0DT
     I              FJAYTM                          WCAYTM
     I              FJKNNX                          WCKNNX
     I              FJICWG                          WCICWG
     I              FJIDWG                          WCIDWG
     I              FJH9SX                          WCH9SX
     I              FJWOTX                          WCWOTX
     I              FJK1DT                          WCK1DT
     I              FJAZTM                          WCAZTM
     I              FJK2DT                          WCK2DT
     I              FJA0TM                          WCA0TM
     I              FJROST                          WCROST
     I              FJRPST                          WCRPST
     I              FJRQST                          WCRQST
     I              FJRRST                          WCRRST
     I              FJZBVA                          WCZBVA
     I              FJWPTX                          WCWPTX
     I              FJWQTX                          WCWQTX
     I              FJWRTX                          WCWRTX
     I              FJWSTX                          WCWSTX
     I              FJRVSX                          WCRVSX
     I              FJRUSX                          WCRUSX
     I              FJRWSX                          WCRWSX
     I              FJRXSX                          WCRXSX
     I              FJRYSX                          WCRYSX
     I              FJRZSX                          WCRZSX
     I              FJR0SX                          WCR0SX
     I              FJR1SX                          WCR1SX
     I              FJR2SX                          WCR2SX
     I              FJR3SX                          WCR3SX
     I              FJR4SX                          WCR4SX
     I              FJPYDT                          WCPYDT
     I              FJCKTM                          WCCKTM
     I              FJPZDT                          WCPZDT
     I              FJCLTM                          WCCLTM
     I              FJP0DT                          WCP0DT
     I              FJCMTM                          WCCMTM
     I              FJP1DT                          WCP1DT
     I              FJCNTM                          WCCNTM
     I              FJP2DT                          WCP2DT
     I              FJCOTM                          WCCOTM
     I              FJP3DT                          WCP3DT
     I              FJCQTM                          WCCQTM
     I              FJUVST                          WCUVST
     I              FJUWST                          WCUWST
     I              FJUXST                          WCUXST
     I              FJAATM                          WCAATM
     I              FJAYNA                          WCAYNA
     I              FJA0NA                          WCA0NA
     I              FJAXDT                          WCAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WDAIC3
     I              OMC4NB                          WDC4NB
     I              OMDPNB                          WDDPNB
     I              OMUENB                          WDUENB
     I              OMHGCD                          WDHGCD
     I              OMAJCD                          WDAJCD
     I              OMBKC7                          WDBKC7
     I              OMCFC7                          WDCFC7
     I              OMGMST                          WDGMST
     I              OMGNST                          WDGNST
     I              OMMAVA                          WDMAVA
     I              OMKDVA                          WDKDVA
     I              OML8VA                          WDL8VA
     I              OML9VA                          WDL9VA
     I              OMGTST                          WDGTST
     I              OMGVST                          WDGVST
     I              OMGUST                          WDGUST
     I              OMQFST                          WDQFST
     I              OMAYVA                          WDAYVA
     I              OMEXDT                          WDEXDT
     I              OMLQCD                          WDLQCD
     I              OMRDCD                          WDRDCD
     I              OMQ7CD                          WDQ7CD
     I              OMBZPR                          WDBZPR
     I              OML6NB                          WDL6NB
     I              OMU1ST                          WDU1ST
     I              OMGIDT                          WDGIDT
     I              OMCRCD                          WDCRCD
     I              OMAGCD                          WDAGCD
     I              OMRZST                          WDRZST
     I              OMR0ST                          WDR0ST
     I              OMR1ST                          WDR1ST
     I              OMG7NA                          WDG7NA
     I              OMG8NA                          WDG8NA
     I              OMRPCD                          WDRPCD
     I              OMVEST                          WDVEST
     I              OMVGST                          WDVGST
     I              OMAVST                          WDAVST
     I              OMU0ST                          WDU0ST
     I              OMRFCD                          WDRFCD
     I              OMFZST                          WDFZST
     I              OMR1NB                          WDR1NB
     I              OMAVQT                          WDAVQT
     I              OMD0WG                          WDD0WG
     I              OMCCQT                          WDCCQT
     I              OMAUWG                          WDAUWG
     I              OMCBQT                          WDCBQT
     I              OMATWG                          WDATWG
     I              OMAQCS                          WDAQCS
     I              OMAGCS                          WDAGCS
     I              OMAKPR                          WDAKPR
     I              OMALPR                          WDALPR
     I              OMAUPR                          WDAUPR
     I              OMAVWG                          WDAVWG
     I              OMA4WG                          WDA4WG
     I              OMA5DT                          WDA5DT
     I              OMAODT                          WDAODT
     I              OMGNDT                          WDGNDT
     I              OMAMST                          WDAMST
     I              OMANST                          WDANST
     I              OMVAST                          WDVAST
     I              OMRGNB                          WDRGNB
     I              OMRHNB                          WDRHNB
     I              OMRINB                          WDRINB
     I              OMRBCD                          WDRBCD
     I              OMHICD                          WDHICD
     I              OMRNCD                          WDRNCD
     I              OMROCD                          WDROCD
     I              OMCXDT                          WDCXDT
     I              OMAJVN                          WDAJVN
     I              OMKXCD                          WDKXCD
     I              OMJPCD                          WDJPCD
     I              OMCQCD                          WDCQCD
     I              OMR4CD                          WDR4CD
     I              OMZ1ST                          WDZ1ST
     I              OMZ3ST                          WDZ3ST
     I              OMZ4ST                          WDZ4ST
     I              OMDUPR                          WDDUPR
     I              OMB6VL                          WDB6VL
     I              OMA1AA                          WDA1AA
     I              OMFZSX                          WDFZSX
     I              OMF0SX                          WDF0SX
     I              OMF1SX                          WDF1SX
     I              OMF2SX                          WDF2SX
     I              OMF3SX                          WDF3SX
     I              OMF4SX                          WDF4SX
     I              OMF5SX                          WDF5SX
     I              OMF6SX                          WDF6SX
     I              OMF7SX                          WDF7SX
     I              OMNTDT                          WDNTDT
     I              OMNUDT                          WDNUDT
     I              OMNVDT                          WDNVDT
     I              OMNWDT                          WDNWDT
     I              OMNXDT                          WDNXDT
     I              OMBUTM                          WDBUTM
     I              OMBVTM                          WDBVTM
     I              OMBWTM                          WDBWTM
     I              OMBXTM                          WDBXTM
     I              OMBYTM                          WDBYTM
     I              OMH5NX                          WDH5NX
     I              OMH6NX                          WDH6NX
     I              OMH7NX                          WDH7NX
     I              OMH8NX                          WDH8NX
     I              OMH9NX                          WDH9NX
     I              OMDVPR                          WDDVPR
     I              OMDWPR                          WDDWPR
     I              OMDXPR                          WDDXPR
     I              OMDYPR                          WDDYPR
     I              OMDZPR                          WDDZPR
     I              OMGSPR                          WDGSPR
     I              OMGTPR                          WDGTPR
     I              OMGUPR                          WDGUPR
     I              OMHOST                          WDHOST
     I              OMHPST                          WDHPST
     I              OMIOST                          WDIOST
     I              OMPEWG                          WDPEWG
     I              OMRINY                          WDRINY
     I              OMTIDT                          WDTIDT
     I              OMTJDT                          WDTJDT
     I              OMH2ST                          WDH2ST
     I              OMH0ST                          WDH0ST
     I              OMH1ST                          WDH1ST
     I              OMTKDT                          WDTKDT
     I              OMTLDT                          WDTLDT
     I              OMTMDT                          WDTMDT
     I              OMUVST                          WDUVST
     I              OMUWST                          WDUWST
     I              OMUXST                          WDUXST
     I              OMAATM                          WDAATM
     I              OMAYNA                          WDAYNA
     I              OMA0NA                          WDA0NA
     I              OMAXDT                          WDAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WEAIC3
     I              OMC4NB                          WEC4NB
     I              OMDPNB                          WEDPNB
     I              OMUENB                          WEUENB
     I              OMHGCD                          WEHGCD
     I              OMAJCD                          WEAJCD
     I              OMBKC7                          WEBKC7
     I              OMCFC7                          WECFC7
     I              OMGMST                          WEGMST
     I              OMGNST                          WEGNST
     I              OMMAVA                          WEMAVA
     I              OMKDVA                          WEKDVA
     I              OML8VA                          WEL8VA
     I              OML9VA                          WEL9VA
     I              OMGTST                          WEGTST
     I              OMGVST                          WEGVST
     I              OMGUST                          WEGUST
     I              OMQFST                          WEQFST
     I              OMAYVA                          WEAYVA
     I              OMEXDT                          WEEXDT
     I              OMLQCD                          WELQCD
     I              OMRDCD                          WERDCD
     I              OMQ7CD                          WEQ7CD
     I              OMBZPR                          WEBZPR
     I              OML6NB                          WEL6NB
     I              OMU1ST                          WEU1ST
     I              OMGIDT                          WEGIDT
     I              OMCRCD                          WECRCD
     I              OMAGCD                          WEAGCD
     I              OMRZST                          WERZST
     I              OMR0ST                          WER0ST
     I              OMR1ST                          WER1ST
     I              OMG7NA                          WEG7NA
     I              OMG8NA                          WEG8NA
     I              OMRPCD                          WERPCD
     I              OMVEST                          WEVEST
     I              OMVGST                          WEVGST
     I              OMAVST                          WEAVST
     I              OMU0ST                          WEU0ST
     I              OMRFCD                          WERFCD
     I              OMFZST                          WEFZST
     I              OMR1NB                          WER1NB
     I              OMAVQT                          WEAVQT
     I              OMD0WG                          WED0WG
     I              OMCCQT                          WECCQT
     I              OMAUWG                          WEAUWG
     I              OMCBQT                          WECBQT
     I              OMATWG                          WEATWG
     I              OMAQCS                          WEAQCS
     I              OMAGCS                          WEAGCS
     I              OMAKPR                          WEAKPR
     I              OMALPR                          WEALPR
     I              OMAUPR                          WEAUPR
     I              OMAVWG                          WEAVWG
     I              OMA4WG                          WEA4WG
     I              OMA5DT                          WEA5DT
     I              OMAODT                          WEAODT
     I              OMGNDT                          WEGNDT
     I              OMAMST                          WEAMST
     I              OMANST                          WEANST
     I              OMVAST                          WEVAST
     I              OMRGNB                          WERGNB
     I              OMRHNB                          WERHNB
     I              OMRINB                          WERINB
     I              OMRBCD                          WERBCD
     I              OMHICD                          WEHICD
     I              OMRNCD                          WERNCD
     I              OMROCD                          WEROCD
     I              OMCXDT                          WECXDT
     I              OMAJVN                          WEAJVN
     I              OMKXCD                          WEKXCD
     I              OMJPCD                          WEJPCD
     I              OMCQCD                          WECQCD
     I              OMR4CD                          WER4CD
     I              OMZ1ST                          WEZ1ST
     I              OMZ3ST                          WEZ3ST
     I              OMZ4ST                          WEZ4ST
     I              OMDUPR                          WEDUPR
     I              OMB6VL                          WEB6VL
     I              OMA1AA                          WEA1AA
     I              OMFZSX                          WEFZSX
     I              OMF0SX                          WEF0SX
     I              OMF1SX                          WEF1SX
     I              OMF2SX                          WEF2SX
     I              OMF3SX                          WEF3SX
     I              OMF4SX                          WEF4SX
     I              OMF5SX                          WEF5SX
     I              OMF6SX                          WEF6SX
     I              OMF7SX                          WEF7SX
     I              OMNTDT                          WENTDT
     I              OMNUDT                          WENUDT
     I              OMNVDT                          WENVDT
     I              OMNWDT                          WENWDT
     I              OMNXDT                          WENXDT
     I              OMBUTM                          WEBUTM
     I              OMBVTM                          WEBVTM
     I              OMBWTM                          WEBWTM
     I              OMBXTM                          WEBXTM
     I              OMBYTM                          WEBYTM
     I              OMH5NX                          WEH5NX
     I              OMH6NX                          WEH6NX
     I              OMH7NX                          WEH7NX
     I              OMH8NX                          WEH8NX
     I              OMH9NX                          WEH9NX
     I              OMDVPR                          WEDVPR
     I              OMDWPR                          WEDWPR
     I              OMDXPR                          WEDXPR
     I              OMDYPR                          WEDYPR
     I              OMDZPR                          WEDZPR
     I              OMGSPR                          WEGSPR
     I              OMGTPR                          WEGTPR
     I              OMGUPR                          WEGUPR
     I              OMHOST                          WEHOST
     I              OMHPST                          WEHPST
     I              OMIOST                          WEIOST
     I              OMPEWG                          WEPEWG
     I              OMRINY                          WERINY
     I              OMTIDT                          WETIDT
     I              OMTJDT                          WETJDT
     I              OMH2ST                          WEH2ST
     I              OMH0ST                          WEH0ST
     I              OMH1ST                          WEH1ST
     I              OMTKDT                          WETKDT
     I              OMTLDT                          WETLDT
     I              OMTMDT                          WETMDT
     I              OMUVST                          WEUVST
     I              OMUWST                          WEUWST
     I              OMUXST                          WEUXST
     I              OMAATM                          WEAATM
     I              OMAYNA                          WEAYNA
     I              OMA0NA                          WEA0NA
     I              OMAXDT                          WEAXDT
      *
     I@BBREWG
      * Customer                  Active Only
      * Renamed input format fields
     I              BBBKC7                          WFBKC7
     I              BBAYTX                          WFAYTX
     I              BBACNA                          WFACNA
     I              BBADNA                          WFADNA
     I              BBAENA                          WFAENA
     I              BBAJNA                          WFAJNA
     I              BBBGCD                          WFBGCD
     I              BBG5CD                          WFG5CD
     I              BBBTTX                          WFBTTX
     I              BBBVTX                          WFBVTX
     I              BBBWTX                          WFBWTX
     I              BBABTX                          WFABTX
     I              BBA2NA                          WFA2NA
     I              BBCBST                          WFCBST
     I              BBB0NA                          WFB0NA
     I              BBP3NB                          WFP3NB
     I              BBAXNA                          WFAXNA
     I              BBI6DT                          WFI6DT
     I              BBAYDT                          WFAYDT
     I              BBANC7                          WFANC7
     I              BBBTC7                          WFBTC7
     I              BBK6ST                          WFK6ST
     I              BBUZST                          WFUZST
     I              BBKXCD                          WFKXCD
     I              BBLTCD                          WFLTCD
     I              BBQNST                          WFQNST
     I              BBS2NB                          WFS2NB
     I              BBVHVA                          WFVHVA
     I              BBI7DT                          WFI7DT
     I              BBRJST                          WFRJST
     I              BBRKST                          WFRKST
     I              BBQWST                          WFQWST
     I              BBQXST                          WFQXST
     I              BBQYST                          WFQYST
     I              BBUNCS                          WFUNCS
     I              BBUVST                          WFUVST
     I              BBUWST                          WFUWST
     I              BBUXST                          WFUXST
     I              BBVSST                          WFVSST
     I              BBAATM                          WFAATM
     I              BBAYNA                          WFAYNA
     I              BBA0NA                          WFA0NA
     I              BBAXDT                          WFAXDT
      *
     I@FLCPEB
      * Load Detail               Load/Stop/Order
      * Renamed input format fields
     I              FLRMNB                          WGRMNB
     I              FLRUNB                          WGRUNB
     I              FLRVNB                          WGRVNB
     I              FLDQTX                          WGDQTX
     I              FLRWNB                          WGRWNB
     I              FLRXNB                          WGRXNB
     I              FLSQNB                          WGSQNB
     I              FLT0NB                          WGT0NB
     I              FLT1NB                          WGT1NB
     I              FLR1NB                          WGR1NB
     I              FLAIC3                          WGAIC3
     I              FLC4NB                          WGC4NB
     I              FLVCST                          WGVCST
     I              FLKEDT                          WGKEDT
     I              FLSXNB                          WGSXNB
     I              FLKFDT                          WGKFDT
     I              FLACTM                          WGACTM
     I              FLK5TX                          WGK5TX
     I              FLW5CD                          WGW5CD
     I              FLEJDT                          WGEJDT
     I              FLAGTM                          WGAGTM
     I              FLKJDT                          WGKJDT
     I              FLATTM                          WGATTM
     I              FLHDDT                          WGHDDT
     I              FLAUTM                          WGAUTM
     I              FLKKDT                          WGKKDT
     I              FLAVTM                          WGAVTM
     I              FLZ4NB                          WGZ4NB
     I              FLY7ST                          WGY7ST
     I              FLY2ST                          WGY2ST
     I              FLWHTX                          WGWHTX
     I              FLWITX                          WGWITX
     I              FLWJTX                          WGWJTX
     I              FLWKTX                          WGWKTX
     I              FLWLTX                          WGWLTX
     I              FLN7DT                          WGN7DT
     I              FLN8DT                          WGN8DT
     I              FLN9DT                          WGN9DT
     I              FLB3TM                          WGB3TM
     I              FLB4TM                          WGB4TM
     I              FLB5TM                          WGB5TM
     I              FLIASX                          WGIASX
     I              FLIBSX                          WGIBSX
     I              FLICSX                          WGICSX
     I              FLWVTX                          WGWVTX
     I              FLWWTX                          WGWWTX
     I              FLWXTX                          WGWXTX
     I              FLUVST                          WGUVST
     I              FLUWST                          WGUWST
     I              FLUXST                          WGUXST
     I              FLAATM                          WGAATM
     I              FLAYNA                          WGAYNA
     I              FLA0NA                          WGA0NA
     I              FLAXDT                          WGAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WHAIC3
     I              OMC4NB                          WHC4NB
     I              OMDPNB                          WHDPNB
     I              OMUENB                          WHUENB
     I              OMHGCD                          WHHGCD
     I              OMAJCD                          WHAJCD
     I              OMBKC7                          WHBKC7
     I              OMCFC7                          WHCFC7
     I              OMGMST                          WHGMST
     I              OMGNST                          WHGNST
     I              OMMAVA                          WHMAVA
     I              OMKDVA                          WHKDVA
     I              OML8VA                          WHL8VA
     I              OML9VA                          WHL9VA
     I              OMGTST                          WHGTST
     I              OMGVST                          WHGVST
     I              OMGUST                          WHGUST
     I              OMQFST                          WHQFST
     I              OMAYVA                          WHAYVA
     I              OMEXDT                          WHEXDT
     I              OMLQCD                          WHLQCD
     I              OMRDCD                          WHRDCD
     I              OMQ7CD                          WHQ7CD
     I              OMBZPR                          WHBZPR
     I              OML6NB                          WHL6NB
     I              OMU1ST                          WHU1ST
     I              OMGIDT                          WHGIDT
     I              OMCRCD                          WHCRCD
     I              OMAGCD                          WHAGCD
     I              OMRZST                          WHRZST
     I              OMR0ST                          WHR0ST
     I              OMR1ST                          WHR1ST
     I              OMG7NA                          WHG7NA
     I              OMG8NA                          WHG8NA
     I              OMRPCD                          WHRPCD
     I              OMVEST                          WHVEST
     I              OMVGST                          WHVGST
     I              OMAVST                          WHAVST
     I              OMU0ST                          WHU0ST
     I              OMRFCD                          WHRFCD
     I              OMFZST                          WHFZST
     I              OMR1NB                          WHR1NB
     I              OMAVQT                          WHAVQT
     I              OMD0WG                          WHD0WG
     I              OMCCQT                          WHCCQT
     I              OMAUWG                          WHAUWG
     I              OMCBQT                          WHCBQT
     I              OMATWG                          WHATWG
     I              OMAQCS                          WHAQCS
     I              OMAGCS                          WHAGCS
     I              OMAKPR                          WHAKPR
     I              OMALPR                          WHALPR
     I              OMAUPR                          WHAUPR
     I              OMAVWG                          WHAVWG
     I              OMA4WG                          WHA4WG
     I              OMA5DT                          WHA5DT
     I              OMAODT                          WHAODT
     I              OMGNDT                          WHGNDT
     I              OMAMST                          WHAMST
     I              OMANST                          WHANST
     I              OMVAST                          WHVAST
     I              OMRGNB                          WHRGNB
     I              OMRHNB                          WHRHNB
     I              OMRINB                          WHRINB
     I              OMRBCD                          WHRBCD
     I              OMHICD                          WHHICD
     I              OMRNCD                          WHRNCD
     I              OMROCD                          WHROCD
     I              OMCXDT                          WHCXDT
     I              OMAJVN                          WHAJVN
     I              OMKXCD                          WHKXCD
     I              OMJPCD                          WHJPCD
     I              OMCQCD                          WHCQCD
     I              OMR4CD                          WHR4CD
     I              OMZ1ST                          WHZ1ST
     I              OMZ3ST                          WHZ3ST
     I              OMZ4ST                          WHZ4ST
     I              OMDUPR                          WHDUPR
     I              OMB6VL                          WHB6VL
     I              OMA1AA                          WHA1AA
     I              OMFZSX                          WHFZSX
     I              OMF0SX                          WHF0SX
     I              OMF1SX                          WHF1SX
     I              OMF2SX                          WHF2SX
     I              OMF3SX                          WHF3SX
     I              OMF4SX                          WHF4SX
     I              OMF5SX                          WHF5SX
     I              OMF6SX                          WHF6SX
     I              OMF7SX                          WHF7SX
     I              OMNTDT                          WHNTDT
     I              OMNUDT                          WHNUDT
     I              OMNVDT                          WHNVDT
     I              OMNWDT                          WHNWDT
     I              OMNXDT                          WHNXDT
     I              OMBUTM                          WHBUTM
     I              OMBVTM                          WHBVTM
     I              OMBWTM                          WHBWTM
     I              OMBXTM                          WHBXTM
     I              OMBYTM                          WHBYTM
     I              OMH5NX                          WHH5NX
     I              OMH6NX                          WHH6NX
     I              OMH7NX                          WHH7NX
     I              OMH8NX                          WHH8NX
     I              OMH9NX                          WHH9NX
     I              OMDVPR                          WHDVPR
     I              OMDWPR                          WHDWPR
     I              OMDXPR                          WHDXPR
     I              OMDYPR                          WHDYPR
     I              OMDZPR                          WHDZPR
     I              OMGSPR                          WHGSPR
     I              OMGTPR                          WHGTPR
     I              OMGUPR                          WHGUPR
     I              OMHOST                          WHHOST
     I              OMHPST                          WHHPST
     I              OMIOST                          WHIOST
     I              OMPEWG                          WHPEWG
     I              OMRINY                          WHRINY
     I              OMTIDT                          WHTIDT
     I              OMTJDT                          WHTJDT
     I              OMH2ST                          WHH2ST
     I              OMH0ST                          WHH0ST
     I              OMH1ST                          WHH1ST
     I              OMTKDT                          WHTKDT
     I              OMTLDT                          WHTLDT
     I              OMTMDT                          WHTMDT
     I              OMUVST                          WHUVST
     I              OMUWST                          WHUWST
     I              OMUXST                          WHUXST
     I              OMAATM                          WHAATM
     I              OMAYNA                          WHAYNA
     I              OMA0NA                          WHA0NA
     I              OMAXDT                          WHAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WIAJCD
     I              ADF8NA                          WIF8NA
     I              ADACNA                          WIACNA
     I              ADADNA                          WIADNA
     I              ADAENA                          WIAENA
     I              ADAJNA                          WIAJNA
     I              ADBTTX                          WIBTTX
     I              ADAOCD                          WIAOCD
     I              ADBGCD                          WIBGCD
     I              ADVHST                          WIVHST
     I              ADMPNA                          WIMPNA
     I              ADWPST                          WIWPST
     I              ADXUST                          WIXUST
     I              ADT0ST                          WIT0ST
     I              ADT1ST                          WIT1ST
     I              ADDBNB                          WIDBNB
     I              ADT2ST                          WIT2ST
     I              ADT3ST                          WIT3ST
     I              ADT4ST                          WIT4ST
     I              ADT6ST                          WIT6ST
     I              ADBWC3                          WIBWC3
     I              ADBTC3                          WIBTC3
     I              ADBUC3                          WIBUC3
     I              ADBVC3                          WIBVC3
     I              ADFCAA                          WIFCAA
     I              ADRQSX                          WIRQSX
     I              ADRRSX                          WIRRSX
     I              ADRSSX                          WIRSSX
     I              ADRTSX                          WIRTSX
     I              ADT7ST                          WIT7ST
     I              ADT8ST                          WIT8ST
     I              ADRNSX                          WIRNSX
     I              ADROSX                          WIROSX
     I              ADRPSX                          WIRPSX
     I              ADUVST                          WIUVST
     I              ADUWST                          WIUWST
     I              ADUXST                          WIUXST
     I              ADVSST                          WIVSST
     I              ADAATM                          WIAATM
     I              ADAYNA                          WIAYNA
     I              ADA0NA                          WIA0NA
     I              ADAXDT                          WIAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WJRMNB
     I              FJAIC3                          WJAIC3
     I              FJAODT                          WJAODT
     I              FJPJST                          WJPJST
     I              FJPKST                          WJPKST
     I              FJRNNB                          WJRNNB
     I              FJDMTX                          WJDMTX
     I              FJDNTX                          WJDNTX
     I              FJDOTX                          WJDOTX
     I              FJWTTX                          WJWTTX
     I              FJWUTX                          WJWUTX
     I              FJRPNB                          WJRPNB
     I              FJFLAM                          WJFLAM
     I              FJXQST                          WJXQST
     I              FJRRNB                          WJRRNB
     I              FJDXTX                          WJDXTX
     I              FJDYTX                          WJDYTX
     I              FJSBNB                          WJSBNB
     I              FJBZNA                          WJBZNA
     I              FJRONB                          WJRONB
     I              FJSQNB                          WJSQNB
     I              FJR1NB                          WJR1NB
     I              FJVCST                          WJVCST
     I              FJVDST                          WJVDST
     I              FJSDNB                          WJSDNB
     I              FJPAOU                          WJPAOU
     I              FJDGWG                          WJDGWG
     I              FJSXNB                          WJSXNB
     I              FJHADT                          WJHADT
     I              FJAART                          WJAART
     I              FJDHWG                          WJDHWG
     I              FJDIWG                          WJDIWG
     I              FJAQDT                          WJAQDT
     I              FJS6NB                          WJS6NB
     I              FJT4NB                          WJT4NB
     I              FJPRTM                          WJPRTM
     I              FJNPSV                          WJNPSV
     I              FJJ8TX                          WJJ8TX
     I              FJTLMI                          WJTLMI
     I              FJJ9TX                          WJJ9TX
     I              FJQ2CD                          WJQ2CD
     I              FJVPCD                          WJVPCD
     I              FJDBCD                          WJDBCD
     I              FJGRWE                          WJGRWE
     I              FJXCCD                          WJXCCD
     I              FJU2ST                          WJU2ST
     I              FJF9DT                          WJF9DT
     I              FJONTM                          WJONTM
     I              FJJ4DT                          WJJ4DT
     I              FJTRTM                          WJTRTM
     I              FJJ5DT                          WJJ5DT
     I              FJSPTM                          WJSPTM
     I              FJJ6DT                          WJJ6DT
     I              FJLFTM                          WJLFTM
     I              FJJ7DT                          WJJ7DT
     I              FJBOTM                          WJBOTM
     I              FJJ8DT                          WJJ8DT
     I              FJBLTM                          WJBLTM
     I              FJKIDT                          WJKIDT
     I              FJASTM                          WJASTM
     I              FJKADT                          WJKADT
     I              FJAJCM                          WJAJCM
     I              FJXACD                          WJXACD
     I              FJOANA                          WJOANA
     I              FJK4TX                          WJK4TX
     I              FJVOAG                          WJVOAG
     I              FJKBDT                          WJKBDT
     I              FJNBBO                          WJNBBO
     I              FJW4CD                          WJW4CD
     I              FJEFDT                          WJEFDT
     I              FJCNTN                          WJCNTN
     I              FJKCDT                          WJKCDT
     I              FJTMIN                          WJTMIN
     I              FJKDDT                          WJKDDT
     I              FJVMNB                          WJVMNB
     I              FJOCFR                          WJOCFR
     I              FJKJDT                          WJKJDT
     I              FJATTM                          WJATTM
     I              FJOTRS                          WJOTRS
     I              FJRNST                          WJRNST
     I              FJBRBK                          WJBRBK
     I              FJEIDT                          WJEIDT
     I              FJRMST                          WJRMST
     I              FJAJCD                          WJAJCD
     I              FJKKDT                          WJKKDT
     I              FJAVTM                          WJAVTM
     I              FJKZDT                          WJKZDT
     I              FJAXTM                          WJAXTM
     I              FJLHOS                          WJLHOS
     I              FJLHOR                          WJLHOR
     I              FJWNTX                          WJWNTX
     I              FJOITX                          WJOITX
     I              FJOJTX                          WJOJTX
     I              FJLLDT                          WJLLDT
     I              FJLSHG                          WJLSHG
     I              FJYPST                          WJYPST
     I              FJK0DT                          WJK0DT
     I              FJAYTM                          WJAYTM
     I              FJKNNX                          WJKNNX
     I              FJICWG                          WJICWG
     I              FJIDWG                          WJIDWG
     I              FJH9SX                          WJH9SX
     I              FJWOTX                          WJWOTX
     I              FJK1DT                          WJK1DT
     I              FJAZTM                          WJAZTM
     I              FJK2DT                          WJK2DT
     I              FJA0TM                          WJA0TM
     I              FJROST                          WJROST
     I              FJRPST                          WJRPST
     I              FJRQST                          WJRQST
     I              FJRRST                          WJRRST
     I              FJZBVA                          WJZBVA
     I              FJWPTX                          WJWPTX
     I              FJWQTX                          WJWQTX
     I              FJWRTX                          WJWRTX
     I              FJWSTX                          WJWSTX
     I              FJRVSX                          WJRVSX
     I              FJRUSX                          WJRUSX
     I              FJRWSX                          WJRWSX
     I              FJRXSX                          WJRXSX
     I              FJRYSX                          WJRYSX
     I              FJRZSX                          WJRZSX
     I              FJR0SX                          WJR0SX
     I              FJR1SX                          WJR1SX
     I              FJR2SX                          WJR2SX
     I              FJR3SX                          WJR3SX
     I              FJR4SX                          WJR4SX
     I              FJPYDT                          WJPYDT
     I              FJCKTM                          WJCKTM
     I              FJPZDT                          WJPZDT
     I              FJCLTM                          WJCLTM
     I              FJP0DT                          WJP0DT
     I              FJCMTM                          WJCMTM
     I              FJP1DT                          WJP1DT
     I              FJCNTM                          WJCNTM
     I              FJP2DT                          WJP2DT
     I              FJCOTM                          WJCOTM
     I              FJP3DT                          WJP3DT
     I              FJCQTM                          WJCQTM
     I              FJUVST                          WJUVST
     I              FJUWST                          WJUWST
     I              FJUXST                          WJUXST
     I              FJAATM                          WJAATM
     I              FJAYNA                          WJAYNA
     I              FJA0NA                          WJA0NA
     I              FJAXDT                          WJAXDT
      *
     I@LGCPNM
      * Legal Run Mileage Hours   Rtv Index w/ Desc Miles
      * Renamed input format fields
     I              LGMILE                          WKMILE
     I              LGHRRQ                          WKHRRQ
     I              LGAATM                          WKAATM
     I              LGAYNA                          WKAYNA
     I              LGA0NA                          WKA0NA
     I              LGAXDT                          WKAXDT
      *
     I@FLCPBW
      * Load Detail               Retrieval index
      * Renamed input format fields
     I              FLRMNB                          WLRMNB
     I              FLRUNB                          WLRUNB
     I              FLRVNB                          WLRVNB
     I              FLDQTX                          WLDQTX
     I              FLRWNB                          WLRWNB
     I              FLRXNB                          WLRXNB
     I              FLSQNB                          WLSQNB
     I              FLT0NB                          WLT0NB
     I              FLT1NB                          WLT1NB
     I              FLR1NB                          WLR1NB
     I              FLAIC3                          WLAIC3
     I              FLC4NB                          WLC4NB
     I              FLVCST                          WLVCST
     I              FLKEDT                          WLKEDT
     I              FLSXNB                          WLSXNB
     I              FLKFDT                          WLKFDT
     I              FLACTM                          WLACTM
     I              FLK5TX                          WLK5TX
     I              FLW5CD                          WLW5CD
     I              FLEJDT                          WLEJDT
     I              FLAGTM                          WLAGTM
     I              FLKJDT                          WLKJDT
     I              FLATTM                          WLATTM
     I              FLHDDT                          WLHDDT
     I              FLAUTM                          WLAUTM
     I              FLKKDT                          WLKKDT
     I              FLAVTM                          WLAVTM
     I              FLZ4NB                          WLZ4NB
     I              FLY7ST                          WLY7ST
     I              FLY2ST                          WLY2ST
     I              FLWHTX                          WLWHTX
     I              FLWITX                          WLWITX
     I              FLWJTX                          WLWJTX
     I              FLWKTX                          WLWKTX
     I              FLWLTX                          WLWLTX
     I              FLN7DT                          WLN7DT
     I              FLN8DT                          WLN8DT
     I              FLN9DT                          WLN9DT
     I              FLB3TM                          WLB3TM
     I              FLB4TM                          WLB4TM
     I              FLB5TM                          WLB5TM
     I              FLIASX                          WLIASX
     I              FLIBSX                          WLIBSX
     I              FLICSX                          WLICSX
     I              FLWVTX                          WLWVTX
     I              FLWWTX                          WLWWTX
     I              FLWXTX                          WLWXTX
     I              FLUVST                          WLUVST
     I              FLUWST                          WLUWST
     I              FLUXST                          WLUXST
     I              FLAATM                          WLAATM
     I              FLAYNA                          WLAYNA
     I              FLA0NA                          WLA0NA
     I              FLAXDT                          WLAXDT
      *
     I@FLCPBM
      * Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WMRMNB
     I              FLRUNB                          WMRUNB
     I              FLRVNB                          WMRVNB
     I              FLDQTX                          WMDQTX
     I              FLRWNB                          WMRWNB
     I              FLRXNB                          WMRXNB
     I              FLSQNB                          WMSQNB
     I              FLT0NB                          WMT0NB
     I              FLT1NB                          WMT1NB
     I              FLR1NB                          WMR1NB
     I              FLAIC3                          WMAIC3
     I              FLC4NB                          WMC4NB
     I              FLVCST                          WMVCST
     I              FLKEDT                          WMKEDT
     I              FLSXNB                          WMSXNB
     I              FLKFDT                          WMKFDT
     I              FLACTM                          WMACTM
     I              FLK5TX                          WMK5TX
     I              FLW5CD                          WMW5CD
     I              FLEJDT                          WMEJDT
     I              FLAGTM                          WMAGTM
     I              FLKJDT                          WMKJDT
     I              FLATTM                          WMATTM
     I              FLHDDT                          WMHDDT
     I              FLAUTM                          WMAUTM
     I              FLKKDT                          WMKKDT
     I              FLAVTM                          WMAVTM
     I              FLZ4NB                          WMZ4NB
     I              FLY7ST                          WMY7ST
     I              FLY2ST                          WMY2ST
     I              FLWHTX                          WMWHTX
     I              FLWITX                          WMWITX
     I              FLWJTX                          WMWJTX
     I              FLWKTX                          WMWKTX
     I              FLWLTX                          WMWLTX
     I              FLN7DT                          WMN7DT
     I              FLN8DT                          WMN8DT
     I              FLN9DT                          WMN9DT
     I              FLB3TM                          WMB3TM
     I              FLB4TM                          WMB4TM
     I              FLB5TM                          WMB5TM
     I              FLIASX                          WMIASX
     I              FLIBSX                          WMIBSX
     I              FLICSX                          WMICSX
     I              FLWVTX                          WMWVTX
     I              FLWWTX                          WMWWTX
     I              FLWXTX                          WMWXTX
     I              FLUVST                          WMUVST
     I              FLUWST                          WMUWST
     I              FLUXST                          WMUXST
     I              FLAATM                          WMAATM
     I              FLAYNA                          WMAYNA
     I              FLA0NA                          WMA0NA
     I              FLAXDT                          WMAXDT
      *
     I@LHCPHB
      * Load Order Change Log     Load/Order/Type
      * Renamed input format fields
     I              LHK4DT                          WOK4DT
     I              LHA1TM                          WOA1TM
     I              LHDXNB                          WODXNB
     I              LHRMNB                          WORMNB
     I              LHRVNB                          WORVNB
     I              LHRVST                          WORVST
     I              LHUJST                          WOUJST
     I              LHMNTX                          WOMNTX
     I              LHMOTX                          WOMOTX
     I              LHAYNA                          WOAYNA
     I              LHA0NA                          WOA0NA
     I              LHBZNA                          WOBZNA
     I              LHXMCD                          WOXMCD
     I              LHAIC3                          WOAIC3
     I              LHC4NB                          WOC4NB
      *
     I@BCREEC
      * A/R Summary               RSQ Cust/Company       N
      * Renamed input format fields
     I              BCAIC3                          WRAIC3
     I              BCANC7                          WRANC7
     I              BCAGVA                          WRAGVA
     I              BCACVA                          WRACVA
     I              BCADVA                          WRADVA
     I              BCAEVA                          WRAEVA
     I              BCAFVA                          WRAFVA
     I              BCAHVA                          WRAHVA
     I              BCVIVA                          WRVIVA
     I              BCVJVA                          WRVJVA
     I              BCVKVA                          WRVKVA
     I              BCVLVA                          WRVLVA
     I              BCVMVA                          WRVMVA
     I              BCVNVA                          WRVNVA
     I              BCEEVA                          WREEVA
     I              BCAKTM                          WRAKTM
     I              BCAHDT                          WRAHDT
     I              BCANDT                          WRANDT
     I              BCANVA                          WRANVA
     I              BCALDT                          WRALDT
     I              BCAMVA                          WRAMVA
     I              BCAIDT                          WRAIDT
     I              BCALVA                          WRALVA
     I              BCDJNB                          WRDJNB
     I              BCDLNB                          WRDLNB
     I              BCDDNB                          WRDDNB
     I              BCDMNB                          WRDMNB
     I              BCDUDT                          WRDUDT
     I              BCLYNO                          WRLYNO
     I              BCLYNC                          WRLYNC
     I              BCLYNP                          WRLYNP
     I              BCLYNI                          WRLYNI
     I              BCADPM                          WRADPM
     I              BCVOVA                          WRVOVA
     I              BCBTDY                          WRBTDY
     I              BCBUDY                          WRBUDY
     I              BCVPVA                          WRVPVA
     I              BCVQVA                          WRVQVA
     I              BCBCCD                          WRBCCD
     I              BCR4CD                          WRR4CD
     I              BCCUMO                          WRCUMO
     I              BCUVST                          WRUVST
     I              BCUWST                          WRUWST
     I              BCUXST                          WRUXST
     I              BCAATM                          WRAATM
     I              BCAYNA                          WRAYNA
     I              BCA0NA                          WRA0NA
     I              BCAXDT                          WRAXDT
      *
     I@BBREXK
      * Customer                  RSQ Parent # Active
      * Renamed input format fields
     I              BBBKC7                          WSBKC7
     I              BBAYTX                          WSAYTX
     I              BBACNA                          WSACNA
     I              BBADNA                          WSADNA
     I              BBAENA                          WSAENA
     I              BBAJNA                          WSAJNA
     I              BBBGCD                          WSBGCD
     I              BBG5CD                          WSG5CD
     I              BBBTTX                          WSBTTX
     I              BBBVTX                          WSBVTX
     I              BBBWTX                          WSBWTX
     I              BBABTX                          WSABTX
     I              BBA2NA                          WSA2NA
     I              BBCBST                          WSCBST
     I              BBB0NA                          WSB0NA
     I              BBP3NB                          WSP3NB
     I              BBAXNA                          WSAXNA
     I              BBI6DT                          WSI6DT
     I              BBAYDT                          WSAYDT
     I              BBANC7                          WSANC7
     I              BBBTC7                          WSBTC7
     I              BBK6ST                          WSK6ST
     I              BBUZST                          WSUZST
     I              BBKXCD                          WSKXCD
     I              BBLTCD                          WSLTCD
     I              BBQNST                          WSQNST
     I              BBS2NB                          WSS2NB
     I              BBVHVA                          WSVHVA
     I              BBI7DT                          WSI7DT
     I              BBRJST                          WSRJST
     I              BBRKST                          WSRKST
     I              BBQWST                          WSQWST
     I              BBQXST                          WSQXST
     I              BBQYST                          WSQYST
     I              BBUNCS                          WSUNCS
     I              BBUVST                          WSUVST
     I              BBUWST                          WSUWST
     I              BBUXST                          WSUXST
     I              BBVSST                          WSVSST
     I              BBAATM                          WSAATM
     I              BBAYNA                          WSAYNA
     I              BBA0NA                          WSA0NA
     I              BBAXDT                          WSAXDT
      *
     I@BGWKKK
      * Order Detail              Co/Ord/Seqs/not Canc/Cnf
      * Renamed input format fields
     I              OMAIC3                          WTAIC3
     I              OMC4NB                          WTC4NB
     I              OMDPNB                          WTDPNB
     I              OMUENB                          WTUENB
     I              OMHGCD                          WTHGCD
     I              OMAJCD                          WTAJCD
     I              OMBKC7                          WTBKC7
     I              OMCFC7                          WTCFC7
     I              OMGMST                          WTGMST
     I              OMGNST                          WTGNST
     I              OMMAVA                          WTMAVA
     I              OMKDVA                          WTKDVA
     I              OML8VA                          WTL8VA
     I              OML9VA                          WTL9VA
     I              OMGTST                          WTGTST
     I              OMGVST                          WTGVST
     I              OMGUST                          WTGUST
     I              OMQFST                          WTQFST
     I              OMAYVA                          WTAYVA
     I              OMEXDT                          WTEXDT
     I              OMLQCD                          WTLQCD
     I              OMRDCD                          WTRDCD
     I              OMQ7CD                          WTQ7CD
     I              OMBZPR                          WTBZPR
     I              OML6NB                          WTL6NB
     I              OMU1ST                          WTU1ST
     I              OMGIDT                          WTGIDT
     I              OMCRCD                          WTCRCD
     I              OMAGCD                          WTAGCD
     I              OMRZST                          WTRZST
     I              OMR0ST                          WTR0ST
     I              OMR1ST                          WTR1ST
     I              OMG7NA                          WTG7NA
     I              OMG8NA                          WTG8NA
     I              OMRPCD                          WTRPCD
     I              OMVEST                          WTVEST
     I              OMVGST                          WTVGST
     I              OMAVST                          WTAVST
     I              OMU0ST                          WTU0ST
     I              OMRFCD                          WTRFCD
     I              OMFZST                          WTFZST
     I              OMR1NB                          WTR1NB
     I              OMAVQT                          WTAVQT
     I              OMD0WG                          WTD0WG
     I              OMCCQT                          WTCCQT
     I              OMAUWG                          WTAUWG
     I              OMCBQT                          WTCBQT
     I              OMATWG                          WTATWG
     I              OMAQCS                          WTAQCS
     I              OMAGCS                          WTAGCS
     I              OMAKPR                          WTAKPR
     I              OMALPR                          WTALPR
     I              OMAUPR                          WTAUPR
     I              OMAVWG                          WTAVWG
     I              OMA4WG                          WTA4WG
     I              OMA5DT                          WTA5DT
     I              OMAODT                          WTAODT
     I              OMGNDT                          WTGNDT
     I              OMAMST                          WTAMST
     I              OMANST                          WTANST
     I              OMVAST                          WTVAST
     I              OMRGNB                          WTRGNB
     I              OMRHNB                          WTRHNB
     I              OMRINB                          WTRINB
     I              OMRBCD                          WTRBCD
     I              OMHICD                          WTHICD
     I              OMRNCD                          WTRNCD
     I              OMROCD                          WTROCD
     I              OMCXDT                          WTCXDT
     I              OMAJVN                          WTAJVN
     I              OMKXCD                          WTKXCD
     I              OMJPCD                          WTJPCD
     I              OMCQCD                          WTCQCD
     I              OMR4CD                          WTR4CD
     I              OMZ1ST                          WTZ1ST
     I              OMZ3ST                          WTZ3ST
     I              OMZ4ST                          WTZ4ST
     I              OMDUPR                          WTDUPR
     I              OMB6VL                          WTB6VL
     I              OMA1AA                          WTA1AA
     I              OMFZSX                          WTFZSX
     I              OMF0SX                          WTF0SX
     I              OMF1SX                          WTF1SX
     I              OMF2SX                          WTF2SX
     I              OMF3SX                          WTF3SX
     I              OMF4SX                          WTF4SX
     I              OMF5SX                          WTF5SX
     I              OMF6SX                          WTF6SX
     I              OMF7SX                          WTF7SX
     I              OMNTDT                          WTNTDT
     I              OMNUDT                          WTNUDT
     I              OMNVDT                          WTNVDT
     I              OMNWDT                          WTNWDT
     I              OMNXDT                          WTNXDT
     I              OMBUTM                          WTBUTM
     I              OMBVTM                          WTBVTM
     I              OMBWTM                          WTBWTM
     I              OMBXTM                          WTBXTM
     I              OMBYTM                          WTBYTM
     I              OMH5NX                          WTH5NX
     I              OMH6NX                          WTH6NX
     I              OMH7NX                          WTH7NX
     I              OMH8NX                          WTH8NX
     I              OMH9NX                          WTH9NX
     I              OMDVPR                          WTDVPR
     I              OMDWPR                          WTDWPR
     I              OMDXPR                          WTDXPR
     I              OMDYPR                          WTDYPR
     I              OMDZPR                          WTDZPR
     I              OMGSPR                          WTGSPR
     I              OMGTPR                          WTGTPR
     I              OMGUPR                          WTGUPR
     I              OMHOST                          WTHOST
     I              OMHPST                          WTHPST
     I              OMIOST                          WTIOST
     I              OMPEWG                          WTPEWG
     I              OMRINY                          WTRINY
     I              OMTIDT                          WTTIDT
     I              OMTJDT                          WTTJDT
     I              OMH2ST                          WTH2ST
     I              OMH0ST                          WTH0ST
     I              OMH1ST                          WTH1ST
     I              OMTKDT                          WTTKDT
     I              OMTLDT                          WTTLDT
     I              OMTMDT                          WTTMDT
     I              OMUVST                          WTUVST
     I              OMUWST                          WTUWST
     I              OMUXST                          WTUXST
     I              OMAATM                          WTAATM
     I              OMAYNA                          WTAYNA
     I              OMA0NA                          WTA0NA
     I              OMAXDT                          WTAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WVAIC3
     I              BEC4NB                          WVC4NB
     I              BEJNCD                          WVJNCD
     I              BEANC7                          WVANC7
     I              BEBKC7                          WVBKC7
     I              BEBRTX                          WVBRTX
     I              BEHMNA                          WVHMNA
     I              BEHONA                          WVHONA
     I              BEHPNA                          WVHPNA
     I              BEHNNA                          WVHNNA
     I              BEDBCD                          WVDBCD
     I              BECKTX                          WVCKTX
     I              BEB0C7                          WVB0C7
     I              BEAETX                          WVAETX
     I              BEB1NA                          WVB1NA
     I              BEB3NA                          WVB3NA
     I              BEB4NA                          WVB4NA
     I              BEB2NA                          WVB2NA
     I              BEBHCD                          WVBHCD
     I              BEC8TX                          WVC8TX
     I              BEBCNA                          WVBCNA
     I              BEA0DT                          WVA0DT
     I              BEA5DT                          WVA5DT
     I              BEGNDT                          WVGNDT
     I              BEACDT                          WVACDT
     I              BEAQCD                          WVAQCD
     I              BEB6NA                          WVB6NA
     I              BEBYNA                          WVBYNA
     I              BEBZNA                          WVBZNA
     I              BEGTST                          WVGTST
     I              BEGVST                          WVGVST
     I              BEGUST                          WVGUST
     I              BEQFST                          WVQFST
     I              BECQCD                          WVCQCD
     I              BEGJST                          WVGJST
     I              BEGWST                          WVGWST
     I              BEGXST                          WVGXST
     I              BEGYST                          WVGYST
     I              BEAODT                          WVAODT
     I              BEAIVN                          WVAIVN
     I              BECXDT                          WVCXDT
     I              BEJZVA                          WVJZVA
     I              BEA1WG                          WVA1WG
     I              BEXIST                          WVXIST
     I              BEXJST                          WVXJST
     I              BEXKST                          WVXKST
     I              BEEIDT                          WVEIDT
     I              BEAFTM                          WVAFTM
     I              BEE8CD                          WVE8CD
     I              BEE9CD                          WVE9CD
     I              BERMNB                          WVRMNB
     I              BETBNB                          WVTBNB
     I              BER1NB                          WVR1NB
     I              BEPJST                          WVPJST
     I              BEU0ST                          WVU0ST
     I              BEU1ST                          WVU1ST
     I              BEQ2CD                          WVQ2CD
     I              BEU2ST                          WVU2ST
     I              BEVEST                          WVVEST
     I              BEVFST                          WVVFST
     I              BEVGST                          WVVGST
     I              BERPCD                          WVRPCD
     I              BERNNB                          WVRNNB
     I              BEVDST                          WVVDST
     I              BEATIN                          WVATIN
     I              BEU4ST                          WVU4ST
     I              BEU5ST                          WVU5ST
     I              BERSRN                          WVRSRN
     I              BEMHNA                          WVMHNA
     I              BEMINA                          WVMINA
     I              BEWBST                          WVWBST
     I              BER4CD                          WVR4CD
     I              BEBFCD                          WVBFCD
     I              BEQ4CD                          WVQ4CD
     I              BET3NB                          WVT3NB
     I              BESICD                          WVSICD
     I              BECONB                          WVCONB
     I              BECEST                          WVCEST
     I              BEAWDT                          WVAWDT
     I              BEJPCD                          WVJPCD
     I              BEXUST                          WVXUST
     I              BEZ1ST                          WVZ1ST
     I              BEVRVA                          WVVRVA
     I              BEOBST                          WVOBST
     I              BEBCST                          WVBCST
     I              BEBDST                          WVBDST
     I              BEB7VL                          WVB7VL
     I              BEGASX                          WVGASX
     I              BEGBSX                          WVGBSX
     I              BEGCSX                          WVGCSX
     I              BEGDSX                          WVGDSX
     I              BEFNSX                          WVFNSX
     I              BEFOSX                          WVFOSX
     I              BEFPSX                          WVFPSX
     I              BEFQSX                          WVFQSX
     I              BEFRSX                          WVFRSX
     I              BEFSSX                          WVFSSX
     I              BEFTSX                          WVFTSX
     I              BEFUSX                          WVFUSX
     I              BEFVSX                          WVFVSX
     I              BEFWSX                          WVFWSX
     I              BEFXSX                          WVFXSX
     I              BEFYSX                          WVFYSX
     I              BENODT                          WVNODT
     I              BENPDT                          WVNPDT
     I              BENQDT                          WVNQDT
     I              BENRDT                          WVNRDT
     I              BENSDT                          WVNSDT
     I              BEBPTM                          WVBPTM
     I              BEBQTM                          WVBQTM
     I              BEBRTM                          WVBRTM
     I              BEBSTM                          WVBSTM
     I              BEBTTM                          WVBTTM
     I              BEH0NX                          WVH0NX
     I              BEH1NX                          WVH1NX
     I              BEH2NX                          WVH2NX
     I              BEH3NX                          WVH3NX
     I              BEH4NX                          WVH4NX
     I              BEC0C7                          WVC0C7
     I              BEUVST                          WVUVST
     I              BEUWST                          WVUWST
     I              BEUXST                          WVUXST
     I              BEAATM                          WVAATM
     I              BEAYNA                          WVAYNA
     I              BEA0NA                          WVA0NA
     I              BEAXDT                          WVAXDT
      *
     I@BUREBI
      * PFS Interface             Retrieval index
      * Renamed input format fields
     I              BUY1NX                          WWY1NX
     I              BUGYAA                          WWGYAA
     I              BURENA                          WWRENA
     I              BUWSSX                          WWWSSX
     I              BUWUSX                          WWWUSX
     I              BUQEDT                          WWQEDT
     I              BUCUTM                          WWCUTM
     I              BUB0NY                          WWB0NY
     I              BUB1NY                          WWB1NY
     I              BUWXSX                          WWWXSX
     I              BUWVSX                          WWWVSX
     I              BUWWSX                          WWWWSX
     I              BUUWSX                          WWUWSX
     I              BUUXSX                          WWUXSX
     I              BUV3SX                          WWV3SX
     I              BUAHNY                          WWAHNY
     I              BUAINY                          WWAINY
     I              BUAJNY                          WWAJNY
     I              BUAKNY                          WWAKNY
      *
     I@NDCPAQ
      * Ham Group Order           Co/Ord/HamGrp
      * Renamed input format fields
     I              NDA1AA                          WXA1AA
     I              NDAIC3                          WXAIC3
     I              NDC4NB                          WXC4NB
     I              NDN2DT                          WXN2DT
     I              NDJDNX                          WXJDNX
     I              NDPDNA                          WXPDNA
     I              NDKZDT                          WXKZDT
     I              NDAXTM                          WXAXTM
     I              NDUVST                          WXUVST
     I              NDUWST                          WXUWST
     I              NDUXST                          WXUXST
     I              NDVSST                          WXVSST
     I              NDAATM                          WXAATM
     I              NDAYNA                          WXAYNA
     I              NDA0NA                          WXA0NA
     I              NDAXDT                          WXAXDT
      *
     I@NDCPAM
      * Ham Group Order           Update index
      * Renamed input format fields
     I              NDA1AA                          WYA1AA
     I              NDAIC3                          WYAIC3
     I              NDC4NB                          WYC4NB
     I              NDN2DT                          WYN2DT
     I              NDJDNX                          WYJDNX
     I              NDPDNA                          WYPDNA
     I              NDKZDT                          WYKZDT
     I              NDAXTM                          WYAXTM
     I              NDUVST                          WYUVST
     I              NDUWST                          WYUWST
     I              NDUXST                          WYUXST
     I              NDVSST                          WYVSST
     I              NDAATM                          WYAATM
     I              NDAYNA                          WYAYNA
     I              NDA0NA                          WYA0NA
     I              NDAXDT                          WYAXDT
      *
     I@FJCPSB
      * Load Header               Load Only
      * Renamed input format fields
     I              FJRMNB                          TARMNB
     I              FJAIC3                          TAAIC3
     I              FJAODT                          TAAODT
     I              FJPJST                          TAPJST
     I              FJPKST                          TAPKST
     I              FJRNNB                          TARNNB
     I              FJDMTX                          TADMTX
     I              FJDNTX                          TADNTX
     I              FJDOTX                          TADOTX
     I              FJWTTX                          TAWTTX
     I              FJWUTX                          TAWUTX
     I              FJRPNB                          TARPNB
     I              FJFLAM                          TAFLAM
     I              FJXQST                          TAXQST
     I              FJRRNB                          TARRNB
     I              FJDXTX                          TADXTX
     I              FJDYTX                          TADYTX
     I              FJSBNB                          TASBNB
     I              FJBZNA                          TABZNA
     I              FJRONB                          TARONB
     I              FJSQNB                          TASQNB
     I              FJR1NB                          TAR1NB
     I              FJVCST                          TAVCST
     I              FJVDST                          TAVDST
     I              FJSDNB                          TASDNB
     I              FJPAOU                          TAPAOU
     I              FJDGWG                          TADGWG
     I              FJSXNB                          TASXNB
     I              FJHADT                          TAHADT
     I              FJAART                          TAAART
     I              FJDHWG                          TADHWG
     I              FJDIWG                          TADIWG
     I              FJAQDT                          TAAQDT
     I              FJS6NB                          TAS6NB
     I              FJT4NB                          TAT4NB
     I              FJPRTM                          TAPRTM
     I              FJNPSV                          TANPSV
     I              FJJ8TX                          TAJ8TX
     I              FJTLMI                          TATLMI
     I              FJJ9TX                          TAJ9TX
     I              FJQ2CD                          TAQ2CD
     I              FJVPCD                          TAVPCD
     I              FJDBCD                          TADBCD
     I              FJGRWE                          TAGRWE
     I              FJXCCD                          TAXCCD
     I              FJU2ST                          TAU2ST
     I              FJF9DT                          TAF9DT
     I              FJONTM                          TAONTM
     I              FJJ4DT                          TAJ4DT
     I              FJTRTM                          TATRTM
     I              FJJ5DT                          TAJ5DT
     I              FJSPTM                          TASPTM
     I              FJJ6DT                          TAJ6DT
     I              FJLFTM                          TALFTM
     I              FJJ7DT                          TAJ7DT
     I              FJBOTM                          TABOTM
     I              FJJ8DT                          TAJ8DT
     I              FJBLTM                          TABLTM
     I              FJKIDT                          TAKIDT
     I              FJASTM                          TAASTM
     I              FJKADT                          TAKADT
     I              FJAJCM                          TAAJCM
     I              FJXACD                          TAXACD
     I              FJOANA                          TAOANA
     I              FJK4TX                          TAK4TX
     I              FJVOAG                          TAVOAG
     I              FJKBDT                          TAKBDT
     I              FJNBBO                          TANBBO
     I              FJW4CD                          TAW4CD
     I              FJEFDT                          TAEFDT
     I              FJCNTN                          TACNTN
     I              FJKCDT                          TAKCDT
     I              FJTMIN                          TATMIN
     I              FJKDDT                          TAKDDT
     I              FJVMNB                          TAVMNB
     I              FJOCFR                          TAOCFR
     I              FJKJDT                          TAKJDT
     I              FJATTM                          TAATTM
     I              FJOTRS                          TAOTRS
     I              FJRNST                          TARNST
     I              FJBRBK                          TABRBK
     I              FJEIDT                          TAEIDT
     I              FJRMST                          TARMST
     I              FJAJCD                          TAAJCD
     I              FJKKDT                          TAKKDT
     I              FJAVTM                          TAAVTM
     I              FJKZDT                          TAKZDT
     I              FJAXTM                          TAAXTM
     I              FJLHOS                          TALHOS
     I              FJLHOR                          TALHOR
     I              FJWNTX                          TAWNTX
     I              FJOITX                          TAOITX
     I              FJOJTX                          TAOJTX
     I              FJLLDT                          TALLDT
     I              FJLSHG                          TALSHG
     I              FJYPST                          TAYPST
     I              FJK0DT                          TAK0DT
     I              FJAYTM                          TAAYTM
     I              FJKNNX                          TAKNNX
     I              FJICWG                          TAICWG
     I              FJIDWG                          TAIDWG
     I              FJH9SX                          TAH9SX
     I              FJWOTX                          TAWOTX
     I              FJK1DT                          TAK1DT
     I              FJAZTM                          TAAZTM
     I              FJK2DT                          TAK2DT
     I              FJA0TM                          TAA0TM
     I              FJROST                          TAROST
     I              FJRPST                          TARPST
     I              FJRQST                          TARQST
     I              FJRRST                          TARRST
     I              FJZBVA                          TAZBVA
     I              FJWPTX                          TAWPTX
     I              FJWQTX                          TAWQTX
     I              FJWRTX                          TAWRTX
     I              FJWSTX                          TAWSTX
     I              FJRVSX                          TARVSX
     I              FJRUSX                          TARUSX
     I              FJRWSX                          TARWSX
     I              FJRXSX                          TARXSX
     I              FJRYSX                          TARYSX
     I              FJRZSX                          TARZSX
     I              FJR0SX                          TAR0SX
     I              FJR1SX                          TAR1SX
     I              FJR2SX                          TAR2SX
     I              FJR3SX                          TAR3SX
     I              FJR4SX                          TAR4SX
     I              FJPYDT                          TAPYDT
     I              FJCKTM                          TACKTM
     I              FJPZDT                          TAPZDT
     I              FJCLTM                          TACLTM
     I              FJP0DT                          TAP0DT
     I              FJCMTM                          TACMTM
     I              FJP1DT                          TAP1DT
     I              FJCNTM                          TACNTM
     I              FJP2DT                          TAP2DT
     I              FJCOTM                          TACOTM
     I              FJP3DT                          TAP3DT
     I              FJCQTM                          TACQTM
     I              FJUVST                          TAUVST
     I              FJUWST                          TAUWST
     I              FJUXST                          TAUXST
     I              FJAATM                          TAAATM
     I              FJAYNA                          TAAYNA
     I              FJA0NA                          TAA0NA
     I              FJAXDT                          TAAXDT
      *
     I@NCCPAJ
      * Ham Group Customer        Update index
      * Renamed input format fields
     I              NCA1AA                          TBA1AA
     I              NCBKC7                          TBBKC7
     I              NCUBTX                          TBUBTX
     I              NCUVST                          TBUVST
     I              NCUWST                          TBUWST
     I              NCUXST                          TBUXST
     I              NCVSST                          TBVSST
     I              NCAATM                          TBAATM
     I              NCAYNA                          TBAYNA
     I              NCA0NA                          TBA0NA
     I              NCAXDT                          TBAXDT
      *
     I@EXRETY
      * Order Types               Active order Types
      * Renamed input format fields
     I              EXJNCD                          TCJNCD
     I              EXJVNA                          TCJVNA
     I              EXOAST                          TCOAST
     I              EXOBST                          TCOBST
     I              EXOEST                          TCOEST
     I              EXOFST                          TCOFST
     I              EXVBST                          TCVBST
     I              EXPYST                          TCPYST
     I              EXX8ST                          TCX8ST
     I              EXISTX                          TCISTX
     I              EXUVST                          TCUVST
     I              EXUWST                          TCUWST
     I              EXUXST                          TCUXST
     I              EXVSST                          TCVSST
     I              EXAATM                          TCAATM
     I              EXAYNA                          TCAYNA
     I              EXA0NA                          TCA0NA
     I              EXAXDT                          TCAXDT
      *
     I@BCREFE
      * A/R Summary               Retrieval index       NV
      * Renamed input format fields
     I              BCAIC3                          TDAIC3
     I              BCANC7                          TDANC7
     I              BCAGVA                          TDAGVA
     I              BCACVA                          TDACVA
     I              BCADVA                          TDADVA
     I              BCAEVA                          TDAEVA
     I              BCAFVA                          TDAFVA
     I              BCAHVA                          TDAHVA
     I              BCVIVA                          TDVIVA
     I              BCVJVA                          TDVJVA
     I              BCVKVA                          TDVKVA
     I              BCVLVA                          TDVLVA
     I              BCVMVA                          TDVMVA
     I              BCVNVA                          TDVNVA
     I              BCEEVA                          TDEEVA
     I              BCAKTM                          TDAKTM
     I              BCAHDT                          TDAHDT
     I              BCANDT                          TDANDT
     I              BCANVA                          TDANVA
     I              BCALDT                          TDALDT
     I              BCAMVA                          TDAMVA
     I              BCAIDT                          TDAIDT
     I              BCALVA                          TDALVA
     I              BCDJNB                          TDDJNB
     I              BCDLNB                          TDDLNB
     I              BCDDNB                          TDDDNB
     I              BCDMNB                          TDDMNB
     I              BCDUDT                          TDDUDT
     I              BCLYNO                          TDLYNO
     I              BCLYNC                          TDLYNC
     I              BCLYNP                          TDLYNP
     I              BCLYNI                          TDLYNI
     I              BCADPM                          TDADPM
     I              BCVOVA                          TDVOVA
     I              BCBTDY                          TDBTDY
     I              BCBUDY                          TDBUDY
     I              BCVPVA                          TDVPVA
     I              BCVQVA                          TDVQVA
     I              BCBCCD                          TDBCCD
     I              BCR4CD                          TDR4CD
     I              BCCUMO                          TDCUMO
     I              BCUVST                          TDUVST
     I              BCUWST                          TDUWST
     I              BCUXST                          TDUXST
     I              BCAATM                          TDAATM
     I              BCAYNA                          TDAYNA
     I              BCA0NA                          TDA0NA
     I              BCAXDT                          TDAXDT
      *
     I@BCREFD
      * A/R Summary               Update index
      * Renamed input format fields
     I              BCAIC3                          TEAIC3
     I              BCANC7                          TEANC7
     I              BCAGVA                          TEAGVA
     I              BCACVA                          TEACVA
     I              BCADVA                          TEADVA
     I              BCAEVA                          TEAEVA
     I              BCAFVA                          TEAFVA
     I              BCAHVA                          TEAHVA
     I              BCVIVA                          TEVIVA
     I              BCVJVA                          TEVJVA
     I              BCVKVA                          TEVKVA
     I              BCVLVA                          TEVLVA
     I              BCVMVA                          TEVMVA
     I              BCVNVA                          TEVNVA
     I              BCEEVA                          TEEEVA
     I              BCAKTM                          TEAKTM
     I              BCAHDT                          TEAHDT
     I              BCANDT                          TEANDT
     I              BCANVA                          TEANVA
     I              BCALDT                          TEALDT
     I              BCAMVA                          TEAMVA
     I              BCAIDT                          TEAIDT
     I              BCALVA                          TEALVA
     I              BCDJNB                          TEDJNB
     I              BCDLNB                          TEDLNB
     I              BCDDNB                          TEDDNB
     I              BCDMNB                          TEDMNB
     I              BCDUDT                          TEDUDT
     I              BCLYNO                          TELYNO
     I              BCLYNC                          TELYNC
     I              BCLYNP                          TELYNP
     I              BCLYNI                          TELYNI
     I              BCADPM                          TEADPM
     I              BCVOVA                          TEVOVA
     I              BCBTDY                          TEBTDY
     I              BCBUDY                          TEBUDY
     I              BCVPVA                          TEVPVA
     I              BCVQVA                          TEVQVA
     I              BCBCCD                          TEBCCD
     I              BCR4CD                          TER4CD
     I              BCCUMO                          TECUMO
     I              BCUVST                          TEUVST
     I              BCUWST                          TEUWST
     I              BCUXST                          TEUXST
     I              BCAATM                          TEAATM
     I              BCAYNA                          TEAYNA
     I              BCA0NA                          TEA0NA
     I              BCAXDT                          TEAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WEAIC3
     I              OMC4NB                          WEC4NB
     I              OMDPNB                          WEDPNB
     I              OMUENB                          WEUENB
     I              OMHGCD                          WEHGCD
     I              OMAJCD                          WEAJCD
     I              OMBKC7                          WEBKC7
     I              OMCFC7                          WECFC7
     I              OMGMST                          WEGMST
     I              OMGNST                          WEGNST
     I              OMMAVA                          WEMAVA
     I              OMKDVA                          WEKDVA
     I              OML8VA                          WEL8VA
     I              OML9VA                          WEL9VA
     I              OMGTST                          WEGTST
     I              OMGVST                          WEGVST
     I              OMGUST                          WEGUST
     I              OMQFST                          WEQFST
     I              OMAYVA                          WEAYVA
     I              OMEXDT                          WEEXDT
     I              OMLQCD                          WELQCD
     I              OMRDCD                          WERDCD
     I              OMQ7CD                          WEQ7CD
     I              OMBZPR                          WEBZPR
     I              OML6NB                          WEL6NB
     I              OMU1ST                          WEU1ST
     I              OMGIDT                          WEGIDT
     I              OMCRCD                          WECRCD
     I              OMAGCD                          WEAGCD
     I              OMRZST                          WERZST
     I              OMR0ST                          WER0ST
     I              OMR1ST                          WER1ST
     I              OMG7NA                          WEG7NA
     I              OMG8NA                          WEG8NA
     I              OMRPCD                          WERPCD
     I              OMVEST                          WEVEST
     I              OMVGST                          WEVGST
     I              OMAVST                          WEAVST
     I              OMU0ST                          WEU0ST
     I              OMRFCD                          WERFCD
     I              OMFZST                          WEFZST
     I              OMR1NB                          WER1NB
     I              OMAVQT                          WEAVQT
     I              OMD0WG                          WED0WG
     I              OMCCQT                          WECCQT
     I              OMAUWG                          WEAUWG
     I              OMCBQT                          WECBQT
     I              OMATWG                          WEATWG
     I              OMAQCS                          WEAQCS
     I              OMAGCS                          WEAGCS
     I              OMAKPR                          WEAKPR
     I              OMALPR                          WEALPR
     I              OMAUPR                          WEAUPR
     I              OMAVWG                          WEAVWG
     I              OMA4WG                          WEA4WG
     I              OMA5DT                          WEA5DT
     I              OMAODT                          WEAODT
     I              OMGNDT                          WEGNDT
     I              OMAMST                          WEAMST
     I              OMANST                          WEANST
     I              OMVAST                          WEVAST
     I              OMRGNB                          WERGNB
     I              OMRHNB                          WERHNB
     I              OMRINB                          WERINB
     I              OMRBCD                          WERBCD
     I              OMHICD                          WEHICD
     I              OMRNCD                          WERNCD
     I              OMROCD                          WEROCD
     I              OMCXDT                          WECXDT
     I              OMAJVN                          WEAJVN
     I              OMKXCD                          WEKXCD
     I              OMJPCD                          WEJPCD
     I              OMCQCD                          WECQCD
     I              OMR4CD                          WER4CD
     I              OMZ1ST                          WEZ1ST
     I              OMZ3ST                          WEZ3ST
     I              OMZ4ST                          WEZ4ST
     I              OMDUPR                          WEDUPR
     I              OMB6VL                          WEB6VL
     I              OMA1AA                          WEA1AA
     I              OMFZSX                          WEFZSX
     I              OMF0SX                          WEF0SX
     I              OMF1SX                          WEF1SX
     I              OMF2SX                          WEF2SX
     I              OMF3SX                          WEF3SX
     I              OMF4SX                          WEF4SX
     I              OMF5SX                          WEF5SX
     I              OMF6SX                          WEF6SX
     I              OMF7SX                          WEF7SX
     I              OMNTDT                          WENTDT
     I              OMNUDT                          WENUDT
     I              OMNVDT                          WENVDT
     I              OMNWDT                          WENWDT
     I              OMNXDT                          WENXDT
     I              OMBUTM                          WEBUTM
     I              OMBVTM                          WEBVTM
     I              OMBWTM                          WEBWTM
     I              OMBXTM                          WEBXTM
     I              OMBYTM                          WEBYTM
     I              OMH5NX                          WEH5NX
     I              OMH6NX                          WEH6NX
     I              OMH7NX                          WEH7NX
     I              OMH8NX                          WEH8NX
     I              OMH9NX                          WEH9NX
     I              OMDVPR                          WEDVPR
     I              OMDWPR                          WEDWPR
     I              OMDXPR                          WEDXPR
     I              OMDYPR                          WEDYPR
     I              OMDZPR                          WEDZPR
     I              OMGSPR                          WEGSPR
     I              OMGTPR                          WEGTPR
     I              OMGUPR                          WEGUPR
     I              OMHOST                          WEHOST
     I              OMHPST                          WEHPST
     I              OMIOST                          WEIOST
     I              OMPEWG                          WEPEWG
     I              OMRINY                          WERINY
     I              OMTIDT                          WETIDT
     I              OMTJDT                          WETJDT
     I              OMH2ST                          WEH2ST
     I              OMH0ST                          WEH0ST
     I              OMH1ST                          WEH1ST
     I              OMTKDT                          WETKDT
     I              OMTLDT                          WETLDT
     I              OMTMDT                          WETMDT
     I              OMUVST                          WEUVST
     I              OMUWST                          WEUWST
     I              OMUXST                          WEUXST
     I              OMAATM                          WEAATM
     I              OMAYNA                          WEAYNA
     I              OMA0NA                          WEA0NA
     I              OMAXDT                          WEAXDT
      *
     IYARDCS      DS                            525
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPARC        DS                             11
      * KEY : Load Detail               Load/Stop/Order
      * I :  Load ID
     I                                    P   1   40PARMNB
      *
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WJRMNB
     I              FJAIC3                          WJAIC3
     I              FJAODT                          WJAODT
     I              FJPJST                          WJPJST
     I              FJPKST                          WJPKST
     I              FJRNNB                          WJRNNB
     I              FJDMTX                          WJDMTX
     I              FJDNTX                          WJDNTX
     I              FJDOTX                          WJDOTX
     I              FJWTTX                          WJWTTX
     I              FJWUTX                          WJWUTX
     I              FJRPNB                          WJRPNB
     I              FJFLAM                          WJFLAM
     I              FJXQST                          WJXQST
     I              FJRRNB                          WJRRNB
     I              FJDXTX                          WJDXTX
     I              FJDYTX                          WJDYTX
     I              FJSBNB                          WJSBNB
     I              FJBZNA                          WJBZNA
     I              FJRONB                          WJRONB
     I              FJSQNB                          WJSQNB
     I              FJR1NB                          WJR1NB
     I              FJVCST                          WJVCST
     I              FJVDST                          WJVDST
     I              FJSDNB                          WJSDNB
     I              FJPAOU                          WJPAOU
     I              FJDGWG                          WJDGWG
     I              FJSXNB                          WJSXNB
     I              FJHADT                          WJHADT
     I              FJAART                          WJAART
     I              FJDHWG                          WJDHWG
     I              FJDIWG                          WJDIWG
     I              FJAQDT                          WJAQDT
     I              FJS6NB                          WJS6NB
     I              FJT4NB                          WJT4NB
     I              FJPRTM                          WJPRTM
     I              FJNPSV                          WJNPSV
     I              FJJ8TX                          WJJ8TX
     I              FJTLMI                          WJTLMI
     I              FJJ9TX                          WJJ9TX
     I              FJQ2CD                          WJQ2CD
     I              FJVPCD                          WJVPCD
     I              FJDBCD                          WJDBCD
     I              FJGRWE                          WJGRWE
     I              FJXCCD                          WJXCCD
     I              FJU2ST                          WJU2ST
     I              FJF9DT                          WJF9DT
     I              FJONTM                          WJONTM
     I              FJJ4DT                          WJJ4DT
     I              FJTRTM                          WJTRTM
     I              FJJ5DT                          WJJ5DT
     I              FJSPTM                          WJSPTM
     I              FJJ6DT                          WJJ6DT
     I              FJLFTM                          WJLFTM
     I              FJJ7DT                          WJJ7DT
     I              FJBOTM                          WJBOTM
     I              FJJ8DT                          WJJ8DT
     I              FJBLTM                          WJBLTM
     I              FJKIDT                          WJKIDT
     I              FJASTM                          WJASTM
     I              FJKADT                          WJKADT
     I              FJAJCM                          WJAJCM
     I              FJXACD                          WJXACD
     I              FJOANA                          WJOANA
     I              FJK4TX                          WJK4TX
     I              FJVOAG                          WJVOAG
     I              FJKBDT                          WJKBDT
     I              FJNBBO                          WJNBBO
     I              FJW4CD                          WJW4CD
     I              FJEFDT                          WJEFDT
     I              FJCNTN                          WJCNTN
     I              FJKCDT                          WJKCDT
     I              FJTMIN                          WJTMIN
     I              FJKDDT                          WJKDDT
     I              FJVMNB                          WJVMNB
     I              FJOCFR                          WJOCFR
     I              FJKJDT                          WJKJDT
     I              FJATTM                          WJATTM
     I              FJOTRS                          WJOTRS
     I              FJRNST                          WJRNST
     I              FJBRBK                          WJBRBK
     I              FJEIDT                          WJEIDT
     I              FJRMST                          WJRMST
     I              FJAJCD                          WJAJCD
     I              FJKKDT                          WJKKDT
     I              FJAVTM                          WJAVTM
     I              FJKZDT                          WJKZDT
     I              FJAXTM                          WJAXTM
     I              FJLHOS                          WJLHOS
     I              FJLHOR                          WJLHOR
     I              FJWNTX                          WJWNTX
     I              FJOITX                          WJOITX
     I              FJOJTX                          WJOJTX
     I              FJLLDT                          WJLLDT
     I              FJLSHG                          WJLSHG
     I              FJYPST                          WJYPST
     I              FJK0DT                          WJK0DT
     I              FJAYTM                          WJAYTM
     I              FJKNNX                          WJKNNX
     I              FJICWG                          WJICWG
     I              FJIDWG                          WJIDWG
     I              FJH9SX                          WJH9SX
     I              FJWOTX                          WJWOTX
     I              FJK1DT                          WJK1DT
     I              FJAZTM                          WJAZTM
     I              FJK2DT                          WJK2DT
     I              FJA0TM                          WJA0TM
     I              FJROST                          WJROST
     I              FJRPST                          WJRPST
     I              FJRQST                          WJRQST
     I              FJRRST                          WJRRST
     I              FJZBVA                          WJZBVA
     I              FJWPTX                          WJWPTX
     I              FJWQTX                          WJWQTX
     I              FJWRTX                          WJWRTX
     I              FJWSTX                          WJWSTX
     I              FJRVSX                          WJRVSX
     I              FJRUSX                          WJRUSX
     I              FJRWSX                          WJRWSX
     I              FJRXSX                          WJRXSX
     I              FJRYSX                          WJRYSX
     I              FJRZSX                          WJRZSX
     I              FJR0SX                          WJR0SX
     I              FJR1SX                          WJR1SX
     I              FJR2SX                          WJR2SX
     I              FJR3SX                          WJR3SX
     I              FJR4SX                          WJR4SX
     I              FJPYDT                          WJPYDT
     I              FJCKTM                          WJCKTM
     I              FJPZDT                          WJPZDT
     I              FJCLTM                          WJCLTM
     I              FJP0DT                          WJP0DT
     I              FJCMTM                          WJCMTM
     I              FJP1DT                          WJP1DT
     I              FJCNTM                          WJCNTM
     I              FJP2DT                          WJP2DT
     I              FJCOTM                          WJCOTM
     I              FJP3DT                          WJP3DT
     I              FJCQTM                          WJCQTM
     I              FJUVST                          WJUVST
     I              FJUWST                          WJUWST
     I              FJUXST                          WJUXST
     I              FJAATM                          WJAATM
     I              FJAYNA                          WJAYNA
     I              FJA0NA                          WJA0NA
     I              FJAXDT                          WJAXDT
      *
     IYBRDCS      DS                            793
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IYCRDCS      DS                            793
     IQOMFL1    E DSOMFLCPL0
      * UPD : Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WMRMNB
     I              FLRUNB                          WMRUNB
     I              FLRVNB                          WMRVNB
     I              FLDQTX                          WMDQTX
     I              FLRWNB                          WMRWNB
     I              FLRXNB                          WMRXNB
     I              FLSQNB                          WMSQNB
     I              FLT0NB                          WMT0NB
     I              FLT1NB                          WMT1NB
     I              FLR1NB                          WMR1NB
     I              FLAIC3                          WMAIC3
     I              FLC4NB                          WMC4NB
     I              FLVCST                          WMVCST
     I              FLKEDT                          WMKEDT
     I              FLSXNB                          WMSXNB
     I              FLKFDT                          WMKFDT
     I              FLACTM                          WMACTM
     I              FLK5TX                          WMK5TX
     I              FLW5CD                          WMW5CD
     I              FLEJDT                          WMEJDT
     I              FLAGTM                          WMAGTM
     I              FLKJDT                          WMKJDT
     I              FLATTM                          WMATTM
     I              FLHDDT                          WMHDDT
     I              FLAUTM                          WMAUTM
     I              FLKKDT                          WMKKDT
     I              FLAVTM                          WMAVTM
     I              FLZ4NB                          WMZ4NB
     I              FLY7ST                          WMY7ST
     I              FLY2ST                          WMY2ST
     I              FLWHTX                          WMWHTX
     I              FLWITX                          WMWITX
     I              FLWJTX                          WMWJTX
     I              FLWKTX                          WMWKTX
     I              FLWLTX                          WMWLTX
     I              FLN7DT                          WMN7DT
     I              FLN8DT                          WMN8DT
     I              FLN9DT                          WMN9DT
     I              FLB3TM                          WMB3TM
     I              FLB4TM                          WMB4TM
     I              FLB5TM                          WMB5TM
     I              FLIASX                          WMIASX
     I              FLIBSX                          WMIBSX
     I              FLICSX                          WMICSX
     I              FLWVTX                          WMWVTX
     I              FLWWTX                          WMWWTX
     I              FLWXTX                          WMWXTX
     I              FLUVST                          WMUVST
     I              FLUWST                          WMUWST
     I              FLUXST                          WMUXST
     I              FLAATM                          WMAATM
     I              FLAYNA                          WMAYNA
     I              FLA0NA                          WMA0NA
     I              FLAXDT                          WMAXDT
      *
     IYDRDCS      DS                            367
     IYERDCS      DS                            525
     IYFRDCS      DS                            525
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WVAIC3
     I              BEC4NB                          WVC4NB
     I              BEJNCD                          WVJNCD
     I              BEANC7                          WVANC7
     I              BEBKC7                          WVBKC7
     I              BEBRTX                          WVBRTX
     I              BEHMNA                          WVHMNA
     I              BEHONA                          WVHONA
     I              BEHPNA                          WVHPNA
     I              BEHNNA                          WVHNNA
     I              BEDBCD                          WVDBCD
     I              BECKTX                          WVCKTX
     I              BEB0C7                          WVB0C7
     I              BEAETX                          WVAETX
     I              BEB1NA                          WVB1NA
     I              BEB3NA                          WVB3NA
     I              BEB4NA                          WVB4NA
     I              BEB2NA                          WVB2NA
     I              BEBHCD                          WVBHCD
     I              BEC8TX                          WVC8TX
     I              BEBCNA                          WVBCNA
     I              BEA0DT                          WVA0DT
     I              BEA5DT                          WVA5DT
     I              BEGNDT                          WVGNDT
     I              BEACDT                          WVACDT
     I              BEAQCD                          WVAQCD
     I              BEB6NA                          WVB6NA
     I              BEBYNA                          WVBYNA
     I              BEBZNA                          WVBZNA
     I              BEGTST                          WVGTST
     I              BEGVST                          WVGVST
     I              BEGUST                          WVGUST
     I              BEQFST                          WVQFST
     I              BECQCD                          WVCQCD
     I              BEGJST                          WVGJST
     I              BEGWST                          WVGWST
     I              BEGXST                          WVGXST
     I              BEGYST                          WVGYST
     I              BEAODT                          WVAODT
     I              BEAIVN                          WVAIVN
     I              BECXDT                          WVCXDT
     I              BEJZVA                          WVJZVA
     I              BEA1WG                          WVA1WG
     I              BEXIST                          WVXIST
     I              BEXJST                          WVXJST
     I              BEXKST                          WVXKST
     I              BEEIDT                          WVEIDT
     I              BEAFTM                          WVAFTM
     I              BEE8CD                          WVE8CD
     I              BEE9CD                          WVE9CD
     I              BERMNB                          WVRMNB
     I              BETBNB                          WVTBNB
     I              BER1NB                          WVR1NB
     I              BEPJST                          WVPJST
     I              BEU0ST                          WVU0ST
     I              BEU1ST                          WVU1ST
     I              BEQ2CD                          WVQ2CD
     I              BEU2ST                          WVU2ST
     I              BEVEST                          WVVEST
     I              BEVFST                          WVVFST
     I              BEVGST                          WVVGST
     I              BERPCD                          WVRPCD
     I              BERNNB                          WVRNNB
     I              BEVDST                          WVVDST
     I              BEATIN                          WVATIN
     I              BEU4ST                          WVU4ST
     I              BEU5ST                          WVU5ST
     I              BERSRN                          WVRSRN
     I              BEMHNA                          WVMHNA
     I              BEMINA                          WVMINA
     I              BEWBST                          WVWBST
     I              BER4CD                          WVR4CD
     I              BEBFCD                          WVBFCD
     I              BEQ4CD                          WVQ4CD
     I              BET3NB                          WVT3NB
     I              BESICD                          WVSICD
     I              BECONB                          WVCONB
     I              BECEST                          WVCEST
     I              BEAWDT                          WVAWDT
     I              BEJPCD                          WVJPCD
     I              BEXUST                          WVXUST
     I              BEZ1ST                          WVZ1ST
     I              BEVRVA                          WVVRVA
     I              BEOBST                          WVOBST
     I              BEBCST                          WVBCST
     I              BEBDST                          WVBDST
     I              BEB7VL                          WVB7VL
     I              BEGASX                          WVGASX
     I              BEGBSX                          WVGBSX
     I              BEGCSX                          WVGCSX
     I              BEGDSX                          WVGDSX
     I              BEFNSX                          WVFNSX
     I              BEFOSX                          WVFOSX
     I              BEFPSX                          WVFPSX
     I              BEFQSX                          WVFQSX
     I              BEFRSX                          WVFRSX
     I              BEFSSX                          WVFSSX
     I              BEFTSX                          WVFTSX
     I              BEFUSX                          WVFUSX
     I              BEFVSX                          WVFVSX
     I              BEFWSX                          WVFWSX
     I              BEFXSX                          WVFXSX
     I              BEFYSX                          WVFYSX
     I              BENODT                          WVNODT
     I              BENPDT                          WVNPDT
     I              BENQDT                          WVNQDT
     I              BENRDT                          WVNRDT
     I              BENSDT                          WVNSDT
     I              BEBPTM                          WVBPTM
     I              BEBQTM                          WVBQTM
     I              BEBRTM                          WVBRTM
     I              BEBSTM                          WVBSTM
     I              BEBTTM                          WVBTTM
     I              BEH0NX                          WVH0NX
     I              BEH1NX                          WVH1NX
     I              BEH2NX                          WVH2NX
     I              BEH3NX                          WVH3NX
     I              BEH4NX                          WVH4NX
     I              BEC0C7                          WVC0C7
     I              BEUVST                          WVUVST
     I              BEUWST                          WVUWST
     I              BEUXST                          WVUXST
     I              BEAATM                          WVAATM
     I              BEAYNA                          WVAYNA
     I              BEA0NA                          WVA0NA
     I              BEAXDT                          WVAXDT
      *
     IYGRDCS      DS                            779
      * Outward parameters
     IPBRC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PBAIC3
      * I :  Order Number
     I                                    P   3   60PBC4NB
      * I :  Order Type - Sales
     I                                        7   8 PBJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PBANC7
      * I :  Ship To Customer
     I                                    P  13  160PBBKC7
      * I :  Ship To Name
     I                                       17  46 PBBRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PBHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PBHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PBHPNA
      * I :  Ship To City
     I                                      137 156 PBHNNA
      * I :  Ship To State Code
     I                                      157 158 PBDBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PBCKTX
      * I :  Bill to Customer
     I                                    P 170 1730PBB0C7
      * I :  Bill to Name
     I                                      174 203 PBAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PBB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PBB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PBB4NA
      * I :  Bill to City
     I                                      294 313 PBB2NA
      * I :  Bill to State Code
     I                                      314 315 PBBHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PBC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PBBCNA
      * I :  Order Date
     I                                    P 342 3450PBA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PBA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PBGNDT
      * I :  Cancel Date
     I                                    P 354 3570PBACDT
      * I :  Terms Code
     I                                      358 359 PBAQCD
      * I :  Special Instructions
     I                                      360 399 PBB6NA
      * I :  Special Instructions 2
     I                                      400 439 PBBYNA
      * I :  Carrier Code
     I                                      440 442 PBBZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PBGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PBGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PBGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PBQFST
      * I :  Reason Code
     I                                      447 449 PBCQCD
      * I :  Order in Use
     I                                      450 450 PBGJST
      * I :  Header Status
     I                                      451 451 PBGWST
      * I :  Header Status Last
     I                                      452 452 PBGXST
      * I :  Order Type Print Status
     I                                      453 453 PBGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PBAODT
      * I :  User Original Entry
     I                                      458 467 PBAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PBCXDT
      * I :  Order Value Total
     I                                    P 472 4772PBJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PBA1WG
      * I :  Credit Hold
     I                                      484 484 PBXIST
      * I :  Production Hold
     I                                      485 485 PBXJST
      * I :  New Customer Hold
     I                                      486 486 PBXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PBEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PBAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PBE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PBE9CD
      * I :  Load ID
     I                                    P 510 5130PBRMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PBTBNB
      * I :  Rated Freight
     I                                    P 517 5222PBR1NB
      * I :  LTL Flag
     I                                      523 523 PBPJST
      * I :  Price Audit
     I                                      524 524 PBU0ST
      * I :  Price Status
     I                                      525 525 PBU1ST
      * I :  Shipping Method
     I                                      526 527 PBQ2CD
      * I :  Export Status
     I                                      528 528 PBU2ST
      * I :  Palletize
     I                                      529 529 PBVEST
      * I :  Shrink Wrap
     I                                      530 530 PBVFST
      * I :  Slip Sheet
     I                                      531 531 PBVGST
      * I :  Age Code
     I                                      532 532 PBRPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PBRNNB
      * I :  Load Type
     I                                      536 536 PBVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PBATIN
      * I :  Load Plan Order
     I                                      541 541 PBU4ST
      * I :  Print Pick Slip
     I                                      542 542 PBU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PBRSRN
      * I :  Special Comment 1
     I                                      547 576 PBMHNA
      * I :  Special Comment 2
     I                                      577 606 PBMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PBWBST
      * I :  Sales Route Code
     I                                      608 610 PBR4CD
      * I :  Manager Level Code
     I                                      611 612 PBBFCD
      * I :  VP Level Code
     I                                      613 615 PBQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PBT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PBSICD
      * I :  Invoice Number
     I                                    P 623 6260PBCONB
      * I :  Invoice Suffix
     I                                      627 628 PBCEST
      * I :  Invoice Date
     I                                    P 629 6320PBAWDT
      * I :  Event Code
     I                                      633 634 PBJPCD
      * I :  Trans Contol AS400/Plant
     I                                      635 635 PBXUST
      * I :  Modified Flag
     I                                      636 636 PBZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PBVRVA
      * I :  Billing Activity Type
     I                                      643 643 PBOBST
      * I :  Block Order Flag
     I                                      644 644 PBBCST
      * I :  Order Certification Flag
     I                                      645 645 PBBDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PBB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PBGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PBGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PBGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PBGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PBFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PBFOSX
      * I :  Order Emailed
     I                                      658 658 PBFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PBFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PBFRSX
      * I :  Broker Order Status
     I                                      661 661 PBFSSX
      * I :  Air Freight Order
     I                                      662 662 PBFTSX
      * I :  Order Requires Review
     I                                      663 664 PBFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PBFVSX
      * I :  Export USDA Approved
     I                                      667 668 PBFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PBFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PBFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PBNODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PBNPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PBNQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PBNRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PBNSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PBBPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PBBQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PBBRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PBBSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PBBTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PBH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PBH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PBH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PBH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PBH4NX
      * I :  Claim Number
     I                                    P 745 7480PBC0C7
      * I :  EDI Status 1
     I                                      749 749 PBUVST
      * I :  EDI Status 2
     I                                      750 750 PBUWST
      * I :  EDI Status 3
     I                                      751 751 PBUXST
      * I :  Job Time
     I                                    P 752 7550PBAATM
      * I :  User Id
     I                                      756 765 PBAYNA
      * I :  Job Name
     I                                      766 775 PBA0NA
      * I :  Job Date
     I                                    P 776 7790PBAXDT
      *
     IYHRDCS      DS                            779
     IYIRDCS      DS                            779
     IYJRDCS      DS                            525
     IQPDND1    E DSPDNDCPL0
      * UPD : Ham Group Order           Update index
      * Renamed input format fields
     I              NDA1AA                          WYA1AA
     I              NDAIC3                          WYAIC3
     I              NDC4NB                          WYC4NB
     I              NDN2DT                          WYN2DT
     I              NDJDNX                          WYJDNX
     I              NDPDNA                          WYPDNA
     I              NDKZDT                          WYKZDT
     I              NDAXTM                          WYAXTM
     I              NDUVST                          WYUVST
     I              NDUWST                          WYUWST
     I              NDUXST                          WYUXST
     I              NDVSST                          WYVSST
     I              NDAATM                          WYAATM
     I              NDAYNA                          WYAYNA
     I              NDA0NA                          WYA0NA
     I              NDAXDT                          WYAXDT
      *
     IQPDNC1    E DSPDNCCPL0
      * UPD : Ham Group Customer        Update index
      * Renamed input format fields
     I              NCA1AA                          TBA1AA
     I              NCBKC7                          TBBKC7
     I              NCUBTX                          TBUBTX
     I              NCUVST                          TBUVST
     I              NCUWST                          TBUWST
     I              NCUXST                          TBUXST
     I              NCVSST                          TBVSST
     I              NCAATM                          TBAATM
     I              NCAYNA                          TBAYNA
     I              NCA0NA                          TBA0NA
     I              NCAXDT                          TBAXDT
      *
     IQARBC1    E DSARBCREL0
      * UPD : A/R Summary               Update index
      * Renamed input format fields
     I              BCAIC3                          TEAIC3
     I              BCANC7                          TEANC7
     I              BCAGVA                          TEAGVA
     I              BCACVA                          TEACVA
     I              BCADVA                          TEADVA
     I              BCAEVA                          TEAEVA
     I              BCAFVA                          TEAFVA
     I              BCAHVA                          TEAHVA
     I              BCVIVA                          TEVIVA
     I              BCVJVA                          TEVJVA
     I              BCVKVA                          TEVKVA
     I              BCVLVA                          TEVLVA
     I              BCVMVA                          TEVMVA
     I              BCVNVA                          TEVNVA
     I              BCEEVA                          TEEEVA
     I              BCAKTM                          TEAKTM
     I              BCAHDT                          TEAHDT
     I              BCANDT                          TEANDT
     I              BCANVA                          TEANVA
     I              BCALDT                          TEALDT
     I              BCAMVA                          TEAMVA
     I              BCAIDT                          TEAIDT
     I              BCALVA                          TEALVA
     I              BCDJNB                          TEDJNB
     I              BCDLNB                          TEDLNB
     I              BCDDNB                          TEDDNB
     I              BCDMNB                          TEDMNB
     I              BCDUDT                          TEDUDT
     I              BCLYNO                          TELYNO
     I              BCLYNC                          TELYNC
     I              BCLYNP                          TELYNP
     I              BCLYNI                          TELYNI
     I              BCADPM                          TEADPM
     I              BCVOVA                          TEVOVA
     I              BCBTDY                          TEBTDY
     I              BCBUDY                          TEBUDY
     I              BCVPVA                          TEVPVA
     I              BCVQVA                          TEVQVA
     I              BCBCCD                          TEBCCD
     I              BCR4CD                          TER4CD
     I              BCCUMO                          TECUMO
     I              BCUVST                          TEUVST
     I              BCUWST                          TEUWST
     I              BCUXST                          TEUXST
     I              BCAATM                          TEAATM
     I              BCAYNA                          TEAYNA
     I              BCA0NA                          TEA0NA
     I              BCAXDT                          TEAXDT
      *
     IYKRDCS      DS                            213
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Order Number
     I                                    P   3   60P1C4NB
      * N :  Order Type - Sales
     I                                        7   8 P1JNCD
      * N :  A/R Customer Number
     I                                    P   9  120P1ANC7
      * I :  Ship To Customer
     I                                    P  13  160P1BKC7
      * N :  Requested Ship Date
     I                                    P  17  200P1A5DT
      * N :  Reason Code
     I                                       21  23 P1CQCD
      * N :  Header Status
     I                                       24  24 P1GWST
      * N :  Header Status Last
     I                                       25  25 P1GXST
      * N :  Order Type Print Status
     I                                       26  26 P1GYST
      * N :  Scheduled Ship Date
     I                                    P  27  300P1AODT
      * N :  User Original Entry
     I                                       31  40 P1AIVN
      * N :  Date of Original Entry
     I                                    P  41  440P1CXDT
      * B :  Order Value Total
     I                                    P  45  502P1JZVA
      * O : MAP Order Weight Total
     I                                    P  51  562P1A1WG
      * N :  Credit Hold
     I                                       57  57 P1XIST
      * N :  Production Hold
     I                                       58  58 P1XJST
      * N :  New Customer Hold
     I                                       59  59 P1XKST
      * N :  Load ID
     I                                    P  60  630P1RMNB
      * N :  Price Audit
     I                                       64  64 P1U0ST
      * N :  Price Status
     I                                       65  65 P1U1ST
      * N :  Export Status
     I                                       66  66 P1U2ST
      * N :  Palletize
     I                                       67  67 P1VEST
      * N :  Load Plan Order
     I                                       68  68 P1U4ST
      * N :  Sales Route Code
     I                                       69  71 P1R4CD
      * N :  Modified Flag
     I                                       72  72 P1Z1ST
      * N :  A/R order Value Total
     I                                    P  73  782P1VRVA
      * N :  Block Order Flag
     I                                       79  79 P1BCST
     IP2PARM      DS
      * FLD: Customer
      * N :  Parent Customer
     I                                    P   1   40P2BTC7
      * N :  Credit Check A/R Customer
     I                                        5   5 P2K6ST
      * N :  Credit Check Parent Cust
     I                                        6   6 P2UZST
      * N :  Parent Credit Limit
     I                                    P   7  122P2S2NB
      * N :  A/R Credit Limit
     I                                    P  13  182P2VHVA
     IP3PARM      DS
      * FLD: Order Types
      * N :  Processing Cycle Type
     I                                        1   1 P3OAST
      * N :  Billing Activity Type
     I                                        2   2 P3OBST
      * N :  Affect Sales Doll Default
     I                                        3   3 P3OFST
     IP4PARM      DS
      * FLD: *Arrays
      * N :  USR Order Credit Hold
     I                                        1   1 P4IDST
      * N :  USR Order Value
     I                                    P   2   72P4JSVA
      * N :  USR Order Weight
     I                                    P   8  132P4AYWG
      * N :  USR Order Value Change
     I                                    P  14  192P4J0VA
      * N :  USR New Order
     I                                       20  23 P4W7ST
      * N :  USR Quantity Change
     I                                    P  24  292P4HOQT
      * N :  USR Production
     I                                       30  30 P4XPST
      * N :  USR Credit Hold
     I                                       31  31 P4XOST
      * N :  USR New Customer Hold
     I                                       32  32 P4QUST
      * I :  USR Country Code
     I                                       33  38 P4Z8CD
      * I :  USR Warehouse Code
     I                                       39  41 P4CPCD
      * N :  Live with TPM
     I                                       42  42 P4O1ST
     IP5PARM      DS
      * N :  USR Update Flag
     I                                        1   1 P5R4ST
     IP6PARM      DS
      * FLD: Company Control
      * N :  Credit Hold Status
     I                                        1   1 P6D8ST
     IP7PARM      DS
      * I :  Pricing Event Called From
     I                                        1   3 P7PECF
     IP8PARM      DS
      * FLD: Load Header
      * N :  Load Status
     I                                        1   1 P8PKST
     IP9PARM      DS
      * FLD: WF Export Upload Header
      * I :  ED Consignee Name
     I                                        1  63 P9RHTX
      * I :  ED Consignee Addr 1
     I                                       64 126 P9RITX
      * I :  ED Consignee Addr 2
     I                                      127 189 P9RJTX
      * I :  ED Consignee Addr 3
     I                                      190 252 P9SCTX
      * I :  ED Consignee Addr 4
     I                                      253 315 P9SDTX
      * I :  ED Consignee State
     I                                      316 317 P9AAAB
      * I :  ED Consignee Postal
     I                                      318 337 P9PHU1
      * I :  ED Consignee Country Code
     I                                      338 343 P9ABAB
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1BKC7    PARM           WP0003  70       Ship To Custome
     C           P1JZVA    PARM P1JZVA    WP0004 112       Order Value Tot
     C           P1A1WG    PARM P1A1WG    WP0005 112       Order Weight To
     C           P4Z8CD    PARM           WP0006  6        USR Country Cod
     C           P4CPCD    PARM           WP0007  3        USR Warehouse C
     C           P7PECF    PARM           WP0008  3        Pricing Event C
     C           P9RHTX    PARM           WP0009 63        ED Consignee Na
     C           P9RITX    PARM           WP0010 63        ED Consignee Ad
     C           P9RJTX    PARM           WP0011 63        ED Consignee Ad
     C           P9SCTX    PARM           WP0012 63        ED Consignee Ad
     C           P9SDTX    PARM           WP0013 63        ED Consignee Ad
     C           P9AAAB    PARM           WP0014  2        ED Consignee St
     C           P9PHU1    PARM           WP0015 20        ED Consignee Po
     C           P9ABAB    PARM           WP0016  6        ED Consignee Co
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * EDT Post Opn Japan Ord XF
      * Initialize Fields.
     C                     EXSR UASUBR                     Initialize Fiel
      * Retrieve Company, Order, & Load Information. (UPD Order Detail)
     C                     EXSR UBSUBR                     Retrieve Compan
      * Retrieve Credit Limits.
     C                     EXSR UCSUBR                     Retrieve Credit
      * Calculate Order Value & Weight total and Order Value Difference.
     C                     EXSR UDSUBR                     Calculate Order
      * Production Hold setup
      * CASE: PAR.Load Status is Locked thru Invoiced
     C           P8PKST    IFEQ 'I'                        *IF
     C           P8PKST    OREQ 'L'
     C           P8PKST    OREQ 'S'
     C                     MOVELP1XJST    P4XPST           USR Production
     C                     END                             *FI
     C           P4JSVA    SUB  P1JZVA    P4J0VA           USR Order Value
      * Check Credit.
     C                     EXSR UGSUBR                     Check Credit.
      * Update Order Dtl and Sts lines; track if have active subs.
     C                     EXSR UHSUBR                     Update Order Dt
      * Update Order Header and write to TMS Trigger table
     C                     EXSR UISUBR                     Update Order He
      * Update Orig Ordered Qty, Firm & Cancel Dte in Order Dtl.-2/04/20
      * CASE: *OTHERWISE
      * Upd Original Order DataRT - Order Detail  * 
     C                     EXSR TIRVGN
      * Update Ham Group/Order records.
     C                     EXSR UKSUBR                     Update Ham Grou
     C                     Z-ADDP4JSVA    P1JZVA           Order Value Tot
     C                     Z-ADDP4AYWG    P1A1WG           Order Weight To
      * Increment # Orders YTD on Add
      * CASE: PAR.USR New Order is *YES
     C           P4W7ST    IFEQ '*YES'                     *IF
      * RTV Affect Inv/Sls     RT - Order Types  * 
     C                     EXSR TRRVGN
      * Only add to # orders if affect sales dollars
      * CASE: PAR.Affect Sales Doll Default is yes
     C           P3OFST    IFEQ 'Y'                        *IF
      * Use Accounting Company if it is there
      * RTV OD Whs/ShpCo/AccCo RT - Order Detail  * 
     C                     EXSR TSRVGN
      * CASE: LCL.Accounting Company is Equal to zero
     C           YL0149    IFEQ *ZERO                      *IF
      * UPD Increment #Ord YTD RT - A/R Summary  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0030           Company Number
     C                     Z-ADDP1ANC7    WL0031           A/R Customer Nu
     C                     EXSR TURVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * UPD Increment #Ord YTD RT - A/R Summary  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0149    WL0030           Company Number
     C                     Z-ADDP1ANC7    WL0031           A/R Customer Nu
     C                     EXSR TURVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Create/Update Export Doc Order Header & Detail
      * CASE: PAR.Export Status is yes
     C           P1U2ST    IFEQ 'Y'                        *IF
      * 09/16/2020 DN R16637-Pass in Consignee Addr 4, State, Zip & Count
      * Exc Crt for Japan ords XF - Export Doc Order Hdr  * 
     C                     CALL 'PBS5XFR'              90  Exc Crt for Jap
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0054  30       Company Number
     C                     PARM P1C4NB    WQ0055  70       Order Number
     C                     PARM P4Z8CD    WQ0056  6        Country Code
     C                     PARM P9RHTX    WQ0057 63        ED Consignee Na
     C                     PARM P9RITX    WQ0058 63        ED Consignee Ad
     C                     PARM P9RJTX    WQ0059 63        ED Consignee Ad
     C                     PARM P9SCTX    WQ0060 63        ED Consignee Ad
     C                     PARM P9SDTX    WQ0061 63        ED Consignee Ad
     C                     PARM P9AAAB    WQ0062  2        ED Consignee St
     C                     PARM P9PHU1    WQ0063 20        ED Consignee Po
     C                     PARM P9ABAB    WQ0064  6        ED Consignee Co
     C                     PARM P4CPCD    WQ0065  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBS5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Credit Hold Status RT - Company Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
      * Establish starting position
     C           KRSSA     CHAIN@ASREGT              90    *
      * Data record not found
     C   90                MOVEL'USR0049' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAD8ST    P6D8ST           Credit Hold Sta
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Post/Update Cond   RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WBAIC3           Company Number
     C                     Z-ADDP1C4NB    WBC4NB           Order Number
      * Establish starting position
     C           KRSSB     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P1JNCD           Order Type - Sa
     C                     Z-ADD*ZERO     P1ANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     P1A5DT           Requested Ship
     C                     MOVEL*BLANK    P1CQCD           Reason Code
     C                     MOVEL*BLANK    P1GWST           Header Status
     C                     MOVEL*BLANK    P1GXST           Header Status L
     C                     MOVEL*BLANK    P1GYST           Order Type Prin
     C                     Z-ADD*ZERO     P1AODT           Scheduled Ship
     C                     Z-ADD*ZERO     P1JZVA           Order Value Tot
     C                     Z-ADD*ZERO     P1A1WG           Order Weight To
     C                     MOVEL*BLANK    P1XIST           Credit Hold
     C                     MOVEL*BLANK    P1XJST           Production Hold
     C                     Z-ADD*ZERO     P1RMNB           Load ID
     C                     MOVEL*BLANK    P1U2ST           Export Status
     C                     MOVEL*BLANK    P1VEST           Palletize
     C                     MOVEL*BLANK    P1U4ST           Load Plan Order
     C                     MOVEL*BLANK    P1R4CD           Sales Route Cod
     C                     MOVEL*BLANK    P1Z1ST           Modified Flag
     C                     Z-ADD*ZERO     P1VRVA           A/R order Value
     C                     MOVEL*BLANK    P1BCST           Block Order Fla
     C                     Z-ADD*ZERO     WUY4CD           Claim Number
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBJNCD    P1JNCD           Order Type - Sa
     C                     Z-ADDWBANC7    P1ANC7           A/R Customer Nu
     C                     Z-ADDWBA5DT    P1A5DT           Requested Ship
     C                     MOVELWBCQCD    P1CQCD           Reason Code
     C                     MOVELWBGWST    P1GWST           Header Status
     C                     MOVELWBGXST    P1GXST           Header Status L
     C                     MOVELWBGYST    P1GYST           Order Type Prin
     C                     Z-ADDWBAODT    P1AODT           Scheduled Ship
     C                     Z-ADDWBJZVA    P1JZVA           Order Value Tot
     C                     Z-ADDWBA1WG    P1A1WG           Order Weight To
     C                     MOVELWBXIST    P1XIST           Credit Hold
     C                     MOVELWBXJST    P1XJST           Production Hold
     C                     Z-ADDWBRMNB    P1RMNB           Load ID
     C                     MOVELWBU2ST    P1U2ST           Export Status
     C                     MOVELWBVEST    P1VEST           Palletize
     C                     MOVELWBU4ST    P1U4ST           Load Plan Order
     C                     MOVELWBR4CD    P1R4CD           Sales Route Cod
     C                     MOVELWBZ1ST    P1Z1ST           Modified Flag
     C                     Z-ADDWBVRVA    P1VRVA           A/R order Value
     C                     MOVELWBBCST    P1BCST           Block Order Fla
     C                     Z-ADDWBC0C7    WUY4CD           Claim Number
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Load Status        RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0001    WCRMNB           Load ID
      * Establish starting position
     C           KRSSC     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Load Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWCPKST    WL0002           Load Status
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV All Fields         RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WBAIC3           Company Number
     C                     Z-ADDP1C4NB    WBC4NB           Order Number
      * Establish starting position
     C           KRSSD     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0004           Order Type - Sa
     C                     Z-ADD*ZERO     YL0005           A/R Customer Nu
     C                     Z-ADD*ZERO     YL0006           Ship To Custome
     C                     MOVEL*BLANK    YL0007           Ship To Name
     C                     MOVEL*BLANK    YL0008           Ship To Address
     C                     MOVEL*BLANK    YL0009           Ship To Address
     C                     MOVEL*BLANK    YL0010           Ship To Address
     C                     MOVEL*BLANK    YL0011           Ship To City
     C                     MOVEL*BLANK    YL0012           Ship To State C
     C                     MOVEL*BLANK    YL0013           Ship To Zip/Pos
     C                     Z-ADD*ZERO     YL0014           Bill to Custome
     C                     MOVEL*BLANK    YL0015           Bill to Name
     C                     MOVEL*BLANK    YL0016           Bill to Address
     C                     MOVEL*BLANK    YL0017           Bill to Address
     C                     MOVEL*BLANK    YL0018           Bill to Address
     C                     MOVEL*BLANK    YL0019           Bill to City
     C                     MOVEL*BLANK    YL0020           Bill to State C
     C                     MOVEL*BLANK    YL0021           Bill to Zip/Pos
     C                     MOVEL*BLANK    YL0022           Customer Purcha
     C                     Z-ADD*ZERO     YL0023           Order Date
     C                     Z-ADD*ZERO     YL0024           Requested Ship
     C                     Z-ADD*ZERO     YL0025           Actual Shipped
     C                     Z-ADD*ZERO     YL0026           Cancel Date
     C                     MOVEL*BLANK    YL0027           Terms Code
     C                     MOVEL*BLANK    YL0028           Special Instruc
     C                     MOVEL*BLANK    YL0029           Special Instruc
     C                     MOVEL*BLANK    YL0030           Carrier Code
     C                     MOVEL*BLANK    YL0031           Comment Print A
     C                     MOVEL*BLANK    YL0032           Comment Print I
     C                     MOVEL*BLANK    YL0033           Comment Print P
     C                     MOVEL*BLANK    YL0034           Comment Print S
     C                     MOVEL*BLANK    YL0035           Reason Code
     C                     MOVEL*BLANK    YL0036           Order in Use
     C                     MOVEL*BLANK    YL0037           Header Status
     C                     MOVEL*BLANK    YL0038           Header Status L
     C                     MOVEL*BLANK    YL0039           Order Type Prin
     C                     Z-ADD*ZERO     YL0040           Scheduled Ship
     C                     MOVEL*BLANK    YL0041           User Original E
     C                     Z-ADD*ZERO     YL0042           Date of Origina
     C                     Z-ADD*ZERO     YL0043           Order Value Tot
     C                     Z-ADD*ZERO     YL0044           Order Weight To
     C                     MOVEL*BLANK    YL0045           Credit Hold
     C                     MOVEL*BLANK    YL0046           Production Hold
     C                     MOVEL*BLANK    YL0047           New Customer Ho
     C                     Z-ADD*ZERO     YL0048           Requested Deliv
     C                     Z-ADD*ZERO     YL0049           Requested Deliv
     C                     MOVEL*BLANK    YL0050           Accounts Receiv
     C                     MOVEL*BLANK    YL0051           Accounts Receiv
     C                     Z-ADD*ZERO     YL0052           Load ID
     C                     Z-ADD*ZERO     YL0053           Absorbed Freigh
     C                     Z-ADD*ZERO     YL0054           Rated Freight
     C                     MOVEL*BLANK    YL0055           LTL Flag
     C                     MOVEL*BLANK    YL0056           Price Audit
     C                     MOVEL*BLANK    YL0057           Price Status
     C                     MOVEL*BLANK    YL0058           Shipping Method
     C                     MOVEL*BLANK    YL0059           Export Status
     C                     MOVEL*BLANK    YL0060           Palletize
     C                     MOVEL*BLANK    YL0061           Shrink Wrap
     C                     MOVEL*BLANK    YL0062           Slip Sheet
     C                     MOVEL*BLANK    YL0063           Age Code
     C                     Z-ADD*ZERO     YL0064           Reefer Temperat
     C                     MOVEL*BLANK    YL0065           Load Type
     C                     Z-ADD*ZERO     YL0066           Attach to Invoi
     C                     MOVEL*BLANK    YL0067           Load Plan Order
     C                     MOVEL*BLANK    YL0068           Print Pick Slip
     C                     Z-ADD*ZERO     YL0069           Resell Referenc
     C                     MOVEL*BLANK    YL0070           Special Comment
     C                     MOVEL*BLANK    YL0071           Special Comment
     C                     MOVEL*BLANK    YL0072           Affect Auto Acc
     C                     MOVEL*BLANK    YL0073           Sales Route Cod
     C                     MOVEL*BLANK    YL0074           Manager Level C
     C                     MOVEL*BLANK    YL0075           VP Level Code
     C                     Z-ADD*ZERO     YL0076           Attach to Order
     C                     MOVEL*BLANK    YL0077           Reason for Pric
     C                     Z-ADD*ZERO     YL0078           Invoice Number
     C                     MOVEL*BLANK    YL0079           Invoice Suffix
     C                     Z-ADD*ZERO     YL0080           Invoice Date
     C                     MOVEL*BLANK    YL0081           Event Code
     C                     MOVEL*BLANK    YL0082           Trans Contol AS
     C                     MOVEL*BLANK    YL0083           Modified Flag
     C                     Z-ADD*ZERO     YL0084           A/R order Value
     C                     MOVEL*BLANK    YL0085           Billing Activit
     C                     MOVEL*BLANK    YL0086           Block Order Fla
     C                     MOVEL*BLANK    YL0087           Order Certifica
     C                     Z-ADD*ZERO     YL0088           Invoice Order V
     C                     MOVEL*BLANK    YL0089           Process Sts for
     C                     MOVEL*BLANK    YL0090           Order Conf Fax
     C                     MOVEL*BLANK    YL0091           Manifest Fax St
     C                     MOVEL*BLANK    YL0092           Invoice Fax Sts
     C                     MOVEL*BLANK    YL0093           Transfer in Sto
     C                     MOVEL*BLANK    YL0094           Email Cust On O
     C                     MOVEL*BLANK    YL0095           Order Emailed
     C                     MOVEL*BLANK    YL0096           Export Docs Go
     C                     MOVEL*BLANK    YL0097           Shipping Temp C
     C                     MOVEL*BLANK    YL0098           Broker Order St
     C                     MOVEL*BLANK    YL0099           Air Freight Ord
     C                     MOVEL*BLANK    YL0100           Order Requires
     C                     MOVEL*BLANK    YL0101           OH Load Plan Re
     C                     MOVEL*BLANK    YL0102           Export USDA App
     C                     MOVEL*BLANK    YL0103           HPB Ship to War
     C                     MOVEL*BLANK    YL0104           OH TF Exempt Co
     C                     Z-ADD*ZERO     YL0105           OH Appt Confirm
     C                     Z-ADD*ZERO     YL0106           JPN Invoice Iss
     C                     Z-ADD*ZERO     YL0107           Load Actual Shi
     C                     Z-ADD*ZERO     YL0108           Load BOL Comple
     C                     Z-ADD*ZERO     YL0109           Load Truck Depa
     C                     Z-ADD*ZERO     YL0110           Maximum Gross W
     C                     Z-ADD*ZERO     YL0111           Time of Origina
     C                     Z-ADD*ZERO     YL0112           OH Appt Confirm
     C                     Z-ADD*ZERO     YL0113           Load BOL Comple
     C                     Z-ADD*ZERO     YL0114           Load Truck Depa
     C                     Z-ADD*ZERO     YL0115           Act Frt Referen
     C                     Z-ADD*ZERO     YL0116           Act Non-Ref Frt
     C                     Z-ADD*ZERO     YL0117           OH Fuel Surchar
     C                     Z-ADD*ZERO     YL0118           OH Total Non-Re
     C                     Z-ADD*ZERO     YL0119           OH Total Ref Fr
     C                     Z-ADD*ZERO     YL0120           Claim Number
     C                     MOVEL*BLANK    YL0121           EDI Status 1
     C                     MOVEL*BLANK    YL0122           EDI Status 2
     C                     MOVEL*BLANK    YL0123           EDI Status 3
     C                     Z-ADD*ZERO     YL0124           Job Time
     C                     MOVEL*BLANK    YL0125           User Id
     C                     MOVEL*BLANK    YL0126           Job Name
     C                     Z-ADD*ZERO     YL0127           Job Date
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBJNCD    YL0004           Order Type - Sa
     C                     Z-ADDWBANC7    YL0005           A/R Customer Nu
     C                     Z-ADDWBBKC7    YL0006           Ship To Custome
     C                     MOVELWBBRTX    YL0007           Ship To Name
     C                     MOVELWBHMNA    YL0008           Ship To Address
     C                     MOVELWBHONA    YL0009           Ship To Address
     C                     MOVELWBHPNA    YL0010           Ship To Address
     C                     MOVELWBHNNA    YL0011           Ship To City
     C                     MOVELWBDBCD    YL0012           Ship To State C
     C                     MOVELWBCKTX    YL0013           Ship To Zip/Pos
     C                     Z-ADDWBB0C7    YL0014           Bill to Custome
     C                     MOVELWBAETX    YL0015           Bill to Name
     C                     MOVELWBB1NA    YL0016           Bill to Address
     C                     MOVELWBB3NA    YL0017           Bill to Address
     C                     MOVELWBB4NA    YL0018           Bill to Address
     C                     MOVELWBB2NA    YL0019           Bill to City
     C                     MOVELWBBHCD    YL0020           Bill to State C
     C                     MOVELWBC8TX    YL0021           Bill to Zip/Pos
     C                     MOVELWBBCNA    YL0022           Customer Purcha
     C                     Z-ADDWBA0DT    YL0023           Order Date
     C                     Z-ADDWBA5DT    YL0024           Requested Ship
     C                     Z-ADDWBGNDT    YL0025           Actual Shipped
     C                     Z-ADDWBACDT    YL0026           Cancel Date
     C                     MOVELWBAQCD    YL0027           Terms Code
     C                     MOVELWBB6NA    YL0028           Special Instruc
     C                     MOVELWBBYNA    YL0029           Special Instruc
     C                     MOVELWBBZNA    YL0030           Carrier Code
     C                     MOVELWBGTST    YL0031           Comment Print A
     C                     MOVELWBGVST    YL0032           Comment Print I
     C                     MOVELWBGUST    YL0033           Comment Print P
     C                     MOVELWBQFST    YL0034           Comment Print S
     C                     MOVELWBCQCD    YL0035           Reason Code
     C                     MOVELWBGJST    YL0036           Order in Use
     C                     MOVELWBGWST    YL0037           Header Status
     C                     MOVELWBGXST    YL0038           Header Status L
     C                     MOVELWBGYST    YL0039           Order Type Prin
     C                     Z-ADDWBAODT    YL0040           Scheduled Ship
     C                     MOVELWBAIVN    YL0041           User Original E
     C                     Z-ADDWBCXDT    YL0042           Date of Origina
     C                     Z-ADDWBJZVA    YL0043           Order Value Tot
     C                     Z-ADDWBA1WG    YL0044           Order Weight To
     C                     MOVELWBXIST    YL0045           Credit Hold
     C                     MOVELWBXJST    YL0046           Production Hold
     C                     MOVELWBXKST    YL0047           New Customer Ho
     C                     Z-ADDWBEIDT    YL0048           Requested Deliv
     C                     Z-ADDWBAFTM    YL0049           Requested Deliv
     C                     MOVELWBE8CD    YL0050           Accounts Receiv
     C                     MOVELWBE9CD    YL0051           Accounts Receiv
     C                     Z-ADDWBRMNB    YL0052           Load ID
     C                     Z-ADDWBTBNB    YL0053           Absorbed Freigh
     C                     Z-ADDWBR1NB    YL0054           Rated Freight
     C                     MOVELWBPJST    YL0055           LTL Flag
     C                     MOVELWBU0ST    YL0056           Price Audit
     C                     MOVELWBU1ST    YL0057           Price Status
     C                     MOVELWBQ2CD    YL0058           Shipping Method
     C                     MOVELWBU2ST    YL0059           Export Status
     C                     MOVELWBVEST    YL0060           Palletize
     C                     MOVELWBVFST    YL0061           Shrink Wrap
     C                     MOVELWBVGST    YL0062           Slip Sheet
     C                     MOVELWBRPCD    YL0063           Age Code
     C                     Z-ADDWBRNNB    YL0064           Reefer Temperat
     C                     MOVELWBVDST    YL0065           Load Type
     C                     Z-ADDWBATIN    YL0066           Attach to Invoi
     C                     MOVELWBU4ST    YL0067           Load Plan Order
     C                     MOVELWBU5ST    YL0068           Print Pick Slip
     C                     Z-ADDWBRSRN    YL0069           Resell Referenc
     C                     MOVELWBMHNA    YL0070           Special Comment
     C                     MOVELWBMINA    YL0071           Special Comment
     C                     MOVELWBWBST    YL0072           Affect Auto Acc
     C                     MOVELWBR4CD    YL0073           Sales Route Cod
     C                     MOVELWBBFCD    YL0074           Manager Level C
     C                     MOVELWBQ4CD    YL0075           VP Level Code
     C                     Z-ADDWBT3NB    YL0076           Attach to Order
     C                     MOVELWBSICD    YL0077           Reason for Pric
     C                     Z-ADDWBCONB    YL0078           Invoice Number
     C                     MOVELWBCEST    YL0079           Invoice Suffix
     C                     Z-ADDWBAWDT    YL0080           Invoice Date
     C                     MOVELWBJPCD    YL0081           Event Code
     C                     MOVELWBXUST    YL0082           Trans Contol AS
     C                     MOVELWBZ1ST    YL0083           Modified Flag
     C                     Z-ADDWBVRVA    YL0084           A/R order Value
     C                     MOVELWBOBST    YL0085           Billing Activit
     C                     MOVELWBBCST    YL0086           Block Order Fla
     C                     MOVELWBBDST    YL0087           Order Certifica
     C                     Z-ADDWBB7VL    YL0088           Invoice Order V
     C                     MOVELWBGASX    YL0089           Process Sts for
     C                     MOVELWBGBSX    YL0090           Order Conf Fax
     C                     MOVELWBGCSX    YL0091           Manifest Fax St
     C                     MOVELWBGDSX    YL0092           Invoice Fax Sts
     C                     MOVELWBFNSX    YL0093           Transfer in Sto
     C                     MOVELWBFOSX    YL0094           Email Cust On O
     C                     MOVELWBFPSX    YL0095           Order Emailed
     C                     MOVELWBFQSX    YL0096           Export Docs Go
     C                     MOVELWBFRSX    YL0097           Shipping Temp C
     C                     MOVELWBFSSX    YL0098           Broker Order St
     C                     MOVELWBFTSX    YL0099           Air Freight Ord
     C                     MOVELWBFUSX    YL0100           Order Requires
     C                     MOVELWBFVSX    YL0101           OH Load Plan Re
     C                     MOVELWBFWSX    YL0102           Export USDA App
     C                     MOVELWBFXSX    YL0103           HPB Ship to War
     C                     MOVELWBFYSX    YL0104           OH TF Exempt Co
     C                     Z-ADDWBNODT    YL0105           OH Appt Confirm
     C                     Z-ADDWBNPDT    YL0106           JPN Invoice Iss
     C                     Z-ADDWBNQDT    YL0107           Load Actual Shi
     C                     Z-ADDWBNRDT    YL0108           Load BOL Comple
     C                     Z-ADDWBNSDT    YL0109           Load Truck Depa
     C                     Z-ADDWBBPTM    YL0110           Maximum Gross W
     C                     Z-ADDWBBQTM    YL0111           Time of Origina
     C                     Z-ADDWBBRTM    YL0112           OH Appt Confirm
     C                     Z-ADDWBBSTM    YL0113           Load BOL Comple
     C                     Z-ADDWBBTTM    YL0114           Load Truck Depa
     C                     Z-ADDWBH0NX    YL0115           Act Frt Referen
     C                     Z-ADDWBH1NX    YL0116           Act Non-Ref Frt
     C                     Z-ADDWBH2NX    YL0117           OH Fuel Surchar
     C                     Z-ADDWBH3NX    YL0118           OH Total Non-Re
     C                     Z-ADDWBH4NX    YL0119           OH Total Ref Fr
     C                     Z-ADDWBC0C7    YL0120           Claim Number
     C                     MOVELWBUVST    YL0121           EDI Status 1
     C                     MOVELWBUWST    YL0122           EDI Status 2
     C                     MOVELWBUXST    YL0123           EDI Status 3
     C                     Z-ADDWBAATM    YL0124           Job Time
     C                     MOVELWBAYNA    YL0125           User Id
     C                     MOVELWBA0NA    YL0126           Job Name
     C                     Z-ADDWBAXDT    YL0127           Job Date
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Edt Post Upd OrdDtl   RT - Order Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        Affect Inventor
     C                     MOVEL*BLANK    WN0002  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0003  1        Affect Sales Pn
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSE01           Company Number
     C           *LIKE     DEFN WDC4NB    WQSE02           Order Number
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSE01           Company Number
     C                     Z-ADDP1C4NB    WQSE02           Order Number
      * Establish starting position
     C           KRSSE     SETLL@BGWKL1                    *
     C           KRSSE     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    YL0132           USR Update Flag
      * CHK: Requested Ship Date, Scheduled Ship Date, Sales Route Code
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : DB1.Requested Ship Date NE PAR.Requested Ship Date
      *   |- c2    : DB1.Scheduled Ship Date NE PAR.Scheduled Ship Date
      *   |- c3    : DB1.Sales Route Code NE PAR.Sales Route Code
      *   '-
     C           WDA5DT    IFNE P1A5DT                     *IF
     C           WDAODT    ORNE P1AODT                     *OR
     C           WDR4CD    ORNE P1R4CD                     *OR
     C                     MOVEL'Y'       YL0132           USR Update Flag
     C                     END                             *FI
      * CHK: Affect Inventory Status
      * CASE: DB1.Affect Inventory Status is blank
     C           WDAMST    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WN0001           Affect Inventor
     C                     MOVEL'Y'       YL0132           USR Update Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWDAMST    WN0001           Affect Inventor
     C                     END                             *FI
      * CHK: Affect Sales Dollars Status
      * CASE: DB1.Affect Sales Doll Status is blank
     C           WDANST    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WN0002           Affect Sales Do
     C                     MOVEL'Y'       YL0132           USR Update Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWDANST    WN0002           Affect Sales Do
     C                     END                             *FI
      * CHK: Affect Sales Pounds Status
      * CASE: DB1.Affect Sales Pnds Status is blank
     C           WDVAST    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WN0003           Affect Sales Pn
     C                     MOVEL'Y'       YL0132           USR Update Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWDVAST    WN0003           Affect Sales Pn
     C                     END                             *FI
      * UPD: Order Detail
      * CASE: LCL.USR Update Flag is Yes
     C           YL0132    IFEQ 'Y'                        *IF
      * Edt Post Upd OrdDtl   CH - Order Detail  * 
     C                     EXSR SFCHRC
     C                     END                             *FI
     C           KRSSE     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * Edt Post Upd OrdDtl   CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0004  70       Item Code
     C                     MOVEL*BLANK    WN0005  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0006  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0007  70       Order Group Cod
     C                     MOVEL*BLANK    WN0008  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0009  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0010 112       Billing Detail
     C                     Z-ADD*ZERO     WN0011 112       Billing Detail
     C                     Z-ADD*ZERO     WN0012 112       Billing Detail
     C                     Z-ADD*ZERO     WN0013 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0014  1        Comment Print A
     C                     MOVEL*BLANK    WN0015  1        Comment Print I
     C                     MOVEL*BLANK    WN0016  1        Comment Print P
     C                     MOVEL*BLANK    WN0017  1        Comment Print S
     C                     Z-ADD*ZERO     WN0018 112       Extended Amount
     C                     Z-ADD*ZERO     WN0019  70       Market Pricing
     C                     MOVEL*BLANK    WN0020  3        Commodity Marke
     C                     MOVEL*BLANK    WN0021  3        Date Method Cod
     C                     MOVEL*BLANK    WN0022  3        Price Method Co
     C                     Z-ADD*ZERO     WN0023 114       Price Overage O
     C                     Z-ADD*ZERO     WN0024  70       Contract Number
     C                     MOVEL*BLANK    WN0025  1        Price Status
     C                     Z-ADD*ZERO     WN0026  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0027  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0028  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0029  1        Work Confirm St
     C                     MOVEL*BLANK    WN0030  1        Work Over/Short
     C                     MOVEL*BLANK    WN0031  1        OD Production P
     C                     MOVEL*BLANK    WN0032 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0033 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0034  1        Age Code
     C                     MOVEL*BLANK    WN0035  1        Palletize
     C                     MOVEL*BLANK    WN0036  1        Slip Sheet
     C                     MOVEL*BLANK    WN0037  1        Catch Weight St
     C                     MOVEL*BLANK    WN0038  1        Price Audit
     C                     MOVEL*BLANK    WN0039  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0040  1        Production Date
     C                     Z-ADD*ZERO     WN0041 112       Rated Freight
     C                     Z-ADD*ZERO     WN0042 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0043 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0044 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0045 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0046 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0047 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0048 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0049 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0050 114       Unit Price
     C                     Z-ADD*ZERO     WN0051 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0052 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0053 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0054 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0055  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0056  30       Item Structure
     C                     Z-ADD*ZERO     WN0057  30       Item Structure
     C                     Z-ADD*ZERO     WN0058  30       Item Structure
     C                     MOVEL*BLANK    WN0059  2        Item Level
     C                     MOVEL*BLANK    WN0060  2        Quality Level
     C                     MOVEL*BLANK    WN0061  2        Pricing Product
     C                     MOVEL*BLANK    WN0062  2        Season Product
     C                     Z-ADD*ZERO     WN0063  70       Date of Origina
     C                     MOVEL*BLANK    WN0064 10        User Profile Na
     C                     MOVEL*BLANK    WN0065  6        Country Code
     C                     MOVEL*BLANK    WN0066  2        Event Code
     C                     MOVEL*BLANK    WN0067  3        Reason Code
     C                     MOVEL*BLANK    WN0068  1        Modified Flag
     C                     MOVEL*BLANK    WN0069  1        Substituted Fla
     C                     MOVEL*BLANK    WN0070  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0071 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0072 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0073  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0074  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0075  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0076  1        Affect Commissi
     C                     MOVEL*BLANK    WN0077  1        Affect Pricing
     C                     MOVEL*BLANK    WN0078  1        Released by Use
     C                     MOVEL*BLANK    WN0079  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0080  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0081  3        Production Ware
     C                     MOVEL*BLANK    WN0082  3        OD Price Type
     C                     Z-ADD*ZERO     WN0083  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0084  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0085  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0086  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0087  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0088  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0089  60       Price Code
     C                     Z-ADD*ZERO     WN0090  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0091  60       Substitution Li
     C                     Z-ADD*ZERO     WN0092  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0093 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0094 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0095 112       OD Item Target
     C                     Z-ADD*ZERO     WN0096 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0097 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0098 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0099 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0100 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0101 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0102 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0103 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0104 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0105 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0106  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0107  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0108  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0109 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0110  40       Item Age Days
     C                     Z-ADD*ZERO     WN0111  70       Production Ovr
     C                     Z-ADD*ZERO     WN0112  70       Production Ovr
     C                     MOVEL*BLANK    WN0113  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0114  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0115  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0116  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0117  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0118  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0119  1        EDI Status 1
     C                     MOVEL*BLANK    WN0120  1        EDI Status 2
     C                     MOVEL*BLANK    WN0121  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0122  60       Job Time
     C                     MOVEL*BLANK    WN0123 10        User Id
     C                     MOVEL*BLANK    WN0124 10        Job Name
     C                     Z-ADD*ZERO     WN0125  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWDAIC3    WEAIC3           Company Number
     C                     Z-ADDWDC4NB    WEC4NB           Order Number
     C                     Z-ADDWDDPNB    WEDPNB           Order Sequence
     C                     Z-ADDWDUENB    WEUENB           Order Secondary
      *
     C           KLCHSF    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C           KLCHSF    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YARDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDP1A5DT    WEA5DT           Requested Ship
     C                     Z-ADDP1AODT    WEAODT           Scheduled Ship
     C                     MOVELWN0001    WEAMST    P      Affect Inventor
     C                     MOVELWN0002    WEANST    P      Affect Sales Do
     C                     MOVELWN0003    WEVAST    P      Affect Sales Pn
     C                     MOVELP1R4CD    WER4CD    P      Sales Route Cod
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Credit Limits      RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WFBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0003    WFBKC7           Ship To Custome
      * Establish starting position
     C           KRSSG     CHAIN@BBREWG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFBTC7    WL0004           Parent Customer
     C                     MOVELWFK6ST    WL0005           Credit Check A/
     C                     MOVELWFUZST    WL0006           Credit Check Pa
     C                     Z-ADDWFS2NB    WL0007           Parent Credit L
     C                     Z-ADDWFVHVA    WL0008           A/R Credit Limi
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv/Chg Whs,ld miles  RT - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0130  70       Total Load Mile
     C                     MOVEL*BLANK    WN0131  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0132  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0133  70       Override Total
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WCRMNB           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WCRMNB           Load ID
      * Establish starting position
     C           KRSSH     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV First Order Whse   RT - OM Load Detail  * 
     C                     EXSR SIRVGN
      * CASE: DB1.Warehouse Code EQ PAR.Ship From Warehouse
     C           WCAJCD    IFEQ WN0131                     *IF
     C                     MOVEL*BLANK    WN0132           Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWCAJCD    WN0132           Warehouse Code
     C                     END                             *FI
      * ** 11/16/2007 LJB FP1251 Total Load Miles will = zeros if no
      * ** Miles Between Cities record exists
      * ** Override total load miles will take precedence over tlm  E0020
      * E4119 RMC 7/15/16  Upd miles if NOT MG LOAD
      * CASE: DB1.MG Created Load is Yes
     C           WCRYSX    IFEQ 'Y'                        *IF
     C                     Z-ADDWCTLMI    WN0130           Total Load Mile
     C                     Z-ADDWCK2DT    WN0133           Override Total
     C                     ELSE
      * CASE: *OTHERWISE
      * CLC Total Load Miles   XF - Load Detail  * 
     C                     CLEARPARC
     C                     Z-ADDWCRMNB    PARMNB           Load ID
      *
     C                     CALL 'PDW3XFR'              90  CLC Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Load Detai
     C           WN0130    PARM WN0130    WQ0018  70       Total Load Mile
     C           WN0133    PARM WN0133    WQ0019  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * ** Add override miles to the update            E00207 LJB 08/13/0
      * CHG Ship FrmWhs,ld mls CH - Load Header  * 
     C                     EXSR SLCHRC
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV First Order Whse   RT - OM Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQSI02           Load ID
      * Define keylist
     C           KPSSI     KLIST
     C                     KFLD           WQSI02           Load ID
     C                     KFLD           WGRVNB           Stop/Drop
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI02           Load ID
      * Setup key
     C                     Z-ADDWCRMNB    WQSI02           Load ID
     C                     Z-ADD1         WGRVNB           Stop/Drop
      * Establish starting position
     C           KPSSI     SETLL@FLCPEB                    *
     C           KRSSI     READE@FLCPEB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
     C                     EXSR SJRVGN
     C                     GOTO SIEXIT                     *QUIT
     C           KRSSI     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN WHC4NB    WQSJ02           Order Number
      * Define keylist
     C           KPSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Order Number
     C                     KFLD           WHDPNB           Order Sequence
     C                     KFLD           WHUENB           Order Secondary
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Order Number
      * Setup key
     C                     Z-ADDWGAIC3    WQSJ01           Company Number
     C                     Z-ADDWGC4NB    WQSJ02           Order Number
     C                     Z-ADD*ZERO     WHDPNB           Order Sequence
     C                     Z-ADD*ZERO     WHUENB           Order Secondary
      * Establish starting position
     C           KPSSJ     SETLL@BGWKAE                    *
     C           KRSSJ     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0131           Warehouse Code
     C                     MOVEL*BLANK    WUG0TX           Trans Contol AS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Warehouse Control  RT - Warehouse  * 
     C                     EXSR SKRVGN
      * PAR = DB1 By name
     C                     MOVELWHAJCD    WN0131           Warehouse Code
     C                     GOTO SJEXIT                     *QUIT
     C           KRSSJ     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Warehouse Control  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WIAJCD           Warehouse Code
      * Setup key
     C                     MOVELWHAJCD    WIAJCD           Warehouse Code
      * Establish starting position
     C           KRSSK     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUG0TX           Trans Contol AS
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIXUST    WUG0TX           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * CHG Ship FrmWhs,ld mls CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0134  30       Company Number
     C                     Z-ADD*ZERO     WN0135  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0136  1        LTL Flag
     C                     MOVEL*BLANK    WN0137  1        Load Status
     C                     Z-ADD*ZERO     WN0138  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0139 15        Seal 1
     C                     MOVEL*BLANK    WN0140 15        Seal 2
     C                     MOVEL*BLANK    WN0141 15        Seal 3
     C                     MOVEL*BLANK    WN0142 15        Seal 4
     C                     MOVEL*BLANK    WN0143 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0144  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0145 112       Flat Amount
     C                     MOVEL*BLANK    WN0146  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0147  50       Total Stops
     C                     MOVEL*BLANK    WN0148 20        Trailer Id
     C                     MOVEL*BLANK    WN0149  3        Transloader Car
     C                     Z-ADD*ZERO     WN0150  40       BOL Time
     C                     MOVEL*BLANK    WN0151  3        Carrier Code
     C                     MOVEL*BLANK    WN0152  7        Truck Size
     C                     Z-ADD*ZERO     WN0153  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0154 112       Rated Freight
     C                     MOVEL*BLANK    WN0155  1        Ship Status
     C                     MOVEL*BLANK    WN0156  1        Load Type
     C                     Z-ADD*ZERO     WN0157  50       Number Pallets
     C                     Z-ADD*ZERO     WN0158  50       Number Pallets
     C                     Z-ADD*ZERO     WN0159 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0160  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0161  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0162  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0163 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0164 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0165  70       Actual Departur
     C                     Z-ADD*ZERO     WN0166  40       Departure Time
     C                     Z-ADD*ZERO     WN0167  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0168  52       Product Tempera
     C                     Z-ADD*ZERO     WN0169  50       Number Spacers
     C                     MOVEL*BLANK    WN0170 12        Car/Veh. Initia
     C                     MOVEL*BLANK    WN0171 12        Recorder ID
     C                     MOVEL*BLANK    WN0172  2        Shipping Method
     C                     MOVEL*BLANK    WN0173  2        Ship To State C
     C                     Z-ADD*ZERO     WN0174  70       Gross Weight
     C                     MOVEL*BLANK    WN0175  3        Carrier Broker
     C                     MOVEL*BLANK    WN0176  1        Export Status
     C                     Z-ADD*ZERO     WN0177  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0178  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0179  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0180  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0181  70       Spotted Date
     C                     Z-ADD*ZERO     WN0182  60       Spotted Time
     C                     Z-ADD*ZERO     WN0183  70       Load Finished D
     C                     Z-ADD*ZERO     WN0184  60       Load Finished T
     C                     Z-ADD*ZERO     WN0185  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0186  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0187  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0188  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0189  70       Truck Departure
     C                     Z-ADD*ZERO     WN0190  60       Truck Departure
     C                     Z-ADD*ZERO     WN0191  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0192  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0193  3        Shipping Line
     C                     MOVEL*BLANK    WN0194 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0195 30        Vessel Name
     C                     Z-ADD*ZERO     WN0196  50       Voyage
     C                     Z-ADD*ZERO     WN0197  70       Sail Date
     C                     MOVEL*BLANK    WN0198 12        Booking Number
     C                     MOVEL*BLANK    WN0199 20        Discharge Port
     C                     Z-ADD*ZERO     WN0200  70       Arrival Date
     C                     MOVEL*BLANK    WN0201 12        Container Numbe
     C                     Z-ADD*ZERO     WN0202  70       Date In
     C                     Z-ADD*ZERO     WN0203  60       Time In
     C                     Z-ADD*ZERO     WN0204  70       Date Out
     C                     Z-ADD*ZERO     WN0205  60       Time Out
     C                     Z-ADD*ZERO     WN0206 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0207  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0208  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0209  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0210  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0211  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0212  70       Requested Deliv
     C                     MOVEL*BLANK    WN0213  1        Load Acceptance
     C                     Z-ADD*ZERO     WN0214  70       On Yard Date
     C                     Z-ADD*ZERO     WN0215  60       On Yard Time
     C                     Z-ADD*ZERO     WN0216  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0217  60       Deadline Depart
     C                     MOVEL*BLANK    WN0218  1        Load Held Over
     C                     MOVEL*BLANK    WN0219  1        Load Held Over
     C                     MOVEL*BLANK    WN0220 15        Load Held Over
     C                     MOVEL*BLANK    WN0221 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0222 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0223  70       Express Mail Da
     C                     MOVEL*BLANK    WN0224  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0225  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0226  70       Product Complet
     C                     Z-ADD*ZERO     WN0227  60       Product Complet
     C                     Z-ADD*ZERO     WN0228  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0229  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0230  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0231  1        Load Confirmed
     C                     MOVEL*BLANK    WN0232 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0233  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0234  60       Load Door 1
     C                     Z-ADD*ZERO     WN0235  60       Load Door 2
     C                     MOVEL*BLANK    WN0236  1        Partial Load
     C                     MOVEL*BLANK    WN0237  1        Load Confirmati
     C                     MOVEL*BLANK    WN0238  1        Export Load USD
     C                     MOVEL*BLANK    WN0239  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0240 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0241 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0242 15        Late Billing Em
     C                     MOVEL*BLANK    WN0243 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0244 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0245  1        Multi Company L
     C                     MOVEL*BLANK    WN0246  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0247  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0248  1        LH Power Only L
     C                     MOVEL*BLANK    WN0249  1        MG Created Load
     C                     MOVEL*BLANK    WN0250  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0251  2        Load U/M
     C                     MOVEL*BLANK    WN0252  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0253  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0254  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0255  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0256  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0257  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0258  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0259  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0260  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0261  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0262  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0263  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0264  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0265  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0266  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0267  60       LH Unused Time
     C                     MOVEL*BLANK    WN0268  1        EDI Status 1
     C                     MOVEL*BLANK    WN0269  1        EDI Status 2
     C                     MOVEL*BLANK    WN0270  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0271  60       Job Time
     C                     MOVEL*BLANK    WN0272 10        User Id
     C                     MOVEL*BLANK    WN0273 10        Job Name
     C                     Z-ADD*ZERO     WN0274  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWCRMNB    WJRMNB           Load ID
      *
     C           KLCHSL    KLIST
     C                     KFLD           WJRMNB           Load ID
     C           KLCHSL    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YBRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWN0130    WJTLMI           Total Load Mile
     C                     MOVELWN0131    WJVPCD    P      Ship From Wareh
     C                     MOVELWN0132    WJAJCD    P      Warehouse Code
     C                     Z-ADDWN0133    WJK2DT           Override Total
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##PGM     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV MG Created Load   RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WCRMNB           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WCRMNB           Load ID
      * Establish starting position
     C           KRSSM     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0133           MG Created Load
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCRYSX    YL0133           MG Created Load
     C                     GOTO SMEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv 1st Ord Delv Dt/Tm RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQSN02           Load ID
      * Define keylist
     C           KPSSN     KLIST
     C                     KFLD           WQSN02           Load ID
     C                     KFLD           WGRVNB           Stop/Drop
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN02           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSN02           Load ID
     C                     Z-ADD*ZERO     WGRVNB           Stop/Drop
      * Establish starting position
     C           KPSSN     SETLL@FLCPEB                    *
     C           KRSSN     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Delivery Date/Time RT - Order Header TRG  * 
     C                     EXSR SORVGN
     C                     GOTO SNEXIT                     *QUIT
     C           KRSSN     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Delivery Date/Time RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDWGAIC3    WBAIC3           Company Number
     C                     Z-ADDWGC4NB    WBC4NB           Order Number
      * Establish starting position
     C           KRSSO     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUBRTX           Ship To Name
     C                     MOVEL*BLANK    WUHNNA           Ship To City
     C                     Z-ADD*ZERO     WN0128           Requested Deliv
     C                     Z-ADD*ZERO     WN0129           Requested Deliv
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBBRTX    WUBRTX           Ship To Name
     C                     MOVELWBHNNA    WUHNNA           Ship To City
     C                     Z-ADDWBEIDT    WN0128           Requested Deliv
     C                     Z-ADDWBAFTM    WN0129           Requested Deliv
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Shipping Method    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WCRMNB           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WCRMNB           Load ID
      * Establish starting position
     C           KRSSP     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCQ2CD    YL0134           Shipping Method
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGRMNB    WQSQ02           Load ID
      * Define keylist
     C           KPSSQ     KLIST
     C                     KFLD           WQSQ02           Load ID
     C                     KFLD           WGRVNB           Stop/Drop
     C                     KFLD           WGC4NB           Order Number
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ02           Load ID
      * Setup key
     C                     Z-ADDWL0009    WQSQ02           Load ID
     C                     Z-ADDWL0010    WGRVNB           Stop/Drop
     C                     Z-ADDWL0011    WGC4NB           Order Number
      * Establish starting position
     C           KPSSQ     SETLL@FLCPEB                    *
     C           KRSSQ     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGRWNB    WL0012           Miles to next s
     C                     GOTO SQEXIT                     *QUIT
     C           KRSSQ     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Legal Run Miles DscRT - Legal Run Mileage Hours  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KPSSR     KLIST
     C                     KFLD           WKMILE           Miles to First
      * Setup key
     C                     Z-ADDWN0276    WKMILE           Miles to First
      * Establish starting position
     C           KPSSR     SETLL@LGCPNM                    *
     C                     READ @LGCPNM                  90*
      * Data record not found
     C   90                MOVEL'USR2462' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWKHRRQ    YL0135           Hours Required
     C                     GOTO SREXIT                     *QUIT
     C                     READ @LGCPNM                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WCRMNB           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WCRMNB           Load ID
      * Establish starting position
     C           KRSSS     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCPKST    WUG0TX           Load Status
     C                     Z-ADDWCTLMI    WUTLMI           Total Load Mile
     C                     Z-ADDWCK2DT    WUK2DT           Override Total
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCHRC    BEGSR
      *================================================================
      * CHG Deadline Dep D/T   CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0284  30       Company Number
     C                     Z-ADD*ZERO     WN0285  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0286  1        LTL Flag
     C                     MOVEL*BLANK    WN0287  1        Load Status
     C                     Z-ADD*ZERO     WN0288  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0289 15        Seal 1
     C                     MOVEL*BLANK    WN0290 15        Seal 2
     C                     MOVEL*BLANK    WN0291 15        Seal 3
     C                     MOVEL*BLANK    WN0292 15        Seal 4
     C                     MOVEL*BLANK    WN0293 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0294  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0295 112       Flat Amount
     C                     MOVEL*BLANK    WN0296  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0297  50       Total Stops
     C                     MOVEL*BLANK    WN0298 20        Trailer Id
     C                     MOVEL*BLANK    WN0299  3        Transloader Car
     C                     Z-ADD*ZERO     WN0300  40       BOL Time
     C                     MOVEL*BLANK    WN0301  3        Carrier Code
     C                     MOVEL*BLANK    WN0302  7        Truck Size
     C                     Z-ADD*ZERO     WN0303  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0304 112       Rated Freight
     C                     MOVEL*BLANK    WN0305  1        Ship Status
     C                     MOVEL*BLANK    WN0306  1        Load Type
     C                     Z-ADD*ZERO     WN0307  50       Number Pallets
     C                     Z-ADD*ZERO     WN0308  50       Number Pallets
     C                     Z-ADD*ZERO     WN0309 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0310  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0311  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0312  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0313 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0314 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0315  70       Actual Departur
     C                     Z-ADD*ZERO     WN0316  40       Departure Time
     C                     Z-ADD*ZERO     WN0317  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0318  52       Product Tempera
     C                     Z-ADD*ZERO     WN0319  50       Number Spacers
     C                     MOVEL*BLANK    WN0320 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0321  70       Total Load Mile
     C                     MOVEL*BLANK    WN0322 12        Recorder ID
     C                     MOVEL*BLANK    WN0323  2        Shipping Method
     C                     MOVEL*BLANK    WN0324  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0325  2        Ship To State C
     C                     Z-ADD*ZERO     WN0326  70       Gross Weight
     C                     MOVEL*BLANK    WN0327  3        Carrier Broker
     C                     MOVEL*BLANK    WN0328  1        Export Status
     C                     Z-ADD*ZERO     WN0329  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0330  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0331  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0332  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0333  70       Spotted Date
     C                     Z-ADD*ZERO     WN0334  60       Spotted Time
     C                     Z-ADD*ZERO     WN0335  70       Load Finished D
     C                     Z-ADD*ZERO     WN0336  60       Load Finished T
     C                     Z-ADD*ZERO     WN0337  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0338  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0339  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0340  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0341  70       Truck Departure
     C                     Z-ADD*ZERO     WN0342  60       Truck Departure
     C                     Z-ADD*ZERO     WN0343  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0344  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0345  3        Shipping Line
     C                     MOVEL*BLANK    WN0346 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0347 30        Vessel Name
     C                     Z-ADD*ZERO     WN0348  50       Voyage
     C                     Z-ADD*ZERO     WN0349  70       Sail Date
     C                     MOVEL*BLANK    WN0350 12        Booking Number
     C                     MOVEL*BLANK    WN0351 20        Discharge Port
     C                     Z-ADD*ZERO     WN0352  70       Arrival Date
     C                     MOVEL*BLANK    WN0353 12        Container Numbe
     C                     Z-ADD*ZERO     WN0354  70       Date In
     C                     Z-ADD*ZERO     WN0355  60       Time In
     C                     Z-ADD*ZERO     WN0356  70       Date Out
     C                     Z-ADD*ZERO     WN0357  60       Time Out
     C                     Z-ADD*ZERO     WN0358 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0359  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0360  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0361  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0362  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0363  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0364  70       Requested Deliv
     C                     MOVEL*BLANK    WN0365  1        Load Acceptance
     C                     MOVEL*BLANK    WN0366  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0367  70       On Yard Date
     C                     Z-ADD*ZERO     WN0368  60       On Yard Time
     C                     MOVEL*BLANK    WN0369  1        Load Held Over
     C                     MOVEL*BLANK    WN0370  1        Load Held Over
     C                     MOVEL*BLANK    WN0371 15        Load Held Over
     C                     MOVEL*BLANK    WN0372 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0373 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0374  70       Express Mail Da
     C                     MOVEL*BLANK    WN0375  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0376  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0377  70       Product Complet
     C                     Z-ADD*ZERO     WN0378  60       Product Complet
     C                     Z-ADD*ZERO     WN0379  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0380  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0381  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0382  1        Load Confirmed
     C                     MOVEL*BLANK    WN0383 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0384  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0385  60       Load Door 1
     C                     Z-ADD*ZERO     WN0386  70       Override Total
     C                     Z-ADD*ZERO     WN0387  60       Load Door 2
     C                     MOVEL*BLANK    WN0388  1        Partial Load
     C                     MOVEL*BLANK    WN0389  1        Load Confirmati
     C                     MOVEL*BLANK    WN0390  1        Export Load USD
     C                     MOVEL*BLANK    WN0391  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0392 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0393 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0394 15        Late Billing Em
     C                     MOVEL*BLANK    WN0395 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0396 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0397  1        Multi Company L
     C                     MOVEL*BLANK    WN0398  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0399  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0400  1        LH Power Only L
     C                     MOVEL*BLANK    WN0401  1        MG Created Load
     C                     MOVEL*BLANK    WN0402  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0403  2        Load U/M
     C                     MOVEL*BLANK    WN0404  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0405  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0406  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0407  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0408  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0409  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0410  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0411  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0412  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0413  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0414  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0415  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0416  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0417  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0418  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0419  60       LH Unused Time
     C                     MOVEL*BLANK    WN0420  1        EDI Status 1
     C                     MOVEL*BLANK    WN0421  1        EDI Status 2
     C                     MOVEL*BLANK    WN0422  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0423  60       Job Time
     C                     MOVEL*BLANK    WN0424 10        User Id
     C                     MOVEL*BLANK    WN0425 10        Job Name
     C                     Z-ADD*ZERO     WN0426  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDP1RMNB    WJRMNB           Load ID
      *
     C           KLCHST    KLIST
     C                     KFLD           WJRMNB           Load ID
     C           KLCHST    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YCRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWN0126    WJKZDT           Deadline Depart
     C                     Z-ADDWN0127    WJAXTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##JOB     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * CHG Deadline Date/Time RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLRMNB    WQSU01           Load ID
      * Define keylist
     C           KPSSU     KLIST
     C                     KFLD           WQSU01           Load ID
     C                     KFLD           WLRUNB           Stop/Drop Seque
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSU01           Load ID
     C                     Z-ADD*ZERO     WLRUNB           Stop/Drop Seque
      * Establish starting position
     C           KPSSU     SETLL@FLCPBW                    *
     C           KRSSU     READE@FLCPBW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SUEXIT                     *QUIT
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Deadline Date/Time CH - Load Detail  * 
     C                     EXSR SVCHRC
     C           KRSSU     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCHRC    BEGSR
      *================================================================
      * CHG Deadline Date/Time CH - Load Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0427  50       Stop/Drop
     C                     MOVEL*BLANK    WN0428 30        Comments for Pi
     C                     Z-ADD*ZERO     WN0429  50       Miles to next s
     C                     Z-ADD*ZERO     WN0430  72       Freight Charge
     C                     Z-ADD*ZERO     WN0431  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0432 112       Freight Misc. C
     C                     Z-ADD*ZERO     WN0433  72       Freight Stop Ch
     C                     Z-ADD*ZERO     WN0434 112       Rated Freight
     C                     Z-ADD*ZERO     WN0435  30       Company Number
     C                     Z-ADD*ZERO     WN0436  70       Order Number
     C                     MOVEL*BLANK    WN0437  1        Ship Status
     C                     Z-ADD*ZERO     WN0438  70       Estimated Arriv
     C                     Z-ADD*ZERO     WN0439  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0440  70       Appointment Con
     C                     Z-ADD*ZERO     WN0441  60       Appointment Con
     C                     MOVEL*BLANK    WN0442 30        Confirmation Ma
     C                     MOVEL*BLANK    WN0443 10        Confirmation Nu
     C                     Z-ADD*ZERO     WN0444  70       Actual Delivery
     C                     Z-ADD*ZERO     WN0445  60       Actual Delivery
     C                     Z-ADD*ZERO     WN0446  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0447  60       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0448  70       On Yard Date
     C                     Z-ADD*ZERO     WN0449  60       On Yard Time
     C                     Z-ADD*ZERO     WN0450  70       MPC Number
     C                     MOVEL*BLANK    WN0451  1        Load Dtl On Tim
     C                     MOVEL*BLANK    WN0452  1        On Time Add'l R
     C                     MOVEL*BLANK    WN0453 15        Seal Nbr 1
     C                     MOVEL*BLANK    WN0454 15        Seal Nbr 2
     C                     MOVEL*BLANK    WN0455 15        Seal Nbr 3
     C                     MOVEL*BLANK    WN0456 15        Seal Nbr 4
     C                     MOVEL*BLANK    WN0457 15        Seal Nbr 5
     C                     Z-ADD*ZERO     WN0458  70       LD Carrier Appt
     C                     Z-ADD*ZERO     WN0459  70       LD Unused Date
     C                     Z-ADD*ZERO     WN0460  70       LD Unused Date
     C                     Z-ADD*ZERO     WN0461  60       LD Carrier Appt
     C                     Z-ADD*ZERO     WN0462  60       LD Unused Time
     C                     Z-ADD*ZERO     WN0463  60       LD Unused Time
     C                     MOVEL*BLANK    WN0464  1        Miles Error Sts
     C                     MOVEL*BLANK    WN0465  1        LD Unused Sts 2
     C                     MOVEL*BLANK    WN0466  2        HPB Transload S
     C                     MOVEL*BLANK    WN0467 15        LD Cst Svc Trac
     C                     MOVEL*BLANK    WN0468 25        Carrier Ref PRO
     C                     MOVEL*BLANK    WN0469 25        Cust Assigned A
     C                     MOVEL*BLANK    WN0470  1        EDI Status 1
     C                     MOVEL*BLANK    WN0471  1        EDI Status 2
     C                     MOVEL*BLANK    WN0472  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0473  60       Job Time
     C                     MOVEL*BLANK    WN0474 10        User Id
     C                     MOVEL*BLANK    WN0475 10        Job Name
     C                     Z-ADD*ZERO     WN0476  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @FLCPBM
     C                     Z-ADDP1RMNB    WMRMNB           Load ID
     C                     Z-ADDWLRUNB    WMRUNB           Stop/Drop Seque
      *
     C           KLCHSV    KLIST
     C                     KFLD           WMRMNB           Load ID
     C                     KFLD           WMRUNB           Stop/Drop Seque
     C           KLCHSV    CHAIN@FLCPBM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFLCPL0'MDACP
     C                     MOVEL'@FLCPBM' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFL1    YDRDCS
      * Move non-key fields to @FLCPBM
     C                     Z-ADDWN0126    WMHDDT           Deadline Depart
     C                     Z-ADDWN0127    WMAUTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WMAATM           Job Time
     C                     MOVEL##USR     WMAYNA           User Id
     C                     MOVEL##JOB     WMA0NA           Job Name
     C                     Z-ADD##JDT     WMAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@FLCPBM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFLCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * Upd Deadline Dte/Tme  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWMAIC3    WL0013           Company Number
     C                     Z-ADDWMC4NB    WL0014           Order Number
     C                     Z-ADDWMHDDT    WL0015           Deadline Depart
     C                     Z-ADDWMAUTM    WL0016           Deadline Depart
     C                     EXSR SWRVGN
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Upd Deadline Dte/Tme  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSW01           Company Number
     C           *LIKE     DEFN WDC4NB    WQSW02           Order Number
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           Company Number
     C                     KFLD           WQSW02           Order Number
      * Setup key
     C                     Z-ADDWL0013    WQSW01           Company Number
     C                     Z-ADDWL0014    WQSW02           Order Number
      * Establish starting position
     C           KRSSW     SETLL@BGWKL1                    *
     C           KRSSW     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Deadline Dte/Tme  CH - Order Detail  * 
     C                     EXSR SXCHRC
     C           KRSSW     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCHRC    BEGSR
      *================================================================
      * Chg Deadline Dte/Tme  CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0477  70       Item Code
     C                     MOVEL*BLANK    WN0478  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0479  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0480  70       Order Group Cod
     C                     MOVEL*BLANK    WN0481  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0482  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0483 112       Billing Detail
     C                     Z-ADD*ZERO     WN0484 112       Billing Detail
     C                     Z-ADD*ZERO     WN0485 112       Billing Detail
     C                     Z-ADD*ZERO     WN0486 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0487  1        Comment Print A
     C                     MOVEL*BLANK    WN0488  1        Comment Print I
     C                     MOVEL*BLANK    WN0489  1        Comment Print P
     C                     MOVEL*BLANK    WN0490  1        Comment Print S
     C                     Z-ADD*ZERO     WN0491 112       Extended Amount
     C                     Z-ADD*ZERO     WN0492  70       Market Pricing
     C                     MOVEL*BLANK    WN0493  3        Commodity Marke
     C                     MOVEL*BLANK    WN0494  3        Date Method Cod
     C                     MOVEL*BLANK    WN0495  3        Price Method Co
     C                     Z-ADD*ZERO     WN0496 114       Price Overage O
     C                     Z-ADD*ZERO     WN0497  70       Contract Number
     C                     MOVEL*BLANK    WN0498  1        Price Status
     C                     Z-ADD*ZERO     WN0499  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0500  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0501  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0502  1        Work Confirm St
     C                     MOVEL*BLANK    WN0503  1        Work Over/Short
     C                     MOVEL*BLANK    WN0504  1        OD Production P
     C                     MOVEL*BLANK    WN0505 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0506 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0507  1        Age Code
     C                     MOVEL*BLANK    WN0508  1        Palletize
     C                     MOVEL*BLANK    WN0509  1        Slip Sheet
     C                     MOVEL*BLANK    WN0510  1        Catch Weight St
     C                     MOVEL*BLANK    WN0511  1        Price Audit
     C                     MOVEL*BLANK    WN0512  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0513  1        Production Date
     C                     Z-ADD*ZERO     WN0514 112       Rated Freight
     C                     Z-ADD*ZERO     WN0515 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0516 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0517 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0518 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0519 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0520 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0521 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0522 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0523 114       Unit Price
     C                     Z-ADD*ZERO     WN0524 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0525 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0526 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0527 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0528  70       Requested Ship
     C                     Z-ADD*ZERO     WN0529  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0530  70       Actual Shipped
     C                     MOVEL*BLANK    WN0531  1        Affect Inventor
     C                     MOVEL*BLANK    WN0532  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0533  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0534  30       Item Structure
     C                     Z-ADD*ZERO     WN0535  30       Item Structure
     C                     Z-ADD*ZERO     WN0536  30       Item Structure
     C                     MOVEL*BLANK    WN0537  2        Item Level
     C                     MOVEL*BLANK    WN0538  2        Quality Level
     C                     MOVEL*BLANK    WN0539  2        Pricing Product
     C                     MOVEL*BLANK    WN0540  2        Season Product
     C                     Z-ADD*ZERO     WN0541  70       Date of Origina
     C                     MOVEL*BLANK    WN0542 10        User Profile Na
     C                     MOVEL*BLANK    WN0543  6        Country Code
     C                     MOVEL*BLANK    WN0544  2        Event Code
     C                     MOVEL*BLANK    WN0545  3        Reason Code
     C                     MOVEL*BLANK    WN0546  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0547  1        Modified Flag
     C                     MOVEL*BLANK    WN0548  1        Substituted Fla
     C                     MOVEL*BLANK    WN0549  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0550 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0551 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0552  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0553  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0554  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0555  1        Affect Commissi
     C                     MOVEL*BLANK    WN0556  1        Affect Pricing
     C                     MOVEL*BLANK    WN0557  1        Released by Use
     C                     MOVEL*BLANK    WN0558  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0559  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0560  3        Production Ware
     C                     MOVEL*BLANK    WN0561  3        OD Price Type
     C                     Z-ADD*ZERO     WN0562  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0563  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0564  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0565  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0566  60       Price Code
     C                     Z-ADD*ZERO     WN0567  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0568  60       Substitution Li
     C                     Z-ADD*ZERO     WN0569  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0570 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0571 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0572 112       OD Item Target
     C                     Z-ADD*ZERO     WN0573 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0574 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0575 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0576 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0577 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0578 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0579 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0580 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0581 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0582 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0583  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0584  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0585  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0586 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0587  40       Item Age Days
     C                     Z-ADD*ZERO     WN0588  70       Production Ovr
     C                     Z-ADD*ZERO     WN0589  70       Production Ovr
     C                     MOVEL*BLANK    WN0590  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0591  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0592  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0593  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0594  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0595  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0596  1        EDI Status 1
     C                     MOVEL*BLANK    WN0597  1        EDI Status 2
     C                     MOVEL*BLANK    WN0598  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0599  60       Job Time
     C                     MOVEL*BLANK    WN0600 10        User Id
     C                     MOVEL*BLANK    WN0601 10        Job Name
     C                     Z-ADD*ZERO     WN0602  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWDAIC3    WEAIC3           Company Number
     C                     Z-ADDWDC4NB    WEC4NB           Order Number
     C                     Z-ADDWDDPNB    WEDPNB           Order Sequence
     C                     Z-ADDWDUENB    WEUENB           Order Secondary
      *
     C           KLCHSX    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C           KLCHSX    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YERDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWL0015    WENVDT           Deadline Depart
     C                     Z-ADDWL0016    WEBUTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * VAL Ld/Ord/Type exists RT - Load Order Change Log  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WORMNB    WQSY01           Load ID
     C           *LIKE     DEFN WOC4NB    WQSY02           Order Number
     C           *LIKE     DEFN WORVST    WQSY03           Load Change Typ
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           Load ID
     C                     KFLD           WQSY02           Order Number
     C                     KFLD           WQSY03           Load Change Typ
      * Setup key
     C                     Z-ADDP1RMNB    WQSY01           Load ID
     C                     Z-ADDP1C4NB    WQSY02           Order Number
     C                     MOVEL'CRDRLS'  WQSY03           Load Change Typ
      * Establish starting position
     C           KRSSY     SETLL@LHCPHB                    *
     C           KRSSY     READE@LHCPHB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2471' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C           KRSSY     READE@LHCPHB                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV Sum $ Owed-A/R Cst RT - A/R Summary  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0607 112       Age $ Due-Curre
     C                     Z-ADD*ZERO     WN0608 112       Value of Open O
     C                     MOVEL*BLANK    WN0609  1        New Customer St
     C                     Z-ADD*ZERO     WN0610  70       Parent Customer
     C                     MOVEL*BLANK    WN0611  1        Credit Check A/
     C                     MOVEL*BLANK    WN0612  1        Credit Check Pa
     C                     MOVEL*BLANK    WN0613  1        Order Entry Hol
     C                     Z-ADD*ZERO     WN0614 112       Parent Credit L
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0018           @Numeric 15.2
      * Declare restrictor key work fields
     C           *LIKE     DEFN WRANC7    WQSZ01           A/R Customer Nu
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           A/R Customer Nu
      * Setup key
     C                     Z-ADDWL0017    WQSZ01           A/R Customer Nu
      * Establish starting position
     C           KRSSZ     SETLL@BCREEC                    *
     C           KRSSZ     READE@BCREEC                  90*
      * Data record not found
     C   90                MOVEL'USR0172' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Compute Credit Amount
      * PGM.*Synon (15,2) work field =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6 + x7)
      * x1    : DB1.Age $ Due-Current-W/O CB
      * +     : PGM.*Synon (15,2) work field
      * x2    : DB1.Age $ Due-Aging 1-W/O CB
      * +     : PGM.*Synon (15,2) work field
      * x3    : DB1.Age $ Due-Aging 2-W/O CB
      * +     : PGM.*Synon (15,2) work field
      * x4    : DB1.Age $ Due-Aging 3-W/O CB
      * +     : PGM.*Synon (15,2) work field
      * x5    : DB1.Age $ Due-Aging 4-W/O CB
      * +     : PGM.*Synon (15,2) work field
      * x6    : DB1.Age $ Due-Aging 5-W/O CB
      * +     : PGM.*Synon (15,2) work field
      * x7    : DB1.Value of Open Orders
     C           WRVIVA    ADD  WRVJVA    W0WA05           *Synon (15,2) w
     C           W0WA05    ADD  WRVKVA    W0WA04           *Synon (15,2) w
     C           W0WA04    ADD  WRVLVA    W0WA03           *Synon (15,2) w
     C           W0WA03    ADD  WRVMVA    W0WA02           *Synon (15,2) w
     C           W0WA02    ADD  WRVNVA    W0WA01           *Synon (15,2) w
     C           W0WA01    ADD  WREEVA    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    W0WA             *Synon (15,2) w
     C                     ADD  W0WA      WL0018           @Numeric 15.2
     C           KRSSZ     READE@BCREEC                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * CLC Sum A/R Due by Par RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0606           @Numeric 15.2
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSBTC7    WQTA01           Parent Customer
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           Parent Customer
      * Setup key
     C                     Z-ADDP2BTC7    WQTA01           Parent Customer
      * Establish starting position
     C           KRSTA     SETLL@BBREXK                    *
     C           KRSTA     READE@BBREXK                  90*
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * only process the customer once
      * CASE: DB1.Ship To Customer EQ DB1.A/R Customer Number
     C           WSBKC7    IFEQ WSANC7                     *IF
      * RTV Sum $ Owed-A/R Cst RT - A/R Summary  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWSANC7    WL0017           A/R Customer Nu
     C                     Z-ADDWUNM15    WL0018           @Numeric 15.2
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0018    WUNM15           @Numeric 15.2
     C                     ADD  WUNM15    WN0606           @Numeric 15.2
     C                     END                             *FI
     C           KRSTA     READE@BBREXK                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * RTV Chg Stat/Hdr P/S   RT - Order Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0615  1        Update Palletiz
     C                     MOVEL*BLANK    WN0616  1        Update Slip She
     C                     MOVEL*BLANK    WN0617  1        USR Update Flag
     C                     MOVEL*BLANK    WN0618  1        All OD Palletiz
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    WN0617           USR Update Flag
     C                     MOVEL'N'       WN0615           Update Palletiz
     C                     MOVEL'N'       WN0616           Update Slip She
     C                     MOVEL*BLANK    WUZ3ST           Substituted Fla
      * 06/16/21 DN W77734-Added All OD Palletize is No Flag.
     C                     MOVEL*BLANK    WN0618           All OD Palletiz
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTAIC3    WQTB01           Company Number
     C           *LIKE     DEFN WTC4NB    WQTB02           Order Number
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WQTB01           Company Number
     C                     KFLD           WQTB02           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WQTB01           Company Number
     C                     Z-ADDP1C4NB    WQTB02           Order Number
      * Establish starting position
     C           KRSTB     SETLL@BGWKKK                    *
     C           KRSTB     READE@BGWKKK                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WN0617           USR Update Flag
      * Update Entered to Available
      * CASE: DB1.Detail Line Status is Entered
     C           WTGMST    IFEQ 'E'                        *IF
     C                     MOVELWTGMST    WUGNST           Detail Line Sta
     C                     MOVEL'A'       WUGMST           Detail Line Sta
      * CHG Detail Status      CH - Order Detail  * 
     C                     EXSR TCCHRC
     C                     END                             *FI
      * Slip Sheet 'Y' on detail must be Yes on Header
      * CASE: DB1.Slip Sheet is yes
     C           WTVGST    IFEQ 'Y'                        *IF
     C                     MOVELWTVGST    WN0616           Update Slip She
     C                     MOVEL'Y'       WN0617           USR Update Flag
     C                     END                             *FI
      * Palletize  'Y' on detail must be Yes on Header - New Rule 8/25/09
      * CASE: DB1.Palletize is yes
     C           WTVEST    IFEQ 'Y'                        *IF
     C                     MOVELWTVEST    WN0615           Update Palletiz
     C                     MOVEL'Y'       WN0617           USR Update Flag
      * 06/16/21 DN W77734-Added All OD Palletize is No Flag.
     C                     MOVEL'N'       WN0618           All OD Palletiz
     C                     END                             *FI
      * 06/16/21 DN W77734-Keep Track if All OD is Palletize = No.
      * CASE:
      *  - c1 AND NOTc2
      *   |- c1    : DB1.Palletize is no
      *   |- c2    : PAR.All OD Palletize is No is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WTVEST    IFEQ 'N'                        *IF
     C           WN0618    IFEQ 'N'                        *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WN0618           All OD Palletiz
     C                     END                             *FI
      * Substitution flag
      * CASE: DB1.Order Secondary Line Seq is GT 1
     C           WTUENB    IFGT 1                          *IF
     C                     MOVEL'Y'       WUZ3ST           Substituted Fla
     C                     END                             *FI
      * Update Order Header
      * CASE: PAR.USR Update Flag is Yes
     C           WN0617    IFEQ 'Y'                        *IF
      * CHG Pall./Slip Post/Or CH - PD Order Header  * 
     C                     EXSR TDCHRC
     C                     END                             *FI
     C           KRSTB     READE@BGWKKK                  90*
     C                     ENDDO
      * USER: Exit processing
      * 06/16/21 DN W77734-If All OD Palletize is No Then Update OH to No
      * CASE: PAR.All OD Palletize is No is yes
     C           WN0618    IFEQ 'Y'                        *IF
      * CHG Palletize         CH - Order Header TRG  * 
     C                     EXSR TECHRC
     C                     END                             *FI
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCCHRC    BEGSR
      *================================================================
      * CHG Detail Status      CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0619  70       Item Code
     C                     MOVEL*BLANK    WN0620  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0621  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0622  70       Order Group Cod
     C                     Z-ADD*ZERO     WN0623 112       Billing Detail
     C                     Z-ADD*ZERO     WN0624 112       Billing Detail
     C                     Z-ADD*ZERO     WN0625 112       Billing Detail
     C                     Z-ADD*ZERO     WN0626 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0627  1        Comment Print A
     C                     MOVEL*BLANK    WN0628  1        Comment Print I
     C                     MOVEL*BLANK    WN0629  1        Comment Print P
     C                     MOVEL*BLANK    WN0630  1        Comment Print S
     C                     Z-ADD*ZERO     WN0631 112       Extended Amount
     C                     Z-ADD*ZERO     WN0632  70       Market Pricing
     C                     MOVEL*BLANK    WN0633  3        Commodity Marke
     C                     MOVEL*BLANK    WN0634  3        Date Method Cod
     C                     MOVEL*BLANK    WN0635  3        Price Method Co
     C                     Z-ADD*ZERO     WN0636 114       Price Overage O
     C                     Z-ADD*ZERO     WN0637  70       Contract Number
     C                     MOVEL*BLANK    WN0638  1        Price Status
     C                     Z-ADD*ZERO     WN0639  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0640  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0641  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0642  1        Work Confirm St
     C                     MOVEL*BLANK    WN0643  1        Work Over/Short
     C                     MOVEL*BLANK    WN0644  1        OD Production P
     C                     MOVEL*BLANK    WN0645 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0646 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0647  1        Age Code
     C                     MOVEL*BLANK    WN0648  1        Palletize
     C                     MOVEL*BLANK    WN0649  1        Slip Sheet
     C                     MOVEL*BLANK    WN0650  1        Catch Weight St
     C                     MOVEL*BLANK    WN0651  1        Price Audit
     C                     MOVEL*BLANK    WN0652  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0653  1        Production Date
     C                     Z-ADD*ZERO     WN0654 112       Rated Freight
     C                     Z-ADD*ZERO     WN0655 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0656 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0657 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0658 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0659 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0660 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0661 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0662 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0663 114       Unit Price
     C                     Z-ADD*ZERO     WN0664 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0665 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0666 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0667 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0668  70       Requested Ship
     C                     Z-ADD*ZERO     WN0669  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0670  70       Actual Shipped
     C                     MOVEL*BLANK    WN0671  1        Affect Inventor
     C                     MOVEL*BLANK    WN0672  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0673  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0674  30       Item Structure
     C                     Z-ADD*ZERO     WN0675  30       Item Structure
     C                     Z-ADD*ZERO     WN0676  30       Item Structure
     C                     MOVEL*BLANK    WN0677  2        Item Level
     C                     MOVEL*BLANK    WN0678  2        Quality Level
     C                     MOVEL*BLANK    WN0679  2        Pricing Product
     C                     MOVEL*BLANK    WN0680  2        Season Product
     C                     Z-ADD*ZERO     WN0681  70       Date of Origina
     C                     MOVEL*BLANK    WN0682 10        User Profile Na
     C                     MOVEL*BLANK    WN0683  6        Country Code
     C                     MOVEL*BLANK    WN0684  2        Event Code
     C                     MOVEL*BLANK    WN0685  3        Reason Code
     C                     MOVEL*BLANK    WN0686  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0687  1        Modified Flag
     C                     MOVEL*BLANK    WN0688  1        Substituted Fla
     C                     MOVEL*BLANK    WN0689  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0690 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0691 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0692  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0693  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0694  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0695  1        Affect Commissi
     C                     MOVEL*BLANK    WN0696  1        Affect Pricing
     C                     MOVEL*BLANK    WN0697  1        Released by Use
     C                     MOVEL*BLANK    WN0698  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0699  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0700  3        Production Ware
     C                     MOVEL*BLANK    WN0701  3        OD Price Type
     C                     Z-ADD*ZERO     WN0702  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0703  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0704  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0705  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0706  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0707  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0708  60       Price Code
     C                     Z-ADD*ZERO     WN0709  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0710  60       Substitution Li
     C                     Z-ADD*ZERO     WN0711  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0712 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0713 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0714 112       OD Item Target
     C                     Z-ADD*ZERO     WN0715 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0716 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0717 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0718 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0719 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0720 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0721 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0722 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0723 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0724 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0725  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0726  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0727  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0728 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0729  40       Item Age Days
     C                     Z-ADD*ZERO     WN0730  70       Production Ovr
     C                     Z-ADD*ZERO     WN0731  70       Production Ovr
     C                     MOVEL*BLANK    WN0732  1        OD Spot Buy
     C                     MOVEL*BLANK    WN0733  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0734  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0735  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0736  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0737  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0738  1        EDI Status 1
     C                     MOVEL*BLANK    WN0739  1        EDI Status 2
     C                     MOVEL*BLANK    WN0740  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0741  60       Job Time
     C                     MOVEL*BLANK    WN0742 10        User Id
     C                     MOVEL*BLANK    WN0743 10        Job Name
     C                     Z-ADD*ZERO     WN0744  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWTAIC3    WEAIC3           Company Number
     C                     Z-ADDWTC4NB    WEC4NB           Order Number
     C                     Z-ADDWTDPNB    WEDPNB           Order Sequence
     C                     Z-ADDWTUENB    WEUENB           Order Secondary
      *
     C           KLCHTC    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C           KLCHTC    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YFRDCS
      * Move non-key fields to @BGWKL0
     C                     MOVELWUGMST    WEGMST    P      Detail Line Sta
     C                     MOVELWUGNST    WEGNST    P      Detail Line Sta
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDCHRC    BEGSR
      *================================================================
      * CHG Pall./Slip Post/Or CH - PD Order Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0745  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0746  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0747  70       Ship To Custome
     C                     MOVEL*BLANK    WN0748 30        Ship To Name
     C                     MOVEL*BLANK    WN0749 30        Ship To Address
     C                     MOVEL*BLANK    WN0750 30        Ship To Address
     C                     MOVEL*BLANK    WN0751 30        Ship To Address
     C                     MOVEL*BLANK    WN0752 20        Ship To City
     C                     MOVEL*BLANK    WN0753  2        Ship To State C
     C                     MOVEL*BLANK    WN0754 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0755  70       Bill to Custome
     C                     MOVEL*BLANK    WN0756 30        Bill to Name
     C                     MOVEL*BLANK    WN0757 30        Bill to Address
     C                     MOVEL*BLANK    WN0758 30        Bill to Address
     C                     MOVEL*BLANK    WN0759 30        Bill to Address
     C                     MOVEL*BLANK    WN0760 20        Bill to City
     C                     MOVEL*BLANK    WN0761  2        Bill to State C
     C                     MOVEL*BLANK    WN0762 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0763 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0764  70       Order Date
     C                     Z-ADD*ZERO     WN0765  70       Requested Ship
     C                     Z-ADD*ZERO     WN0766  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0767  70       Cancel Date
     C                     MOVEL*BLANK    WN0768  2        Terms Code
     C                     MOVEL*BLANK    WN0769 40        Special Instruc
     C                     MOVEL*BLANK    WN0770 40        Special Instruc
     C                     MOVEL*BLANK    WN0771  3        Carrier Code
     C                     MOVEL*BLANK    WN0772  1        Comment Print A
     C                     MOVEL*BLANK    WN0773  1        Comment Print I
     C                     MOVEL*BLANK    WN0774  1        Comment Print P
     C                     MOVEL*BLANK    WN0775  1        Comment Print S
     C                     MOVEL*BLANK    WN0776  3        Reason Code
     C                     MOVEL*BLANK    WN0777  1        Order in Use
     C                     MOVEL*BLANK    WN0778  1        Header Status
     C                     MOVEL*BLANK    WN0779  1        Header Status L
     C                     MOVEL*BLANK    WN0780  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0781  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0782 10        User Original E
     C                     Z-ADD*ZERO     WN0783  70       Date of Origina
     C                     Z-ADD*ZERO     WN0784 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0785 112       Order Weight To
     C                     MOVEL*BLANK    WN0786  1        Credit Hold
     C                     MOVEL*BLANK    WN0787  1        Production Hold
     C                     MOVEL*BLANK    WN0788  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0789  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0790  40       Requested Deliv
     C                     MOVEL*BLANK    WN0791  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0792 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0793  70       Load ID
     C                     Z-ADD*ZERO     WN0794  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0795 112       Rated Freight
     C                     MOVEL*BLANK    WN0796  1        LTL Flag
     C                     MOVEL*BLANK    WN0797  1        Price Audit
     C                     MOVEL*BLANK    WN0798  1        Price Status
     C                     MOVEL*BLANK    WN0799  2        Shipping Method
     C                     MOVEL*BLANK    WN0800  1        Export Status
     C                     MOVEL*BLANK    WN0801  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0802  1        Age Code
     C                     Z-ADD*ZERO     WN0803  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0804  1        Load Type
     C                     Z-ADD*ZERO     WN0805  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0806  1        Load Plan Order
     C                     MOVEL*BLANK    WN0807  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0808  70       Resell Referenc
     C                     MOVEL*BLANK    WN0809 30        Special Comment
     C                     MOVEL*BLANK    WN0810 30        Special Comment
     C                     MOVEL*BLANK    WN0811  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0812  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0813  2        Manager Level C
     C                     MOVEL*BLANK    WN0814  3        VP Level Code
     C                     Z-ADD*ZERO     WN0815  70       Attach to Order
     C                     MOVEL*BLANK    WN0816  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0817  70       Invoice Number
     C                     MOVEL*BLANK    WN0818  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0819  70       Invoice Date
     C                     MOVEL*BLANK    WN0820  2        Event Code
     C                     MOVEL*BLANK    WN0821  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0822  1        Modified Flag
     C                     Z-ADD*ZERO     WN0823 112       A/R order Value
     C                     MOVEL*BLANK    WN0824  1        Billing Activit
     C                     MOVEL*BLANK    WN0825  1        Block Order Fla
     C                     MOVEL*BLANK    WN0826  1        Order Certifica
     C                     Z-ADD*ZERO     WN0827 112       Invoice Order V
     C                     MOVEL*BLANK    WN0828  1        Process Sts for
     C                     MOVEL*BLANK    WN0829  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0830  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0831  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0832  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0833  1        Email Cust On O
     C                     MOVEL*BLANK    WN0834  1        Order Emailed
     C                     MOVEL*BLANK    WN0835  1        Export Docs Go
     C                     MOVEL*BLANK    WN0836  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0837  1        Broker Order St
     C                     MOVEL*BLANK    WN0838  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0839  2        Order Requires
     C                     MOVEL*BLANK    WN0840  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0841  2        Export USDA App
     C                     MOVEL*BLANK    WN0842  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0843  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0844  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0845  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0846  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0847  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0848  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0849  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0850  60       Time of Origina
     C                     Z-ADD*ZERO     WN0851  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0852  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0853  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0854 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0855 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0856 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0857 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0858 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0859  70       Claim Number
     C                     MOVEL*BLANK    WN0860  1        EDI Status 1
     C                     MOVEL*BLANK    WN0861  1        EDI Status 2
     C                     MOVEL*BLANK    WN0862  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0863  60       Job Time
     C                     MOVEL*BLANK    WN0864 10        User Id
     C                     MOVEL*BLANK    WN0865 10        Job Name
     C                     Z-ADD*ZERO     WN0866  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWTAIC3    WVAIC3           Company Number
     C                     Z-ADDWTC4NB    WVC4NB           Order Number
      *
     C           KLCHTD    KLIST
     C                     KFLD           WVAIC3           Company Number
     C                     KFLD           WVC4NB           Order Number
     C           KLCHTD    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YGRDCS
      * Move non-key fields to @BECPFJ
     C                     MOVELWN0615    WVVEST    P      Palletize
     C                     MOVELWN0616    WVVGST    P      Slip Sheet
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WVAATM           Job Time
     C                     MOVEL##USR     WVAYNA           User Id
     C                     MOVEL##PGM     WVA0NA           Job Name
     C                     Z-ADD##JDT     WVAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPBRC
     C                     Z-ADDWVAIC3    PBAIC3           Company Number
     C                     Z-ADDWVC4NB    PBC4NB           Order Number
     C                     MOVELWVJNCD    PBJNCD    P      Order Type - Sa
     C                     Z-ADDWVANC7    PBANC7           A/R Customer Nu
     C                     Z-ADDWVBKC7    PBBKC7           Ship To Custome
     C                     MOVELWVBRTX    PBBRTX    P      Ship To Name
     C                     MOVELWVHMNA    PBHMNA    P      Ship To Address
     C                     MOVELWVHONA    PBHONA    P      Ship To Address
     C                     MOVELWVHPNA    PBHPNA    P      Ship To Address
     C                     MOVELWVHNNA    PBHNNA    P      Ship To City
     C                     MOVELWVDBCD    PBDBCD    P      Ship To State C
     C                     MOVELWVCKTX    PBCKTX    P      Ship To Zip/Pos
     C                     Z-ADDWVB0C7    PBB0C7           Bill to Custome
     C                     MOVELWVAETX    PBAETX    P      Bill to Name
     C                     MOVELWVB1NA    PBB1NA    P      Bill to Address
     C                     MOVELWVB3NA    PBB3NA    P      Bill to Address
     C                     MOVELWVB4NA    PBB4NA    P      Bill to Address
     C                     MOVELWVB2NA    PBB2NA    P      Bill to City
     C                     MOVELWVBHCD    PBBHCD    P      Bill to State C
     C                     MOVELWVC8TX    PBC8TX    P      Bill to Zip/Pos
     C                     MOVELWVBCNA    PBBCNA    P      Customer Purcha
     C                     Z-ADDWVA0DT    PBA0DT           Order Date
     C                     Z-ADDWVA5DT    PBA5DT           Requested Ship
     C                     Z-ADDWVGNDT    PBGNDT           Actual Shipped
     C                     Z-ADDWVACDT    PBACDT           Cancel Date
     C                     MOVELWVAQCD    PBAQCD    P      Terms Code
     C                     MOVELWVB6NA    PBB6NA    P      Special Instruc
     C                     MOVELWVBYNA    PBBYNA    P      Special Instruc
     C                     MOVELWVBZNA    PBBZNA    P      Carrier Code
     C                     MOVELWVGTST    PBGTST    P      Comment Print A
     C                     MOVELWVGVST    PBGVST    P      Comment Print I
     C                     MOVELWVGUST    PBGUST    P      Comment Print P
     C                     MOVELWVQFST    PBQFST    P      Comment Print S
     C                     MOVELWVCQCD    PBCQCD    P      Reason Code
     C                     MOVELWVGJST    PBGJST    P      Order in Use
     C                     MOVELWVGWST    PBGWST    P      Header Status
     C                     MOVELWVGXST    PBGXST    P      Header Status L
     C                     MOVELWVGYST    PBGYST    P      Order Type Prin
     C                     Z-ADDWVAODT    PBAODT           Scheduled Ship
     C                     MOVELWVAIVN    PBAIVN    P      User Original E
     C                     Z-ADDWVCXDT    PBCXDT           Date of Origina
     C                     Z-ADDWVJZVA    PBJZVA           Order Value Tot
     C                     Z-ADDWVA1WG    PBA1WG           Order Weight To
     C                     MOVELWVXIST    PBXIST    P      Credit Hold
     C                     MOVELWVXJST    PBXJST    P      Production Hold
     C                     MOVELWVXKST    PBXKST    P      New Customer Ho
     C                     Z-ADDWVEIDT    PBEIDT           Requested Deliv
     C                     Z-ADDWVAFTM    PBAFTM           Requested Deliv
     C                     MOVELWVE8CD    PBE8CD    P      Accounts Receiv
     C                     MOVELWVE9CD    PBE9CD    P      Accounts Receiv
     C                     Z-ADDWVRMNB    PBRMNB           Load ID
     C                     Z-ADDWVTBNB    PBTBNB           Absorbed Freigh
     C                     Z-ADDWVR1NB    PBR1NB           Rated Freight
     C                     MOVELWVPJST    PBPJST    P      LTL Flag
     C                     MOVELWVU0ST    PBU0ST    P      Price Audit
     C                     MOVELWVU1ST    PBU1ST    P      Price Status
     C                     MOVELWVQ2CD    PBQ2CD    P      Shipping Method
     C                     MOVELWVU2ST    PBU2ST    P      Export Status
     C                     MOVELWVVEST    PBVEST    P      Palletize
     C                     MOVELWVVFST    PBVFST    P      Shrink Wrap
     C                     MOVELWVVGST    PBVGST    P      Slip Sheet
     C                     MOVELWVRPCD    PBRPCD    P      Age Code
     C                     Z-ADDWVRNNB    PBRNNB           Reefer Temperat
     C                     MOVELWVVDST    PBVDST    P      Load Type
     C                     Z-ADDWVATIN    PBATIN           Attach to Invoi
     C                     MOVELWVU4ST    PBU4ST    P      Load Plan Order
     C                     MOVELWVU5ST    PBU5ST    P      Print Pick Slip
     C                     Z-ADDWVRSRN    PBRSRN           Resell Referenc
     C                     MOVELWVMHNA    PBMHNA    P      Special Comment
     C                     MOVELWVMINA    PBMINA    P      Special Comment
     C                     MOVELWVWBST    PBWBST    P      Affect Auto Acc
     C                     MOVELWVR4CD    PBR4CD    P      Sales Route Cod
     C                     MOVELWVBFCD    PBBFCD    P      Manager Level C
     C                     MOVELWVQ4CD    PBQ4CD    P      VP Level Code
     C                     Z-ADDWVT3NB    PBT3NB           Attach to Order
     C                     MOVELWVSICD    PBSICD    P      Reason for Pric
     C                     Z-ADDWVCONB    PBCONB           Invoice Number
     C                     MOVELWVCEST    PBCEST    P      Invoice Suffix
     C                     Z-ADDWVAWDT    PBAWDT           Invoice Date
     C                     MOVELWVJPCD    PBJPCD    P      Event Code
     C                     MOVELWVXUST    PBXUST    P      Trans Contol AS
     C                     MOVELWVZ1ST    PBZ1ST    P      Modified Flag
     C                     Z-ADDWVVRVA    PBVRVA           A/R order Value
     C                     MOVELWVOBST    PBOBST    P      Billing Activit
     C                     MOVELWVBCST    PBBCST    P      Block Order Fla
     C                     MOVELWVBDST    PBBDST    P      Order Certifica
     C                     Z-ADDWVB7VL    PBB7VL           Invoice Order V
     C                     MOVELWVGASX    PBGASX    P      Process Sts for
     C                     MOVELWVGBSX    PBGBSX    P      Order Conf Fax
     C                     MOVELWVGCSX    PBGCSX    P      Manifest Fax St
     C                     MOVELWVGDSX    PBGDSX    P      Invoice Fax Sts
     C                     MOVELWVFNSX    PBFNSX    P      Transfer in Sto
     C                     MOVELWVFOSX    PBFOSX    P      Email Cust On O
     C                     MOVELWVFPSX    PBFPSX    P      Order Emailed
     C                     MOVELWVFQSX    PBFQSX    P      Export Docs Go
     C                     MOVELWVFRSX    PBFRSX    P      Shipping Temp C
     C                     MOVELWVFSSX    PBFSSX    P      Broker Order St
     C                     MOVELWVFTSX    PBFTSX    P      Air Freight Ord
     C                     MOVELWVFUSX    PBFUSX    P      Order Requires
     C                     MOVELWVFVSX    PBFVSX    P      OH Load Plan Re
     C                     MOVELWVFWSX    PBFWSX    P      Export USDA App
     C                     MOVELWVFXSX    PBFXSX    P      HPB Ship to War
     C                     MOVELWVFYSX    PBFYSX    P      OH TF Exempt Co
     C                     Z-ADDWVNODT    PBNODT           OH Appt Confirm
     C                     Z-ADDWVNPDT    PBNPDT           JPN Invoice Iss
     C                     Z-ADDWVNQDT    PBNQDT           Load Actual Shi
     C                     Z-ADDWVNRDT    PBNRDT           Load BOL Comple
     C                     Z-ADDWVNSDT    PBNSDT           Load Truck Depa
     C                     Z-ADDWVBPTM    PBBPTM           Maximum Gross W
     C                     Z-ADDWVBQTM    PBBQTM           Time of Origina
     C                     Z-ADDWVBRTM    PBBRTM           OH Appt Confirm
     C                     Z-ADDWVBSTM    PBBSTM           Load BOL Comple
     C                     Z-ADDWVBTTM    PBBTTM           Load Truck Depa
     C                     Z-ADDWVH0NX    PBH0NX           Act Frt Referen
     C                     Z-ADDWVH1NX    PBH1NX           Act Non-Ref Frt
     C                     Z-ADDWVH2NX    PBH2NX           OH Fuel Surchar
     C                     Z-ADDWVH3NX    PBH3NX           OH Total Non-Re
     C                     Z-ADDWVH4NX    PBH4NX           OH Total Ref Fr
     C                     Z-ADDWVC0C7    PBC0C7           Claim Number
     C                     MOVELWVUVST    PBUVST    P      EDI Status 1
     C                     MOVELWVUWST    PBUWST    P      EDI Status 2
     C                     MOVELWVUXST    PBUXST    P      EDI Status 3
     C                     Z-ADDWVAATM    PBAATM           Job Time
     C                     MOVELWVAYNA    PBAYNA    P      User Id
     C                     MOVELWVA0NA    PBA0NA    P      Job Name
     C                     Z-ADDWVAXDT    PBAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TECHRC    BEGSR
      *================================================================
      * CHG Palletize         CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0867  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0868  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0869  70       Ship To Custome
     C                     MOVEL*BLANK    WN0870 30        Ship To Name
     C                     MOVEL*BLANK    WN0871 30        Ship To Address
     C                     MOVEL*BLANK    WN0872 30        Ship To Address
     C                     MOVEL*BLANK    WN0873 30        Ship To Address
     C                     MOVEL*BLANK    WN0874 20        Ship To City
     C                     MOVEL*BLANK    WN0875  2        Ship To State C
     C                     MOVEL*BLANK    WN0876 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0877  70       Bill to Custome
     C                     MOVEL*BLANK    WN0878 30        Bill to Name
     C                     MOVEL*BLANK    WN0879 30        Bill to Address
     C                     MOVEL*BLANK    WN0880 30        Bill to Address
     C                     MOVEL*BLANK    WN0881 30        Bill to Address
     C                     MOVEL*BLANK    WN0882 20        Bill to City
     C                     MOVEL*BLANK    WN0883  2        Bill to State C
     C                     MOVEL*BLANK    WN0884 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0885 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0886  70       Order Date
     C                     Z-ADD*ZERO     WN0887  70       Requested Ship
     C                     Z-ADD*ZERO     WN0888  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0889  70       Cancel Date
     C                     MOVEL*BLANK    WN0890  2        Terms Code
     C                     MOVEL*BLANK    WN0891 40        Special Instruc
     C                     MOVEL*BLANK    WN0892 40        Special Instruc
     C                     MOVEL*BLANK    WN0893  3        Carrier Code
     C                     MOVEL*BLANK    WN0894  1        Comment Print A
     C                     MOVEL*BLANK    WN0895  1        Comment Print I
     C                     MOVEL*BLANK    WN0896  1        Comment Print P
     C                     MOVEL*BLANK    WN0897  1        Comment Print S
     C                     MOVEL*BLANK    WN0898  3        Reason Code
     C                     MOVEL*BLANK    WN0899  1        Order in Use
     C                     MOVEL*BLANK    WN0900  1        Header Status
     C                     MOVEL*BLANK    WN0901  1        Header Status L
     C                     MOVEL*BLANK    WN0902  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0903  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0904 10        User Original E
     C                     Z-ADD*ZERO     WN0905  70       Date of Origina
     C                     Z-ADD*ZERO     WN0906 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0907 112       Order Weight To
     C                     MOVEL*BLANK    WN0908  1        Credit Hold
     C                     MOVEL*BLANK    WN0909  1        Production Hold
     C                     MOVEL*BLANK    WN0910  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0911  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0912  40       Requested Deliv
     C                     MOVEL*BLANK    WN0913  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0914 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0915  70       Load ID
     C                     Z-ADD*ZERO     WN0916  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0917 112       Rated Freight
     C                     MOVEL*BLANK    WN0918  1        LTL Flag
     C                     MOVEL*BLANK    WN0919  1        Price Audit
     C                     MOVEL*BLANK    WN0920  1        Price Status
     C                     MOVEL*BLANK    WN0921  2        Shipping Method
     C                     MOVEL*BLANK    WN0922  1        Export Status
     C                     MOVEL*BLANK    WN0923  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0924  1        Slip Sheet
     C                     MOVEL*BLANK    WN0925  1        Age Code
     C                     Z-ADD*ZERO     WN0926  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0927  1        Load Type
     C                     Z-ADD*ZERO     WN0928  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0929  1        Load Plan Order
     C                     MOVEL*BLANK    WN0930  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0931  70       Resell Referenc
     C                     MOVEL*BLANK    WN0932 30        Special Comment
     C                     MOVEL*BLANK    WN0933 30        Special Comment
     C                     MOVEL*BLANK    WN0934  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0935  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0936  2        Manager Level C
     C                     MOVEL*BLANK    WN0937  3        VP Level Code
     C                     Z-ADD*ZERO     WN0938  70       Attach to Order
     C                     MOVEL*BLANK    WN0939  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0940  70       Invoice Number
     C                     MOVEL*BLANK    WN0941  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0942  70       Invoice Date
     C                     MOVEL*BLANK    WN0943  2        Event Code
     C                     MOVEL*BLANK    WN0944  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0945  1        Modified Flag
     C                     Z-ADD*ZERO     WN0946 112       A/R order Value
     C                     MOVEL*BLANK    WN0947  1        Billing Activit
     C                     MOVEL*BLANK    WN0948  1        Block Order Fla
     C                     MOVEL*BLANK    WN0949  1        Order Certifica
     C                     Z-ADD*ZERO     WN0950 112       Invoice Order V
     C                     MOVEL*BLANK    WN0951  1        Process Sts for
     C                     MOVEL*BLANK    WN0952  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0953  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0954  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0955  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0956  1        Email Cust On O
     C                     MOVEL*BLANK    WN0957  1        Order Emailed
     C                     MOVEL*BLANK    WN0958  1        Export Docs Go
     C                     MOVEL*BLANK    WN0959  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0960  1        Broker Order St
     C                     MOVEL*BLANK    WN0961  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0962  2        Order Requires
     C                     MOVEL*BLANK    WN0963  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0964  2        Export USDA App
     C                     MOVEL*BLANK    WN0965  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0966  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0967  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0968  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0969  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0970  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0971  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0972  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0973  60       Time of Origina
     C                     Z-ADD*ZERO     WN0974  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0975  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0976  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0977 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0978 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0979 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0980 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0981 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0982  70       Claim Number
     C                     MOVEL*BLANK    WN0983  1        EDI Status 1
     C                     MOVEL*BLANK    WN0984  1        EDI Status 2
     C                     MOVEL*BLANK    WN0985  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0986  60       Job Time
     C                     MOVEL*BLANK    WN0987 10        User Id
     C                     MOVEL*BLANK    WN0988 10        Job Name
     C                     Z-ADD*ZERO     WN0989  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWTAIC3    WVAIC3           Company Number
     C                     Z-ADDWTC4NB    WVC4NB           Order Number
      *
     C           KLCHTE    KLIST
     C                     KFLD           WVAIC3           Company Number
     C                     KFLD           WVC4NB           Order Number
     C           KLCHTE    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YHRDCS
      * Move non-key fields to @BECPFJ
     C                     MOVEL'N'       WVVEST    P      Palletize
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WVAATM           Job Time
     C                     MOVEL##USR     WVAYNA           User Id
     C                     MOVEL##PGM     WVA0NA           Job Name
     C                     Z-ADD##JDT     WVAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * UPD Chg Order-Post     RT - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0990  1        Header Status
     C                     MOVEL*BLANK    WN0991  1        Header Status L
     C                     MOVEL*BLANK    WN0992  1        Credit Hold
     C                     MOVEL*BLANK    WN0993  1        Production Hold
     C                     MOVEL*BLANK    WN0994  2        Order Requires
     C                     MOVEL*BLANK    WN0995  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0996  1        Live with TPM
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** Changes and Comments
     C                     EXSR UJSUBR                     ***** Changes a
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WBAIC3           Company Number
     C                     Z-ADDP1C4NB    WBC4NB           Order Number
      * Establish starting position
     C           KRSTF     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * C2576:  don't change status if confirmed/complete; no holds, eith
      * Change status if needed
      * CASE: DB1.Header Status is Confirmed & Complete
     C           WBGWST    IFEQ 'C'                        *IF
     C           WBGWST    OREQ 'R'
     C                     MOVELWBGXST    WN0991           Header Status L
     C                     MOVELWBGWST    WN0990           Header Status
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Header Status is Available
      *   |- c2    : DB1.Header Status is Cancelled
      *   '-
     C           WBGWST    IFEQ 'A'                        *IF
     C           WBGWST    OREQ 'X'                        *OR
      * 03/14/19 DN S14648-Added Condition to Check Header Sts='X'.
     C                     MOVELWBGXST    WN0991           Header Status L
     C                     MOVELWBGWST    WN0990           Header Status
     C                     ELSE
      * CASE: *OTHERWISE
      * don't reactivate if order was cancelled               e004119
      * CASE: DB1.Header Status is Not cancelled
     C           WBGWST    IFEQ 'L'                        *IF
     C           WBGWST    OREQ 'A'
     C           WBGWST    OREQ 'C'
     C           WBGWST    OREQ 'R'
     C           WBGWST    OREQ 'E'
     C           WBGWST    OREQ 'H'
     C           WBGWST    OREQ 'I'
     C                     MOVELWBGWST    WN0991           Header Status L
     C                     MOVEL'A'       WN0990           Header Status
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * On Credit Hold
      * CASE: PAR.Header Status is Confirmed & Complete
     C           WN0990    IFEQ 'C'                        *IF
     C           WN0990    OREQ 'R'
     C                     MOVEL'N'       WN0992           Credit Hold
     C                     ELSE
      * CASE: PAR.USR Credit Hold is Yes
     C           P4XOST    IFEQ 'Y'                        *IF
     C                     MOVEL'H'       WN0990           Header Status
     C                     MOVEL'Y'       WN0992           Credit Hold
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WN0992           Credit Hold
     C                     END                             *FI
     C                     END                             *FI
      * Production Hold
      * CASE: PAR.Header Status is Confirmed & Complete
     C           WN0990    IFEQ 'C'                        *IF
     C           WN0990    OREQ 'R'
     C                     MOVEL'N'       WN0993           Production Hold
     C                     ELSE
      * CASE: PAR.USR Production is Yes
     C           P4XPST    IFEQ 'Y'                        *IF
      * E2824 10/14/13 RMC Dont hold Order for Prod Hold -- only for Cred
     C                     MOVEL'Y'       WN0993           Production Hold
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WN0993           Production Hold
     C                     END                             *FI
     C                     END                             *FI
      * ** Check Ord Dtl record for Export Ord Autom Upload Errors  P0012
      * **  This function does not recheck or reset errors
      * RTV OD Error from Upl XF - Order Detail  * 
     C                     CALL 'PBACXFR'              90  RTV OD Error fr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBAIC3    WQ0033  30       Company Number
     C                     PARM WBC4NB    WQ0034  70       Order Number
     C           YL0138    PARM *ZERO     WQ0035  40       Item Age Days
     C           YL0139    PARM *BLANK    WQ0036  3        Order Line Erro
     C           YL0140    PARM *BLANK    WQ0037  1        Status Flag 20
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBACXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ** If upload errors in Ord Dtl, set Ord Requires Rvw to Yes  P001
      * CASE: LCL.Order Line Error Type is Upload Error Pending
     C           YL0139    IFEQ 'DD'                       *IF
     C           YL0139    OREQ 'HD'
     C           YL0139    OREQ 'IT'
     C           YL0139    OREQ 'AC'
     C           YL0139    OREQ 'WT'
     C           YL0139    OREQ 'PA'
     C           YL0139    OREQ 'SL'
     C           YL0139    OREQ 'DT'
     C           YL0139    OREQ 'ME'
     C                     MOVEL*BLANK    WN0994           Order Requires
     C                     MOVEL'Y'       WN0994           Order Requires
     C                     END                             *FI
      * CHG Ord Sts/Crd-PrdHld CH - Order Header TRG  * 
     C                     EXSR TGCHRC
     C                     MOVELWBFVSX    WN0995           OH Load Plan Re
      * * Default in DDD/T if Load ID is blanks
      * CASE: DB1.Load ID is Blank
     C           WBRMNB    IFEQ 0                          *IF
      * ** Defaults DDD/T to SSD & 8:00 am if export w/no state code
      * CLC Deadln Depart Dt  XF - Order Header TRG  * 
     C                     CALL 'POSCXFR'              90  CLC Deadln Depa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBAIC3    WQ0038  30       Company Number
     C                     PARM WBC4NB    WQ0039  70       Order Number
     C                     PARM WBHNNA    WQ0040 20        City
     C                     PARM WBDBCD    WQ0041  2        State Code
     C                     PARM WBEIDT    WQ0042  70       Requested Deliv
     C                     PARM WBAFTM    WQ0043  40       Requested Deliv
     C           YL0141    PARM *ZERO     WQ0044  70       Deadline Depart
     C           YL0142    PARM *ZERO     WQ0045  60       Deadline Depart
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POSCXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ** 11/16/2007 LJB FP1251
      * ** If no Miles To Next Stop, DDD/T will be zeros
      * Upd Deadline Dte/Tme  RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0013           Company Number
     C                     Z-ADDWBC4NB    WL0014           Order Number
     C                     Z-ADDYL0141    WL0015           Deadline Depart
     C                     Z-ADDYL0142    WL0016           Deadline Depart
     C                     EXSR SWRVGN
     C                     END                             *FI
     C                     ENDIF
      * USER: Exit processing
      * P00196 8/22/12 RMC Chk Pfs Interface cond "LDORDD" for Y for this
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0019           PFS Company Num
     C                     MOVEL'LDORDD'  WL0020    P      PFS Interface C
     C                     EXSR THRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0021    YL0143    P      PFS AccuSort Ac
     C                     MOVELWL0022    YL0144    P      PFS Carlisle Ac
      * CASE: DB1.Load ID is GT Zero
     C           WBRMNB    IFGT 0                          *IF
      * RTV Load Status        RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBRMNB    WL0001           Load ID
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0145    P      Load Status
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0145           Load Status
     C                     END                             *FI
      * Carlisle
      * CASE: LCL.PFS Carlisle Active is Yes
     C           YL0144    IFEQ 'Y'                        *IF
      * CASE: DB1.Load ID is GT Zero
     C           WBRMNB    IFGT 0                          *IF
      * CASE: LCL.Load Status is Lock
     C           YL0145    IFEQ 'L'                        *IF
      * PFS Lock Load/Order   XF - PFS Load Header  * 
     C                     CALL 'PPNLXFR'              90  PFS Lock Load/O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBRMNB    WQ0046  70       Load ID
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPNLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * P00196 RMC 10/3/12 CAT2 Dailys-Interface Cond "ORDONL" - send ord
      * PFS Order Header XF
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.Load ID is Blank
      *   |- c2    : LCL.Load Status is Prior to Lock
      *   '-
     C           WBRMNB    IFEQ 0                          *IF
     C           YL0145    OREQ 'C'                        *OR
     C           YL0145    OREQ 'E'
     C           YL0145    OREQ 'U'
      * Rtv Active Status     RT - PFS Interface  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0019           PFS Company Num
     C                     MOVEL'ORDONL'  WL0020    P      PFS Interface C
     C                     EXSR THRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0021    YL0143    P      PFS AccuSort Ac
     C                     MOVELWL0022    YL0144    P      PFS Carlisle Ac
      * CASE: LCL.PFS Carlisle Active is Yes
     C           YL0144    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    YL0145           Load Status
     C                     Z-ADD*ZERO     YL0146           Load ID
      * PFS Order Header      XF - Order Header TRG  * 
     C                     CALL 'PBEYXFR'              90  PFS Order Heade
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBAIC3    WQ0047  30       Company Number
     C                     PARM WBC4NB    WQ0048  70       Order Number
     C                     PARM WBBZNA    WQ0049  3        Carrier Code
     C                     PARM YL0146    WQ0050  70       Load ID
     C                     PARM YL0145    WQ0051  1        Load Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBEYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Pricing Event Called From is TMS Update for Select
     C           P7PECF    IFEQ 'OE'                       *IF
     C           P7PECF    OREQ 'SWP'
     C           P7PECF    OREQ 'CEO'
     C           P7PECF    OREQ 'UWT'
      * CASE: PAR.OH Load Plan Ready is Yes
     C           WN0995    IFEQ 'Y'                        *IF
      * Rtv Crt OH Trigger    XF - TMS Order Header Trigger  * 
     C                     CALL 'PBWVXFR'              90  Rtv Crt OH Trig
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1C4NB    WQ0052  70       Order Number
     C                     PARM P1AIC3    WQ0053  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBWVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGCHRC    BEGSR
      *================================================================
      * CHG Ord Sts/Crd-PrdHld CH - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0997  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0998  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0999  70       Ship To Custome
     C                     MOVEL*BLANK    WN1000 30        Ship To Name
     C                     MOVEL*BLANK    WN1001 30        Ship To Address
     C                     MOVEL*BLANK    WN1002 30        Ship To Address
     C                     MOVEL*BLANK    WN1003 30        Ship To Address
     C                     MOVEL*BLANK    WN1004 20        Ship To City
     C                     MOVEL*BLANK    WN1005  2        Ship To State C
     C                     MOVEL*BLANK    WN1006 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN1007  70       Bill to Custome
     C                     MOVEL*BLANK    WN1008 30        Bill to Name
     C                     MOVEL*BLANK    WN1009 30        Bill to Address
     C                     MOVEL*BLANK    WN1010 30        Bill to Address
     C                     MOVEL*BLANK    WN1011 30        Bill to Address
     C                     MOVEL*BLANK    WN1012 20        Bill to City
     C                     MOVEL*BLANK    WN1013  2        Bill to State C
     C                     MOVEL*BLANK    WN1014 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN1015 15        Customer Purcha
     C                     Z-ADD*ZERO     WN1016  70       Order Date
     C                     Z-ADD*ZERO     WN1017  70       Requested Ship
     C                     Z-ADD*ZERO     WN1018  70       Actual Shipped
     C                     Z-ADD*ZERO     WN1019  70       Cancel Date
     C                     MOVEL*BLANK    WN1020  2        Terms Code
     C                     MOVEL*BLANK    WN1021 40        Special Instruc
     C                     MOVEL*BLANK    WN1022 40        Special Instruc
     C                     MOVEL*BLANK    WN1023  3        Carrier Code
     C                     MOVEL*BLANK    WN1024  1        Comment Print A
     C                     MOVEL*BLANK    WN1025  1        Comment Print I
     C                     MOVEL*BLANK    WN1026  1        Comment Print P
     C                     MOVEL*BLANK    WN1027  1        Comment Print S
     C                     MOVEL*BLANK    WN1028  3        Reason Code
     C                     MOVEL*BLANK    WN1029  1        Order Type Prin
     C                     Z-ADD*ZERO     WN1030  70       Scheduled Ship
     C                     MOVEL*BLANK    WN1031 10        User Original E
     C                     Z-ADD*ZERO     WN1032  70       Date of Origina
     C                     MOVEL*BLANK    WN1033  1        New Customer Ho
     C                     Z-ADD*ZERO     WN1034  70       Requested Deliv
     C                     Z-ADD*ZERO     WN1035  40       Requested Deliv
     C                     MOVEL*BLANK    WN1036  4        Accounts Receiv
     C                     MOVEL*BLANK    WN1037 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN1038  70       Load ID
     C                     Z-ADD*ZERO     WN1039  52       Absorbed Freigh
     C                     Z-ADD*ZERO     WN1040 112       Rated Freight
     C                     MOVEL*BLANK    WN1041  1        LTL Flag
     C                     MOVEL*BLANK    WN1042  1        Price Audit
     C                     MOVEL*BLANK    WN1043  1        Price Status
     C                     MOVEL*BLANK    WN1044  2        Shipping Method
     C                     MOVEL*BLANK    WN1045  1        Export Status
     C                     MOVEL*BLANK    WN1046  1        Palletize
     C                     MOVEL*BLANK    WN1047  1        Shrink Wrap
     C                     MOVEL*BLANK    WN1048  1        Slip Sheet
     C                     MOVEL*BLANK    WN1049  1        Age Code
     C                     Z-ADD*ZERO     WN1050  52       Reefer Temperat
     C                     MOVEL*BLANK    WN1051  1        Load Type
     C                     Z-ADD*ZERO     WN1052  70       Attach to Invoi
     C                     MOVEL*BLANK    WN1053  1        Load Plan Order
     C                     MOVEL*BLANK    WN1054  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN1055  70       Resell Referenc
     C                     MOVEL*BLANK    WN1056 30        Special Comment
     C                     MOVEL*BLANK    WN1057 30        Special Comment
     C                     MOVEL*BLANK    WN1058  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN1059  3        Sales Route Cod
     C                     MOVEL*BLANK    WN1060  2        Manager Level C
     C                     MOVEL*BLANK    WN1061  3        VP Level Code
     C                     Z-ADD*ZERO     WN1062  70       Attach to Order
     C                     MOVEL*BLANK    WN1063  3        Reason for Pric
     C                     Z-ADD*ZERO     WN1064  70       Invoice Number
     C                     MOVEL*BLANK    WN1065  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN1066  70       Invoice Date
     C                     MOVEL*BLANK    WN1067  2        Event Code
     C                     MOVEL*BLANK    WN1068  1        Trans Contol AS
     C                     Z-ADD*ZERO     WN1069 112       A/R order Value
     C                     MOVEL*BLANK    WN1070  1        Billing Activit
     C                     MOVEL*BLANK    WN1071  1        Block Order Fla
     C                     MOVEL*BLANK    WN1072  1        Order Certifica
     C                     Z-ADD*ZERO     WN1073 112       Invoice Order V
     C                     MOVEL*BLANK    WN1074  1        Process Sts for
     C                     MOVEL*BLANK    WN1075  1        Order Conf Fax
     C                     MOVEL*BLANK    WN1076  1        Manifest Fax St
     C                     MOVEL*BLANK    WN1077  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN1078  1        Transfer in Sto
     C                     MOVEL*BLANK    WN1079  1        Email Cust On O
     C                     MOVEL*BLANK    WN1080  1        Order Emailed
     C                     MOVEL*BLANK    WN1081  1        Export Docs Go
     C                     MOVEL*BLANK    WN1082  1        Shipping Temp C
     C                     MOVEL*BLANK    WN1083  1        Broker Order St
     C                     MOVEL*BLANK    WN1084  1        Air Freight Ord
     C                     MOVEL*BLANK    WN1085  2        Export USDA App
     C                     MOVEL*BLANK    WN1086  3        HPB Ship to War
     C                     MOVEL*BLANK    WN1087  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN1088  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN1089  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN1090  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN1091  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN1092  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN1093  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN1094  60       Time of Origina
     C                     Z-ADD*ZERO     WN1095  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN1096  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN1097  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN1098 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN1099 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN1100 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN1101 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN1102 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN1103  70       Claim Number
     C                     MOVEL*BLANK    WN1104  1        EDI Status 1
     C                     MOVEL*BLANK    WN1105  1        EDI Status 2
     C                     MOVEL*BLANK    WN1106  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1107  60       Job Time
     C                     MOVEL*BLANK    WN1108 10        User Id
     C                     MOVEL*BLANK    WN1109 10        Job Name
     C                     Z-ADD*ZERO     WN1110  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YIRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWBAIC3    WVAIC3           Company Number
     C                     Z-ADDWBC4NB    WVC4NB           Order Number
      *
     C           KLCHTG    KLIST
     C                     KFLD           WVAIC3           Company Number
     C                     KFLD           WVC4NB           Order Number
     C           KLCHTG    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YIRDCS
      * Move non-key fields to @BECPFJ
     C                     MOVEL'N'       WVGJST    P      Order in Use
     C                     MOVELWN0990    WVGWST    P      Header Status
     C                     MOVELWN0991    WVGXST    P      Header Status L
     C                     Z-ADDP4JSVA    WVJZVA           Order Value Tot
     C                     Z-ADDP4AYWG    WVA1WG           Order Weight To
     C                     MOVELWN0992    WVXIST    P      Credit Hold
     C                     MOVELWN0993    WVXJST    P      Production Hold
     C                     MOVELP1Z1ST    WVZ1ST    P      Modified Flag
     C                     MOVELWN0994    WVFUSX    P      Order Requires
     C                     MOVELWBFVSX    WVFVSX    P      OH Load Plan Re
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WVAATM           Job Time
     C                     MOVEL##USR     WVAYNA           User Id
     C                     MOVEL##PGM     WVA0NA           Job Name
     C                     Z-ADD##JDT     WVAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPBRC
     C                     Z-ADDWVAIC3    PBAIC3           Company Number
     C                     Z-ADDWVC4NB    PBC4NB           Order Number
     C                     MOVELWVJNCD    PBJNCD    P      Order Type - Sa
     C                     Z-ADDWVANC7    PBANC7           A/R Customer Nu
     C                     Z-ADDWVBKC7    PBBKC7           Ship To Custome
     C                     MOVELWVBRTX    PBBRTX    P      Ship To Name
     C                     MOVELWVHMNA    PBHMNA    P      Ship To Address
     C                     MOVELWVHONA    PBHONA    P      Ship To Address
     C                     MOVELWVHPNA    PBHPNA    P      Ship To Address
     C                     MOVELWVHNNA    PBHNNA    P      Ship To City
     C                     MOVELWVDBCD    PBDBCD    P      Ship To State C
     C                     MOVELWVCKTX    PBCKTX    P      Ship To Zip/Pos
     C                     Z-ADDWVB0C7    PBB0C7           Bill to Custome
     C                     MOVELWVAETX    PBAETX    P      Bill to Name
     C                     MOVELWVB1NA    PBB1NA    P      Bill to Address
     C                     MOVELWVB3NA    PBB3NA    P      Bill to Address
     C                     MOVELWVB4NA    PBB4NA    P      Bill to Address
     C                     MOVELWVB2NA    PBB2NA    P      Bill to City
     C                     MOVELWVBHCD    PBBHCD    P      Bill to State C
     C                     MOVELWVC8TX    PBC8TX    P      Bill to Zip/Pos
     C                     MOVELWVBCNA    PBBCNA    P      Customer Purcha
     C                     Z-ADDWVA0DT    PBA0DT           Order Date
     C                     Z-ADDWVA5DT    PBA5DT           Requested Ship
     C                     Z-ADDWVGNDT    PBGNDT           Actual Shipped
     C                     Z-ADDWVACDT    PBACDT           Cancel Date
     C                     MOVELWVAQCD    PBAQCD    P      Terms Code
     C                     MOVELWVB6NA    PBB6NA    P      Special Instruc
     C                     MOVELWVBYNA    PBBYNA    P      Special Instruc
     C                     MOVELWVBZNA    PBBZNA    P      Carrier Code
     C                     MOVELWVGTST    PBGTST    P      Comment Print A
     C                     MOVELWVGVST    PBGVST    P      Comment Print I
     C                     MOVELWVGUST    PBGUST    P      Comment Print P
     C                     MOVELWVQFST    PBQFST    P      Comment Print S
     C                     MOVELWVCQCD    PBCQCD    P      Reason Code
     C                     MOVELWVGJST    PBGJST    P      Order in Use
     C                     MOVELWVGWST    PBGWST    P      Header Status
     C                     MOVELWVGXST    PBGXST    P      Header Status L
     C                     MOVELWVGYST    PBGYST    P      Order Type Prin
     C                     Z-ADDWVAODT    PBAODT           Scheduled Ship
     C                     MOVELWVAIVN    PBAIVN    P      User Original E
     C                     Z-ADDWVCXDT    PBCXDT           Date of Origina
     C                     Z-ADDWVJZVA    PBJZVA           Order Value Tot
     C                     Z-ADDWVA1WG    PBA1WG           Order Weight To
     C                     MOVELWVXIST    PBXIST    P      Credit Hold
     C                     MOVELWVXJST    PBXJST    P      Production Hold
     C                     MOVELWVXKST    PBXKST    P      New Customer Ho
     C                     Z-ADDWVEIDT    PBEIDT           Requested Deliv
     C                     Z-ADDWVAFTM    PBAFTM           Requested Deliv
     C                     MOVELWVE8CD    PBE8CD    P      Accounts Receiv
     C                     MOVELWVE9CD    PBE9CD    P      Accounts Receiv
     C                     Z-ADDWVRMNB    PBRMNB           Load ID
     C                     Z-ADDWVTBNB    PBTBNB           Absorbed Freigh
     C                     Z-ADDWVR1NB    PBR1NB           Rated Freight
     C                     MOVELWVPJST    PBPJST    P      LTL Flag
     C                     MOVELWVU0ST    PBU0ST    P      Price Audit
     C                     MOVELWVU1ST    PBU1ST    P      Price Status
     C                     MOVELWVQ2CD    PBQ2CD    P      Shipping Method
     C                     MOVELWVU2ST    PBU2ST    P      Export Status
     C                     MOVELWVVEST    PBVEST    P      Palletize
     C                     MOVELWVVFST    PBVFST    P      Shrink Wrap
     C                     MOVELWVVGST    PBVGST    P      Slip Sheet
     C                     MOVELWVRPCD    PBRPCD    P      Age Code
     C                     Z-ADDWVRNNB    PBRNNB           Reefer Temperat
     C                     MOVELWVVDST    PBVDST    P      Load Type
     C                     Z-ADDWVATIN    PBATIN           Attach to Invoi
     C                     MOVELWVU4ST    PBU4ST    P      Load Plan Order
     C                     MOVELWVU5ST    PBU5ST    P      Print Pick Slip
     C                     Z-ADDWVRSRN    PBRSRN           Resell Referenc
     C                     MOVELWVMHNA    PBMHNA    P      Special Comment
     C                     MOVELWVMINA    PBMINA    P      Special Comment
     C                     MOVELWVWBST    PBWBST    P      Affect Auto Acc
     C                     MOVELWVR4CD    PBR4CD    P      Sales Route Cod
     C                     MOVELWVBFCD    PBBFCD    P      Manager Level C
     C                     MOVELWVQ4CD    PBQ4CD    P      VP Level Code
     C                     Z-ADDWVT3NB    PBT3NB           Attach to Order
     C                     MOVELWVSICD    PBSICD    P      Reason for Pric
     C                     Z-ADDWVCONB    PBCONB           Invoice Number
     C                     MOVELWVCEST    PBCEST    P      Invoice Suffix
     C                     Z-ADDWVAWDT    PBAWDT           Invoice Date
     C                     MOVELWVJPCD    PBJPCD    P      Event Code
     C                     MOVELWVXUST    PBXUST    P      Trans Contol AS
     C                     MOVELWVZ1ST    PBZ1ST    P      Modified Flag
     C                     Z-ADDWVVRVA    PBVRVA           A/R order Value
     C                     MOVELWVOBST    PBOBST    P      Billing Activit
     C                     MOVELWVBCST    PBBCST    P      Block Order Fla
     C                     MOVELWVBDST    PBBDST    P      Order Certifica
     C                     Z-ADDWVB7VL    PBB7VL           Invoice Order V
     C                     MOVELWVGASX    PBGASX    P      Process Sts for
     C                     MOVELWVGBSX    PBGBSX    P      Order Conf Fax
     C                     MOVELWVGCSX    PBGCSX    P      Manifest Fax St
     C                     MOVELWVGDSX    PBGDSX    P      Invoice Fax Sts
     C                     MOVELWVFNSX    PBFNSX    P      Transfer in Sto
     C                     MOVELWVFOSX    PBFOSX    P      Email Cust On O
     C                     MOVELWVFPSX    PBFPSX    P      Order Emailed
     C                     MOVELWVFQSX    PBFQSX    P      Export Docs Go
     C                     MOVELWVFRSX    PBFRSX    P      Shipping Temp C
     C                     MOVELWVFSSX    PBFSSX    P      Broker Order St
     C                     MOVELWVFTSX    PBFTSX    P      Air Freight Ord
     C                     MOVELWVFUSX    PBFUSX    P      Order Requires
     C                     MOVELWVFVSX    PBFVSX    P      OH Load Plan Re
     C                     MOVELWVFWSX    PBFWSX    P      Export USDA App
     C                     MOVELWVFXSX    PBFXSX    P      HPB Ship to War
     C                     MOVELWVFYSX    PBFYSX    P      OH TF Exempt Co
     C                     Z-ADDWVNODT    PBNODT           OH Appt Confirm
     C                     Z-ADDWVNPDT    PBNPDT           JPN Invoice Iss
     C                     Z-ADDWVNQDT    PBNQDT           Load Actual Shi
     C                     Z-ADDWVNRDT    PBNRDT           Load BOL Comple
     C                     Z-ADDWVNSDT    PBNSDT           Load Truck Depa
     C                     Z-ADDWVBPTM    PBBPTM           Maximum Gross W
     C                     Z-ADDWVBQTM    PBBQTM           Time of Origina
     C                     Z-ADDWVBRTM    PBBRTM           OH Appt Confirm
     C                     Z-ADDWVBSTM    PBBSTM           Load BOL Comple
     C                     Z-ADDWVBTTM    PBBTTM           Load Truck Depa
     C                     Z-ADDWVH0NX    PBH0NX           Act Frt Referen
     C                     Z-ADDWVH1NX    PBH1NX           Act Non-Ref Frt
     C                     Z-ADDWVH2NX    PBH2NX           OH Fuel Surchar
     C                     Z-ADDWVH3NX    PBH3NX           OH Total Non-Re
     C                     Z-ADDWVH4NX    PBH4NX           OH Total Ref Fr
     C                     Z-ADDWVC0C7    PBC0C7           Claim Number
     C                     MOVELWVUVST    PBUVST    P      EDI Status 1
     C                     MOVELWVUWST    PBUWST    P      EDI Status 2
     C                     MOVELWVUXST    PBUXST    P      EDI Status 3
     C                     Z-ADDWVAATM    PBAATM           Job Time
     C                     MOVELWVAYNA    PBAYNA    P      User Id
     C                     MOVELWVA0NA    PBA0NA    P      Job Name
     C                     Z-ADDWVAXDT    PBAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YIRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Rtv Active Status     RT - PFS Interface  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           WWY1NX           PFS Company Num
     C                     KFLD           WWGYAA           PFS Interface C
      * Setup key
     C                     Z-ADDWL0019    WWY1NX           PFS Company Num
     C                     MOVELWL0020    WWGYAA           PFS Interface C
      * Establish starting position
     C           KRSTH     CHAIN@BUREBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3541' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0021           PFS AccuSort Ac
     C                     MOVEL*BLANK    WL0022           PFS Carlisle Ac
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWWWSSX    WL0021           PFS AccuSort Ac
     C                     MOVELWWWUSX    WL0022           PFS Carlisle Ac
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * Upd Original Order DataRT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQTI01           Company Number
     C           *LIKE     DEFN WDC4NB    WQTI02           Order Number
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           WQTI01           Company Number
     C                     KFLD           WQTI02           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WQTI01           Company Number
     C                     Z-ADDP1C4NB    WQTI02           Order Number
      * Establish starting position
     C           KRSTI     SETLL@BGWKL1                    *
     C           KRSTI     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Block Order Flag is Firm Order
     C           P1BCST    IFEQ 'F'                        *IF
      * If Not Cancelled & Firm Date=0 Then Update Orig Ordered Qty & Fir
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Detail Line Status is Not cancelled
      *   |- c2    : DB1.OD Firm Date is Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WDGMST    IFEQ 'L'                        *IF
     C           WDGMST    OREQ 'A'
     C           WDGMST    OREQ 'C'
     C           WDGMST    OREQ 'R'
     C           WDGMST    OREQ 'E'
     C           WDGMST    OREQ 'H'
     C           WDGMST    OREQ 'I'
     C           WDNXDT    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Chg Original Order DataCH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0023           Company Number
     C                     Z-ADDWDC4NB    WL0024           Order Number
     C                     Z-ADDWDDPNB    WL0025           Order Sequence
     C                     Z-ADDWDUENB    WL0026           Order Secondary
     C                     Z-ADD##JDT     WL0027           OD Firm Date
     C                     Z-ADDWDAVQT    WL0028           OD Original Ord
     C                     Z-ADDWDGSPR    WL0029           OD Cancel Date
     C                     EXSR TJCHRC
     C                     END                             *FI
      * If Cancelled & Cancel Date=0 Then Update OD Cancel Date to *Job D
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Detail Line Status is Cancelled
      *   |- c2    : DB1.OD Cancel Date is Equal zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WDGMST    IFEQ 'X'                        *IF
     C           WDGSPR    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Note: OD Cancel Date is a 'PRC' Data Type.
      * LCL.USR From Date Numeric = JOB.*Job date
     C                     Z-ADD##JDT     YL0147           USR From Date N
      * Chg Original Order DataCH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0023           Company Number
     C                     Z-ADDWDC4NB    WL0024           Order Number
     C                     Z-ADDWDDPNB    WL0025           Order Sequence
     C                     Z-ADDWDUENB    WL0026           Order Secondary
     C                     Z-ADDWDNXDT    WL0027           OD Firm Date
     C                     Z-ADDWDDZPR    WL0028           OD Original Ord
     C                     Z-ADDYL0147    WL0029           OD Cancel Date
     C                     EXSR TJCHRC
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Block Order Flag is Block Order
     C           P1BCST    IFEQ 'B'                        *IF
      * Chg Original Order DataCH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0023           Company Number
     C                     Z-ADDWDC4NB    WL0024           Order Number
     C                     Z-ADDWDDPNB    WL0025           Order Sequence
     C                     Z-ADDWDUENB    WL0026           Order Secondary
     C                     Z-ADD*ZERO     WL0027           OD Firm Date
     C                     Z-ADD*ZERO     WL0028           OD Original Ord
     C                     Z-ADDWDGSPR    WL0029           OD Cancel Date
     C                     EXSR TJCHRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTI     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJCHRC    BEGSR
      *================================================================
      * Chg Original Order DataCH - Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1111  70       Item Code
     C                     MOVEL*BLANK    WN1112  3        Warehouse Code
     C                     Z-ADD*ZERO     WN1113  70       Ship To Custome
     C                     Z-ADD*ZERO     WN1114  70       Order Group Cod
     C                     MOVEL*BLANK    WN1115  1        Detail Line Sta
     C                     MOVEL*BLANK    WN1116  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN1117 112       Billing Detail
     C                     Z-ADD*ZERO     WN1118 112       Billing Detail
     C                     Z-ADD*ZERO     WN1119 112       Billing Detail
     C                     Z-ADD*ZERO     WN1120 112       Quantity to Sub
     C                     MOVEL*BLANK    WN1121  1        Comment Print A
     C                     MOVEL*BLANK    WN1122  1        Comment Print I
     C                     MOVEL*BLANK    WN1123  1        Comment Print P
     C                     MOVEL*BLANK    WN1124  1        Comment Print S
     C                     Z-ADD*ZERO     WN1125 112       Extended Amount
     C                     Z-ADD*ZERO     WN1126  70       Market Pricing
     C                     MOVEL*BLANK    WN1127  3        Commodity Marke
     C                     MOVEL*BLANK    WN1128  3        Date Method Cod
     C                     MOVEL*BLANK    WN1129  3        Price Method Co
     C                     Z-ADD*ZERO     WN1130 114       Price Overage O
     C                     Z-ADD*ZERO     WN1131  70       Contract Number
     C                     MOVEL*BLANK    WN1132  1        Price Status
     C                     Z-ADD*ZERO     WN1133  70       Pricing Date Us
     C                     MOVEL*BLANK    WN1134  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN1135  2        U/M - Ordered
     C                     MOVEL*BLANK    WN1136  1        Work Confirm St
     C                     MOVEL*BLANK    WN1137  1        Work Over/Short
     C                     MOVEL*BLANK    WN1138  1        OD Production P
     C                     MOVEL*BLANK    WN1139 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN1140 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN1141  1        Age Code
     C                     MOVEL*BLANK    WN1142  1        Palletize
     C                     MOVEL*BLANK    WN1143  1        Slip Sheet
     C                     MOVEL*BLANK    WN1144  1        Catch Weight St
     C                     MOVEL*BLANK    WN1145  1        Price Audit
     C                     MOVEL*BLANK    WN1146  3        Price Audit Rea
     C                     MOVEL*BLANK    WN1147  1        Production Date
     C                     Z-ADD*ZERO     WN1148 112       Rated Freight
     C                     Z-ADD*ZERO     WN1149 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN1150 112       Weight Ordered
     C                     Z-ADD*ZERO     WN1151 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN1152 112       Weight Schedule
     C                     Z-ADD*ZERO     WN1153 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN1154 112       Weight Shipped
     C                     Z-ADD*ZERO     WN1155 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN1156 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN1157 114       Unit Price
     C                     Z-ADD*ZERO     WN1158 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN1159 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN1160 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN1161 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN1162  70       Requested Ship
     C                     Z-ADD*ZERO     WN1163  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN1164  70       Actual Shipped
     C                     MOVEL*BLANK    WN1165  1        Affect Inventor
     C                     MOVEL*BLANK    WN1166  1        Affect Sales Do
     C                     MOVEL*BLANK    WN1167  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN1168  30       Item Structure
     C                     Z-ADD*ZERO     WN1169  30       Item Structure
     C                     Z-ADD*ZERO     WN1170  30       Item Structure
     C                     MOVEL*BLANK    WN1171  2        Item Level
     C                     MOVEL*BLANK    WN1172  2        Quality Level
     C                     MOVEL*BLANK    WN1173  2        Pricing Product
     C                     MOVEL*BLANK    WN1174  2        Season Product
     C                     Z-ADD*ZERO     WN1175  70       Date of Origina
     C                     MOVEL*BLANK    WN1176 10        User Profile Na
     C                     MOVEL*BLANK    WN1177  6        Country Code
     C                     MOVEL*BLANK    WN1178  2        Event Code
     C                     MOVEL*BLANK    WN1179  3        Reason Code
     C                     MOVEL*BLANK    WN1180  3        Sales Route Cod
     C                     MOVEL*BLANK    WN1181  1        Modified Flag
     C                     MOVEL*BLANK    WN1182  1        Substituted Fla
     C                     MOVEL*BLANK    WN1183  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN1184 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN1185 112       Invoice Extende
     C                     Z-ADD*ZERO     WN1186  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN1187  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN1188  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN1189  1        Affect Commissi
     C                     MOVEL*BLANK    WN1190  1        Affect Pricing
     C                     MOVEL*BLANK    WN1191  1        Released by Use
     C                     MOVEL*BLANK    WN1192  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN1193  2        OD Pallet Type
     C                     MOVEL*BLANK    WN1194  3        Production Ware
     C                     MOVEL*BLANK    WN1195  3        OD Price Type
     C                     Z-ADD*ZERO     WN1196  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN1197  70       Consumed Item C
     C                     Z-ADD*ZERO     WN1198  70       Deadline Depart
     C                     Z-ADD*ZERO     WN1199  70       OD Price Type R
     C                     Z-ADD*ZERO     WN1200  60       Deadline Depart
     C                     Z-ADD*ZERO     WN1201  60       Price Code
     C                     Z-ADD*ZERO     WN1202  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN1203  60       Substitution Li
     C                     Z-ADD*ZERO     WN1204  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN1205 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN1206 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN1207 112       OD Item Target
     C                     Z-ADD*ZERO     WN1208 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN1209 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN1210 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN1211 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN1212 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN1213 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN1214 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN1215 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN1216  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN1217  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN1218  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN1219 112       Weight Amount E
     C                     Z-ADD*ZERO     WN1220  40       Item Age Days
     C                     Z-ADD*ZERO     WN1221  70       Production Ovr
     C                     Z-ADD*ZERO     WN1222  70       Production Ovr
     C                     MOVEL*BLANK    WN1223  1        OD Spot Buy
     C                     MOVEL*BLANK    WN1224  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN1225  3        Order Line Erro
     C                     Z-ADD*ZERO     WN1226  70       OD Market Begin
     C                     Z-ADD*ZERO     WN1227  70       OD Market Endin
     C                     Z-ADD*ZERO     WN1228  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN1229  1        EDI Status 1
     C                     MOVEL*BLANK    WN1230  1        EDI Status 2
     C                     MOVEL*BLANK    WN1231  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1232  60       Job Time
     C                     MOVEL*BLANK    WN1233 10        User Id
     C                     MOVEL*BLANK    WN1234 10        Job Name
     C                     Z-ADD*ZERO     WN1235  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YJRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0023    WEAIC3           Company Number
     C                     Z-ADDWL0024    WEC4NB           Order Number
     C                     Z-ADDWL0025    WEDPNB           Order Sequence
     C                     Z-ADDWL0026    WEUENB           Order Secondary
      *
     C           KLCHTJ    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C           KLCHTJ    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YJRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWL0027    WENXDT           OD Firm Date
     C                     Z-ADDWL0028    WEDZPR           OD Original Ord
     C                     Z-ADDWL0029    WEGSPR           OD Cancel Date
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YJRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * DLT Unused HG/Orders   RT - Ham Group/Order  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN1236  1        Ham Group Found
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WXAIC3    WQTK01           Company Number
     C           *LIKE     DEFN WXC4NB    WQTK02           Order Number
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           WQTK01           Company Number
     C                     KFLD           WQTK02           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WQTK01           Company Number
     C                     Z-ADDP1C4NB    WQTK02           Order Number
      * Establish starting position
     C           KRSTK     SETLL@NDCPAQ                    *
     C           KRSTK     READE@NDCPAQ                  90*
      * Data record not found
     C   90                MOVEL'USR2872' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * VAL Ham Group on Order RT - PD Order Detail  * 
     C                     EXSR TLRVGN
      * CASE: PAR.Ham Group Found USR is No
     C           WN1236    IFEQ 'N'                        *IF
      * DLT Ham Group/Order    DL - Ham Group/Order  * 
     C                     EXSR TMDLRC
     C                     END                             *FI
     C           KRSTK     READE@NDCPAQ                  90*
     C                     ENDDO
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * VAL Ham Group on Order RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WN1236           Ham Group Found
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQTL01           Company Number
     C           *LIKE     DEFN WDC4NB    WQTL02           Order Number
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WQTL01           Company Number
     C                     KFLD           WQTL02           Order Number
      * Setup key
     C                     Z-ADDWXAIC3    WQTL01           Company Number
     C                     Z-ADDWXC4NB    WQTL02           Order Number
      * Establish starting position
     C           KRSTL     SETLL@BGWKL1                    *
     C           KRSTL     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Ham Group Number EQ PAR.Ham Group Number
      *   |- c2    : DB1.Detail Line Status is Not cancelled
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WDA1AA    IFEQ WXA1AA                     *IF
     C           WDGMST    IFEQ 'L'                        *IF
     C           WDGMST    OREQ 'A'
     C           WDGMST    OREQ 'C'
     C           WDGMST    OREQ 'R'
     C           WDGMST    OREQ 'E'
     C           WDGMST    OREQ 'H'
     C           WDGMST    OREQ 'I'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WN1236           Ham Group Found
     C                     GOTO TLEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTL     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMDLRC    BEGSR
      *================================================================
      * DLT Ham Group/Order    DL - Ham Group/Order  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @NDCPAM
     C                     Z-ADDWXA1AA    WYA1AA           Ham Group Numbe
     C                     Z-ADDWXAIC3    WYAIC3           Company Number
     C                     Z-ADDWXC4NB    WYC4NB           Order Number
      *
     C           KLDLTM    KLIST
     C                     KFLD           WYA1AA           Ham Group Numbe
     C                     KFLD           WYAIC3           Company Number
     C                     KFLD           WYC4NB           Order Number
     C           KLDLTM    CHAIN@NDCPAM              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDNDCPL0'MDACP
     C                     MOVEL'@NDCPAM' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TMEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@NDCPAM                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * CRT New HamGrp/Orders  RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1237  70       Deadline Depart
     C                     Z-ADD*ZERO     WN1238  60       Deadline Depart
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQTN01           Company Number
     C           *LIKE     DEFN WDC4NB    WQTN02           Order Number
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           WQTN01           Company Number
     C                     KFLD           WQTN02           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WQTN01           Company Number
     C                     Z-ADDP1C4NB    WQTN02           Order Number
      * Establish starting position
     C           KRSTN     SETLL@BGWKL1                    *
     C           KRSTN     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Ham Group Number is Entered
     C           WDA1AA    IFNE 0                          *IF
      * RTV Deadln DepartDT/TM RT - OM Load Header  * 
     C                     EXSR TORVGN
      * CRT Ham Group/Order    CR - Ham Group/Order  * 
     C                     EXSR TPCRRC
      * ** Default record status to Active
      * CRT Ham Group/Customer CR - Ham Group Customer  * 
     C                     EXSR TQCRRC
     C                     END                             *FI
     C           KRSTN     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * RTV Deadln DepartDT/TM RT - OM Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TARMNB    WQTO02           Load ID
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           WQTO02           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQTO02           Load ID
      * Establish starting position
     C           KRSTO     SETLL@FJCPSB                    *
     C           KRSTO     READE@FJCPSB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN1237           Deadline Depart
     C                     Z-ADD*ZERO     WN1238           Deadline Depart
     C                     GOTO TOEXIT                     *QUIT
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDTAKZDT    WN1237           Deadline Depart
     C                     Z-ADDTAAXTM    WN1238           Deadline Depart
     C                     GOTO TOEXIT                     *QUIT
     C           KRSTO     READE@FJCPSB                  90*
     C                     ENDDO
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPCRRC    BEGSR
      *================================================================
      * CRT Ham Group/Order    CR - Ham Group/Order  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN1239  1        EDI Status 1
     C                     MOVEL*BLANK    WN1240  1        EDI Status 2
     C                     MOVEL*BLANK    WN1241  1        EDI Status 3
     C                     MOVEL*BLANK    WN1242  1        Record Status
     C                     Z-ADD*ZERO     WN1243  60       Job Time
     C                     MOVEL*BLANK    WN1244 10        User Id
     C                     MOVEL*BLANK    WN1245 10        Job Name
     C                     Z-ADD*ZERO     WN1246  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @NDCPAM
     C                     Z-ADDWDA1AA    WYA1AA           Ham Group Numbe
     C                     Z-ADDWDAIC3    WYAIC3           Company Number
     C                     Z-ADDWDC4NB    WYC4NB           Order Number
     C                     Z-ADDWDAODT    WYN2DT           Ham Group Produ
     C                     Z-ADD*ZERO     WYJDNX           Ham Group Proce
     C                     MOVEL*BLANK    WYPDNA           Ham Group Sched
     C                     Z-ADDWN1237    WYKZDT           Deadline Depart
     C                     Z-ADDWN1238    WYAXTM           Deadline Depart
      *
      * USER: Processing before Data update
     C                     MOVEL*BLANK    WYUVST           EDI Status 1
     C                     MOVEL*BLANK    WYUWST           EDI Status 2
     C                     MOVEL*BLANK    WYUXST           EDI Status 3
     C                     MOVEL'A'       WYVSST           Record Status
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WYAATM           Job Time
     C                     MOVEL##USR     WYAYNA           User Id
     C                     MOVEL##JOB     WYA0NA           Job Name
     C                     Z-ADD##JDT     WYAXDT           Job Date
     C           KLCRTP    KLIST
     C                     KFLD           WYA1AA           Ham Group Numbe
     C                     KFLD           WYAIC3           Company Number
     C                     KFLD           WYC4NB           Order Number
      * Check for duplicate primary key
     C           KLCRTP    SETLL@NDCPAM                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2873' W0RTN   7
      * USER: Processing if Data record already exists
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C                     WRITE@NDCPAM                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQCRRC    BEGSR
      *================================================================
      * CRT Ham Group/Customer CR - Ham Group Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @NCCPAJ
     C                     Z-ADDWDA1AA    TBA1AA           Ham Group Numbe
     C                     Z-ADDWDBKC7    TBBKC7           Ship To Custome
     C                     MOVEL*BLANK    TBUBTX           Ham Group Cust
     C                     MOVELWDUVST    TBUVST           EDI Status 1
     C                     MOVELWDUWST    TBUWST           EDI Status 2
     C                     MOVELWDUXST    TBUXST           EDI Status 3
     C                     MOVEL'A'       TBVSST           Record Status
     C                     Z-ADDWDAATM    TBAATM           Job Time
     C                     MOVELWDAYNA    TBAYNA           User Id
     C                     MOVELWDA0NA    TBA0NA           Job Name
     C                     Z-ADDWDAXDT    TBAXDT           Job Date
      *
      * USER: Processing before Data update
      * ** change from par context             05/04/2007 LJB OMS011
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     TBAATM           Job Time
     C                     MOVEL##USR     TBAYNA           User Id
     C                     MOVEL##JOB     TBA0NA           Job Name
     C                     Z-ADD##JDT     TBAXDT           Job Date
     C           KLCRTQ    KLIST
     C                     KFLD           TBA1AA           Ham Group Numbe
     C                     KFLD           TBBKC7           Ship To Custome
      * Check for duplicate primary key
     C           KLCRTQ    SETLL@NCCPAJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2871' W0RTN   7
      * USER: Processing if Data record already exists
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C                     WRITE@NCCPAJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRRVGN    BEGSR
      *================================================================
      * RTV Affect Inv/Sls     RT - Order Types  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTR     KLIST
     C                     KFLD           TCJNCD           Order Type - Sa
      * Setup key
     C                     MOVELP1JNCD    TCJNCD           Order Type - Sa
      * Establish starting position
     C           KRSTR     CHAIN@EXRETY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1063' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P3OFST           Affect Sales Do
     C                     GOTO TREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELTCOFST    P3OFST           Affect Sales Do
     C                     ENDIF
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSRVGN    BEGSR
      *================================================================
      * RTV OD Whs/ShpCo/AccCo RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQTS01           Company Number
     C           *LIKE     DEFN WDC4NB    WQTS02           Order Number
      * Define keylist
     C           KRSTS     KLIST
     C                     KFLD           WQTS01           Company Number
     C                     KFLD           WQTS02           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WQTS01           Company Number
     C                     Z-ADDP1C4NB    WQTS02           Order Number
      * Establish starting position
     C           KRSTS     SETLL@BGWKL1                    *
     C           KRSTS     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WDGMST    IFEQ 'L'                        *IF
     C           WDGMST    OREQ 'A'
     C           WDGMST    OREQ 'C'
     C           WDGMST    OREQ 'R'
     C           WDGMST    OREQ 'E'
     C           WDGMST    OREQ 'H'
     C           WDGMST    OREQ 'I'
      * RTV OD Whs/ShpCo/AccCo RT - Warehouse  * Retrieve object
     C                     EXSR TTRVGN
     C                     MOVELWDAJCD    YN0004           Warehouse Code
     C                     GOTO TSEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTS     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTRVGN    BEGSR
      *================================================================
      * RTV OD Whs/ShpCo/AccCo RT - Warehouse  * Retrieve object
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTT     KLIST
     C                     KFLD           WIAJCD           Warehouse Code
      * Setup key
     C                     MOVELWDAJCD    WIAJCD           Warehouse Code
      * Establish starting position
     C           KRSTT     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0148           Shipping Compan
     C                     Z-ADD*ZERO     YL0149           Accounting Comp
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TTEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWIBWC3    YL0148           Shipping Compan
     C                     Z-ADDWIBTC3    YL0149           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TURVGN    BEGSR
      *================================================================
      * UPD Increment #Ord YTD RT - A/R Summary  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1247  50       Number of Order
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTU     KLIST
     C                     KFLD           TDAIC3           Company Number
     C                     KFLD           TDANC7           A/R Customer Nu
      * Setup key
     C                     Z-ADDWL0030    TDAIC3           Company Number
     C                     Z-ADDWL0031    TDANC7           A/R Customer Nu
      * Establish starting position
     C           KRSTU     CHAIN@BCREFE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0172' W0RTN   7
      * USER: Processing if Data record not found
      * CRT A/R Summary        CR - A/R Summary  * 
     C                     EXSR TVCRRC
     C                     GOTO TUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           TDDLNB    ADD  1         WN1247           Number of Order
      * CHG A/R Summary        CH - A/R Summary  * 
     C                     EXSR TWCHRC
     C                     ENDIF
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVCRRC    BEGSR
      *================================================================
      * CRT A/R Summary        CR - A/R Summary  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1248  60       Job Time
     C                     MOVEL*BLANK    WN1249 10        User Id
     C                     MOVEL*BLANK    WN1250 10        Job Name
     C                     Z-ADD*ZERO     WN1251  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BCREFD
     C                     Z-ADDWL0030    TEAIC3           Company Number
     C                     Z-ADDWL0031    TEANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     TEAGVA           Age $ Due - Cur
     C                     Z-ADD*ZERO     TEACVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     TEADVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     TEAEVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     TEAFVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     TEAHVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     TEVIVA           Age $ Due-Curre
     C                     Z-ADD*ZERO     TEVJVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     TEVKVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     TEVLVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     TEVMVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     TEVNVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     TEEEVA           Value of Open O
     C                     Z-ADD*ZERO     TEAKTM           Time of Last Ag
     C                     Z-ADD*ZERO     TEAHDT           Date of First S
     C                     Z-ADD*ZERO     TEANDT           Date of Last Sh
     C                     Z-ADD*ZERO     TEANVA           Amount of Last
     C                     Z-ADD*ZERO     TEALDT           Date of Last Pa
     C                     Z-ADD*ZERO     TEAMVA           Amount of Last
     C                     Z-ADD*ZERO     TEAIDT           Date of Highest
     C                     Z-ADD*ZERO     TEALVA           Amount of Highe
     C                     Z-ADD*ZERO     TEDJNB           Number of Invoi
     C                     Z-ADD1         TEDLNB           Number of Order
     C                     Z-ADD*ZERO     TEDDNB           Number of Credi
     C                     Z-ADD*ZERO     TEDMNB           Number of Payme
     C                     Z-ADD*ZERO     TEDUDT           Date of Last Ag
     C                     Z-ADD*ZERO     TELYNO           Last YTD Nbr of
     C                     Z-ADD*ZERO     TELYNC           Last YTD Nbr of
     C                     Z-ADD*ZERO     TELYNP           Last YTD Nbr of
     C                     Z-ADD*ZERO     TELYNI           Last YTD Nbr of
     C                     Z-ADD*ZERO     TEADPM           MTD Invoices Pa
     C                     Z-ADD*ZERO     TEVOVA           YTD Invoices Pa
     C                     Z-ADD*ZERO     TEBTDY           MTD Days Paid
     C                     Z-ADD*ZERO     TEBUDY           YTD Days Paid
     C                     Z-ADD*ZERO     TEVPVA           YTD Sales Invoi
     C                     Z-ADD*ZERO     TEVQVA           Last Year Sales
     C                     MOVEL*BLANK    TEBCCD           Salesperson Cod
     C                     MOVEL*BLANK    TER4CD           Sales Route Cod
     C                     Z-ADD*ZERO     TECUMO           Current Month
     C                     MOVEL*BLANK    TEUVST           EDI Status 1
     C                     MOVEL*BLANK    TEUWST           EDI Status 2
     C                     MOVEL*BLANK    TEUXST           EDI Status 3
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     TEAATM           Job Time
     C                     MOVEL##USR     TEAYNA           User Id
     C                     MOVEL##JOB     TEA0NA           Job Name
     C                     Z-ADD##JDT     TEAXDT           Job Date
     C           KLCRTV    KLIST
     C                     KFLD           TEAIC3           Company Number
     C                     KFLD           TEANC7           A/R Customer Nu
      * Check for duplicate primary key
     C           KLCRTV    SETLL@BCREFD                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0173' W0RTN   7
      * Send message 'A/R Summary            EX'
     C                     MOVEL'USR0173' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TVEXIT
     C                     ENDIF
      *
     C                     WRITE@BCREFD                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWCHRC    BEGSR
      *================================================================
      * CHG A/R Summary        CH - A/R Summary  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1252 112       Age $ Due - Cur
     C                     Z-ADD*ZERO     WN1253 112       Age $ Due - Agi
     C                     Z-ADD*ZERO     WN1254 112       Age $ Due - Agi
     C                     Z-ADD*ZERO     WN1255 112       Age $ Due - Agi
     C                     Z-ADD*ZERO     WN1256 112       Age $ Due - Agi
     C                     Z-ADD*ZERO     WN1257 112       Age $ Due - Agi
     C                     Z-ADD*ZERO     WN1258 112       Age $ Due-Curre
     C                     Z-ADD*ZERO     WN1259 112       Age $ Due-Aging
     C                     Z-ADD*ZERO     WN1260 112       Age $ Due-Aging
     C                     Z-ADD*ZERO     WN1261 112       Age $ Due-Aging
     C                     Z-ADD*ZERO     WN1262 112       Age $ Due-Aging
     C                     Z-ADD*ZERO     WN1263 112       Age $ Due-Aging
     C                     Z-ADD*ZERO     WN1264 112       Value of Open O
     C                     Z-ADD*ZERO     WN1265  60       Time of Last Ag
     C                     Z-ADD*ZERO     WN1266  70       Date of First S
     C                     Z-ADD*ZERO     WN1267  70       Date of Last Sh
     C                     Z-ADD*ZERO     WN1268 112       Amount of Last
     C                     Z-ADD*ZERO     WN1269  70       Date of Last Pa
     C                     Z-ADD*ZERO     WN1270 112       Amount of Last
     C                     Z-ADD*ZERO     WN1271  70       Date of Highest
     C                     Z-ADD*ZERO     WN1272 112       Amount of Highe
     C                     Z-ADD*ZERO     WN1273  50       Number of Invoi
     C                     Z-ADD*ZERO     WN1274  50       Number of Credi
     C                     Z-ADD*ZERO     WN1275  50       Number of Payme
     C                     Z-ADD*ZERO     WN1276  70       Date of Last Ag
     C                     Z-ADD*ZERO     WN1277  50       Last YTD Nbr of
     C                     Z-ADD*ZERO     WN1278  50       Last YTD Nbr of
     C                     Z-ADD*ZERO     WN1279  50       Last YTD Nbr of
     C                     Z-ADD*ZERO     WN1280  50       Last YTD Nbr of
     C                     Z-ADD*ZERO     WN1281  50       MTD Invoices Pa
     C                     Z-ADD*ZERO     WN1282  50       YTD Invoices Pa
     C                     Z-ADD*ZERO     WN1283  50       MTD Days Paid
     C                     Z-ADD*ZERO     WN1284  50       YTD Days Paid
     C                     Z-ADD*ZERO     WN1285 112       YTD Sales Invoi
     C                     Z-ADD*ZERO     WN1286 112       Last Year Sales
     C                     MOVEL*BLANK    WN1287  3        Salesperson Cod
     C                     MOVEL*BLANK    WN1288  3        Sales Route Cod
     C                     Z-ADD*ZERO     WN1289  20       Current Month
     C                     MOVEL*BLANK    WN1290  1        EDI Status 1
     C                     MOVEL*BLANK    WN1291  1        EDI Status 2
     C                     MOVEL*BLANK    WN1292  1        EDI Status 3
     C                     Z-ADD*ZERO     WN1293  60       Job Time
     C                     MOVEL*BLANK    WN1294 10        User Id
     C                     MOVEL*BLANK    WN1295 10        Job Name
     C                     Z-ADD*ZERO     WN1296  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YKRDC   1
      *
      * Move key fields to @BCREFD
     C                     Z-ADDTDAIC3    TEAIC3           Company Number
     C                     Z-ADDTDANC7    TEANC7           A/R Customer Nu
      *
     C           KLCHTW    KLIST
     C                     KFLD           TEAIC3           Company Number
     C                     KFLD           TEANC7           A/R Customer Nu
     C           KLCHTW    CHAIN@BCREFD              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'ARBCREL0'MDACP
     C                     MOVEL'@BCREFD' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL012.
     C                     MOVEL'LBL012'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QARBC1    YKRDCS
      * Move non-key fields to @BCREFD
     C                     Z-ADDWN1247    TEDLNB           Number of Order
      *
      * Set PGM.*Record Data Changed flag
     C           QARBC1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) TEAATM' defaulted for 'Job Time'.
      * Field '(DB1) TEAYNA' defaulted for 'User Id'.
      * Field '(DB1) TEA0NA' defaulted for 'Job Name'.
      * Field '(DB1) TEAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     TEAATM           Job Time
     C                     MOVEL##USR     TEAYNA           User Id
     C                     MOVEL##JOB     TEA0NA           Job Name
     C                     Z-ADD##JDT     TEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QARBC1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YKRDC     IFEQ 'Y'
     C                     UPDAT@BCREFD                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKARBCREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Initialize Fields.
      *================================================================
     C                     MOVEL'N'       P4XOST           USR Credit Hold
     C                     MOVEL'N'       P4XPST           USR Production
     C                     MOVEL*BLANK    P4W7ST           USR New Order
     C                     MOVEL'*NO'     P4W7ST           USR New Order
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Retrieve Company, Order, & Load Information. (UPD Order Detail)
      *================================================================
      * RTV Credit Hold Status RT - Company Control  * 
     C                     EXSR SARVGN
      * RTV Post/Update Cond   RT - Order Header TRG  * 
     C                     EXSR SBRVGN
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0001  30       Company Number
     C           YL0001    PARM *BLANK    WQ0002  1        Plant Company S
     C           YL0002    PARM *BLANK    WQ0003  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set flag for new order
      * CASE: PAR.Header Status is Entered
     C           P1GWST    IFEQ 'E'                        *IF
     C                     MOVEL'*YES'    P4W7ST           USR New Order
     C                     END                             *FI
      * E4119 RMC 5/23/2016 Remove Live with tpm checks
      * RTV Load Status        RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1RMNB    WL0001           Load ID
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0003    P      Load Status
      * RTV All Fields         RT - Order Header TRG  * 
     C                     EXSR SDRVGN
      * CASE: LCL.Order Requires Review is No
     C           YL0100    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * ** If EOA errors still exist, update OH and OD        P001251
      * EXC Order Req Rvw editsXF - Order Header TRG  * 
     C                     CALL 'PBBIXFR'              90  EXC Order Req R
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0004  30       Company Number
     C                     PARM P1C4NB    WQ0005  70       Order Number
     C                     PARM P1BKC7    WQ0006  70       Ship To Custome
     C                     PARM P1A5DT    WQ0007  70       Requested Ship
     C                     PARM P1AODT    WQ0008  70       Scheduled Ship
     C                     PARM YL0048    WQ0009  70       Requested Deliv
     C                     PARM YL0049    WQ0010  40       Requested Deliv
     C                     PARM YL0052    WQ0011  70       Load ID
     C           YL0100    PARM YL0100    WQ0012  2        Order Requires
     C                     PARM YL0128    WQ0013  3        Warehouse Code
     C           YL0129    PARM YL0129    WQ0014  3        Order Line Erro
     C                     PARM YL0130    WQ0015  70       Deadline Depart
     C                     PARM YL0131    WQ0016  60       Deadline Depart
     C                     PARM YL0002    WQ0017  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBBIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * 09/23/08 PKD S00463 Repost of Order will not update missing
      *              info in the Order Detail.
      * Edt Post Upd OrdDtl   RT - Order Detail  * 
     C                     EXSR SERVGN
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Retrieve Credit Limits.
      *================================================================
      * * A/R Credit Limit *
      * RTV Credit Limits      RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1ANC7    WL0003           Ship To Custome
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0004    P2BTC7           Parent Customer
     C                     MOVELWL0005    P2K6ST    P      Credit Check A/
     C                     MOVELWL0006    P2UZST    P      Credit Check Pa
     C                     Z-ADDWL0007    WUNFNN           Parent Credit L
     C                     Z-ADDWL0008    P2VHVA           A/R Credit Limi
      * * Parent Credit Limit *
      * RTV Credit Limits      RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2BTC7    WL0003           Ship To Custome
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0004    WUNFNN           Parent Customer
     C                     MOVELWL0005    WUG0TX    P      Credit Check A/
     C                     MOVELWL0006    WUG0TX    P      Credit Check Pa
     C                     Z-ADDWL0007    P2S2NB           Parent Credit L
     C                     Z-ADDWL0008    WUNFNN           A/R Credit Limi
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Calculate Order Value & Weight total and Order Value Difference.
      *================================================================
     C                     Z-ADD*ZERO     P4JSVA           USR Order Value
     C                     Z-ADD*ZERO     P4AYWG           USR Order Weigh
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Load ID is GT Zero
      *   |- c2    : PAR.Load Plan Order is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1RMNB    IFGT *ZERO                      *IF
     C           P1U4ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      *
     C                     Z-ADD*ZERO     WN0126  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0127  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0128  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0129  40       Requested Deliv
      *
      * UPD Ld Mi,Whse,DDD/T   IF
      * ***** Change Log and Comments
     C                     EXSR UESUBR                     ***** Change Lo
      * Rtv/Chg Whs,ld miles  RT - Load Header  * 
     C                     EXSR SHRVGN
      * RTV MG Created Load   RT - Load Header  * 
     C                     EXSR SMRVGN
      * CASE: LCL.MG Created Load is Not MG Created Load
     C           YL0133    IFEQ *BLANK                     *IF
      * Deadline depart calcs
      * CASE: PAR.Load Status is Entered
     C           P8PKST    IFEQ 'E'                        *IF
      * only calculate deadline departure if the load is not "E"ntered
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv 1st Ord Delv Dt/Tm RT - Load Detail  * 
     C                     EXSR SNRVGN
     C           WN0129    MULT 100       WN0127           Deadline Depart
     C                     Z-ADDWN0128    WN0126           Deadline Depart
      * ** 11/16/2007 LJB FP1251 Total Load Miles will be zeros if there
      * ** is no Miles Between Cities record - this is an error that
      * ** needs to be corrected
      * ** 08/21/2008 LJB E00207 If 1st stop miles cannot be calculated,
      * ** is still an error. Override miles won't correct this.
      * ** 09/23/2009 LJB E00495  Date and Time will be zero'd out if
      * ** mileage could not be calculated.
      *
     C                     Z-ADD*ZERO     WN0275  51       Hours Required
     C                     Z-ADD*ZERO     WN0276  50       Miles to next s
     C                     Z-ADD*ZERO     WN0277  50       USR Hours 5.0
     C                     Z-ADD*ZERO     WN0278  51       USR Hours to Mi
     C                     Z-ADD*ZERO     WN0279  50       @Days 5
     C                     Z-ADD*ZERO     WN0280  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0281  20       USR Period
     C                     Z-ADD*ZERO     WN0282  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0283  40       Requested Deliv
      *
      * CLC Departure Date/TimeIF
      * ***** Change Log and Comments
     C                     EXSR UFSUBR                     ***** Change Lo
      * RTV Shipping Method    RT - Load Header  * 
     C                     EXSR SPRVGN
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.Shipping Method is Collect Truck
      *   |- c2    : LCL.Shipping Method is Collect Rail
      *   '-
     C           YL0134    IFEQ 'CT'                       *IF
     C           YL0134    OREQ 'CR'                       *OR
      * ** Treat CT & CR the same           FP1251 LJB 12/26/2007
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1RMNB    WL0009           Load ID
     C                     Z-ADD*ZERO     WL0010           Stop/Drop
     C                     Z-ADD*ZERO     WL0011           Order Number
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0012    WN0276           Miles to next s
      * ** Calc miles between all stops then retrieve 1st stop miles
      * CASE: PAR.Miles to next stop is Not Entered
     C           WN0276    IFEQ 0                          *IF
      * ** Override miles will be returned, if entered
      * CLC Total Load Miles   XF - Load Detail  * 
     C                     CLEARPARC
     C                     Z-ADDP1RMNB    PARMNB           Load ID
      *
     C                     CALL 'PDW3XFR'              90  CLC Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Load Detai
     C           WUTLMI    PARM WUTLMI    WQ0020  70       Total Load Mile
     C           WUK2DT    PARM WUK2DT    WQ0021  70       Override Total
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RTV 1st Stop Mileage   RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1RMNB    WL0009           Load ID
     C                     Z-ADD*ZERO     WL0010           Stop/Drop
     C                     Z-ADD*ZERO     WL0011           Order Number
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0012    WN0276           Miles to next s
     C                     END                             *FI
      * ** 11/16/2007 LJB FP1251 Error if no miles, set SDD/SDT to zeros
      * CASE: PAR.Miles to next stop is Not Entered
     C           WN0276    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WN0126           Scheduled Deliv
     C                     Z-ADD*ZERO     WN0127           Scheduled Deliv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0275           Hours Required
     C                     Z-ADD*ZERO     YL0135           Hours Required
      * RTV Legal Run Miles DscRT - Legal Run Mileage Hours  * 
     C                     EXSR SRRVGN
      * 09/09/11 PKD E1659 Additional Route Hours
      * Rtv Addtnl Route Hrs  XF - Order Header TRG  * 
     C                     CALL 'PMACXFR'              90  Rtv Addtnl Rout
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1RMNB    WQ0022  70       Load ID
     C           YL0136    PARM YL0136    WQ0023  50       Additional Rout
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMACXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C           YL0135    ADD  YL0136    WN0275           Hours Required
      * get number of whole days + remaining hours
      * CASE: PAR.Hours Required is Zero
     C           WN0275    IFEQ 0                          *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C           WN0275    DIV  24        WN0279           @Days 5
     C           WN0279    MULT 24        WU               USR Hours 5.0
     C           WN0275    SUB  WU        WN0277           USR Hours 5.0
     C           WN0277    MULT 10000     WUPINB           @Numeric 6,0
      * Subtract whole days
      * CASE: PAR.@Days 5 is greater than zero
     C           WN0279    IFGT 0                          *IF
     C                     MULT -1        WN0279           @Days 5
      * PAR.Scheduled Delivery Date = PAR.Scheduled Delivery Date + PAR.@
     C           WN0126    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0279    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0126
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0126
     C                     END
     C                     END                             *FI
      * Calculate # whole days + hours left
      * CASE: WRK.@Numeric 6,0 GE PAR.Scheduled Delivery Time
     C           WUPINB    IFGE WN0127                     *IF
     C                     SUB  WN0127    WUPINB           @Numeric 6,0
     C                     Z-ADD-1        WN0279           @Days 5
      * PAR.Scheduled Delivery Date = PAR.Scheduled Delivery Date + PAR.@
     C           WN0126    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDWN0279    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0126
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0126
     C                     END
     C           240000    SUB  WUPINB    WN0127           Scheduled Deliv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WUPINB    WN0127           Scheduled Deliv
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
     C                     EXSR SSRVGN
     C                     END                             *FI
      * CHG Deadline Dep D/T   CH - Load Header  * 
     C                     EXSR STCHRC
      * CHG Deadline Date/Time RT - Load Detail  * 
     C                     EXSR SURVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ****
      * CLC Price/Price Audit  XF - Order Header TRG  * 
     C                     CALL 'PDPRXFR'              90  CLC Price/Price
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0024  30       Company Number
     C                     PARM P1C4NB    WQ0025  70       Order Number
     C                     PARM *ZERO     WQ0026  30       Order Sequence
     C                     PARM *ZERO     WQ0027  30       Order Secondary
     C                     PARM P7PECF    WQ0028  3        Pricing Event C
     C           P4JSVA    PARM *ZERO     WQ0029 112       Order Value Tot
     C           P4AYWG    PARM *ZERO     WQ0030 112       Order Weight To
     C           P4XPST    PARM P4XPST    WQ0031  1        Production Hold
     C                     PARM P4W7ST    WQ0032  4        USR New Order
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * E04119  RMC 7/15/16 if TMSLDP is live and MG Load, then dont upd
      *    miles or Deadline Depart (comes from MG)
      * E01523  RMC 5/31/11 Use req delv all the time for ddt calc
      * ** 09.23.2009 LJB E00495
      * ** Retrieve Carrier Appt Date/Time, use if not zeros, else
      * ** use Requested Delivery Date/Time
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** The Date and Time being calculated are the latest date and tim
      * ** that the truck can leave the warehouse and still make the
      * ** delivery on time.
      * *****
      * ** E00495 LJB 09.23.2009
      * ** Carrier Appt Date and Time are in the parm Deadline Departure
      * ** date and time, if called from "UPD Ld Mi,Whse,DDD/T IF"
      * *****
      * ** E00207 LJB 08/11/2008
      * ** Override Total Load Miles has been added to the
      * ** Retrieve Total Load Miles function
      * *****
      * ** FP1251 LJB 12/26/2007
      * ** If no Miles To Next record, change SSD/T to zeros.
      * ** Scheduled Deliv Date has (should have) Requested Delivery Date
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Check Credit.
      *================================================================
      * *** Credit checking routine
      *   *** Do not credit check Block Orders
      *   *** Do not credit check if shipped/invoiced
      *   *** Do not credit check if Pricing event is Unit Weight Change
      *   *** Do not credit check if load is locked, shipped or invoiced
      *   *** Do Not credit check if previously Credit Released
      *   *** Do Not Credit Check if credit check is turned off for Co.
      *   *** Do not chedit check if $ is less than last time checked
      *   *** Do not credit check if order id Confirmed or Complete
      *   *** Do not credit check if Pricing event is Sweep Ords to MG
      * VAL Ld/Ord/Type exists RT - Load Order Change Log  * 
     C                     EXSR SYRVGN
      * No Credit Check done when Credit Check off for Co. or $ < last ti
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ @CN,001                    *IF
      *      No credit checking if order was previously Credit Released-E
     C                     MOVELP1XIST    P4XOST           USR Credit Hold
     C                     ELSE
      * CASE: PAR.Header Status is Confirmed & Complete
     C           P1GWST    IFEQ 'C'                        *IF
     C           P1GWST    OREQ 'R'
      *      no credit checking needed
     C                     MOVELP1XIST    P4XOST           USR Credit Hold
     C                     ELSE
      * CASE: LCL.Load Status is Locked thru Invoiced
     C           YL0003    IFEQ 'I'                        *IF
     C           YL0003    OREQ 'L'
     C           YL0003    OREQ 'S'
      * E4119 RMC 5/23/2016 Remove Live with tpm checks
      *      C2968: no credit checking needed
     C                     MOVELP1XIST    P4XOST           USR Credit Hold
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.USR Order Value LE PAR.A/R order Value Total
      *   |- c2    : PAR.Credit Hold is No
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P4JSVA    IFLE P1VRVA                     *IF
     C           P1XIST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      *      no credit checking needed
     C                     ELSE
      * CASE: PAR.Block Order Flag is Block Order
     C           P1BCST    IFEQ 'B'                        *IF
      *    OMS203:  Do not credit check Block Orders
     C                     MOVELP1XIST    P4XOST           USR Credit Hold
     C                     ELSE
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Pricing Event Called From is Unit Weight Change
      *   |- c2    : PAR.Pricing Event Called From is Unit Weight Change-
      *   '-
     C           P7PECF    IFEQ 'UWC'                      *IF
     C           P7PECF    OREQ 'UWT'                      *OR
      *    PDD012:  Do not credit check on unit weight change
     C                     MOVELP1XIST    P4XOST           USR Credit Hold
     C                     ELSE
      * CASE: PAR.Pricing Event Called From is Sweep Orders to MG
     C           P7PECF    IFEQ 'SWP'                      *IF
      *    PDD012:  Do not credit check on unit weight change
     C                     MOVELP1XIST    P4XOST           USR Credit Hold
     C                     ELSE
      * CASE: PAR.Credit Hold Status is yes
     C           P6D8ST    IFEQ 'Y'                        *IF
      * 12/07/06 PKD PK0040 Company Number not used inside IF.
      *
     C                     Z-ADD*ZERO     WN0603 112       Age $ Due-Curre
     C                     Z-ADD*ZERO     WN0604 112       Value of Open O
     C                     Z-ADD*ZERO     WN0605 112       USR Credit Amou
     C                     Z-ADD*ZERO     WN0606 152       @Numeric 15.2
      *
      * INT Post/Ord Cred Ck   IF
     C                     MOVEL'N'       P4IDST           USR Order Credi
     C                     MOVELWUOTTX    YL0137           Status - Y or N
      * Credit check A/R Customer
      * CASE: PAR.Credit Check A/R Customer is yes
     C           P2K6ST    IFEQ 'Y'                        *IF
      * RTV Sum $ Owed-A/R Cst RT - A/R Summary  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1ANC7    WL0017           A/R Customer Nu
     C                     Z-ADDWN0606    WL0018           @Numeric 15.2
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0018    WN0606           @Numeric 15.2
     C                     Z-ADDWN0606    WN0605           USR Credit Amou
      * Hold if total of A/R Summaries for A/R Cust + this ord > A/R C/L
      * CASE: PAR.USR Credit Amount GT PAR.A/R Credit Limit
     C           WN0605    IFGT P2VHVA                     *IF
     C                     MOVEL'Y'       P4IDST           USR Order Credi
     C                     MOVEL'N'       YL0137           Status - Y or N
     C                     END                             *FI
     C                     END                             *FI
      * Credit check Parent Customer
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Credit Check Parent Cust is yes
      *   |- c2    : PAR.USR Order Credit Hold is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2UZST    IFEQ 'Y'                        *IF
     C           P4IDST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CLC Sum A/R Due by Par RT - Customer  * 
     C                     EXSR TARVGN
     C                     Z-ADDWN0606    WN0605           USR Credit Amou
      * Hold if total of A/R Summaries under Parent + this ord > Parent C
      * CASE: PAR.USR Credit Amount GT PAR.Parent Credit Limit
     C           WN0605    IFGT P2S2NB                     *IF
     C                     MOVEL'Y'       P4IDST           USR Order Credi
     C                     MOVEL'Y'       YL0137           Status - Y or N
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVELP4IDST    P4XOST           USR Credit Hold
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Update Order Dtl and Sts lines; track if have active subs.
      *================================================================
      * RTV Chg Stat/Hdr P/S   RT - Order Detail  * 
     C                     EXSR TBRVGN
      * Modified flag
      * CASE: PAR.Header Status is Confirmed & Complete
     C           P1GWST    IFEQ 'C'                        *IF
     C           P1GWST    OREQ 'R'
      *      ** no change
     C                     ELSE
      * CASE: WRK.Substituted Flag is Substitutions Exist
     C           WUZ3ST    IFEQ 'Y'                        *IF
     C                     MOVEL'M'       P1Z1ST           Modified Flag
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    P1Z1ST           Modified Flag
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Update Order Header and write to TMS Trigger table
      *================================================================
      * * Post the order and write to Trigger Table so order will be sent
      * *  to MercuryGate for Load Planning (Load ID assigned) E004119
      * UPD Chg Order-Post     RT - Order Header TRG  * 
     C                     EXSR TFRVGN
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * ***** Changes and Comments
      *================================================================
      * E4119 RMC 5/23/2016 Remove Live with tpm checks
      * ** 02/22/16 LJB E4119O:  This is changing AGAIN. Write to the Tri
      * **   file when Order is first created?????
      * ** 02/09/16 LJB E004119:  This is changing again. OE won't write
      * **   the Trigger file at this time
      * ** 10/08/15 LJB E004119:  Create TMS Trigger Table record if orde
      * **   is not complete/confirmed and order has been changed.
      * **   The TMS Load Plan Ready flag should be "  " in the Ord Hdr
      * **   when first created, then "N ". When sent to MG the first tim
      * **   the flag will always by "Y ".
      * ** 10/14/13 RMC E2684 Dont hold order for Prod Hold -- only for C
      * ** 02/01/13 RMC P02045 Upd TPM Order Header TRG if sts is Y or P
      * ** 08/22/12 RMC P0196: Dailys implementation of CAT2 - in exit pr
      * ** 11/30/11 LJB P1251: EDI Nistevo Send Status is no longer used
      * **   Check Order Detail for Export Order Automation Upload errors
      * **   If errors still exist then set Order Header, Order Requires
      * **   Review flag to Yes.
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * Update Ham Group/Order records.
      *================================================================
      * *** Delete OLD Ham Group/Order Entries ***
      * DLT Unused HG/Orders   RT - Ham Group/Order  * 
     C                     EXSR TKRVGN
      * *** Create NEW Ham Group/Order Entries ***
      * CRT New HamGrp/Orders  RT - Order Detail  * 
     C                     EXSR TNRVGN
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1JNCD           Order Type - Sa
     C                     Z-ADD*ZERO     P1ANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     P1A5DT           Requested Ship
     C                     MOVEL*BLANK    P1CQCD           Reason Code
     C                     MOVEL*BLANK    P1GWST           Header Status
     C                     MOVEL*BLANK    P1GXST           Header Status L
     C                     MOVEL*BLANK    P1GYST           Order Type Prin
     C                     Z-ADD*ZERO     P1AODT           Scheduled Ship
     C                     MOVEL*BLANK    P1AIVN           User Original E
     C                     Z-ADD*ZERO     P1CXDT           Date of Origina
     C                     MOVEL*BLANK    P1XIST           Credit Hold
     C                     MOVEL*BLANK    P1XJST           Production Hold
     C                     MOVEL*BLANK    P1XKST           New Customer Ho
     C                     Z-ADD*ZERO     P1RMNB           Load ID
     C                     MOVEL*BLANK    P1U0ST           Price Audit
     C                     MOVEL*BLANK    P1U1ST           Price Status
     C                     MOVEL*BLANK    P1U2ST           Export Status
     C                     MOVEL*BLANK    P1VEST           Palletize
     C                     MOVEL*BLANK    P1U4ST           Load Plan Order
     C                     MOVEL*BLANK    P1R4CD           Sales Route Cod
     C                     MOVEL*BLANK    P1Z1ST           Modified Flag
     C                     Z-ADD*ZERO     P1VRVA           A/R order Value
     C                     MOVEL*BLANK    P1BCST           Block Order Fla
     C                     Z-ADD*ZERO     P2BTC7           Parent Customer
     C                     MOVEL*BLANK    P2K6ST           Credit Check A/
     C                     MOVEL*BLANK    P2UZST           Credit Check Pa
     C                     Z-ADD*ZERO     P2S2NB           Parent Credit L
     C                     Z-ADD*ZERO     P2VHVA           A/R Credit Limi
     C                     MOVEL*BLANK    P3OAST           Processing Cycl
     C                     MOVEL*BLANK    P3OBST           Billing Activit
     C                     MOVEL*BLANK    P3OFST           Affect Sales Do
     C                     MOVEL*BLANK    P4IDST           USR Order Credi
     C                     Z-ADD*ZERO     P4JSVA           USR Order Value
     C                     Z-ADD*ZERO     P4AYWG           USR Order Weigh
     C                     Z-ADD*ZERO     P4J0VA           USR Order Value
     C                     MOVEL*BLANK    P4W7ST           USR New Order
     C                     Z-ADD*ZERO     P4HOQT           USR Quantity Ch
     C                     MOVEL*BLANK    P4XPST           USR Production
     C                     MOVEL*BLANK    P4XOST           USR Credit Hold
     C                     MOVEL*BLANK    P4QUST           USR New Custome
     C                     MOVEL*BLANK    P4O1ST           Live with TPM
     C                     MOVEL*BLANK    P5R4ST           USR Update Flag
     C                     MOVEL*BLANK    P6D8ST           Credit Hold Sta
     C                     MOVEL*BLANK    P8PKST           Load Status
      *
      * Initialise indicators for re-entry
     C                     MOVE '0'       *IN
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAAXNB           Current Account
     C                     Z-ADD*ZERO     WANGNB           Current Account
     C                     Z-ADD*ZERO     WABZNB           OM Week
     C                     Z-ADD*ZERO     WAC5NB           Next Order Numb
     C                     Z-ADD*ZERO     WAC3NB           Next Invoice Nu
     C                     Z-ADD*ZERO     WACYNB           Next Credit Mem
     C                     Z-ADD*ZERO     WAIONB           Next Charge Bac
     C                     Z-ADD*ZERO     WAI6NB           Next On Acct Ca
     C                     Z-ADD*ZERO     WADCNB           Next Voucher Nu
     C                     Z-ADD*ZERO     WAC7NB           Next Customer #
     C                     Z-ADD*ZERO     WAC2NB           Next Inventory
     C                     Z-ADD*ZERO     WAC1NB           Next PFS Batch
     C                     Z-ADD*ZERO     WAL8NB           Next Contract/P
     C                     Z-ADD*ZERO     WABANB           Next HPB Batch
     C                     Z-ADD*ZERO     WAAIPC           Manual Price Ac
     C                     Z-ADD*ZERO     WAASPC           CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WAA2VA           Late Charge Min
     C                     Z-ADD*ZERO     WAAADY           A/P Aging Days
     C                     Z-ADD*ZERO     WAABDY           A/P Aging Days
     C                     Z-ADD*ZERO     WAACDY           A/P Aging Days
     C                     Z-ADD*ZERO     WAADDY           A/P Aging Days
     C                     Z-ADD*ZERO     WAAEDY           A/R Aging Days
     C                     Z-ADD*ZERO     WAAFDY           A/R Aging Days
     C                     Z-ADD*ZERO     WAAGDY           A/R Aging Days
     C                     Z-ADD*ZERO     WAAHDY           A/R Aging Days
     C                     Z-ADD*ZERO     WAAENB           Retention Perio
     C                     Z-ADD*ZERO     WAALNB           Retention Perio
     C                     Z-ADD*ZERO     WAEVNB           Retention Perio
     C                     Z-ADD*ZERO     WARPOP           Retention Perio
     C                     Z-ADD*ZERO     WADWNB           Retention Perio
     C                     Z-ADD*ZERO     WAR3NB           Next Load ID
     C                     Z-ADD*ZERO     WAR4NB           Next Item Numbe
     C                     Z-ADD*ZERO     WASCNB           Production Numb
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Unused Parm - CD7     USR
     C                     Z-ADD*ZERO     WUY4CD  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A/R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WBNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WBNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WBNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WBNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WBBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WBBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WCRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WCFLAM           Flat Amount
     C                     Z-ADD*ZERO     WCRRNB           Total Stops
     C                     Z-ADD*ZERO     WCSBNB           BOL Time
     C                     Z-ADD*ZERO     WCSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCSDNB           Number Pallets
     C                     Z-ADD*ZERO     WCPAOU           Number Pallets
     C                     Z-ADD*ZERO     WCDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WCSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WCHADT           Actual Arrival
     C                     Z-ADD*ZERO     WCAART           Actual Arrival
     C                     Z-ADD*ZERO     WCDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WCDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WCAQDT           Actual Departur
     C                     Z-ADD*ZERO     WCS6NB           Departure Time
     C                     Z-ADD*ZERO     WCT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WCPRTM           Product Tempera
     C                     Z-ADD*ZERO     WCNPSV           Number Spacers
     C                     Z-ADD*ZERO     WCTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WCGRWE           Gross Weight
     C                     Z-ADD*ZERO     WCF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WCJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WCTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WCJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WCSPTM           Spotted Time
     C                     Z-ADD*ZERO     WCJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WCLFTM           Load Finished T
     C                     Z-ADD*ZERO     WCJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WCBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WCJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WCBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WCKIDT           Truck Departure
     C                     Z-ADD*ZERO     WCASTM           Truck Departure
     C                     Z-ADD*ZERO     WCKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WCAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WCVOAG           Voyage
     C                     Z-ADD*ZERO     WCKBDT           Sail Date
     C                     Z-ADD*ZERO     WCEFDT           Arrival Date
     C                     Z-ADD*ZERO     WCKCDT           Date In
     C                     Z-ADD*ZERO     WCTMIN           Time In
     C                     Z-ADD*ZERO     WCKDDT           Date Out
     C                     Z-ADD*ZERO     WCVMNB           Time Out
     C                     Z-ADD*ZERO     WCOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WCKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WCATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WCBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WCEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WCKKDT           On Yard Date
     C                     Z-ADD*ZERO     WCAVTM           On Yard Time
     C                     Z-ADD*ZERO     WCKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WCAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WCLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WCK0DT           Product Complet
     C                     Z-ADD*ZERO     WCAYTM           Product Complet
     C                     Z-ADD*ZERO     WCKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WCICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WCIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WCK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WCAZTM           Load Door 1
     C                     Z-ADD*ZERO     WCK2DT           Override Total
     C                     Z-ADD*ZERO     WCA0TM           Load Door 2
     C                     Z-ADD*ZERO     WCZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WCPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WCCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WCPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WCCLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WCP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WCCMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WCP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WCCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WCP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WCCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WCP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WCCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDDPNB           Order Sequence
     C                     Z-ADD*ZERO     WDUENB           Order Secondary
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WDMAVA           Billing Detail
     C                     Z-ADD*ZERO     WDKDVA           Billing Detail
     C                     Z-ADD*ZERO     WDL8VA           Billing Detail
     C                     Z-ADD*ZERO     WDL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WDAYVA           Extended Amount
     C                     Z-ADD*ZERO     WDEXDT           Market Pricing
     C                     Z-ADD*ZERO     WDBZPR           Price Overage O
     C                     Z-ADD*ZERO     WDL6NB           Contract Number
     C                     Z-ADD*ZERO     WDGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WDD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WDCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WDAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WDCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WDATWG           Weight Shipped
     C                     Z-ADD*ZERO     WDAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WDAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WDAKPR           Unit Price
     C                     Z-ADD*ZERO     WDALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WDAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WDAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WDA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WDB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WDA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WDNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WDNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WDNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WDNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WDNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WDBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WDBVTM           Price Code
     C                     Z-ADD*ZERO     WDBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WDBXTM           Substitution Li
     C                     Z-ADD*ZERO     WDBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WDH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WDH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WDH7NX           OD Item Target
     C                     Z-ADD*ZERO     WDH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WDH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WDDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WDDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WDDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WDDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WDDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WDGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WDGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WDGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WDPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WDRINY           Item Age Days
     C                     Z-ADD*ZERO     WDTIDT           Production Ovr
     C                     Z-ADD*ZERO     WDTJDT           Production Ovr
     C                     Z-ADD*ZERO     WDTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WDTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WDTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFP3NB           D & B Number
     C                     Z-ADD*ZERO     WFI6DT           Date of D & B R
     C                     Z-ADD*ZERO     WFAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WFANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WFBTC7           Parent Customer
     C                     Z-ADD*ZERO     WFS2NB           Parent Credit L
     C                     Z-ADD*ZERO     WFVHVA           A/R Credit Limi
     C                     Z-ADD*ZERO     WFI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGRMNB           Load ID
     C                     Z-ADD*ZERO     WGRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WGRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WGRWNB           Miles to next s
     C                     Z-ADD*ZERO     WGRXNB           Freight Charge
     C                     Z-ADD*ZERO     WGSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WGT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WGT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WGR1NB           Rated Freight
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGC4NB           Order Number
     C                     Z-ADD*ZERO     WGKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WGSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WGKFDT           Appointment Con
     C                     Z-ADD*ZERO     WGACTM           Appointment Con
     C                     Z-ADD*ZERO     WGEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WGAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WGKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WGATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WGHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WGAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WGKKDT           On Yard Date
     C                     Z-ADD*ZERO     WGAVTM           On Yard Time
     C                     Z-ADD*ZERO     WGZ4NB           MPC Number
     C                     Z-ADD*ZERO     WGN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WGN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WGN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WGB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WGB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WGB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WIBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WIBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WIBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WIBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Define work field Ship To Name
     C                     MOVEL*BLANK    WUBRTX 30
      * Define work field Ship To City
     C                     MOVEL*BLANK    WUHNNA 20
      * Define work field Total Load Miles
     C                     Z-ADD*ZERO     WUTLMI  70
      * Define work field Override Total Load Miles
     C                     Z-ADD*ZERO     WUK2DT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKMILE           Miles to First
     C                     Z-ADD*ZERO     WKHRRQ           Hours Required
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field USR Hours 5.0
     C                     Z-ADD*ZERO     WU      50
      * Define work field @Numeric 6,0
     C                     Z-ADD*ZERO     WUPINB  60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOK4DT           Created Date
     C                     Z-ADD*ZERO     WOA1TM           Created Time
     C                     Z-ADD*ZERO     WODXNB           Sequence Number
     C                     Z-ADD*ZERO     WORMNB           Load ID
     C                     Z-ADD*ZERO     WORVNB           Stop/Drop
     C                     Z-ADD*ZERO     WOAIC3           Company Number
     C                     Z-ADD*ZERO     WOC4NB           Order Number
      * Define work field Blank for 4           USR
     C                     MOVEL*BLANK    WUOTTX  4
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRAIC3           Company Number
     C                     Z-ADD*ZERO     WRANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WRAGVA           Age $ Due - Cur
     C                     Z-ADD*ZERO     WRACVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WRADVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WRAEVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WRAFVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WRAHVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WRVIVA           Age $ Due-Curre
     C                     Z-ADD*ZERO     WRVJVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WRVKVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WRVLVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WRVMVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WRVNVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WREEVA           Value of Open O
     C                     Z-ADD*ZERO     WRAKTM           Time of Last Ag
     C                     Z-ADD*ZERO     WRAHDT           Date of First S
     C                     Z-ADD*ZERO     WRANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WRANVA           Amount of Last
     C                     Z-ADD*ZERO     WRALDT           Date of Last Pa
     C                     Z-ADD*ZERO     WRAMVA           Amount of Last
     C                     Z-ADD*ZERO     WRAIDT           Date of Highest
     C                     Z-ADD*ZERO     WRALVA           Amount of Highe
     C                     Z-ADD*ZERO     WRDJNB           Number of Invoi
     C                     Z-ADD*ZERO     WRDLNB           Number of Order
     C                     Z-ADD*ZERO     WRDDNB           Number of Credi
     C                     Z-ADD*ZERO     WRDMNB           Number of Payme
     C                     Z-ADD*ZERO     WRDUDT           Date of Last Ag
     C                     Z-ADD*ZERO     WRLYNO           Last YTD Nbr of
     C                     Z-ADD*ZERO     WRLYNC           Last YTD Nbr of
     C                     Z-ADD*ZERO     WRLYNP           Last YTD Nbr of
     C                     Z-ADD*ZERO     WRLYNI           Last YTD Nbr of
     C                     Z-ADD*ZERO     WRADPM           MTD Invoices Pa
     C                     Z-ADD*ZERO     WRVOVA           YTD Invoices Pa
     C                     Z-ADD*ZERO     WRBTDY           MTD Days Paid
     C                     Z-ADD*ZERO     WRBUDY           YTD Days Paid
     C                     Z-ADD*ZERO     WRVPVA           YTD Sales Invoi
     C                     Z-ADD*ZERO     WRVQVA           Last Year Sales
     C                     Z-ADD*ZERO     WRCUMO           Current Month
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Define work field @Numeric 15.2
     C                     Z-ADD*ZERO     WUNM15 152
      * Define work field Substituted Flag
     C                     MOVEL*BLANK    WUZ3ST  1
      * Define work field Detail Line Status Last
     C                     MOVEL*BLANK    WUGNST  1
      * Define work field Detail Line Status
     C                     MOVEL*BLANK    WUGMST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WWY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WWQEDT           PFS Last Update
     C                     Z-ADD*ZERO     WWCUTM           PFS Last Update
     C                     Z-ADD*ZERO     WWB0NY           PFS Hours Betwe
     C                     Z-ADD*ZERO     WWB1NY           PFS Minutes Btw
     C                     Z-ADD*ZERO     WWUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WWAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WWAINY           PFS Create Time
     C                     Z-ADD*ZERO     WWAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WWAKNY           PFS Change time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WXA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WXAIC3           Company Number
     C                     Z-ADD*ZERO     WXC4NB           Order Number
     C                     Z-ADD*ZERO     WXN2DT           Ham Group Produ
     C                     Z-ADD*ZERO     WXJDNX           Ham Group Proce
     C                     Z-ADD*ZERO     WXKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WXAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WXAATM           Job Time
     C                     Z-ADD*ZERO     WXAXDT           Job Date
      * Clear all neither parameters
      * CRT Ham Group/Order    CR - Ham Group/Order  * 
     C                     Z-ADD*ZERO     WYAATM           Job Time
     C                     Z-ADD*ZERO     WYAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TBA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     TBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     TBAATM           Job Time
     C                     Z-ADD*ZERO     TBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TCAATM           Job Time
     C                     Z-ADD*ZERO     TCAXDT           Job Date
      * Clear all neither parameters
      * CRT A/R Summary        CR - A/R Summary  * 
     C                     Z-ADD*ZERO     TEAATM           Job Time
     C                     Z-ADD*ZERO     TEAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WA05 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA04 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA03 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA02 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA   152       *Synon (15,2) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  70
     C                     MOVEL*BLANK    WL0002  1
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0003  70
     C                     Z-ADD*ZERO     WL0004  70
     C                     MOVEL*BLANK    WL0005  1
     C                     MOVEL*BLANK    WL0006  1
     C                     Z-ADD*ZERO     WL0007 112
     C                     Z-ADD*ZERO     WL0008 112
      * Define local variables for subroutine SQRVGN.
     C                     Z-ADD*ZERO     WL0009  70
     C                     Z-ADD*ZERO     WL0010  50
     C                     Z-ADD*ZERO     WL0011  70
     C                     Z-ADD*ZERO     WL0012  50
      * Define local variables for subroutine SWRVGN.
     C                     Z-ADD*ZERO     WL0013  30
     C                     Z-ADD*ZERO     WL0014  70
     C                     Z-ADD*ZERO     WL0015  70
     C                     Z-ADD*ZERO     WL0016  60
      * Define local variables for subroutine SZRVGN.
     C                     Z-ADD*ZERO     WL0017  70
     C                     Z-ADD*ZERO     WL0018 152
      * Define local variables for subroutine THRVGN.
     C                     Z-ADD*ZERO     WL0019  30
     C                     MOVEL*BLANK    WL0020  6
     C                     MOVEL*BLANK    WL0021  1
     C                     MOVEL*BLANK    WL0022  1
      * Define local variables for subroutine TJCHRC.
     C                     Z-ADD*ZERO     WL0023  30
     C                     Z-ADD*ZERO     WL0024  70
     C                     Z-ADD*ZERO     WL0025  30
     C                     Z-ADD*ZERO     WL0026  30
     C                     Z-ADD*ZERO     WL0027  70
     C                     Z-ADD*ZERO     WL0028 114
     C                     Z-ADD*ZERO     WL0029 114
      * Define local variables for subroutine TURVGN.
     C                     Z-ADD*ZERO     WL0030  30
     C                     Z-ADD*ZERO     WL0031  70
      * Define local work field Plant Company Sts
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Company Organization
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Load Status
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Order Type - Sales
     C                     MOVEL*BLANK    YL0004  2
      * Define local work field A/R Customer Number
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0006  70
      * Define local work field Ship To Name
     C                     MOVEL*BLANK    YL0007 30
      * Define local work field Ship To Address Line 1
     C                     MOVEL*BLANK    YL0008 30
      * Define local work field Ship To Address Line 2
     C                     MOVEL*BLANK    YL0009 30
      * Define local work field Ship To Address Line 3
     C                     MOVEL*BLANK    YL0010 30
      * Define local work field Ship To City
     C                     MOVEL*BLANK    YL0011 20
      * Define local work field Ship To State Code
     C                     MOVEL*BLANK    YL0012  2
      * Define local work field Ship To Zip/Postal Code
     C                     MOVEL*BLANK    YL0013 11
      * Define local work field Bill to Customer
     C                     Z-ADD*ZERO     YL0014  70
      * Define local work field Bill to Name
     C                     MOVEL*BLANK    YL0015 30
      * Define local work field Bill to Address Line 1
     C                     MOVEL*BLANK    YL0016 30
      * Define local work field Bill to Address Line 2
     C                     MOVEL*BLANK    YL0017 30
      * Define local work field Bill to Address Line 3
     C                     MOVEL*BLANK    YL0018 30
      * Define local work field Bill to City
     C                     MOVEL*BLANK    YL0019 20
      * Define local work field Bill to State Code
     C                     MOVEL*BLANK    YL0020  2
      * Define local work field Bill to Zip/Postal Code
     C                     MOVEL*BLANK    YL0021 11
      * Define local work field Customer Purchase Order #
     C                     MOVEL*BLANK    YL0022 15
      * Define local work field Order Date
     C                     Z-ADD*ZERO     YL0023  70
      * Define local work field Requested Ship Date
     C                     Z-ADD*ZERO     YL0024  70
      * Define local work field Actual Shipped Date
     C                     Z-ADD*ZERO     YL0025  70
      * Define local work field Cancel Date
     C                     Z-ADD*ZERO     YL0026  70
      * Define local work field Terms Code
     C                     MOVEL*BLANK    YL0027  2
      * Define local work field Special Instructions
     C                     MOVEL*BLANK    YL0028 40
      * Define local work field Special Instructions 2
     C                     MOVEL*BLANK    YL0029 40
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0030  3
      * Define local work field Comment Print Acknowledge
     C                     MOVEL*BLANK    YL0031  1
      * Define local work field Comment Print Inv/Cr.Memo
     C                     MOVEL*BLANK    YL0032  1
      * Define local work field Comment Print Pick Slip
     C                     MOVEL*BLANK    YL0033  1
      * Define local work field Comment Print Ship Doc
     C                     MOVEL*BLANK    YL0034  1
      * Define local work field Reason Code
     C                     MOVEL*BLANK    YL0035  3
      * Define local work field Order in Use
     C                     MOVEL*BLANK    YL0036  1
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0037  1
      * Define local work field Header Status Last
     C                     MOVEL*BLANK    YL0038  1
      * Define local work field Order Type Print Status
     C                     MOVEL*BLANK    YL0039  1
      * Define local work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YL0040  70
      * Define local work field User Original Entry
     C                     MOVEL*BLANK    YL0041 10
      * Define local work field Date of Original Entry
     C                     Z-ADD*ZERO     YL0042  70
      * Define local work field Order Value Total
     C                     Z-ADD*ZERO     YL0043 112
      * Define local work field Order Weight Total
     C                     Z-ADD*ZERO     YL0044 112
      * Define local work field Credit Hold
     C                     MOVEL*BLANK    YL0045  1
      * Define local work field Production Hold
     C                     MOVEL*BLANK    YL0046  1
      * Define local work field New Customer Hold
     C                     MOVEL*BLANK    YL0047  1
      * Define local work field Requested Delivery Date
     C                     Z-ADD*ZERO     YL0048  70
      * Define local work field Requested Delivery Time
     C                     Z-ADD*ZERO     YL0049  40
      * Define local work field Accounts Receiv. Ent 1
     C                     MOVEL*BLANK    YL0050  4
      * Define local work field Accounts Receiv. Ent 2
     C                     MOVEL*BLANK    YL0051 12
      * Define local work field Load ID
     C                     Z-ADD*ZERO     YL0052  70
      * Define local work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YL0053  52
      * Define local work field Rated Freight
     C                     Z-ADD*ZERO     YL0054 112
      * Define local work field LTL Flag
     C                     MOVEL*BLANK    YL0055  1
      * Define local work field Price Audit
     C                     MOVEL*BLANK    YL0056  1
      * Define local work field Price Status
     C                     MOVEL*BLANK    YL0057  1
      * Define local work field Shipping Method
     C                     MOVEL*BLANK    YL0058  2
      * Define local work field Export Status
     C                     MOVEL*BLANK    YL0059  1
      * Define local work field Palletize
     C                     MOVEL*BLANK    YL0060  1
      * Define local work field Shrink Wrap
     C                     MOVEL*BLANK    YL0061  1
      * Define local work field Slip Sheet
     C                     MOVEL*BLANK    YL0062  1
      * Define local work field Age Code
     C                     MOVEL*BLANK    YL0063  1
      * Define local work field Reefer Temperature
     C                     Z-ADD*ZERO     YL0064  52
      * Define local work field Load Type
     C                     MOVEL*BLANK    YL0065  1
      * Define local work field Attach to Invoice Number
     C                     Z-ADD*ZERO     YL0066  70
      * Define local work field Load Plan Order
     C                     MOVEL*BLANK    YL0067  1
      * Define local work field Print Pick Slip
     C                     MOVEL*BLANK    YL0068  1
      * Define local work field Resell Reference Number
     C                     Z-ADD*ZERO     YL0069  70
      * Define local work field Special Comment 1
     C                     MOVEL*BLANK    YL0070 30
      * Define local work field Special Comment 2
     C                     MOVEL*BLANK    YL0071 30
      * Define local work field Affect Auto Accruals
     C                     MOVEL*BLANK    YL0072  1
      * Define local work field Sales Route Code
     C                     MOVEL*BLANK    YL0073  3
      * Define local work field Manager Level Code
     C                     MOVEL*BLANK    YL0074  2
      * Define local work field VP Level Code
     C                     MOVEL*BLANK    YL0075  3
      * Define local work field Attach to Order Number
     C                     Z-ADD*ZERO     YL0076  70
      * Define local work field Reason for Price Audit
     C                     MOVEL*BLANK    YL0077  3
      * Define local work field Invoice Number
     C                     Z-ADD*ZERO     YL0078  70
      * Define local work field Invoice Suffix
     C                     MOVEL*BLANK    YL0079  2
      * Define local work field Invoice Date
     C                     Z-ADD*ZERO     YL0080  70
      * Define local work field Event Code
     C                     MOVEL*BLANK    YL0081  2
      * Define local work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    YL0082  1
      * Define local work field Modified Flag
     C                     MOVEL*BLANK    YL0083  1
      * Define local work field A/R order Value Total
     C                     Z-ADD*ZERO     YL0084 112
      * Define local work field Billing Activity Type
     C                     MOVEL*BLANK    YL0085  1
      * Define local work field Block Order Flag
     C                     MOVEL*BLANK    YL0086  1
      * Define local work field Order Certification Flag
     C                     MOVEL*BLANK    YL0087  1
      * Define local work field Invoice Order Value Tot
     C                     Z-ADD*ZERO     YL0088 112
      * Define local work field Process Sts for 3C
     C                     MOVEL*BLANK    YL0089  1
      * Define local work field Order Conf Fax Sts
     C                     MOVEL*BLANK    YL0090  1
      * Define local work field Manifest Fax Sts
     C                     MOVEL*BLANK    YL0091  1
      * Define local work field Invoice Fax Sts
     C                     MOVEL*BLANK    YL0092  1
      * Define local work field Transfer in Storage Ind
     C                     MOVEL*BLANK    YL0093  1
      * Define local work field Email Cust On Order Ship
     C                     MOVEL*BLANK    YL0094  1
      * Define local work field Order Emailed
     C                     MOVEL*BLANK    YL0095  1
      * Define local work field Export Docs Go w/Driver
     C                     MOVEL*BLANK    YL0096  1
      * Define local work field Shipping Temp Code C/F
     C                     MOVEL*BLANK    YL0097  1
      * Define local work field Broker Order Status
     C                     MOVEL*BLANK    YL0098  1
      * Define local work field Air Freight Order
     C                     MOVEL*BLANK    YL0099  1
      * Define local work field Order Requires Review
     C                     MOVEL*BLANK    YL0100  2
      * Define local work field OH Load Plan Ready
     C                     MOVEL*BLANK    YL0101  2
      * Define local work field Export USDA Approved
     C                     MOVEL*BLANK    YL0102  2
      * Define local work field HPB Ship to Warehouse
     C                     MOVEL*BLANK    YL0103  3
      * Define local work field OH TF Exempt Code
     C                     MOVEL*BLANK    YL0104  3
      * Define local work field OH Appt Confirmation Dt
     C                     Z-ADD*ZERO     YL0105  70
      * Define local work field JPN Invoice Issuance Date
     C                     Z-ADD*ZERO     YL0106  70
      * Define local work field Load Actual Shipped Date
     C                     Z-ADD*ZERO     YL0107  70
      * Define local work field Load BOL Complete Date
     C                     Z-ADD*ZERO     YL0108  70
      * Define local work field Load Truck Departure Date
     C                     Z-ADD*ZERO     YL0109  70
      * Define local work field Maximum Gross Weight
     C                     Z-ADD*ZERO     YL0110  60
      * Define local work field Time of Original Entry
     C                     Z-ADD*ZERO     YL0111  60
      * Define local work field OH Appt Confirmation Tm
     C                     Z-ADD*ZERO     YL0112  60
      * Define local work field Load BOL Complete Time
     C                     Z-ADD*ZERO     YL0113  60
      * Define local work field Load Truck Departure Time
     C                     Z-ADD*ZERO     YL0114  60
      * Define local work field Act Frt Reference Amount
     C                     Z-ADD*ZERO     YL0115 112
      * Define local work field Act Non-Ref Frt Amount
     C                     Z-ADD*ZERO     YL0116 112
      * Define local work field OH Fuel Surcharge Amount
     C                     Z-ADD*ZERO     YL0117 112
      * Define local work field OH Total Non-Ref Frt Amt
     C                     Z-ADD*ZERO     YL0118 112
      * Define local work field OH Total Ref Frt Amt
     C                     Z-ADD*ZERO     YL0119 112
      * Define local work field Claim Number
     C                     Z-ADD*ZERO     YL0120  70
      * Define local work field EDI Status 1
     C                     MOVEL*BLANK    YL0121  1
      * Define local work field EDI Status 2
     C                     MOVEL*BLANK    YL0122  1
      * Define local work field EDI Status 3
     C                     MOVEL*BLANK    YL0123  1
      * Define local work field Job Time
     C                     Z-ADD*ZERO     YL0124  60
      * Define local work field User Id
     C                     MOVEL*BLANK    YL0125 10
      * Define local work field Job Name
     C                     MOVEL*BLANK    YL0126 10
      * Define local work field Job Date
     C                     Z-ADD*ZERO     YL0127  70
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0128  3
      * Define local work field Order Line Error Type
     C                     MOVEL*BLANK    YL0129  3
      * Define local work field Deadline Departure Date
     C                     Z-ADD*ZERO     YL0130  70
      * Define local work field Deadline Departure Time
     C                     Z-ADD*ZERO     YL0131  60
      * Define local work field USR Update Flag
     C                     MOVEL*BLANK    YL0132  1
      * Define local work field MG Created Load
     C                     MOVEL*BLANK    YL0133  1
      * Define null work field Ship To State Code
     C                     MOVEL*BLANK    YN0001  2
      * Define local work field Shipping Method
     C                     MOVEL*BLANK    YL0134  2
      * Define local work field Hours Required
     C                     Z-ADD*ZERO     YL0135  51
      * Define local work field Additional Route Hours
     C                     Z-ADD*ZERO     YL0136  50
      * Define local work field Status - Y or N
     C                     MOVEL*BLANK    YL0137  1
      * Define local work field Item Age Days
     C                     Z-ADD*ZERO     YL0138  40
      * Define local work field Order Line Error Type
     C                     MOVEL*BLANK    YL0139  3
      * Define local work field Status Flag 20 Y/N
     C                     MOVEL*BLANK    YL0140  1
      * Define local work field Deadline Depart DT    HDR
     C                     Z-ADD*ZERO     YL0141  70
      * Define local work field Deadline Depart Time  HDR
     C                     Z-ADD*ZERO     YL0142  60
      * Define local work field PFS AccuSort Active
     C                     MOVEL*BLANK    YL0143  1
      * Define local work field PFS Carlisle Active
     C                     MOVEL*BLANK    YL0144  1
      * Define local work field Load Status
     C                     MOVEL*BLANK    YL0145  1
      * Define local work field Load ID
     C                     Z-ADD*ZERO     YL0146  70
      * Define local work field USR From Date Numeric
     C                     Z-ADD*ZERO     YL0147  70
      * Define null work field Affect Inventory Default
     C                     MOVEL*BLANK    YN0002  1
      * Define null work field Affect Sales Pnds Default
     C                     MOVEL*BLANK    YN0003  1
      * Define null work field Warehouse Code
     C                     MOVEL*BLANK    YN0004  3
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0148  30
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0149  30
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0003
