     H/TITLE Read rcds Purge-Fresh  XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 04/24/20  Time  : 15:34:34
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPOB2CPL4IF  E           K        DISK
      * RSQ : Product Trace             Prod date(D), Order>0
      *
     FPOB3CPL1IF  E           K        DISK
      * RTV : Farm Site Summary         Retrieval index
      *
     FPOB2CPRGIF  E           K        DISK                      A
      * UPD : Product Trace             Update Index for Purge
      *
     FPOB2CPL0UF  E           K        DISK
      * UPD : Product Trace             Update index
      *
     FPOB3CPL2IF  E           K        DISK                      A
      * UPD : Farm Site Summary         Update Index for Purge
      *
     FPOB3CPL0UF  E           K        DISK
      * UPD : Farm Site Summary         Update index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@B2CPOO
      * Product Trace             Prod date(D), Order>0
      * Renamed input format fields
     I              B2AIC3                          WAAIC3
     I              B2PFNX                          WAPFNX
     I              B2AADX                          WAAADX
     I              B2B9TM                          WAB9TM
     I              B2ADDX                          WAADDX
     I              B2ABDX                          WAABDX
     I              B2CATM                          WACATM
     I              B2MNSX                          WAMNSX
     I              B2JOWG                          WAJOWG
     I              B2JPWG                          WAJPWG
     I              B2MOSX                          WAMOSX
     I              B2DNAA                          WADNAA
     I              B2PGNX                          WAPGNX
     I              B2BTT1                          WABTT1
     I              B2D7C7                          WAD7C7
     I              B2PYNA                          WAPYNA
     I              B2PZNA                          WAPZNA
     I              B2MPSX                          WAMPSX
     I              B2CCT1                          WACCT1
     I              B2PHNX                          WAPHNX
     I              B2MQSX                          WAMQSX
     I              B2DOAA                          WADOAA
     I              B2BUT1                          WABUT1
     I              B2DYAA                          WADYAA
     I              B2BVT1                          WABVT1
     I              B2DPAA                          WADPAA
     I              B2DQAA                          WADQAA
     I              B2BZT1                          WABZT1
     I              B2BWT1                          WABWT1
     I              B2DRAA                          WADRAA
     I              B2B9T1                          WAB9T1
     I              B2DSAA                          WADSAA
     I              B2B8T1                          WAB8T1
     I              B2D4AA                          WAD4AA
     I              B2EPAA                          WAEPAA
     I              B2EQAA                          WAEQAA
     I              B2ERAA                          WAERAA
     I              B2ESAA                          WAESAA
     I              B2PNSX                          WAPNSX
     I              B2UFNX                          WAUFNX
     I              B2UGNX                          WAUGNX
     I              B2UHNX                          WAUHNX
     I              B2AGDX                          WAAGDX
     I              B2CGTM                          WACGTM
     I              B2POSX                          WAPOSX
     I              B2PPSX                          WAPPSX
     I              B2UINX                          WAUINX
     I              B2UJNX                          WAUJNX
     I              B2UKNX                          WAUKNX
     I              B2ULNX                          WAULNX
     I              B2PRSX                          WAPRSX
     I              B2PSSX                          WAPSSX
     I              B2AATM                          WAAATM
     I              B2AYNA                          WAAYNA
     I              B2A0NA                          WAA0NA
     I              B2AXDT                          WAAXDT
      *
     I@B2CPON
      * Product Trace             Update Index for Purge
      * Renamed input format fields
     I              B2AIC3                          WBAIC3
     I              B2PFNX                          WBPFNX
     I              B2AADX                          WBAADX
     I              B2B9TM                          WBB9TM
     I              B2ADDX                          WBADDX
     I              B2ABDX                          WBABDX
     I              B2CATM                          WBCATM
     I              B2MNSX                          WBMNSX
     I              B2JOWG                          WBJOWG
     I              B2JPWG                          WBJPWG
     I              B2MOSX                          WBMOSX
     I              B2DNAA                          WBDNAA
     I              B2PGNX                          WBPGNX
     I              B2BTT1                          WBBTT1
     I              B2D7C7                          WBD7C7
     I              B2PYNA                          WBPYNA
     I              B2PZNA                          WBPZNA
     I              B2MPSX                          WBMPSX
     I              B2CCT1                          WBCCT1
     I              B2PHNX                          WBPHNX
     I              B2MQSX                          WBMQSX
     I              B2DOAA                          WBDOAA
     I              B2BUT1                          WBBUT1
     I              B2DYAA                          WBDYAA
     I              B2BVT1                          WBBVT1
     I              B2DPAA                          WBDPAA
     I              B2DQAA                          WBDQAA
     I              B2BZT1                          WBBZT1
     I              B2BWT1                          WBBWT1
     I              B2DRAA                          WBDRAA
     I              B2B9T1                          WBB9T1
     I              B2DSAA                          WBDSAA
     I              B2B8T1                          WBB8T1
     I              B2D4AA                          WBD4AA
     I              B2EPAA                          WBEPAA
     I              B2EQAA                          WBEQAA
     I              B2ERAA                          WBERAA
     I              B2ESAA                          WBESAA
     I              B2PNSX                          WBPNSX
     I              B2UFNX                          WBUFNX
     I              B2UGNX                          WBUGNX
     I              B2UHNX                          WBUHNX
     I              B2AGDX                          WBAGDX
     I              B2CGTM                          WBCGTM
     I              B2POSX                          WBPOSX
     I              B2PPSX                          WBPPSX
     I              B2UINX                          WBUINX
     I              B2UJNX                          WBUJNX
     I              B2UKNX                          WBUKNX
     I              B2ULNX                          WBULNX
     I              B2PRSX                          WBPRSX
     I              B2PSSX                          WBPSSX
     I              B2AATM                          WBAATM
     I              B2AYNA                          WBAYNA
     I              B2A0NA                          WBA0NA
     I              B2AXDT                          WBAXDT
      *
     I@B2CPMP
      * Product Trace             Update index
      * Renamed input format fields
     I              B2AIC3                          WCAIC3
     I              B2PFNX                          WCPFNX
     I              B2AADX                          WCAADX
     I              B2B9TM                          WCB9TM
     I              B2ADDX                          WCADDX
     I              B2ABDX                          WCABDX
     I              B2CATM                          WCCATM
     I              B2MNSX                          WCMNSX
     I              B2JOWG                          WCJOWG
     I              B2JPWG                          WCJPWG
     I              B2MOSX                          WCMOSX
     I              B2DNAA                          WCDNAA
     I              B2PGNX                          WCPGNX
     I              B2BTT1                          WCBTT1
     I              B2D7C7                          WCD7C7
     I              B2PYNA                          WCPYNA
     I              B2PZNA                          WCPZNA
     I              B2MPSX                          WCMPSX
     I              B2CCT1                          WCCCT1
     I              B2PHNX                          WCPHNX
     I              B2MQSX                          WCMQSX
     I              B2DOAA                          WCDOAA
     I              B2BUT1                          WCBUT1
     I              B2DYAA                          WCDYAA
     I              B2BVT1                          WCBVT1
     I              B2DPAA                          WCDPAA
     I              B2DQAA                          WCDQAA
     I              B2BZT1                          WCBZT1
     I              B2BWT1                          WCBWT1
     I              B2DRAA                          WCDRAA
     I              B2B9T1                          WCB9T1
     I              B2DSAA                          WCDSAA
     I              B2B8T1                          WCB8T1
     I              B2D4AA                          WCD4AA
     I              B2EPAA                          WCEPAA
     I              B2EQAA                          WCEQAA
     I              B2ERAA                          WCERAA
     I              B2ESAA                          WCESAA
     I              B2PNSX                          WCPNSX
     I              B2UFNX                          WCUFNX
     I              B2UGNX                          WCUGNX
     I              B2UHNX                          WCUHNX
     I              B2AGDX                          WCAGDX
     I              B2CGTM                          WCCGTM
     I              B2POSX                          WCPOSX
     I              B2PPSX                          WCPPSX
     I              B2UINX                          WCUINX
     I              B2UJNX                          WCUJNX
     I              B2UKNX                          WCUKNX
     I              B2ULNX                          WCULNX
     I              B2PRSX                          WCPRSX
     I              B2PSSX                          WCPSSX
     I              B2AATM                          WCAATM
     I              B2AYNA                          WCAYNA
     I              B2A0NA                          WCA0NA
     I              B2AXDT                          WCAXDT
      *
     I@B3CPMT
      * Farm Site Summary         Retrieval index
      * Renamed input format fields
     I              B3DVAA                          WDDVAA
     I              B3ACDX                          WDACDX
     I              B3MRSX                          WDMRSX
     I              B3DTAA                          WDDTAA
     I              B3DZAA                          WDDZAA
     I              B3DUAA                          WDDUAA
     I              B3BYT1                          WDBYT1
     I              B3DWAA                          WDDWAA
     I              B3BXT1                          WDBXT1
     I              B3DXAA                          WDDXAA
     I              B3CBT1                          WDCBT1
     I              B3AATM                          WDAATM
     I              B3AYNA                          WDAYNA
     I              B3A0NA                          WDA0NA
     I              B3AXDT                          WDAXDT
      *
     I@B3CPL2
      * Farm Site Summary         Update Index for Purge
      * Renamed input format fields
     I              B3DVAA                          WEDVAA
     I              B3ACDX                          WEACDX
     I              B3MRSX                          WEMRSX
     I              B3DTAA                          WEDTAA
     I              B3DZAA                          WEDZAA
     I              B3DUAA                          WEDUAA
     I              B3BYT1                          WEBYT1
     I              B3DWAA                          WEDWAA
     I              B3BXT1                          WEBXT1
     I              B3DXAA                          WEDXAA
     I              B3CBT1                          WECBT1
     I              B3AATM                          WEAATM
     I              B3AYNA                          WEAYNA
     I              B3A0NA                          WEA0NA
     I              B3AXDT                          WEAXDT
      *
     I@B3CPMS
      * Farm Site Summary         Update index
      * Renamed input format fields
     I              B3DVAA                          WFDVAA
     I              B3ACDX                          WFACDX
     I              B3MRSX                          WFMRSX
     I              B3DTAA                          WFDTAA
     I              B3DZAA                          WFDZAA
     I              B3DUAA                          WFDUAA
     I              B3BYT1                          WFBYT1
     I              B3DWAA                          WFDWAA
     I              B3BXT1                          WFBXT1
     I              B3DXAA                          WFDXAA
     I              B3CBT1                          WFCBT1
     I              B3AATM                          WFAATM
     I              B3AYNA                          WFAYNA
     I              B3A0NA                          WFA0NA
     I              B3AXDT                          WFAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPOB21    E DSPOB2CPRG
      * UPD : Product Trace             Update Index for Purge
      * Renamed input format fields
     I              B2AIC3                          WBAIC3
     I              B2PFNX                          WBPFNX
     I              B2AADX                          WBAADX
     I              B2B9TM                          WBB9TM
     I              B2ADDX                          WBADDX
     I              B2ABDX                          WBABDX
     I              B2CATM                          WBCATM
     I              B2MNSX                          WBMNSX
     I              B2JOWG                          WBJOWG
     I              B2JPWG                          WBJPWG
     I              B2MOSX                          WBMOSX
     I              B2DNAA                          WBDNAA
     I              B2PGNX                          WBPGNX
     I              B2BTT1                          WBBTT1
     I              B2D7C7                          WBD7C7
     I              B2PYNA                          WBPYNA
     I              B2PZNA                          WBPZNA
     I              B2MPSX                          WBMPSX
     I              B2CCT1                          WBCCT1
     I              B2PHNX                          WBPHNX
     I              B2MQSX                          WBMQSX
     I              B2DOAA                          WBDOAA
     I              B2BUT1                          WBBUT1
     I              B2DYAA                          WBDYAA
     I              B2BVT1                          WBBVT1
     I              B2DPAA                          WBDPAA
     I              B2DQAA                          WBDQAA
     I              B2BZT1                          WBBZT1
     I              B2BWT1                          WBBWT1
     I              B2DRAA                          WBDRAA
     I              B2B9T1                          WBB9T1
     I              B2DSAA                          WBDSAA
     I              B2B8T1                          WBB8T1
     I              B2D4AA                          WBD4AA
     I              B2EPAA                          WBEPAA
     I              B2EQAA                          WBEQAA
     I              B2ERAA                          WBERAA
     I              B2ESAA                          WBESAA
     I              B2PNSX                          WBPNSX
     I              B2UFNX                          WBUFNX
     I              B2UGNX                          WBUGNX
     I              B2UHNX                          WBUHNX
     I              B2AGDX                          WBAGDX
     I              B2CGTM                          WBCGTM
     I              B2POSX                          WBPOSX
     I              B2PPSX                          WBPPSX
     I              B2UINX                          WBUINX
     I              B2UJNX                          WBUJNX
     I              B2UKNX                          WBUKNX
     I              B2ULNX                          WBULNX
     I              B2PRSX                          WBPRSX
     I              B2PSSX                          WBPSSX
     I              B2AATM                          WBAATM
     I              B2AYNA                          WBAYNA
     I              B2A0NA                          WBA0NA
     I              B2AXDT                          WBAXDT
      *
     IQPOB22    E DSPOB2CPL0
      * UPD : Product Trace             Update index
      * Renamed input format fields
     I              B2AIC3                          WCAIC3
     I              B2PFNX                          WCPFNX
     I              B2AADX                          WCAADX
     I              B2B9TM                          WCB9TM
     I              B2ADDX                          WCADDX
     I              B2ABDX                          WCABDX
     I              B2CATM                          WCCATM
     I              B2MNSX                          WCMNSX
     I              B2JOWG                          WCJOWG
     I              B2JPWG                          WCJPWG
     I              B2MOSX                          WCMOSX
     I              B2DNAA                          WCDNAA
     I              B2PGNX                          WCPGNX
     I              B2BTT1                          WCBTT1
     I              B2D7C7                          WCD7C7
     I              B2PYNA                          WCPYNA
     I              B2PZNA                          WCPZNA
     I              B2MPSX                          WCMPSX
     I              B2CCT1                          WCCCT1
     I              B2PHNX                          WCPHNX
     I              B2MQSX                          WCMQSX
     I              B2DOAA                          WCDOAA
     I              B2BUT1                          WCBUT1
     I              B2DYAA                          WCDYAA
     I              B2BVT1                          WCBVT1
     I              B2DPAA                          WCDPAA
     I              B2DQAA                          WCDQAA
     I              B2BZT1                          WCBZT1
     I              B2BWT1                          WCBWT1
     I              B2DRAA                          WCDRAA
     I              B2B9T1                          WCB9T1
     I              B2DSAA                          WCDSAA
     I              B2B8T1                          WCB8T1
     I              B2D4AA                          WCD4AA
     I              B2EPAA                          WCEPAA
     I              B2EQAA                          WCEQAA
     I              B2ERAA                          WCERAA
     I              B2ESAA                          WCESAA
     I              B2PNSX                          WCPNSX
     I              B2UFNX                          WCUFNX
     I              B2UGNX                          WCUGNX
     I              B2UHNX                          WCUHNX
     I              B2AGDX                          WCAGDX
     I              B2CGTM                          WCCGTM
     I              B2POSX                          WCPOSX
     I              B2PPSX                          WCPPSX
     I              B2UINX                          WCUINX
     I              B2UJNX                          WCUJNX
     I              B2UKNX                          WCUKNX
     I              B2ULNX                          WCULNX
     I              B2PRSX                          WCPRSX
     I              B2PSSX                          WCPSSX
     I              B2AATM                          WCAATM
     I              B2AYNA                          WCAYNA
     I              B2A0NA                          WCA0NA
     I              B2AXDT                          WCAXDT
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPOB31    E DSPOB3CPL2
      * UPD : Farm Site Summary         Update Index for Purge
      * Renamed input format fields
     I              B3DVAA                          WEDVAA
     I              B3ACDX                          WEACDX
     I              B3MRSX                          WEMRSX
     I              B3DTAA                          WEDTAA
     I              B3DZAA                          WEDZAA
     I              B3DUAA                          WEDUAA
     I              B3BYT1                          WEBYT1
     I              B3DWAA                          WEDWAA
     I              B3BXT1                          WEBXT1
     I              B3DXAA                          WEDXAA
     I              B3CBT1                          WECBT1
     I              B3AATM                          WEAATM
     I              B3AYNA                          WEAYNA
     I              B3A0NA                          WEA0NA
     I              B3AXDT                          WEAXDT
      *
     IQPOB32    E DSPOB3CPL0
      * UPD : Farm Site Summary         Update index
      * Renamed input format fields
     I              B3DVAA                          WFDVAA
     I              B3ACDX                          WFACDX
     I              B3MRSX                          WFMRSX
     I              B3DTAA                          WFDTAA
     I              B3DZAA                          WFDZAA
     I              B3DUAA                          WFDUAA
     I              B3BYT1                          WFBYT1
     I              B3DWAA                          WFDWAA
     I              B3BXT1                          WFBXT1
     I              B3DXAA                          WFDXAA
     I              B3CBT1                          WFCBT1
     I              B3AATM                          WFAATM
     I              B3AYNA                          WFAYNA
     I              B3A0NA                          WFA0NA
     I              B3AXDT                          WFAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Purge Date USR
     I                                    P   1   40P1NGDT
     IP2PARM      DS                             44
      * RCD: PAR CVTDATE parms
      * N :  Date From Convert USR
     I                                        1  10 P2XETX
      * N :  Date To Convert USR
     I                                       11  21 P2XFTX
      * N :  Date From Format USR
     I                                       22  29 P2C5VN
      * N :  Date To Format USR
     I                                       30  37 P2C6VN
      * N :  Date Separator USR
     I                                       38  44 P2C4VN
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1NGDT    PARM           WP0001  70       Purge Date USR
     C                     PARM           P2PARM           RCD: *Arrays
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Read rcds Purge-Fresh  XF
     C                     MOVEL*BLANK    P2XETX           Date From Conve
     C                     MOVELP1NGDT    P2XETX           Date From Conve
      * Cvt Date              UP - /UT Functions  * 
     C                     CALL 'POD5UPR'              90  Cvt Date
     C                     PARM P2XETX    WQ0001 10        Date From Conve
     C           P2XFTX    PARM *BLANK    WQ0002 11        Date To Convert
     C                     PARM '*CYMD'   WQ0003  8        Date From Forma
     C                     PARM '*YYMD'   WQ0004  8        Date To Format
     C                     PARM '*NONE'   WQ0005  7        Date Separator
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POD5UPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * ** Move 11 char to 8 char
     C                     MOVELP2XFTX    WUBIT1           AS Prod Date YY
      * ** Convert 8 char to 8 numeric
     C                     MOVE WUBIT1    YL0001           PT Prod Date YY
      * Read rcds Purge-Fresh  RT - Product Trace  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Read rcds Purge-Fresh  RT - Product Trace  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTAST           First Time Flag
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WAAADX           PT Prod Date YY
      * Setup key
     C                     Z-ADDYL0001    WAAADX           PT Prod Date YY
      * Establish starting position
     C           KPSSA     SETLL@B2CPOO                    *
     C                     READ @B2CPOO                  90*
      * Data record not found
     C   90                MOVEL'USR3144' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.User Id is SAMPLE
     C           WAAYNA    IFEQ @CN,001                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Purge Fresh
      * CRT Product Trace Purge - Product Trace  * 
     C                     EXSR SBCRRC
      * DLT Product Trace Purge - Product Trace  * 
     C                     EXSR SCDLRC
      * ** Moved to inside the Delete
     C                     END                             *FI
     C                     READ @B2CPOO                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCRRC    BEGSR
      *================================================================
      * CRT Product Trace Purge - Product Trace  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B2CPON
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     Z-ADDWAPFNX    WBPFNX           PT Serial Numbe
     C                     Z-ADDWAAADX    WBAADX           PT Prod Date YY
     C                     Z-ADDWAB9TM    WBB9TM           PT Production T
     C                     Z-ADDWAADDX    WBADDX           PT Label Date Y
     C                     Z-ADDWAABDX    WBABDX           PT Offset Prod
     C                     Z-ADDWACATM    WBCATM           PT Offset Prod
     C                     MOVELWAMNSX    WBMNSX           PT Inventory St
     C                     Z-ADDWAJOWG    WBJOWG           PT Net Weight
     C                     Z-ADDWAJPWG    WBJPWG           PT Gross Weight
     C                     MOVELWAMOSX    WBMOSX           PT Shift Number
     C                     MOVELWADNAA    WBDNAA           PT Warehouse ID
     C                     Z-ADDWAPGNX    WBPGNX           PT Order Number
     C                     MOVELWABTT1    WBBTT1           PT Pallet Numbe
     C                     Z-ADDWAD7C7    WBD7C7           PT Product Code
     C                     MOVELWAPYNA    WBPYNA           PT Item Label L
     C                     MOVELWAPZNA    WBPZNA           PT Item Label L
     C                     MOVELWAMPSX    WBMPSX           PT Fresh/Frozen
     C                     MOVELWACCT1    WBCCT1           PT Item Picture
     C                     Z-ADDWAPHNX    WBPHNX           PT Tattoo Numbe
     C                     MOVELWAMQSX    WBMQSX           PT Source Type
     C                     MOVELWADOAA    WBDOAA           PT Source Code
     C                     MOVELWABUT1    WBBUT1           PT Source Code
     C                     MOVELWADYAA    WBDYAA           PT Producer/Cel
     C                     MOVELWABVT1    WBBVT1           PT Producer/Cel
     C                     MOVELWADPAA    WBDPAA           PT Producer/Far
     C                     MOVELWADQAA    WBDQAA           PT Producer Loc
     C                     MOVELWABZT1    WBBZT1           PT Producer/Far
     C                     MOVELWABWT1    WBBWT1           PT Producer/Far
     C                     MOVELWADRAA    WBDRAA           PT Producer/Far
     C                     MOVELWAB9T1    WBB9T1           PT Producer/Far
     C                     MOVELWADSAA    WBDSAA           PT Genetic Code
     C                     MOVELWAB8T1    WBB8T1           PT Genetic Desc
     C                     MOVELWAD4AA    WBD4AA           PT Gender Code
     C                     MOVELWAEPAA    WBEPAA           PT Producer/Far
     C                     MOVELWAEQAA    WBEQAA           PT Producer/Far
     C                     MOVELWAERAA    WBERAA           PT Producer/Far
     C                     MOVELWAESAA    WBESAA           PT Producer/Far
     C                     MOVELWAPNSX    WBPNSX           PT Item Type Co
     C                     Z-ADDWAUFNX    WBUFNX           PT Item Str Cla
     C                     Z-ADDWAUGNX    WBUGNX           PT Item Str Gro
     C                     Z-ADDWAUHNX    WBUHNX           PT Item Str Typ
     C                     Z-ADDWAAGDX    WBAGDX           PT WIP Dump/Pro
     C                     Z-ADDWACGTM    WBCGTM           PT WIP Dump/Pro
     C                     MOVELWAPOSX    WBPOSX           PT WIP Dump/Pro
     C                     MOVELWAPPSX    WBPPSX           PT WIP Used/Not
     C                     Z-ADDWAUINX    WBUINX           PT From FG Seri
     C                     Z-ADDWAUJNX    WBUJNX           PT To FG Serial
     C                     Z-ADDWAUKNX    WBUKNX           PT Unused Nbr 3
     C                     Z-ADDWAULNX    WBULNX           PT Unused Nbr 4
     C                     MOVELWAPRSX    WBPRSX           PT Incl in Prod
     C                     MOVELWAPSSX    WBPSSX           PT Unused Sts 4
     C                     Z-ADDWAAATM    WBAATM           Job Time
     C                     MOVELWAAYNA    WBAYNA           User Id
     C                     MOVELWAA0NA    WBA0NA           Job Name
     C                     Z-ADDWAAXDT    WBAXDT           Job Date
      *
     C           KLCRSB    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBPFNX           PT Serial Numbe
     C                     KFLD           WBAADX           PT Prod Date YY
     C                     KFLD           WBB9TM           PT Production T
      * Check for duplicate primary key
     C           KLCRSB    SETLL@B2CPON                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3145' W0RTN   7
      * Send message 'Product Trace          EX'
     C                     MOVEL'USR3145' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C                     WRITE@B2CPON                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCDLRC    BEGSR
      *================================================================
      * DLT Product Trace Purge - Product Trace  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B2CPMP
     C                     Z-ADDWAAIC3    WCAIC3           Company Number
     C                     Z-ADDWAPFNX    WCPFNX           PT Serial Numbe
     C                     Z-ADDWAAADX    WCAADX           PT Prod Date YY
     C                     Z-ADDWAB9TM    WCB9TM           PT Production T
      *
     C           KLDLSC    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCPFNX           PT Serial Numbe
     C                     KFLD           WCAADX           PT Prod Date YY
     C                     KFLD           WCB9TM           PT Production T
     C           KLDLSC    CHAIN@B2CPMP              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB2CPL0'MDACP
     C                     MOVEL'@B2CPMP' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B2CPMP                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * DBF delete successful
      * USER: Processing after Data update
      *  ** 08/13/2007 LJB FP1009
      * RTV all FSS for Purge  RT - Farm Site Summary  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWCDNAA    WL0001    P      FS Warehouse ID
     C                     Z-ADDWCAADX    WL0002           FS Prod Date YY
     C                     MOVELWCMOSX    WL0003    P      FS Shift Number
     C                     MOVELWCDPAA    WL0004    P      FS Producer/Far
     C                     MOVELWCDQAA    WL0005    P      FS Producer Loc
     C                     EXSR SDRVGN
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV all FSS for Purge  RT - Farm Site Summary  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDDVAA           FS Warehouse ID
     C                     KFLD           WDACDX           FS Prod Date YY
     C                     KFLD           WDMRSX           FS Shift Number
     C                     KFLD           WDDTAA           FS Producer/Far
     C                     KFLD           WDDZAA           FS Producer Loc
      * Setup key
     C                     MOVELWL0001    WDDVAA           FS Warehouse ID
     C                     Z-ADDWL0002    WDACDX           FS Prod Date YY
     C                     MOVELWL0003    WDMRSX           FS Shift Number
     C                     MOVELWL0004    WDDTAA           FS Producer/Far
     C                     MOVELWL0005    WDDZAA           FS Producer Loc
      * Establish starting position
     C           KRSSD     CHAIN@B3CPMT              90    *
      * Data record not found
     C   90                MOVEL'USR3146' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CRT Frm Site Summ Purge - Farm Site Summary  * 
     C                     EXSR SECRRC
      * Delete Farm Site Summary - Farm Site Summary  * 
     C                     EXSR SFDLRC
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * CRT Frm Site Summ Purge - Farm Site Summary  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B3CPL2
     C                     MOVELWDDVAA    WEDVAA           FS Warehouse ID
     C                     Z-ADDWDACDX    WEACDX           FS Prod Date YY
     C                     MOVELWDMRSX    WEMRSX           FS Shift Number
     C                     MOVELWDDTAA    WEDTAA           FS Producer/Far
     C                     MOVELWDDZAA    WEDZAA           FS Producer Loc
     C                     MOVELWDDUAA    WEDUAA           FS Producer/Cel
     C                     MOVELWDBYT1    WEBYT1           FS Producer/Cel
     C                     MOVELWDDWAA    WEDWAA           FS Producer/Far
     C                     MOVELWDBXT1    WEBXT1           FS Producer/Far
     C                     MOVELWDDXAA    WEDXAA           FS Producer/Far
     C                     MOVELWDCBT1    WECBT1           FS Producer/Far
     C                     Z-ADDWDAATM    WEAATM           Job Time
     C                     MOVELWDAYNA    WEAYNA           User Id
     C                     MOVELWDA0NA    WEA0NA           Job Name
     C                     Z-ADDWDAXDT    WEAXDT           Job Date
      *
     C           KLCRSE    KLIST
     C                     KFLD           WEDVAA           FS Warehouse ID
     C                     KFLD           WEACDX           FS Prod Date YY
     C                     KFLD           WEMRSX           FS Shift Number
     C                     KFLD           WEDTAA           FS Producer/Far
     C                     KFLD           WEDZAA           FS Producer Loc
      * Check for duplicate primary key
     C           KLCRSE    SETLL@B3CPL2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3147' W0RTN   7
      * Send message 'Farm Site Summary      EX'
     C                     MOVEL'USR3147' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@B3CPL2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFDLRC    BEGSR
      *================================================================
      * Delete Farm Site Summary - Farm Site Summary  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B3CPMS
     C                     MOVELWDDVAA    WFDVAA           FS Warehouse ID
     C                     Z-ADDWDACDX    WFACDX           FS Prod Date YY
     C                     MOVELWDMRSX    WFMRSX           FS Shift Number
     C                     MOVELWDDTAA    WFDTAA           FS Producer/Far
     C                     MOVELWDDZAA    WFDZAA           FS Producer Loc
      *
     C           KLDLSF    KLIST
     C                     KFLD           WFDVAA           FS Warehouse ID
     C                     KFLD           WFACDX           FS Prod Date YY
     C                     KFLD           WFMRSX           FS Shift Number
     C                     KFLD           WFDTAA           FS Producer/Far
     C                     KFLD           WFDZAA           FS Producer Loc
     C           KLDLSF    CHAIN@B3CPMS              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB3CPL0'MDACP
     C                     MOVEL'@B3CPMS' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B3CPMS                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2XETX           Date From Conve
     C                     MOVEL*BLANK    P2XFTX           Date To Convert
     C                     MOVEL*BLANK    P2C5VN           Date From Forma
     C                     MOVEL*BLANK    P2C6VN           Date To Format
     C                     MOVEL*BLANK    P2C4VN           Date Separator
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field AS Prod Date YYYYMMDD
     C                     MOVEL*BLANK    WUBIT1  8
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAPFNX           PT Serial Numbe
     C                     Z-ADD*ZERO     WAAADX           PT Prod Date YY
     C                     Z-ADD*ZERO     WAB9TM           PT Production T
     C                     Z-ADD*ZERO     WAADDX           PT Label Date Y
     C                     Z-ADD*ZERO     WAABDX           PT Offset Prod
     C                     Z-ADD*ZERO     WACATM           PT Offset Prod
     C                     Z-ADD*ZERO     WAJOWG           PT Net Weight
     C                     Z-ADD*ZERO     WAJPWG           PT Gross Weight
     C                     Z-ADD*ZERO     WAPGNX           PT Order Number
     C                     Z-ADD*ZERO     WAD7C7           PT Product Code
     C                     Z-ADD*ZERO     WAPHNX           PT Tattoo Numbe
     C                     Z-ADD*ZERO     WAUFNX           PT Item Str Cla
     C                     Z-ADD*ZERO     WAUGNX           PT Item Str Gro
     C                     Z-ADD*ZERO     WAUHNX           PT Item Str Typ
     C                     Z-ADD*ZERO     WAAGDX           PT WIP Dump/Pro
     C                     Z-ADD*ZERO     WACGTM           PT WIP Dump/Pro
     C                     Z-ADD*ZERO     WAUINX           PT From FG Seri
     C                     Z-ADD*ZERO     WAUJNX           PT To FG Serial
     C                     Z-ADD*ZERO     WAUKNX           PT Unused Nbr 3
     C                     Z-ADD*ZERO     WAULNX           PT Unused Nbr 4
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDACDX           FS Prod Date YY
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SDRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     Z-ADD*ZERO     WL0002  80
     C                     MOVEL*BLANK    WL0003  1
     C                     MOVEL*BLANK    WL0004  7
     C                     MOVEL*BLANK    WL0005  6
      * Define local work field PT Prod Date YYYYMMDD
     C                     Z-ADD*ZERO     YL0001  80
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 SAMPLE
