// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PWNGXFR
// ?Date: 14.08.2025 Time: 02:57:04
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?Modification histroy
DO;

//?11/10/2021 JBB HD87450 - Update BOH if Commodity values change
//?                         Function modified.  Update Commodity
//?                         Market Code and Commodity Price Group in
//?                         thr Buy Order Header if values change.
//? 6/04/2021 JBB SDN619 - Repayments by Business Users
//?               E17058   Function created.  Update production
//?                        files with the new values.
ENDDO;

//?If Producer or Location values change
CASE;

// IF PAR.Producer Code New NE PAR.PD Producer Code
IF PAR.Producer_Code_New <> PAR.PD_Producer_Code;

// OR PAR.Location Code New NE PAR.PL Location Code
OR PAR.Location_Code_New <> PAR.PL_Location_Code;

// OR PAR.Commodity Market Code New NE PAR.PSC Commodity Market Code
OR PAR.Commodity_Market_Code_New <> PAR.PSC_Commodity_Market_Code;

// OR PAR.Commodity Price Group New NE PAR.PSC Commodity Price Group
OR PAR.Commodity_Price_Group_New <> PAR.PSC_Commodity_Price_Group;

//?The new Contract and Sub-Contract are updated in the following file:
//?- Buy Order Header - PKAWCPP
//?Notes on Producer/Location change
DO;

//?Producer Code and Location are updated in the following files:
//?- Buy Order Header - PKAWCPP
//?- Buy Order Load - PKAXCPP
//?- Buy Order Load Weight - PKEJCPP
//?- Delivery Schedule Detail - PLAECPP
//?- Delivery Tracking - PLAFCPP
//?- Tattoo Header - PKA1CPP
//?- Tattoo Header Ext - PKDNCPP (Only Producer Code changes)
//?The Site Id must be updated in the following file:
//?- Tattoo Header Ext - PKDNCPP
//?The new Market Code and Price Group are updated in the following file:
//?- Buy Order Header - PKAWCPP
//?The new Contract and Sub-Contract are updated in the following file:
//?- Buy Order Header - PKAWCPP
ENDDO;

EXECUTE FUNCTION(Upd for Prd/Loc Chg   IF) TYPE(EXCINTFUN)                      AB1367830;
PARAMETER(PAR.BOH_Company_Number);
PARAMETER(PAR.BOH_Buy_Order_Number);
PARAMETER(PAR.BOL_Load_Number);
PARAMETER(PAR.TH_Tattoo_Number);
PARAMETER(PAR.TH_Kill_Date);
PARAMETER(PAR.Producer_Code_New);
PARAMETER(PAR.Location_Code_New);
PARAMETER(PAR.Contract_Code_New);
PARAMETER(PAR.Sub_Contract_Code_New);
PARAMETER(PAR.Site_Id_New);
PARAMETER(PAR.Commodity_Market_Code_New);
PARAMETER(PAR.Commodity_Price_Group_New);
{
 //?Execute internal function

 EXECUTE FUNCTION(Upd for Repay Prd/Loc CH) TYPE(CHGOBJ) FILE(PKA1CPP)           AB1367832;
 PARAMETER(PAR.BOH_Company_Number);
 PARAMETER(PAR.BOH_Buy_Order_Number);
 PARAMETER(PAR.BOL_Load_Number);
 PARAMETER(PAR.TH_Tattoo_Number);
 PARAMETER(PAR.TH_Kill_Date);
 PARAMETER(PAR.Producer_Code_New);
 PARAMETER(PAR.Location_Code_New);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
  PARAMETER(DB1.RS_User_Changed);
  PARAMETER(DB1.RS_Date_Changed);
  PARAMETER(DB1.RS_Time_Changed);
  PARAMETER(DB1.RS_Job);
  PARAMETER(DB1.RS_Program);
  {
   //?Execute internal function

   // PAR.RS User Changed = JOB.*USER
   PAR.RS_User_Changed = JOB.*USER;

   // PAR.RS Date Changed = JOB.*Job date
   PAR.RS_Date_Changed = JOB.*Job_date;

   // PAR.RS Time Changed = JOB.*Job time
   PAR.RS_Time_Changed = JOB.*Job_time;

   // PAR.RS Job = JOB.*JOB
   PAR.RS_Job = JOB.*JOB;

   // PAR.RS Program = JOB.*PROGRAM
   PAR.RS_Program = JOB.*PROGRAM;

  }

 }

 EXECUTE FUNCTION(Upd for Repay Prd/Loc CH) TYPE(CHGOBJ) FILE(PKDNCPP)           AB1367833;
 PARAMETER(PAR.BOH_Company_Number);
 PARAMETER(PAR.BOH_Buy_Order_Number);
 PARAMETER(PAR.BOL_Load_Number);
 PARAMETER(PAR.TH_Tattoo_Number);
 PARAMETER(PAR.TH_Kill_Date);
 PARAMETER(PAR.Producer_Code_New);
 PARAMETER(PAR.Site_Id_New);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
  PARAMETER(DB1.RS_User_Changed);
  PARAMETER(DB1.RS_Date_Changed);
  PARAMETER(DB1.RS_Time_Changed);
  PARAMETER(DB1.RS_Job);
  PARAMETER(DB1.RS_Program);
  {
   //?Execute internal function

   // PAR.RS User Changed = JOB.*USER
   PAR.RS_User_Changed = JOB.*USER;

   // PAR.RS Date Changed = JOB.*Job date
   PAR.RS_Date_Changed = JOB.*Job_date;

   // PAR.RS Time Changed = JOB.*Job time
   PAR.RS_Time_Changed = JOB.*Job_time;

   // PAR.RS Job = JOB.*JOB
   PAR.RS_Job = JOB.*JOB;

   // PAR.RS Program = JOB.*PROGRAM
   PAR.RS_Program = JOB.*PROGRAM;

  }

 }

 EXECUTE FUNCTION(Upd for Repay Prd/Loc CH) TYPE(CHGOBJ) FILE(PKAWCPP)           AB1367835;
 PARAMETER(PAR.BOH_Company_Number);
 PARAMETER(PAR.BOH_Buy_Order_Number);
 PARAMETER(PAR.Commodity_Market_Code_New);
 PARAMETER(PAR.Commodity_Price_Group_New);
 PARAMETER(PAR.Producer_Code_New);
 PARAMETER(PAR.Location_Code_New);
 PARAMETER(PAR.Contract_Code_New);
 PARAMETER(PAR.Sub_Contract_Code_New);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
  PARAMETER(DB1.RS_User_Changed);
  PARAMETER(DB1.RS_Date_Changed);
  PARAMETER(DB1.RS_Time_Changed);
  PARAMETER(DB1.RS_Job);
  PARAMETER(DB1.RS_Program);
  {
   //?Execute internal function

   // PAR.RS User Changed = JOB.*USER
   PAR.RS_User_Changed = JOB.*USER;

   // PAR.RS Date Changed = JOB.*Job date
   PAR.RS_Date_Changed = JOB.*Job_date;

   // PAR.RS Time Changed = JOB.*Job time
   PAR.RS_Time_Changed = JOB.*Job_time;

   // PAR.RS Job = JOB.*JOB
   PAR.RS_Job = JOB.*JOB;

   // PAR.RS Program = JOB.*PROGRAM
   PAR.RS_Program = JOB.*PROGRAM;

  }

 }

 EXECUTE FUNCTION(Upd for Prd/Loc Chg   CH) TYPE(CHGOBJ) FILE(PKAXCPP)           AB1367836;
 PARAMETER(PAR.BOH_Company_Number);
 PARAMETER(PAR.BOH_Buy_Order_Number);
 PARAMETER(PAR.BOL_Load_Number);
 PARAMETER(PAR.Producer_Code_New);
 PARAMETER(PAR.Location_Code_New);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
  PARAMETER(DB1.RS_User_Changed);
  PARAMETER(DB1.RS_Date_Changed);
  PARAMETER(DB1.RS_Time_Changed);
  PARAMETER(DB1.RS_Job);
  PARAMETER(DB1.RS_Program);
  {
   //?Execute internal function

   // PAR.RS User Changed = JOB.*USER
   PAR.RS_User_Changed = JOB.*USER;

   // PAR.RS Date Changed = JOB.*Job date
   PAR.RS_Date_Changed = JOB.*Job_date;

   // PAR.RS Time Changed = JOB.*Job time
   PAR.RS_Time_Changed = JOB.*Job_time;

   // PAR.RS Job = JOB.*JOB
   PAR.RS_Job = JOB.*JOB;

   // PAR.RS Program = JOB.*PROGRAM
   PAR.RS_Program = JOB.*PROGRAM;

  }

 }

 EXECUTE FUNCTION(Upd for Prd/Loc Chg   RT) TYPE(RTVOBJ) FILE(PLAECPP)           AB1367837;
 PARAMETER(PAR.BOH_Company_Number);
 PARAMETER(PAR.BOH_Buy_Order_Number);
 PARAMETER(PAR.BOL_Load_Number);
 PARAMETER(PAR.TH_Kill_Date);
 PARAMETER(PAR.Producer_Code_New);
 PARAMETER(PAR.Location_Code_New);
 {
  //?USER: Process Data record

  EXECUTE FUNCTION(Upd for Prd/Loc Chg   CH) TYPE(CHGOBJ) FILE(PLAECPP)           AB1367838;
  PARAMETER(DB1.CC_Company_Number);
  PARAMETER(DB1.DSH_Kill_Date);
  PARAMETER(DB1.DSD_Delivery_Date);
  PARAMETER(DB1.DSD_Delivery_Time);
  PARAMETER(DB1.DSD_Delivery_Time_Seq);
  PARAMETER(PAR.Producer_Code_New);
  PARAMETER(PAR.Location_Code_New);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
   PARAMETER(DB1.RS_User_Changed);
   PARAMETER(DB1.RS_Date_Changed);
   PARAMETER(DB1.RS_Time_Changed);
   PARAMETER(DB1.RS_Job);
   PARAMETER(DB1.RS_Program);
   {
    //?Execute internal function

    // PAR.RS User Changed = JOB.*USER
    PAR.RS_User_Changed = JOB.*USER;

    // PAR.RS Date Changed = JOB.*Job date
    PAR.RS_Date_Changed = JOB.*Job_date;

    // PAR.RS Time Changed = JOB.*Job time
    PAR.RS_Time_Changed = JOB.*Job_time;

    // PAR.RS Job = JOB.*JOB
    PAR.RS_Job = JOB.*JOB;

    // PAR.RS Program = JOB.*PROGRAM
    PAR.RS_Program = JOB.*PROGRAM;

   }

  }

 }

 EXECUTE FUNCTION(Upd for Prd/Loc Chg   RT) TYPE(RTVOBJ) FILE(PLAFCPP)           AB1367839;
 PARAMETER(PAR.BOH_Company_Number);
 PARAMETER(PAR.BOH_Buy_Order_Number);
 PARAMETER(PAR.BOL_Load_Number);
 PARAMETER(PAR.TH_Kill_Date);
 PARAMETER(PAR.Producer_Code_New);
 PARAMETER(PAR.Location_Code_New);
 {
  //?USER: Process Data record

  EXECUTE FUNCTION(Upd for Prd/Loc Chg   CH) TYPE(CHGOBJ) FILE(PLAFCPP)           AB1367840;
  PARAMETER(DB1.CC_Company_Number);
  PARAMETER(DB1.DSH_Kill_Date);
  PARAMETER(DB1.DT_Delivery_Date);
  PARAMETER(DB1.DT_Delivery_Time);
  PARAMETER(DB1.DT_Delivery_Time_Seq);
  PARAMETER(PAR.Producer_Code_New);
  PARAMETER(PAR.Location_Code_New);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
   PARAMETER(DB1.RS_User_Changed);
   PARAMETER(DB1.RS_Date_Changed);
   PARAMETER(DB1.RS_Time_Changed);
   PARAMETER(DB1.RS_Job);
   PARAMETER(DB1.RS_Program);
   {
    //?Execute internal function

    // PAR.RS User Changed = JOB.*USER
    PAR.RS_User_Changed = JOB.*USER;

    // PAR.RS Date Changed = JOB.*Job date
    PAR.RS_Date_Changed = JOB.*Job_date;

    // PAR.RS Time Changed = JOB.*Job time
    PAR.RS_Time_Changed = JOB.*Job_time;

    // PAR.RS Job = JOB.*JOB
    PAR.RS_Job = JOB.*JOB;

    // PAR.RS Program = JOB.*PROGRAM
    PAR.RS_Program = JOB.*PROGRAM;

   }

  }

 }

}


ENDIF;

//?If Site ID changes
CASE;

// IF PAR.Site Id New NE PAR.PS Site ID
IF PAR.Site_Id_New <> PAR.PS_Site_ID;

EXECUTE FUNCTION(Upd for Repay Prd/Loc CH) TYPE(CHGOBJ) FILE(PKDNCPP)           AB1367833;
PARAMETER(PAR.BOH_Company_Number);
PARAMETER(PAR.BOH_Buy_Order_Number);
PARAMETER(PAR.BOL_Load_Number);
PARAMETER(PAR.TH_Tattoo_Number);
PARAMETER(PAR.TH_Kill_Date);
PARAMETER(PAR.Producer_Code_New);
PARAMETER(PAR.Site_Id_New);
{
 //?USER: Processing before Data update

 EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
 PARAMETER(DB1.RS_User_Changed);
 PARAMETER(DB1.RS_Date_Changed);
 PARAMETER(DB1.RS_Time_Changed);
 PARAMETER(DB1.RS_Job);
 PARAMETER(DB1.RS_Program);
 {
  //?Execute internal function

  // PAR.RS User Changed = JOB.*USER
  PAR.RS_User_Changed = JOB.*USER;

  // PAR.RS Date Changed = JOB.*Job date
  PAR.RS_Date_Changed = JOB.*Job_date;

  // PAR.RS Time Changed = JOB.*Job time
  PAR.RS_Time_Changed = JOB.*Job_time;

  // PAR.RS Job = JOB.*JOB
  PAR.RS_Job = JOB.*JOB;

  // PAR.RS Program = JOB.*PROGRAM
  PAR.RS_Program = JOB.*PROGRAM;

 }

}


ENDIF;

