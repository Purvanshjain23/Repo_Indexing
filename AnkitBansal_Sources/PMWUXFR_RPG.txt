     H/TITLE Exc Upd 1 Ord frm Inv XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 01/16/20  Time  : 14:53:46
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPMDACPLAIF  E           K        DISK
      * RSQ : COA Batch Header RIN      ShCo/Order
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FPMCCCPL1IF  E           K        DISK
      * RTV : COA Batch Header          Retrieval index
      *
     FOMFNCPL1IF  E           K        DISK
      * RTV : Manifest Detail           Retrieval index
      *
     FPMCAREL2IF  E           K        DISK
      * RSQ : COA Property Define Hdr   Co/Item Code
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FPNGJREL1IF  E           K        DISK
      * RTV : RFS API Volume Corr Table Retrieval index
      *
     FOPBFCPLOIF  E           K        DISK
      * RSQ : Order Header TRG          Ord-D/Co
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FPDNIREL1IF  E           K        DISK
      * RTV : Company Customer EXT      Retrieval index
      *
     FCAEOREL3IF  E           K        DISK
      * RSQ : Company Customer          Customer/Company
      *
     FPMDACPL1IF  E           K        DISK
      * RTV : COA Batch Header RIN      Retrieval index
      *
     FPNGGREL1IF  E           K        DISK
      * RTV : RFS Transaction Reason    Retrieval index
      *
     FPNFPCPL1IF  E           K        DISK
      * RTV : Manifest Detail RIN Sell  Retrieval index
      *
     FPMDACPL0UF  E           K        DISK                      A
      * UPD : COA Batch Header RIN      Update index
      *
     FPMCCCPL0UF  E           K        DISK
      * UPD : COA Batch Header          Update index
      *
     I@DACPDL
      * COA Batch Header RIN      ShCo/Order
      * Renamed input format fields
     I              DAAIC3                          WAAIC3
     I              DAL6T1                          WAL6T1
     I              DAI3NY                          WAI3NY
     I              DAJYNY                          WAJYNY
     I              DAQ1NY                          WAQ1NY
     I              DAMUT1                          WAMUT1
     I              DAJZNY                          WAJZNY
     I              DAJ0NY                          WAJ0NY
     I              DAJ2NY                          WAJ2NY
     I              DARIDT                          WARIDT
     I              DAC5TM                          WAC5TM
     I              DAMVT1                          WAMVT1
     I              DAMWT1                          WAMWT1
     I              DARINT                          WARINT
     I              DARJDT                          WARJDT
     I              DAC6TM                          WAC6TM
     I              DAC4NB                          WAC4NB
     I              DADPNB                          WADPNB
     I              DAUENB                          WAUENB
     I              DARZNB                          WARZNB
     I              DANGT1                          WANGT1
     I              DARMNB                          WARMNB
     I              DARKDT                          WARKDT
     I              DAC7TM                          WAC7TM
     I              DARINS                          WARINS
     I              DAMXT1                          WAMXT1
     I              DAG3ST                          WAG3ST
     I              DAQWNY                          WAQWNY
     I              DAL0AA                          WAL0AA
     I              DAMAT1                          WAMAT1
     I              DATDNA                          WATDNA
     I              DACWC3                          WACWC3
     I              DAQXNY                          WAQXNY
     I              DAQZNY                          WAQZNY
     I              DAQ0NY                          WAQ0NY
     I              DALVTX                          WALVTX
     I              DANYT1                          WANYT1
     I              DAG5ST                          WAG5ST
     I              DAG7ST                          WAG7ST
     I              DATFDT                          WATFDT
     I              DATGDT                          WATGDT
     I              DAWIT1                          WAWIT1
     I              DAQYNY                          WAQYNY
     I              DAL7T1                          WAL7T1
     I              DAR8NY                          WAR8NY
     I              DAR0NY                          WAR0NY
     I              DAI7AA                          WAI7AA
     I              DAMXAA                          WAMXAA
     I              DAMSAA                          WAMSAA
     I              DAR7NY                          WAR7NY
     I              DAHEPR                          WAHEPR
     I              DAHFPR                          WAHFPR
     I              DAWVT1                          WAWVT1
     I              DAW0T1                          WAW0T1
     I              DAR5NY                          WAR5NY
     I              DAW1T1                          WAW1T1
     I              DAR6NY                          WAR6NY
     I              DAJ1ST                          WAJ1ST
     I              DAKHST                          WAKHST
     I              DATWDT                          WATWDT
     I              DADUTM                          WADUTM
     I              DAKGST                          WAKGST
     I              DATVDT                          WATVDT
     I              DADTTM                          WADTTM
     I              DAR9NY                          WAR9NY
     I              DASQNY                          WASQNY
     I              DABHR3                          WABHR3
     I              DASRNY                          WASRNY
     I              DAW7T1                          WAW7T1
     I              DAW8T1                          WAW8T1
     I              DAT2DT                          WAT2DT
     I              DASXNY                          WASXNY
     I              DASYNY                          WASYNY
     I              DASZNY                          WASZNY
     I              DAVSST                          WAVSST
     I              DAMJDT                          WAMJDT
     I              DABETM                          WABETM
     I              DACCVN                          WACCVN
     I              DACDVN                          WACDVN
     I              DAMKDT                          WAMKDT
     I              DABFTM                          WABFTM
     I              DACEVN                          WACEVN
     I              DACFVN                          WACFVN
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WCAIC3
     I              OMC4NB                          WCC4NB
     I              OMDPNB                          WCDPNB
     I              OMUENB                          WCUENB
     I              OMHGCD                          WCHGCD
     I              OMAJCD                          WCAJCD
     I              OMBKC7                          WCBKC7
     I              OMCFC7                          WCCFC7
     I              OMGMST                          WCGMST
     I              OMGNST                          WCGNST
     I              OMMAVA                          WCMAVA
     I              OMKDVA                          WCKDVA
     I              OML8VA                          WCL8VA
     I              OML9VA                          WCL9VA
     I              OMGTST                          WCGTST
     I              OMGVST                          WCGVST
     I              OMGUST                          WCGUST
     I              OMQFST                          WCQFST
     I              OMAYVA                          WCAYVA
     I              OMEXDT                          WCEXDT
     I              OMLQCD                          WCLQCD
     I              OMRDCD                          WCRDCD
     I              OMQ7CD                          WCQ7CD
     I              OMBZPR                          WCBZPR
     I              OML6NB                          WCL6NB
     I              OMU1ST                          WCU1ST
     I              OMGIDT                          WCGIDT
     I              OMCRCD                          WCCRCD
     I              OMAGCD                          WCAGCD
     I              OMRZST                          WCRZST
     I              OMR0ST                          WCR0ST
     I              OMR1ST                          WCR1ST
     I              OMG7NA                          WCG7NA
     I              OMG8NA                          WCG8NA
     I              OMRPCD                          WCRPCD
     I              OMVEST                          WCVEST
     I              OMVGST                          WCVGST
     I              OMAVST                          WCAVST
     I              OMU0ST                          WCU0ST
     I              OMRFCD                          WCRFCD
     I              OMFZST                          WCFZST
     I              OMR1NB                          WCR1NB
     I              OMAVQT                          WCAVQT
     I              OMD0WG                          WCD0WG
     I              OMCCQT                          WCCCQT
     I              OMAUWG                          WCAUWG
     I              OMCBQT                          WCCBQT
     I              OMATWG                          WCATWG
     I              OMAQCS                          WCAQCS
     I              OMAGCS                          WCAGCS
     I              OMAKPR                          WCAKPR
     I              OMALPR                          WCALPR
     I              OMAUPR                          WCAUPR
     I              OMAVWG                          WCAVWG
     I              OMA4WG                          WCA4WG
     I              OMA5DT                          WCA5DT
     I              OMAODT                          WCAODT
     I              OMGNDT                          WCGNDT
     I              OMAMST                          WCAMST
     I              OMANST                          WCANST
     I              OMVAST                          WCVAST
     I              OMRGNB                          WCRGNB
     I              OMRHNB                          WCRHNB
     I              OMRINB                          WCRINB
     I              OMRBCD                          WCRBCD
     I              OMHICD                          WCHICD
     I              OMRNCD                          WCRNCD
     I              OMROCD                          WCROCD
     I              OMCXDT                          WCCXDT
     I              OMAJVN                          WCAJVN
     I              OMKXCD                          WCKXCD
     I              OMJPCD                          WCJPCD
     I              OMCQCD                          WCCQCD
     I              OMR4CD                          WCR4CD
     I              OMZ1ST                          WCZ1ST
     I              OMZ3ST                          WCZ3ST
     I              OMZ4ST                          WCZ4ST
     I              OMDUPR                          WCDUPR
     I              OMB6VL                          WCB6VL
     I              OMA1AA                          WCA1AA
     I              OMFZSX                          WCFZSX
     I              OMF0SX                          WCF0SX
     I              OMF1SX                          WCF1SX
     I              OMF2SX                          WCF2SX
     I              OMF3SX                          WCF3SX
     I              OMF4SX                          WCF4SX
     I              OMF5SX                          WCF5SX
     I              OMF6SX                          WCF6SX
     I              OMF7SX                          WCF7SX
     I              OMNTDT                          WCNTDT
     I              OMNUDT                          WCNUDT
     I              OMNVDT                          WCNVDT
     I              OMNWDT                          WCNWDT
     I              OMNXDT                          WCNXDT
     I              OMBUTM                          WCBUTM
     I              OMBVTM                          WCBVTM
     I              OMBWTM                          WCBWTM
     I              OMBXTM                          WCBXTM
     I              OMBYTM                          WCBYTM
     I              OMH5NX                          WCH5NX
     I              OMH6NX                          WCH6NX
     I              OMH7NX                          WCH7NX
     I              OMH8NX                          WCH8NX
     I              OMH9NX                          WCH9NX
     I              OMDVPR                          WCDVPR
     I              OMDWPR                          WCDWPR
     I              OMDXPR                          WCDXPR
     I              OMDYPR                          WCDYPR
     I              OMDZPR                          WCDZPR
     I              OMGSPR                          WCGSPR
     I              OMGTPR                          WCGTPR
     I              OMGUPR                          WCGUPR
     I              OMHOST                          WCHOST
     I              OMHPST                          WCHPST
     I              OMIOST                          WCIOST
     I              OMPEWG                          WCPEWG
     I              OMRINY                          WCRINY
     I              OMTIDT                          WCTIDT
     I              OMTJDT                          WCTJDT
     I              OMH2ST                          WCH2ST
     I              OMH0ST                          WCH0ST
     I              OMH1ST                          WCH1ST
     I              OMTKDT                          WCTKDT
     I              OMTLDT                          WCTLDT
     I              OMTMDT                          WCTMDT
     I              OMUVST                          WCUVST
     I              OMUWST                          WCUWST
     I              OMUXST                          WCUXST
     I              OMAATM                          WCAATM
     I              OMAYNA                          WCAYNA
     I              OMA0NA                          WCA0NA
     I              OMAXDT                          WCAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WDAJCD
     I              ADF8NA                          WDF8NA
     I              ADACNA                          WDACNA
     I              ADADNA                          WDADNA
     I              ADAENA                          WDAENA
     I              ADAJNA                          WDAJNA
     I              ADBTTX                          WDBTTX
     I              ADAOCD                          WDAOCD
     I              ADBGCD                          WDBGCD
     I              ADVHST                          WDVHST
     I              ADMPNA                          WDMPNA
     I              ADWPST                          WDWPST
     I              ADXUST                          WDXUST
     I              ADT0ST                          WDT0ST
     I              ADT1ST                          WDT1ST
     I              ADDBNB                          WDDBNB
     I              ADT2ST                          WDT2ST
     I              ADT3ST                          WDT3ST
     I              ADT4ST                          WDT4ST
     I              ADT6ST                          WDT6ST
     I              ADBWC3                          WDBWC3
     I              ADBTC3                          WDBTC3
     I              ADBUC3                          WDBUC3
     I              ADBVC3                          WDBVC3
     I              ADFCAA                          WDFCAA
     I              ADRQSX                          WDRQSX
     I              ADRRSX                          WDRRSX
     I              ADRSSX                          WDRSSX
     I              ADRTSX                          WDRTSX
     I              ADT7ST                          WDT7ST
     I              ADT8ST                          WDT8ST
     I              ADRNSX                          WDRNSX
     I              ADROSX                          WDROSX
     I              ADRPSX                          WDRPSX
     I              ADUVST                          WDUVST
     I              ADUWST                          WDUWST
     I              ADUXST                          WDUXST
     I              ADVSST                          WDVSST
     I              ADAATM                          WDAATM
     I              ADAYNA                          WDAYNA
     I              ADA0NA                          WDA0NA
     I              ADAXDT                          WDAXDT
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WEAIC3
     I              KMV8CD                          WEV8CD
     I              KMAUNA                          WEAUNA
     I              KMI5ST                          WEI5ST
     I              KMBXTX                          WEBXTX
     I              KMM8NB                          WEM8NB
     I              KMUVST                          WEUVST
     I              KMUWST                          WEUWST
     I              KMUXST                          WEUXST
     I              KMVSST                          WEVSST
     I              KMAATM                          WEAATM
     I              KMAYNA                          WEAYNA
     I              KMA0NA                          WEA0NA
     I              KMAXDT                          WEAXDT
      *
     I@CCCPOH
      * COA Batch Header          Retrieval index
      * Renamed input format fields
     I              CCAIC3                          WFAIC3
     I              CCL6T1                          WFL6T1
     I              CCI3NY                          WFI3NY
     I              CCIKAA                          WFIKAA
     I              CCIDAA                          WFIDAA
     I              CCRFDT                          WFRFDT
     I              CCC2TM                          WFC2TM
     I              CCMHT1                          WFMHT1
     I              CCRGDT                          WFRGDT
     I              CCC3TM                          WFC3TM
     I              CCMKT1                          WFMKT1
     I              CCJHNY                          WFJHNY
     I              CCR1NA                          WFR1NA
     I              CCRHDT                          WFRHDT
     I              CCC4TM                          WFC4TM
     I              CCMIT1                          WFMIT1
     I              CCMJT1                          WFMJT1
     I              CCHXTX                          WFHXTX
     I              CCHJTX                          WFHJTX
     I              CCHYTX                          WFHYTX
     I              CCJENY                          WFJENY
     I              CCJVNY                          WFJVNY
     I              CCJWNY                          WFJWNY
     I              CCIMTX                          WFIMTX
     I              CCFEDS                          WFFEDS
     I              CCMTT1                          WFMTT1
     I              CCJXNY                          WFJXNY
     I              CCJ1NY                          WFJ1NY
     I              CCJCNY                          WFJCNY
     I              CCJDNY                          WFJDNY
     I              CCJ3NY                          WFJ3NY
     I              CCRLDT                          WFRLDT
     I              CCMSAA                          WFMSAA
     I              CCMTAA                          WFMTAA
     I              CCMUAA                          WFMUAA
     I              CCL8T1                          WFL8T1
     I              CCR0NY                          WFR0NY
     I              CCL7T1                          WFL7T1
     I              CCJQST                          WFJQST
     I              CCWUT1                          WFWUT1
     I              CCWVT1                          WFWVT1
     I              CCJZST                          WFJZST
     I              CCJ0ST                          WFJ0ST
     I              CCTTDT                          WFTTDT
     I              CCDRTM                          WFDRTM
     I              CCWYT1                          WFWYT1
     I              CCJUST                          WFJUST
     I              CCR4NY                          WFR4NY
     I              CCMZAA                          WFMZAA
     I              CCTUDT                          WFTUDT
     I              CCDSTM                          WFDSTM
     I              CCWZT1                          WFWZT1
     I              CCM0AA                          WFM0AA
     I              CCSANY                          WFSANY
     I              CCKJST                          WFKJST
     I              CCKKST                          WFKKST
     I              CCGZPC                          WFGZPC
     I              CCW2T1                          WFW2T1
     I              CCM1AA                          WFM1AA
     I              CCSBNY                          WFSBNY
     I              CCKLST                          WFKLST
     I              CCKPST                          WFKPST
     I              CCG0PC                          WFG0PC
     I              CCW3T1                          WFW3T1
     I              CCM2AA                          WFM2AA
     I              CCSCNY                          WFSCNY
     I              CCKQST                          WFKQST
     I              CCKRST                          WFKRST
     I              CCG1PC                          WFG1PC
     I              CCW4T1                          WFW4T1
     I              CCVSST                          WFVSST
     I              CCMJDT                          WFMJDT
     I              CCBETM                          WFBETM
     I              CCCCVN                          WFCCVN
     I              CCCDVN                          WFCDVN
     I              CCMKDT                          WFMKDT
     I              CCBFTM                          WFBFTM
     I              CCCEVN                          WFCEVN
     I              CCCFVN                          WFCFVN
      *
     I@FNCPCT
      * Manifest Detail           Retrieval index
      * Renamed input format fields
     I              FNAIC3                          WGAIC3
     I              FNC4NB                          WGC4NB
     I              FNDPNB                          WGDPNB
     I              FNUENB                          WGUENB
     I              FNRZNB                          WGRZNB
     I              FNFOQT                          WGFOQT
     I              FNR0NB                          WGR0NB
     I              FNPMST                          WGPMST
     I              FNK7DT                          WGK7DT
     I              FNPFNX                          WGPFNX
     I              FNHGCD                          WGHGCD
     I              FNAJCD                          WGAJCD
     I              FNELDT                          WGELDT
     I              FNN5WG                          WGN5WG
     I              FNRZNA                          WGRZNA
     I              FNH5NY                          WGH5NY
     I              FNH6NY                          WGH6NY
     I              FNH7NY                          WGH7NY
     I              FNGBTX                          WGGBTX
     I              FNN6WG                          WGN6WG
     I              FNN7WG                          WGN7WG
     I              FNGCTX                          WGGCTX
     I              FNGDTX                          WGGDTX
     I              FNRBDT                          WGRBDT
     I              FNITNY                          WGITNY
     I              FNIVNY                          WGIVNY
     I              FNIUNY                          WGIUNY
     I              FNIWNY                          WGIWNY
     I              FNIXNY                          WGIXNY
     I              FNIYNY                          WGIYNY
     I              FNUVST                          WGUVST
     I              FNUWST                          WGUWST
     I              FNUXST                          WGUXST
     I              FNVSST                          WGVSST
     I              FNAATM                          WGAATM
     I              FNAYNA                          WGAYNA
     I              FNA0NA                          WGA0NA
     I              FNAXDT                          WGAXDT
      *
     I@CARED2
      * COA Property Define Hdr   Co/Item Code
      * Renamed input format fields
     I              CAAIC3                          WHAIC3
     I              CAIDAA                          WHIDAA
     I              CAR2NA                          WHR2NA
     I              CAL2T1                          WHL2T1
     I              CAL3T1                          WHL3T1
     I              CAL4T1                          WHL4T1
     I              CAL5T1                          WHL5T1
     I              CAL6T1                          WHL6T1
     I              CAL7T1                          WHL7T1
     I              CAL8T1                          WHL8T1
     I              CAL9T1                          WHL9T1
     I              CAMAT1                          WHMAT1
     I              CAJCNY                          WHJCNY
     I              CAJDNY                          WHJDNY
     I              CAJENY                          WHJENY
     I              CAJFNY                          WHJFNY
     I              CAGMPC                          WHGMPC
     I              CAMBT1                          WHMBT1
     I              CAIEAA                          WHIEAA
     I              CAIFAA                          WHIFAA
     I              CAIGAA                          WHIGAA
     I              CAIHAA                          WHIHAA
     I              CAIIAA                          WHIIAA
     I              CAIJAA                          WHIJAA
     I              CAJQNY                          WHJQNY
     I              CALXST                          WHLXST
     I              CAJRNY                          WHJRNY
     I              CALYST                          WHLYST
     I              CAIMTX                          WHIMTX
     I              CAFEDS                          WHFEDS
     I              CAIBAA                          WHIBAA
     I              CAI1NY                          WHI1NY
     I              CAHCTU                          WHHCTU
     I              CAMCT1                          WHMCT1
     I              CAVSST                          WHVSST
     I              CAMJDT                          WHMJDT
     I              CABETM                          WHBETM
     I              CACCVN                          WHCCVN
     I              CACDVN                          WHCDVN
     I              CAMKDT                          WHMKDT
     I              CABFTM                          WHBFTM
     I              CACEVN                          WHCEVN
     I              CACFVN                          WHCFVN
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WIRMNB
     I              FJAIC3                          WIAIC3
     I              FJAODT                          WIAODT
     I              FJPJST                          WIPJST
     I              FJPKST                          WIPKST
     I              FJRNNB                          WIRNNB
     I              FJDMTX                          WIDMTX
     I              FJDNTX                          WIDNTX
     I              FJDOTX                          WIDOTX
     I              FJWTTX                          WIWTTX
     I              FJWUTX                          WIWUTX
     I              FJRPNB                          WIRPNB
     I              FJFLAM                          WIFLAM
     I              FJXQST                          WIXQST
     I              FJRRNB                          WIRRNB
     I              FJDXTX                          WIDXTX
     I              FJDYTX                          WIDYTX
     I              FJSBNB                          WISBNB
     I              FJBZNA                          WIBZNA
     I              FJRONB                          WIRONB
     I              FJSQNB                          WISQNB
     I              FJR1NB                          WIR1NB
     I              FJVCST                          WIVCST
     I              FJVDST                          WIVDST
     I              FJSDNB                          WISDNB
     I              FJPAOU                          WIPAOU
     I              FJDGWG                          WIDGWG
     I              FJSXNB                          WISXNB
     I              FJHADT                          WIHADT
     I              FJAART                          WIAART
     I              FJDHWG                          WIDHWG
     I              FJDIWG                          WIDIWG
     I              FJAQDT                          WIAQDT
     I              FJS6NB                          WIS6NB
     I              FJT4NB                          WIT4NB
     I              FJPRTM                          WIPRTM
     I              FJNPSV                          WINPSV
     I              FJJ8TX                          WIJ8TX
     I              FJTLMI                          WITLMI
     I              FJJ9TX                          WIJ9TX
     I              FJQ2CD                          WIQ2CD
     I              FJVPCD                          WIVPCD
     I              FJDBCD                          WIDBCD
     I              FJGRWE                          WIGRWE
     I              FJXCCD                          WIXCCD
     I              FJU2ST                          WIU2ST
     I              FJF9DT                          WIF9DT
     I              FJONTM                          WIONTM
     I              FJJ4DT                          WIJ4DT
     I              FJTRTM                          WITRTM
     I              FJJ5DT                          WIJ5DT
     I              FJSPTM                          WISPTM
     I              FJJ6DT                          WIJ6DT
     I              FJLFTM                          WILFTM
     I              FJJ7DT                          WIJ7DT
     I              FJBOTM                          WIBOTM
     I              FJJ8DT                          WIJ8DT
     I              FJBLTM                          WIBLTM
     I              FJKIDT                          WIKIDT
     I              FJASTM                          WIASTM
     I              FJKADT                          WIKADT
     I              FJAJCM                          WIAJCM
     I              FJXACD                          WIXACD
     I              FJOANA                          WIOANA
     I              FJK4TX                          WIK4TX
     I              FJVOAG                          WIVOAG
     I              FJKBDT                          WIKBDT
     I              FJNBBO                          WINBBO
     I              FJW4CD                          WIW4CD
     I              FJEFDT                          WIEFDT
     I              FJCNTN                          WICNTN
     I              FJKCDT                          WIKCDT
     I              FJTMIN                          WITMIN
     I              FJKDDT                          WIKDDT
     I              FJVMNB                          WIVMNB
     I              FJOCFR                          WIOCFR
     I              FJKJDT                          WIKJDT
     I              FJATTM                          WIATTM
     I              FJOTRS                          WIOTRS
     I              FJRNST                          WIRNST
     I              FJBRBK                          WIBRBK
     I              FJEIDT                          WIEIDT
     I              FJRMST                          WIRMST
     I              FJAJCD                          WIAJCD
     I              FJKKDT                          WIKKDT
     I              FJAVTM                          WIAVTM
     I              FJKZDT                          WIKZDT
     I              FJAXTM                          WIAXTM
     I              FJLHOS                          WILHOS
     I              FJLHOR                          WILHOR
     I              FJWNTX                          WIWNTX
     I              FJOITX                          WIOITX
     I              FJOJTX                          WIOJTX
     I              FJLLDT                          WILLDT
     I              FJLSHG                          WILSHG
     I              FJYPST                          WIYPST
     I              FJK0DT                          WIK0DT
     I              FJAYTM                          WIAYTM
     I              FJKNNX                          WIKNNX
     I              FJICWG                          WIICWG
     I              FJIDWG                          WIIDWG
     I              FJH9SX                          WIH9SX
     I              FJWOTX                          WIWOTX
     I              FJK1DT                          WIK1DT
     I              FJAZTM                          WIAZTM
     I              FJK2DT                          WIK2DT
     I              FJA0TM                          WIA0TM
     I              FJROST                          WIROST
     I              FJRPST                          WIRPST
     I              FJRQST                          WIRQST
     I              FJRRST                          WIRRST
     I              FJZBVA                          WIZBVA
     I              FJWPTX                          WIWPTX
     I              FJWQTX                          WIWQTX
     I              FJWRTX                          WIWRTX
     I              FJWSTX                          WIWSTX
     I              FJRVSX                          WIRVSX
     I              FJRUSX                          WIRUSX
     I              FJRWSX                          WIRWSX
     I              FJRXSX                          WIRXSX
     I              FJRYSX                          WIRYSX
     I              FJRZSX                          WIRZSX
     I              FJR0SX                          WIR0SX
     I              FJR1SX                          WIR1SX
     I              FJR2SX                          WIR2SX
     I              FJR3SX                          WIR3SX
     I              FJR4SX                          WIR4SX
     I              FJPYDT                          WIPYDT
     I              FJCKTM                          WICKTM
     I              FJPZDT                          WIPZDT
     I              FJCLTM                          WICLTM
     I              FJP0DT                          WIP0DT
     I              FJCMTM                          WICMTM
     I              FJP1DT                          WIP1DT
     I              FJCNTM                          WICNTM
     I              FJP2DT                          WIP2DT
     I              FJCOTM                          WICOTM
     I              FJP3DT                          WIP3DT
     I              FJCQTM                          WICQTM
     I              FJUVST                          WIUVST
     I              FJUWST                          WIUWST
     I              FJUXST                          WIUXST
     I              FJAATM                          WIAATM
     I              FJAYNA                          WIAYNA
     I              FJA0NA                          WIA0NA
     I              FJAXDT                          WIAXDT
      *
     I@GJREHH
      * RFS API Volume Corr Table Retrieval index
      * Renamed input format fields
     I              GJSSNY                          WJSSNY
     I              GJSTNY                          WJSTNY
     I              GJSUNY                          WJSUNY
     I              GJK7ST                          WJK7ST
     I              GJSVNY                          WJSVNY
     I              GJVSST                          WJVSST
     I              GJMJDT                          WJMJDT
     I              GJBETM                          WJBETM
     I              GJCCVN                          WJCCVN
     I              GJCDVN                          WJCDVN
     I              GJMKDT                          WJMKDT
     I              GJBFTM                          WJBFTM
     I              GJCEVN                          WJCEVN
     I              GJCFVN                          WJCFVN
      *
     I@BFCPY2
      * Order Header TRG          Ord-D/Co
      * Renamed input format fields
     I              BEAIC3                          WKAIC3
     I              BEC4NB                          WKC4NB
     I              BEJNCD                          WKJNCD
     I              BEANC7                          WKANC7
     I              BEBKC7                          WKBKC7
     I              BEBRTX                          WKBRTX
     I              BEHMNA                          WKHMNA
     I              BEHONA                          WKHONA
     I              BEHPNA                          WKHPNA
     I              BEHNNA                          WKHNNA
     I              BEDBCD                          WKDBCD
     I              BECKTX                          WKCKTX
     I              BEB0C7                          WKB0C7
     I              BEAETX                          WKAETX
     I              BEB1NA                          WKB1NA
     I              BEB3NA                          WKB3NA
     I              BEB4NA                          WKB4NA
     I              BEB2NA                          WKB2NA
     I              BEBHCD                          WKBHCD
     I              BEC8TX                          WKC8TX
     I              BEBCNA                          WKBCNA
     I              BEA0DT                          WKA0DT
     I              BEA5DT                          WKA5DT
     I              BEGNDT                          WKGNDT
     I              BEACDT                          WKACDT
     I              BEAQCD                          WKAQCD
     I              BEB6NA                          WKB6NA
     I              BEBYNA                          WKBYNA
     I              BEBZNA                          WKBZNA
     I              BEGTST                          WKGTST
     I              BEGVST                          WKGVST
     I              BEGUST                          WKGUST
     I              BEQFST                          WKQFST
     I              BECQCD                          WKCQCD
     I              BEGJST                          WKGJST
     I              BEGWST                          WKGWST
     I              BEGXST                          WKGXST
     I              BEGYST                          WKGYST
     I              BEAODT                          WKAODT
     I              BEAIVN                          WKAIVN
     I              BECXDT                          WKCXDT
     I              BEJZVA                          WKJZVA
     I              BEA1WG                          WKA1WG
     I              BEXIST                          WKXIST
     I              BEXJST                          WKXJST
     I              BEXKST                          WKXKST
     I              BEEIDT                          WKEIDT
     I              BEAFTM                          WKAFTM
     I              BEE8CD                          WKE8CD
     I              BEE9CD                          WKE9CD
     I              BERMNB                          WKRMNB
     I              BETBNB                          WKTBNB
     I              BER1NB                          WKR1NB
     I              BEPJST                          WKPJST
     I              BEU0ST                          WKU0ST
     I              BEU1ST                          WKU1ST
     I              BEQ2CD                          WKQ2CD
     I              BEU2ST                          WKU2ST
     I              BEVEST                          WKVEST
     I              BEVFST                          WKVFST
     I              BEVGST                          WKVGST
     I              BERPCD                          WKRPCD
     I              BERNNB                          WKRNNB
     I              BEVDST                          WKVDST
     I              BEATIN                          WKATIN
     I              BEU4ST                          WKU4ST
     I              BEU5ST                          WKU5ST
     I              BERSRN                          WKRSRN
     I              BEMHNA                          WKMHNA
     I              BEMINA                          WKMINA
     I              BEWBST                          WKWBST
     I              BER4CD                          WKR4CD
     I              BEBFCD                          WKBFCD
     I              BEQ4CD                          WKQ4CD
     I              BET3NB                          WKT3NB
     I              BESICD                          WKSICD
     I              BECONB                          WKCONB
     I              BECEST                          WKCEST
     I              BEAWDT                          WKAWDT
     I              BEJPCD                          WKJPCD
     I              BEXUST                          WKXUST
     I              BEZ1ST                          WKZ1ST
     I              BEVRVA                          WKVRVA
     I              BEOBST                          WKOBST
     I              BEBCST                          WKBCST
     I              BEBDST                          WKBDST
     I              BEB7VL                          WKB7VL
     I              BEGASX                          WKGASX
     I              BEGBSX                          WKGBSX
     I              BEGCSX                          WKGCSX
     I              BEGDSX                          WKGDSX
     I              BEFNSX                          WKFNSX
     I              BEFOSX                          WKFOSX
     I              BEFPSX                          WKFPSX
     I              BEFQSX                          WKFQSX
     I              BEFRSX                          WKFRSX
     I              BEFSSX                          WKFSSX
     I              BEFTSX                          WKFTSX
     I              BEFUSX                          WKFUSX
     I              BEFVSX                          WKFVSX
     I              BEFWSX                          WKFWSX
     I              BEFXSX                          WKFXSX
     I              BEFYSX                          WKFYSX
     I              BENODT                          WKNODT
     I              BENPDT                          WKNPDT
     I              BENQDT                          WKNQDT
     I              BENRDT                          WKNRDT
     I              BENSDT                          WKNSDT
     I              BEBPTM                          WKBPTM
     I              BEBQTM                          WKBQTM
     I              BEBRTM                          WKBRTM
     I              BEBSTM                          WKBSTM
     I              BEBTTM                          WKBTTM
     I              BEH0NX                          WKH0NX
     I              BEH1NX                          WKH1NX
     I              BEH2NX                          WKH2NX
     I              BEH3NX                          WKH3NX
     I              BEH4NX                          WKH4NX
     I              BEC0C7                          WKC0C7
     I              BEUVST                          WKUVST
     I              BEUWST                          WKUWST
     I              BEUXST                          WKUXST
     I              BEAATM                          WKAATM
     I              BEAYNA                          WKAYNA
     I              BEA0NA                          WKA0NA
     I              BEAXDT                          WKAXDT
      *
     I@AMREJF
      * Order Header Extension    Retrieval index
      * Renamed input format fields
     I              AMAIC3                          WLAIC3
     I              AMC4NB                          WLC4NB
     I              AMRMNB                          WLRMNB
     I              AMRUNB                          WLRUNB
     I              AMXACD                          WLXACD
     I              AMOANA                          WLOANA
     I              AMHBAA                          WLHBAA
     I              AMJ0T1                          WLJ0T1
     I              AMGENY                          WLGENY
     I              AMJ1T1                          WLJ1T1
     I              AMHCAA                          WLHCAA
     I              AMQWDT                          WLQWDT
     I              AMQXDT                          WLQXDT
     I              AMQYDT                          WLQYDT
     I              AMHDAA                          WLHDAA
     I              AMCCTX                          WLCCTX
     I              AMJ2T1                          WLJ2T1
     I              AMRLNA                          WLRLNA
     I              AMRMNA                          WLRMNA
     I              AMGINY                          WLGINY
     I              AMGFNY                          WLGFNY
     I              AMGGNY                          WLGGNY
     I              AMGHNY                          WLGHNY
     I              AMHEVL                          WLHEVL
     I              AMHFVL                          WLHFVL
     I              AMHGVL                          WLHGVL
     I              AMQZDT                          WLQZDT
     I              AMQ0DT                          WLQ0DT
     I              AMQ1DT                          WLQ1DT
     I              AMQ2DT                          WLQ2DT
     I              AMC2TX                          WLC2TX
     I              AMC3TX                          WLC3TX
     I              AMC6TX                          WLC6TX
     I              AMCHTX                          WLCHTX
     I              AMCITX                          WLCITX
     I              AMCLTX                          WLCLTX
     I              AMB4TX                          WLB4TX
     I              AMCUTX                          WLCUTX
     I              AMCVTX                          WLCVTX
     I              AMB9TX                          WLB9TX
     I              AMJWSC                          WLJWSC
     I              AMITNY                          WLITNY
     I              AMLMT1                          WLLMT1
     I              AMLWAA                          WLLWAA
     I              AMFVST                          WLFVST
     I              AMF0ST                          WLF0ST
     I              AMF2ST                          WLF2ST
     I              AMF3ST                          WLF3ST
     I              AMJUSC                          WLJUSC
     I              AMJVSC                          WLJVSC
     I              AMV3T1                          WLV3T1
     I              AMV4T1                          WLV4T1
     I              AMV5T1                          WLV5T1
     I              AMV6T1                          WLV6T1
     I              AMV7T1                          WLV7T1
     I              AMV8T1                          WLV8T1
     I              AMV9T1                          WLV9T1
     I              AMWAT1                          WLWAT1
     I              AMWBT1                          WLWBT1
     I              AMWCT1                          WLWCT1
     I              AMWDT1                          WLWDT1
     I              AMQJNY                          WLQJNY
     I              AMQKNY                          WLQKNY
     I              AMQLNY                          WLQLNY
     I              AMP8NY                          WLP8NY
     I              AMP9NY                          WLP9NY
     I              AMQANY                          WLQANY
     I              AMQCNY                          WLQCNY
     I              AMQDNY                          WLQDNY
     I              AMQENY                          WLQENY
     I              AMQFNY                          WLQFNY
     I              AMQGNY                          WLQGNY
     I              AMQHNY                          WLQHNY
     I              AMQINY                          WLQINY
     I              AMQMNY                          WLQMNY
     I              AMMYU1                          WLMYU1
     I              AMJXSC                          WLJXSC
     I              AMJYSC                          WLJYSC
     I              AMJZSC                          WLJZSC
     I              AMJ0SC                          WLJ0SC
     I              AMMZU1                          WLMZU1
     I              AMM0U1                          WLM0U1
     I              AMM1U1                          WLM1U1
     I              AMM2U1                          WLM2U1
     I              AMM3U1                          WLM3U1
     I              AMW5DT                          WLW5DT
     I              AMW6DT                          WLW6DT
     I              AMUVST                          WLUVST
     I              AMUWST                          WLUWST
     I              AMUXST                          WLUXST
     I              AMVSST                          WLVSST
     I              AMAATM                          WLAATM
     I              AMAYNA                          WLAYNA
     I              AMA0NA                          WLA0NA
     I              AMAXDT                          WLAXDT
      *
     I@NIREBO
      * Company Customer EXT      Retrieval index
      * Renamed input format fields
     I              NIAIC3                          WMAIC3
     I              NIBKC7                          WMBKC7
     I              NIUFTX                          WMUFTX
     I              NIUGTX                          WMUGTX
     I              NIPFNA                          WMPFNA
     I              NIJ5NX                          WMJ5NX
     I              NIU5TX                          WMU5TX
     I              NIU6TX                          WMU6TX
     I              NIW0TX                          WMW0TX
     I              NIKSNX                          WMKSNX
     I              NIPENX                          WMPENX
     I              NIHSSX                          WMHSSX
     I              NIHTSX                          WMHTSX
     I              NIHUSX                          WMHUSX
     I              NIHVSX                          WMHVSX
     I              NINCT1                          WMNCT1
     I              NIM9T1                          WMM9T1
     I              NINAT1                          WMNAT1
     I              NIL9AA                          WML9AA
     I              NIWJT1                          WMWJT1
     I              NIHLST                          WMHLST
     I              NIHMST                          WMHMST
     I              NINBT1                          WMNBT1
     I              NIWKT1                          WMWKT1
     I              NIJ7NY                          WMJ7NY
     I              NIRJNY                          WMRJNY
     I              NIRKNY                          WMRKNY
     I              NIH9ST                          WMH9ST
     I              NIAATM                          WMAATM
     I              NIAYNA                          WMAYNA
     I              NIA0NA                          WMA0NA
     I              NIAXDT                          WMAXDT
      *
     I@EOREU0
      * Company Customer          Customer/Company
      * Renamed input format fields
     I              EOAIC3                          WOAIC3
     I              EOBKC7                          WOBKC7
     I              EOAQCD                          WOAQCD
     I              EOR4CD                          WOR4CD
     I              EOBYNA                          WOBYNA
     I              EOB6NA                          WOB6NA
     I              EOBZNA                          WOBZNA
     I              EOLLST                          WOLLST
     I              EOPPST                          WOPPST
     I              EOR5NB                          WOR5NB
     I              EOR6NB                          WOR6NB
     I              EOQGST                          WOQGST
     I              EOBOCD                          WOBOCD
     I              EOTBNB                          WOTBNB
     I              EOMTCU                          WOMTCU
     I              EOW2NB                          WOW2NB
     I              EORPCD                          WORPCD
     I              EOAJCD                          WOAJCD
     I              EOX9ST                          WOX9ST
     I              EOT9CD                          WOT9CD
     I              EOUBCD                          WOUBCD
     I              EOISTX                          WOISTX
     I              EOLQCD                          WOLQCD
     I              EONJNA                          WONJNA
     I              EOI0TX                          WOI0TX
     I              EONKNA                          WONKNA
     I              EOI1TX                          WOI1TX
     I              EOVLST                          WOVLST
     I              EORLST                          WORLST
     I              EOMMTX                          WOMMTX
     I              EOOHNA                          WOOHNA
     I              EOQ6ST                          WOQ6ST
     I              EOQ8ST                          WOQ8ST
     I              EORBST                          WORBST
     I              EOREST                          WOREST
     I              EOUVST                          WOUVST
     I              EOUWST                          WOUWST
     I              EOUXST                          WOUXST
     I              EOVSST                          WOVSST
     I              EOAATM                          WOAATM
     I              EOAYNA                          WOAYNA
     I              EOA0NA                          WOA0NA
     I              EOAXDT                          WOAXDT
      *
     I@DACPP5
      * COA Batch Header RIN      Update index
      * Renamed input format fields
     I              DAAIC3                          WRAIC3
     I              DAL6T1                          WRL6T1
     I              DAI3NY                          WRI3NY
     I              DAJYNY                          WRJYNY
     I              DAQ1NY                          WRQ1NY
     I              DAMUT1                          WRMUT1
     I              DAJZNY                          WRJZNY
     I              DAJ0NY                          WRJ0NY
     I              DAJ2NY                          WRJ2NY
     I              DARIDT                          WRRIDT
     I              DAC5TM                          WRC5TM
     I              DAMVT1                          WRMVT1
     I              DAMWT1                          WRMWT1
     I              DARINT                          WRRINT
     I              DARJDT                          WRRJDT
     I              DAC6TM                          WRC6TM
     I              DAC4NB                          WRC4NB
     I              DADPNB                          WRDPNB
     I              DAUENB                          WRUENB
     I              DARZNB                          WRRZNB
     I              DANGT1                          WRNGT1
     I              DARMNB                          WRRMNB
     I              DARKDT                          WRRKDT
     I              DAC7TM                          WRC7TM
     I              DARINS                          WRRINS
     I              DAMXT1                          WRMXT1
     I              DAG3ST                          WRG3ST
     I              DAQWNY                          WRQWNY
     I              DAL0AA                          WRL0AA
     I              DAMAT1                          WRMAT1
     I              DATDNA                          WRTDNA
     I              DACWC3                          WRCWC3
     I              DAQXNY                          WRQXNY
     I              DAQZNY                          WRQZNY
     I              DAQ0NY                          WRQ0NY
     I              DALVTX                          WRLVTX
     I              DANYT1                          WRNYT1
     I              DAG5ST                          WRG5ST
     I              DAG7ST                          WRG7ST
     I              DATFDT                          WRTFDT
     I              DATGDT                          WRTGDT
     I              DAWIT1                          WRWIT1
     I              DAQYNY                          WRQYNY
     I              DAL7T1                          WRL7T1
     I              DAR8NY                          WRR8NY
     I              DAR0NY                          WRR0NY
     I              DAI7AA                          WRI7AA
     I              DAMXAA                          WRMXAA
     I              DAMSAA                          WRMSAA
     I              DAR7NY                          WRR7NY
     I              DAHEPR                          WRHEPR
     I              DAHFPR                          WRHFPR
     I              DAWVT1                          WRWVT1
     I              DAW0T1                          WRW0T1
     I              DAR5NY                          WRR5NY
     I              DAW1T1                          WRW1T1
     I              DAR6NY                          WRR6NY
     I              DAJ1ST                          WRJ1ST
     I              DAKHST                          WRKHST
     I              DATWDT                          WRTWDT
     I              DADUTM                          WRDUTM
     I              DAKGST                          WRKGST
     I              DATVDT                          WRTVDT
     I              DADTTM                          WRDTTM
     I              DAR9NY                          WRR9NY
     I              DASQNY                          WRSQNY
     I              DABHR3                          WRBHR3
     I              DASRNY                          WRSRNY
     I              DAW7T1                          WRW7T1
     I              DAW8T1                          WRW8T1
     I              DAT2DT                          WRT2DT
     I              DASXNY                          WRSXNY
     I              DASYNY                          WRSYNY
     I              DASZNY                          WRSZNY
     I              DAVSST                          WRVSST
     I              DAMJDT                          WRMJDT
     I              DABETM                          WRBETM
     I              DACCVN                          WRCCVN
     I              DACDVN                          WRCDVN
     I              DAMKDT                          WRMKDT
     I              DABFTM                          WRBFTM
     I              DACEVN                          WRCEVN
     I              DACFVN                          WRCFVN
      *
     I@CCCPOG
      * COA Batch Header          Update index
      * Renamed input format fields
     I              CCAIC3                          WSAIC3
     I              CCL6T1                          WSL6T1
     I              CCI3NY                          WSI3NY
     I              CCIKAA                          WSIKAA
     I              CCIDAA                          WSIDAA
     I              CCRFDT                          WSRFDT
     I              CCC2TM                          WSC2TM
     I              CCMHT1                          WSMHT1
     I              CCRGDT                          WSRGDT
     I              CCC3TM                          WSC3TM
     I              CCMKT1                          WSMKT1
     I              CCJHNY                          WSJHNY
     I              CCR1NA                          WSR1NA
     I              CCRHDT                          WSRHDT
     I              CCC4TM                          WSC4TM
     I              CCMIT1                          WSMIT1
     I              CCMJT1                          WSMJT1
     I              CCHXTX                          WSHXTX
     I              CCHJTX                          WSHJTX
     I              CCHYTX                          WSHYTX
     I              CCJENY                          WSJENY
     I              CCJVNY                          WSJVNY
     I              CCJWNY                          WSJWNY
     I              CCIMTX                          WSIMTX
     I              CCFEDS                          WSFEDS
     I              CCMTT1                          WSMTT1
     I              CCJXNY                          WSJXNY
     I              CCJ1NY                          WSJ1NY
     I              CCJCNY                          WSJCNY
     I              CCJDNY                          WSJDNY
     I              CCJ3NY                          WSJ3NY
     I              CCRLDT                          WSRLDT
     I              CCMSAA                          WSMSAA
     I              CCMTAA                          WSMTAA
     I              CCMUAA                          WSMUAA
     I              CCL8T1                          WSL8T1
     I              CCR0NY                          WSR0NY
     I              CCL7T1                          WSL7T1
     I              CCJQST                          WSJQST
     I              CCWUT1                          WSWUT1
     I              CCWVT1                          WSWVT1
     I              CCJZST                          WSJZST
     I              CCJ0ST                          WSJ0ST
     I              CCTTDT                          WSTTDT
     I              CCDRTM                          WSDRTM
     I              CCWYT1                          WSWYT1
     I              CCJUST                          WSJUST
     I              CCR4NY                          WSR4NY
     I              CCMZAA                          WSMZAA
     I              CCTUDT                          WSTUDT
     I              CCDSTM                          WSDSTM
     I              CCWZT1                          WSWZT1
     I              CCM0AA                          WSM0AA
     I              CCSANY                          WSSANY
     I              CCKJST                          WSKJST
     I              CCKKST                          WSKKST
     I              CCGZPC                          WSGZPC
     I              CCW2T1                          WSW2T1
     I              CCM1AA                          WSM1AA
     I              CCSBNY                          WSSBNY
     I              CCKLST                          WSKLST
     I              CCKPST                          WSKPST
     I              CCG0PC                          WSG0PC
     I              CCW3T1                          WSW3T1
     I              CCM2AA                          WSM2AA
     I              CCSCNY                          WSSCNY
     I              CCKQST                          WSKQST
     I              CCKRST                          WSKRST
     I              CCG1PC                          WSG1PC
     I              CCW4T1                          WSW4T1
     I              CCVSST                          WSVSST
     I              CCMJDT                          WSMJDT
     I              CCBETM                          WSBETM
     I              CCCCVN                          WSCCVN
     I              CCCDVN                          WSCDVN
     I              CCMKDT                          WSMKDT
     I              CCBFTM                          WSBFTM
     I              CCCEVN                          WSCEVN
     I              CCCFVN                          WSCFVN
      *
     I@DACPP6
      * COA Batch Header RIN      Retrieval index
      * Renamed input format fields
     I              DAAIC3                          WTAIC3
     I              DAL6T1                          WTL6T1
     I              DAI3NY                          WTI3NY
     I              DAJYNY                          WTJYNY
     I              DAQ1NY                          WTQ1NY
     I              DAMUT1                          WTMUT1
     I              DAJZNY                          WTJZNY
     I              DAJ0NY                          WTJ0NY
     I              DAJ2NY                          WTJ2NY
     I              DARIDT                          WTRIDT
     I              DAC5TM                          WTC5TM
     I              DAMVT1                          WTMVT1
     I              DAMWT1                          WTMWT1
     I              DARINT                          WTRINT
     I              DARJDT                          WTRJDT
     I              DAC6TM                          WTC6TM
     I              DAC4NB                          WTC4NB
     I              DADPNB                          WTDPNB
     I              DAUENB                          WTUENB
     I              DARZNB                          WTRZNB
     I              DANGT1                          WTNGT1
     I              DARMNB                          WTRMNB
     I              DARKDT                          WTRKDT
     I              DAC7TM                          WTC7TM
     I              DARINS                          WTRINS
     I              DAMXT1                          WTMXT1
     I              DAG3ST                          WTG3ST
     I              DAQWNY                          WTQWNY
     I              DAL0AA                          WTL0AA
     I              DAMAT1                          WTMAT1
     I              DATDNA                          WTTDNA
     I              DACWC3                          WTCWC3
     I              DAQXNY                          WTQXNY
     I              DAQZNY                          WTQZNY
     I              DAQ0NY                          WTQ0NY
     I              DALVTX                          WTLVTX
     I              DANYT1                          WTNYT1
     I              DAG5ST                          WTG5ST
     I              DAG7ST                          WTG7ST
     I              DATFDT                          WTTFDT
     I              DATGDT                          WTTGDT
     I              DAWIT1                          WTWIT1
     I              DAQYNY                          WTQYNY
     I              DAL7T1                          WTL7T1
     I              DAR8NY                          WTR8NY
     I              DAR0NY                          WTR0NY
     I              DAI7AA                          WTI7AA
     I              DAMXAA                          WTMXAA
     I              DAMSAA                          WTMSAA
     I              DAR7NY                          WTR7NY
     I              DAHEPR                          WTHEPR
     I              DAHFPR                          WTHFPR
     I              DAWVT1                          WTWVT1
     I              DAW0T1                          WTW0T1
     I              DAR5NY                          WTR5NY
     I              DAW1T1                          WTW1T1
     I              DAR6NY                          WTR6NY
     I              DAJ1ST                          WTJ1ST
     I              DAKHST                          WTKHST
     I              DATWDT                          WTTWDT
     I              DADUTM                          WTDUTM
     I              DAKGST                          WTKGST
     I              DATVDT                          WTTVDT
     I              DADTTM                          WTDTTM
     I              DAR9NY                          WTR9NY
     I              DASQNY                          WTSQNY
     I              DABHR3                          WTBHR3
     I              DASRNY                          WTSRNY
     I              DAW7T1                          WTW7T1
     I              DAW8T1                          WTW8T1
     I              DAT2DT                          WTT2DT
     I              DASXNY                          WTSXNY
     I              DASYNY                          WTSYNY
     I              DASZNY                          WTSZNY
     I              DAVSST                          WTVSST
     I              DAMJDT                          WTMJDT
     I              DABETM                          WTBETM
     I              DACCVN                          WTCCVN
     I              DACDVN                          WTCDVN
     I              DAMKDT                          WTMKDT
     I              DABFTM                          WTBFTM
     I              DACEVN                          WTCEVN
     I              DACFVN                          WTCFVN
      *
     I@GGREG2
      * RFS Transaction Reason    Retrieval index
      * Renamed input format fields
     I              GGI7AA                          WVI7AA
     I              GGMXAA                          WVMXAA
     I              GGWTT1                          WVWTT1
     I              GGJPST                          WVJPST
     I              GGVSST                          WVVSST
     I              GGMJDT                          WVMJDT
     I              GGBETM                          WVBETM
     I              GGCCVN                          WVCCVN
     I              GGCDVN                          WVCDVN
     I              GGMKDT                          WVMKDT
     I              GGBFTM                          WVBFTM
     I              GGCEVN                          WVCEVN
     I              GGCFVN                          WVCFVN
      *
     I@FPCPDP
      * Manifest Detail RIN Sell  Retrieval index
      * Renamed input format fields
     I              FPAIC3                          WWAIC3
     I              FPC4NB                          WWC4NB
     I              FPDPNB                          WWDPNB
     I              FPUENB                          WWUENB
     I              FPRZNB                          WWRZNB
     I              FPL6T1                          WWL6T1
     I              FPI3NY                          WWI3NY
     I              FPJYNY                          WWJYNY
     I              FPQ1NY                          WWQ1NY
     I              FPN6WG                          WWN6WG
     I              FPRCNY                          WWRCNY
     I              FPHJST                          WWHJST
     I              FPVSST                          WWVSST
     I              FPMJDT                          WWMJDT
     I              FPBETM                          WWBETM
     I              FPCCVN                          WWCCVN
     I              FPCDVN                          WWCDVN
     I              FPMKDT                          WWMKDT
     I              FPBFTM                          WWBFTM
     I              FPCEVN                          WWCEVN
     I              FPCFVN                          WWCFVN
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
     IQPMDA1    E DSPMDACPL0
      * UPD : COA Batch Header RIN      Update index
      * Renamed input format fields
     I              DAAIC3                          WRAIC3
     I              DAL6T1                          WRL6T1
     I              DAI3NY                          WRI3NY
     I              DAJYNY                          WRJYNY
     I              DAQ1NY                          WRQ1NY
     I              DAMUT1                          WRMUT1
     I              DAJZNY                          WRJZNY
     I              DAJ0NY                          WRJ0NY
     I              DAJ2NY                          WRJ2NY
     I              DARIDT                          WRRIDT
     I              DAC5TM                          WRC5TM
     I              DAMVT1                          WRMVT1
     I              DAMWT1                          WRMWT1
     I              DARINT                          WRRINT
     I              DARJDT                          WRRJDT
     I              DAC6TM                          WRC6TM
     I              DAC4NB                          WRC4NB
     I              DADPNB                          WRDPNB
     I              DAUENB                          WRUENB
     I              DARZNB                          WRRZNB
     I              DANGT1                          WRNGT1
     I              DARMNB                          WRRMNB
     I              DARKDT                          WRRKDT
     I              DAC7TM                          WRC7TM
     I              DARINS                          WRRINS
     I              DAMXT1                          WRMXT1
     I              DAG3ST                          WRG3ST
     I              DAQWNY                          WRQWNY
     I              DAL0AA                          WRL0AA
     I              DAMAT1                          WRMAT1
     I              DATDNA                          WRTDNA
     I              DACWC3                          WRCWC3
     I              DAQXNY                          WRQXNY
     I              DAQZNY                          WRQZNY
     I              DAQ0NY                          WRQ0NY
     I              DALVTX                          WRLVTX
     I              DANYT1                          WRNYT1
     I              DAG5ST                          WRG5ST
     I              DAG7ST                          WRG7ST
     I              DATFDT                          WRTFDT
     I              DATGDT                          WRTGDT
     I              DAWIT1                          WRWIT1
     I              DAQYNY                          WRQYNY
     I              DAL7T1                          WRL7T1
     I              DAR8NY                          WRR8NY
     I              DAR0NY                          WRR0NY
     I              DAI7AA                          WRI7AA
     I              DAMXAA                          WRMXAA
     I              DAMSAA                          WRMSAA
     I              DAR7NY                          WRR7NY
     I              DAHEPR                          WRHEPR
     I              DAHFPR                          WRHFPR
     I              DAWVT1                          WRWVT1
     I              DAW0T1                          WRW0T1
     I              DAR5NY                          WRR5NY
     I              DAW1T1                          WRW1T1
     I              DAR6NY                          WRR6NY
     I              DAJ1ST                          WRJ1ST
     I              DAKHST                          WRKHST
     I              DATWDT                          WRTWDT
     I              DADUTM                          WRDUTM
     I              DAKGST                          WRKGST
     I              DATVDT                          WRTVDT
     I              DADTTM                          WRDTTM
     I              DAR9NY                          WRR9NY
     I              DASQNY                          WRSQNY
     I              DABHR3                          WRBHR3
     I              DASRNY                          WRSRNY
     I              DAW7T1                          WRW7T1
     I              DAW8T1                          WRW8T1
     I              DAT2DT                          WRT2DT
     I              DASXNY                          WRSXNY
     I              DASYNY                          WRSYNY
     I              DASZNY                          WRSZNY
     I              DAVSST                          WRVSST
     I              DAMJDT                          WRMJDT
     I              DABETM                          WRBETM
     I              DACCVN                          WRCCVN
     I              DACDVN                          WRCDVN
     I              DAMKDT                          WRMKDT
     I              DABFTM                          WRBFTM
     I              DACEVN                          WRCEVN
     I              DACFVN                          WRCFVN
      *
     IYARDCS      DS                            563
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPMCC1    E DSPMCCCPL0
      * UPD : COA Batch Header          Update index
      * Renamed input format fields
     I              CCAIC3                          WSAIC3
     I              CCL6T1                          WSL6T1
     I              CCI3NY                          WSI3NY
     I              CCIKAA                          WSIKAA
     I              CCIDAA                          WSIDAA
     I              CCRFDT                          WSRFDT
     I              CCC2TM                          WSC2TM
     I              CCMHT1                          WSMHT1
     I              CCRGDT                          WSRGDT
     I              CCC3TM                          WSC3TM
     I              CCMKT1                          WSMKT1
     I              CCJHNY                          WSJHNY
     I              CCR1NA                          WSR1NA
     I              CCRHDT                          WSRHDT
     I              CCC4TM                          WSC4TM
     I              CCMIT1                          WSMIT1
     I              CCMJT1                          WSMJT1
     I              CCHXTX                          WSHXTX
     I              CCHJTX                          WSHJTX
     I              CCHYTX                          WSHYTX
     I              CCJENY                          WSJENY
     I              CCJVNY                          WSJVNY
     I              CCJWNY                          WSJWNY
     I              CCIMTX                          WSIMTX
     I              CCFEDS                          WSFEDS
     I              CCMTT1                          WSMTT1
     I              CCJXNY                          WSJXNY
     I              CCJ1NY                          WSJ1NY
     I              CCJCNY                          WSJCNY
     I              CCJDNY                          WSJDNY
     I              CCJ3NY                          WSJ3NY
     I              CCRLDT                          WSRLDT
     I              CCMSAA                          WSMSAA
     I              CCMTAA                          WSMTAA
     I              CCMUAA                          WSMUAA
     I              CCL8T1                          WSL8T1
     I              CCR0NY                          WSR0NY
     I              CCL7T1                          WSL7T1
     I              CCJQST                          WSJQST
     I              CCWUT1                          WSWUT1
     I              CCWVT1                          WSWVT1
     I              CCJZST                          WSJZST
     I              CCJ0ST                          WSJ0ST
     I              CCTTDT                          WSTTDT
     I              CCDRTM                          WSDRTM
     I              CCWYT1                          WSWYT1
     I              CCJUST                          WSJUST
     I              CCR4NY                          WSR4NY
     I              CCMZAA                          WSMZAA
     I              CCTUDT                          WSTUDT
     I              CCDSTM                          WSDSTM
     I              CCWZT1                          WSWZT1
     I              CCM0AA                          WSM0AA
     I              CCSANY                          WSSANY
     I              CCKJST                          WSKJST
     I              CCKKST                          WSKKST
     I              CCGZPC                          WSGZPC
     I              CCW2T1                          WSW2T1
     I              CCM1AA                          WSM1AA
     I              CCSBNY                          WSSBNY
     I              CCKLST                          WSKLST
     I              CCKPST                          WSKPST
     I              CCG0PC                          WSG0PC
     I              CCW3T1                          WSW3T1
     I              CCM2AA                          WSM2AA
     I              CCSCNY                          WSSCNY
     I              CCKQST                          WSKQST
     I              CCKRST                          WSKRST
     I              CCG1PC                          WSG1PC
     I              CCW4T1                          WSW4T1
     I              CCVSST                          WSVSST
     I              CCMJDT                          WSMJDT
     I              CCBETM                          WSBETM
     I              CCCCVN                          WSCCVN
     I              CCCDVN                          WSCDVN
     I              CCMKDT                          WSMKDT
     I              CCBFTM                          WSBFTM
     I              CCCEVN                          WSCEVN
     I              CCCFVN                          WSCFVN
      *
     IYBRDCS      DS                            659
     IYCRDCS      DS                            563
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: COA Batch Header RIN
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * N :  COA Batch Header RIN
     I                                        3  40 P1MUT1
      * N :  COA RIN SSSSSSSS
     I                                    P  41  450P1JZNY
      * N :  COA RIN EEEEEEEE
     I                                    P  46  500P1J0NY
      * N :  COA RIN Volume in Gallons
     I                                    P  51  550P1J2NY
      * I :  Order Number
     I                                    P  56  590P1C4NB
     IP2PARM      DS
      * FLD: COA Property Define Hdr
      * N :  COA Bio-diesel Fuel Code
     I                                        1   6 P2IDAA
      * N :  COA Producer Regist Nbr
     I                                        7  31 P2L2T1
      * N :  COA Employer ID
     I                                       32  51 P2L3T1
      * N :  COA ULSD Company #
     I                                       52  55 P2L6T1
      * N :  COA ULSD Facility #
     I                                       56  60 P2L7T1
      * N :  COA RIN Equivalence Valu
     I                                       61  62 P2L8T1
      * N :  COA RIN Renewable Enrgy
     I                                       63  63 P2L9T1
      * N :  COA RIN Type Flag
     I                                       64  64 P2MAT1
      * N :  COA Temperature Loadout
     I                                    P  65  660P2JENY
      * N :  COA Temp Conv Factor 1
     I                                    P  67  728P2JQNY
      * N :  Operation Factor 1
     I                                       73  73 P2LXST
      * N :  COA Temp Conv Factor 2
     I                                    P  74  798P2JRNY
      * N :  Operation Factor 2
     I                                       80  80 P2LYST
     IP3PARM      DS
      * N :  COA Last RIN EEEEEEEE
     I                                    P   1   50P3J1NY
     IP4PARM      DS
      * I :  Process Cust Types Usr
     I                                        1   2 P4YDSX
     IP5PARM      DS
      * I :  Status - Y or N
     I                                        1   1 P5B8ST
     IP6PARM      DS
      * I :  Actual Shipped Date
     I                                    P   1   40P6GNDT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P4YDSX    PARM           WP0003  2        Process Cust Ty
     C           P5B8ST    PARM           WP0004  1        Status - Y or N
     C           P6GNDT    PARM           WP0005  70       Actual Shipped
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Exc Upd 1 Ord frm Inv XF
      * FP1110 - this is called from the Invoice Print Process (PPXWXFR)
      *  to perform the HPB processing for ONE order:
      *   The Shipping process creates the Batch RIN rcd without a RIN.
      *   Then Invoicing updates the Batch RIN rcd with the RIN.
      * I. For order that is Ready to Invoice Print:
      * 1)  Generate the RIN number in RIN Seq so they're created in the
      *   that the orders were shipped.
      * 2)  Update the Batch Header with Volume used, and last RIN EEEEEE
      * 3)  Update Batch Header RIN record.
      * * Update RIN rcd with RIN if it isnt already there.
      * Rtv Gen 1 RIN at Invc RT - COA Batch Header RIN  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Gen 1 RIN at Invc RT - COA Batch Header RIN  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  6        COA Bio-diesel
     C                     MOVEL*BLANK    WN0002 30        COA Bio-dsl Fue
     C                     MOVEL*BLANK    WN0003 25        COA Producer Re
     C                     MOVEL*BLANK    WN0004 20        COA Employer ID
     C                     MOVEL*BLANK    WN0005  5        COA ULSD Facili
     C                     MOVEL*BLANK    WN0006  2        COA RIN Equival
     C                     MOVEL*BLANK    WN0007  1        COA RIN Renewab
     C                     MOVEL*BLANK    WN0008  1        COA RIN Type Fl
     C                     Z-ADD*ZERO     WN0009  75       COA Density Loa
     C                     Z-ADD*ZERO     WN0010  75       COA Density Ref
     C                     Z-ADD*ZERO     WN0011  30       COA Temperature
     C                     Z-ADD*ZERO     WN0012  30       COA Temperature
     C                     Z-ADD*ZERO     WN0013  41       COA BOL Percent
     C                     Z-ADD*ZERO     WN0014 118       COA Temp Conv F
     C                     MOVEL*BLANK    WN0015  1        Operation Facto
     C                     Z-ADD*ZERO     WN0016 118       COA Temp Conv F
     C                     MOVEL*BLANK    WN0017  1        Operation Facto
     C                     MOVEL*BLANK    WN0018  3        COA RFS Renew F
     C                     MOVEL*BLANK    WN0019  3        COA RFS Rnwbl F
     C                     Z-ADD*ZERO     WN0020  80       COA Last RIN EE
     C                     MOVEL*BLANK    WN0021  1        RFS Volume Corr
     C                     MOVEL*BLANK    WN0022  2        COA BH Equiv Va
     C                     Z-ADD*ZERO     WN0023  70       Actual Ship Dat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * R8683 1/13/2017 RMC Take extra rins across 369 and 374.
      * E2273 9/27/2012 RMC All 3rd party SELs from internal whses are to
      *    be FIFO now. It was just 3rd party from ext whses that were.
      * Control by outputting this: LCL.COA EMTS Batch Nbr = CON.*ZERO
     C                     MOVEL'A'       WN0021           RFS Volume Corr
      * Declare restrictor key work fields
     C           *LIKE     DEFN WACWC3    WQSA01           COA Shipping Co
     C           *LIKE     DEFN WAC4NB    WQSA03           Order Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           COA Shipping Co
     C                     KFLD           WQSA03           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           COA Shipping Co
     C                     Z-ADDP1C4NB    WQSA03           Order Number
      * Establish starting position
     C           KRSSA     SETLL@DACPDL                    *
     C           KRSSA     READE@DACPDL                  90*
      * Data record not found
     C   90                MOVEL'USR3855' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * SEL Inv to Crt RIN-HPB RT - Order Header TRG  * 
     C                     EXSR SBRVGN
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
     C                     EXSR SCRVGN
      * RTV Warehouse Location RT - Warehouse  * 
     C                     EXSR SERVGN
      * RTV Numeric Value      RT - Company Values  * 
     C                     EXSR SFRVGN
      * CASE: LCL.Warehouse Location is Internal (Plant)
     C           YL0021    IFEQ 'I'                        *IF
      * If order in ready to invoice print, gen the rin # and upd the rcd
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.Order Type Print Status is yes
      *   |- c2    : DB1.COA RIN Transaction Date is not entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0001    IFEQ 'Y'                        *IF
     C           WARIDT    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV for Ship process  RT - COA Batch Header  * 
     C                     EXSR SGRVGN
      * RTV HPB to Gen RIN    RT - Manifest Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWACWC3    WL0001           Company Number
     C                     Z-ADDWAC4NB    WL0002           Order Number
     C                     Z-ADDWADPNB    WL0003           Order Sequence
     C                     Z-ADDWAUENB    WL0004           Order Secondary
     C                     Z-ADDWARZNB    WL0005           Case Sequence N
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0027           Item Code
     C                     Z-ADDWL0007    YL0028           HPB Meter Net G
     C                     Z-ADDWL0008    YL0029           HPB Meter Start
     C                     Z-ADDWL0009    YL0030           HPB Meter Endin
     C                     Z-ADDWL0010    YL0031           HPB Meter Total
     C                     Z-ADDWL0011    YL0032           HPB Meter Net W
      * Use item code from manifest dtl for property retrieval
     C                     Z-ADDYL0027    WUH4NY           Item Code 5.0
     C                     MOVEL*BLANK    WUY7TX           Text USR 5
     C                     MOVELWUH4NY    WUY7TX           Text USR 5
     C                     MOVEL*BLANK    YL0033           COA OMS Item Co
     C                     MOVELWUY7TX    YL0033           COA OMS Item Co
      * RTV all used flds/item RT - COA Property Define Hdr  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0012           Company Number
     C                     MOVELYL0033    WL0042    P      COA OMS Item Co
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0013    YL0023    P      COA Bio-diesel
     C                     MOVELWL0014    YN0004    P      COA Bio-dsl Fue
     C                     MOVELWL0015    WN0003    P      COA Producer Re
     C                     MOVELWL0016    WN0004    P      COA Employer ID
     C                     MOVELWL0017    YN0005    P      COA Sold From A
     C                     MOVELWL0018    YL0034    P      COA Sold From N
     C                     MOVELWL0019    YL0035    P      COA ULSD Compan
     C                     MOVELWL0020    WN0005    P      COA ULSD Facili
     C                     MOVELWL0021    WN0006    P      COA RIN Equival
     C                     MOVELWL0022    WN0007    P      COA RIN Renewab
     C                     MOVELWL0023    WN0008    P      COA RIN Type Fl
     C                     Z-ADDWL0024    YN0006           COA Density Loa
     C                     Z-ADDWL0025    YN0007           COA Density Ref
     C                     Z-ADDWL0026    YN0003           COA Temperature
     C                     Z-ADDWL0027    YN0008           COA Temperature
     C                     Z-ADDWL0028    WN0013           COA BOL Percent
     C                     MOVELWL0029    YN0009    P      COA Sale Locati
     C                     MOVELWL0030    YN0010    P      COA Active Whse
     C                     MOVELWL0031    YN0011    P      COA Active Whse
     C                     MOVELWL0032    YN0012    P      COA Active Whse
     C                     MOVELWL0033    YN0013    P      COA Active Whse
     C                     MOVELWL0034    YN0014    P      COA Active Whse
     C                     MOVELWL0035    YN0015    P      COA Active Whse
     C                     Z-ADDWL0036    WN0014           COA Temp Conv F
     C                     MOVELWL0037    WN0015    P      Operation Facto
     C                     Z-ADDWL0038    WN0016           COA Temp Conv F
     C                     MOVELWL0039    WN0017    P      Operation Facto
     C                     MOVELWL0040    YN0016    P      COA RFS Renew F
     C                     MOVELWL0041    YN0017    P      COA RFS Rnwbl F
     C                     Z-ADDWL0043    YL0036           Sold To Custome
     C                     MOVELWL0044    YN0018    P      Record Status
      * --------------------------------------------------------------
      *   Create interal IT1 order if appl  --- moved here from below
      *   because we need the transfer price for the 361 SEL and 369 BUY
      * Create 361 order shipping from warehouse IT1
      * CASE: DB1.COA Ship To Warehouse is Blanks
     C           WAL0AA    IFEQ *BLANK                     *IF
      * *****  Create 361 Order Data with warehouse IT1 = inter company
      * *****  so this order will go thru the invoice post/accrual proces
      *           Files:  OH, OD, OD Pricing, OE
      * Exc HPB Crt Ord f/Inv XF - Order Header TRG  * 
     C                     CALL 'PNNTXFR'              90  Exc HPB Crt Ord
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WACWC3    WQ0050  30       Company Number
     C                     PARM WAC4NB    WQ0051  70       Order Number
     C                     PARM YL0036    WQ0052  70       Sold To Custome
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNNTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * --------------------------------------------------------------
      * RTV Prod Temp-HPB     RT - Load Header  * 
     C                     EXSR SJRVGN
     C                     Z-ADDYL0037    WN0011           COA Temperature
      * CASE: PAR.RFS Volume Corr Mthd  USR is Calculate factor per Prop
     C           WN0021    IFEQ 'C'                        *IF
      * Calc temperature adjustment which is used to calc the net gallons
      * Conversion factor 1
      * CASE: PAR.COA Temp Conv Factor 1 is Entered
     C           WN0014    IFNE 0                          *IF
      * 6/22/10 was using *synon 17,7 workfields
      * CASE: PAR.Operation Factor 1 is Multiply
     C           WN0015    IFEQ 'M'                        *IF
     C           WN0011    MULT WN0014    W0WE             *Synon (17,9) w
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           WN0015    IFEQ 'D'                        *IF
     C           WN0011    DIV  WN0014    W0WE             *Synon (17,9) w
     C                     ELSE
      * CASE: *OTHERWISE
     C           WN0011    ADD  WN0014    W0WE             *Synon (17,9) w
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0011    W0WE             *Synon (17,9) w
     C                     END                             *FI
      * Conversion factor 2   -- do to the result of conv factor 1
      * CASE: PAR.COA Temp Conv Factor 2 is Entered
     C           WN0016    IFNE 0                          *IF
      * CASE: PAR.Operation Factor 2 is Multiply
     C           WN0017    IFEQ 'M'                        *IF
     C                     MULT WN0016    W0WE             *Synon (17,9) w
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           WN0017    IFEQ 'D'                        *IF
     C                     DIV  WN0016    W0WE             *Synon (17,9) w
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  WN0016    W0WE             *Synon (17,9) w
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           1         MULT W0WE      YL0038    H      HPB Temperature
     C                     ELSE
      * CASE: PAR.RFS Volume Corr Mthd  USR is API Volume Corr Table
     C           WN0021    IFEQ 'A'                        *IF
     C                     Z-ADDWN0011    YL0039           RFS Loadout Tem
      * Rtv API Vol Cor Fctor RT - RFS API Volume Corr Table  * 
     C                     EXSR SKRVGN
     C                     Z-ADDYL0040    YL0038           HPB Temperature
     C                     END                             *FI
     C                     END                             *FI
      * Create RIN from the components
      * HPB Create RIN Nbr    IF
      * P00579  RMC 5/13/10 EMTS Processing: pass out the Batch Volume,
      *   RIN Quantity. Calc rin qty from batch volume as a whole number
      *  because Rin qty must =  batch volume * equiv value.
      * 6/22/2010 added 1 dec place to prop conv factor fields
      * 6/25/2010 added 2 dec place to hpb temperature adjustmnt field. w
      * 7/13/2010 recalc meter end gallon after rounding to whole nbr
      * 7/14/2010 use new table for api vol corr factor
      * S00946  RMC 9/24/09 calc EEEEEEEE = (SSSSSSSS + Rin Volume) - 1
      *  instead of adding 1 to the RIN Volume.
      *   for ex. RIN Vol of 10502 would have rin 00000001 00010502
      *   which represents 10502 RINS
      * S00813  RMC 5/21/09 adjust gross gallons to be 99.9% of the gross
      * which is the amount that is actually renewable fuel. the .1% is p
      *   gross gall of renewable fuel = gross gallons * (bol percent/100
      *  See compute statement below
      * ____________________________________________________
      * The net gallons are calculated by taking the gross gallons
      *  times a temperature adjustment formula which is stored in the
      *  Property Batch Header
      * Example:  145 degrees * -.0008008 + 1.048 = temp adjustment
      *        temp adjustment * gross Gallons = Net Gallons
      * The 1st RIN for a batch will have SSSSSSSS = 00000001,
      * The subsequent RINS, will have SSSSSSSS = last RIN EEEEEEEE + 1,
      * ** EEEEEEEE = (Net Total Gallons for that detail) + its SSSSSSSS
      * ** EEEEEEEE = SSSSSSSS nbr if the batch_RIN represents 1 gallon
      *  Equivalence value = 1.5 for now. it is stored in prop hdr as 15
     C                     Z-ADD*ZERO     YL0047           USR Count
     C                     MOVE WN0006    YL0047           USR Count
     C           YL0047    DIV  10        YL0048           HPB Equivalence
     C                     MOVEL*BLANK    YL0049           USR Work Field
     C                     MOVELWAI3NY    YL0049           USR Work Field
      * Temp adjust * start and end gallons to get the Net Gallons
      * Calc RIN SSSSSSSS nbr
      * CASE: PAR.COA Last RIN EEEEEEEE is eq 00000000
     C           WN0020    IFEQ 0                          *IF
     C                     Z-ADD1         YL0050           HPB Meter Start
     C                     ELSE
      * CASE: *OTHERWISE
     C           WN0020    ADD  1         YL0050           HPB Meter Start
     C                     END                             *FI
      * Temperature Adjust the Total Gross Gallons to get the Net
      * S00689    RMC 3/26/09 dont round to zero decimal field yet.
      * Compu: gross gal*temp adj
      * PGM.*Synon (17,7) work field =
      *    *COMPUTE ((x1 * (x3/x4))* x2)
      * x1    : PAR.HPB Meter Total Gallon
      * *     : PGM.*Synon (17,7) work field = PAR.HPB Meter Total Gallon
      * x3    : PAR.COA BOL Percent
      * /     : PGM.*Synon (17,7) work field *
      * x4    : CON.100
      * *     : PGM.*Synon (17,7) work field *
      * x2    : PAR.HPB Temperature Adjustmnt
     C           WN0013    DIV  100       W0WD02           *Synon (17,7) w
     C           YL0031    MULT W0WD02    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT YL0038    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    W0WD             *Synon (17,7) w
      * Calc Volume for the Total Net Gallons using workfield from above
     C           W0WD      MULT YL0048    YL0051    H      HPB Meter Endin
      * EMTS: Rin qty must =  batch volume * equiv value.  5/13/2010
     C           1         MULT W0WD      YL0045    H      COA Batch RIN V
     C           YL0045    MULT YL0048    YL0046    H      COA RIN Quantit
     C           YL0045    MULT YL0048    YL0051    H      HPB Meter Endin
     C                     Z-ADDYL0051    YL0044           COA RIN Volume
      * Add Volume to SSSSSSSS nbr to get the EEEEEEEE nbr
      * CASE: PAR.HPB Meter Total Gallon is Eq 1
     C           YL0031    IFEQ 1                          *IF
     C                     Z-ADDYL0050    YL0051           HPB Meter Endin
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  YL0050    YL0051           HPB Meter Endin
     C                     SUB  1         YL0051           HPB Meter Endin
     C                     END                             *FI
     C                     Z-ADDYL0050    YL0042           COA RIN SSSSSSS
     C                     Z-ADDYL0051    YL0043           COA RIN EEEEEEE
     C                     Z-ADDYL0051    WN0020           COA Last RIN EE
     C                     MOVEL*BLANK    YL0052           Generic Heading
     C                     MOVELYL0050    YL0052           Generic Heading
     C                     MOVEL*BLANK    YL0053           Generic Heading
     C                     MOVELYL0051    YL0053           Generic Heading
      * Use the batch's production year- per tom 9/08/09
      * LCL.Year Code = PAR.COA Batch Production Date *YEAR
     C           YL0024    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    YL0054
     C                     MOVELYL0054    YL0055           Year Alpha (YYY
      * Concatenate all fields together
     C                     Z-ADD*ZEROS    ZQ      50
     C           WN0008    CAT  YL0055:ZQ YL0056    P      COA Batch Heade
     C                     Z-ADD*ZEROS    ZQ      50
     C           YL0056    CAT  WAL6T1:ZQ YL0056    P      COA Batch Heade
     C                     Z-ADD*ZEROS    ZQ      50
     C           YL0056    CAT  WN0005:ZQ YL0056    P      COA Batch Heade
     C                     Z-ADD*ZEROS    ZQ      50
     C           YL0056    CAT  YL0049:ZQ YL0056    P      COA Batch Heade
     C                     Z-ADD*ZEROS    ZQ      50
     C           YL0056    CAT  WN0006:ZQ YL0056    P      COA Batch Heade
     C                     Z-ADD*ZEROS    ZQ      50
     C           YL0056    CAT  WN0007:ZQ YL0056    P      COA Batch Heade
     C                     Z-ADD*ZEROS    ZQ      50
     C           YL0056    CAT  YL0052:ZQ YL0056    P      COA Batch Heade
     C                     Z-ADD*ZEROS    ZQ      50
     C           YL0056    CAT  YL0053:ZQ YL0041    P      COA Batch Heade
      * ******
      * ******  Update 361 SEL Batch RIN Record  ***
      * ******   do this always - sel to 369 needs the RIN ******* 2/26/1
      * RMC C0699 use Bill to cust instead of ship to for HPB epa reg#
      * RTV Bilto/Customer     RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWACWC3    WL0045           Company Number
     C                     Z-ADDWAC4NB    WL0046           Order Number
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0047    YL0057           Bill to Custome
     C                     MOVELWL0048    YL0058    P      Bill to Name
      * RTV HPB RIN Fields     RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWACWC3    WL0049           Company Number
     C                     Z-ADDWAC4NB    WL0050           Order Number
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0051    YL0059           OHE HPB RIN Equ
     C                     Z-ADDWL0052    YL0060           OHE HPB RIN Pri
     C                     MOVELWL0053    YL0061    P      OHE Override Ty
      * CASE: LCL.OHE HPB RIN Equiv Value is EQ 0
     C           YL0059    IFEQ 0                          *IF
     C                     Z-ADDWASXNY    YL0059           OHE HPB RIN Equ
     C                     END                             *FI
      * Rtv HPB Cust Fields   RT - Company Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWACWC3    WL0054           Company Number
     C                     Z-ADDYL0057    WL0055           Ship To Custome
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0056    YL0062    P      HPB Employer ID
     C                     MOVELWL0057    YL0063    P      HPB ULSD Compan
     C                     MOVELWL0058    YL0064    P      HPB ULSD Facili
      * CASE: LCL.OHE Override Type Code is No
     C           YL0061    IFEQ *BLANK                     *IF
      * Rtv Customer Type     RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0057    WL0059           Ship To Custome
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0060    YL0065    P      Type Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELYL0061    YL0065           Type Code
     C                     END                             *FI
      * **** EMTS processing: Ready to Generate the rin for this order in
      * **** and Ready to process the SEL RIN Transaction in EMTS
      * Update: both EMTS sts, COA Batch RIN Volume,COA RIN Quantity,
      *    price per gallon - rounded to 2 dec.
      * If batch is from RFS2, then send to emts, else dont
      * CASE: DB1.COA BHR RFS Version Nbr is RFS 2
     C           WAJ1ST    IFEQ '2'                        *IF
     C                     MOVEL'0'       YL0066           COA GEN EMTS St
     C                     MOVEL'0'       YL0067           COA RIN EMTS St
     C                     MOVEL*BLANK    YL0041           COA Batch Heade
     C                     ELSE
      * CASE: *OTHERWISE
      * DONT SEND TO EMTS IF BATCH IF FROM RFS1
     C                     MOVEL*BLANK    YL0066           COA GEN EMTS St
     C                     MOVEL*BLANK    YL0067           COA RIN EMTS St
     C                     END                             *FI
      * E2013 RMC 3/21/12 output act ship date as rin yr
      * LCL.COA BHR RIN Gen Year = PAR.Actual Ship Date Usr *YEAR
     C           WN0023    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    YL0068
      * 5/12 RMC get transfer price from 361 order OR 369 order
      * CASE: DB1.COA Ship To Warehouse is Blanks
     C           WAL0AA    IFEQ *BLANK                     *IF
      * R6965 RMC 8.16.16 new hpb plant
      * RTV Unit Price        RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0022    WL0061           Company Number
     C                     Z-ADDWAC4NB    WL0062           Order Number
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0063    YL0069           Unit Price
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Unit Price        RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWACWC3    WL0061           Company Number
     C                     Z-ADDWAC4NB    WL0062           Order Number
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0063    YL0069           Unit Price
     C                     END                             *FI
     C           1         MULT YL0069    YL0070    H      COA BHR Gallon
      * ****
      * E2013 RMC 3/21/12 output act ship date as rin trans dt
      * Chg COA Batch Hdr RIN CH - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0064           Company Number
     C                     MOVELWAL6T1    WL0065    P      COA ULSD Compan
     C                     Z-ADDWAI3NY    WL0066           COA Batch Numbe
     C                     Z-ADDWAJYNY    WL0067           COA Batch Heade
     C                     Z-ADDWAQ1NY    WL0068           COA Batch Hdr R
     C                     MOVELYL0041    WL0069    P      COA Batch Heade
     C                     Z-ADDYL0042    WL0070           COA RIN SSSSSSS
     C                     Z-ADDYL0043    WL0071           COA RIN EEEEEEE
     C                     Z-ADDYL0044    WL0072           COA RIN Volume
     C                     Z-ADDWN0023    WL0073           COA RIN Transac
     C                     Z-ADD##JTM     WL0074           COA RIN Transac
     C                     MOVELWAMVT1    WL0075    P      COA RIN Trans P
     C                     MOVELWAMWT1    WL0076    P      COA RIN Trans P
     C                     MOVEL*BLANK    WL0077           COA Retired RIN
     C                     Z-ADD0         WL0078           COA Retired RIN
     C                     Z-ADD0         WL0079           COA Retired RIN
     C                     Z-ADDWAC4NB    WL0080           Order Number
     C                     Z-ADDWADPNB    WL0081           Order Sequence
     C                     Z-ADDWAUENB    WL0082           Order Secondary
     C                     Z-ADDWARZNB    WL0083           Case Sequence N
     C                     MOVEL*BLANK    WL0084           COA Rail Car
     C                     Z-ADDWARMNB    WL0085           Load ID
     C                     Z-ADD0         WL0086           COA Date of 1st
     C                     Z-ADD0         WL0087           COA RIN Unused
     C                     MOVEL'N'       WL0088    P      COA RIN Modifie
     C                     MOVEL*BLANK    WL0089           COA RIN Unused
     C                     MOVELWAG3ST    WL0090    P      COA RIN SoldFul
     C                     Z-ADDWAQWNY    WL0091           COA RIN Gallons
     C                     MOVELWAL0AA    WL0092    P      COA Ship To War
     C                     MOVELWAMAT1    WL0093    P      COA RIN Type Fl
     C                     MOVELWATDNA    WL0094    P      COA RIN Custome
     C                     Z-ADDWACWC3    WL0095           COA Shipping Co
     C                     Z-ADDWAQXNY    WL0096           COA Ref Load Id
     C                     Z-ADDWAQZNY    WL0097           COA Reference B
     C                     Z-ADDWAQ0NY    WL0098           COA Reference B
     C                     MOVELWALVTX    WL0099    P      RFS Compliance
     C                     MOVELWANYT1    WL0100    P      RFS Report Year
     C                     MOVELWAG5ST    WL0101    P      COA RIN Int/Ext
     C                     MOVELWAG7ST    WL0102    P      COA BHR Unused
     C                     Z-ADDWATFDT    WL0103           COA BHR Net Gal
     C                     Z-ADDWATGDT    WL0104           COA BHR Unused
     C                     MOVELWAWIT1    WL0105    P      COA BHR Unused
     C                     Z-ADDWN0011    WL0106           COA BHR Loadout
     C                     MOVELWAL7T1    WL0107    P      COA ULSD Facili
     C                     Z-ADDYL0045    WL0108           COA Batch RIN V
     C                     Z-ADDYL0046    WL0109           COA RIN Quantit
     C                     MOVELWAI7AA    WL0110    P      RFS Transaction
     C                     MOVELWAMXAA    WL0111    P      RFS Trans Reaso
     C                     MOVELWAMSAA    WL0112    P      RFS Fuel Code
     C                     Z-ADDYL0068    WL0113           COA BHR RIN Gen
     C                     Z-ADDWAHEPR    WL0114           COA BHR RIN Pri
     C                     Z-ADDYL0070    WL0115           COA BHR Gallon
     C                     MOVELWAWVT1    WL0116    P      COA Transaction
     C                     MOVELWAW0T1    WL0117    P      COA RIN Support
     C                     Z-ADDWAR5NY    WL0118           COA RIN Support
     C                     MOVELWAW1T1    WL0119    P      COA RIN Support
     C                     Z-ADDWAR6NY    WL0120           COA RIN Support
     C                     MOVELWAJ1ST    WL0121    P      COA BHR RFS Ver
     C                     MOVELYL0066    WL0122    P      COA GEN EMTS St
     C                     Z-ADDWATWDT    WL0123           COA GEN EMTS Da
     C                     Z-ADDWADUTM    WL0124           COA GEN EMTS Ti
     C                     MOVELYL0067    WL0125    P      COA RIN EMTS St
     C                     Z-ADDWATVDT    WL0126           COA RIN EMTS Da
     C                     Z-ADDWADTTM    WL0127           COA RIN EMTS Ti
     C                     Z-ADDWARMNB    WL0128           COA EMTS PTD Nb
     C                     Z-ADDWASQNY    WL0129           COA EMTS Batch
     C                     MOVELWABHR3    WL0130    P      COA BHR Unused
     C                     Z-ADDWASRNY    WL0131           COA BHR Unused
     C                     MOVELWAW7T1    WL0132    P      COA EMTS Trans
     C                     MOVELWAW8T1    WL0133    P      COA EMTS Return
     C                     Z-ADDWAT2DT    WL0134           COA BHR Unused
     C                     Z-ADDWASXNY    WL0135           COA BHR Equiv V
     C                     Z-ADDWASYNY    WL0136           COA BHR RINs to
     C                     Z-ADDWASZNY    WL0137           COA Unassgnd Tx
     C                     MOVEL'A'       WL0138    P      Record Status
     C                     Z-ADD##JDT     WL0139           Change Date
     C                     Z-ADD##JTM     WL0140           Change Time
     C                     MOVEL##USR     WL0141    P      Change User
     C                     MOVEL##PGM     WL0142    P      Change Program
     C                     EXSR SQCHRC
      * ******  Update Batch Header fields
      * RTV for Upd Gals Used RT - COA Batch Header  * 
     C                     EXSR SRRVGN
      * ******  Create more RINS   FP1322  ********
      * ******  Create Batch RIN Record: BUY for  HPB Biodiesel 369  ***
      *  ******   do this always - BUY from 361 needs the RIN ******* 3/0
      * RTV all used flds/item RT - COA Property Define Hdr  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0012           Company Number
     C                     MOVELYL0033    WL0042    P      COA OMS Item Co
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0013    YL0023    P      COA Bio-diesel
     C                     MOVELWL0014    YN0004    P      COA Bio-dsl Fue
     C                     MOVELWL0015    WN0003    P      COA Producer Re
     C                     MOVELWL0016    WN0004    P      COA Employer ID
     C                     MOVELWL0017    YN0005    P      COA Sold From A
     C                     MOVELWL0018    YL0034    P      COA Sold From N
     C                     MOVELWL0019    YL0035    P      COA ULSD Compan
     C                     MOVELWL0020    WN0005    P      COA ULSD Facili
     C                     MOVELWL0021    WN0006    P      COA RIN Equival
     C                     MOVELWL0022    WN0007    P      COA RIN Renewab
     C                     MOVELWL0023    WN0008    P      COA RIN Type Fl
     C                     Z-ADDWL0024    YN0006           COA Density Loa
     C                     Z-ADDWL0025    YN0007           COA Density Ref
     C                     Z-ADDWL0026    YN0003           COA Temperature
     C                     Z-ADDWL0027    YN0008           COA Temperature
     C                     Z-ADDWL0028    WN0013           COA BOL Percent
     C                     MOVELWL0029    YN0009    P      COA Sale Locati
     C                     MOVELWL0030    YN0010    P      COA Active Whse
     C                     MOVELWL0031    YN0011    P      COA Active Whse
     C                     MOVELWL0032    YN0012    P      COA Active Whse
     C                     MOVELWL0033    YN0013    P      COA Active Whse
     C                     MOVELWL0034    YN0014    P      COA Active Whse
     C                     MOVELWL0035    YN0015    P      COA Active Whse
     C                     Z-ADDWL0036    WN0014           COA Temp Conv F
     C                     MOVELWL0037    WN0015    P      Operation Facto
     C                     Z-ADDWL0038    WN0016           COA Temp Conv F
     C                     MOVELWL0039    WN0017    P      Operation Facto
     C                     MOVELWL0040    YN0016    P      COA RFS Renew F
     C                     MOVELWL0041    YN0017    P      COA RFS Rnwbl F
     C                     Z-ADDWL0043    YL0036           Sold To Custome
     C                     MOVELWL0044    YN0018    P      Record Status
     C           WAQ1NY    ADD  1         YL0074           COA Batch Hdr R
      * CASE: DB1.COA Ship To Warehouse is Blanks
     C           WAL0AA    IFEQ *BLANK                     *IF
     C                     MOVEL'F'       YL0075           COA RIN SoldFul
      * 5/04  dont create BUY with net gallons to sell if pickup from pla
     C                     Z-ADD0         YL0028           HPB Meter Net G
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0075           COA RIN SoldFul
     C                     END                             *FI
      * CASE: LCL.Type Code is Not RIN Customer
     C           YL0065    IFEQ 'NR'                       *IF
     C                     Z-ADDYL0046    YL0076           COA BHR RINs to
     C                     Z-ADD0         YL0077           COA RIN Gallons
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.COA Ship To Warehouse is Blanks
     C           WAL0AA    IFEQ *BLANK                     *IF
     C                     Z-ADDYL0046    YL0077           COA RIN Gallons
     C                     Z-ADD0         YL0076           COA BHR RINs to
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         YL0077           COA RIN Gallons
     C                     Z-ADD0         YL0076           COA BHR RINs to
     C                     END                             *FI
     C                     END                             *FI
      * P0579 5/13 create BUY with emts RIN sts = 0 = ready to send to em
      *   same COA Batch RIN Volume,COA RIN Quantity, price per gall as a
      * If batch is from RFS2, then send to emts, else dont
      * CASE: DB1.COA BHR RFS Version Nbr is RFS 2
     C           WAJ1ST    IFEQ '2'                        *IF
     C                     MOVEL*BLANK    YL0066           COA GEN EMTS St
     C                     MOVEL'0'       YL0067           COA RIN EMTS St
     C                     MOVEL*BLANK    YL0041           COA Batch Heade
     C                     ELSE
      * CASE: *OTHERWISE
      * DONT SEND TO EMTS IF BATCH IF FROM RFS1
     C                     MOVEL*BLANK    YL0066           COA GEN EMTS St
     C                     MOVEL*BLANK    YL0067           COA RIN EMTS St
     C                     END                             *FI
      * E2013 RMC 3/21/12 output act ship date as rin trans dt
      * Crt COA Batch Hdr RIN CR - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWACWC3    WL0222           Company Number
     C                     MOVELWAL6T1    WL0223    P      COA ULSD Compan
     C                     Z-ADDWAI3NY    WL0224           COA Batch Numbe
     C                     Z-ADDWAJYNY    WL0225           COA Batch Heade
     C                     Z-ADDYL0074    WL0226           COA Batch Hdr R
     C                     MOVELYL0041    WL0227    P      COA Batch Heade
     C                     Z-ADDYL0042    WL0228           COA RIN SSSSSSS
     C                     Z-ADDYL0043    WL0229           COA RIN EEEEEEE
     C                     Z-ADDYL0044    WL0230           COA RIN Volume
     C                     Z-ADDWN0023    WL0231           COA RIN Transac
     C                     Z-ADD##JTM     WL0232           COA RIN Transac
     C                     MOVELYL0034    WL0233    P      COA RIN Trans P
     C                     MOVELYL0035    WL0234    P      COA RIN Trans P
     C                     MOVEL*BLANK    WL0235           COA Retired RIN
     C                     Z-ADD0         WL0236           COA Retired RIN
     C                     Z-ADD0         WL0237           COA Retired RIN
     C                     Z-ADD0         WL0238           Order Number
     C                     Z-ADD0         WL0239           Order Sequence
     C                     Z-ADD0         WL0240           Order Secondary
     C                     Z-ADD0         WL0241           Case Sequence N
     C                     MOVEL*BLANK    WL0242           COA Rail Car
     C                     Z-ADD0         WL0243           Load ID
     C                     Z-ADD0         WL0244           COA Date of 1st
     C                     Z-ADD0         WL0245           COA RIN Unused
     C                     MOVEL'N'       WL0246    P      COA RIN Modifie
     C                     MOVEL*BLANK    WL0247           COA RIN Unused
     C                     MOVELYL0075    WL0248    P      COA RIN SoldFul
     C                     Z-ADDYL0077    WL0249           COA RIN Gallons
     C                     MOVELWAL0AA    WL0250    P      COA Ship To War
     C                     MOVELWAMAT1    WL0251    P      COA RIN Type Fl
     C                     MOVELWATDNA    WL0252    P      COA RIN Custome
     C                     Z-ADD0         WL0253           COA Shipping Co
     C                     Z-ADD0         WL0254           COA Ref Load Id
     C                     Z-ADD0         WL0255           COA Reference B
     C                     Z-ADD0         WL0256           COA Reference B
     C                     MOVELWALVTX    WL0257    P      RFS Compliance
     C                     MOVELWANYT1    WL0258    P      RFS Report Year
     C                     MOVELWAG5ST    WL0259    P      COA RIN Int/Ext
     C                     MOVELWAG7ST    WL0260    P      COA BHR Unused
     C                     Z-ADDYL0028    WL0261           COA BHR Net Gal
     C                     Z-ADDWATGDT    WL0262           COA BHR Unused
     C                     MOVELWAWIT1    WL0263    P      COA BHR Unused
     C                     Z-ADDWN0011    WL0264           COA BHR Loadout
     C                     MOVELWAL7T1    WL0265    P      COA ULSD Facili
     C                     Z-ADDYL0045    WL0266           COA Batch RIN V
     C                     Z-ADDYL0046    WL0267           COA RIN Quantit
     C                     MOVEL'BUY'     WL0268    P      RFS Transaction
     C                     MOVELWAMXAA    WL0269    P      RFS Trans Reaso
     C                     MOVELWAMSAA    WL0270    P      RFS Fuel Code
     C                     Z-ADDYL0068    WL0271           COA BHR RIN Gen
     C                     Z-ADDWAHEPR    WL0272           COA BHR RIN Pri
     C                     Z-ADDYL0070    WL0273           COA BHR Gallon
     C                     MOVELWAWVT1    WL0274    P      COA Transaction
     C                     MOVELWAW0T1    WL0275    P      COA RIN Support
     C                     Z-ADDWAR5NY    WL0276           COA RIN Support
     C                     MOVELWAW1T1    WL0277    P      COA RIN Support
     C                     Z-ADDWAR6NY    WL0278           COA RIN Support
     C                     MOVELWAJ1ST    WL0279    P      COA BHR RFS Ver
     C                     MOVELYL0066    WL0280    P      COA GEN EMTS St
     C                     Z-ADDWATWDT    WL0281           COA GEN EMTS Da
     C                     Z-ADDWADUTM    WL0282           COA GEN EMTS Ti
     C                     MOVELYL0067    WL0283    P      COA RIN EMTS St
     C                     Z-ADDWATVDT    WL0284           COA RIN EMTS Da
     C                     Z-ADDWADTTM    WL0285           COA RIN EMTS Ti
     C                     Z-ADDWARMNB    WL0286           COA EMTS PTD Nb
     C                     Z-ADDWASQNY    WL0287           COA EMTS Batch
     C                     MOVELWABHR3    WL0288    P      COA BHR Unused
     C                     Z-ADDWASRNY    WL0289           COA BHR Unused
     C                     MOVEL*BLANK    WL0290           COA EMTS Trans
     C                     MOVEL*BLANK    WL0291           COA EMTS Return
     C                     Z-ADDWAT2DT    WL0292           COA BHR Unused
     C                     Z-ADDWASXNY    WL0293           COA BHR Equiv V
     C                     Z-ADDYL0076    WL0294           COA BHR RINs to
     C                     Z-ADDWASZNY    WL0295           COA Unassgnd Tx
     C                     MOVEL'A'       WL0296    P      Record Status
     C                     Z-ADD##JDT     WL0297           Create Date
     C                     Z-ADD##JTM     WL0298           Create Time
     C                     MOVEL##USR     WL0299    P      Create User
     C                     MOVEL##PGM     WL0300    P      Create Program
     C                     Z-ADD##JDT     WL0301           Change Date
     C                     Z-ADD##JTM     WL0302           Change Time
     C                     MOVEL##USR     WL0303    P      Change User
     C                     MOVEL##PGM     WL0304    P      Change Program
     C                     EXSR SUCRRC
      * ******  Create Batch RIN Record for SEL to external cust  *****
      * ******   if not shipping to an external warehouse        *****
      * SEL/SEP Rin to cust if not ext whse
      * CASE: DB1.COA Ship To Warehouse is Blanks
     C           WAL0AA    IFEQ *BLANK                     *IF
      * RTV Bilto/Customer     RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWACWC3    WL0045           Company Number
     C                     Z-ADDWAC4NB    WL0046           Order Number
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0047    YL0057           Bill to Custome
     C                     MOVELWL0048    YL0058    P      Bill to Name
      * Rtv HPB Cust Fields   RT - Company Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWACWC3    WL0054           Company Number
     C                     Z-ADDYL0057    WL0055           Ship To Custome
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0056    YL0062    P      HPB Employer ID
     C                     MOVELWL0057    YL0063    P      HPB ULSD Compan
     C                     MOVELWL0058    YL0064    P      HPB ULSD Facili
     C                     ADD  1         YL0074           COA Batch Hdr R
     C                     MOVEL*BLANK    YL0075           COA RIN SoldFul
      * 5/12/11 RMC Get price from 369 order
      * RTV Unit Price        RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWACWC3    WL0061           Company Number
     C                     Z-ADDWAC4NB    WL0062           Order Number
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0063    YL0069           Unit Price
     C           1         MULT YL0069    YL0070    H      COA BHR Gallon
      * E2273 9/27/2012 -- ALL SELs are to be FIFO NOW in EMTS -PER TOM D
     C                     Z-ADD0         YL0078           COA EMTS Batch
      * If batch is from RFS2, then send to emts, else dont
      * CASE: DB1.COA BHR RFS Version Nbr is RFS 2
     C           WAJ1ST    IFEQ '2'                        *IF
     C                     MOVEL*BLANK    YL0066           COA GEN EMTS St
     C                     MOVEL'0'       YL0067           COA RIN EMTS St
     C                     MOVEL*BLANK    YL0041           COA Batch Heade
     C                     ELSE
      * CASE: *OTHERWISE
      * DONT SEND TO EMTS IF BATCH IF FROM RFS1
     C                     MOVEL*BLANK    YL0066           COA GEN EMTS St
     C                     MOVEL*BLANK    YL0067           COA RIN EMTS St
     C                     END                             *FI
      * Not RIN Customer then dont output RIN or other specific fields 3/
      * CASE: LCL.Type Code is Not RIN Customer
     C           YL0065    IFEQ 'NR'                       *IF
     C                     MOVEL'U'       YL0075           COA RIN SoldFul
     C                     MOVEL*BLANK    YL0041           COA Batch Heade
     C                     Z-ADD0         YL0042           COA RIN SSSSSSS
     C                     Z-ADD0         YL0043           COA RIN EEEEEEE
     C                     Z-ADD0         YL0044           COA RIN Volume
     C                     Z-ADD0         YL0046           COA RIN Quantit
     C                     Z-ADD0         YL0045           COA Batch RIN V
     C                     MOVEL*BLANK    YL0067           COA RIN EMTS St
     C                     MOVEL*BLANK    YL0066           COA GEN EMTS St
     C                     MOVEL*BLANK    YL0063           HPB ULSD Compan
     C                     END                             *FI
      * If Blender, create SEParated RIN Trans, else create SEL @ 1.5
      * CASE: LCL.Type Code is Blender for Biodiesel
     C           YL0065    IFEQ 'BL'                       *IF
      * When sold to a Blender, create SEParated RIN.
     C                     MOVEL'SEP'     YL0079           RFS Transaction
     C                     MOVEL'2'       WN0008           COA RIN Type Fl
      * Rtv Trans Rsn Dft,Dsc RT - RFS Transaction Reason  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0079    WL0305    P      RFS Transaction
     C                     MOVEL'Y'       WL0308    P      RFS Trans Reaso
     C                     EXSR SVRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0306    YL0080    P      RFS Trans Reaso
     C                     MOVELWL0307    YN0019    P      RFS Trans Reaso
      * Rtv Equiv Value f/SEP RT - COA Batch Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0309           Company Number
     C                     MOVELWAL6T1    WL0310    P      COA ULSD Compan
     C                     Z-ADDWAI3NY    WL0311           COA Batch Numbe
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0312    YL0081    P      COA BH Equiv Va
     C                     Z-ADD*ZERO     YL0082           COA RIN Equival
     C                     MOVE YL0081    YL0082           COA RIN Equival
      * CASE: LCL.COA RIN Equivalence Valu# is Zero
     C           YL0082    IFEQ 0                          *IF
     C                     Z-ADD2.5       YL0082           COA RIN Equival
     C                     END                             *FI
      * Exc Gen RIN SEP Trans XF - COA Batch Header RIN  * 
     C                     CALL 'PNT2XFR'              90  Exc Gen RIN SEP
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0053  30       Company Number
     C                     PARM WAL6T1    WQ0054  4        COA ULSD Compan
     C                     PARM WAI3NY    WQ0055  50       COA Batch Numbe
     C                     PARM WAJYNY    WQ0056  50       COA Batch Heade
     C                     PARM YL0074    WQ0057  50       COA Batch Hdr R
     C                     PARM WAMUT1    WQ0058 38        COA Batch Heade
     C                     PARM YL0042    WQ0059  80       COA RIN SSSSSSS
     C                     PARM YL0043    WQ0060  80       COA RIN EEEEEEE
     C                     PARM YL0044    WQ0061  80       COA RIN Volume
     C                     PARM YL0058    WQ0062 30        COA RIN Trans P
     C                     PARM YL0063    WQ0063  4        COA RIN Trans P
     C                     PARM WAC4NB    WQ0064  70       Order Number
     C                     PARM WADPNB    WQ0065  30       Order Sequence
     C                     PARM WAUENB    WQ0066  30       Order Secondary
     C                     PARM WARZNB    WQ0067  50       Case Sequence N
     C                     PARM WANGT1    WQ0068 15        COA Rail Car
     C                     PARM WARMNB    WQ0069  70       Load ID
     C                     PARM 0         WQ0070  70       COA Date of 1st
     C                     PARM 0         WQ0071  60       COA RIN Unused
     C                     PARM *BLANK    WQ0072  1        COA RIN Modifie
     C                     PARM *BLANK    WQ0073 25        COA RIN Unused
     C                     PARM YL0075    WQ0074  1        COA RIN SoldFul
     C                     PARM WAQWNY    WQ0075  80       COA RIN Gallons
     C                     PARM WAL0AA    WQ0076  3        COA Ship To War
     C                     PARM WN0008    WQ0077  1        COA RIN Type Fl
     C                     PARM WATDNA    WQ0078 15        COA RIN Custome
     C                     PARM WACWC3    WQ0079  30       COA Shipping Co
     C                     PARM WAQXNY    WQ0080  70       COA Ref Load Id
     C                     PARM WAQZNY    WQ0081  50       COA Reference B
     C                     PARM WAQ0NY    WQ0082  50       COA Reference B
     C                     PARM WALVTX    WQ0083  2        RFS Compliance
     C                     PARM WANYT1    WQ0084  4        RFS Report Year
     C                     PARM WAG5ST    WQ0085  1        COA RIN Int/Ext
     C                     PARM WAG7ST    WQ0086  2        COA BHR Unused
     C                     PARM WATFDT    WQ0087  70       COA BHR Net Gal
     C                     PARM WATGDT    WQ0088  70       COA BHR Unused
     C                     PARM WAWIT1    WQ0089 25        COA BHR Unused
     C                     PARM WAQYNY    WQ0090  70       COA BHR Loadout
     C                     PARM WAL7T1    WQ0091  5        COA ULSD Facili
     C                     PARM YL0045    WQ0092  70       COA Batch RIN V
     C                     PARM YL0046    WQ0093  70       COA RIN Quantit
     C                     PARM YL0079    WQ0094  3        RFS Transaction
     C                     PARM YL0080    WQ0095  3        RFS Trans Reaso
     C                     PARM WAMSAA    WQ0096  1        RFS Fuel Code
     C                     PARM YL0068    WQ0097  40       COA BHR RIN Gen
     C                     PARM YL0083    WQ0098  72       COA BHR RIN Pri
     C                     PARM YL0070    WQ0099  72       COA BHR Gallon
     C                     PARM WAWVT1    WQ0100 50        COA Transaction
     C                     PARM WAW0T1    WQ0101 25        COA RIN Support
     C                     PARM WAR5NY    WQ0102  70       COA RIN Support
     C                     PARM WAW1T1    WQ0103 25        COA RIN Support
     C                     PARM WAR6NY    WQ0104  70       COA RIN Support
     C                     PARM WAJ1ST    WQ0105  1        COA BHR RFS Ver
     C                     PARM YL0066    WQ0106  1        COA GEN EMTS St
     C                     PARM 0         WQ0107  70       COA GEN EMTS Da
     C                     PARM 0         WQ0108  60       COA GEN EMTS Ti
     C                     PARM YL0067    WQ0109  1        COA RIN EMTS St
     C                     PARM 0         WQ0110  70       COA RIN EMTS Da
     C                     PARM 0         WQ0111  60       COA RIN EMTS Ti
     C                     PARM WAR9NY    WQ0112  70       COA EMTS PTD Nb
     C                     PARM YL0078    WQ0113  80       COA EMTS Batch
     C                     PARM WABHR3    WQ0114  2        COA BHR Unused
     C                     PARM WASRNY    WQ0115  80       COA BHR Unused
     C                     PARM *BLANK    WQ0116 40        COA EMTS Trans
     C                     PARM *BLANK    WQ0117 10        COA EMTS Return
     C                     PARM WAT2DT    WQ0118  70       COA BHR Unused
     C                     PARM WASYNY    WQ0119  70       COA BHR RINs to
     C                     PARM 0         WQ0120  70       COA Unassgnd Tx
     C                     PARM YL0082    WQ0121  81       COA RIN Equival
     C                     PARM WN0023    WQ0122  70       Actual Ship Dat
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNT2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.OHE HPB RIN Equiv Value EQ DB1.COA BHR Equiv Value
     C           YL0059    IFEQ WASXNY                     *IF
     C                     MOVEL'SEL'     YL0079           RFS Transaction
     C                     MOVEL'1'       WN0008           COA RIN Type Fl
     C                     MOVELWAMXAA    YL0080           RFS Trans Reaso
      * E2013 RMC 3/21/12 output act ship date as rin trans dt
      * Crt COA Batch Hdr RIN CR - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWACWC3    WL0222           Company Number
     C                     MOVELWAL6T1    WL0223    P      COA ULSD Compan
     C                     Z-ADDWAI3NY    WL0224           COA Batch Numbe
     C                     Z-ADDWAJYNY    WL0225           COA Batch Heade
     C                     Z-ADDYL0074    WL0226           COA Batch Hdr R
     C                     MOVELYL0041    WL0227    P      COA Batch Heade
     C                     Z-ADDYL0042    WL0228           COA RIN SSSSSSS
     C                     Z-ADDYL0043    WL0229           COA RIN EEEEEEE
     C                     Z-ADDYL0044    WL0230           COA RIN Volume
     C                     Z-ADDWN0023    WL0231           COA RIN Transac
     C                     Z-ADD##JTM     WL0232           COA RIN Transac
     C                     MOVELYL0058    WL0233    P      COA RIN Trans P
     C                     MOVELYL0063    WL0234    P      COA RIN Trans P
     C                     MOVEL*BLANK    WL0235           COA Retired RIN
     C                     Z-ADD0         WL0236           COA Retired RIN
     C                     Z-ADD0         WL0237           COA Retired RIN
     C                     Z-ADDWAC4NB    WL0238           Order Number
     C                     Z-ADDWADPNB    WL0239           Order Sequence
     C                     Z-ADDWAUENB    WL0240           Order Secondary
     C                     Z-ADDWARZNB    WL0241           Case Sequence N
     C                     MOVEL*BLANK    WL0242           COA Rail Car
     C                     Z-ADDWARMNB    WL0243           Load ID
     C                     Z-ADD0         WL0244           COA Date of 1st
     C                     Z-ADD0         WL0245           COA RIN Unused
     C                     MOVEL'N'       WL0246    P      COA RIN Modifie
     C                     MOVEL*BLANK    WL0247           COA RIN Unused
     C                     MOVELYL0075    WL0248    P      COA RIN SoldFul
     C                     Z-ADDWAQWNY    WL0249           COA RIN Gallons
     C                     MOVELWAL0AA    WL0250    P      COA Ship To War
     C                     MOVELWN0008    WL0251    P      COA RIN Type Fl
     C                     MOVELWATDNA    WL0252    P      COA RIN Custome
     C                     Z-ADDWACWC3    WL0253           COA Shipping Co
     C                     Z-ADD0         WL0254           COA Ref Load Id
     C                     Z-ADD0         WL0255           COA Reference B
     C                     Z-ADD0         WL0256           COA Reference B
     C                     MOVELWALVTX    WL0257    P      RFS Compliance
     C                     MOVELWANYT1    WL0258    P      RFS Report Year
     C                     MOVELWAG5ST    WL0259    P      COA RIN Int/Ext
     C                     MOVELWAG7ST    WL0260    P      COA BHR Unused
     C                     Z-ADDWATFDT    WL0261           COA BHR Net Gal
     C                     Z-ADDWATGDT    WL0262           COA BHR Unused
     C                     MOVELWAWIT1    WL0263    P      COA BHR Unused
     C                     Z-ADDWN0011    WL0264           COA BHR Loadout
     C                     MOVELWAL7T1    WL0265    P      COA ULSD Facili
     C                     Z-ADDYL0045    WL0266           COA Batch RIN V
     C                     Z-ADDYL0046    WL0267           COA RIN Quantit
     C                     MOVELYL0079    WL0268    P      RFS Transaction
     C                     MOVELYL0080    WL0269    P      RFS Trans Reaso
     C                     MOVELWAMSAA    WL0270    P      RFS Fuel Code
     C                     Z-ADDYL0068    WL0271           COA BHR RIN Gen
     C                     Z-ADDWAHEPR    WL0272           COA BHR RIN Pri
     C                     Z-ADDYL0070    WL0273           COA BHR Gallon
     C                     MOVELWAWVT1    WL0274    P      COA Transaction
     C                     MOVELWAW0T1    WL0275    P      COA RIN Support
     C                     Z-ADDWAR5NY    WL0276           COA RIN Support
     C                     MOVELWAW1T1    WL0277    P      COA RIN Support
     C                     Z-ADDWAR6NY    WL0278           COA RIN Support
     C                     MOVELWAJ1ST    WL0279    P      COA BHR RFS Ver
     C                     MOVELYL0066    WL0280    P      COA GEN EMTS St
     C                     Z-ADDWATWDT    WL0281           COA GEN EMTS Da
     C                     Z-ADDWADUTM    WL0282           COA GEN EMTS Ti
     C                     MOVELYL0067    WL0283    P      COA RIN EMTS St
     C                     Z-ADDWATVDT    WL0284           COA RIN EMTS Da
     C                     Z-ADDWADTTM    WL0285           COA RIN EMTS Ti
     C                     Z-ADDWARMNB    WL0286           COA EMTS PTD Nb
     C                     Z-ADDYL0078    WL0287           COA EMTS Batch
     C                     MOVELWABHR3    WL0288    P      COA BHR Unused
     C                     Z-ADDWASRNY    WL0289           COA BHR Unused
     C                     MOVEL*BLANK    WL0290           COA EMTS Trans
     C                     MOVEL*BLANK    WL0291           COA EMTS Return
     C                     Z-ADDWAT2DT    WL0292           COA BHR Unused
     C                     Z-ADDWASXNY    WL0293           COA BHR Equiv V
     C                     Z-ADD0         WL0294           COA BHR RINs to
     C                     Z-ADDWASZNY    WL0295           COA Unassgnd Tx
     C                     MOVEL'A'       WL0296    P      Record Status
     C                     Z-ADD##JDT     WL0297           Create Date
     C                     Z-ADD##JTM     WL0298           Create Time
     C                     MOVEL##USR     WL0299    P      Create User
     C                     MOVEL##PGM     WL0300    P      Create Program
     C                     Z-ADD##JDT     WL0301           Change Date
     C                     Z-ADD##JTM     WL0302           Change Time
     C                     MOVEL##USR     WL0303    P      Change User
     C                     MOVEL##PGM     WL0304    P      Change Program
     C                     EXSR SUCRRC
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'SEL'     YL0079           RFS Transaction
     C                     MOVEL'1'       WN0008           COA RIN Type Fl
      * Rtv Trans Rsn Dft,Dsc RT - RFS Transaction Reason  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0079    WL0305    P      RFS Transaction
     C                     MOVEL'Y'       WL0308    P      RFS Trans Reaso
     C                     EXSR SVRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0306    YL0080    P      RFS Trans Reaso
     C                     MOVELWL0307    YN0019    P      RFS Trans Reaso
      * Exc Gen RIN SEP Trans XF - COA Batch Header RIN  * 
     C                     CALL 'PNT2XFR'              90  Exc Gen RIN SEP
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0123  30       Company Number
     C                     PARM WAL6T1    WQ0124  4        COA ULSD Compan
     C                     PARM WAI3NY    WQ0125  50       COA Batch Numbe
     C                     PARM WAJYNY    WQ0126  50       COA Batch Heade
     C                     PARM YL0074    WQ0127  50       COA Batch Hdr R
     C                     PARM WAMUT1    WQ0128 38        COA Batch Heade
     C                     PARM YL0042    WQ0129  80       COA RIN SSSSSSS
     C                     PARM YL0043    WQ0130  80       COA RIN EEEEEEE
     C                     PARM YL0044    WQ0131  80       COA RIN Volume
     C                     PARM YL0058    WQ0132 30        COA RIN Trans P
     C                     PARM YL0063    WQ0133  4        COA RIN Trans P
     C                     PARM WAC4NB    WQ0134  70       Order Number
     C                     PARM WADPNB    WQ0135  30       Order Sequence
     C                     PARM WAUENB    WQ0136  30       Order Secondary
     C                     PARM WARZNB    WQ0137  50       Case Sequence N
     C                     PARM WANGT1    WQ0138 15        COA Rail Car
     C                     PARM WARMNB    WQ0139  70       Load ID
     C                     PARM 0         WQ0140  70       COA Date of 1st
     C                     PARM 0         WQ0141  60       COA RIN Unused
     C                     PARM *BLANK    WQ0142  1        COA RIN Modifie
     C                     PARM *BLANK    WQ0143 25        COA RIN Unused
     C                     PARM YL0075    WQ0144  1        COA RIN SoldFul
     C                     PARM WAQWNY    WQ0145  80       COA RIN Gallons
     C                     PARM WAL0AA    WQ0146  3        COA Ship To War
     C                     PARM WN0008    WQ0147  1        COA RIN Type Fl
     C                     PARM WATDNA    WQ0148 15        COA RIN Custome
     C                     PARM WACWC3    WQ0149  30       COA Shipping Co
     C                     PARM WAQXNY    WQ0150  70       COA Ref Load Id
     C                     PARM WAQZNY    WQ0151  50       COA Reference B
     C                     PARM WAQ0NY    WQ0152  50       COA Reference B
     C                     PARM WALVTX    WQ0153  2        RFS Compliance
     C                     PARM WANYT1    WQ0154  4        RFS Report Year
     C                     PARM WAG5ST    WQ0155  1        COA RIN Int/Ext
     C                     PARM WAG7ST    WQ0156  2        COA BHR Unused
     C                     PARM WATFDT    WQ0157  70       COA BHR Net Gal
     C                     PARM WATGDT    WQ0158  70       COA BHR Unused
     C                     PARM WAWIT1    WQ0159 25        COA BHR Unused
     C                     PARM WAQYNY    WQ0160  70       COA BHR Loadout
     C                     PARM WAL7T1    WQ0161  5        COA ULSD Facili
     C                     PARM YL0045    WQ0162  70       COA Batch RIN V
     C                     PARM YL0046    WQ0163  70       COA RIN Quantit
     C                     PARM YL0079    WQ0164  3        RFS Transaction
     C                     PARM YL0080    WQ0165  3        RFS Trans Reaso
     C                     PARM WAMSAA    WQ0166  1        RFS Fuel Code
     C                     PARM YL0068    WQ0167  40       COA BHR RIN Gen
     C                     PARM 0         WQ0168  72       COA BHR RIN Pri
     C                     PARM YL0070    WQ0169  72       COA BHR Gallon
     C                     PARM WAWVT1    WQ0170 50        COA Transaction
     C                     PARM WAW0T1    WQ0171 25        COA RIN Support
     C                     PARM WAR5NY    WQ0172  70       COA RIN Support
     C                     PARM WAW1T1    WQ0173 25        COA RIN Support
     C                     PARM WAR6NY    WQ0174  70       COA RIN Support
     C                     PARM WAJ1ST    WQ0175  1        COA BHR RFS Ver
     C                     PARM YL0066    WQ0176  1        COA GEN EMTS St
     C                     PARM 0         WQ0177  70       COA GEN EMTS Da
     C                     PARM 0         WQ0178  60       COA GEN EMTS Ti
     C                     PARM YL0067    WQ0179  1        COA RIN EMTS St
     C                     PARM 0         WQ0180  70       COA RIN EMTS Da
     C                     PARM 0         WQ0181  60       COA RIN EMTS Ti
     C                     PARM WAR9NY    WQ0182  70       COA EMTS PTD Nb
     C                     PARM YL0078    WQ0183  80       COA EMTS Batch
     C                     PARM WABHR3    WQ0184  2        COA BHR Unused
     C                     PARM WASRNY    WQ0185  80       COA BHR Unused
     C                     PARM *BLANK    WQ0186 40        COA EMTS Trans
     C                     PARM *BLANK    WQ0187 10        COA EMTS Return
     C                     PARM WAT2DT    WQ0188  70       COA BHR Unused
     C                     PARM WASYNY    WQ0189  70       COA BHR RINs to
     C                     PARM 0         WQ0190  70       COA Unassgnd Tx
     C                     PARM YL0059    WQ0191  81       COA RIN Equival
     C                     PARM WN0023    WQ0192  70       Actual Ship Dat
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNT2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: LCL.Warehouse Location is External
     C           YL0021    IFEQ 'E'                        *IF
      * If order in ready to invoice print, get the rin # and upd the rcd
      * CASE:
      *  - c1ANDc2ANDc3
      *   |- c1    : LCL.Order Type Print Status is yes
      *   |- c2    : DB1.COA Batch Header RIN is Eq Blank
      *   |- c3    : DB1.COA RIN Transaction Date is not entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0001    IFEQ 'Y'                        *IF
     C           WAMUT1    IFEQ *BLANK                     *IF
     C           WARIDT    IFEQ 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Key for BUY RIN that was sold to outside from external whse.
      *   and create SEL RIN from net gallons sold
      * RTV HPB to Gen RIN    RT - Manifest Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWACWC3    WL0001           Company Number
     C                     Z-ADDWAC4NB    WL0002           Order Number
     C                     Z-ADDWADPNB    WL0003           Order Sequence
     C                     Z-ADDWAUENB    WL0004           Order Secondary
     C                     Z-ADDWARZNB    WL0005           Case Sequence N
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    YL0027           Item Code
     C                     Z-ADDWL0007    YL0028           HPB Meter Net G
     C                     Z-ADDWL0008    YL0029           HPB Meter Start
     C                     Z-ADDWL0009    YL0030           HPB Meter Endin
     C                     Z-ADDWL0010    YL0031           HPB Meter Total
     C                     Z-ADDWL0011    YL0032           HPB Meter Net W
      * RTV RIN Key fields    RT - Manifest Detail RIN Sell  * 
     C                     EXSR SXRVGN
      * RTV Bilto/Customer     RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWACWC3    WL0045           Company Number
     C                     Z-ADDWAC4NB    WL0046           Order Number
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0047    YL0057           Bill to Custome
     C                     MOVELWL0048    YL0058    P      Bill to Name
      * RMC 1/20/20 R16048 USe db1.coa shipping co instead of db1.company
      * RTV HPB RIN Fields     RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWACWC3    WL0049           Company Number
     C                     Z-ADDWAC4NB    WL0050           Order Number
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0051    YL0059           OHE HPB RIN Equ
     C                     Z-ADDWL0052    YL0060           OHE HPB RIN Pri
     C                     MOVELWL0053    YL0061    P      OHE Override Ty
      * CASE: LCL.OHE HPB RIN Equiv Value is EQ 0
     C           YL0059    IFEQ 0                          *IF
     C                     Z-ADDWASXNY    YL0059           OHE HPB RIN Equ
     C                     END                             *FI
      * CASE: LCL.OHE Override Type Code is No
     C           YL0061    IFEQ *BLANK                     *IF
      * Rtv Customer Type     RT - Company Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0057    WL0059           Ship To Custome
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0060    YL0065    P      Type Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELYL0061    YL0065           Type Code
     C                     END                             *FI
      * Not RIN and RIN/BLender SEP updates
      * CASE: LCL.Type Code is Not RIN Customer
     C           YL0065    IFEQ 'NR'                       *IF
      * Rtv Key RIN for SEL   RT - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0313           Company Number
     C                     MOVELYL0035    WL0314    P      COA ULSD Compan
     C                     Z-ADDYL0084    WL0315           COA Batch Numbe
     C                     Z-ADDYL0085    WL0316           COA Batch Heade
     C                     Z-ADDYL0074    WL0317           COA Batch Hdr R
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0318    YL0041    P      COA Batch Heade
     C                     Z-ADDWL0319    YL0042           COA RIN SSSSSSS
     C                     Z-ADDWL0320    YL0043           COA RIN EEEEEEE
     C                     Z-ADDWL0321    YL0044           COA RIN Volume
     C                     Z-ADDWL0322    YL0077           COA RIN Gallons
     C                     MOVELWL0323    YL0087    P      COA RIN Type Fl
     C                     Z-ADDWL0324    YL0088           COA BHR Net Gal
     C                     Z-ADDWL0325    YL0089           COA BHR Loadout
     C                     Z-ADDWL0326    YL0076           COA BHR RINs to
     C                     Z-ADDYL0077    WUQWNY           COA RIN Gallons
      * Rtv Equiv Value f/btchRT - COA Batch Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0327           Company Number
     C                     MOVELWAL6T1    WL0328    P      COA ULSD Compan
     C                     Z-ADDWAI3NY    WL0329           COA Batch Numbe
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0330    YL0082           COA RIN Equival
      * Exc HPB RIN Gen Split  XF - COA Batch Header RIN  * 
     C                     CALL 'PNOMXFR'              90  Exc HPB RIN Gen
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0193  30       Company Number
     C                     PARM WAL6T1    WQ0194  4        COA ULSD Compan
     C                     PARM WAI3NY    WQ0195  50       COA Batch Numbe
     C                     PARM WAJYNY    WQ0196  50       COA Batch Heade
     C                     PARM YL0041    WQ0197 38        COA Batch Heade
     C                     PARM YL0042    WQ0198  80       COA RIN SSSSSSS
     C                     PARM YL0043    WQ0199  80       COA RIN EEEEEEE
     C           YL0044    PARM YL0044    WQ0200  80       COA RIN Volume
     C           YL0077    PARM YL0077    WQ0201  80       COA RIN Gallons
     C           YL0088    PARM YL0088    WQ0202  70       COA BHR Net Gal
     C           YL0046    PARM YL0046    WQ0203  70       COA RIN Quantit
     C                     PARM YL0076    WQ0204  70       COA BHR RINs to
     C           YL0090    PARM *BLANK    WQ0205 38        COA Batch RIN
     C           YL0091    PARM YL0091    WQ0206  80       COA RIN SSSSSSS
     C           YL0092    PARM YL0092    WQ0207  80       COA RIN EEEEEEE
     C           YL0093    PARM YL0093    WQ0208  80       COA RIN Volume
     C                     PARM YL0028    WQ0209  70       Quantity 7.0 US
     C                     PARM YL0082    WQ0210  81       COA RIN Equival
     C           YL0094    PARM YL0094    WQ0211  70       COA Batch RIN V
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNOMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * upd SEL rin with fuel sold Unassigned "U" sts
      * E2013 RMC 3/21/12 output act ship date as rin trans dt
      * Chg Sold Fl/Splt/UnStsCH - COA Batch Header RIN  * 
     C                     EXSR TACHRC
      * RMC 5/4/10 was wrk.rin gallons sold - need to incr RINS sold
      *      so they wont be re-sold assigned, increas rins sold SEP too
      * RMC 7/13/11 pass in lcl.coa rin quantity to upd rins sold unassgn
      *   instead of using lcl.rin gallons sold
      * Rtv Upd Ref Ord f/Inv RT - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0331           Company Number
     C                     MOVELYL0035    WL0332    P      COA ULSD Compan
     C                     Z-ADDYL0084    WL0333           COA Batch Numbe
     C                     Z-ADDYL0085    WL0334           COA Batch Heade
     C                     Z-ADDYL0074    WL0335           COA Batch Hdr R
     C                     Z-ADDYL0077    WL0336           COA RIN Gallons
     C                     Z-ADDYL0088    WL0337           COA BHR Net Gal
     C                     Z-ADDYL0046    WL0338           COA RIN Quantit
     C                     MOVELYL0065    WL0339    P      Type Code
     C                     Z-ADD0         WL0340           RIN Adjustment
     C                     EXSR TBRVGN
     C                     ELSE
      * CASE: LCL.Type Code is Blender for Biodiesel
     C           YL0065    IFEQ 'BL'                       *IF
      * Rtv Key RIN for SEL   RT - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0313           Company Number
     C                     MOVELYL0035    WL0314    P      COA ULSD Compan
     C                     Z-ADDYL0084    WL0315           COA Batch Numbe
     C                     Z-ADDYL0085    WL0316           COA Batch Heade
     C                     Z-ADDYL0074    WL0317           COA Batch Hdr R
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0318    YL0041    P      COA Batch Heade
     C                     Z-ADDWL0319    YL0042           COA RIN SSSSSSS
     C                     Z-ADDWL0320    YL0043           COA RIN EEEEEEE
     C                     Z-ADDWL0321    YL0044           COA RIN Volume
     C                     Z-ADDWL0322    YL0077           COA RIN Gallons
     C                     MOVELWL0323    YL0087    P      COA RIN Type Fl
     C                     Z-ADDWL0324    YL0088           COA BHR Net Gal
     C                     Z-ADDWL0325    YL0089           COA BHR Loadout
     C                     Z-ADDWL0326    YL0076           COA BHR RINs to
      * Rtv Equiv Value f/btchRT - COA Batch Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0327           Company Number
     C                     MOVELWAL6T1    WL0328    P      COA ULSD Compan
     C                     Z-ADDWAI3NY    WL0329           COA Batch Numbe
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0330    YL0082           COA RIN Equival
      * Exc HPB RIN Gen Split  XF - COA Batch Header RIN  * 
     C                     CALL 'PNOMXFR'              90  Exc HPB RIN Gen
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0212  30       Company Number
     C                     PARM WAL6T1    WQ0213  4        COA ULSD Compan
     C                     PARM WAI3NY    WQ0214  50       COA Batch Numbe
     C                     PARM WAJYNY    WQ0215  50       COA Batch Heade
     C                     PARM YL0041    WQ0216 38        COA Batch Heade
     C                     PARM YL0042    WQ0217  80       COA RIN SSSSSSS
     C                     PARM YL0043    WQ0218  80       COA RIN EEEEEEE
     C           YL0044    PARM YL0044    WQ0219  80       COA RIN Volume
     C           YL0077    PARM YL0077    WQ0220  80       COA RIN Gallons
     C           YL0088    PARM YL0088    WQ0221  70       COA BHR Net Gal
     C           YL0046    PARM YL0046    WQ0222  70       COA RIN Quantit
     C                     PARM YL0076    WQ0223  70       COA BHR RINs to
     C           YL0090    PARM *BLANK    WQ0224 38        COA Batch RIN
     C           YL0091    PARM YL0091    WQ0225  80       COA RIN SSSSSSS
     C           YL0092    PARM YL0092    WQ0226  80       COA RIN EEEEEEE
     C           YL0093    PARM YL0093    WQ0227  80       COA RIN Volume
     C                     PARM YL0028    WQ0228  70       Quantity 7.0 US
     C                     PARM YL0082    WQ0229  81       COA RIN Equival
     C           YL0094    PARM YL0094    WQ0230  70       COA Batch RIN V
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNOMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD0         YL0098           RIN Adjustment
      * Calc vol with SEP equiv value
      * Rtv Equiv Value f/SEP RT - COA Batch Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0309           Company Number
     C                     MOVELWAL6T1    WL0310    P      COA ULSD Compan
     C                     Z-ADDWAI3NY    WL0311           COA Batch Numbe
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0312    WN0022    P      COA BH Equiv Va
     C                     Z-ADD*ZERO     WUJ3NY           COA RIN Equival
     C                     MOVE WN0022    WUJ3NY           COA RIN Equival
     C                     Z-ADD0         YL0099           Volume Needed
      * if SEP Equiv value GT batch,adjust volume.
      * CASE: WRK.COA RIN Equivalence Valu# GT LCL.COA RIN Equivalence Va
     C           WUJ3NY    IFGT YL0082                     *IF
      * 2/06/12 C1918 chg above NE to GT
      * Calc new volume for 1st SEP from RIN quantity / 2.5
      *   Round any dec place to next whole nmbr - so add .5 then round
      * Comp: vol at 2.5 the rins
      * LCL.AMOUNT =
      *    *COMPUTE (x1/x2)
      * x1    : LCL.COA RIN Quantity
      * /     : PGM.*Synon (15,2) work field *
      * x2    : WRK.COA RIN Equivalence Valu#
     C           YL0046    DIV  WUJ3NY    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0100           AMOUNT
     C                     Z-ADDYL0100    YL0101           Decimal Places
      * chk decimal places>0
      * CASE: LCL.Decimal Places    usr is GT .00
     C           YL0101    IFGT .00                        *IF
     C                     ADD  .5        YL0100           AMOUNT
     C                     END                             *FI
     C           YL0100    MULT 1         YL0045    H      COA Batch RIN V
      * Calc Volume needed =  Orig Volume - Volume at 2.5
     C           YL0094    SUB  YL0045    YL0099           Volume Needed
     C                     END                             *FI
      * P0579 EMTS 5/13/10 RMC Update vol, rin qty, price, year, emts sts
      * RFS VERSION 1 OR 2
      * CASE: DB1.COA BHR RFS Version Nbr is RFS 2
     C           WAJ1ST    IFEQ '2'                        *IF
     C                     MOVEL'0'       YL0067           COA RIN EMTS St
     C                     MOVEL*BLANK    YL0090           COA Batch RIN
     C                     ELSE
      * CASE: *OTHERWISE
      * RINs originally created under version rfs 1, are sold outside of
     C                     MOVEL*BLANK    YL0067           COA RIN EMTS St
     C                     END                             *FI
      * BHR RIN Gen Year
      * CASE: DB1.COA BHR RIN Gen Year is not equal to zero
     C           WAR7NY    IFNE 0                          *IF
     C                     Z-ADDWAR7NY    YL0068           COA BHR RIN Gen
     C                     ELSE
      * CASE: *OTHERWISE
      * E2013 RMC 3/21/12 output act ship date as rin yr
      * LCL.COA BHR RIN Gen Year = PAR.Actual Ship Date Usr *YEAR
     C           WN0023    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    YL0068
     C                     END                             *FI
      * RMC 1/20/20 R16048 USe db1.coa shipping co instead of db1.company
      * RTV Unit Price        RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWACWC3    WL0061           Company Number
     C                     Z-ADDWAC4NB    WL0062           Order Number
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0063    YL0069           Unit Price
     C           YL0069    MULT 1         YL0070    H      COA BHR Gallon
      *   Upd BUY RIN with RIN gallons sold and reduce net galls to sell
      * RMC 7/13/11 pass in lcl.coa rin quantity to upd rins sold unassgn
      *   instead of using lcl.rin gallons sold
      * Rtv Upd Ref Ord f/Inv RT - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0331           Company Number
     C                     MOVELYL0035    WL0332    P      COA ULSD Compan
     C                     Z-ADDYL0084    WL0333           COA Batch Numbe
     C                     Z-ADDYL0085    WL0334           COA Batch Heade
     C                     Z-ADDYL0074    WL0335           COA Batch Hdr R
     C                     Z-ADDYL0077    WL0336           COA RIN Gallons
     C                     Z-ADDYL0088    WL0337           COA BHR Net Gal
     C                     Z-ADDYL0046    WL0338           COA RIN Quantit
     C                     MOVELYL0065    WL0339    P      Type Code
     C                     Z-ADDYL0098    WL0340           RIN Adjustment
     C                     EXSR TBRVGN
      *   Upd SEP RIN with RIN gallons sold and volume at SEP equiv value
      * Rtv Upd Ord f/inv     RT - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0341           Company Number
     C                     MOVELWAL6T1    WL0342    P      COA ULSD Compan
     C                     Z-ADDWAI3NY    WL0343           COA Batch Numbe
     C                     Z-ADDWAJYNY    WL0344           COA Batch Heade
     C                     Z-ADDWAQ1NY    WL0345           COA Batch Hdr R
     C                     Z-ADDYL0045    WL0346           COA Batch RIN V
     C                     Z-ADDYL0046    WL0347           COA RIN Quantit
     C                     Z-ADDYL0068    WL0348           COA BHR RIN Gen
     C                     Z-ADDYL0070    WL0349           COA BHR Gallon
     C                     MOVELYL0067    WL0350    P      COA RIN EMTS St
     C                     Z-ADDWASQNY    WL0351           COA EMTS Batch
     C                     Z-ADDWUJ3NY    WL0352           COA BHR Equiv V
     C                     Z-ADDYL0091    WL0353           COA RIN SSSSSSS
     C                     Z-ADDYL0092    WL0354           COA RIN EEEEEEE
     C                     Z-ADDYL0093    WL0355           COA RIN Volume
     C                     MOVELYL0090    WL0356    P      COA Batch RIN
     C                     Z-ADDWN0023    WL0357           Actual Ship Dat
     C                     EXSR TCRVGN
      * Get extra volume f/unassn rins not sold
      * CASE: LCL.Volume Needed         usr is Greater than Zero
     C           YL0099    IFGT 0                          *IF
      * Exc Gen RIN SEP-f/Ext XF - COA Batch Header RIN  * 
     C                     CALL 'PNT8XFR'              90  Exc Gen RIN SEP
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0231  30       Company Number
     C                     PARM WAL6T1    WQ0232  4        COA ULSD Compan
     C                     PARM WAI3NY    WQ0233  50       COA Batch Numbe
     C                     PARM WAJYNY    WQ0234  50       COA Batch Heade
     C                     PARM WAQ1NY    WQ0235  50       COA Batch Hdr R
     C                     PARM YL0041    WQ0236 38        COA Batch Heade
     C                     PARM YL0042    WQ0237  80       COA RIN SSSSSSS
     C                     PARM YL0043    WQ0238  80       COA RIN EEEEEEE
     C                     PARM YL0044    WQ0239  80       COA RIN Volume
     C                     PARM WAMVT1    WQ0240 30        COA RIN Trans P
     C                     PARM WAMWT1    WQ0241  4        COA RIN Trans P
     C                     PARM WAC4NB    WQ0242  70       Order Number
     C                     PARM WADPNB    WQ0243  30       Order Sequence
     C                     PARM WAUENB    WQ0244  30       Order Secondary
     C                     PARM WARZNB    WQ0245  50       Case Sequence N
     C                     PARM WANGT1    WQ0246 15        COA Rail Car
     C                     PARM WARMNB    WQ0247  70       Load ID
     C                     PARM WARKDT    WQ0248  70       COA Date of 1st
     C                     PARM WAC7TM    WQ0249  60       COA RIN Unused
     C                     PARM WARINS    WQ0250  1        COA RIN Modifie
     C                     PARM WAMXT1    WQ0251 25        COA RIN Unused
     C                     PARM WAG3ST    WQ0252  1        COA RIN SoldFul
     C                     PARM WAQWNY    WQ0253  80       COA RIN Gallons
     C                     PARM WAL0AA    WQ0254  3        COA Ship To War
     C                     PARM WAMAT1    WQ0255  1        COA RIN Type Fl
     C                     PARM WATDNA    WQ0256 15        COA RIN Custome
     C                     PARM WACWC3    WQ0257  30       COA Shipping Co
     C                     PARM WAQXNY    WQ0258  70       COA Ref Load Id
     C                     PARM WAQZNY    WQ0259  50       COA Reference B
     C                     PARM WAQ0NY    WQ0260  50       COA Reference B
     C                     PARM WALVTX    WQ0261  2        RFS Compliance
     C                     PARM WANYT1    WQ0262  4        RFS Report Year
     C                     PARM WAG5ST    WQ0263  1        COA RIN Int/Ext
     C                     PARM WAG7ST    WQ0264  2        COA BHR Unused
     C                     PARM WATFDT    WQ0265  70       COA BHR Net Gal
     C                     PARM WATGDT    WQ0266  70       COA BHR Unused
     C                     PARM WAWIT1    WQ0267 25        COA BHR Unused
     C                     PARM WAQYNY    WQ0268  70       COA BHR Loadout
     C                     PARM WAL7T1    WQ0269  5        COA ULSD Facili
     C                     PARM YL0045    WQ0270  70       COA Batch RIN V
     C                     PARM WAR0NY    WQ0271  70       COA RIN Quantit
     C                     PARM WAI7AA    WQ0272  3        RFS Transaction
     C                     PARM WAMXAA    WQ0273  3        RFS Trans Reaso
     C                     PARM WAMSAA    WQ0274  1        RFS Fuel Code
     C                     PARM YL0068    WQ0275  40       COA BHR RIN Gen
     C                     PARM WAHEPR    WQ0276  72       COA BHR RIN Pri
     C                     PARM YL0070    WQ0277  72       COA BHR Gallon
     C                     PARM WAWVT1    WQ0278 50        COA Transaction
     C                     PARM WAW0T1    WQ0279 25        COA RIN Support
     C                     PARM WAR5NY    WQ0280  70       COA RIN Support
     C                     PARM WAW1T1    WQ0281 25        COA RIN Support
     C                     PARM WAR6NY    WQ0282  70       COA RIN Support
     C                     PARM WAJ1ST    WQ0283  1        COA BHR RFS Ver
     C                     PARM WAKHST    WQ0284  1        COA GEN EMTS St
     C                     PARM WATWDT    WQ0285  70       COA GEN EMTS Da
     C                     PARM WADUTM    WQ0286  60       COA GEN EMTS Ti
     C                     PARM WAKGST    WQ0287  1        COA RIN EMTS St
     C                     PARM WATVDT    WQ0288  70       COA RIN EMTS Da
     C                     PARM WADTTM    WQ0289  60       COA RIN EMTS Ti
     C                     PARM WAR9NY    WQ0290  70       COA EMTS PTD Nb
     C                     PARM WASQNY    WQ0291  80       COA EMTS Batch
     C                     PARM WABHR3    WQ0292  2        COA BHR Unused
     C                     PARM WASRNY    WQ0293  80       COA BHR Unused
     C                     PARM WAW7T1    WQ0294 40        COA EMTS Trans
     C                     PARM WAW8T1    WQ0295 10        COA EMTS Return
     C                     PARM WAT2DT    WQ0296  70       COA BHR Unused
     C                     PARM WUJ3NY    WQ0297  21       COA BHR Equiv V
     C                     PARM WASYNY    WQ0298  70       COA BHR RINs to
     C                     PARM WASZNY    WQ0299  70       COA Unassgnd Tx
     C           YL0099    PARM YL0099    WQ0300  70       Volume Needed
     C                     PARM WN0023    WQ0301  70       Actual Ship Dat
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNT8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Key RIN for SEL   RT - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0313           Company Number
     C                     MOVELYL0035    WL0314    P      COA ULSD Compan
     C                     Z-ADDYL0084    WL0315           COA Batch Numbe
     C                     Z-ADDYL0085    WL0316           COA Batch Heade
     C                     Z-ADDYL0074    WL0317           COA Batch Hdr R
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0318    YL0041    P      COA Batch Heade
     C                     Z-ADDWL0319    YL0042           COA RIN SSSSSSS
     C                     Z-ADDWL0320    YL0043           COA RIN EEEEEEE
     C                     Z-ADDWL0321    YL0044           COA RIN Volume
     C                     Z-ADDWL0322    YL0077           COA RIN Gallons
     C                     MOVELWL0323    YL0087    P      COA RIN Type Fl
     C                     Z-ADDWL0324    YL0088           COA BHR Net Gal
     C                     Z-ADDWL0325    YL0089           COA BHR Loadout
     C                     Z-ADDWL0326    YL0076           COA BHR RINs to
      * Rtv Equiv Value f/btchRT - COA Batch Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0327           Company Number
     C                     MOVELWAL6T1    WL0328    P      COA ULSD Compan
     C                     Z-ADDWAI3NY    WL0329           COA Batch Numbe
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0330    YL0082           COA RIN Equival
      * Exc HPB RIN Gen Split  XF - COA Batch Header RIN  * 
     C                     CALL 'PNOMXFR'              90  Exc HPB RIN Gen
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0302  30       Company Number
     C                     PARM WAL6T1    WQ0303  4        COA ULSD Compan
     C                     PARM WAI3NY    WQ0304  50       COA Batch Numbe
     C                     PARM WAJYNY    WQ0305  50       COA Batch Heade
     C                     PARM YL0041    WQ0306 38        COA Batch Heade
     C                     PARM YL0042    WQ0307  80       COA RIN SSSSSSS
     C                     PARM YL0043    WQ0308  80       COA RIN EEEEEEE
     C           YL0044    PARM YL0044    WQ0309  80       COA RIN Volume
     C           YL0077    PARM YL0077    WQ0310  80       COA RIN Gallons
     C           YL0088    PARM YL0088    WQ0311  70       COA BHR Net Gal
     C           YL0046    PARM YL0046    WQ0312  70       COA RIN Quantit
     C                     PARM YL0076    WQ0313  70       COA BHR RINs to
     C           YL0090    PARM *BLANK    WQ0314 38        COA Batch RIN
     C           YL0091    PARM YL0091    WQ0315  80       COA RIN SSSSSSS
     C           YL0092    PARM YL0092    WQ0316  80       COA RIN EEEEEEE
     C           YL0093    PARM YL0093    WQ0317  80       COA RIN Volume
     C                     PARM YL0028    WQ0318  70       Quantity 7.0 US
     C                     PARM YL0082    WQ0319  81       COA RIN Equival
     C           YL0094    PARM YL0094    WQ0320  70       COA Batch RIN V
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNOMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD0         YL0098           RIN Adjustment
     C                     Z-ADD0         YL0099           Volume Needed
      * if SEL Equiv value GT batch,adjust volume.
      * CASE: LCL.OHE HPB RIN Equiv Value GT LCL.COA RIN Equivalence Valu
     C           YL0059    IFGT YL0082                     *IF
      * 2/06/12 C1918 chg above NE to GT
      * Calc new volume for 1st SEP from RIN quantity / 2.5
      *   Round any dec place to next whole nmbr - so add .5 then round
      * Comp: vol at 2.5 the rins
      * LCL.AMOUNT =
      *    *COMPUTE (x1/x2)
      * x1    : LCL.COA RIN Quantity
      * /     : PGM.*Synon (15,2) work field *
      * x2    : LCL.OHE HPB RIN Equiv Value
     C           YL0046    DIV  YL0059    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0100           AMOUNT
     C                     Z-ADDYL0100    YL0101           Decimal Places
      * chk decimal places>0
      * CASE: LCL.Decimal Places    usr is GT .00
     C           YL0101    IFGT .00                        *IF
     C                     ADD  .5        YL0100           AMOUNT
     C                     END                             *FI
     C           YL0100    MULT 1         YL0045    H      COA Batch RIN V
      * Calc Volume needed =  Orig Volume - Volume at 2.5
     C           YL0094    SUB  YL0045    YL0099           Volume Needed
     C                     Z-ADDYL0059    YL0082           COA RIN Equival
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0094    YL0045           COA Batch RIN V
     C                     END                             *FI
      * if SEL Equiv value LT batch, then put excess in Rins to sell Unss
      * CASE: LCL.OHE HPB RIN Equiv Value LT LCL.COA RIN Equivalence Valu
     C           YL0059    IFLT YL0082                     *IF
     C                     Z-ADDYL0046    YL0098           RIN Adjustment
      * Calc rins needed per OHE Rin equiv value
      * Comp: rins at OHE equiv
      * LCL.COA RIN Quantity =
      *    *COMPUTE (x1*x2)
      * x1    : LCL.HPB Meter Net Gallon
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x2    : LCL.OHE HPB RIN Equiv Value
     C           YL0028    MULT YL0059    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0046           COA RIN Quantit
     C                     Z-ADDYL0046    YL0093           COA RIN Volume
      * Calc Excess RINs  =  Orig RINs - RIN Adjustment which is rins at
     C                     SUB  YL0046    YL0098           RIN Adjustment
      * reduce rin gallons sold by what is going into rins to sell unassn
     C                     SUB  YL0098    YL0077           COA RIN Gallons
     C                     Z-ADDYL0059    YL0082           COA RIN Equival
     C           YL0091    ADD  YL0046    YL0092           COA RIN EEEEEEE
      * Sub 1 for inclusive
     C                     SUB  1         YL0092           COA RIN EEEEEEE
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
      * RMC -- NEW 7-10-15
      * IF no rins exist on orig buy rcd 7-10-15, calc batch volume to ge
      * CASE: LCL.COA RIN Quantity is ZERO
     C           YL0046    IFEQ 0                          *IF
      * CASE: LCL.Item Code is B100
     C           YL0027    IFEQ 11000                      *IF
     C                     Z-ADD100       YL0102           COA BOL Percent
     C                     END                             *FI
      * CASE: LCL.Item Code is B99.9
     C           YL0027    IFEQ 10999                      *IF
     C                     Z-ADD99.9      YL0102           COA BOL Percent
     C                     END                             *FI
      * Compute:vol needed usr
      * LCL.Volume Needed         usr =
      *    *COMPUTE (x1 *(x2/x3))
      * x1    : LCL.HPB Meter Net Gallon
      * *     : PGM.*Synon (17,7) work field *
      * x2    : LCL.COA BOL Percent
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           YL0102    DIV  100       W0WD01           *Synon (17,7) w
     C           YL0028    MULT W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0099           Volume Needed
     C                     Z-ADDYL0059    YL0082           COA RIN Equival
     C                     END                             *FI
      * P0579 EMTS 5/13/10 RMC Update vol, rin qty, price, year, emts sts
      * RFS Version 1 or 2
      * CASE: DB1.COA BHR RFS Version Nbr is RFS 2
     C           WAJ1ST    IFEQ '2'                        *IF
     C                     MOVEL'0'       YL0067           COA RIN EMTS St
     C                     MOVEL*BLANK    YL0090           COA Batch RIN
     C                     ELSE
      * CASE: *OTHERWISE
      * RINs originally created under version rfs 1, are sold outside of
     C                     MOVEL*BLANK    YL0067           COA RIN EMTS St
     C                     END                             *FI
      * RTV Unit Price        RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWACWC3    WL0061           Company Number
     C                     Z-ADDWAC4NB    WL0062           Order Number
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0063    YL0069           Unit Price
     C           YL0069    MULT 1         YL0070    H      COA BHR Gallon
      * *************************
      * Dont output EMTS Batch if GEN date older than 12/21/11       E186
      *   So those will process FIFO in EMTS
     C                     Z-ADDWASQNY    YL0078           COA EMTS Batch
      * R6965 RMC 8/16/16 new hpb plant
      * Rtv GEN Dt for org SELRT - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0022    WL0358           Company Number
     C                     MOVELWAL6T1    WL0359    P      COA ULSD Compan
     C                     Z-ADDWAI3NY    WL0360           COA Batch Numbe
     C                     Z-ADDWAJYNY    WL0361           COA Batch Heade
     C                     EXSR TDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0362    WUR7NY           COA BHR RIN Gen
     C                     Z-ADDWL0363    YL0103           COA GEN EMTS Da
      * 1/03/2012 -- ALL SELs are to be FIFO NOW in EMTS
     C                     Z-ADD0         YL0078           COA EMTS Batch
      * BHR RIN Gen Year
      * CASE: DB1.COA BHR RIN Gen Year is not equal to zero
     C           WAR7NY    IFNE 0                          *IF
     C                     Z-ADDWAR7NY    YL0068           COA BHR RIN Gen
     C                     ELSE
      * CASE: WRK.COA BHR RIN Gen Year is not equal to zero
     C           WUR7NY    IFNE 0                          *IF
     C                     Z-ADDWUR7NY    YL0068           COA BHR RIN Gen
     C                     ELSE
      * CASE: *OTHERWISE
      * E2013 RMC 3/21/12 output act ship date as rin yr
      * LCL.COA BHR RIN Gen Year = PAR.Actual Ship Date Usr *YEAR
     C           WN0023    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    YL0068
     C                     END                             *FI
     C                     END                             *FI
      * ************************
      * CASE: LCL.COA RIN Quantity is ZERO
     C           YL0046    IFEQ 0                          *IF
      * mark processed so it wont try to go to emts    7-13-15
     C                     MOVEL'1'       YL0067           COA RIN EMTS St
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'0'       YL0067           COA RIN EMTS St
     C                     END                             *FI
      * Rtv Upd Ord f/inv     RT - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0341           Company Number
     C                     MOVELWAL6T1    WL0342    P      COA ULSD Compan
     C                     Z-ADDWAI3NY    WL0343           COA Batch Numbe
     C                     Z-ADDWAJYNY    WL0344           COA Batch Heade
     C                     Z-ADDWAQ1NY    WL0345           COA Batch Hdr R
     C                     Z-ADDYL0045    WL0346           COA Batch RIN V
     C                     Z-ADDYL0046    WL0347           COA RIN Quantit
     C                     Z-ADDYL0068    WL0348           COA BHR RIN Gen
     C                     Z-ADDYL0070    WL0349           COA BHR Gallon
     C                     MOVELYL0067    WL0350    P      COA RIN EMTS St
     C                     Z-ADDYL0078    WL0351           COA EMTS Batch
     C                     Z-ADDYL0082    WL0352           COA BHR Equiv V
     C                     Z-ADDYL0091    WL0353           COA RIN SSSSSSS
     C                     Z-ADDYL0092    WL0354           COA RIN EEEEEEE
     C                     Z-ADDYL0093    WL0355           COA RIN Volume
     C                     MOVELYL0090    WL0356    P      COA Batch RIN
     C                     Z-ADDWN0023    WL0357           Actual Ship Dat
     C                     EXSR TCRVGN
      *   Upd BUY RIN with RIN gallons sold and reduce net galls to sell
      * RMC 7/13/11 pass in lcl.coa rin quantity to upd rins sold unassgn
      *   instead of using lcl.rin gallons sold
      * Rtv Upd Ref Ord f/Inv RT - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0331           Company Number
     C                     MOVELYL0035    WL0332    P      COA ULSD Compan
     C                     Z-ADDYL0084    WL0333           COA Batch Numbe
     C                     Z-ADDYL0085    WL0334           COA Batch Heade
     C                     Z-ADDYL0074    WL0335           COA Batch Hdr R
     C                     Z-ADDYL0077    WL0336           COA RIN Gallons
     C                     Z-ADDYL0088    WL0337           COA BHR Net Gal
     C                     Z-ADDYL0046    WL0338           COA RIN Quantit
     C                     MOVELYL0065    WL0339    P      Type Code
     C                     Z-ADDYL0098    WL0340           RIN Adjustment
     C                     EXSR TBRVGN
      * Get extra volume f/unassn rins not sold
      * CASE: LCL.Volume Needed         usr is Greater than Zero
     C           YL0099    IFGT 0                          *IF
      * Exc Gen RIN SEP-f/Ext XF - COA Batch Header RIN  * 
     C                     CALL 'PNT8XFR'              90  Exc Gen RIN SEP
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0321  30       Company Number
     C                     PARM WAL6T1    WQ0322  4        COA ULSD Compan
     C                     PARM WAI3NY    WQ0323  50       COA Batch Numbe
     C                     PARM WAJYNY    WQ0324  50       COA Batch Heade
     C                     PARM WAQ1NY    WQ0325  50       COA Batch Hdr R
     C                     PARM YL0041    WQ0326 38        COA Batch Heade
     C                     PARM YL0042    WQ0327  80       COA RIN SSSSSSS
     C                     PARM YL0043    WQ0328  80       COA RIN EEEEEEE
     C                     PARM YL0044    WQ0329  80       COA RIN Volume
     C                     PARM WAMVT1    WQ0330 30        COA RIN Trans P
     C                     PARM WAMWT1    WQ0331  4        COA RIN Trans P
     C                     PARM WAC4NB    WQ0332  70       Order Number
     C                     PARM WADPNB    WQ0333  30       Order Sequence
     C                     PARM WAUENB    WQ0334  30       Order Secondary
     C                     PARM WARZNB    WQ0335  50       Case Sequence N
     C                     PARM WANGT1    WQ0336 15        COA Rail Car
     C                     PARM WARMNB    WQ0337  70       Load ID
     C                     PARM WARKDT    WQ0338  70       COA Date of 1st
     C                     PARM WAC7TM    WQ0339  60       COA RIN Unused
     C                     PARM WARINS    WQ0340  1        COA RIN Modifie
     C                     PARM WAMXT1    WQ0341 25        COA RIN Unused
     C                     PARM WAG3ST    WQ0342  1        COA RIN SoldFul
     C                     PARM WAQWNY    WQ0343  80       COA RIN Gallons
     C                     PARM WAL0AA    WQ0344  3        COA Ship To War
     C                     PARM WAMAT1    WQ0345  1        COA RIN Type Fl
     C                     PARM WATDNA    WQ0346 15        COA RIN Custome
     C                     PARM WACWC3    WQ0347  30       COA Shipping Co
     C                     PARM WAQXNY    WQ0348  70       COA Ref Load Id
     C                     PARM WAQZNY    WQ0349  50       COA Reference B
     C                     PARM WAQ0NY    WQ0350  50       COA Reference B
     C                     PARM WALVTX    WQ0351  2        RFS Compliance
     C                     PARM WANYT1    WQ0352  4        RFS Report Year
     C                     PARM WAG5ST    WQ0353  1        COA RIN Int/Ext
     C                     PARM WAG7ST    WQ0354  2        COA BHR Unused
     C                     PARM WATFDT    WQ0355  70       COA BHR Net Gal
     C                     PARM WATGDT    WQ0356  70       COA BHR Unused
     C                     PARM WAWIT1    WQ0357 25        COA BHR Unused
     C                     PARM WAQYNY    WQ0358  70       COA BHR Loadout
     C                     PARM WAL7T1    WQ0359  5        COA ULSD Facili
     C                     PARM YL0045    WQ0360  70       COA Batch RIN V
     C                     PARM WAR0NY    WQ0361  70       COA RIN Quantit
     C                     PARM WAI7AA    WQ0362  3        RFS Transaction
     C                     PARM WAMXAA    WQ0363  3        RFS Trans Reaso
     C                     PARM WAMSAA    WQ0364  1        RFS Fuel Code
     C                     PARM YL0068    WQ0365  40       COA BHR RIN Gen
     C                     PARM 0         WQ0366  72       COA BHR RIN Pri
     C                     PARM YL0070    WQ0367  72       COA BHR Gallon
     C                     PARM WAWVT1    WQ0368 50        COA Transaction
     C                     PARM WAW0T1    WQ0369 25        COA RIN Support
     C                     PARM WAR5NY    WQ0370  70       COA RIN Support
     C                     PARM WAW1T1    WQ0371 25        COA RIN Support
     C                     PARM WAR6NY    WQ0372  70       COA RIN Support
     C                     PARM WAJ1ST    WQ0373  1        COA BHR RFS Ver
     C                     PARM WAKHST    WQ0374  1        COA GEN EMTS St
     C                     PARM WATWDT    WQ0375  70       COA GEN EMTS Da
     C                     PARM WADUTM    WQ0376  60       COA GEN EMTS Ti
     C                     PARM WAKGST    WQ0377  1        COA RIN EMTS St
     C                     PARM WATVDT    WQ0378  70       COA RIN EMTS Da
     C                     PARM WADTTM    WQ0379  60       COA RIN EMTS Ti
     C                     PARM WAR9NY    WQ0380  70       COA EMTS PTD Nb
     C                     PARM WASQNY    WQ0381  80       COA EMTS Batch
     C                     PARM WABHR3    WQ0382  2        COA BHR Unused
     C                     PARM WASRNY    WQ0383  80       COA BHR Unused
     C                     PARM WAW7T1    WQ0384 40        COA EMTS Trans
     C                     PARM WAW8T1    WQ0385 10        COA EMTS Return
     C                     PARM WAT2DT    WQ0386  70       COA BHR Unused
     C                     PARM YL0059    WQ0387  21       COA BHR Equiv V
     C                     PARM WASYNY    WQ0388  70       COA BHR RINs to
     C                     PARM WASZNY    WQ0389  70       COA Unassgnd Tx
     C           YL0099    PARM YL0099    WQ0390  70       Volume Needed
     C                     PARM WN0023    WQ0391  70       Actual Ship Dat
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNT8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ******
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@DACPDL                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * SEL Inv to Crt RIN-HPB RT - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0024  1        Order Status
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * FP1110 RMC 7/18/08
      * This was copied from *SEL Invc to Print&Post RT* and modified to
      * Order type print status to Yes if an order passes validations and
      * be invoiced in the next step.  The calling routine of this functi
      * updates the Batch RIN with the RIN nbr so its there before the in
      * print
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDWACWC3    WBAIC3           Company Number
     C                     Z-ADDWAC4NB    WBC4NB           Order Number
      * Establish starting position
     C           KRSSB     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'N'       YL0001           Order Type Prin
     C                     Z-ADDWBGNDT    WN0023           Actual Ship Dat
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * ** If Billing Activity Type = 1 for Invoice
      * CASE: DB1.Billing Activity Type is Invoice
     C           WBOBST    IFEQ '1'                        *IF
      * Sel Customer Type     XF - Company Customer  * 
     C                     CALL 'PPUOXFR'              90  Sel Customer Ty
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBAIC3    WQ0001  30       Company Number
     C                     PARM WBBKC7    WQ0002  70       Ship To Custome
     C           YL0002    PARM YL0002    WQ0003  2        Type Code
     C                     PARM P4YDSX    WQ0004  2        Process Cust Ty
     C           W0RSL     PARM W0RSL     WQ0005  1        *Record selecte
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPUOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ** Process selected Customer Type (Third Party or Inter-Company)
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * ** Process record for any possible errors. Flag the header with
      * ** the results so the print program knows whether or not to print
      * ** this invoice.
      * 05/01/18 DN R12926-Removed Absorbed Freight Rate CWT Parm on PPX8
      * PRT Invc Excpt Select  XF - Order Header TRG  * 
     C                     CALL 'PPX8XFR'              90  PRT Invc Excpt
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBAIC3    WQ0006  30       Company Number
     C                     PARM WBC4NB    WQ0007  70       Order Number
     C                     PARM WBJNCD    WQ0008  2        Order Type - Sa
     C                     PARM WBANC7    WQ0009  70       A/R Customer Nu
     C                     PARM WBBKC7    WQ0010  70       Ship To Custome
     C                     PARM WBBCNA    WQ0011 15        Customer Purcha
     C                     PARM WBA0DT    WQ0012  70       Order Date
     C                     PARM WBGNDT    WQ0013  70       Actual Shipped
     C                     PARM WBGWST    WQ0014  1        Header Status
     C                     PARM WBGXST    WQ0015  1        Header Status L
     C                     PARM WBAODT    WQ0016  70       Scheduled Ship
     C                     PARM WBRMNB    WQ0017  70       Load ID
     C                     PARM WBU0ST    WQ0018  1        Price Audit
     C                     PARM WBU1ST    WQ0019  1        Price Status
     C                     PARM WBQ2CD    WQ0020  2        Shipping Method
     C                     PARM WBR4CD    WQ0021  3        Sales Route Cod
     C                     PARM WBJPCD    WQ0022  2        Event Code
     C                     PARM WBOBST    WQ0023  1        Billing Activit
     C                     PARM WAC4NB    WQ0024  70       USR Order Numbe
     C                     PARM WARMNB    WQ0025  70       Load ID USR
     C                     PARM '1'       WQ0026  1        USR Billing Act
     C                     PARM P6GNDT    WQ0027  70       USR Actual Ship
     C           YL0003    PARM YL0003    WQ0028  1        Update Exceptio
     C           W0RSL     PARM W0RSL     WQ0029  1        *Record selecte
     C           YL0004    PARM *BLANK    WQ0030  1        Print Pre-Inv/E
     C           YL0005    PARM *BLANK    WQ0031  1        Departure Sts U
     C           YL0006    PARM YL0006    WQ0032 155       System Value Nu
     C           YL0007    PARM YL0007    WQ0033  1        Manual Prc Err
     C           YL0008    PARM YL0008    WQ0034 114       Projected Marke
     C           YL0009    PARM YL0009    WQ0035  1        Average Ship Wg
     C           YL0010    PARM YL0010    WQ0036  1        InterCo Price E
     C           YL0011    PARM YL0011    WQ0037  1        Record Found US
     C           WN0024    PARM WN0024    WQ0038  1        Order Status
     C           YL0012    PARM YL0012    WQ0039  1        GTIN Error Sts
     C           YL0013    PARM YL0013    WQ0040  70       GTIN Error Item
     C                     PARM *ZERO     WQ0041  70       Item Code USR
     C                     PARM *ZERO     WQ0042  70       Item Code
     C           YL0014    PARM YL0014    WQ0043  3        Default Commod
     C           YL0015    PARM YL0015    WQ0044 114       Market Overage
     C           YL0016    PARM YL0016    WQ0045  7        Commodity Price
     C           YL0017    PARM *ZERO     WQ0046 114       Price Overage O
     C                     PARM P4YDSX    WQ0047  2        Process Cust Ty
     C           WUJDST    PARM WUJDST    WQ0048  1        USR Check Y/N S
     C           YL0018    PARM YL0018    WQ0049  1        D-EDI INV PROC
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPX8XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * ** Set Order type print status
      * CASE: LCL.Print Pre-Inv/Exception is Print on Pre-Invoice Reg
     C           YL0004    IFEQ 'P'                        *IF
      * Ready for invoice
     C                     MOVEL'Y'       YL0001           Order Type Prin
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Update header if record has exceptions
      * CASE: LCL.Print Pre-Inv/Exception is Print on Exception
     C           YL0004    IFEQ 'E'                        *IF
     C                     MOVEL'N'       YL0001           Order Type Prin
     C                     END                             *FI
     C                     END                             *FI
      * ** Final Val for order being priced before allowing Invoic
      * CASE: PAR.Order Type Print Status is yes
     C           YL0001    IFEQ 'Y'                        *IF
      * Order is priced
      * CASE: DB1.Price Status is Priced
     C           WBU1ST    IFEQ 'P'                        *IF
     C                     MOVEL'Y'       YL0001           Order Type Prin
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0001           Order Type Prin
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSC02           Order Number
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
     C                     KFLD           WCDPNB           Order Sequence
     C                     KFLD           WCUENB           Order Secondary
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
      * Setup key
     C                     Z-ADDWACWC3    WQSC01           Company Number
     C                     Z-ADDWAC4NB    WQSC02           Order Number
     C                     Z-ADDWADPNB    WCDPNB           Order Sequence
     C                     Z-ADDWAUENB    WCUENB           Order Secondary
      * Establish starting position
     C           KPSSC     SETLL@BGWKAE                    *
     C           KRSSC     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0019           Warehouse Code
     C                     MOVEL*BLANK    YL0020           Trans Contol AS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Warehouse Control  RT - Warehouse  * 
     C                     EXSR SDRVGN
      * PAR = DB1 By name
     C                     MOVELWCAJCD    YL0019           Warehouse Code
     C                     GOTO SCEXIT                     *QUIT
     C           KRSSC     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Warehouse Control  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAJCD           Warehouse Code
      * Setup key
     C                     MOVELWCAJCD    WDAJCD           Warehouse Code
      * Establish starting position
     C           KRSSD     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0020           Trans Contol AS
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDXUST    YL0020           Trans Contol AS
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Warehouse Location RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WDAJCD           Warehouse Code
      * Setup key
     C                     MOVELYL0019    WDAJCD           Warehouse Code
      * Establish starting position
     C           KRSSE     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0021           Warehouse Locat
     C                     GOTO SEEXIT                     *QUIT
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDT0ST    YL0021           Warehouse Locat
     C                     GOTO SEEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEV8CD           Company Value C
      * Setup key
     C                     Z-ADDWAAIC3    WEAIC3           Company Number
     C                     MOVE *BLANK    WEV8CD           Company Value C
     C                     MOVEL'HPBPLT'  WEV8CD           Company Value C
      * Establish starting position
     C           KRSSF     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEM8NB    YL0022           System Value Nu
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV for Ship process  RT - COA Batch Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFL6T1           COA ULSD Compan
     C                     KFLD           WFI3NY           COA Batch Numbe
      * Setup key
     C                     Z-ADDWAAIC3    WFAIC3           Company Number
     C                     MOVELWAL6T1    WFL6T1           COA ULSD Compan
     C                     Z-ADDWAI3NY    WFI3NY           COA Batch Numbe
      * Establish starting position
     C           KRSSG     CHAIN@CCCPOH              90    *
      * Data record not found
     C   90                MOVEL'USR3803' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFIDAA    YL0023           COA Bio-diesel
     C                     Z-ADDWFRHDT    YL0024           COA Batch Produ
     C                     Z-ADDWFJ1NY    WN0020           COA Last RIN EE
     C                     MOVELWFMSAA    YL0025           RFS Fuel Code
     C                     MOVELWFL8T1    WN0006           COA RIN Equival
     C                     MOVELWFJZST    YL0026           COA BH RFS Vers
     C                     MOVELWFJUST    WN0022           COA BH Equiv Va
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV HPB to Gen RIN    RT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C                     KFLD           WGRZNB           Case Sequence N
      * Setup key
     C                     Z-ADDWL0001    WGAIC3           Company Number
     C                     Z-ADDWL0002    WGC4NB           Order Number
     C                     Z-ADDWL0003    WGDPNB           Order Sequence
     C                     Z-ADDWL0004    WGUENB           Order Secondary
     C                     Z-ADDWL0005    WGRZNB           Case Sequence N
      * Establish starting position
     C           KRSSH     SETGT@FNCPCT                91  *
     C                     READP@FNCPCT                9190*
      * Check high order keys
     C  N90      WL0001    IFNE WGAIC3                     Company Number
     C           WL0002    ORNE WGC4NB                     Order Number
     C           WL0003    ORNE WGDPNB                     Order Sequence
     C           WL0004    ORNE WGUENB                     Order Secondary
     C                     SETON                     90
     C                     END
      *
      * Data record not found
     C   90                MOVEL'USR1196' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGHGCD    WL0006           Item Code
     C                     Z-ADDWGN6WG    WL0007           HPB Meter Net G
     C                     Z-ADDWGIVNY    WL0008           HPB Meter Start
     C                     Z-ADDWGIUNY    WL0009           HPB Meter Endin
     C                     Z-ADDWGIWNY    WL0010           HPB Meter Total
     C                     Z-ADDWGIXNY    WL0011           HPB Meter Net W
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV all used flds/item RT - COA Property Define Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0013           COA Bio-diesel
     C                     MOVEL*BLANK    WL0014           COA Bio-dsl Fue
     C                     MOVEL*BLANK    WL0015           COA Producer Re
     C                     MOVEL*BLANK    WL0016           COA Employer ID
     C                     MOVEL*BLANK    WL0017           COA Sold From A
     C                     MOVEL*BLANK    WL0018           COA Sold From N
     C                     MOVEL*BLANK    WL0019           COA ULSD Compan
     C                     MOVEL*BLANK    WL0020           COA ULSD Facili
     C                     MOVEL*BLANK    WL0021           COA RIN Equival
     C                     MOVEL*BLANK    WL0022           COA RIN Renewab
     C                     MOVEL*BLANK    WL0023           COA RIN Type Fl
     C                     Z-ADD*ZERO     WL0024           COA Density Loa
     C                     Z-ADD*ZERO     WL0025           COA Density Ref
     C                     Z-ADD*ZERO     WL0026           COA Temperature
     C                     Z-ADD*ZERO     WL0027           COA Temperature
     C                     Z-ADD*ZERO     WL0028           COA BOL Percent
     C                     MOVEL*BLANK    WL0029           COA Sale Locati
     C                     MOVEL*BLANK    WL0030           COA Active Whse
     C                     MOVEL*BLANK    WL0031           COA Active Whse
     C                     MOVEL*BLANK    WL0032           COA Active Whse
     C                     MOVEL*BLANK    WL0033           COA Active Whse
     C                     MOVEL*BLANK    WL0034           COA Active Whse
     C                     MOVEL*BLANK    WL0035           COA Active Whse
     C                     Z-ADD*ZERO     WL0036           COA Temp Conv F
     C                     MOVEL*BLANK    WL0037           Operation Facto
     C                     Z-ADD*ZERO     WL0038           COA Temp Conv F
     C                     MOVEL*BLANK    WL0039           Operation Facto
     C                     MOVEL*BLANK    WL0040           COA RFS Renew F
     C                     MOVEL*BLANK    WL0041           COA RFS Rnwbl F
     C                     Z-ADD*ZERO     WL0043           Sold To Custome
     C                     MOVEL*BLANK    WL0044           Record Status
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSI01           Company Number
     C           *LIKE     DEFN WHIBAA    WQSI02           COA OMS Item Co
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           COA OMS Item Co
      * Setup key
     C                     Z-ADDWL0012    WQSI01           Company Number
     C                     MOVELWL0042    WQSI02           COA OMS Item Co
      * Establish starting position
     C           KRSSI     SETLL@CARED2                    *
     C           KRSSI     READE@CARED2                  90*
      * Data record not found
     C   90                MOVEL'USR3799' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHIDAA    WL0013           COA Bio-diesel
     C                     MOVELWHR2NA    WL0014           COA Bio-dsl Fue
     C                     MOVELWHL2T1    WL0015           COA Producer Re
     C                     MOVELWHL3T1    WL0016           COA Employer ID
     C                     MOVELWHL4T1    WL0017           COA Sold From A
     C                     MOVELWHL5T1    WL0018           COA Sold From N
     C                     MOVELWHL6T1    WL0019           COA ULSD Compan
     C                     MOVELWHL7T1    WL0020           COA ULSD Facili
     C                     MOVELWHL8T1    WL0021           COA RIN Equival
     C                     MOVELWHL9T1    WL0022           COA RIN Renewab
     C                     MOVELWHMAT1    WL0023           COA RIN Type Fl
     C                     Z-ADDWHJCNY    WL0024           COA Density Loa
     C                     Z-ADDWHJDNY    WL0025           COA Density Ref
     C                     Z-ADDWHJENY    WL0026           COA Temperature
     C                     Z-ADDWHJFNY    WL0027           COA Temperature
     C                     Z-ADDWHGMPC    WL0028           COA BOL Percent
     C                     MOVELWHMBT1    WL0029           COA Sale Locati
     C                     MOVELWHIEAA    WL0030           COA Active Whse
     C                     MOVELWHIFAA    WL0031           COA Active Whse
     C                     MOVELWHIGAA    WL0032           COA Active Whse
     C                     MOVELWHIHAA    WL0033           COA Active Whse
     C                     MOVELWHIIAA    WL0034           COA Active Whse
     C                     MOVELWHIJAA    WL0035           COA Active Whse
     C                     Z-ADDWHJQNY    WL0036           COA Temp Conv F
     C                     MOVELWHLXST    WL0037           Operation Facto
     C                     Z-ADDWHJRNY    WL0038           COA Temp Conv F
     C                     MOVELWHLYST    WL0039           Operation Facto
     C                     MOVELWHIMTX    WL0040           COA RFS Renew F
     C                     MOVELWHFEDS    WL0041           COA RFS Rnwbl F
     C                     Z-ADDWHI1NY    WL0043           Sold To Custome
     C                     MOVELWHVSST    WL0044           Record Status
     C           KRSSI     READE@CARED2                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Prod Temp-HPB     RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WIRMNB           Load ID
      * Setup key
     C                     Z-ADDWARMNB    WIRMNB           Load ID
      * Establish starting position
     C           KRSSJ     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWIPRTM    YL0037           Product Tempera
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv API Vol Cor Fctor RT - RFS API Volume Corr Table  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WJSSNY           RFS API Gravity
     C                     KFLD           WJSTNY           RFS Loadout Tem
      * Setup key
     C                     Z-ADD30        WJSSNY           RFS API Gravity
     C                     Z-ADDYL0039    WJSTNY           RFS Loadout Tem
      * Establish starting position
     C           KRSSK     CHAIN@GJREHH              90    *
      * Data record not found
     C   90                MOVEL'USR4345' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWJSUNY    YL0040           RFS API Vol Cor
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Bilto/Customer     RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKC4NB    WQSL01           Order Number
     C           *LIKE     DEFN WKAIC3    WQSL02           Company Number
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Order Number
     C                     KFLD           WQSL02           Company Number
      * Setup key
     C                     Z-ADDWL0046    WQSL01           Order Number
     C                     Z-ADDWL0045    WQSL02           Company Number
      * Establish starting position
     C           KRSSL     SETLL@BFCPY2                    *
     C           KRSSL     READE@BFCPY2                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWKB0C7    WL0047           Bill to Custome
     C                     MOVELWKAETX    WL0048           Bill to Name
     C           KRSSL     READE@BFCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV HPB RIN Fields     RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0049    WLAIC3           Company Number
     C                     Z-ADDWL0050    WLC4NB           Order Number
      * Establish starting position
     C           KRSSM     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0051           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WL0052           OHE HPB RIN Pri
     C                     MOVEL*BLANK    WL0053           OHE Override Ty
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWLHEVL    WL0051           OHE HPB RIN Equ
     C                     Z-ADDWLHFVL    WL0052           OHE HPB RIN Pri
     C                     MOVELWLCHTX    WL0053           OHE Override Ty
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv HPB Cust Fields   RT - Company Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0054    WMAIC3           Company Number
     C                     Z-ADDWL0055    WMBKC7           Ship To Custome
      * Establish starting position
     C           KRSSN     CHAIN@NIREBO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2904' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0056           HPB Employer ID
     C                     MOVEL*BLANK    WL0057           HPB ULSD Compan
     C                     MOVEL*BLANK    WL0058           HPB ULSD Facili
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWMNCT1    WL0056           HPB Employer ID
     C                     MOVELWMM9T1    WL0057           HPB ULSD Compan
     C                     MOVELWMNAT1    WL0058           HPB ULSD Facili
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Customer Type     RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOBKC7    WQSO01           Ship To Custome
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Ship To Custome
      * Setup key
     C                     Z-ADDWL0059    WQSO01           Ship To Custome
      * Establish starting position
     C           KRSSO     SETLL@EOREU0                    *
     C           KRSSO     READE@EOREU0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0060           Type Code
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWOBOCD    WL0060           Type Code
     C                     GOTO SOEXIT                     *QUIT
     C           KRSSO     READE@EOREU0                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Unit Price        RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSP01           Company Number
     C           *LIKE     DEFN WCC4NB    WQSP02           Order Number
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Company Number
     C                     KFLD           WQSP02           Order Number
      * Setup key
     C                     Z-ADDWL0061    WQSP01           Company Number
     C                     Z-ADDWL0062    WQSP02           Order Number
      * Establish starting position
     C           KRSSP     SETLL@BGWKAE                    *
     C           KRSSP     READE@BGWKAE                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCAKPR    WL0063           Unit Price
     C           KRSSP     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCHRC    BEGSR
      *================================================================
      * Chg COA Batch Hdr RIN CH - COA Batch Header RIN  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0025  70       Create Date
     C                     Z-ADD*ZERO     WN0026  60       Create Time
     C                     MOVEL*BLANK    WN0027 10        Create User
     C                     MOVEL*BLANK    WN0028 10        Create Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @DACPP5
     C                     Z-ADDWL0064    WRAIC3           Company Number
     C                     MOVELWL0065    WRL6T1    P      COA ULSD Compan
     C                     Z-ADDWL0066    WRI3NY           COA Batch Numbe
     C                     Z-ADDWL0067    WRJYNY           COA Batch Heade
     C                     Z-ADDWL0068    WRQ1NY           COA Batch Hdr R
      *
     C           KLCHSQ    KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRL6T1           COA ULSD Compan
     C                     KFLD           WRI3NY           COA Batch Numbe
     C                     KFLD           WRJYNY           COA Batch Heade
     C                     KFLD           WRQ1NY           COA Batch Hdr R
     C           KLCHSQ    CHAIN@DACPP5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMDACPL0'MDACP
     C                     MOVEL'@DACPP5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPMDA1    YARDCS
      * Move non-key fields to @DACPP5
     C                     MOVELWL0069    WRMUT1    P      COA Batch Heade
     C                     Z-ADDWL0070    WRJZNY           COA RIN SSSSSSS
     C                     Z-ADDWL0071    WRJ0NY           COA RIN EEEEEEE
     C                     Z-ADDWL0072    WRJ2NY           COA RIN Volume
     C                     Z-ADDWL0073    WRRIDT           COA RIN Transac
     C                     Z-ADDWL0074    WRC5TM           COA RIN Transac
     C                     MOVELWL0075    WRMVT1    P      COA RIN Trans P
     C                     MOVELWL0076    WRMWT1    P      COA RIN Trans P
     C                     MOVELWL0077    WRRINT    P      COA Retired RIN
     C                     Z-ADDWL0078    WRRJDT           COA Retired RIN
     C                     Z-ADDWL0079    WRC6TM           COA Retired RIN
     C                     Z-ADDWL0080    WRC4NB           Order Number
     C                     Z-ADDWL0081    WRDPNB           Order Sequence
     C                     Z-ADDWL0082    WRUENB           Order Secondary
     C                     Z-ADDWL0083    WRRZNB           Case Sequence N
     C                     MOVELWL0084    WRNGT1    P      COA Rail Car
     C                     Z-ADDWL0085    WRRMNB           Load ID
     C                     Z-ADDWL0086    WRRKDT           COA Date of 1st
     C                     Z-ADDWL0087    WRC7TM           COA RIN Unused
     C                     MOVELWL0088    WRRINS    P      COA RIN Modifie
     C                     MOVELWL0089    WRMXT1    P      COA RIN Unused
     C                     MOVELWL0090    WRG3ST    P      COA RIN SoldFul
     C                     Z-ADDWL0091    WRQWNY           COA RIN Gallons
     C                     MOVELWL0092    WRL0AA    P      COA Ship To War
     C                     MOVELWL0093    WRMAT1    P      COA RIN Type Fl
     C                     MOVELWL0094    WRTDNA    P      COA RIN Custome
     C                     Z-ADDWL0095    WRCWC3           COA Shipping Co
     C                     Z-ADDWL0096    WRQXNY           COA Ref Load Id
     C                     Z-ADDWL0097    WRQZNY           COA Reference B
     C                     Z-ADDWL0098    WRQ0NY           COA Reference B
     C                     MOVELWL0099    WRLVTX    P      RFS Compliance
     C                     MOVELWL0100    WRNYT1    P      RFS Report Year
     C                     MOVELWL0101    WRG5ST    P      COA RIN Int/Ext
     C                     MOVELWL0102    WRG7ST    P      COA BHR Unused
     C                     Z-ADDWL0103    WRTFDT           COA BHR Net Gal
     C                     Z-ADDWL0104    WRTGDT           COA BHR Unused
     C                     MOVELWL0105    WRWIT1    P      COA BHR Unused
     C                     Z-ADDWL0106    WRQYNY           COA BHR Loadout
     C                     MOVELWL0107    WRL7T1    P      COA ULSD Facili
     C                     Z-ADDWL0108    WRR8NY           COA Batch RIN V
     C                     Z-ADDWL0109    WRR0NY           COA RIN Quantit
     C                     MOVELWL0110    WRI7AA    P      RFS Transaction
     C                     MOVELWL0111    WRMXAA    P      RFS Trans Reaso
     C                     MOVELWL0112    WRMSAA    P      RFS Fuel Code
     C                     Z-ADDWL0113    WRR7NY           COA BHR RIN Gen
     C                     Z-ADDWL0114    WRHEPR           COA BHR RIN Pri
     C                     Z-ADDWL0115    WRHFPR           COA BHR Gallon
     C                     MOVELWL0116    WRWVT1    P      COA Transaction
     C                     MOVELWL0117    WRW0T1    P      COA RIN Support
     C                     Z-ADDWL0118    WRR5NY           COA RIN Support
     C                     MOVELWL0119    WRW1T1    P      COA RIN Support
     C                     Z-ADDWL0120    WRR6NY           COA RIN Support
     C                     MOVELWL0121    WRJ1ST    P      COA BHR RFS Ver
     C                     MOVELWL0122    WRKHST    P      COA GEN EMTS St
     C                     Z-ADDWL0123    WRTWDT           COA GEN EMTS Da
     C                     Z-ADDWL0124    WRDUTM           COA GEN EMTS Ti
     C                     MOVELWL0125    WRKGST    P      COA RIN EMTS St
     C                     Z-ADDWL0126    WRTVDT           COA RIN EMTS Da
     C                     Z-ADDWL0127    WRDTTM           COA RIN EMTS Ti
     C                     Z-ADDWL0128    WRR9NY           COA EMTS PTD Nb
     C                     Z-ADDWL0129    WRSQNY           COA EMTS Batch
     C                     MOVELWL0130    WRBHR3    P      COA BHR Unused
     C                     Z-ADDWL0131    WRSRNY           COA BHR Unused
     C                     MOVELWL0132    WRW7T1    P      COA EMTS Trans
     C                     MOVELWL0133    WRW8T1    P      COA EMTS Return
     C                     Z-ADDWL0134    WRT2DT           COA BHR Unused
     C                     Z-ADDWL0135    WRSXNY           COA BHR Equiv V
     C                     Z-ADDWL0136    WRSYNY           COA BHR RINs to
     C                     Z-ADDWL0137    WRSZNY           COA Unassgnd Tx
     C                     MOVELWL0138    WRVSST    P      Record Status
     C                     Z-ADDWL0139    WRMKDT           Change Date
     C                     Z-ADDWL0140    WRBFTM           Change Time
     C                     MOVELWL0141    WRCEVN    P      Change User
     C                     MOVELWL0142    WRCFVN    P      Change Program
      *
      * Set PGM.*Record Data Changed flag
     C           QPMDA1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Chg Date/Time      IF
     C                     Z-ADD##JDT     WRMKDT           Change Date
     C                     Z-ADD##JTM     WRBFTM           Change Time
     C                     MOVEL##USR     WRCEVN           Change User
     C                     MOVEL##PGM     WRCFVN           Change Program
      * Set PGM.*Record Data Changed flag
     C           QPMDA1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@DACPP5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMDACPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV for Upd Gals Used RT - COA Batch Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFL6T1           COA ULSD Compan
     C                     KFLD           WFI3NY           COA Batch Numbe
      * Setup key
     C                     Z-ADDWAAIC3    WFAIC3           Company Number
     C                     MOVELWAL6T1    WFL6T1           COA ULSD Compan
     C                     Z-ADDWAI3NY    WFI3NY           COA Batch Numbe
      * Establish starting position
     C           KRSSR     CHAIN@CCCPOH              90    *
      * Data record not found
     C   90                MOVEL'USR3803' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WFJHNY    ADD  YL0044    YL0071           COA Gallons Use
      * Update Header's rin with the Lowest SSSSS rin number, and the las
      * CASE: PAR.COA Last RIN EEEEEEEE is eq 00000000
     C           WN0020    IFEQ 0                          *IF
      * E00382  Dont update Batch RIN or change EEEEEEE if input par is 0
      *   because customer is a Non Rin customer type
      * CHG Change Record      CH - COA Batch Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0143           Company Number
     C                     MOVELWFL6T1    WL0144    P      COA ULSD Compan
     C                     Z-ADDWFI3NY    WL0145           COA Batch Numbe
     C                     MOVELWFIKAA    WL0146    P      COA Active Whse
     C                     MOVELWFIDAA    WL0147    P      COA Bio-diesel
     C                     Z-ADDWFRFDT    WL0148           COA Date Open f
     C                     Z-ADDWFC2TM    WL0149           COA Time Open f
     C                     MOVELWFMHT1    WL0150    P      COA Open for Sh
     C                     Z-ADDWFRGDT    WL0151           COA Date Close
     C                     Z-ADDWFC3TM    WL0152           COA Time Close
     C                     MOVELWFMKT1    WL0153    P      COA Close from
     C                     Z-ADDYL0071    WL0154           COA Gallons Use
     C                     MOVELWFR1NA    WL0155    P      COA Comment
     C                     Z-ADDWFRHDT    WL0156           COA Batch Produ
     C                     Z-ADDWFC4TM    WL0157           COA Batch Unuse
     C                     MOVELWFMIT1    WL0158    P      COA Batch Unuse
     C                     MOVELWFMJT1    WL0159    P      COA Batch Unuse
     C                     MOVELWFHXTX    WL0160    P      COA Batch Heade
     C                     MOVELWFHJTX    WL0161    P      COA Batch Prope
     C                     MOVELWFHYTX    WL0162    P      COA Batch Int/E
     C                     Z-ADDWFJENY    WL0163           COA Temperature
     C                     Z-ADDWFJVNY    WL0164           COA Batch Volum
     C                     Z-ADDWFJWNY    WL0165           COA Batch Denat
     C                     MOVELWFIMTX    WL0166    P      COA RFS Renew F
     C                     MOVELWFFEDS    WL0167    P      COA RFS Rnwbl F
     C                     MOVELWFMTT1    WL0168    P      COA Batch RIN
     C                     Z-ADDWFJXNY    WL0169           COA Batch Expor
     C                     Z-ADDWFJ1NY    WL0170           COA Last RIN EE
     C                     Z-ADDWFJCNY    WL0171           COA Density Loa
     C                     Z-ADDWFJDNY    WL0172           COA Density Ref
     C                     Z-ADDWFJ3NY    WL0173           COA RIN Equival
     C                     Z-ADDWFRLDT    WL0174           COA Batch Unuse
     C                     MOVELWFMSAA    WL0175    P      RFS Fuel Code
     C                     MOVELWFMTAA    WL0176    P      RFS Process Cod
     C                     MOVELWFMUAA    WL0177    P      RFS Fuel Catego
     C                     MOVELWFL8T1    WL0178    P      COA RIN Equival
     C                     Z-ADDWFR0NY    WL0179           COA RIN Quantit
     C                     MOVELWFL7T1    WL0180    P      COA ULSD Facili
     C                     MOVELWFJQST    WL0181    P      COA Co-Product
     C                     MOVELWFWUT1    WL0182    P      COA Co-Product
     C                     MOVELWFWVT1    WL0183    P      COA Transaction
     C                     MOVELWFJZST    WL0184    P      COA BH RFS Vers
     C                     MOVELWFJ0ST    WL0185    P      COA BH EMTS Sts
     C                     Z-ADDWFTTDT    WL0186           COA BH EMTS Dat
     C                     Z-ADDWFDRTM    WL0187           COA BH EMTS Tim
     C                     MOVELWFWYT1    WL0188    P      COA BH Unused I
     C                     MOVELWFJUST    WL0189    P      COA BH Equiv Va
     C                     Z-ADDWFR4NY    WL0190           COA BH Yield Pe
     C                     MOVELWFMZAA    WL0191    P      COA BH Unused C
     C                     Z-ADDWFTUDT    WL0192           COA BH Unused D
     C                     Z-ADDWFDSTM    WL0193           COA BH Unused T
     C                     MOVELWFWZT1    WL0194    P      COA BH Unused C
     C                     MOVELWFM0AA    WL0195    P      RFS Feedstock C
     C                     Z-ADDWFSANY    WL0196           COA BH Feedstck
     C                     MOVELWFKJST    WL0197    P      COA BH Feedstck
     C                     MOVELWFKKST    WL0198    P      COA BH Feedstck
     C                     Z-ADDWFGZPC    WL0199           COA BH Feedstck
     C                     MOVELWFW2T1    WL0200    P      COA BH Feedstck
     C                     MOVELWFM1AA    WL0201    P      RFS Feedstock C
     C                     Z-ADDWFSBNY    WL0202           COA BH Feedstck
     C                     MOVELWFKLST    WL0203    P      COA BH Feedstck
     C                     MOVELWFKPST    WL0204    P      COA BH Feedstck
     C                     Z-ADDWFG0PC    WL0205           COA BH Feedstck
     C                     MOVELWFW3T1    WL0206    P      COA BH Feedstck
     C                     MOVELWFM2AA    WL0207    P      RFS Feedstock C
     C                     Z-ADDWFSCNY    WL0208           COA BH Feedstck
     C                     MOVELWFKQST    WL0209    P      COA BH Feedstck
     C                     MOVELWFKRST    WL0210    P      COA BH Feedstck
     C                     Z-ADDWFG1PC    WL0211           cOA BH Feedstck
     C                     MOVELWFW4T1    WL0212    P      COA BH Feedstck
     C                     MOVELWFVSST    WL0213    P      Record Status
     C                     Z-ADDWFMJDT    WL0214           Create Date
     C                     Z-ADDWFBETM    WL0215           Create Time
     C                     MOVELWFCCVN    WL0216    P      Create User
     C                     MOVELWFCDVN    WL0217    P      Create Program
     C                     Z-ADDWFMKDT    WL0218           Change Date
     C                     Z-ADDWFBFTM    WL0219           Change Time
     C                     MOVELWFCEVN    WL0220    P      Change User
     C                     MOVELWFCFVN    WL0221    P      Change Program
     C                     EXSR SSCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv 1st Seq for Batch RT - COA Batch Header RIN  * 
     C                     EXSR STRVGN
      * *Move-Right - /UT User Source  * 
     C                     MOVE WN0020    YL0072
      * CHG Change Record      CH - COA Batch Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0143           Company Number
     C                     MOVELWFL6T1    WL0144    P      COA ULSD Compan
     C                     Z-ADDWFI3NY    WL0145           COA Batch Numbe
     C                     MOVELWFIKAA    WL0146    P      COA Active Whse
     C                     MOVELWFIDAA    WL0147    P      COA Bio-diesel
     C                     Z-ADDWFRFDT    WL0148           COA Date Open f
     C                     Z-ADDWFC2TM    WL0149           COA Time Open f
     C                     MOVELWFMHT1    WL0150    P      COA Open for Sh
     C                     Z-ADDWFRGDT    WL0151           COA Date Close
     C                     Z-ADDWFC3TM    WL0152           COA Time Close
     C                     MOVELWFMKT1    WL0153    P      COA Close from
     C                     Z-ADDYL0071    WL0154           COA Gallons Use
     C                     MOVELWFR1NA    WL0155    P      COA Comment
     C                     Z-ADDWFRHDT    WL0156           COA Batch Produ
     C                     Z-ADDWFC4TM    WL0157           COA Batch Unuse
     C                     MOVELWFMIT1    WL0158    P      COA Batch Unuse
     C                     MOVELWFMJT1    WL0159    P      COA Batch Unuse
     C                     MOVELWFHXTX    WL0160    P      COA Batch Heade
     C                     MOVELWFHJTX    WL0161    P      COA Batch Prope
     C                     MOVELWFHYTX    WL0162    P      COA Batch Int/E
     C                     Z-ADDWFJENY    WL0163           COA Temperature
     C                     Z-ADDWFJVNY    WL0164           COA Batch Volum
     C                     Z-ADDWFJWNY    WL0165           COA Batch Denat
     C                     MOVELWFIMTX    WL0166    P      COA RFS Renew F
     C                     MOVELWFFEDS    WL0167    P      COA RFS Rnwbl F
     C                     MOVELYL0072    WL0168    P      COA Batch RIN
     C                     Z-ADDWFJXNY    WL0169           COA Batch Expor
     C                     Z-ADDWN0020    WL0170           COA Last RIN EE
     C                     Z-ADDWFJCNY    WL0171           COA Density Loa
     C                     Z-ADDWFJDNY    WL0172           COA Density Ref
     C                     Z-ADDWFJ3NY    WL0173           COA RIN Equival
     C                     Z-ADDWFRLDT    WL0174           COA Batch Unuse
     C                     MOVELWFMSAA    WL0175    P      RFS Fuel Code
     C                     MOVELWFMTAA    WL0176    P      RFS Process Cod
     C                     MOVELWFMUAA    WL0177    P      RFS Fuel Catego
     C                     MOVELWFL8T1    WL0178    P      COA RIN Equival
     C                     Z-ADDWFR0NY    WL0179           COA RIN Quantit
     C                     MOVELWFL7T1    WL0180    P      COA ULSD Facili
     C                     MOVELWFJQST    WL0181    P      COA Co-Product
     C                     MOVELWFWUT1    WL0182    P      COA Co-Product
     C                     MOVELWFWVT1    WL0183    P      COA Transaction
     C                     MOVELWFJZST    WL0184    P      COA BH RFS Vers
     C                     MOVELWFJ0ST    WL0185    P      COA BH EMTS Sts
     C                     Z-ADDWFTTDT    WL0186           COA BH EMTS Dat
     C                     Z-ADDWFDRTM    WL0187           COA BH EMTS Tim
     C                     MOVELWFWYT1    WL0188    P      COA BH Unused I
     C                     MOVELWFJUST    WL0189    P      COA BH Equiv Va
     C                     Z-ADDWFR4NY    WL0190           COA BH Yield Pe
     C                     MOVELWFMZAA    WL0191    P      COA BH Unused C
     C                     Z-ADDWFTUDT    WL0192           COA BH Unused D
     C                     Z-ADDWFDSTM    WL0193           COA BH Unused T
     C                     MOVELWFWZT1    WL0194    P      COA BH Unused C
     C                     MOVELWFM0AA    WL0195    P      RFS Feedstock C
     C                     Z-ADDWFSANY    WL0196           COA BH Feedstck
     C                     MOVELWFKJST    WL0197    P      COA BH Feedstck
     C                     MOVELWFKKST    WL0198    P      COA BH Feedstck
     C                     Z-ADDWFGZPC    WL0199           COA BH Feedstck
     C                     MOVELWFW2T1    WL0200    P      COA BH Feedstck
     C                     MOVELWFM1AA    WL0201    P      RFS Feedstock C
     C                     Z-ADDWFSBNY    WL0202           COA BH Feedstck
     C                     MOVELWFKLST    WL0203    P      COA BH Feedstck
     C                     MOVELWFKPST    WL0204    P      COA BH Feedstck
     C                     Z-ADDWFG0PC    WL0205           COA BH Feedstck
     C                     MOVELWFW3T1    WL0206    P      COA BH Feedstck
     C                     MOVELWFM2AA    WL0207    P      RFS Feedstock C
     C                     Z-ADDWFSCNY    WL0208           COA BH Feedstck
     C                     MOVELWFKQST    WL0209    P      COA BH Feedstck
     C                     MOVELWFKRST    WL0210    P      COA BH Feedstck
     C                     Z-ADDWFG1PC    WL0211           cOA BH Feedstck
     C                     MOVELWFW4T1    WL0212    P      COA BH Feedstck
     C                     MOVELWFVSST    WL0213    P      Record Status
     C                     Z-ADDWFMJDT    WL0214           Create Date
     C                     Z-ADDWFBETM    WL0215           Create Time
     C                     MOVELWFCCVN    WL0216    P      Create User
     C                     MOVELWFCDVN    WL0217    P      Create Program
     C                     Z-ADDWFMKDT    WL0218           Change Date
     C                     Z-ADDWFBFTM    WL0219           Change Time
     C                     MOVELWFCEVN    WL0220    P      Change User
     C                     MOVELWFCFVN    WL0221    P      Change Program
     C                     EXSR SSCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCHRC    BEGSR
      *================================================================
      * CHG Change Record      CH - COA Batch Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @CCCPOG
     C                     Z-ADDWL0143    WSAIC3           Company Number
     C                     MOVELWL0144    WSL6T1    P      COA ULSD Compan
     C                     Z-ADDWL0145    WSI3NY           COA Batch Numbe
      *
     C           KLCHSS    KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSL6T1           COA ULSD Compan
     C                     KFLD           WSI3NY           COA Batch Numbe
     C           KLCHSS    CHAIN@CCCPOG              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMCCCPL0'MDACP
     C                     MOVEL'@CCCPOG' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPMCC1    YBRDCS
      * Move non-key fields to @CCCPOG
     C                     MOVELWL0146    WSIKAA    P      COA Active Whse
     C                     MOVELWL0147    WSIDAA    P      COA Bio-diesel
     C                     Z-ADDWL0148    WSRFDT           COA Date Open f
     C                     Z-ADDWL0149    WSC2TM           COA Time Open f
     C                     MOVELWL0150    WSMHT1    P      COA Open for Sh
     C                     Z-ADDWL0151    WSRGDT           COA Date Close
     C                     Z-ADDWL0152    WSC3TM           COA Time Close
     C                     MOVELWL0153    WSMKT1    P      COA Close from
     C                     Z-ADDWL0154    WSJHNY           COA Gallons Use
     C                     MOVELWL0155    WSR1NA    P      COA Comment
     C                     Z-ADDWL0156    WSRHDT           COA Batch Produ
     C                     Z-ADDWL0157    WSC4TM           COA Batch Unuse
     C                     MOVELWL0158    WSMIT1    P      COA Batch Unuse
     C                     MOVELWL0159    WSMJT1    P      COA Batch Unuse
     C                     MOVELWL0160    WSHXTX    P      COA Batch Heade
     C                     MOVELWL0161    WSHJTX    P      COA Batch Prope
     C                     MOVELWL0162    WSHYTX    P      COA Batch Int/E
     C                     Z-ADDWL0163    WSJENY           COA Temperature
     C                     Z-ADDWL0164    WSJVNY           COA Batch Volum
     C                     Z-ADDWL0165    WSJWNY           COA Batch Denat
     C                     MOVELWL0166    WSIMTX    P      COA RFS Renew F
     C                     MOVELWL0167    WSFEDS    P      COA RFS Rnwbl F
     C                     MOVELWL0168    WSMTT1    P      COA Batch RIN
     C                     Z-ADDWL0169    WSJXNY           COA Batch Expor
     C                     Z-ADDWL0170    WSJ1NY           COA Last RIN EE
     C                     Z-ADDWL0171    WSJCNY           COA Density Loa
     C                     Z-ADDWL0172    WSJDNY           COA Density Ref
     C                     Z-ADDWL0173    WSJ3NY           COA RIN Equival
     C                     Z-ADDWL0174    WSRLDT           COA Batch Unuse
     C                     MOVELWL0175    WSMSAA    P      RFS Fuel Code
     C                     MOVELWL0176    WSMTAA    P      RFS Process Cod
     C                     MOVELWL0177    WSMUAA    P      RFS Fuel Catego
     C                     MOVELWL0178    WSL8T1    P      COA RIN Equival
     C                     Z-ADDWL0179    WSR0NY           COA RIN Quantit
     C                     MOVELWL0180    WSL7T1    P      COA ULSD Facili
     C                     MOVELWL0181    WSJQST    P      COA Co-Product
     C                     MOVELWL0182    WSWUT1    P      COA Co-Product
     C                     MOVELWL0183    WSWVT1    P      COA Transaction
     C                     MOVELWL0184    WSJZST    P      COA BH RFS Vers
     C                     MOVELWL0185    WSJ0ST    P      COA BH EMTS Sts
     C                     Z-ADDWL0186    WSTTDT           COA BH EMTS Dat
     C                     Z-ADDWL0187    WSDRTM           COA BH EMTS Tim
     C                     MOVELWL0188    WSWYT1    P      COA BH Unused I
     C                     MOVELWL0189    WSJUST    P      COA BH Equiv Va
     C                     Z-ADDWL0190    WSR4NY           COA BH Yield Pe
     C                     MOVELWL0191    WSMZAA    P      COA BH Unused C
     C                     Z-ADDWL0192    WSTUDT           COA BH Unused D
     C                     Z-ADDWL0193    WSDSTM           COA BH Unused T
     C                     MOVELWL0194    WSWZT1    P      COA BH Unused C
     C                     MOVELWL0195    WSM0AA    P      RFS Feedstock C
     C                     Z-ADDWL0196    WSSANY           COA BH Feedstck
     C                     MOVELWL0197    WSKJST    P      COA BH Feedstck
     C                     MOVELWL0198    WSKKST    P      COA BH Feedstck
     C                     Z-ADDWL0199    WSGZPC           COA BH Feedstck
     C                     MOVELWL0200    WSW2T1    P      COA BH Feedstck
     C                     MOVELWL0201    WSM1AA    P      RFS Feedstock C
     C                     Z-ADDWL0202    WSSBNY           COA BH Feedstck
     C                     MOVELWL0203    WSKLST    P      COA BH Feedstck
     C                     MOVELWL0204    WSKPST    P      COA BH Feedstck
     C                     Z-ADDWL0205    WSG0PC           COA BH Feedstck
     C                     MOVELWL0206    WSW3T1    P      COA BH Feedstck
     C                     MOVELWL0207    WSM2AA    P      RFS Feedstock C
     C                     Z-ADDWL0208    WSSCNY           COA BH Feedstck
     C                     MOVELWL0209    WSKQST    P      COA BH Feedstck
     C                     MOVELWL0210    WSKRST    P      COA BH Feedstck
     C                     Z-ADDWL0211    WSG1PC           cOA BH Feedstck
     C                     MOVELWL0212    WSW4T1    P      COA BH Feedstck
     C                     MOVELWL0213    WSVSST    P      Record Status
     C                     Z-ADDWL0214    WSMJDT           Create Date
     C                     Z-ADDWL0215    WSBETM           Create Time
     C                     MOVELWL0216    WSCCVN    P      Create User
     C                     MOVELWL0217    WSCDVN    P      Create Program
     C                     Z-ADDWL0218    WSMKDT           Change Date
     C                     Z-ADDWL0219    WSBFTM           Change Time
     C                     MOVELWL0220    WSCEVN    P      Change User
     C                     MOVELWL0221    WSCFVN    P      Change Program
      *
      * Set PGM.*Record Data Changed flag
     C           QPMCC1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Chg Date/Time      IF
     C                     Z-ADD##JDT     WSMKDT           Change Date
     C                     Z-ADD##JTM     WSBFTM           Change Time
     C                     MOVEL##USR     WSCEVN           Change User
     C                     MOVEL##PGM     WSCFVN           Change Program
      * Set PGM.*Record Data Changed flag
     C           QPMCC1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@CCCPOG                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMCCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv 1st Seq for Batch RT - COA Batch Header RIN  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD99999999  YL0073           COA RIN SSSSSSS
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTAIC3    WQST01           Company Number
     C           *LIKE     DEFN WTL6T1    WQST02           COA ULSD Compan
     C           *LIKE     DEFN WTI3NY    WQST03           COA Batch Numbe
      * Define keylist
     C           KPSST     KLIST
     C                     KFLD           WQST01           Company Number
     C                     KFLD           WQST02           COA ULSD Compan
     C                     KFLD           WQST03           COA Batch Numbe
     C                     KFLD           WTJYNY           COA Batch Heade
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           Company Number
     C                     KFLD           WQST02           COA ULSD Compan
     C                     KFLD           WQST03           COA Batch Numbe
      * Setup key
     C                     Z-ADDWFAIC3    WQST01           Company Number
     C                     MOVELWFL6T1    WQST02           COA ULSD Compan
     C                     Z-ADDWFI3NY    WQST03           COA Batch Numbe
     C                     Z-ADD0         WTJYNY           COA Batch Heade
      * Establish starting position
     C           KPSST     SETLL@DACPP6                    *
     C           KRSST     READE@DACPP6                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3855' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    YL0072           COA Batch Heade
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Get lowest Starting rin number for the batch
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.COA RIN SSSSSSSS LT LCL.COA RIN SSSSSSSS
      *   |- c2    : DB1.COA RIN SSSSSSSS is GT 00000000
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WTJZNY    IFLT YL0073                     *IF
     C           WTJZNY    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELWTMUT1    YL0072           COA Batch Heade
     C                     Z-ADDWTJZNY    YL0073           COA RIN SSSSSSS
     C                     END                             *FI
     C           KRSST     READE@DACPP6                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCRRC    BEGSR
      *================================================================
      * Crt COA Batch Hdr RIN CR - COA Batch Header RIN  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DACPP5
     C                     Z-ADDWL0222    WRAIC3           Company Number
     C                     MOVELWL0223    WRL6T1           COA ULSD Compan
     C                     Z-ADDWL0224    WRI3NY           COA Batch Numbe
     C                     Z-ADDWL0225    WRJYNY           COA Batch Heade
     C                     Z-ADDWL0226    WRQ1NY           COA Batch Hdr R
     C                     MOVELWL0227    WRMUT1           COA Batch Heade
     C                     Z-ADDWL0228    WRJZNY           COA RIN SSSSSSS
     C                     Z-ADDWL0229    WRJ0NY           COA RIN EEEEEEE
     C                     Z-ADDWL0230    WRJ2NY           COA RIN Volume
     C                     Z-ADDWL0231    WRRIDT           COA RIN Transac
     C                     Z-ADDWL0232    WRC5TM           COA RIN Transac
     C                     MOVELWL0233    WRMVT1           COA RIN Trans P
     C                     MOVELWL0234    WRMWT1           COA RIN Trans P
     C                     MOVELWL0235    WRRINT           COA Retired RIN
     C                     Z-ADDWL0236    WRRJDT           COA Retired RIN
     C                     Z-ADDWL0237    WRC6TM           COA Retired RIN
     C                     Z-ADDWL0238    WRC4NB           Order Number
     C                     Z-ADDWL0239    WRDPNB           Order Sequence
     C                     Z-ADDWL0240    WRUENB           Order Secondary
     C                     Z-ADDWL0241    WRRZNB           Case Sequence N
     C                     MOVELWL0242    WRNGT1           COA Rail Car
     C                     Z-ADDWL0243    WRRMNB           Load ID
     C                     Z-ADDWL0244    WRRKDT           COA Date of 1st
     C                     Z-ADDWL0245    WRC7TM           COA RIN Unused
     C                     MOVELWL0246    WRRINS           COA RIN Modifie
     C                     MOVELWL0247    WRMXT1           COA RIN Unused
     C                     MOVELWL0248    WRG3ST           COA RIN SoldFul
     C                     Z-ADDWL0249    WRQWNY           COA RIN Gallons
     C                     MOVELWL0250    WRL0AA           COA Ship To War
     C                     MOVELWL0251    WRMAT1           COA RIN Type Fl
     C                     MOVELWL0252    WRTDNA           COA RIN Custome
     C                     Z-ADDWL0253    WRCWC3           COA Shipping Co
     C                     Z-ADDWL0254    WRQXNY           COA Ref Load Id
     C                     Z-ADDWL0255    WRQZNY           COA Reference B
     C                     Z-ADDWL0256    WRQ0NY           COA Reference B
     C                     MOVELWL0257    WRLVTX           RFS Compliance
     C                     MOVELWL0258    WRNYT1           RFS Report Year
     C                     MOVELWL0259    WRG5ST           COA RIN Int/Ext
     C                     MOVELWL0260    WRG7ST           COA BHR Unused
     C                     Z-ADDWL0261    WRTFDT           COA BHR Net Gal
     C                     Z-ADDWL0262    WRTGDT           COA BHR Unused
     C                     MOVELWL0263    WRWIT1           COA BHR Unused
     C                     Z-ADDWL0264    WRQYNY           COA BHR Loadout
     C                     MOVELWL0265    WRL7T1           COA ULSD Facili
     C                     Z-ADDWL0266    WRR8NY           COA Batch RIN V
     C                     Z-ADDWL0267    WRR0NY           COA RIN Quantit
     C                     MOVELWL0268    WRI7AA           RFS Transaction
     C                     MOVELWL0269    WRMXAA           RFS Trans Reaso
     C                     MOVELWL0270    WRMSAA           RFS Fuel Code
     C                     Z-ADDWL0271    WRR7NY           COA BHR RIN Gen
     C                     Z-ADDWL0272    WRHEPR           COA BHR RIN Pri
     C                     Z-ADDWL0273    WRHFPR           COA BHR Gallon
     C                     MOVELWL0274    WRWVT1           COA Transaction
     C                     MOVELWL0275    WRW0T1           COA RIN Support
     C                     Z-ADDWL0276    WRR5NY           COA RIN Support
     C                     MOVELWL0277    WRW1T1           COA RIN Support
     C                     Z-ADDWL0278    WRR6NY           COA RIN Support
     C                     MOVELWL0279    WRJ1ST           COA BHR RFS Ver
     C                     MOVELWL0280    WRKHST           COA GEN EMTS St
     C                     Z-ADDWL0281    WRTWDT           COA GEN EMTS Da
     C                     Z-ADDWL0282    WRDUTM           COA GEN EMTS Ti
     C                     MOVELWL0283    WRKGST           COA RIN EMTS St
     C                     Z-ADDWL0284    WRTVDT           COA RIN EMTS Da
     C                     Z-ADDWL0285    WRDTTM           COA RIN EMTS Ti
     C                     Z-ADDWL0286    WRR9NY           COA EMTS PTD Nb
     C                     Z-ADDWL0287    WRSQNY           COA EMTS Batch
     C                     MOVELWL0288    WRBHR3           COA BHR Unused
     C                     Z-ADDWL0289    WRSRNY           COA BHR Unused
     C                     MOVELWL0290    WRW7T1           COA EMTS Trans
     C                     MOVELWL0291    WRW8T1           COA EMTS Return
     C                     Z-ADDWL0292    WRT2DT           COA BHR Unused
     C                     Z-ADDWL0293    WRSXNY           COA BHR Equiv V
     C                     Z-ADDWL0294    WRSYNY           COA BHR RINs to
     C                     Z-ADDWL0295    WRSZNY           COA Unassgnd Tx
     C                     MOVELWL0296    WRVSST           Record Status
     C                     Z-ADDWL0297    WRMJDT           Create Date
     C                     Z-ADDWL0298    WRBETM           Create Time
     C                     MOVELWL0299    WRCCVN           Create User
     C                     MOVELWL0300    WRCDVN           Create Program
     C                     Z-ADDWL0301    WRMKDT           Change Date
     C                     Z-ADDWL0302    WRBFTM           Change Time
     C                     MOVELWL0303    WRCEVN           Change User
     C                     MOVELWL0304    WRCFVN           Change Program
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WRVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WRMJDT           Create Date
     C                     Z-ADD##JTM     WRBETM           Create Time
     C                     MOVEL##USR     WRCCVN           Create User
     C                     MOVEL##PGM     WRCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD0         WRMKDT           Change Date
     C                     Z-ADD0         WRBFTM           Change Time
     C                     MOVEL*BLANK    WRCEVN           Change User
     C                     MOVEL*BLANK    WRCFVN           Change Program
     C           KLCRSU    KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRL6T1           COA ULSD Compan
     C                     KFLD           WRI3NY           COA Batch Numbe
     C                     KFLD           WRJYNY           COA Batch Heade
     C                     KFLD           WRQ1NY           COA Batch Hdr R
      * Check for duplicate primary key
     C           KLCRSU    SETLL@DACPP5                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3856' W0RTN   7
      * Send message 'COA Batch Header RIN   EX'
     C                     MOVEL'USR3856' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C                     WRITE@DACPP5                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Trans Rsn Dft,Dsc RT - RFS Transaction Reason  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WVI7AA    WQSV01           RFS Transaction
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           RFS Transaction
      * Setup key
     C                     MOVELWL0305    WQSV01           RFS Transaction
      * Establish starting position
     C           KRSSV     SETLL@GGREG2                    *
     C           KRSSV     READE@GGREG2                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4324' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0306           RFS Trans Reaso
     C                     MOVEL*BLANK    WL0307           RFS Trans Reaso
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RFS Trans Reason Dft EQ PAR.RFS Trans Reason Dft
     C           WVJPST    IFEQ WL0308                     *IF
      * PAR = DB1 By name
     C                     MOVELWVMXAA    WL0306           RFS Trans Reaso
     C                     MOVELWVWTT1    WL0307           RFS Trans Reaso
     C                     GOTO SVEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSV     READE@GGREG2                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Equiv Value f/SEP RT - COA Batch Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFL6T1           COA ULSD Compan
     C                     KFLD           WFI3NY           COA Batch Numbe
      * Setup key
     C                     Z-ADDWL0309    WFAIC3           Company Number
     C                     MOVELWL0310    WFL6T1           COA ULSD Compan
     C                     Z-ADDWL0311    WFI3NY           COA Batch Numbe
      * Establish starting position
     C           KRSSW     CHAIN@CCCPOH              90    *
      * Data record not found
     C   90                MOVEL'USR3803' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFJUST    WL0312           COA BH Equiv Va
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV RIN Key fields    RT - Manifest Detail RIN Sell  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WWAIC3           Company Number
     C                     KFLD           WWC4NB           Order Number
     C                     KFLD           WWDPNB           Order Sequence
     C                     KFLD           WWUENB           Order Secondary
     C                     KFLD           WWRZNB           Case Sequence N
      * Setup key
     C                     Z-ADDWACWC3    WWAIC3           Company Number
     C                     Z-ADDWAC4NB    WWC4NB           Order Number
     C                     Z-ADDWADPNB    WWDPNB           Order Sequence
     C                     Z-ADDWAUENB    WWUENB           Order Secondary
     C                     Z-ADDWARZNB    WWRZNB           Case Sequence N
      * Establish starting position
     C           KRSSX     CHAIN@FPCPDP              90    *
      * Data record not found
     C   90                MOVEL'USR4210' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWWL6T1    YL0035           COA ULSD Compan
     C                     Z-ADDWWI3NY    YL0084           COA Batch Numbe
     C                     Z-ADDWWJYNY    YL0085           COA Batch Heade
     C                     Z-ADDWWQ1NY    YL0074           COA Batch Hdr R
     C                     Z-ADDWWRCNY    YL0086           COA Batch Compa
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv Key RIN for SEL   RT - COA Batch Header RIN  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTL6T1           COA ULSD Compan
     C                     KFLD           WTI3NY           COA Batch Numbe
     C                     KFLD           WTJYNY           COA Batch Heade
     C                     KFLD           WTQ1NY           COA Batch Hdr R
      * Setup key
     C                     Z-ADDWL0313    WTAIC3           Company Number
     C                     MOVELWL0314    WTL6T1           COA ULSD Compan
     C                     Z-ADDWL0315    WTI3NY           COA Batch Numbe
     C                     Z-ADDWL0316    WTJYNY           COA Batch Heade
     C                     Z-ADDWL0317    WTQ1NY           COA Batch Hdr R
      * Establish starting position
     C           KRSSY     CHAIN@DACPP6              90    *
      * Data record not found
     C   90                MOVEL'USR3855' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWTMUT1    WL0318           COA Batch Heade
     C                     Z-ADDWTJZNY    WL0319           COA RIN SSSSSSS
     C                     Z-ADDWTJ0NY    WL0320           COA RIN EEEEEEE
     C                     Z-ADDWTJ2NY    WL0321           COA RIN Volume
     C                     Z-ADDWTQWNY    WL0322           COA RIN Gallons
     C                     MOVELWTMAT1    WL0323           COA RIN Type Fl
     C                     Z-ADDWTTFDT    WL0324           COA BHR Net Gal
     C                     Z-ADDWTQYNY    WL0325           COA BHR Loadout
     C                     Z-ADDWTSYNY    WL0326           COA BHR RINs to
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Rtv Equiv Value f/btchRT - COA Batch Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFL6T1           COA ULSD Compan
     C                     KFLD           WFI3NY           COA Batch Numbe
      * Setup key
     C                     Z-ADDWL0327    WFAIC3           Company Number
     C                     MOVELWL0328    WFL6T1           COA ULSD Compan
     C                     Z-ADDWL0329    WFI3NY           COA Batch Numbe
      * Establish starting position
     C           KRSSZ     CHAIN@CCCPOH              90    *
      * Data record not found
     C   90                MOVEL'USR3803' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFJ3NY    WL0330           COA RIN Equival
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TACHRC    BEGSR
      *================================================================
      * Chg Sold Fl/Splt/UnStsCH - COA Batch Header RIN  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0029  80       COA RIN SSSSSSS
     C                     Z-ADD*ZERO     WN0030  80       COA RIN EEEEEEE
     C                     Z-ADD*ZERO     WN0031  80       COA RIN Volume
     C                     MOVEL*BLANK    WN0032 30        COA RIN Trans P
     C                     MOVEL*BLANK    WN0033  3        COA Retired RIN
     C                     Z-ADD*ZERO     WN0034  70       COA Retired RIN
     C                     Z-ADD*ZERO     WN0035  60       COA Retired RIN
     C                     Z-ADD*ZERO     WN0036  70       Order Number
     C                     Z-ADD*ZERO     WN0037  30       Order Sequence
     C                     Z-ADD*ZERO     WN0038  30       Order Secondary
     C                     Z-ADD*ZERO     WN0039  50       Case Sequence N
     C                     MOVEL*BLANK    WN0040 15        COA Rail Car
     C                     Z-ADD*ZERO     WN0041  70       Load ID
     C                     Z-ADD*ZERO     WN0042  70       COA Date of 1st
     C                     Z-ADD*ZERO     WN0043  60       COA RIN Unused
     C                     MOVEL*BLANK    WN0044  1        COA RIN Modifie
     C                     MOVEL*BLANK    WN0045 25        COA RIN Unused
     C                     Z-ADD*ZERO     WN0046  80       COA RIN Gallons
     C                     MOVEL*BLANK    WN0047  3        COA Ship To War
     C                     MOVEL*BLANK    WN0048  1        COA RIN Type Fl
     C                     MOVEL*BLANK    WN0049 15        COA RIN Custome
     C                     Z-ADD*ZERO     WN0050  30       COA Shipping Co
     C                     Z-ADD*ZERO     WN0051  70       COA Ref Load Id
     C                     Z-ADD*ZERO     WN0052  50       COA Reference B
     C                     Z-ADD*ZERO     WN0053  50       COA Reference B
     C                     MOVEL*BLANK    WN0054  2        RFS Compliance
     C                     MOVEL*BLANK    WN0055  4        RFS Report Year
     C                     MOVEL*BLANK    WN0056  1        COA RIN Int/Ext
     C                     MOVEL*BLANK    WN0057  2        COA BHR Unused
     C                     Z-ADD*ZERO     WN0058  70       COA BHR Net Gal
     C                     Z-ADD*ZERO     WN0059  70       COA BHR Unused
     C                     MOVEL*BLANK    WN0060 25        COA BHR Unused
     C                     Z-ADD*ZERO     WN0061  70       COA BHR Loadout
     C                     MOVEL*BLANK    WN0062  5        COA ULSD Facili
     C                     Z-ADD*ZERO     WN0063  70       COA Batch RIN V
     C                     Z-ADD*ZERO     WN0064  70       COA RIN Quantit
     C                     MOVEL*BLANK    WN0065  3        RFS Transaction
     C                     MOVEL*BLANK    WN0066  3        RFS Trans Reaso
     C                     MOVEL*BLANK    WN0067  1        RFS Fuel Code
     C                     Z-ADD*ZERO     WN0068  40       COA BHR RIN Gen
     C                     Z-ADD*ZERO     WN0069  72       COA BHR RIN Pri
     C                     Z-ADD*ZERO     WN0070  72       COA BHR Gallon
     C                     MOVEL*BLANK    WN0071 50        COA Transaction
     C                     MOVEL*BLANK    WN0072 25        COA RIN Support
     C                     Z-ADD*ZERO     WN0073  70       COA RIN Support
     C                     MOVEL*BLANK    WN0074 25        COA RIN Support
     C                     Z-ADD*ZERO     WN0075  70       COA RIN Support
     C                     MOVEL*BLANK    WN0076  1        COA BHR RFS Ver
     C                     MOVEL*BLANK    WN0077  1        COA GEN EMTS St
     C                     Z-ADD*ZERO     WN0078  70       COA GEN EMTS Da
     C                     Z-ADD*ZERO     WN0079  60       COA GEN EMTS Ti
     C                     MOVEL*BLANK    WN0080  1        COA RIN EMTS St
     C                     Z-ADD*ZERO     WN0081  70       COA RIN EMTS Da
     C                     Z-ADD*ZERO     WN0082  60       COA RIN EMTS Ti
     C                     Z-ADD*ZERO     WN0083  70       COA EMTS PTD Nb
     C                     Z-ADD*ZERO     WN0084  80       COA EMTS Batch
     C                     MOVEL*BLANK    WN0085  2        COA BHR Unused
     C                     Z-ADD*ZERO     WN0086  80       COA BHR Unused
     C                     MOVEL*BLANK    WN0087 40        COA EMTS Trans
     C                     MOVEL*BLANK    WN0088 10        COA EMTS Return
     C                     Z-ADD*ZERO     WN0089  70       COA BHR Unused
     C                     Z-ADD*ZERO     WN0090  21       COA BHR Equiv V
     C                     Z-ADD*ZERO     WN0091  70       COA BHR RINs to
     C                     Z-ADD*ZERO     WN0092  70       COA Unassgnd Tx
     C                     MOVEL*BLANK    WN0093  1        Record Status
     C                     Z-ADD*ZERO     WN0094  70       Create Date
     C                     Z-ADD*ZERO     WN0095  60       Create Time
     C                     MOVEL*BLANK    WN0096 10        Create User
     C                     MOVEL*BLANK    WN0097 10        Create Program
     C                     Z-ADD*ZERO     WN0098  70       Change Date
     C                     Z-ADD*ZERO     WN0099  60       Change Time
     C                     MOVEL*BLANK    WN0100 10        Change User
     C                     MOVEL*BLANK    WN0101 10        Change Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @DACPP5
     C                     Z-ADDWAAIC3    WRAIC3           Company Number
     C                     MOVELWAL6T1    WRL6T1    P      COA ULSD Compan
     C                     Z-ADDWAI3NY    WRI3NY           COA Batch Numbe
     C                     Z-ADDWAJYNY    WRJYNY           COA Batch Heade
     C                     Z-ADDWAQ1NY    WRQ1NY           COA Batch Hdr R
      *
     C           KLCHTA    KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRL6T1           COA ULSD Compan
     C                     KFLD           WRI3NY           COA Batch Numbe
     C                     KFLD           WRJYNY           COA Batch Heade
     C                     KFLD           WRQ1NY           COA Batch Hdr R
     C           KLCHTA    CHAIN@DACPP5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMDACPL0'MDACP
     C                     MOVEL'@DACPP5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TAEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPMDA1    YCRDCS
      * Move non-key fields to @DACPP5
     C                     MOVELWAMUT1    WRMUT1    P      COA Batch Heade
     C                     Z-ADDWN0023    WRRIDT           COA RIN Transac
     C                     Z-ADD##JTM     WRC5TM           COA RIN Transac
     C                     MOVEL*BLANK    WRMWT1    P      COA RIN Trans P
     C                     MOVEL'U'       WRG3ST    P      COA RIN SoldFul
      *
      * Set PGM.*Record Data Changed flag
     C           QPMDA1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Chg Date/Time      IF
     C                     Z-ADD##JDT     WRMKDT           Change Date
     C                     Z-ADD##JTM     WRBFTM           Change Time
     C                     MOVEL##USR     WRCEVN           Change User
     C                     MOVEL##PGM     WRCFVN           Change Program
      * Set PGM.*Record Data Changed flag
     C           QPMDA1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@DACPP5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMDACPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Rtv Upd Ref Ord f/Inv RT - COA Batch Header RIN  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTL6T1           COA ULSD Compan
     C                     KFLD           WTI3NY           COA Batch Numbe
     C                     KFLD           WTJYNY           COA Batch Heade
     C                     KFLD           WTQ1NY           COA Batch Hdr R
      * Setup key
     C                     Z-ADDWL0331    WTAIC3           Company Number
     C                     MOVELWL0332    WTL6T1           COA ULSD Compan
     C                     Z-ADDWL0333    WTI3NY           COA Batch Numbe
     C                     Z-ADDWL0334    WTJYNY           COA Batch Heade
     C                     Z-ADDWL0335    WTQ1NY           COA Batch Hdr R
      * Establish starting position
     C           KRSTB     CHAIN@DACPP6              90    *
      * Data record not found
     C   90                MOVEL'USR3855' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: PAR.COA BHR Net Galls to Sell is Not Entered
     C           WL0337    IFEQ 0                          *IF
     C                     MOVEL'F'       YL0095           COA RIN SoldFul
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'S'       YL0095           COA RIN SoldFul
     C                     END                             *FI
      * increase unassigned rins sold or rins sold
      * CASE: PAR.Type Code is Not RIN Customer
     C           WL0339    IFEQ 'NR'                       *IF
      * Use rin quantity instead. it was putting the total sold (assgn+un
     C           WTSYNY    ADD  WL0338    YL0096           COA BHR RINs to
     C                     Z-ADDWTQWNY    YL0097           COA RIN Volume
     C                     ELSE
      * CASE: *OTHERWISE
      * update rin adjustment --> excess rins from when ohe equiv is <1.5
     C           WTSYNY    ADD  WL0340    YL0096           COA BHR RINs to
     C                     Z-ADDWL0336    YL0097           COA RIN Volume
     C                     END                             *FI
      * Chg COA Batch Hdr RIN CH - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWTAIC3    WL0064           Company Number
     C                     MOVELWTL6T1    WL0065    P      COA ULSD Compan
     C                     Z-ADDWTI3NY    WL0066           COA Batch Numbe
     C                     Z-ADDWTJYNY    WL0067           COA Batch Heade
     C                     Z-ADDWTQ1NY    WL0068           COA Batch Hdr R
     C                     MOVELWTMUT1    WL0069    P      COA Batch Heade
     C                     Z-ADDWTJZNY    WL0070           COA RIN SSSSSSS
     C                     Z-ADDWTJ0NY    WL0071           COA RIN EEEEEEE
     C                     Z-ADDWTJ2NY    WL0072           COA RIN Volume
     C                     Z-ADDWTRIDT    WL0073           COA RIN Transac
     C                     Z-ADDWTC5TM    WL0074           COA RIN Transac
     C                     MOVELWTMVT1    WL0075    P      COA RIN Trans P
     C                     MOVELWTMWT1    WL0076    P      COA RIN Trans P
     C                     MOVELWTRINT    WL0077    P      COA Retired RIN
     C                     Z-ADDWTRJDT    WL0078           COA Retired RIN
     C                     Z-ADDWTC6TM    WL0079           COA Retired RIN
     C                     Z-ADDWTC4NB    WL0080           Order Number
     C                     Z-ADDWTDPNB    WL0081           Order Sequence
     C                     Z-ADDWTUENB    WL0082           Order Secondary
     C                     Z-ADDWTRZNB    WL0083           Case Sequence N
     C                     MOVELWTNGT1    WL0084    P      COA Rail Car
     C                     Z-ADDWTRMNB    WL0085           Load ID
     C                     Z-ADDWTRKDT    WL0086           COA Date of 1st
     C                     Z-ADDWTC7TM    WL0087           COA RIN Unused
     C                     MOVELWTRINS    WL0088    P      COA RIN Modifie
     C                     MOVELWTMXT1    WL0089    P      COA RIN Unused
     C                     MOVELYL0095    WL0090    P      COA RIN SoldFul
     C                     Z-ADDYL0097    WL0091           COA RIN Gallons
     C                     MOVELWTL0AA    WL0092    P      COA Ship To War
     C                     MOVELWTMAT1    WL0093    P      COA RIN Type Fl
     C                     MOVELWTTDNA    WL0094    P      COA RIN Custome
     C                     Z-ADDWTCWC3    WL0095           COA Shipping Co
     C                     Z-ADDWTQXNY    WL0096           COA Ref Load Id
     C                     Z-ADDWTQZNY    WL0097           COA Reference B
     C                     Z-ADDWTQ0NY    WL0098           COA Reference B
     C                     MOVELWTLVTX    WL0099    P      RFS Compliance
     C                     MOVELWTNYT1    WL0100    P      RFS Report Year
     C                     MOVELWTG5ST    WL0101    P      COA RIN Int/Ext
     C                     MOVELWTG7ST    WL0102    P      COA BHR Unused
     C                     Z-ADDWL0337    WL0103           COA BHR Net Gal
     C                     Z-ADDWTTGDT    WL0104           COA BHR Unused
     C                     MOVELWTWIT1    WL0105    P      COA BHR Unused
     C                     Z-ADDWTQYNY    WL0106           COA BHR Loadout
     C                     MOVELWTL7T1    WL0107    P      COA ULSD Facili
     C                     Z-ADDWTR8NY    WL0108           COA Batch RIN V
     C                     Z-ADDWTR0NY    WL0109           COA RIN Quantit
     C                     MOVELWTI7AA    WL0110    P      RFS Transaction
     C                     MOVELWTMXAA    WL0111    P      RFS Trans Reaso
     C                     MOVELWTMSAA    WL0112    P      RFS Fuel Code
     C                     Z-ADDWTR7NY    WL0113           COA BHR RIN Gen
     C                     Z-ADDWTHEPR    WL0114           COA BHR RIN Pri
     C                     Z-ADDWTHFPR    WL0115           COA BHR Gallon
     C                     MOVELWTWVT1    WL0116    P      COA Transaction
     C                     MOVELWTW0T1    WL0117    P      COA RIN Support
     C                     Z-ADDWTR5NY    WL0118           COA RIN Support
     C                     MOVELWTW1T1    WL0119    P      COA RIN Support
     C                     Z-ADDWTR6NY    WL0120           COA RIN Support
     C                     MOVELWTJ1ST    WL0121    P      COA BHR RFS Ver
     C                     MOVELWTKHST    WL0122    P      COA GEN EMTS St
     C                     Z-ADDWTTWDT    WL0123           COA GEN EMTS Da
     C                     Z-ADDWTDUTM    WL0124           COA GEN EMTS Ti
     C                     MOVELWTKGST    WL0125    P      COA RIN EMTS St
     C                     Z-ADDWTTVDT    WL0126           COA RIN EMTS Da
     C                     Z-ADDWTDTTM    WL0127           COA RIN EMTS Ti
     C                     Z-ADDWTR9NY    WL0128           COA EMTS PTD Nb
     C                     Z-ADDWTSQNY    WL0129           COA EMTS Batch
     C                     MOVELWTBHR3    WL0130    P      COA BHR Unused
     C                     Z-ADDWTSRNY    WL0131           COA BHR Unused
     C                     MOVELWTW7T1    WL0132    P      COA EMTS Trans
     C                     MOVELWTW8T1    WL0133    P      COA EMTS Return
     C                     Z-ADDWTT2DT    WL0134           COA BHR Unused
     C                     Z-ADDWTSXNY    WL0135           COA BHR Equiv V
     C                     Z-ADDYL0096    WL0136           COA BHR RINs to
     C                     Z-ADDWTSZNY    WL0137           COA Unassgnd Tx
     C                     MOVELWTVSST    WL0138    P      Record Status
     C                     Z-ADDWTMKDT    WL0139           Change Date
     C                     Z-ADDWTBFTM    WL0140           Change Time
     C                     MOVELWTCEVN    WL0141    P      Change User
     C                     MOVELWTCFVN    WL0142    P      Change Program
     C                     EXSR SQCHRC
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Rtv Upd Ord f/inv     RT - COA Batch Header RIN  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WTAIC3           Company Number
     C                     KFLD           WTL6T1           COA ULSD Compan
     C                     KFLD           WTI3NY           COA Batch Numbe
     C                     KFLD           WTJYNY           COA Batch Heade
     C                     KFLD           WTQ1NY           COA Batch Hdr R
      * Setup key
     C                     Z-ADDWL0341    WTAIC3           Company Number
     C                     MOVELWL0342    WTL6T1           COA ULSD Compan
     C                     Z-ADDWL0343    WTI3NY           COA Batch Numbe
     C                     Z-ADDWL0344    WTJYNY           COA Batch Heade
     C                     Z-ADDWL0345    WTQ1NY           COA Batch Hdr R
      * Establish starting position
     C           KRSTC     CHAIN@DACPP6              90    *
      * Data record not found
     C   90                MOVEL'USR3855' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg COA Batch Hdr RIN CH - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWTAIC3    WL0064           Company Number
     C                     MOVELWTL6T1    WL0065    P      COA ULSD Compan
     C                     Z-ADDWTI3NY    WL0066           COA Batch Numbe
     C                     Z-ADDWTJYNY    WL0067           COA Batch Heade
     C                     Z-ADDWTQ1NY    WL0068           COA Batch Hdr R
     C                     MOVELWL0356    WL0069    P      COA Batch Heade
     C                     Z-ADDWL0353    WL0070           COA RIN SSSSSSS
     C                     Z-ADDWL0354    WL0071           COA RIN EEEEEEE
     C                     Z-ADDWL0355    WL0072           COA RIN Volume
     C                     Z-ADDWL0357    WL0073           COA RIN Transac
     C                     Z-ADD##JTM     WL0074           COA RIN Transac
     C                     MOVELWTMVT1    WL0075    P      COA RIN Trans P
     C                     MOVELWTMWT1    WL0076    P      COA RIN Trans P
     C                     MOVELWTRINT    WL0077    P      COA Retired RIN
     C                     Z-ADDWTRJDT    WL0078           COA Retired RIN
     C                     Z-ADDWTC6TM    WL0079           COA Retired RIN
     C                     Z-ADDWTC4NB    WL0080           Order Number
     C                     Z-ADDWTDPNB    WL0081           Order Sequence
     C                     Z-ADDWTUENB    WL0082           Order Secondary
     C                     Z-ADDWTRZNB    WL0083           Case Sequence N
     C                     MOVELWTNGT1    WL0084    P      COA Rail Car
     C                     Z-ADDWTRMNB    WL0085           Load ID
     C                     Z-ADDWTRKDT    WL0086           COA Date of 1st
     C                     Z-ADDWTC7TM    WL0087           COA RIN Unused
     C                     MOVELWTRINS    WL0088    P      COA RIN Modifie
     C                     MOVELWTMXT1    WL0089    P      COA RIN Unused
     C                     MOVELWTG3ST    WL0090    P      COA RIN SoldFul
     C                     Z-ADDWTQWNY    WL0091           COA RIN Gallons
     C                     MOVELWTL0AA    WL0092    P      COA Ship To War
     C                     MOVELWTMAT1    WL0093    P      COA RIN Type Fl
     C                     MOVELWTTDNA    WL0094    P      COA RIN Custome
     C                     Z-ADDWTCWC3    WL0095           COA Shipping Co
     C                     Z-ADDWTQXNY    WL0096           COA Ref Load Id
     C                     Z-ADDWTQZNY    WL0097           COA Reference B
     C                     Z-ADDWTQ0NY    WL0098           COA Reference B
     C                     MOVELWTLVTX    WL0099    P      RFS Compliance
     C                     MOVELWTNYT1    WL0100    P      RFS Report Year
     C                     MOVELWTG5ST    WL0101    P      COA RIN Int/Ext
     C                     MOVELWTG7ST    WL0102    P      COA BHR Unused
     C                     Z-ADDWTTFDT    WL0103           COA BHR Net Gal
     C                     Z-ADDWTTGDT    WL0104           COA BHR Unused
     C                     MOVELWTWIT1    WL0105    P      COA BHR Unused
     C                     Z-ADDWTQYNY    WL0106           COA BHR Loadout
     C                     MOVELWTL7T1    WL0107    P      COA ULSD Facili
     C                     Z-ADDWL0346    WL0108           COA Batch RIN V
     C                     Z-ADDWL0347    WL0109           COA RIN Quantit
     C                     MOVELWTI7AA    WL0110    P      RFS Transaction
     C                     MOVELWTMXAA    WL0111    P      RFS Trans Reaso
     C                     MOVELWTMSAA    WL0112    P      RFS Fuel Code
     C                     Z-ADDWL0348    WL0113           COA BHR RIN Gen
     C                     Z-ADDWTHEPR    WL0114           COA BHR RIN Pri
     C                     Z-ADDWL0349    WL0115           COA BHR Gallon
     C                     MOVELWTWVT1    WL0116    P      COA Transaction
     C                     MOVELWTW0T1    WL0117    P      COA RIN Support
     C                     Z-ADDWTR5NY    WL0118           COA RIN Support
     C                     MOVELWTW1T1    WL0119    P      COA RIN Support
     C                     Z-ADDWTR6NY    WL0120           COA RIN Support
     C                     MOVELWTJ1ST    WL0121    P      COA BHR RFS Ver
     C                     MOVELWTKHST    WL0122    P      COA GEN EMTS St
     C                     Z-ADDWTTWDT    WL0123           COA GEN EMTS Da
     C                     Z-ADDWTDUTM    WL0124           COA GEN EMTS Ti
     C                     MOVELWL0350    WL0125    P      COA RIN EMTS St
     C                     Z-ADDWTTVDT    WL0126           COA RIN EMTS Da
     C                     Z-ADDWTDTTM    WL0127           COA RIN EMTS Ti
     C                     Z-ADDWTR9NY    WL0128           COA EMTS PTD Nb
     C                     Z-ADDWL0351    WL0129           COA EMTS Batch
     C                     MOVELWTBHR3    WL0130    P      COA BHR Unused
     C                     Z-ADDWTSRNY    WL0131           COA BHR Unused
     C                     MOVELWTW7T1    WL0132    P      COA EMTS Trans
     C                     MOVELWTW8T1    WL0133    P      COA EMTS Return
     C                     Z-ADDWTT2DT    WL0134           COA BHR Unused
     C                     Z-ADDWL0352    WL0135           COA BHR Equiv V
     C                     Z-ADDWTSYNY    WL0136           COA BHR RINs to
     C                     Z-ADDWTSZNY    WL0137           COA Unassgnd Tx
     C                     MOVELWTVSST    WL0138    P      Record Status
     C                     Z-ADD##JDT     WL0139           Change Date
     C                     Z-ADD##JTM     WL0140           Change Time
     C                     MOVEL##USR     WL0141    P      Change User
     C                     MOVEL##PGM     WL0142    P      Change Program
     C                     EXSR SQCHRC
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv GEN Dt for org SELRT - COA Batch Header RIN  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTAIC3    WQTD01           Company Number
     C           *LIKE     DEFN WTL6T1    WQTD02           COA ULSD Compan
     C           *LIKE     DEFN WTI3NY    WQTD03           COA Batch Numbe
     C           *LIKE     DEFN WTJYNY    WQTD04           COA Batch Heade
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           Company Number
     C                     KFLD           WQTD02           COA ULSD Compan
     C                     KFLD           WQTD03           COA Batch Numbe
     C                     KFLD           WQTD04           COA Batch Heade
      * Setup key
     C                     Z-ADDWL0358    WQTD01           Company Number
     C                     MOVELWL0359    WQTD02           COA ULSD Compan
     C                     Z-ADDWL0360    WQTD03           COA Batch Numbe
     C                     Z-ADDWL0361    WQTD04           COA Batch Heade
      * Establish starting position
     C           KRSTD     SETLL@DACPP6                    *
     C           KRSTD     READE@DACPP6                  90*
      * Data record not found
     C   90                MOVEL'USR3855' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Get GEN date... s/only be 1 order for this ulsd/batch/seq
      * PAR = DB1 By name
     C                     Z-ADDWTR7NY    WL0362           COA BHR RIN Gen
     C                     Z-ADDWTTWDT    WL0363           COA GEN EMTS Da
     C                     GOTO TDEXIT                     *QUIT
     C           KRSTD     READE@DACPP6                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1MUT1           COA Batch Heade
     C                     Z-ADD*ZERO     P1JZNY           COA RIN SSSSSSS
     C                     Z-ADD*ZERO     P1J0NY           COA RIN EEEEEEE
     C                     Z-ADD*ZERO     P1J2NY           COA RIN Volume
     C                     MOVEL*BLANK    P2IDAA           COA Bio-diesel
     C                     MOVEL*BLANK    P2L2T1           COA Producer Re
     C                     MOVEL*BLANK    P2L3T1           COA Employer ID
     C                     MOVEL*BLANK    P2L6T1           COA ULSD Compan
     C                     MOVEL*BLANK    P2L7T1           COA ULSD Facili
     C                     MOVEL*BLANK    P2L8T1           COA RIN Equival
     C                     MOVEL*BLANK    P2L9T1           COA RIN Renewab
     C                     MOVEL*BLANK    P2MAT1           COA RIN Type Fl
     C                     Z-ADD*ZERO     P2JENY           COA Temperature
     C                     Z-ADD*ZERO     P2JQNY           COA Temp Conv F
     C                     MOVEL*BLANK    P2LXST           Operation Facto
     C                     Z-ADD*ZERO     P2JRNY           COA Temp Conv F
     C                     MOVEL*BLANK    P2LYST           Operation Facto
     C                     Z-ADD*ZERO     P3J1NY           COA Last RIN EE
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAI3NY           COA Batch Numbe
     C                     Z-ADD*ZERO     WAJYNY           COA Batch Heade
     C                     Z-ADD*ZERO     WAQ1NY           COA Batch Hdr R
     C                     Z-ADD*ZERO     WAJZNY           COA RIN SSSSSSS
     C                     Z-ADD*ZERO     WAJ0NY           COA RIN EEEEEEE
     C                     Z-ADD*ZERO     WAJ2NY           COA RIN Volume
     C                     Z-ADD*ZERO     WARIDT           COA RIN Transac
     C                     Z-ADD*ZERO     WAC5TM           COA RIN Transac
     C                     Z-ADD*ZERO     WARJDT           COA Retired RIN
     C                     Z-ADD*ZERO     WAC6TM           COA Retired RIN
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WARZNB           Case Sequence N
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WARKDT           COA Date of 1st
     C                     Z-ADD*ZERO     WAC7TM           COA RIN Unused
     C                     Z-ADD*ZERO     WAQWNY           COA RIN Gallons
     C                     Z-ADD*ZERO     WACWC3           COA Shipping Co
     C                     Z-ADD*ZERO     WAQXNY           COA Ref Load Id
     C                     Z-ADD*ZERO     WAQZNY           COA Reference B
     C                     Z-ADD*ZERO     WAQ0NY           COA Reference B
     C                     Z-ADD*ZERO     WATFDT           COA BHR Net Gal
     C                     Z-ADD*ZERO     WATGDT           COA BHR Unused
     C                     Z-ADD*ZERO     WAQYNY           COA BHR Loadout
     C                     Z-ADD*ZERO     WAR8NY           COA Batch RIN V
     C                     Z-ADD*ZERO     WAR0NY           COA RIN Quantit
     C                     Z-ADD*ZERO     WAR7NY           COA BHR RIN Gen
     C                     Z-ADD*ZERO     WAHEPR           COA BHR RIN Pri
     C                     Z-ADD*ZERO     WAHFPR           COA BHR Gallon
     C                     Z-ADD*ZERO     WAR5NY           COA RIN Support
     C                     Z-ADD*ZERO     WAR6NY           COA RIN Support
     C                     Z-ADD*ZERO     WATWDT           COA GEN EMTS Da
     C                     Z-ADD*ZERO     WADUTM           COA GEN EMTS Ti
     C                     Z-ADD*ZERO     WATVDT           COA RIN EMTS Da
     C                     Z-ADD*ZERO     WADTTM           COA RIN EMTS Ti
     C                     Z-ADD*ZERO     WAR9NY           COA EMTS PTD Nb
     C                     Z-ADD*ZERO     WASQNY           COA EMTS Batch
     C                     Z-ADD*ZERO     WASRNY           COA BHR Unused
     C                     Z-ADD*ZERO     WAT2DT           COA BHR Unused
     C                     Z-ADD*ZERO     WASXNY           COA BHR Equiv V
     C                     Z-ADD*ZERO     WASYNY           COA BHR RINs to
     C                     Z-ADD*ZERO     WASZNY           COA Unassgnd Tx
     C                     Z-ADD*ZERO     WAMJDT           Create Date
     C                     Z-ADD*ZERO     WABETM           Create Time
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A/R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WBNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WBNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WBNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WBNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WBBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WBBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field USR Check Y/N Status
     C                     MOVEL*BLANK    WUJDST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WCMAVA           Billing Detail
     C                     Z-ADD*ZERO     WCKDVA           Billing Detail
     C                     Z-ADD*ZERO     WCL8VA           Billing Detail
     C                     Z-ADD*ZERO     WCL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WCAYVA           Extended Amount
     C                     Z-ADD*ZERO     WCEXDT           Market Pricing
     C                     Z-ADD*ZERO     WCBZPR           Price Overage O
     C                     Z-ADD*ZERO     WCL6NB           Contract Number
     C                     Z-ADD*ZERO     WCGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WCD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WCCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WCAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WCCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WCATWG           Weight Shipped
     C                     Z-ADD*ZERO     WCAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WCAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WCAKPR           Unit Price
     C                     Z-ADD*ZERO     WCALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WCAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WCAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WCA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCRGNB           Item Structure
     C                     Z-ADD*ZERO     WCRHNB           Item Structure
     C                     Z-ADD*ZERO     WCRINB           Item Structure
     C                     Z-ADD*ZERO     WCCXDT           Date of Origina
     C                     Z-ADD*ZERO     WCDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WCB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WCA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WCNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WCNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WCNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WCNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WCNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WCBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WCBVTM           Price Code
     C                     Z-ADD*ZERO     WCBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WCBXTM           Substitution Li
     C                     Z-ADD*ZERO     WCBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WCH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WCH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WCH7NX           OD Item Target
     C                     Z-ADD*ZERO     WCH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WCH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WCDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WCDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WCDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WCDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WCDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WCGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WCGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WCGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WCPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WCRINY           Item Age Days
     C                     Z-ADD*ZERO     WCTIDT           Production Ovr
     C                     Z-ADD*ZERO     WCTJDT           Production Ovr
     C                     Z-ADD*ZERO     WCTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WCTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WCTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WDBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WDBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WDBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WDBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEM8NB           System Value Nu
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFI3NY           COA Batch Numbe
     C                     Z-ADD*ZERO     WFRFDT           COA Date Open f
     C                     Z-ADD*ZERO     WFC2TM           COA Time Open f
     C                     Z-ADD*ZERO     WFRGDT           COA Date Close
     C                     Z-ADD*ZERO     WFC3TM           COA Time Close
     C                     Z-ADD*ZERO     WFJHNY           COA Gallons Use
     C                     Z-ADD*ZERO     WFRHDT           COA Batch Produ
     C                     Z-ADD*ZERO     WFC4TM           COA Batch Unuse
     C                     Z-ADD*ZERO     WFJENY           COA Temperature
     C                     Z-ADD*ZERO     WFJVNY           COA Batch Volum
     C                     Z-ADD*ZERO     WFJWNY           COA Batch Denat
     C                     Z-ADD*ZERO     WFJXNY           COA Batch Expor
     C                     Z-ADD*ZERO     WFJ1NY           COA Last RIN EE
     C                     Z-ADD*ZERO     WFJCNY           COA Density Loa
     C                     Z-ADD*ZERO     WFJDNY           COA Density Ref
     C                     Z-ADD*ZERO     WFJ3NY           COA RIN Equival
     C                     Z-ADD*ZERO     WFRLDT           COA Batch Unuse
     C                     Z-ADD*ZERO     WFR0NY           COA RIN Quantit
     C                     Z-ADD*ZERO     WFTTDT           COA BH EMTS Dat
     C                     Z-ADD*ZERO     WFDRTM           COA BH EMTS Tim
     C                     Z-ADD*ZERO     WFR4NY           COA BH Yield Pe
     C                     Z-ADD*ZERO     WFTUDT           COA BH Unused D
     C                     Z-ADD*ZERO     WFDSTM           COA BH Unused T
     C                     Z-ADD*ZERO     WFSANY           COA BH Feedstck
     C                     Z-ADD*ZERO     WFGZPC           COA BH Feedstck
     C                     Z-ADD*ZERO     WFSBNY           COA BH Feedstck
     C                     Z-ADD*ZERO     WFG0PC           COA BH Feedstck
     C                     Z-ADD*ZERO     WFSCNY           COA BH Feedstck
     C                     Z-ADD*ZERO     WFG1PC           cOA BH Feedstck
     C                     Z-ADD*ZERO     WFMJDT           Create Date
     C                     Z-ADD*ZERO     WFBETM           Create Time
     C                     Z-ADD*ZERO     WFMKDT           Change Date
     C                     Z-ADD*ZERO     WFBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGC4NB           Order Number
     C                     Z-ADD*ZERO     WGDPNB           Order Sequence
     C                     Z-ADD*ZERO     WGUENB           Order Secondary
     C                     Z-ADD*ZERO     WGRZNB           Case Sequence N
     C                     Z-ADD*ZERO     WGFOQT           Case Quantity
     C                     Z-ADD*ZERO     WGR0NB           Case Weight
     C                     Z-ADD*ZERO     WGK7DT           Label Date
     C                     Z-ADD*ZERO     WGPFNX           PT Serial Numbe
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGELDT           Production Date
     C                     Z-ADD*ZERO     WGN5WG           Manifest Gross
     C                     Z-ADD*ZERO     WGH5NY           Manifest Total
     C                     Z-ADD*ZERO     WGH6NY           Manifest Co-Par
     C                     Z-ADD*ZERO     WGH7NY           Manifest Pallet
     C                     Z-ADD*ZERO     WGN6WG           HPB Meter Net G
     C                     Z-ADD*ZERO     WGN7WG           Manifest Net We
     C                     Z-ADD*ZERO     WGRBDT           Manifest Unused
     C                     Z-ADD*ZERO     WGITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WGIVNY           HPB Meter Start
     C                     Z-ADD*ZERO     WGIUNY           HPB Meter Endin
     C                     Z-ADD*ZERO     WGIWNY           HPB Meter Total
     C                     Z-ADD*ZERO     WGIXNY           HPB Meter Net W
     C                     Z-ADD*ZERO     WGIYNY           HPB Density Ref
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field Item Code 5.0
     C                     Z-ADD*ZERO     WUH4NY  50
      * Define work field Text USR 5
     C                     MOVEL*BLANK    WUY7TX  5
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHJCNY           COA Density Loa
     C                     Z-ADD*ZERO     WHJDNY           COA Density Ref
     C                     Z-ADD*ZERO     WHJENY           COA Temperature
     C                     Z-ADD*ZERO     WHJFNY           COA Temperature
     C                     Z-ADD*ZERO     WHGMPC           COA BOL Percent
     C                     Z-ADD*ZERO     WHJQNY           COA Temp Conv F
     C                     Z-ADD*ZERO     WHJRNY           COA Temp Conv F
     C                     Z-ADD*ZERO     WHI1NY           Sold To Custome
     C                     Z-ADD*ZERO     WHMJDT           Create Date
     C                     Z-ADD*ZERO     WHBETM           Create Time
     C                     Z-ADD*ZERO     WHMKDT           Change Date
     C                     Z-ADD*ZERO     WHBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIRMNB           Load ID
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WIRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WIRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WIFLAM           Flat Amount
     C                     Z-ADD*ZERO     WIRRNB           Total Stops
     C                     Z-ADD*ZERO     WISBNB           BOL Time
     C                     Z-ADD*ZERO     WISQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WIR1NB           Rated Freight
     C                     Z-ADD*ZERO     WISDNB           Number Pallets
     C                     Z-ADD*ZERO     WIPAOU           Number Pallets
     C                     Z-ADD*ZERO     WIDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WISXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WIHADT           Actual Arrival
     C                     Z-ADD*ZERO     WIAART           Actual Arrival
     C                     Z-ADD*ZERO     WIDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WIDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WIAQDT           Actual Departur
     C                     Z-ADD*ZERO     WIS6NB           Departure Time
     C                     Z-ADD*ZERO     WIT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WIPRTM           Product Tempera
     C                     Z-ADD*ZERO     WINPSV           Number Spacers
     C                     Z-ADD*ZERO     WITLMI           Total Load Mile
     C                     Z-ADD*ZERO     WIGRWE           Gross Weight
     C                     Z-ADD*ZERO     WIF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WIJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WITRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WIJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WISPTM           Spotted Time
     C                     Z-ADD*ZERO     WIJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WILFTM           Load Finished T
     C                     Z-ADD*ZERO     WIJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WIBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WIJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WIBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WIKIDT           Truck Departure
     C                     Z-ADD*ZERO     WIASTM           Truck Departure
     C                     Z-ADD*ZERO     WIKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WIAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WIVOAG           Voyage
     C                     Z-ADD*ZERO     WIKBDT           Sail Date
     C                     Z-ADD*ZERO     WIEFDT           Arrival Date
     C                     Z-ADD*ZERO     WIKCDT           Date In
     C                     Z-ADD*ZERO     WITMIN           Time In
     C                     Z-ADD*ZERO     WIKDDT           Date Out
     C                     Z-ADD*ZERO     WIVMNB           Time Out
     C                     Z-ADD*ZERO     WIOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WIKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WIATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WIBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WIEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WIKKDT           On Yard Date
     C                     Z-ADD*ZERO     WIAVTM           On Yard Time
     C                     Z-ADD*ZERO     WIKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WIAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WILLDT           Express Mail Da
     C                     Z-ADD*ZERO     WIK0DT           Product Complet
     C                     Z-ADD*ZERO     WIAYTM           Product Complet
     C                     Z-ADD*ZERO     WIKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WIICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WIIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WIK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WIAZTM           Load Door 1
     C                     Z-ADD*ZERO     WIK2DT           Override Total
     C                     Z-ADD*ZERO     WIA0TM           Load Door 2
     C                     Z-ADD*ZERO     WIZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WIPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WICKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WIPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WICLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WIP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WICMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WIP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WICNTM           LH Unused Time
     C                     Z-ADD*ZERO     WIP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WICOTM           LH Unused Time
     C                     Z-ADD*ZERO     WIP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WICQTM           LH Unused Time
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJSSNY           RFS API Gravity
     C                     Z-ADD*ZERO     WJSTNY           RFS Loadout Tem
     C                     Z-ADD*ZERO     WJSUNY           RFS API Vol Cor
     C                     Z-ADD*ZERO     WJSVNY           RFS API Unused
     C                     Z-ADD*ZERO     WJMJDT           Create Date
     C                     Z-ADD*ZERO     WJBETM           Create Time
     C                     Z-ADD*ZERO     WJMKDT           Change Date
     C                     Z-ADD*ZERO     WJBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLC4NB           Order Number
     C                     Z-ADD*ZERO     WLRMNB           Load ID
     C                     Z-ADD*ZERO     WLRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WLQWDT           OHE Sail/Flight
     C                     Z-ADD*ZERO     WLQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WLQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WLGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WLGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WLGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WLGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WLHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WLHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WLHGVL           Transload Termi
     C                     Z-ADD*ZERO     WLQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WLQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WLQ1DT           OHE Port/Pier P
     C                     Z-ADD*ZERO     WLQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WLITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WLQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WLQKNY           LD Stop/Drop
     C                     Z-ADD*ZERO     WLQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WLP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WLP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WLQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WLQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WLQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WLQENY           Original Appoin
     C                     Z-ADD*ZERO     WLQFNY           Original Appoin
     C                     Z-ADD*ZERO     WLQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WLQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WLQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WLQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WLW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WLW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WMKSNX           Additional Rout
     C                     Z-ADD*ZERO     WMPENX           Cust Shipping T
     C                     Z-ADD*ZERO     WMJ7NY           CCE Last ABS Fr
     C                     Z-ADD*ZERO     WMRJNY           Item Age Days F
     C                     Z-ADD*ZERO     WMRKNY           Item Age Days F
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOAIC3           Company Number
     C                     Z-ADD*ZERO     WOBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WOR5NB           Deliver after t
     C                     Z-ADD*ZERO     WOR6NB           Deliver before
     C                     Z-ADD*ZERO     WOTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WOMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WOW2NB           Co/Cust Overage
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WVMJDT           Create Date
     C                     Z-ADD*ZERO     WVBETM           Create Time
     C                     Z-ADD*ZERO     WVMKDT           Change Date
     C                     Z-ADD*ZERO     WVBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WWAIC3           Company Number
     C                     Z-ADD*ZERO     WWC4NB           Order Number
     C                     Z-ADD*ZERO     WWDPNB           Order Sequence
     C                     Z-ADD*ZERO     WWUENB           Order Secondary
     C                     Z-ADD*ZERO     WWRZNB           Case Sequence N
     C                     Z-ADD*ZERO     WWI3NY           COA Batch Numbe
     C                     Z-ADD*ZERO     WWJYNY           COA Batch Heade
     C                     Z-ADD*ZERO     WWQ1NY           COA Batch Hdr R
     C                     Z-ADD*ZERO     WWN6WG           HPB Meter Net G
     C                     Z-ADD*ZERO     WWRCNY           COA Batch Compa
     C                     Z-ADD*ZERO     WWMJDT           Create Date
     C                     Z-ADD*ZERO     WWBETM           Create Time
     C                     Z-ADD*ZERO     WWMKDT           Change Date
     C                     Z-ADD*ZERO     WWBFTM           Change Time
      * Define work field COA RIN Gallons Sold
     C                     Z-ADD*ZERO     WUQWNY  80
      * Define work field COA RIN Equivalence Valu#
     C                     Z-ADD*ZERO     WUJ3NY  81
      * Define work field COA BHR RIN Gen Year
     C                     Z-ADD*ZERO     WUR7NY  40
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WE   179       *Synon (17,9) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD   177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  30
     C                     Z-ADD*ZERO     WL0005  50
     C                     Z-ADD*ZERO     WL0006  70
     C                     Z-ADD*ZERO     WL0007 112
     C                     Z-ADD*ZERO     WL0008  80
     C                     Z-ADD*ZERO     WL0009  80
     C                     Z-ADD*ZERO     WL0010  80
     C                     Z-ADD*ZERO     WL0011  80
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0012  30
     C                     MOVEL*BLANK    WL0013  6
     C                     MOVEL*BLANK    WL0014 30
     C                     MOVEL*BLANK    WL0015 25
     C                     MOVEL*BLANK    WL0016 20
     C                     MOVEL*BLANK    WL0017 40
     C                     MOVEL*BLANK    WL0018 40
     C                     MOVEL*BLANK    WL0019  4
     C                     MOVEL*BLANK    WL0020  5
     C                     MOVEL*BLANK    WL0021  2
     C                     MOVEL*BLANK    WL0022  1
     C                     MOVEL*BLANK    WL0023  1
     C                     Z-ADD*ZERO     WL0024  75
     C                     Z-ADD*ZERO     WL0025  75
     C                     Z-ADD*ZERO     WL0026  30
     C                     Z-ADD*ZERO     WL0027  30
     C                     Z-ADD*ZERO     WL0028  41
     C                     MOVEL*BLANK    WL0029 30
     C                     MOVEL*BLANK    WL0030  3
     C                     MOVEL*BLANK    WL0031  3
     C                     MOVEL*BLANK    WL0032  3
     C                     MOVEL*BLANK    WL0033  3
     C                     MOVEL*BLANK    WL0034  3
     C                     MOVEL*BLANK    WL0035  3
     C                     Z-ADD*ZERO     WL0036 118
     C                     MOVEL*BLANK    WL0037  1
     C                     Z-ADD*ZERO     WL0038 118
     C                     MOVEL*BLANK    WL0039  1
     C                     MOVEL*BLANK    WL0040  3
     C                     MOVEL*BLANK    WL0041  3
     C                     MOVEL*BLANK    WL0042  6
     C                     Z-ADD*ZERO     WL0043  70
     C                     MOVEL*BLANK    WL0044  1
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0045  30
     C                     Z-ADD*ZERO     WL0046  70
     C                     Z-ADD*ZERO     WL0047  70
     C                     MOVEL*BLANK    WL0048 30
      * Define local variables for subroutine SMRVGN.
     C                     Z-ADD*ZERO     WL0049  30
     C                     Z-ADD*ZERO     WL0050  70
     C                     Z-ADD*ZERO     WL0051 112
     C                     Z-ADD*ZERO     WL0052 112
     C                     MOVEL*BLANK    WL0053  2
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0054  30
     C                     Z-ADD*ZERO     WL0055  70
     C                     MOVEL*BLANK    WL0056 20
     C                     MOVEL*BLANK    WL0057  4
     C                     MOVEL*BLANK    WL0058  5
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0059  70
     C                     MOVEL*BLANK    WL0060  2
      * Define local variables for subroutine SPRVGN.
     C                     Z-ADD*ZERO     WL0061  30
     C                     Z-ADD*ZERO     WL0062  70
     C                     Z-ADD*ZERO     WL0063 114
      * Define local variables for subroutine SQCHRC.
     C                     Z-ADD*ZERO     WL0064  30
     C                     MOVEL*BLANK    WL0065  4
     C                     Z-ADD*ZERO     WL0066  50
     C                     Z-ADD*ZERO     WL0067  50
     C                     Z-ADD*ZERO     WL0068  50
     C                     MOVEL*BLANK    WL0069 38
     C                     Z-ADD*ZERO     WL0070  80
     C                     Z-ADD*ZERO     WL0071  80
     C                     Z-ADD*ZERO     WL0072  80
     C                     Z-ADD*ZERO     WL0073  70
     C                     Z-ADD*ZERO     WL0074  60
     C                     MOVEL*BLANK    WL0075 30
     C                     MOVEL*BLANK    WL0076  4
     C                     MOVEL*BLANK    WL0077  3
     C                     Z-ADD*ZERO     WL0078  70
     C                     Z-ADD*ZERO     WL0079  60
     C                     Z-ADD*ZERO     WL0080  70
     C                     Z-ADD*ZERO     WL0081  30
     C                     Z-ADD*ZERO     WL0082  30
     C                     Z-ADD*ZERO     WL0083  50
     C                     MOVEL*BLANK    WL0084 15
     C                     Z-ADD*ZERO     WL0085  70
     C                     Z-ADD*ZERO     WL0086  70
     C                     Z-ADD*ZERO     WL0087  60
     C                     MOVEL*BLANK    WL0088  1
     C                     MOVEL*BLANK    WL0089 25
     C                     MOVEL*BLANK    WL0090  1
     C                     Z-ADD*ZERO     WL0091  80
     C                     MOVEL*BLANK    WL0092  3
     C                     MOVEL*BLANK    WL0093  1
     C                     MOVEL*BLANK    WL0094 15
     C                     Z-ADD*ZERO     WL0095  30
     C                     Z-ADD*ZERO     WL0096  70
     C                     Z-ADD*ZERO     WL0097  50
     C                     Z-ADD*ZERO     WL0098  50
     C                     MOVEL*BLANK    WL0099  2
     C                     MOVEL*BLANK    WL0100  4
     C                     MOVEL*BLANK    WL0101  1
     C                     MOVEL*BLANK    WL0102  2
     C                     Z-ADD*ZERO     WL0103  70
     C                     Z-ADD*ZERO     WL0104  70
     C                     MOVEL*BLANK    WL0105 25
     C                     Z-ADD*ZERO     WL0106  70
     C                     MOVEL*BLANK    WL0107  5
     C                     Z-ADD*ZERO     WL0108  70
     C                     Z-ADD*ZERO     WL0109  70
     C                     MOVEL*BLANK    WL0110  3
     C                     MOVEL*BLANK    WL0111  3
     C                     MOVEL*BLANK    WL0112  1
     C                     Z-ADD*ZERO     WL0113  40
     C                     Z-ADD*ZERO     WL0114  72
     C                     Z-ADD*ZERO     WL0115  72
     C                     MOVEL*BLANK    WL0116 50
     C                     MOVEL*BLANK    WL0117 25
     C                     Z-ADD*ZERO     WL0118  70
     C                     MOVEL*BLANK    WL0119 25
     C                     Z-ADD*ZERO     WL0120  70
     C                     MOVEL*BLANK    WL0121  1
     C                     MOVEL*BLANK    WL0122  1
     C                     Z-ADD*ZERO     WL0123  70
     C                     Z-ADD*ZERO     WL0124  60
     C                     MOVEL*BLANK    WL0125  1
     C                     Z-ADD*ZERO     WL0126  70
     C                     Z-ADD*ZERO     WL0127  60
     C                     Z-ADD*ZERO     WL0128  70
     C                     Z-ADD*ZERO     WL0129  80
     C                     MOVEL*BLANK    WL0130  2
     C                     Z-ADD*ZERO     WL0131  80
     C                     MOVEL*BLANK    WL0132 40
     C                     MOVEL*BLANK    WL0133 10
     C                     Z-ADD*ZERO     WL0134  70
     C                     Z-ADD*ZERO     WL0135  21
     C                     Z-ADD*ZERO     WL0136  70
     C                     Z-ADD*ZERO     WL0137  70
     C                     MOVEL*BLANK    WL0138  1
     C                     Z-ADD*ZERO     WL0139  70
     C                     Z-ADD*ZERO     WL0140  60
     C                     MOVEL*BLANK    WL0141 10
     C                     MOVEL*BLANK    WL0142 10
      * Define local variables for subroutine SSCHRC.
     C                     Z-ADD*ZERO     WL0143  30
     C                     MOVEL*BLANK    WL0144  4
     C                     Z-ADD*ZERO     WL0145  50
     C                     MOVEL*BLANK    WL0146  3
     C                     MOVEL*BLANK    WL0147  6
     C                     Z-ADD*ZERO     WL0148  70
     C                     Z-ADD*ZERO     WL0149  60
     C                     MOVEL*BLANK    WL0150  3
     C                     Z-ADD*ZERO     WL0151  70
     C                     Z-ADD*ZERO     WL0152  60
     C                     MOVEL*BLANK    WL0153  3
     C                     Z-ADD*ZERO     WL0154  70
     C                     MOVEL*BLANK    WL0155 30
     C                     Z-ADD*ZERO     WL0156  70
     C                     Z-ADD*ZERO     WL0157  60
     C                     MOVEL*BLANK    WL0158 25
     C                     MOVEL*BLANK    WL0159 25
     C                     MOVEL*BLANK    WL0160  1
     C                     MOVEL*BLANK    WL0161  1
     C                     MOVEL*BLANK    WL0162  1
     C                     Z-ADD*ZERO     WL0163  30
     C                     Z-ADD*ZERO     WL0164  80
     C                     Z-ADD*ZERO     WL0165  70
     C                     MOVEL*BLANK    WL0166  3
     C                     MOVEL*BLANK    WL0167  3
     C                     MOVEL*BLANK    WL0168 38
     C                     Z-ADD*ZERO     WL0169  80
     C                     Z-ADD*ZERO     WL0170  80
     C                     Z-ADD*ZERO     WL0171  75
     C                     Z-ADD*ZERO     WL0172  75
     C                     Z-ADD*ZERO     WL0173  81
     C                     Z-ADD*ZERO     WL0174  70
     C                     MOVEL*BLANK    WL0175  1
     C                     MOVEL*BLANK    WL0176  3
     C                     MOVEL*BLANK    WL0177  3
     C                     MOVEL*BLANK    WL0178  2
     C                     Z-ADD*ZERO     WL0179  70
     C                     MOVEL*BLANK    WL0180  5
     C                     MOVEL*BLANK    WL0181  2
     C                     MOVEL*BLANK    WL0182 50
     C                     MOVEL*BLANK    WL0183 50
     C                     MOVEL*BLANK    WL0184  1
     C                     MOVEL*BLANK    WL0185  1
     C                     Z-ADD*ZERO     WL0186  70
     C                     Z-ADD*ZERO     WL0187  60
     C                     MOVEL*BLANK    WL0188 25
     C                     MOVEL*BLANK    WL0189  2
     C                     Z-ADD*ZERO     WL0190  70
     C                     MOVEL*BLANK    WL0191  6
     C                     Z-ADD*ZERO     WL0192  70
     C                     Z-ADD*ZERO     WL0193  60
     C                     MOVEL*BLANK    WL0194 15
     C                     MOVEL*BLANK    WL0195  3
     C                     Z-ADD*ZERO     WL0196  80
     C                     MOVEL*BLANK    WL0197  3
     C                     MOVEL*BLANK    WL0198  1
     C                     Z-ADD*ZERO     WL0199  52
     C                     MOVEL*BLANK    WL0200 50
     C                     MOVEL*BLANK    WL0201  3
     C                     Z-ADD*ZERO     WL0202  80
     C                     MOVEL*BLANK    WL0203  3
     C                     MOVEL*BLANK    WL0204  1
     C                     Z-ADD*ZERO     WL0205  52
     C                     MOVEL*BLANK    WL0206 50
     C                     MOVEL*BLANK    WL0207  3
     C                     Z-ADD*ZERO     WL0208  80
     C                     MOVEL*BLANK    WL0209  3
     C                     MOVEL*BLANK    WL0210  1
     C                     Z-ADD*ZERO     WL0211  52
     C                     MOVEL*BLANK    WL0212 50
     C                     MOVEL*BLANK    WL0213  1
     C                     Z-ADD*ZERO     WL0214  70
     C                     Z-ADD*ZERO     WL0215  60
     C                     MOVEL*BLANK    WL0216 10
     C                     MOVEL*BLANK    WL0217 10
     C                     Z-ADD*ZERO     WL0218  70
     C                     Z-ADD*ZERO     WL0219  60
     C                     MOVEL*BLANK    WL0220 10
     C                     MOVEL*BLANK    WL0221 10
      * Define local variables for subroutine SUCRRC.
     C                     Z-ADD*ZERO     WL0222  30
     C                     MOVEL*BLANK    WL0223  4
     C                     Z-ADD*ZERO     WL0224  50
     C                     Z-ADD*ZERO     WL0225  50
     C                     Z-ADD*ZERO     WL0226  50
     C                     MOVEL*BLANK    WL0227 38
     C                     Z-ADD*ZERO     WL0228  80
     C                     Z-ADD*ZERO     WL0229  80
     C                     Z-ADD*ZERO     WL0230  80
     C                     Z-ADD*ZERO     WL0231  70
     C                     Z-ADD*ZERO     WL0232  60
     C                     MOVEL*BLANK    WL0233 30
     C                     MOVEL*BLANK    WL0234  4
     C                     MOVEL*BLANK    WL0235  3
     C                     Z-ADD*ZERO     WL0236  70
     C                     Z-ADD*ZERO     WL0237  60
     C                     Z-ADD*ZERO     WL0238  70
     C                     Z-ADD*ZERO     WL0239  30
     C                     Z-ADD*ZERO     WL0240  30
     C                     Z-ADD*ZERO     WL0241  50
     C                     MOVEL*BLANK    WL0242 15
     C                     Z-ADD*ZERO     WL0243  70
     C                     Z-ADD*ZERO     WL0244  70
     C                     Z-ADD*ZERO     WL0245  60
     C                     MOVEL*BLANK    WL0246  1
     C                     MOVEL*BLANK    WL0247 25
     C                     MOVEL*BLANK    WL0248  1
     C                     Z-ADD*ZERO     WL0249  80
     C                     MOVEL*BLANK    WL0250  3
     C                     MOVEL*BLANK    WL0251  1
     C                     MOVEL*BLANK    WL0252 15
     C                     Z-ADD*ZERO     WL0253  30
     C                     Z-ADD*ZERO     WL0254  70
     C                     Z-ADD*ZERO     WL0255  50
     C                     Z-ADD*ZERO     WL0256  50
     C                     MOVEL*BLANK    WL0257  2
     C                     MOVEL*BLANK    WL0258  4
     C                     MOVEL*BLANK    WL0259  1
     C                     MOVEL*BLANK    WL0260  2
     C                     Z-ADD*ZERO     WL0261  70
     C                     Z-ADD*ZERO     WL0262  70
     C                     MOVEL*BLANK    WL0263 25
     C                     Z-ADD*ZERO     WL0264  70
     C                     MOVEL*BLANK    WL0265  5
     C                     Z-ADD*ZERO     WL0266  70
     C                     Z-ADD*ZERO     WL0267  70
     C                     MOVEL*BLANK    WL0268  3
     C                     MOVEL*BLANK    WL0269  3
     C                     MOVEL*BLANK    WL0270  1
     C                     Z-ADD*ZERO     WL0271  40
     C                     Z-ADD*ZERO     WL0272  72
     C                     Z-ADD*ZERO     WL0273  72
     C                     MOVEL*BLANK    WL0274 50
     C                     MOVEL*BLANK    WL0275 25
     C                     Z-ADD*ZERO     WL0276  70
     C                     MOVEL*BLANK    WL0277 25
     C                     Z-ADD*ZERO     WL0278  70
     C                     MOVEL*BLANK    WL0279  1
     C                     MOVEL*BLANK    WL0280  1
     C                     Z-ADD*ZERO     WL0281  70
     C                     Z-ADD*ZERO     WL0282  60
     C                     MOVEL*BLANK    WL0283  1
     C                     Z-ADD*ZERO     WL0284  70
     C                     Z-ADD*ZERO     WL0285  60
     C                     Z-ADD*ZERO     WL0286  70
     C                     Z-ADD*ZERO     WL0287  80
     C                     MOVEL*BLANK    WL0288  2
     C                     Z-ADD*ZERO     WL0289  80
     C                     MOVEL*BLANK    WL0290 40
     C                     MOVEL*BLANK    WL0291 10
     C                     Z-ADD*ZERO     WL0292  70
     C                     Z-ADD*ZERO     WL0293  21
     C                     Z-ADD*ZERO     WL0294  70
     C                     Z-ADD*ZERO     WL0295  70
     C                     MOVEL*BLANK    WL0296  1
     C                     Z-ADD*ZERO     WL0297  70
     C                     Z-ADD*ZERO     WL0298  60
     C                     MOVEL*BLANK    WL0299 10
     C                     MOVEL*BLANK    WL0300 10
     C                     Z-ADD*ZERO     WL0301  70
     C                     Z-ADD*ZERO     WL0302  60
     C                     MOVEL*BLANK    WL0303 10
     C                     MOVEL*BLANK    WL0304 10
      * Define local variables for subroutine SVRVGN.
     C                     MOVEL*BLANK    WL0305  3
     C                     MOVEL*BLANK    WL0306  3
     C                     MOVEL*BLANK    WL0307 30
     C                     MOVEL*BLANK    WL0308  1
      * Define local variables for subroutine SWRVGN.
     C                     Z-ADD*ZERO     WL0309  30
     C                     MOVEL*BLANK    WL0310  4
     C                     Z-ADD*ZERO     WL0311  50
     C                     MOVEL*BLANK    WL0312  2
      * Define local variables for subroutine SYRVGN.
     C                     Z-ADD*ZERO     WL0313  30
     C                     MOVEL*BLANK    WL0314  4
     C                     Z-ADD*ZERO     WL0315  50
     C                     Z-ADD*ZERO     WL0316  50
     C                     Z-ADD*ZERO     WL0317  50
     C                     MOVEL*BLANK    WL0318 38
     C                     Z-ADD*ZERO     WL0319  80
     C                     Z-ADD*ZERO     WL0320  80
     C                     Z-ADD*ZERO     WL0321  80
     C                     Z-ADD*ZERO     WL0322  80
     C                     MOVEL*BLANK    WL0323  1
     C                     Z-ADD*ZERO     WL0324  70
     C                     Z-ADD*ZERO     WL0325  70
     C                     Z-ADD*ZERO     WL0326  70
      * Define local variables for subroutine SZRVGN.
     C                     Z-ADD*ZERO     WL0327  30
     C                     MOVEL*BLANK    WL0328  4
     C                     Z-ADD*ZERO     WL0329  50
     C                     Z-ADD*ZERO     WL0330  81
      * Define local variables for subroutine TBRVGN.
     C                     Z-ADD*ZERO     WL0331  30
     C                     MOVEL*BLANK    WL0332  4
     C                     Z-ADD*ZERO     WL0333  50
     C                     Z-ADD*ZERO     WL0334  50
     C                     Z-ADD*ZERO     WL0335  50
     C                     Z-ADD*ZERO     WL0336  80
     C                     Z-ADD*ZERO     WL0337  70
     C                     Z-ADD*ZERO     WL0338  70
     C                     MOVEL*BLANK    WL0339  2
     C                     Z-ADD*ZERO     WL0340  70
      * Define local variables for subroutine TCRVGN.
     C                     Z-ADD*ZERO     WL0341  30
     C                     MOVEL*BLANK    WL0342  4
     C                     Z-ADD*ZERO     WL0343  50
     C                     Z-ADD*ZERO     WL0344  50
     C                     Z-ADD*ZERO     WL0345  50
     C                     Z-ADD*ZERO     WL0346  70
     C                     Z-ADD*ZERO     WL0347  70
     C                     Z-ADD*ZERO     WL0348  40
     C                     Z-ADD*ZERO     WL0349  72
     C                     MOVEL*BLANK    WL0350  1
     C                     Z-ADD*ZERO     WL0351  80
     C                     Z-ADD*ZERO     WL0352  21
     C                     Z-ADD*ZERO     WL0353  80
     C                     Z-ADD*ZERO     WL0354  80
     C                     Z-ADD*ZERO     WL0355  80
     C                     MOVEL*BLANK    WL0356 38
     C                     Z-ADD*ZERO     WL0357  70
      * Define local variables for subroutine TDRVGN.
     C                     Z-ADD*ZERO     WL0358  30
     C                     MOVEL*BLANK    WL0359  4
     C                     Z-ADD*ZERO     WL0360  50
     C                     Z-ADD*ZERO     WL0361  50
     C                     Z-ADD*ZERO     WL0362  40
     C                     Z-ADD*ZERO     WL0363  70
      * Define local work field Order Type Print Status
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Type Code
     C                     MOVEL*BLANK    YL0002  2
      * Define local work field Update Exception Status
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Print Pre-Inv/Exception
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Departure Sts USR
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field System Value Numeric
     C                     Z-ADD*ZERO     YL0006 155
      * Define local work field Manual Prc Err Sts USR
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field Projected Market Price
     C                     Z-ADD*ZERO     YL0008 114
      * Define local work field Average Ship Wgt Err USR
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field InterCo Price Err USR
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field GTIN Error Sts USR
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field GTIN Error Item Code USR
     C                     Z-ADD*ZERO     YL0013  70
      * Define null work field Item Code USR
     C                     Z-ADD*ZERO     YN0001  70
      * Define null work field Item Code
     C                     Z-ADD*ZERO     YN0002  70
      * Define local work field Default Commod Mark basis
     C                     MOVEL*BLANK    YL0014  3
      * Define local work field Market Overage
     C                     Z-ADD*ZERO     YL0015 114
      * Define local work field Commodity Price Group
     C                     MOVEL*BLANK    YL0016  7
      * Define local work field Price Overage Override
     C                     Z-ADD*ZERO     YL0017 114
      * Define local work field D-EDI INV PROC FLAG
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0019  3
      * Define local work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    YL0020  1
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0021  1
      * Define local work field Company Number     041405
     C                     Z-ADD*ZERO     YL0022  30
      * Define local work field COA Bio-diesel Fuel Code
     C                     MOVEL*BLANK    YL0023  6
      * Define local work field COA Batch Production Date
     C                     Z-ADD*ZERO     YL0024  70
      * Define null work field COA Temperature Loadout
     C                     Z-ADD*ZERO     YN0003  30
      * Define local work field RFS Fuel Code
     C                     MOVEL*BLANK    YL0025  1
      * Define local work field COA BH RFS Version Nbr
     C                     MOVEL*BLANK    YL0026  1
      * Define local work field Item Code
     C                     Z-ADD*ZERO     YL0027  70
      * Define local work field HPB Meter Net Gallon
     C                     Z-ADD*ZERO     YL0028 112
      * Define local work field HPB Meter Start Gallon
     C                     Z-ADD*ZERO     YL0029  80
      * Define local work field HPB Meter Ending Gallon
     C                     Z-ADD*ZERO     YL0030  80
      * Define local work field HPB Meter Total Gallon
     C                     Z-ADD*ZERO     YL0031  80
      * Define local work field HPB Meter Net Weight
     C                     Z-ADD*ZERO     YL0032  80
      * Define local work field COA OMS Item Code
     C                     MOVEL*BLANK    YL0033  6
      * Define null work field COA Bio-dsl Fuel Cd Descr
     C                     MOVEL*BLANK    YN0004 30
      * Define null work field COA Sold From Address
     C                     MOVEL*BLANK    YN0005 40
      * Define local work field COA Sold From Name
     C                     MOVEL*BLANK    YL0034 40
      * Define local work field COA ULSD Company #
     C                     MOVEL*BLANK    YL0035  4
      * Define null work field COA Density Loadout
     C                     Z-ADD*ZERO     YN0006  75
      * Define null work field COA Density Reference
     C                     Z-ADD*ZERO     YN0007  75
      * Define null work field COA Temperature Ref
     C                     Z-ADD*ZERO     YN0008  30
      * Define null work field COA Sale Location
     C                     MOVEL*BLANK    YN0009 30
      * Define null work field COA Active Whse/Tank 1
     C                     MOVEL*BLANK    YN0010  3
      * Define null work field COA Active Whse/Tank 2
     C                     MOVEL*BLANK    YN0011  3
      * Define null work field COA Active Whse/Tank 3
     C                     MOVEL*BLANK    YN0012  3
      * Define null work field COA Active Whse/Tank 4
     C                     MOVEL*BLANK    YN0013  3
      * Define null work field COA Active Whse/Tank 5
     C                     MOVEL*BLANK    YN0014  3
      * Define null work field COA Active Whse/Tank 6
     C                     MOVEL*BLANK    YN0015  3
      * Define null work field COA RFS Renew Fuel Code
     C                     MOVEL*BLANK    YN0016  3
      * Define null work field COA RFS Rnwbl Feedstock
     C                     MOVEL*BLANK    YN0017  3
      * Define local work field Sold To Customer-hpb biod
     C                     Z-ADD*ZERO     YL0036  70
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0018  1
      * Define local work field Product Temperature
     C                     Z-ADD*ZERO     YL0037  52
      * Define local work field HPB Temperature Adjustmnt
     C                     Z-ADD*ZERO     YL0038  96
      * Define local work field RFS Loadout Temperature
     C                     Z-ADD*ZERO     YL0039  41
      * Define local work field RFS API Vol Corr Factor
     C                     Z-ADD*ZERO     YL0040  54
      * Define local work field COA Batch Header RIN
     C                     MOVEL*BLANK    YL0041 38
      * Define local work field COA RIN SSSSSSSS
     C                     Z-ADD*ZERO     YL0042  80
      * Define local work field COA RIN EEEEEEEE
     C                     Z-ADD*ZERO     YL0043  80
      * Define local work field COA RIN Volume in Gallons
     C                     Z-ADD*ZERO     YL0044  80
      * Define local work field COA Batch RIN Volume
     C                     Z-ADD*ZERO     YL0045  70
      * Define local work field COA RIN Quantity
     C                     Z-ADD*ZERO     YL0046  70
      * Define local work field USR Count
     C                     Z-ADD*ZERO     YL0047  30
      * Define local work field HPB Equivalence Value USR
     C                     Z-ADD*ZERO     YL0048  31
      * Define local work field USR Work Field 5A     USR
     C                     MOVEL*BLANK    YL0049  5
      * Define local work field HPB Meter Start Gallon
     C                     Z-ADD*ZERO     YL0050  80
      * Define local work field HPB Meter Ending Gallon
     C                     Z-ADD*ZERO     YL0051  80
      * Define local work field Generic Heading 8
     C                     MOVEL*BLANK    YL0052  8
      * Define local work field Generic Heading 9
     C                     MOVEL*BLANK    YL0053  8
      * Define local work field Year Code
     C                     Z-ADD*ZERO     YL0054  40
      * Define local work field Year Alpha (YYYY) USR
     C                     MOVEL*BLANK    YL0055  4
      * Define local work field COA Batch Header RIN
     C                     MOVEL*BLANK    YL0056 38
      * Define local work field Bill to Customer
     C                     Z-ADD*ZERO     YL0057  70
      * Define local work field Bill to Name
     C                     MOVEL*BLANK    YL0058 30
      * Define local work field OHE HPB RIN Equiv Value
     C                     Z-ADD*ZERO     YL0059 112
      * Define local work field OHE HPB RIN Price
     C                     Z-ADD*ZERO     YL0060 112
      * Define local work field OHE Override Type Code
     C                     MOVEL*BLANK    YL0061  2
      * Define local work field HPB Employer ID #
     C                     MOVEL*BLANK    YL0062 20
      * Define local work field HPB ULSD Company #
     C                     MOVEL*BLANK    YL0063  4
      * Define local work field HPB ULSD Facility ID
     C                     MOVEL*BLANK    YL0064  5
      * Define local work field Type Code
     C                     MOVEL*BLANK    YL0065  2
      * Define local work field COA GEN EMTS Sts
     C                     MOVEL*BLANK    YL0066  1
      * Define local work field COA RIN EMTS Sts
     C                     MOVEL*BLANK    YL0067  1
      * Define local work field COA BHR RIN Gen Year
     C                     Z-ADD*ZERO     YL0068  40
      * Define local work field Unit Price
     C                     Z-ADD*ZERO     YL0069 114
      * Define local work field COA BHR Gallon Price
     C                     Z-ADD*ZERO     YL0070  72
      * Define local work field COA Gallons Used
     C                     Z-ADD*ZERO     YL0071  70
      * Define local work field COA Batch RIN
     C                     MOVEL*BLANK    YL0072 38
      * Define local work field COA RIN SSSSSSSS
     C                     Z-ADD*ZERO     YL0073  80
      * Define local work field COA Batch Hdr RIN Seq Sec
     C                     Z-ADD*ZERO     YL0074  50
      * Define local work field COA RIN SoldFull/Splt Sts
     C                     MOVEL*BLANK    YL0075  1
      * Define local work field COA BHR RINs to Sell Sep
     C                     Z-ADD*ZERO     YL0076  70
      * Define local work field COA RIN Gallons Sold
     C                     Z-ADD*ZERO     YL0077  80
      * Define local work field COA EMTS Batch Nbr
     C                     Z-ADD*ZERO     YL0078  80
      * Define local work field RFS Transaction Type
     C                     MOVEL*BLANK    YL0079  3
      * Define local work field RFS Trans Reason Code
     C                     MOVEL*BLANK    YL0080  3
      * Define null work field RFS Trans Reason Desc
     C                     MOVEL*BLANK    YN0019 30
      * Define local work field COA BH Equiv Value f/SEP
     C                     MOVEL*BLANK    YL0081  2
      * Define local work field COA RIN Equivalence Valu#
     C                     Z-ADD*ZERO     YL0082  81
      * Define local work field COA BHR RIN Price
     C                     Z-ADD*ZERO     YL0083  72
      * Define local work field COA Batch Number
     C                     Z-ADD*ZERO     YL0084  50
      * Define local work field COA Batch Header RIN Seq
     C                     Z-ADD*ZERO     YL0085  50
      * Define local work field COA Batch Company Nbr
     C                     Z-ADD*ZERO     YL0086  70
      * Define local work field COA RIN Type Flag
     C                     MOVEL*BLANK    YL0087  1
      * Define local work field COA BHR Net Galls to Sell
     C                     Z-ADD*ZERO     YL0088  70
      * Define local work field COA BHR Loadout Temp
     C                     Z-ADD*ZERO     YL0089  70
      * Define local work field COA Batch RIN
     C                     MOVEL*BLANK    YL0090 38
      * Define local work field COA RIN SSSSSSSS  New usr
     C                     Z-ADD*ZERO     YL0091  80
      * Define local work field COA RIN EEEEEEEE  New usr
     C                     Z-ADD*ZERO     YL0092  80
      * Define local work field COA RIN Volume New usr
     C                     Z-ADD*ZERO     YL0093  80
      * Define local work field COA Batch RIN Volume new
     C                     Z-ADD*ZERO     YL0094  70
      * Define local work field COA RIN SoldFull/Splt Sts
     C                     MOVEL*BLANK    YL0095  1
      * Define local work field COA BHR RINs to Sell Sep
     C                     Z-ADD*ZERO     YL0096  70
      * Define local work field COA RIN Volume New usr
     C                     Z-ADD*ZERO     YL0097  80
      * Define local work field RIN Adjustment USR
     C                     Z-ADD*ZERO     YL0098  70
      * Define local work field Volume Needed         usr
     C                     Z-ADD*ZERO     YL0099  70
      * Define local work field AMOUNT
     C                     Z-ADD*ZERO     YL0100  82
      * Define local work field Decimal Places    usr
     C                     Z-ADD*ZERO     YL0101  22
      * Define local work field COA BOL Percent
     C                     Z-ADD*ZERO     YL0102  41
      * Define local work field COA GEN EMTS Date Sent
     C                     Z-ADD*ZERO     YL0103  70
      *================================================================
     CSR         ZZEXIT    ENDSR
