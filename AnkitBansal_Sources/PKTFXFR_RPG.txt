     H/TITLE Payment Producer Post  XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISRCENT
     H* Date          : 12/06/21  Time  : 11:17:50
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKC4REL1IF  E           K        DISK
      * RTV : Payment Processing Parms  Retrieval index
      *
     FPLADCPL0IF  E           K        DISK
      * RTV : Delivery Sched Header     Retrieval index
      *
     FPLAECPL0IF  E           K        DISK
      * RTV : Delivery Sched Detail     Retrieval index
      *
     FPKFJCPL3IF  E           K        DISK
      * RSQ : Tattoo Pending            Co/Dte-d/Tto Pending
      *
     FPKC4REL0UF  E           K        DISK
      * UPD : Payment Processing Parms  Update index
      *
     FPLAECPL1UF  E           K        DISK
      * UPD : Delivery Sched Detail     Update index
      *
     FPLADCPL1UF  E           K        DISK
      * UPD : Delivery Sched Header     Update index
      *
     FPKFJCPL0UF  E           K        DISK
      * UPD : Tattoo Pending            Update index
      *
      * Long constants
     E                    @CN#    1  33  6   @CN    25
     I@C4REO7
      * Payment Processing Parms  Retrieval index
      * Renamed input format fields
     I              C4HONB                          WAHONB
     I              C4CKDT                          WACKDT
     I              C4M1NB                          WAM1NB
     I              C4KHST                          WAKHST
     I              C4KJST                          WAKJST
     I              C4PINB                          WAPINB
     I              C4KKST                          WAKKST
     I              C4AAVN                          WAAAVN
     I              C4AADT                          WAAADT
     I              C4AMTM                          WAAMTM
     I              C4AJST                          WAAJST
     I              C4AHVN                          WAAHVN
     I              C4AGVN                          WAAGVN
     I              C4ABVN                          WAABVN
     I              C4ABDT                          WAABDT
     I              C4ABTM                          WAABTM
      *
     I@C4REO6
      * Payment Processing Parms  Update index
      * Renamed input format fields
     I              C4HONB                          WBHONB
     I              C4CKDT                          WBCKDT
     I              C4M1NB                          WBM1NB
     I              C4KHST                          WBKHST
     I              C4KJST                          WBKJST
     I              C4PINB                          WBPINB
     I              C4KKST                          WBKKST
     I              C4AAVN                          WBAAVN
     I              C4AADT                          WBAADT
     I              C4AMTM                          WBAMTM
     I              C4AJST                          WBAJST
     I              C4AHVN                          WBAHVN
     I              C4AGVN                          WBAGVN
     I              C4ABVN                          WBABVN
     I              C4ABDT                          WBABDT
     I              C4ABTM                          WBABTM
      *
     I@ADCPID
      * Delivery Sched Header     Retrieval index
      * Renamed input format fields
     I              ADHONB                          WCHONB
     I              ADE0DT                          WCE0DT
     I              ADHYA1                          WCHYA1
     I              ADINA1                          WCINA1
     I              ADWXST                          WCWXST
     I              ADE1DT                          WCE1DT
     I              ADBLTM                          WCBLTM
     I              ADE2DT                          WCE2DT
     I              ADBMTM                          WCBMTM
     I              ADE3DT                          WCE3DT
     I              ADBNTM                          WCBNTM
     I              ADXDST                          WCXDST
     I              ADE4DT                          WCE4DT
     I              ADBOTM                          WCBOTM
     I              ADXEST                          WCXEST
     I              ADE5DT                          WCE5DT
     I              ADBPTM                          WCBPTM
     I              ADAAVN                          WCAAVN
     I              ADAADT                          WCAADT
     I              ADAMTM                          WCAMTM
     I              ADAJST                          WCAJST
     I              ADAHVN                          WCAHVN
     I              ADAGVN                          WCAGVN
     I              ADABVN                          WCABVN
     I              ADABDT                          WCABDT
     I              ADABTM                          WCABTM
      *
     I@AECPIG
      * Delivery Sched Detail     Retrieval index
      * Renamed input format fields
     I              AEHONB                          WDHONB
     I              AEE0DT                          WDE0DT
     I              AEE6DT                          WDE6DT
     I              AEAGTH                          WDAGTH
     I              AEHZA1                          WDHZA1
     I              AEH0A1                          WDH0A1
     I              AEH1A1                          WDH1A1
     I              AEJ4CD                          WDJ4CD
     I              AEJ5CD                          WDJ5CD
     I              AELBCD                          WDLBCD
     I              AELCCD                          WDLCCD
     I              AEIOA1                          WDIOA1
     I              AEH2A1                          WDH2A1
     I              AEIJA1                          WDIJA1
     I              AEK9CD                          WDK9CD
     I              AEK8CD                          WDK8CD
     I              AEJ6CD                          WDJ6CD
     I              AEJ7CD                          WDJ7CD
     I              AEMGCD                          WDMGCD
     I              AEW1ST                          WDW1ST
     I              AEW2ST                          WDW2ST
     I              AEH3A1                          WDH3A1
     I              AEMECD                          WDMECD
     I              AEMFCD                          WDMFCD
     I              AEW4ST                          WDW4ST
     I              AEXWST                          WDXWST
     I              AEFRDT                          WDFRDT
     I              AEBOTH                          WDBOTH
     I              AEE7DT                          WDE7DT
     I              AEAHTH                          WDAHTH
     I              AEE8DT                          WDE8DT
     I              AEAITH                          WDAITH
     I              AEXBST                          WDXBST
     I              AEXGST                          WDXGST
     I              AEXPST                          WDXPST
     I              AEXNST                          WDXNST
     I              AEXTST                          WDXTST
     I              AEXLST                          WDXLST
     I              AEW0ST                          WDW0ST
     I              AEYEST                          WDYEST
     I              AEFZDT                          WDFZDT
     I              AEB1TH                          WDB1TH
     I              AEAACD                          WDAACD
     I              AEABCD                          WDABCD
     I              AEAECD                          WDAECD
     I              AEHMNB                          WDHMNB
     I              AEBNNB                          WDBNNB
     I              AEBONB                          WDBONB
     I              AEY0A1                          WDY0A1
     I              AEY1A1                          WDY1A1
     I              AEDGT1                          WDDGT1
     I              AEDHT1                          WDDHT1
     I              AEIISS                          WDIISS
     I              AEAAVN                          WDAAVN
     I              AEAADT                          WDAADT
     I              AEAMTM                          WDAMTM
     I              AEAJST                          WDAJST
     I              AEAHVN                          WDAHVN
     I              AEAGVN                          WDAGVN
     I              AEABVN                          WDABVN
     I              AEABDT                          WDABDT
     I              AEABTM                          WDABTM
      *
     I@AECPIH
      * Delivery Sched Detail     Update index
      * Renamed input format fields
     I              AEHONB                          WEHONB
     I              AEE0DT                          WEE0DT
     I              AEE6DT                          WEE6DT
     I              AEAGTH                          WEAGTH
     I              AEHZA1                          WEHZA1
     I              AEH0A1                          WEH0A1
     I              AEH1A1                          WEH1A1
     I              AEJ4CD                          WEJ4CD
     I              AEJ5CD                          WEJ5CD
     I              AELBCD                          WELBCD
     I              AELCCD                          WELCCD
     I              AEIOA1                          WEIOA1
     I              AEH2A1                          WEH2A1
     I              AEIJA1                          WEIJA1
     I              AEK9CD                          WEK9CD
     I              AEK8CD                          WEK8CD
     I              AEJ6CD                          WEJ6CD
     I              AEJ7CD                          WEJ7CD
     I              AEMGCD                          WEMGCD
     I              AEW1ST                          WEW1ST
     I              AEW2ST                          WEW2ST
     I              AEH3A1                          WEH3A1
     I              AEMECD                          WEMECD
     I              AEMFCD                          WEMFCD
     I              AEW4ST                          WEW4ST
     I              AEXWST                          WEXWST
     I              AEFRDT                          WEFRDT
     I              AEBOTH                          WEBOTH
     I              AEE7DT                          WEE7DT
     I              AEAHTH                          WEAHTH
     I              AEE8DT                          WEE8DT
     I              AEAITH                          WEAITH
     I              AEXBST                          WEXBST
     I              AEXGST                          WEXGST
     I              AEXPST                          WEXPST
     I              AEXNST                          WEXNST
     I              AEXTST                          WEXTST
     I              AEXLST                          WEXLST
     I              AEW0ST                          WEW0ST
     I              AEYEST                          WEYEST
     I              AEFZDT                          WEFZDT
     I              AEB1TH                          WEB1TH
     I              AEAACD                          WEAACD
     I              AEABCD                          WEABCD
     I              AEAECD                          WEAECD
     I              AEHMNB                          WEHMNB
     I              AEBNNB                          WEBNNB
     I              AEBONB                          WEBONB
     I              AEY0A1                          WEY0A1
     I              AEY1A1                          WEY1A1
     I              AEDGT1                          WEDGT1
     I              AEDHT1                          WEDHT1
     I              AEIISS                          WEIISS
     I              AEAAVN                          WEAAVN
     I              AEAADT                          WEAADT
     I              AEAMTM                          WEAMTM
     I              AEAJST                          WEAJST
     I              AEAHVN                          WEAHVN
     I              AEAGVN                          WEAGVN
     I              AEABVN                          WEABVN
     I              AEABDT                          WEABDT
     I              AEABTM                          WEABTM
      *
     I@ADCPIE
      * Delivery Sched Header     Update index
      * Renamed input format fields
     I              ADHONB                          WFHONB
     I              ADE0DT                          WFE0DT
     I              ADHYA1                          WFHYA1
     I              ADINA1                          WFINA1
     I              ADWXST                          WFWXST
     I              ADE1DT                          WFE1DT
     I              ADBLTM                          WFBLTM
     I              ADE2DT                          WFE2DT
     I              ADBMTM                          WFBMTM
     I              ADE3DT                          WFE3DT
     I              ADBNTM                          WFBNTM
     I              ADXDST                          WFXDST
     I              ADE4DT                          WFE4DT
     I              ADBOTM                          WFBOTM
     I              ADXEST                          WFXEST
     I              ADE5DT                          WFE5DT
     I              ADBPTM                          WFBPTM
     I              ADAAVN                          WFAAVN
     I              ADAADT                          WFAADT
     I              ADAMTM                          WFAMTM
     I              ADAJST                          WFAJST
     I              ADAHVN                          WFAHVN
     I              ADAGVN                          WFAGVN
     I              ADABVN                          WFABVN
     I              ADABDT                          WFABDT
     I              ADABTM                          WFABTM
      *
     I@FJCPJN
      * Tattoo Pending            Co/Dte-d/Tto Pending
      * Renamed input format fields
     I              FJHONB                          WGHONB
     I              FJEZDT                          WGEZDT
     I              FJHSA1                          WGHSA1
     I              FJHMNB                          WGHMNB
     I              FJBNNB                          WGBNNB
     I              FJBONB                          WGBONB
     I              FJHRA1                          WGHRA1
     I              FJBKTM                          WGBKTM
     I              FJWPST                          WGWPST
     I              FJWQST                          WGWQST
     I              FJMIA1                          WGMIA1
     I              FJAAVN                          WGAAVN
     I              FJAADT                          WGAADT
     I              FJAMTM                          WGAMTM
     I              FJAJST                          WGAJST
     I              FJAHVN                          WGAHVN
     I              FJAGVN                          WGAGVN
     I              FJABVN                          WGABVN
     I              FJABDT                          WGABDT
     I              FJABTM                          WGABTM
      *
     I@FJCPHV
      * Tattoo Pending            Update index
      * Renamed input format fields
     I              FJHONB                          WHHONB
     I              FJEZDT                          WHEZDT
     I              FJHSA1                          WHHSA1
     I              FJHMNB                          WHHMNB
     I              FJBNNB                          WHBNNB
     I              FJBONB                          WHBONB
     I              FJHRA1                          WHHRA1
     I              FJBKTM                          WHBKTM
     I              FJWPST                          WHWPST
     I              FJWQST                          WHWQST
     I              FJMIA1                          WHMIA1
     I              FJAAVN                          WHAAVN
     I              FJAADT                          WHAADT
     I              FJAMTM                          WHAMTM
     I              FJAJST                          WHAJST
     I              FJAHVN                          WHAHVN
     I              FJAGVN                          WHAGVN
     I              FJABVN                          WHABVN
     I              FJABDT                          WHABDT
     I              FJABTM                          WHABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IQPKC41    E DSPKC4REL0
      * UPD : Payment Processing Parms  Update index
      * Renamed input format fields
     I              C4HONB                          WBHONB
     I              C4CKDT                          WBCKDT
     I              C4M1NB                          WBM1NB
     I              C4KHST                          WBKHST
     I              C4KJST                          WBKJST
     I              C4PINB                          WBPINB
     I              C4KKST                          WBKKST
     I              C4AAVN                          WBAAVN
     I              C4AADT                          WBAADT
     I              C4AMTM                          WBAMTM
     I              C4AJST                          WBAJST
     I              C4AHVN                          WBAHVN
     I              C4AGVN                          WBAGVN
     I              C4ABVN                          WBABVN
     I              C4ABDT                          WBABDT
     I              C4ABTM                          WBABTM
      *
     IYARDCS      DS                             72
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      * Outward parameters
     IPARC        DS                             21
      * KEY : Tattoo Header             Co/Prd/Loc/KlDte/Tto/Unp
      * I : RST BOH Company Number
     I                                    P   1   20PAHMNB
      * I : MAP TH Kill Date
     I                                    P  15  180PAB0DT
      *
      * Outward parameters
     IPBRC        DS                             22
      * KEY : Tattoo Header             Co/Prd/Bol/Tto, Unpd Com
      * I : RST BOH Company Number
     I                                    P   1   20PBHMNB
      * I : MAP TH Kill Date
     I                                    P  16  190PBB0DT
      *
      * Outward parameters
     IPCRC        DS                             11
      * KEY : Tattoo Header             Co/kD/SRT/Pt/Tto *all*
      * I : RST BOH Company Number
     I                                    P   1   20PCHMNB
      * I : RST TH Kill Date
     I                                    P   3   60PCB0DT
      *
      * Outward parameters
     IPDRC        DS                             11
      * KEY : Tattoo Header             Co/kD/SRT/Pt/Tto *all*
      * I : RST BOH Company Number
     I                                    P   1   20PDHMNB
      * I : RST TH Kill Date
     I                                    P   3   60PDB0DT
      *
      * Outward parameters
     IPERC        DS                              9
      * KEY : Tattoo Header             Co/Kill/Tattoo Active
      * I : RST BOH Company Number
     I                                    P   1   20PEHMNB
      * I : RST TH Kill Date
     I                                    P   3   60PEB0DT
      *
     IQPLAE1    E DSPLAECPL1
      * UPD : Delivery Sched Detail     Update index
      * Renamed input format fields
     I              AEHONB                          WEHONB
     I              AEE0DT                          WEE0DT
     I              AEE6DT                          WEE6DT
     I              AEAGTH                          WEAGTH
     I              AEHZA1                          WEHZA1
     I              AEH0A1                          WEH0A1
     I              AEH1A1                          WEH1A1
     I              AEJ4CD                          WEJ4CD
     I              AEJ5CD                          WEJ5CD
     I              AELBCD                          WELBCD
     I              AELCCD                          WELCCD
     I              AEIOA1                          WEIOA1
     I              AEH2A1                          WEH2A1
     I              AEIJA1                          WEIJA1
     I              AEK9CD                          WEK9CD
     I              AEK8CD                          WEK8CD
     I              AEJ6CD                          WEJ6CD
     I              AEJ7CD                          WEJ7CD
     I              AEMGCD                          WEMGCD
     I              AEW1ST                          WEW1ST
     I              AEW2ST                          WEW2ST
     I              AEH3A1                          WEH3A1
     I              AEMECD                          WEMECD
     I              AEMFCD                          WEMFCD
     I              AEW4ST                          WEW4ST
     I              AEXWST                          WEXWST
     I              AEFRDT                          WEFRDT
     I              AEBOTH                          WEBOTH
     I              AEE7DT                          WEE7DT
     I              AEAHTH                          WEAHTH
     I              AEE8DT                          WEE8DT
     I              AEAITH                          WEAITH
     I              AEXBST                          WEXBST
     I              AEXGST                          WEXGST
     I              AEXPST                          WEXPST
     I              AEXNST                          WEXNST
     I              AEXTST                          WEXTST
     I              AEXLST                          WEXLST
     I              AEW0ST                          WEW0ST
     I              AEYEST                          WEYEST
     I              AEFZDT                          WEFZDT
     I              AEB1TH                          WEB1TH
     I              AEAACD                          WEAACD
     I              AEABCD                          WEABCD
     I              AEAECD                          WEAECD
     I              AEHMNB                          WEHMNB
     I              AEBNNB                          WEBNNB
     I              AEBONB                          WEBONB
     I              AEY0A1                          WEY0A1
     I              AEY1A1                          WEY1A1
     I              AEDGT1                          WEDGT1
     I              AEDHT1                          WEDHT1
     I              AEIISS                          WEIISS
     I              AEAAVN                          WEAAVN
     I              AEAADT                          WEAADT
     I              AEAMTM                          WEAMTM
     I              AEAJST                          WEAJST
     I              AEAHVN                          WEAHVN
     I              AEAGVN                          WEAGVN
     I              AEABVN                          WEABVN
     I              AEABDT                          WEABDT
     I              AEABTM                          WEABTM
      *
     IYBRDCS      DS                            275
     IQPLAD1    E DSPLADCPL1
      * UPD : Delivery Sched Header     Update index
      * Renamed input format fields
     I              ADHONB                          WFHONB
     I              ADE0DT                          WFE0DT
     I              ADHYA1                          WFHYA1
     I              ADINA1                          WFINA1
     I              ADWXST                          WFWXST
     I              ADE1DT                          WFE1DT
     I              ADBLTM                          WFBLTM
     I              ADE2DT                          WFE2DT
     I              ADBMTM                          WFBMTM
     I              ADE3DT                          WFE3DT
     I              ADBNTM                          WFBNTM
     I              ADXDST                          WFXDST
     I              ADE4DT                          WFE4DT
     I              ADBOTM                          WFBOTM
     I              ADXEST                          WFXEST
     I              ADE5DT                          WFE5DT
     I              ADBPTM                          WFBPTM
     I              ADAAVN                          WFAAVN
     I              ADAADT                          WFAADT
     I              ADAMTM                          WFAMTM
     I              ADAJST                          WFAJST
     I              ADAHVN                          WFAHVN
     I              ADAGVN                          WFAGVN
     I              ADABVN                          WFABVN
     I              ADABDT                          WFABDT
     I              ADABTM                          WFABTM
      *
     IYCRDCS      DS                            108
     IYDRDCS      DS                             72
     IYERDCS      DS                             72
     IQPKFJ1    E DSPKFJCPL0
      * UPD : Tattoo Pending            Update index
      * Renamed input format fields
     I              FJHONB                          WHHONB
     I              FJEZDT                          WHEZDT
     I              FJHSA1                          WHHSA1
     I              FJHMNB                          WHHMNB
     I              FJBNNB                          WHBNNB
     I              FJBONB                          WHBONB
     I              FJHRA1                          WHHRA1
     I              FJBKTM                          WHBKTM
     I              FJWPST                          WHWPST
     I              FJWQST                          WHWQST
     I              FJMIA1                          WHMIA1
     I              FJAAVN                          WHAAVN
     I              FJAADT                          WHAADT
     I              FJAMTM                          WHAMTM
     I              FJAJST                          WHAJST
     I              FJAHVN                          WHAHVN
     I              FJAGVN                          WHAGVN
     I              FJABVN                          WHABVN
     I              FJABDT                          WHABDT
     I              FJABTM                          WHABTM
      *
     IYFRDCS      DS                             72
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Payment Processing Parms
      * I :  CC Company Number
     I                                    P   1   20P1HONB
     IP2PARM      DS
      * I : MAP Oms System Value Alpha
     I                                        1  40 P2EVTX
     IP3PARM      DS
      * FLD: *Arrays
      * I :  PRT Printer Device
     I                                        1  10 P3ACVN
      * I :  PRT Hold Output Sts
     I                                       11  14 P3AKST
      * I :  PRT Save Output Sts
     I                                       15  18 P3AMST
      * I :  PRT Copies
     I                                       19  200P3AKNB
     IP4PARM      DS
      * N :  Current Time
     I                                        1   60P4A1TM
      * Submit job processing data structures.
     I#SRQS       DS                           3000
     I                                        1   1 #SDMY1
     I#SSTR       DS                           3000
     I                                        1   1 #SDMY2
     I#SWRK       DS                           3000
     I                                        1   1 #SDMY3
     I#SMRG       DS                            256
     I                                        1   1 #SDMY4
     I            DS
     I I            'CMD(CALL PGM('           1  13 #SCLL
     I I            'PARM('                  14  18 #SPRM
     I I            ')'                      19  19 #SPRN
     I I            '          '             20  29 #SPRG
      * Submit job command strings.
     I            DS
     I I            'SBMJOB     JOB(EVERP-    1 256 #S0001
     I              'UPLOD) LOG(4 00 *SEC-
     I              'LVL) HOLD(*JOBD)    '
     I            DS
     I I            'SBMJOB     JOB(HPEED-    1 256 #S0002
     I              'IFTP) JOBQ(QGPL/PORK-
     I              'FTPQ) LOG(4 00 *SECL-
     I              'VL)                 '
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Post: HPE Payment Strt'
      * Pmt Current Payment Date
     I                                    P   1   40ZA0001
      * Current Time
     I                                    P   5   80ZA0002
      * CC Company Number
     I                                    P   9  100ZA0003
      * Message data for 'Post: Crt Eval TrnUpl ERP'
      * Pmt Current Payment Date
     I                                    P   1   40ZA0004
      * Current Time
     I                                    P   5   80ZA0005
      * CC Company Number
     I                                    P   9  100ZA0006
      * Message data for 'Post: HPE Payment Cmpl'
      * Pmt Current Payment Date
     I                                    P   1   40ZA0007
      * Current Time
     I                                    P   5   80ZA0008
      * CC Company Number
     I                                    P   9  100ZA0009
      * Message data for 'SBM Prt Crc Dtl/Sum'
      * Oms System Value Alpha
     I                                        1  40 ZA0010
      * PRT Printer Device
     I                                       41  50 ZA0011
      * PRT Hold Output Sts
     I                                       51  54 ZA0012
      * PRT Save Output Sts
     I                                       55  58 ZA0013
      * PRT Copies
     I                                    P  59  600ZA0014
      * Message data for 'SBM Fax Crc Dtl/Sum'
      * Post or Select Rpts   USR
     I                                        1   1 ZA0015
      * Print Carcass Analysis Us
     I                                        2   2 ZA0016
      * Status 3
     I                                        3   3 ZA0017
      * Oms System Value Alpha
     I                                        4  43 ZA0018
      * Message data for 'Post: Prt CS/CD Sbm'
      * Pmt Current Payment Date
     I                                    P   1   40ZA0019
      * Current Time
     I                                    P   5   80ZA0020
      * CC Company Number
     I                                    P   9  100ZA0021
      * Message data for 'Exec Sequel M3 Intercomp'
      * Date Alpha USR
     I                                        1   7 ZA0022
      * EMail Address
     I                                        8  57 ZA0023
      * Message data for 'SBM TF2 Payment Push'
      * PRT Printer Device
     I                                        1  10 ZA0024
      * PRT Hold Output Sts
     I                                       11  14 ZA0025
      * PRT Save Output Sts
     I                                       15  18 ZA0026
      * PRT Copies
     I                                    P  19  200ZA0027
      * PRT Night Queue
     I                                       21  30 ZA0028
      * BOH Company Number
     I                                    P  31  320ZA0029
      * Oms System Value Alpha
     I                                       33  72 ZA0030
      * Push Type
     I                                       73  73 ZA0031
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HONB    PARM           WP0001  30       CC Company Numb
     C           P2EVTX    PARM           WP0002 40        Oms System Valu
     C           P3ACVN    PARM           WP0003 10        PRT Printer Dev
     C           P3AKST    PARM           WP0004  4        PRT Hold Output
     C           P3AMST    PARM           WP0005  4        PRT Save Output
     C           P3AKNB    PARM           WP0006  20       PRT Copies
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Payment Producer Post  XF
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * Rtv Payment Processing RT - Payment Processing Parms  * 
     C                     EXSR SARVGN
     C                     MOVEL@CN,001   YL0001           Office Dist Lis
      * 1/17/2008 SLM ADD DUE TO THE FACT THAT MPLUS COULD NOT
      * SEND A COMPLETED MESSAGE DUE TO COMPLETED MESSAGES DO NOT
      * GO TO QSYSOPR. THEY GO TO THE USER
      * Added the HPEPAYCMP in company value to get
      * the distro list for the completed job message that we build
      * this is the last message only.  all other message
      * PRKHPPST - will be for guymon
      * TFHPEPAYP - will be for stjoe
      * Get the distro list for Office Dist List USR2
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0001  30       BOH Company Num
     C                     PARM @CN,002   WQ0002 10        Company Value C
     C           YL0002    PARM *BLANK    WQ0003 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Step 6, 7, & Roll Kill Date
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.PP Payment Error is No Errors
      *   |- c2    : WRK.PP Commission Paym Error is No Errors
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUKJST    IFEQ 'N'                        *IF
     C           WUKHST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Step 6: Payment Post
     C                     EXSR UDSUBR                     Step 6: Payment
      * Step 7:  Reports, sbm carcass sheets prt/fax and also EDI
      * CASE: WRK.Pmt Current Payment Step is 00007 Carcass Summary
     C           WUM1NB    IFEQ 00007                      *IF
      * Carcass summary, carcass detail, & additional processing
     C                     EXSR UESUBR                     Carcass summary
     C                     Z-ADD*ZERO     P4A1TM           Current Time
      * Current Time
      * Rtv Current Time      US - STR User Source Functions  * 
     C                     TIME           P4A1TM
      * Setup message data for message
      * Convert Pmt Current Payment Date to display format
      * Convert date
     C           1000000   ADD  WUCKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0019
     C                     Z-ADDP4A1TM    ZA0020           Current Time
     C                     Z-ADDP1HONB    ZA0021           CC Company Numb
      * Retrieve message Post: Prt CS/CD Sbm
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0792' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           WUKGTX    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Snd Pager Msg (MPLUS) UP - STR Order Management Sys  * 
     C                     CALL 'POMSUPC'              90  Snd Pager Msg (
     C                     PARM YL0001    WQ0045 10        Office Dist Lis
     C                     PARM WUKGTX    WQ0046132        Office Dist Mes
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMSUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Sequel M3 voucher data created
     C                     MOVEL*BLANK    YL0013           Date Alpha USR
     C                     MOVEL##JDT     YL0013           Date Alpha USR
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0047  30       BOH Company Num
     C                     PARM @CN,030   WQ0048 10        Company Value C
     C           YL0014    PARM *BLANK    WQ0049 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.Live with M3   USR is No
     C           YL0014    IFEQ 'N'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0050  30       BOH Company Num
     C                     PARM @CN,031   WQ0051 10        Company Value C
     C           YL0015    PARM *BLANK    WQ0052 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0053  30       BOH Company Num
     C                     PARM @CN,032   WQ0054 10        Company Value C
     C           YL0016    PARM *BLANK    WQ0055 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.CC Company Number is SBD Farms of Guymon, Ok
     C           P1HONB    IFEQ 360                        *IF
      * Setup message data for message
     C                     MOVELYL0013    ZA0022           Date Alpha USR
     C                     MOVELYL0015    ZA0023           EMail Address
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1431' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
     C                     END                             *FI
     C                     END                             *FI
      * Moved to Step 7 due to user running payment post twice
      * R10169 JJH 07/10/17 - New Logic for 360, 960, 961, and 440
      * R10169 JJH 08/22/17 - Temporarily disable the SBMJOB to PRKFTPQ
      * CASE: JOB.*USER is PorkISTesting
     C           ##USR     IFEQ @CN,003                    *IF
     C           ##USR     OREQ @CN,004
     C           ##USR     OREQ @CN,005
     C           ##USR     OREQ @CN,006
     C           ##USR     OREQ @CN,007
     C           ##USR     OREQ @CN,008
     C           ##USR     OREQ @CN,009
     C           ##USR     OREQ @CN,010
     C           ##USR     OREQ @CN,011
     C           ##USR     OREQ @CN,012
     C           ##USR     OREQ @CN,013
     C           ##USR     OREQ @CN,014
     C           ##USR     OREQ @CN,015
     C           ##USR     OREQ @CN,016
     C           ##USR     OREQ @CN,017
     C           ##USR     OREQ @CN,018
     C           ##USR     OREQ @CN,019
     C           ##USR     OREQ @CN,020
     C           ##USR     OREQ @CN,021
     C           ##USR     OREQ @CN,022
     C           ##USR     OREQ @CN,023
     C           ##USR     OREQ @CN,024
     C           ##USR     OREQ @CN,025
     C           ##USR     OREQ @CN,026
     C           ##USR     OREQ @CN,027
     C           ##USR     OREQ @CN,028
      * RMC 5/20/21  ADDED THIS CHECK
     C                     ELSE
      * CASE: *OTHERWISE
      * SBMJOB: Crt EDI Carcass Sum/DtXF - EDI Carcass Summary  * 
      *
     C                     MOVEL*BLANK    W0RTN
      * Build call string for processing in batch.
     C                     MOVEL#S0002    #SRQS     P
     C           #SRQS     CAT  #SCLL:1   #SRQS            Call command
     C                     MOVEL'PWEHXFR '#SPRG     P      Load pgm name
     C           #SRQS     CAT  #SPRG:0   #SRQS            Add pgm name
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
      * Build parameters string.
     C           #SRQS     CAT  #SPRM:1   #SRQS            Parameters
      *
     C                     MOVELW0RTN     #SSTR     P      *Return code
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 7         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADDP1HONB    #SPAK  309       CC Company Numb
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADDWUCKDT    #SPAK  309       Pmt Current Pay
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 7         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *
     C           W0RTN     IFNE *BLANK
      * Build of submit job string ended in error.
     C                     MOVEL'Y2U0065' W0RTN
     C                     MOVEL'PWEHXFR 'W0CLPG 10 P
      * Send message '*Error occured on SBMJOB'
     C                     MOVEL'Y2U0065' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     ELSE
      *
     C           W0SJO     IFNE *BLANK
      * Merge variable submit job overrides.
     C                     CALL 'Y2MGRQR'              90  *
     C                     PARM #SRQS     #SWRK
     C                     PARM W0SJO     #SMRG
     C  N90                MOVEL#SWRK     #SRQS     P
     C                     MOVE *BLANK    W0SJO
     C                     END
      * Submit request.
     C                     CALL 'Y2CMEXC'              90  *
     C                     PARM           #SRQS
     C                     PARM 3000      #SRQL  155
     C                     PARM           W0JVN  10
     C                     PARM           W0JUN  10
     C                     PARM           W0JNB   6
     C                     END
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWEHXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Roll dates for 360 & 960 and purge the tattoo pending for 960 onl
      * For 960, go back 2 kill days to purge pending unused tattoos
      * CASE: PAR.CC Company Number is SBD Farms of Guymon, Ok
     C           P1HONB    IFEQ 360                        *IF
      * Del Unused Tattoo #   RT - Tattoo Pending  * 
     C                     EXSR SIRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Prev Kill Date    XF - STR Order Management Sys  * 
     C                     CALL 'PDRUXFR'              90  Rtv Prev Kill D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0056  30       BOH Company Num
     C                     PARM WUCKDT    WQ0057  70       Cut Date
     C           WUB5DT    PARM *ZERO     WQ0058  70       Date USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDRUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Prev Kill Date    XF - STR Order Management Sys  * 
     C                     CALL 'PDRUXFR'              90  Rtv Prev Kill D
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0059  30       BOH Company Num
     C                     PARM WUB5DT    WQ0060  70       Cut Date
     C           WUB5DT    PARM *ZERO     WQ0061  70       Date USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDRUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Del Unused Tattoo #   RT - Tattoo Pending  * 
     C                     EXSR SKRVGN
     C                     END                             *FI
     C                     END                             *FI
      * End Of Job:  Roll Kill Date    99999 Normal EOJ
      * CASE: WRK.Pmt Current Payment Step is 99999 Normal EOJ
     C           WUM1NB    IFEQ 99999                      *IF
      * Step End of Job update payment date and step
     C                     EXSR UFSUBR                     Step End of Job
      *  9/08/2017 JBB E9904 - Payment Push from 440 to 961
      * Rtv Company Value Nbr XF - STR Order Management Sys  * HPEPSHTOCO
     C                     CALL 'PDHGXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0065  30       BOH Company Num
     C                     PARM @CN,033   WQ0066 10        Company Value C
     C           YL0017    PARM *ZERO     WQ0067 155       System Value Nu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHGXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * If Push To Company found, submit the Payment Push process
      * CASE: LCL.Push To Company is Greater Then *zero
     C           YL0017    IFGT *ZERO                      *IF
     C                     Z-ADDP3AKNB    YL0018           Number 1 USR
      * Setup message data for message
     C                     MOVELP3ACVN    ZA0024           PRT Printer Dev
     C                     MOVELP3AKST    ZA0025           PRT Hold Output
     C                     MOVELP3AMST    ZA0026           PRT Save Output
     C                     Z-ADDYL0018    ZA0027           Number 1 USR
     C                     MOVEL'*JOBD'   ZA0028           PRT Night Queue
     C                     Z-ADDP1HONB    ZA0029           CC Company Numb
     C                     MOVELP2EVTX    ZA0030           Oms System Valu
     C                     MOVEL'A'       ZA0031           Push Type
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1459' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Payment Processing RT - Payment Processing Parms  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAHONB           CC Company Numb
      * Setup key
     C                     Z-ADDP1HONB    WAHONB           CC Company Numb
      * Establish starting position
     C           KRSSA     CHAIN@C4REO7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0434' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUCKDT           Pmt Current Pay
     C                     Z-ADD*ZERO     WUM1NB           Pmt Current Pay
     C                     MOVEL*BLANK    WUKHST           PP Commission P
     C                     MOVEL*BLANK    WUKJST           PP Payment Erro
     C                     Z-ADD*ZERO     WUPINB           PP Unused Nbr 1
     C                     MOVEL*BLANK    WUKKST           PP Repayment St
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWACKDT    WUCKDT           Pmt Current Pay
     C                     Z-ADDWAM1NB    WUM1NB           Pmt Current Pay
     C                     MOVELWAKHST    WUKHST           PP Commission P
     C                     MOVELWAKJST    WUKJST           PP Payment Erro
     C                     Z-ADDWAPINB    WUPINB           PP Unused Nbr 1
     C                     MOVELWAKKST    WUKKST           PP Repayment St
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCHRC    BEGSR
      *================================================================
      * Upd Paymnt Prc         CH - Payment Processing Parms  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       Pmt Current Pay
     C                     MOVEL*BLANK    WN0002 10        RS User Changed
     C                     Z-ADD*ZERO     WN0003  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0004  60       RS Time Changed
     C                     MOVEL*BLANK    WN0005  1        RS Record Statu
     C                     MOVEL*BLANK    WN0006 10        RS Job
     C                     MOVEL*BLANK    WN0007 10        RS Program
     C                     MOVEL*BLANK    WN0008 10        RS User Added
     C                     Z-ADD*ZERO     WN0009  70       RS Date Added
     C                     Z-ADD*ZERO     WN0010  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WN0002           RS User Changed
     C                     Z-ADD##JDT     WN0003           RS Date Changed
     C                     Z-ADD##JTM     WN0004           RS Time Changed
     C                     MOVEL##JOB     WN0006           RS Job
     C                     MOVEL##PGM     WN0007           RS Program
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @C4REO6
     C                     Z-ADDP1HONB    WBHONB           CC Company Numb
      *
     C           KLCHSB    KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C           KLCHSB    CHAIN@C4REO6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKC4REL0'MDACP
     C                     MOVEL'@C4REO6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKC41    YARDCS
      * Move non-key fields to @C4REO6
     C                     Z-ADDWUM1NB    WBM1NB           Pmt Current Pay
     C                     MOVELWUKHST    WBKHST    P      PP Commission P
     C                     MOVELWUKJST    WBKJST    P      PP Payment Erro
     C                     Z-ADDWUPINB    WBPINB           PP Unused Nbr 1
     C                     MOVELWUKKST    WBKKST    P      PP Repayment St
      *
      * Set PGM.*Record Data Changed flag
     C           QPKC41    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@C4REO6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKC4REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * Move @C4REO6 fields back
     C                     Z-ADDWBM1NB    WUM1NB           Pmt Current Pay
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Chg Sts/Date/Time RT - Delivery Sched Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C                     KFLD           WCE0DT           DSH Kill Date
      * Setup key
     C                     Z-ADDP1HONB    WCHONB           CC Company Numb
     C                     Z-ADDWUCKDT    WCE0DT           DSH Kill Date
      * Establish starting position
     C           KRSSC     CHAIN@ADCPID              90    *
      * Data record not found
     C   90                MOVEL'PRK1026' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWCE2DT    YL0003           DSH Opened to L
     C                     Z-ADDWCBMTM    YL0004           DSH Opened to L
     C                     Z-ADDWCE3DT    YL0005           DSH Posted to H
     C                     Z-ADDWCBNTM    YL0006           DSH Posted to H
     C                     Z-ADDWCE4DT    YL0007           DSH Sched Close
     C                     Z-ADDWCBOTM    YL0008           DSH Sched Close
     C                     Z-ADDWCE5DT    YL0009           DSH BOL Printed
     C                     Z-ADDWCBPTM    YL0010           DSH BOL Printed
      * CASE: PAR.DSH Status is 02-Opened to Live Prod
     C           '10'      IFEQ '02'                       *IF
     C                     Z-ADD##JDT     YL0003           DSH Opened to L
     C           ##JTM     DIV  100       YL0004           DSH Opened to L
     C                     ELSE
      * CASE: PAR.DSH Status is 03-Posted to HPS
     C           '10'      IFEQ '03'                       *IF
     C                     Z-ADD##JDT     YL0005           DSH Posted to H
     C           ##JTM     DIV  100       YL0006           DSH Posted to H
     C                     ELSE
      * CASE: PAR.DSH Status is 05-BOL/Movement Printed
     C           '10'      IFEQ '05'                       *IF
     C                     Z-ADD##JDT     YL0009           DSH BOL Printed
     C           ##JTM     DIV  100       YL0010           DSH BOL Printed
     C                     ELSE
      * CASE: PAR.DSH Status is 10=Schedule Closed
     C           '10'      IFEQ '10'                       *IF
     C                     Z-ADD##JDT     YL0007           DSH Sched Close
     C           ##JTM     DIV  100       YL0008           DSH Sched Close
      * Upd Lock Status       RT - Delivery Sched Detail  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Chg DSH Sts           CH - Delivery Sched Header  * 
     C                     EXSR SFCHRC
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Upd Lock Status       RT - Delivery Sched Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHONB    WQSD01           CC Company Numb
     C           *LIKE     DEFN WDE0DT    WQSD02           DSH Kill Date
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           CC Company Numb
     C                     KFLD           WQSD02           DSH Kill Date
      * Setup key
     C                     Z-ADDWCHONB    WQSD01           CC Company Numb
     C                     Z-ADDWCE0DT    WQSD02           DSH Kill Date
      * Establish starting position
     C           KRSSD     SETLL@AECPIG                    *
     C           KRSSD     READE@AECPIG                  90*
      * Data record not found
     C   90                MOVEL'PRK1028' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Lock Status       CH - Delivery Sched Detail  * 
     C                     EXSR SECHRC
     C           KRSSD     READE@AECPIG                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECHRC    BEGSR
      *================================================================
      * Chg Lock Status       CH - Delivery Sched Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0011  20       DSD Scheduled H
     C                     Z-ADD*ZERO     WN0012  50       DSD Farm Site C
     C                     MOVEL*BLANK    WN0013  5        DSD Building
     C                     MOVEL*BLANK    WN0014  5        DSD Room
     C                     MOVEL*BLANK    WN0015  5        DSD Sire Line C
     C                     MOVEL*BLANK    WN0016  7        DSD Hog Group C
     C                     Z-ADD*ZERO     WN0017  30       DSD Unused Head
     C                     Z-ADD*ZERO     WN0018  30       DSD Scheduled D
     C                     Z-ADD*ZERO     WN0019  30       DSD Scheduled K
     C                     MOVEL*BLANK    WN0020  5        DSD Transportat
     C                     MOVEL*BLANK    WN0021  5        DSD Trucker Cod
     C                     MOVEL*BLANK    WN0022  5        DSD Driver
     C                     MOVEL*BLANK    WN0023  5        DSD Loading Cre
     C                     MOVEL*BLANK    WN0024  6        CHR Code
     C                     MOVEL*BLANK    WN0025  2        DSD Load Type
     C                     MOVEL*BLANK    WN0026  1        DSD Full/Split
     C                     Z-ADD*ZERO     WN0027  70       DSD Movement Nu
     C                     MOVEL*BLANK    WN0028 15        DSD Truck ID
     C                     MOVEL*BLANK    WN0029 15        DSD Trailer ID
     C                     MOVEL*BLANK    WN0030  1        DSD Movement Pr
     C                     MOVEL*BLANK    WN0031  1        DSD Sched Route
     C                     Z-ADD*ZERO     WN0032  70       DSD Sched Route
     C                     Z-ADD*ZERO     WN0033  40       DSD Sched Route
     C                     Z-ADD*ZERO     WN0034  70       DSD Sch Farm Ar
     C                     Z-ADD*ZERO     WN0035  40       DSD Sch Farm Ar
     C                     Z-ADD*ZERO     WN0036  70       DSD Sch Start L
     C                     Z-ADD*ZERO     WN0037  40       DSD Sch Start L
     C                     MOVEL*BLANK    WN0038  1        DSD Receiving S
     C                     MOVEL*BLANK    WN0039  1        DSD Kill Shift
     C                     MOVEL*BLANK    WN0040  1        DSD BOL Kill Sh
     C                     MOVEL*BLANK    WN0041  1        DSD HPS Post St
     C                     MOVEL*BLANK    WN0042  1        DSD HPE Post St
     C                     MOVEL*BLANK    WN0043  1        DSD Source Type
     C                     MOVEL*BLANK    WN0044  4        DSD Transfer St
     C                     Z-ADD*ZERO     WN0045  70       DSD Unused Date
     C                     Z-ADD*ZERO     WN0046  40       DSD Unused Time
     C                     MOVEL*BLANK    WN0047  3        SR Source Code
     C                     MOVEL*BLANK    WN0048  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0049  6        PL Location Cod
     C                     Z-ADD*ZERO     WN0050  30       BOH Company Num
     C                     Z-ADD*ZERO     WN0051  70       BOH Buy Order N
     C                     Z-ADD*ZERO     WN0052  50       BOL Load Number
     C                     Z-ADD*ZERO     WN0053 100       DSD PRD Srv Bat
     C                     Z-ADD*ZERO     WN0054 100       DSD PRD Srv Sch
     C                     MOVEL*BLANK    WN0055 10        DSD Ref 1
     C                     MOVEL*BLANK    WN0056 10        DSD Ref 2
     C                     MOVEL*BLANK    WN0057  2        DSD Ref Status
     C                     MOVEL*BLANK    WN0058 10        RS User Changed
     C                     Z-ADD*ZERO     WN0059  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0060  60       RS Time Changed
     C                     MOVEL*BLANK    WN0061  1        RS Record Statu
     C                     MOVEL*BLANK    WN0062 10        RS Job
     C                     MOVEL*BLANK    WN0063 10        RS Program
     C                     MOVEL*BLANK    WN0064 10        RS User Added
     C                     Z-ADD*ZERO     WN0065  70       RS Date Added
     C                     Z-ADD*ZERO     WN0066  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @AECPIH
     C                     Z-ADDWDHONB    WEHONB           CC Company Numb
     C                     Z-ADDWDE0DT    WEE0DT           DSH Kill Date
     C                     Z-ADDWDE6DT    WEE6DT           DSD Delivery Da
     C                     Z-ADDWDAGTH    WEAGTH           DSD Delivery Ti
     C                     Z-ADDWDHZA1    WEHZA1           DSD Delivery Ti
      *
     C           KLCHSE    KLIST
     C                     KFLD           WEHONB           CC Company Numb
     C                     KFLD           WEE0DT           DSH Kill Date
     C                     KFLD           WEE6DT           DSD Delivery Da
     C                     KFLD           WEAGTH           DSD Delivery Ti
     C                     KFLD           WEHZA1           DSD Delivery Ti
     C           KLCHSE    CHAIN@AECPIH              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLAECPL1'MDACP
     C                     MOVEL'@AECPIH' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLAE1    YBRDCS
      * Move non-key fields to @AECPIH
     C                     MOVEL'L'       WEXLST    P      DSD Lock Status
      *
      * Set PGM.*Record Data Changed flag
     C           QPLAE1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@AECPIH                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLAECPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * Chg DSH Sts           CH - Delivery Sched Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @ADCPIE
     C                     Z-ADDWCHONB    WFHONB           CC Company Numb
     C                     Z-ADDWCE0DT    WFE0DT           DSH Kill Date
      *
     C           KLCHSF    KLIST
     C                     KFLD           WFHONB           CC Company Numb
     C                     KFLD           WFE0DT           DSH Kill Date
     C           KLCHSF    CHAIN@ADCPIE              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PLADCPL1'MDACP
     C                     MOVEL'@ADCPIE' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPLAD1    YCRDCS
      * Move non-key fields to @ADCPIE
     C                     Z-ADDWCHYA1    WFHYA1           DSH Planned Kil
     C                     Z-ADDWCINA1    WFINA1           DSH Requested D
     C                     MOVEL'10'      WFWXST    P      DSH Status
     C                     Z-ADDWCE1DT    WFE1DT           DSH Ext Sch Cre
     C                     Z-ADDWCBLTM    WFBLTM           DSH Ext Sch Cre
     C                     Z-ADDYL0003    WFE2DT           DSH Opened to L
     C                     Z-ADDYL0004    WFBMTM           DSH Opened to L
     C                     Z-ADDYL0005    WFE3DT           DSH Posted to H
     C                     Z-ADDYL0006    WFBNTM           DSH Posted to H
     C                     MOVELYL0011    WFXDST    P      DSH Unused Sts
     C                     Z-ADDYL0007    WFE4DT           DSH Sched Close
     C                     Z-ADDYL0008    WFBOTM           DSH Sched Close
     C                     MOVELWCXEST    WFXEST    P      DSH Unused Sts
     C                     Z-ADDYL0009    WFE5DT           DSH BOL Printed
     C                     Z-ADDWCBPTM    WFBPTM           DSH BOL Printed
     C                     MOVELWCAAVN    WFAAVN    P      RS User Changed
     C                     Z-ADDWCAADT    WFAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WFAMTM           RS Time Changed
     C                     MOVELWCAJST    WFAJST    P      RS Record Statu
     C                     MOVELWCAHVN    WFAHVN    P      RS Job
     C                     MOVELWCAGVN    WFAGVN    P      RS Program
     C                     MOVELWCABVN    WFABVN    P      RS User Added
     C                     Z-ADDWCABDT    WFABDT           RS Date Added
     C                     Z-ADDWCABTM    WFABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPLAD1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WFAAVN           RS User Changed
     C                     Z-ADD##JDT     WFAADT           RS Date Changed
     C                     Z-ADD##JTM     WFAMTM           RS Time Changed
     C                     MOVEL##JOB     WFAHVN           RS Job
     C                     MOVEL##PGM     WFAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPLAD1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@ADCPIE                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPLADCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * Upd Paymnt Prc         CH - Payment Processing Parms  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0067  70       Pmt Current Pay
     C                     MOVEL*BLANK    WN0068 10        RS User Changed
     C                     Z-ADD*ZERO     WN0069  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0070  60       RS Time Changed
     C                     MOVEL*BLANK    WN0071  1        RS Record Statu
     C                     MOVEL*BLANK    WN0072 10        RS Job
     C                     MOVEL*BLANK    WN0073 10        RS Program
     C                     MOVEL*BLANK    WN0074 10        RS User Added
     C                     Z-ADD*ZERO     WN0075  70       RS Date Added
     C                     Z-ADD*ZERO     WN0076  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WN0068           RS User Changed
     C                     Z-ADD##JDT     WN0069           RS Date Changed
     C                     Z-ADD##JTM     WN0070           RS Time Changed
     C                     MOVEL##JOB     WN0072           RS Job
     C                     MOVEL##PGM     WN0073           RS Program
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @C4REO6
     C                     Z-ADDP1HONB    WBHONB           CC Company Numb
      *
     C           KLCHSG    KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C           KLCHSG    CHAIN@C4REO6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKC4REL0'MDACP
     C                     MOVEL'@C4REO6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKC41    YDRDCS
      * Move non-key fields to @C4REO6
     C                     Z-ADDWUM1NB    WBM1NB           Pmt Current Pay
     C                     MOVELWUKHST    WBKHST    P      PP Commission P
     C                     MOVELWUKJST    WBKJST    P      PP Payment Erro
     C                     Z-ADDWUPINB    WBPINB           PP Unused Nbr 1
     C                     MOVELWUKKST    WBKKST    P      PP Repayment St
      *
      * Set PGM.*Record Data Changed flag
     C           QPKC41    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@C4REO6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKC4REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * Move @C4REO6 fields back
     C                     Z-ADDWBM1NB    WUM1NB           Pmt Current Pay
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCHRC    BEGSR
      *================================================================
      * Upd Paymnt Prc         CH - Payment Processing Parms  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0077  70       Pmt Current Pay
     C                     MOVEL*BLANK    WN0078 10        RS User Changed
     C                     Z-ADD*ZERO     WN0079  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0080  60       RS Time Changed
     C                     MOVEL*BLANK    WN0081  1        RS Record Statu
     C                     MOVEL*BLANK    WN0082 10        RS Job
     C                     MOVEL*BLANK    WN0083 10        RS Program
     C                     MOVEL*BLANK    WN0084 10        RS User Added
     C                     Z-ADD*ZERO     WN0085  70       RS Date Added
     C                     Z-ADD*ZERO     WN0086  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WN0078           RS User Changed
     C                     Z-ADD##JDT     WN0079           RS Date Changed
     C                     Z-ADD##JTM     WN0080           RS Time Changed
     C                     MOVEL##JOB     WN0082           RS Job
     C                     MOVEL##PGM     WN0083           RS Program
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @C4REO6
     C                     Z-ADDP1HONB    WBHONB           CC Company Numb
      *
     C           KLCHSH    KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C           KLCHSH    CHAIN@C4REO6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKC4REL0'MDACP
     C                     MOVEL'@C4REO6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKC41    YERDCS
      * Move non-key fields to @C4REO6
     C                     Z-ADDWUM1NB    WBM1NB           Pmt Current Pay
     C                     MOVELWUKHST    WBKHST    P      PP Commission P
     C                     MOVELWUKJST    WBKJST    P      PP Payment Erro
     C                     Z-ADDWUPINB    WBPINB           PP Unused Nbr 1
     C                     MOVELWUKKST    WBKKST    P      PP Repayment St
      *
      * Set PGM.*Record Data Changed flag
     C           QPKC41    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@C4REO6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKC4REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * Move @C4REO6 fields back
     C                     Z-ADDWBM1NB    WUM1NB           Pmt Current Pay
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Del Unused Tattoo #   RT - Tattoo Pending  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHONB    WQSI01           CC Company Numb
     C           *LIKE     DEFN WGEZDT    WQSI02           TP Tattoo Date
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           CC Company Numb
     C                     KFLD           WQSI02           TP Tattoo Date
      * Setup key
     C                     Z-ADDP1HONB    WQSI01           CC Company Numb
     C                     Z-ADDWUCKDT    WQSI02           TP Tattoo Date
      * Establish starting position
     C           KRSSI     SETLL@FJCPJN                    *
     C           KRSSI     READE@FJCPJN                  90*
      * Data record not found
     C   90                MOVEL'PRK1012' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Tattoo Pending    DL - Tattoo Pending  * 
     C                     EXSR SJDLRC
     C           KRSSI     READE@FJCPJN                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJDLRC    BEGSR
      *================================================================
      * Del Tattoo Pending    DL - Tattoo Pending  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @FJCPHV
     C                     Z-ADDWGHONB    WHHONB           CC Company Numb
     C                     Z-ADDWGEZDT    WHEZDT           TP Tattoo Date
     C                     Z-ADDWGHSA1    WHHSA1           TP Tattoo Numbe
      *
     C           KLDLSJ    KLIST
     C                     KFLD           WHHONB           CC Company Numb
     C                     KFLD           WHEZDT           TP Tattoo Date
     C                     KFLD           WHHSA1           TP Tattoo Numbe
     C           KLDLSJ    CHAIN@FJCPHV              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFJCPL0'MDACP
     C                     MOVEL'@FJCPHV' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@FJCPHV                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Del Unused Tattoo #   RT - Tattoo Pending  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGHONB    WQSK01           CC Company Numb
     C           *LIKE     DEFN WGEZDT    WQSK02           TP Tattoo Date
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           CC Company Numb
     C                     KFLD           WQSK02           TP Tattoo Date
      * Setup key
     C                     Z-ADDP1HONB    WQSK01           CC Company Numb
     C                     Z-ADDWUB5DT    WQSK02           TP Tattoo Date
      * Establish starting position
     C           KRSSK     SETLL@FJCPJN                    *
     C           KRSSK     READE@FJCPJN                  90*
      * Data record not found
     C   90                MOVEL'PRK1012' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Tattoo Pending    DL - Tattoo Pending  * 
     C                     EXSR SLDLRC
     C           KRSSK     READE@FJCPJN                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLDLRC    BEGSR
      *================================================================
      * Del Tattoo Pending    DL - Tattoo Pending  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @FJCPHV
     C                     Z-ADDWGHONB    WHHONB           CC Company Numb
     C                     Z-ADDWGEZDT    WHEZDT           TP Tattoo Date
     C                     Z-ADDWGHSA1    WHHSA1           TP Tattoo Numbe
      *
     C           KLDLSL    KLIST
     C                     KFLD           WHHONB           CC Company Numb
     C                     KFLD           WHEZDT           TP Tattoo Date
     C                     KFLD           WHHSA1           TP Tattoo Numbe
     C           KLDLSL    CHAIN@FJCPHV              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFJCPL0'MDACP
     C                     MOVEL'@FJCPHV' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@FJCPHV                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Payment Processing RT - Payment Processing Parms  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WAHONB           CC Company Numb
      * Setup key
     C                     Z-ADDP1HONB    WAHONB           CC Company Numb
      * Establish starting position
     C           KRSSM     CHAIN@C4REO7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0434' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUCKDT           Pmt Current Pay
     C                     Z-ADD*ZERO     WUM1NB           Pmt Current Pay
     C                     MOVEL*BLANK    WUKHST           PP Commission P
     C                     MOVEL*BLANK    WUKJST           PP Payment Erro
     C                     Z-ADD*ZERO     WUPINB           PP Unused Nbr 1
     C                     MOVEL*BLANK    WUKKST           PP Repayment St
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWACKDT    WUCKDT           Pmt Current Pay
     C                     Z-ADDWAM1NB    WUM1NB           Pmt Current Pay
     C                     MOVELWAKHST    WUKHST           PP Commission P
     C                     MOVELWAKJST    WUKJST           PP Payment Erro
     C                     Z-ADDWAPINB    WUPINB           PP Unused Nbr 1
     C                     MOVELWAKKST    WUKKST           PP Repayment St
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCHRC    BEGSR
      *================================================================
      * Chg Payment Date/Step  CH - Payment Processing Parms  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0087  50       PP Unused Nbr 1
     C                     MOVEL*BLANK    WN0088  1        PP Repayment St
     C                     MOVEL*BLANK    WN0089 10        RS User Changed
     C                     Z-ADD*ZERO     WN0090  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0091  60       RS Time Changed
     C                     MOVEL*BLANK    WN0092  1        RS Record Statu
     C                     MOVEL*BLANK    WN0093 10        RS Job
     C                     MOVEL*BLANK    WN0094 10        RS Program
     C                     MOVEL*BLANK    WN0095 10        RS User Added
     C                     Z-ADD*ZERO     WN0096  70       RS Date Added
     C                     Z-ADD*ZERO     WN0097  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WN0089           RS User Changed
     C                     Z-ADD##JDT     WN0090           RS Date Changed
     C                     Z-ADD##JTM     WN0091           RS Time Changed
     C                     MOVEL##JOB     WN0093           RS Job
     C                     MOVEL##PGM     WN0094           RS Program
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @C4REO6
     C                     Z-ADDP1HONB    WBHONB           CC Company Numb
      *
     C           KLCHSN    KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C           KLCHSN    CHAIN@C4REO6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKC4REL0'MDACP
     C                     MOVEL'@C4REO6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKC41    YFRDCS
      * Move non-key fields to @C4REO6
     C                     Z-ADDWUB1DT    WBCKDT           Pmt Current Pay
     C                     Z-ADDWUM1NB    WBM1NB           Pmt Current Pay
     C                     MOVELWUKHST    WBKHST    P      PP Commission P
     C                     MOVELWUKJST    WBKJST    P      PP Payment Erro
      *
      * Set PGM.*Record Data Changed flag
     C           QPKC41    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@C4REO6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKC4REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * SDN440 RMC 05/20/21 - ADDED CHECK FOR PORKISTESTING USER BEFORE
      * - Submitting Create EDI Carcass Summary/Detail (PWEHXFR)
      * H16853 ISE 11/09/2020 - Recompiled due to change in Buy Order Num
      * E13291 JBB  7/06/18 - Payment Push Automation
      * - Add a Push Type parameter to the submitted call of the Push to
      *   Pay process called at the end of this process.  Passed in an 'A
      *   to signify this is an Automatic call of the Push to Pay process
      * E10169 JBB  4/25/18 - Do not print MPR Comparison report for 961
      * - Jerry reported that on 4/3/18, that the Paid values and the USD
      *   values did not match for a Tattoo#.  This was because 960 and
      *   440 had the same Tattoo# on the same day because of the Payment
      *   Push process.  Susan says that the report is not needed for
      *   Company 961 because all of the values should be 440 values.
      * E10169 JJH 11/28/17 - Payment Producer Post Modifications
      * - This logic was re-instated after we corrected the error in the
      *   PWEHXFR program that was generating an error.
      * - Submit Create EDI Carcass Summary/Detail (PWEHXFR)
      * - This function was created to submit the EDI Carcass Summary and
      *   Detail as a seperate job.  If this job fails, it can be
      *   cancelled without affecting the other portions of the Post
      *   Producer Payments.
      * - Because this process uses FTP, and SFTP these processes some
      *   sometimes fail and it takes time to resolve, and this causes
      *   other jobs in the job queue to be delayed.
      * - This will allow the Post Payment Processing to complete, instea
      *   of waiting to resolve issues regarding FTP and SFTP.
      * - We have the option to run the ReCreate the EDI files for a
      *   Kill Date (PLGIPVR) as an on-demand job.
      * E9904  JBB  9/08/2017 - Push Payment from 440 to 961
      * - Add a submit to the Payment Push driver program if the current
      *   company is set up to perform a push.  Currently, only company 4
      *   is set up in the Company Values file to perform a payment push.
      * E10169 JJH 08/22/17 - Post Payment Producer Modifications
      * - Modify program so that it will generate the EDI Carcasss Summar
      *   and Detail if *USER is PorkISTesting
      * E10169 JJH 08/22/17 - Post Payment Producer Modifications
      * - Temporarily disable the job that submits separte job to be
      *   processed in PRKFTPQ for FTP/SFTP/Emails.  We could not success
      *   test this process.
      * E10169 JJH 08/14/17 - Post Payment Producer Modifications
      * - Allow FTP Method (FTP, SFTP, or Email) for PrkISTesting to be
      *   determined by the Ext ProducerFTPMethod XF - Producer (PWDUXFR)
      * E10169 JJH 08/07/17 - Payment Producer Post Modifications
      * - Submit Create EDI Carcass Summary/Detail (PWEHXFR)
      * - This function was created to submit the EDI Carcass Summary and
      *   Detail as a seperate job.  If this job fails, it can be
      *   cancelled without affecting the other portions of the Post
      *   Producer Payments.
      * - Because this process uses FTP, and SFTP these processes some
      *   sometimes fail and it takes time to resolve, and this causes
      *   other jobs in the job queue to be delayed.
      * - This will allow the Post Payment Processing to complete, instea
      *   of waiting to resolve issues regarding FTP and SFTP.
      * - We have the option to run the ReCreate the EDI files for a
      *   Kill Date (PLGIPVR) as an on-demand job.
      * E10169 JJH 07/26/17 - Payment Producer Post Modifications
      * - Recompile to allow *USER LST: PorkISTesting to alllow Susan
      *   Blakey and Julius High to run the Payment Post Edit. This
      *   allows IT to process when troubleshooting problems.
      * E10169 - Posting changes STF and testing 7/9/2017
     C                     EXSR UBSUBR                     E10169 - Postin
      * RMC 04/28/17 T8163 added email sql with M3 ap vouchers, in step 7
      * RMC 11/23/05 added co to mplus msgs
      * S0555 SLM 11/14/2008 When the EDI create is being perform
     C                     EXSR UCSUBR                     S0555 SLM 11/14
      * slm 06/26/2013 - Put the EDI, purge of tattoo pending(960)
      * AT step 7 user selecting the payment post twice and edi was getti
      * kicked off twice while the other one was running
      * E3625 JJH 12/04/14 - Recompile because PrklISTesting List for
      *  field *USER to add users Julius High (ISJHIGH) and Collin Lynch
      *  ISCLYNC.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * E10169 - Posting changes STF and testing 7/9/2017
      *================================================================
      * slm 07/09/17 Changes due to TPMTESTF is not yet established
      * to allow us to run some areas so I bypass section that are for
      * production only.
      * At this time the test data, will not be sent to the IHUB
      * see 2nd part of step 6.
      * slm 07/09/17 Allow all of the EDI Carcass Detail/Summary file to
      * be created when in the testing but do not ftp to the folders
      * but send these files out via Email/Julius will be working
      * on the email of the edi carcass detail/edi carcass summary
      * see step 7.  At this time this is * out waiting for us to
      * to have this ready via email
      * also at this time 440 WILL NOT FTP to folders, and until the
      * .net has something to cover 440, we will send these files via
      * email, Julius and I will get these,
      * carcass summary/crcass detail,
      * un * this statement when that section is ready Step 7
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * S0555 SLM 11/14/2008 When the EDI create is being perform
      *================================================================
      * S0555 SLM 11/14/2008 When the EDI create is being perform
      * pass new parm to state the EDI will need to send out the files
      * to the web.  Or do not send the files to the web
      * The sequels are not to be performed then the process flag
      * on the EDI carcass summary & detail will be set to a P for
      * process.  the sequels do not pick up records that are mark P
      * If the sequels will be  performed then the process flag will
      * be set to A for Active, the sequels will pick up all
      * records that are active, and then the sequels will perform
      * another update to change these active records to P for process
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Step 6: Payment Post
      *================================================================
     C                     Z-ADD*ZERO     P4A1TM           Current Time
      * Current Time
      * Rtv Current Time      US - STR User Source Functions  * 
     C                     TIME           P4A1TM
      * Setup message data for message
      * Convert Pmt Current Payment Date to display format
      * Convert date
     C           1000000   ADD  WUCKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0001
     C                     Z-ADDP4A1TM    ZA0002           Current Time
     C                     Z-ADDP1HONB    ZA0003           CC Company Numb
      * Retrieve message Post: HPE Payment Strt
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0785' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           WUKGTX    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Snd Pager Msg (MPLUS) UP - STR Order Management Sys  * 
     C                     CALL 'POMSUPC'              90  Snd Pager Msg (
     C                     PARM YL0001    WQ0004 10        Office Dist Lis
     C                     PARM WUKGTX    WQ0005132        Office Dist Mes
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMSUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Step 6:  Producer Posting
      * CASE: WRK.Pmt Current Payment Step is Less or Equal to Step 6
     C           WUM1NB    IFLE 00006                      *IF
      * Step 6  Payment posting and producer Post/Create Producer Voucher
      * CASE: WRK.Pmt Current Payment Step is Greater then or Equal 5
     C           WUM1NB    IFGE 00005                      *IF
     C                     Z-ADD00006     WUM1NB           Pmt Current Pay
      * Upd Paymnt Prc         CH - Payment Processing Parms  * 
     C                     EXSR SBCHRC
      * Prt Pay Chk Post Rep  PF - Tattoo Header  * 
     C                     CALL 'PKT1PFR'              90  Prt Pay Chk Pos
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0006  30       BOH Company Num
     C                     PARM WUCKDT    WQ0007  70       TH Kill Date
     C                     PARM 'P'       WQ0008  1        @Status Edit/Po
     C                     PARM P2EVTX    WQ0009 40        Oms System Valu
     C                     PARM 'U'       WQ0010  1        @Status Unpaid/
     C           WUKIST    PARM WUKIST    WQ0011  1        Pmt Payment Err
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKT1PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * This report will print a report by producer, and create checks
      * Prt Payment Edit/Post PF - Tattoo Header  * 
     C                     CLEARPARC
     C                     Z-ADDP1HONB    PAHMNB           BOH Company Num
     C                     Z-ADDWUCKDT    PAB0DT           TH Kill Date
      *
     C                     CALL 'PKS2PFR'              90  Prt Payment Edi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Tattoo Hea
     C                     PARM 'P'       WQ0012  1        @Status Edit/Po
     C                     PARM P2EVTX    WQ0013 40        Oms System Valu
     C                     PARM 'U'       WQ0014  1        @Status Unpaid/
     C           WUKIST    PARM WUKIST    WQ0015  1        Pmt Payment Err
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKS2PFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * This report will print comm paid by TH producer, and create check
      * Prt Payment Comm E/P  PF - Tattoo Header  * 
     C                     CLEARPBRC
     C                     Z-ADDP1HONB    PBHMNB           BOH Company Num
     C                     Z-ADDWUCKDT    PBB0DT           TH Kill Date
      *
     C                     CALL 'PKPMPFR'              90  Prt Payment Com
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: Tattoo Hea
     C                     PARM 'P'       WQ0016  1        @Status Edit/Po
     C           WUKIST    PARM WUKIST    WQ0017  1        PP Commission P
     C                     PARM P2EVTX    WQ0018 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKPMPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PK0166- Update TH Ext with Excluded Carcass Data
      * Rtv Excep Deleted Sum XF - Eval Trans  * 
     C                     CALL 'PKT5XFR'              90  Rtv Excep Delet
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0019  30       ET Company Numb
     C                     PARM WUCKDT    WQ0020  70       ET Kill Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKT5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Prt Pur-Jrn Prm/Final PF - Tattoo Header  * 
     C                     CLEARPCRC
     C                     Z-ADDP1HONB    PCHMNB           BOH Company Num
     C                     Z-ADDWUCKDT    PCB0DT           TH Kill Date
      *
     C                     CALL 'PKTTPFR'              90  Prt Pur-Jrn Prm
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PCRC             KEY: Tattoo Hea
     C                     PARM 'P'       WQ0021  1        @Status Edit/Po
     C                     PARM P2EVTX    WQ0022 40        Oms System Valu
     C                     PARM 'U'       WQ0023  1        @Status Unpaid/
     C           WUEKST    PARM WUEKST    WQ0024  1        Pmt Payment Err
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKTTPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Prt Pur-Jrn Rsl       PF - Tattoo Header  * 
     C                     CLEARPDRC
     C                     Z-ADDP1HONB    PDHMNB           BOH Company Num
     C                     Z-ADDWUCKDT    PDB0DT           TH Kill Date
      *
     C                     CALL 'PKTZPFR'              90  Prt Pur-Jrn Rsl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PDRC             KEY: Tattoo Hea
     C                     PARM 'P'       WQ0025  1        @Status Edit/Po
     C                     PARM P2EVTX    WQ0026 40        Oms System Valu
     C                     PARM 'U'       WQ0027  1        @Status Unpaid/
     C           WUEKST    PARM WUEKST    WQ0028  1        Pmt Payment Err
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKTZPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PK0254 - MPR comparison
      *  4/25/18 JBB E30419-Do not print MPR Comparison report for 961
      * CASE:
      *  - NOTc1
      *   |- c1    : PAR.CC Company Number is Triumph Foods-2
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1HONB    IFEQ 961                        *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Prt MPR Comparison   PF - Tattoo Header  * 
     C                     CLEARPERC
     C                     Z-ADDP1HONB    PEHMNB           BOH Company Num
     C                     Z-ADDWUCKDT    PEB0DT           TH Kill Date
      *
     C                     CALL 'PKWZPFR'              90  Prt MPR Compari
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PERC             KEY: Tattoo Hea
     C                     PARM P2EVTX    WQ0029 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWZPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * PK - Change Delivery Tracking with BOL Summary 12/23/03
      * Exc DT BOL Sum Fields XF - Buy Order Load  * 
     C                     CALL 'PLD4XFR'              90  Exc DT BOL Sum
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0030  30       BOH Company Num
     C                     PARM WUCKDT    WQ0031  70       BOL Kill Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLD4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PK0495 - Change Delivery Sched Header status to 10=Closed
      * Rtv Chg Sts/Date/Time RT - Delivery Sched Header  * 
     C                     EXSR SCRVGN
      * PK0495 - Recalc Pen Inventory for the day    04/02/03
     C                     Z-ADDP1HONB    WUHONB           CC Company Numb
      * Exc Pen Inv Recalc    XF - Pen Inventory  * 
     C                     CALL 'PLC7XFR'              90  Exc Pen Inv Rec
     C                     PARM *BLANK    W0RTN   7
     C           WUHONB    PARM WUHONB    WQ0032  30       CC Company Numb
     C           WUCKDT    PARM WUCKDT    WQ0033  70       PI Scheduled Da
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLC7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PK0541 - Update 1st kill time for each TH    09/05/03
     C                     Z-ADDP1HONB    WUHONB           CC Company Numb
      * Exc Kill Hour for TH  XF - Tattoo Header  * 
     C                     CALL 'PLDUXFR'              90  Exc Kill Hour f
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUHONB    WQ0034  30       BOH Company Num
     C                     PARM WUCKDT    WQ0035  70       TH Kill Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLDUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * 4/9/04  FOM Upl to FtP Site
      * 11/23/05 do for Guymon only. extra pgming is req to do for Triump
      * CASE: PAR.CC Company Number is SBD Farms of Guymon, Ok
     C           P1HONB    IFEQ 360                        *IF
      * Upl EvUpl to Ftp site UP - Eval Trans UPL  * 
     C                     CALL 'PLDMUPR'              90  Upl EvUpl to Ft
     C                     PARM WULMST    WQ0036  7        Return Code USR
     C                     PARM WUCKDT    WQ0037  70       EA Kill Date
     C                     PARM WUJ6TX    WQ0038  1        EA Shift
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLDMUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * E10169 SLM 07/09/17 - Eval Trans Upl Erp
      * CASE: JOB.*USER is PorkISTesting
     C           ##USR     IFEQ @CN,003                    *IF
     C           ##USR     OREQ @CN,004
     C           ##USR     OREQ @CN,005
     C           ##USR     OREQ @CN,006
     C           ##USR     OREQ @CN,007
     C           ##USR     OREQ @CN,008
     C           ##USR     OREQ @CN,009
     C           ##USR     OREQ @CN,010
     C           ##USR     OREQ @CN,011
     C           ##USR     OREQ @CN,012
     C           ##USR     OREQ @CN,013
     C           ##USR     OREQ @CN,014
     C           ##USR     OREQ @CN,015
     C           ##USR     OREQ @CN,016
     C           ##USR     OREQ @CN,017
     C           ##USR     OREQ @CN,018
     C           ##USR     OREQ @CN,019
     C           ##USR     OREQ @CN,020
     C           ##USR     OREQ @CN,021
     C           ##USR     OREQ @CN,022
     C           ##USR     OREQ @CN,023
     C           ##USR     OREQ @CN,024
     C           ##USR     OREQ @CN,025
     C           ##USR     OREQ @CN,026
     C           ##USR     OREQ @CN,027
     C           ##USR     OREQ @CN,028
      * slm 7/9/2017 add due to testing
      * Do not allow the next process to be run if the condition is true
      * TPMTESTF does not have all of the files that are need to perform
      * the next function, and we do not need this portion if we are test
     C                     ELSE
      * CASE: *OTHERWISE
      * will be send hot scale data to the Ihub then to Ifor
      * Step 6UPL:  Eval Trans Upl to Eval Trans Upl Erp
      * CASE: WRK.Pmt Current Payment Step is 00006 Producer Payment
     C           WUM1NB    IFEQ 00006                      *IF
      * 8/26/2014 slm p3321
      * Read the Eval Trans Upl BY Company and restrict on Kill date
      * Read the Eval Trans Upl and either create these records or
      * update the records in the EVAL TRANS UPL Erp
     C                     MOVELP1HONB    WUC3CD           Company Number
      * SBMJOB: Bld Erp EvalTrnUplAct XF - Eval Trans UPL  * 
      *
     C                     MOVEL*BLANK    W0RTN
      * Build call string for processing in batch.
     C                     MOVEL#S0001    #SRQS     P
     C           #SRQS     CAT  #SCLL:1   #SRQS            Call command
     C                     MOVEL'PLVAXFR '#SPRG     P      Load pgm name
     C           #SRQS     CAT  #SPRG:0   #SRQS            Add pgm name
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
      * Build parameters string.
     C           #SRQS     CAT  #SPRM:1   #SRQS            Parameters
      *
     C                     MOVELW0RTN     #SSTR     P      *Return code
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 7         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     MOVELWUC3CD    #SSTR     P      Company Number
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'A'       #STYP   1
     C                     PARM 3         #SLEN   50
     C                     PARM           #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADDWUCKDT    #SPAK  309       Kill Date 1 Usr
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 7         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C                     Z-ADDWUCKDT    #SPAK  309       Kill Date 2 USR
     C                     MOVEL#SPAK     #SSTR     P
     C                     CALL 'Y2BLSJR'
     C                     PARM           W0RTN
     C                     PARM           #SSTR
     C                     PARM 'P'       #STYP   1
     C                     PARM 7         #SLEN   50
     C                     PARM 0         #SDEC   10
     C                     PARM           #SRQS
      *
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *................................................................
     C           #SRQS     CAT  #SPRN:0   #SRQS            Parenthesis
      *
     C           W0RTN     IFNE *BLANK
      * Build of submit job string ended in error.
     C                     MOVEL'Y2U0065' W0RTN
     C                     MOVEL'PLVAXFR 'W0CLPG 10 P
      * Send message '*Error occured on SBMJOB'
     C                     MOVEL'Y2U0065' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     ELSE
      *
     C           W0SJO     IFNE *BLANK
      * Merge variable submit job overrides.
     C                     CALL 'Y2MGRQR'              90  *
     C                     PARM #SRQS     #SWRK
     C                     PARM W0SJO     #SMRG
     C  N90                MOVEL#SWRK     #SRQS     P
     C                     MOVE *BLANK    W0SJO
     C                     END
      * Submit request.
     C                     CALL 'Y2CMEXC'              90  *
     C                     PARM           #SRQS
     C                     PARM 3000      #SRQL  155
     C                     PARM           W0JVN  10
     C                     PARM           W0JUN  10
     C                     PARM           W0JNB   6
     C                     END
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLVAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL@CN,029   YL0012           Office Dist Lis
     C                     Z-ADD*ZERO     P4A1TM           Current Time
      * Current Time
      * Rtv Current Time      US - STR User Source Functions  * 
     C                     TIME           P4A1TM
      * Setup message data for message
      * Convert Pmt Current Payment Date to display format
      * Convert date
     C           1000000   ADD  WUCKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0004
     C                     Z-ADDP4A1TM    ZA0005           Current Time
     C                     Z-ADDP1HONB    ZA0006           CC Company Numb
      * Retrieve message Post: Crt Eval TrnUpl ERP
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1313' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           WUKGTX    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Snd Pager Msg (MPLUS) UP - STR Order Management Sys  * 
     C                     CALL 'POMSUPC'              90  Snd Pager Msg (
     C                     PARM YL0012    WQ0039 10        Office Dist Lis
     C                     PARM WUKGTX    WQ0040132        Office Dist Mes
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMSUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD00007     WUM1NB           Pmt Current Pay
      * Upd Paymnt Prc         CH - Payment Processing Parms  * 
     C                     EXSR SGCHRC
     C                     END                             *FI
     C                     END                             *FI
      * 1/17/2008 SLM Change to use Office Dist List USR2 load from compv
      * See above
     C                     Z-ADD*ZERO     P4A1TM           Current Time
      * Current Time
      * Rtv Current Time      US - STR User Source Functions  * 
     C                     TIME           P4A1TM
      * Setup message data for message
      * Convert Pmt Current Payment Date to display format
      * Convert date
     C           1000000   ADD  WUCKDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0007
     C                     Z-ADDP4A1TM    ZA0008           Current Time
     C                     Z-ADDP1HONB    ZA0009           CC Company Numb
      * Retrieve message Post: HPE Payment Cmpl
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0784' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           WUKGTX    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      * Snd Pager Msg (MPLUS) UP - STR Order Management Sys  * 
     C                     CALL 'POMSUPC'              90  Snd Pager Msg (
     C                     PARM YL0002    WQ0041 10        Office Dist Lis
     C                     PARM WUKGTX    WQ0042132        Office Dist Mes
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMSUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Carcass summary, carcass detail, & additional processing
      *================================================================
      * Upd Tto/Prd Lean Dist XF - Crc Sum Lean Dist Range  * 
     C                     CALL 'PKTDXFR'              90  Upd Tto/Prd Lea
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0043  30       BOH Company Num
     C                     PARM WUCKDT    WQ0044  70       TH Voucher Paym
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKTDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * *** Print Carc Sum and Crc Dtl consecutively    *** 91896
      * Setup message data for message
     C                     MOVELP2EVTX    ZA0010           Oms System Valu
     C                     MOVELP3ACVN    ZA0011           PRT Printer Dev
     C                     MOVELP3AKST    ZA0012           PRT Hold Output
     C                     MOVELP3AMST    ZA0013           PRT Save Output
     C                     Z-ADDP3AKNB    ZA0014           PRT Copies
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0782' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
      * Setup message data for message
     C                     MOVEL'P'       ZA0015           Post or Select
     C                     MOVEL'N'       ZA0016           Print Carcass A
     C                     MOVEL'N'       ZA0017           Status 3
     C                     MOVELP2EVTX    ZA0018           Oms System Valu
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0783' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
     C                     Z-ADD99999     WUM1NB           Pmt Current Pay
      * Upd Paymnt Prc         CH - Payment Processing Parms  * 
     C                     EXSR SHCHRC
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Step End of Job update payment date and step
      *================================================================
      * Chg Payment Date/Step  IF
      * This function will move either current kill
      * or next kill date to payment date, and set next number to zero.
      * This routine should only be used at the tail end of
      * the batch processing.
      * Rtv Payment Processing RT - Payment Processing Parms  * 
     C                     EXSR SMRVGN
      * CASE: PAR.Pmt Current Payment Step is 99999 Normal EOJ
     C           WUM1NB    IFEQ 99999                      *IF
      * Based on Payment date Get Next Current Kill date
      * Rtv Nxt Kill Dt 2 OMS XF - STR Order Management Sys  * 
     C                     CALL 'PDUXXFR'              90  Rtv Nxt Kill Dt
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HONB    WQ0062  30       CC Company Numb
     C                     PARM WUCKDT    WQ0063  70       Kill Date Usr
     C           WUB1DT    PARM *ZERO     WQ0064  70       Next Kill Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDUXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD1         WUM1NB           Pmt Current Pay
     C                     MOVEL*BLANK    WUKLST           Pmt Payment Err
     C                     MOVEL'N'       WUKHST           PP Commission P
      * Chg Payment Date/Step  CH - Payment Processing Parms  * 
     C                     EXSR SNCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * *ERROR PAYMENT STEP NOT AT END OF JOB
      * Send message 'Payment Processing Error'
     C                     MOVEL'PRK0436' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'PRK0436' W0RTN            *Return code
     C                     END                             *FI
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P4A1TM           Current Time
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Pmt Current Payment Date
     C                     Z-ADD*ZERO     WUCKDT  70
      * Define work field Pmt Current Payment Step
     C                     Z-ADD*ZERO     WUM1NB  50
      * Define work field PP Commission Paym Error
     C                     MOVEL*BLANK    WUKHST  1
      * Define work field PP Payment Error
     C                     MOVEL*BLANK    WUKJST  1
      * Define work field PP Unused Nbr 1
     C                     Z-ADD*ZERO     WUPINB  50
      * Define work field PP Repayment Status
     C                     MOVEL*BLANK    WUKKST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHONB           CC Company Numb
     C                     Z-ADD*ZERO     WACKDT           Pmt Current Pay
     C                     Z-ADD*ZERO     WAM1NB           Pmt Current Pay
     C                     Z-ADD*ZERO     WAPINB           PP Unused Nbr 1
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field Office Dist Message USR
     C                     MOVEL*BLANK    WUKGTX132
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field @Payment Error
     C                     MOVEL*BLANK    WUKIST  1
      * Define work field @Payment Sts
     C                     MOVEL*BLANK    WUEKST  2
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHONB           CC Company Numb
     C                     Z-ADD*ZERO     WCE0DT           DSH Kill Date
     C                     Z-ADD*ZERO     WCHYA1           DSH Planned Kil
     C                     Z-ADD*ZERO     WCINA1           DSH Requested D
     C                     Z-ADD*ZERO     WCE1DT           DSH Ext Sch Cre
     C                     Z-ADD*ZERO     WCBLTM           DSH Ext Sch Cre
     C                     Z-ADD*ZERO     WCE2DT           DSH Opened to L
     C                     Z-ADD*ZERO     WCBMTM           DSH Opened to L
     C                     Z-ADD*ZERO     WCE3DT           DSH Posted to H
     C                     Z-ADD*ZERO     WCBNTM           DSH Posted to H
     C                     Z-ADD*ZERO     WCE4DT           DSH Sched Close
     C                     Z-ADD*ZERO     WCBOTM           DSH Sched Close
     C                     Z-ADD*ZERO     WCE5DT           DSH BOL Printed
     C                     Z-ADD*ZERO     WCBPTM           DSH BOL Printed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHONB           CC Company Numb
     C                     Z-ADD*ZERO     WDE0DT           DSH Kill Date
     C                     Z-ADD*ZERO     WDE6DT           DSD Delivery Da
     C                     Z-ADD*ZERO     WDAGTH           DSD Delivery Ti
     C                     Z-ADD*ZERO     WDHZA1           DSD Delivery Ti
     C                     Z-ADD*ZERO     WDH0A1           DSD Scheduled H
     C                     Z-ADD*ZERO     WDH1A1           DSD Farm Site C
     C                     Z-ADD*ZERO     WDIOA1           DSD Unused Head
     C                     Z-ADD*ZERO     WDH2A1           DSD Scheduled D
     C                     Z-ADD*ZERO     WDIJA1           DSD Scheduled K
     C                     Z-ADD*ZERO     WDH3A1           DSD Movement Nu
     C                     Z-ADD*ZERO     WDFRDT           DSD Sched Route
     C                     Z-ADD*ZERO     WDBOTH           DSD Sched Route
     C                     Z-ADD*ZERO     WDE7DT           DSD Sch Farm Ar
     C                     Z-ADD*ZERO     WDAHTH           DSD Sch Farm Ar
     C                     Z-ADD*ZERO     WDE8DT           DSD Sch Start L
     C                     Z-ADD*ZERO     WDAITH           DSD Sch Start L
     C                     Z-ADD*ZERO     WDFZDT           DSD Unused Date
     C                     Z-ADD*ZERO     WDB1TH           DSD Unused Time
     C                     Z-ADD*ZERO     WDHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WDBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WDBONB           BOL Load Number
     C                     Z-ADD*ZERO     WDY0A1           DSD PRD Srv Bat
     C                     Z-ADD*ZERO     WDY1A1           DSD PRD Srv Sch
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Define work field CC Company Number
     C                     Z-ADD*ZERO     WUHONB  30
      * Define work field Return Code USR
     C                     MOVEL*BLANK    WULMST  7
      * Define work field Blank Usr 2
     C                     MOVEL*BLANK    WUJ6TX  1
      * Define work field Company Number Alpha Usr
     C                     MOVEL*BLANK    WUC3CD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGHONB           CC Company Numb
     C                     Z-ADD*ZERO     WGEZDT           TP Tattoo Date
     C                     Z-ADD*ZERO     WGHSA1           TP Tattoo Numbe
     C                     Z-ADD*ZERO     WGHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WGBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WGBONB           BOL Load Number
     C                     Z-ADD*ZERO     WGHRA1           Employee ID
     C                     Z-ADD*ZERO     WGBKTM           TP Tattoo Creat
     C                     Z-ADD*ZERO     WGMIA1           Employee Number
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
      * Define work field Date USR
     C                     Z-ADD*ZERO     WUB5DT  70
      * Define work field Current Kill Date
     C                     Z-ADD*ZERO     WUB1DT  70
      * Define work field Pmt Payment Error
     C                     MOVEL*BLANK    WUKLST  1
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      *
     C                     MOVEL*BLANK    W0SJO 132        *Sbmjob overrid
      * Define local work field Office Dist List USR
     C                     MOVEL*BLANK    YL0001 10
      * Define local work field Office Dist List USR2
     C                     MOVEL*BLANK    YL0002 10
      * Define local work field DSH Opened to Live Date
     C                     Z-ADD*ZERO     YL0003  70
      * Define local work field DSH Opened to Live Time
     C                     Z-ADD*ZERO     YL0004  40
      * Define local work field DSH Posted to HPS Date
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field DSH Posted to HPS Time
     C                     Z-ADD*ZERO     YL0006  40
      * Define local work field DSH Sched Closed Date
     C                     Z-ADD*ZERO     YL0007  70
      * Define local work field DSH Sched Closed Time
     C                     Z-ADD*ZERO     YL0008  40
      * Define local work field DSH BOL Printed Date
     C                     Z-ADD*ZERO     YL0009  70
      * Define local work field DSH BOL Printed Time
     C                     Z-ADD*ZERO     YL0010  40
      * Define local work field DSH Unused Sts 1
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field Office Dist List USR3
     C                     MOVEL*BLANK    YL0012 10
      * Define local work field Date Alpha USR
     C                     MOVEL*BLANK    YL0013  7
      * Define local work field Live with M3   USR
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field EMail Address
     C                     MOVEL*BLANK    YL0015 50
      * Define local work field M3 Division # USR
     C                     MOVEL*BLANK    YL0016  3
      * Define local work field Push To Company
     C                     Z-ADD*ZERO     YL0017  30
      * Define local work field Number 1 USR
     C                     Z-ADD*ZERO     YL0018  20
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 PRKHPPST
00002 HPEPAYPCMP
00003 PRKTEST
00004 ISPPATE
00005 ISSMASO
00006 ISRCENT
00007 ISPURVAP
00008 ISROSEM
00009 ISSHARONZ
00010 ISSZURN
00011 ISJHIGH
00012 ISJBADE
00013 ISJAMESB
00014 ISDNGUY
00015 ISDANNYN
00016 PRKTESTGU
00017 PRKTESTST
00018 PRKTESTTF
00019 TPMTEST
00020 TFTST961
00021 ISSUSANM
00022 ISJULIUSH
00023 ISBGUTI
00024 ISBARBG
00025 ISBBARK
00026 ISNFOY
00027 ISNATHANF
00028 ISDREDD
00029 PRKHPEINFO
00030 M3HPEVCH
00031 M3HPEDST
00032 M3DIVISION
00033 HPEPSHTOCO
