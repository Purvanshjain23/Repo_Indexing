     H/TITLE Crt Hog Pop PrmOptNll XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : COOL:2E  Version: 62050
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL                     n
     H* System        : HPEDEVMDL
     H* User name     : ISRCENT
     H* Date          : 04/26/01  Time  : 16:26:53
     H* Copyright     : HPEDEVMDL                     n
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKDACPL1IF  E           K        DISK
      * RTV : Hog Population Rpt Hdr    Retrieval index
      *
     FPKC9CPL1IF  E           K        DISK
      * RTV : Hog Population Rpt Dtl    Retrieval index
      *
     FPKFBCPL1IF  E           K        DISK
      * RTV : Hog Population Hdr Outf 2 Retrieval index
      *
     FPKFCCPL1IF  E           K        DISK
      * RTV : Hog Population Dtl Outf 2 Retrieval index
      *
     FPKFBCPL0UF  E           K        DISK                      A
      * UPD : Hog Population Hdr Outf 2 Update index
      *
     FPKFCCPL0UF  E           K        DISK                      A
      * UPD : Hog Population Dtl Outf 2 Update index
      *
     I@DACPQW
      * Hog Population Rpt Hdr    Retrieval index
      * Renamed input format fields
     I              DAK1ST                          WAK1ST
     I              DAJCTX                          WAJCTX
     I              DAQYNB                          WAQYNB
     I              DAKZST                          WAKZST
     I              DAK0ST                          WAK0ST
     I              DAR6NB                          WAR6NB
     I              DACMDT                          WACMDT
     I              DACODT                          WACODT
     I              DAENNB                          WAENNB
     I              DATNST                          WATNST
     I              DARKNB                          WARKNB
     I              DARLNB                          WARLNB
     I              DARMNB                          WARMNB
     I              DARNNB                          WARNNB
     I              DARONB                          WARONB
     I              DARPNB                          WARPNB
     I              DARQNB                          WARQNB
     I              DARRNB                          WARRNB
     I              DARSNB                          WARSNB
     I              DARTNB                          WARTNB
     I              DARUNB                          WARUNB
     I              DARVNB                          WARVNB
     I              DARWNB                          WARWNB
     I              DARXNB                          WARXNB
     I              DARYNB                          WARYNB
     I              DARZNB                          WARZNB
     I              DAR0NB                          WAR0NB
     I              DAR1NB                          WAR1NB
     I              DAR2NB                          WAR2NB
     I              DAR3NB                          WAR3NB
     I              DAR7NB                          WAR7NB
     I              DAEONB                          WAEONB
     I              DAEWPC                          WAEWPC
     I              DAEXPC                          WAEXPC
     I              DAR4NB                          WAR4NB
     I              DAEYPC                          WAEYPC
     I              DAE0PC                          WAE0PC
     I              DAAACD                          WAAACD
     I              DAABCD                          WAABCD
     I              DAHTCD                          WAHTCD
     I              DAAAVN                          WAAAVN
     I              DAAADT                          WAAADT
     I              DAAMTM                          WAAMTM
     I              DAAJST                          WAAJST
     I              DAAHVN                          WAAHVN
     I              DAAGVN                          WAAGVN
     I              DAABVN                          WAABVN
     I              DAABDT                          WAABDT
     I              DAABTM                          WAABTM
      *
     I@C9CPQT
      * Hog Population Rpt Dtl    Retrieval index
      * Renamed input format fields
     I              C9K1ST                          WBK1ST
     I              C9JCTX                          WBJCTX
     I              C9QUNB                          WBQUNB
     I              C9QVNB                          WBQVNB
     I              C9QWNB                          WBQWNB
     I              C9QXNB                          WBQXNB
     I              C9QZNB                          WBQZNB
     I              C9Q0NB                          WBQ0NB
     I              C9Q1NB                          WBQ1NB
     I              C9Q2NB                          WBQ2NB
     I              C9Q3NB                          WBQ3NB
     I              C9Q4NB                          WBQ4NB
     I              C9Q5NB                          WBQ5NB
     I              C9Q6NB                          WBQ6NB
     I              C9Q7NB                          WBQ7NB
     I              C9Q8NB                          WBQ8NB
     I              C9Q9NB                          WBQ9NB
     I              C9RANB                          WBRANB
     I              C9RBNB                          WBRBNB
     I              C9RCNB                          WBRCNB
     I              C9RDNB                          WBRDNB
     I              C9RENB                          WBRENB
     I              C9RFNB                          WBRFNB
     I              C9RGNB                          WBRGNB
     I              C9RHNB                          WBRHNB
     I              C9RINB                          WBRINB
     I              C9RJNB                          WBRJNB
     I              C9LMPR                          WBLMPR
     I              C9LNPR                          WBLNPR
     I              C9LOPR                          WBLOPR
     I              C9LPPR                          WBLPPR
     I              C9LQPR                          WBLQPR
     I              C9LRPR                          WBLRPR
     I              C9LSPR                          WBLSPR
     I              C9LTPR                          WBLTPR
     I              C9LUPR                          WBLUPR
     I              C9L0PR                          WBL0PR
     I              C9LVPR                          WBLVPR
     I              C9LWPR                          WBLWPR
     I              C9LXPR                          WBLXPR
     I              C9LYPR                          WBLYPR
     I              C9LZPR                          WBLZPR
     I              C9L1PR                          WBL1PR
     I              C9L2PR                          WBL2PR
     I              C9L3PR                          WBL3PR
     I              C9L4PR                          WBL4PR
     I              C9L5PR                          WBL5PR
     I              C9AAVN                          WBAAVN
     I              C9AADT                          WBAADT
     I              C9AMTM                          WBAMTM
     I              C9AJST                          WBAJST
     I              C9AHVN                          WBAHVN
     I              C9AGVN                          WBAGVN
     I              C9ABVN                          WBABVN
     I              C9ABDT                          WBABDT
     I              C9ABTM                          WBABTM
      *
     I@FBCPGU
      * Hog Population Hdr Outf 2 Retrieval index
      * Renamed input format fields
     I              FBK1ST                          WCK1ST
     I              FBFJA1                          WCFJA1
     I              FBFKA1                          WCFKA1
     I              FBFIA1                          WCFIA1
     I              FBCMDT                          WCCMDT
     I              FBCODT                          WCCODT
     I              FBFLA1                          WCFLA1
     I              FBFMA1                          WCFMA1
     I              FBFNA1                          WCFNA1
     I              FBFOA1                          WCFOA1
     I              FBFPA1                          WCFPA1
      *
     I@FBCPGT
      * Hog Population Hdr Outf 2 Update index
      * Renamed input format fields
     I              FBK1ST                          WDK1ST
     I              FBFJA1                          WDFJA1
     I              FBFKA1                          WDFKA1
     I              FBFIA1                          WDFIA1
     I              FBCMDT                          WDCMDT
     I              FBCODT                          WDCODT
     I              FBFLA1                          WDFLA1
     I              FBFMA1                          WDFMA1
     I              FBFNA1                          WDFNA1
     I              FBFOA1                          WDFOA1
     I              FBFPA1                          WDFPA1
      *
     I@FCCPGX
      * Hog Population Dtl Outf 2 Retrieval index
      * Renamed input format fields
     I              FCK1ST                          WEK1ST
     I              FCB0DT                          WEB0DT
     I              FCQUNB                          WEQUNB
     I              FCQVNB                          WEQVNB
     I              FCFIA1                          WEFIA1
     I              FCQWNB                          WEQWNB
     I              FCQXNB                          WEQXNB
     I              FCFHA1                          WEFHA1
     I              FCRJNB                          WERJNB
     I              FCU1PR                          WEU1PR
      *
     I@FCCPGW
      * Hog Population Dtl Outf 2 Update index
      * Renamed input format fields
     I              FCK1ST                          WFK1ST
     I              FCB0DT                          WFB0DT
     I              FCQUNB                          WFQUNB
     I              FCQVNB                          WFQVNB
     I              FCFIA1                          WFFIA1
     I              FCQWNB                          WFQWNB
     I              FCQXNB                          WFQXNB
     I              FCFHA1                          WFFHA1
     I              FCRJNB                          WFRJNB
     I              FCU1PR                          WFU1PR
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKFB1    E DSPKFBCPL0
      * UPD : Hog Population Hdr Outf 2 Update index
      * Renamed input format fields
     I              FBK1ST                          WDK1ST
     I              FBFJA1                          WDFJA1
     I              FBFKA1                          WDFKA1
     I              FBFIA1                          WDFIA1
     I              FBCMDT                          WDCMDT
     I              FBCODT                          WDCODT
     I              FBFLA1                          WDFLA1
     I              FBFMA1                          WDFMA1
     I              FBFNA1                          WDFNA1
     I              FBFOA1                          WDFOA1
     I              FBFPA1                          WDFPA1
      *
     IYARDCS      DS                             38
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKFC1    E DSPKFCCPL0
      * UPD : Hog Population Dtl Outf 2 Update index
      * Renamed input format fields
     I              FCK1ST                          WFK1ST
     I              FCB0DT                          WFB0DT
     I              FCQUNB                          WFQUNB
     I              FCQVNB                          WFQVNB
     I              FCFIA1                          WFFIA1
     I              FCQWNB                          WFQWNB
     I              FCQXNB                          WFQXNB
     I              FCFHA1                          WFFHA1
     I              FCRJNB                          WFRJNB
     I              FCU1PR                          WFU1PR
      *
     IYBRDCS      DS                             35
     IYCRDCS      DS                             38
     IYDRDCS      DS                             35
     IYERDCS      DS                             38
     IYFRDCS      DS                             35
     IYGRDCS      DS                             38
     IYHRDCS      DS                             35
     IYIRDCS      DS                             38
     IYJRDCS      DS                             35
     IYKRDCS      DS                             38
     IYLRDCS      DS                             35
     IYMRDCS      DS                             38
     IYNRDCS      DS                             35
     IYORDCS      DS                             38
     IYPRDCS      DS                             35
     IYQRDCS      DS                             38
     IYRRDCS      DS                             35
     IYSRDCS      DS                             38
     IYTRDCS      DS                             35
     IYURDCS      DS                             38
     IYVRDCS      DS                             35
     IYWRDCS      DS                             38
     IYXRDCS      DS                             35
     IYYRDCS      DS                             38
     IYZRDCS      DS                             35
     IY0RDCS      DS                             38
     IY1RDCS      DS                             35
     IY2RDCS      DS                             38
     IY3RDCS      DS                             35
     IY4RDCS      DS                             38
     IY5RDCS      DS                             35
     IY6RDCS      DS                             38
     IY7RDCS      DS                             35
     IY8RDCS      DS                             38
     IY9RDCS      DS                             35
     IXARDCS      DS                             38
     IXBRDCS      DS                             35
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  TH Kill Date
     I                                    P   1   40P1B0DT
     IP2PARM      DS
      * FLD: Hog Population Rpt Hdr
      * I :  HRH From Kill Date
     I                                    P   1   40P2CMDT
      * I :  HRH To Kill Date
     I                                    P   5   80P2CODT
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1B0DT    PARM           WP0001  70       TH Kill Date
     C           P2CMDT    PARM           WP0002  70       HRH From Kill D
     C           P2CODT    PARM           WP0003  70       HRH To Kill Dat
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Crt Hog Pop PrmOptNll XF
      * Create NLL records in outfile Hdr and Detail
      * Rtv Hop Pop f/PrmOpt  RT - Hog Population Rpt Hdr  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         NACHRC    BEGSR
      *================================================================
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0025  51       HRH Avg Hot Wgt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YQRDC   1
      *
      * Move key fields to @FBCPGT
     C                     MOVELWCK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWCFJA1    WDFJA1           HRH Min Carcass
     C                     Z-ADDWCFKA1    WDFKA1           HRH Max Carcass
     C                     Z-ADDWCFIA1    WDFIA1           HRH Carcass Hdr
      *
     C           KLCHNA    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
     C           KLCHNA    CHAIN@FBCPGT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFBCPL0'MDACP
     C                     MOVEL'@FBCPGT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL017.
     C                     MOVEL'LBL017'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NAEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFB1    YQRDCS
      * Move non-key fields to @FBCPGT
     C                     Z-ADDWCCMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDWCCODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWCFLA1    WDFLA1           HRH Min Live We
     C                     Z-ADDWCFMA1    WDFMA1           HRH Max Live We
     C                     Z-ADDYL0002    WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFB1    IFNE YQRDCS
     C           YQRDC     ANDNE'N'
     C                     MOVE 'Y'       YQRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YQRDC     IFEQ 'Y'
     C                     UPDAT@FBCPGT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFBCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNB     KLIST
     C                     KFLD           WEK1ST           HRH Type Of Dis
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WEQUNB           HRD Min Carcass
     C                     KFLD           WEQVNB           HRD Max Carcass
     C                     KFLD           WEFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WEK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WEB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WEQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WEQVNB           HRD Max Carcass
     C                     Z-ADDWARSNB    WEFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSNB     CHAIN@FCCPGX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0985' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
     C                     EXSR NCCRRC
     C                     GOTO NBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WEFHA1    ADD  *ZERO     YL0003           HRD Dist Carcas
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
     C                     EXSR NDCHRC
     C                     ENDIF
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0026  70       HRD Percent Tot
     C                     Z-ADD*ZERO     WN0027 152       HRD Dist Hot Wt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARSNB    WFFIA1           HRH Carcass Hdr
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADD*ZERO     WFFHA1           HRD Dist Carcas
      *
     C           KLCRNC    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRNC    SETLL@FCCPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0986' W0RTN   7
      * Send message 'Hog Population 1237180'
     C                     MOVEL'PRK0986' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NCEXIT
     C                     ENDIF
      *
     C                     WRITE@FCCPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YRRDC   1
      *
      * Move key fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARSNB    WFFIA1           HRH Carcass Hdr
      *
     C           KLCHND    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
     C           KLCHND    CHAIN@FCCPGW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFCCPL0'MDACP
     C                     MOVEL'@FCCPGW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL018.
     C                     MOVEL'LBL018'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFC1    YRRDCS
      * Move non-key fields to @FCCPGW
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADDYL0003    WFFHA1           HRD Dist Carcas
     C                     Z-ADD*ZERO     WFRJNB           HRD Percent Tot
     C                     Z-ADD*ZERO     WFU1PR           HRD Dist Hot Wt
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFC1    IFNE YRRDCS
     C           YRRDC     ANDNE'N'
     C                     MOVE 'Y'       YRRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YRRDC     IFEQ 'Y'
     C                     UPDAT@FCCPGW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         NERVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNE     KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCFJA1           HRH Min Carcass
     C                     KFLD           WCFKA1           HRH Max Carcass
     C                     KFLD           WCFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WCK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WCFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WCFKA1           HRH Max Carcass
     C                     Z-ADDWARTNB    WCFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSNE     CHAIN@FBCPGU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0954' W0RTN   7
      * USER: Processing if Data record not found
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
     C                     EXSR NFCRRC
     C                     GOTO NEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WCFNA1    ADD  *ZERO     YL0002           HRH Dist Carcas
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
     C                     ADD  WCFOA1    YL0001           HRH Total Hot W
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
     C                     EXSR NGCHRC
     C                     ENDIF
      *================================================================
     CSR         NEEXIT    ENDSR
      /EJECT
     CSR         NFCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FBCPGT
     C                     MOVELWBK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WDFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WDFKA1           HRH Max Carcass
     C                     Z-ADDWARTNB    WDFIA1           HRH Carcass Hdr
     C                     Z-ADDP2CMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDP2CODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWBQWNB    WDFLA1           HRH Min Live We
     C                     Z-ADDWBQXNB    WDFMA1           HRH Max Live We
     C                     Z-ADD*ZERO     WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
     C                     Z-ADD*ZERO     WDFPA1           HRH Avg Hot Wgt
      *
     C           KLCRNF    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRNF    SETLL@FBCPGT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0955' W0RTN   7
      * Send message 'Hog Population Hdr Out EX'
     C                     MOVEL'PRK0955' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NFEXIT
     C                     ENDIF
      *
     C                     WRITE@FBCPGT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NFEXIT    ENDSR
      /EJECT
     CSR         NGCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0028  51       HRH Avg Hot Wgt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YSRDC   1
      *
      * Move key fields to @FBCPGT
     C                     MOVELWCK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWCFJA1    WDFJA1           HRH Min Carcass
     C                     Z-ADDWCFKA1    WDFKA1           HRH Max Carcass
     C                     Z-ADDWCFIA1    WDFIA1           HRH Carcass Hdr
      *
     C           KLCHNG    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
     C           KLCHNG    CHAIN@FBCPGT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFBCPL0'MDACP
     C                     MOVEL'@FBCPGT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL019.
     C                     MOVEL'LBL019'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFB1    YSRDCS
      * Move non-key fields to @FBCPGT
     C                     Z-ADDWCCMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDWCCODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWCFLA1    WDFLA1           HRH Min Live We
     C                     Z-ADDWCFMA1    WDFMA1           HRH Max Live We
     C                     Z-ADDYL0002    WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFB1    IFNE YSRDCS
     C           YSRDC     ANDNE'N'
     C                     MOVE 'Y'       YSRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YSRDC     IFEQ 'Y'
     C                     UPDAT@FBCPGT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFBCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NGEXIT    ENDSR
      /EJECT
     CSR         NHRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNH     KLIST
     C                     KFLD           WEK1ST           HRH Type Of Dis
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WEQUNB           HRD Min Carcass
     C                     KFLD           WEQVNB           HRD Max Carcass
     C                     KFLD           WEFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WEK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WEB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WEQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WEQVNB           HRD Max Carcass
     C                     Z-ADDWARTNB    WEFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSNH     CHAIN@FCCPGX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0985' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
     C                     EXSR NICRRC
     C                     GOTO NHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WEFHA1    ADD  *ZERO     YL0003           HRD Dist Carcas
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
     C                     EXSR NJCHRC
     C                     ENDIF
      *================================================================
     CSR         NHEXIT    ENDSR
      /EJECT
     CSR         NICRRC    BEGSR
      *================================================================
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0029  70       HRD Percent Tot
     C                     Z-ADD*ZERO     WN0030 152       HRD Dist Hot Wt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARTNB    WFFIA1           HRH Carcass Hdr
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADD*ZERO     WFFHA1           HRD Dist Carcas
      *
     C           KLCRNI    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRNI    SETLL@FCCPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0986' W0RTN   7
      * Send message 'Hog Population 1237180'
     C                     MOVEL'PRK0986' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NIEXIT
     C                     ENDIF
      *
     C                     WRITE@FCCPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NIEXIT    ENDSR
      /EJECT
     CSR         NJCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YTRDC   1
      *
      * Move key fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARTNB    WFFIA1           HRH Carcass Hdr
      *
     C           KLCHNJ    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
     C           KLCHNJ    CHAIN@FCCPGW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFCCPL0'MDACP
     C                     MOVEL'@FCCPGW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL020.
     C                     MOVEL'LBL020'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFC1    YTRDCS
      * Move non-key fields to @FCCPGW
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADDYL0003    WFFHA1           HRD Dist Carcas
     C                     Z-ADD*ZERO     WFRJNB           HRD Percent Tot
     C                     Z-ADD*ZERO     WFU1PR           HRD Dist Hot Wt
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFC1    IFNE YTRDCS
     C           YTRDC     ANDNE'N'
     C                     MOVE 'Y'       YTRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YTRDC     IFEQ 'Y'
     C                     UPDAT@FCCPGW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NJEXIT    ENDSR
      /EJECT
     CSR         NKRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNK     KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCFJA1           HRH Min Carcass
     C                     KFLD           WCFKA1           HRH Max Carcass
     C                     KFLD           WCFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WCK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WCFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WCFKA1           HRH Max Carcass
     C                     Z-ADDWARUNB    WCFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSNK     CHAIN@FBCPGU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0954' W0RTN   7
      * USER: Processing if Data record not found
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
     C                     EXSR NLCRRC
     C                     GOTO NKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WCFNA1    ADD  *ZERO     YL0002           HRH Dist Carcas
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
     C                     ADD  WCFOA1    YL0001           HRH Total Hot W
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
     C                     EXSR NMCHRC
     C                     ENDIF
      *================================================================
     CSR         NKEXIT    ENDSR
      /EJECT
     CSR         NLCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FBCPGT
     C                     MOVELWBK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WDFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WDFKA1           HRH Max Carcass
     C                     Z-ADDWARUNB    WDFIA1           HRH Carcass Hdr
     C                     Z-ADDP2CMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDP2CODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWBQWNB    WDFLA1           HRH Min Live We
     C                     Z-ADDWBQXNB    WDFMA1           HRH Max Live We
     C                     Z-ADD*ZERO     WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
     C                     Z-ADD*ZERO     WDFPA1           HRH Avg Hot Wgt
      *
     C           KLCRNL    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRNL    SETLL@FBCPGT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0955' W0RTN   7
      * Send message 'Hog Population Hdr Out EX'
     C                     MOVEL'PRK0955' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NLEXIT
     C                     ENDIF
      *
     C                     WRITE@FBCPGT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NLEXIT    ENDSR
      /EJECT
     CSR         NMCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0031  51       HRH Avg Hot Wgt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YURDC   1
      *
      * Move key fields to @FBCPGT
     C                     MOVELWCK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWCFJA1    WDFJA1           HRH Min Carcass
     C                     Z-ADDWCFKA1    WDFKA1           HRH Max Carcass
     C                     Z-ADDWCFIA1    WDFIA1           HRH Carcass Hdr
      *
     C           KLCHNM    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
     C           KLCHNM    CHAIN@FBCPGT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFBCPL0'MDACP
     C                     MOVEL'@FBCPGT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL021.
     C                     MOVEL'LBL021'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFB1    YURDCS
      * Move non-key fields to @FBCPGT
     C                     Z-ADDWCCMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDWCCODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWCFLA1    WDFLA1           HRH Min Live We
     C                     Z-ADDWCFMA1    WDFMA1           HRH Max Live We
     C                     Z-ADDYL0002    WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFB1    IFNE YURDCS
     C           YURDC     ANDNE'N'
     C                     MOVE 'Y'       YURDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YURDC     IFEQ 'Y'
     C                     UPDAT@FBCPGT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFBCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NMEXIT    ENDSR
      /EJECT
     CSR         NNRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNN     KLIST
     C                     KFLD           WEK1ST           HRH Type Of Dis
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WEQUNB           HRD Min Carcass
     C                     KFLD           WEQVNB           HRD Max Carcass
     C                     KFLD           WEFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WEK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WEB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WEQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WEQVNB           HRD Max Carcass
     C                     Z-ADDWARUNB    WEFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSNN     CHAIN@FCCPGX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0985' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
     C                     EXSR NOCRRC
     C                     GOTO NNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WEFHA1    ADD  *ZERO     YL0003           HRD Dist Carcas
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
     C                     EXSR NPCHRC
     C                     ENDIF
      *================================================================
     CSR         NNEXIT    ENDSR
      /EJECT
     CSR         NOCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0032  70       HRD Percent Tot
     C                     Z-ADD*ZERO     WN0033 152       HRD Dist Hot Wt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARUNB    WFFIA1           HRH Carcass Hdr
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADD*ZERO     WFFHA1           HRD Dist Carcas
      *
     C           KLCRNO    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRNO    SETLL@FCCPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0986' W0RTN   7
      * Send message 'Hog Population 1237180'
     C                     MOVEL'PRK0986' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NOEXIT
     C                     ENDIF
      *
     C                     WRITE@FCCPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NOEXIT    ENDSR
      /EJECT
     CSR         NPCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YVRDC   1
      *
      * Move key fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARUNB    WFFIA1           HRH Carcass Hdr
      *
     C           KLCHNP    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
     C           KLCHNP    CHAIN@FCCPGW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFCCPL0'MDACP
     C                     MOVEL'@FCCPGW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL022.
     C                     MOVEL'LBL022'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFC1    YVRDCS
      * Move non-key fields to @FCCPGW
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADDYL0003    WFFHA1           HRD Dist Carcas
     C                     Z-ADD*ZERO     WFRJNB           HRD Percent Tot
     C                     Z-ADD*ZERO     WFU1PR           HRD Dist Hot Wt
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFC1    IFNE YVRDCS
     C           YVRDC     ANDNE'N'
     C                     MOVE 'Y'       YVRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YVRDC     IFEQ 'Y'
     C                     UPDAT@FCCPGW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NPEXIT    ENDSR
      /EJECT
     CSR         NQRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNQ     KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCFJA1           HRH Min Carcass
     C                     KFLD           WCFKA1           HRH Max Carcass
     C                     KFLD           WCFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WCK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WCFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WCFKA1           HRH Max Carcass
     C                     Z-ADDWARVNB    WCFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSNQ     CHAIN@FBCPGU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0954' W0RTN   7
      * USER: Processing if Data record not found
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
     C                     EXSR NRCRRC
     C                     GOTO NQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WCFNA1    ADD  *ZERO     YL0002           HRH Dist Carcas
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
     C                     ADD  WCFOA1    YL0001           HRH Total Hot W
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
     C                     EXSR NSCHRC
     C                     ENDIF
      *================================================================
     CSR         NQEXIT    ENDSR
      /EJECT
     CSR         NRCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FBCPGT
     C                     MOVELWBK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WDFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WDFKA1           HRH Max Carcass
     C                     Z-ADDWARVNB    WDFIA1           HRH Carcass Hdr
     C                     Z-ADDP2CMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDP2CODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWBQWNB    WDFLA1           HRH Min Live We
     C                     Z-ADDWBQXNB    WDFMA1           HRH Max Live We
     C                     Z-ADD*ZERO     WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
     C                     Z-ADD*ZERO     WDFPA1           HRH Avg Hot Wgt
      *
     C           KLCRNR    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRNR    SETLL@FBCPGT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0955' W0RTN   7
      * Send message 'Hog Population Hdr Out EX'
     C                     MOVEL'PRK0955' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NREXIT
     C                     ENDIF
      *
     C                     WRITE@FBCPGT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NREXIT    ENDSR
      /EJECT
     CSR         NSCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0034  51       HRH Avg Hot Wgt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YWRDC   1
      *
      * Move key fields to @FBCPGT
     C                     MOVELWCK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWCFJA1    WDFJA1           HRH Min Carcass
     C                     Z-ADDWCFKA1    WDFKA1           HRH Max Carcass
     C                     Z-ADDWCFIA1    WDFIA1           HRH Carcass Hdr
      *
     C           KLCHNS    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
     C           KLCHNS    CHAIN@FBCPGT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFBCPL0'MDACP
     C                     MOVEL'@FBCPGT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL023.
     C                     MOVEL'LBL023'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFB1    YWRDCS
      * Move non-key fields to @FBCPGT
     C                     Z-ADDWCCMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDWCCODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWCFLA1    WDFLA1           HRH Min Live We
     C                     Z-ADDWCFMA1    WDFMA1           HRH Max Live We
     C                     Z-ADDYL0002    WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFB1    IFNE YWRDCS
     C           YWRDC     ANDNE'N'
     C                     MOVE 'Y'       YWRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YWRDC     IFEQ 'Y'
     C                     UPDAT@FBCPGT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFBCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NSEXIT    ENDSR
      /EJECT
     CSR         NTRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNT     KLIST
     C                     KFLD           WEK1ST           HRH Type Of Dis
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WEQUNB           HRD Min Carcass
     C                     KFLD           WEQVNB           HRD Max Carcass
     C                     KFLD           WEFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WEK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WEB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WEQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WEQVNB           HRD Max Carcass
     C                     Z-ADDWARVNB    WEFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSNT     CHAIN@FCCPGX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0985' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
     C                     EXSR NUCRRC
     C                     GOTO NTEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WEFHA1    ADD  *ZERO     YL0003           HRD Dist Carcas
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
     C                     EXSR NVCHRC
     C                     ENDIF
      *================================================================
     CSR         NTEXIT    ENDSR
      /EJECT
     CSR         NUCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0035  70       HRD Percent Tot
     C                     Z-ADD*ZERO     WN0036 152       HRD Dist Hot Wt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARVNB    WFFIA1           HRH Carcass Hdr
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADD*ZERO     WFFHA1           HRD Dist Carcas
      *
     C           KLCRNU    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRNU    SETLL@FCCPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0986' W0RTN   7
      * Send message 'Hog Population 1237180'
     C                     MOVEL'PRK0986' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NUEXIT
     C                     ENDIF
      *
     C                     WRITE@FCCPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NUEXIT    ENDSR
      /EJECT
     CSR         NVCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YXRDC   1
      *
      * Move key fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARVNB    WFFIA1           HRH Carcass Hdr
      *
     C           KLCHNV    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
     C           KLCHNV    CHAIN@FCCPGW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFCCPL0'MDACP
     C                     MOVEL'@FCCPGW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL024.
     C                     MOVEL'LBL024'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NVEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFC1    YXRDCS
      * Move non-key fields to @FCCPGW
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADDYL0003    WFFHA1           HRD Dist Carcas
     C                     Z-ADD*ZERO     WFRJNB           HRD Percent Tot
     C                     Z-ADD*ZERO     WFU1PR           HRD Dist Hot Wt
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFC1    IFNE YXRDCS
     C           YXRDC     ANDNE'N'
     C                     MOVE 'Y'       YXRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YXRDC     IFEQ 'Y'
     C                     UPDAT@FCCPGW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NVEXIT    ENDSR
      /EJECT
     CSR         NWRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNW     KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCFJA1           HRH Min Carcass
     C                     KFLD           WCFKA1           HRH Max Carcass
     C                     KFLD           WCFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WCK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WCFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WCFKA1           HRH Max Carcass
     C                     Z-ADDWARWNB    WCFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSNW     CHAIN@FBCPGU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0954' W0RTN   7
      * USER: Processing if Data record not found
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
     C                     EXSR NXCRRC
     C                     GOTO NWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WCFNA1    ADD  *ZERO     YL0002           HRH Dist Carcas
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
     C                     ADD  WCFOA1    YL0001           HRH Total Hot W
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
     C                     EXSR NYCHRC
     C                     ENDIF
      *================================================================
     CSR         NWEXIT    ENDSR
      /EJECT
     CSR         NXCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FBCPGT
     C                     MOVELWBK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WDFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WDFKA1           HRH Max Carcass
     C                     Z-ADDWARWNB    WDFIA1           HRH Carcass Hdr
     C                     Z-ADDP2CMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDP2CODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWBQWNB    WDFLA1           HRH Min Live We
     C                     Z-ADDWBQXNB    WDFMA1           HRH Max Live We
     C                     Z-ADD*ZERO     WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
     C                     Z-ADD*ZERO     WDFPA1           HRH Avg Hot Wgt
      *
     C           KLCRNX    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRNX    SETLL@FBCPGT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0955' W0RTN   7
      * Send message 'Hog Population Hdr Out EX'
     C                     MOVEL'PRK0955' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NXEXIT
     C                     ENDIF
      *
     C                     WRITE@FBCPGT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NXEXIT    ENDSR
      /EJECT
     CSR         NYCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0037  51       HRH Avg Hot Wgt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YYRDC   1
      *
      * Move key fields to @FBCPGT
     C                     MOVELWCK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWCFJA1    WDFJA1           HRH Min Carcass
     C                     Z-ADDWCFKA1    WDFKA1           HRH Max Carcass
     C                     Z-ADDWCFIA1    WDFIA1           HRH Carcass Hdr
      *
     C           KLCHNY    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
     C           KLCHNY    CHAIN@FBCPGT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFBCPL0'MDACP
     C                     MOVEL'@FBCPGT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL025.
     C                     MOVEL'LBL025'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFB1    YYRDCS
      * Move non-key fields to @FBCPGT
     C                     Z-ADDWCCMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDWCCODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWCFLA1    WDFLA1           HRH Min Live We
     C                     Z-ADDWCFMA1    WDFMA1           HRH Max Live We
     C                     Z-ADDYL0002    WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFB1    IFNE YYRDCS
     C           YYRDC     ANDNE'N'
     C                     MOVE 'Y'       YYRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YYRDC     IFEQ 'Y'
     C                     UPDAT@FBCPGT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFBCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NYEXIT    ENDSR
      /EJECT
     CSR         NZRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSNZ     KLIST
     C                     KFLD           WEK1ST           HRH Type Of Dis
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WEQUNB           HRD Min Carcass
     C                     KFLD           WEQVNB           HRD Max Carcass
     C                     KFLD           WEFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WEK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WEB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WEQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WEQVNB           HRD Max Carcass
     C                     Z-ADDWARWNB    WEFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSNZ     CHAIN@FCCPGX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0985' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
     C                     EXSR OACRRC
     C                     GOTO NZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WEFHA1    ADD  *ZERO     YL0003           HRD Dist Carcas
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
     C                     EXSR OBCHRC
     C                     ENDIF
      *================================================================
     CSR         NZEXIT    ENDSR
      /EJECT
     CSR         OACRRC    BEGSR
      *================================================================
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0038  70       HRD Percent Tot
     C                     Z-ADD*ZERO     WN0039 152       HRD Dist Hot Wt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARWNB    WFFIA1           HRH Carcass Hdr
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADD*ZERO     WFFHA1           HRD Dist Carcas
      *
     C           KLCROA    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCROA    SETLL@FCCPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0986' W0RTN   7
      * Send message 'Hog Population 1237180'
     C                     MOVEL'PRK0986' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OAEXIT
     C                     ENDIF
      *
     C                     WRITE@FCCPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OAEXIT    ENDSR
      /EJECT
     CSR         OBCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YZRDC   1
      *
      * Move key fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARWNB    WFFIA1           HRH Carcass Hdr
      *
     C           KLCHOB    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
     C           KLCHOB    CHAIN@FCCPGW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFCCPL0'MDACP
     C                     MOVEL'@FCCPGW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL026.
     C                     MOVEL'LBL026'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFC1    YZRDCS
      * Move non-key fields to @FCCPGW
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADDYL0003    WFFHA1           HRD Dist Carcas
     C                     Z-ADD*ZERO     WFRJNB           HRD Percent Tot
     C                     Z-ADD*ZERO     WFU1PR           HRD Dist Hot Wt
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFC1    IFNE YZRDCS
     C           YZRDC     ANDNE'N'
     C                     MOVE 'Y'       YZRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YZRDC     IFEQ 'Y'
     C                     UPDAT@FCCPGW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OBEXIT    ENDSR
      /EJECT
     CSR         OCRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOC     KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCFJA1           HRH Min Carcass
     C                     KFLD           WCFKA1           HRH Max Carcass
     C                     KFLD           WCFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WCK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WCFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WCFKA1           HRH Max Carcass
     C                     Z-ADDWARXNB    WCFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSOC     CHAIN@FBCPGU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0954' W0RTN   7
      * USER: Processing if Data record not found
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
     C                     EXSR ODCRRC
     C                     GOTO OCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WCFNA1    ADD  *ZERO     YL0002           HRH Dist Carcas
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
     C                     ADD  WCFOA1    YL0001           HRH Total Hot W
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
     C                     EXSR OECHRC
     C                     ENDIF
      *================================================================
     CSR         OCEXIT    ENDSR
      /EJECT
     CSR         ODCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FBCPGT
     C                     MOVELWBK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WDFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WDFKA1           HRH Max Carcass
     C                     Z-ADDWARXNB    WDFIA1           HRH Carcass Hdr
     C                     Z-ADDP2CMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDP2CODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWBQWNB    WDFLA1           HRH Min Live We
     C                     Z-ADDWBQXNB    WDFMA1           HRH Max Live We
     C                     Z-ADD*ZERO     WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
     C                     Z-ADD*ZERO     WDFPA1           HRH Avg Hot Wgt
      *
     C           KLCROD    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCROD    SETLL@FBCPGT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0955' W0RTN   7
      * Send message 'Hog Population Hdr Out EX'
     C                     MOVEL'PRK0955' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO ODEXIT
     C                     ENDIF
      *
     C                     WRITE@FBCPGT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         ODEXIT    ENDSR
      /EJECT
     CSR         OECHRC    BEGSR
      *================================================================
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0040  51       HRH Avg Hot Wgt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    Y0RDC   1
      *
      * Move key fields to @FBCPGT
     C                     MOVELWCK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWCFJA1    WDFJA1           HRH Min Carcass
     C                     Z-ADDWCFKA1    WDFKA1           HRH Max Carcass
     C                     Z-ADDWCFIA1    WDFIA1           HRH Carcass Hdr
      *
     C           KLCHOE    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
     C           KLCHOE    CHAIN@FBCPGT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFBCPL0'MDACP
     C                     MOVEL'@FBCPGT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL027.
     C                     MOVEL'LBL027'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFB1    Y0RDCS
      * Move non-key fields to @FBCPGT
     C                     Z-ADDWCCMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDWCCODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWCFLA1    WDFLA1           HRH Min Live We
     C                     Z-ADDWCFMA1    WDFMA1           HRH Max Live We
     C                     Z-ADDYL0002    WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFB1    IFNE Y0RDCS
     C           Y0RDC     ANDNE'N'
     C                     MOVE 'Y'       Y0RDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           Y0RDC     IFEQ 'Y'
     C                     UPDAT@FBCPGT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFBCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OEEXIT    ENDSR
      /EJECT
     CSR         OFRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOF     KLIST
     C                     KFLD           WEK1ST           HRH Type Of Dis
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WEQUNB           HRD Min Carcass
     C                     KFLD           WEQVNB           HRD Max Carcass
     C                     KFLD           WEFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WEK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WEB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WEQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WEQVNB           HRD Max Carcass
     C                     Z-ADDWARXNB    WEFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSOF     CHAIN@FCCPGX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0985' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
     C                     EXSR OGCRRC
     C                     GOTO OFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WEFHA1    ADD  *ZERO     YL0003           HRD Dist Carcas
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
     C                     EXSR OHCHRC
     C                     ENDIF
      *================================================================
     CSR         OFEXIT    ENDSR
      /EJECT
     CSR         OGCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0041  70       HRD Percent Tot
     C                     Z-ADD*ZERO     WN0042 152       HRD Dist Hot Wt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARXNB    WFFIA1           HRH Carcass Hdr
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADD*ZERO     WFFHA1           HRD Dist Carcas
      *
     C           KLCROG    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCROG    SETLL@FCCPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0986' W0RTN   7
      * Send message 'Hog Population 1237180'
     C                     MOVEL'PRK0986' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OGEXIT
     C                     ENDIF
      *
     C                     WRITE@FCCPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OGEXIT    ENDSR
      /EJECT
     CSR         OHCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    Y1RDC   1
      *
      * Move key fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARXNB    WFFIA1           HRH Carcass Hdr
      *
     C           KLCHOH    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
     C           KLCHOH    CHAIN@FCCPGW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFCCPL0'MDACP
     C                     MOVEL'@FCCPGW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL028.
     C                     MOVEL'LBL028'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFC1    Y1RDCS
      * Move non-key fields to @FCCPGW
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADDYL0003    WFFHA1           HRD Dist Carcas
     C                     Z-ADD*ZERO     WFRJNB           HRD Percent Tot
     C                     Z-ADD*ZERO     WFU1PR           HRD Dist Hot Wt
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFC1    IFNE Y1RDCS
     C           Y1RDC     ANDNE'N'
     C                     MOVE 'Y'       Y1RDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           Y1RDC     IFEQ 'Y'
     C                     UPDAT@FCCPGW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OHEXIT    ENDSR
      /EJECT
     CSR         OIRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOI     KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCFJA1           HRH Min Carcass
     C                     KFLD           WCFKA1           HRH Max Carcass
     C                     KFLD           WCFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WCK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WCFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WCFKA1           HRH Max Carcass
     C                     Z-ADDWARYNB    WCFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSOI     CHAIN@FBCPGU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0954' W0RTN   7
      * USER: Processing if Data record not found
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
     C                     EXSR OJCRRC
     C                     GOTO OIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WCFNA1    ADD  *ZERO     YL0002           HRH Dist Carcas
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
     C                     ADD  WCFOA1    YL0001           HRH Total Hot W
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
     C                     EXSR OKCHRC
     C                     ENDIF
      *================================================================
     CSR         OIEXIT    ENDSR
      /EJECT
     CSR         OJCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FBCPGT
     C                     MOVELWBK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WDFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WDFKA1           HRH Max Carcass
     C                     Z-ADDWARYNB    WDFIA1           HRH Carcass Hdr
     C                     Z-ADDP2CMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDP2CODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWBQWNB    WDFLA1           HRH Min Live We
     C                     Z-ADDWBQXNB    WDFMA1           HRH Max Live We
     C                     Z-ADD*ZERO     WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
     C                     Z-ADD*ZERO     WDFPA1           HRH Avg Hot Wgt
      *
     C           KLCROJ    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCROJ    SETLL@FBCPGT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0955' W0RTN   7
      * Send message 'Hog Population Hdr Out EX'
     C                     MOVEL'PRK0955' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OJEXIT
     C                     ENDIF
      *
     C                     WRITE@FBCPGT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OJEXIT    ENDSR
      /EJECT
     CSR         OKCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0043  51       HRH Avg Hot Wgt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    Y2RDC   1
      *
      * Move key fields to @FBCPGT
     C                     MOVELWCK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWCFJA1    WDFJA1           HRH Min Carcass
     C                     Z-ADDWCFKA1    WDFKA1           HRH Max Carcass
     C                     Z-ADDWCFIA1    WDFIA1           HRH Carcass Hdr
      *
     C           KLCHOK    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
     C           KLCHOK    CHAIN@FBCPGT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFBCPL0'MDACP
     C                     MOVEL'@FBCPGT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL029.
     C                     MOVEL'LBL029'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFB1    Y2RDCS
      * Move non-key fields to @FBCPGT
     C                     Z-ADDWCCMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDWCCODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWCFLA1    WDFLA1           HRH Min Live We
     C                     Z-ADDWCFMA1    WDFMA1           HRH Max Live We
     C                     Z-ADDYL0002    WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFB1    IFNE Y2RDCS
     C           Y2RDC     ANDNE'N'
     C                     MOVE 'Y'       Y2RDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           Y2RDC     IFEQ 'Y'
     C                     UPDAT@FBCPGT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFBCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OKEXIT    ENDSR
      /EJECT
     CSR         OLRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOL     KLIST
     C                     KFLD           WEK1ST           HRH Type Of Dis
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WEQUNB           HRD Min Carcass
     C                     KFLD           WEQVNB           HRD Max Carcass
     C                     KFLD           WEFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WEK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WEB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WEQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WEQVNB           HRD Max Carcass
     C                     Z-ADDWARYNB    WEFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSOL     CHAIN@FCCPGX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0985' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
     C                     EXSR OMCRRC
     C                     GOTO OLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WEFHA1    ADD  *ZERO     YL0003           HRD Dist Carcas
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
     C                     EXSR ONCHRC
     C                     ENDIF
      *================================================================
     CSR         OLEXIT    ENDSR
      /EJECT
     CSR         OMCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0044  70       HRD Percent Tot
     C                     Z-ADD*ZERO     WN0045 152       HRD Dist Hot Wt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARYNB    WFFIA1           HRH Carcass Hdr
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADD*ZERO     WFFHA1           HRD Dist Carcas
      *
     C           KLCROM    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCROM    SETLL@FCCPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0986' W0RTN   7
      * Send message 'Hog Population 1237180'
     C                     MOVEL'PRK0986' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OMEXIT
     C                     ENDIF
      *
     C                     WRITE@FCCPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OMEXIT    ENDSR
      /EJECT
     CSR         ONCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    Y3RDC   1
      *
      * Move key fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARYNB    WFFIA1           HRH Carcass Hdr
      *
     C           KLCHON    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
     C           KLCHON    CHAIN@FCCPGW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFCCPL0'MDACP
     C                     MOVEL'@FCCPGW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL030.
     C                     MOVEL'LBL030'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO ONEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO ONEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFC1    Y3RDCS
      * Move non-key fields to @FCCPGW
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADDYL0003    WFFHA1           HRD Dist Carcas
     C                     Z-ADD*ZERO     WFRJNB           HRD Percent Tot
     C                     Z-ADD*ZERO     WFU1PR           HRD Dist Hot Wt
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFC1    IFNE Y3RDCS
     C           Y3RDC     ANDNE'N'
     C                     MOVE 'Y'       Y3RDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           Y3RDC     IFEQ 'Y'
     C                     UPDAT@FCCPGW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         ONEXIT    ENDSR
      /EJECT
     CSR         OORVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOO     KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCFJA1           HRH Min Carcass
     C                     KFLD           WCFKA1           HRH Max Carcass
     C                     KFLD           WCFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WCK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WCFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WCFKA1           HRH Max Carcass
     C                     Z-ADDWARZNB    WCFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSOO     CHAIN@FBCPGU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0954' W0RTN   7
      * USER: Processing if Data record not found
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
     C                     EXSR OPCRRC
     C                     GOTO OOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WCFNA1    ADD  *ZERO     YL0002           HRH Dist Carcas
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
     C                     ADD  WCFOA1    YL0001           HRH Total Hot W
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
     C                     EXSR OQCHRC
     C                     ENDIF
      *================================================================
     CSR         OOEXIT    ENDSR
      /EJECT
     CSR         OPCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FBCPGT
     C                     MOVELWBK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WDFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WDFKA1           HRH Max Carcass
     C                     Z-ADDWARZNB    WDFIA1           HRH Carcass Hdr
     C                     Z-ADDP2CMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDP2CODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWBQWNB    WDFLA1           HRH Min Live We
     C                     Z-ADDWBQXNB    WDFMA1           HRH Max Live We
     C                     Z-ADD*ZERO     WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
     C                     Z-ADD*ZERO     WDFPA1           HRH Avg Hot Wgt
      *
     C           KLCROP    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCROP    SETLL@FBCPGT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0955' W0RTN   7
      * Send message 'Hog Population Hdr Out EX'
     C                     MOVEL'PRK0955' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OPEXIT
     C                     ENDIF
      *
     C                     WRITE@FBCPGT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OPEXIT    ENDSR
      /EJECT
     CSR         OQCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0046  51       HRH Avg Hot Wgt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    Y4RDC   1
      *
      * Move key fields to @FBCPGT
     C                     MOVELWCK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWCFJA1    WDFJA1           HRH Min Carcass
     C                     Z-ADDWCFKA1    WDFKA1           HRH Max Carcass
     C                     Z-ADDWCFIA1    WDFIA1           HRH Carcass Hdr
      *
     C           KLCHOQ    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
     C           KLCHOQ    CHAIN@FBCPGT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFBCPL0'MDACP
     C                     MOVEL'@FBCPGT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL031.
     C                     MOVEL'LBL031'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFB1    Y4RDCS
      * Move non-key fields to @FBCPGT
     C                     Z-ADDWCCMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDWCCODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWCFLA1    WDFLA1           HRH Min Live We
     C                     Z-ADDWCFMA1    WDFMA1           HRH Max Live We
     C                     Z-ADDYL0002    WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFB1    IFNE Y4RDCS
     C           Y4RDC     ANDNE'N'
     C                     MOVE 'Y'       Y4RDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           Y4RDC     IFEQ 'Y'
     C                     UPDAT@FBCPGT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFBCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OQEXIT    ENDSR
      /EJECT
     CSR         ORRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOR     KLIST
     C                     KFLD           WEK1ST           HRH Type Of Dis
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WEQUNB           HRD Min Carcass
     C                     KFLD           WEQVNB           HRD Max Carcass
     C                     KFLD           WEFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WEK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WEB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WEQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WEQVNB           HRD Max Carcass
     C                     Z-ADDWARZNB    WEFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSOR     CHAIN@FCCPGX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0985' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
     C                     EXSR OSCRRC
     C                     GOTO OREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WEFHA1    ADD  *ZERO     YL0003           HRD Dist Carcas
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
     C                     EXSR OTCHRC
     C                     ENDIF
      *================================================================
     CSR         OREXIT    ENDSR
      /EJECT
     CSR         OSCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0047  70       HRD Percent Tot
     C                     Z-ADD*ZERO     WN0048 152       HRD Dist Hot Wt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARZNB    WFFIA1           HRH Carcass Hdr
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADD*ZERO     WFFHA1           HRD Dist Carcas
      *
     C           KLCROS    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCROS    SETLL@FCCPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0986' W0RTN   7
      * Send message 'Hog Population 1237180'
     C                     MOVEL'PRK0986' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OSEXIT
     C                     ENDIF
      *
     C                     WRITE@FCCPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OSEXIT    ENDSR
      /EJECT
     CSR         OTCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    Y5RDC   1
      *
      * Move key fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARZNB    WFFIA1           HRH Carcass Hdr
      *
     C           KLCHOT    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
     C           KLCHOT    CHAIN@FCCPGW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFCCPL0'MDACP
     C                     MOVEL'@FCCPGW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL032.
     C                     MOVEL'LBL032'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OTEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OTEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFC1    Y5RDCS
      * Move non-key fields to @FCCPGW
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADDYL0003    WFFHA1           HRD Dist Carcas
     C                     Z-ADD*ZERO     WFRJNB           HRD Percent Tot
     C                     Z-ADD*ZERO     WFU1PR           HRD Dist Hot Wt
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFC1    IFNE Y5RDCS
     C           Y5RDC     ANDNE'N'
     C                     MOVE 'Y'       Y5RDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           Y5RDC     IFEQ 'Y'
     C                     UPDAT@FCCPGW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OTEXIT    ENDSR
      /EJECT
     CSR         OURVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOU     KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCFJA1           HRH Min Carcass
     C                     KFLD           WCFKA1           HRH Max Carcass
     C                     KFLD           WCFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WCK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WCFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WCFKA1           HRH Max Carcass
     C                     Z-ADDWAR0NB    WCFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSOU     CHAIN@FBCPGU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0954' W0RTN   7
      * USER: Processing if Data record not found
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
     C                     EXSR OVCRRC
     C                     GOTO OUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WCFNA1    ADD  *ZERO     YL0002           HRH Dist Carcas
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
     C                     ADD  WCFOA1    YL0001           HRH Total Hot W
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
     C                     EXSR OWCHRC
     C                     ENDIF
      *================================================================
     CSR         OUEXIT    ENDSR
      /EJECT
     CSR         OVCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FBCPGT
     C                     MOVELWBK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WDFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WDFKA1           HRH Max Carcass
     C                     Z-ADDWAR0NB    WDFIA1           HRH Carcass Hdr
     C                     Z-ADDP2CMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDP2CODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWBQWNB    WDFLA1           HRH Min Live We
     C                     Z-ADDWBQXNB    WDFMA1           HRH Max Live We
     C                     Z-ADD*ZERO     WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
     C                     Z-ADD*ZERO     WDFPA1           HRH Avg Hot Wgt
      *
     C           KLCROV    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCROV    SETLL@FBCPGT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0955' W0RTN   7
      * Send message 'Hog Population Hdr Out EX'
     C                     MOVEL'PRK0955' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OVEXIT
     C                     ENDIF
      *
     C                     WRITE@FBCPGT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OVEXIT    ENDSR
      /EJECT
     CSR         OWCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0049  51       HRH Avg Hot Wgt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    Y6RDC   1
      *
      * Move key fields to @FBCPGT
     C                     MOVELWCK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWCFJA1    WDFJA1           HRH Min Carcass
     C                     Z-ADDWCFKA1    WDFKA1           HRH Max Carcass
     C                     Z-ADDWCFIA1    WDFIA1           HRH Carcass Hdr
      *
     C           KLCHOW    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
     C           KLCHOW    CHAIN@FBCPGT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFBCPL0'MDACP
     C                     MOVEL'@FBCPGT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL033.
     C                     MOVEL'LBL033'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFB1    Y6RDCS
      * Move non-key fields to @FBCPGT
     C                     Z-ADDWCCMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDWCCODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWCFLA1    WDFLA1           HRH Min Live We
     C                     Z-ADDWCFMA1    WDFMA1           HRH Max Live We
     C                     Z-ADDYL0002    WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFB1    IFNE Y6RDCS
     C           Y6RDC     ANDNE'N'
     C                     MOVE 'Y'       Y6RDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           Y6RDC     IFEQ 'Y'
     C                     UPDAT@FBCPGT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFBCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OWEXIT    ENDSR
      /EJECT
     CSR         OXRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSOX     KLIST
     C                     KFLD           WEK1ST           HRH Type Of Dis
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WEQUNB           HRD Min Carcass
     C                     KFLD           WEQVNB           HRD Max Carcass
     C                     KFLD           WEFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WEK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WEB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WEQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WEQVNB           HRD Max Carcass
     C                     Z-ADDWAR0NB    WEFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSOX     CHAIN@FCCPGX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0985' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
     C                     EXSR OYCRRC
     C                     GOTO OXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WEFHA1    ADD  *ZERO     YL0003           HRD Dist Carcas
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
     C                     EXSR OZCHRC
     C                     ENDIF
      *================================================================
     CSR         OXEXIT    ENDSR
      /EJECT
     CSR         OYCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0050  70       HRD Percent Tot
     C                     Z-ADD*ZERO     WN0051 152       HRD Dist Hot Wt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWAR0NB    WFFIA1           HRH Carcass Hdr
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADD*ZERO     WFFHA1           HRD Dist Carcas
      *
     C           KLCROY    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCROY    SETLL@FCCPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0986' W0RTN   7
      * Send message 'Hog Population 1237180'
     C                     MOVEL'PRK0986' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO OYEXIT
     C                     ENDIF
      *
     C                     WRITE@FCCPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         OYEXIT    ENDSR
      /EJECT
     CSR         OZCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    Y7RDC   1
      *
      * Move key fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWAR0NB    WFFIA1           HRH Carcass Hdr
      *
     C           KLCHOZ    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
     C           KLCHOZ    CHAIN@FCCPGW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFCCPL0'MDACP
     C                     MOVEL'@FCCPGW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL034.
     C                     MOVEL'LBL034'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO OZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO OZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFC1    Y7RDCS
      * Move non-key fields to @FCCPGW
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADDYL0003    WFFHA1           HRD Dist Carcas
     C                     Z-ADD*ZERO     WFRJNB           HRD Percent Tot
     C                     Z-ADD*ZERO     WFU1PR           HRD Dist Hot Wt
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFC1    IFNE Y7RDCS
     C           Y7RDC     ANDNE'N'
     C                     MOVE 'Y'       Y7RDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           Y7RDC     IFEQ 'Y'
     C                     UPDAT@FCCPGW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         OZEXIT    ENDSR
      /EJECT
     CSR         PARVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPA     KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCFJA1           HRH Min Carcass
     C                     KFLD           WCFKA1           HRH Max Carcass
     C                     KFLD           WCFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WCK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WCFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WCFKA1           HRH Max Carcass
     C                     Z-ADDWAR1NB    WCFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSPA     CHAIN@FBCPGU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0954' W0RTN   7
      * USER: Processing if Data record not found
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
     C                     EXSR PBCRRC
     C                     GOTO PAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WCFNA1    ADD  *ZERO     YL0002           HRH Dist Carcas
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
     C                     ADD  WCFOA1    YL0001           HRH Total Hot W
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
     C                     EXSR PCCHRC
     C                     ENDIF
      *================================================================
     CSR         PAEXIT    ENDSR
      /EJECT
     CSR         PBCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FBCPGT
     C                     MOVELWBK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WDFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WDFKA1           HRH Max Carcass
     C                     Z-ADDWAR1NB    WDFIA1           HRH Carcass Hdr
     C                     Z-ADDP2CMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDP2CODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWBQWNB    WDFLA1           HRH Min Live We
     C                     Z-ADDWBQXNB    WDFMA1           HRH Max Live We
     C                     Z-ADD*ZERO     WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
     C                     Z-ADD*ZERO     WDFPA1           HRH Avg Hot Wgt
      *
     C           KLCRPB    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRPB    SETLL@FBCPGT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0955' W0RTN   7
      * Send message 'Hog Population Hdr Out EX'
     C                     MOVEL'PRK0955' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO PBEXIT
     C                     ENDIF
      *
     C                     WRITE@FBCPGT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         PBEXIT    ENDSR
      /EJECT
     CSR         PCCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0052  51       HRH Avg Hot Wgt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    Y8RDC   1
      *
      * Move key fields to @FBCPGT
     C                     MOVELWCK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWCFJA1    WDFJA1           HRH Min Carcass
     C                     Z-ADDWCFKA1    WDFKA1           HRH Max Carcass
     C                     Z-ADDWCFIA1    WDFIA1           HRH Carcass Hdr
      *
     C           KLCHPC    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
     C           KLCHPC    CHAIN@FBCPGT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFBCPL0'MDACP
     C                     MOVEL'@FBCPGT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL035.
     C                     MOVEL'LBL035'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFB1    Y8RDCS
      * Move non-key fields to @FBCPGT
     C                     Z-ADDWCCMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDWCCODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWCFLA1    WDFLA1           HRH Min Live We
     C                     Z-ADDWCFMA1    WDFMA1           HRH Max Live We
     C                     Z-ADDYL0002    WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFB1    IFNE Y8RDCS
     C           Y8RDC     ANDNE'N'
     C                     MOVE 'Y'       Y8RDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           Y8RDC     IFEQ 'Y'
     C                     UPDAT@FBCPGT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFBCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PCEXIT    ENDSR
      /EJECT
     CSR         PDRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPD     KLIST
     C                     KFLD           WEK1ST           HRH Type Of Dis
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WEQUNB           HRD Min Carcass
     C                     KFLD           WEQVNB           HRD Max Carcass
     C                     KFLD           WEFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WEK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WEB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WEQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WEQVNB           HRD Max Carcass
     C                     Z-ADDWAR1NB    WEFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSPD     CHAIN@FCCPGX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0985' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
     C                     EXSR PECRRC
     C                     GOTO PDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WEFHA1    ADD  *ZERO     YL0003           HRD Dist Carcas
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
     C                     EXSR PFCHRC
     C                     ENDIF
      *================================================================
     CSR         PDEXIT    ENDSR
      /EJECT
     CSR         PECRRC    BEGSR
      *================================================================
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0053  70       HRD Percent Tot
     C                     Z-ADD*ZERO     WN0054 152       HRD Dist Hot Wt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWAR1NB    WFFIA1           HRH Carcass Hdr
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADD*ZERO     WFFHA1           HRD Dist Carcas
      *
     C           KLCRPE    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRPE    SETLL@FCCPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0986' W0RTN   7
      * Send message 'Hog Population 1237180'
     C                     MOVEL'PRK0986' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO PEEXIT
     C                     ENDIF
      *
     C                     WRITE@FCCPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         PEEXIT    ENDSR
      /EJECT
     CSR         PFCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    Y9RDC   1
      *
      * Move key fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWAR1NB    WFFIA1           HRH Carcass Hdr
      *
     C           KLCHPF    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
     C           KLCHPF    CHAIN@FCCPGW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFCCPL0'MDACP
     C                     MOVEL'@FCCPGW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL036.
     C                     MOVEL'LBL036'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFC1    Y9RDCS
      * Move non-key fields to @FCCPGW
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADDYL0003    WFFHA1           HRD Dist Carcas
     C                     Z-ADD*ZERO     WFRJNB           HRD Percent Tot
     C                     Z-ADD*ZERO     WFU1PR           HRD Dist Hot Wt
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFC1    IFNE Y9RDCS
     C           Y9RDC     ANDNE'N'
     C                     MOVE 'Y'       Y9RDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           Y9RDC     IFEQ 'Y'
     C                     UPDAT@FCCPGW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PFEXIT    ENDSR
      /EJECT
     CSR         PGRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPG     KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCFJA1           HRH Min Carcass
     C                     KFLD           WCFKA1           HRH Max Carcass
     C                     KFLD           WCFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WCK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WCFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WCFKA1           HRH Max Carcass
     C                     Z-ADDWAR2NB    WCFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSPG     CHAIN@FBCPGU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0954' W0RTN   7
      * USER: Processing if Data record not found
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
     C                     EXSR PHCRRC
     C                     GOTO PGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WCFNA1    ADD  *ZERO     YL0002           HRH Dist Carcas
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
     C                     ADD  WCFOA1    YL0001           HRH Total Hot W
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
     C                     EXSR PICHRC
     C                     ENDIF
      *================================================================
     CSR         PGEXIT    ENDSR
      /EJECT
     CSR         PHCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FBCPGT
     C                     MOVELWBK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WDFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WDFKA1           HRH Max Carcass
     C                     Z-ADDWAR2NB    WDFIA1           HRH Carcass Hdr
     C                     Z-ADDP2CMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDP2CODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWBQWNB    WDFLA1           HRH Min Live We
     C                     Z-ADDWBQXNB    WDFMA1           HRH Max Live We
     C                     Z-ADD*ZERO     WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
     C                     Z-ADD*ZERO     WDFPA1           HRH Avg Hot Wgt
      *
     C           KLCRPH    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRPH    SETLL@FBCPGT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0955' W0RTN   7
      * Send message 'Hog Population Hdr Out EX'
     C                     MOVEL'PRK0955' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO PHEXIT
     C                     ENDIF
      *
     C                     WRITE@FBCPGT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         PHEXIT    ENDSR
      /EJECT
     CSR         PICHRC    BEGSR
      *================================================================
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0055  51       HRH Avg Hot Wgt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    XARDC   1
      *
      * Move key fields to @FBCPGT
     C                     MOVELWCK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWCFJA1    WDFJA1           HRH Min Carcass
     C                     Z-ADDWCFKA1    WDFKA1           HRH Max Carcass
     C                     Z-ADDWCFIA1    WDFIA1           HRH Carcass Hdr
      *
     C           KLCHPI    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
     C           KLCHPI    CHAIN@FBCPGT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFBCPL0'MDACP
     C                     MOVEL'@FBCPGT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL037.
     C                     MOVEL'LBL037'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFB1    XARDCS
      * Move non-key fields to @FBCPGT
     C                     Z-ADDWCCMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDWCCODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWCFLA1    WDFLA1           HRH Min Live We
     C                     Z-ADDWCFMA1    WDFMA1           HRH Max Live We
     C                     Z-ADDYL0002    WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFB1    IFNE XARDCS
     C           XARDC     ANDNE'N'
     C                     MOVE 'Y'       XARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           XARDC     IFEQ 'Y'
     C                     UPDAT@FBCPGT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFBCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PIEXIT    ENDSR
      /EJECT
     CSR         PJRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSPJ     KLIST
     C                     KFLD           WEK1ST           HRH Type Of Dis
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WEQUNB           HRD Min Carcass
     C                     KFLD           WEQVNB           HRD Max Carcass
     C                     KFLD           WEFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WEK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WEB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WEQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WEQVNB           HRD Max Carcass
     C                     Z-ADDWAR2NB    WEFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSPJ     CHAIN@FCCPGX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0985' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
     C                     EXSR PKCRRC
     C                     GOTO PJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WEFHA1    ADD  *ZERO     YL0003           HRD Dist Carcas
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
     C                     EXSR PLCHRC
     C                     ENDIF
      *================================================================
     CSR         PJEXIT    ENDSR
      /EJECT
     CSR         PKCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0056  70       HRD Percent Tot
     C                     Z-ADD*ZERO     WN0057 152       HRD Dist Hot Wt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWAR2NB    WFFIA1           HRH Carcass Hdr
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADD*ZERO     WFFHA1           HRD Dist Carcas
      *
     C           KLCRPK    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRPK    SETLL@FCCPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0986' W0RTN   7
      * Send message 'Hog Population 1237180'
     C                     MOVEL'PRK0986' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO PKEXIT
     C                     ENDIF
      *
     C                     WRITE@FCCPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         PKEXIT    ENDSR
      /EJECT
     CSR         PLCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    XBRDC   1
      *
      * Move key fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWAR2NB    WFFIA1           HRH Carcass Hdr
      *
     C           KLCHPL    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
     C           KLCHPL    CHAIN@FCCPGW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFCCPL0'MDACP
     C                     MOVEL'@FCCPGW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL038.
     C                     MOVEL'LBL038'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO PLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO PLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFC1    XBRDCS
      * Move non-key fields to @FCCPGW
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADDYL0003    WFFHA1           HRD Dist Carcas
     C                     Z-ADD*ZERO     WFRJNB           HRD Percent Tot
     C                     Z-ADD*ZERO     WFU1PR           HRD Dist Hot Wt
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFC1    IFNE XBRDCS
     C           XBRDC     ANDNE'N'
     C                     MOVE 'Y'       XBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           XBRDC     IFEQ 'Y'
     C                     UPDAT@FCCPGW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         PLEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Hop Pop f/PrmOpt  RT - Hog Population Rpt Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@DACPQW                    *
     C                     READ @DACPQW                  90*
      * Data record not found
     C   90                MOVEL'PRK0478' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Hog Pop PrmOpt    RT - Hog Population Rpt Dtl  * 
     C                     EXSR SBRVGN
     C                     GOTO SAEXIT                     *QUIT
     C                     READ @DACPQW                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Hog Pop PrmOpt    RT - Hog Population Rpt Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBK1ST    WQSB01           HRH Type Of Dis
     C           *LIKE     DEFN WBJCTX    WQSB02           HRH Report Brea
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           HRH Type Of Dis
     C                     KFLD           WQSB02           HRH Report Brea
      * Setup key
     C                     MOVELWAK1ST    WQSB01           HRH Type Of Dis
     C                     MOVELWAJCTX    WQSB02           HRH Report Brea
      * Establish starting position
     C           KRSSB     SETLL@C9CPQT                    *
     C           KRSSB     READE@C9CPQT                  90*
      * Data record not found
     C   90                MOVEL'PRK0476' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
     C                     EXSR SCRVGN
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
     C                     EXSR SFRVGN
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
     C                     EXSR SIRVGN
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
     C                     EXSR SLRVGN
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
     C                     EXSR SORVGN
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
     C                     EXSR SRRVGN
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
     C                     EXSR SURVGN
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
     C                     EXSR SXRVGN
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
     C                     EXSR TARVGN
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
     C                     EXSR TDRVGN
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
     C                     EXSR TGRVGN
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
     C                     EXSR TJRVGN
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
     C                     EXSR TMRVGN
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
     C                     EXSR TPRVGN
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
     C                     EXSR TSRVGN
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
     C                     EXSR TVRVGN
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
     C                     EXSR TYRVGN
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
     C                     EXSR NBRVGN
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
     C                     EXSR NERVGN
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
     C                     EXSR NHRVGN
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
     C                     EXSR NKRVGN
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
     C                     EXSR NNRVGN
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
     C                     EXSR NQRVGN
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
     C                     EXSR NTRVGN
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
     C                     EXSR NWRVGN
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
     C                     EXSR NZRVGN
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
     C                     EXSR OCRVGN
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
     C                     EXSR OFRVGN
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
     C                     EXSR OIRVGN
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
     C                     EXSR OLRVGN
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
     C                     EXSR OORVGN
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
     C                     EXSR ORRVGN
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
     C                     EXSR OURVGN
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
     C                     EXSR OXRVGN
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
     C                     EXSR PARVGN
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
     C                     EXSR PDRVGN
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
     C                     EXSR PGRVGN
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
     C                     EXSR PJRVGN
     C           KRSSB     READE@C9CPQT                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCFJA1           HRH Min Carcass
     C                     KFLD           WCFKA1           HRH Max Carcass
     C                     KFLD           WCFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WCK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WCFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WCFKA1           HRH Max Carcass
     C                     Z-ADDWARKNB    WCFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSSC     CHAIN@FBCPGU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0954' W0RTN   7
      * USER: Processing if Data record not found
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
     C                     EXSR SDCRRC
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WCFNA1    ADD  *ZERO     YL0002           HRH Dist Carcas
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
     C                     ADD  WCFOA1    YL0001           HRH Total Hot W
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
     C                     EXSR SECHRC
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FBCPGT
     C                     MOVELWBK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WDFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WDFKA1           HRH Max Carcass
     C                     Z-ADDWARKNB    WDFIA1           HRH Carcass Hdr
     C                     Z-ADDP2CMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDP2CODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWBQWNB    WDFLA1           HRH Min Live We
     C                     Z-ADDWBQXNB    WDFMA1           HRH Max Live We
     C                     Z-ADD*ZERO     WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
     C                     Z-ADD*ZERO     WDFPA1           HRH Avg Hot Wgt
      *
     C           KLCRSD    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRSD    SETLL@FBCPGT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0955' W0RTN   7
      * Send message 'Hog Population Hdr Out EX'
     C                     MOVEL'PRK0955' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C                     WRITE@FBCPGT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECHRC    BEGSR
      *================================================================
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  51       HRH Avg Hot Wgt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FBCPGT
     C                     MOVELWCK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWCFJA1    WDFJA1           HRH Min Carcass
     C                     Z-ADDWCFKA1    WDFKA1           HRH Max Carcass
     C                     Z-ADDWCFIA1    WDFIA1           HRH Carcass Hdr
      *
     C           KLCHSE    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
     C           KLCHSE    CHAIN@FBCPGT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFBCPL0'MDACP
     C                     MOVEL'@FBCPGT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFB1    YARDCS
      * Move non-key fields to @FBCPGT
     C                     Z-ADDWCCMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDWCCODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWCFLA1    WDFLA1           HRH Min Live We
     C                     Z-ADDWCFMA1    WDFMA1           HRH Max Live We
     C                     Z-ADDYL0002    WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFB1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FBCPGT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFBCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WEK1ST           HRH Type Of Dis
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WEQUNB           HRD Min Carcass
     C                     KFLD           WEQVNB           HRD Max Carcass
     C                     KFLD           WEFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WEK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WEB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WEQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WEQVNB           HRD Max Carcass
     C                     Z-ADDWARKNB    WEFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSSF     CHAIN@FCCPGX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0985' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
     C                     EXSR SGCRRC
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WEFHA1    ADD  *ZERO     YL0003           HRD Dist Carcas
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
     C                     EXSR SHCHRC
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0002  70       HRD Percent Tot
     C                     Z-ADD*ZERO     WN0003 152       HRD Dist Hot Wt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARKNB    WFFIA1           HRH Carcass Hdr
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADD*ZERO     WFFHA1           HRD Dist Carcas
      *
     C           KLCRSG    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRSG    SETLL@FCCPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0986' W0RTN   7
      * Send message 'Hog Population 1237180'
     C                     MOVEL'PRK0986' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C                     WRITE@FCCPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARKNB    WFFIA1           HRH Carcass Hdr
      *
     C           KLCHSH    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
     C           KLCHSH    CHAIN@FCCPGW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFCCPL0'MDACP
     C                     MOVEL'@FCCPGW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFC1    YBRDCS
      * Move non-key fields to @FCCPGW
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADDYL0003    WFFHA1           HRD Dist Carcas
     C                     Z-ADD*ZERO     WFRJNB           HRD Percent Tot
     C                     Z-ADD*ZERO     WFU1PR           HRD Dist Hot Wt
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFC1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@FCCPGW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCFJA1           HRH Min Carcass
     C                     KFLD           WCFKA1           HRH Max Carcass
     C                     KFLD           WCFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WCK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WCFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WCFKA1           HRH Max Carcass
     C                     Z-ADDWARLNB    WCFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSSI     CHAIN@FBCPGU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0954' W0RTN   7
      * USER: Processing if Data record not found
     C           0         MULT *ZERO     YL0001           HRH Total Hot W
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
     C                     EXSR SJCRRC
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WCFNA1    ADD  0         YL0002           HRH Dist Carcas
     C           0         MULT *ZERO     YL0001           HRH Total Hot W
     C                     ADD  WCFOA1    YL0001           HRH Total Hot W
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
     C                     EXSR SKCHRC
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FBCPGT
     C                     MOVELWBK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WDFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WDFKA1           HRH Max Carcass
     C                     Z-ADDWARLNB    WDFIA1           HRH Carcass Hdr
     C                     Z-ADDP2CMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDP2CODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWBQWNB    WDFLA1           HRH Min Live We
     C                     Z-ADDWBQXNB    WDFMA1           HRH Max Live We
     C                     Z-ADD0         WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
     C                     Z-ADD*ZERO     WDFPA1           HRH Avg Hot Wgt
      *
     C           KLCRSJ    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRSJ    SETLL@FBCPGT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0955' W0RTN   7
      * Send message 'Hog Population Hdr Out EX'
     C                     MOVEL'PRK0955' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C                     WRITE@FBCPGT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0004  51       HRH Avg Hot Wgt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @FBCPGT
     C                     MOVELWCK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWCFJA1    WDFJA1           HRH Min Carcass
     C                     Z-ADDWCFKA1    WDFKA1           HRH Max Carcass
     C                     Z-ADDWCFIA1    WDFIA1           HRH Carcass Hdr
      *
     C           KLCHSK    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
     C           KLCHSK    CHAIN@FBCPGT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFBCPL0'MDACP
     C                     MOVEL'@FBCPGT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFB1    YCRDCS
      * Move non-key fields to @FBCPGT
     C                     Z-ADDWCCMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDWCCODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWCFLA1    WDFLA1           HRH Min Live We
     C                     Z-ADDWCFMA1    WDFMA1           HRH Max Live We
     C                     Z-ADDYL0002    WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFB1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@FBCPGT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFBCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WEK1ST           HRH Type Of Dis
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WEQUNB           HRD Min Carcass
     C                     KFLD           WEQVNB           HRD Max Carcass
     C                     KFLD           WEFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WEK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WEB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WEQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WEQVNB           HRD Max Carcass
     C                     Z-ADDWARLNB    WEFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSSL     CHAIN@FCCPGX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0985' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
     C                     EXSR SMCRRC
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WEFHA1    ADD  *ZERO     YL0003           HRD Dist Carcas
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
     C                     EXSR SNCHRC
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0005  70       HRD Percent Tot
     C                     Z-ADD*ZERO     WN0006 152       HRD Dist Hot Wt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARLNB    WFFIA1           HRH Carcass Hdr
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADD*ZERO     WFFHA1           HRD Dist Carcas
      *
     C           KLCRSM    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRSM    SETLL@FCCPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0986' W0RTN   7
      * Send message 'Hog Population 1237180'
     C                     MOVEL'PRK0986' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C                     WRITE@FCCPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARLNB    WFFIA1           HRH Carcass Hdr
      *
     C           KLCHSN    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
     C           KLCHSN    CHAIN@FCCPGW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFCCPL0'MDACP
     C                     MOVEL'@FCCPGW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFC1    YDRDCS
      * Move non-key fields to @FCCPGW
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADDYL0003    WFFHA1           HRD Dist Carcas
     C                     Z-ADD*ZERO     WFRJNB           HRD Percent Tot
     C                     Z-ADD*ZERO     WFU1PR           HRD Dist Hot Wt
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFC1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@FCCPGW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCFJA1           HRH Min Carcass
     C                     KFLD           WCFKA1           HRH Max Carcass
     C                     KFLD           WCFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WCK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WCFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WCFKA1           HRH Max Carcass
     C                     Z-ADDWARMNB    WCFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSSO     CHAIN@FBCPGU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0954' W0RTN   7
      * USER: Processing if Data record not found
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
     C                     EXSR SPCRRC
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WCFNA1    ADD  *ZERO     YL0002           HRH Dist Carcas
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
     C                     ADD  WCFOA1    YL0001           HRH Total Hot W
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
     C                     EXSR SQCHRC
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FBCPGT
     C                     MOVELWBK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WDFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WDFKA1           HRH Max Carcass
     C                     Z-ADDWARMNB    WDFIA1           HRH Carcass Hdr
     C                     Z-ADDP2CMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDP2CODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWBQWNB    WDFLA1           HRH Min Live We
     C                     Z-ADDWBQXNB    WDFMA1           HRH Max Live We
     C                     Z-ADD*ZERO     WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
     C                     Z-ADD*ZERO     WDFPA1           HRH Avg Hot Wgt
      *
     C           KLCRSP    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRSP    SETLL@FBCPGT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0955' W0RTN   7
      * Send message 'Hog Population Hdr Out EX'
     C                     MOVEL'PRK0955' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C                     WRITE@FBCPGT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0007  51       HRH Avg Hot Wgt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @FBCPGT
     C                     MOVELWCK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWCFJA1    WDFJA1           HRH Min Carcass
     C                     Z-ADDWCFKA1    WDFKA1           HRH Max Carcass
     C                     Z-ADDWCFIA1    WDFIA1           HRH Carcass Hdr
      *
     C           KLCHSQ    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
     C           KLCHSQ    CHAIN@FBCPGT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFBCPL0'MDACP
     C                     MOVEL'@FBCPGT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFB1    YERDCS
      * Move non-key fields to @FBCPGT
     C                     Z-ADDWCCMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDWCCODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWCFLA1    WDFLA1           HRH Min Live We
     C                     Z-ADDWCFMA1    WDFMA1           HRH Max Live We
     C                     Z-ADDYL0002    WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFB1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@FBCPGT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFBCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WEK1ST           HRH Type Of Dis
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WEQUNB           HRD Min Carcass
     C                     KFLD           WEQVNB           HRD Max Carcass
     C                     KFLD           WEFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WEK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WEB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WEQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WEQVNB           HRD Max Carcass
     C                     Z-ADDWARMNB    WEFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSSR     CHAIN@FCCPGX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0985' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
     C                     EXSR SSCRRC
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WEFHA1    ADD  *ZERO     YL0003           HRD Dist Carcas
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
     C                     EXSR STCHRC
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0008  70       HRD Percent Tot
     C                     Z-ADD*ZERO     WN0009 152       HRD Dist Hot Wt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARMNB    WFFIA1           HRH Carcass Hdr
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADD*ZERO     WFFHA1           HRD Dist Carcas
      *
     C           KLCRSS    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRSS    SETLL@FCCPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0986' W0RTN   7
      * Send message 'Hog Population 1237180'
     C                     MOVEL'PRK0986' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C                     WRITE@FCCPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARMNB    WFFIA1           HRH Carcass Hdr
      *
     C           KLCHST    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
     C           KLCHST    CHAIN@FCCPGW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFCCPL0'MDACP
     C                     MOVEL'@FCCPGW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFC1    YFRDCS
      * Move non-key fields to @FCCPGW
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADDYL0003    WFFHA1           HRD Dist Carcas
     C                     Z-ADD*ZERO     WFRJNB           HRD Percent Tot
     C                     Z-ADD*ZERO     WFU1PR           HRD Dist Hot Wt
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFC1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@FCCPGW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCFJA1           HRH Min Carcass
     C                     KFLD           WCFKA1           HRH Max Carcass
     C                     KFLD           WCFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WCK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WCFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WCFKA1           HRH Max Carcass
     C                     Z-ADDWARNNB    WCFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSSU     CHAIN@FBCPGU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0954' W0RTN   7
      * USER: Processing if Data record not found
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
     C                     EXSR SVCRRC
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WCFNA1    ADD  *ZERO     YL0002           HRH Dist Carcas
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
     C                     ADD  WCFOA1    YL0001           HRH Total Hot W
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
     C                     EXSR SWCHRC
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FBCPGT
     C                     MOVELWBK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WDFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WDFKA1           HRH Max Carcass
     C                     Z-ADDWARNNB    WDFIA1           HRH Carcass Hdr
     C                     Z-ADDP2CMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDP2CODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWBQWNB    WDFLA1           HRH Min Live We
     C                     Z-ADDWBQXNB    WDFMA1           HRH Max Live We
     C                     Z-ADD*ZERO     WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
     C                     Z-ADD*ZERO     WDFPA1           HRH Avg Hot Wgt
      *
     C           KLCRSV    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRSV    SETLL@FBCPGT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0955' W0RTN   7
      * Send message 'Hog Population Hdr Out EX'
     C                     MOVEL'PRK0955' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C                     WRITE@FBCPGT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0010  51       HRH Avg Hot Wgt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @FBCPGT
     C                     MOVELWCK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWCFJA1    WDFJA1           HRH Min Carcass
     C                     Z-ADDWCFKA1    WDFKA1           HRH Max Carcass
     C                     Z-ADDWCFIA1    WDFIA1           HRH Carcass Hdr
      *
     C           KLCHSW    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
     C           KLCHSW    CHAIN@FBCPGT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFBCPL0'MDACP
     C                     MOVEL'@FBCPGT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFB1    YGRDCS
      * Move non-key fields to @FBCPGT
     C                     Z-ADDWCCMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDWCCODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWCFLA1    WDFLA1           HRH Min Live We
     C                     Z-ADDWCFMA1    WDFMA1           HRH Max Live We
     C                     Z-ADDYL0002    WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFB1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@FBCPGT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFBCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WEK1ST           HRH Type Of Dis
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WEQUNB           HRD Min Carcass
     C                     KFLD           WEQVNB           HRD Max Carcass
     C                     KFLD           WEFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WEK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WEB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WEQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WEQVNB           HRD Max Carcass
     C                     Z-ADDWARNNB    WEFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSSX     CHAIN@FCCPGX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0985' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
     C                     EXSR SYCRRC
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WEFHA1    ADD  *ZERO     YL0003           HRD Dist Carcas
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
     C                     EXSR SZCHRC
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0011  70       HRD Percent Tot
     C                     Z-ADD*ZERO     WN0012 152       HRD Dist Hot Wt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARNNB    WFFIA1           HRH Carcass Hdr
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADD*ZERO     WFFHA1           HRD Dist Carcas
      *
     C           KLCRSY    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRSY    SETLL@FCCPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0986' W0RTN   7
      * Send message 'Hog Population 1237180'
     C                     MOVEL'PRK0986' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C                     WRITE@FCCPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARNNB    WFFIA1           HRH Carcass Hdr
      *
     C           KLCHSZ    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
     C           KLCHSZ    CHAIN@FCCPGW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFCCPL0'MDACP
     C                     MOVEL'@FCCPGW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFC1    YHRDCS
      * Move non-key fields to @FCCPGW
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADDYL0003    WFFHA1           HRD Dist Carcas
     C                     Z-ADD*ZERO     WFRJNB           HRD Percent Tot
     C                     Z-ADD*ZERO     WFU1PR           HRD Dist Hot Wt
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFC1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@FCCPGW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCFJA1           HRH Min Carcass
     C                     KFLD           WCFKA1           HRH Max Carcass
     C                     KFLD           WCFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WCK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WCFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WCFKA1           HRH Max Carcass
     C                     Z-ADDWARONB    WCFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSTA     CHAIN@FBCPGU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0954' W0RTN   7
      * USER: Processing if Data record not found
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
     C                     EXSR TBCRRC
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WCFNA1    ADD  *ZERO     YL0002           HRH Dist Carcas
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
     C                     ADD  WCFOA1    YL0001           HRH Total Hot W
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
     C                     EXSR TCCHRC
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FBCPGT
     C                     MOVELWBK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WDFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WDFKA1           HRH Max Carcass
     C                     Z-ADDWARONB    WDFIA1           HRH Carcass Hdr
     C                     Z-ADDP2CMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDP2CODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWBQWNB    WDFLA1           HRH Min Live We
     C                     Z-ADDWBQXNB    WDFMA1           HRH Max Live We
     C                     Z-ADD*ZERO     WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
     C                     Z-ADD*ZERO     WDFPA1           HRH Avg Hot Wgt
      *
     C           KLCRTB    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRTB    SETLL@FBCPGT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0955' W0RTN   7
      * Send message 'Hog Population Hdr Out EX'
     C                     MOVEL'PRK0955' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C                     WRITE@FBCPGT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0013  51       HRH Avg Hot Wgt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YIRDC   1
      *
      * Move key fields to @FBCPGT
     C                     MOVELWCK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWCFJA1    WDFJA1           HRH Min Carcass
     C                     Z-ADDWCFKA1    WDFKA1           HRH Max Carcass
     C                     Z-ADDWCFIA1    WDFIA1           HRH Carcass Hdr
      *
     C           KLCHTC    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
     C           KLCHTC    CHAIN@FBCPGT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFBCPL0'MDACP
     C                     MOVEL'@FBCPGT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFB1    YIRDCS
      * Move non-key fields to @FBCPGT
     C                     Z-ADDWCCMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDWCCODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWCFLA1    WDFLA1           HRH Min Live We
     C                     Z-ADDWCFMA1    WDFMA1           HRH Max Live We
     C                     Z-ADDYL0002    WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFB1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YIRDC     IFEQ 'Y'
     C                     UPDAT@FBCPGT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFBCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WEK1ST           HRH Type Of Dis
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WEQUNB           HRD Min Carcass
     C                     KFLD           WEQVNB           HRD Max Carcass
     C                     KFLD           WEFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WEK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WEB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WEQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WEQVNB           HRD Max Carcass
     C                     Z-ADDWARONB    WEFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSTD     CHAIN@FCCPGX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0985' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
     C                     EXSR TECRRC
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WEFHA1    ADD  *ZERO     YL0003           HRD Dist Carcas
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
     C                     EXSR TFCHRC
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TECRRC    BEGSR
      *================================================================
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0014  70       HRD Percent Tot
     C                     Z-ADD*ZERO     WN0015 152       HRD Dist Hot Wt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARONB    WFFIA1           HRH Carcass Hdr
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADD*ZERO     WFFHA1           HRD Dist Carcas
      *
     C           KLCRTE    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRTE    SETLL@FCCPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0986' W0RTN   7
      * Send message 'Hog Population 1237180'
     C                     MOVEL'PRK0986' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C                     WRITE@FCCPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YJRDC   1
      *
      * Move key fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARONB    WFFIA1           HRH Carcass Hdr
      *
     C           KLCHTF    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
     C           KLCHTF    CHAIN@FCCPGW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFCCPL0'MDACP
     C                     MOVEL'@FCCPGW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFC1    YJRDCS
      * Move non-key fields to @FCCPGW
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADDYL0003    WFFHA1           HRD Dist Carcas
     C                     Z-ADD*ZERO     WFRJNB           HRD Percent Tot
     C                     Z-ADD*ZERO     WFU1PR           HRD Dist Hot Wt
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFC1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YJRDC     IFEQ 'Y'
     C                     UPDAT@FCCPGW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCFJA1           HRH Min Carcass
     C                     KFLD           WCFKA1           HRH Max Carcass
     C                     KFLD           WCFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WCK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WCFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WCFKA1           HRH Max Carcass
     C                     Z-ADDWARPNB    WCFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSTG     CHAIN@FBCPGU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0954' W0RTN   7
      * USER: Processing if Data record not found
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
     C                     EXSR THCRRC
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WCFNA1    ADD  *ZERO     YL0002           HRH Dist Carcas
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
     C                     ADD  WCFOA1    YL0001           HRH Total Hot W
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
     C                     EXSR TICHRC
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FBCPGT
     C                     MOVELWBK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WDFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WDFKA1           HRH Max Carcass
     C                     Z-ADDWARPNB    WDFIA1           HRH Carcass Hdr
     C                     Z-ADDP2CMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDP2CODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWBQWNB    WDFLA1           HRH Min Live We
     C                     Z-ADDWBQXNB    WDFMA1           HRH Max Live We
     C                     Z-ADD*ZERO     WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
     C                     Z-ADD*ZERO     WDFPA1           HRH Avg Hot Wgt
      *
     C           KLCRTH    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRTH    SETLL@FBCPGT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0955' W0RTN   7
      * Send message 'Hog Population Hdr Out EX'
     C                     MOVEL'PRK0955' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C                     WRITE@FBCPGT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TICHRC    BEGSR
      *================================================================
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0016  51       HRH Avg Hot Wgt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YKRDC   1
      *
      * Move key fields to @FBCPGT
     C                     MOVELWCK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWCFJA1    WDFJA1           HRH Min Carcass
     C                     Z-ADDWCFKA1    WDFKA1           HRH Max Carcass
     C                     Z-ADDWCFIA1    WDFIA1           HRH Carcass Hdr
      *
     C           KLCHTI    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
     C           KLCHTI    CHAIN@FBCPGT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFBCPL0'MDACP
     C                     MOVEL'@FBCPGT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFB1    YKRDCS
      * Move non-key fields to @FBCPGT
     C                     Z-ADDWCCMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDWCCODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWCFLA1    WDFLA1           HRH Min Live We
     C                     Z-ADDWCFMA1    WDFMA1           HRH Max Live We
     C                     Z-ADDYL0002    WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFB1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YKRDC     IFEQ 'Y'
     C                     UPDAT@FBCPGT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFBCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WEK1ST           HRH Type Of Dis
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WEQUNB           HRD Min Carcass
     C                     KFLD           WEQVNB           HRD Max Carcass
     C                     KFLD           WEFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WEK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WEB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WEQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WEQVNB           HRD Max Carcass
     C                     Z-ADDWARPNB    WEFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSTJ     CHAIN@FCCPGX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0985' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
     C                     EXSR TKCRRC
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WEFHA1    ADD  *ZERO     YL0003           HRD Dist Carcas
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
     C                     EXSR TLCHRC
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0017  70       HRD Percent Tot
     C                     Z-ADD*ZERO     WN0018 152       HRD Dist Hot Wt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARPNB    WFFIA1           HRH Carcass Hdr
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADD*ZERO     WFFHA1           HRD Dist Carcas
      *
     C           KLCRTK    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRTK    SETLL@FCCPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0986' W0RTN   7
      * Send message 'Hog Population 1237180'
     C                     MOVEL'PRK0986' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C                     WRITE@FCCPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YLRDC   1
      *
      * Move key fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARPNB    WFFIA1           HRH Carcass Hdr
      *
     C           KLCHTL    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
     C           KLCHTL    CHAIN@FCCPGW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFCCPL0'MDACP
     C                     MOVEL'@FCCPGW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL012.
     C                     MOVEL'LBL012'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFC1    YLRDCS
      * Move non-key fields to @FCCPGW
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADDYL0003    WFFHA1           HRD Dist Carcas
     C                     Z-ADD*ZERO     WFRJNB           HRD Percent Tot
     C                     Z-ADD*ZERO     WFU1PR           HRD Dist Hot Wt
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFC1    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YLRDC     IFEQ 'Y'
     C                     UPDAT@FCCPGW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCFJA1           HRH Min Carcass
     C                     KFLD           WCFKA1           HRH Max Carcass
     C                     KFLD           WCFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WCK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WCFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WCFKA1           HRH Max Carcass
     C                     Z-ADDWARQNB    WCFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSTM     CHAIN@FBCPGU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0954' W0RTN   7
      * USER: Processing if Data record not found
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
     C                     EXSR TNCRRC
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WCFNA1    ADD  *ZERO     YL0002           HRH Dist Carcas
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
     C                     ADD  WCFOA1    YL0001           HRH Total Hot W
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
     C                     EXSR TOCHRC
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FBCPGT
     C                     MOVELWBK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WDFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WDFKA1           HRH Max Carcass
     C                     Z-ADDWARQNB    WDFIA1           HRH Carcass Hdr
     C                     Z-ADDP2CMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDP2CODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWBQWNB    WDFLA1           HRH Min Live We
     C                     Z-ADDWBQXNB    WDFMA1           HRH Max Live We
     C                     Z-ADD*ZERO     WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
     C                     Z-ADD*ZERO     WDFPA1           HRH Avg Hot Wgt
      *
     C           KLCRTN    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRTN    SETLL@FBCPGT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0955' W0RTN   7
      * Send message 'Hog Population Hdr Out EX'
     C                     MOVEL'PRK0955' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C                     WRITE@FBCPGT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TOCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0019  51       HRH Avg Hot Wgt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YMRDC   1
      *
      * Move key fields to @FBCPGT
     C                     MOVELWCK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWCFJA1    WDFJA1           HRH Min Carcass
     C                     Z-ADDWCFKA1    WDFKA1           HRH Max Carcass
     C                     Z-ADDWCFIA1    WDFIA1           HRH Carcass Hdr
      *
     C           KLCHTO    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
     C           KLCHTO    CHAIN@FBCPGT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFBCPL0'MDACP
     C                     MOVEL'@FBCPGT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL013.
     C                     MOVEL'LBL013'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFB1    YMRDCS
      * Move non-key fields to @FBCPGT
     C                     Z-ADDWCCMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDWCCODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWCFLA1    WDFLA1           HRH Min Live We
     C                     Z-ADDWCFMA1    WDFMA1           HRH Max Live We
     C                     Z-ADDYL0002    WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFB1    IFNE YMRDCS
     C           YMRDC     ANDNE'N'
     C                     MOVE 'Y'       YMRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YMRDC     IFEQ 'Y'
     C                     UPDAT@FBCPGT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFBCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           WEK1ST           HRH Type Of Dis
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WEQUNB           HRD Min Carcass
     C                     KFLD           WEQVNB           HRD Max Carcass
     C                     KFLD           WEFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WEK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WEB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WEQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WEQVNB           HRD Max Carcass
     C                     Z-ADDWARQNB    WEFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSTP     CHAIN@FCCPGX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0985' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
     C                     EXSR TQCRRC
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WEFHA1    ADD  *ZERO     YL0003           HRD Dist Carcas
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
     C                     EXSR TRCHRC
     C                     ENDIF
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0020  70       HRD Percent Tot
     C                     Z-ADD*ZERO     WN0021 152       HRD Dist Hot Wt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARQNB    WFFIA1           HRH Carcass Hdr
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADD*ZERO     WFFHA1           HRD Dist Carcas
      *
     C           KLCRTQ    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRTQ    SETLL@FCCPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0986' W0RTN   7
      * Send message 'Hog Population 1237180'
     C                     MOVEL'PRK0986' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C                     WRITE@FCCPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YNRDC   1
      *
      * Move key fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARQNB    WFFIA1           HRH Carcass Hdr
      *
     C           KLCHTR    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
     C           KLCHTR    CHAIN@FCCPGW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFCCPL0'MDACP
     C                     MOVEL'@FCCPGW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL014.
     C                     MOVEL'LBL014'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFC1    YNRDCS
      * Move non-key fields to @FCCPGW
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADDYL0003    WFFHA1           HRD Dist Carcas
     C                     Z-ADD*ZERO     WFRJNB           HRD Percent Tot
     C                     Z-ADD*ZERO     WFU1PR           HRD Dist Hot Wt
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFC1    IFNE YNRDCS
     C           YNRDC     ANDNE'N'
     C                     MOVE 'Y'       YNRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YNRDC     IFEQ 'Y'
     C                     UPDAT@FCCPGW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTS     KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCFJA1           HRH Min Carcass
     C                     KFLD           WCFKA1           HRH Max Carcass
     C                     KFLD           WCFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WCK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WCFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WCFKA1           HRH Max Carcass
     C                     Z-ADDWARRNB    WCFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSTS     CHAIN@FBCPGU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0954' W0RTN   7
      * USER: Processing if Data record not found
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
     C                     EXSR TTCRRC
     C                     GOTO TSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WCFNA1    ADD  *ZERO     YL0002           HRH Dist Carcas
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
     C                     ADD  WCFOA1    YL0001           HRH Total Hot W
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
     C                     EXSR TUCHRC
     C                     ENDIF
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FBCPGT
     C                     MOVELWBK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WDFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WDFKA1           HRH Max Carcass
     C                     Z-ADDWARRNB    WDFIA1           HRH Carcass Hdr
     C                     Z-ADDP2CMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDP2CODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWBQWNB    WDFLA1           HRH Min Live We
     C                     Z-ADDWBQXNB    WDFMA1           HRH Max Live We
     C                     Z-ADD*ZERO     WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
     C                     Z-ADD*ZERO     WDFPA1           HRH Avg Hot Wgt
      *
     C           KLCRTT    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRTT    SETLL@FBCPGT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0955' W0RTN   7
      * Send message 'Hog Population Hdr Out EX'
     C                     MOVEL'PRK0955' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TTEXIT
     C                     ENDIF
      *
     C                     WRITE@FBCPGT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TUCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0022  51       HRH Avg Hot Wgt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YORDC   1
      *
      * Move key fields to @FBCPGT
     C                     MOVELWCK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWCFJA1    WDFJA1           HRH Min Carcass
     C                     Z-ADDWCFKA1    WDFKA1           HRH Max Carcass
     C                     Z-ADDWCFIA1    WDFIA1           HRH Carcass Hdr
      *
     C           KLCHTU    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
     C           KLCHTU    CHAIN@FBCPGT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFBCPL0'MDACP
     C                     MOVEL'@FBCPGT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL015.
     C                     MOVEL'LBL015'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFB1    YORDCS
      * Move non-key fields to @FBCPGT
     C                     Z-ADDWCCMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDWCCODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWCFLA1    WDFLA1           HRH Min Live We
     C                     Z-ADDWCFMA1    WDFMA1           HRH Max Live We
     C                     Z-ADDYL0002    WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFB1    IFNE YORDCS
     C           YORDC     ANDNE'N'
     C                     MOVE 'Y'       YORDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YORDC     IFEQ 'Y'
     C                     UPDAT@FBCPGT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFBCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTV     KLIST
     C                     KFLD           WEK1ST           HRH Type Of Dis
     C                     KFLD           WEB0DT           TH Kill Date
     C                     KFLD           WEQUNB           HRD Min Carcass
     C                     KFLD           WEQVNB           HRD Max Carcass
     C                     KFLD           WEFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WEK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WEB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WEQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WEQVNB           HRD Max Carcass
     C                     Z-ADDWARRNB    WEFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSTV     CHAIN@FCCPGX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0985' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
     C                     EXSR TWCRRC
     C                     GOTO TVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WEFHA1    ADD  *ZERO     YL0003           HRD Dist Carcas
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
     C                     EXSR TXCHRC
     C                     ENDIF
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0023  70       HRD Percent Tot
     C                     Z-ADD*ZERO     WN0024 152       HRD Dist Hot Wt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARRNB    WFFIA1           HRH Carcass Hdr
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADD*ZERO     WFFHA1           HRD Dist Carcas
      *
     C           KLCRTW    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRTW    SETLL@FCCPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0986' W0RTN   7
      * Send message 'Hog Population 1237180'
     C                     MOVEL'PRK0986' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TWEXIT
     C                     ENDIF
      *
     C                     WRITE@FCCPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         TXCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YPRDC   1
      *
      * Move key fields to @FCCPGW
     C                     MOVELWBK1ST    WFK1ST           HRH Type Of Dis
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWBQUNB    WFQUNB           HRD Min Carcass
     C                     Z-ADDWBQVNB    WFQVNB           HRD Max Carcass
     C                     Z-ADDWARRNB    WFFIA1           HRH Carcass Hdr
      *
     C           KLCHTX    KLIST
     C                     KFLD           WFK1ST           HRH Type Of Dis
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFQUNB           HRD Min Carcass
     C                     KFLD           WFQVNB           HRD Max Carcass
     C                     KFLD           WFFIA1           HRH Carcass Hdr
     C           KLCHTX    CHAIN@FCCPGW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFCCPL0'MDACP
     C                     MOVEL'@FCCPGW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL016.
     C                     MOVEL'LBL016'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFC1    YPRDCS
      * Move non-key fields to @FCCPGW
     C                     Z-ADDWBQWNB    WFQWNB           HRD Min Live We
     C                     Z-ADDWBQXNB    WFQXNB           HRD Max Live We
     C                     Z-ADDYL0003    WFFHA1           HRD Dist Carcas
     C                     Z-ADD*ZERO     WFRJNB           HRD Percent Tot
     C                     Z-ADD*ZERO     WFU1PR           HRD Dist Hot Wt
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFC1    IFNE YPRDCS
     C           YPRDC     ANDNE'N'
     C                     MOVE 'Y'       YPRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YPRDC     IFEQ 'Y'
     C                     UPDAT@FCCPGW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TXEXIT    ENDSR
      /EJECT
     CSR         TYRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTY     KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCFJA1           HRH Min Carcass
     C                     KFLD           WCFKA1           HRH Max Carcass
     C                     KFLD           WCFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELWBK1ST    WCK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WCFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WCFKA1           HRH Max Carcass
     C                     Z-ADDWARSNB    WCFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSTY     CHAIN@FBCPGU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0954' W0RTN   7
      * USER: Processing if Data record not found
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
     C                     EXSR TZCRRC
     C                     GOTO TYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WCFNA1    ADD  *ZERO     YL0002           HRH Dist Carcas
     C           *ZERO     MULT *ZERO     YL0001           HRH Total Hot W
     C                     ADD  WCFOA1    YL0001           HRH Total Hot W
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
     C                     EXSR NACHRC
     C                     ENDIF
      *================================================================
     CSR         TYEXIT    ENDSR
      /EJECT
     CSR         TZCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FBCPGT
     C                     MOVELWBK1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDWBQUNB    WDFJA1           HRH Min Carcass
     C                     Z-ADDWBQVNB    WDFKA1           HRH Max Carcass
     C                     Z-ADDWARSNB    WDFIA1           HRH Carcass Hdr
     C                     Z-ADDP2CMDT    WDCMDT           HRH From Kill D
     C                     Z-ADDP2CODT    WDCODT           HRH To Kill Dat
     C                     Z-ADDWBQWNB    WDFLA1           HRH Min Live We
     C                     Z-ADDWBQXNB    WDFMA1           HRH Max Live We
     C                     Z-ADD*ZERO     WDFNA1           HRH Dist Carcas
     C                     Z-ADDYL0001    WDFOA1           HRH Total Hot W
     C                     Z-ADD*ZERO     WDFPA1           HRH Avg Hot Wgt
      *
     C           KLCRTZ    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDFJA1           HRH Min Carcass
     C                     KFLD           WDFKA1           HRH Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRTZ    SETLL@FBCPGT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0955' W0RTN   7
      * Send message 'Hog Population Hdr Out EX'
     C                     MOVEL'PRK0955' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TZEXIT
     C                     ENDIF
      *
     C                     WRITE@FBCPGT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TZEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAQYNB           HRH Company Num
     C                     Z-ADD*ZERO     WAR6NB           HRH Tattoo Numb
     C                     Z-ADD*ZERO     WACMDT           HRH From Kill D
     C                     Z-ADD*ZERO     WACODT           HRH To Kill Dat
     C                     Z-ADD*ZERO     WAENNB           HRH Farm Site
     C                     Z-ADD*ZERO     WARKNB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WARLNB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WARMNB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WARNNB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WARONB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WARPNB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WARQNB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WARRNB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WARSNB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WARTNB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WARUNB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WARVNB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WARWNB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WARXNB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WARYNB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WARZNB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WAR0NB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WAR1NB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WAR2NB           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WAR3NB           HRH Head Killed
     C                     Z-ADD*ZERO     WAR7NB           HRH AVG Hot Wei
     C                     Z-ADD*ZERO     WAEONB           HRH Avg Live Wg
     C                     Z-ADD*ZERO     WAEWPC           HRH Avg Light R
     C                     Z-ADD*ZERO     WAEXPC           HRH Avg Loin Ey
     C                     Z-ADD*ZERO     WAR4NB           HRH Avg Back Fa
     C                     Z-ADD*ZERO     WAEYPC           HRH Avg Lean %
     C                     Z-ADD*ZERO     WAE0PC           HRH % Adjusted
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBQUNB           HRD Min Carcass
     C                     Z-ADD*ZERO     WBQVNB           HRD Max Carcass
     C                     Z-ADD*ZERO     WBQWNB           HRD Min Live We
     C                     Z-ADD*ZERO     WBQXNB           HRD Max Live We
     C                     Z-ADD*ZERO     WBQZNB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WBQ0NB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WBQ1NB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WBQ2NB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WBQ3NB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WBQ4NB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WBQ5NB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WBQ6NB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WBQ7NB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WBQ8NB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WBQ9NB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WBRANB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WBRBNB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WBRCNB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WBRDNB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WBRENB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WBRFNB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WBRGNB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WBRHNB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WBRINB           HRD Dist Carcas
     C                     Z-ADD*ZERO     WBRJNB           HRD Percent Tot
     C                     Z-ADD*ZERO     WBLMPR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WBLNPR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WBLOPR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WBLPPR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WBLQPR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WBLRPR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WBLSPR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WBLTPR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WBLUPR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WBL0PR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WBLVPR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WBLWPR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WBLXPR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WBLYPR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WBLZPR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WBL1PR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WBL2PR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WBL3PR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WBL4PR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WBL5PR           HRD Dist Hot Wt
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCFJA1           HRH Min Carcass
     C                     Z-ADD*ZERO     WCFKA1           HRH Max Carcass
     C                     Z-ADD*ZERO     WCFIA1           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WCCMDT           HRH From Kill D
     C                     Z-ADD*ZERO     WCCODT           HRH To Kill Dat
     C                     Z-ADD*ZERO     WCFLA1           HRH Min Live We
     C                     Z-ADD*ZERO     WCFMA1           HRH Max Live We
     C                     Z-ADD*ZERO     WCFNA1           HRH Dist Carcas
     C                     Z-ADD*ZERO     WCFOA1           HRH Total Hot W
     C                     Z-ADD*ZERO     WCFPA1           HRH Avg Hot Wgt
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WEQUNB           HRD Min Carcass
     C                     Z-ADD*ZERO     WEQVNB           HRD Max Carcass
     C                     Z-ADD*ZERO     WEFIA1           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WEQWNB           HRD Min Live We
     C                     Z-ADD*ZERO     WEQXNB           HRD Max Live We
     C                     Z-ADD*ZERO     WEFHA1           HRD Dist Carcas
     C                     Z-ADD*ZERO     WERJNB           HRD Percent Tot
     C                     Z-ADD*ZERO     WEU1PR           HRD Dist Hot Wt
      * Clear all neither parameters
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
     C                     Z-ADD*ZERO     WFRJNB  70       HRD Percent Tot
     C                     Z-ADD*ZERO     WFU1PR 152       HRD Dist Hot Wt
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local work field HRH Total Hot Wgt
     C                     Z-ADD*ZERO     YL0001 152
      * Define local work field HRH Dist Carcass Cnt
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field HRD Dist Carcass Cnt
     C                     Z-ADD*ZERO     YL0003  70
      *================================================================
     CSR         ZZEXIT    ENDSR
