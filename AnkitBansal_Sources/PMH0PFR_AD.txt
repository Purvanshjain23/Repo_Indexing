// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PMH0PFR
// ?Date: 14.08.2025 Time: 12:05:34
// ?------------------------------------------------------------------------------------------------

//?USER: Initialize program

EXECUTE FUNCTION(VAL Rtv & Ctr Prt Hdg  IF) TYPE(EXCINTFUN)                     AC1258755;
PARAMETER('OMS');
{
 //?Execute internal function

 EXECUTE FUNCTION(SET Setup Prt Headings IF) TYPE(EXCINTFUN)                     AC1258771;
 PARAMETER(PAR.Application_Code);
 {
  //?Execute internal function

  EXECUTE FUNCTION(RTV Applic. Group Desc RT) TYPE(RTVOBJ) FILE(CADNREP)          AC1274118;
  PARAMETER(PAR.Application_Code);
  PARAMETER(WRK.Description);
  {
   //?USER: Process Data record

   CASE;

   // IF DB1.Application Group is Blank
   IF DB1.Application_Group = *BLANK;

   MOVE *ALL (To: PAR From: DB1);

   // IF *OTHERWISE
   IF *OTHERWISE;

   EXECUTE FUNCTION(RTV Application Desc   RT) TYPE(RTVOBJ) FILE(CADNREP)          AC1249881;
   PARAMETER(DB1.Application_Group);
   PARAMETER(PAR.Description);
   {
    //?USER: Processing if Data record not found

    MOVE *ALL (To: PAR From: CON);

    // PGM.*Return code = CND.*Record does not exist
    PGM.*Return_code = 'Y2U0005';

    //?USER: Process Data record

    MOVE *ALL (To: PAR From: DB1);

   }

   ENDIF;

  }

  // WRK.USR Description 40 = WRK.Description
  WRK.USR_Description_40 = WRK.Description;

  // Execute function CLC Center Txt Str 40  US.
  EXECUTE FUNCTION(CLC Center Txt Str 40  US) TYPE(EXCUSRSRC) ('PDYJUFR');
  PARAMETER(WRK.USR_Description_40);
  PARAMETER(WRK.USR_Description_40_2);
  {
   E                    UCT        40  1               CENTER TABLE
   C                     MOVEA#IDSC4    UCT              LOAD ARRAY
   C                     Z-ADD40        UX      20       SET COUNTER
   C           UX        DOWGT0
   C           UCT,UX    IFEQ ' '
   C                     SUB  1         UX
   C                     ELSE
   C                     Z-ADDUX        UXH     20
   C                     Z-ADD0         UX
   C                     END
   C                     END
   C           40        SUB  UXH       UX
   C           UX        DIV  2         UX
   C           UX        IFGT 0
   C                     MOVE *BLANKS   UCT
   C                     MOVEA#IDSC4    UCT,UX
   C                     END
   C                     MOVEAUCT       #ODE40           LOAD OUTPUT
  }

  // Execute function MOV Appl Desc to PrtCo US.
  EXECUTE FUNCTION(MOV Appl Desc to PrtCo US) TYPE(EXCUSRSRC) ('PD2KUFR');
  PARAMETER(WRK.USR_Description_40_2);
  {
   C                     MOVE #IDE40    $ACMP
  }

 }

}


// PAR.USR Display 1 = CND.No
PAR.USR_Display_1 = 'N';

// LCL.Page Length = CON.78
LCL.Page_Length = 78;

//?***** Change Log and Comments
//?DLY029  --  this is a New pgm for Dailys. Can be called from a prompt
//?            and evoked from the Order Entry post confirm prompt
//?** 2/22/08 SAZ Added PO  Get Order Comments for any Get Ready (PS)
//?*****
//?USER: Record selection processing

//?>>> Dept Type = "A" when all depts should be printed on the same report
CASE;

// IF PAR.Department Type is All - Dailys
IF PAR.Department_Type = 'A';

// IF *OTHERWISE
IF *OTHERWISE;

EXECUTE FUNCTION(Rtv Get Ready Rpt      RT) TYPE(RTVOBJ) FILE(OPBGWKP)          AC1829632;
PARAMETER(DB1.Company_Number);
PARAMETER(DB1.Order_Number);
PARAMETER(PAR.Department_Code);
PARAMETER(LCL.Print_Yes_No_USR);
{
 //?USER: Processing if Data record not found

 // PAR.Print (Yes/No) USR = CND.No
 PAR.Print_Yes_No_USR = 'N';

 //?USER: Process Data record

 EXECUTE FUNCTION(Rtv Export/Department RT) TYPE(RTVOBJ) FILE(CABZREP)           AC1504627;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Item_Code);
 PARAMETER(LCL.Department_Code);
 PARAMETER(NLL.Export_Domestic);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 CASE;

 // IF PAR.Department Code EQ LCL.Department Code
 IF PAR.Department_Code = LCL.Department_Code;

 // PAR.Print (Yes/No) USR = CND.Yes
 PAR.Print_Yes_No_USR = 'Y';

 QUIT;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // PAR.Print (Yes/No) USR = CND.No
 PAR.Print_Yes_No_USR = 'N';

 ENDIF;

}


CASE;

// IF LCL.Print (Yes/No) USR is Yes
IF LCL.Print_Yes_No_USR = 'Y';

// IF *OTHERWISE
IF *OTHERWISE;

// PGM.*Record selected = CND.*NO
PGM.*Record_selected = 'N';

ENDIF;

ENDIF;

//?USER: Null report processing

// Execute function CLC Set for Null Rpt   US.
EXECUTE FUNCTION(CLC Set for Null Rpt   US) TYPE(EXCUSRSRC) ('PDUUUFR');
{
 C                     MOVEL'Y'       W0AP1P
 C                     MOVEL'Y'       W0NEWP
}


// PAR.USR Display 1 = CND.Yes
PAR.USR_Display_1 = 'Y';

//?USER: Print required level headings

// SUPPRESSED PRINT Company Number header format

CASE;

IF NEW Order_Number;
// CUR.Department Code = PAR.Department Code
CUR.Department_Code = PAR.Department_Code;

// LCL.Company Number Alpha = CVTVAR(PAR.Company Number)
LCL.Company_Number_Alpha = CVTVAR(PAR.Company_Number);

// LCL.Order Number Alpha = CVTVAR(DB1.Order Number)
LCL.Order_Number_Alpha = CVTVAR(DB1.Order_Number);

// LCL.Alpha Search = CONCAT(LCL.Company Number Alpha,CON.-,CND.*None)
LCL.Alpha_Search = LCL.Company_Number_Alpha + '-' (*ZERO);

// LCL.Alpha Search = CONCAT(LCL.Alpha Search,LCL.Order Number Alpha,CND.*None)
LCL.Alpha_Search = LCL.Alpha_Search + LCL.Order_Number_Alpha (*ZERO);

// CUR.Company/Order NO Usr = LCL.Alpha Search
CUR.Company_Order_NO_Usr = LCL.Alpha_Search;

// Call program CLC Day of Week        XF.
CALL PROGRAM(CLC Day of Week        XF) ('PDXIXFR');
PARAMETER(DB1.Scheduled_Ship_Date);
PARAMETER(CUR.Day_of_the_Week_USR);

// Execute function CVT Str to Upper Alpha US.
EXECUTE FUNCTION(CVT Str to Upper Alpha US) TYPE(EXCUSRSRC) ('PDWEUFR');
PARAMETER(CUR.Day_of_the_Week_USR);
PARAMETER(CUR.Day_of_the_Week_USR);
{
 PDWEUFR:  PGM PARM(&STRIN &STROUT)

 CHGVAR VAR(&FLDOUT) VALUE('%XLATE(UPTEXT &STRIN)')
}


EXECUTE FUNCTION(RTV Customer Telephone RT) TYPE(RTVOBJ) FILE(CABBREP)          AC1216241;
PARAMETER(CUR.Ship_To_Customer);
PARAMETER(CUR.Telephone_Number_FF);
{
 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


EXECUTE FUNCTION(Sales Route Desc      DRV) TYPE(DRVFLD)                        AC1575490;
PARAMETER(CUR.Sales_Route_Desc_DRV);
PARAMETER(CUR.Sales_Route_Code);
{
 //?Calculate derived field

 EXECUTE FUNCTION(RTV Description        RT) TYPE(RTVOBJ) FILE(PDJEREP)          AC1270614;
 PARAMETER(PAR.Sales_Route_Code);
 PARAMETER(PAR.Sales_Route_Desc_DRV);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

}


EXECUTE FUNCTION(Department Desc DRV) TYPE(DRVFLD)                              AC1666904;
PARAMETER(CUR.Department_Desc_DRV);
PARAMETER(CUR.Company_Number);
PARAMETER(CUR.Department_Code);
{
 //?Calculate derived field

 EXECUTE FUNCTION(Rtv Prod Dept Name    RT) TYPE(RTVOBJ) FILE(PDI5REP)           AC1286709;
 PARAMETER(PAR.Company_Number);
 PARAMETER(PAR.Department_Code);
 PARAMETER(PAR.Department_Desc_DRV);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

}


CASE;

// IF CUR.Special Instructions is Equal to Blank
IF CUR.Special_Instructions = *BLANK;

// AND CUR.Special Instructions 2 is Equal to Blank
AND CUR.Special_Instructions_2 = *BLANK;

// LCL.Display Flag = CND.No
LCL.Display_Flag = 'N';

ENDIF;

EXECUTE FUNCTION(Carrier Name DRV) TYPE(DRVFLD)                                 AC1582201;
PARAMETER(CUR.Carrier_Name_DRV);
PARAMETER(CUR.Carrier_Code);
{
 //?Calculate derived field

 EXECUTE FUNCTION(RTV Carrier Name       RT) TYPE(RTVOBJ) FILE(OMFFREP)          AC1382687;
 PARAMETER(PAR.Carrier_Code);
 PARAMETER(PAR.Carrier_Name_DRV);
 PARAMETER(NLL.Record_Status);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

  // PGM.*Return code = CND.*Normal
  PGM.*Return_code = *BLANK;

 }

}


// Print Order Number header format
PRINT Order Number header format;

//?Embedded PRTOBJ : Prt Label Instructions PO
EXECUTE FUNCTION(Prt Label Instructions PO) TYPE(PRTOBJ);
PARAMETER(CUR.Company_Number);
PARAMETER(CUR.Ship_To_Customer);
PARAMETER('LB');
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

 // PGM.*Return code = CND.*Normal
 PGM.*Return_code = *BLANK;

}


ENDIF;

// SUPPRESSED PRINT Ship To Customer header format

//?PRTOBJ calls after print of detail format

//?Embedded PRTOBJ : PRT Get Ready Report   PO
EXECUTE FUNCTION(PRT Get Ready Report   PO) TYPE(PRTOBJ);
PARAMETER(DB1.Company_Number);
PARAMETER(DB1.Order_Number);
PARAMETER(PAR.Department_Code);
PARAMETER(PAR.Department_Type);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

 // PGM.*Return code = CND.*Normal
 PGM.*Return_code = *BLANK;

}


//?USER: Print required level totals

// SUPPRESSED PRINT Ship To Customer totals format

CASE;

IF NEW Order_Number;
//?Embedded PRTOBJ : Prt Cust Comment PL   PO
EXECUTE FUNCTION(Prt Cust Comment PL   PO) TYPE(PRTOBJ);
PARAMETER(CUR.Ship_To_Customer);
PARAMETER('PI');
PARAMETER(*ZERO);
PARAMETER('Y');
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

 // PGM.*Return code = CND.*Normal
 PGM.*Return_code = *BLANK;

}


CASE;

// IF CUR.Special Instructions is Equal to Blank
IF CUR.Special_Instructions = *BLANK;

// AND CUR.Special Instructions 2 is Equal to Blank
AND CUR.Special_Instructions_2 = *BLANK;

// LCL.Display Flag = CND.No
LCL.Display_Flag = 'N';

ENDIF;

// Execute function Set order hdr print N US.
EXECUTE FUNCTION(Set order hdr print N US) TYPE(EXCUSRSRC) ('PMIOUFR');
{
 C                     MOVE 'N'       W0AP01
}


// Print Order Number totals format
PRINT Order Number totals format;

//?Embedded PRTOBJ : PRT Header comments    PO
//?Get Order Comments for any Get Ready (PS)
EXECUTE FUNCTION(PRT Header comments    PO) TYPE(PRTOBJ);
PARAMETER(CUR.Company_Number);
PARAMETER(CUR.Order_Number);
PARAMETER(*ZERO);
PARAMETER('PS');
{
 C                     MOVE 'N'       W0AP01
}


//?Embedded PRTOBJ : PRT Shipping Inst.     PO
EXECUTE FUNCTION(PRT Shipping Inst.     PO) TYPE(PRTOBJ);
PARAMETER(CUR.Company_Number);
PARAMETER(CUR.Order_Number);
{
 C                     MOVE 'N'       W0AP01
}


//?Embedded PRTOBJ : Prt Get Ready Sign Ln PO
EXECUTE FUNCTION(Prt Get Ready Sign Ln PO) TYPE(PRTOBJ);
PARAMETER(CUR.Company_Number);
PARAMETER(CUR.Order_Number);
{
 C                     MOVE 'N'       W0AP01
}


ENDIF;

CASE;

IF NEW Company_Number;
// Print Company Number totals format
PRINT Company Number totals format;

ENDIF;

