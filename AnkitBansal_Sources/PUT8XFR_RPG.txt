     H/TITLE Cnv Upd EDI Ord Auto  XF  Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 10/15/21  Time  : 12:54:25
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FECP004L4  IF   E           K DISK
      * RSQ : EDI Purchase Order Header OrdDte-d/PO/TC#
      *
     FOPBFCPMX  IF   E           K DISK
      * RSQ : Order Header TRG          CustPO#,Ord#
      *
     FPNGQREL1  IF   E           K DISK
      * RTV : EDI Bill To Interchange   Retrieval index
      *
     FPMAMREL1  IF   E           K DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FPMAMREL0  UF   E           K DISK
      * UPD : Order Header Extension    Update index
      *
     D YDOW            S              1     DIM(7)
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
      /EJECT
     D XDINT           DS
      * Internal date
     D  XDINDT                 1      7  0
     D  XDINYY                 1      3  0
     D  XDINMM                 4      5  0
     D  XDINDD                 6      7  0
      /EJECT
     D XD2T            DS
      * Internal date
     D  XDINT2                 1      7  0
     D  XDINY2                 1      3  0
     D  XDINM2                 4      5  0
     D  XDIND2                 6      7  0
     D QPMAM1        E DS                  EXTNAME(PMAMREL0)
      * UPD : Order Header Extension    Update index
      * Renamed input format fields
     D  WEAIC3       E                     EXTFLD(AMAIC3)
     D  WEC4NB       E                     EXTFLD(AMC4NB)
     D  WERMNB       E                     EXTFLD(AMRMNB)
     D  WERUNB       E                     EXTFLD(AMRUNB)
     D  WEXACD       E                     EXTFLD(AMXACD)
     D  WEOANA       E                     EXTFLD(AMOANA)
     D  WEHBAA       E                     EXTFLD(AMHBAA)
     D  WEJ0T1       E                     EXTFLD(AMJ0T1)
     D  WEGENY       E                     EXTFLD(AMGENY)
     D  WEJ1T1       E                     EXTFLD(AMJ1T1)
     D  WEHCAA       E                     EXTFLD(AMHCAA)
     D  WEQWDT       E                     EXTFLD(AMQWDT)
     D  WEQXDT       E                     EXTFLD(AMQXDT)
     D  WEQYDT       E                     EXTFLD(AMQYDT)
     D  WEHDAA       E                     EXTFLD(AMHDAA)
     D  WECCTX       E                     EXTFLD(AMCCTX)
     D  WEJ2T1       E                     EXTFLD(AMJ2T1)
     D  WERLNA       E                     EXTFLD(AMRLNA)
     D  WERMNA       E                     EXTFLD(AMRMNA)
     D  WEGINY       E                     EXTFLD(AMGINY)
     D  WEGFNY       E                     EXTFLD(AMGFNY)
     D  WEGGNY       E                     EXTFLD(AMGGNY)
     D  WEGHNY       E                     EXTFLD(AMGHNY)
     D  WEHEVL       E                     EXTFLD(AMHEVL)
     D  WEHFVL       E                     EXTFLD(AMHFVL)
     D  WEHGVL       E                     EXTFLD(AMHGVL)
     D  WEQZDT       E                     EXTFLD(AMQZDT)
     D  WEQ0DT       E                     EXTFLD(AMQ0DT)
     D  WEQ1DT       E                     EXTFLD(AMQ1DT)
     D  WEQ2DT       E                     EXTFLD(AMQ2DT)
     D  WEC2TX       E                     EXTFLD(AMC2TX)
     D  WEC3TX       E                     EXTFLD(AMC3TX)
     D  WEC6TX       E                     EXTFLD(AMC6TX)
     D  WECHTX       E                     EXTFLD(AMCHTX)
     D  WECITX       E                     EXTFLD(AMCITX)
     D  WECLTX       E                     EXTFLD(AMCLTX)
     D  WEB4TX       E                     EXTFLD(AMB4TX)
     D  WECUTX       E                     EXTFLD(AMCUTX)
     D  WECVTX       E                     EXTFLD(AMCVTX)
     D  WEB9TX       E                     EXTFLD(AMB9TX)
     D  WEJWSC       E                     EXTFLD(AMJWSC)
     D  WEITNY       E                     EXTFLD(AMITNY)
     D  WELMT1       E                     EXTFLD(AMLMT1)
     D  WELWAA       E                     EXTFLD(AMLWAA)
     D  WEFVST       E                     EXTFLD(AMFVST)
     D  WEF0ST       E                     EXTFLD(AMF0ST)
     D  WEF2ST       E                     EXTFLD(AMF2ST)
     D  WEF3ST       E                     EXTFLD(AMF3ST)
     D  WEJUSC       E                     EXTFLD(AMJUSC)
     D  WEJVSC       E                     EXTFLD(AMJVSC)
     D  WEV3T1       E                     EXTFLD(AMV3T1)
     D  WEV4T1       E                     EXTFLD(AMV4T1)
     D  WEV5T1       E                     EXTFLD(AMV5T1)
     D  WEV6T1       E                     EXTFLD(AMV6T1)
     D  WEV7T1       E                     EXTFLD(AMV7T1)
     D  WEV8T1       E                     EXTFLD(AMV8T1)
     D  WEV9T1       E                     EXTFLD(AMV9T1)
     D  WEWAT1       E                     EXTFLD(AMWAT1)
     D  WEWBT1       E                     EXTFLD(AMWBT1)
     D  WEWCT1       E                     EXTFLD(AMWCT1)
     D  WEWDT1       E                     EXTFLD(AMWDT1)
     D  WEQJNY       E                     EXTFLD(AMQJNY)
     D  WEQKNY       E                     EXTFLD(AMQKNY)
     D  WEQLNY       E                     EXTFLD(AMQLNY)
     D  WEP8NY       E                     EXTFLD(AMP8NY)
     D  WEP9NY       E                     EXTFLD(AMP9NY)
     D  WEQANY       E                     EXTFLD(AMQANY)
     D  WEQCNY       E                     EXTFLD(AMQCNY)
     D  WEQDNY       E                     EXTFLD(AMQDNY)
     D  WEQENY       E                     EXTFLD(AMQENY)
     D  WEQFNY       E                     EXTFLD(AMQFNY)
     D  WEQGNY       E                     EXTFLD(AMQGNY)
     D  WEQHNY       E                     EXTFLD(AMQHNY)
     D  WEQINY       E                     EXTFLD(AMQINY)
     D  WEQMNY       E                     EXTFLD(AMQMNY)
     D  WEMYU1       E                     EXTFLD(AMMYU1)
     D  WEJXSC       E                     EXTFLD(AMJXSC)
     D  WEJYSC       E                     EXTFLD(AMJYSC)
     D  WEJZSC       E                     EXTFLD(AMJZSC)
     D  WEJ0SC       E                     EXTFLD(AMJ0SC)
     D  WEMZU1       E                     EXTFLD(AMMZU1)
     D  WEM0U1       E                     EXTFLD(AMM0U1)
     D  WEM1U1       E                     EXTFLD(AMM1U1)
     D  WEM2U1       E                     EXTFLD(AMM2U1)
     D  WEM3U1       E                     EXTFLD(AMM3U1)
     D  WEW5DT       E                     EXTFLD(AMW5DT)
     D  WEW6DT       E                     EXTFLD(AMW6DT)
     D  WEUVST       E                     EXTFLD(AMUVST)
     D  WEUWST       E                     EXTFLD(AMUWST)
     D  WEUXST       E                     EXTFLD(AMUXST)
     D  WEVSST       E                     EXTFLD(AMVSST)
     D  WEAATM       E                     EXTFLD(AMAATM)
     D  WEAYNA       E                     EXTFLD(AMAYNA)
     D  WEA0NA       E                     EXTFLD(AMA0NA)
     D  WEAXDT       E                     EXTFLD(AMAXDT)
      *
     D YARDCS          DS           894
      * Message data for message Y2U0009.
     D MD0009          DS
     D  MDPGM                  1     10
     D  MDACP                 11     20
     D  MDFMT                 21     30
     D  MDACT                 31     34
     D  MDLBL                 35     40
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  Y0CX01         S              1
     D  YL0001         S              7
     D  ZQ             S              5  0
     D  YL0002         S              7  0
     D  YL0003         S              1
     D  WQSB01         S                   LIKE(WBBCNA)
     D  YL0004         S              7  0
     D  XDWK1          S              8  0
     D  XDAY1          S              6  0
     D  XDAY2          S              6  0
     D  XDURR          S              8  0
     D  XDSEL          S              1
     D  XDCDW          S              7
     D  XDWSL          S              1  0
     D  XDSTP          S              1  0
     D  XDWNB          S              6  0
     D  XDLSW          S              1  0
     D  YY             S              6  0
     D  XDWK3          S              7  1
     D  XDWK2          S              6  0
     D  YL0005         S              7  0
     D  WL0001         S              7  0
     D  WL0002         S              6
     D  WL0003         S              3  0
     D  WL0004         S              7  0
     D  WQSC01         S                   LIKE(WCB0C7)
     D  WN0001         S              7  0
     D  WN0002         S              5  0
     D  WN0003         S              3
     D  WN0004         S             20
     D  WN0005         S             25
     D  WN0006         S             30
     D  WN0007         S             15
     D  WN0008         S             15
     D  WN0009         S             20
     D  WN0010         S              7  0
     D  WN0011         S              7  0
     D  WN0012         S              7  0
     D  WN0013         S              3
     D  WN0014         S              1
     D  WN0015         S             12
     D  WN0016         S             35
     D  WN0017         S             75
     D  WN0018         S             11  0
     D  WN0019         S             11  0
     D  WN0020         S             11  0
     D  WN0021         S             11  0
     D  WN0022         S             11  2
     D  WN0023         S             11  2
     D  WN0024         S             11  2
     D  WN0025         S              7  0
     D  WN0026         S              7  0
     D  WN0027         S              7  0
     D  WN0028         S              7  0
     D  WN0029         S              4
     D  WN0030         S              4
     D  WN0031         S              4
     D  WN0032         S              2
     D  WN0033         S              2
     D  WN0034         S              2
     D  WN0035         S              3
     D  WN0036         S              3
     D  WN0037         S              3
     D  WN0038         S              5
     D  WN0039         S              5
     D  WN0040         S              5  0
     D  WN0041         S             38
     D  WN0042         S              6
     D  WN0043         S              6
     D  WN0044         S              6
     D  WN0045         S              6
     D  WN0046         S              6
     D  WN0047         S              1
     D  WN0048         S              1
     D  WN0049         S             10
     D  WN0050         S             10
     D  WN0051         S             10
     D  WN0052         S             15
     D  WN0053         S             15
     D  WN0054         S             15
     D  WN0055         S             30
     D  WN0056         S             30
     D  WN0057         S             30
     D  WN0058         S             50
     D  WN0059         S             50
     D  WN0060         S              3  0
     D  WN0061         S              3  0
     D  WN0062         S              3  0
     D  WN0063         S              5  2
     D  WN0064         S              5  2
     D  WN0065         S              5  0
     D  WN0066         S              6  0
     D  WN0067         S              6  0
     D  WN0068         S              6  0
     D  WN0069         S              6  0
     D  WN0070         S              9  0
     D  WN0071         S              9  0
     D  WN0072         S              9  0
     D  WN0073         S              9  6
     D  WN0074         S             15
     D  WN0075         S              1
     D  WN0076         S              2
     D  WN0077         S              2
     D  WN0078         S              5
     D  WN0079         S              5
     D  WN0080         S             15
     D  WN0081         S             15
     D  WN0082         S             30
     D  WN0083         S              7  0
     D  WN0084         S              7  0
     D  WN0085         S              1
     D  WN0086         S              1
     D  WN0087         S              1
     D  WN0088         S              1
     D  WN0089         S              6  0
     D  WN0090         S             10
     D  WN0091         S             10
     D  WN0092         S              7  0
     D  YARDC          S              1
     D  WQSF01         S                   LIKE(WBBCNA)
     D  WQSF02         S                   LIKE(WBC4NB)
     D  YL0006         S              7  0
     D  YL0007         S              7  0
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  YRSW00         S              5  0
     D  YRSW01         S              5  0
     D  W0PMT          S              1
     d $string_data    s             30a   inz(*blank)
     d $pos            s              5u 0 inz(*zero)
     D                 DS
     D  ZAMSDA                 1    132
     I@P004TE
      * EDI Purchase Order Header OrdDte-d/PO/TC#
      * Renamed input format fields
     I              BQTSCN                      WATSCN
     I              BQL3SX                      WAL3SX
     I              BQOSDT                      WAOSDT
     I              BQPONO                      WAPONO
     I              BQDKAA                      WADKAA
     I              BQNAME                      WANAME
     I              BQCQLF                      WACQLF
     I              BQCNUM                      WACNUM
     I              BQINRF                      WAINRF
     I              BQGNTX                      WAGNTX
     I              BQHUAA                      WAHUAA
     I              BQHUVL                      WAHUVL
     I              BQHVAA                      WAHVAA
     I              BQX8T1                      WAX8T1
     I              BQJ2AA                      WAJ2AA
     I              BQT6DT                      WAT6DT
     I              BQQLFX                      WAQLFX
     I              BQDELV                      WADELV
     I              BQSHMT                      WASHMT
     I              BQMTTY                      WAMTTY
     I              BQPLEX                      WAPLEX
     I              BQLDOP                      WALDOP
     I              BQROUT                      WAROUT
     I              BQFOBP                      WAFOBP
     I              BQD3VL                      WAD3VL
     I              BQUNIT                      WAUNIT
     I              BQD4VL                      WAD4VL
     I              BQAMTX                      WAAMTX
     I              BQDSTS                      WADSTS
     I              BQSRAA                      WASRAA
     I              BQBRU1                      WABRU1
     I              BQSSAA                      WASSAA
     I              BQBSU1                      WABSU1
     I              BQSTAA                      WASTAA
     I              BQBTU1                      WABTU1
     I              BQSUAA                      WASUAA
     I              BQBUU1                      WABUU1
     I              BQSVAA                      WASVAA
     I              BQBVU1                      WABVU1
     I              BQSWAA                      WASWAA
     I              BQBWU1                      WABWU1
     I              BQSXAA                      WASXAA
     I              BQBXU1                      WABXU1
     I              BQYDT1                      WAYDT1
     I              BQNLST                      WANLST
     I              BQUFDT                      WAUFDT
     I              BQOJAA                      WAOJAA
     I              BQJ5NX                      WAJ5NX
      *
     I@BFCPN2
      * Order Header TRG          CustPO#,Ord#
      * Renamed input format fields
     I              BEAIC3                      WBAIC3
     I              BEC4NB                      WBC4NB
     I              BEJNCD                      WBJNCD
     I              BEANC7                      WBANC7
     I              BEBKC7                      WBBKC7
     I              BEBRTX                      WBBRTX
     I              BEHMNA                      WBHMNA
     I              BEHONA                      WBHONA
     I              BEHPNA                      WBHPNA
     I              BEHNNA                      WBHNNA
     I              BEDBCD                      WBDBCD
     I              BECKTX                      WBCKTX
     I              BEB0C7                      WBB0C7
     I              BEAETX                      WBAETX
     I              BEB1NA                      WBB1NA
     I              BEB3NA                      WBB3NA
     I              BEB4NA                      WBB4NA
     I              BEB2NA                      WBB2NA
     I              BEBHCD                      WBBHCD
     I              BEC8TX                      WBC8TX
     I              BEBCNA                      WBBCNA
     I              BEA0DT                      WBA0DT
     I              BEA5DT                      WBA5DT
     I              BEGNDT                      WBGNDT
     I              BEACDT                      WBACDT
     I              BEAQCD                      WBAQCD
     I              BEB6NA                      WBB6NA
     I              BEBYNA                      WBBYNA
     I              BEBZNA                      WBBZNA
     I              BEGTST                      WBGTST
     I              BEGVST                      WBGVST
     I              BEGUST                      WBGUST
     I              BEQFST                      WBQFST
     I              BECQCD                      WBCQCD
     I              BEGJST                      WBGJST
     I              BEGWST                      WBGWST
     I              BEGXST                      WBGXST
     I              BEGYST                      WBGYST
     I              BEAODT                      WBAODT
     I              BEAIVN                      WBAIVN
     I              BECXDT                      WBCXDT
     I              BEJZVA                      WBJZVA
     I              BEA1WG                      WBA1WG
     I              BEXIST                      WBXIST
     I              BEXJST                      WBXJST
     I              BEXKST                      WBXKST
     I              BEEIDT                      WBEIDT
     I              BEAFTM                      WBAFTM
     I              BEE8CD                      WBE8CD
     I              BEE9CD                      WBE9CD
     I              BERMNB                      WBRMNB
     I              BETBNB                      WBTBNB
     I              BER1NB                      WBR1NB
     I              BEPJST                      WBPJST
     I              BEU0ST                      WBU0ST
     I              BEU1ST                      WBU1ST
     I              BEQ2CD                      WBQ2CD
     I              BEU2ST                      WBU2ST
     I              BEVEST                      WBVEST
     I              BEVFST                      WBVFST
     I              BEVGST                      WBVGST
     I              BERPCD                      WBRPCD
     I              BERNNB                      WBRNNB
     I              BEVDST                      WBVDST
     I              BEATIN                      WBATIN
     I              BEU4ST                      WBU4ST
     I              BEU5ST                      WBU5ST
     I              BERSRN                      WBRSRN
     I              BEMHNA                      WBMHNA
     I              BEMINA                      WBMINA
     I              BEWBST                      WBWBST
     I              BER4CD                      WBR4CD
     I              BEBFCD                      WBBFCD
     I              BEQ4CD                      WBQ4CD
     I              BET3NB                      WBT3NB
     I              BESICD                      WBSICD
     I              BECONB                      WBCONB
     I              BECEST                      WBCEST
     I              BEAWDT                      WBAWDT
     I              BEJPCD                      WBJPCD
     I              BEXUST                      WBXUST
     I              BEZ1ST                      WBZ1ST
     I              BEVRVA                      WBVRVA
     I              BEOBST                      WBOBST
     I              BEBCST                      WBBCST
     I              BEBDST                      WBBDST
     I              BEB7VL                      WBB7VL
     I              BEGASX                      WBGASX
     I              BEGBSX                      WBGBSX
     I              BEGCSX                      WBGCSX
     I              BEGDSX                      WBGDSX
     I              BEFNSX                      WBFNSX
     I              BEFOSX                      WBFOSX
     I              BEFPSX                      WBFPSX
     I              BEFQSX                      WBFQSX
     I              BEFRSX                      WBFRSX
     I              BEFSSX                      WBFSSX
     I              BEFTSX                      WBFTSX
     I              BEFUSX                      WBFUSX
     I              BEFVSX                      WBFVSX
     I              BEFWSX                      WBFWSX
     I              BEFXSX                      WBFXSX
     I              BEFYSX                      WBFYSX
     I              BENODT                      WBNODT
     I              BENPDT                      WBNPDT
     I              BENQDT                      WBNQDT
     I              BENRDT                      WBNRDT
     I              BENSDT                      WBNSDT
     I              BEBPTM                      WBBPTM
     I              BEBQTM                      WBBQTM
     I              BEBRTM                      WBBRTM
     I              BEBSTM                      WBBSTM
     I              BEBTTM                      WBBTTM
     I              BEH0NX                      WBH0NX
     I              BEH1NX                      WBH1NX
     I              BEH2NX                      WBH2NX
     I              BEH3NX                      WBH3NX
     I              BEH4NX                      WBH4NX
     I              BEC0C7                      WBC0C7
     I              BEUVST                      WBUVST
     I              BEUWST                      WBUWST
     I              BEUXST                      WBUXST
     I              BEAATM                      WBAATM
     I              BEAYNA                      WBAYNA
     I              BEA0NA                      WBA0NA
     I              BEAXDT                      WBAXDT
      *
     I@GQREH2
      * EDI Bill To Interchange   Retrieval index
      * Renamed input format fields
     I              GQB0C7                      WCB0C7
     I              GQM4AA                      WCM4AA
     I              GQM7AA                      WCM7AA
     I              GQJ5NX                      WCJ5NX
     I              GQA8U1                      WCA8U1
     I              GQA9U1                      WCA9U1
     I              GQBAU1                      WCBAU1
     I              GQBBU1                      WCBBU1
     I              GQY4NY                      WCY4NY
     I              GQY5NY                      WCY5NY
     I              GQBFU1                      WCBFU1
     I              GQBGU1                      WCBGU1
     I              GQBHU1                      WCBHU1
     I              GQBIU1                      WCBIU1
     I              GQSIAA                      WCSIAA
     I              GQSJAA                      WCSJAA
     I              GQVSST                      WCVSST
     I              GQMJDT                      WCMJDT
     I              GQBETM                      WCBETM
     I              GQCCVN                      WCCCVN
     I              GQCDVN                      WCCDVN
     I              GQMKDT                      WCMKDT
     I              GQBFTM                      WCBFTM
     I              GQCEVN                      WCCEVN
     I              GQCFVN                      WCCFVN
      *
     I@AMREJF
      * Order Header Extension    Retrieval index
      * Renamed input format fields
     I              AMAIC3                      WDAIC3
     I              AMC4NB                      WDC4NB
     I              AMRMNB                      WDRMNB
     I              AMRUNB                      WDRUNB
     I              AMXACD                      WDXACD
     I              AMOANA                      WDOANA
     I              AMHBAA                      WDHBAA
     I              AMJ0T1                      WDJ0T1
     I              AMGENY                      WDGENY
     I              AMJ1T1                      WDJ1T1
     I              AMHCAA                      WDHCAA
     I              AMQWDT                      WDQWDT
     I              AMQXDT                      WDQXDT
     I              AMQYDT                      WDQYDT
     I              AMHDAA                      WDHDAA
     I              AMCCTX                      WDCCTX
     I              AMJ2T1                      WDJ2T1
     I              AMRLNA                      WDRLNA
     I              AMRMNA                      WDRMNA
     I              AMGINY                      WDGINY
     I              AMGFNY                      WDGFNY
     I              AMGGNY                      WDGGNY
     I              AMGHNY                      WDGHNY
     I              AMHEVL                      WDHEVL
     I              AMHFVL                      WDHFVL
     I              AMHGVL                      WDHGVL
     I              AMQZDT                      WDQZDT
     I              AMQ0DT                      WDQ0DT
     I              AMQ1DT                      WDQ1DT
     I              AMQ2DT                      WDQ2DT
     I              AMC2TX                      WDC2TX
     I              AMC3TX                      WDC3TX
     I              AMC6TX                      WDC6TX
     I              AMCHTX                      WDCHTX
     I              AMCITX                      WDCITX
     I              AMCLTX                      WDCLTX
     I              AMB4TX                      WDB4TX
     I              AMCUTX                      WDCUTX
     I              AMCVTX                      WDCVTX
     I              AMB9TX                      WDB9TX
     I              AMJWSC                      WDJWSC
     I              AMITNY                      WDITNY
     I              AMLMT1                      WDLMT1
     I              AMLWAA                      WDLWAA
     I              AMFVST                      WDFVST
     I              AMF0ST                      WDF0ST
     I              AMF2ST                      WDF2ST
     I              AMF3ST                      WDF3ST
     I              AMJUSC                      WDJUSC
     I              AMJVSC                      WDJVSC
     I              AMV3T1                      WDV3T1
     I              AMV4T1                      WDV4T1
     I              AMV5T1                      WDV5T1
     I              AMV6T1                      WDV6T1
     I              AMV7T1                      WDV7T1
     I              AMV8T1                      WDV8T1
     I              AMV9T1                      WDV9T1
     I              AMWAT1                      WDWAT1
     I              AMWBT1                      WDWBT1
     I              AMWCT1                      WDWCT1
     I              AMWDT1                      WDWDT1
     I              AMQJNY                      WDQJNY
     I              AMQKNY                      WDQKNY
     I              AMQLNY                      WDQLNY
     I              AMP8NY                      WDP8NY
     I              AMP9NY                      WDP9NY
     I              AMQANY                      WDQANY
     I              AMQCNY                      WDQCNY
     I              AMQDNY                      WDQDNY
     I              AMQENY                      WDQENY
     I              AMQFNY                      WDQFNY
     I              AMQGNY                      WDQGNY
     I              AMQHNY                      WDQHNY
     I              AMQINY                      WDQINY
     I              AMQMNY                      WDQMNY
     I              AMMYU1                      WDMYU1
     I              AMJXSC                      WDJXSC
     I              AMJYSC                      WDJYSC
     I              AMJZSC                      WDJZSC
     I              AMJ0SC                      WDJ0SC
     I              AMMZU1                      WDMZU1
     I              AMM0U1                      WDM0U1
     I              AMM1U1                      WDM1U1
     I              AMM2U1                      WDM2U1
     I              AMM3U1                      WDM3U1
     I              AMW5DT                      WDW5DT
     I              AMW6DT                      WDW6DT
     I              AMUVST                      WDUVST
     I              AMUWST                      WDUWST
     I              AMUXST                      WDUXST
     I              AMVSST                      WDVSST
     I              AMAATM                      WDAATM
     I              AMAYNA                      WDAYNA
     I              AMA0NA                      WDA0NA
     I              AMAXDT                      WDAXDT
      *
     I@AMREJE
      * Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                      WEAIC3
     I              AMC4NB                      WEC4NB
     I              AMRMNB                      WERMNB
     I              AMRUNB                      WERUNB
     I              AMXACD                      WEXACD
     I              AMOANA                      WEOANA
     I              AMHBAA                      WEHBAA
     I              AMJ0T1                      WEJ0T1
     I              AMGENY                      WEGENY
     I              AMJ1T1                      WEJ1T1
     I              AMHCAA                      WEHCAA
     I              AMQWDT                      WEQWDT
     I              AMQXDT                      WEQXDT
     I              AMQYDT                      WEQYDT
     I              AMHDAA                      WEHDAA
     I              AMCCTX                      WECCTX
     I              AMJ2T1                      WEJ2T1
     I              AMRLNA                      WERLNA
     I              AMRMNA                      WERMNA
     I              AMGINY                      WEGINY
     I              AMGFNY                      WEGFNY
     I              AMGGNY                      WEGGNY
     I              AMGHNY                      WEGHNY
     I              AMHEVL                      WEHEVL
     I              AMHFVL                      WEHFVL
     I              AMHGVL                      WEHGVL
     I              AMQZDT                      WEQZDT
     I              AMQ0DT                      WEQ0DT
     I              AMQ1DT                      WEQ1DT
     I              AMQ2DT                      WEQ2DT
     I              AMC2TX                      WEC2TX
     I              AMC3TX                      WEC3TX
     I              AMC6TX                      WEC6TX
     I              AMCHTX                      WECHTX
     I              AMCITX                      WECITX
     I              AMCLTX                      WECLTX
     I              AMB4TX                      WEB4TX
     I              AMCUTX                      WECUTX
     I              AMCVTX                      WECVTX
     I              AMB9TX                      WEB9TX
     I              AMJWSC                      WEJWSC
     I              AMITNY                      WEITNY
     I              AMLMT1                      WELMT1
     I              AMLWAA                      WELWAA
     I              AMFVST                      WEFVST
     I              AMF0ST                      WEF0ST
     I              AMF2ST                      WEF2ST
     I              AMF3ST                      WEF3ST
     I              AMJUSC                      WEJUSC
     I              AMJVSC                      WEJVSC
     I              AMV3T1                      WEV3T1
     I              AMV4T1                      WEV4T1
     I              AMV5T1                      WEV5T1
     I              AMV6T1                      WEV6T1
     I              AMV7T1                      WEV7T1
     I              AMV8T1                      WEV8T1
     I              AMV9T1                      WEV9T1
     I              AMWAT1                      WEWAT1
     I              AMWBT1                      WEWBT1
     I              AMWCT1                      WEWCT1
     I              AMWDT1                      WEWDT1
     I              AMQJNY                      WEQJNY
     I              AMQKNY                      WEQKNY
     I              AMQLNY                      WEQLNY
     I              AMP8NY                      WEP8NY
     I              AMP9NY                      WEP9NY
     I              AMQANY                      WEQANY
     I              AMQCNY                      WEQCNY
     I              AMQDNY                      WEQDNY
     I              AMQENY                      WEQENY
     I              AMQFNY                      WEQFNY
     I              AMQGNY                      WEQGNY
     I              AMQHNY                      WEQHNY
     I              AMQINY                      WEQINY
     I              AMQMNY                      WEQMNY
     I              AMMYU1                      WEMYU1
     I              AMJXSC                      WEJXSC
     I              AMJYSC                      WEJYSC
     I              AMJZSC                      WEJZSC
     I              AMJ0SC                      WEJ0SC
     I              AMMZU1                      WEMZU1
     I              AMM0U1                      WEM0U1
     I              AMM1U1                      WEM1U1
     I              AMM2U1                      WEM2U1
     I              AMM3U1                      WEM3U1
     I              AMW5DT                      WEW5DT
     I              AMW6DT                      WEW6DT
     I              AMUVST                      WEUVST
     I              AMUWST                      WEUWST
     I              AMUXST                      WEUXST
     I              AMVSST                      WEVSST
     I              AMAATM                      WEAATM
     I              AMAYNA                      WEAYNA
     I              AMA0NA                      WEA0NA
     I              AMAXDT                      WEAXDT
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Cnv Upd EDI Ord Auto  XF
      * Cnv Upd EDI Ord Auto  RT - EDI Purchase Order Header  * 
     C                   EXSR      SARVGN
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * Cnv Upd EDI Ord Auto  RT - EDI Purchase Order Header  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KPSSA         KLIST
     C                   KFLD                    WAOSDT                         G5002-ORDER DAT
      * Setup key
     C                   Z-ADD     1210911       WAOSDT                         G5002-ORDER DAT
      * Establish starting position
     C     KPSSA         SETLL     @P004TE                                      *
     C                   READ      @P004TE                                90    *
      * Data record not found
     C   90              MOVEL     'USR3103'     W0RTN
      * USER: Process Data record
      * Quit If Order Date is Prior to 01/01/2020. Read Order Date in DES
      * CASE: DB1.G5002-ORDER DATE is LT 01/01/2020
     C                   DOW       NOT *IN90
     C                   IF        WAOSDT < 1200101
     C                   GOTO      SAEXIT                                       *QUIT
     C                   ELSE
      * CASE: *OTHERWISE
      * Order Number & PO# Must Exist.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.OH Order Number is Not Blanks
      *   |- c2    : DB1.G5003-PURCHASE ORDER NUMB is Entered
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        WABXU1 <> ' '
     C                   IF        WAPONO <> ' '
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * SST & Convert Order Number.
      * CASE: *OTHERWISE
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     7             YRSW00
     C                   Z-ADD     1             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00030 OR
     C                             ZQ > 00030
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  WABXU1:ZQ     YL0001                 90      Order Number Al
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
     C                   MOVE      YL0001        YL0002                         Order Number
      * CASE: LCL.Order Number is Greater then zero
      * Scan for '+' Which Indicates Multiple Orders Were Created.
      * CASE: *OTHERWISE
      * Eus Scan for '+'      US - EDI Purchase Order Header  * 
     C                   IF        YL0002 > 0
      * Scan for '+' which indicates multiple Orders were created.
      *
      /free
       $string_data = WABXU1;
       $pos = %scan ('+' : $string_data);
       If $pos = 0;
         YL0003 = 'N';
       Else;
         YL0003 = 'Y';
       EndIf;
      /end-free
      * Multiple Orders Found, Then RST Only on PO# Else RST PO#/Order#.
      * CASE: LCL.Character Found USR is Yes
      * Cnv Upd EDI Ord Auto2 RT - Order Header TRG  * 
     C                   IF        YL0003 = 'Y'
     C                   EXSR      SBRVGN
     C                   ELSE
      * CASE: *OTHERWISE
      * Cnv Upd EDI Ord Auto  RT - Order Header TRG  * 
     C                   EXSR      SFRVGN
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   READ      @P004TE                                90    *
     C                   ENDDO
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBRVGN        BEGSR
      *================================================================
      * Cnv Upd EDI Ord Auto2 RT - Order Header TRG  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSB         KLIST
     C                   KFLD                    WQSB01                         Customer Purcha
      * Setup key
     C                   MOVEL     WAPONO        WQSB01                         Customer Purcha
      * Establish starting position
     C     KRSSB         SETLL     @BFCPN2                                      *
     C     KRSSB         READE     @BFCPN2                                90    *
      * Data record not found
     C   90              MOVEL     'USR0176'     W0RTN
      * USER: Process Data record
      * LCL.USR From Date = DB1.Order Date + CON.-5 *DAYS
     C                   DOW       NOT *IN90
     C     WBA0DT        ADD       1000000       XDINDT
     C                   EXSR      XCVTA
     C                   Z-ADD     XDAY1         XDAY2
     C                   Z-ADD     -5            XDURR
     C                   MOVEL     '1'           XDSEL
     C                   MOVEL     '1111111'     XDCDW
     C                   EXSR      XDOWS
     C                   EXSR      XDADY
     C                   EXSR      XCVFA
     C                   IF        XDINDT < 010101 OR
     C                             XDINDT > 4000000
     C                   Z-ADD     *ZERO         YL0004
     C                   ELSE
     C     XDINDT        SUB       1000000       YL0004
     C                   END
      * LCL.USR Through Date = DB1.Order Date + CON.5 *DAYS
     C     WBA0DT        ADD       1000000       XDINDT
     C                   EXSR      XCVTA
     C                   Z-ADD     XDAY1         XDAY2
     C                   Z-ADD     5             XDURR
     C                   MOVEL     '1'           XDSEL
     C                   MOVEL     '1111111'     XDCDW
     C                   EXSR      XDOWS
     C                   EXSR      XDADY
     C                   EXSR      XCVFA
     C                   IF        XDINDT < 010101 OR
     C                             XDINDT > 4000000
     C                   Z-ADD     *ZERO         YL0005
     C                   ELSE
     C     XDINDT        SUB       1000000       YL0005
     C                   END
      * Order Date Must Be Within +/- 5 Days of PO Date.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.G5002-ORDER DATE GE LCL.USR From Date
      *   |- c2    : PAR.G5002-ORDER DATE LE LCL.USR Through Date
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        WAOSDT >= YL0004
     C                   IF        WAOSDT <= YL0005
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Cnv Upd EDI Ord Auto  RT - EDI Bill To Interchange  * 
      * Move input parameters to subroutine local variables.
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     WBB0C7        WL0001                         Bill to Custome
     C                   MOVEL(P)  WAJ5NX        WL0002                         EDI Trading Par
     C                   Z-ADD     WBAIC3        WL0003                         Company Number
     C                   Z-ADD     WBC4NB        WL0004                         Order Number
     C                   EXSR      SCRVGN
     C                   END                                                    *FI
     C     KRSSB         READE     @BFCPN2                                90    *
     C                   ENDDO
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   SCRVGN        BEGSR
      *================================================================
      * Cnv Upd EDI Ord Auto  RT - EDI Bill To Interchange  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSC         KLIST
     C                   KFLD                    WQSC01                         Bill to Custome
      * Setup key
     C                   Z-ADD     WL0001        WQSC01                         Bill to Custome
      * Establish starting position
     C     KRSSC         SETLL     @GQREH2                                      *
     C     KRSSC         READE     @GQREH2                                90    *
      * Data record not found
     C   90              MOVEL     'USR4373'     W0RTN
      * USER: Process Data record
      * EDI Trading Partner No. Must Match.
      * CASE: PAR.EDI Trading Partner No. EQ DB1.EDI Trading Partner No.
     C                   DOW       NOT *IN90
      * Update OHE EDI Order Automated='Y' in OHE File.
      * Cnv Upd EDI Ord Auto  RT - Order Header Extension  * 
     C                   IF        WL0002 = WCJ5NX
     C                   EXSR      SDRVGN
     C                   GOTO      SCEXIT                                       *QUIT
     C                   END                                                    *FI
     C     KRSSC         READE     @GQREH2                                90    *
     C                   ENDDO
      *================================================================
     CSR   SCEXIT        ENDSR
      /EJECT
     CSR   SDRVGN        BEGSR
      *================================================================
      * Cnv Upd EDI Ord Auto  RT - Order Header Extension  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSD         KLIST
     C                   KFLD                    WDAIC3                         Company Number
     C                   KFLD                    WDC4NB                         Order Number
      * Setup key
     C                   Z-ADD     WL0003        WDAIC3                         Company Number
     C                   Z-ADD     WL0004        WDC4NB                         Order Number
      * Establish starting position
     C     KRSSD         CHAIN     @AMREJF                            90        *
      * Data record not found
     C   90              MOVEL     'USR3697'     W0RTN
      * USER: Process Data record
      * CASE:
      *  - NOTc1
      *   |- c1    : DB1.OHE EDI Order Automated is Yes
      *   '-
     C                   IF        NOT *IN90
     C                   MOVEL     '0'           Y0CX01
     C                   IF        WDJYSC = 'Y'
     C                   ELSE
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
      * Cnv Upd EDI Ord Auto  CH - Order Header Extension  * 
     C                   IF        Y0CX01 = '1'
     C                   EXSR      SECHRC
     C                   END                                                    *FI
     C                   ENDIF
      *================================================================
     CSR   SDEXIT        ENDSR
      /EJECT
     CSR   SECHRC        BEGSR
      *================================================================
      * Cnv Upd EDI Ord Auto  CH - Order Header Extension  * 
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0001                         Load ID
     C                   Z-ADD     *ZERO         WN0002                         Stop/Drop Seque
     C                   EVAL      WN0003 = ' '                                 Shipping Line
     C                   EVAL      WN0004 = ' '                                 Port Delv Termi
     C                   EVAL      WN0005 = ' '                                 OHE City
     C                   EVAL      WN0006 = ' '                                 OHE Vessel/Airl
     C                   EVAL      WN0007 = ' '                                 OHE Voyage/Flig
     C                   EVAL      WN0008 = ' '                                 OHE Booking Num
     C                   EVAL      WN0009 = ' '                                 OHE Discharge P
     C                   Z-ADD     *ZERO         WN0010                         OHE Sail/Flight
     C                   Z-ADD     *ZERO         WN0011                         OHE Port Cut Da
     C                   Z-ADD     *ZERO         WN0012                         OHE Arrival Dat
     C                   EVAL      WN0013 = ' '                                 OHE Late Delive
     C                   EVAL      WN0014 = ' '                                 OHE Ship Status
     C                   EVAL      WN0015 = ' '                                 OHE Container N
     C                   EVAL      WN0016 = ' '                                 OHE Comment 1
     C                   EVAL      WN0017 = ' '                                 OHE Comment 2
     C                   Z-ADD     *ZERO         WN0018                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0019                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0020                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0021                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0022                         OHE HPB RIN Equ
     C                   Z-ADD     *ZERO         WN0023                         OHE HPB RIN Pri
     C                   Z-ADD     *ZERO         WN0024                         Transload Termi
     C                   Z-ADD     *ZERO         WN0025                         OHE Est Arrv at
     C                   Z-ADD     *ZERO         WN0026                         OHE Backhaul ET
     C                   Z-ADD     *ZERO         WN0027                         OHE Port/Pier P
     C                   Z-ADD     *ZERO         WN0028                         OHE Actual Ship
     C                   EVAL      WN0029 = ' '                                 OHE Carrier SCA
     C                   EVAL      WN0030 = ' '                                 OHE Spot Buy
     C                   EVAL      WN0031 = ' '                                 OHE PO ACK Flag
     C                   EVAL      WN0032 = ' '                                 OHE Override Ty
     C                   EVAL      WN0033 = ' '                                 OHE Backhaul St
     C                   EVAL      WN0034 = ' '                                 OHE Backhaul ET
     C                   EVAL      WN0035 = ' '                                 OHE Load Haul T
     C                   EVAL      WN0036 = ' '                                 OHE Backhaul Ca
     C                   EVAL      WN0037 = ' '                                 OHE Bookings Co
     C                   EVAL      WN0038 = ' '                                 OHE EDI Error R
     C                   EVAL      WN0039 = ' '                                 OHE EDI Error R
     C                   Z-ADD     *ZERO         WN0040                         HPB COA Batch N
     C                   EVAL      WN0041 = ' '                                 Delivery P.O. N
     C                   EVAL      WN0042 = ' '                                 OHE Intended fo
     C                   EVAL      WN0043 = ' '                                 OHE EDI 943 Act
     C                   EVAL      WN0044 = ' '                                 OHE EDI 944 Act
     C                   EVAL      WN0045 = ' '                                 OHE EDI 940 Act
     C                   EVAL      WN0046 = ' '                                 OHE EDI 945 Act
     C                   EVAL      WN0047 = ' '                                 OHE EDI 856 Act
     C                   EVAL      WN0048 = ' '                                 OHE EDI 824 Act
     C                   EVAL      WN0049 = ' '                                 OHE Transload S
     C                   EVAL      WN0050 = ' '                                 OHE Abs Rate Ov
     C                   EVAL      WN0051 = ' '                                 OHE Appt Confir
     C                   EVAL      WN0052 = ' '                                 OHE Backhaul Co
     C                   EVAL      WN0053 = ' '                                 OHE Backhaul Ch
     C                   EVAL      WN0054 = ' '                                 OHE Transload C
     C                   EVAL      WN0055 = ' '                                 OHE Pier Pass I
     C                   EVAL      WN0056 = ' '                                 OHE Carrier Nm
     C                   EVAL      WN0057 = ' '                                 OHE Appt Confir
     C                   EVAL      WN0058 = ' '                                 OHE Backhaul Co
     C                   EVAL      WN0059 = ' '                                 Letter of Credi
     C                   Z-ADD     *ZERO         WN0060                         OHE Backhaul Re
     C                   Z-ADD     *ZERO         WN0061                         LD Stop/Drop
     C                   Z-ADD     *ZERO         WN0062                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0063                         OHE Pier Pass F
     C                   Z-ADD     *ZERO         WN0064                         OHE Port Check
     C                   Z-ADD     *ZERO         WN0065                         OHE Port Cut Ti
     C                   Z-ADD     *ZERO         WN0066                         OHE Backhaul Tr
     C                   Z-ADD     *ZERO         WN0067                         OHE Load Sched
     C                   Z-ADD     *ZERO         WN0068                         Original Appoin
     C                   Z-ADD     *ZERO         WN0069                         Original Appoin
     C                   Z-ADD     *ZERO         WN0070                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WN0071                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WN0072                         OHE Unused Nume
     C                   Z-ADD     *ZERO         WN0073                         OHE Orig ABS Fr
     C                   EVAL      WN0074 = ' '                                 OHE Genset Numb
     C                   EVAL      WN0075 = ' '                                 OHE Email BOL/S
     C                   EVAL      WN0076 = ' '                                 OHE Unused Stat
     C                   EVAL      WN0077 = ' '                                 OHE Unused Stat
     C                   EVAL      WN0078 = ' '                                 OHE Unused Text
     C                   EVAL      WN0079 = ' '                                 OHE Unused Text
     C                   EVAL      WN0080 = ' '                                 OHE Customer Ve
     C                   EVAL      WN0081 = ' '                                 OHE Unused Text
     C                   EVAL      WN0082 = ' '                                 OHE Unused Text
     C                   Z-ADD     *ZERO         WN0083                         OHE Unused Date
     C                   Z-ADD     *ZERO         WN0084                         OHE Unused Date
     C                   EVAL      WN0085 = ' '                                 EDI Status 1
     C                   EVAL      WN0086 = ' '                                 EDI Status 2
     C                   EVAL      WN0087 = ' '                                 EDI Status 3
     C                   EVAL      WN0088 = ' '                                 Record Status
     C                   Z-ADD     *ZERO         WN0089                         Job Time
     C                   EVAL      WN0090 = ' '                                 User Id
     C                   EVAL      WN0091 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WN0092                         Job Date
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YARDC = ' '
      *
      * Move key fields to @AMREJE
     C                   Z-ADD     WDAIC3        WEAIC3                         Company Number
     C                   Z-ADD     WDC4NB        WEC4NB                         Order Number
      *
     C     KLCHSE        KLIST
     C                   KFLD                    WEAIC3                         Company Number
     C                   KFLD                    WEC4NB                         Order Number
     C     KLCHSE        CHAIN     @AMREJE                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'PMAMREL0'    MDACP
     C                   MOVEL     '@AMREJE'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL001.
     C                   MOVEL     'LBL001'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SEEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SEEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QPMAM1        YARDCS
      * Move non-key fields to @AMREJE
     C                   MOVEL(P)  'Y'           WEJYSC                         OHE EDI Order A
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QPMAM1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * USER: Processing before Data update
     C                   Z-ADD     ##JTM         WEAATM                         Job Time
     C                   Z-ADD     ##JDT         WEAXDT                         Job Date
     C                   MOVEL     ##PGM         WEA0NA                         Job Name
     C                   MOVEL     ##USR         WEAYNA                         User Id
      * Set PGM.*Record Data Changed flag
     C                   IF        QPMAM1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YARDC = 'Y'
     C                   UPDATE    @AMREJE                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    PMAMREL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SEEXIT        ENDSR
      /EJECT
     CSR   SFRVGN        BEGSR
      *================================================================
      * Cnv Upd EDI Ord Auto  RT - Order Header TRG  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSF         KLIST
     C                   KFLD                    WQSF01                         Customer Purcha
     C                   KFLD                    WQSF02                         Order Number
      * Setup key
     C                   MOVEL     WAPONO        WQSF01                         Customer Purcha
     C                   Z-ADD     YL0002        WQSF02                         Order Number
      * Establish starting position
     C     KRSSF         SETLL     @BFCPN2                                      *
     C     KRSSF         READE     @BFCPN2                                90    *
      * Data record not found
     C   90              MOVEL     'USR0176'     W0RTN
      * USER: Process Data record
      * LCL.USR From Date = DB1.Order Date + CON.-5 *DAYS
     C                   DOW       NOT *IN90
     C     WBA0DT        ADD       1000000       XDINDT
     C                   EXSR      XCVTA
     C                   Z-ADD     XDAY1         XDAY2
     C                   Z-ADD     -5            XDURR
     C                   MOVEL     '1'           XDSEL
     C                   MOVEL     '1111111'     XDCDW
     C                   EXSR      XDOWS
     C                   EXSR      XDADY
     C                   EXSR      XCVFA
     C                   IF        XDINDT < 010101 OR
     C                             XDINDT > 4000000
     C                   Z-ADD     *ZERO         YL0006
     C                   ELSE
     C     XDINDT        SUB       1000000       YL0006
     C                   END
      * LCL.USR Through Date = DB1.Order Date + CON.5 *DAYS
     C     WBA0DT        ADD       1000000       XDINDT
     C                   EXSR      XCVTA
     C                   Z-ADD     XDAY1         XDAY2
     C                   Z-ADD     5             XDURR
     C                   MOVEL     '1'           XDSEL
     C                   MOVEL     '1111111'     XDCDW
     C                   EXSR      XDOWS
     C                   EXSR      XDADY
     C                   EXSR      XCVFA
     C                   IF        XDINDT < 010101 OR
     C                             XDINDT > 4000000
     C                   Z-ADD     *ZERO         YL0007
     C                   ELSE
     C     XDINDT        SUB       1000000       YL0007
     C                   END
      * Order Date Must Be Within +/- 5 Days of PO Date.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.G5002-ORDER DATE GE LCL.USR From Date
      *   |- c2    : PAR.G5002-ORDER DATE LE LCL.USR Through Date
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        WAOSDT >= YL0006
     C                   IF        WAOSDT <= YL0007
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Cnv Upd EDI Ord Auto  RT - EDI Bill To Interchange  * 
      * Move input parameters to subroutine local variables.
     C                   IF        Y0CX01 = '1'
     C                   Z-ADD     WBB0C7        WL0001                         Bill to Custome
     C                   MOVEL(P)  WAJ5NX        WL0002                         EDI Trading Par
     C                   Z-ADD     WBAIC3        WL0003                         Company Number
     C                   Z-ADD     WBC4NB        WL0004                         Order Number
     C                   EXSR      SCRVGN
     C                   END                                                    *FI
     C     KRSSF         READE     @BFCPN2                                90    *
     C                   ENDDO
      *================================================================
     CSR   SFEXIT        ENDSR
      /EJECT
     CSR   XCVFA         BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C                   IF        XDAY1 > 109267
     C                   ADD       2             XDAY1
     C                   ELSE
     C                   IF        XDAY1 > 36218
     C                   ADD       1             XDAY1
     C                   END
     C                   END
      * Full years (up to the date)
     C     XDAY1         DIV       365.25        XDWK1
     C                   MVR                     XDWK3
     C                   Z-ADD     XDWK1         XDINYY
      * The date is the end of a year
     C                   IF        XDWK3 = 0
     C                   Z-ADD     12            XDINMM
     C                   Z-ADD     31            XDINDD
     C                   ELSE
      * Year days up to the date
     C     XDWK1         MULT      365.25        XDWK2
     C                   SUB       XDWK2         XDAY1
     C                   ADD       1             XDINYY
      * Leap year ?
     C     XDINYY        DIV       4             XDWK1
     C                   MVR                     XDWK1
      * March 1 (relative day of the year)
     C                   IF        XDWK1 = 0
     C                   Z-ADD     60            XDWK1
     C                   ELSE
     C                   Z-ADD     59            XDWK1
     C                   END
      * Define date base month and offset day -
      *  - January (thru February)
     C                   IF        XDAY1 <= XDWK1
     C                   Z-ADD     1             XDINMM
     C                   ELSE
     C                   SUB       XDWK1         XDAY1
      *  - March (thru July)
     C                   IF        XDAY1 <= 153
     C                   Z-ADD     3             XDINMM
     C                   ELSE
      *  - August (thru December)
     C                   Z-ADD     8             XDINMM
     C                   SUB       153           XDAY1
     C                   END
      * Calculate 2 month base and offset day
     C     XDAY1         SUB       1             XDWK1
     C                   DIV       61            XDWK1
     C                   MVR                     XDAY1
     C                   ADD       1             XDAY1
     C                   MULT      2             XDWK1
     C                   ADD       XDWK1         XDINMM
     C                   END
      * Calculate date increment,
     C                   IF        XDAY1 > 31
     C                   ADD       1             XDINMM
     C                   SUB       31            XDAY1
     C                   END
     C                   Z-ADD     XDAY1         XDINDD
     C                   END
      *================================================================
     CSR   XCVFAE        ENDSR
      /EJECT
     CSR   XCVTA         BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C     XDINYY        SUB       1             XDWK1
     C     XDWK1         MULT      365.25        XDAY1
     C                   IF        XDWK1 >= 300
     C                   SUB       2             XDAY1
     C                   ELSE
     C                   IF        XDWK1 >= 100
     C                   SUB       1             XDAY1
     C                   END
     C                   END
      * (from the beginning of the year to the beginning of the month:)
     C     XDINMM        SUB       1             XDWK1
      *     ...+31*(MM-1) (for January-February) ...
     C                   IF        XDINMM < 3
     C                   MULT      31            XDWK1
     C                   ADD       XDWK1         XDAY1
     C                   ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                   MULT      30            XDWK1
     C                   ADD       XDWK1         XDAY1
      *         ...-2 (for preceding February) ...
     C                   SUB       2             XDAY1
      *         ...+1 (for preceding February, if leap year) ...
     C                   IF        XDINYY <> 100 AND
     C                             XDINYY <> 300
     C     XDINYY        DIV       4             XDWK1
     C                   MVR                     XDWK1
     C                   IF        XDWK1 = 0
     C                   ADD       1             XDAY1
     C                   END
     C                   END
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C                   IF        XDINMM < 8
     C     XDINMM        MULT      .5            XDWK1
     C                   ADD       XDWK1         XDAY1
     C                   ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C     XDINMM        ADD       1             XDWK1
     C                   MULT      .5            XDWK1
     C                   ADD       XDWK1         XDAY1
     C                   END
     C                   END
      * ...+DD (days in the month up to the ending date)
     C                   ADD       XDINDD        XDAY1
      *================================================================
     CSR   XCVTAE        ENDSR
      /EJECT
     CSR   XDADY         BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
      * None days of week selected
     C                   IF        XDURR = 0 OR
     C                             XDWSL = 0
     C                   Z-ADD     XDAY2         XDAY1
      * Return Code: Unable to increment date.
     C                   IF        XDURR <> *ZERO
     C                   MOVEL     'Y2U0059'     W0RTN
     C                   ENDIF
     C                   GOTO      XDADYE
     C                   ENDIF
      * All days of week selected
     C                   IF        XDWSL = 7
     C     XDAY2         ADD       XDURR         XDAY1
     C                   GOTO      XDADYM
     C                   ENDIF
      * Some days of week selected
     C                   IF        XDURR >= 0
     C                   Z-ADD     1             XDSTP
     C                   ELSE
     C                   Z-ADD     -1            XDSTP
     C                   ENDIF
      * Get number of full weeks in the duration
     C     XDURR         DIV       XDWSL         XDWNB
      * Isolate the last week
     C                   MVR                     XDLSW
     C                   IF        XDLSW = 0
     C     XDWSL         MULT      XDSTP         XDLSW
     C                   SUB       XDSTP         XDWNB
     C                   ENDIF
      * Increment the date by the full weeks
     C     XDWNB         MULT      7             XDWK1
     C     XDAY2         ADD       XDWK1         XDAY1
      * Determine day of week of the beginning date
     C     XDAY2         ADD       3             YY
     C                   DIV       7             YY
     C                   MVR                     YY
     C                   IF        YY = 0
     C                   Z-ADD     7             YY
     C                   ENDIF
      * Loop: Increment the date by the last week
      * Increment the date
     C                   DOW       XDLSW <> 0
     C                   ADD       XDSTP         XDAY1
      * Increment the day of week
     C                   ADD       XDSTP         YY
      * Put day of week into the range 1-7
     C                   IF        YY = 0
     C                   Z-ADD     7             YY
     C                   ELSE
     C                   IF        YY = 8
     C                   Z-ADD     1             YY
     C                   ELSE
     C                   IF        YY = -1
     C                   Z-ADD     6             YY
     C                   ENDIF
     C                   ENDIF
     C                   ENDIF
      * Selected day of the last week has been processed
     C                   IF        YDOW(YY) = XDSEL
     C                   SUB       XDSTP         XDLSW
     C                   ENDIF
      * End of loop
     C                   ENDDO
     C     XDADYM        TAG
     C                   IF        XDINDD < 1
     C                   Z-ADD     1             XDINDD
     C                   MOVEL     'Y2U0006'     W0RTN
     C                   ENDIF
      *================================================================
     CSR   XDADYE        ENDSR
      /EJECT
     CSR   XDOWS         BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                   MOVEA     XDCDW         YDOW
     C                   Z-ADD     0             XDWSL
     C                   Z-ADD     1             YY
     C                   DOW       YY <= 7
     C                   IF        YDOW(YY) = XDSEL
     C                   ADD       1             XDWSL
     C                   END
     C                   ADD       1             YY
     C                   END
      *================================================================
     CSR   XDOWSE        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WATSCN                         ST02-TRANS SET
     C                   Z-ADD     *ZERO         WAOSDT                         G5002-ORDER DAT
     C                   Z-ADD     *ZERO         WAHUVL                         SAC05-$$ AMT OF
     C                   Z-ADD     *ZERO         WAT6DT                         G6202 Ship Date
     C                   Z-ADD     *ZERO         WADELV                         G6202-DELIVERY
     C                   Z-ADD     *ZERO         WAD3VL                         G7601-QUANTITY
     C                   Z-ADD     *ZERO         WAD4VL                         G7603-WEIGHT OR
     C                   Z-ADD     *ZERO         WAAMTX                         G7608-ORDER AMO
     C                   Z-ADD     *ZERO         WAUFDT                         POH Date Stamp
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WBAIC3                         Company Number
     C                   Z-ADD     *ZERO         WBC4NB                         Order Number
     C                   Z-ADD     *ZERO         WBANC7                         A/R Customer Nu
     C                   Z-ADD     *ZERO         WBBKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WBB0C7                         Bill to Custome
     C                   Z-ADD     *ZERO         WBA0DT                         Order Date
     C                   Z-ADD     *ZERO         WBA5DT                         Requested Ship
     C                   Z-ADD     *ZERO         WBGNDT                         Actual Shipped
     C                   Z-ADD     *ZERO         WBACDT                         Cancel Date
     C                   Z-ADD     *ZERO         WBAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         WBCXDT                         Date of Origina
     C                   Z-ADD     *ZERO         WBJZVA                         Order Value Tot
     C                   Z-ADD     *ZERO         WBA1WG                         Order Weight To
     C                   Z-ADD     *ZERO         WBEIDT                         Requested Deliv
     C                   Z-ADD     *ZERO         WBAFTM                         Requested Deliv
     C                   Z-ADD     *ZERO         WBRMNB                         Load ID
     C                   Z-ADD     *ZERO         WBTBNB                         Absorbed Freigh
     C                   Z-ADD     *ZERO         WBR1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WBRNNB                         Reefer Temperat
     C                   Z-ADD     *ZERO         WBATIN                         Attach to Invoi
     C                   Z-ADD     *ZERO         WBRSRN                         Resell Referenc
     C                   Z-ADD     *ZERO         WBT3NB                         Attach to Order
     C                   Z-ADD     *ZERO         WBCONB                         Invoice Number
     C                   Z-ADD     *ZERO         WBAWDT                         Invoice Date
     C                   Z-ADD     *ZERO         WBVRVA                         A/R order Value
     C                   Z-ADD     *ZERO         WBB7VL                         Invoice Order V
     C                   Z-ADD     *ZERO         WBNODT                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WBNPDT                         JPN Invoice Iss
     C                   Z-ADD     *ZERO         WBNQDT                         Load Actual Shi
     C                   Z-ADD     *ZERO         WBNRDT                         Load BOL Comple
     C                   Z-ADD     *ZERO         WBNSDT                         Load Truck Depa
     C                   Z-ADD     *ZERO         WBBPTM                         Maximum Gross W
     C                   Z-ADD     *ZERO         WBBQTM                         Time of Origina
     C                   Z-ADD     *ZERO         WBBRTM                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WBBSTM                         Load BOL Comple
     C                   Z-ADD     *ZERO         WBBTTM                         Load Truck Depa
     C                   Z-ADD     *ZERO         WBH0NX                         Act Frt Referen
     C                   Z-ADD     *ZERO         WBH1NX                         Act Non-Ref Frt
     C                   Z-ADD     *ZERO         WBH2NX                         OH Fuel Surchar
     C                   Z-ADD     *ZERO         WBH3NX                         OH Total Non-Re
     C                   Z-ADD     *ZERO         WBH4NX                         OH Total Ref Fr
     C                   Z-ADD     *ZERO         WBC0C7                         Claim Number
     C                   Z-ADD     *ZERO         WBAATM                         Job Time
     C                   Z-ADD     *ZERO         WBAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WCB0C7                         Bill to Custome
     C                   Z-ADD     *ZERO         WCY4NY                         EDI Alt ST Cust
     C                   Z-ADD     *ZERO         WCY5NY                         EDI unused nbr
     C                   Z-ADD     *ZERO         WCMJDT                         Create Date
     C                   Z-ADD     *ZERO         WCBETM                         Create Time
     C                   Z-ADD     *ZERO         WCMKDT                         Change Date
     C                   Z-ADD     *ZERO         WCBFTM                         Change Time
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WDAIC3                         Company Number
     C                   Z-ADD     *ZERO         WDC4NB                         Order Number
     C                   Z-ADD     *ZERO         WDRMNB                         Load ID
     C                   Z-ADD     *ZERO         WDRUNB                         Stop/Drop Seque
     C                   Z-ADD     *ZERO         WDQWDT                         OHE Sail/Flight
     C                   Z-ADD     *ZERO         WDQXDT                         OHE Port Cut Da
     C                   Z-ADD     *ZERO         WDQYDT                         OHE Arrival Dat
     C                   Z-ADD     *ZERO         WDGINY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WDGFNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WDGGNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WDGHNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WDHEVL                         OHE HPB RIN Equ
     C                   Z-ADD     *ZERO         WDHFVL                         OHE HPB RIN Pri
     C                   Z-ADD     *ZERO         WDHGVL                         Transload Termi
     C                   Z-ADD     *ZERO         WDQZDT                         OHE Est Arrv at
     C                   Z-ADD     *ZERO         WDQ0DT                         OHE Backhaul ET
     C                   Z-ADD     *ZERO         WDQ1DT                         OHE Port/Pier P
     C                   Z-ADD     *ZERO         WDQ2DT                         OHE Actual Ship
     C                   Z-ADD     *ZERO         WDITNY                         HPB COA Batch N
     C                   Z-ADD     *ZERO         WDQJNY                         OHE Backhaul Re
     C                   Z-ADD     *ZERO         WDQKNY                         LD Stop/Drop
     C                   Z-ADD     *ZERO         WDQLNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WDP8NY                         OHE Pier Pass F
     C                   Z-ADD     *ZERO         WDP9NY                         OHE Port Check
     C                   Z-ADD     *ZERO         WDQANY                         OHE Port Cut Ti
     C                   Z-ADD     *ZERO         WDQCNY                         OHE Backhaul Tr
     C                   Z-ADD     *ZERO         WDQDNY                         OHE Load Sched
     C                   Z-ADD     *ZERO         WDQENY                         Original Appoin
     C                   Z-ADD     *ZERO         WDQFNY                         Original Appoin
     C                   Z-ADD     *ZERO         WDQGNY                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WDQHNY                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WDQINY                         OHE Unused Nume
     C                   Z-ADD     *ZERO         WDQMNY                         OHE Orig ABS Fr
     C                   Z-ADD     *ZERO         WDW5DT                         OHE Unused Date
     C                   Z-ADD     *ZERO         WDW6DT                         OHE Unused Date
     C                   Z-ADD     *ZERO         WDAATM                         Job Time
     C                   Z-ADD     *ZERO         WDAXDT                         Job Date
      * Define *Synon program work fields
     C                   Z-ADD     *ZEROS        YRSW00                         *Synon (5,0) wo
     C                   Z-ADD     *ZEROS        YRSW01                         *Synon (5,0) wo
     C                   MOVEL     'N'           W0PMT
      * Define local variables for subroutine SCRVGN.
     C                   Z-ADD     *ZERO         WL0001
     C                   EVAL      WL0002 = ' '
     C                   Z-ADD     *ZERO         WL0003
     C                   Z-ADD     *ZERO         WL0004
      * Define local work field Order Number Alpha
     C                   EVAL      YL0001 = ' '
      * Define local work field Order Number
     C                   Z-ADD     *ZERO         YL0002
      * Define local work field Character Found USR
     C                   EVAL      YL0003 = ' '
      * Define local work field USR From Date
     C                   Z-ADD     *ZERO         YL0004
      * Define local work field USR Through Date
     C                   Z-ADD     *ZERO         YL0005
      * Define local work field USR From Date
     C                   Z-ADD     *ZERO         YL0006
      * Define local work field USR Through Date
     C                   Z-ADD     *ZERO         YL0007
      *================================================================
     CSR   ZZEXIT        ENDSR
