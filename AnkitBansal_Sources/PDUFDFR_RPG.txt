     H/TITLE WW Reprint Invoices    DF Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Display file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 01/25/23  Time  : 08:56:01
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDUFDFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: WW Reprint Invoices    DF Display file
      *
     FOPBFCPLDIF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Order Header TRG          InvDt(D,AR Nme S(Inv
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPNF7REL4IF  E           K        DISK
      * RSQ : Cust Distribution Entry   Cust/DistCd/Type/Seq
      *
     FPNF7REL1IF  E           K        DISK
      * RTV : Cust Distribution Entry   Retrieval index
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse Codes           Retrieval index       NV
      *
     FPDNEREL1IF  E           K        DISK
      * RTV : Customer EXT              Retrieval index
      *
     FPNGQREL1IF  E           K        DISK
      * RTV : EDI Bill To Interchange   Retrieval index
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FECP004L8IF  E           K        DISK
      * RSQ : EDI Purchase Order Header Trade Partner/PO Number
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPDJ4CPL0IF  E           K        DISK                      A
      * UPD : WF Invoice List Work      Update index
      *
     FPMAFCPL0IF  E           K        DISK                      A
      * UPD : WF Invoice/Combine Drv    Update index
      *
     E                    AR1        30  1               ARRAY 1
     E                    AR2        30  1               ARRAY 2
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    #L7         7  1
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * Long constants
     E                    @CN#    1  12  6   @CN    25
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WAAIC3
     I              BEC4NB                          WAC4NB
     I              BEJNCD                          WAJNCD
     I              BEANC7                          WAANC7
     I              BEBKC7                          WABKC7
     I              BEBRTX                          WABRTX
     I              BEHMNA                          WAHMNA
     I              BEHONA                          WAHONA
     I              BEHPNA                          WAHPNA
     I              BEHNNA                          WAHNNA
     I              BEDBCD                          WADBCD
     I              BECKTX                          WACKTX
     I              BEB0C7                          WAB0C7
     I              BEAETX                          WAAETX
     I              BEB1NA                          WAB1NA
     I              BEB3NA                          WAB3NA
     I              BEB4NA                          WAB4NA
     I              BEB2NA                          WAB2NA
     I              BEBHCD                          WABHCD
     I              BEC8TX                          WAC8TX
     I              BEBCNA                          WABCNA
     I              BEA0DT                          WAA0DT
     I              BEA5DT                          WAA5DT
     I              BEGNDT                          WAGNDT
     I              BEACDT                          WAACDT
     I              BEAQCD                          WAAQCD
     I              BEB6NA                          WAB6NA
     I              BEBYNA                          WABYNA
     I              BEBZNA                          WABZNA
     I              BEGTST                          WAGTST
     I              BEGVST                          WAGVST
     I              BEGUST                          WAGUST
     I              BEQFST                          WAQFST
     I              BECQCD                          WACQCD
     I              BEGJST                          WAGJST
     I              BEGWST                          WAGWST
     I              BEGXST                          WAGXST
     I              BEGYST                          WAGYST
     I              BEAODT                          WAAODT
     I              BEAIVN                          WAAIVN
     I              BECXDT                          WACXDT
     I              BEJZVA                          WAJZVA
     I              BEA1WG                          WAA1WG
     I              BEXIST                          WAXIST
     I              BEXJST                          WAXJST
     I              BEXKST                          WAXKST
     I              BEEIDT                          WAEIDT
     I              BEAFTM                          WAAFTM
     I              BEE8CD                          WAE8CD
     I              BEE9CD                          WAE9CD
     I              BERMNB                          WARMNB
     I              BETBNB                          WATBNB
     I              BER1NB                          WAR1NB
     I              BEPJST                          WAPJST
     I              BEU0ST                          WAU0ST
     I              BEU1ST                          WAU1ST
     I              BEQ2CD                          WAQ2CD
     I              BEU2ST                          WAU2ST
     I              BEVEST                          WAVEST
     I              BEVFST                          WAVFST
     I              BEVGST                          WAVGST
     I              BERPCD                          WARPCD
     I              BERNNB                          WARNNB
     I              BEVDST                          WAVDST
     I              BEATIN                          WAATIN
     I              BEU4ST                          WAU4ST
     I              BEU5ST                          WAU5ST
     I              BERSRN                          WARSRN
     I              BEMHNA                          WAMHNA
     I              BEMINA                          WAMINA
     I              BEWBST                          WAWBST
     I              BER4CD                          WAR4CD
     I              BEBFCD                          WABFCD
     I              BEQ4CD                          WAQ4CD
     I              BET3NB                          WAT3NB
     I              BESICD                          WASICD
     I              BECONB                          WACONB
     I              BECEST                          WACEST
     I              BEAWDT                          WAAWDT
     I              BEJPCD                          WAJPCD
     I              BEXUST                          WAXUST
     I              BEZ1ST                          WAZ1ST
     I              BEVRVA                          WAVRVA
     I              BEOBST                          WAOBST
     I              BEBCST                          WABCST
     I              BEBDST                          WABDST
     I              BEB7VL                          WAB7VL
     I              BEGASX                          WAGASX
     I              BEGBSX                          WAGBSX
     I              BEGCSX                          WAGCSX
     I              BEGDSX                          WAGDSX
     I              BEFNSX                          WAFNSX
     I              BEFOSX                          WAFOSX
     I              BEFPSX                          WAFPSX
     I              BEFQSX                          WAFQSX
     I              BEFRSX                          WAFRSX
     I              BEFSSX                          WAFSSX
     I              BEFTSX                          WAFTSX
     I              BEFUSX                          WAFUSX
     I              BEFVSX                          WAFVSX
     I              BEFWSX                          WAFWSX
     I              BEFXSX                          WAFXSX
     I              BEFYSX                          WAFYSX
     I              BENODT                          WANODT
     I              BENPDT                          WANPDT
     I              BENQDT                          WANQDT
     I              BENRDT                          WANRDT
     I              BENSDT                          WANSDT
     I              BEBPTM                          WABPTM
     I              BEBQTM                          WABQTM
     I              BEBRTM                          WABRTM
     I              BEBSTM                          WABSTM
     I              BEBTTM                          WABTTM
     I              BEH0NX                          WAH0NX
     I              BEH1NX                          WAH1NX
     I              BEH2NX                          WAH2NX
     I              BEH3NX                          WAH3NX
     I              BEH4NX                          WAH4NX
     I              BEC0C7                          WAC0C7
     I              BEUVST                          WAUVST
     I              BEUWST                          WAUWST
     I              BEUXST                          WAUXST
     I              BEAATM                          WAAATM
     I              BEAYNA                          WAAYNA
     I              BEA0NA                          WAA0NA
     I              BEAXDT                          WAAXDT
      *
     I@F7REFP
      * Cust Distribution Entry   Retrieval index
      * Renamed input format fields
     I              F7BKC7                          WBBKC7
     I              F7MNAA                          WBMNAA
     I              F7RNNY                          WBRNNY
     I              F7WLT1                          WBWLT1
     I              F7IRST                          WBIRST
     I              F7WMT1                          WBWMT1
     I              F7VSST                          WBVSST
     I              F7MJDT                          WBMJDT
     I              F7BETM                          WBBETM
     I              F7CCVN                          WBCCVN
     I              F7CDVN                          WBCDVN
     I              F7MKDT                          WBMKDT
     I              F7BFTM                          WBBFTM
     I              F7CEVN                          WBCEVN
     I              F7CFVN                          WBCFVN
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
      * Outward parameters
     IPARC        DS                             10
      * KEY : Order Header TRG          Co/Order Decend/Date Ord
      * I : RST Company Number
     I                                    P   1   20PAAIC3
      * I : RST Order Number
     I                                    P   3   60PAC4NB
      * I : RST Order Date
     I                                    P   7  100PAA0DT
      *
     IQPDJ41    E DSPDJ4CPL0
      * UPD : WF Invoice List Work      Update index
      *
     IQPMAF1    E DSPMAFCPL0
      * UPD : WF Invoice/Combine Drv    Update index
      *
      * Outward parameters
     IPBRC        DS                             12
      * KEY : History Dtl Accrual       Retrieval index
      * I : RST Company Number
     I                                    P   1   20PBAIC3
      * I : RST Order Number
     I                                    P   3   60PBC4NB
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P1AJCD
      * N :  Company Number
     I                                    P   4   50P1AIC3
      * N :  Application Code
     I                                        6  11 P1DNCD
      * N :  Salesperson Code
     I                                       12  14 P1BCCD
      * N :  Allow Multi-Company
     I                                       15  15 P1I6ST
      * N :  Default Printer
     I                                       16  25 P1MPNA
      * N :  First Time Flag
     I                                       26  26 P1TAST
      * N :  Name
     I                                       27  56 P1ADTX
      * N :  System Value Alpha
     I                                       57  96 P1BXTX
      * N :  Access Denied (Y/N)
     I                                       97  97 P1WVST
     IP2PARM      DS
      * FLD: *Arrays
      * N :  PRT Description
     I                                        1  25 P2G3TX
      * N :  PRT Printer Device
     I                                       26  35 P2WRST
      * N :  PRT Hold Output Sts
     I                                       36  39 P2WSST
      * N :  PRT Save Output Sts
     I                                       40  43 P2WTST
      * N :  PRT Number of Copies
     I                                       44  450P2DYNB
      * N :  PRT Night Queue Run Sts
     I                                       46  46 P2WUST
      * N :  PRT Night Queue
     I                                       47  56 P2BVVN
      * N :  Company Number Pass   USR
     I                                    P  57  645P2AJAA
      * N :  Customer Number Pass  USR
     I                                    P  65  725P2AJNC
      * N :  Order Number 2  PASS  USR
     I                                    P  73  805P2AJAF
      * N :  System Value Numeric
     I                                    P  81  885P2M8NB
      * N :  Status - Y or N
     I                                       89  89 P2B8ST
     IP3PARM      DS
      * N :  PRT Night Queue  USR
     I                                        1  10 P3B7VN
     IP4PARM      DS
      * N :  Job Name CDE
     I                                        1  10 P4B2VN
     IP5PARM      DS
      * N :  Use Credit Contact Info
     I                                        1   1 P5
     IP6PARM      DS
      * N :  Cover Sheet Name
     I                                        1  10 P6LGTX
     IP7PARM      DS
      * N :  Job Number USR
     I                                        1   6 P7HAAA
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD7 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'CD3 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Fax Invoice Flag is no'
      * A/R Customer
     I                                        1   7 ZA0001
      * Message data for 'Invoice waiting to Fax'
      * Invoice Number
     I                                    P   1   40ZA0002
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0003
      * Application Code
     I                                       11  16 ZA0004
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0005
      * Application Code
     I                                       11  16 ZA0006
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
      * First Time
      * CASE: PAR.First Time Flag is Yes
     C           P1TAST    IFEQ 'Y'                        *IF
     C                     Z-ADDP1AIC3    #2AIC3           Company Number
     C                     MOVEL'N'       P1TAST           First Time Flag
     C                     END                             *FI
     C                     MOVEL*BLANK    P2WRST           PRT Printer Dev
      * *Set Cursor: CTL.Invoice Date  (*Override=*YES)
     C                     Z-ADD*ZERO     W0RR0
     C                     Z-ADD010       W0ROW0
     C                     Z-ADD005       W0COL0
     C                     MOVEL'1'       W0OVR0           *YES
      * select on order number
      * CASE: CTL.Order Number is Not equal to zeros
     C           #2C4NB    IFNE *ZERO                      *IF
      * RTV Cust Name Inv Date RT - Order Header TRG  * 
     C                     EXSR SARVGN
     C                     END                             *FI
      * select on name
      * CASE: CTL.Name 25A USR NE WRK.Blank for 30          USR
     C           #CUJTX    IFNE WUW4TX                     *IF
      * CVT Str to Upper Alpha US - /UT User Source  * 
     C                     MOVEA#CUJTX    AR1              LOAD ARRAY
     C                     MOVEA*BLANK    AR2              LOAD ARRAY
     C                     Z-ADD1         X1      20       SET COUNTER
     C                     Z-ADD1         Y1      20       SET COUNTER
      * * * * * * * CHECK FOR ALPHABETIC CHARACTERS * * * * * * *
     C           X1        DOWLT31
     C           AR1,X1    IFEQ ' '
     C           AR1,X1    ORGE 'a'
     C           AR1,X1    ANDLE'Z'
     C           AR1,X1    ANDNE'~'
     C           AR1,X1    ANDNE'{'
     C           AR1,X1    ANDNE'}'
     C           AR1,X1    ANDNE'\'
     C                     MOVE AR1,X1    AR2,Y1
     C                     ADD  1         Y1
     C                     ADD  1         X1
     C                     ELSE
     C                     ADD  1         X1
     C                     END
     C                     END
     C                     Z-ADD1         Y1
     C           Y1        DOWLT31
     C           AR2,Y1    IFEQ 'a'
     C                     MOVEL'A'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'b'
     C                     MOVEL'B'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'c'
     C                     MOVEL'C'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'd'
     C                     MOVEL'D'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'e'
     C                     MOVEL'E'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'f'
     C                     MOVEL'F'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'g'
     C                     MOVEL'G'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'h'
     C                     MOVEL'H'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'i'
     C                     MOVEL'I'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'j'
     C                     MOVEL'J'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'k'
     C                     MOVEL'K'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'l'
     C                     MOVEL'L'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'm'
     C                     MOVEL'M'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'n'
     C                     MOVEL'N'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'o'
     C                     MOVEL'O'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'p'
     C                     MOVEL'P'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'q'
     C                     MOVEL'Q'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'r'
     C                     MOVEL'R'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 's'
     C                     MOVEL'S'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 't'
     C                     MOVEL'T'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'u'
     C                     MOVEL'U'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'v'
     C                     MOVEL'V'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'w'
     C                     MOVEL'W'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'x'
     C                     MOVEL'X'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'y'
     C                     MOVEL'Y'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'z'
     C                     MOVEL'Z'       AR2,Y1
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     ADD  1         Y1
     C                     END
     C                     MOVEAAR2       #CUJTX           LOAD OUTPUT
     C                     MOVEL#CUJTX    YL0001           Name 25A USR
     C                     END                             *FI
     C                     MOVEL#CLTCD    YL0002           EDI Invoice Sts
     C                     MOVEL#CVQSX    YL0003           Email Selection
     C                     MOVEL#CRLST    YL0004           Fax Invoice Fla
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           BEAWDT           Invoice Date
     C                     KFLD           BEAETX           Bill to Name
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C           #2AWDT    IFEQ *ZERO
     C                     MOVEL*HIVAL    BEAWDT           Invoice Date
     C                     ELSE
     C                     Z-ADD#2AWDT    BEAWDT
     C                     ENDIF
     C                     MOVEL#2AETX    BEAETX
     C                     Z-ADD#2C4NB    BEC4NB
     C           KPOS      SETLL@BFCPOA
     C                     READ @BFCPOA                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #2AETX    WZAETX
     C                     MOVEL#2AETX    WZAETX           Bill to Name
     C           *LIKE     DEFN #2AWDT    WZAWDT
     C                     MOVEL#2AWDT    WZAWDT           Invoice Date
     C           *LIKE     DEFN #2B0C7    WZB0C7
     C                     MOVEL#2B0C7    WZB0C7           Bill to Custome
     C           *LIKE     DEFN #2BKC7    WZBKC7
     C                     MOVEL#2BKC7    WZBKC7           Ship To Custome
     C           *LIKE     DEFN #2AIC3    WZAIC3
     C                     MOVEL#2AIC3    WZAIC3           Company Number
     C           *LIKE     DEFN #2C4NB    WZC4NB
     C                     MOVEL#2C4NB    WZC4NB           Order Number
     C           *LIKE     DEFN #2JNCD    WZJNCD
     C                     MOVEL#2JNCD    WZJNCD           Order Type - Sa
     C           *LIKE     DEFN #2CONB    WZCONB
     C                     MOVEL#2CONB    WZCONB           Invoice Number
     C           *LIKE     DEFN #2BCNA    WZBCNA
     C                     MOVEL#2BCNA    WZBCNA           Customer Purcha
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@BFCPOA                  90*
     C  N82                READ @BFCPOA                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  1
     C                     MOVEAWKIND0    *IN,43
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2AWDT    IFEQ *ZERO                      Invoice Date
     C           #2AETX    IFNE *BLANK                     Bill to Name
     C           BEAETX    CABLT#2AETX    BB020            Bill to Name
     C                     END
     C                     END
     C           #2B0C7    IFNE *ZERO                      Bill to Custome
     C           BEB0C7    CABNE#2B0C7    BB020            Bill to Custome
     C                     END
     C           #2BKC7    IFNE *ZERO                      Ship To Custome
     C           BEBKC7    CABNE#2BKC7    BB020            Ship To Custome
     C                     END
     C           #2AIC3    IFNE *ZERO                      Company Number
     C           BEAIC3    CABNE#2AIC3    BB020            Company Number
     C                     END
     C           #2AWDT    IFEQ *ZERO                      Invoice Date
     C           #2AETX    OREQ *BLANK                     Bill to Name
     C           #2C4NB    IFNE *ZERO                      Order Number
     C           BEC4NB    CABNE#2C4NB    BB020            Order Number
     C                     END
     C                     END
     C           #2JNCD    IFNE *BLANK                     Order Type - Sa
     C           BEJNCD    CABNE#2JNCD    BB020            Order Type - Sa
     C                     END
     C           #2CONB    IFNE *ZERO                      Invoice Number
     C           BECONB    CABNE#2CONB    BB020            Invoice Number
     C                     END
     C           #2BCNA    IFNE *BLANK                     Customer Purcha
     C           BEBCNA    CABNE#2BCNA    BB020            Customer Purcha
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
      * Match company number
      * CASE: CTL.Company Number NE WRK.ZERO
     C           #2AIC3    IFNE WUW0NB                     *IF
      * CASE: DB1.Company Number NE CTL.Company Number
     C           BEAIC3    IFNE #2AIC3                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Customer Name
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: CTL.Name 25A USR NE WRK.BLANK
     C           #CUJTX    IFNE WUGSTX                     *IF
      * CLC Call Qclscan       UP - /UT User Source  * 
     C                     CALL 'QCLSCAN'              90  CLC Call Qclsca
     C                     PARM #1AETX    WQ0001256        USR Qclscan fie
     C                     PARM 30        WQ0002  30       USR Qclscan Len
     C                     PARM 1         WQ0003  30       USR Qclscan Sta
     C                     PARM #CUJTX    WQ0004256        USR Qclscan Mas
     C                     PARM 25        WQ0005  30       USR Qclscan Mas
     C                     PARM '1'       WQ0006  1        USR Qclscan Tra
     C                     PARM '1'       WQ0007  1        USR Qclscan Tri
     C                     PARM *BLANK    WQ0008  1        USR Qclscan Wil
     C           WUY8NB    PARM WUY8NB    WQ0009  30       USR Qclscan Res
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'QCLSCAN' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9832  *
     C                     END
      * CASE: WRK.USR Qclscan Result ? is Does contain
     C           WUY8NB    IFGT 0                          *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Exclude non-invoiced orders
      * CASE: DB1.Invoice Number EQ WRK.ZERO
     C           BECONB    IFEQ WUW0NB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Exclude Credit/Debit Memos
      * CASE: DB1.Billing Activity Type is Credit Memo
     C           BEOBST    IFEQ '2'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     MOVEL*BLANK    P2B8ST           Status - Y or N
      * ** Set Fax to Yes if it exists
     C                     MOVEL*BLANK    YL0005           CDE Destination
     C                     MOVEL*BLANK    YL0006           CDE Name
      * RTV CDE Fax-1 only    RT - Cust Distribution Entry  * 
     C                     EXSR SBRVGN
      * Set Fax Invoice Flag                                  P000198
      * CASE: LCL.CDE Destination is Entered
     C           YL0005    IFNE *BLANK                     *IF
     C                     MOVEL'Y'       #RRLST           Fax Invoice Fla
     C                     MOVELYL0006    #ROHNA           Fax Invoice Con
     C                     MOVELYL0005    #RMMTX           Fax Invoice Fax
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #RRLST           Fax Invoice Fla
     C                     END                             *FI
      * ** Set Email to Yes if it exists
     C                     MOVEL*BLANK    YL0005           CDE Destination
     C                     MOVEL*BLANK    YL0006           CDE Name
      * 04/16/19 DN R14851-Get Destination Type for Email or One Email/In
      * RTV CDE 1st Eml only2 RT - Cust Distribution Entry  * 
     C                     EXSR SCRVGN
      * Set Email Invoice Flag                                P000198
      * CASE: LCL.CDE Destination is Entered
     C           YL0005    IFNE *BLANK                     *IF
     C                     MOVELYL0006    #ROHNA           Fax Invoice Con
     C                     MOVELYL0005    #RMMTX           Fax Invoice Fax
     C                     MOVEL'Y'       #RVQSX           Email Selection
      * 04/16/19 DN R14851-Set Email Selection usr='O' if Destination Typ
      * CASE: LCL.CDE Destination Type is One Email/Invoice
     C           YL0007    IFEQ 'O'                        *IF
     C                     MOVEL'O'       #RVQSX           Email Selection
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #RVQSX           Email Selection
     C                     END                             *FI
      * Rtv EDI/Prt Invoice   RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1ANC7    WL0001           Ship To Custome
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #RLTCD    P      EDI Invoice Sts
     C                     MOVELWL0003    YN0001    P      Print Invoice S
      * SEL: EDI Invoice Sts
      * CASE: CTL.EDI Invoice Sts is Y/N Values
     C           #CLTCD    IFEQ 'N'                        *IF
     C           #CLTCD    OREQ 'Y'
      * CASE: CTL.EDI Invoice Sts NE RCD.EDI Invoice Sts
     C           #CLTCD    IFNE #RLTCD                     *IF
      * 04/17/19 DN R14851-Added Record Selected=*NO.
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * SEL: Fax Invoice Sts
      * CASE: CTL.Fax Invoice Flag is *ALL values
     C           #CRLST    IFEQ 'Y'                        *IF
     C           #CRLST    OREQ 'N'
      * CASE: CTL.Fax Invoice Flag NE RCD.Fax Invoice Flag
     C           #CRLST    IFNE #RRLST                     *IF
      * 04/17/19 DN R14851-Added Record Selected=*NO.
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * 04/17/19 DN R14851-Replace 'SEL: Email Invoice Sts' to not use LS
      * SEL: Email Invoice Sts                        04/17/19 DN R14851
      * CASE:
      *  - c1 OR c2
      *   |- c1    : CTL.Email Selection usr is Not Selected
      *   |- c2    : CTL.Email Selection usr EQ RCD.Email Selection usr
      *   '-
     C           #CVQSX    IFEQ *BLANK                     *IF
     C           #CVQSX    OREQ #RVQSX                     *OR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * SFL Fold/Drop  RPG 2  US - /UT User Source  * 
     C           MODE      IFEQ '0'
     C                     SETON                     89
     C                     ELSE
     C                     SETOF                     89
     C                     ENDIF
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C                     READ @BFCPOA                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate Invoice Date
      * External date
     C                     Z-ADDV2AWDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     Z-ADDXDINDT    #2AWDT
      * Validate Bill to Customer and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2B0C7    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2B0C7    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,002                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2B0C7           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2B0C7           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Ship To Customer and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2BKC7    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,002                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2BKC7           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2BKC7           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV2AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,002                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #2AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Order Number and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2C4NB    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,002                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #2C4NB           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2C4NB           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Fax Invoice Flag
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#CRLST'  IFEQ YPMTFD
      * Fax Invoice Flag
     C                     MOVEL#CRLST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFRLST
     C                     SELEC
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD1         ZFRLST
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD2         ZFRLST
     C                     ENDSL
     C                     EXFMTZERLST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFRLST    WHEQ 1
     C                     MOVEL'Y'       W0INVL           Y
     C           ZFRLST    WHEQ 2
     C                     MOVEL'N'       W0INVL           N
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #CRLST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Email Selection usr
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#CVQSX'  IFEQ YPMTFD
      * Email Selection usr
     C                     MOVEL#CVQSX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZFVQSX
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZFVQSX
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZFVQSX
     C           W0INVL    WHEQ 'O'                        O
     C                     Z-ADD3         ZFVQSX
     C                     ENDSL
     C                     EXFMTZEVQSX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZFVQSX    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZFVQSX    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C           ZFVQSX    WHEQ 3
     C                     MOVEL'O'       W0INVL           O
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #CVQSX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    CABNE*BLANKS   DATAG1
      * Change of position specified
     C           WZAWDT    CASNE#2AWDT    FBRQRL
     C           WZB0C7    CASNE#2B0C7    FBRQRL
     C           WZBKC7    CASNE#2BKC7    FBRQRL
     C           WZAIC3    CASNE#2AIC3    FBRQRL
     C           WZC4NB    CASNE#2C4NB    FBRQRL
     C           WZJNCD    CASNE#2JNCD    FBRQRL
     C           WZCONB    CASNE#2CONB    FBRQRL
     C           WZBCNA    CASNE#2BCNA    FBRQRL
     C                     END
     C           DATAG1    TAG
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process subfile control (Pre-confirm)
      * Reload sfl if select by name changes
      * CASE: CTL.Name 25A USR NE LCL.Name 25A USR
     C           #CUJTX    IFNE YL0001                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * Reload sfl if reload for EDI changes
      * CASE: CTL.EDI Invoice Sts NE LCL.EDI Invoice Sts
     C           #CLTCD    IFNE YL0002                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * Reload sfl if Email Inv Sts Changes           04/17/19 DN R14851
      * CASE: CTL.Email Selection usr NE LCL.Email Selection usr
     C           #CVQSX    IFNE YL0003                     *IF
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * USER: Final processing (Pre-confirm)
      * Fax or Email Invoice
      * CASE: PAR.Status - Y or N is yes
     C           P2B8ST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       P5               Use Credit Cont
     C                     MOVEL*BLANK    P6LGTX           Cover Sheet Nam
     C                     MOVEL'SI'      P6LGTX           Cover Sheet Nam
      * PRC Fax Invoice        UP - /UT User Programs  * 
     C                     CALL 'PDVMUPC'              90  PRC Fax Invoice
     C           W0RTN     PARM *BLANK    WQ0010  7        *Return code
     C                     PARM @CN,003   WQ0011 10        Program name US
     C                     PARM 'OMS'     WQ0012  6        Application Cod
     C                     PARM @CN,004   WQ0013 25        PRT Description
     C                     PARM P2AJAA    WQ0014 155       Company Number
     C                     PARM P2AJNC    WQ0015 155       Customer Number
     C                     PARM WUAJAF    WQ0016 155       Order Number 2
     C           YL0008    PARM YL0008    WQ0017  1        USR Active Flag
     C           P3B7VN    PARM P3B7VN    WQ0018 10        PRT Night Queue
     C           P4B2VN    PARM P4B2VN    WQ0019 10        Job Name CDE
     C           P6LGTX    PARM P6LGTX    WQ0020 10        Cover Sheet Nam
     C                     PARM P5        WQ0021  1        Use Credit Cont
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDVMUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Message if printed
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Send message 'Fax Invoice sent to cust'
     C                     MOVEL'USR2446' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,43
     C                     SETOF                     98    *
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * USER: Process subfile record (Pre-confirm)
     C                     Z-ADD#1AIC3    P2AJAA           Company Number
     C                     Z-ADD#1C4NB    P2AJAF           Order Number 2
     C                     Z-ADD#1ANC7    P2AJNC           Customer Number
     C                     Z-ADD#1B0C7    YL0009           A/R Customer Nu
     C                     MOVEL@CN,005   YL0010           Program name US
     C                     MOVEL'R'       YL0008           Reprint Status
     C                     MOVEL'N'       P2WUST           PRT Night Queue
     C                     MOVEL##JOB     P4B2VN           Job Name CDE
      * Set flag = Invoice Reprint
      * 5=Order Inquiry Detail
      * CASE: RCD.*SFLSEL is *Display
     C           #1SEL     IFEQ '5'                        *IF
     C           #1SEL     OREQ ' 5'
      * CASE: RCD.Billing Activity Type is Credit or Debit Memo
     C           #1OBST    IFEQ '2'                        *IF
     C           #1OBST    OREQ '3'
      * DSP Credit/Debit Memo  D1 - Order Header TRG  * 
     C                     CLEARPARC
     C                     Z-ADD#1AIC3    PAAIC3           Company Number
     C                     Z-ADD#1C4NB    PAC4NB           Order Number
     C                     Z-ADD#1A0DT    PAA0DT           Order Date
      *
     C                     CALL 'PDIXD1R'              90  DSP Credit/Debi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDIXD1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: RCD.Event Code is Shipped Thru 07 History
     C           #1JPCD    IFGE '04'                       *IF
     C           #1JPCD    ANDLE'07'
      * DSP Ord Inq Ship Dtl   DF - Order Detail  * 
     C                     CALL 'PDP3DFR'              90  DSP Ord Inq Shi
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0022  30       Company Number
     C                     PARM #1C4NB    WQ0023  70       Order Number
     C           WUDPNB    PARM *ZERO     WQ0024  30       Order Sequence
     C           P1DNCD    PARM P1DNCD    WQ0025  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDP3DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * DSP Ord Inquiry Detail DF - Order Detail  * 
     C                     CALL 'PDPZDFR'              90  DSP Ord Inquiry
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0026  30       Company Number
     C                     PARM #1C4NB    WQ0027  70       Order Number
     C           WUDPNB    PARM *ZERO     WQ0028  30       Order Sequence
     C           WUUENB    PARM *ZERO     WQ0029  30       Order Secondary
     C           P1DNCD    PARM P1DNCD    WQ0030  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPZDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 6=Reprint/EDI
      * CASE: RCD.*SFLSEL is *Print
     C           #1SEL     IFEQ '6'                        *IF
     C           #1SEL     OREQ ' 6'
      * Rtv EDI/Prt Invoice   RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1ANC7    WL0001           Ship To Custome
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0002    P      EDI Invoice Sts
     C                     MOVELWL0003    YL0011    P      Print Invoice S
      * RMC added this check - dont create edi files if cust isnt set for
      * CASE: LCL.EDI Invoice Sts is yes
     C           YL0002    IFEQ 'Y'                        *IF
      *  7/13/2021 JBB SDD657 - Get Send EDI Document flag
      * Rtv EDI Manual PO Sts XF - EDI Bill To Interchange  * IN
     C                     CALL 'PUTBXFR'              90  Rtv EDI Manual
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0031  30       Company Number
     C                     PARM #1C4NB    WQ0032  70       Order Number
     C                     PARM 'IN'      WQ0033  6        Interchange Cod
     C           YL0012    PARM *BLANK    WQ0034  1        Send EDI Docume
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUTBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * If Send EDI Document flag is Y, set EDI Invoice Status = Y
      * CASE: LCL.Send EDI Document Y/N is Yes
     C           YL0012    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0002           EDI Invoice Sts
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0002           EDI Invoice Sts
     C                     END                             *FI
     C                     END                             *FI
      * CASE: LCL.EDI Invoice Sts is yes
     C           YL0002    IFEQ 'Y'                        *IF
      * RTV OD Whs/ShpCo/AccCo RT - Order Detail  * 
     C                     EXSR SERVGN
      * Del ECP001/002/003    UP - EDI Invoice header  * 
     C                     CALL 'EC201'                90  Del ECP001/002/
     C                     PARM YL0013    WQ0035  30       Company Number
     C                     PARM #1CONB    WQ0036  70       Invoice Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'EC201'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     98    *
     C                     END
      * Crt ECP001/002/003    UP - EDI Invoice header  * 
     C                     CALL 'EC200'                90  Crt ECP001/002/
     C                     PARM YL0013    WQ0037  30       Company Number
     C                     PARM #1C4NB    WQ0038  70       Order Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'EC200'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#1AIC3    P2AJAA           Company Number
     C                     Z-ADD#1C4NB    P2AJAF           Order Number 2
     C                     MOVEL'Y'       YL0008           Reprint Status
     C                     MOVEL'N'       P2WUST           PRT Night Queue
     C                     Z-ADD#1B0C7    YL0009           A/R Customer Nu
      * PRT Invc/Pre-Invc Reg  UP - /UT User Programs  * 
     C                     CALL 'PDTLUPR'              90  PRT Invc/Pre-In
     C           W0RTN     PARM *BLANK    WQ0039  7        *Return code
     C                     PARM @CN,005   WQ0040 10        Program name US
     C                     PARM ##JOB     WQ0041 10        Program Name$ U
     C                     PARM P1DNCD    WQ0042  6        Application Cod
     C                     PARM P4B2VN    WQ0043 10        Job Name CDE
     C                     PARM P7HAAA    WQ0044  6        Job Number USR
     C                     PARM #1OBST    WQ0045  1        Billing Activit
     C                     PARM @CN,006   WQ0046 25        PRT Description
     C           P2WRST    PARM P2WRST    WQ0047 10        PRT Printer Dev
     C           P2WSST    PARM P2WSST    WQ0048  4        PRT Hold Output
     C           P2WTST    PARM P2WTST    WQ0049  4        PRT Save Output
     C           P2WUST    PARM P2WUST    WQ0050  1        PRT Night Queue
     C           P2BVVN    PARM P2BVVN    WQ0051 10        PRT Night Queue
     C                     PARM P2AJAA    WQ0052 155       Company Number
     C                     PARM *ZERO     WQ0053 155       Thru Date Pass
     C                     PARM *ZERO     WQ0054 155       Order Number 1
     C                     PARM P2AJAF    WQ0055 155       Order Number 2
     C           P2M8NB    PARM P2M8NB    WQ0056 155       System Value Nu
     C           YL0008    PARM YL0008    WQ0057  1        USR Active Flag
     C                     PARM 'N'       WQ0058  1        USR Print Pre-I
     C                     PARM 'N'       WQ0059  1        USR Print Pre-I
     C                     PARM 'I'       WQ0060  1        Invoice/Pre-Inv
     C                     PARM YL0009    WQ0061 155       A/R Customer Nu
     C                     PARM 'OR'      WQ0062  2        Process Cust Ty
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDTLUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     98    *
     C                     END
      * Message if printed
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Send message 'Print has been Submitted'
     C                     MOVEL'USR1832' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * 7=Select for Fax or Email
      * CASE: RCD.*SFLSEL is Fax
     C           #1SEL     IFEQ '7'                        *IF
     C           #1SEL     OREQ ' 7'
      * ** Set fax flag=Yes so wf rec isn't deleted before invoice is fax
     C                     MOVEL'Y'       WURLST           Fax Invoice Fla
      * Fax if Fax Invoice flag is Yes
      * CASE: WRK.Fax Invoice Flag is No Automatic Fax Invoice
     C           WURLST    IFEQ 'N'                        *IF
      * Setup message data for message
      * Convert A/R Customer Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1ANC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1ANC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0001           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0001           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Fax Invoice Flag is no'
     C                     MOVEL'USR2898' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * First time only:  prompt for night run
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.PRT Night Queue  USR is Not entered
      *   |- c2    : PAR.Status - Y or N is blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3B7VN    IFEQ *BLANK                     *IF
     C           P2B8ST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PMT Print Opts Nightq  PV - Print Options  * 
     C                     CALL 'PDXOPVR'              90  PMT Print Opts
     C                     PARM *BLANK    W0RTN   7
     C                     PARM @CN,004   WQ0063 25        PRT Description
     C           P3B7VN    PARM P3B7VN    WQ0064 10        PRT Night Queue
     C                     PARM 'OMS'     WQ0065  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXOPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ @CN,007                    *IF
     C                     MOVEL'N'       P2B8ST           Status - Y or N
     C                     END                             *FI
     C                     END                             *FI
      * Set night queue
      * CASE: PAR.PRT Night Queue  USR is JOBD
     C           P3B7VN    IFEQ '*JOBD'                    *IF
     C                     MOVEL##JOB     P4B2VN           Job Name CDE
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL@CN,008   P4B2VN           Job Name CDE
     C                     END                             *FI
      * Fax or Email Invoice
      * CASE: PAR.Status - Y or N is no
     C           P2B8ST    IFEQ 'N'                        *IF
      *      don't do anything; this means they're not going to do this.
     C                     ELSE
      * CASE: *OTHERWISE
      * CRT PD Invoice List Wk CR - WF Invoice List Work  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP4B2VN    WL0004    P      Job Name CDE
     C                     Z-ADD#1C4NB    WL0005           Order Number
     C                     Z-ADD#1JZVA    WL0006           Order Value Tot
     C                     Z-ADD#1A1WG    WL0007           Order Weight To
     C                     MOVEL#1BRTX    WL0008    P      Ship To Name
     C                     MOVEL#1AETX    WL0009    P      Bill to Name
     C                     MOVELWURLST    WL0010    P      Fax Invoice Fla
     C                     Z-ADD#1BKC7    WL0011           Ship to Custome
     C                     Z-ADD#1ANC7    WL0012           Ship To Custome
     C                     Z-ADD#1AIC3    WL0013           Company Number
     C                     Z-ADD#1CONB    WL0014           Invoice Number
     C                     MOVEL#1CEST    WL0015    P      Invoice Suffix
     C                     EXSR SGCRRC
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       P2B8ST           Status - Y or N
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#1CONB    ZA0002           Invoice Number
      * Send message 'Invoice waiting to Fax'
     C                     MOVEL'USR2509' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * 8=Reprint
      * CASE: RCD.*SFLSEL is Option 8
     C           #1SEL     IFEQ '8'                        *IF
     C           #1SEL     OREQ ' 8'
      * Rtv One Invoice /PO   RT - Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BKC7    WL0016           Ship To Custome
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0017    YL0014    P      One Invoice Per
      * Crt Combo or Standard invoice work file record
      * CASE: LCL.One Invoice Per PO is Yes
     C           YL0014    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    P7HAAA           Job Number USR
     C                     MOVEL##JNO     P7HAAA           Job Number USR
      * Crt WF Invoice/Combine CR - WF Invoice/Combine Drv  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP4B2VN    WL0018    P      Job Name CDE
     C                     MOVELP7HAAA    WL0019    P      Job Number Cde
     C                     Z-ADD#1C4NB    WL0020           Order Number
     C                     MOVEL#1AETX    WL0021    P      Bill to Name
     C                     Z-ADD#1JZVA    WL0022           Order Value Tot
     C                     Z-ADD#1A1WG    WL0023           Order Weight To
     C                     MOVEL#1BRTX    WL0024    P      Ship To Name
     C                     MOVEL'N'       WL0025    P      Fax Invoice Fla
     C                     MOVELYL0014    WL0026    P      One Invoice Per
     C                     MOVEL#1BCNA    WL0027    P      Customer Purcha
     C                     MOVEL'N'       WL0028    P      Combine Invoice
     C                     MOVEL#1OBST    WL0029    P      WF Inv/Comb Bil
     C                     Z-ADD#1GNDT    WL0030           Actual Shipped
     C                     Z-ADD#1BKC7    WL0031           Ship To Custome
     C                     Z-ADD#1B0C7    WL0032           Bill to Custome
     C                     Z-ADD#1AIC3    WL0033           Company Number
     C                     Z-ADD#1CONB    WL0034           Invoice Number
     C                     MOVEL#1CEST    WL0035    P      Invoice Suffix
     C                     MOVEL'A'       WL0036    P      Record Status
     C                     EXSR SICRRC
     C                     ELSE
      * CASE: *OTHERWISE
      * CRT PD Invoice List Wk CR - WF Invoice List Work  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP4B2VN    WL0004    P      Job Name CDE
     C                     Z-ADD#1C4NB    WL0005           Order Number
     C                     Z-ADD#1JZVA    WL0006           Order Value Tot
     C                     Z-ADD#1A1WG    WL0007           Order Weight To
     C                     MOVEL#1BRTX    WL0008    P      Ship To Name
     C                     MOVEL#1AETX    WL0009    P      Bill to Name
     C                     MOVEL'N'       WL0010    P      Fax Invoice Fla
     C                     Z-ADD#1BKC7    WL0011           Ship to Custome
     C                     Z-ADD#1ANC7    WL0012           Ship To Custome
     C                     Z-ADD#1AIC3    WL0013           Company Number
     C                     Z-ADD#1CONB    WL0014           Invoice Number
     C                     MOVEL#1CEST    WL0015    P      Invoice Suffix
     C                     EXSR SGCRRC
     C                     END                             *FI
      * ** Call PDTLUPR PRT Invc/Pre-Invc Reg UP to submit reprint pgm
      * PRT Invc/Pre-Invc Reg  UP - /UT User Programs  * 
     C                     CALL 'PDTLUPR'              90  PRT Invc/Pre-In
     C           W0RTN     PARM *BLANK    WQ0066  7        *Return code
     C                     PARM YL0010    WQ0067 10        Program name US
     C                     PARM P4B2VN    WQ0068 10        Program Name$ U
     C                     PARM P1DNCD    WQ0069  6        Application Cod
     C                     PARM P4B2VN    WQ0070 10        Job Name CDE
     C                     PARM P7HAAA    WQ0071  6        Job Number USR
     C                     PARM #1OBST    WQ0072  1        Billing Activit
     C                     PARM @CN,009   WQ0073 25        PRT Description
     C           P2WRST    PARM P2WRST    WQ0074 10        PRT Printer Dev
     C           P2WSST    PARM P2WSST    WQ0075  4        PRT Hold Output
     C           P2WTST    PARM P2WTST    WQ0076  4        PRT Save Output
     C           P2WUST    PARM P2WUST    WQ0077  1        PRT Night Queue
     C           P2BVVN    PARM P2BVVN    WQ0078 10        PRT Night Queue
     C                     PARM P2AJAA    WQ0079 155       Company Number
     C                     PARM *ZERO     WQ0080 155       Thru Date Pass
     C                     PARM *ZERO     WQ0081 155       Order Number 1
     C                     PARM P2AJAF    WQ0082 155       Order Number 2
     C           P2M8NB    PARM P2M8NB    WQ0083 155       System Value Nu
     C           YL0008    PARM YL0008    WQ0084  1        USR Active Flag
     C                     PARM 'N'       WQ0085  1        USR Print Pre-I
     C                     PARM 'N'       WQ0086  1        USR Print Pre-I
     C                     PARM 'I'       WQ0087  1        Invoice/Pre-Inv
     C                     PARM YL0009    WQ0088 155       A/R Customer Nu
     C                     PARM 'OR'      WQ0089  2        Process Cust Ty
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDTLUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     98    *
     C                     END
      * Printed message
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Send message 'Print has been Submitted'
     C                     MOVEL'USR1832' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
      * 9=Reprint (Form)
      * CASE: RCD.*SFLSEL is Option 9
     C           #1SEL     IFEQ '9'                        *IF
     C           #1SEL     OREQ ' 9'
     C                     MOVEL'Y'       YL0008           Reprint Status
      * Rtv One Invoice /PO   RT - Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1BKC7    WL0016           Ship To Custome
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0017    YL0014    P      One Invoice Per
      * CASE: LCL.One Invoice Per PO is Yes
     C           YL0014    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    P7HAAA           Job Number USR
     C                     MOVEL##JNO     P7HAAA           Job Number USR
      * Crt WF Invoice/Combine CR - WF Invoice/Combine Drv  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP4B2VN    WL0018    P      Job Name CDE
     C                     MOVELP7HAAA    WL0019    P      Job Number Cde
     C                     Z-ADD#1C4NB    WL0020           Order Number
     C                     MOVEL#1AETX    WL0021    P      Bill to Name
     C                     Z-ADD#1JZVA    WL0022           Order Value Tot
     C                     Z-ADD#1A1WG    WL0023           Order Weight To
     C                     MOVEL#1BRTX    WL0024    P      Ship To Name
     C                     MOVEL'N'       WL0025    P      Fax Invoice Fla
     C                     MOVELYL0014    WL0026    P      One Invoice Per
     C                     MOVEL#1BCNA    WL0027    P      Customer Purcha
     C                     MOVEL'N'       WL0028    P      Combine Invoice
     C                     MOVEL#1OBST    WL0029    P      WF Inv/Comb Bil
     C                     Z-ADD#1GNDT    WL0030           Actual Shipped
     C                     Z-ADD#1BKC7    WL0031           Ship To Custome
     C                     Z-ADD#1B0C7    WL0032           Bill to Custome
     C                     Z-ADD#1AIC3    WL0033           Company Number
     C                     Z-ADD#1CONB    WL0034           Invoice Number
     C                     MOVEL#1CEST    WL0035    P      Invoice Suffix
     C                     MOVEL'A'       WL0036    P      Record Status
     C                     EXSR SICRRC
     C                     END                             *FI
     C                     END                             *FI
      * 11=Ordered vs. Shipped Detail
      * CASE: RCD.*SFLSEL is Option 11
     C           #1SEL     IFEQ '11'                       *IF
      * CASE: RCD.Billing Activity Type is Credit or Debit Memo
     C           #1OBST    IFEQ '2'                        *IF
     C           #1OBST    OREQ '3'
      * Send message 'No Shipping Detail CM/DM'
     C                     MOVEL'USR2328' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * DSP Order vs. Ship Dtl DF - Order Detail  * 
     C                     CALL 'PDP7DFR'              90  DSP Order vs. S
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0090  30       Company Number
     C                     PARM #1C4NB    WQ0091  70       Order Number
     C                     PARM #1JNCD    WQ0092  2        Order Type - Sa
     C                     PARM #1BKC7    WQ0093  70       Ship To Custome
     C                     PARM #1BRTX    WQ0094 30        Ship To Name
     C                     PARM #1BCNA    WQ0095 15        Customer Purcha
     C                     PARM #1A0DT    WQ0096  70       Order Date
     C                     PARM #1GNDT    WQ0097  70       Actual Shipped
     C                     PARM #1GWST    WQ0098  1        Header Status
     C           #1XIST    PARM #1XIST    WQ0099  1        Credit Hold
     C           #1XJST    PARM #1XJST    WQ0100  1        Production Hold
     C           #1XKST    PARM #1XKST    WQ0101  1        New Customer Ho
     C                     PARM #1R4CD    WQ0102  3        Sales Route Cod
     C                     PARM P1DNCD    WQ0103  6        Application Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDP7DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * 13=Chg customer po# in Sales History and Order Header
      * CASE: RCD.*SFLSEL is Option 13
     C           #1SEL     IFEQ '13'                       *IF
      * PMT Chg Cust Po#      PV - Order Header TRG  * 
     C                     CALL 'PMD2PVR'              90  PMT Chg Cust Po
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0104  30       Company Number
     C                     PARM #1C4NB    WQ0105  70       Order Number
     C                     PARM #1BRTX    WQ0106 30        Ship To Name
     C                     PARM #1BCNA    WQ0107 15        Customer Purcha
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMD2PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * E4057 JJH 06/16/15 - Display Option 15
      * 15=Dsp Acrl Hist
      * CASE: RCD.*SFLSEL is Option 15
     C           #1SEL     IFEQ '15'                       *IF
      * Dsp Hist Dtl Accrual  DF - History Dtl Accrual  * 
     C                     CLEARPBRC
     C                     Z-ADD#1AIC3    PBAIC3           Company Number
     C                     Z-ADD#1C4NB    PBC4NB           Order Number
      *
     C                     CALL 'PBRODFR'              90  Dsp Hist Dtl Ac
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PBRC             KEY: History Dt
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBRODFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
      * 90=Create 855/865 (IT Only)
      * CASE: RCD.*SFLSEL is Option 90
     C           #1SEL     IFEQ '90'                       *IF
      * 2014/09/10 PKD/SAZ Create 855 or 865 if needed -- Option for IT
      * Parm added to IF. Not used here so pass lcl context   E004140
      * Val for PO Ack        IF
     C                     MOVEL'N'       YL0016           EDI Process Fla
      * Retrieve the BT Customer
      * Rtv Order Info ALL    RT - Order Header TRG  * 
     C                     EXSR SJRVGN
      * Check to see it the BT Cust should get a POA/POAC (ack or chgd ac
      * RTV BT Intrchg BT custRT - EDI Bill To Interchange  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0017    WL0037           Bill to Custome
     C                     MOVEL'POACK'   WL0038    P      Interchange Cod
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0039    YL0020    P      POC/POCA ??
     C                     MOVELWL0040    YL0021    P      EDI Trading Par
      * W95589 DN 01/24/23-Commented Out & Moved Below.
      * W95589 DN 01/24/23-Only Check if Record Exist to Set EDI POA Flag
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Chk to see if BT cust requires a EDI PO ACK
      * CASE: LCL.POC/POCA ?? is PO Ack
     C           YL0020    IFEQ 'POACK'                    *IF
     C                     MOVEL'Y'       YL0022           EDI POA
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0022           EDI POA
     C                     END                             *FI
     C                     END                             *FI
      * RTV BT Intrchg BT custRT - EDI Bill To Interchange  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0017    WL0037           Bill to Custome
     C                     MOVEL'POCACK'  WL0038    P      Interchange Cod
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0039    YL0020    P      POC/POCA ??
     C                     MOVELWL0040    YL0021    P      EDI Trading Par
      * W95589 DN 01/24/23-Commented Out & Moved Below.
      * W95589 DN 01/24/23-Only Check if Record Exist to Set EDI POAC Fla
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Chk to see if BT cust requires a EDI PO Chg ACK
      * CASE: LCL.POC/POCA ?? is PO Change Ack
     C           YL0020    IFEQ @CN,010                    *IF
     C                     MOVEL'Y'       YL0023           EDI POAC
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0023           EDI POAC
     C                     END                             *FI
     C                     END                             *FI
      * See if a rcd has been written to OH ext.
      * RTV EDI PO Flag       RT - Order Header Extension  * 
     C                     EXSR SLRVGN
      * Record found in Order header ext
      * CASE: LCL.Record Found USR is Record Found
     C           YL0025    IFEQ 'Y'                        *IF
      * If flag blank, No ack has been sent for this PO yet.
      * CASE:
      *  - c1ORc2
      *   |- c1    : LCL.OHE PO ACK Flag is *Blank
      *   |- c2    : LCL.OHE PO ACK Flag is *NO
      *   '-
     C           YL0024    IFEQ *BLANK                     *IF
     C           YL0024    OREQ '*NO'                      *OR
      * CASE: LCL.EDI POA is Yes
     C           YL0022    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0016           EDI Process Fla
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If flag not blank, 855 ack has been sent for this PO. Need to sen
      * another 855(865) if the customer is set up for it.
      * CASE: LCL.EDI POAC is Yes
     C           YL0023    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0016           EDI Process Fla
     C                     END                             *FI
     C                     END                             *FI
      * If record not found and POA is yes, send
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.EDI POA is Yes
     C           YL0022    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0016           EDI Process Fla
     C                     END                             *FI
     C                     END                             *FI
      * When all chks are done, need to check to see if the Cust PO
      * has been entered. If not,do not send to customer.
      * If Cust PO# not entered
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6
      *   |- c1    : LCL.Customer Purchase Order # is tba
      *   |- c2    : LCL.Customer Purchase Order # is TBA(cap)
      *   |- c3    : LCL.Customer Purchase Order # is TBD(cap)
      *   |- c4    : LCL.Customer Purchase Order # is tbd
      *   |- c5    : LCL.Customer Purchase Order # is BLOCK(cap)
      *   |- c6    : LCL.Customer Purchase Order # is Block
      *   '-
     C           YL0018    IFEQ 'tba'                      *IF
     C           YL0018    OREQ 'TBA'                      *OR
     C           YL0018    OREQ 'TBD'                      *OR
     C           YL0018    OREQ 'tbd'                      *OR
     C           YL0018    OREQ 'BLOCK'                    *OR
     C           YL0018    OREQ 'Block'                    *OR
      * S13599 DN 08/16/18-Added check for 'TBD, tbd, BLOCK & Block'.
     C                     MOVEL'N'       YL0016           EDI Process Fla
     C                     MOVEL'NP'      YL0015           Trans Type 1 PA
     C                     END                             *FI
      * 2014/09/10 PKD/SAZ Check if PO was sent via EDI for SYSCO.  If ye
      *                    Create an 855; otherwise don't do it.
      * E003964 SLM  02/24/2015 logic for SYSCO & DSYSCO Work the same
      * CASE:
      *  - c1 OR c2
      *   |- c1    : LCL.EDI Trading Partner No. is SYSCO Dailys
      *   |- c2    : LCL.EDI Trading Partner No. is SYSCO Foods
      *   '-
     C           YL0021    IFEQ @CN,011                    *IF
     C           YL0021    OREQ 'SYSCO'                    *OR
      * VAL PO Exists         RT - EDI Purchase Order Header  * 
     C                     EXSR SMRVGN
      * VAL: Return Code
      * CASE: LCL.Record Found USR is Record Not Found
     C           YL0025    IFEQ 'N'                        *IF
     C                     MOVEL'N'       YL0016           EDI Process Fla
     C                     MOVEL'TP'      YL0015           Trans Type 1 PA
     C                     END                             *FI
     C                     END                             *FI
      *  7/13/2021 JBB SDD657 - Trading Partner Control
      * Rtv EDI Manual PO Sts XF - EDI Bill To Interchange  * POACK
     C                     CALL 'PUTBXFR'              90  Rtv EDI Manual
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0108  30       Company Number
     C                     PARM #1C4NB    WQ0109  70       Order Number
     C                     PARM 'POACK'   WQ0110  6        Interchange Cod
     C           YL0026    PARM *BLANK    WQ0111  1        Send EDI Docume
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUTBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * If Send EDI Invoice = N, set EDI Process Flag = N
      * CASE: LCL.Send EDI Document Y/N is No
     C           YL0026    IFEQ 'N'                        *IF
     C                     MOVEL'N'       YL0016           EDI Process Fla
     C                     END                             *FI
      * CASE: LCL.EDI Process Flag is Process
     C           YL0016    IFEQ 'Y'                        *IF
      * 2014/09/09 PKD Added Price Audit condition
      * Do we need to EDI 855/865?
      * CASE:
      *  - c1 ORc2ORc3ORc4
      *   |- c1    : PAR.Pricing Event Called From is Market Price Change
      *   |- c2    : PAR.Pricing Event Called From is Order Entry
      *   |- c3    : PAR.Pricing Event Called From is Price Maintenance
      *   |- c4    : PAR.Pricing Event Called From is Price Audit
      *   '-
     C           'PA'      IFEQ 'MPC'                      *IF
     C           'PA'      OREQ 'OE'                       *OR
     C           'PA'      OREQ 'PM'                       *OR
     C           'PA'      OREQ 'PA'                       *OR
      * CASE: LCL.Price Status is Priced
     C           YL0019    IFEQ 'P'                        *IF
      * Rtv/Crt EDI PO Ack    XF - EDI PO Ack Hdr  * 
     C                     CALL 'PNYLXFR'              90  Rtv/Crt EDI PO
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0112  30       Company Number
     C                     PARM #1C4NB    WQ0113  70       Order Number
     C           YL0015    PARM YL0015    WQ0114  2        Trans Type 1 PA
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNYLXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'OP'      YL0015           Trans Type 1 PA
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
      * SFLNXTCHG
     C                     SETON                     84
     C                     ELSE
      * SFLRCD valid
      * SFLNXTCHG
     C                     SETOF                     84
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C                     MOVEL'0'       *IN79
     C           P1I6ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BFCPOA fields to subfile
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     MOVELBEBRTX    #1BRTX           Ship To Name
     C                     MOVELBEHMNA    #1HMNA           Ship To Address
     C                     MOVELBEHONA    #1HONA           Ship To Address
     C                     MOVELBEHPNA    #1HPNA           Ship To Address
     C                     MOVELBEHNNA    #1HNNA           Ship To City
     C                     MOVELBEDBCD    #1DBCD           Ship To State C
     C                     MOVELBECKTX    #1CKTX           Ship To Zip/Pos
     C                     MOVELBEB1NA    #1B1NA           Bill to Address
     C                     MOVELBEB3NA    #1B3NA           Bill to Address
     C                     MOVELBEB4NA    #1B4NA           Bill to Address
     C                     MOVELBEB2NA    #1B2NA           Bill to City
     C                     MOVELBEBHCD    #1BHCD           Bill to State C
     C                     MOVELBEC8TX    #1C8TX           Bill to Zip/Pos
     C                     Z-ADDBEA0DT    #1A0DT           Order Date
     C                     Z-ADDBEA5DT    #1A5DT           Requested Ship
     C                     Z-ADDBEGNDT    #1GNDT           Actual Shipped
     C                     Z-ADDBEACDT    #1ACDT           Cancel Date
     C                     MOVELBEAQCD    #1AQCD           Terms Code
     C                     MOVELBEB6NA    #1B6NA           Special Instruc
     C                     MOVELBEBYNA    #1BYNA           Special Instruc
     C                     MOVELBEBZNA    #1BZNA           Carrier Code
     C                     MOVELBEGTST    #1GTST           Comment Print A
     C                     MOVELBEGVST    #1GVST           Comment Print I
     C                     MOVELBEGUST    #1GUST           Comment Print P
     C                     MOVELBEQFST    #1QFST           Comment Print S
     C                     MOVELBECQCD    #1CQCD           Reason Code
     C                     MOVELBEGJST    #1GJST           Order in Use
     C                     MOVELBEGWST    #1GWST           Header Status
     C                     MOVELBEGXST    #1GXST           Header Status L
     C                     MOVELBEGYST    #1GYST           Order Type Prin
     C                     Z-ADDBEAODT    #1AODT           Scheduled Ship
     C                     MOVELBEAIVN    #1AIVN           User Original E
     C                     Z-ADDBECXDT    #1CXDT           Date of Origina
     C                     Z-ADDBEJZVA    #1JZVA           Order Value Tot
     C                     Z-ADDBEA1WG    #1A1WG           Order Weight To
     C                     MOVELBEXIST    #1XIST           Credit Hold
     C                     MOVELBEXJST    #1XJST           Production Hold
     C                     MOVELBEXKST    #1XKST           New Customer Ho
     C                     Z-ADDBEEIDT    #1EIDT           Requested Deliv
     C                     Z-ADDBEAFTM    #1AFTM           Requested Deliv
     C                     MOVELBEE8CD    #1E8CD           Accounts Receiv
     C                     MOVELBEE9CD    #1E9CD           Accounts Receiv
     C                     Z-ADDBERMNB    #1RMNB           Load ID
     C                     Z-ADDBETBNB    #1TBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    #1R1NB           Rated Freight
     C                     MOVELBEPJST    #1PJST           LTL Flag
     C                     MOVELBEU0ST    #1U0ST           Price Audit
     C                     MOVELBEU1ST    #1U1ST           Price Status
     C                     MOVELBEQ2CD    #1Q2CD           Shipping Method
     C                     MOVELBEU2ST    #1U2ST           Export Status
     C                     MOVELBEVEST    #1VEST           Palletize
     C                     MOVELBEVFST    #1VFST           Shrink Wrap
     C                     MOVELBEVGST    #1VGST           Slip Sheet
     C                     MOVELBERPCD    #1RPCD           Age Code
     C                     Z-ADDBERNNB    #1RNNB           Reefer Temperat
     C                     MOVELBEVDST    #1VDST           Load Type
     C                     Z-ADDBEATIN    #1ATIN           Attach to Invoi
     C                     MOVELBEU4ST    #1U4ST           Load Plan Order
     C                     MOVELBEU5ST    #1U5ST           Print Pick Slip
     C                     Z-ADDBERSRN    #1RSRN           Resell Referenc
     C                     MOVELBEMHNA    #1MHNA           Special Comment
     C                     MOVELBEMINA    #1MINA           Special Comment
     C                     MOVELBEWBST    #1WBST           Affect Auto Acc
     C                     MOVELBER4CD    #1R4CD           Sales Route Cod
     C                     MOVELBEBFCD    #1BFCD           Manager Level C
     C                     MOVELBEQ4CD    #1Q4CD           VP Level Code
     C                     Z-ADDBET3NB    #1T3NB           Attach to Order
     C                     MOVELBESICD    #1SICD           Reason for Pric
     C                     MOVELBECEST    #1CEST           Invoice Suffix
     C                     MOVELBEJPCD    #1JPCD           Event Code
     C                     MOVELBEXUST    #1XUST           Trans Contol AS
     C                     MOVELBEZ1ST    #1Z1ST           Modified Flag
     C                     Z-ADDBEVRVA    #1VRVA           A/R order Value
     C                     MOVELBEOBST    #1OBST           Billing Activit
     C                     MOVELBEBCST    #1BCST           Block Order Fla
     C                     MOVELBEBDST    #1BDST           Order Certifica
     C                     Z-ADDBEB7VL    #1B7VL           Invoice Order V
     C                     MOVELBEGASX    #1GASX           Process Sts for
     C                     MOVELBEGBSX    #1GBSX           Order Conf Fax
     C                     MOVELBEGCSX    #1GCSX           Manifest Fax St
     C                     MOVELBEFNSX    #1FNSX           Transfer in Sto
     C                     MOVELBEFOSX    #1FOSX           Email Cust On O
     C                     MOVELBEFPSX    #1FPSX           Order Emailed
     C                     MOVELBEFQSX    #1FQSX           Export Docs Go
     C                     MOVELBEFRSX    #1FRSX           Shipping Temp C
     C                     MOVELBEFSSX    #1FSSX           Broker Order St
     C                     MOVELBEFTSX    #1FTSX           Air Freight Ord
     C                     MOVELBEFUSX    #1FUSX           Order Requires
     C                     MOVELBEFVSX    #1FVSX           OH Load Plan Re
     C                     MOVELBEFWSX    #1FWSX           Export USDA App
     C                     MOVELBEFXSX    #1FXSX           HPB Ship to War
     C                     MOVELBEFYSX    #1FYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    #1NODT           OH Appt Confirm
     C                     Z-ADDBENPDT    #1NPDT           JPN Invoice Iss
     C                     Z-ADDBENQDT    #1NQDT           Load Actual Shi
     C                     Z-ADDBENRDT    #1NRDT           Load BOL Comple
     C                     Z-ADDBENSDT    #1NSDT           Load Truck Depa
     C                     Z-ADDBEBPTM    #1BPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    #1BQTM           Time of Origina
     C                     Z-ADDBEBRTM    #1BRTM           OH Appt Confirm
     C                     Z-ADDBEBSTM    #1BSTM           Load BOL Comple
     C                     Z-ADDBEBTTM    #1BTTM           Load Truck Depa
     C                     Z-ADDBEH0NX    #1H0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    #1H1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    #1H2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    #1H3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    #1H4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    #1C0C7           Claim Number
     C                     MOVELBEUVST    #1UVST           EDI Status 1
     C                     MOVELBEUWST    #1UWST           EDI Status 2
     C                     MOVELBEUXST    #1UXST           EDI Status 3
     C                     Z-ADDBEAATM    #1AATM           Job Time
     C                     MOVELBEAYNA    #1AYNA           User Id
     C                     MOVELBEA0NA    #1A0NA           Job Name
     C                     Z-ADDBEAXDT    #1AXDT           Job Date
     C                     Z-ADDBEANC7    #1ANC7           A/R Customer Nu
     C                     Z-ADDBEAWDT    #1AWDT           Invoice Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1AWDT
     C                     MOVELBEAETX    #1AETX           Bill to Name
     C                     Z-ADDBEB0C7    #1B0C7           Bill to Custome
      * Clear external version also
     C                     MOVEL*BLANK    V1B0C7
     C                     Z-ADDBEBKC7    #1BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V1BKC7
     C                     Z-ADDBEAIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     Z-ADDBEC4NB    #1C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V1C4NB
     C                     MOVELBEJNCD    #1JNCD           Order Type - Sa
     C                     Z-ADDBECONB    #1CONB           Invoice Number
     C                     MOVELBEBCNA    #1BCNA           Customer Purcha
     C                     MOVELBEGDSX    #1GDSX           Invoice Fax Sts
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL*BLANK    #RLTCD           EDI Invoice Sts
     C                     MOVEL*BLANK    #RRLST           Fax Invoice Fla
     C                     MOVEL*BLANK    #RVQSX           Email Selection
     C                     MOVEL*BLANK    #RMMTX           Fax Invoice Fax
     C                     MOVEL*BLANK    #ROHNA           Fax Invoice Con
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     MOVEL*BLANK    #CAPTX           Company Name
     C                     MOVEL*BLANK    #2AETX           Bill to Name
     C                     Z-ADD*ZERO     #2AWDT           Invoice Date
      * Clear external version also
     C                     Z-ADD*ZERO     V2AWDT
     C                     MOVEL*BLANK    #CUJTX           Name 25A USR
     C                     Z-ADD*ZERO     #2B0C7           Bill to Custome
      * Clear external version also
     C                     MOVEL*BLANK    V2B0C7
     C                     Z-ADD*ZERO     #2BKC7           Ship To Custome
      * Clear external version also
     C                     MOVEL*BLANK    V2BKC7
     C                     Z-ADD*ZERO     #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     Z-ADD*ZERO     #2C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V2C4NB
     C                     MOVEL*BLANK    #2JNCD           Order Type - Sa
     C                     Z-ADD*ZERO     #2CONB           Invoice Number
     C                     MOVEL*BLANK    #2BCNA           Customer Purcha
     C                     MOVEL*BLANK    #CLTCD           EDI Invoice Sts
     C                     MOVEL*BLANK    #CRLST           Fax Invoice Fla
     C                     MOVEL*BLANK    #CVQSX           Email Selection
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Invoice Date to display format
      * Convert date
     C           1000000   ADD  #1AWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1AWDT
      * Convert Bill to Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1B0C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1B0C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1B0C7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1B0C7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1BKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Invoice Date to display format
      * Convert date
     C           1000000   ADD  #2AWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2AWDT
      * Convert Bill to Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2B0C7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2B0C7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2B0C7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2B0C7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2BKC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2BKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2BKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2BKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2C4NB           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Cust Name Inv Date RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
      * Setup key
     C                     Z-ADD#2AIC3    WAAIC3           Company Number
     C                     Z-ADD#2C4NB    WAC4NB           Order Number
      * Establish starting position
     C           KRSSA     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWAAETX    #2AETX           Bill to Name
     C                     Z-ADDWAAWDT    #2AWDT           Invoice Date
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV CDE Fax-1 only    RT - Cust Distribution Entry  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0006           CDE Name
     C                     MOVEL*BLANK    YL0005           CDE Destination
      * Declare restrictor key work fields
     C           *LIKE     DEFN F7BKC7    WQSB01           Ship To Custome
     C           *LIKE     DEFN F7MNAA    WQSB02           Distribution Co
     C           *LIKE     DEFN F7IRST    WQSB03           CDE Destination
      * Define keylist
     C           KPSSB     KLIST
     C                     KFLD           WQSB01           Ship To Custome
     C                     KFLD           WQSB02           Distribution Co
     C                     KFLD           WQSB03           CDE Destination
     C                     KFLD           F7RNNY           CDE Sequence Nu
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Ship To Custome
     C                     KFLD           WQSB02           Distribution Co
     C                     KFLD           WQSB03           CDE Destination
      * Setup key
     C                     Z-ADD#1ANC7    WQSB01           Ship To Custome
     C                     MOVEL@CN,001   WQSB02           Distribution Co
     C                     MOVEL'F'       WQSB03           CDE Destination
     C                     Z-ADD*ZERO     F7RNNY           CDE Sequence Nu
      * Establish starting position
     C           KPSSB     SETLL@F7REN4                    *
     C           KRSSB     READE@F7REN4                  90*
      * Data record not found
     C   90                MOVEL'USR4289' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Return 1st active record with a fax number
      * CASE: DB1.CDE Destination Type is Fax
     C           F7IRST    IFEQ 'F'                        *IF
      * CASE: DB1.Record Status is Active
     C           F7VSST    IFEQ 'A'                        *IF
      * PAR = DB1 By name
     C                     MOVELF7WLT1    YL0006           CDE Name
     C                     MOVELF7WMT1    YL0005           CDE Destination
     C                     GOTO SBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSB     READE@F7REN4                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV CDE 1st Eml only2 RT - Cust Distribution Entry  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0006           CDE Name
     C                     MOVEL*BLANK    YL0007           CDE Destination
     C                     MOVEL*BLANK    YL0005           CDE Destination
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBBKC7    WQSC01           Ship To Custome
     C           *LIKE     DEFN WBMNAA    WQSC02           Distribution Co
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           Ship To Custome
     C                     KFLD           WQSC02           Distribution Co
     C                     KFLD           WBRNNY           CDE Sequence Nu
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Ship To Custome
     C                     KFLD           WQSC02           Distribution Co
      * Setup key
     C                     Z-ADD#1ANC7    WQSC01           Ship To Custome
     C                     MOVEL@CN,001   WQSC02           Distribution Co
     C                     Z-ADD*ZERO     WBRNNY           CDE Sequence Nu
      * Establish starting position
     C           KPSSC     SETLL@F7REFP                    *
     C           KRSSC     READE@F7REFP                  90*
      * Data record not found
     C   90                MOVEL'USR4289' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Return 1st active record with an email address
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.CDE Destination Type is Email
      *   |- c2    : DB1.CDE Destination Type is One Email/Invoice
      *   '-
     C           WBIRST    IFEQ 'E'                        *IF
     C           WBIRST    OREQ 'O'                        *OR
      * R14851 4/15/19  RMC ADDED Type = O
      * CASE: DB1.Record Status is Active
     C           WBVSST    IFEQ 'A'                        *IF
      * PAR = DB1 By name
     C                     MOVELWBWLT1    YL0006           CDE Name
     C                     MOVELWBIRST    YL0007           CDE Destination
     C                     MOVELWBWMT1    YL0005           CDE Destination
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSC     READE@F7REFP                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv EDI/Prt Invoice   RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           BBBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0001    BBBKC7           Ship To Custome
      * Establish starting position
     C           KRSSD     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           EDI Invoice Sts
     C                     MOVEL*BLANK    WL0003           Print Invoice S
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBBLTCD    WL0002           EDI Invoice Sts
     C                     MOVELBBQXST    WL0003           Print Invoice S
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV OD Whs/ShpCo/AccCo RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSE01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSE02           Order Number
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSE01           Company Number
     C                     Z-ADD#1C4NB    WQSE02           Order Number
      * Establish starting position
     C           KRSSE     SETLL@BGWKL1                    *
     C           KRSSE     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           OMGMST    IFEQ 'L'                        *IF
     C           OMGMST    OREQ 'A'
     C           OMGMST    OREQ 'C'
     C           OMGMST    OREQ 'R'
     C           OMGMST    OREQ 'E'
     C           OMGMST    OREQ 'H'
     C           OMGMST    OREQ 'I'
      * RTV OD Whs/ShpCo/AccCo RT - Warehouse  * Retrieve object
     C                     EXSR SFRVGN
     C                     MOVELOMAJCD    YN0002           Warehouse Code
     C                     GOTO SEEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSE     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV OD Whs/ShpCo/AccCo RT - Warehouse  * Retrieve object
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELOMAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSF     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0013           Accounting Comp
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDADBTC3    YL0013           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCRRC    BEGSR
      *================================================================
      * CRT PD Invoice List Wk CR - WF Invoice List Work  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @J4CPDG
     C                     MOVELWL0004    J4B2VN           Job Name CDE
     C                     Z-ADDWL0005    J4C4NB           Order Number
     C                     Z-ADDWL0006    J4JZVA           Order Value Tot
     C                     Z-ADDWL0007    J4A1WG           Order Weight To
     C                     MOVELWL0008    J4BRTX           Ship To Name
     C                     MOVELWL0009    J4AETX           Bill to Name
     C                     MOVELWL0010    J4RLST           Fax Invoice Fla
     C                     Z-ADDWL0011    J4CBC7           Ship to Custome
     C                     Z-ADDWL0012    J4BKC7           Ship To Custome
     C                     Z-ADDWL0013    J4AIC3           Company Number
     C                     Z-ADDWL0014    J4CONB           Invoice Number
     C                     MOVELWL0015    J4CEST           Invoice Suffix
      *
     C           KLCRSG    KLIST
     C                     KFLD           J4B2VN           Job Name CDE
     C                     KFLD           J4C4NB           Order Number
      * Check for duplicate primary key
     C           KLCRSG    SETLL@J4CPDG                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2069' W0RTN   7
      * USER: Processing if Data record already exists
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C                     WRITE@J4CPDG                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv One Invoice /PO   RT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           NEBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0016    NEBKC7           Ship To Custome
      * Establish starting position
     C           KRSSH     CHAIN@NEREAT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WL0017           One Invoice Per
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELNEHUSX    WL0017           One Invoice Per
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICRRC    BEGSR
      *================================================================
      * Crt WF Invoice/Combine CR - WF Invoice/Combine Drv  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       Create Date
     C                     Z-ADD*ZERO     WN0002  60       Create Time
     C                     MOVEL*BLANK    WN0003 10        Create User
     C                     MOVEL*BLANK    WN0004 10        Create Program
     C                     Z-ADD*ZERO     WN0005  70       Change Date
     C                     Z-ADD*ZERO     WN0006  60       Change Time
     C                     MOVEL*BLANK    WN0007 10        Change User
     C                     MOVEL*BLANK    WN0008 10        Change Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AFCPHT
     C                     MOVELWL0018    AFB2VN           Job Name CDE
     C                     MOVELWL0019    AFDJVN           Job Number Cde
     C                     Z-ADDWL0020    AFC4NB           Order Number
     C                     MOVELWL0021    AFAETX           Bill to Name
     C                     Z-ADDWL0022    AFJZVA           Order Value Tot
     C                     Z-ADDWL0023    AFA1WG           Order Weight To
     C                     MOVELWL0024    AFBRTX           Ship To Name
     C                     MOVELWL0025    AFRLST           Fax Invoice Fla
     C                     MOVELWL0026    AFHUSX           One Invoice Per
     C                     MOVELWL0027    AFBCNA           Customer Purcha
     C                     MOVELWL0028    AFA8TX           Combine Invoice
     C                     MOVELWL0029    AFBETX           WF Inv/Comb Bil
     C                     Z-ADDWL0030    AFGNDT           Actual Shipped
     C                     Z-ADDWL0031    AFBKC7           Ship To Custome
     C                     Z-ADDWL0032    AFEMC7           Bill to Custome
     C                     Z-ADDWL0033    AFAIC3           Company Number
     C                     Z-ADDWL0034    AFCONB           Invoice Number
     C                     MOVELWL0035    AFCEST           Invoice Suffix
     C                     MOVELWL0036    AFVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       AFVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     AFMJDT           Create Date
     C                     Z-ADD##JTM     AFBETM           Create Time
     C                     MOVEL##USR     AFCCVN           Create User
     C                     MOVEL##PGM     AFCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD*ZERO     AFMKDT           Change Date
     C                     Z-ADD*ZERO     AFBFTM           Change Time
     C                     MOVEL*BLANK    AFCEVN           Change User
     C                     MOVEL*BLANK    AFCFVN           Change Program
     C           KLCRSI    KLIST
     C                     KFLD           AFB2VN           Job Name CDE
     C                     KFLD           AFDJVN           Job Number Cde
     C                     KFLD           AFC4NB           Order Number
      * Check for duplicate primary key
     C           KLCRSI    SETLL@AFCPHT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3672' W0RTN   7
      * Send message 'WF Invoice/Combine Drv EX'
     C                     MOVEL'USR3672' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C                     WRITE@AFCPHT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Order Info ALL    RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WAAIC3           Company Number
     C                     Z-ADD#1C4NB    WAC4NB           Order Number
      * Establish starting position
     C           KRSSJ     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0017           A/R Customer Nu
     C                     MOVEL*BLANK    YL0018           Customer Purcha
     C                     MOVEL*BLANK    YL0019           Price Status
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAANC7    YL0017           A/R Customer Nu
     C                     MOVELWABCNA    YL0018           Customer Purcha
     C                     MOVELWAU1ST    YL0019           Price Status
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV BT Intrchg BT custRT - EDI Bill To Interchange  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0039           POC/POCA ??
     C                     MOVEL*BLANK    WL0040           EDI Trading Par
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           GQB0C7           Bill to Custome
     C                     KFLD           GQM4AA           Interchange Cod
      * Setup key
     C                     Z-ADDWL0037    GQB0C7           Bill to Custome
     C                     MOVELWL0038    GQM4AA           Interchange Cod
      * Establish starting position
     C           KRSSK     CHAIN@GQREH2              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4373' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0039           POC/POCA ??
     C                     MOVEL*BLANK    WL0040           EDI Trading Par
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELGQJ5NX    WL0040           EDI Trading Par
      * 01/24/23 DN W95589-Check Record Status is Active for both 855 & 8
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Interchange Code is PO Acknowledgement  855
      *   |- c2    : DB1.Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           GQM4AA    IFEQ 'POACK'                    *IF
     C           GQVSST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    WL0039           POC/POCA ??
     C                     MOVEL'POACK'   WL0039           POC/POCA ??
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Interchange Code is PO Change Ack       865
      *   |- c2    : DB1.Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           GQM4AA    IFEQ @CN,010                    *IF
     C           GQVSST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'POCACK'  WL0039           POC/POCA ??
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV EDI PO Flag       RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 3/11/14 SAZ If OHE PO ack flag = Blank, initialize to *NO
      * 3/11/14 SAZ If Record not found, initialize  OHE PO Ack Flag to *
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    AMAIC3           Company Number
     C                     Z-ADD#1C4NB    AMC4NB           Order Number
      * Establish starting position
     C           KRSSL     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0024           OHE PO ACK Flag
     C                     MOVEL*BLANK    YL0025           Record Found US
     C                     MOVEL'N'       YL0025           Record Found US
     C                     MOVEL*BLANK    YL0024           OHE PO ACK Flag
     C                     MOVEL'*NO'     YL0024           OHE PO ACK Flag
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELAMC6TX    YL0024           OHE PO ACK Flag
      * CASE: DB1.OHE PO ACK Flag is *Blank
     C           AMC6TX    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    YL0024           OHE PO ACK Flag
     C                     MOVEL'*NO'     YL0024           OHE PO ACK Flag
     C                     END                             *FI
     C                     MOVEL'Y'       YL0025           Record Found US
     C                     GOTO SLEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * VAL PO Exists         RT - EDI Purchase Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BQJ5NX    WQSM01           EDI Trading Par
     C           *LIKE     DEFN BQPONO    WQSM02           G5003-PURCHASE
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           EDI Trading Par
     C                     KFLD           WQSM02           G5003-PURCHASE
      * Setup key
     C                     MOVELYL0021    WQSM01           EDI Trading Par
     C                     MOVELYL0018    WQSM02           G5003-PURCHASE
      * Establish starting position
     C           KRSSM     SETLL@P004SK                    *
     C           KRSSM     READE@P004SK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3103' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       YL0025           Record Found US
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       YL0025           Record Found US
     C                     GOTO SMEXIT                     *QUIT
     C           KRSSM     READE@P004SK                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0009    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSN     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    P1I6ST           Allow Multi-Com
     C                     MOVELDRMPNA    P1MPNA           Default Printer
     C                     MOVELDRBCCD    P1BCCD           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0027           Company Number
     C                     MOVELDRBUVN    WN0010           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0041    DTAJVN           User Profile Na
     C                     MOVELWL0042    DTDNCD           Application Cod
      * Establish starting position
     C           KRSSO     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0043           Company Number
     C                     MOVELDTAJCD    WL0044           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSP01           Application Cod
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Application Cod
      * Setup key
     C                     MOVELP1DNCD    WQSP01           Application Cod
      * Establish starting position
     C           KRSSP     SETLL@DNRESF                    *
     C           KRSSP     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SQRVGN
     C                     END                             *FI
     C           KRSSP     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSQ01           Application Cod
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSQ01           Application Cod
      * Establish starting position
     C           KRSSQ     SETLL@DNRESF                    *
     C           KRSSQ     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSQ     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
     C           *IN25     IFEQ '0'
      * Bypass when help done
     C                     SETOF                     94    *
     C           W0OVR0    IFEQ '1'
     C           W0OVR0    OREQ '0'
     C           *IN99     ANDEQ'0'
      * If override or no error
     C                     SETON                     94    *
     C           W0RR0     IFNE *ZERO
     C           W0RR0     IFGT ##RRMX
     C                     Z-ADD##RRMX    ##SFRC
     C                     ELSE
     C                     Z-ADDW0RR0     ##SFRC
     C                     END
     C                     END
     C                     Z-ADDW0ROW0    ZZCSRW
     C                     Z-ADDW0COL0    ZZCSCL
     C                     END
     C                     END
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
     C                     SETOF                     94    *
     C                     Z-ADD0         W0RR0   40
     C                     Z-ADD0         W0ROW0  30
     C                     Z-ADD0         W0COL0  30
     C                     MOVE '2'       W0OVR0  1
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD11        ZHSTRW  40
     C                     Z-ADD22        ZHNDRW  40
     C                     Z-ADD2         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           ZHCSRW    IFEQ 010
     C           ZHCSCL    ANDEQ101
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CRLST'  YPMTFD           Fax Invoice Fla
     C                     END
      *
     C           ZHCSRW    IFEQ 010
     C           ZHCSCL    ANDEQ106
     C           @#DFMT    ANDEQ'#SFLCTL'
     C                     MOVEL'#CVQSX'  YPMTFD           Email Selection
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1AJCD           Warehouse Code
     C                     Z-ADD*ZERO     P1AIC3           Company Number
     C                     MOVEL*BLANK    P1DNCD           Application Cod
     C                     MOVEL*BLANK    P1BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P1I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P1MPNA           Default Printer
     C                     MOVEL*BLANK    P1TAST           First Time Flag
     C                     MOVEL*BLANK    P1ADTX           Name
     C                     MOVEL*BLANK    P1BXTX           System Value Al
     C                     MOVEL*BLANK    P1WVST           Access Denied (
     C                     MOVEL*BLANK    P2G3TX           PRT Description
     C                     MOVEL*BLANK    P2WRST           PRT Printer Dev
     C                     MOVEL*BLANK    P2WSST           PRT Hold Output
     C                     MOVEL*BLANK    P2WTST           PRT Save Output
     C                     Z-ADD*ZERO     P2DYNB           PRT Number of C
     C                     MOVEL*BLANK    P2WUST           PRT Night Queue
     C                     MOVEL*BLANK    P2BVVN           PRT Night Queue
     C                     Z-ADD*ZERO     P2AJAA           Company Number
     C                     Z-ADD*ZERO     P2AJNC           Customer Number
     C                     Z-ADD*ZERO     P2AJAF           Order Number 2
     C                     Z-ADD*ZERO     P2M8NB           System Value Nu
     C                     MOVEL*BLANK    P2B8ST           Status - Y or N
     C                     MOVEL*BLANK    P3B7VN           PRT Night Queue
     C                     MOVEL*BLANK    P4B2VN           Job Name CDE
     C                     MOVEL*BLANK    P5               Use Credit Cont
     C                     MOVEL*BLANK    P6LGTX           Cover Sheet Nam
     C                     MOVEL*BLANK    P7HAAA           Job Number USR
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WAA0DT           Order Date
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WAACDT           Cancel Date
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WAJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WAA1WG           Order Weight To
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WAATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WARSRN           Resell Referenc
     C                     Z-ADD*ZERO     WAT3NB           Attach to Order
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WAAWDT           Invoice Date
     C                     Z-ADD*ZERO     WAVRVA           A/R order Value
     C                     Z-ADD*ZERO     WAB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WANODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WANPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WANQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WANRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WANSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WABPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WABQTM           Time of Origina
     C                     Z-ADD*ZERO     WABRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WABSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WABTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WAH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WAH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WAH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WAH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WAH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Blank for 30          USR
     C                     MOVEL*BLANK    WUW4TX 30
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field USR Qclscan Result ?
     C                     Z-ADD*ZERO     WUY8NB  30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBRNNY           CDE Sequence Nu
     C                     Z-ADD*ZERO     WBMJDT           Create Date
     C                     Z-ADD*ZERO     WBBETM           Create Time
     C                     Z-ADD*ZERO     WBMKDT           Change Date
     C                     Z-ADD*ZERO     WBBFTM           Change Time
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Order Number 2  PASS  USR
     C                     Z-ADD*ZERO     WUAJAF 155
      * Define work field Order Sequence Number
     C                     Z-ADD*ZERO     WUDPNB  30
      * Define work field Order Secondary Line Seq
     C                     Z-ADD*ZERO     WUUENB  30
      * Define work field Fax Invoice Flag
     C                     MOVEL*BLANK    WURLST  1
      * Clear all neither parameters
      * Crt WF Invoice/Combine CR - WF Invoice/Combine Drv  * 
     C                     Z-ADD*ZERO     AFMJDT           Create Date
     C                     Z-ADD*ZERO     AFBETM           Create Time
     C                     Z-ADD*ZERO     AFMKDT           Change Date
     C                     Z-ADD*ZERO     AFBFTM           Change Time
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Initialize *SET CURSOR data
     C                     MOVE 'Y'       YSETCS  1
     C                     EXSR Y9CLR
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0001  70
     C                     MOVEL*BLANK    WL0002  1
     C                     MOVEL*BLANK    WL0003  1
      * Define local variables for subroutine SGCRRC.
     C                     MOVEL*BLANK    WL0004 10
     C                     Z-ADD*ZERO     WL0005  70
     C                     Z-ADD*ZERO     WL0006 112
     C                     Z-ADD*ZERO     WL0007 112
     C                     MOVEL*BLANK    WL0008 30
     C                     MOVEL*BLANK    WL0009 30
     C                     MOVEL*BLANK    WL0010  1
     C                     Z-ADD*ZERO     WL0011  70
     C                     Z-ADD*ZERO     WL0012  70
     C                     Z-ADD*ZERO     WL0013  30
     C                     Z-ADD*ZERO     WL0014  70
     C                     MOVEL*BLANK    WL0015  2
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0016  70
     C                     MOVEL*BLANK    WL0017  1
      * Define local variables for subroutine SICRRC.
     C                     MOVEL*BLANK    WL0018 10
     C                     MOVEL*BLANK    WL0019 10
     C                     Z-ADD*ZERO     WL0020  70
     C                     MOVEL*BLANK    WL0021 30
     C                     Z-ADD*ZERO     WL0022 112
     C                     Z-ADD*ZERO     WL0023 112
     C                     MOVEL*BLANK    WL0024 30
     C                     MOVEL*BLANK    WL0025  1
     C                     MOVEL*BLANK    WL0026  1
     C                     MOVEL*BLANK    WL0027 15
     C                     MOVEL*BLANK    WL0028  1
     C                     MOVEL*BLANK    WL0029  1
     C                     Z-ADD*ZERO     WL0030  70
     C                     Z-ADD*ZERO     WL0031  70
     C                     Z-ADD*ZERO     WL0032  70
     C                     Z-ADD*ZERO     WL0033  30
     C                     Z-ADD*ZERO     WL0034  70
     C                     MOVEL*BLANK    WL0035  2
     C                     MOVEL*BLANK    WL0036  1
      * Define local variables for subroutine SKRVGN.
     C                     Z-ADD*ZERO     WL0037  70
     C                     MOVEL*BLANK    WL0038  6
     C                     MOVEL*BLANK    WL0039  6
     C                     MOVEL*BLANK    WL0040  6
      * Define local variables for subroutine SORVGN.
     C                     MOVEL*BLANK    WL0041 10
     C                     MOVEL*BLANK    WL0042  6
     C                     Z-ADD*ZERO     WL0043  30
     C                     MOVEL*BLANK    WL0044  3
      * Define local work field Name 25A USR
     C                     MOVEL*BLANK    YL0001 25
      * Define local work field EDI Invoice Sts
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Email Selection usr
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Fax Invoice Flag
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field CDE Destination
     C                     MOVEL*BLANK    YL0005 50
      * Define local work field CDE Name
     C                     MOVEL*BLANK    YL0006 30
      * Define local work field CDE Destination Type
     C                     MOVEL*BLANK    YL0007  1
      * Define null work field Print Invoice Sts
     C                     MOVEL*BLANK    YN0001  1
      * Define local work field Reprint Status USR
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field A/R Customer Num Pass USR
     C                     Z-ADD*ZERO     YL0009 155
      * Define local work field Program name USR
     C                     MOVEL*BLANK    YL0010 10
      * Define local work field Print Invoice Sts
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field Send EDI Document Y/N
     C                     MOVEL*BLANK    YL0012  1
      * Define null work field Warehouse Code
     C                     MOVEL*BLANK    YN0002  3
      * Define null work field Shipping Company
     C                     Z-ADD*ZERO     YN0003  30
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0013  30
      * Define local work field One Invoice Per PO
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field Trans Type 1 PASS     USR
     C                     MOVEL*BLANK    YL0015  2
      * Define local work field EDI Process Flag
     C                     MOVEL*BLANK    YL0016  1
      * Define null work field Order Type - Sales
     C                     MOVEL*BLANK    YN0004  2
      * Define local work field A/R Customer Number
     C                     Z-ADD*ZERO     YL0017  70
      * Define null work field Ship To Customer
     C                     Z-ADD*ZERO     YN0005  70
      * Define null work field Ship To Name
     C                     MOVEL*BLANK    YN0006 30
      * Define null work field Ship To Address Line 1
     C                     MOVEL*BLANK    YN0007 30
      * Define null work field Ship To Address Line 2
     C                     MOVEL*BLANK    YN0008 30
      * Define null work field Ship To Address Line 3
     C                     MOVEL*BLANK    YN0009 30
      * Define null work field Ship To City
     C                     MOVEL*BLANK    YN0010 20
      * Define null work field Ship To State Code
     C                     MOVEL*BLANK    YN0011  2
      * Define null work field Ship To Zip/Postal Code
     C                     MOVEL*BLANK    YN0012 11
      * Define null work field Bill to Customer
     C                     Z-ADD*ZERO     YN0013  70
      * Define null work field Bill to Name
     C                     MOVEL*BLANK    YN0014 30
      * Define null work field Bill to Address Line 1
     C                     MOVEL*BLANK    YN0015 30
      * Define null work field Bill to Address Line 2
     C                     MOVEL*BLANK    YN0016 30
      * Define null work field Bill to Address Line 3
     C                     MOVEL*BLANK    YN0017 30
      * Define null work field Bill to City
     C                     MOVEL*BLANK    YN0018 20
      * Define null work field Bill to State Code
     C                     MOVEL*BLANK    YN0019  2
      * Define null work field Bill to Zip/Postal Code
     C                     MOVEL*BLANK    YN0020 11
      * Define local work field Customer Purchase Order #
     C                     MOVEL*BLANK    YL0018 15
      * Define null work field Order Date
     C                     Z-ADD*ZERO     YN0021  70
      * Define null work field Requested Ship Date
     C                     Z-ADD*ZERO     YN0022  70
      * Define null work field Actual Shipped Date
     C                     Z-ADD*ZERO     YN0023  70
      * Define null work field Cancel Date
     C                     Z-ADD*ZERO     YN0024  70
      * Define null work field Terms Code
     C                     MOVEL*BLANK    YN0025  2
      * Define null work field Special Instructions
     C                     MOVEL*BLANK    YN0026 40
      * Define null work field Special Instructions 2
     C                     MOVEL*BLANK    YN0027 40
      * Define null work field Carrier Code
     C                     MOVEL*BLANK    YN0028  3
      * Define null work field Comment Print Acknowledge
     C                     MOVEL*BLANK    YN0029  1
      * Define null work field Comment Print Inv/Cr.Memo
     C                     MOVEL*BLANK    YN0030  1
      * Define null work field Comment Print Pick Slip
     C                     MOVEL*BLANK    YN0031  1
      * Define null work field Comment Print Ship Doc
     C                     MOVEL*BLANK    YN0032  1
      * Define null work field Reason Code
     C                     MOVEL*BLANK    YN0033  3
      * Define null work field Order in Use
     C                     MOVEL*BLANK    YN0034  1
      * Define null work field Header Status
     C                     MOVEL*BLANK    YN0035  1
      * Define null work field Header Status Last
     C                     MOVEL*BLANK    YN0036  1
      * Define null work field Order Type Print Status
     C                     MOVEL*BLANK    YN0037  1
      * Define null work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YN0038  70
      * Define null work field User Original Entry
     C                     MOVEL*BLANK    YN0039 10
      * Define null work field Date of Original Entry
     C                     Z-ADD*ZERO     YN0040  70
      * Define null work field Order Value Total
     C                     Z-ADD*ZERO     YN0041 112
      * Define null work field Order Weight Total
     C                     Z-ADD*ZERO     YN0042 112
      * Define null work field Credit Hold
     C                     MOVEL*BLANK    YN0043  1
      * Define null work field Production Hold
     C                     MOVEL*BLANK    YN0044  1
      * Define null work field New Customer Hold
     C                     MOVEL*BLANK    YN0045  1
      * Define null work field Requested Delivery Date
     C                     Z-ADD*ZERO     YN0046  70
      * Define null work field Requested Delivery Time
     C                     Z-ADD*ZERO     YN0047  40
      * Define null work field Accounts Receiv. Ent 1
     C                     MOVEL*BLANK    YN0048  4
      * Define null work field Accounts Receiv. Ent 2
     C                     MOVEL*BLANK    YN0049 12
      * Define null work field Load ID
     C                     Z-ADD*ZERO     YN0050  70
      * Define null work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YN0051  52
      * Define null work field Rated Freight
     C                     Z-ADD*ZERO     YN0052 112
      * Define null work field LTL Flag
     C                     MOVEL*BLANK    YN0053  1
      * Define null work field Price Audit
     C                     MOVEL*BLANK    YN0054  1
      * Define local work field Price Status
     C                     MOVEL*BLANK    YL0019  1
      * Define null work field Shipping Method
     C                     MOVEL*BLANK    YN0055  2
      * Define null work field Export Status
     C                     MOVEL*BLANK    YN0056  1
      * Define null work field Palletize
     C                     MOVEL*BLANK    YN0057  1
      * Define null work field Shrink Wrap
     C                     MOVEL*BLANK    YN0058  1
      * Define null work field Slip Sheet
     C                     MOVEL*BLANK    YN0059  1
      * Define null work field Age Code
     C                     MOVEL*BLANK    YN0060  1
      * Define null work field Reefer Temperature
     C                     Z-ADD*ZERO     YN0061  52
      * Define null work field Load Type
     C                     MOVEL*BLANK    YN0062  1
      * Define null work field Attach to Invoice Number
     C                     Z-ADD*ZERO     YN0063  70
      * Define null work field Load Plan Order
     C                     MOVEL*BLANK    YN0064  1
      * Define null work field Print Pick Slip
     C                     MOVEL*BLANK    YN0065  1
      * Define null work field Resell Reference Number
     C                     Z-ADD*ZERO     YN0066  70
      * Define null work field Special Comment 1
     C                     MOVEL*BLANK    YN0067 30
      * Define null work field Special Comment 2
     C                     MOVEL*BLANK    YN0068 30
      * Define null work field Affect Auto Accruals
     C                     MOVEL*BLANK    YN0069  1
      * Define null work field Sales Route Code
     C                     MOVEL*BLANK    YN0070  3
      * Define null work field Manager Level Code
     C                     MOVEL*BLANK    YN0071  2
      * Define null work field VP Level Code
     C                     MOVEL*BLANK    YN0072  3
      * Define null work field Attach to Order Number
     C                     Z-ADD*ZERO     YN0073  70
      * Define null work field Reason for Price Audit
     C                     MOVEL*BLANK    YN0074  3
      * Define null work field Invoice Number
     C                     Z-ADD*ZERO     YN0075  70
      * Define null work field Invoice Suffix
     C                     MOVEL*BLANK    YN0076  2
      * Define null work field Invoice Date
     C                     Z-ADD*ZERO     YN0077  70
      * Define null work field Event Code
     C                     MOVEL*BLANK    YN0078  2
      * Define null work field Trans Contol AS400_Plant
     C                     MOVEL*BLANK    YN0079  1
      * Define null work field Modified Flag
     C                     MOVEL*BLANK    YN0080  1
      * Define null work field A/R order Value Total
     C                     Z-ADD*ZERO     YN0081 112
      * Define null work field Billing Activity Type
     C                     MOVEL*BLANK    YN0082  1
      * Define null work field Block Order Flag
     C                     MOVEL*BLANK    YN0083  1
      * Define null work field Order Certification Flag
     C                     MOVEL*BLANK    YN0084  1
      * Define null work field Invoice Order Value Tot
     C                     Z-ADD*ZERO     YN0085 112
      * Define null work field Process Sts for 3C
     C                     MOVEL*BLANK    YN0086  1
      * Define null work field Order Conf Fax Sts
     C                     MOVEL*BLANK    YN0087  1
      * Define null work field Manifest Fax Sts
     C                     MOVEL*BLANK    YN0088  1
      * Define null work field Invoice Fax Sts
     C                     MOVEL*BLANK    YN0089  1
      * Define null work field Transfer in Storage Ind
     C                     MOVEL*BLANK    YN0090  1
      * Define null work field Email Cust On Order Ship
     C                     MOVEL*BLANK    YN0091  1
      * Define null work field Order Emailed
     C                     MOVEL*BLANK    YN0092  1
      * Define null work field Export Docs Go w/Driver
     C                     MOVEL*BLANK    YN0093  1
      * Define null work field Shipping Temp Code C/F
     C                     MOVEL*BLANK    YN0094  1
      * Define null work field Broker Order Status
     C                     MOVEL*BLANK    YN0095  1
      * Define null work field Air Freight Order
     C                     MOVEL*BLANK    YN0096  1
      * Define null work field Order Requires Review
     C                     MOVEL*BLANK    YN0097  2
      * Define null work field OH Load Plan Ready
     C                     MOVEL*BLANK    YN0098  2
      * Define null work field Export USDA Approved
     C                     MOVEL*BLANK    YN0099  2
      * Define null work field HPB Ship to Warehouse
     C                     MOVEL*BLANK    YN0100  3
      * Define null work field OH TF Exempt Code
     C                     MOVEL*BLANK    YN0101  3
      * Define null work field OH Appt Confirmation Dt
     C                     Z-ADD*ZERO     YN0102  70
      * Define null work field JPN Invoice Issuance Date
     C                     Z-ADD*ZERO     YN0103  70
      * Define null work field Load Actual Shipped Date
     C                     Z-ADD*ZERO     YN0104  70
      * Define null work field Load BOL Complete Date
     C                     Z-ADD*ZERO     YN0105  70
      * Define null work field Load Truck Departure Date
     C                     Z-ADD*ZERO     YN0106  70
      * Define null work field Maximum Gross Weight
     C                     Z-ADD*ZERO     YN0107  60
      * Define null work field Time of Original Entry
     C                     Z-ADD*ZERO     YN0108  60
      * Define null work field OH Appt Confirmation Tm
     C                     Z-ADD*ZERO     YN0109  60
      * Define null work field Load BOL Complete Time
     C                     Z-ADD*ZERO     YN0110  60
      * Define null work field Load Truck Departure Time
     C                     Z-ADD*ZERO     YN0111  60
      * Define null work field Act Frt Reference Amount
     C                     Z-ADD*ZERO     YN0112 112
      * Define null work field Act Non-Ref Frt Amount
     C                     Z-ADD*ZERO     YN0113 112
      * Define null work field OH Fuel Surcharge Amount
     C                     Z-ADD*ZERO     YN0114 112
      * Define null work field OH Total Non-Ref Frt Amt
     C                     Z-ADD*ZERO     YN0115 112
      * Define null work field OH Total Ref Frt Amt
     C                     Z-ADD*ZERO     YN0116 112
      * Define null work field Claim Number
     C                     Z-ADD*ZERO     YN0117  70
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0118  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0119  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0120  1
      * Define null work field Job Time
     C                     Z-ADD*ZERO     YN0121  60
      * Define null work field User Id
     C                     MOVEL*BLANK    YN0122 10
      * Define null work field Job Name
     C                     MOVEL*BLANK    YN0123 10
      * Define null work field Job Date
     C                     Z-ADD*ZERO     YN0124  70
      * Define local work field POC/POCA ??
     C                     MOVEL*BLANK    YL0020  6
      * Define local work field EDI Trading Partner No.
     C                     MOVEL*BLANK    YL0021  6
      * Define local work field EDI POA
     C                     MOVEL*BLANK    YL0022  1
      * Define local work field EDI POAC
     C                     MOVEL*BLANK    YL0023  1
      * Define local work field OHE PO ACK Flag
     C                     MOVEL*BLANK    YL0024  4
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0025  1
      * Define local work field Send EDI Document Y/N
     C                     MOVEL*BLANK    YL0026  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0027  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0028  3
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD06        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
     C                     MOVEL*BLANK    P1DNCD           Application Cod
     C                     MOVEL'A/R'     P1DNCD           Application Cod
      *
     C                     MOVEL*BLANK    WN0009 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0009           User Profile Na
      *
     C                     MOVEL*BLANK    WN0010 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SNRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,012                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0009    ZA0003           User Profile Na
     C                     MOVELP1DNCD    ZA0004           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0010    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0009    WL0041    P      User Profile Na
     C                     MOVELP1DNCD    WL0042    P      Application Cod
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0043    P1AIC3           Company Number
     C                     MOVELWL0044    YL0028    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0010    WL0041    P      User Profile Na
     C                     MOVELP1DNCD    WL0042    P      Application Cod
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0043    P1AIC3           Company Number
     C                     MOVELWL0044    YL0028    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0028    P1AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0009    ZA0005           User Profile Na
     C                     MOVELP1DNCD    ZA0006           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0027    IFNE 0                          *IF
     C                     Z-ADDYL0027    P1AIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0028    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P1AJCD    PARM *BLANK    WQ0115  3        Warehouse Code
     C                     PARM YL0027    WQ0116  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SPRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     Z-ADD1         P2M8NB           System Value Nu
     C                     MOVEL'Y'       P1TAST           First Time Flag
      * SFL Fold/Drop  RPG    US - /UT User Source  * 
     C                     Z-ADD12        ##SFPG
     C                     Z-ADD999999    W0SLM            *Scan limit
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** @CN
00001 AR-INVOICE
00002 USR0752
00003 PDVMPCLP
00004 Fax/Email Invoice
00005 PDR4PCLP
00006 Reprint Invoice
00007 Y2U9999
00008 NIGHTFAX
00009 Reprint Invoices
00010 POCACK
00011 DSYSCO
00012 Y2U0005
