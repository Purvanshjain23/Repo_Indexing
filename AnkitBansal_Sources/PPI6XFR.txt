     H/TITLE UPD ATS Order Allocate zz Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     W* Warning: This program does not set on the LR indicator
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 01/23/09  Time  : 13:40:44
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FCAAFREL7IF  E           K        DISK
      * RSQ : Calendar                  RSQ Co/Yr/Period/Week/Da
      *
     FPOCWCPL1IF  E           K        DISK
      * RTV : PS Prod Item Inventory    Retrieval index
      *
     FPOB5CPL3IF  E           K        DISK
      * RSQ : Order Detail Sched-Inv    Co/Itm/Whs/PDte/Ord
      *
     FPOB5CPL1IF  E           K        DISK
      * RTV : Order Detail Sched-Inv    Retrieval index
      *
     FPDKNCPL1IF  E           K        DISK
      * RTV : Order Detail Schedule     Retrieval index
      *
     FPDI8CPL1IF  E           K        DISK
      * RTV : PS Prod Item Schedule     Retrieval index
      *
     FCAAFREL6IF  E           K        DISK
      * RSQ : Calendar                  RSQ Co/Date Descending
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FPDJCCPL1IF  E           K        DISK
      * RTV : PS Prod Schedule          Retrieval index
      *
     FPDI8CPL4IF  E           K        DISK
      * RSQ : PS Prod Item Schedule     Co/Itm/Whs/PrdDte/Typ
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FCAAFREL3IF  E           K        DISK
      * RSQ : Calendar                  Co/Date               NV
      *
     FPOB5CPL0UF  E           K        DISK                      A
      * UPD : Order Detail Sched-Inv    Update index
      *
     FPDKNCPL0UF  E           K        DISK                      A
      * UPD : Order Detail Schedule     Update index
      *
     FPDI8CPL0UF  E           K        DISK                      A
      * UPD : PS Prod Item Schedule     Update index
      *
     E                    YDOW        7  1               *Days of week
     I@AFREBE
      * Calendar                  Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WAAIC3
     I              AFBCDT                          WABCDT
     I              AFCQNB                          WACQNB
     I              AFESNB                          WAESNB
     I              AFETNB                          WAETNB
     I              AFBZNB                          WABZNB
     I              AFA9ST                          WAA9ST
     I              AFEINB                          WAEINB
     I              AFC5ST                          WAC5ST
     I              AFAQNB                          WAAQNB
     I              AFCMST                          WACMST
     I              AFV9ST                          WAV9ST
     I              AFWAST                          WAWAST
     I              AFX2ST                          WAX2ST
     I              AFOJDT                          WAOJDT
     I              AFNQNX                          WANQNX
     I              AFNRNX                          WANRNX
     I              AFI9SX                          WAI9SX
     I              AFJASX                          WAJASX
     I              AFOKDT                          WAOKDT
     I              AFOLDT                          WAOLDT
     I              AFUVST                          WAUVST
     I              AFUWST                          WAUWST
     I              AFUXST                          WAUXST
     I              AFAATM                          WAAATM
     I              AFAYNA                          WAAYNA
     I              AFA0NA                          WAA0NA
     I              AFAXDT                          WAAXDT
      *
     I@AFREQ0
      * Calendar                  RSQ Co/Yr/Period/Week/Da
      * Renamed input format fields
     I              AFAIC3                          WBAIC3
     I              AFBCDT                          WBBCDT
     I              AFCQNB                          WBCQNB
     I              AFESNB                          WBESNB
     I              AFETNB                          WBETNB
     I              AFBZNB                          WBBZNB
     I              AFA9ST                          WBA9ST
     I              AFEINB                          WBEINB
     I              AFC5ST                          WBC5ST
     I              AFAQNB                          WBAQNB
     I              AFCMST                          WBCMST
     I              AFV9ST                          WBV9ST
     I              AFWAST                          WBWAST
     I              AFX2ST                          WBX2ST
     I              AFOJDT                          WBOJDT
     I              AFNQNX                          WBNQNX
     I              AFNRNX                          WBNRNX
     I              AFI9SX                          WBI9SX
     I              AFJASX                          WBJASX
     I              AFOKDT                          WBOKDT
     I              AFOLDT                          WBOLDT
     I              AFUVST                          WBUVST
     I              AFUWST                          WBUWST
     I              AFUXST                          WBUXST
     I              AFAATM                          WBAATM
     I              AFAYNA                          WBAYNA
     I              AFA0NA                          WBA0NA
     I              AFAXDT                          WBAXDT
      *
     I@CWCPQW
      * PS Prod Item Inventory    Retrieval index
      * Renamed input format fields
     I              CWAIC3                          WCAIC3
     I              CWHGCD                          WCHGCD
     I              CWAJCD                          WCAJCD
     I              CWELDT                          WCELDT
     I              CWACWG                          WCACWG
     I              CWARQT                          WCARQT
     I              CWK7DT                          WCK7DT
     I              CWUVST                          WCUVST
     I              CWUWST                          WCUWST
     I              CWUXST                          WCUXST
     I              CWVSST                          WCVSST
     I              CWAATM                          WCAATM
     I              CWAYNA                          WCAYNA
     I              CWA0NA                          WCA0NA
     I              CWAXDT                          WCAXDT
      *
     I@B5CPM4
      * Order Detail Sched-Inv    Co/Itm/Whs/PDte/Ord
      * Renamed input format fields
     I              B5AIC3                          WDAIC3
     I              B5C4NB                          WDC4NB
     I              B5DPNB                          WDDPNB
     I              B5UENB                          WDUENB
     I              B5JGDT                          WDJGDT
     I              B5AODT                          WDAODT
     I              B5AJCD                          WDAJCD
     I              B5HGCD                          WDHGCD
     I              B5IUQT                          WDIUQT
     I              B5F3WG                          WDF3WG
     I              B5UVST                          WDUVST
     I              B5UWST                          WDUWST
     I              B5UXST                          WDUXST
     I              B5VSST                          WDVSST
     I              B5AATM                          WDAATM
     I              B5AYNA                          WDAYNA
     I              B5A0NA                          WDA0NA
     I              B5AXDT                          WDAXDT
      *
     I@B5CPM2
      * Order Detail Sched-Inv    Retrieval index
      * Renamed input format fields
     I              B5AIC3                          WEAIC3
     I              B5C4NB                          WEC4NB
     I              B5DPNB                          WEDPNB
     I              B5UENB                          WEUENB
     I              B5JGDT                          WEJGDT
     I              B5AODT                          WEAODT
     I              B5AJCD                          WEAJCD
     I              B5HGCD                          WEHGCD
     I              B5IUQT                          WEIUQT
     I              B5F3WG                          WEF3WG
     I              B5UVST                          WEUVST
     I              B5UWST                          WEUWST
     I              B5UXST                          WEUXST
     I              B5VSST                          WEVSST
     I              B5AATM                          WEAATM
     I              B5AYNA                          WEAYNA
     I              B5A0NA                          WEA0NA
     I              B5AXDT                          WEAXDT
      *
     I@B5CPM1
      * Order Detail Sched-Inv    Update index
      * Renamed input format fields
     I              B5AIC3                          WFAIC3
     I              B5C4NB                          WFC4NB
     I              B5DPNB                          WFDPNB
     I              B5UENB                          WFUENB
     I              B5JGDT                          WFJGDT
     I              B5AODT                          WFAODT
     I              B5AJCD                          WFAJCD
     I              B5HGCD                          WFHGCD
     I              B5IUQT                          WFIUQT
     I              B5F3WG                          WFF3WG
     I              B5UVST                          WFUVST
     I              B5UWST                          WFUWST
     I              B5UXST                          WFUXST
     I              B5VSST                          WFVSST
     I              B5AATM                          WFAATM
     I              B5AYNA                          WFAYNA
     I              B5A0NA                          WFA0NA
     I              B5AXDT                          WFAXDT
      *
     I@KNCPHO
      * Order Detail Schedule     Retrieval index
      * Renamed input format fields
     I              KNAIC3                          WGAIC3
     I              KNC4NB                          WGC4NB
     I              KNDPNB                          WGDPNB
     I              KNUENB                          WGUENB
     I              KNJGDT                          WGJGDT
     I              KNAODT                          WGAODT
     I              KNAJCD                          WGAJCD
     I              KNAYAA                          WGAYAA
     I              KNHGCD                          WGHGCD
     I              KNIGQT                          WGIGQT
     I              KNFLWG                          WGFLWG
     I              KNIUQT                          WGIUQT
     I              KNF3WG                          WGF3WG
     I              KNIVQT                          WGIVQT
     I              KNF4WG                          WGF4WG
     I              KNP7ST                          WGP7ST
     I              KNP8ST                          WGP8ST
     I              KNQAST                          WGQAST
     I              KNUVST                          WGUVST
     I              KNUWST                          WGUWST
     I              KNUXST                          WGUXST
     I              KNVSST                          WGVSST
     I              KNAATM                          WGAATM
     I              KNAYNA                          WGAYNA
     I              KNA0NA                          WGA0NA
     I              KNAXDT                          WGAXDT
      *
     I@KNCPHN
      * Order Detail Schedule     Update index
      * Renamed input format fields
     I              KNAIC3                          WHAIC3
     I              KNC4NB                          WHC4NB
     I              KNDPNB                          WHDPNB
     I              KNUENB                          WHUENB
     I              KNJGDT                          WHJGDT
     I              KNAODT                          WHAODT
     I              KNAJCD                          WHAJCD
     I              KNAYAA                          WHAYAA
     I              KNHGCD                          WHHGCD
     I              KNIGQT                          WHIGQT
     I              KNFLWG                          WHFLWG
     I              KNIUQT                          WHIUQT
     I              KNF3WG                          WHF3WG
     I              KNIVQT                          WHIVQT
     I              KNF4WG                          WHF4WG
     I              KNP7ST                          WHP7ST
     I              KNP8ST                          WHP8ST
     I              KNQAST                          WHQAST
     I              KNUVST                          WHUVST
     I              KNUWST                          WHUWST
     I              KNUXST                          WHUXST
     I              KNVSST                          WHVSST
     I              KNAATM                          WHAATM
     I              KNAYNA                          WHAYNA
     I              KNA0NA                          WHA0NA
     I              KNAXDT                          WHAXDT
      *
     I@I8CPUS
      * PS Prod Item Schedule     Retrieval index
      * Renamed input format fields
     I              I8AIC3                          WIAIC3
     I              I8V5ST                          WIV5ST
     I              I8ELDT                          WIELDT
     I              I8HGCD                          WIHGCD
     I              I8AJCD                          WIAJCD
     I              I8GPDT                          WIGPDT
     I              I8WTSP                          WIWTSP
     I              I8QTSP                          WIQTSP
     I              I8DJPC                          WIDJPC
     I              I8F8WG                          WIF8WG
     I              I8WTIN                          WIWTIN
     I              I8D5NB                          WID5NB
     I              I8DXWG                          WIDXWG
     I              I8B2NB                          WIB2NB
     I              I8WTCN                          WIWTCN
     I              I8PSCV                          WIPSCV
     I              I8SAWT                          WISAWT
     I              I8B9NB                          WIB9NB
     I              I8D1WG                          WID1WG
     I              I8CBNB                          WICBNB
     I              I8EZWG                          WIEZWG
     I              I8CCNB                          WICCNB
     I              I8E0WG                          WIE0WG
     I              I8D6NB                          WID6NB
     I              I8OAWT                          WIOAWT
     I              I8CDNB                          WICDNB
     I              I8UNW2                          WIUNW2
     I              I8CENB                          WICENB
     I              I8F9WG                          WIF9WG
     I              I8BPNB                          WIBPNB
     I              I8GAWG                          WIGAWG
     I              I8BQNB                          WIBQNB
     I              I8GBWG                          WIGBWG
     I              I8BRNB                          WIBRNB
     I              I8GCWG                          WIGCWG
     I              I8BSNB                          WIBSNB
     I              I8GDWG                          WIGDWG
     I              I8BWNB                          WIBWNB
     I              I8GEWG                          WIGEWG
     I              I8PS6U                          WIPS6U
     I              I8WCST                          WIWCST
     I              I8WPST                          WIWPST
     I              I8B5ST                          WIB5ST
     I              I8TFST                          WITFST
     I              I8TEST                          WITEST
     I              I8THST                          WITHST
     I              I8UDST                          WIUDST
     I              I8UFST                          WIUFST
     I              I8UGST                          WIUGST
     I              I8UHST                          WIUHST
     I              I8B6ST                          WIB6ST
     I              I8B7ST                          WIB7ST
     I              I8DVWG                          WIDVWG
     I              I8D7NB                          WID7NB
     I              I8FCAD                          WIFCAD
     I              I8D9NB                          WID9NB
     I              I8DWWG                          WIDWWG
     I              I8EANB                          WIEANB
     I              I8SHWT                          WISHWT
     I              I8EBNB                          WIEBNB
     I              I8AVWT                          WIAVWT
     I              I8ECNB                          WIECNB
     I              I8WTON                          WIWTON
     I              I8EDNB                          WIEDNB
     I              I8FNWT                          WIFNWT
     I              I8EENB                          WIEENB
     I              I8QTAS                          WIQTAS
     I              I8EFNB                          WIEFNB
     I              I8WAIO                          WIWAIO
     I              I8EGNB                          WIEGNB
     I              I8R3CD                          WIR3CD
     I              I8RGNB                          WIRGNB
     I              I8RHNB                          WIRHNB
     I              I8RINB                          WIRINB
     I              I8XRCD                          WIXRCD
     I              I8UVST                          WIUVST
     I              I8UWST                          WIUWST
     I              I8UXST                          WIUXST
     I              I8VSST                          WIVSST
     I              I8AATM                          WIAATM
     I              I8AYNA                          WIAYNA
     I              I8A0NA                          WIA0NA
     I              I8AXDT                          WIAXDT
      *
     I@I8CPUR
      * PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WJAIC3
     I              I8V5ST                          WJV5ST
     I              I8ELDT                          WJELDT
     I              I8HGCD                          WJHGCD
     I              I8AJCD                          WJAJCD
     I              I8GPDT                          WJGPDT
     I              I8WTSP                          WJWTSP
     I              I8QTSP                          WJQTSP
     I              I8DJPC                          WJDJPC
     I              I8F8WG                          WJF8WG
     I              I8WTIN                          WJWTIN
     I              I8D5NB                          WJD5NB
     I              I8DXWG                          WJDXWG
     I              I8B2NB                          WJB2NB
     I              I8WTCN                          WJWTCN
     I              I8PSCV                          WJPSCV
     I              I8SAWT                          WJSAWT
     I              I8B9NB                          WJB9NB
     I              I8D1WG                          WJD1WG
     I              I8CBNB                          WJCBNB
     I              I8EZWG                          WJEZWG
     I              I8CCNB                          WJCCNB
     I              I8E0WG                          WJE0WG
     I              I8D6NB                          WJD6NB
     I              I8OAWT                          WJOAWT
     I              I8CDNB                          WJCDNB
     I              I8UNW2                          WJUNW2
     I              I8CENB                          WJCENB
     I              I8F9WG                          WJF9WG
     I              I8BPNB                          WJBPNB
     I              I8GAWG                          WJGAWG
     I              I8BQNB                          WJBQNB
     I              I8GBWG                          WJGBWG
     I              I8BRNB                          WJBRNB
     I              I8GCWG                          WJGCWG
     I              I8BSNB                          WJBSNB
     I              I8GDWG                          WJGDWG
     I              I8BWNB                          WJBWNB
     I              I8GEWG                          WJGEWG
     I              I8PS6U                          WJPS6U
     I              I8WCST                          WJWCST
     I              I8WPST                          WJWPST
     I              I8B5ST                          WJB5ST
     I              I8TFST                          WJTFST
     I              I8TEST                          WJTEST
     I              I8THST                          WJTHST
     I              I8UDST                          WJUDST
     I              I8UFST                          WJUFST
     I              I8UGST                          WJUGST
     I              I8UHST                          WJUHST
     I              I8B6ST                          WJB6ST
     I              I8B7ST                          WJB7ST
     I              I8DVWG                          WJDVWG
     I              I8D7NB                          WJD7NB
     I              I8FCAD                          WJFCAD
     I              I8D9NB                          WJD9NB
     I              I8DWWG                          WJDWWG
     I              I8EANB                          WJEANB
     I              I8SHWT                          WJSHWT
     I              I8EBNB                          WJEBNB
     I              I8AVWT                          WJAVWT
     I              I8ECNB                          WJECNB
     I              I8WTON                          WJWTON
     I              I8EDNB                          WJEDNB
     I              I8FNWT                          WJFNWT
     I              I8EENB                          WJEENB
     I              I8QTAS                          WJQTAS
     I              I8EFNB                          WJEFNB
     I              I8WAIO                          WJWAIO
     I              I8EGNB                          WJEGNB
     I              I8R3CD                          WJR3CD
     I              I8RGNB                          WJRGNB
     I              I8RHNB                          WJRHNB
     I              I8RINB                          WJRINB
     I              I8XRCD                          WJXRCD
     I              I8UVST                          WJUVST
     I              I8UWST                          WJUWST
     I              I8UXST                          WJUXST
     I              I8VSST                          WJVSST
     I              I8AATM                          WJAATM
     I              I8AYNA                          WJAYNA
     I              I8A0NA                          WJA0NA
     I              I8AXDT                          WJAXDT
      *
     I@AFREPU
      * Calendar                  RSQ Co/Date Descending
      * Renamed input format fields
     I              AFAIC3                          WKAIC3
     I              AFBCDT                          WKBCDT
     I              AFCQNB                          WKCQNB
     I              AFESNB                          WKESNB
     I              AFETNB                          WKETNB
     I              AFBZNB                          WKBZNB
     I              AFA9ST                          WKA9ST
     I              AFEINB                          WKEINB
     I              AFC5ST                          WKC5ST
     I              AFAQNB                          WKAQNB
     I              AFCMST                          WKCMST
     I              AFV9ST                          WKV9ST
     I              AFWAST                          WKWAST
     I              AFX2ST                          WKX2ST
     I              AFOJDT                          WKOJDT
     I              AFNQNX                          WKNQNX
     I              AFNRNX                          WKNRNX
     I              AFI9SX                          WKI9SX
     I              AFJASX                          WKJASX
     I              AFOKDT                          WKOKDT
     I              AFOLDT                          WKOLDT
     I              AFUVST                          WKUVST
     I              AFUWST                          WKUWST
     I              AFUXST                          WKUXST
     I              AFAATM                          WKAATM
     I              AFAYNA                          WKAYNA
     I              AFA0NA                          WKA0NA
     I              AFAXDT                          WKAXDT
      *
     I@ADRET1
      * Warehouse                 Active records only
      * Renamed input format fields
     I              ADAJCD                          WLAJCD
     I              ADF8NA                          WLF8NA
     I              ADACNA                          WLACNA
     I              ADADNA                          WLADNA
     I              ADAENA                          WLAENA
     I              ADAJNA                          WLAJNA
     I              ADBTTX                          WLBTTX
     I              ADAOCD                          WLAOCD
     I              ADBGCD                          WLBGCD
     I              ADVHST                          WLVHST
     I              ADMPNA                          WLMPNA
     I              ADWPST                          WLWPST
     I              ADXUST                          WLXUST
     I              ADT0ST                          WLT0ST
     I              ADT1ST                          WLT1ST
     I              ADDBNB                          WLDBNB
     I              ADT2ST                          WLT2ST
     I              ADT3ST                          WLT3ST
     I              ADT4ST                          WLT4ST
     I              ADT6ST                          WLT6ST
     I              ADBWC3                          WLBWC3
     I              ADBTC3                          WLBTC3
     I              ADBUC3                          WLBUC3
     I              ADBVC3                          WLBVC3
     I              ADFCAA                          WLFCAA
     I              ADRQSX                          WLRQSX
     I              ADRRSX                          WLRRSX
     I              ADRSSX                          WLRSSX
     I              ADRTSX                          WLRTSX
     I              ADT7ST                          WLT7ST
     I              ADT8ST                          WLT8ST
     I              ADRNSX                          WLRNSX
     I              ADROSX                          WLROSX
     I              ADRPSX                          WLRPSX
     I              ADUVST                          WLUVST
     I              ADUWST                          WLUWST
     I              ADUXST                          WLUXST
     I              ADVSST                          WLVSST
     I              ADAATM                          WLAATM
     I              ADAYNA                          WLAYNA
     I              ADA0NA                          WLA0NA
     I              ADAXDT                          WLAXDT
      *
     I@JCCPVC
      * PS Prod Schedule          Retrieval index
      * Renamed input format fields
     I              JCAIC3                          WMAIC3
     I              JCV5ST                          WMV5ST
     I              JCELDT                          WMELDT
     I              JCHVHD                          WMHVHD
     I              JCZ6NB                          WMZ6NB
     I              JCZ7NB                          WMZ7NB
     I              JCDGPC                          WMDGPC
     I              JCAVCW                          WMAVCW
     I              JCDIPC                          WMDIPC
     I              JCZ0NB                          WMZ0NB
     I              JCAVLE                          WMAVLE
     I              JCECWG                          WMECWG
     I              JCUVST                          WMUVST
     I              JCUWST                          WMUWST
     I              JCUXST                          WMUXST
     I              JCVSST                          WMVSST
     I              JCAATM                          WMAATM
     I              JCAYNA                          WMAYNA
     I              JCA0NA                          WMA0NA
     I              JCAXDT                          WMAXDT
      *
     I@I8CPXP
      * PS Prod Item Schedule     Co/Itm/Whs/PrdDte/Typ
      * Renamed input format fields
     I              I8AIC3                          WOAIC3
     I              I8V5ST                          WOV5ST
     I              I8ELDT                          WOELDT
     I              I8HGCD                          WOHGCD
     I              I8AJCD                          WOAJCD
     I              I8GPDT                          WOGPDT
     I              I8WTSP                          WOWTSP
     I              I8QTSP                          WOQTSP
     I              I8DJPC                          WODJPC
     I              I8F8WG                          WOF8WG
     I              I8WTIN                          WOWTIN
     I              I8D5NB                          WOD5NB
     I              I8DXWG                          WODXWG
     I              I8B2NB                          WOB2NB
     I              I8WTCN                          WOWTCN
     I              I8PSCV                          WOPSCV
     I              I8SAWT                          WOSAWT
     I              I8B9NB                          WOB9NB
     I              I8D1WG                          WOD1WG
     I              I8CBNB                          WOCBNB
     I              I8EZWG                          WOEZWG
     I              I8CCNB                          WOCCNB
     I              I8E0WG                          WOE0WG
     I              I8D6NB                          WOD6NB
     I              I8OAWT                          WOOAWT
     I              I8CDNB                          WOCDNB
     I              I8UNW2                          WOUNW2
     I              I8CENB                          WOCENB
     I              I8F9WG                          WOF9WG
     I              I8BPNB                          WOBPNB
     I              I8GAWG                          WOGAWG
     I              I8BQNB                          WOBQNB
     I              I8GBWG                          WOGBWG
     I              I8BRNB                          WOBRNB
     I              I8GCWG                          WOGCWG
     I              I8BSNB                          WOBSNB
     I              I8GDWG                          WOGDWG
     I              I8BWNB                          WOBWNB
     I              I8GEWG                          WOGEWG
     I              I8PS6U                          WOPS6U
     I              I8WCST                          WOWCST
     I              I8WPST                          WOWPST
     I              I8B5ST                          WOB5ST
     I              I8TFST                          WOTFST
     I              I8TEST                          WOTEST
     I              I8THST                          WOTHST
     I              I8UDST                          WOUDST
     I              I8UFST                          WOUFST
     I              I8UGST                          WOUGST
     I              I8UHST                          WOUHST
     I              I8B6ST                          WOB6ST
     I              I8B7ST                          WOB7ST
     I              I8DVWG                          WODVWG
     I              I8D7NB                          WOD7NB
     I              I8FCAD                          WOFCAD
     I              I8D9NB                          WOD9NB
     I              I8DWWG                          WODWWG
     I              I8EANB                          WOEANB
     I              I8SHWT                          WOSHWT
     I              I8EBNB                          WOEBNB
     I              I8AVWT                          WOAVWT
     I              I8ECNB                          WOECNB
     I              I8WTON                          WOWTON
     I              I8EDNB                          WOEDNB
     I              I8FNWT                          WOFNWT
     I              I8EENB                          WOEENB
     I              I8QTAS                          WOQTAS
     I              I8EFNB                          WOEFNB
     I              I8WAIO                          WOWAIO
     I              I8EGNB                          WOEGNB
     I              I8R3CD                          WOR3CD
     I              I8RGNB                          WORGNB
     I              I8RHNB                          WORHNB
     I              I8RINB                          WORINB
     I              I8XRCD                          WOXRCD
     I              I8UVST                          WOUVST
     I              I8UWST                          WOUWST
     I              I8UXST                          WOUXST
     I              I8VSST                          WOVSST
     I              I8AATM                          WOAATM
     I              I8AYNA                          WOAYNA
     I              I8A0NA                          WOA0NA
     I              I8AXDT                          WOAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WRAIC3
     I              BZHGCD                          WRHGCD
     I              BZAVNA                          WRAVNA
     I              BZAWNA                          WRAWNA
     I              BZL7NA                          WRL7NA
     I              BZL8NA                          WRL8NA
     I              BZL6NA                          WRL6NA
     I              BZMFNA                          WRMFNA
     I              BZADCD                          WRADCD
     I              BZAWPC                          WRAWPC
     I              BZLXST                          WRLXST
     I              BZAECD                          WRAECD
     I              BZAXPC                          WRAXPC
     I              BZLYST                          WRLYST
     I              BZAFCD                          WRAFCD
     I              BZAICD                          WRAICD
     I              BZAIWG                          WRAIWG
     I              BZHICD                          WRHICD
     I              BZRBCD                          WRRBCD
     I              BZFZST                          WRFZST
     I              BZAVST                          WRAVST
     I              BZCZWG                          WRCZWG
     I              BZC0WG                          WRC0WG
     I              BZURTN                          WRURTN
     I              BZAJC8                          WRAJC8
     I              BZRINB                          WRRINB
     I              BZRHNB                          WRRHNB
     I              BZRGNB                          WRRGNB
     I              BZLNCD                          WRLNCD
     I              BZTFNB                          WRTFNB
     I              BZN0CD                          WRN0CD
     I              BZX4ST                          WRX4ST
     I              BZTMVA                          WRTMVA
     I              BZTNVA                          WRTNVA
     I              BZBLPR                          WRBLPR
     I              BZBMPR                          WRBMPR
     I              BZLRCD                          WRLRCD
     I              BZU9ST                          WRU9ST
     I              BZCMCO                          WRCMCO
     I              BZQ1CD                          WRQ1CD
     I              BZQ8CD                          WRQ8CD
     I              BZCHTM                          WRCHTM
     I              BZQZCD                          WRQZCD
     I              BZXWST                          WRXWST
     I              BZXXST                          WRXXST
     I              BZVMST                          WRVMST
     I              BZSWGH                          WRSWGH
     I              BZPPHE                          WRPPHE
     I              BZR3CD                          WRR3CD
     I              BZSDCD                          WRSDCD
     I              BZICN1                          WRICN1
     I              BZSVCD                          WRSVCD
     I              BZICN2                          WRICN2
     I              BZSWCD                          WRSWCD
     I              BZV2NB                          WRV2NB
     I              BZSXCD                          WRSXCD
     I              BZITCN                          WRITCN
     I              BZSYCD                          WRSYCD
     I              BZITC5                          WRITC5
     I              BZSZCD                          WRSZCD
     I              BZICN6                          WRICN6
     I              BZS0CD                          WRS0CD
     I              BZICN7                          WRICN7
     I              BZS1CD                          WRS1CD
     I              BZICN8                          WRICN8
     I              BZS2CD                          WRS2CD
     I              BZICN9                          WRICN9
     I              BZS3CD                          WRS3CD
     I              BZICN0                          WRICN0
     I              BZS4CD                          WRS4CD
     I              BZSFNB                          WRSFNB
     I              BZA3WG                          WRA3WG
     I              BZSJNB                          WRSJNB
     I              BZLLCD                          WRLLCD
     I              BZLMCD                          WRLMCD
     I              BZP3ST                          WRP3ST
     I              BZSKNB                          WRSKNB
     I              BZSLNB                          WRSLNB
     I              BZSMNB                          WRSMNB
     I              BZP4ST                          WRP4ST
     I              BZCFNB                          WRCFNB
     I              BZCGNB                          WRCGNB
     I              BZILNB                          WRILNB
     I              BZCHNB                          WRCHNB
     I              BZCINB                          WRCINB
     I              BZCJNB                          WRCJNB
     I              BZCMNB                          WRCMNB
     I              BZCNNB                          WRCNNB
     I              BZCRNB                          WRCRNB
     I              BZCSNB                          WRCSNB
     I              BZCVNB                          WRCVNB
     I              BZCWNB                          WRCWNB
     I              BZCXNB                          WRCXNB
     I              BZCZNB                          WRCZNB
     I              BZC0NB                          WRC0NB
     I              BZN1CD                          WRN1CD
     I              BZB4NB                          WRB4NB
     I              BZB5NB                          WRB5NB
     I              BZX5ST                          WRX5ST
     I              BZX6ST                          WRX6ST
     I              BZX7ST                          WRX7ST
     I              BZPCCT                          WRPCCT
     I              BZBDNB                          WRBDNB
     I              BZBJNB                          WRBJNB
     I              BZSUST                          WRSUST
     I              BZSVST                          WRSVST
     I              BZSYST                          WRSYST
     I              BZSZST                          WRSZST
     I              BZS1ST                          WRS1ST
     I              BZXRCD                          WRXRCD
     I              BZXTCD                          WRXTCD
     I              BZXUCD                          WRXUCD
     I              BZF5WG                          WRF5WG
     I              BZF6WG                          WRF6WG
     I              BZF7WG                          WRF7WG
     I              BZBLNB                          WRBLNB
     I              BZBNNB                          WRBNNB
     I              BZS2ST                          WRS2ST
     I              BZS4ST                          WRS4ST
     I              BZS5ST                          WRS5ST
     I              BZS6ST                          WRS6ST
     I              BZS8ST                          WRS8ST
     I              BZS9ST                          WRS9ST
     I              BZTCST                          WRTCST
     I              BZTDST                          WRTDST
     I              BZUVST                          WRUVST
     I              BZUWST                          WRUWST
     I              BZUXST                          WRUXST
     I              BZVSST                          WRVSST
     I              BZAATM                          WRAATM
     I              BZAYNA                          WRAYNA
     I              BZA0NA                          WRA0NA
     I              BZAXDT                          WRAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WSAJCD
     I              ADF8NA                          WSF8NA
     I              ADACNA                          WSACNA
     I              ADADNA                          WSADNA
     I              ADAENA                          WSAENA
     I              ADAJNA                          WSAJNA
     I              ADBTTX                          WSBTTX
     I              ADAOCD                          WSAOCD
     I              ADBGCD                          WSBGCD
     I              ADVHST                          WSVHST
     I              ADMPNA                          WSMPNA
     I              ADWPST                          WSWPST
     I              ADXUST                          WSXUST
     I              ADT0ST                          WST0ST
     I              ADT1ST                          WST1ST
     I              ADDBNB                          WSDBNB
     I              ADT2ST                          WST2ST
     I              ADT3ST                          WST3ST
     I              ADT4ST                          WST4ST
     I              ADT6ST                          WST6ST
     I              ADBWC3                          WSBWC3
     I              ADBTC3                          WSBTC3
     I              ADBUC3                          WSBUC3
     I              ADBVC3                          WSBVC3
     I              ADFCAA                          WSFCAA
     I              ADRQSX                          WSRQSX
     I              ADRRSX                          WSRRSX
     I              ADRSSX                          WSRSSX
     I              ADRTSX                          WSRTSX
     I              ADT7ST                          WST7ST
     I              ADT8ST                          WST8ST
     I              ADRNSX                          WSRNSX
     I              ADROSX                          WSROSX
     I              ADRPSX                          WSRPSX
     I              ADUVST                          WSUVST
     I              ADUWST                          WSUWST
     I              ADUXST                          WSUXST
     I              ADVSST                          WSVSST
     I              ADAATM                          WSAATM
     I              ADAYNA                          WSAYNA
     I              ADA0NA                          WSA0NA
     I              ADAXDT                          WSAXDT
      *
     I@AFREYY
      * Calendar                  Co/Date               NV
      * Renamed input format fields
     I              AFAIC3                          WTAIC3
     I              AFBCDT                          WTBCDT
     I              AFCQNB                          WTCQNB
     I              AFESNB                          WTESNB
     I              AFETNB                          WTETNB
     I              AFBZNB                          WTBZNB
     I              AFA9ST                          WTA9ST
     I              AFEINB                          WTEINB
     I              AFC5ST                          WTC5ST
     I              AFAQNB                          WTAQNB
     I              AFCMST                          WTCMST
     I              AFV9ST                          WTV9ST
     I              AFWAST                          WTWAST
     I              AFX2ST                          WTX2ST
     I              AFOJDT                          WTOJDT
     I              AFNQNX                          WTNQNX
     I              AFNRNX                          WTNRNX
     I              AFI9SX                          WTI9SX
     I              AFJASX                          WTJASX
     I              AFOKDT                          WTOKDT
     I              AFOLDT                          WTOLDT
     I              AFUVST                          WTUVST
     I              AFUWST                          WTUWST
     I              AFUXST                          WTUXST
     I              AFAATM                          WTAATM
     I              AFAYNA                          WTAYNA
     I              AFA0NA                          WTA0NA
     I              AFAXDT                          WTAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQPOB51    E DSPOB5CPL0
      * UPD : Order Detail Sched-Inv    Update index
      * Renamed input format fields
     I              B5AIC3                          WFAIC3
     I              B5C4NB                          WFC4NB
     I              B5DPNB                          WFDPNB
     I              B5UENB                          WFUENB
     I              B5JGDT                          WFJGDT
     I              B5AODT                          WFAODT
     I              B5AJCD                          WFAJCD
     I              B5HGCD                          WFHGCD
     I              B5IUQT                          WFIUQT
     I              B5F3WG                          WFF3WG
     I              B5UVST                          WFUVST
     I              B5UWST                          WFUWST
     I              B5UXST                          WFUXST
     I              B5VSST                          WFVSST
     I              B5AATM                          WFAATM
     I              B5AYNA                          WFAYNA
     I              B5A0NA                          WFA0NA
     I              B5AXDT                          WFAXDT
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYARDCS      DS                             69
     IQPDKN1    E DSPDKNCPL0
      * UPD : Order Detail Schedule     Update index
      * Renamed input format fields
     I              KNAIC3                          WHAIC3
     I              KNC4NB                          WHC4NB
     I              KNDPNB                          WHDPNB
     I              KNUENB                          WHUENB
     I              KNJGDT                          WHJGDT
     I              KNAODT                          WHAODT
     I              KNAJCD                          WHAJCD
     I              KNAYAA                          WHAYAA
     I              KNHGCD                          WHHGCD
     I              KNIGQT                          WHIGQT
     I              KNFLWG                          WHFLWG
     I              KNIUQT                          WHIUQT
     I              KNF3WG                          WHF3WG
     I              KNIVQT                          WHIVQT
     I              KNF4WG                          WHF4WG
     I              KNP7ST                          WHP7ST
     I              KNP8ST                          WHP8ST
     I              KNQAST                          WHQAST
     I              KNUVST                          WHUVST
     I              KNUWST                          WHUWST
     I              KNUXST                          WHUXST
     I              KNVSST                          WHVSST
     I              KNAATM                          WHAATM
     I              KNAYNA                          WHAYNA
     I              KNA0NA                          WHA0NA
     I              KNAXDT                          WHAXDT
      *
     IYBRDCS      DS                            100
     IQPDI81    E DSPDI8CPL0
      * UPD : PS Prod Item Schedule     Update index
      * Renamed input format fields
     I              I8AIC3                          WJAIC3
     I              I8V5ST                          WJV5ST
     I              I8ELDT                          WJELDT
     I              I8HGCD                          WJHGCD
     I              I8AJCD                          WJAJCD
     I              I8GPDT                          WJGPDT
     I              I8WTSP                          WJWTSP
     I              I8QTSP                          WJQTSP
     I              I8DJPC                          WJDJPC
     I              I8F8WG                          WJF8WG
     I              I8WTIN                          WJWTIN
     I              I8D5NB                          WJD5NB
     I              I8DXWG                          WJDXWG
     I              I8B2NB                          WJB2NB
     I              I8WTCN                          WJWTCN
     I              I8PSCV                          WJPSCV
     I              I8SAWT                          WJSAWT
     I              I8B9NB                          WJB9NB
     I              I8D1WG                          WJD1WG
     I              I8CBNB                          WJCBNB
     I              I8EZWG                          WJEZWG
     I              I8CCNB                          WJCCNB
     I              I8E0WG                          WJE0WG
     I              I8D6NB                          WJD6NB
     I              I8OAWT                          WJOAWT
     I              I8CDNB                          WJCDNB
     I              I8UNW2                          WJUNW2
     I              I8CENB                          WJCENB
     I              I8F9WG                          WJF9WG
     I              I8BPNB                          WJBPNB
     I              I8GAWG                          WJGAWG
     I              I8BQNB                          WJBQNB
     I              I8GBWG                          WJGBWG
     I              I8BRNB                          WJBRNB
     I              I8GCWG                          WJGCWG
     I              I8BSNB                          WJBSNB
     I              I8GDWG                          WJGDWG
     I              I8BWNB                          WJBWNB
     I              I8GEWG                          WJGEWG
     I              I8PS6U                          WJPS6U
     I              I8WCST                          WJWCST
     I              I8WPST                          WJWPST
     I              I8B5ST                          WJB5ST
     I              I8TFST                          WJTFST
     I              I8TEST                          WJTEST
     I              I8THST                          WJTHST
     I              I8UDST                          WJUDST
     I              I8UFST                          WJUFST
     I              I8UGST                          WJUGST
     I              I8UHST                          WJUHST
     I              I8B6ST                          WJB6ST
     I              I8B7ST                          WJB7ST
     I              I8DVWG                          WJDVWG
     I              I8D7NB                          WJD7NB
     I              I8FCAD                          WJFCAD
     I              I8D9NB                          WJD9NB
     I              I8DWWG                          WJDWWG
     I              I8EANB                          WJEANB
     I              I8SHWT                          WJSHWT
     I              I8EBNB                          WJEBNB
     I              I8AVWT                          WJAVWT
     I              I8ECNB                          WJECNB
     I              I8WTON                          WJWTON
     I              I8EDNB                          WJEDNB
     I              I8FNWT                          WJFNWT
     I              I8EENB                          WJEENB
     I              I8QTAS                          WJQTAS
     I              I8EFNB                          WJEFNB
     I              I8WAIO                          WJWAIO
     I              I8EGNB                          WJEGNB
     I              I8R3CD                          WJR3CD
     I              I8RGNB                          WJRGNB
     I              I8RHNB                          WJRHNB
     I              I8RINB                          WJRINB
     I              I8XRCD                          WJXRCD
     I              I8UVST                          WJUVST
     I              I8UWST                          WJUWST
     I              I8UXST                          WJUXST
     I              I8VSST                          WJVSST
     I              I8AATM                          WJAATM
     I              I8AYNA                          WJAYNA
     I              I8A0NA                          WJA0NA
     I              I8AXDT                          WJAXDT
      *
     IYCRDCS      DS                            326
     IYDRDCS      DS                            100
     IYERDCS      DS                            326
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Order Number
     I                                    P   3   60P1C4NB
      * I :  Order Sequence Number
     I                                    P   7   80P1DPNB
      * I :  Order Secondary Line Seq
     I                                    P   9  100P1UENB
      * I :  Item Code
     I                                    P  11  140P1HGCD
      * I :  Warehouse Code
     I                                       15  17 P1AJCD
      * I :  Age Code
     I                                       18  18 P1RPCD
      * I :  Ship Date USR
     I                                    P  19  220P1HLDT
      * I :  Quantity Ordered
     I                                    P  23  282P1AVQT
      * I :  Weight Ordered
     I                                    P  29  342P1D0WG
      * B :  Quantity Scheduled
     I                                    P  35  402P1CCQT
      * B :  Weight Scheduled
     I                                    P  41  462P1AUWG
      * I :  PSAA Program Name
     I                                       47  56 P1BXVN
      * B :  ATS Quantity Need USR
     I                                    P  57  622P1HWQT
      * B :  ATS Weight Need USR
     I                                    P  63  682P1ENWG
      * I :  Unit Weight
     I                                    P  69  742P1AIWG
      * N :  Production Date
     I                                    P  75  780P1ELDT
      * N :  Production Date RGF
     I                                    P  79  820P1GVDT
      * N :  Production Date RGT
     I                                    P  83  860P1GWDT
      * I :  ATS Adj Type USR 2
     I                                       87  88 P1QJST
      * N :  Week Number
     I                                    P  89  900P1EINB
      * N :  Accounting Year Code
     I                                    P  91  930P1ESNB
      * N :  Accounting Period Code
     I                                    P  94  950P1ETNB
      * N :  OM Week
     I                                    P  96  970P1BZNB
      * N :  Week Begin Date      USR
     I                                    P  98 1010P1LHDT
      * N :  Week End Date        USR
     I                                    P 102 1050P1LIDT
      * I :  Production Date USR
     I                                    P 106 1090P1GXDT
     IP2PARM      DS
      * FLD: Company Item
      * I :  U/M - Primary
     I                                        1   2 P2ADCD
      * I :  Fresh Chilling Time
     I                                    P   3   52P2CHTM
      * I :  Base/Conv/Loss Item
     I                                        6   7 P2QZCD
      * I :  Department Code
     I                                        8  13 P2R3CD
      * I :  Piece Count Item
     I                                       14  14 P2PCCT
      * I :  Pieces Per Bag
     I                                    P  15  180P2BDNB
      * I :  Bags Per Unit
     I                                    P  19  220P2BJNB
      * I :  Export/Domestic
     I                                       23  23 P2SUST
      * I :  Print On Schedule
     I                                       24  24 P2SVST
      * I :  Fresh Inv Allocation Seq
     I                                       25  25 P2SYST
      * I :  Fresh Sched As Ordered
     I                                       26  26 P2SZST
      * I :  Frozen Sched As Ordered
     I                                       27  27 P2S1ST
      * I :  Primal Group Code
     I                                       28  33 P2XRCD
     IP3PARM      DS
      * FLD: Warehouse
      * N :  Production Warehouse Code
     I                                        1   3 P3AOCD
      * I :  Warehouse Type
     I                                        4   5 P3WPST
      * I :  Warehouse Std Chill Time
     I                                        6   6 P3T1ST
      * I :  Warehouse Chill Time
     I                                    P   7   92P3DBNB
     IP4PARM      DS
      * FLD: Order Detail Schedule
      * N :  Scheduled Ship Date
     I                                    P   1   40P4AODT
      * N :  Order From Warehouse
     I                                        5   7 P4AYAA
     IP5PARM      DS
      * N :  Chill Time USR
     I                                    P   1   20P5CSHD
     IP6PARM      DS
      * I :  USR Age Code
     I                                        1   1 P6FWST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1DPNB    PARM           WP0003  30       Order Sequence
     C           P1UENB    PARM           WP0004  30       Order Secondary
     C           P1HGCD    PARM           WP0005  70       Item Code
     C           P1AJCD    PARM           WP0006  3        Warehouse Code
     C           P1RPCD    PARM           WP0007  1        Age Code
     C           P1HLDT    PARM           WP0008  70       Ship Date USR
     C           P1AVQT    PARM           WP0009 112       Quantity Ordere
     C           P1D0WG    PARM           WP0010 112       Weight Ordered
     C           P1CCQT    PARM P1CCQT    WP0011 112       Quantity Schedu
     C           P1AUWG    PARM P1AUWG    WP0012 112       Weight Schedule
     C           P1BXVN    PARM           WP0013 10        PSAA Program Na
     C           P1HWQT    PARM P1HWQT    WP0014 112       ATS Quantity Ne
     C           P1ENWG    PARM P1ENWG    WP0015 112       ATS Weight Need
     C           P1AIWG    PARM           WP0016 112       Unit Weight
     C           P1QJST    PARM           WP0017  2        ATS Adj Type US
     C           P1GXDT    PARM           WP0018  70       Production Date
     C           P2ADCD    PARM           WP0019  2        U/M - Primary
     C           P2CHTM    PARM           WP0020  52       Fresh Chilling
     C           P2QZCD    PARM           WP0021  2        Base/Conv/Loss
     C           P2R3CD    PARM           WP0022  6        Department Code
     C           P2PCCT    PARM           WP0023  1        Piece Count Ite
     C           P2BDNB    PARM           WP0024  70       Pieces Per Bag
     C           P2BJNB    PARM           WP0025  70       Bags Per Unit
     C           P2SUST    PARM           WP0026  1        Export/Domestic
     C           P2SVST    PARM           WP0027  1        Print On Schedu
     C           P2SYST    PARM           WP0028  1        Fresh Inv Alloc
     C           P2SZST    PARM           WP0029  1        Fresh Sched As
     C           P2S1ST    PARM           WP0030  1        Frozen Sched As
     C           P2XRCD    PARM           WP0031  6        Primal Group Co
     C           P3WPST    PARM           WP0032  2        Warehouse Type
     C           P3T1ST    PARM           WP0033  1        Warehouse Std C
     C           P3DBNB    PARM           WP0034  52       Warehouse Chill
     C           P6FWST    PARM           WP0035  1        USR Age Code
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * UPD ATS Order Allocate zz
      * Age Limit - Production (PAR Context) (Age Code)
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           P3T1ST    IFEQ 'Y'                        *IF
      * CLC PA Age Limits      IF
     C                     Z-ADD*ZERO     WUDNBU           Day NBR USR
      * 04/10/07 Effective 04/23/07 representation of Age Code changes
      *          will be such that Age Code A will be 0 day for boxes
      *          and combos.  The labels on the cartons will not print
      *          a date that is offset by Sunday or Holiday.  Instead of
      *          Code Date, it will be the Pack Date.
      * Production Date RGT and Production Date RGF
      * CASE: PAR.Chilling Time is Not Entered
     C           P3DBNB    IFEQ *ZERO                      *IF
     C                     Z-ADDP1HLDT    P1GWDT           Production Date
      * Production Date RGF
      * CASE: PAR.Age Code is A: 0 Day
     C           P1RPCD    IFEQ 'A'                        *IF
     C                     Z-ADDP1GWDT    P1GVDT           Production Date
     C                     ELSE
      * CASE: PAR.Age Code is B: 1 Day
     C           P1RPCD    IFEQ 'B'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-1 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GVDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GVDT
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is C: 2 Day
     C           P1RPCD    IFEQ 'C'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-2 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-2        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GVDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GVDT
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is D: 3 Day
     C           P1RPCD    IFEQ 'D'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-3 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-3        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GVDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GVDT
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is E: 4 Day
     C           P1RPCD    IFEQ 'E'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-4 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-4        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GVDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GVDT
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is F: 5 Day
     C           P1RPCD    IFEQ 'F'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-5 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-5        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GVDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GVDT
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is G: 6 Day
     C           P1RPCD    IFEQ 'G'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-6 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-6        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GVDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GVDT
     C                     END
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Age Code is H: 7 Days to 119 Days
      *   |- c2    : PAR.Age Code is I: 120 Days +
      *   '-
     C           P1RPCD    IFEQ 'H'                        *IF
     C           P1RPCD    OREQ 'I'                        *OR
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-365 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-365      XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GVDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GVDT
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C           P3DBNB    MULT -1        YL0001           Fresh Chilling
      * PAR.Production Date RGT = PAR.Ship Date USR + LCL.Fresh Chilling
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDYL0001    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111110' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GWDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GWDT
     C                     END
      * Production Date RGF
      * CASE: PAR.Age Code is A: 0 Day
     C           P1RPCD    IFEQ 'A'                        *IF
      * 04/10/07 PKD We should not have chilled orders with A Age Code.
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-1 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GVDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GVDT
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is B: 1 Day
     C           P1RPCD    IFEQ 'B'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-1 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GVDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GVDT
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is C: 2 Day
     C           P1RPCD    IFEQ 'C'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-2 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-2        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GVDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GVDT
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is D: 3 Day
     C           P1RPCD    IFEQ 'D'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-3 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-3        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GVDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GVDT
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is E: 4 Day
     C           P1RPCD    IFEQ 'E'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-4 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-4        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GVDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GVDT
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is F: 5 Day
     C           P1RPCD    IFEQ 'F'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-5 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-5        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GVDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GVDT
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is G: 6 Day
     C           P1RPCD    IFEQ 'G'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-6 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-6        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GVDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GVDT
     C                     END
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Age Code is H: 7 Days to 119 Days
      *   |- c2    : PAR.Age Code is I: 120 Days +
      *   '-
     C           P1RPCD    IFEQ 'H'                        *IF
     C           P1RPCD    OREQ 'I'                        *OR
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-365 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-365      XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GVDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GVDT
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CLC PA Age Limits      IF
     C                     Z-ADD*ZERO     WUDNBU           Day NBR USR
      * 04/10/07 Effective 04/23/07 representation of Age Code changes
      *          will be such that Age Code A will be 0 day for boxes
      *          and combos.  The labels on the cartons will not print
      *          a date that is offset by Sunday or Holiday.  Instead of
      *          Code Date, it will be the Pack Date.
      * Production Date RGT and Production Date RGF
      * CASE: PAR.Chilling Time is Not Entered
     C           P2CHTM    IFEQ *ZERO                      *IF
     C                     Z-ADDP1HLDT    P1GWDT           Production Date
      * Production Date RGF
      * CASE: PAR.Age Code is A: 0 Day
     C           P1RPCD    IFEQ 'A'                        *IF
     C                     Z-ADDP1GWDT    P1GVDT           Production Date
     C                     ELSE
      * CASE: PAR.Age Code is B: 1 Day
     C           P1RPCD    IFEQ 'B'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-1 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GVDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GVDT
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is C: 2 Day
     C           P1RPCD    IFEQ 'C'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-2 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-2        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GVDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GVDT
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is D: 3 Day
     C           P1RPCD    IFEQ 'D'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-3 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-3        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GVDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GVDT
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is E: 4 Day
     C           P1RPCD    IFEQ 'E'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-4 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-4        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GVDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GVDT
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is F: 5 Day
     C           P1RPCD    IFEQ 'F'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-5 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-5        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GVDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GVDT
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is G: 6 Day
     C           P1RPCD    IFEQ 'G'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-6 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-6        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GVDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GVDT
     C                     END
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Age Code is H: 7 Days to 119 Days
      *   |- c2    : PAR.Age Code is I: 120 Days +
      *   '-
     C           P1RPCD    IFEQ 'H'                        *IF
     C           P1RPCD    OREQ 'I'                        *OR
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-365 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-365      XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GVDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GVDT
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C           P2CHTM    MULT -1        YL0001           Fresh Chilling
      * PAR.Production Date RGT = PAR.Ship Date USR + LCL.Fresh Chilling
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDYL0001    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111110' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GWDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GWDT
     C                     END
      * Production Date RGF
      * CASE: PAR.Age Code is A: 0 Day
     C           P1RPCD    IFEQ 'A'                        *IF
      * 04/10/07 PKD We should not have chilled orders with A Age Code.
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-1 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GVDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GVDT
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is B: 1 Day
     C           P1RPCD    IFEQ 'B'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-1 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GVDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GVDT
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is C: 2 Day
     C           P1RPCD    IFEQ 'C'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-2 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-2        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GVDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GVDT
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is D: 3 Day
     C           P1RPCD    IFEQ 'D'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-3 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-3        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GVDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GVDT
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is E: 4 Day
     C           P1RPCD    IFEQ 'E'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-4 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-4        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GVDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GVDT
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is F: 5 Day
     C           P1RPCD    IFEQ 'F'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-5 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-5        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GVDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GVDT
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is G: 6 Day
     C           P1RPCD    IFEQ 'G'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-6 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-6        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GVDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GVDT
     C                     END
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Age Code is H: 7 Days to 119 Days
      *   |- c2    : PAR.Age Code is I: 120 Days +
      *   '-
     C           P1RPCD    IFEQ 'H'                        *IF
     C           P1RPCD    OREQ 'I'                        *OR
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-365 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-365      XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P1GVDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P1GVDT
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Production Date USR is Entered
     C           P1GXDT    IFNE *ZERO                      *IF
     C                     Z-ADDP1GXDT    P1ELDT           Production Date
     C                     Z-ADDP1GXDT    P1GVDT           Production Date
     C                     Z-ADDP1GXDT    P1GWDT           Production Date
     C                     END                             *FI
      * Retrieve Week End date for *JOB DATE
      * RTV Day/Wk/Prd/Yr     RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     Z-ADD##JDT     WL0002           Post to G/L Dat
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    WUCQNB           Julian Date
     C                     Z-ADDWL0004    P1ESNB           Accounting Year
     C                     Z-ADDWL0005    P1ETNB           Accounting Peri
     C                     Z-ADDWL0006    P1BZNB           OM Week
     C                     MOVELWL0007    WUA9ST    P      Day of Week
     C                     Z-ADDWL0008    P1EINB           Week Number
      * RTV Bgn/End Dts Prd/Yr RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0009           Company Number
     C                     Z-ADDP1ESNB    WL0011           Accounting Year
     C                     Z-ADDP1ETNB    WL0012           Accounting Peri
     C                     MOVEL'7'       WL0013    P      Day of Week
     C                     Z-ADDP1EINB    WL0014           Week Number
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0010    P1LIDT           Post to G/L Dat
      * Allocate Inventory, Production, and/or Standard Mix
      * CASE: PAR.Warehouse Type is Frozen
     C           P3WPST    IFEQ 'FZ'                       *IF
      * CLC PA Age Limits      IF
     C                     Z-ADD*ZERO     WUDNBU           Day NBR USR
      * 04/10/07 Effective 04/23/07 representation of Age Code changes
      *          will be such that Age Code A will be 0 day for boxes
      *          and combos.  The labels on the cartons will not print
      *          a date that is offset by Sunday or Holiday.  Instead of
      *          Code Date, it will be the Pack Date.
      * Production Date RGT and Production Date RGF
      * CASE: PAR.Chilling Time is Not Entered
     C           P3DBNB    IFEQ *ZERO                      *IF
     C                     Z-ADDP1HLDT    YL0003           Production Date
      * Production Date RGF
      * CASE: PAR.Age Code is A: 0 Day
     C           P6FWST    IFEQ 'A'                        *IF
     C                     Z-ADDYL0003    YL0002           Production Date
     C                     ELSE
      * CASE: PAR.Age Code is B: 1 Day
     C           P6FWST    IFEQ 'B'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-1 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is C: 2 Day
     C           P6FWST    IFEQ 'C'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-2 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-2        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is D: 3 Day
     C           P6FWST    IFEQ 'D'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-3 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-3        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is E: 4 Day
     C           P6FWST    IFEQ 'E'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-4 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-4        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is F: 5 Day
     C           P6FWST    IFEQ 'F'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-5 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-5        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is G: 6 Day
     C           P6FWST    IFEQ 'G'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-6 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-6        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Age Code is H: 7 Days to 119 Days
      *   |- c2    : PAR.Age Code is I: 120 Days +
      *   '-
     C           P6FWST    IFEQ 'H'                        *IF
     C           P6FWST    OREQ 'I'                        *OR
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-365 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-365      XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C           P3DBNB    MULT -1        YL0001           Fresh Chilling
      * PAR.Production Date RGT = PAR.Ship Date USR + LCL.Fresh Chilling
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDYL0001    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111110' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0003
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0003
     C                     END
      * Production Date RGF
      * CASE: PAR.Age Code is A: 0 Day
     C           P6FWST    IFEQ 'A'                        *IF
      * 04/10/07 PKD We should not have chilled orders with A Age Code.
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-1 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is B: 1 Day
     C           P6FWST    IFEQ 'B'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-1 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is C: 2 Day
     C           P6FWST    IFEQ 'C'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-2 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-2        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is D: 3 Day
     C           P6FWST    IFEQ 'D'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-3 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-3        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is E: 4 Day
     C           P6FWST    IFEQ 'E'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-4 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-4        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is F: 5 Day
     C           P6FWST    IFEQ 'F'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-5 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-5        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is G: 6 Day
     C           P6FWST    IFEQ 'G'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-6 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-6        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Age Code is H: 7 Days to 119 Days
      *   |- c2    : PAR.Age Code is I: 120 Days +
      *   '-
     C           P6FWST    IFEQ 'H'                        *IF
     C           P6FWST    OREQ 'I'                        *OR
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-365 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-365      XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0001 110       ATS Quantity Av
     C                     Z-ADD*ZERO     WN0002 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0003 112       Quantity Alloca
     C                     Z-ADD*ZERO     WN0004  92       Weight Allocate
      *
      * UPD Allocate Inv      IF
      * Allocate Inventory
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Production Date RGF LT JOB.*Job date
      *   |- c2    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0002    IFLT ##JDT                      *IF
     C           P1HWQT    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * UPD Allocate Inv      RT - PS Prod Item Inventory  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0015           Company Number
     C                     Z-ADDP1HGCD    WL0016           Item Code
     C                     MOVELP1AJCD    WL0017    P      Warehouse Code
     C                     Z-ADDYL0002    WL0018           Production Date
     C                     Z-ADDP1AIWG    WL0019           Unit Weight
     C                     MOVELP2PCCT    WL0020    P      Piece Count Ite
     C                     Z-ADDP2BDNB    WL0021           Pieces Per Bag
     C                     Z-ADDP2BJNB    WL0022           Bags Per Unit
     C                     Z-ADDP1C4NB    WL0023           Order Number
     C                     Z-ADDP1DPNB    WL0024           Order Sequence
     C                     Z-ADDP1UENB    WL0025           Order Secondary
     C                     Z-ADDP1AVQT    WL0026           Quantity Ordere
     C                     Z-ADDP1D0WG    WL0027           Weight Ordered
     C                     Z-ADDP1CCQT    WL0028           Quantity Schedu
     C                     Z-ADDP1AUWG    WL0029           Weight Schedule
     C                     Z-ADDP1HWQT    WL0030           ATS Quantity Ne
     C                     Z-ADDP1ENWG    WL0031           ATS Weight Need
     C                     Z-ADDP1HLDT    WL0032           Ship Date USR
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0028    P1CCQT           Quantity Schedu
     C                     Z-ADDWL0029    P1AUWG           Weight Schedule
     C                     Z-ADDWL0030    P1HWQT           ATS Quantity Ne
     C                     Z-ADDWL0031    P1ENWG           ATS Weight Need
     C                     END                             *FI
      * Ship Off Cut
      * CASE: LCL.Production Date RGT LT JOB.*Job date
     C           YL0003    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0003           Production Date
     C                     Z-ADDYL0003    YL0008           Production Date
     C                     Z-ADDYL0008    YL0002           Production Date
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0064           Company Number
     C                     Z-ADDYL0003    WL0065           Post to G/L Dat
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0066    YL0009    P      Production Day
      * CASE: LCL.Production Day Status is no
     C           YL0009    IFEQ 'N'                        *IF
      * Rtv Prev Prd Dte      RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0067           Company Number
     C                     Z-ADDYL0003    WL0068           Post to G/L Dat
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0069    YL0003           Production Date
     C                     END                             *FI
     C                     END                             *FI
      * CASE: LCL.Production Date RGT GE LCL.Production Date RGF
     C           YL0003    IFGE YL0002                     *IF
     C                     Z-ADDYL0003    YL0002           Production Date
      *
     C                     MOVEL*BLANK    WN0140  1        Production Type
     C                     Z-ADD*ZERO     WN0141 110       ATS Quantity Av
     C                     Z-ADD*ZERO     WN0142 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0143  70       ATS Pieces Avai
     C                     Z-ADD*ZERO     WN0144 112       Quantity Alloca
     C                     Z-ADD*ZERO     WN0145  92       Weight Allocate
     C                     Z-ADD*ZERO     WN0146  70       Pieces Allocate
     C                     Z-ADD*ZERO     WN0147  52       Chilling Time U
     C                     Z-ADD*ZERO     WN0148  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0149  52       Production Yiel
     C                     Z-ADD*ZERO     WN0150  70       SM Pieces Need
     C                     Z-ADD*ZERO     WN0151 112       SM Weight Need
      *
      * UPD Allocate Prd      IF
      * FP1054 Added CASE stmts for Fresh and Frozen- frozen is alloc bac
      *      When getting Production or Standard numbers, then
      *      Use Production Warehouse and Acctng Co for Order's Warehouse
      * Rtv Productin Whs     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1AJCD    WL0070    P      Warehouse Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0071    YL0010    P      Production Ware
     C                     Z-ADDWL0072    YL0011           Accounting Comp
      * FRESH - original code is in this CASE - alloc forward
      * CASE: PAR.Warehouse Type is Fresh
     C           P3WPST    IFEQ 'FR'                       *IF
     C                     MOVEL'F'       YL0012           Allocation Meth
      * Chilling Time
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           P3T1ST    IFEQ 'Y'                        *IF
     C                     Z-ADDP3DBNB    WN0147           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP2CHTM    WN0147           Chilling Time U
     C                     END                             *FI
     C                     Z-ADDYL0003    YL0013           Production Date
      * DOC:  Allocation
     C                     EXSR UASUBR                     DOC:  Allocatio
      * CASE: LCL.Allocation Method USR is Forward
     C           YL0012    IFEQ 'F'                        *IF
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           YL0002    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0008           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           YL0003    IFLT ##JDT                      *IF
     C                     Z-ADDYL0003    YL0013           Production Date
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0002    YL0008           Production Date
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte <= Prd Dte RGT & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date LE LCL.Production Date To
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           YL0008    IFLE YL0013                     *IF
     C           P1HWQT    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0064           Company Number
     C                     Z-ADDYL0008    WL0065           Post to G/L Dat
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0066    YL0014    P      Production Day
      * Allocate Production
      * CASE: LCL.Production Day Status is yes
     C           YL0014    IFEQ 'Y'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0008    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0140           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0073           Company Number
     C                     MOVELWN0140    WL0074    P      Production Type
     C                     Z-ADDYL0008    WL0075           Production Date
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0076    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0140           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           YL0008    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0140           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use Production Warehouse and Acctng instead of par.warehou
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0011    WL0077           Company Number
     C                     MOVELWN0140    WL0078    P      Production Type
     C                     Z-ADDYL0008    WL0079           Production Date
     C                     Z-ADDP1HGCD    WL0080           Item Code
     C                     MOVELYL0010    WL0081    P      Warehouse Code
     C                     Z-ADDWN0142    WL0083           ATS Weight Avai
     C                     Z-ADDWN0143    WL0084           ATS Pieces Avai
     C                     Z-ADDWN0147    WL0085           Chilling Time U
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0082    WN0148           PS Avg Piece Wg
     C                     Z-ADDWL0083    WN0142           ATS Weight Avai
     C                     Z-ADDWL0084    WN0143           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2PCCT    IFEQ 'Y'                        *IF
     C           P2BDNB    IFGT *ZERO                      *IF
     C           P2BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           P2BDNB    MULT P2BJNB    W0WJ01           *Synon (15,0) w
     C           WN0143    DIV  W0WJ01    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0141           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2PCCT    IFEQ *BLANK                     *IF
     C           P2PCCT    OREQ 'N'
     C           P1AIWG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0142    DIV  P1AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0141           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0141           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           P1QJST    IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0141    IFLT P1HWQT                     *IF
     C                     Z-ADDP1HWQT    WN0141           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0141    IFGT *ZERO                      *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           P1HWQT    IFGT WN0141                     *IF
     C                     ADD  WN0141    P1CCQT           Quantity Schedu
     C           WN0141    MULT P1AIWG    WN0142           ATS Weight Avai
     C                     ADD  WN0142    P1AUWG           Weight Schedule
     C                     Z-ADDWN0142    WN0145           Weight Allocate
     C                     Z-ADDWN0141    WN0144           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           P1HWQT    IFLE WN0141                     *IF
     C                     ADD  P1HWQT    P1CCQT           Quantity Schedu
     C           P1HWQT    MULT P1AIWG    P1ENWG    H      ATS Weight Need
     C                     ADD  P1ENWG    P1AUWG           Weight Schedule
     C                     Z-ADDP1ENWG    WN0145           Weight Allocate
     C                     Z-ADDP1HWQT    WN0144           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0144    IFGT *ZERO                      *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0086           Company Number
     C                     Z-ADDP1C4NB    WL0087           Order Number
     C                     Z-ADDP1DPNB    WL0088           Order Sequence
     C                     Z-ADDP1UENB    WL0089           Order Secondary
     C                     Z-ADDYL0008    WL0090           OD Production D
     C                     Z-ADDP1HLDT    WL0091           Scheduled Ship
     C                     MOVELP1AJCD    WL0092    P      Warehouse Code
     C                     MOVELP1AJCD    WL0093    P      Order From Ware
     C                     Z-ADDP1HGCD    WL0094           Item Code
     C                     Z-ADDWN0145    WL0095           Weight Allocate
     C                     Z-ADDWN0144    WL0096           Quantity Alloca
     C                     MOVELP2QZCD    WL0097    P      Base/Conv/Loss
     C                     EXSR SURVGN
      * CASE: PAR.Piece Count Item is yes
     C           P2PCCT    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           WN0144    MULT P2BDNB    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P2BJNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0146           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0146    MULT WN0148    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0145           Weight Allocate
     C                     END                             *FI
      * FP1054 Upd production by Production Warehouse, Acctng Co
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0011    WL0098           Company Number
     C                     MOVELWN0140    WL0099    P      Production Type
     C                     Z-ADDYL0008    WL0100           Production Date
     C                     Z-ADDP1HGCD    WL0101           Item Code
     C                     MOVELYL0010    WL0102    P      Warehouse Code
     C                     Z-ADDWN0145    WL0103           Weight Allocate
     C                     Z-ADDWN0146    WL0104           Pieces Allocate
     C                     EXSR SWRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0144           Quantity Alloca
     C                     Z-ADD*ZERO     WN0145           Weight Allocate
     C                     Z-ADD*ZERO     P1CCQT           Quantity Schedu
     C                     Z-ADD*ZERO     P1AUWG           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     P1CCQT           Quantity Schedu
     C                     ADD  *ZERO     P1AUWG           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           1         IFLT *ZERO                      *IF
     C           1         MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0143           Company Number
     C                     Z-ADDYL0008    WL0144           Post to G/L Dat
     C                     Z-ADDYL0008    WL0146           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0147           *Duration (fact
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0145    YL0008           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           1         IFGT *ZERO                      *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0148           Company Number
     C                     Z-ADDYL0008    WL0149           Post to G/L Dat
     C                     Z-ADDYL0008    WL0151           *Date2 (beginni
     C                     Z-ADD1         WL0152           *Duration (fact
     C                     EXSR TDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0150    YL0008           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           1         IFEQ *ZERO                      *IF
     C                     Z-ADDYL0008    YL0008           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           P1AVQT    SUB  P1CCQT    P1HWQT           ATS Quantity Ne
     C           P1D0WG    SUB  P1AUWG    P1ENWG           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
     C           P1AVQT    SUB  P1CCQT    P1HWQT           ATS Quantity Ne
     C           P1D0WG    SUB  P1AUWG    P1ENWG           ATS Weight Need
     C                     END                             *FI
      * FROZEN - allocate backwards - new for FP1054
      * CASE: PAR.Warehouse Type is Frozen
     C           P3WPST    IFEQ 'FZ'                       *IF
     C                     MOVEL'B'       YL0012           Allocation Meth
      * Chilling Time
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           P3T1ST    IFEQ 'Y'                        *IF
     C                     Z-ADDP3DBNB    WN0147           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP2CHTM    WN0147           Chilling Time U
     C                     END                             *FI
     C                     Z-ADDYL0003    YL0013           Production Date
      * DOC:  Allocation
     C                     EXSR UCSUBR                     DOC:  Allocatio
      * CASE: LCL.Allocation Method USR is Backward
     C           YL0012    IFEQ 'B'                        *IF
      * For backwards start with the TO date, then -1 day until FROM date
     C                     Z-ADDYL0002    YL0017           Production Date
     C                     Z-ADDYL0003    YL0008           Production Date
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           YL0002    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     YL0008           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           YL0003    IFLT ##JDT                      *IF
     C                     Z-ADDYL0003    YL0013           Production Date
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0003    YL0008           Production Date
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte >= Prd Dte RGF & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date GE LCL.Production Date RGF
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           YL0008    IFGE YL0017                     *IF
     C           P1HWQT    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0064           Company Number
     C                     Z-ADDYL0008    WL0065           Post to G/L Dat
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0066    YL0014    P      Production Day
      * Allocate Production
      * CASE: LCL.Production Day Status is yes
     C           YL0014    IFEQ 'Y'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           YL0008    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0140           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0073           Company Number
     C                     MOVELWN0140    WL0074    P      Production Type
     C                     Z-ADDYL0008    WL0075           Production Date
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0076    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0140           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           YL0008    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0140           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use Production Warehouse and Acctng instead of par.warehou
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0011    WL0077           Company Number
     C                     MOVELWN0140    WL0078    P      Production Type
     C                     Z-ADDYL0008    WL0079           Production Date
     C                     Z-ADDP1HGCD    WL0080           Item Code
     C                     MOVELYL0010    WL0081    P      Warehouse Code
     C                     Z-ADDWN0142    WL0083           ATS Weight Avai
     C                     Z-ADDWN0143    WL0084           ATS Pieces Avai
     C                     Z-ADDWN0147    WL0085           Chilling Time U
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0082    WN0148           PS Avg Piece Wg
     C                     Z-ADDWL0083    WN0142           ATS Weight Avai
     C                     Z-ADDWL0084    WN0143           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2PCCT    IFEQ 'Y'                        *IF
     C           P2BDNB    IFGT *ZERO                      *IF
     C           P2BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           P2BDNB    MULT P2BJNB    W0WJ01           *Synon (15,0) w
     C           WN0143    DIV  W0WJ01    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0141           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2PCCT    IFEQ *BLANK                     *IF
     C           P2PCCT    OREQ 'N'
     C           P1AIWG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0142    DIV  P1AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0141           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0141           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           P1QJST    IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0141    IFLT P1HWQT                     *IF
     C                     Z-ADDP1HWQT    WN0141           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0141    IFGT *ZERO                      *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           P1HWQT    IFGT WN0141                     *IF
     C                     ADD  WN0141    P1CCQT           Quantity Schedu
     C           WN0141    MULT P1AIWG    WN0142           ATS Weight Avai
     C                     ADD  WN0142    P1AUWG           Weight Schedule
     C                     Z-ADDWN0142    WN0145           Weight Allocate
     C                     Z-ADDWN0141    WN0144           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           P1HWQT    IFLE WN0141                     *IF
     C                     ADD  P1HWQT    P1CCQT           Quantity Schedu
     C           P1HWQT    MULT P1AIWG    P1ENWG    H      ATS Weight Need
     C                     ADD  P1ENWG    P1AUWG           Weight Schedule
     C                     Z-ADDP1ENWG    WN0145           Weight Allocate
     C                     Z-ADDP1HWQT    WN0144           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0144    IFGT *ZERO                      *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0086           Company Number
     C                     Z-ADDP1C4NB    WL0087           Order Number
     C                     Z-ADDP1DPNB    WL0088           Order Sequence
     C                     Z-ADDP1UENB    WL0089           Order Secondary
     C                     Z-ADDYL0008    WL0090           OD Production D
     C                     Z-ADDP1HLDT    WL0091           Scheduled Ship
     C                     MOVELP1AJCD    WL0092    P      Warehouse Code
     C                     MOVELP1AJCD    WL0093    P      Order From Ware
     C                     Z-ADDP1HGCD    WL0094           Item Code
     C                     Z-ADDWN0145    WL0095           Weight Allocate
     C                     Z-ADDWN0144    WL0096           Quantity Alloca
     C                     MOVELP2QZCD    WL0097    P      Base/Conv/Loss
     C                     EXSR SURVGN
      * CASE: PAR.Piece Count Item is yes
     C           P2PCCT    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           WN0144    MULT P2BDNB    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P2BJNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0146           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0146    MULT WN0148    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0145           Weight Allocate
     C                     END                             *FI
      * FP1054 Use Production Warehouse and Acctng instead of par.warehou
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0011    WL0098           Company Number
     C                     MOVELWN0140    WL0099    P      Production Type
     C                     Z-ADDYL0008    WL0100           Production Date
     C                     Z-ADDP1HGCD    WL0101           Item Code
     C                     MOVELYL0010    WL0102    P      Warehouse Code
     C                     Z-ADDWN0145    WL0103           Weight Allocate
     C                     Z-ADDWN0146    WL0104           Pieces Allocate
     C                     EXSR SWRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0144           Quantity Alloca
     C                     Z-ADD*ZERO     WN0145           Weight Allocate
     C                     Z-ADD*ZERO     P1CCQT           Quantity Schedu
     C                     Z-ADD*ZERO     P1AUWG           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     P1CCQT           Quantity Schedu
     C                     ADD  *ZERO     P1AUWG           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 -  subtract 1 day to go backwards
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           -1        IFLT *ZERO                      *IF
     C           -1        MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0143           Company Number
     C                     Z-ADDYL0008    WL0144           Post to G/L Dat
     C                     Z-ADDYL0008    WL0146           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0147           *Duration (fact
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0145    YL0008           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           -1        IFGT *ZERO                      *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0148           Company Number
     C                     Z-ADDYL0008    WL0149           Post to G/L Dat
     C                     Z-ADDYL0008    WL0151           *Date2 (beginni
     C                     Z-ADD-1        WL0152           *Duration (fact
     C                     EXSR TDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0150    YL0008           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           -1        IFEQ *ZERO                      *IF
     C                     Z-ADDYL0008    YL0008           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           P1AVQT    SUB  P1CCQT    P1HWQT           ATS Quantity Ne
     C           P1D0WG    SUB  P1AUWG    P1ENWG           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
     C           P1AVQT    SUB  P1CCQT    P1HWQT           ATS Quantity Ne
     C           P1D0WG    SUB  P1AUWG    P1ENWG           ATS Weight Need
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Warehouse Type is Fresh
     C           P3WPST    IFEQ 'FR'                       *IF
      * Schedule As Order or Order Allocate
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           P1QJST    IFEQ 'AO'                       *IF
      * 06/18/04 Still need to check inventory before scheduling
      *          production as ordered.
      * Only allocate inventory order placed during current week
      * CASE: PAR.Production Date LE PAR.Week End Date        USR
     C           P1ELDT    IFLE P1LIDT                     *IF
      * CLC PA Age Limits      IF
     C                     Z-ADD*ZERO     WUDNBU           Day NBR USR
      * 04/10/07 Effective 04/23/07 representation of Age Code changes
      *          will be such that Age Code A will be 0 day for boxes
      *          and combos.  The labels on the cartons will not print
      *          a date that is offset by Sunday or Holiday.  Instead of
      *          Code Date, it will be the Pack Date.
      * Production Date RGT and Production Date RGF
      * CASE: PAR.Chilling Time is Not Entered
     C           P2CHTM    IFEQ *ZERO                      *IF
     C                     Z-ADDP1HLDT    YL0003           Production Date
      * Production Date RGF
      * CASE: PAR.Age Code is A: 0 Day
     C           P6FWST    IFEQ 'A'                        *IF
     C                     Z-ADDYL0003    YL0002           Production Date
     C                     ELSE
      * CASE: PAR.Age Code is B: 1 Day
     C           P6FWST    IFEQ 'B'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-1 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is C: 2 Day
     C           P6FWST    IFEQ 'C'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-2 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-2        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is D: 3 Day
     C           P6FWST    IFEQ 'D'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-3 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-3        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is E: 4 Day
     C           P6FWST    IFEQ 'E'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-4 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-4        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is F: 5 Day
     C           P6FWST    IFEQ 'F'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-5 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-5        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is G: 6 Day
     C           P6FWST    IFEQ 'G'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-6 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-6        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Age Code is H: 7 Days to 119 Days
      *   |- c2    : PAR.Age Code is I: 120 Days +
      *   '-
     C           P6FWST    IFEQ 'H'                        *IF
     C           P6FWST    OREQ 'I'                        *OR
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-365 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-365      XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C           P2CHTM    MULT -1        YL0001           Fresh Chilling
      * PAR.Production Date RGT = PAR.Ship Date USR + LCL.Fresh Chilling
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDYL0001    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111110' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0003
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0003
     C                     END
      * Production Date RGF
      * CASE: PAR.Age Code is A: 0 Day
     C           P6FWST    IFEQ 'A'                        *IF
      * 04/10/07 PKD We should not have chilled orders with A Age Code.
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-1 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is B: 1 Day
     C           P6FWST    IFEQ 'B'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-1 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is C: 2 Day
     C           P6FWST    IFEQ 'C'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-2 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-2        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is D: 3 Day
     C           P6FWST    IFEQ 'D'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-3 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-3        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is E: 4 Day
     C           P6FWST    IFEQ 'E'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-4 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-4        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is F: 5 Day
     C           P6FWST    IFEQ 'F'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-5 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-5        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is G: 6 Day
     C           P6FWST    IFEQ 'G'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-6 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-6        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Age Code is H: 7 Days to 119 Days
      *   |- c2    : PAR.Age Code is I: 120 Days +
      *   '-
     C           P6FWST    IFEQ 'H'                        *IF
     C           P6FWST    OREQ 'I'                        *OR
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-365 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-365      XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0349 110       ATS Quantity Av
     C                     Z-ADD*ZERO     WN0350 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0351 112       Quantity Alloca
     C                     Z-ADD*ZERO     WN0352  92       Weight Allocate
      *
      * UPD Allocate Inv      IF
      * Allocate Inventory
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Production Date RGF LT JOB.*Job date
      *   |- c2    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0002    IFLT ##JDT                      *IF
     C           P1HWQT    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * UPD Allocate Inv      RT - PS Prod Item Inventory  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0015           Company Number
     C                     Z-ADDP1HGCD    WL0016           Item Code
     C                     MOVELP1AJCD    WL0017    P      Warehouse Code
     C                     Z-ADDYL0002    WL0018           Production Date
     C                     Z-ADDP1AIWG    WL0019           Unit Weight
     C                     MOVELP2PCCT    WL0020    P      Piece Count Ite
     C                     Z-ADDP2BDNB    WL0021           Pieces Per Bag
     C                     Z-ADDP2BJNB    WL0022           Bags Per Unit
     C                     Z-ADDP1C4NB    WL0023           Order Number
     C                     Z-ADDP1DPNB    WL0024           Order Sequence
     C                     Z-ADDP1UENB    WL0025           Order Secondary
     C                     Z-ADDP1AVQT    WL0026           Quantity Ordere
     C                     Z-ADDP1D0WG    WL0027           Weight Ordered
     C                     Z-ADDP1CCQT    WL0028           Quantity Schedu
     C                     Z-ADDP1AUWG    WL0029           Weight Schedule
     C                     Z-ADDP1HWQT    WL0030           ATS Quantity Ne
     C                     Z-ADDP1ENWG    WL0031           ATS Weight Need
     C                     Z-ADDP1HLDT    WL0032           Ship Date USR
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0028    P1CCQT           Quantity Schedu
     C                     Z-ADDWL0029    P1AUWG           Weight Schedule
     C                     Z-ADDWL0030    P1HWQT           ATS Quantity Ne
     C                     Z-ADDWL0031    P1ENWG           ATS Weight Need
     C                     END                             *FI
     C                     END                             *FI
      * Ship Off Cut orders that still have not shipped.
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           P1GWDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     P1GWDT           Production Date
     C                     Z-ADDP1GWDT    P1ELDT           Production Date
     C                     Z-ADDP1GWDT    P1GVDT           Production Date
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0064           Company Number
     C                     Z-ADDP1GWDT    WL0065           Post to G/L Dat
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0066    YL0009    P      Production Day
      * CASE: LCL.Production Day Status is no
     C           YL0009    IFEQ 'N'                        *IF
      * Rtv Prev Prd Dte      RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0067           Company Number
     C                     Z-ADDP1GWDT    WL0068           Post to G/L Dat
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0069    P1GWDT           Production Date
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Production Date RGT GE PAR.Production Date RGF
     C           P1GWDT    IFGE P1GVDT                     *IF
     C                     Z-ADDP1GWDT    P1GVDT           Production Date
      * Allocate Production or Standard
      * CASE: PAR.Base/Conv/Loss Item is Base
     C           P2QZCD    IFEQ 'B'                        *IF
      *
     C                     MOVEL*BLANK    WN0353  1        Production Type
     C                     Z-ADD*ZERO     WN0354 110       ATS Quantity Av
     C                     Z-ADD*ZERO     WN0355 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0356  70       ATS Pieces Avai
     C                     Z-ADD*ZERO     WN0357 112       Quantity Alloca
     C                     Z-ADD*ZERO     WN0358  92       Weight Allocate
     C                     Z-ADD*ZERO     WN0359  70       Pieces Allocate
     C                     Z-ADD*ZERO     WN0360  52       Chilling Time U
     C                     Z-ADD*ZERO     WN0361  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0362  52       Production Yiel
     C                     Z-ADD*ZERO     WN0363  70       SM Pieces Need
     C                     Z-ADD*ZERO     WN0364 112       SM Weight Need
      *
      * UPD Allocate Prd      IF
      * FP1054 Added CASE stmts for Fresh and Frozen- frozen is alloc bac
      *      When getting Production or Standard numbers, then
      *      Use Production Warehouse and Acctng Co for Order's Warehouse
      * Rtv Productin Whs     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1AJCD    WL0070    P      Warehouse Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0071    YL0010    P      Production Ware
     C                     Z-ADDWL0072    YL0011           Accounting Comp
      * FRESH - original code is in this CASE - alloc forward
      * CASE: PAR.Warehouse Type is Fresh
     C           P3WPST    IFEQ 'FR'                       *IF
     C                     MOVEL'F'       YL0012           Allocation Meth
      * Chilling Time
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           P3T1ST    IFEQ 'Y'                        *IF
     C                     Z-ADDP3DBNB    WN0360           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP2CHTM    WN0360           Chilling Time U
     C                     END                             *FI
     C                     Z-ADDP1GWDT    YL0013           Production Date
      * DOC:  Allocation
     C                     EXSR UDSUBR                     DOC:  Allocatio
      * CASE: LCL.Allocation Method USR is Forward
     C           YL0012    IFEQ 'F'                        *IF
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           P1GVDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     P1ELDT           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           P1GWDT    IFLT ##JDT                      *IF
     C                     Z-ADDP1GWDT    YL0013           Production Date
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1GVDT    P1ELDT           Production Date
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte <= Prd Dte RGT & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date LE LCL.Production Date To
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           P1ELDT    IFLE YL0013                     *IF
     C           P1HWQT    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0064           Company Number
     C                     Z-ADDP1ELDT    WL0065           Post to G/L Dat
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0066    YL0014    P      Production Day
      * Allocate Production
      * CASE: LCL.Production Day Status is yes
     C           YL0014    IFEQ 'Y'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           P1ELDT    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0353           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0073           Company Number
     C                     MOVELWN0353    WL0074    P      Production Type
     C                     Z-ADDP1ELDT    WL0075           Production Date
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0076    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0353           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           P1ELDT    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0353           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use Production Warehouse and Acctng instead of par.warehou
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0011    WL0077           Company Number
     C                     MOVELWN0353    WL0078    P      Production Type
     C                     Z-ADDP1ELDT    WL0079           Production Date
     C                     Z-ADDP1HGCD    WL0080           Item Code
     C                     MOVELYL0010    WL0081    P      Warehouse Code
     C                     Z-ADDWN0355    WL0083           ATS Weight Avai
     C                     Z-ADDWN0356    WL0084           ATS Pieces Avai
     C                     Z-ADDWN0360    WL0085           Chilling Time U
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0082    WN0361           PS Avg Piece Wg
     C                     Z-ADDWL0083    WN0355           ATS Weight Avai
     C                     Z-ADDWL0084    WN0356           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2PCCT    IFEQ 'Y'                        *IF
     C           P2BDNB    IFGT *ZERO                      *IF
     C           P2BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           P2BDNB    MULT P2BJNB    W0WJ01           *Synon (15,0) w
     C           WN0356    DIV  W0WJ01    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0354           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2PCCT    IFEQ *BLANK                     *IF
     C           P2PCCT    OREQ 'N'
     C           P1AIWG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0355    DIV  P1AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0354           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0354           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           P1QJST    IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0354    IFLT P1HWQT                     *IF
     C                     Z-ADDP1HWQT    WN0354           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0354    IFGT *ZERO                      *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           P1HWQT    IFGT WN0354                     *IF
     C                     ADD  WN0354    P1CCQT           Quantity Schedu
     C           WN0354    MULT P1AIWG    WN0355           ATS Weight Avai
     C                     ADD  WN0355    P1AUWG           Weight Schedule
     C                     Z-ADDWN0355    WN0358           Weight Allocate
     C                     Z-ADDWN0354    WN0357           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           P1HWQT    IFLE WN0354                     *IF
     C                     ADD  P1HWQT    P1CCQT           Quantity Schedu
     C           P1HWQT    MULT P1AIWG    P1ENWG    H      ATS Weight Need
     C                     ADD  P1ENWG    P1AUWG           Weight Schedule
     C                     Z-ADDP1ENWG    WN0358           Weight Allocate
     C                     Z-ADDP1HWQT    WN0357           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0357    IFGT *ZERO                      *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0086           Company Number
     C                     Z-ADDP1C4NB    WL0087           Order Number
     C                     Z-ADDP1DPNB    WL0088           Order Sequence
     C                     Z-ADDP1UENB    WL0089           Order Secondary
     C                     Z-ADDP1ELDT    WL0090           OD Production D
     C                     Z-ADDP1HLDT    WL0091           Scheduled Ship
     C                     MOVELP1AJCD    WL0092    P      Warehouse Code
     C                     MOVELP1AJCD    WL0093    P      Order From Ware
     C                     Z-ADDP1HGCD    WL0094           Item Code
     C                     Z-ADDWN0358    WL0095           Weight Allocate
     C                     Z-ADDWN0357    WL0096           Quantity Alloca
     C                     MOVELP2QZCD    WL0097    P      Base/Conv/Loss
     C                     EXSR SURVGN
      * CASE: PAR.Piece Count Item is yes
     C           P2PCCT    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           WN0357    MULT P2BDNB    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P2BJNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0359           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0359    MULT WN0361    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0358           Weight Allocate
     C                     END                             *FI
      * FP1054 Upd production by Production Warehouse, Acctng Co
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0011    WL0098           Company Number
     C                     MOVELWN0353    WL0099    P      Production Type
     C                     Z-ADDP1ELDT    WL0100           Production Date
     C                     Z-ADDP1HGCD    WL0101           Item Code
     C                     MOVELYL0010    WL0102    P      Warehouse Code
     C                     Z-ADDWN0358    WL0103           Weight Allocate
     C                     Z-ADDWN0359    WL0104           Pieces Allocate
     C                     EXSR SWRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0357           Quantity Alloca
     C                     Z-ADD*ZERO     WN0358           Weight Allocate
     C                     Z-ADD*ZERO     P1CCQT           Quantity Schedu
     C                     Z-ADD*ZERO     P1AUWG           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     P1CCQT           Quantity Schedu
     C                     ADD  *ZERO     P1AUWG           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           1         IFLT *ZERO                      *IF
     C           1         MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0143           Company Number
     C                     Z-ADDP1ELDT    WL0144           Post to G/L Dat
     C                     Z-ADDP1ELDT    WL0146           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0147           *Duration (fact
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0145    P1ELDT           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           1         IFGT *ZERO                      *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0148           Company Number
     C                     Z-ADDP1ELDT    WL0149           Post to G/L Dat
     C                     Z-ADDP1ELDT    WL0151           *Date2 (beginni
     C                     Z-ADD1         WL0152           *Duration (fact
     C                     EXSR TDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0150    P1ELDT           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           1         IFEQ *ZERO                      *IF
     C                     Z-ADDP1ELDT    P1ELDT           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           P1AVQT    SUB  P1CCQT    P1HWQT           ATS Quantity Ne
     C           P1D0WG    SUB  P1AUWG    P1ENWG           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
     C           P1AVQT    SUB  P1CCQT    P1HWQT           ATS Quantity Ne
     C           P1D0WG    SUB  P1AUWG    P1ENWG           ATS Weight Need
     C                     END                             *FI
      * FROZEN - allocate backwards - new for FP1054
      * CASE: PAR.Warehouse Type is Frozen
     C           P3WPST    IFEQ 'FZ'                       *IF
     C                     MOVEL'B'       YL0012           Allocation Meth
      * Chilling Time
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           P3T1ST    IFEQ 'Y'                        *IF
     C                     Z-ADDP3DBNB    WN0360           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP2CHTM    WN0360           Chilling Time U
     C                     END                             *FI
     C                     Z-ADDP1GWDT    YL0013           Production Date
      * DOC:  Allocation
     C                     EXSR UESUBR                     DOC:  Allocatio
      * CASE: LCL.Allocation Method USR is Backward
     C           YL0012    IFEQ 'B'                        *IF
      * For backwards start with the TO date, then -1 day until FROM date
     C                     Z-ADDP1GVDT    YL0017           Production Date
     C                     Z-ADDP1GWDT    P1ELDT           Production Date
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           P1GVDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     P1ELDT           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           P1GWDT    IFLT ##JDT                      *IF
     C                     Z-ADDP1GWDT    YL0013           Production Date
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1GWDT    P1ELDT           Production Date
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte >= Prd Dte RGF & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date GE LCL.Production Date RGF
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           P1ELDT    IFGE YL0017                     *IF
     C           P1HWQT    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0064           Company Number
     C                     Z-ADDP1ELDT    WL0065           Post to G/L Dat
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0066    YL0014    P      Production Day
      * Allocate Production
      * CASE: LCL.Production Day Status is yes
     C           YL0014    IFEQ 'Y'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           P1ELDT    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0353           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0073           Company Number
     C                     MOVELWN0353    WL0074    P      Production Type
     C                     Z-ADDP1ELDT    WL0075           Production Date
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0076    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0353           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           P1ELDT    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0353           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use Production Warehouse and Acctng instead of par.warehou
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0011    WL0077           Company Number
     C                     MOVELWN0353    WL0078    P      Production Type
     C                     Z-ADDP1ELDT    WL0079           Production Date
     C                     Z-ADDP1HGCD    WL0080           Item Code
     C                     MOVELYL0010    WL0081    P      Warehouse Code
     C                     Z-ADDWN0355    WL0083           ATS Weight Avai
     C                     Z-ADDWN0356    WL0084           ATS Pieces Avai
     C                     Z-ADDWN0360    WL0085           Chilling Time U
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0082    WN0361           PS Avg Piece Wg
     C                     Z-ADDWL0083    WN0355           ATS Weight Avai
     C                     Z-ADDWL0084    WN0356           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2PCCT    IFEQ 'Y'                        *IF
     C           P2BDNB    IFGT *ZERO                      *IF
     C           P2BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           P2BDNB    MULT P2BJNB    W0WJ01           *Synon (15,0) w
     C           WN0356    DIV  W0WJ01    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0354           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2PCCT    IFEQ *BLANK                     *IF
     C           P2PCCT    OREQ 'N'
     C           P1AIWG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0355    DIV  P1AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0354           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0354           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           P1QJST    IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0354    IFLT P1HWQT                     *IF
     C                     Z-ADDP1HWQT    WN0354           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0354    IFGT *ZERO                      *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           P1HWQT    IFGT WN0354                     *IF
     C                     ADD  WN0354    P1CCQT           Quantity Schedu
     C           WN0354    MULT P1AIWG    WN0355           ATS Weight Avai
     C                     ADD  WN0355    P1AUWG           Weight Schedule
     C                     Z-ADDWN0355    WN0358           Weight Allocate
     C                     Z-ADDWN0354    WN0357           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           P1HWQT    IFLE WN0354                     *IF
     C                     ADD  P1HWQT    P1CCQT           Quantity Schedu
     C           P1HWQT    MULT P1AIWG    P1ENWG    H      ATS Weight Need
     C                     ADD  P1ENWG    P1AUWG           Weight Schedule
     C                     Z-ADDP1ENWG    WN0358           Weight Allocate
     C                     Z-ADDP1HWQT    WN0357           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0357    IFGT *ZERO                      *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0086           Company Number
     C                     Z-ADDP1C4NB    WL0087           Order Number
     C                     Z-ADDP1DPNB    WL0088           Order Sequence
     C                     Z-ADDP1UENB    WL0089           Order Secondary
     C                     Z-ADDP1ELDT    WL0090           OD Production D
     C                     Z-ADDP1HLDT    WL0091           Scheduled Ship
     C                     MOVELP1AJCD    WL0092    P      Warehouse Code
     C                     MOVELP1AJCD    WL0093    P      Order From Ware
     C                     Z-ADDP1HGCD    WL0094           Item Code
     C                     Z-ADDWN0358    WL0095           Weight Allocate
     C                     Z-ADDWN0357    WL0096           Quantity Alloca
     C                     MOVELP2QZCD    WL0097    P      Base/Conv/Loss
     C                     EXSR SURVGN
      * CASE: PAR.Piece Count Item is yes
     C           P2PCCT    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           WN0357    MULT P2BDNB    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P2BJNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0359           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0359    MULT WN0361    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0358           Weight Allocate
     C                     END                             *FI
      * FP1054 Use Production Warehouse and Acctng instead of par.warehou
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0011    WL0098           Company Number
     C                     MOVELWN0353    WL0099    P      Production Type
     C                     Z-ADDP1ELDT    WL0100           Production Date
     C                     Z-ADDP1HGCD    WL0101           Item Code
     C                     MOVELYL0010    WL0102    P      Warehouse Code
     C                     Z-ADDWN0358    WL0103           Weight Allocate
     C                     Z-ADDWN0359    WL0104           Pieces Allocate
     C                     EXSR SWRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0357           Quantity Alloca
     C                     Z-ADD*ZERO     WN0358           Weight Allocate
     C                     Z-ADD*ZERO     P1CCQT           Quantity Schedu
     C                     Z-ADD*ZERO     P1AUWG           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     P1CCQT           Quantity Schedu
     C                     ADD  *ZERO     P1AUWG           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 -  subtract 1 day to go backwards
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           -1        IFLT *ZERO                      *IF
     C           -1        MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0143           Company Number
     C                     Z-ADDP1ELDT    WL0144           Post to G/L Dat
     C                     Z-ADDP1ELDT    WL0146           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0147           *Duration (fact
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0145    P1ELDT           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           -1        IFGT *ZERO                      *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0148           Company Number
     C                     Z-ADDP1ELDT    WL0149           Post to G/L Dat
     C                     Z-ADDP1ELDT    WL0151           *Date2 (beginni
     C                     Z-ADD-1        WL0152           *Duration (fact
     C                     EXSR TDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0150    P1ELDT           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           -1        IFEQ *ZERO                      *IF
     C                     Z-ADDP1ELDT    P1ELDT           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           P1AVQT    SUB  P1CCQT    P1HWQT           ATS Quantity Ne
     C           P1D0WG    SUB  P1AUWG    P1ENWG           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
     C           P1AVQT    SUB  P1CCQT    P1HWQT           ATS Quantity Ne
     C           P1D0WG    SUB  P1AUWG    P1ENWG           ATS Weight Need
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Base/Conv/Loss Item is Converted/Fabricated
     C           P2QZCD    IFEQ 'C'                        *IF
     C           P2QZCD    OREQ 'F'
      * UPD Allocate Std      XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDHMXFR'              90  UPD Allocate St
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AJCD    WQ0001  3        Warehouse Code
     C                     PARM P1AIC3    WQ0002  30       Company Number
     C                     PARM P1HGCD    WQ0003  70       Item Code
     C           P1ELDT    PARM P1ELDT    WQ0004  70       Production Date
     C                     PARM P2ADCD    WQ0005  2        U/M - Primary
     C                     PARM P1AIWG    WQ0006 112       Unit Weight
     C                     PARM P2CHTM    WQ0007  52       Fresh Chilling
     C                     PARM P2PCCT    WQ0008  1        Piece Count Ite
     C                     PARM P2BDNB    WQ0009  70       Pieces Per Bag
     C                     PARM P2BJNB    WQ0010  70       Bags Per Unit
     C                     PARM P3WPST    WQ0011  2        Warehouse Type
     C                     PARM P3T1ST    WQ0012  1        Warehouse Std C
     C                     PARM P3DBNB    WQ0013  52       Warehouse Chill
     C                     PARM P1C4NB    WQ0014  70       Order Number
     C                     PARM P1DPNB    WQ0015  30       Order Sequence
     C                     PARM P1UENB    WQ0016  30       Order Secondary
     C                     PARM P1GVDT    WQ0017  70       Production Date
     C                     PARM P1GWDT    WQ0018  70       Production Date
     C                     PARM P1AVQT    WQ0019 112       Quantity Ordere
     C                     PARM P1D0WG    WQ0020 112       Weight Ordered
     C           P1CCQT    PARM P1CCQT    WQ0021 112       Quantity Schedu
     C           P1AUWG    PARM P1AUWG    WQ0022 112       Weight Schedule
     C           P1HWQT    PARM P1HWQT    WQ0023 112       ATS Quantity Ne
     C           P1ENWG    PARM P1ENWG    WQ0024 112       ATS Weight Need
     C                     PARM P1RPCD    WQ0025  1        Age Code
     C                     PARM P1HLDT    WQ0026  70       Ship Date USR
     C                     PARM P1QJST    WQ0027  2        ATS Adj Type US
     C                     PARM P1BXVN    WQ0028 10        PSAA Program Na
     C                     PARM P4AYAA    WQ0029  3        Order From Ware
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Only allocate inventory order placed during current week
      * CASE: PAR.Production Date LE PAR.Week End Date        USR
     C           P1ELDT    IFLE P1LIDT                     *IF
      * CLC PA Age Limits      IF
     C                     Z-ADD*ZERO     WUDNBU           Day NBR USR
      * 04/10/07 Effective 04/23/07 representation of Age Code changes
      *          will be such that Age Code A will be 0 day for boxes
      *          and combos.  The labels on the cartons will not print
      *          a date that is offset by Sunday or Holiday.  Instead of
      *          Code Date, it will be the Pack Date.
      * Production Date RGT and Production Date RGF
      * CASE: PAR.Chilling Time is Not Entered
     C           P2CHTM    IFEQ *ZERO                      *IF
     C                     Z-ADDP1HLDT    YL0003           Production Date
      * Production Date RGF
      * CASE: PAR.Age Code is A: 0 Day
     C           P6FWST    IFEQ 'A'                        *IF
     C                     Z-ADDYL0003    YL0002           Production Date
     C                     ELSE
      * CASE: PAR.Age Code is B: 1 Day
     C           P6FWST    IFEQ 'B'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-1 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is C: 2 Day
     C           P6FWST    IFEQ 'C'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-2 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-2        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is D: 3 Day
     C           P6FWST    IFEQ 'D'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-3 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-3        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is E: 4 Day
     C           P6FWST    IFEQ 'E'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-4 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-4        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is F: 5 Day
     C           P6FWST    IFEQ 'F'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-5 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-5        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is G: 6 Day
     C           P6FWST    IFEQ 'G'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-6 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-6        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Age Code is H: 7 Days to 119 Days
      *   |- c2    : PAR.Age Code is I: 120 Days +
      *   '-
     C           P6FWST    IFEQ 'H'                        *IF
     C           P6FWST    OREQ 'I'                        *OR
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-365 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-365      XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C           P2CHTM    MULT -1        YL0001           Fresh Chilling
      * PAR.Production Date RGT = PAR.Ship Date USR + LCL.Fresh Chilling
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDYL0001    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111110' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0003
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0003
     C                     END
      * Production Date RGF
      * CASE: PAR.Age Code is A: 0 Day
     C           P6FWST    IFEQ 'A'                        *IF
      * 04/10/07 PKD We should not have chilled orders with A Age Code.
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-1 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is B: 1 Day
     C           P6FWST    IFEQ 'B'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-1 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is C: 2 Day
     C           P6FWST    IFEQ 'C'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-2 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-2        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is D: 3 Day
     C           P6FWST    IFEQ 'D'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-3 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-3        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is E: 4 Day
     C           P6FWST    IFEQ 'E'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-4 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-4        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is F: 5 Day
     C           P6FWST    IFEQ 'F'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-5 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-5        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE: PAR.Age Code is G: 6 Day
     C           P6FWST    IFEQ 'G'                        *IF
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-6 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-6        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     ELSE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Age Code is H: 7 Days to 119 Days
      *   |- c2    : PAR.Age Code is I: 120 Days +
      *   '-
     C           P6FWST    IFEQ 'H'                        *IF
     C           P6FWST    OREQ 'I'                        *OR
      * PAR.Production Date RGF = PAR.Ship Date USR + CON.-365 *DAYS
     C           P1HLDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-365      XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0002
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0002
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0365 110       ATS Quantity Av
     C                     Z-ADD*ZERO     WN0366 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0367 112       Quantity Alloca
     C                     Z-ADD*ZERO     WN0368  92       Weight Allocate
      *
      * UPD Allocate Inv      IF
      * Allocate Inventory
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Production Date RGF LT JOB.*Job date
      *   |- c2    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0002    IFLT ##JDT                      *IF
     C           P1HWQT    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * UPD Allocate Inv      RT - PS Prod Item Inventory  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0015           Company Number
     C                     Z-ADDP1HGCD    WL0016           Item Code
     C                     MOVELP1AJCD    WL0017    P      Warehouse Code
     C                     Z-ADDYL0002    WL0018           Production Date
     C                     Z-ADDP1AIWG    WL0019           Unit Weight
     C                     MOVELP2PCCT    WL0020    P      Piece Count Ite
     C                     Z-ADDP2BDNB    WL0021           Pieces Per Bag
     C                     Z-ADDP2BJNB    WL0022           Bags Per Unit
     C                     Z-ADDP1C4NB    WL0023           Order Number
     C                     Z-ADDP1DPNB    WL0024           Order Sequence
     C                     Z-ADDP1UENB    WL0025           Order Secondary
     C                     Z-ADDP1AVQT    WL0026           Quantity Ordere
     C                     Z-ADDP1D0WG    WL0027           Weight Ordered
     C                     Z-ADDP1CCQT    WL0028           Quantity Schedu
     C                     Z-ADDP1AUWG    WL0029           Weight Schedule
     C                     Z-ADDP1HWQT    WL0030           ATS Quantity Ne
     C                     Z-ADDP1ENWG    WL0031           ATS Weight Need
     C                     Z-ADDP1HLDT    WL0032           Ship Date USR
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0028    P1CCQT           Quantity Schedu
     C                     Z-ADDWL0029    P1AUWG           Weight Schedule
     C                     Z-ADDWL0030    P1HWQT           ATS Quantity Ne
     C                     Z-ADDWL0031    P1ENWG           ATS Weight Need
     C                     END                             *FI
     C                     END                             *FI
      * Allocate Production or Standard
      * CASE: PAR.Base/Conv/Loss Item is Base
     C           P2QZCD    IFEQ 'B'                        *IF
      *
     C                     MOVEL*BLANK    WN0369  1        Production Type
     C                     Z-ADD*ZERO     WN0370 110       ATS Quantity Av
     C                     Z-ADD*ZERO     WN0371 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0372  70       ATS Pieces Avai
     C                     Z-ADD*ZERO     WN0373 112       Quantity Alloca
     C                     Z-ADD*ZERO     WN0374  92       Weight Allocate
     C                     Z-ADD*ZERO     WN0375  70       Pieces Allocate
     C                     Z-ADD*ZERO     WN0376  52       Chilling Time U
     C                     Z-ADD*ZERO     WN0377  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0378  52       Production Yiel
     C                     Z-ADD*ZERO     WN0379  70       SM Pieces Need
     C                     Z-ADD*ZERO     WN0380 112       SM Weight Need
      *
      * UPD Allocate Prd      IF
      * FP1054 Added CASE stmts for Fresh and Frozen- frozen is alloc bac
      *      When getting Production or Standard numbers, then
      *      Use Production Warehouse and Acctng Co for Order's Warehouse
      * Rtv Productin Whs     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1AJCD    WL0070    P      Warehouse Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0071    YL0010    P      Production Ware
     C                     Z-ADDWL0072    YL0011           Accounting Comp
      * FRESH - original code is in this CASE - alloc forward
      * CASE: PAR.Warehouse Type is Fresh
     C           P3WPST    IFEQ 'FR'                       *IF
     C                     MOVEL'F'       YL0012           Allocation Meth
      * Chilling Time
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           P3T1ST    IFEQ 'Y'                        *IF
     C                     Z-ADDP3DBNB    WN0376           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP2CHTM    WN0376           Chilling Time U
     C                     END                             *FI
     C                     Z-ADDP1GWDT    YL0013           Production Date
      * DOC:  Allocation
     C                     EXSR UFSUBR                     DOC:  Allocatio
      * CASE: LCL.Allocation Method USR is Forward
     C           YL0012    IFEQ 'F'                        *IF
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           P1GVDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     P1ELDT           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           P1GWDT    IFLT ##JDT                      *IF
     C                     Z-ADDP1GWDT    YL0013           Production Date
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1GVDT    P1ELDT           Production Date
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte <= Prd Dte RGT & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date LE LCL.Production Date To
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           P1ELDT    IFLE YL0013                     *IF
     C           P1HWQT    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0064           Company Number
     C                     Z-ADDP1ELDT    WL0065           Post to G/L Dat
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0066    YL0014    P      Production Day
      * Allocate Production
      * CASE: LCL.Production Day Status is yes
     C           YL0014    IFEQ 'Y'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           P1ELDT    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0369           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0073           Company Number
     C                     MOVELWN0369    WL0074    P      Production Type
     C                     Z-ADDP1ELDT    WL0075           Production Date
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0076    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0369           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           P1ELDT    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0369           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use Production Warehouse and Acctng instead of par.warehou
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0011    WL0077           Company Number
     C                     MOVELWN0369    WL0078    P      Production Type
     C                     Z-ADDP1ELDT    WL0079           Production Date
     C                     Z-ADDP1HGCD    WL0080           Item Code
     C                     MOVELYL0010    WL0081    P      Warehouse Code
     C                     Z-ADDWN0371    WL0083           ATS Weight Avai
     C                     Z-ADDWN0372    WL0084           ATS Pieces Avai
     C                     Z-ADDWN0376    WL0085           Chilling Time U
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0082    WN0377           PS Avg Piece Wg
     C                     Z-ADDWL0083    WN0371           ATS Weight Avai
     C                     Z-ADDWL0084    WN0372           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2PCCT    IFEQ 'Y'                        *IF
     C           P2BDNB    IFGT *ZERO                      *IF
     C           P2BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           P2BDNB    MULT P2BJNB    W0WJ01           *Synon (15,0) w
     C           WN0372    DIV  W0WJ01    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0370           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2PCCT    IFEQ *BLANK                     *IF
     C           P2PCCT    OREQ 'N'
     C           P1AIWG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0371    DIV  P1AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0370           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0370           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           P1QJST    IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0370    IFLT P1HWQT                     *IF
     C                     Z-ADDP1HWQT    WN0370           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0370    IFGT *ZERO                      *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           P1HWQT    IFGT WN0370                     *IF
     C                     ADD  WN0370    P1CCQT           Quantity Schedu
     C           WN0370    MULT P1AIWG    WN0371           ATS Weight Avai
     C                     ADD  WN0371    P1AUWG           Weight Schedule
     C                     Z-ADDWN0371    WN0374           Weight Allocate
     C                     Z-ADDWN0370    WN0373           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           P1HWQT    IFLE WN0370                     *IF
     C                     ADD  P1HWQT    P1CCQT           Quantity Schedu
     C           P1HWQT    MULT P1AIWG    P1ENWG    H      ATS Weight Need
     C                     ADD  P1ENWG    P1AUWG           Weight Schedule
     C                     Z-ADDP1ENWG    WN0374           Weight Allocate
     C                     Z-ADDP1HWQT    WN0373           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0373    IFGT *ZERO                      *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0086           Company Number
     C                     Z-ADDP1C4NB    WL0087           Order Number
     C                     Z-ADDP1DPNB    WL0088           Order Sequence
     C                     Z-ADDP1UENB    WL0089           Order Secondary
     C                     Z-ADDP1ELDT    WL0090           OD Production D
     C                     Z-ADDP1HLDT    WL0091           Scheduled Ship
     C                     MOVELP1AJCD    WL0092    P      Warehouse Code
     C                     MOVELP1AJCD    WL0093    P      Order From Ware
     C                     Z-ADDP1HGCD    WL0094           Item Code
     C                     Z-ADDWN0374    WL0095           Weight Allocate
     C                     Z-ADDWN0373    WL0096           Quantity Alloca
     C                     MOVELP2QZCD    WL0097    P      Base/Conv/Loss
     C                     EXSR SURVGN
      * CASE: PAR.Piece Count Item is yes
     C           P2PCCT    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           WN0373    MULT P2BDNB    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P2BJNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0375           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0375    MULT WN0377    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0374           Weight Allocate
     C                     END                             *FI
      * FP1054 Upd production by Production Warehouse, Acctng Co
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0011    WL0098           Company Number
     C                     MOVELWN0369    WL0099    P      Production Type
     C                     Z-ADDP1ELDT    WL0100           Production Date
     C                     Z-ADDP1HGCD    WL0101           Item Code
     C                     MOVELYL0010    WL0102    P      Warehouse Code
     C                     Z-ADDWN0374    WL0103           Weight Allocate
     C                     Z-ADDWN0375    WL0104           Pieces Allocate
     C                     EXSR SWRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0373           Quantity Alloca
     C                     Z-ADD*ZERO     WN0374           Weight Allocate
     C                     Z-ADD*ZERO     P1CCQT           Quantity Schedu
     C                     Z-ADD*ZERO     P1AUWG           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     P1CCQT           Quantity Schedu
     C                     ADD  *ZERO     P1AUWG           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           1         IFLT *ZERO                      *IF
     C           1         MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0143           Company Number
     C                     Z-ADDP1ELDT    WL0144           Post to G/L Dat
     C                     Z-ADDP1ELDT    WL0146           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0147           *Duration (fact
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0145    P1ELDT           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           1         IFGT *ZERO                      *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0148           Company Number
     C                     Z-ADDP1ELDT    WL0149           Post to G/L Dat
     C                     Z-ADDP1ELDT    WL0151           *Date2 (beginni
     C                     Z-ADD1         WL0152           *Duration (fact
     C                     EXSR TDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0150    P1ELDT           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           1         IFEQ *ZERO                      *IF
     C                     Z-ADDP1ELDT    P1ELDT           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           P1AVQT    SUB  P1CCQT    P1HWQT           ATS Quantity Ne
     C           P1D0WG    SUB  P1AUWG    P1ENWG           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
     C           P1AVQT    SUB  P1CCQT    P1HWQT           ATS Quantity Ne
     C           P1D0WG    SUB  P1AUWG    P1ENWG           ATS Weight Need
     C                     END                             *FI
      * FROZEN - allocate backwards - new for FP1054
      * CASE: PAR.Warehouse Type is Frozen
     C           P3WPST    IFEQ 'FZ'                       *IF
     C                     MOVEL'B'       YL0012           Allocation Meth
      * Chilling Time
      * CASE: PAR.Warehouse Std Chill Time is yes
     C           P3T1ST    IFEQ 'Y'                        *IF
     C                     Z-ADDP3DBNB    WN0376           Chilling Time U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP2CHTM    WN0376           Chilling Time U
     C                     END                             *FI
     C                     Z-ADDP1GWDT    YL0013           Production Date
      * DOC:  Allocation
     C                     EXSR UGSUBR                     DOC:  Allocatio
      * CASE: LCL.Allocation Method USR is Backward
     C           YL0012    IFEQ 'B'                        *IF
      * For backwards start with the TO date, then -1 day until FROM date
     C                     Z-ADDP1GVDT    YL0017           Production Date
     C                     Z-ADDP1GWDT    P1ELDT           Production Date
      * Starting Production Date
      * CASE: PAR.Production Date RGF LT JOB.*Job date
     C           P1GVDT    IFLT ##JDT                      *IF
     C                     Z-ADD##JDT     P1ELDT           Production Date
      * CASE: PAR.Production Date RGT LT JOB.*Job date
     C           P1GWDT    IFLT ##JDT                      *IF
     C                     Z-ADDP1GWDT    YL0013           Production Date
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1GWDT    P1ELDT           Production Date
     C                     END                             *FI
      * ITR:  Allocate Availability based on AGE CODE.
      * DO WHILE: Prd Dte >= Prd Dte RGF & Need > 0
      *  - c1 AND c3
      *   |- c1    : PAR.Production Date GE LCL.Production Date RGF
      *   |- c3    : PAR.ATS Quantity Need USR is Greater than zero
      *   '-
     C                     DO   *HIVAL                     *DOW
     C                     MOVEL'0'       Y0CX01  1
     C           P1ELDT    IFGE YL0017                     *IF
     C           P1HWQT    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
     C                     LEAVE
     C                     END                             *FI
      * Rtv Prd Day Sts       RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0064           Company Number
     C                     Z-ADDP1ELDT    WL0065           Post to G/L Dat
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0066    YL0014    P      Production Day
      * Allocate Production
      * CASE: LCL.Production Day Status is yes
     C           YL0014    IFEQ 'Y'                        *IF
      * Determine Production Type
      * CASE: PAR.Production Date EQ JOB.*Job date
     C           P1ELDT    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WN0369           Production Type
      * Val Sched Existance   RT - PS Prod Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0073           Company Number
     C                     MOVELWN0369    WL0074    P      Production Type
     C                     Z-ADDP1ELDT    WL0075           Production Date
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0076    WUWXST    P      Record Found US
      * Set to Plan if record not found
      * CASE: WRK.Record Found USR is Record Not Found
     C           WUWXST    IFEQ 'N'                        *IF
     C                     MOVEL'P'       WN0369           Production Type
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Production Date GT JOB.*Job date
     C           P1ELDT    IFGT ##JDT                      *IF
     C                     MOVEL'P'       WN0369           Production Type
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Use Production Warehouse and Acctng instead of par.warehou
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0011    WL0077           Company Number
     C                     MOVELWN0369    WL0078    P      Production Type
     C                     Z-ADDP1ELDT    WL0079           Production Date
     C                     Z-ADDP1HGCD    WL0080           Item Code
     C                     MOVELYL0010    WL0081    P      Warehouse Code
     C                     Z-ADDWN0371    WL0083           ATS Weight Avai
     C                     Z-ADDWN0372    WL0084           ATS Pieces Avai
     C                     Z-ADDWN0376    WL0085           Chilling Time U
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0082    WN0377           PS Avg Piece Wg
     C                     Z-ADDWL0083    WN0371           ATS Weight Avai
     C                     Z-ADDWL0084    WN0372           ATS Pieces Avai
      * Quantity Available
      * CASE: Piece Count = Y
      *  - c1 AND c2 AND c3
      *   |- c1    : PAR.Piece Count Item is yes
      *   |- c2    : PAR.Pieces Per Bag is GT Zero
      *   |- c3    : PAR.Bags Per Unit is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2PCCT    IFEQ 'Y'                        *IF
     C           P2BDNB    IFGT *ZERO                      *IF
     C           P2BJNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.ATS Pieces Available USR
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           P2BDNB    MULT P2BJNB    W0WJ01           *Synon (15,0) w
     C           WN0372    DIV  W0WJ01    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0370           ATS Quantity Av
     C                     ELSE
      * CASE: Piece Count = N
      *  - c1 AND c2
      *   |- c1    : PAR.Piece Count Item is Not Yes
      *   |- c2    : PAR.Unit Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2PCCT    IFEQ *BLANK                     *IF
     C           P2PCCT    OREQ 'N'
     C           P1AIWG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ATS Quantity Avail USR
      * PAR.ATS Quantity Avail USR =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.ATS Weight Available USR
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Unit Weight
     C           WN0371    DIV  P1AIWG    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0370           ATS Quantity Av
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0370           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * Schedule As Ordered
      * CASE: PAR.ATS Adj Type USR 2 is Sched/Alloc As Ordered
     C           P1QJST    IFEQ 'AO'                       *IF
      * CASE: PAR.ATS Quantity Avail USR LT PAR.ATS Quantity Need USR
     C           WN0370    IFLT P1HWQT                     *IF
     C                     Z-ADDP1HWQT    WN0370           ATS Quantity Av
     C                     END                             *FI
     C                     END                             *FI
      * If production avail allocate
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0370    IFGT *ZERO                      *IF
      * Allocate Available Quantity
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           P1HWQT    IFGT WN0370                     *IF
     C                     ADD  WN0370    P1CCQT           Quantity Schedu
     C           WN0370    MULT P1AIWG    WN0371           ATS Weight Avai
     C                     ADD  WN0371    P1AUWG           Weight Schedule
     C                     Z-ADDWN0371    WN0374           Weight Allocate
     C                     Z-ADDWN0370    WN0373           Quantity Alloca
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           P1HWQT    IFLE WN0370                     *IF
     C                     ADD  P1HWQT    P1CCQT           Quantity Schedu
     C           P1HWQT    MULT P1AIWG    P1ENWG    H      ATS Weight Need
     C                     ADD  P1ENWG    P1AUWG           Weight Schedule
     C                     Z-ADDP1ENWG    WN0374           Weight Allocate
     C                     Z-ADDP1HWQT    WN0373           Quantity Alloca
     C                     END                             *FI
     C                     END                             *FI
      * If quantity allocated is GT zero
      * CASE: PAR.Quantity Allocated USR is GT Zero
     C           WN0373    IFGT *ZERO                      *IF
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0086           Company Number
     C                     Z-ADDP1C4NB    WL0087           Order Number
     C                     Z-ADDP1DPNB    WL0088           Order Sequence
     C                     Z-ADDP1UENB    WL0089           Order Secondary
     C                     Z-ADDP1ELDT    WL0090           OD Production D
     C                     Z-ADDP1HLDT    WL0091           Scheduled Ship
     C                     MOVELP1AJCD    WL0092    P      Warehouse Code
     C                     MOVELP1AJCD    WL0093    P      Order From Ware
     C                     Z-ADDP1HGCD    WL0094           Item Code
     C                     Z-ADDWN0374    WL0095           Weight Allocate
     C                     Z-ADDWN0373    WL0096           Quantity Alloca
     C                     MOVELP2QZCD    WL0097    P      Base/Conv/Loss
     C                     EXSR SURVGN
      * CASE: PAR.Piece Count Item is yes
     C           P2PCCT    IFEQ 'Y'                        *IF
      * Pieces Allocated
      * PAR.Pieces Allocated USR =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           WN0373    MULT P2BDNB    W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    MULT P2BJNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0375           Pieces Allocate
      * Weight Allocated
      * PAR.Weight Allocated USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Pieces Allocated USR
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PS Avg Piece Wgt
     C           WN0375    MULT WN0377    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0374           Weight Allocate
     C                     END                             *FI
      * FP1054 Use Production Warehouse and Acctng instead of par.warehou
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0011    WL0098           Company Number
     C                     MOVELWN0369    WL0099    P      Production Type
     C                     Z-ADDP1ELDT    WL0100           Production Date
     C                     Z-ADDP1HGCD    WL0101           Item Code
     C                     MOVELYL0010    WL0102    P      Warehouse Code
     C                     Z-ADDWN0374    WL0103           Weight Allocate
     C                     Z-ADDWN0375    WL0104           Pieces Allocate
     C                     EXSR SWRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0373           Quantity Alloca
     C                     Z-ADD*ZERO     WN0374           Weight Allocate
     C                     Z-ADD*ZERO     P1CCQT           Quantity Schedu
     C                     Z-ADD*ZERO     P1AUWG           Weight Schedule
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     P1CCQT           Quantity Schedu
     C                     ADD  *ZERO     P1AUWG           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 -  subtract 1 day to go backwards
      * CLC Inc/Dec Date       IF
      * CASE: PAR.*Duration (factor) is LT Zero
     C           -1        IFLT *ZERO                      *IF
     C           -1        MULT -1        WUDUF            *Duration (fact
      * Clc Date (descending) RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0143           Company Number
     C                     Z-ADDP1ELDT    WL0144           Post to G/L Dat
     C                     Z-ADDP1ELDT    WL0146           *Date2 (beginni
     C                     Z-ADDWUDUF     WL0147           *Duration (fact
     C                     EXSR TCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0145    P1ELDT           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is GT Zero
     C           -1        IFGT *ZERO                      *IF
      * Clc Date (ascending)  RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0148           Company Number
     C                     Z-ADDP1ELDT    WL0149           Post to G/L Dat
     C                     Z-ADDP1ELDT    WL0151           *Date2 (beginni
     C                     Z-ADD-1        WL0152           *Duration (fact
     C                     EXSR TDRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0150    P1ELDT           *Date1 (ending)
     C                     ELSE
      * CASE: PAR.*Duration (factor) is EQ Zero
     C           -1        IFEQ *ZERO                      *IF
     C                     Z-ADDP1ELDT    P1ELDT           *Date1 (ending)
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           P1AVQT    SUB  P1CCQT    P1HWQT           ATS Quantity Ne
     C           P1D0WG    SUB  P1AUWG    P1ENWG           ATS Weight Need
     C                     END                             *ITR
     C                     END                             *FI
     C           P1AVQT    SUB  P1CCQT    P1HWQT           ATS Quantity Ne
     C           P1D0WG    SUB  P1AUWG    P1ENWG           ATS Weight Need
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Base/Conv/Loss Item is Converted/Fabricated
     C           P2QZCD    IFEQ 'C'                        *IF
     C           P2QZCD    OREQ 'F'
      * UPD Allocate Std      XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDHMXFR'              90  UPD Allocate St
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AJCD    WQ0030  3        Warehouse Code
     C                     PARM P1AIC3    WQ0031  30       Company Number
     C                     PARM P1HGCD    WQ0032  70       Item Code
     C           P1ELDT    PARM P1ELDT    WQ0033  70       Production Date
     C                     PARM P2ADCD    WQ0034  2        U/M - Primary
     C                     PARM P1AIWG    WQ0035 112       Unit Weight
     C                     PARM P2CHTM    WQ0036  52       Fresh Chilling
     C                     PARM P2PCCT    WQ0037  1        Piece Count Ite
     C                     PARM P2BDNB    WQ0038  70       Pieces Per Bag
     C                     PARM P2BJNB    WQ0039  70       Bags Per Unit
     C                     PARM P3WPST    WQ0040  2        Warehouse Type
     C                     PARM P3T1ST    WQ0041  1        Warehouse Std C
     C                     PARM P3DBNB    WQ0042  52       Warehouse Chill
     C                     PARM P1C4NB    WQ0043  70       Order Number
     C                     PARM P1DPNB    WQ0044  30       Order Sequence
     C                     PARM P1UENB    WQ0045  30       Order Secondary
     C                     PARM P1GVDT    WQ0046  70       Production Date
     C                     PARM P1GWDT    WQ0047  70       Production Date
     C                     PARM P1AVQT    WQ0048 112       Quantity Ordere
     C                     PARM P1D0WG    WQ0049 112       Weight Ordered
     C           P1CCQT    PARM P1CCQT    WQ0050 112       Quantity Schedu
     C           P1AUWG    PARM P1AUWG    WQ0051 112       Weight Schedule
     C           P1HWQT    PARM P1HWQT    WQ0052 112       ATS Quantity Ne
     C           P1ENWG    PARM P1ENWG    WQ0053 112       ATS Weight Need
     C                     PARM P1RPCD    WQ0054  1        Age Code
     C                     PARM P1HLDT    WQ0055  70       Ship Date USR
     C                     PARM P1QJST    WQ0056  2        ATS Adj Type US
     C                     PARM P1BXVN    WQ0057 10        PSAA Program Na
     C                     PARM P4AYAA    WQ0058  3        Order From Ware
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * **** Investigate the following code for validity ****
      * 06/25/02 According to Steve, we do not want to allocate fresh
      *          availabity for frozen orders.
      * *****************************************************
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Day/Wk/Prd/Yr     RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WABCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADDWL0001    WAAIC3           Company Number
     C                     Z-ADDWL0002    WABCDT           Post to G/L Dat
      * Establish starting position
     C           KRSSA     CHAIN@AFREBE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0003           Julian Date
     C                     Z-ADD*ZERO     WL0004           Accounting Year
     C                     Z-ADD*ZERO     WL0005           Accounting Peri
     C                     Z-ADD*ZERO     WL0006           OM Week
     C                     MOVEL*BLANK    WL0007           Day of Week
     C                     Z-ADD*ZERO     WL0008           Week Number
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWACQNB    WL0003           Julian Date
     C                     Z-ADDWAESNB    WL0004           Accounting Year
     C                     Z-ADDWAETNB    WL0005           Accounting Peri
     C                     Z-ADDWABZNB    WL0006           OM Week
     C                     MOVELWAA9ST    WL0007           Day of Week
     C                     Z-ADDWAEINB    WL0008           Week Number
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Bgn/End Dts Prd/Yr RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBESNB    WQSB02           Accounting Year
     C           *LIKE     DEFN WBETNB    WQSB03           Accounting Peri
     C           *LIKE     DEFN WBEINB    WQSB04           Week Number
     C           *LIKE     DEFN WBA9ST    WQSB05           Day of Week
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Accounting Year
     C                     KFLD           WQSB03           Accounting Peri
     C                     KFLD           WQSB04           Week Number
     C                     KFLD           WQSB05           Day of Week
      * Setup key
     C                     Z-ADDWL0009    WQSB01           Company Number
     C                     Z-ADDWL0011    WQSB02           Accounting Year
     C                     Z-ADDWL0012    WQSB03           Accounting Peri
     C                     Z-ADDWL0014    WQSB04           Week Number
     C                     MOVELWL0013    WQSB05           Day of Week
      * Establish starting position
     C           KRSSB     SETLL@AFREQ0                    *
     C           KRSSB     READE@AFREQ0                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBBCDT    WL0010           Post to G/L Dat
     C           KRSSB     READE@AFREQ0                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * UPD Allocate Inv      RT - PS Prod Item Inventory  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0005 110       ATS Quantity Av
     C                     Z-ADD*ZERO     WN0006 112       ATS Weight Avai
     C                     Z-ADD*ZERO     WN0007  70       ATS Pieces Avai
     C                     Z-ADD*ZERO     WN0008 112       Quantity Alloca
     C                     Z-ADD*ZERO     WN0009  92       Weight Allocate
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0008           Quantity Alloca
     C                     Z-ADD*ZERO     WN0009           Weight Allocate
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCHGCD    WQSC02           Item Code
     C           *LIKE     DEFN WCAJCD    WQSC03           Warehouse Code
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Item Code
     C                     KFLD           WQSC03           Warehouse Code
     C                     KFLD           WCELDT           Production Date
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Item Code
     C                     KFLD           WQSC03           Warehouse Code
      * Setup key
     C                     Z-ADDWL0015    WQSC01           Company Number
     C                     Z-ADDWL0016    WQSC02           Item Code
     C                     MOVELWL0017    WQSC03           Warehouse Code
     C                     Z-ADDWL0018    WCELDT           Production Date
      * Establish starting position
     C           KPSSC     SETLL@CWCPQW                    *
     C           KRSSC     READE@CWCPQW                  90*
      * Data record not found
     C   90                MOVEL'USR3238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Production Date EQ JOB.*Job date
      *   |- c2    : PAR.ATS Quantity Need USR is Less than or equal zero
      *   '-
     C           WCELDT    IFEQ ##JDT                      *IF
     C           WL0030    ORLE *ZERO                      *OR
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
      * Rtv Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
     C                     EXSR SDRVGN
     C           WCARQT    SUB  YL0004    WN0005           ATS Quantity Av
     C           WCACWG    SUB  YL0005    WN0006           ATS Weight Avai
      * Allocate Available Inventory
      * CASE: PAR.ATS Quantity Avail USR is GT Zero
     C           WN0005    IFGT *ZERO                      *IF
      * Allocate
      * CASE: PAR.ATS Quantity Need USR GT PAR.ATS Quantity Avail USR
     C           WL0030    IFGT WN0005                     *IF
     C                     ADD  WN0005    WL0028           Quantity Schedu
     C           WN0005    MULT WL0019    WN0006           ATS Weight Avai
     C                     ADD  WN0006    WL0029           Weight Schedule
     C                     Z-ADDWN0005    WN0008           Quantity Alloca
     C                     Z-ADDWN0006    WN0009           Weight Allocate
     C                     ELSE
      * CASE: PAR.ATS Quantity Need USR LE PAR.ATS Quantity Avail USR
     C           WL0030    IFLE WN0005                     *IF
     C                     ADD  WL0030    WL0028           Quantity Schedu
     C                     ADD  WL0031    WL0029           Weight Schedule
     C                     Z-ADDWL0030    WN0008           Quantity Alloca
     C           WN0008    MULT WL0019    WN0009    H      Weight Allocate
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  *ZERO     WL0028           Quantity Schedu
     C                     ADD  *ZERO     WL0029           Weight Schedule
     C                     END                             *FI
     C                     END                             *FI
      * Upd Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
     C                     EXSR SERVGN
      * Upd Qty/Wgt Inv Alc   RT - Order Detail Schedule  * 
     C                     EXSR SIRVGN
      * Upd Inv Allocated     RT - PS Prod Item Schedule  * 
     C                     EXSR SMRVGN
     C                     END                             *FI
     C           WL0026    SUB  WL0028    WL0030           ATS Quantity Ne
     C           WL0027    SUB  WL0029    WL0031           ATS Weight Need
     C           KRSSC     READE@CWCPQW                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0004           OD Quantity Inv
     C                     Z-ADD*ZERO     YL0005           OD Weight Inv S
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSD01           Company Number
     C           *LIKE     DEFN WDHGCD    WQSD02           Item Code
     C           *LIKE     DEFN WDAJCD    WQSD03           Warehouse Code
     C           *LIKE     DEFN WDJGDT    WQSD04           OD Production D
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Item Code
     C                     KFLD           WQSD03           Warehouse Code
     C                     KFLD           WQSD04           OD Production D
      * Setup key
     C                     Z-ADDWCAIC3    WQSD01           Company Number
     C                     Z-ADDWCHGCD    WQSD02           Item Code
     C                     MOVELWCAJCD    WQSD03           Warehouse Code
     C                     Z-ADDWCELDT    WQSD04           OD Production D
      * Establish starting position
     C           KRSSD     SETLL@B5CPM4                    *
     C           KRSSD     READE@B5CPM4                  90*
      * Data record not found
     C   90                MOVEL'USR3150' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WDIUQT    YL0004           OD Quantity Inv
     C                     ADD  WDF3WG    YL0005           OD Weight Inv S
     C           KRSSD     READE@B5CPM4                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Upd Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0010  1        EDI Status 1
     C                     MOVEL*BLANK    WN0011  1        EDI Status 2
     C                     MOVEL*BLANK    WN0012  1        EDI Status 3
     C                     MOVEL*BLANK    WN0013  1        Record Status
     C                     Z-ADD*ZERO     WN0014  60       Job Time
     C                     MOVEL*BLANK    WN0015 10        User Id
     C                     MOVEL*BLANK    WN0016 10        Job Name
     C                     Z-ADD*ZERO     WN0017  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C                     KFLD           WEJGDT           OD Production D
      * Setup key
     C                     Z-ADDWCAIC3    WEAIC3           Company Number
     C                     Z-ADDWL0023    WEC4NB           Order Number
     C                     Z-ADDWL0024    WEDPNB           Order Sequence
     C                     Z-ADDWL0025    WEUENB           Order Secondary
     C                     Z-ADDWCELDT    WEJGDT           OD Production D
      * Establish starting position
     C           KRSSE     CHAIN@B5CPM2              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3150' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Ord Dtl Sch-Inv   CR - Order Detail Sched-Inv  * 
     C                     EXSR SFCRRC
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WEIUQT    ADD  WN0008    YL0006           OD Quantity Inv
     C           WEF3WG    ADD  WN0009    YL0007           OD Weight Inv S
      * CASE: LCL.OD Quantity Inv Sched is LE Zero
     C           YL0006    IFLE *ZERO                      *IF
      * Delete Order Detail Sched - Order Detail Sched-Inv  * 
     C                     EXSR SGDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Ord Dtl Sch-Inv   CH - Order Detail Sched-Inv  * 
     C                     EXSR SHCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCRRC    BEGSR
      *================================================================
      * Crt Ord Dtl Sch-Inv   CR - Order Detail Sched-Inv  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B5CPM1
     C                     Z-ADDWCAIC3    WFAIC3           Company Number
     C                     Z-ADDWL0023    WFC4NB           Order Number
     C                     Z-ADDWL0024    WFDPNB           Order Sequence
     C                     Z-ADDWL0025    WFUENB           Order Secondary
     C                     Z-ADDWCELDT    WFJGDT           OD Production D
     C                     Z-ADDWL0032    WFAODT           Scheduled Ship
     C                     MOVELWCAJCD    WFAJCD           Warehouse Code
     C                     Z-ADDWCHGCD    WFHGCD           Item Code
     C                     Z-ADDWN0008    WFIUQT           OD Quantity Inv
     C                     Z-ADDWN0009    WFF3WG           OD Weight Inv S
     C                     MOVELWN0010    WFUVST           EDI Status 1
     C                     MOVELWN0011    WFUWST           EDI Status 2
     C                     MOVELWN0012    WFUXST           EDI Status 3
     C                     MOVELWN0013    WFVSST           Record Status
     C                     Z-ADDWN0014    WFAATM           Job Time
     C                     MOVELWN0015    WFAYNA           User Id
     C                     MOVELWN0016    WFA0NA           Job Name
     C                     Z-ADDWN0017    WFAXDT           Job Date
      *
      * USER: Processing before Data update
      * UPS CRTOBJ Stamp      IF
     C                     MOVEL'A'       WFVSST           Record Status
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##PGM     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
     C           KLCRSF    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
     C                     KFLD           WFDPNB           Order Sequence
     C                     KFLD           WFUENB           Order Secondary
     C                     KFLD           WFJGDT           OD Production D
      * Check for duplicate primary key
     C           KLCRSF    SETLL@B5CPM1                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3151' W0RTN   7
      * Send message 'Order Detail Sched-Inv EX'
     C                     MOVEL'USR3151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C                     WRITE@B5CPM1                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGDLRC    BEGSR
      *================================================================
      * Delete Order Detail Sched - Order Detail Sched-Inv  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B5CPM1
     C                     Z-ADDWEAIC3    WFAIC3           Company Number
     C                     Z-ADDWEC4NB    WFC4NB           Order Number
     C                     Z-ADDWEDPNB    WFDPNB           Order Sequence
     C                     Z-ADDWEUENB    WFUENB           Order Secondary
     C                     Z-ADDWEJGDT    WFJGDT           OD Production D
      *
     C           KLDLSG    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
     C                     KFLD           WFDPNB           Order Sequence
     C                     KFLD           WFUENB           Order Secondary
     C                     KFLD           WFJGDT           OD Production D
     C           KLDLSG    CHAIN@B5CPM1              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB5CPL0'MDACP
     C                     MOVEL'@B5CPM1' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B5CPM1                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCHRC    BEGSR
      *================================================================
      * Chg Ord Dtl Sch-Inv   CH - Order Detail Sched-Inv  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0018  1        EDI Status 1
     C                     MOVEL*BLANK    WN0019  1        EDI Status 2
     C                     MOVEL*BLANK    WN0020  1        EDI Status 3
     C                     MOVEL*BLANK    WN0021  1        Record Status
     C                     Z-ADD*ZERO     WN0022  60       Job Time
     C                     MOVEL*BLANK    WN0023 10        User Id
     C                     MOVEL*BLANK    WN0024 10        Job Name
     C                     Z-ADD*ZERO     WN0025  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @B5CPM1
     C                     Z-ADDWEAIC3    WFAIC3           Company Number
     C                     Z-ADDWEC4NB    WFC4NB           Order Number
     C                     Z-ADDWEDPNB    WFDPNB           Order Sequence
     C                     Z-ADDWEUENB    WFUENB           Order Secondary
     C                     Z-ADDWEJGDT    WFJGDT           OD Production D
      *
     C           KLCHSH    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFC4NB           Order Number
     C                     KFLD           WFDPNB           Order Sequence
     C                     KFLD           WFUENB           Order Secondary
     C                     KFLD           WFJGDT           OD Production D
     C           KLCHSH    CHAIN@B5CPM1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB5CPL0'MDACP
     C                     MOVEL'@B5CPM1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPOB51    YARDCS
      * Move non-key fields to @B5CPM1
     C                     Z-ADDWEAODT    WFAODT           Scheduled Ship
     C                     MOVELWCAJCD    WFAJCD    P      Warehouse Code
     C                     Z-ADDWCHGCD    WFHGCD           Item Code
     C                     Z-ADDYL0006    WFIUQT           OD Quantity Inv
     C                     Z-ADDYL0007    WFF3WG           OD Weight Inv S
      *
      * Set PGM.*Record Data Changed flag
     C           QPOB51    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@B5CPM1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPOB5CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Upd Qty/Wgt Inv Alc   RT - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0026 112       OD Quantity Sch
     C                     Z-ADD*ZERO     WN0027 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0028 112       OD Quantity Inv
     C                     Z-ADD*ZERO     WN0029 112       OD Weight Inv S
     C                     Z-ADD*ZERO     WN0030 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0031 112       OD Weight Unuse
     C                     MOVEL*BLANK    WN0032  1        OD Added to Sch
     C                     MOVEL*BLANK    WN0033  1        OD Reallocate S
     C                     MOVEL*BLANK    WN0034  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0035  1        EDI Status 1
     C                     MOVEL*BLANK    WN0036  1        EDI Status 2
     C                     MOVEL*BLANK    WN0037  1        EDI Status 3
     C                     MOVEL*BLANK    WN0038  1        Record Status
     C                     Z-ADD*ZERO     WN0039  60       Job Time
     C                     MOVEL*BLANK    WN0040 10        User Id
     C                     MOVEL*BLANK    WN0041 10        Job Name
     C                     Z-ADD*ZERO     WN0042  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C                     KFLD           WGJGDT           OD Production D
      * Setup key
     C                     Z-ADDWL0015    WGAIC3           Company Number
     C                     Z-ADDWL0023    WGC4NB           Order Number
     C                     Z-ADDWL0024    WGDPNB           Order Sequence
     C                     Z-ADDWL0025    WGUENB           Order Secondary
     C                     Z-ADD##JDT     WGJGDT           OD Production D
      * Establish starting position
     C           KRSSI     CHAIN@KNCPHO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2238' W0RTN   7
      * USER: Processing if Data record not found
      * CRT Ord Detail Sched   CR - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0015    WL0033           Company Number
     C                     Z-ADDWL0023    WL0034           Order Number
     C                     Z-ADDWL0024    WL0035           Order Sequence
     C                     Z-ADDWL0025    WL0036           Order Secondary
     C                     Z-ADD##JDT     WL0037           OD Production D
     C                     Z-ADDWL0032    WL0038           Scheduled Ship
     C                     MOVELWL0017    WL0039    P      Warehouse Code
     C                     MOVELWL0017    WL0040    P      Order From Ware
     C                     Z-ADDWL0016    WL0041           Item Code
     C                     Z-ADDWN0026    WL0042           OD Quantity Sch
     C                     Z-ADDWN0027    WL0043           OD Weight Sched
     C                     Z-ADDWN0008    WL0044           OD Quantity Inv
     C                     Z-ADDWN0009    WL0045           OD Weight Inv S
     C                     Z-ADDWN0030    WL0046           OD Quantity Unu
     C                     Z-ADDWN0031    WL0047           OD Weight Unuse
     C                     MOVELWN0032    WL0048    P      OD Added to Sch
     C                     MOVELWN0033    WL0049    P      OD Reallocate S
     C                     MOVELWN0034    WL0050    P      OD Status Unuse
     C                     MOVELWN0035    WL0051    P      EDI Status 1
     C                     MOVELWN0036    WL0052    P      EDI Status 2
     C                     MOVELWN0037    WL0053    P      EDI Status 3
     C                     MOVELWN0038    WL0054    P      Record Status
     C                     Z-ADDWN0039    WL0055           Job Time
     C                     MOVELWN0040    WL0056    P      User Id
     C                     MOVELWN0041    WL0057    P      Job Name
     C                     Z-ADDWN0042    WL0058           Job Date
     C                     EXSR SJCRRC
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WGIUQT    ADD  WN0008    WN0028           OD Quantity Inv
     C           WGF3WG    ADD  WN0009    WN0029           OD Weight Inv S
      * CASE: PAR.OD Quantity Inv Sched is LE Zero
     C           WN0028    IFLE *ZERO                      *IF
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWGAIC3    WL0059           Company Number
     C                     Z-ADDWGC4NB    WL0060           Order Number
     C                     Z-ADDWGDPNB    WL0061           Order Sequence
     C                     Z-ADDWGUENB    WL0062           Order Secondary
     C                     Z-ADDWGJGDT    WL0063           OD Production D
     C                     EXSR SKDLRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg Qty/Wgt Inv Alc - Order Detail Schedule  * 
     C                     EXSR SLCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCRRC    BEGSR
      *================================================================
      * CRT Ord Detail Sched   CR - Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @KNCPHN
     C                     Z-ADDWL0033    WHAIC3           Company Number
     C                     Z-ADDWL0034    WHC4NB           Order Number
     C                     Z-ADDWL0035    WHDPNB           Order Sequence
     C                     Z-ADDWL0036    WHUENB           Order Secondary
     C                     Z-ADDWL0037    WHJGDT           OD Production D
     C                     Z-ADDWL0038    WHAODT           Scheduled Ship
     C                     MOVELWL0039    WHAJCD           Warehouse Code
     C                     MOVELWL0040    WHAYAA           Order From Ware
     C                     Z-ADDWL0041    WHHGCD           Item Code
     C                     Z-ADDWL0042    WHIGQT           OD Quantity Sch
     C                     Z-ADDWL0043    WHFLWG           OD Weight Sched
     C                     Z-ADDWL0044    WHIUQT           OD Quantity Inv
     C                     Z-ADDWL0045    WHF3WG           OD Weight Inv S
     C                     Z-ADDWL0046    WHIVQT           OD Quantity Unu
     C                     Z-ADDWL0047    WHF4WG           OD Weight Unuse
     C                     MOVELWL0048    WHP7ST           OD Added to Sch
     C                     MOVELWL0049    WHP8ST           OD Reallocate S
     C                     MOVELWL0050    WHQAST           OD Status Unuse
     C                     MOVELWL0051    WHUVST           EDI Status 1
     C                     MOVELWL0052    WHUWST           EDI Status 2
     C                     MOVELWL0053    WHUXST           EDI Status 3
     C                     MOVELWL0054    WHVSST           Record Status
     C                     Z-ADDWL0055    WHAATM           Job Time
     C                     MOVELWL0056    WHAYNA           User Id
     C                     MOVELWL0057    WHA0NA           Job Name
     C                     Z-ADDWL0058    WHAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WHVSST           Record Status
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##JOB     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
     C           KLCRSJ    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHC4NB           Order Number
     C                     KFLD           WHDPNB           Order Sequence
     C                     KFLD           WHUENB           Order Secondary
     C                     KFLD           WHJGDT           OD Production D
      * Check for duplicate primary key
     C           KLCRSJ    SETLL@KNCPHN                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2239' W0RTN   7
      * Send message 'Order Detail Schedule  EX'
     C                     MOVEL'USR2239' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C                     WRITE@KNCPHN                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKDLRC    BEGSR
      *================================================================
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @KNCPHN
     C                     Z-ADDWL0059    WHAIC3           Company Number
     C                     Z-ADDWL0060    WHC4NB           Order Number
     C                     Z-ADDWL0061    WHDPNB           Order Sequence
     C                     Z-ADDWL0062    WHUENB           Order Secondary
     C                     Z-ADDWL0063    WHJGDT           OD Production D
      *
     C           KLDLSK    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHC4NB           Order Number
     C                     KFLD           WHDPNB           Order Sequence
     C                     KFLD           WHUENB           Order Secondary
     C                     KFLD           WHJGDT           OD Production D
     C           KLDLSK    CHAIN@KNCPHN              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@KNCPHN                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * Chg Qty/Wgt Inv Alc - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0043  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0044  3        Warehouse Code
     C                     MOVEL*BLANK    WN0045  3        Order From Ware
     C                     Z-ADD*ZERO     WN0046  70       Item Code
     C                     Z-ADD*ZERO     WN0047 112       OD Quantity Sch
     C                     Z-ADD*ZERO     WN0048 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0049 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0050 112       OD Weight Unuse
     C                     MOVEL*BLANK    WN0051  1        OD Added to Sch
     C                     MOVEL*BLANK    WN0052  1        OD Reallocate S
     C                     MOVEL*BLANK    WN0053  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0054  1        EDI Status 1
     C                     MOVEL*BLANK    WN0055  1        EDI Status 2
     C                     MOVEL*BLANK    WN0056  1        EDI Status 3
     C                     MOVEL*BLANK    WN0057  1        Record Status
     C                     Z-ADD*ZERO     WN0058  60       Job Time
     C                     MOVEL*BLANK    WN0059 10        User Id
     C                     MOVEL*BLANK    WN0060 10        Job Name
     C                     Z-ADD*ZERO     WN0061  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @KNCPHN
     C                     Z-ADDWL0015    WHAIC3           Company Number
     C                     Z-ADDWL0023    WHC4NB           Order Number
     C                     Z-ADDWL0024    WHDPNB           Order Sequence
     C                     Z-ADDWL0025    WHUENB           Order Secondary
     C                     Z-ADD##JDT     WHJGDT           OD Production D
      *
     C           KLCHSL    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHC4NB           Order Number
     C                     KFLD           WHDPNB           Order Sequence
     C                     KFLD           WHUENB           Order Secondary
     C                     KFLD           WHJGDT           OD Production D
     C           KLCHSL    CHAIN@KNCPHN              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDKN1    YBRDCS
      * Move non-key fields to @KNCPHN
     C                     Z-ADDWN0028    WHIUQT           OD Quantity Inv
     C                     Z-ADDWN0029    WHF3WG           OD Weight Inv S
      *
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * UPS CHGOBJ Stamp      IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##PGM     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@KNCPHN                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDKNCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Upd Inv Allocated     RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0062  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0063  70       PS Pieces Inv A
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIV5ST           Production Type
     C                     KFLD           WIELDT           Production Date
     C                     KFLD           WIHGCD           Item Code
     C                     KFLD           WIAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0015    WIAIC3           Company Number
     C                     MOVEL'S'       WIV5ST           Production Type
     C                     Z-ADD##JDT     WIELDT           Production Date
     C                     Z-ADDWL0016    WIHGCD           Item Code
     C                     MOVELWL0017    WIAJCD           Warehouse Code
      * Establish starting position
     C           KRSSM     CHAIN@I8CPUS              90    *
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WIUNW2    ADD  WN0009    WN0062           PS Weight Inv A
      * PS Pieces Inv Allocated
      * CASE: PAR.Piece Count Item is yes
     C           WL0020    IFEQ 'Y'                        *IF
      * Pieces Inv Allocated
      * PAR.PS Pieces Inv Allocated =
      *    *COMPUTE (x1 + (x2 * (x3 * x4)))
      * x1    : DB1.PS Pieces Inv Allocated
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.Quantity Allocated USR
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x4    : PAR.Bags Per Unit
     C           WL0021    MULT WL0022    W0WJ02           *Synon (15,0) w
     C           WN0008    MULT W0WJ02    W0WJ01    H      *Synon (15,0) w
     C           WICENB    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0063           PS Pieces Inv A
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0063           PS Pieces Inv A
     C                     END                             *FI
      * Chg Inv Allocated     CH - PS Prod Item Schedule  * 
     C                     EXSR SNCHRC
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCHRC    BEGSR
      *================================================================
      * Chg Inv Allocated     CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0064  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0065  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0066  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0067  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0068  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0069  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0070  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0071  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0072  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0073  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0074  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0075  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0076  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0077  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0078  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0079  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0080  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0081  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0082  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0083  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0084  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0085 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0086  70       PS Pieces Fz Tf
     C                     Z-ADD*ZERO     WN0087 112       PS Weight Fz Tf
     C                     Z-ADD*ZERO     WN0088  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0089 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0090  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0091 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0092  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0093 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0094  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0095 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0096  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0097  3        PS Item Id
     C                     MOVEL*BLANK    WN0098  2        Warehouse Type
     C                     MOVEL*BLANK    WN0099  1        PS Lock Status
     C                     MOVEL*BLANK    WN0100  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0101  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0102  1        PS Piece Count
     C                     MOVEL*BLANK    WN0103  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0104  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0105  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0106  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0107  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0108  3        PS Production W
     C                     Z-ADD*ZERO     WN0109  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0110  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0111  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0112  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0113  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0114  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0115  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0116  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0117  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0118  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0119  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0120  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0121  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0122  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0123  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0124  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0125  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0126  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0127  6        Department Code
     C                     Z-ADD*ZERO     WN0128  30       Item Structure
     C                     Z-ADD*ZERO     WN0129  30       Item Structure
     C                     Z-ADD*ZERO     WN0130  30       Item Structure
     C                     MOVEL*BLANK    WN0131  6        Primal Group Co
     C                     MOVEL*BLANK    WN0132  1        EDI Status 1
     C                     MOVEL*BLANK    WN0133  1        EDI Status 2
     C                     MOVEL*BLANK    WN0134  1        EDI Status 3
     C                     MOVEL*BLANK    WN0135  1        Record Status
     C                     Z-ADD*ZERO     WN0136  60       Job Time
     C                     MOVEL*BLANK    WN0137 10        User Id
     C                     MOVEL*BLANK    WN0138 10        Job Name
     C                     Z-ADD*ZERO     WN0139  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWIAIC3    WJAIC3           Company Number
     C                     MOVELWIV5ST    WJV5ST    P      Production Type
     C                     Z-ADDWIELDT    WJELDT           Production Date
     C                     Z-ADDWIHGCD    WJHGCD           Item Code
     C                     MOVELWIAJCD    WJAJCD    P      Warehouse Code
      *
     C           KLCHSN    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJV5ST           Production Type
     C                     KFLD           WJELDT           Production Date
     C                     KFLD           WJHGCD           Item Code
     C                     KFLD           WJAJCD           Warehouse Code
     C           KLCHSN    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YCRDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWN0062    WJUNW2           PS Weight Inv A
     C                     Z-ADDWN0063    WJCENB           PS Pieces Inv A
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * UPS CHGOBJ Stamp      IF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##PGM     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Prd Day Sts       RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WABCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADDWL0064    WAAIC3           Company Number
     C                     Z-ADDWL0065    WABCDT           Post to G/L Dat
      * Establish starting position
     C           KRSSO     CHAIN@AFREBE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0066           Production Day
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAWAST    WL0066           Production Day
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Prev Prd Dte      RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKAIC3    WQSP01           Company Number
      * Define keylist
     C           KPSSP     KLIST
     C                     KFLD           WQSP01           Company Number
     C                     KFLD           WKBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Company Number
      * Setup key
     C                     Z-ADDWL0067    WQSP01           Company Number
     C                     Z-ADDWL0068    WKBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSP     SETLL@AFREPU                    *
     C           KRSSP     READE@AFREPU                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Plant Date of Last Order EQ PAR.Plant Date of Last Orde
     C           WKBCDT    IFEQ WL0068                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Production Day Status is yes
     C           WKWAST    IFEQ 'Y'                        *IF
     C                     Z-ADDWKBCDT    WL0069           Production Date
     C                     GOTO SPEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSP     READE@AFREPU                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Productin Whs     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WLAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0070    WLAJCD           Warehouse Code
      * Establish starting position
     C           KRSSQ     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0071           Production Ware
     C                     Z-ADD*ZERO     WL0072           Accounting Comp
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWLAOCD    WL0071           Production Ware
     C                     Z-ADDWLBTC3    WL0072           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Val Sched Existance   RT - PS Prod Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMV5ST           Production Type
     C                     KFLD           WMELDT           Production Date
      * Setup key
     C                     Z-ADDWL0073    WMAIC3           Company Number
     C                     MOVELWL0074    WMV5ST           Production Type
     C                     Z-ADDWL0075    WMELDT           Production Date
      * Establish starting position
     C           KRSSR     CHAIN@JCCPVC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1795' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WL0076           Record Found US
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0076           Record Found US
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Avail Production  RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0152  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0153  70       PS Pieces Ship
     C                     MOVEL*BLANK    WN0154  1        Piece Count Ite
     C                     Z-ADD*ZERO     WN0155  70       Pieces Per Bag
     C                     Z-ADD*ZERO     WN0156  70       Bags Per Unit
     C                     Z-ADD*ZERO     WN0157  92       Weight Producti
     C                     Z-ADD*ZERO     WN0158  70       Pieces Producti
     C                     Z-ADD*ZERO     WN0159 112       OD Quantity Sch
     C                     Z-ADD*ZERO     WN0160 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0161  70       Pieces Allocate
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0082           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0152           PS Weight Ship
     C                     Z-ADD*ZERO     WN0153           PS Pieces Ship
     C                     Z-ADD*ZERO     WL0083           ATS Weight Avai
     C                     Z-ADD*ZERO     WL0084           ATS Pieces Avai
     C                     MOVEL*BLANK    WN0154           Piece Count Ite
     C                     Z-ADD*ZERO     WN0155           Pieces Per Bag
     C                     Z-ADD*ZERO     WN0156           Bags Per Unit
     C                     Z-ADD*ZERO     WN0157           Weight Producti
     C                     Z-ADD*ZERO     WN0158           Pieces Producti
     C                     Z-ADD*ZERO     WN0159           OD Quantity Sch
     C                     Z-ADD*ZERO     WN0160           OD Weight Sched
     C                     Z-ADD*ZERO     WN0161           Pieces Allocate
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIV5ST           Production Type
     C                     KFLD           WIELDT           Production Date
     C                     KFLD           WIHGCD           Item Code
     C                     KFLD           WIAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0077    WIAIC3           Company Number
     C                     MOVELWL0078    WIV5ST           Production Type
     C                     Z-ADDWL0079    WIELDT           Production Date
     C                     Z-ADDWL0080    WIHGCD           Item Code
     C                     MOVELWL0081    WIAJCD           Warehouse Code
      * Establish starting position
     C           KRSSS     CHAIN@I8CPUS              90    *
      * Data record not found
     C   90                MOVEL'USR1763' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Production = Standard + Prod Adj - Converted
      * Prod Avail = Production + Ship Cut Adj + Ship Adj - Prod Alloc
      * CASE: DB1.PS Lock Status is NOT LOCKED
     C           WIB5ST    IFEQ 'N'                        *IF
      * Ship Cut Adjust
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Chilling Time USR is GT Zero
      *   |- c2    : DB1.Production Date EQ JOB.*Job date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0085    IFGT *ZERO                      *IF
     C           WIELDT    IFEQ ##JDT                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Ship Cut Adjust   RT - PS Prod Item Schedule  * 
     C                     EXSR STRVGN
     C                     END                             *FI
      * Weight Production
      * PAR.Weight Production USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : DB1.PS Weight Standard
      * +     : PGM.*Synon (15,2) work field
      * x2    : DB1.PS Weight Prod Adj
      * -     : PGM.*Synon (15,2) work field
      * x3    : DB1.PS Weight Converted
     C           WIDXWG    ADD  WID1WG    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  WIWTCN    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0157           Weight Producti
      * Pieces Production
      * PAR.Pieces Production USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : DB1.PS Pieces Standard
      * +     : PGM.*Synon (15,0) work field
      * x2    : DB1.PS Pieces Prod Adj
      * -     : PGM.*Synon (15,0) work field
      * x3    : DB1.PS Pieces Converted
     C           WIB2NB    ADD  WICBNB    W0WJ01           *Synon (15,0) w
     C           W0WJ01    SUB  WIPSCV    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0158           Pieces Producti
      * Weight Available
      * PAR.ATS Weight Available USR =
      *    *COMPUTE (x1 + x2 + x3 - x4)
      * x1    : PAR.Weight Production USR
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.PS Weight Ship Cut Adj
      * +     : PGM.*Synon (15,2) work field
      * x3    : DB1.PS Weight Shipping Adj
      * -     : PGM.*Synon (15,2) work field
      * x4    : DB1.PS Weight Prod Allocated
     C           WN0157    ADD  WN0152    W0WA02           *Synon (15,2) w
     C           W0WA02    ADD  WISAWT    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  WIOAWT    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0083           ATS Weight Avai
      * Pieces Available
      * PAR.ATS Pieces Available USR =
      *    *COMPUTE (x1 + x2 + x3 - x4)
      * x1    : PAR.Pieces Production USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.PS Pieces Ship Cut Adj
      * +     : PGM.*Synon (15,0) work field
      * x3    : DB1.PS Pieces Shipping Adj
      * -     : PGM.*Synon (15,0) work field
      * x4    : DB1.PS Pieces Prod Allocated
     C           WN0158    ADD  WN0153    W0WJ02           *Synon (15,0) w
     C           W0WJ02    ADD  WIB9NB    W0WJ01           *Synon (15,0) w
     C           W0WJ01    SUB  WICDNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WL0084           ATS Pieces Avai
      * Weight Avail
      * CASE: PAR.ATS Weight Available USR is Less than zero
     C           WL0083    IFLT *ZERO                      *IF
     C                     Z-ADD*ZERO     WL0083           ATS Weight Avai
     C                     Z-ADD*ZERO     WL0084           ATS Pieces Avai
     C                     END                             *FI
     C                     Z-ADDWIF8WG    WL0082           PS Avg Piece Wg
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv Ship Cut Adjust   RT - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOAIC3    WQST01           Company Number
     C           *LIKE     DEFN WOHGCD    WQST02           Item Code
     C           *LIKE     DEFN WOAJCD    WQST03           Warehouse Code
     C           *LIKE     DEFN WOELDT    WQST04           Production Date
     C           *LIKE     DEFN WOV5ST    WQST05           Production Type
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           Company Number
     C                     KFLD           WQST02           Item Code
     C                     KFLD           WQST03           Warehouse Code
     C                     KFLD           WQST04           Production Date
     C                     KFLD           WQST05           Production Type
      * Setup key
     C                     Z-ADDWIAIC3    WQST01           Company Number
     C                     Z-ADDWIHGCD    WQST02           Item Code
     C                     MOVELWIAJCD    WQST03           Warehouse Code
     C                     Z-ADDWIGPDT    WQST04           Production Date
     C                     MOVEL'P'       WQST05           Production Type
      * Establish starting position
     C           KRSST     SETLL@I8CPXP                    *
     C           KRSST     READE@I8CPXP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0152           PS Weight Ship
     C                     Z-ADD*ZERO     WN0153           PS Pieces Ship
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWOE0WG    WN0152           PS Weight Ship
     C                     Z-ADDWOD6NB    WN0153           PS Pieces Ship
     C           KRSST     READE@I8CPXP                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Upd Ord Detail Sched  RT - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0162 112       OD Quantity Sch
     C                     Z-ADD*ZERO     WN0163 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0164 112       OD Quantity Inv
     C                     Z-ADD*ZERO     WN0165 112       OD Weight Inv S
     C                     Z-ADD*ZERO     WN0166 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0167 112       OD Weight Unuse
     C                     MOVEL*BLANK    WN0168  1        OD Added to Sch
     C                     MOVEL*BLANK    WN0169  1        OD Reallocate S
     C                     MOVEL*BLANK    WN0170  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0171  1        EDI Status 1
     C                     MOVEL*BLANK    WN0172  1        EDI Status 2
     C                     MOVEL*BLANK    WN0173  1        EDI Status 3
     C                     MOVEL*BLANK    WN0174  1        Record Status
     C                     Z-ADD*ZERO     WN0175  60       Job Time
     C                     MOVEL*BLANK    WN0176 10        User Id
     C                     MOVEL*BLANK    WN0177 10        Job Name
     C                     Z-ADD*ZERO     WN0178  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C                     KFLD           WGJGDT           OD Production D
      * Setup key
     C                     Z-ADDWL0086    WGAIC3           Company Number
     C                     Z-ADDWL0087    WGC4NB           Order Number
     C                     Z-ADDWL0088    WGDPNB           Order Sequence
     C                     Z-ADDWL0089    WGUENB           Order Secondary
     C                     Z-ADDWL0090    WGJGDT           OD Production D
      * Establish starting position
     C           KRSSU     CHAIN@KNCPHO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2238' W0RTN   7
      * USER: Processing if Data record not found
      * CRT Ord Detail Sched   CR - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0086    WL0033           Company Number
     C                     Z-ADDWL0087    WL0034           Order Number
     C                     Z-ADDWL0088    WL0035           Order Sequence
     C                     Z-ADDWL0089    WL0036           Order Secondary
     C                     Z-ADDWL0090    WL0037           OD Production D
     C                     Z-ADDWL0091    WL0038           Scheduled Ship
     C                     MOVELWL0092    WL0039    P      Warehouse Code
     C                     MOVELWL0093    WL0040    P      Order From Ware
     C                     Z-ADDWL0094    WL0041           Item Code
     C                     Z-ADDWL0096    WL0042           OD Quantity Sch
     C                     Z-ADDWL0095    WL0043           OD Weight Sched
     C                     Z-ADDWN0164    WL0044           OD Quantity Inv
     C                     Z-ADDWN0165    WL0045           OD Weight Inv S
     C                     Z-ADDWN0166    WL0046           OD Quantity Unu
     C                     Z-ADDWN0167    WL0047           OD Weight Unuse
     C                     MOVELWN0168    WL0048    P      OD Added to Sch
     C                     MOVELWN0169    WL0049    P      OD Reallocate S
     C                     MOVELWN0170    WL0050    P      OD Status Unuse
     C                     MOVELWN0171    WL0051    P      EDI Status 1
     C                     MOVELWN0172    WL0052    P      EDI Status 2
     C                     MOVELWN0173    WL0053    P      EDI Status 3
     C                     MOVELWN0174    WL0054    P      Record Status
     C                     Z-ADDWN0175    WL0055           Job Time
     C                     MOVELWN0176    WL0056    P      User Id
     C                     MOVELWN0177    WL0057    P      Job Name
     C                     Z-ADDWN0178    WL0058           Job Date
     C                     EXSR SJCRRC
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WGIGQT    ADD  WL0096    WN0162           OD Quantity Sch
     C           WGFLWG    ADD  WL0095    WN0163           OD Weight Sched
     C                     MOVELWGP7ST    YL0015           OD Added to Sch
      * CASE: PAR.Base/Conv/Loss Item is Converted/Fabricated
     C           WL0097    IFEQ 'C'                        *IF
     C           WL0097    OREQ 'F'
      * CASE: PAR.OD Production Date EQ JOB.*Job date
     C           WL0090    IFEQ ##JDT                      *IF
     C                     MOVEL'Y'       YL0015           OD Added to Sch
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.OD Quantity Scheduled is Greater than zero
     C           WN0162    IFGT *ZERO                      *IF
      * CHG Qty/Wgt Scheduled  CH - Order Detail Schedule  * 
     C                     EXSR SVCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWGAIC3    WL0059           Company Number
     C                     Z-ADDWGC4NB    WL0060           Order Number
     C                     Z-ADDWGDPNB    WL0061           Order Sequence
     C                     Z-ADDWGUENB    WL0062           Order Secondary
     C                     Z-ADDWGJGDT    WL0063           OD Production D
     C                     EXSR SKDLRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCHRC    BEGSR
      *================================================================
      * CHG Qty/Wgt Scheduled  CH - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0179  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0180  3        Warehouse Code
     C                     MOVEL*BLANK    WN0181  3        Order From Ware
     C                     Z-ADD*ZERO     WN0182  70       Item Code
     C                     Z-ADD*ZERO     WN0183 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0184 112       OD Weight Unuse
     C                     MOVEL*BLANK    WN0185  1        OD Reallocate S
     C                     MOVEL*BLANK    WN0186  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0187  1        EDI Status 1
     C                     MOVEL*BLANK    WN0188  1        EDI Status 2
     C                     MOVEL*BLANK    WN0189  1        EDI Status 3
     C                     MOVEL*BLANK    WN0190  1        Record Status
     C                     Z-ADD*ZERO     WN0191  60       Job Time
     C                     MOVEL*BLANK    WN0192 10        User Id
     C                     MOVEL*BLANK    WN0193 10        Job Name
     C                     Z-ADD*ZERO     WN0194  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @KNCPHN
     C                     Z-ADDWGAIC3    WHAIC3           Company Number
     C                     Z-ADDWGC4NB    WHC4NB           Order Number
     C                     Z-ADDWGDPNB    WHDPNB           Order Sequence
     C                     Z-ADDWGUENB    WHUENB           Order Secondary
     C                     Z-ADDWGJGDT    WHJGDT           OD Production D
      *
     C           KLCHSV    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHC4NB           Order Number
     C                     KFLD           WHDPNB           Order Sequence
     C                     KFLD           WHUENB           Order Secondary
     C                     KFLD           WHJGDT           OD Production D
     C           KLCHSV    CHAIN@KNCPHN              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDKN1    YDRDCS
      * Move non-key fields to @KNCPHN
     C                     Z-ADDWN0162    WHIGQT           OD Quantity Sch
     C                     Z-ADDWN0163    WHFLWG           OD Weight Sched
     C                     Z-ADDWGIUQT    WHIUQT           OD Quantity Inv
     C                     Z-ADDWGF3WG    WHF3WG           OD Weight Inv S
     C                     MOVELYL0015    WHP7ST    P      OD Added to Sch
      *
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##JOB     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@KNCPHN                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDKNCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Upd Prod Allocated    RT - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0195  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0196  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0197  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0198  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0199  92       PS Avg Piece Wg
     C                     Z-ADD*ZERO     WN0200  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0201  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0202  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0203  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0204  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0205  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0206  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0207  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0208  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0209  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0210  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0211  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0212  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0213  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0214  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0215  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0216  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0217  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0218 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0219  70       PS Pieces Fz Tf
     C                     Z-ADD*ZERO     WN0220 112       PS Weight Fz Tf
     C                     Z-ADD*ZERO     WN0221  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0222 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0223  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0224 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0225  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0226 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0227  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0228 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0229  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0230  3        PS Item Id
     C                     MOVEL*BLANK    WN0231  2        Warehouse Type
     C                     MOVEL*BLANK    WN0232  1        PS Lock Status
     C                     MOVEL*BLANK    WN0233  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0234  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0235  1        PS Piece Count
     C                     MOVEL*BLANK    WN0236  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0237  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0238  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0239  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0240  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0241  3        PS Production W
     C                     Z-ADD*ZERO     WN0242  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0243  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0244  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0245  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0246  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0247  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0248  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0249  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0250  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0251  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0252  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0253  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0254  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0255  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0256  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0257  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0258  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0259  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0260  6        Department Code
     C                     Z-ADD*ZERO     WN0261  30       Item Structure
     C                     Z-ADD*ZERO     WN0262  30       Item Structure
     C                     Z-ADD*ZERO     WN0263  30       Item Structure
     C                     MOVEL*BLANK    WN0264  6        Primal Group Co
     C                     MOVEL*BLANK    WN0265  1        EDI Status 1
     C                     MOVEL*BLANK    WN0266  1        EDI Status 2
     C                     MOVEL*BLANK    WN0267  1        EDI Status 3
     C                     MOVEL*BLANK    WN0268  1        Record Status
     C                     Z-ADD*ZERO     WN0269  60       Job Time
     C                     MOVEL*BLANK    WN0270 10        User Id
     C                     MOVEL*BLANK    WN0271 10        Job Name
     C                     Z-ADD*ZERO     WN0272  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIV5ST           Production Type
     C                     KFLD           WIELDT           Production Date
     C                     KFLD           WIHGCD           Item Code
     C                     KFLD           WIAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0098    WIAIC3           Company Number
     C                     MOVELWL0099    WIV5ST           Production Type
     C                     Z-ADDWL0100    WIELDT           Production Date
     C                     Z-ADDWL0101    WIHGCD           Item Code
     C                     MOVELWL0102    WIAJCD           Warehouse Code
      * Establish starting position
     C           KRSSW     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADDWL0103    WN0214           PS Weight Prod
     C                     Z-ADDWL0104    WN0215           PS Pieces Prod
      * CASE: PAR.PS Pieces Prod Allocated is GT Zero
     C           WN0215    IFGT *ZERO                      *IF
      * Average Piece Weight
      * PAR.PS Avg Piece Wgt =
      *    *COMPUTE (x1 / x2)
      * x1    : PAR.PS Weight Prod Allocated
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.PS Pieces Prod Allocated
     C           WN0214    DIV  WN0215    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0199           PS Avg Piece Wg
     C                     END                             *FI
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
     C                     EXSR SXCRRC
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WIOAWT    ADD  WL0103    WN0214           PS Weight Prod
     C           WICDNB    ADD  WL0104    WN0215           PS Pieces Prod
      * Chg Prod Allocated    CH - PS Prod Item Schedule  * 
     C                     EXSR TBCHRC
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCRRC    BEGSR
      *================================================================
      * UPS Crt Prod Detail   CR - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @I8CPUR
     C                     Z-ADDWL0098    WJAIC3           Company Number
     C                     MOVELWL0099    WJV5ST           Production Type
     C                     Z-ADDWL0100    WJELDT           Production Date
     C                     Z-ADDWL0101    WJHGCD           Item Code
     C                     MOVELWL0102    WJAJCD           Warehouse Code
     C                     Z-ADDWN0195    WJGPDT           PS Available Sh
     C                     Z-ADDWN0196    WJWTSP           PS Weight Plann
     C                     Z-ADDWN0197    WJQTSP           PS Pieces Plann
     C                     Z-ADDWN0198    WJDJPC           PS % of Carcass
     C                     Z-ADDWN0199    WJF8WG           PS Avg Piece Wg
     C                     Z-ADDWN0200    WJWTIN           PS Weight Inv O
     C                     Z-ADDWN0201    WJD5NB           PS Pieces Inv O
     C                     Z-ADDWN0202    WJDXWG           PS Weight Stand
     C                     Z-ADDWN0203    WJB2NB           PS Pieces Stand
     C                     Z-ADDWN0204    WJWTCN           PS Weight Conve
     C                     Z-ADDWN0205    WJPSCV           PS Pieces Conve
     C                     Z-ADDWN0206    WJSAWT           PS Weight Shipp
     C                     Z-ADDWN0207    WJB9NB           PS Pieces Shipp
     C                     Z-ADDWN0208    WJD1WG           PS Weight Prod
     C                     Z-ADDWN0209    WJCBNB           PS Pieces Prod
     C                     Z-ADDWN0210    WJEZWG           PS Weight Inv A
     C                     Z-ADDWN0211    WJCCNB           PS Pieces Inv A
     C                     Z-ADDWN0212    WJE0WG           PS Weight Ship
     C                     Z-ADDWN0213    WJD6NB           PS Pieces Ship
     C                     Z-ADDWN0214    WJOAWT           PS Weight Prod
     C                     Z-ADDWN0215    WJCDNB           PS Pieces Prod
     C                     Z-ADDWN0216    WJUNW2           PS Weight Inv A
     C                     Z-ADDWN0217    WJCENB           PS Pieces Inv A
     C                     Z-ADDWN0218    WJF9WG           PS Unit Weight
     C                     Z-ADDWN0219    WJBPNB           PS Pieces Fz Tf
     C                     Z-ADDWN0220    WJGAWG           PS Weight Fz Tf
     C                     Z-ADDWN0221    WJBQNB           PS Pieces Unuse
     C                     Z-ADDWN0222    WJGBWG           PS Weight Unuse
     C                     Z-ADDWN0223    WJBRNB           PS Pieces Unuse
     C                     Z-ADDWN0224    WJGCWG           PS Weight Unuse
     C                     Z-ADDWN0225    WJBSNB           PS Pieces Unuse
     C                     Z-ADDWN0226    WJGDWG           PS Weight Unuse
     C                     Z-ADDWN0227    WJBWNB           PS Pieces Unuse
     C                     Z-ADDWN0228    WJGEWG           PS Weight Unuse
     C                     Z-ADDWN0229    WJPS6U           PS Pieces Unuse
     C                     MOVELWN0230    WJWCST           PS Item Id
     C                     MOVELWN0231    WJWPST           Warehouse Type
     C                     MOVELWN0232    WJB5ST           PS Lock Status
     C                     MOVELWN0233    WJTFST           PS Export/Domes
     C                     MOVELWN0234    WJTEST           PS Print On Sch
     C                     MOVELWN0235    WJTHST           PS Piece Count
     C                     MOVELWN0236    WJUDST           PS Unused Sts 1
     C                     MOVELWN0237    WJUFST           PS Unused Sts 2
     C                     MOVELWN0238    WJUGST           PS Unused Sts 3
     C                     MOVELWN0239    WJUHST           PS Unused Sts 4
     C                     MOVELWN0240    WJB6ST           PS Item Sched N
     C                     MOVELWN0241    WJB7ST           PS Production W
     C                     Z-ADDWN0242    WJDVWG           PS Weight Order
     C                     Z-ADDWN0243    WJD7NB           PS Pieces Order
     C                     Z-ADDWN0244    WJFCAD           PS Weight FC Ad
     C                     Z-ADDWN0245    WJD9NB           PS Pieces FC Ad
     C                     Z-ADDWN0246    WJDWWG           PS Weight FX Ad
     C                     Z-ADDWN0247    WJEANB           PS Pieces FX Ad
     C                     Z-ADDWN0248    WJSHWT           PS Weight Sched
     C                     Z-ADDWN0249    WJEBNB           PS Pieces Sched
     C                     Z-ADDWN0250    WJAVWT           PS Weight Avail
     C                     Z-ADDWN0251    WJECNB           PS Pieces Avail
     C                     Z-ADDWN0252    WJWTON           PS Weight Produ
     C                     Z-ADDWN0253    WJEDNB           PS Pieces Produ
     C                     Z-ADDWN0254    WJFNWT           PS Weight Fab N
     C                     Z-ADDWN0255    WJEENB           PS Pieces Fab N
     C                     Z-ADDWN0256    WJQTAS           PS Weight Sched
     C                     Z-ADDWN0257    WJEFNB           PS Pieces Sched
     C                     Z-ADDWN0258    WJWAIO           PS Weight Sched
     C                     Z-ADDWN0259    WJEGNB           PS Pieces Sched
     C                     MOVELWN0260    WJR3CD           Department Code
     C                     Z-ADDWN0261    WJRGNB           Item Structure
     C                     Z-ADDWN0262    WJRHNB           Item Structure
     C                     Z-ADDWN0263    WJRINB           Item Structure
     C                     MOVELWN0264    WJXRCD           Primal Group Co
     C                     MOVELWN0265    WJUVST           EDI Status 1
     C                     MOVELWN0266    WJUWST           EDI Status 2
     C                     MOVELWN0267    WJUXST           EDI Status 3
     C                     MOVELWN0268    WJVSST           Record Status
     C                     Z-ADDWN0269    WJAATM           Job Time
     C                     MOVELWN0270    WJAYNA           User Id
     C                     MOVELWN0271    WJA0NA           Job Name
     C                     Z-ADDWN0272    WJAXDT           Job Date
      *
      * USER: Processing before Data update
      * BPS Setup Item Info   IF
      *
     C                     Z-ADD*ZERO     WN0273 155       System Value Nu
      *
      * UPS Rtv Company/Item  IF
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWJAIC3    WL0105           Company Number
     C                     Z-ADDWJHGCD    WL0106           Item Code
     C                     EXSR SYRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0107    WUAVNA    P      Description Lin
     C                     MOVELWL0108    WUADCD    P      U/M - Primary
     C                     Z-ADDWL0109    WUAIWG           Unit Weight
     C                     Z-ADDWL0110    WJRINB           Item Structure
     C                     Z-ADDWL0111    WJRHNB           Item Structure
     C                     Z-ADDWL0112    WJRGNB           Item Structure
     C                     MOVELWL0113    WUN0CD    P      Item Type Code
     C                     MOVELWL0114    WUQ1CD    P      Default Warehou
     C                     Z-ADDWL0115    WUCHTM           Fresh Chilling
     C                     MOVELWL0116    WUQZCD    P      Base/Conv/Loss
     C                     MOVELWL0117    WUXWST    P      Variety/Rendere
     C                     MOVELWL0118    WUVMST    P      Credit Item Sta
     C                     Z-ADDWL0119    WUSWGH           Std Weight/Head
     C                     Z-ADDWL0120    WUPPHE           Pieces Per Head
     C                     MOVELWL0121    WJR3CD    P      Department Code
     C                     MOVELWL0122    WUSDCD    P      Group for Packa
     C                     MOVELWL0123    WUX5ST    P      Seconds Item
     C                     MOVELWL0124    WJTHST    P      Piece Count Ite
     C                     Z-ADDWL0125    WUBDNB           Pieces Per Bag
     C                     Z-ADDWL0126    WUBJNB           Bags Per Unit
     C                     MOVELWL0127    WJTFST    P      Export/Domestic
     C                     MOVELWL0128    WJTEST    P      Print On Schedu
     C                     MOVELWL0129    WUSYST    P      Fresh Inv Alloc
     C                     MOVELWL0130    WUSZST    P      Fresh Sched As
     C                     MOVELWL0131    WUS1ST    P      Frozen Sched As
     C                     MOVELWL0132    WJXRCD    P      Primal Group Co
      * BPS Rtv Whs Info      RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWJAJCD    WL0133    P      Warehouse Code
     C                     EXSR SZRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0134    WJWPST    P      Warehouse Type
     C                     MOVELWL0135    WUXUST    P      Trans Contol AS
     C                     MOVELWL0136    WUT0ST    P      Warehouse Locat
     C                     MOVELWL0137    WUT1ST    P      Warehouse Std C
     C                     Z-ADDWL0138    WUDBNB           Warehouse Chill
      * BPS Set Up Item Id    IF
      * CASE: PAR.Item Type Code is Raw Materials
     C           WUN0CD    IFEQ 'RM'                       *IF
     C                     MOVEL'RMB'     WJWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Seconds Item is Yes
     C           WUX5ST    IFEQ 'Y'                        *IF
     C                     MOVEL'FSC'     WJWCST           PS Item Id
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Variety/Rendered/Cut is Variety
     C           WUXWST    IFEQ 'V'                        *IF
     C                     MOVEL'FVR'     WJWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Rendered
     C           WUXWST    IFEQ 'R'                        *IF
     C                     MOVEL'FRD'     WJWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Variety/Rendered/Cut is Cut
     C           WUXWST    IFEQ 'C'                        *IF
      * Base/Converted/Fabricated
      * CASE: PAR.Credit Item Status is yes
     C           WUVMST    IFEQ 'Y'                        *IF
      * Setup Base/Converted/Fabricated Credit
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FBC'     WJWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCC'     WJWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFC'     WJWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLC'     WJWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup Base/Converted/Fabricated
      * CASE: PAR.Converted/Base Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'FGB'     WJWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Converted
     C           WUQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'FCV'     WJWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Fabricated
     C           WUQZCD    IFEQ 'F'                        *IF
     C                     MOVEL'FFB'     WJWCST           PS Item Id
     C                     ELSE
      * CASE: PAR.Converted/Base Item is Loss
     C           WUQZCD    IFEQ 'L'                        *IF
     C                     MOVEL'FLS'     WJWCST           PS Item Id
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * FP1054 Output PS Prod Warehouse
      * Rtv Productin Whs     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWJAJCD    WL0070    P      Warehouse Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0071    WJB7ST    P      Production Ware
     C                     Z-ADDWL0072    YL0016           Accounting Comp
      * Available Ship Date
      * CASE: WRK.Warehouse Std Chill Time is yes
     C           WUT1ST    IFEQ 'Y'                        *IF
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWJAIC3    WL0139           Company Number
     C                     Z-ADDWL0100    WL0140           Post to G/L Dat
     C                     Z-ADDWUDBNB    WL0141           Fresh Chilling
     C                     EXSR TARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0142    WJGPDT           PS Available Sh
     C                     ELSE
      * CASE: *OTHERWISE
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWJAIC3    WL0139           Company Number
     C                     Z-ADDWL0100    WL0140           Post to G/L Dat
     C                     Z-ADDWUCHTM    WL0141           Fresh Chilling
     C                     EXSR TARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0142    WJGPDT           PS Available Sh
     C                     END                             *FI
      * Average Piece Weight
      * CASE: PAR.PS Pieces Planned Prod is GT Zero
     C           WN0197    IFGT *ZERO                      *IF
     C           WN0196    DIV  WN0197    WJF8WG    H      PS Avg Piece Wg
     C                     END                             *FI
      * UPS CRTOBJ Stamp      IF
     C                     MOVEL'A'       WJVSST           Record Status
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##PGM     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
     C                     MOVEL'N'       WJB5ST           PS Lock Status
     C           KLCRSX    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJV5ST           Production Type
     C                     KFLD           WJELDT           Production Date
     C                     KFLD           WJHGCD           Item Code
     C                     KFLD           WJAJCD           Warehouse Code
      * Check for duplicate primary key
     C           KLCRSX    SETLL@I8CPUR                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1764' W0RTN   7
      * Send message 'PS Prod Item Schedule  EX'
     C                     MOVEL'USR1764' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C                     WRITE@I8CPUR                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv Prd Sch Info   PS RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0105    WRAIC3           Company Number
     C                     Z-ADDWL0106    WRHGCD           Item Code
      * Establish starting position
     C           KRSSY     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0107           Description Lin
     C                     MOVEL*BLANK    WL0108           U/M - Primary
     C                     Z-ADD*ZERO     WL0109           Unit Weight
     C                     Z-ADD*ZERO     WL0110           Item Structure
     C                     Z-ADD*ZERO     WL0111           Item Structure
     C                     Z-ADD*ZERO     WL0112           Item Structure
     C                     MOVEL*BLANK    WL0113           Item Type Code
     C                     MOVEL*BLANK    WL0114           Default Warehou
     C                     Z-ADD*ZERO     WL0115           Fresh Chilling
     C                     MOVEL*BLANK    WL0116           Base/Conv/Loss
     C                     MOVEL*BLANK    WL0117           Variety/Rendere
     C                     MOVEL*BLANK    WL0118           Credit Item Sta
     C                     Z-ADD*ZERO     WL0119           Std Weight/Head
     C                     Z-ADD*ZERO     WL0120           Pieces Per Head
     C                     MOVEL*BLANK    WL0121           Department Code
     C                     MOVEL*BLANK    WL0122           Group for Packa
     C                     MOVEL*BLANK    WL0123           Seconds Item
     C                     MOVEL*BLANK    WL0124           Piece Count Ite
     C                     Z-ADD*ZERO     WL0125           Pieces Per Bag
     C                     Z-ADD*ZERO     WL0126           Bags Per Unit
     C                     MOVEL*BLANK    WL0127           Export/Domestic
     C                     MOVEL*BLANK    WL0128           Print On Schedu
     C                     MOVEL*BLANK    WL0129           Fresh Inv Alloc
     C                     MOVEL*BLANK    WL0130           Fresh Sched As
     C                     MOVEL*BLANK    WL0131           Frozen Sched As
     C                     MOVEL*BLANK    WL0132           Primal Group Co
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWRAVNA    WL0107           Description Lin
     C                     MOVELWRADCD    WL0108           U/M - Primary
     C                     Z-ADDWRAIWG    WL0109           Unit Weight
     C                     Z-ADDWRRINB    WL0110           Item Structure
     C                     Z-ADDWRRHNB    WL0111           Item Structure
     C                     Z-ADDWRRGNB    WL0112           Item Structure
     C                     MOVELWRN0CD    WL0113           Item Type Code
     C                     MOVELWRQ1CD    WL0114           Default Warehou
     C                     Z-ADDWRCHTM    WL0115           Fresh Chilling
     C                     MOVELWRQZCD    WL0116           Base/Conv/Loss
     C                     MOVELWRXWST    WL0117           Variety/Rendere
     C                     MOVELWRVMST    WL0118           Credit Item Sta
     C                     Z-ADDWRSWGH    WL0119           Std Weight/Head
     C                     Z-ADDWRPPHE    WL0120           Pieces Per Head
     C                     MOVELWRR3CD    WL0121           Department Code
     C                     MOVELWRSDCD    WL0122           Group for Packa
     C                     MOVELWRX5ST    WL0123           Seconds Item
     C                     MOVELWRPCCT    WL0124           Piece Count Ite
     C                     Z-ADDWRBDNB    WL0125           Pieces Per Bag
     C                     Z-ADDWRBJNB    WL0126           Bags Per Unit
     C                     MOVELWRSUST    WL0127           Export/Domestic
     C                     MOVELWRSVST    WL0128           Print On Schedu
     C                     MOVELWRSYST    WL0129           Fresh Inv Alloc
     C                     MOVELWRSZST    WL0130           Fresh Sched As
     C                     MOVELWRS1ST    WL0131           Frozen Sched As
     C                     MOVELWRXRCD    WL0132           Primal Group Co
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * BPS Rtv Whs Info      RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WSAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0133    WSAJCD           Warehouse Code
      * Establish starting position
     C           KRSSZ     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0134           Warehouse Type
     C                     MOVEL*BLANK    WL0135           Trans Contol AS
     C                     MOVEL*BLANK    WL0136           Warehouse Locat
     C                     MOVEL*BLANK    WL0137           Warehouse Std C
     C                     Z-ADD*ZERO     WL0138           Warehouse Chill
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWSWPST    WL0134           Warehouse Type
     C                     MOVELWSXUST    WL0135           Trans Contol AS
     C                     MOVELWST0ST    WL0136           Warehouse Locat
     C                     MOVELWST1ST    WL0137           Warehouse Std C
     C                     Z-ADDWSDBNB    WL0138           Warehouse Chill
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * UPS Clc Avail Shp Dte RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQTA01           Company Number
      * Define keylist
     C           KPSTA     KLIST
     C                     KFLD           WQTA01           Company Number
     C                     KFLD           WABCDT           Post to G/L Dat
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           Company Number
      * Setup key
     C                     Z-ADDWL0139    WQTA01           Company Number
     C                     Z-ADDWL0140    WABCDT           Post to G/L Dat
      * Establish starting position
     C           KPSTA     SETLL@AFREBE                    *
     C           KRSTA     READE@AFREBE                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DOC:  Change Log
     C                     EXSR UBSUBR                     DOC:  Change Lo
      * CASE: WRK.Count USR EQ PAR.Chilling Time
     C           WUCNTU    IFEQ WL0141                     *IF
     C                     Z-ADDWABCDT    WL0142           PS Available Sh
     C                     GOTO TAEXIT                     *QUIT
     C                     END                             *FI
      * 04/10/07 PKD No offset, so do not check for Saturday.
     C                     ADD  1         WUCNTU           Count USR
     C           KRSTA     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBCHRC    BEGSR
      *================================================================
      * Chg Prod Allocated    CH - PS Prod Item Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0274  70       PS Available Sh
     C                     Z-ADD*ZERO     WN0275  92       PS Weight Plann
     C                     Z-ADD*ZERO     WN0276  70       PS Pieces Plann
     C                     Z-ADD*ZERO     WN0277  72       PS % of Carcass
     C                     Z-ADD*ZERO     WN0278  92       PS Weight Inv O
     C                     Z-ADD*ZERO     WN0279  70       PS Pieces Inv O
     C                     Z-ADD*ZERO     WN0280  92       PS Weight Stand
     C                     Z-ADD*ZERO     WN0281  70       PS Pieces Stand
     C                     Z-ADD*ZERO     WN0282  92       PS Weight Conve
     C                     Z-ADD*ZERO     WN0283  70       PS Pieces Conve
     C                     Z-ADD*ZERO     WN0284  92       PS Weight Shipp
     C                     Z-ADD*ZERO     WN0285  70       PS Pieces Shipp
     C                     Z-ADD*ZERO     WN0286  92       PS Weight Prod
     C                     Z-ADD*ZERO     WN0287  70       PS Pieces Prod
     C                     Z-ADD*ZERO     WN0288  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0289  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0290  92       PS Weight Ship
     C                     Z-ADD*ZERO     WN0291  70       PS Pieces Ship
     C                     Z-ADD*ZERO     WN0292  92       PS Weight Inv A
     C                     Z-ADD*ZERO     WN0293  70       PS Pieces Inv A
     C                     Z-ADD*ZERO     WN0294 112       PS Unit Weight
     C                     Z-ADD*ZERO     WN0295  70       PS Pieces Fz Tf
     C                     Z-ADD*ZERO     WN0296 112       PS Weight Fz Tf
     C                     Z-ADD*ZERO     WN0297  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0298 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0299  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0300 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0301  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0302 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0303  70       PS Pieces Unuse
     C                     Z-ADD*ZERO     WN0304 112       PS Weight Unuse
     C                     Z-ADD*ZERO     WN0305  70       PS Pieces Unuse
     C                     MOVEL*BLANK    WN0306  3        PS Item Id
     C                     MOVEL*BLANK    WN0307  2        Warehouse Type
     C                     MOVEL*BLANK    WN0308  1        PS Lock Status
     C                     MOVEL*BLANK    WN0309  1        PS Export/Domes
     C                     MOVEL*BLANK    WN0310  1        PS Print On Sch
     C                     MOVEL*BLANK    WN0311  1        PS Piece Count
     C                     MOVEL*BLANK    WN0312  1        PS Unused Sts 1
     C                     MOVEL*BLANK    WN0313  1        PS Unused Sts 2
     C                     MOVEL*BLANK    WN0314  1        PS Unused Sts 3
     C                     MOVEL*BLANK    WN0315  1        PS Unused Sts 4
     C                     MOVEL*BLANK    WN0316  2        PS Item Sched N
     C                     MOVEL*BLANK    WN0317  3        PS Production W
     C                     Z-ADD*ZERO     WN0318  92       PS Weight Order
     C                     Z-ADD*ZERO     WN0319  70       PS Pieces Order
     C                     Z-ADD*ZERO     WN0320  92       PS Weight FC Ad
     C                     Z-ADD*ZERO     WN0321  70       PS Pieces FC Ad
     C                     Z-ADD*ZERO     WN0322  92       PS Weight FX Ad
     C                     Z-ADD*ZERO     WN0323  70       PS Pieces FX Ad
     C                     Z-ADD*ZERO     WN0324  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0325  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0326  92       PS Weight Avail
     C                     Z-ADD*ZERO     WN0327  70       PS Pieces Avail
     C                     Z-ADD*ZERO     WN0328  92       PS Weight Produ
     C                     Z-ADD*ZERO     WN0329  70       PS Pieces Produ
     C                     Z-ADD*ZERO     WN0330  92       PS Weight Fab N
     C                     Z-ADD*ZERO     WN0331  70       PS Pieces Fab N
     C                     Z-ADD*ZERO     WN0332  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0333  70       PS Pieces Sched
     C                     Z-ADD*ZERO     WN0334  92       PS Weight Sched
     C                     Z-ADD*ZERO     WN0335  70       PS Pieces Sched
     C                     MOVEL*BLANK    WN0336  6        Department Code
     C                     Z-ADD*ZERO     WN0337  30       Item Structure
     C                     Z-ADD*ZERO     WN0338  30       Item Structure
     C                     Z-ADD*ZERO     WN0339  30       Item Structure
     C                     MOVEL*BLANK    WN0340  6        Primal Group Co
     C                     MOVEL*BLANK    WN0341  1        EDI Status 1
     C                     MOVEL*BLANK    WN0342  1        EDI Status 2
     C                     MOVEL*BLANK    WN0343  1        EDI Status 3
     C                     MOVEL*BLANK    WN0344  1        Record Status
     C                     Z-ADD*ZERO     WN0345  60       Job Time
     C                     MOVEL*BLANK    WN0346 10        User Id
     C                     MOVEL*BLANK    WN0347 10        Job Name
     C                     Z-ADD*ZERO     WN0348  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @I8CPUR
     C                     Z-ADDWIAIC3    WJAIC3           Company Number
     C                     MOVELWIV5ST    WJV5ST    P      Production Type
     C                     Z-ADDWIELDT    WJELDT           Production Date
     C                     Z-ADDWIHGCD    WJHGCD           Item Code
     C                     MOVELWIAJCD    WJAJCD    P      Warehouse Code
      *
     C           KLCHTB    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJV5ST           Production Type
     C                     KFLD           WJELDT           Production Date
     C                     KFLD           WJHGCD           Item Code
     C                     KFLD           WJAJCD           Warehouse Code
     C           KLCHTB    CHAIN@I8CPUR              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDI8CPL0'MDACP
     C                     MOVEL'@I8CPUR' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDI81    YERDCS
      * Move non-key fields to @I8CPUR
     C                     Z-ADDWIF8WG    WJF8WG           PS Avg Piece Wg
     C                     Z-ADDWN0214    WJOAWT           PS Weight Prod
     C                     Z-ADDWN0215    WJCDNB           PS Pieces Prod
      *
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * UPS CHGOBJ Stamp      IF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##PGM     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDI81    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@I8CPUR                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDI8CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Clc Date (descending) RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKAIC3    WQTC01           Company Number
      * Define keylist
     C           KPSTC     KLIST
     C                     KFLD           WQTC01           Company Number
     C                     KFLD           WKBCDT           Post to G/L Dat
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WQTC01           Company Number
      * Setup key
     C                     Z-ADDWL0143    WQTC01           Company Number
     C                     Z-ADDWL0144    WKBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSTC     SETLL@AFREPU                    *
     C           KRSTC     READE@AFREPU                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Post to G/L Date EQ DB1.Post to G/L Date
     C           WL0144    IFEQ WKBCDT                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
      * CASE: WRK.Count USR EQ PAR.*Duration (factor)
     C           WUCNTU    IFEQ WL0147                     *IF
     C                     Z-ADDWKBCDT    WL0145           *Date1 (ending)
     C                     GOTO TCEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTC     READE@AFREPU                  90*
     C                     ENDDO
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Clc Date (ascending)  RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTAIC3    WQTD01           Company Number
      * Define keylist
     C           KPSTD     KLIST
     C                     KFLD           WQTD01           Company Number
     C                     KFLD           WTBCDT           Post to G/L Dat
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           Company Number
      * Setup key
     C                     Z-ADDWL0148    WQTD01           Company Number
     C                     Z-ADDWL0149    WTBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSTD     SETLL@AFREYY                    *
     C           KRSTD     READE@AFREYY                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Post to G/L Date EQ DB1.Post to G/L Date
     C           WL0149    IFEQ WTBCDT                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
      * CASE: WRK.Count USR EQ PAR.*Duration (factor)
     C           WUCNTU    IFEQ WL0152                     *IF
     C                     Z-ADDWTBCDT    WL0150           *Date1 (ending)
     C                     GOTO TDEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTD     READE@AFREYY                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * DOC:  Allocation
      *================================================================
      * Backward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      * Forward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * DOC:  Change Log
      *================================================================
      * 04/10/07 Effective 04/23/07 representation of Age Code changes
      *          will be such that Age Code A will be 0 day for boxes
      *          and combos.  The labels on the cartons will not print
      *          a date that is offset by Sunday or Holiday.  Instead of
      *          Code Date, it will be the Pack Date.
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * DOC:  Allocation
      *================================================================
      * Backward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      * Forward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * DOC:  Allocation
      *================================================================
      * Backward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      * Forward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * DOC:  Allocation
      *================================================================
      * Backward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      * Forward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * DOC:  Allocation
      *================================================================
      * Backward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      * Forward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * DOC:  Allocation
      *================================================================
      * Backward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      * Forward Allocation
      * c1 & c2 & c3
      * c1: PAR.Production Date GE PAR.Production Date RGF
      * c2: PAR.Production Date GE JOB.*Job date
      * c3: PAR.ATS Quantity Need USR is Greater than zero
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1ELDT           Production Date
     C                     Z-ADD*ZERO     P1GVDT           Production Date
     C                     Z-ADD*ZERO     P1GWDT           Production Date
     C                     Z-ADD*ZERO     P1EINB           Week Number
     C                     Z-ADD*ZERO     P1ESNB           Accounting Year
     C                     Z-ADD*ZERO     P1ETNB           Accounting Peri
     C                     Z-ADD*ZERO     P1BZNB           OM Week
     C                     Z-ADD*ZERO     P1LHDT           Week Begin Date
     C                     Z-ADD*ZERO     P1LIDT           Week End Date
     C                     MOVEL*BLANK    P3AOCD           Production Ware
     C                     Z-ADD*ZERO     P4AODT           Scheduled Ship
     C                     MOVEL*BLANK    P4AYAA           Order From Ware
     C                     Z-ADD*ZERO     P5CSHD           Chill Time USR
      *
      * Initialise indicators for re-entry
     C                     MOVE '0'       *IN
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Day NBR USR
     C                     Z-ADD*ZERO     WUDNBU  20
      * Define work field Julian Date
     C                     Z-ADD*ZERO     WUCQNB  50
      * Define work field Day of Week
     C                     MOVEL*BLANK    WUA9ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WABCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WACQNB           Julian Date
     C                     Z-ADD*ZERO     WAESNB           Accounting Year
     C                     Z-ADD*ZERO     WAETNB           Accounting Peri
     C                     Z-ADD*ZERO     WABZNB           OM Week
     C                     Z-ADD*ZERO     WAEINB           Week Number
     C                     Z-ADD*ZERO     WAAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WAOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WANQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WANRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WAOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WAOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCELDT           Production Date
     C                     Z-ADD*ZERO     WCACWG           Quantity on Han
     C                     Z-ADD*ZERO     WCARQT           Quantity on Han
     C                     Z-ADD*ZERO     WCK7DT           Label Date
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDDPNB           Order Sequence
     C                     Z-ADD*ZERO     WDUENB           Order Secondary
     C                     Z-ADD*ZERO     WDJGDT           OD Production D
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDIUQT           OD Quantity Inv
     C                     Z-ADD*ZERO     WDF3WG           OD Weight Inv S
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGC4NB           Order Number
     C                     Z-ADD*ZERO     WGDPNB           Order Sequence
     C                     Z-ADD*ZERO     WGUENB           Order Secondary
     C                     Z-ADD*ZERO     WGJGDT           OD Production D
     C                     Z-ADD*ZERO     WGAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGIGQT           OD Quantity Sch
     C                     Z-ADD*ZERO     WGFLWG           OD Weight Sched
     C                     Z-ADD*ZERO     WGIUQT           OD Quantity Inv
     C                     Z-ADD*ZERO     WGF3WG           OD Weight Inv S
     C                     Z-ADD*ZERO     WGIVQT           OD Quantity Unu
     C                     Z-ADD*ZERO     WGF4WG           OD Weight Unuse
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIELDT           Production Date
     C                     Z-ADD*ZERO     WIHGCD           Item Code
     C                     Z-ADD*ZERO     WIGPDT           PS Available Sh
     C                     Z-ADD*ZERO     WIWTSP           PS Weight Plann
     C                     Z-ADD*ZERO     WIQTSP           PS Pieces Plann
     C                     Z-ADD*ZERO     WIDJPC           PS % of Carcass
     C                     Z-ADD*ZERO     WIF8WG           PS Avg Piece Wg
     C                     Z-ADD*ZERO     WIWTIN           PS Weight Inv O
     C                     Z-ADD*ZERO     WID5NB           PS Pieces Inv O
     C                     Z-ADD*ZERO     WIDXWG           PS Weight Stand
     C                     Z-ADD*ZERO     WIB2NB           PS Pieces Stand
     C                     Z-ADD*ZERO     WIWTCN           PS Weight Conve
     C                     Z-ADD*ZERO     WIPSCV           PS Pieces Conve
     C                     Z-ADD*ZERO     WISAWT           PS Weight Shipp
     C                     Z-ADD*ZERO     WIB9NB           PS Pieces Shipp
     C                     Z-ADD*ZERO     WID1WG           PS Weight Prod
     C                     Z-ADD*ZERO     WICBNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WIEZWG           PS Weight Inv A
     C                     Z-ADD*ZERO     WICCNB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WIE0WG           PS Weight Ship
     C                     Z-ADD*ZERO     WID6NB           PS Pieces Ship
     C                     Z-ADD*ZERO     WIOAWT           PS Weight Prod
     C                     Z-ADD*ZERO     WICDNB           PS Pieces Prod
     C                     Z-ADD*ZERO     WIUNW2           PS Weight Inv A
     C                     Z-ADD*ZERO     WICENB           PS Pieces Inv A
     C                     Z-ADD*ZERO     WIF9WG           PS Unit Weight
     C                     Z-ADD*ZERO     WIBPNB           PS Pieces Fz Tf
     C                     Z-ADD*ZERO     WIGAWG           PS Weight Fz Tf
     C                     Z-ADD*ZERO     WIBQNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WIGBWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WIBRNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WIGCWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WIBSNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WIGDWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WIBWNB           PS Pieces Unuse
     C                     Z-ADD*ZERO     WIGEWG           PS Weight Unuse
     C                     Z-ADD*ZERO     WIPS6U           PS Pieces Unuse
     C                     Z-ADD*ZERO     WIDVWG           PS Weight Order
     C                     Z-ADD*ZERO     WID7NB           PS Pieces Order
     C                     Z-ADD*ZERO     WIFCAD           PS Weight FC Ad
     C                     Z-ADD*ZERO     WID9NB           PS Pieces FC Ad
     C                     Z-ADD*ZERO     WIDWWG           PS Weight FX Ad
     C                     Z-ADD*ZERO     WIEANB           PS Pieces FX Ad
     C                     Z-ADD*ZERO     WISHWT           PS Weight Sched
     C                     Z-ADD*ZERO     WIEBNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WIAVWT           PS Weight Avail
     C                     Z-ADD*ZERO     WIECNB           PS Pieces Avail
     C                     Z-ADD*ZERO     WIWTON           PS Weight Produ
     C                     Z-ADD*ZERO     WIEDNB           PS Pieces Produ
     C                     Z-ADD*ZERO     WIFNWT           PS Weight Fab N
     C                     Z-ADD*ZERO     WIEENB           PS Pieces Fab N
     C                     Z-ADD*ZERO     WIQTAS           PS Weight Sched
     C                     Z-ADD*ZERO     WIEFNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WIWAIO           PS Weight Sched
     C                     Z-ADD*ZERO     WIEGNB           PS Pieces Sched
     C                     Z-ADD*ZERO     WIRGNB           Item Structure
     C                     Z-ADD*ZERO     WIRHNB           Item Structure
     C                     Z-ADD*ZERO     WIRINB           Item Structure
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WLBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WLBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WLBUC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WLBVC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUWXST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMELDT           Production Date
     C                     Z-ADD*ZERO     WMHVHD           Hog Volume
     C                     Z-ADD*ZERO     WMZ6NB           Average Live We
     C                     Z-ADD*ZERO     WMZ7NB           Average Hot Wei
     C                     Z-ADD*ZERO     WMDGPC           Cooler Shrink P
     C                     Z-ADD*ZERO     WMAVCW           Average Cold We
     C                     Z-ADD*ZERO     WMDIPC           Average Lean Pe
     C                     Z-ADD*ZERO     WMZ0NB           Average Backfat
     C                     Z-ADD*ZERO     WMAVLE           Average Loin-Ey
     C                     Z-ADD*ZERO     WMECWG           Hot Weight Tota
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field U/M - Primary
     C                     MOVEL*BLANK    WUADCD  2
      * Define work field Unit Weight
     C                     Z-ADD*ZERO     WUAIWG 112
      * Define work field Item Type Code
     C                     MOVEL*BLANK    WUN0CD  3
      * Define work field Default Warehouse
     C                     MOVEL*BLANK    WUQ1CD  3
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Define work field Base/Conv/Loss Item
     C                     MOVEL*BLANK    WUQZCD  2
      * Define work field Variety/Rendered/Cut
     C                     MOVEL*BLANK    WUXWST  1
      * Define work field Credit Item Status
     C                     MOVEL*BLANK    WUVMST  1
      * Define work field Std Weight/Head (Var/Ren)
     C                     Z-ADD*ZERO     WUSWGH 112
      * Define work field Pieces Per Head
     C                     Z-ADD*ZERO     WUPPHE  70
      * Define work field Group for Packaging
     C                     MOVEL*BLANK    WUSDCD  1
      * Define work field Seconds Item
     C                     MOVEL*BLANK    WUX5ST  1
      * Define work field Pieces Per Bag
     C                     Z-ADD*ZERO     WUBDNB  70
      * Define work field Bags Per Unit
     C                     Z-ADD*ZERO     WUBJNB  70
      * Define work field Fresh Inv Allocation Seq
     C                     MOVEL*BLANK    WUSYST  1
      * Define work field Fresh Sched As Ordered
     C                     MOVEL*BLANK    WUSZST  1
      * Define work field Frozen Sched As Ordered
     C                     MOVEL*BLANK    WUS1ST  1
      * Define work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    WUXUST  1
      * Define work field Warehouse Location
     C                     MOVEL*BLANK    WUT0ST  1
      * Define work field Warehouse Std Chill Time
     C                     MOVEL*BLANK    WUT1ST  1
      * Define work field Warehouse Chill Time
     C                     Z-ADD*ZERO     WUDBNB  52
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRAIC3           Company Number
     C                     Z-ADD*ZERO     WRHGCD           Item Code
     C                     Z-ADD*ZERO     WRAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WRAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WRAIWG           Unit Weight
     C                     Z-ADD*ZERO     WRCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WRC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WRURTN           Number Cases On
     C                     Z-ADD*ZERO     WRAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WRRINB           Item Structure
     C                     Z-ADD*ZERO     WRRHNB           Item Structure
     C                     Z-ADD*ZERO     WRRGNB           Item Structure
     C                     Z-ADD*ZERO     WRTFNB           Transportation
     C                     Z-ADD*ZERO     WRTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WRTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WRBLPR           Market Overage
     C                     Z-ADD*ZERO     WRBMPR           Standard Overag
     C                     Z-ADD*ZERO     WRCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WRCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WRSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WRPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WRICN1           Item Category N
     C                     Z-ADD*ZERO     WRICN2           Item Category N
     C                     Z-ADD*ZERO     WRV2NB           Item Category N
     C                     Z-ADD*ZERO     WRITCN           Item Category N
     C                     Z-ADD*ZERO     WRITC5           Item Category N
     C                     Z-ADD*ZERO     WRICN6           Item Category N
     C                     Z-ADD*ZERO     WRICN7           Item Category N
     C                     Z-ADD*ZERO     WRICN8           Item Category N
     C                     Z-ADD*ZERO     WRICN9           Item Category N
     C                     Z-ADD*ZERO     WRICN0           Item Category N
     C                     Z-ADD*ZERO     WRSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WRA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WRSJNB           Production Lead
     C                     Z-ADD*ZERO     WRSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WRSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WRSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WRCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WRCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WRILNB           PM % 2nds Facto
     C                     Z-ADD*ZERO     WRCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WRCINB           PM Batch Size
     C                     Z-ADD*ZERO     WRCJNB           PM Lot Size
     C                     Z-ADD*ZERO     WRCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WRCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WRCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WRCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WRCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WRCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WRCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WRCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WRC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WRB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WRB5NB           PM Line Number
     C                     Z-ADD*ZERO     WRBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WRBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WRF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WRF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WRF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WRBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WRBNNB           Production Qty
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUCNTU  50
      * Define work field *Duration (factor)
     C                     Z-ADD*ZERO     WUDUF   80
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WJ02 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ01 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA02 152       *Synon (15,2) w
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  50
     C                     Z-ADD*ZERO     WL0004  40
     C                     Z-ADD*ZERO     WL0005  20
     C                     Z-ADD*ZERO     WL0006  30
     C                     MOVEL*BLANK    WL0007  1
     C                     Z-ADD*ZERO     WL0008  20
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0009  30
     C                     Z-ADD*ZERO     WL0010  70
     C                     Z-ADD*ZERO     WL0011  40
     C                     Z-ADD*ZERO     WL0012  20
     C                     MOVEL*BLANK    WL0013  1
     C                     Z-ADD*ZERO     WL0014  20
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0015  30
     C                     Z-ADD*ZERO     WL0016  70
     C                     MOVEL*BLANK    WL0017  3
     C                     Z-ADD*ZERO     WL0018  70
     C                     Z-ADD*ZERO     WL0019 112
     C                     MOVEL*BLANK    WL0020  1
     C                     Z-ADD*ZERO     WL0021  70
     C                     Z-ADD*ZERO     WL0022  70
     C                     Z-ADD*ZERO     WL0023  70
     C                     Z-ADD*ZERO     WL0024  30
     C                     Z-ADD*ZERO     WL0025  30
     C                     Z-ADD*ZERO     WL0026 112
     C                     Z-ADD*ZERO     WL0027 112
     C                     Z-ADD*ZERO     WL0028 112
     C                     Z-ADD*ZERO     WL0029 112
     C                     Z-ADD*ZERO     WL0030 112
     C                     Z-ADD*ZERO     WL0031 112
     C                     Z-ADD*ZERO     WL0032  70
      * Define local variables for subroutine SJCRRC.
     C                     Z-ADD*ZERO     WL0033  30
     C                     Z-ADD*ZERO     WL0034  70
     C                     Z-ADD*ZERO     WL0035  30
     C                     Z-ADD*ZERO     WL0036  30
     C                     Z-ADD*ZERO     WL0037  70
     C                     Z-ADD*ZERO     WL0038  70
     C                     MOVEL*BLANK    WL0039  3
     C                     MOVEL*BLANK    WL0040  3
     C                     Z-ADD*ZERO     WL0041  70
     C                     Z-ADD*ZERO     WL0042 112
     C                     Z-ADD*ZERO     WL0043 112
     C                     Z-ADD*ZERO     WL0044 112
     C                     Z-ADD*ZERO     WL0045 112
     C                     Z-ADD*ZERO     WL0046 112
     C                     Z-ADD*ZERO     WL0047 112
     C                     MOVEL*BLANK    WL0048  1
     C                     MOVEL*BLANK    WL0049  1
     C                     MOVEL*BLANK    WL0050  2
     C                     MOVEL*BLANK    WL0051  1
     C                     MOVEL*BLANK    WL0052  1
     C                     MOVEL*BLANK    WL0053  1
     C                     MOVEL*BLANK    WL0054  1
     C                     Z-ADD*ZERO     WL0055  60
     C                     MOVEL*BLANK    WL0056 10
     C                     MOVEL*BLANK    WL0057 10
     C                     Z-ADD*ZERO     WL0058  70
      * Define local variables for subroutine SKDLRC.
     C                     Z-ADD*ZERO     WL0059  30
     C                     Z-ADD*ZERO     WL0060  70
     C                     Z-ADD*ZERO     WL0061  30
     C                     Z-ADD*ZERO     WL0062  30
     C                     Z-ADD*ZERO     WL0063  70
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0064  30
     C                     Z-ADD*ZERO     WL0065  70
     C                     MOVEL*BLANK    WL0066  1
      * Define local variables for subroutine SPRVGN.
     C                     Z-ADD*ZERO     WL0067  30
     C                     Z-ADD*ZERO     WL0068  70
     C                     Z-ADD*ZERO     WL0069  70
      * Define local variables for subroutine SQRVGN.
     C                     MOVEL*BLANK    WL0070  3
     C                     MOVEL*BLANK    WL0071  3
     C                     Z-ADD*ZERO     WL0072  30
      * Define local variables for subroutine SRRVGN.
     C                     Z-ADD*ZERO     WL0073  30
     C                     MOVEL*BLANK    WL0074  1
     C                     Z-ADD*ZERO     WL0075  70
     C                     MOVEL*BLANK    WL0076  1
      * Define local variables for subroutine SSRVGN.
     C                     Z-ADD*ZERO     WL0077  30
     C                     MOVEL*BLANK    WL0078  1
     C                     Z-ADD*ZERO     WL0079  70
     C                     Z-ADD*ZERO     WL0080  70
     C                     MOVEL*BLANK    WL0081  3
     C                     Z-ADD*ZERO     WL0082  92
     C                     Z-ADD*ZERO     WL0083 112
     C                     Z-ADD*ZERO     WL0084  70
     C                     Z-ADD*ZERO     WL0085  52
      * Define local variables for subroutine SURVGN.
     C                     Z-ADD*ZERO     WL0086  30
     C                     Z-ADD*ZERO     WL0087  70
     C                     Z-ADD*ZERO     WL0088  30
     C                     Z-ADD*ZERO     WL0089  30
     C                     Z-ADD*ZERO     WL0090  70
     C                     Z-ADD*ZERO     WL0091  70
     C                     MOVEL*BLANK    WL0092  3
     C                     MOVEL*BLANK    WL0093  3
     C                     Z-ADD*ZERO     WL0094  70
     C                     Z-ADD*ZERO     WL0095  92
     C                     Z-ADD*ZERO     WL0096 112
     C                     MOVEL*BLANK    WL0097  2
      * Define local variables for subroutine SWRVGN.
     C                     Z-ADD*ZERO     WL0098  30
     C                     MOVEL*BLANK    WL0099  1
     C                     Z-ADD*ZERO     WL0100  70
     C                     Z-ADD*ZERO     WL0101  70
     C                     MOVEL*BLANK    WL0102  3
     C                     Z-ADD*ZERO     WL0103  92
     C                     Z-ADD*ZERO     WL0104  70
      * Define local variables for subroutine SYRVGN.
     C                     Z-ADD*ZERO     WL0105  30
     C                     Z-ADD*ZERO     WL0106  70
     C                     MOVEL*BLANK    WL0107 30
     C                     MOVEL*BLANK    WL0108  2
     C                     Z-ADD*ZERO     WL0109 112
     C                     Z-ADD*ZERO     WL0110  30
     C                     Z-ADD*ZERO     WL0111  30
     C                     Z-ADD*ZERO     WL0112  30
     C                     MOVEL*BLANK    WL0113  3
     C                     MOVEL*BLANK    WL0114  3
     C                     Z-ADD*ZERO     WL0115  52
     C                     MOVEL*BLANK    WL0116  2
     C                     MOVEL*BLANK    WL0117  1
     C                     MOVEL*BLANK    WL0118  1
     C                     Z-ADD*ZERO     WL0119 112
     C                     Z-ADD*ZERO     WL0120  70
     C                     MOVEL*BLANK    WL0121  6
     C                     MOVEL*BLANK    WL0122  1
     C                     MOVEL*BLANK    WL0123  1
     C                     MOVEL*BLANK    WL0124  1
     C                     Z-ADD*ZERO     WL0125  70
     C                     Z-ADD*ZERO     WL0126  70
     C                     MOVEL*BLANK    WL0127  1
     C                     MOVEL*BLANK    WL0128  1
     C                     MOVEL*BLANK    WL0129  1
     C                     MOVEL*BLANK    WL0130  1
     C                     MOVEL*BLANK    WL0131  1
     C                     MOVEL*BLANK    WL0132  6
      * Define local variables for subroutine SZRVGN.
     C                     MOVEL*BLANK    WL0133  3
     C                     MOVEL*BLANK    WL0134  2
     C                     MOVEL*BLANK    WL0135  1
     C                     MOVEL*BLANK    WL0136  1
     C                     MOVEL*BLANK    WL0137  1
     C                     Z-ADD*ZERO     WL0138  52
      * Define local variables for subroutine TARVGN.
     C                     Z-ADD*ZERO     WL0139  30
     C                     Z-ADD*ZERO     WL0140  70
     C                     Z-ADD*ZERO     WL0141  52
     C                     Z-ADD*ZERO     WL0142  70
      * Define local variables for subroutine TCRVGN.
     C                     Z-ADD*ZERO     WL0143  30
     C                     Z-ADD*ZERO     WL0144  70
     C                     Z-ADD*ZERO     WL0145  70
     C                     Z-ADD*ZERO     WL0146  70
     C                     Z-ADD*ZERO     WL0147  80
      * Define local variables for subroutine TDRVGN.
     C                     Z-ADD*ZERO     WL0148  30
     C                     Z-ADD*ZERO     WL0149  70
     C                     Z-ADD*ZERO     WL0150  70
     C                     Z-ADD*ZERO     WL0151  70
     C                     Z-ADD*ZERO     WL0152  80
      * Define local work field Fresh Chilling Time
     C                     Z-ADD*ZERO     YL0001  52
      * Define local work field Production Date RGF
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field Production Date RGT
     C                     Z-ADD*ZERO     YL0003  70
      * Define local work field OD Quantity Inv Sched
     C                     Z-ADD*ZERO     YL0004 112
      * Define local work field OD Weight Inv Sched
     C                     Z-ADD*ZERO     YL0005 112
      * Define local work field OD Quantity Inv Sched
     C                     Z-ADD*ZERO     YL0006 112
      * Define local work field OD Weight Inv Sched
     C                     Z-ADD*ZERO     YL0007 112
      * Define local work field Production Date
     C                     Z-ADD*ZERO     YL0008  70
      * Define local work field Production Day Status
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field Production Warehouse Code
     C                     MOVEL*BLANK    YL0010  3
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0011  30
      * Define local work field Allocation Method USR
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field Production Date To
     C                     Z-ADD*ZERO     YL0013  70
      * Define local work field Production Day Status
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field OD Added to Sched Today
     C                     MOVEL*BLANK    YL0015  1
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0016  30
      * Define local work field Production Date RGF
     C                     Z-ADD*ZERO     YL0017  70
      *================================================================
     CSR         ZZEXIT    ENDSR
