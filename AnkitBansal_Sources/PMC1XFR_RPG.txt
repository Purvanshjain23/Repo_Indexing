     H/TITLE Rtv/Crt LdSchPosition XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSMASO
     H* Date          : 11/01/18  Time  : 17:45:58
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDMJCPL7IF  E           K        DISK
      * RSQ : Load Schdlng Pstn Key     PCW/OCW/Item/Prc Seq
      *
     FPME0CPL2IF  E           K        DISK
      * RSQ : WF Item Position Balance  By Itm/Pcw/Ocw/Date(A)
      *
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FPME0CPL0UF  E           K        DISK
      * UPD : WF Item Position Balance  Update index
      *
     FPDMHCPL0IF  E           K        DISK                      A
      * UPD : Load Schdlng Position     Update index
      *
     I@MJCPZE
      * Load Schdlng Pstn Key     PCW/OCW/Item/Prc Seq
      * Renamed input format fields
     I              MJHGCD                          WAHGCD
     I              MJCRC3                          WACRC3
     I              MJLRAA                          WALRAA
     I              MJCVC3                          WACVC3
     I              MJLVAA                          WALVAA
     I              MJSPSQ                          WASPSQ
     I              MJT4NB                          WAT4NB
     I              MJN5NY                          WAN5NY
     I              MJAODT                          WAAODT
     I              MJKZDT                          WAKZDT
     I              MJAXTM                          WAAXTM
     I              MJJPCD                          WAJPCD
     I              MJC4NB                          WAC4NB
     I              MJRMNB                          WARMNB
     I              MJH1QT                          WAH1QT
     I              MJN2NY                          WAN2NY
     I              MJBZST                          WABZST
     I              MJSUDT                          WASUDT
     I              MJRINY                          WARINY
     I              MJTIDT                          WATIDT
     I              MJTJDT                          WATJDT
     I              MJTNDT                          WATNDT
     I              MJTODT                          WATODT
     I              MJBMSX                          WABMSX
     I              MJUVST                          WAUVST
     I              MJUWST                          WAUWST
     I              MJUXST                          WAUXST
     I              MJVSST                          WAVSST
     I              MJAATM                          WAAATM
     I              MJAYNA                          WAAYNA
     I              MJA0NA                          WAA0NA
     I              MJAXDT                          WAAXDT
      *
     I@E0CPCQ
      * WF Item Position Balance  By Itm/Pcw/Ocw/Date(A)
      * Renamed input format fields
     I              E0HGCD                          WBHGCD
     I              E0CSC3                          WBCSC3
     I              E0LSAA                          WBLSAA
     I              E0CTC3                          WBCTC3
     I              E0LTAA                          WBLTAA
     I              E0ELDT                          WBELDT
     I              E0PNQT                          WBPNQT
     I              E0POQT                          WBPOQT
     I              E0PPQT                          WBPPQT
     I              E0PQQT                          WBPQQT
     I              E0PRQT                          WBPRQT
     I              E0PSQT                          WBPSQT
     I              E0P3QT                          WBP3QT
     I              E0B1ST                          WBB1ST
     I              E0B2ST                          WBB2ST
     I              E0B3ST                          WBB3ST
      *
     I@E0CPYW
      * WF Item Position Balance  Update index
      * Renamed input format fields
     I              E0HGCD                          WCHGCD
     I              E0CSC3                          WCCSC3
     I              E0LSAA                          WCLSAA
     I              E0CTC3                          WCCTC3
     I              E0LTAA                          WCLTAA
     I              E0ELDT                          WCELDT
     I              E0PNQT                          WCPNQT
     I              E0POQT                          WCPOQT
     I              E0PPQT                          WCPPQT
     I              E0PQQT                          WCPQQT
     I              E0PRQT                          WCPRQT
     I              E0PSQT                          WCPSQT
     I              E0P3QT                          WCP3QT
     I              E0B1ST                          WCB1ST
     I              E0B2ST                          WCB2ST
     I              E0B3ST                          WCB3ST
      *
     I@MHCPUY
      * Load Schdlng Position     Update index
      * Renamed input format fields
     I              MHHGCD                          WDHGCD
     I              MHCQC3                          WDCQC3
     I              MHLQAA                          WDLQAA
     I              MHCUC3                          WDCUC3
     I              MHLUAA                          WDLUAA
     I              MHSPSQ                          WDSPSQ
     I              MHBMSX                          WDBMSX
     I              MHL7DT                          WDL7DT
     I              MHC4NB                          WDC4NB
     I              MHRMNB                          WDRMNB
     I              MHAODT                          WDAODT
     I              MHJPCD                          WDJPCD
     I              MHKBQT                          WDKBQT
     I              MHKCQT                          WDKCQT
     I              MHKHQT                          WDKHQT
     I              MHKDQT                          WDKDQT
     I              MHKEQT                          WDKEQT
     I              MHKFQT                          WDKFQT
     I              MHH1QT                          WDH1QT
     I              MHKGQT                          WDKGQT
     I              MHKZDT                          WDKZDT
     I              MHAXTM                          WDAXTM
     I              MHBOSX                          WDBOSX
     I              MHBPSX                          WDBPSX
     I              MHBQSX                          WDBQSX
     I              MHUNUS                          WDUNUS
     I              MHUNU2                          WDUNU2
     I              MHT4NB                          WDT4NB
     I              MHRVNB                          WDRVNB
     I              MHBUST                          WDBUST
     I              MHSTDT                          WDSTDT
     I              MHN5NY                          WDN5NY
     I              MHRINY                          WDRINY
     I              MHTIDT                          WDTIDT
     I              MHTJDT                          WDTJDT
     I              MHTNDT                          WDTNDT
     I              MHTODT                          WDTODT
     I              MHUVST                          WDUVST
     I              MHUWST                          WDUWST
     I              MHUXST                          WDUXST
     I              MHVSST                          WDVSST
     I              MHAATM                          WDAATM
     I              MHAYNA                          WDAYNA
     I              MHA0NA                          WDA0NA
     I              MHAXDT                          WDAXDT
      *
     I@FLCPKF
      * Load Detail               Co/Load/Order
      * Renamed input format fields
     I              FLRMNB                          WERMNB
     I              FLRUNB                          WERUNB
     I              FLRVNB                          WERVNB
     I              FLDQTX                          WEDQTX
     I              FLRWNB                          WERWNB
     I              FLRXNB                          WERXNB
     I              FLSQNB                          WESQNB
     I              FLT0NB                          WET0NB
     I              FLT1NB                          WET1NB
     I              FLR1NB                          WER1NB
     I              FLAIC3                          WEAIC3
     I              FLC4NB                          WEC4NB
     I              FLVCST                          WEVCST
     I              FLKEDT                          WEKEDT
     I              FLSXNB                          WESXNB
     I              FLKFDT                          WEKFDT
     I              FLACTM                          WEACTM
     I              FLK5TX                          WEK5TX
     I              FLW5CD                          WEW5CD
     I              FLEJDT                          WEEJDT
     I              FLAGTM                          WEAGTM
     I              FLKJDT                          WEKJDT
     I              FLATTM                          WEATTM
     I              FLHDDT                          WEHDDT
     I              FLAUTM                          WEAUTM
     I              FLKKDT                          WEKKDT
     I              FLAVTM                          WEAVTM
     I              FLZ4NB                          WEZ4NB
     I              FLY7ST                          WEY7ST
     I              FLY2ST                          WEY2ST
     I              FLWHTX                          WEWHTX
     I              FLWITX                          WEWITX
     I              FLWJTX                          WEWJTX
     I              FLWKTX                          WEWKTX
     I              FLWLTX                          WEWLTX
     I              FLN7DT                          WEN7DT
     I              FLN8DT                          WEN8DT
     I              FLN9DT                          WEN9DT
     I              FLB3TM                          WEB3TM
     I              FLB4TM                          WEB4TM
     I              FLB5TM                          WEB5TM
     I              FLIASX                          WEIASX
     I              FLIBSX                          WEIBSX
     I              FLICSX                          WEICSX
     I              FLWVTX                          WEWVTX
     I              FLWWTX                          WEWWTX
     I              FLWXTX                          WEWXTX
     I              FLUVST                          WEUVST
     I              FLUWST                          WEUWST
     I              FLUXST                          WEUXST
     I              FLAATM                          WEAATM
     I              FLAYNA                          WEAYNA
     I              FLA0NA                          WEA0NA
     I              FLAXDT                          WEAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPME01    E DSPME0CPL0
      * UPD : WF Item Position Balance  Update index
      * Renamed input format fields
     I              E0HGCD                          WCHGCD
     I              E0CSC3                          WCCSC3
     I              E0LSAA                          WCLSAA
     I              E0CTC3                          WCCTC3
     I              E0LTAA                          WCLTAA
     I              E0ELDT                          WCELDT
     I              E0PNQT                          WCPNQT
     I              E0POQT                          WCPOQT
     I              E0PPQT                          WCPPQT
     I              E0PQQT                          WCPQQT
     I              E0PRQT                          WCPRQT
     I              E0PSQT                          WCPSQT
     I              E0P3QT                          WCP3QT
     I              E0B1ST                          WCB1ST
     I              E0B2ST                          WCB2ST
     I              E0B3ST                          WCB3ST
      *
     IYARDCS      DS                             49
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                             49
     IQPDMH1    E DSPDMHCPL0
      * UPD : Load Schdlng Position     Update index
      * Renamed input format fields
     I              MHHGCD                          WDHGCD
     I              MHCQC3                          WDCQC3
     I              MHLQAA                          WDLQAA
     I              MHCUC3                          WDCUC3
     I              MHLUAA                          WDLUAA
     I              MHSPSQ                          WDSPSQ
     I              MHBMSX                          WDBMSX
     I              MHL7DT                          WDL7DT
     I              MHC4NB                          WDC4NB
     I              MHRMNB                          WDRMNB
     I              MHAODT                          WDAODT
     I              MHJPCD                          WDJPCD
     I              MHKBQT                          WDKBQT
     I              MHKCQT                          WDKCQT
     I              MHKHQT                          WDKHQT
     I              MHKDQT                          WDKDQT
     I              MHKEQT                          WDKEQT
     I              MHKFQT                          WDKFQT
     I              MHH1QT                          WDH1QT
     I              MHKGQT                          WDKGQT
     I              MHKZDT                          WDKZDT
     I              MHAXTM                          WDAXTM
     I              MHBOSX                          WDBOSX
     I              MHBPSX                          WDBPSX
     I              MHBQSX                          WDBQSX
     I              MHUNUS                          WDUNUS
     I              MHUNU2                          WDUNU2
     I              MHT4NB                          WDT4NB
     I              MHRVNB                          WDRVNB
     I              MHBUST                          WDBUST
     I              MHSTDT                          WDSTDT
     I              MHN5NY                          WDN5NY
     I              MHRINY                          WDRINY
     I              MHTIDT                          WDTIDT
     I              MHTJDT                          WDTJDT
     I              MHTNDT                          WDTNDT
     I              MHTODT                          WDTODT
     I              MHUVST                          WDUVST
     I              MHUWST                          WDUWST
     I              MHUXST                          WDUXST
     I              MHVSST                          WDVSST
     I              MHAATM                          WDAATM
     I              MHAYNA                          WDAYNA
     I              MHA0NA                          WDA0NA
     I              MHAXDT                          WDAXDT
      *
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Rtv/Crt LdSchPosition XF
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * 01/20/16 JJH E4687 - Load Scheduling Positioning with Mercury Gat
      * - If Live with TPM = Yes, use the "MG RTV LD Stop/DropNb RT -
      *   Order Header Ext" function to get the Ld Stop/Drop.
      * Rtv/Crt LdSchPosition RT - Load Schdlng Pstn Key  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv/Crt LdSchPosition RT - Load Schdlng Pstn Key  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUTAST           First Time Flag
     C                     Z-ADD0         YL0001           Scheduled Ship
      * Establish starting position
     C           *LOVAL    SETLL@MJCPZE                    *
     C                     READ @MJCPZE                  90*
      * Data record not found
     C   90                MOVEL'USR2713' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * slm * out due to thinking this was used for testing
      * slm * SEE what is wrong with * out this function
      * CASE: DB1.Item Code is Review specific Item
     C           WAHGCD    IFEQ 2310                       *IF
      * Send message 'Condition Found'
     C                     MOVEL'USR4187' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: DB1.Item Code is Review specific Item2
     C           WAHGCD    IFEQ 11610                      *IF
      * Send message 'Condition Found'
     C                     MOVEL'USR4187' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: DB1.Item Code is Review specific Item3
     C           WAHGCD    IFEQ 26010                      *IF
      * Send message 'Condition Found'
     C                     MOVEL'USR4187' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.First Time Flag is Yes
     C           WUTAST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUTAST           First Time Flag
     C                     Z-ADDWAHGCD    YL0002           Item Code USR
     C                     MOVELWALVAA    YL0003           LSPK Order Ware
     C                     Z-ADDWACVC3    YL0004           LSPK Order Comp
     C                     MOVELWALRAA    YL0005           LSPK Production
     C                     Z-ADDWACRC3    YL0006           LSPK Accounting
     C                     END                             *FI
      * Break in Item Code or Whs:  Output Final Position Rcd and Reset f
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5
      *   |- c1    : DB1.Item Code NE LCL.Item Code USR
      *   |- c2    : DB1.LSPK Order Warehouse NE LCL.LSPK Order Warehouse
      *   |- c3    : DB1.LSPK Order Company NE LCL.LSPK Order Company
      *   |- c4    : DB1.LSPK Production Whse NE LCL.LSPK Production Whse
      *   |- c5    : DB1.LSPK Accounting Company NE LCL.LSPK Accounting C
      *   '-
     C           WAHGCD    IFNE YL0002                     *IF
     C           WALVAA    ORNE YL0003                     *OR
     C           WACVC3    ORNE YL0004                     *OR
     C           WALRAA    ORNE YL0005                     *OR
     C           WACRC3    ORNE YL0006                     *OR
     C                     Z-ADD0         YL0007           Seq if on a loa
     C                     Z-ADD99899     YL0008           Seq if not on L
     C                     Z-ADDWAHGCD    YL0002           Item Code USR
     C                     MOVELWALVAA    YL0003           LSPK Order Ware
     C                     Z-ADDWACVC3    YL0004           LSPK Order Comp
     C                     MOVELWALRAA    YL0005           LSPK Production
     C                     Z-ADDWACRC3    YL0006           LSPK Accounting
     C                     Z-ADD0         YL0001           Scheduled Ship
     C                     Z-ADD0         YL0009           Actual Inventor
     C                     Z-ADD0         WUKEQT           Scheduled Produ
     C                     MOVEL'N'       WUD4ST           USR Flag 1
     C                     Z-ADD0         YL0010           Scheduling Posi
     C                     END                             *FI
      * ** Save previous rcd's qtys needed to calculate current rcd's qty
     C                     Z-ADD0         YL0011           Actual Producti
     C                     Z-ADD0         YL0012           Scheduled Produ
     C                     Z-ADDWAH1QT    YL0013           Scheduled Quant
     C                     Z-ADD0         YL0010           Scheduling Posi
     C                     Z-ADD0         WUKGQT           Scheduling Posi
      * ** Scheduled Ship Date Break
      * ****** Scheduled ship date ******
      * CASE: DB1.Scheduled Ship Date NE LCL.Scheduled Ship Date
     C           WAAODT    IFNE YL0001                     *IF
     C                     MOVEL'N'       WUTMST           USR First Time
     C                     Z-ADDWAAODT    YL0001           Scheduled Ship
      * do not perform the production fields population
     C                     END                             *FI
      * ******** Scheduling Position ********
      * Read the WF Item Position Balance and get the Grade
     C                     EXSR UBSUBR                     Read the WF Ite
      * **
      * ** Create the position record with seq, quantities and order grad
      * CASE: DB1.Schedule Sequence Number is 99999
     C           WAT4NB    IFEQ 99999                      *IF
     C                     Z-ADD0         YL0021           Schedule Sequen
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAT4NB    YL0021           Schedule Sequen
     C                     END                             *FI
     C           WUN9NY    MULT -1        YL0010           Scheduling Posi
      * 01/20/16 JJH E4687 - Load Scheduling Positioning with Mercury Gat
      * Crt Load Schdlng Pstn CR - Load Schdlng Position  * 
     C                     EXSR SECRRC
     C                     READ @MJCPZE                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv/Chg ItemPostAlloc RT - WF Item Position Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADDWASUDT    WUGXDT           Production Date
     C                     Z-ADDWUN9NY    YL0015           Schedule Qty Gr
     C                     Z-ADDWAN2NY    YL0016           Picked to Order
     C                     MOVEL'Y'       YL0017           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHGCD    WQSB01           Item Code
     C           *LIKE     DEFN WBCSC3    WQSB02           IPB Accounting
     C           *LIKE     DEFN WBLSAA    WQSB03           IPB Production
     C           *LIKE     DEFN WBCTC3    WQSB04           IPB Order Compa
     C           *LIKE     DEFN WBLTAA    WQSB05           IPB Order Wareh
      * Define keylist
     C           KPSSB     KLIST
     C                     KFLD           WQSB01           Item Code
     C                     KFLD           WQSB02           IPB Accounting
     C                     KFLD           WQSB03           IPB Production
     C                     KFLD           WQSB04           IPB Order Compa
     C                     KFLD           WQSB05           IPB Order Wareh
     C                     KFLD           WBELDT           Production Date
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Item Code
     C                     KFLD           WQSB02           IPB Accounting
     C                     KFLD           WQSB03           IPB Production
     C                     KFLD           WQSB04           IPB Order Compa
     C                     KFLD           WQSB05           IPB Order Wareh
      * Setup key
     C                     Z-ADDWAHGCD    WQSB01           Item Code
     C                     Z-ADDWACRC3    WQSB02           IPB Accounting
     C                     MOVELWALRAA    WQSB03           IPB Production
     C                     Z-ADDWACVC3    WQSB04           IPB Order Compa
     C                     MOVELWALVAA    WQSB05           IPB Order Wareh
     C                     Z-ADDWASUDT    WBELDT           Production Date
      * Establish starting position
     C           KPSSB     SETLL@E0CPCQ                    *
     C           KRSSB     READE@E0CPCQ                  90*
      * Data record not found
     C   90                MOVEL'USR4090' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'N'       YL0018           Read Another Re
      * CASE: DB1.IPB New Current Position is LE Zero
     C           WBP3QT    IFLE 0                          *IF
     C                     ELSE
      * CASE: LCL.Schedule Qty Grade Usr is Greater than Zero
     C           YL0015    IFGT 0                          *IF
      * Calculate fields
     C                     EXSR UCSUBR                     Calculate field
      * Update the WF Item Position Balance
     C                     EXSR UDSUBR                     Update the WF I
      * CASE: LCL.Schedule Qty Grade Usr is Greater than Zero
     C           YL0015    IFGT 0                          *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     GOTO SBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSB     READE@E0CPCQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCHRC    BEGSR
      *================================================================
      * Chg WF ItemAppSchPkUsdCH - WF Item Position Balance  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       IPB Quantity On
     C                     Z-ADD*ZERO     WN0002  70       IPB Picked
     C                     Z-ADD*ZERO     WN0003  70       IPB Start Posit
     C                     Z-ADD*ZERO     WN0004  70       IPB Allocated S
     C                     Z-ADD*ZERO     WN0005  70       IPB Allocated P
     C                     Z-ADD*ZERO     WN0006  70       IPB Total Used
     C                     Z-ADD*ZERO     WN0007  70       IPB New Current
     C                     MOVEL*BLANK    WN0008  1        IPB UnUsed Stat
     C                     MOVEL*BLANK    WN0009  1        IPB UnUsed Stat
     C                     MOVEL*BLANK    WN0010  1        IPB UnUsed Stat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @E0CPYW
     C                     Z-ADDWBHGCD    WCHGCD           Item Code
     C                     Z-ADDWBCSC3    WCCSC3           IPB Accounting
     C                     MOVELWBLSAA    WCLSAA    P      IPB Production
     C                     Z-ADDWBCTC3    WCCTC3           IPB Order Compa
     C                     MOVELWBLTAA    WCLTAA    P      IPB Order Wareh
     C                     Z-ADDWBELDT    WCELDT           Production Date
      *
     C           KLCHSC    KLIST
     C                     KFLD           WCHGCD           Item Code
     C                     KFLD           WCCSC3           IPB Accounting
     C                     KFLD           WCLSAA           IPB Production
     C                     KFLD           WCCTC3           IPB Order Compa
     C                     KFLD           WCLTAA           IPB Order Wareh
     C                     KFLD           WCELDT           Production Date
     C           KLCHSC    CHAIN@E0CPYW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PME0CPL0'MDACP
     C                     MOVEL'@E0CPYW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPME01    YARDCS
      * USER: Processing after Data read
      * Accumulate to individual fields
     C                     ADD  WAH1QT    WCPQQT           IPB Allocated S
     C                     ADD  WAN2NY    WCPRQT           IPB Allocated P
     C                     ADD  YL0020    WCPSQT           IPB Total Used
      * calculate the extended amount
     C           WCPPQT    SUB  WCPSQT    WCP3QT           IPB New Current
      *
      * Set PGM.*Record Data Changed flag
     C           QPME01    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@E0CPYW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPME0CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCHRC    BEGSR
      *================================================================
      * Chg WF ItemApp     UsdCH - WF Item Position Balance  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0011  70       IPB Quantity On
     C                     Z-ADD*ZERO     WN0012  70       IPB Picked
     C                     Z-ADD*ZERO     WN0013  70       IPB Start Posit
     C                     Z-ADD*ZERO     WN0014  70       IPB Allocated S
     C                     Z-ADD*ZERO     WN0015  70       IPB Allocated P
     C                     Z-ADD*ZERO     WN0016  70       IPB Total Used
     C                     Z-ADD*ZERO     WN0017  70       IPB New Current
     C                     MOVEL*BLANK    WN0018  1        IPB UnUsed Stat
     C                     MOVEL*BLANK    WN0019  1        IPB UnUsed Stat
     C                     MOVEL*BLANK    WN0020  1        IPB UnUsed Stat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @E0CPYW
     C                     Z-ADDWBHGCD    WCHGCD           Item Code
     C                     Z-ADDWBCSC3    WCCSC3           IPB Accounting
     C                     MOVELWBLSAA    WCLSAA    P      IPB Production
     C                     Z-ADDWBCTC3    WCCTC3           IPB Order Compa
     C                     MOVELWBLTAA    WCLTAA    P      IPB Order Wareh
     C                     Z-ADDWBELDT    WCELDT           Production Date
      *
     C           KLCHSD    KLIST
     C                     KFLD           WCHGCD           Item Code
     C                     KFLD           WCCSC3           IPB Accounting
     C                     KFLD           WCLSAA           IPB Production
     C                     KFLD           WCCTC3           IPB Order Compa
     C                     KFLD           WCLTAA           IPB Order Wareh
     C                     KFLD           WCELDT           Production Date
     C           KLCHSD    CHAIN@E0CPYW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PME0CPL0'MDACP
     C                     MOVEL'@E0CPYW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPME01    YBRDCS
      * USER: Processing after Data read
      * Accumulate to individual fields
     C                     ADD  YL0020    WCPSQT           IPB Total Used
      * calculate the extended amount
     C           WCPPQT    SUB  WCPSQT    WCP3QT           IPB New Current
      *
      * Set PGM.*Record Data Changed flag
     C           QPME01    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@E0CPYW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPME0CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * Crt Load Schdlng Pstn CR - Load Schdlng Position  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0021  50       Stop/Drop
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @MHCPUY
     C                     Z-ADDWAHGCD    WDHGCD           Item Code
     C                     Z-ADDWACRC3    WDCQC3           LSP Accounting
     C                     MOVELWALRAA    WDLQAA           LSP Prodution W
     C                     Z-ADDWACVC3    WDCUC3           LSP Order Compa
     C                     MOVELWALVAA    WDLUAA           LSP Order Wareh
     C                     Z-ADDWASPSQ    WDSPSQ           Sequence
     C                     MOVELWABMSX    WDBMSX           Record Type
     C                     Z-ADDYL0022    WDL7DT           Thru Scheduled
     C                     Z-ADDWAC4NB    WDC4NB           Order Number
     C                     Z-ADDWARMNB    WDRMNB           Load ID
     C                     Z-ADDWAAODT    WDAODT           Scheduled Ship
     C                     MOVELWAJPCD    WDJPCD           Event Code
     C                     Z-ADDYL0009    WDKBQT           Actual Inventor
     C                     Z-ADDWAN2NY    WDKCQT           Picked Inventor
     C                     Z-ADDYL0023    WDKHQT           Available Inven
     C                     Z-ADDYL0011    WDKDQT           Actual Producti
     C                     Z-ADDYL0012    WDKEQT           Scheduled Produ
     C                     Z-ADDYL0024    WDKFQT           Available Produ
     C                     Z-ADDWAH1QT    WDH1QT           Scheduled Quant
     C                     Z-ADDYL0010    WDKGQT           Scheduling Posi
     C                     Z-ADDWAKZDT    WDKZDT           Deadline Depart
     C                     Z-ADDWAAXTM    WDAXTM           Deadline Depart
     C                     MOVELYL0014    WDBOSX           Order Grade
     C                     MOVELWUGSTX    WDBPSX           Load Grade
     C                     MOVELWUGSTX    WDBQSX           Multiple Wareho
     C                     MOVELWUGSTX    WDUNUS           SSI Download Fl
     C                     MOVELWUGSTX    WDUNU2           unused status 2
     C                     Z-ADDYL0021    WDT4NB           Schedule Sequen
     C                     MOVELWABZST    WDBUST           LSP Order Aged
     C                     Z-ADDWASUDT    WDSTDT           LSP Production
     C                     Z-ADDWAN5NY    WDN5NY           Process Sequenc
     C                     Z-ADDWARINY    WDRINY           Item Age Days
     C                     Z-ADDWATIDT    WDTIDT           Production Ovr
     C                     Z-ADDWATJDT    WDTJDT           Production Ovr
     C                     Z-ADDWATNDT    WDTNDT           Production AgeD
     C                     Z-ADDWATODT    WDTODT           Production AgeD
     C                     MOVELWAUVST    WDUVST           EDI Status 1
     C                     MOVELWAUWST    WDUWST           EDI Status 2
     C                     MOVELWAUXST    WDUXST           EDI Status 3
     C                     MOVELWAVSST    WDVSST           Record Status
     C                     Z-ADDWAAATM    WDAATM           Job Time
     C                     MOVELWAAYNA    WDAYNA           User Id
     C                     MOVELWAA0NA    WDA0NA           Job Name
     C                     Z-ADDWAAXDT    WDAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WDVSST           Record Status
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * 01/20/16 JJH E4687 - Load Scheduling Positioning with Mercury Gat
      * ** 05/19/16   RMC E4119  remove live with tpm check
      * RTV Get Stop Number - Load Detail  * Get Stop Number
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWARMNB    WL0001           Load ID
     C                     Z-ADDWAC4NB    WL0003           Order Number
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    WDRVNB           Stop/Drop
     C           KLCRSE    KLIST
     C                     KFLD           WDHGCD           Item Code
     C                     KFLD           WDCQC3           LSP Accounting
     C                     KFLD           WDLQAA           LSP Prodution W
     C                     KFLD           WDCUC3           LSP Order Compa
     C                     KFLD           WDLUAA           LSP Order Wareh
     C                     KFLD           WDSPSQ           Sequence
      * Check for duplicate primary key
     C           KLCRSE    SETLL@MHCPUY                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2707' W0RTN   7
      * Send message 'Load Schdlng Position  EX'
     C                     MOVEL'USR2707' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@MHCPUY                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Get Stop Number - Load Detail  * Get Stop Number
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WERMNB    WQSF02           Load ID
     C           *LIKE     DEFN WEC4NB    WQSF03           Order Number
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF02           Load ID
     C                     KFLD           WQSF03           Order Number
      * Setup key
     C                     Z-ADDWL0001    WQSF02           Load ID
     C                     Z-ADDWL0003    WQSF03           Order Number
      * Establish starting position
     C           KRSSF     SETLL@FLCPKF                    *
     C           KRSSF     READE@FLCPKF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0002           Stop/Drop
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWERVNB    WL0002           Stop/Drop
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     GOTO SFEXIT                     *QUIT
     C           KRSSF     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * ** 05/19/16   RMC E4119  remove live with tpm check
      * 01/20/16 JJH E4687 - Load Scheduling Positioning with Mercury Gat
      * - If Live with TPM = Yes, use the "MG RTV LD Stop/DropNb RT -
      *   Order Header Ext" function to get the Ld Stop/Drop.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Read the WF Item Position Balance and get the Grade
      *================================================================
      * CASE: DB1.Load ID is Blank
     C           WARMNB    IFEQ 0                          *IF
      * Dont grade if the load id is blank
     C                     MOVELWUGSTX    YL0014           Order Grade
     C                     ELSE
      * CASE: Do no aged Pick records of Negative
      *  - c1 AND c2
      *   |- c1    : DB1.Scheduled Quantity is Equal to Zero
      *   |- c2    : DB1.Picked to Order is LT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAH1QT    IFEQ 0                          *IF
     C           WAN2NY    IFLT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Dont grade if the load id is blank
     C                     MOVELWUGSTX    YL0014           Order Grade
     C                     ELSE
      * CASE: *OTHERWISE
      * get the grade (send in the SchedQty & Picked to Order) & use
      * the scheduled qty to reduce the onhand requirement
     C           WAH1QT    SUB  WAN2NY    WUN9NY           Schedule Qty Gr
      * Rtv/Chg ItemPostAlloc RT - WF Item Position Balance  * 
     C                     EXSR SBRVGN
      * ****** Grade the order ****** must be done in this sequence
      * as of this time we will not be using the grade of  A
      * ** C = order needs actual inventory to be filled
      * ** X = order cannot be filled
      * SCHEDULE QTY >0  NEED MORE INVENTORY
      * SCHEDULE QTY 0 HAS INVENTORY OR THERE IS INVENTORY TO COVER
      * CASE: WRK.Schedule Qty Grade Usr GT WRK.ZERO
     C           WUN9NY    IFGT WUW0NB                     *IF
     C                     MOVEL'X'       YL0014           Order Grade
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'C'       YL0014           Order Grade
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Calculate fields
      *================================================================
      * Current record from Load Pst Key must now be applied
     C                     Z-ADDWBP3QT    YL0019           IPB New Current
      * CASE: LCL.Schedule Qty Grade Usr GT LCL.IPB New Current Position
     C           YL0015    IFGT YL0019                     *IF
      * new current balance and what was used same thing
      * there is a balance left over so read another record
     C                     Z-ADDYL0019    YL0020           Used for Order
     C                     MOVEL'Y'       YL0018           Read Another Re
     C                     ELSE
      * CASE:
      *  - c2 ANDc3
      *   |- c2    : LCL.Schedule Qty Grade Usr LE DB1.IPB New Current Po
      *   |- c3    : LCL.First Time Flag is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0015    IFLE WBP3QT                     *IF
     C           YL0017    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * what is being processed = what came in
      * total is schedule
      * there is no left over
     C                     Z-ADDYL0015    YL0020           Used for Order
     C                     ELSE
      * CASE: *OTHERWISE
      * SUSAN4 LOOK AT  THIS
     C                     Z-ADDYL0015    YL0020           Used for Order
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Update the WF Item Position Balance
      *================================================================
     C                     Z-ADDYL0015    WUN9NY           Schedule Qty Gr
      * CASE: LCL.First Time Flag is Yes
     C           YL0017    IFEQ 'Y'                        *IF
      * apply the Sched Qty Picked to Order and the Used for Order
      * for the first record only
      * Chg WF ItemAppSchPkUsdCH - WF Item Position Balance  * 
     C                     EXSR SCCHRC
      * CASE: LCL.Used for Order is Greater than Zero
     C           YL0020    IFGT 0                          *IF
     C                     SUB  YL0020    WUN9NY           Schedule Qty Gr
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WAH1QT    WUN9NY           Schedule Qty Gr
     C                     SUB  WAN2NY    WUN9NY           Schedule Qty Gr
     C                     END                             *FI
     C                     MOVEL'N'       YL0017           First Time Flag
     C                     ELSE
      * CASE: *OTHERWISE
      * apply the Used for Order for the remainding of the balance on
      * then order
      * Chg WF ItemApp     UsdCH - WF Item Position Balance  * 
     C                     EXSR SDCHRC
     C                     SUB  YL0020    WUN9NY           Schedule Qty Gr
     C                     END                             *FI
     C                     Z-ADDWUN9NY    YL0015           Schedule Qty Gr
     C                     Z-ADDWUN9NY    WUN9NY           Schedule Qty Gr
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WACRC3           LSPK Accounting
     C                     Z-ADD*ZERO     WACVC3           LSPK Order Comp
     C                     Z-ADD*ZERO     WASPSQ           Sequence
     C                     Z-ADD*ZERO     WAT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WAN5NY           Process Sequenc
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WAKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WAAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WAH1QT           Scheduled Quant
     C                     Z-ADD*ZERO     WAN2NY           Picked to Order
     C                     Z-ADD*ZERO     WASUDT           LSPK Production
     C                     Z-ADD*ZERO     WARINY           Item Age Days
     C                     Z-ADD*ZERO     WATIDT           Production Ovr
     C                     Z-ADD*ZERO     WATJDT           Production Ovr
     C                     Z-ADD*ZERO     WATNDT           Production AgeD
     C                     Z-ADD*ZERO     WATODT           Production AgeD
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Scheduled Production
     C                     Z-ADD*ZERO     WUKEQT  70
      * Define work field USR Flag 1
     C                     MOVEL*BLANK    WUD4ST  1
      * Define work field Scheduling Position
     C                     Z-ADD*ZERO     WUKGQT  70
      * Define work field USR First Time
     C                     MOVEL*BLANK    WUTMST  1
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field Schedule Qty Grade Usr
     C                     Z-ADD*ZERO     WUN9NY  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBCSC3           IPB Accounting
     C                     Z-ADD*ZERO     WBCTC3           IPB Order Compa
     C                     Z-ADD*ZERO     WBELDT           Production Date
     C                     Z-ADD*ZERO     WBPNQT           IPB Quantity On
     C                     Z-ADD*ZERO     WBPOQT           IPB Picked
     C                     Z-ADD*ZERO     WBPPQT           IPB Start Posit
     C                     Z-ADD*ZERO     WBPQQT           IPB Allocated S
     C                     Z-ADD*ZERO     WBPRQT           IPB Allocated P
     C                     Z-ADD*ZERO     WBPSQT           IPB Total Used
     C                     Z-ADD*ZERO     WBP3QT           IPB New Current
      * Define work field Production Date USR
     C                     Z-ADD*ZERO     WUGXDT  70
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDCQC3           LSP Accounting
     C                     Z-ADD*ZERO     WDCUC3           LSP Order Compa
     C                     Z-ADD*ZERO     WDSPSQ           Sequence
     C                     Z-ADD*ZERO     WDL7DT           Thru Scheduled
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDKBQT           Actual Inventor
     C                     Z-ADD*ZERO     WDKCQT           Picked Inventor
     C                     Z-ADD*ZERO     WDKHQT           Available Inven
     C                     Z-ADD*ZERO     WDKDQT           Actual Producti
     C                     Z-ADD*ZERO     WDKEQT           Scheduled Produ
     C                     Z-ADD*ZERO     WDKFQT           Available Produ
     C                     Z-ADD*ZERO     WDH1QT           Scheduled Quant
     C                     Z-ADD*ZERO     WDKGQT           Scheduling Posi
     C                     Z-ADD*ZERO     WDKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WDAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WDT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WDRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WDSTDT           LSP Production
     C                     Z-ADD*ZERO     WDN5NY           Process Sequenc
     C                     Z-ADD*ZERO     WDRINY           Item Age Days
     C                     Z-ADD*ZERO     WDTIDT           Production Ovr
     C                     Z-ADD*ZERO     WDTJDT           Production Ovr
     C                     Z-ADD*ZERO     WDTNDT           Production AgeD
     C                     Z-ADD*ZERO     WDTODT           Production AgeD
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WERMNB           Load ID
     C                     Z-ADD*ZERO     WERUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WERVNB           Stop/Drop
     C                     Z-ADD*ZERO     WERWNB           Miles to next s
     C                     Z-ADD*ZERO     WERXNB           Freight Charge
     C                     Z-ADD*ZERO     WESQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WET0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WET1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WER1NB           Rated Freight
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WESXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WEKFDT           Appointment Con
     C                     Z-ADD*ZERO     WEACTM           Appointment Con
     C                     Z-ADD*ZERO     WEEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WEAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WEKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WEATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WEHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WEAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WEKKDT           On Yard Date
     C                     Z-ADD*ZERO     WEAVTM           On Yard Time
     C                     Z-ADD*ZERO     WEZ4NB           MPC Number
     C                     Z-ADD*ZERO     WEN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WEN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WEN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WEB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WEB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WEB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0001  70
     C                     Z-ADD*ZERO     WL0002  50
     C                     Z-ADD*ZERO     WL0003  70
      * Define local work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field Item Code USR
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field LSPK Order Warehouse
     C                     MOVEL*BLANK    YL0003  3
      * Define local work field LSPK Order Company
     C                     Z-ADD*ZERO     YL0004  30
      * Define local work field LSPK Production Whse
     C                     MOVEL*BLANK    YL0005  3
      * Define local work field LSPK Accounting Company
     C                     Z-ADD*ZERO     YL0006  30
      * Define local work field Seq if on a load      USR
     C                     Z-ADD*ZERO     YL0007  50
      * Define local work field Seq if not on Load    USR
     C                     Z-ADD*ZERO     YL0008  50
      * Define local work field Actual Inventory
     C                     Z-ADD*ZERO     YL0009  70
      * Define local work field Scheduling Position
     C                     Z-ADD*ZERO     YL0010  70
      * Define local work field Actual Production
     C                     Z-ADD*ZERO     YL0011  70
      * Define local work field Scheduled Production
     C                     Z-ADD*ZERO     YL0012  70
      * Define local work field Scheduled Quantity
     C                     Z-ADD*ZERO     YL0013  70
      * Define local work field Order Grade
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field Schedule Qty Grade Usr
     C                     Z-ADD*ZERO     YL0015  70
      * Define local work field Picked to Order Usr
     C                     Z-ADD*ZERO     YL0016  70
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0017  1
      * Define local work field Read Another Record Usr
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field IPB New Current Position
     C                     Z-ADD*ZERO     YL0019  70
      * Define local work field Used for Order
     C                     Z-ADD*ZERO     YL0020  70
      * Define local work field Schedule Sequence Number
     C                     Z-ADD*ZERO     YL0021  50
      * Define local work field Thru Scheduled Ship Date
     C                     Z-ADD*ZERO     YL0022  70
      * Define local work field Available Inventory
     C                     Z-ADD*ZERO     YL0023  70
      * Define local work field Available Production
     C                     Z-ADD*ZERO     YL0024  70
      *================================================================
     CSR         ZZEXIT    ENDSR
