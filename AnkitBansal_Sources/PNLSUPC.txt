/********************************************************************/
/*                                                                  */
/*  SYNOPSIS -  BUILD THE WF A/R ORDERS BY NAME & PRINT REPORT      */
/*                                                                  */
/*  SYSTEM    - ORDER MANAGEMENT SYSTEM                             */
/*  PROGRAM   - BUILD THE WF A/R ORDERS BY NAME & PRINT REPORT      */
/*              SUBMITTED FROM PNLQUPC                              */
/*  DATE      - 09/16/2009                                          */
/*                                                                  */
/*  PARAMETERS:                                                     */
/*                                                                  */
/*  &RETURN     - RETURN CODE                                       */
/*  &OUTQ       - OUTPUT QUEUE                                      */
/*  &COPIES     - NUMBER OF COPIES                                  */
/*  &NIGHTQ     - NIGHT QUEUE                                       */
/*  &HOLD       - HOLD PRINT FLAG                                   */
/*  &SAVE       - SAVE PRINT FLAG                                   */
/*  &APPLIC     - APPLICATION CODE                                  */
/*  &COMPNYN    - COMPANY NUMBER (PASSED)                           */
/*  &FRMDATN    - FROM DATE      (PASSED)                           */
/*  &THRDATN    - THRU DATE      (PASSED)                           */
/*  &CUSTNAME   - CUSTOMER NAME                                     */
/*  &CUSTNBR    - CUSTOMER NBR                                      */
/*  &ADJTYP1    - ADJUSTMENT TYPE 1                                 */
/*  &ADJTYP2    - ADJUSTMENT TYPE 2                                 */
/*  &ADJTYP3    - ADJUSTMENT TYPE 3                                 */
/*  &ADJTYP4    - ADJUSTMENT TYPE 4                                 */
/*  &ADJTYP5    - ADJUSTMENT TYPE 5                                 */
/*  &ADJTYP6    - ADJUSTMENT TYPE 6                                 */
/*  &ADJTYP7    - ADJUSTMENT TYPE 7                                 */
/*  &ADJTYP8    - ADJUSTMENT TYPE 8                                 */
/*  &ADJTYP9    - ADJUSTMENT TYPE 9                                 */
/*  &ADJTYP10   - ADJUSTMENT TYPE 10                                */
/*  &COMP1      - COMPANY NUMBER 1      NOT PASSED                  */
/*  &COMP2      - COMPANY NUMBER 2                                  */
/*  &COMP3      - COMPANY NUMBER 3                                  */
/*  &INVSFX1    - INVOICE SUFFIX 1                                  */
/*  &INVSFX2    - INVOICE SUFFIX 2                                  */
/*  &INVSFX3    - INVOICE SUFFIX 3                                  */
/*  &INVSFX4    - INVOICE SUFFIX 4                                  */
/*  &INVSFX5    - INVOICE SUFFIX 5                                  */
/*  &INVSFX6    - INVOICE SUFFIX 6                                  */
/*  &RPTFMT     - REPORT FORMAT  (E OR P)                           */
/*  &EMAILADDR  - EMAIL ADDRESS                                     */
/*  &RPTTYPE    - REPORT TYPE (C=1 CO, A=ALL, M=MULTIPLE SEL)       */
/********************************************************************/
/** 12/21/2022 EL 103904 SELECT ONE CUST LOGIC ADDED               **/
/** 03/29/2017 LJB  E009707                                        **/
/**   INVOICE SUFFIXES, MORE COMPANIES, REPORT FORMAT AND          **/
/**   EMAIL ADDRESS WERE ADDED TO THE WORK FILE                    **/
/**   CUST NAME FUNCTIONALITY ISN'T WORKING SO NAME IS NO LONGER   **/
/**   BEING PASSED, JUST BLANKS IN THE FIELD                       **/
/********************************************************************/
 PNLSUPC:    PGM        PARM(&RETURN &OUTQ &HOLD &SAVE &COMPNYN &CUST155 +
                          &FRMDATN &THRDATN &COPIES &RPTTYPE +
                          &CUSTNAME &ADJTYP1 &ADJTYP2 &ADJTYP3 +
                          &ADJTYP4 &ADJTYP5 &ADJTYP6 &ADJTYP7 +
                          &ADJTYP8 &ADJTYP9 &ADJTYP10 +
                          &COMP2N &COMP3N &INVSFX1 &INVSFX2 +
                          &INVSFX3 &INVSFX4 &INVSFX5 &INVSFX6 +
                          &RPTFMT &EMAILADDR)
/* PARMS                                                             */
             DCL        VAR(&RETURN) TYPE(*CHAR) LEN(7)
             DCL        VAR(&COMPNYN) TYPE(*DEC)
             DCL        VAR(&CUST155) TYPE(*DEC) LEN(15 5)
             DCL        VAR(&CUSTNBR) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&COMP) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&FRMDATN) TYPE(*DEC)
             DCL        VAR(&FRMDAT) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&THRDATN) TYPE(*DEC)
             DCL        VAR(&THRDAT) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&CUSTNAME) TYPE(*CHAR) LEN(30)
             DCL        VAR(&ADJTYP1) TYPE(*CHAR) LEN(3)
             DCL        VAR(&ADJTYP2) TYPE(*CHAR) LEN(3)
             DCL        VAR(&ADJTYP3) TYPE(*CHAR) LEN(3)
             DCL        VAR(&ADJTYP4) TYPE(*CHAR) LEN(3)
             DCL        VAR(&ADJTYP5) TYPE(*CHAR) LEN(3)
             DCL        VAR(&ADJTYP6) TYPE(*CHAR) LEN(3)
             DCL        VAR(&ADJTYP7) TYPE(*CHAR) LEN(3)
             DCL        VAR(&ADJTYP8) TYPE(*CHAR) LEN(3)
             DCL        VAR(&ADJTYP9) TYPE(*CHAR) LEN(3)
             DCL        VAR(&ADJTYP10) TYPE(*CHAR) LEN(3)
             DCL        VAR(&COMP1N)  TYPE(*DEC)          /* NOT PASSED */
             DCL        VAR(&COMP2N)  TYPE(*DEC)
             DCL        VAR(&COMP3N)  TYPE(*DEC)
             DCL        VAR(&COMP1)   TYPE(*DEC) LEN(3 0) /* NOT PASSED */
             DCL        VAR(&COMP2)   TYPE(*DEC) LEN(3 0)
             DCL        VAR(&COMP3)   TYPE(*DEC) LEN(3 0)
             DCL        VAR(&INVSFX1) TYPE(*CHAR) LEN(2)
             DCL        VAR(&INVSFX2) TYPE(*CHAR) LEN(2)
             DCL        VAR(&INVSFX3) TYPE(*CHAR) LEN(2)
             DCL        VAR(&INVSFX4) TYPE(*CHAR) LEN(2)
             DCL        VAR(&INVSFX5) TYPE(*CHAR) LEN(2)
             DCL        VAR(&INVSFX6) TYPE(*CHAR) LEN(2)
             DCL        VAR(&RPTFMT)  TYPE(*CHAR) LEN(1)
             DCL        VAR(&EMAILADDR) TYPE(*CHAR) LEN(50)
             DCL        VAR(&RPTTYPE) TYPE(*CHAR) LEN(1)
             DCL        VAR(&OUTQ) TYPE(*CHAR) LEN(10)
             DCL        VAR(&HOLD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&SAVE) TYPE(*CHAR) LEN(4)
             DCL        VAR(&COPIES) TYPE(*DEC)
             DCL        VAR(&COPY) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&MSG) TYPE(*CHAR) LEN(512)
             DCL        VAR(&MSGID) TYPE(*CHAR) LEN(7)
             DCL        VAR(&MSGL) TYPE(*DEC) LEN(5 0)

             CHGVAR &CUSTNBR &CUST155
/*   MONITOR MESSAGES                                               */
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(MSGTRAP))

/*******     ADDLIBLE   LIB(PRKDEVQRY) POSITION(*LAST)            +
             MONMSG     MSGID(CPF2103)                   *********/

/*   INITIALIZE VARIABLES                                           */

             CHGVAR     VAR(&RETURN) VALUE('       ')
             CHGVAR     VAR(&COPY) VALUE(&COPIES)
             IF         COND(&COPY *LE 0) THEN(CHGVAR VAR(&COPY) +
                          VALUE(1))
             CHGVAR     VAR(&COMP) VALUE(&COMPNYN)
             CHGVAR     VAR(&COMP2) VALUE(&COMP2N)
             CHGVAR     VAR(&COMP3) VALUE(&COMP3N)
             CHGVAR     VAR(&FRMDAT) VALUE(&FRMDATN)
             CHGVAR     VAR(&THRDAT) VALUE(&THRDATN)

/*   BUILD WORK FILE AND LOGICALS IN QTEMP                          */
             CRTDUPOBJ  OBJ(PDK5REP) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) DATA(*NO) CST(*NO) TRG(*NO)
             MONMSG     MSGID(CPF2130)
             CLRPFM     FILE(QTEMP/PDK5REP)
             MONMSG     MSGID(CPF3142)
             OVRDBF     FILE(PDK5REP) TOFILE(QTEMP/PDK5REP)

             CRTDUPOBJ  OBJ(PDK5REL0) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) DATA(*NO)
             MONMSG     MSGID(CPF2130)
             OVRDBF     FILE(PDK5REL0) TOFILE(QTEMP/PDK5REL0)

             CRTDUPOBJ  OBJ(PDK5REL1) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) DATA(*NO)
             MONMSG     MSGID(CPF2130)
             OVRDBF     FILE(PDK5REL1) TOFILE(QTEMP/PDK5REL1)

             CRTDUPOBJ  OBJ(PDK5REL2) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) DATA(*NO)
             MONMSG     MSGID(CPF2130)
             OVRDBF     FILE(PDK5REL2) TOFILE(QTEMP/PDK5REL2)

             CRTDUPOBJ  OBJ(PDK5REL3) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) DATA(*NO)
             MONMSG     MSGID(CPF2130)
             OVRDBF     FILE(PDK5REL3) TOFILE(QTEMP/PDK5REL3)

             CRTDUPOBJ  OBJ(PDK5REL4) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) DATA(*NO)
             MONMSG     MSGID(CPF2130)
             OVRDBF     FILE(PDK5REL4) TOFILE(QTEMP/PDK5REL4)

/*   PROGRAM TO BUILD THE WORKFILE                                  */
/*   ADDITIONAL COMPANIES, INV SUFFIXES ADDED  E009707              */
             CALL       PGM(PDVNXFR) PARM(&RETURN &COMP &CUSTNBR &FRMDAT +
                          &THRDAT &CUSTNAME &ADJTYP1 &ADJTYP2 +
                          &ADJTYP3 &ADJTYP4 &ADJTYP5 &ADJTYP6 +
                          &ADJTYP7 &ADJTYP8 &ADJTYP9 &ADJTYP10 +
                          &COMP2 &COMP3 &INVSFX1 &INVSFX2 +
                          &INVSFX3 &INVSFX4 &INVSFX5 &INVSFX6 +
                          &RPTTYPE)

/*** FOR TESTING ONLY - THE GOTO SKIPS THE TEST                */
  GOTO OVRPRTF
             CLRPFM     FILE(OMSDEVGEN/PDK5REPSV)
             MONMSG     MSGID(CPF0000)

             CPYF       FROMFILE(QTEMP/PDK5REP) +
                          TOFILE(OMSDEVGEN/PDK5REPSV) +
                          MBROPT(*REPLACE) CRTFILE(*YES)
             MONMSG     MSGID(CPF3142 CPF2817)

 OVRPRTF:
             OVRPRTF    FILE(PNLRPFR$) OUTQ(&OUTQ) COPIES(&COPY) +
                          HOLD(&HOLD) SAVE(&SAVE)
             OVRPRTF    FILE(PNLTPFR$) OUTQ(&OUTQ) COPIES(&COPY) +
                          HOLD(&HOLD) SAVE(&SAVE)
             OVRPRTF    FILE(PUBRPFR$) OUTQ(&OUTQ) COPIES(&COPY) +
                          HOLD(&HOLD) SAVE(&SAVE)

             IF         COND(&RPTFMT *EQ 'P') THEN(DO)

/*   PRINT THE REPORT-1 COMPANY                                     */
             IF         COND(&RPTTYPE *EQ 'C') THEN(CALL +
                          PGM(PNLRPFR) PARM(&RETURN &COMP &CUSTNAME &CUSTNBR +
                          &THRDAT &FRMDAT &RPTTYPE &ADJTYP1 +
                          &ADJTYP2 &ADJTYP3 &ADJTYP4 &ADJTYP5 +
                          &ADJTYP6 &ADJTYP7 &ADJTYP8 &ADJTYP9 +
                          &ADJTYP10 &COMP1 &COMP2 &COMP3 &INVSFX1 +
                          &INVSFX2 &INVSFX3 &INVSFX4 &INVSFX5 +
                          &INVSFX6))

/*   PRINT THE REPORT-ALL COS                                       */
             IF         COND(&RPTTYPE *EQ 'A') THEN(CALL +
                          PGM(PNLTPFR) PARM(&RETURN &CUSTNAME &CUSTNBR +
                          &THRDAT &FRMDAT &RPTTYPE &ADJTYP1 +
                          &ADJTYP2 &ADJTYP3 &ADJTYP4 &ADJTYP5 +
                          &ADJTYP6 &ADJTYP7 &ADJTYP8 &ADJTYP9 +
                          &ADJTYP10 &COMP &COMP2 &COMP3 &INVSFX1 +
                          &INVSFX2 &INVSFX3 &INVSFX4 &INVSFX5 +
                          &INVSFX6))

/*   PRINT THE REPORT-FOR MULTIPLE COMPANIES                        */
             IF         COND(&RPTTYPE *EQ 'M') THEN(CALL +
                          PGM(PUBRPFR) PARM(&RETURN &COMP &CUSTNAME &CUSTNBR +
                          &THRDAT &FRMDAT &RPTTYPE &ADJTYP1 +
                          &ADJTYP2 &ADJTYP3 &ADJTYP4 &ADJTYP5 +
                          &ADJTYP6 &ADJTYP7 &ADJTYP8 &ADJTYP9 +
                          &ADJTYP10 &COMP1 &COMP2 &COMP3 &INVSFX1 +
                          &INVSFX2 &INVSFX3 &INVSFX4 &INVSFX5 +
                          &INVSFX6))

             ENDDO        /* END RPTFMT = "P" PRINT  */

/* EMAIL SPREADSHEET, IF REQUESTED                                   */
             IF         COND(&RPTFMT *EQ 'E') THEN(EXECUTE +
                          VIEW(PDK5REPV1) PCFMT(*XLS) +
                          RECIPIENT(&EMAILADDR) EMLMSG('A/R +
                          Adjustment Type Report'))

             GOTO       CMDLBL(END)

/*-------------------------USER QUIT--------------------------------*/
 USERQUIT:   CHGVAR     VAR(&RETURN) VALUE('Y2U0005')
             GOTO       CMDLBL(END)

/*----------------------RECEIVE MESSAGES----------------------------*/

 MSGTRAP:    RCVMSG     MSGTYPE(*EXCP) MSGDTA(&MSG) MSGDTALEN(&MSGL) +
                          MSGID(&MSGID)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))

             SNDPGMMSG  MSGID(&MSGID) MSGF(QCPFMSG) MSGDTA(%SST(&MSG +
                          1 &MSGL)) MSGTYPE(*ESCAPE)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))

 END:    /***RMVLIBLE   LIB(PRKDEVQRY)  +
             MONMSG     MSGID(CPF0000)  *****/

             ENDPGM
