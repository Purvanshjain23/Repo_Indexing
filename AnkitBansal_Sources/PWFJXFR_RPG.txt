     H/TITLE Upd Delv Schd Dtl UPL XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 01:44:42
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPWAKCPL2IF  E           K        DISK
      * RTV : Delivery Sched Detail INT Rtv Not Processed
      *
     FPLBJCPL0IF  E           K        DISK                      A
      * UPD : Delivery Sched Detail UPL Update index
      *
     FPWAKCPL0UF  E           K        DISK
      * UPD : Delivery Sched Detail INT Update index
      *
     I@AKCPYD
      * Delivery Sched Detail INT Rtv Not Processed
      * Renamed input format fields
     I              AKZOA1                          WAZOA1
     I              AKHVDT                          WAHVDT
     I              AKB6TM                          WAB6TM
     I              AKZPA1                          WAZPA1
     I              AKZQA1                          WAZQA1
     I              AKHWDT                          WAHWDT
     I              AKHXDT                          WAHXDT
     I              AKCKTH                          WACKTH
     I              AKZSA1                          WAZSA1
     I              AKSTCD                          WASTCD
     I              AKSUCD                          WASUCD
     I              AKSVCD                          WASVCD
     I              AKJVSS                          WAJVSS
     I              AKZRA1                          WAZRA1
     I              AKJWSS                          WAJWSS
     I              AKS1CD                          WAS1CD
     I              AKSWCD                          WASWCD
     I              AKSXCD                          WASXCD
     I              AKSYCD                          WASYCD
     I              AKJXSS                          WAJXSS
     I              AKJYSS                          WAJYSS
     I              AKZTA1                          WAZTA1
     I              AKSZCD                          WASZCD
     I              AKS0CD                          WAS0CD
     I              AKJZSS                          WAJZSS
     I              AKHZDT                          WAHZDT
     I              AKCLTH                          WACLTH
     I              AKH0DT                          WAH0DT
     I              AKCMTH                          WACMTH
     I              AKHYDT                          WAHYDT
     I              AKCNTH                          WACNTH
     I              AKABCD                          WAABCD
     I              AKAECD                          WAAECD
     I              AKHMNB                          WAHMNB
     I              AKBNNB                          WABNNB
     I              AKBONB                          WABONB
     I              AKZUA1                          WAZUA1
     I              AKZVA1                          WAZVA1
     I              AKE3T1                          WAE3T1
     I              AKE4T1                          WAE4T1
     I              AKJ0SS                          WAJ0SS
     I              AKFFSS                          WAFFSS
     I              AKFGSS                          WAFGSS
     I              AKFHSS                          WAFHSS
     I              AKPVCD                          WAPVCD
     I              AKPWCD                          WAPWCD
      *
     I@BJCPRJ
      * Delivery Sched Detail UPL Update index
      * Renamed input format fields
     I              BJTFA1                          WBTFA1
     I              BJAADX                          WBAADX
     I              BJTGA1                          WBTGA1
     I              BJTHA1                          WBTHA1
     I              BJTPA1                          WBTPA1
     I              BJGXDT                          WBGXDT
     I              BJGTDT                          WBGTDT
     I              BJB8TH                          WBB8TH
     I              BJTKA1                          WBTKA1
     I              BJPJCD                          WBPJCD
     I              BJPKCD                          WBPKCD
     I              BJPLCD                          WBPLCD
     I              BJPMCD                          WBPMCD
     I              BJTMA1                          WBTMA1
     I              BJPQCD                          WBPQCD
     I              BJPPCD                          WBPPCD
     I              BJPNCD                          WBPNCD
     I              BJPOCD                          WBPOCD
     I              BJPRCD                          WBPRCD
     I              BJPSCD                          WBPSCD
     I              BJE4SS                          WBE4SS
     I              BJTOA1                          WBTOA1
     I              BJPTCD                          WBPTCD
     I              BJPUCD                          WBPUCD
     I              BJE6SS                          WBE6SS
     I              BJGWDT                          WBGWDT
     I              BJCATH                          WBCATH
     I              BJGUDT                          WBGUDT
     I              BJB9TH                          WBB9TH
     I              BJGVDT                          WBGVDT
     I              BJCBTH                          WBCBTH
     I              BJABCD                          WBABCD
     I              BJAECD                          WBAECD
     I              BJHMNB                          WBHMNB
     I              BJBNNB                          WBBNNB
     I              BJBONB                          WBBONB
     I              BJYYA1                          WBYYA1
     I              BJYZA1                          WBYZA1
     I              BJDET1                          WBDET1
     I              BJDFT1                          WBDFT1
     I              BJIHSS                          WBIHSS
     I              BJFFSS                          WBFFSS
     I              BJFGSS                          WBFGSS
     I              BJFHSS                          WBFHSS
     I              BJPVCD                          WBPVCD
     I              BJPWCD                          WBPWCD
      *
     I@AKCPYB
      * Delivery Sched Detail INT Update index
      * Renamed input format fields
     I              AKZOA1                          WCZOA1
     I              AKHVDT                          WCHVDT
     I              AKB6TM                          WCB6TM
     I              AKZPA1                          WCZPA1
     I              AKZQA1                          WCZQA1
     I              AKHWDT                          WCHWDT
     I              AKHXDT                          WCHXDT
     I              AKCKTH                          WCCKTH
     I              AKZSA1                          WCZSA1
     I              AKSTCD                          WCSTCD
     I              AKSUCD                          WCSUCD
     I              AKSVCD                          WCSVCD
     I              AKJVSS                          WCJVSS
     I              AKZRA1                          WCZRA1
     I              AKJWSS                          WCJWSS
     I              AKS1CD                          WCS1CD
     I              AKSWCD                          WCSWCD
     I              AKSXCD                          WCSXCD
     I              AKSYCD                          WCSYCD
     I              AKJXSS                          WCJXSS
     I              AKJYSS                          WCJYSS
     I              AKZTA1                          WCZTA1
     I              AKSZCD                          WCSZCD
     I              AKS0CD                          WCS0CD
     I              AKJZSS                          WCJZSS
     I              AKHZDT                          WCHZDT
     I              AKCLTH                          WCCLTH
     I              AKH0DT                          WCH0DT
     I              AKCMTH                          WCCMTH
     I              AKHYDT                          WCHYDT
     I              AKCNTH                          WCCNTH
     I              AKABCD                          WCABCD
     I              AKAECD                          WCAECD
     I              AKHMNB                          WCHMNB
     I              AKBNNB                          WCBNNB
     I              AKBONB                          WCBONB
     I              AKZUA1                          WCZUA1
     I              AKZVA1                          WCZVA1
     I              AKE3T1                          WCE3T1
     I              AKE4T1                          WCE4T1
     I              AKJ0SS                          WCJ0SS
     I              AKFFSS                          WCFFSS
     I              AKFGSS                          WCFGSS
     I              AKFHSS                          WCFHSS
     I              AKPVCD                          WCPVCD
     I              AKPWCD                          WCPWCD
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPLBJ1    E DSPLBJCPL0
      * UPD : Delivery Sched Detail UPL Update index
      * Renamed input format fields
     I              BJTFA1                          WBTFA1
     I              BJAADX                          WBAADX
     I              BJTGA1                          WBTGA1
     I              BJTHA1                          WBTHA1
     I              BJTPA1                          WBTPA1
     I              BJGXDT                          WBGXDT
     I              BJGTDT                          WBGTDT
     I              BJB8TH                          WBB8TH
     I              BJTKA1                          WBTKA1
     I              BJPJCD                          WBPJCD
     I              BJPKCD                          WBPKCD
     I              BJPLCD                          WBPLCD
     I              BJPMCD                          WBPMCD
     I              BJTMA1                          WBTMA1
     I              BJPQCD                          WBPQCD
     I              BJPPCD                          WBPPCD
     I              BJPNCD                          WBPNCD
     I              BJPOCD                          WBPOCD
     I              BJPRCD                          WBPRCD
     I              BJPSCD                          WBPSCD
     I              BJE4SS                          WBE4SS
     I              BJTOA1                          WBTOA1
     I              BJPTCD                          WBPTCD
     I              BJPUCD                          WBPUCD
     I              BJE6SS                          WBE6SS
     I              BJGWDT                          WBGWDT
     I              BJCATH                          WBCATH
     I              BJGUDT                          WBGUDT
     I              BJB9TH                          WBB9TH
     I              BJGVDT                          WBGVDT
     I              BJCBTH                          WBCBTH
     I              BJABCD                          WBABCD
     I              BJAECD                          WBAECD
     I              BJHMNB                          WBHMNB
     I              BJBNNB                          WBBNNB
     I              BJBONB                          WBBONB
     I              BJYYA1                          WBYYA1
     I              BJYZA1                          WBYZA1
     I              BJDET1                          WBDET1
     I              BJDFT1                          WBDFT1
     I              BJIHSS                          WBIHSS
     I              BJFFSS                          WBFFSS
     I              BJFGSS                          WBFGSS
     I              BJFHSS                          WBFHSS
     I              BJPVCD                          WBPVCD
     I              BJPWCD                          WBPWCD
      *
     IQPWAK1    E DSPWAKCPL0
      * UPD : Delivery Sched Detail INT Update index
      * Renamed input format fields
     I              AKZOA1                          WCZOA1
     I              AKHVDT                          WCHVDT
     I              AKB6TM                          WCB6TM
     I              AKZPA1                          WCZPA1
     I              AKZQA1                          WCZQA1
     I              AKHWDT                          WCHWDT
     I              AKHXDT                          WCHXDT
     I              AKCKTH                          WCCKTH
     I              AKZSA1                          WCZSA1
     I              AKSTCD                          WCSTCD
     I              AKSUCD                          WCSUCD
     I              AKSVCD                          WCSVCD
     I              AKJVSS                          WCJVSS
     I              AKZRA1                          WCZRA1
     I              AKJWSS                          WCJWSS
     I              AKS1CD                          WCS1CD
     I              AKSWCD                          WCSWCD
     I              AKSXCD                          WCSXCD
     I              AKSYCD                          WCSYCD
     I              AKJXSS                          WCJXSS
     I              AKJYSS                          WCJYSS
     I              AKZTA1                          WCZTA1
     I              AKSZCD                          WCSZCD
     I              AKS0CD                          WCS0CD
     I              AKJZSS                          WCJZSS
     I              AKHZDT                          WCHZDT
     I              AKCLTH                          WCCLTH
     I              AKH0DT                          WCH0DT
     I              AKCMTH                          WCCMTH
     I              AKHYDT                          WCHYDT
     I              AKCNTH                          WCCNTH
     I              AKABCD                          WCABCD
     I              AKAECD                          WCAECD
     I              AKHMNB                          WCHMNB
     I              AKBNNB                          WCBNNB
     I              AKBONB                          WCBONB
     I              AKZUA1                          WCZUA1
     I              AKZVA1                          WCZVA1
     I              AKE3T1                          WCE3T1
     I              AKE4T1                          WCE4T1
     I              AKJ0SS                          WCJ0SS
     I              AKFFSS                          WCFFSS
     I              AKFGSS                          WCFGSS
     I              AKFHSS                          WCFHSS
     I              AKPVCD                          WCPVCD
     I              AKPWCD                          WCPWCD
      *
     IYARDCS      DS                            223
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Delivery Sched Detail INT
      * I :  DSI Company Number
     I                                        1   30P1ZOA1
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1ZOA1    PARM           WP0001  30       DSI Company Num
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Upd Delv Schd Dtl UPL XF
      * E10812 JJH 12/09/17 - Update Delivery Schedule Dtl UPL
     C                     EXSR UASUBR                     E10812 JJH 12/0
      * E31600 JBB  5/08/18 - Recompile for Audit Stamp inclusion
     C                     EXSR UBSUBR                     E31600 JBB  5/0
      * H16853 ISE 11/04/2020 - Recompiled due to change in Buy Order Num
     C                     EXSR UCSUBR                     H16853 ISE 11/0
      * Create Delivery Sched Detail UPL
      * Upd Delv Schd Dtl UPL RT - Delivery Sched Detail INT  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Upd Delv Schd Dtl UPL RT - Delivery Sched Detail INT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAZOA1    WQSA01           DSI Company Num
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           DSI Company Num
      * Setup key
     C                     Z-ADDP1ZOA1    WQSA01           DSI Company Num
      * Establish starting position
     C           KRSSA     SETLL@AKCPYD                    *
     C           KRSSA     READE@AKCPYD                  90*
      * Data record not found
     C   90                MOVEL'PRK1471' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Create Delivery Sched Detail UPL
      * Crt Delivery Sched DetUCR - Delivery Sched Detail UPL  * 
     C                     EXSR SBCRRC
      * Set DSU Process Status = Processed
      * Chg DSU Process StatusCH - Delivery Sched Detail INT  * 
     C                     EXSR SCCHRC
     C           KRSSA     READE@AKCPYD                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCRRC    BEGSR
      *================================================================
      * Crt Delivery Sched DetUCR - Delivery Sched Detail UPL  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        DSU Record Stat
     C                     Z-ADD*ZERO     WN0002  70       DSU Change Date
     C                     Z-ADD*ZERO     WN0003  60       DSU Change Time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BJCPRJ
     C                     Z-ADDWAZOA1    WBTFA1           DSU Company Num
     C                     Z-ADDWAHVDT    WBAADX           DSU Transaction
     C                     Z-ADDWAB6TM    WBTGA1           DSU Transaction
     C                     Z-ADDWAZPA1    WBTHA1           DSU Transaction
     C                     Z-ADDWAZQA1    WBTPA1           DSU Split Seque
     C                     Z-ADDWAHWDT    WBGXDT           DSU Kill Date
     C                     Z-ADDWAHXDT    WBGTDT           DSU Delivery Da
     C                     Z-ADDWACKTH    WBB8TH           DSU Delivery Ti
     C                     Z-ADDWAZSA1    WBTKA1           DSU Farm Site C
     C                     MOVELWASTCD    WBPJCD           DSU Building
     C                     MOVELWASUCD    WBPKCD           DSU Room
     C                     MOVELWASVCD    WBPLCD           DSU Sire Line C
     C                     MOVELWAJVSS    WBPMCD           DSU Hog Group C
     C                     Z-ADDWAZRA1    WBTMA1           DSU Scheduled D
     C                     MOVELWAJWSS    WBPQCD           UnUsed Status 5
     C                     MOVELWAS1CD    WBPPCD           UnUsed Code 5
     C                     MOVELWASWCD    WBPNCD           DSU Driver
     C                     MOVELWASXCD    WBPOCD           DSU Loading Cre
     C                     MOVELWASYCD    WBPRCD           DSU Hauler Reas
     C                     MOVELWAJXSS    WBPSCD           DSU Load Type
     C                     MOVELWAJYSS    WBE4SS           DSU Full/Split
     C                     Z-ADDWAZTA1    WBTOA1           DSU Movement Nu
     C                     MOVELWASZCD    WBPTCD           DSU Truck ID
     C                     MOVELWAS0CD    WBPUCD           DSU Trailer ID
     C                     MOVELWAJZSS    WBE6SS           DSU Sched Route
     C                     Z-ADDWAHZDT    WBGWDT           DSU Sched Route
     C                     Z-ADDWACLTH    WBCATH           DSU Sched Route
     C                     Z-ADDWAH0DT    WBGUDT           DSU Sch Farm Ar
     C                     Z-ADDWACMTH    WBB9TH           DSU Sch Farm Ar
     C                     Z-ADDWAHYDT    WBGVDT           DSU Sch Start L
     C                     Z-ADDWACNTH    WBCBTH           DSU Sch Start L
     C                     MOVELWAABCD    WBABCD           PD Producer Cod
     C                     MOVELWAAECD    WBAECD           PL Location Cod
     C                     Z-ADDWAHMNB    WBHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WBBONB           BOL Load Number
     C                     Z-ADDWAZUA1    WBYYA1           DSU PRD Srv Bat
     C                     Z-ADDWAZVA1    WBYZA1           DSU PRD Srv Sch
     C                     MOVELWAE3T1    WBDET1           DSU Ref 1
     C                     MOVELWAE4T1    WBDFT1           DSU Ref 2
     C                     MOVELWAJ0SS    WBIHSS           DSU Ref Status
     C                     Z-ADD*ZERO     WBFGSS           DSU Process Sta
     C                     MOVEL*BLANK    WBFHSS           DSU Error Reaso
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBFFSS           DSU Record Stat
     C                     Z-ADD##JDT     WBPVCD           DSU Change Date
     C                     Z-ADD##JTM     WBPWCD           DSU Change Time
     C           KLCRSB    KLIST
     C                     KFLD           WBTFA1           DSU Company Num
     C                     KFLD           WBAADX           DSU Transaction
     C                     KFLD           WBTGA1           DSU Transaction
     C                     KFLD           WBTHA1           DSU Transaction
      * Check for duplicate primary key
     C           KLCRSB    SETLL@BJCPRJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1276' W0RTN   7
      * Send message 'Delivery Sched 1309442'
     C                     MOVEL'PRK1276' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C                     WRITE@BJCPRJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCHRC    BEGSR
      *================================================================
      * Chg DSU Process StatusCH - Delivery Sched Detail INT  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0004  70       DSI Kill Date
     C                     Z-ADD*ZERO     WN0005  70       DSI Delivery Da
     C                     Z-ADD*ZERO     WN0006  40       DSI Delivery Ti
     C                     Z-ADD*ZERO     WN0007  50       DSI Farm Site C
     C                     MOVEL*BLANK    WN0008  5        DSI Building
     C                     MOVEL*BLANK    WN0009  5        DSI Room
     C                     MOVEL*BLANK    WN0010  5        DSI Sire Line C
     C                     MOVEL*BLANK    WN0011  7        DSI Hog Group C
     C                     Z-ADD*ZERO     WN0012  30       DSI Scheduled D
     C                     MOVEL*BLANK    WN0013  5        DSI Unused Stat
     C                     MOVEL*BLANK    WN0014  5        DSI Unused Code
     C                     MOVEL*BLANK    WN0015  5        DSI Driver
     C                     MOVEL*BLANK    WN0016  5        DSI Loading Cre
     C                     MOVEL*BLANK    WN0017  6        DSI Hauler Reas
     C                     MOVEL*BLANK    WN0018  2        DSI Load Type
     C                     MOVEL*BLANK    WN0019  1        DSI Full/Split
     C                     Z-ADD*ZERO     WN0020  70       DSI Movement Nu
     C                     MOVEL*BLANK    WN0021 15        DSI Truck ID
     C                     MOVEL*BLANK    WN0022 15        DSI Trailer ID
     C                     MOVEL*BLANK    WN0023  1        DSI Sched Route
     C                     Z-ADD*ZERO     WN0024  70       DSI Sched Route
     C                     Z-ADD*ZERO     WN0025  40       DSI Sched Route
     C                     Z-ADD*ZERO     WN0026  70       DSI Sch Farm Ar
     C                     Z-ADD*ZERO     WN0027  40       DSI Sch Farm Ar
     C                     Z-ADD*ZERO     WN0028  70       DSI Sch Start L
     C                     Z-ADD*ZERO     WN0029  40       DSI Sch Start L
     C                     MOVEL*BLANK    WN0030  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0031  6        PL Location Cod
     C                     Z-ADD*ZERO     WN0032  30       BOH Company Num
     C                     Z-ADD*ZERO     WN0033  70       BOH Buy Order N
     C                     Z-ADD*ZERO     WN0034  50       BOL Load Number
     C                     Z-ADD*ZERO     WN0035 100       DSI PRD Srv Bat
     C                     Z-ADD*ZERO     WN0036 100       DSI PRD Srv Sch
     C                     MOVEL*BLANK    WN0037 10        DSI Ref 1
     C                     MOVEL*BLANK    WN0038 10        DSI Ref 2
     C                     MOVEL*BLANK    WN0039  2        DSI Ref Status
     C                     MOVEL*BLANK    WN0040  1        DSU Record Stat
     C                     MOVEL*BLANK    WN0041  6        DSU Error Reaso
     C                     Z-ADD*ZERO     WN0042  70       DSU Change Date
     C                     Z-ADD*ZERO     WN0043  60       DSU Change Time
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @AKCPYB
     C                     Z-ADDWAZOA1    WCZOA1           DSI Company Num
     C                     Z-ADDWAHVDT    WCHVDT           DSI Transaction
     C                     Z-ADDWAB6TM    WCB6TM           DSI Transaction
     C                     Z-ADDWAZPA1    WCZPA1           DSI Transaction
      *
     C           KLCHSC    KLIST
     C                     KFLD           WCZOA1           DSI Company Num
     C                     KFLD           WCHVDT           DSI Transaction
     C                     KFLD           WCB6TM           DSI Transaction
     C                     KFLD           WCZPA1           DSI Transaction
     C           KLCHSC    CHAIN@AKCPYB              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PWAKCPL0'MDACP
     C                     MOVEL'@AKCPYB' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPWAK1    YARDCS
      * Move non-key fields to @AKCPYB
     C                     Z-ADDWAZQA1    WCZQA1           DSI Split Seque
     C                     Z-ADD1         WCFGSS           DSU Process Sta
      *
      * Set PGM.*Record Data Changed flag
     C           QPWAK1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL'C'       WCFFSS           DSU Record Stat
     C                     Z-ADD##JDT     WCPVCD           DSU Change Date
     C                     Z-ADD##JTM     WCPWCD           DSU Change Time
      * Set PGM.*Record Data Changed flag
     C           QPWAK1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@AKCPYB                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPWAKCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * E10812 JJH 12/09/17 - Update Delivery Schedule Dtl UPL
      *================================================================
      * - Process all records by Company with a DSU Process Status = Not
      *   processed (0)
      * - Copy record from Delivery Sched Detail INT to Delivery Sched
      *   Detail UPL
      * - Set DSU Process Status to Processed (1) in Delivery Sched Detai
      *   INT
      * - Set DSU Process Status to Not Processed (0) in Delivery Sched
      *   Dtl UPL
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * E31600 JBB  5/08/18 - Recompile for Audit Stamp inclusion
      *================================================================
      * Update audit stamp on UPL record
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * H16853 ISE 11/04/2020 - Recompiled due to change in Buy Order Nu
      *================================================================
      * - Process all records by Company with a DSU Process Status = Not
      *   processed (0)
      * - Copy record from Delivery Sched Detail INT to Delivery Sched
      *   Detail UPL
      * - Set DSU Process Status to Processed (1) in Delivery Sched Detai
      *   INT
      * - Set DSU Process Status to Not Processed (0) in Delivery Sched
      *   Dtl UPL
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAZOA1           DSI Company Num
     C                     Z-ADD*ZERO     WAHVDT           DSI Transaction
     C                     Z-ADD*ZERO     WAB6TM           DSI Transaction
     C                     Z-ADD*ZERO     WAZPA1           DSI Transaction
     C                     Z-ADD*ZERO     WAZQA1           DSI Split Seque
     C                     Z-ADD*ZERO     WAHWDT           DSI Kill Date
     C                     Z-ADD*ZERO     WAHXDT           DSI Delivery Da
     C                     Z-ADD*ZERO     WACKTH           DSI Delivery Ti
     C                     Z-ADD*ZERO     WAZSA1           DSI Farm Site C
     C                     Z-ADD*ZERO     WAZRA1           DSI Scheduled D
     C                     Z-ADD*ZERO     WAZTA1           DSI Movement Nu
     C                     Z-ADD*ZERO     WAHZDT           DSI Sched Route
     C                     Z-ADD*ZERO     WACLTH           DSI Sched Route
     C                     Z-ADD*ZERO     WAH0DT           DSI Sch Farm Ar
     C                     Z-ADD*ZERO     WACMTH           DSI Sch Farm Ar
     C                     Z-ADD*ZERO     WAHYDT           DSI Sch Start L
     C                     Z-ADD*ZERO     WACNTH           DSI Sch Start L
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WAZUA1           DSI PRD Srv Bat
     C                     Z-ADD*ZERO     WAZVA1           DSI PRD Srv Sch
     C                     Z-ADD*ZERO     WAFGSS           DSU Process Sta
     C                     Z-ADD*ZERO     WAPVCD           DSU Change Date
     C                     Z-ADD*ZERO     WAPWCD           DSU Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBTFA1           DSU Company Num
     C                     Z-ADD*ZERO     WBAADX           DSU Transaction
     C                     Z-ADD*ZERO     WBTGA1           DSU Transaction
     C                     Z-ADD*ZERO     WBTHA1           DSU Transaction
     C                     Z-ADD*ZERO     WBTPA1           DSU Split Seque
     C                     Z-ADD*ZERO     WBGXDT           DSU Kill Date
     C                     Z-ADD*ZERO     WBGTDT           DSU Delivery Da
     C                     Z-ADD*ZERO     WBB8TH           DSU Delivery Ti
     C                     Z-ADD*ZERO     WBTKA1           DSU Farm Site C
     C                     Z-ADD*ZERO     WBTMA1           DSU Scheduled D
     C                     Z-ADD*ZERO     WBTOA1           DSU Movement Nu
     C                     Z-ADD*ZERO     WBGWDT           DSU Sched Route
     C                     Z-ADD*ZERO     WBCATH           DSU Sched Route
     C                     Z-ADD*ZERO     WBGUDT           DSU Sch Farm Ar
     C                     Z-ADD*ZERO     WBB9TH           DSU Sch Farm Ar
     C                     Z-ADD*ZERO     WBGVDT           DSU Sch Start L
     C                     Z-ADD*ZERO     WBCBTH           DSU Sch Start L
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBBONB           BOL Load Number
     C                     Z-ADD*ZERO     WBYYA1           DSU PRD Srv Bat
     C                     Z-ADD*ZERO     WBYZA1           DSU PRD Srv Sch
     C                     Z-ADD*ZERO     WBFGSS           DSU Process Sta
     C                     Z-ADD*ZERO     WBPVCD           DSU Change Date
     C                     Z-ADD*ZERO     WBPWCD           DSU Change Time
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
