     H/TITLE BLD Weekly Claims DwnldXF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSMASO
     H* Date          : 02/23/10  Time  : 08:54:41
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDMKCPL1IF  E           K        DISK
      * RTV : A/R Claim                 Retrieval index
      *
     FPDMOCPL1IF  E           K        DISK
      * RTV : A/R Claim Product         Retrieval index
      *
     FOMHSTPL1IF  E           K        DISK
      * RTV : Sales History             Retrieval index
      *
     FPDJEREL2IF  E           K        DISK
      * RTV : Sales Route               Active Records
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCAAPREL2IF  E           K        DISK
      * RTV : Salesperson               Retrieval index       V
      *
     FPDMNCPL2IF  E           K        DISK
      * RTV : A/R Claim Explanation     Retrieval Index Expl Onl
      *
     FPPATREL1IF  E           K        DISK
      * RTV : A/R Claim Department      Retrieval index
      *
     FPDMPCPL1IF  E           K        DISK
      * RTV : A/R Claim Resale Product  Retrieval index
      *
     FOPBGWKLAIF  E           K        DISK
      * RSQ : Order Detail              co/
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FOPCXREL1IF  E           K        DISK
      * RTV : OP Reason Codes           Retrieval index
      *
     FPDNACPL2IF  E           K        DISK
      * RSQ : WF A/R Claim Download     1st Reason Code/Claim #
      *
     FPDNACPL0IF  E           K        DISK                      A
      * UPD : WF A/R Claim Download     Update index
      *
     FPDNBCPL0IF  E           K        DISK                      A
      * UPD : WF A/R Claim Reas Dwnld   Update index
      *
      * Long constants
     E                    @CN#    1   1  6   @CN    25
     E                    YK01       20 11  A            Claim Unique Re
      *
     E                    YK02       20 11  A            Claim Unique De
      *
     E                    YDOW        7  1               *Days of week
     I@MKCPWB
      * A/R Claim                 Retrieval index
      * Renamed input format fields
     I              MKC0C7                          WAC0C7
     I              MKZLCD                          WAZLCD
     I              MKBIC3                          WABIC3
     I              MKALNX                          WAALNX
     I              MKRMNB                          WARMNB
     I              MKC3C7                          WAC3C7
     I              MKRFTX                          WARFTX
     I              MKCHSX                          WACHSX
     I              MKCJSX                          WACJSX
     I              MKAYVL                          WAAYVL
     I              MKAZVL                          WAAZVL
     I              MKA0VL                          WAA0VL
     I              MKPQTX                          WAPQTX
     I              MKCNSX                          WACNSX
     I              MKPLTX                          WAPLTX
     I              MKCOSX                          WACOSX
     I              MKPMTX                          WAPMTX
     I              MKCPSX                          WACPSX
     I              MKA1VL                          WAA1VL
     I              MKPNTX                          WAPNTX
     I              MKPOTX                          WAPOTX
     I              MKMLDT                          WAMLDT
     I              MKEJDT                          WAEJDT
     I              MKCQSX                          WACQSX
     I              MKPPTX                          WAPPTX
     I              MKMMDT                          WAMMDT
     I              MKMNDT                          WAMNDT
     I              MKBGTM                          WABGTM
     I              MKCGVN                          WACGVN
     I              MKC4C7                          WAC4C7
     I              MKO2NA                          WAO2NA
     I              MKNFDT                          WANFDT
     I              MKBJTM                          WABJTM
     I              MKCQVN                          WACQVN
     I              MKMODT                          WAMODT
     I              MKBHTM                          WABHTM
     I              MKCHVN                          WACHVN
     I              MKCRSX                          WACRSX
     I              MKMPDT                          WAMPDT
     I              MKBITM                          WABITM
     I              MKCIVN                          WACIVN
     I              MKTBTX                          WATBTX
     I              MKEOVL                          WAEOVL
     I              MKEPVL                          WAEPVL
     I              MKP6DT                          WAP6DT
     I              MKCRTM                          WACRTM
     I              MKYSNX                          WAYSNX
     I              MKT5SX                          WAT5SX
     I              MKF7PC                          WAF7PC
     I              MKF8PC                          WAF8PC
     I              MKF9PC                          WAF9PC
     I              MKEQVL                          WAEQVL
     I              MKERVL                          WAERVL
     I              MKESVL                          WAESVL
     I              MKETVL                          WAETVL
     I              MKT7SX                          WAT7SX
     I              MKT8SX                          WAT8SX
     I              MKT9SX                          WAT9SX
     I              MKUASX                          WAUASX
     I              MKUBSX                          WAUBSX
     I              MKGAPC                          WAGAPC
     I              MKGBPC                          WAGBPC
     I              MKVSST                          WAVSST
     I              MKMJDT                          WAMJDT
     I              MKBETM                          WABETM
     I              MKCCVN                          WACCVN
     I              MKCDVN                          WACDVN
     I              MKMKDT                          WAMKDT
     I              MKBFTM                          WABFTM
     I              MKCEVN                          WACEVN
     I              MKCFVN                          WACFVN
      *
     I@MOCPWK
      * A/R Claim Product         Retrieval index
      * Renamed input format fields
     I              MOC0C7                          WDC0C7
     I              MOAFNX                          WDAFNX
     I              MOBIC3                          WDBIC3
     I              MOC1C7                          WDC1C7
     I              MOCQCD                          WDCQCD
     I              MOHHCD                          WDHHCD
     I              MOCISX                          WDCISX
     I              MOFUAA                          WDFUAA
     I              MODPNB                          WDDPNB
     I              MOUENB                          WDUENB
     I              MOKUQT                          WDKUQT
     I              MOHHWG                          WDHHWG
     I              MODIPR                          WDDIPR
     I              MOBNVL                          WDBNVL
     I              MOF0SX                          WDF0SX
     I              MOF1SX                          WDF1SX
     I              MOF2SX                          WDF2SX
     I              MOFXPR                          WDFXPR
     I              MOAMST                          WDAMST
     I              MOANST                          WDANST
     I              MOVAST                          WDVAST
     I              MOTNSX                          WDTNSX
     I              MOALNX                          WDALNX
     I              MORMNB                          WDRMNB
     I              MOYTNX                          WDYTNX
     I              MON0CD                          WDN0CD
     I              MOQYSX                          WDQYSX
     I              MOQZSX                          WDQZSX
     I              MOQ0SX                          WDQ0SX
     I              MOUCSX                          WDUCSX
     I              MOUDSX                          WDUDSX
     I              MOUESX                          WDUESX
     I              MOFYPR                          WDFYPR
     I              MOFZPR                          WDFZPR
     I              MOF0PR                          WDF0PR
     I              MOF1PR                          WDF1PR
     I              MOF2PR                          WDF2PR
     I              MOEUVL                          WDEUVL
     I              MOEVVL                          WDEVVL
     I              MOEWVL                          WDEWVL
     I              MOEXVL                          WDEXVL
     I              MOEYVL                          WDEYVL
     I              MOVSST                          WDVSST
     I              MOMJDT                          WDMJDT
     I              MOBETM                          WDBETM
     I              MOCCVN                          WDCCVN
     I              MOCDVN                          WDCDVN
     I              MOMKDT                          WDMKDT
     I              MOBFTM                          WDBFTM
     I              MOCEVN                          WDCEVN
     I              MOCFVN                          WDCFVN
      *
     I@FHSTD3
      * Sales History             Retrieval index
      * Renamed input format fields
     I              F4AIC3                          WEAIC3
     I              F4C4NB                          WEC4NB
     I              F4DPNB                          WEDPNB
     I              F4UENB                          WEUENB
     I              F4MONA                          WEMONA
     I              F4RJCD                          WERJCD
     I              F4RKCD                          WERKCD
     I              F4GPTX                          WEGPTX
     I              F4ABTX                          WEABTX
     I              F4KXCD                          WEKXCD
     I              F4BOCD                          WEBOCD
     I              F4BTC7                          WEBTC7
     I              F4ANC7                          WEANC7
     I              F4AQTX                          WEAQTX
     I              F4BKC7                          WEBKC7
     I              F4BRTX                          WEBRTX
     I              F4HNNA                          WEHNNA
     I              F4DBCD                          WEDBCD
     I              F4CKTX                          WECKTX
     I              F4BCNA                          WEBCNA
     I              F4A0DT                          WEA0DT
     I              F4ACDT                          WEACDT
     I              F4R4CD                          WER4CD
     I              F4R5CD                          WER5CD
     I              F4BFCD                          WEBFCD
     I              F4Q4CD                          WEQ4CD
     I              F4AQCD                          WEAQCD
     I              F4TBNB                          WETBNB
     I              F4BZNA                          WEBZNA
     I              F4RLCD                          WERLCD
     I              F4JNCD                          WEJNCD
     I              F4Q2CD                          WEQ2CD
     I              F4U2ST                          WEU2ST
     I              F4ATIN                          WEATIN
     I              F4T3NB                          WET3NB
     I              F4RSRN                          WERSRN
     I              F4ORIT                          WEORIT
     I              F4AJCD                          WEAJCD
     I              F4AVQT                          WEAVQT
     I              F4D0WG                          WED0WG
     I              F4CCQT                          WECCQT
     I              F4AUWG                          WEAUWG
     I              F4AGCD                          WEAGCD
     I              F4AKPR                          WEAKPR
     I              F4AUPR                          WEAUPR
     I              F4CRCD                          WECRCD
     I              F4A5DT                          WEA5DT
     I              F4AWDT                          WEAWDT
     I              F4HDDT                          WEHDDT
     I              F4AGCS                          WEAGCS
     I              F4AQCS                          WEAQCS
     I              F4AVWG                          WEAVWG
     I              F4AYVA                          WEAYVA
     I              F4AMST                          WEAMST
     I              F4ANST                          WEANST
     I              F4VAST                          WEVAST
     I              F4L6NB                          WEL6NB
     I              F4UMCD                          WEUMCD
     I              F4HCDT                          WEHCDT
     I              F4ESNB                          WEESNB
     I              F4ETNB                          WEETNB
     I              F4BZNB                          WEBZNB
     I              F4EXQT                          WEEXQT
     I              F4BYWG                          WEBYWG
     I              F4S5NB                          WES5NB
     I              F4MAVA                          WEMAVA
     I              F4KDVA                          WEKDVA
     I              F4USVA                          WEUSVA
     I              F4UTVA                          WEUTVA
     I              F4A4WG                          WEA4WG
     I              F4CKNB                          WECKNB
     I              F4BMST                          WEBMST
     I              F4R8NB                          WER8NB
     I              F4RMCD                          WERMCD
     I              F4BZPR                          WEBZPR
     I              F4RDCD                          WERDCD
     I              F4Q7CD                          WEQ7CD
     I              F4EXDT                          WEEXDT
     I              F4LQCD                          WELQCD
     I              F4HICD                          WEHICD
     I              F4RBCD                          WERBCD
     I              F4RGNB                          WERGNB
     I              F4RHNB                          WERHNB
     I              F4RINB                          WERINB
     I              F4R1NB                          WER1NB
     I              F4CONB                          WECONB
     I              F4CEST                          WECEST
     I              F4GNDT                          WEGNDT
     I              F4RMNB                          WERMNB
     I              F4AODT                          WEAODT
     I              F4LLCD                          WELLCD
     I              F4LMCD                          WELMCD
     I              F4SKNB                          WESKNB
     I              F4SLNB                          WESLNB
     I              F4SMNB                          WESMNB
     I              F4G7NA                          WEG7NA
     I              F4ONVA                          WEONVA
     I              F4N0CD                          WEN0CD
     I              F4B4NB                          WEB4NB
     I              F4B5NB                          WEB5NB
     I              F4N1CD                          WEN1CD
     I              F4GIDT                          WEGIDT
     I              F4Z1ST                          WEZ1ST
     I              F4ULVA                          WEULVA
     I              F4UNVA                          WEUNVA
     I              F4UOVA                          WEUOVA
     I              F4UPVA                          WEUPVA
     I              F4UQVA                          WEUQVA
     I              F4SDCD                          WESDCD
     I              F4QZCD                          WEQZCD
     I              F4XWST                          WEXWST
     I              F4T9CD                          WET9CD
     I              F4UBCD                          WEUBCD
     I              F4CFC7                          WECFC7
     I              F4X1CD                          WEX1CD
     I              F4GASX                          WEGASX
     I              F4DUPR                          WEDUPR
     I              F4B6VL                          WEB6VL
     I              F4IANX                          WEIANX
     I              F4IBNX                          WEIBNX
     I              F4RPCD                          WERPCD
     I              F4NYDT                          WENYDT
     I              F4BZTM                          WEBZTM
     I              F4Z4NB                          WEZ4NB
     I              F4XACD                          WEXACD
     I              F4OANA                          WEOANA
     I              F4OKTX                          WEOKTX
     I              F4K4TX                          WEK4TX
     I              F4NBBO                          WENBBO
     I              F4OCFR                          WEOCFR
     I              F4C0C7                          WEC0C7
     I              F4A1AA                          WEA1AA
     I              F4VEST                          WEVEST
     I              F4A5PR                          WEA5PR
     I              F4CDPR                          WECDPR
     I              F4D0PR                          WED0PR
     I              F4D0VL                          WED0VL
     I              F4IRSX                          WEIRSX
     I              F4CEVL                          WECEVL
     I              F4ISSX                          WEISSX
     I              F4ITSX                          WEITSX
     I              F4IUSX                          WEIUSX
     I              F4OHDT                          WEOHDT
     I              F4D9PR                          WED9PR
     I              F4CFVL                          WECFVL
     I              F4UVST                          WEUVST
     I              F4UWST                          WEUWST
     I              F4UXST                          WEUXST
     I              F4AATM                          WEAATM
     I              F4AYNA                          WEAYNA
     I              F4A0NA                          WEA0NA
     I              F4AXDT                          WEAXDT
      *
     I@JEREWS
      * Sales Route               Active Records
      * Renamed input format fields
     I              JER4CD                          WFR4CD
     I              JEMZNA                          WFMZNA
     I              JEBCCD                          WFBCCD
     I              JEBFCD                          WFBFCD
     I              JEQ4CD                          WFQ4CD
     I              JEWOST                          WFWOST
     I              JER8CD                          WFR8CD
     I              JEUVST                          WFUVST
     I              JEUWST                          WFUWST
     I              JEUXST                          WFUXST
     I              JEVSST                          WFVSST
     I              JEAATM                          WFAATM
     I              JEAYNA                          WFAYNA
     I              JEA0NA                          WFA0NA
     I              JEAXDT                          WFAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WGAIC3
     I              BEC4NB                          WGC4NB
     I              BEJNCD                          WGJNCD
     I              BEANC7                          WGANC7
     I              BEBKC7                          WGBKC7
     I              BEBRTX                          WGBRTX
     I              BEHMNA                          WGHMNA
     I              BEHONA                          WGHONA
     I              BEHPNA                          WGHPNA
     I              BEHNNA                          WGHNNA
     I              BEDBCD                          WGDBCD
     I              BECKTX                          WGCKTX
     I              BEB0C7                          WGB0C7
     I              BEAETX                          WGAETX
     I              BEB1NA                          WGB1NA
     I              BEB3NA                          WGB3NA
     I              BEB4NA                          WGB4NA
     I              BEB2NA                          WGB2NA
     I              BEBHCD                          WGBHCD
     I              BEC8TX                          WGC8TX
     I              BEBCNA                          WGBCNA
     I              BEA0DT                          WGA0DT
     I              BEA5DT                          WGA5DT
     I              BEGNDT                          WGGNDT
     I              BEACDT                          WGACDT
     I              BEAQCD                          WGAQCD
     I              BEB6NA                          WGB6NA
     I              BEBYNA                          WGBYNA
     I              BEBZNA                          WGBZNA
     I              BEGTST                          WGGTST
     I              BEGVST                          WGGVST
     I              BEGUST                          WGGUST
     I              BEQFST                          WGQFST
     I              BECQCD                          WGCQCD
     I              BEGJST                          WGGJST
     I              BEGWST                          WGGWST
     I              BEGXST                          WGGXST
     I              BEGYST                          WGGYST
     I              BEAODT                          WGAODT
     I              BEAIVN                          WGAIVN
     I              BECXDT                          WGCXDT
     I              BEJZVA                          WGJZVA
     I              BEA1WG                          WGA1WG
     I              BEXIST                          WGXIST
     I              BEXJST                          WGXJST
     I              BEXKST                          WGXKST
     I              BEEIDT                          WGEIDT
     I              BEAFTM                          WGAFTM
     I              BEE8CD                          WGE8CD
     I              BEE9CD                          WGE9CD
     I              BERMNB                          WGRMNB
     I              BETBNB                          WGTBNB
     I              BER1NB                          WGR1NB
     I              BEPJST                          WGPJST
     I              BEU0ST                          WGU0ST
     I              BEU1ST                          WGU1ST
     I              BEQ2CD                          WGQ2CD
     I              BEU2ST                          WGU2ST
     I              BEVEST                          WGVEST
     I              BEVFST                          WGVFST
     I              BEVGST                          WGVGST
     I              BERPCD                          WGRPCD
     I              BERNNB                          WGRNNB
     I              BEVDST                          WGVDST
     I              BEATIN                          WGATIN
     I              BEU4ST                          WGU4ST
     I              BEU5ST                          WGU5ST
     I              BERSRN                          WGRSRN
     I              BEMHNA                          WGMHNA
     I              BEMINA                          WGMINA
     I              BEWBST                          WGWBST
     I              BER4CD                          WGR4CD
     I              BEBFCD                          WGBFCD
     I              BEQ4CD                          WGQ4CD
     I              BET3NB                          WGT3NB
     I              BESICD                          WGSICD
     I              BECONB                          WGCONB
     I              BECEST                          WGCEST
     I              BEAWDT                          WGAWDT
     I              BEJPCD                          WGJPCD
     I              BEXUST                          WGXUST
     I              BEZ1ST                          WGZ1ST
     I              BEVRVA                          WGVRVA
     I              BEOBST                          WGOBST
     I              BEBCST                          WGBCST
     I              BEBDST                          WGBDST
     I              BEB7VL                          WGB7VL
     I              BEGASX                          WGGASX
     I              BEGBSX                          WGGBSX
     I              BEGCSX                          WGGCSX
     I              BEGDSX                          WGGDSX
     I              BEFNSX                          WGFNSX
     I              BEFOSX                          WGFOSX
     I              BEFPSX                          WGFPSX
     I              BEFQSX                          WGFQSX
     I              BEFRSX                          WGFRSX
     I              BEFSSX                          WGFSSX
     I              BEFTSX                          WGFTSX
     I              BEFUSX                          WGFUSX
     I              BEFVSX                          WGFVSX
     I              BEFWSX                          WGFWSX
     I              BEFXSX                          WGFXSX
     I              BEFYSX                          WGFYSX
     I              BENODT                          WGNODT
     I              BENPDT                          WGNPDT
     I              BENQDT                          WGNQDT
     I              BENRDT                          WGNRDT
     I              BENSDT                          WGNSDT
     I              BEBPTM                          WGBPTM
     I              BEBQTM                          WGBQTM
     I              BEBRTM                          WGBRTM
     I              BEBSTM                          WGBSTM
     I              BEBTTM                          WGBTTM
     I              BEH0NX                          WGH0NX
     I              BEH1NX                          WGH1NX
     I              BEH2NX                          WGH2NX
     I              BEH3NX                          WGH3NX
     I              BEH4NX                          WGH4NX
     I              BEC0C7                          WGC0C7
     I              BEUVST                          WGUVST
     I              BEUWST                          WGUWST
     I              BEUXST                          WGUXST
     I              BEAATM                          WGAATM
     I              BEAYNA                          WGAYNA
     I              BEA0NA                          WGA0NA
     I              BEAXDT                          WGAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WHAIC3
     I              OMC4NB                          WHC4NB
     I              OMDPNB                          WHDPNB
     I              OMUENB                          WHUENB
     I              OMHGCD                          WHHGCD
     I              OMAJCD                          WHAJCD
     I              OMBKC7                          WHBKC7
     I              OMCFC7                          WHCFC7
     I              OMGMST                          WHGMST
     I              OMGNST                          WHGNST
     I              OMMAVA                          WHMAVA
     I              OMKDVA                          WHKDVA
     I              OML8VA                          WHL8VA
     I              OML9VA                          WHL9VA
     I              OMGTST                          WHGTST
     I              OMGVST                          WHGVST
     I              OMGUST                          WHGUST
     I              OMQFST                          WHQFST
     I              OMAYVA                          WHAYVA
     I              OMEXDT                          WHEXDT
     I              OMLQCD                          WHLQCD
     I              OMRDCD                          WHRDCD
     I              OMQ7CD                          WHQ7CD
     I              OMBZPR                          WHBZPR
     I              OML6NB                          WHL6NB
     I              OMU1ST                          WHU1ST
     I              OMGIDT                          WHGIDT
     I              OMCRCD                          WHCRCD
     I              OMAGCD                          WHAGCD
     I              OMRZST                          WHRZST
     I              OMR0ST                          WHR0ST
     I              OMR1ST                          WHR1ST
     I              OMG7NA                          WHG7NA
     I              OMG8NA                          WHG8NA
     I              OMRPCD                          WHRPCD
     I              OMVEST                          WHVEST
     I              OMVGST                          WHVGST
     I              OMAVST                          WHAVST
     I              OMU0ST                          WHU0ST
     I              OMRFCD                          WHRFCD
     I              OMFZST                          WHFZST
     I              OMR1NB                          WHR1NB
     I              OMAVQT                          WHAVQT
     I              OMD0WG                          WHD0WG
     I              OMCCQT                          WHCCQT
     I              OMAUWG                          WHAUWG
     I              OMCBQT                          WHCBQT
     I              OMATWG                          WHATWG
     I              OMAQCS                          WHAQCS
     I              OMAGCS                          WHAGCS
     I              OMAKPR                          WHAKPR
     I              OMALPR                          WHALPR
     I              OMAUPR                          WHAUPR
     I              OMAVWG                          WHAVWG
     I              OMA4WG                          WHA4WG
     I              OMA5DT                          WHA5DT
     I              OMAODT                          WHAODT
     I              OMGNDT                          WHGNDT
     I              OMAMST                          WHAMST
     I              OMANST                          WHANST
     I              OMVAST                          WHVAST
     I              OMRGNB                          WHRGNB
     I              OMRHNB                          WHRHNB
     I              OMRINB                          WHRINB
     I              OMRBCD                          WHRBCD
     I              OMHICD                          WHHICD
     I              OMRNCD                          WHRNCD
     I              OMROCD                          WHROCD
     I              OMCXDT                          WHCXDT
     I              OMAJVN                          WHAJVN
     I              OMKXCD                          WHKXCD
     I              OMJPCD                          WHJPCD
     I              OMCQCD                          WHCQCD
     I              OMR4CD                          WHR4CD
     I              OMZ1ST                          WHZ1ST
     I              OMZ3ST                          WHZ3ST
     I              OMZ4ST                          WHZ4ST
     I              OMDUPR                          WHDUPR
     I              OMB6VL                          WHB6VL
     I              OMA1AA                          WHA1AA
     I              OMFZSX                          WHFZSX
     I              OMF0SX                          WHF0SX
     I              OMF1SX                          WHF1SX
     I              OMF2SX                          WHF2SX
     I              OMF3SX                          WHF3SX
     I              OMF4SX                          WHF4SX
     I              OMF5SX                          WHF5SX
     I              OMF6SX                          WHF6SX
     I              OMF7SX                          WHF7SX
     I              OMNTDT                          WHNTDT
     I              OMNUDT                          WHNUDT
     I              OMNVDT                          WHNVDT
     I              OMNWDT                          WHNWDT
     I              OMNXDT                          WHNXDT
     I              OMBUTM                          WHBUTM
     I              OMBVTM                          WHBVTM
     I              OMBWTM                          WHBWTM
     I              OMBXTM                          WHBXTM
     I              OMBYTM                          WHBYTM
     I              OMH5NX                          WHH5NX
     I              OMH6NX                          WHH6NX
     I              OMH7NX                          WHH7NX
     I              OMH8NX                          WHH8NX
     I              OMH9NX                          WHH9NX
     I              OMDVPR                          WHDVPR
     I              OMDWPR                          WHDWPR
     I              OMDXPR                          WHDXPR
     I              OMDYPR                          WHDYPR
     I              OMDZPR                          WHDZPR
     I              OMGSPR                          WHGSPR
     I              OMGTPR                          WHGTPR
     I              OMGUPR                          WHGUPR
     I              OMHOST                          WHHOST
     I              OMHPST                          WHHPST
     I              OMIOST                          WHIOST
     I              OMPEWG                          WHPEWG
     I              OMRINY                          WHRINY
     I              OMTIDT                          WHTIDT
     I              OMTJDT                          WHTJDT
     I              OMH2ST                          WHH2ST
     I              OMH0ST                          WHH0ST
     I              OMH1ST                          WHH1ST
     I              OMTKDT                          WHTKDT
     I              OMTLDT                          WHTLDT
     I              OMTMDT                          WHTMDT
     I              OMUVST                          WHUVST
     I              OMUWST                          WHUWST
     I              OMUXST                          WHUXST
     I              OMAATM                          WHAATM
     I              OMAYNA                          WHAYNA
     I              OMA0NA                          WHA0NA
     I              OMAXDT                          WHAXDT
      *
     I@APREBU
      * Salesperson               Retrieval index       V
      * Renamed input format fields
     I              APBCCD                          WIBCCD
     I              APALTX                          WIALTX
     I              APACNA                          WIACNA
     I              APADNA                          WIADNA
     I              APAENA                          WIAENA
     I              APAJNA                          WIAJNA
     I              APBGCD                          WIBGCD
     I              APBTTX                          WIBTTX
     I              APBVTX                          WIBVTX
     I              APBWTX                          WIBWTX
     I              APDZTX                          WIDZTX
     I              APD0TX                          WID0TX
     I              APD1TX                          WID1TX
     I              APLVCD                          WILVCD
     I              APKZCD                          WIKZCD
     I              APAIC3                          WIAIC3
     I              APAVNB                          WIAVNB
     I              APDSCD                          WIDSCD
     I              APUVST                          WIUVST
     I              APUWST                          WIUWST
     I              APUXST                          WIUXST
     I              APVSST                          WIVSST
     I              APAATM                          WIAATM
     I              APAYNA                          WIAYNA
     I              APA0NA                          WIA0NA
     I              APAXDT                          WIAXDT
      *
     I@MNCPSE
      * A/R Claim Explanation     Retrieval Index Expl Onl
      * Renamed input format fields
     I              MNC0C7                          WJC0C7
     I              MNAANX                          WJAANX
     I              MNPYTX                          WJPYTX
     I              MNLGNY                          WJLGNY
     I              MNRRDT                          WJRRDT
     I              MNL1TX                          WJL1TX
     I              MNN7T1                          WJN7T1
     I              MNRSDT                          WJRSDT
     I              MNC9TM                          WJC9TM
     I              MNL2TX                          WJL2TX
     I              MNVSST                          WJVSST
     I              MNMJDT                          WJMJDT
     I              MNBETM                          WJBETM
     I              MNCCVN                          WJCCVN
     I              MNCDVN                          WJCDVN
     I              MNMKDT                          WJMKDT
     I              MNBFTM                          WJBFTM
     I              MNCEVN                          WJCEVN
     I              MNCFVN                          WJCFVN
      *
     I@ATREW0
      * A/R Claim Department      Retrieval index
      * Renamed input format fields
     I              ATFUAA                          WKFUAA
     I              ATTXTX                          WKTXTX
     I              ATTNSX                          WKTNSX
     I              ATVSST                          WKVSST
     I              ATMJDT                          WKMJDT
     I              ATBETM                          WKBETM
     I              ATCCVN                          WKCCVN
     I              ATCDVN                          WKCDVN
     I              ATMKDT                          WKMKDT
     I              ATBFTM                          WKBFTM
     I              ATCEVN                          WKCEVN
     I              ATCFVN                          WKCFVN
      *
     I@MPCPWQ
      * A/R Claim Resale Product  Retrieval index
      * Renamed input format fields
     I              MPC0C7                          WLC0C7
     I              MPBKC7                          WLBKC7
     I              MPAKNX                          WLAKNX
     I              MPBHC3                          WLBHC3
     I              MPC5C7                          WLC5C7
     I              MPCQCD                          WLCQCD
     I              MPHHCD                          WLHHCD
     I              MPCISX                          WLCISX
     I              MPFUAA                          WLFUAA
     I              MPDPNB                          WLDPNB
     I              MPUENB                          WLUENB
     I              MPKVQT                          WLKVQT
     I              MPHIWG                          WLHIWG
     I              MPDJPR                          WLDJPR
     I              MPBOVL                          WLBOVL
     I              MPO2NA                          WLO2NA
     I              MPF0SX                          WLF0SX
     I              MPF1SX                          WLF1SX
     I              MPF2SX                          WLF2SX
     I              MPAMST                          WLAMST
     I              MPANST                          WLANST
     I              MPVAST                          WLVAST
     I              MPUFSX                          WLUFSX
     I              MPQVSX                          WLQVSX
     I              MPQWSX                          WLQWSX
     I              MPQXSX                          WLQXSX
     I              MPVSST                          WLVSST
     I              MPMJDT                          WLMJDT
     I              MPBETM                          WLBETM
     I              MPCCVN                          WLCCVN
     I              MPCDVN                          WLCDVN
     I              MPMKDT                          WLMKDT
     I              MPBFTM                          WLBFTM
     I              MPCEVN                          WLCEVN
     I              MPCFVN                          WLCFVN
      *
     I@NACPZ9
      * WF A/R Claim Download     Update index
      * Renamed input format fields
     I              NAINNX                          WMINNX
     I              NAG6SX                          WMG6SX
     I              NATTTX                          WMTTTX
     I              NATSTX                          WMTSTX
     I              NACHSX                          WMCHSX
     I              NAIONX                          WMIONX
     I              NAIPNX                          WMIPNX
     I              NATUTX                          WMTUTX
     I              NABIC3                          WMBIC3
     I              NAIQNX                          WMIQNX
     I              NATVTX                          WMTVTX
     I              NATYTX                          WMTYTX
     I              NATXTX                          WMTXTX
     I              NATWTX                          WMTWTX
     I              NAB8VL                          WMB8VL
     I              NADQVL                          WMDQVL
     I              NADRVL                          WMDRVL
     I              NAHJSX                          WMHJSX
     I              NAA4AA                          WMA4AA
     I              NACJSX                          WMCJSX
     I              NAPPTX                          WMPPTX
     I              NAAJCD                          WMAJCD
      *
     I@BGWKAE
      * Order Detail              co/
      * Renamed input format fields
     I              OMAIC3                          WOAIC3
     I              OMC4NB                          WOC4NB
     I              OMDPNB                          WODPNB
     I              OMUENB                          WOUENB
     I              OMHGCD                          WOHGCD
     I              OMAJCD                          WOAJCD
     I              OMBKC7                          WOBKC7
     I              OMCFC7                          WOCFC7
     I              OMGMST                          WOGMST
     I              OMGNST                          WOGNST
     I              OMMAVA                          WOMAVA
     I              OMKDVA                          WOKDVA
     I              OML8VA                          WOL8VA
     I              OML9VA                          WOL9VA
     I              OMGTST                          WOGTST
     I              OMGVST                          WOGVST
     I              OMGUST                          WOGUST
     I              OMQFST                          WOQFST
     I              OMAYVA                          WOAYVA
     I              OMEXDT                          WOEXDT
     I              OMLQCD                          WOLQCD
     I              OMRDCD                          WORDCD
     I              OMQ7CD                          WOQ7CD
     I              OMBZPR                          WOBZPR
     I              OML6NB                          WOL6NB
     I              OMU1ST                          WOU1ST
     I              OMGIDT                          WOGIDT
     I              OMCRCD                          WOCRCD
     I              OMAGCD                          WOAGCD
     I              OMRZST                          WORZST
     I              OMR0ST                          WOR0ST
     I              OMR1ST                          WOR1ST
     I              OMG7NA                          WOG7NA
     I              OMG8NA                          WOG8NA
     I              OMRPCD                          WORPCD
     I              OMVEST                          WOVEST
     I              OMVGST                          WOVGST
     I              OMAVST                          WOAVST
     I              OMU0ST                          WOU0ST
     I              OMRFCD                          WORFCD
     I              OMFZST                          WOFZST
     I              OMR1NB                          WOR1NB
     I              OMAVQT                          WOAVQT
     I              OMD0WG                          WOD0WG
     I              OMCCQT                          WOCCQT
     I              OMAUWG                          WOAUWG
     I              OMCBQT                          WOCBQT
     I              OMATWG                          WOATWG
     I              OMAQCS                          WOAQCS
     I              OMAGCS                          WOAGCS
     I              OMAKPR                          WOAKPR
     I              OMALPR                          WOALPR
     I              OMAUPR                          WOAUPR
     I              OMAVWG                          WOAVWG
     I              OMA4WG                          WOA4WG
     I              OMA5DT                          WOA5DT
     I              OMAODT                          WOAODT
     I              OMGNDT                          WOGNDT
     I              OMAMST                          WOAMST
     I              OMANST                          WOANST
     I              OMVAST                          WOVAST
     I              OMRGNB                          WORGNB
     I              OMRHNB                          WORHNB
     I              OMRINB                          WORINB
     I              OMRBCD                          WORBCD
     I              OMHICD                          WOHICD
     I              OMRNCD                          WORNCD
     I              OMROCD                          WOROCD
     I              OMCXDT                          WOCXDT
     I              OMAJVN                          WOAJVN
     I              OMKXCD                          WOKXCD
     I              OMJPCD                          WOJPCD
     I              OMCQCD                          WOCQCD
     I              OMR4CD                          WOR4CD
     I              OMZ1ST                          WOZ1ST
     I              OMZ3ST                          WOZ3ST
     I              OMZ4ST                          WOZ4ST
     I              OMDUPR                          WODUPR
     I              OMB6VL                          WOB6VL
     I              OMA1AA                          WOA1AA
     I              OMFZSX                          WOFZSX
     I              OMF0SX                          WOF0SX
     I              OMF1SX                          WOF1SX
     I              OMF2SX                          WOF2SX
     I              OMF3SX                          WOF3SX
     I              OMF4SX                          WOF4SX
     I              OMF5SX                          WOF5SX
     I              OMF6SX                          WOF6SX
     I              OMF7SX                          WOF7SX
     I              OMNTDT                          WONTDT
     I              OMNUDT                          WONUDT
     I              OMNVDT                          WONVDT
     I              OMNWDT                          WONWDT
     I              OMNXDT                          WONXDT
     I              OMBUTM                          WOBUTM
     I              OMBVTM                          WOBVTM
     I              OMBWTM                          WOBWTM
     I              OMBXTM                          WOBXTM
     I              OMBYTM                          WOBYTM
     I              OMH5NX                          WOH5NX
     I              OMH6NX                          WOH6NX
     I              OMH7NX                          WOH7NX
     I              OMH8NX                          WOH8NX
     I              OMH9NX                          WOH9NX
     I              OMDVPR                          WODVPR
     I              OMDWPR                          WODWPR
     I              OMDXPR                          WODXPR
     I              OMDYPR                          WODYPR
     I              OMDZPR                          WODZPR
     I              OMGSPR                          WOGSPR
     I              OMGTPR                          WOGTPR
     I              OMGUPR                          WOGUPR
     I              OMHOST                          WOHOST
     I              OMHPST                          WOHPST
     I              OMIOST                          WOIOST
     I              OMPEWG                          WOPEWG
     I              OMRINY                          WORINY
     I              OMTIDT                          WOTIDT
     I              OMTJDT                          WOTJDT
     I              OMH2ST                          WOH2ST
     I              OMH0ST                          WOH0ST
     I              OMH1ST                          WOH1ST
     I              OMTKDT                          WOTKDT
     I              OMTLDT                          WOTLDT
     I              OMTMDT                          WOTMDT
     I              OMUVST                          WOUVST
     I              OMUWST                          WOUWST
     I              OMUXST                          WOUXST
     I              OMAATM                          WOAATM
     I              OMAYNA                          WOAYNA
     I              OMA0NA                          WOA0NA
     I              OMAXDT                          WOAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WRAJCD
     I              ADF8NA                          WRF8NA
     I              ADACNA                          WRACNA
     I              ADADNA                          WRADNA
     I              ADAENA                          WRAENA
     I              ADAJNA                          WRAJNA
     I              ADBTTX                          WRBTTX
     I              ADAOCD                          WRAOCD
     I              ADBGCD                          WRBGCD
     I              ADVHST                          WRVHST
     I              ADMPNA                          WRMPNA
     I              ADWPST                          WRWPST
     I              ADXUST                          WRXUST
     I              ADT0ST                          WRT0ST
     I              ADT1ST                          WRT1ST
     I              ADDBNB                          WRDBNB
     I              ADT2ST                          WRT2ST
     I              ADT3ST                          WRT3ST
     I              ADT4ST                          WRT4ST
     I              ADT6ST                          WRT6ST
     I              ADBWC3                          WRBWC3
     I              ADBTC3                          WRBTC3
     I              ADBUC3                          WRBUC3
     I              ADBVC3                          WRBVC3
     I              ADFCAA                          WRFCAA
     I              ADRQSX                          WRRQSX
     I              ADRRSX                          WRRRSX
     I              ADRSSX                          WRRSSX
     I              ADRTSX                          WRRTSX
     I              ADT7ST                          WRT7ST
     I              ADT8ST                          WRT8ST
     I              ADRNSX                          WRRNSX
     I              ADROSX                          WRROSX
     I              ADRPSX                          WRRPSX
     I              ADUVST                          WRUVST
     I              ADUWST                          WRUWST
     I              ADUXST                          WRUXST
     I              ADVSST                          WRVSST
     I              ADAATM                          WRAATM
     I              ADAYNA                          WRAYNA
     I              ADA0NA                          WRA0NA
     I              ADAXDT                          WRAXDT
      *
     I@BBREE9
      * Customer                  Retrieval index       NV
      * Renamed input format fields
     I              BBBKC7                          WSBKC7
     I              BBAYTX                          WSAYTX
     I              BBACNA                          WSACNA
     I              BBADNA                          WSADNA
     I              BBAENA                          WSAENA
     I              BBAJNA                          WSAJNA
     I              BBBGCD                          WSBGCD
     I              BBG5CD                          WSG5CD
     I              BBBTTX                          WSBTTX
     I              BBBVTX                          WSBVTX
     I              BBBWTX                          WSBWTX
     I              BBABTX                          WSABTX
     I              BBA2NA                          WSA2NA
     I              BBCBST                          WSCBST
     I              BBB0NA                          WSB0NA
     I              BBP3NB                          WSP3NB
     I              BBAXNA                          WSAXNA
     I              BBI6DT                          WSI6DT
     I              BBAYDT                          WSAYDT
     I              BBANC7                          WSANC7
     I              BBBTC7                          WSBTC7
     I              BBK6ST                          WSK6ST
     I              BBUZST                          WSUZST
     I              BBKXCD                          WSKXCD
     I              BBLTCD                          WSLTCD
     I              BBQNST                          WSQNST
     I              BBS2NB                          WSS2NB
     I              BBVHVA                          WSVHVA
     I              BBI7DT                          WSI7DT
     I              BBRJST                          WSRJST
     I              BBRKST                          WSRKST
     I              BBQWST                          WSQWST
     I              BBQXST                          WSQXST
     I              BBQYST                          WSQYST
     I              BBUNCS                          WSUNCS
     I              BBUVST                          WSUVST
     I              BBUWST                          WSUWST
     I              BBUXST                          WSUXST
     I              BBVSST                          WSVSST
     I              BBAATM                          WSAATM
     I              BBAYNA                          WSAYNA
     I              BBA0NA                          WSA0NA
     I              BBAXDT                          WSAXDT
      *
     I@CXRENA
      * OP Reason Codes           Retrieval index
      * Renamed input format fields
     I              CXCQCD                          WTCQCD
     I              CXAUNA                          WTAUNA
     I              CXUVST                          WTUVST
     I              CXUWST                          WTUWST
     I              CXUXST                          WTUXST
     I              CXVSST                          WTVSST
     I              CXAATM                          WTAATM
     I              CXAYNA                          WTAYNA
     I              CXA0NA                          WTA0NA
     I              CXAXDT                          WTAXDT
      *
     I@NACPAB
      * WF A/R Claim Download     1st Reason Code/Claim #
      * Renamed input format fields
     I              NAINNX                          WVINNX
     I              NAG6SX                          WVG6SX
     I              NATTTX                          WVTTTX
     I              NATSTX                          WVTSTX
     I              NACHSX                          WVCHSX
     I              NAIONX                          WVIONX
     I              NAIPNX                          WVIPNX
     I              NATUTX                          WVTUTX
     I              NABIC3                          WVBIC3
     I              NAIQNX                          WVIQNX
     I              NATVTX                          WVTVTX
     I              NATYTX                          WVTYTX
     I              NATXTX                          WVTXTX
     I              NATWTX                          WVTWTX
     I              NAB8VL                          WVB8VL
     I              NADQVL                          WVDQVL
     I              NADRVL                          WVDRVL
     I              NAHJSX                          WVHJSX
     I              NAA4AA                          WVA4AA
     I              NACJSX                          WVCJSX
     I              NAPPTX                          WVPPTX
     I              NAAJCD                          WVAJCD
      *
     I@NBCPAD
      * WF A/R Claim Reas Dwnld   Update index
      * Renamed input format fields
     I              NBCQCD                          WWCQCD
     I              NBT3TX                          WWT3TX
     I              NBIVNX                          WWIVNX
     I              NBB9VL                          WWB9VL
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IYD01        DS
     I                                        1   30YI0101
     I                                        4   6 YI0102
     I                                        7  110YI01
      *
     IYM01        DS                         20
     I                                        1   30WBDXNB
     I                                        4   6 WBCQCD
      *
     IYW01        DS
     I                                        1   30XADXNB
     I                                        4   6 XACQCD
      *
     IYD02        DS
     I                                        1   30YI0201
     I                                        4   6 YI0202
     I                                        7  110YI02
      *
     IYM02        DS                         20
     I                                        1   30WCDXNB
     I                                        4   6 WCFUAA
      *
     IYW02        DS
     I                                        1   30XBDXNB
     I                                        4   6 XBFUAA
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQPDNA1    E DSPDNACPL0
      * UPD : WF A/R Claim Download     Update index
      * Renamed input format fields
     I              NAINNX                          WMINNX
     I              NAG6SX                          WMG6SX
     I              NATTTX                          WMTTTX
     I              NATSTX                          WMTSTX
     I              NACHSX                          WMCHSX
     I              NAIONX                          WMIONX
     I              NAIPNX                          WMIPNX
     I              NATUTX                          WMTUTX
     I              NABIC3                          WMBIC3
     I              NAIQNX                          WMIQNX
     I              NATVTX                          WMTVTX
     I              NATYTX                          WMTYTX
     I              NATXTX                          WMTXTX
     I              NATWTX                          WMTWTX
     I              NAB8VL                          WMB8VL
     I              NADQVL                          WMDQVL
     I              NADRVL                          WMDRVL
     I              NAHJSX                          WMHJSX
     I              NAA4AA                          WMA4AA
     I              NACJSX                          WMCJSX
     I              NAPPTX                          WMPPTX
     I              NAAJCD                          WMAJCD
      *
     IQPDNB1    E DSPDNBCPL0
      * UPD : WF A/R Claim Reas Dwnld   Update index
      * Renamed input format fields
     I              NBCQCD                          WWCQCD
     I              NBT3TX                          WWT3TX
     I              NBIVNX                          WWIVNX
     I              NBB9VL                          WWB9VL
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * I :  Reason Code
     I                                        1   3 P1CQCD
      * I :  Claim Status
     I                                        4   4 P1CJSX
      * I :  Salesperson to Rvw Claim
     I                                        5   7 P1ZLCD
      * I :  Claim Item Code
     I                                    P   8  110P1C1C7
      * I :  Claim Ship to Customer
     I                                    P  12  150P1C3C7
      * I :  Claim Item Company Number
     I                                    P  16  170P1BJC3
      * I :  Claim Start Number
     I                                    P  18  210P1DFC7
      * I :  Claim End Number
     I                                    P  22  250P1DGC7
      * I :  Claim Start Entry Date
     I                                    P  26  290P1NBDT
      * I :  Claim End Entry Date
     I                                    P  30  330P1NCDT
      * I :  Memo Posting Str Date Usr
     I                                    P  34  370P1QBDT
      * I :  Memo Posting End Date Usr
     I                                    P  38  410P1QCDT
     IP2PARM      DS
      * I :  Report or File USR
     I                                        1   1 P2G4SX
     IP3PARM      DS
      * I :  Email Address
     I                                        1  50 P3UGTX
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1CQCD    PARM           WP0001  3        Reason Code
     C           P1CJSX    PARM           WP0002  1        Claim Status
     C           P1ZLCD    PARM           WP0003  3        Salesperson to
     C           P1C1C7    PARM           WP0004  70       Claim Item Code
     C           P1C3C7    PARM           WP0005  70       Claim Ship to C
     C           P1BJC3    PARM           WP0006  30       Claim Item Comp
     C           P1DFC7    PARM           WP0007  70       Claim Start Num
     C           P1DGC7    PARM           WP0008  70       Claim End Numbe
     C           P1NBDT    PARM           WP0009  70       Claim Start Ent
     C           P1NCDT    PARM           WP0010  70       Claim End Entry
     C           P1QBDT    PARM           WP0011  70       Memo Posting St
     C           P1QCDT    PARM           WP0012  70       Memo Posting En
     C           P2G4SX    PARM           WP0013  1        Report or File
     C           P3UGTX    PARM           WP0014 50        Email Address
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * BLD Weekly Claims DwnldXF
      * *** Build Claim Download File ***
      * CRT DNLD Claims by Cst RT - A/R Claim  * 
     C                     EXSR SARVGN
      * *** Build Claim Download Reason File ***
      * RTV/CRT Claim Reas FileRT - OP Reason Codes  * 
     C                     EXSR SXRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * CRT DNLD Claims by Cst RT - A/R Claim  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        *Record selecte
     C                     MOVEL*BLANK    WN0002  2        Claim Type
     C                     Z-ADD*ZERO     WN0003  70       Claim Number (u
     C                     MOVEL*BLANK    WN0004 11        Claim Reason Co
     C                     MOVEL*BLANK    WN0005 20        Claim Short Cus
     C                     Z-ADD*ZERO     WN0006  70       Claim Load ID (
     C                     Z-ADD*ZERO     WN0007  70       Claim Invoice (
     C                     MOVEL*BLANK    WN0008 10        Claim Act Shp D
     C                     Z-ADD*ZERO     WN0009  70       Claim Order # (
     C                     MOVEL*BLANK    WN0010 20        Claim Short Sal
     C                     MOVEL*BLANK    WN0011110        Claim Short Exp
     C                     MOVEL*BLANK    WN0012 20        Claim Departmen
     C                     Z-ADD*ZERO     WN0013 112       Claim Amount (u
     C                     MOVEL*BLANK    WN0014 10        Claim Entry Dat
     C                     MOVEL*BLANK    WN0015  3        Claim Reason Co
     C                     MOVEL*BLANK    WN0016  1        Claim Product/R
     C                     Z-ADD*ZERO     WN0017 112       Claim Resale Am
     C                     Z-ADD*ZERO     WN0018 112       Claim Net Loss
     C                     Z-ADD*ZERO     WN0019  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0020 112       Resale Item Amo
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** Change Log
      * ** 01/30/2006 LJB
      * ** If company number is passed in, select only that company's
      * ** records.
      * *****
      * Establish starting position
     C           *LOVAL    SETLL@MKCPWB                    *
     C                     READ @MKCPWB                  90*
      * Data record not found
     C   90                MOVEL'USR2729' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WN0001           *Record selecte
      * SEL:  Company Number                              1/30/06 LJB
      * CASE: PAR.Claim Item Company Number is not equal to zero
     C           P1BJC3    IFNE *ZERO                      *IF
      * CASE: DB1.Claim Company Number NE PAR.Claim Item Company Number
     C           WABIC3    IFNE P1BJC3                     *IF
     C                     MOVEL'N'       WN0001           *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * SEL:  Claim Number
      * CASE: PAR.Claim Start Number is Not Zero
     C           P1DFC7    IFNE *ZERO                      *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Claim Number LT PAR.Claim Start Number
      *   |- c2    : DB1.Claim Number GT PAR.Claim End Number
      *   '-
     C           WAC0C7    IFLT P1DFC7                     *IF
     C           WAC0C7    ORGT P1DGC7                     *OR
     C                     MOVEL'N'       WN0001           *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * SEL:  Entry Date
      * CASE: PAR.Claim Start Entry Date is Entered
     C           P1NBDT    IFNE *ZERO                      *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Claim Entry Date LT PAR.Claim Start Entry Date
      *   |- c2    : DB1.Claim Entry Date GT PAR.Claim End Entry Date
      *   '-
     C           WAMNDT    IFLT P1NBDT                     *IF
     C           WAMNDT    ORGT P1NCDT                     *OR
     C                     MOVEL'N'       WN0001           *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * SEL:  Memo Posting Date              051705 slm
      * CASE: PAR.Claim Start Entry Date is Entered
     C           P1NBDT    IFNE *ZERO                      *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Claim Entry Date LT PAR.Claim Start Entry Date
      *   |- c2    : DB1.Claim Entry Date GT PAR.Claim End Entry Date
      *   '-
     C           WAMNDT    IFLT P1NBDT                     *IF
     C           WAMNDT    ORGT P1NCDT                     *OR
     C                     MOVEL'N'       WN0001           *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * SEL:  Customer
      * CASE: PAR.Claim Ship to Customer is not equal to zero
     C           P1C3C7    IFNE *ZERO                      *IF
      * CASE: DB1.Claim Ship to Customer NE PAR.Claim Ship to Customer
     C           WAC3C7    IFNE P1C3C7                     *IF
     C                     MOVEL'N'       WN0001           *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * SEL:  Claim Status
      * CASE: PAR.Claim Status is Blank
     C           P1CJSX    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Claim Status NE PAR.Claim Status
     C           WACJSX    IFNE P1CJSX                     *IF
     C                     MOVEL'N'       WN0001           *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * SEL:  Salesperson
      * CASE: PAR.Salesperson to Rvw Claim is entered
     C           P1ZLCD    IFNE *BLANK                     *IF
      * CASE: DB1.Salesperson to Rvw Claim NE PAR.Salesperson to Rvw Clai
     C           WAZLCD    IFNE P1ZLCD                     *IF
     C                     MOVEL'N'       WN0001           *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.*Record selected is *YES
     C           WN0001    IFEQ 'Y'                        *IF
      * Build file based on Claim Products.        (CM/DM)
     C                     EXSR UASUBR                     Build file base
      * Build file based on Claim Resale Products. (DM)
     C                     EXSR UMSUBR                     Build file base
     C                     END                             *FI
     C                     READ @MKCPWB                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBDLRC    BEGSR
      *================================================================
      * CLR Reason Code Array DL - *Arrays  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Initialize array variables
     C                     MOVEA*HIVAL    YK01
      * Initialize last used element number
     C                     Z-ADD0         YL01
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCDLRC    BEGSR
      *================================================================
      * CLR Dept Code Arrays DL - *Arrays  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Initialize array variables
     C                     MOVEA*HIVAL    YK02
      * Initialize last used element number
     C                     Z-ADD0         YL02
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * CRT DNLD Claims by Cst RT - A/R Claim Product  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0021  1        Save *Record Se
     C                     MOVEL*BLANK    WN0022  1        First Time Flag
     C                     Z-ADD*ZERO     WN0023  30       Sequence Number
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WN0022           First Time Flag
     C                     MOVEL'N'       WN0001           *Record selecte
     C                     MOVEL*BLANK    WN0015           Claim Reason Co
     C                     Z-ADD*ZERO     WN0023           Sequence Number
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDC0C7    WQSD01           Claim Number
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Claim Number
      * Setup key
     C                     Z-ADDWAC0C7    WQSD01           Claim Number
      * Establish starting position
     C           KRSSD     SETLL@MOCPWK                    *
     C           KRSSD     READE@MOCPWK                  90*
      * Data record not found
     C   90                MOVEL'USR2737' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WN0001           *Record selecte
      * Perform Selections.
     C                     EXSR UCSUBR                     Perform Selecti
      * CASE: PAR.*Record selected is *YES
     C           WN0001    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WN0021           Save *Record Se
      * Save First Reason Code.
     C                     EXSR UFSUBR                     Save First Reas
     C                     ADD  1         WN0023           Sequence Number
      * RTV/CRT Reas Cde Array RT - *Arrays  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0023    WL0001           Sequence Number
     C                     MOVELWDCQCD    WL0002    P      Reason Code
     C                     EXSR SERVGN
      * RTV/CRT Dept Cde Array RT - *Arrays  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0023    WL0003           Sequence Number
     C                     MOVELWDFUAA    WL0004    P      Claim Departmen
     C                     EXSR SGRVGN
     C                     END                             *FI
     C           KRSSD     READE@MOCPWK                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.Save *Record Selected USR is *YES
     C           WN0021    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WN0001           *Record selecte
     C                     END                             *FI
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV/CRT Reas Cde Array RT - *Arrays  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0024  1        Record Found US
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WN0024           Record Found US
     C                     Z-ADD1         Y       50
     C           YL01      IFGT 0
     C                     MOVELYK01,Y    YD01
     C           YI01      OCUR YM01
     C                     ELSE
      * Array element not found
     C                     MOVEL'Y2U0005' W0RTN   7
     C                     ENDIF
      *
      * Sequence through qualified elements:
     C                     Z-ADDY         YR01    50
     C           YR01      DOWLEYL01
     C                     Z-ADDYR01      Y
     C                     MOVELYK01,Y    YD01
     C           YI01      OCUR YM01
      * USER: Process Data record
      * CASE: DB1.Reason Code EQ PAR.Reason Code
     C           WBCQCD    IFEQ WL0002                     *IF
     C                     MOVEL'Y'       WN0024           Record Found US
     C                     END                             *FI
     C                     ADD  1         YR01
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.Record Found USR is Record Not Found
     C           WN0024    IFEQ 'N'                        *IF
      * CRT Reason Code Array CR - *Arrays  * 
     C                     EXSR SFCRRC
     C                     END                             *FI
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCRRC    BEGSR
      *================================================================
      * CRT Reason Code Array CR - *Arrays  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Array full, cannot add any more elements
     C           YL01      IFEQ 20
     C                     MOVEL'Y2U0036' W0RTN   7
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C                     Z-ADD*ZERO     XADXNB           Sequence Number
     C                     MOVEL*BLANK    XACQCD           Reason Code
      * Move all fields to Claim Unique Reason Codes
     C                     Z-ADDWL0001    XADXNB           Sequence Number
     C                     MOVELWL0002    XACQCD           Reason Code
      *
      * Move key fields to Claim Unique Reason Codes
     C                     Z-ADDXADXNB    YI0101           Sequence Number
     C                     MOVELXACQCD    YI0102           Reason Code
      *
      * Check for duplicate primary key
      * Initialize internal index
     C                     Z-ADD*ZERO     YI01
      * Only search if key is not beyond range of current elements
     C           YL01      IFGT 0
     C           YK01,YL01 ANDGTYD01
      * Set search index to first element of array
     C                     Z-ADD1         Y       50
     C           YD01      LOKUPYK01,Y               90    Look for >
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C           *IN90     IFEQ '1'
      * Move to data structure for comparison
     C                     MOVELYK01,Y    YD01
      * Compare
     C           YI0101    IFEQ XADXNB
     C           YI0102    ANDEQXACQCD
      * Array element already exists
     C                     MOVEL'Y2U0003' W0RTN   7
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C                     ENDIF
      *
      * Insert after last used element
     C           YL01      ADD  1         Y       50
      * Check if element was a previously deleted element
     C           YK01,Y    IFNE *HIVAL
      * If so, reuse MODS index
     C                     MOVELYK01,Y    YD01
     C                     ELSE
      * If not, use element number as MODS index
     C                     Z-ADDY         YI01
     C                     ENDIF
      *
      * Create(insert) new element
      * Move key fields to Claim Unique Reason Codes
     C                     Z-ADDXADXNB    YI0101           Sequence Number
     C                     MOVELXACQCD    YI0102           Reason Code
      *
     C                     MOVELYD01      YK01,Y
     C           YI01      OCUR YM01
      * Update MODS fields
     C                     Z-ADDXADXNB    WBDXNB           Sequence Number
     C                     MOVELXACQCD    WBCQCD           Reason Code
      * Only sort if element is out of position
     C           YL01      IFGT 0
     C           YK01,YL01 ANDGTYD01
      * Adjust RTVOBJ index to reflect position of added/removed element
     C           YR01      IFGT 0
     C           YR01      ANDLE20
     C           YK01,YR01 ANDGTYD01
     C                     ADD  1         YR01    50
     C                     ENDIF
      * Sort array to place element in correct position
     C                     SORTAYK01
     C                     ENDIF
      * Adjust number of elements currently in array
     C                     ADD  1         YL01
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV/CRT Dept Cde Array RT - *Arrays  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0025  1        Record Found US
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WN0025           Record Found US
     C                     Z-ADD1         Y       50
     C           YL02      IFGT 0
     C                     MOVELYK02,Y    YD02
     C           YI02      OCUR YM02
     C                     ELSE
      * Array element not found
     C                     MOVEL'Y2U0005' W0RTN   7
     C                     ENDIF
      *
      * Sequence through qualified elements:
     C                     Z-ADDY         YR02    50
     C           YR02      DOWLEYL02
     C                     Z-ADDYR02      Y
     C                     MOVELYK02,Y    YD02
     C           YI02      OCUR YM02
      * USER: Process Data record
      * CASE: DB1.Claim Department Code EQ PAR.Claim Department Code
     C           WCFUAA    IFEQ WL0004                     *IF
     C                     MOVEL'Y'       WN0025           Record Found US
     C                     END                             *FI
     C                     ADD  1         YR02
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.Record Found USR is Record Not Found
     C           WN0025    IFEQ 'N'                        *IF
      * CRT Dept Code Array CR - *Arrays  * 
     C                     EXSR SHCRRC
     C                     END                             *FI
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCRRC    BEGSR
      *================================================================
      * CRT Dept Code Array CR - *Arrays  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Array full, cannot add any more elements
     C           YL02      IFEQ 20
     C                     MOVEL'Y2U0036' W0RTN   7
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C                     Z-ADD*ZERO     XBDXNB           Sequence Number
     C                     MOVEL*BLANK    XBFUAA           Claim Departmen
      * Move all fields to Claim Unique Dept Codes
     C                     Z-ADDWL0003    XBDXNB           Sequence Number
     C                     MOVELWL0004    XBFUAA           Claim Departmen
      *
      * Move key fields to Claim Unique Dept Codes
     C                     Z-ADDXBDXNB    YI0201           Sequence Number
     C                     MOVELXBFUAA    YI0202           Claim Departmen
      *
      * Check for duplicate primary key
      * Initialize internal index
     C                     Z-ADD*ZERO     YI02
      * Only search if key is not beyond range of current elements
     C           YL02      IFGT 0
     C           YK02,YL02 ANDGTYD02
      * Set search index to first element of array
     C                     Z-ADD1         Y       50
     C           YD02      LOKUPYK02,Y               90    Look for >
     C                     ELSE
     C                     SETOF                     90    *
     C                     ENDIF
     C           *IN90     IFEQ '1'
      * Move to data structure for comparison
     C                     MOVELYK02,Y    YD02
      * Compare
     C           YI0201    IFEQ XBDXNB
     C           YI0202    ANDEQXBFUAA
      * Array element already exists
     C                     MOVEL'Y2U0003' W0RTN   7
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C                     ENDIF
      *
      * Insert after last used element
     C           YL02      ADD  1         Y       50
      * Check if element was a previously deleted element
     C           YK02,Y    IFNE *HIVAL
      * If so, reuse MODS index
     C                     MOVELYK02,Y    YD02
     C                     ELSE
      * If not, use element number as MODS index
     C                     Z-ADDY         YI02
     C                     ENDIF
      *
      * Create(insert) new element
      * Move key fields to Claim Unique Dept Codes
     C                     Z-ADDXBDXNB    YI0201           Sequence Number
     C                     MOVELXBFUAA    YI0202           Claim Departmen
      *
     C                     MOVELYD02      YK02,Y
     C           YI02      OCUR YM02
      * Update MODS fields
     C                     Z-ADDXBDXNB    WCDXNB           Sequence Number
     C                     MOVELXBFUAA    WCFUAA           Claim Departmen
      * Only sort if element is out of position
     C           YL02      IFGT 0
     C           YK02,YL02 ANDGTYD02
      * Adjust RTVOBJ index to reflect position of added/removed element
     C           YR02      IFGT 0
     C           YR02      ANDLE20
     C           YK02,YR02 ANDGTYD02
     C                     ADD  1         YR02    50
     C                     ENDIF
      * Sort array to place element in correct position
     C                     SORTAYK02
     C                     ENDIF
      * Adjust number of elements currently in array
     C                     ADD  1         YL02
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Claim Reason Codes RT - *Arrays  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0026  50       Count USR
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    WL0005           Claim Reason Co
     C                     Z-ADD1         WN0026           Count USR
     C                     Z-ADD1         Y       50
     C           YL01      IFGT 0
     C                     MOVELYK01,Y    YD01
     C           YI01      OCUR YM01
     C                     ELSE
      * Array element not found
     C                     MOVEL'Y2U0005' W0RTN   7
     C                     ENDIF
      *
      * Sequence through qualified elements:
     C                     Z-ADDY         YR01    50
     C           YR01      DOWLEYL01
     C                     Z-ADDYR01      Y
     C                     MOVELYK01,Y    YD01
     C           YI01      OCUR YM01
      * USER: Process Data record
      * CASE: PAR.Count USR is LE 4
     C           WN0026    IFLE 4                          *IF
      * CASE: PAR.Claim Reason Code(s) is *Blank
     C           WL0005    IFEQ *BLANK                     *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           WL0005    CAT  WBCQCD:ZQ WL0005    P      Claim Reason Co
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           WL0005    CAT  ',':ZQ    WL0005    P      Claim Reason Co
     C                     Z-ADD*ZERO     ZQ      50
     C           WL0005    CAT  WBCQCD:ZQ WL0005    P      Claim Reason Co
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         WN0026           Count USR
     C                     ADD  1         YR01
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Claim Order Info   RT - Sales History  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN WEC4NB    WQSJ02           Order Number
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Order Number
      * Setup key
     C                     Z-ADDWL0006    WQSJ01           Company Number
     C                     Z-ADDWL0007    WQSJ02           Order Number
      * Establish starting position
     C           KRSSJ     SETLL@FHSTD3                    *
     C           KRSSJ     READE@FHSTD3                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1241' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0008           Ship To Custome
     C                     MOVEL*BLANK    WL0009           Ship To Name
     C                     MOVEL*BLANK    WL0010           Customer Purcha
     C                     MOVEL*BLANK    WL0011           Carrier Code
     C                     MOVEL*BLANK    WL0012           Warehouse Code
     C                     Z-ADD*ZERO     WL0013           Invoice Date
     C                     Z-ADD*ZERO     WL0014           Invoice Number
     C                     MOVEL*BLANK    WL0015           Invoice Suffix
     C                     Z-ADD*ZERO     WL0016           Actual Shipped
     C                     Z-ADD*ZERO     WL0017           Load ID
     C                     MOVEL*BLANK    WL0018           Salesperson to
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEBKC7    WL0008           Ship To Custome
     C                     MOVELWEBRTX    WL0009           Ship To Name
     C                     MOVELWEBCNA    WL0010           Customer Purcha
     C                     MOVELWEBZNA    WL0011           Carrier Code
     C                     MOVELWEAJCD    WL0012           Warehouse Code
     C                     Z-ADDWEAWDT    WL0013           Invoice Date
     C                     Z-ADDWECONB    WL0014           Invoice Number
     C                     MOVELWECEST    WL0015           Invoice Suffix
     C                     Z-ADDWEGNDT    WL0016           Actual Shipped
     C                     Z-ADDWERMNB    WL0017           Load ID
      * RTV Salesman Code      RT - Sales Route  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWER4CD    WL0019    P      Sales Route Cod
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0020    WL0018    P      Salesperson Cod
     C                     GOTO SJEXIT                     *QUIT
     C           KRSSJ     READE@FHSTD3                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Salesman Code      RT - Sales Route  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WFR4CD           Sales Route Cod
      * Setup key
     C                     MOVELWL0019    WFR4CD           Sales Route Cod
      * Establish starting position
     C           KRSSK     CHAIN@JEREWS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1800' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0020           Salesperson Cod
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFBCCD    WL0020           Salesperson Cod
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Claim Order Info   RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0021    WGAIC3           Company Number
     C                     Z-ADDWL0022    WGC4NB           Order Number
      * Establish starting position
     C           KRSSL     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0023           Ship To Custome
     C                     MOVEL*BLANK    WL0024           Ship To Name
     C                     MOVEL*BLANK    WL0025           Customer Purcha
     C                     Z-ADD*ZERO     WL0026           Actual Shipped
     C                     MOVEL*BLANK    WL0027           Carrier Code
     C                     Z-ADD*ZERO     WL0028           Load ID
     C                     Z-ADD*ZERO     WL0029           Invoice Number
     C                     MOVEL*BLANK    WL0030           Invoice Suffix
     C                     Z-ADD*ZERO     WL0031           Invoice Date
     C                     MOVEL*BLANK    WL0032           Salesperson to
     C                     MOVEL*BLANK    WL0033           Warehouse Code
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGBKC7    WL0023           Ship To Custome
     C                     MOVELWGBRTX    WL0024           Ship To Name
     C                     MOVELWGBCNA    WL0025           Customer Purcha
     C                     Z-ADDWGGNDT    WL0026           Actual Shipped
     C                     MOVELWGBZNA    WL0027           Carrier Code
     C                     Z-ADDWGRMNB    WL0028           Load ID
     C                     Z-ADDWGCONB    WL0029           Invoice Number
     C                     MOVELWGCEST    WL0030           Invoice Suffix
     C                     Z-ADDWGAWDT    WL0031           Invoice Date
      * RTV Whse/Non Cancelled RT - Order Detail  * 
     C                     EXSR SMRVGN
      * RTV Salesman Code      RT - PD Sales Route  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWGR4CD    WL0019    P      Sales Route Cod
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0020    WL0032    P      Salesperson Cod
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Whse/Non Cancelled RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSM01           Company Number
     C           *LIKE     DEFN WHC4NB    WQSM02           Order Number
      * Define keylist
     C           KPSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Order Number
     C                     KFLD           WHDPNB           Order Sequence
     C                     KFLD           WHUENB           Order Secondary
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Order Number
      * Setup key
     C                     Z-ADDWGAIC3    WQSM01           Company Number
     C                     Z-ADDWGC4NB    WQSM02           Order Number
     C                     Z-ADD*ZERO     WHDPNB           Order Sequence
     C                     Z-ADD*ZERO     WHUENB           Order Secondary
      * Establish starting position
     C           KPSSM     SETLL@BGWKL1                    *
     C           KRSSM     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0033           Warehouse Code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
      * CASE: DB1.Detail Line Status is Cancelled
     C           WHGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = DB1 By name
     C                     MOVELWHAJCD    WL0033           Warehouse Code
     C                     GOTO SMEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSM     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Salesperson        RT - Salesperson  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WIBCCD           Salesperson Cod
      * Setup key
     C                     MOVELWL0034    WIBCCD           Salesperson Cod
      * Establish starting position
     C           KRSSN     CHAIN@APREBU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0035           Salesperson Nam
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIALTX    WL0035           Salesperson Nam
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV First Expln Line RT - A/R Claim Explanation  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0033  50       Count USR
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    WL0037           Claim Short Exp
     C                     Z-ADD1         WN0033           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJC0C7    WQSO01           Claim Number
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Claim Number
      * Setup key
     C                     Z-ADDWL0036    WQSO01           Claim Number
      * Establish starting position
     C           KRSSO     SETLL@MNCPSE                    *
     C           KRSSO     READE@MNCPSE                  90*
      * Data record not found
     C   90                MOVEL'USR2735' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.Count USR is LE 2
     C           WN0033    IFLE 2                          *IF
     C                     Z-ADD1         ZQ      50
     C           WL0037    CAT  WJPYTX:ZQ WL0037    P      Claim Short Exp
     C                     ADD  1         WN0033           Count USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     GOTO SOEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSO     READE@MNCPSE                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Claim Dept Codes RT - *Arrays  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0034 30        Department Desc
     C                     Z-ADD*ZERO     WN0035  50       Count USR
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    WL0038           Claim Departmen
     C                     Z-ADD1         WN0035           Count USR
     C                     Z-ADD1         Y       50
     C           YL02      IFGT 0
     C                     MOVELYK02,Y    YD02
     C           YI02      OCUR YM02
     C                     ELSE
      * Array element not found
     C                     MOVEL'Y2U0005' W0RTN   7
     C                     ENDIF
      *
      * Sequence through qualified elements:
     C                     Z-ADDY         YR02    50
     C           YR02      DOWLEYL02
     C                     Z-ADDYR02      Y
     C                     MOVELYK02,Y    YD02
     C           YI02      OCUR YM02
      * USER: Process Data record
      * CASE: PAR.Count USR is LE 4
     C           WN0035    IFLE 4                          *IF
      * 051705 slm use the department description as is do not
      *            set condition for the description
      *            this process was using the responsibility department
      *            now we use the claim department
      * Rtv Claim Department   RT - A/R Claim Department  * 
     C                     EXSR SQRVGN
      * CASE: PAR.Department Description is equal to blank
     C           WN0034    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    WN0034           Department Desc
     C                     MOVEL@CN,01    WN0034           Department Desc
     C                     END                             *FI
      * CASE: PAR.Claim Department Desc is *Blank
     C           WL0038    IFEQ *BLANK                     *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           WL0038    CAT  WN0034:ZQ WL0038    P      Claim Departmen
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           WL0038    CAT  ',':ZQ    WL0038    P      Claim Departmen
     C                     Z-ADD*ZERO     ZQ      50
     C           WL0038    CAT  WN0034:ZQ WL0038    P      Claim Departmen
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         WN0035           Count USR
     C                     ADD  1         YR02
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Claim Department   RT - A/R Claim Department  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WKFUAA           Claim Departmen
      * Setup key
     C                     MOVELWCFUAA    WKFUAA           Claim Departmen
      * Establish starting position
     C           KRSSQ     CHAIN@ATREW0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3421' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0034           Claim Departmen
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWKTXTX    WN0034           Claim Departmen
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Calc Resale Total  RT - A/R Claim Resale Product  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0002           Resale Total It
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLC0C7    WQSR01           Claim Number
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           Claim Number
      * Setup key
     C                     Z-ADDWAC0C7    WQSR01           Claim Number
      * Establish starting position
     C           KRSSR     SETLL@MPCPWQ                    *
     C           KRSSR     READE@MPCPWQ                  90*
      * Data record not found
     C   90                MOVEL'USR2739' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WLBOVL    YL0002           Resale Total It
     C           KRSSR     READE@MPCPWQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCRRC    BEGSR
      *================================================================
      * CRT A/R Claim Download CR - WF A/R Claim Download  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0042  3        Warehouse Code
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @NACPZ9
     C                     Z-ADDWL0039    WMINNX           Claim Number (u
     C                     MOVELWL0040    WMG6SX           Claim Product/R
     C                     MOVELWL0041    WMTTTX           Claim Short Cus
     C                     MOVELWL0042    WMTSTX           Claim Reason Co
     C                     MOVELWL0043    WMCHSX           Claim Type
     C                     Z-ADDWL0044    WMIONX           Claim Load ID (
     C                     Z-ADDWL0045    WMIPNX           Claim Invoice (
     C                     MOVELWL0046    WMTUTX           Claim Act Shp D
     C                     Z-ADDWL0047    WMBIC3           Claim Company N
     C                     Z-ADDWL0048    WMIQNX           Claim Order # (
     C                     MOVELWL0049    WMTVTX           Claim Short Sal
     C                     MOVELWL0050    WMTYTX           Claim Entry Dat
     C                     MOVELWL0051    WMTXTX           Claim Departmen
     C                     MOVELWL0052    WMTWTX           Claim Short Exp
     C                     Z-ADDWL0053    WMB8VL           Claim Amount (u
     C                     Z-ADDWL0054    WMDQVL           Claim Resale Am
     C                     Z-ADDWL0055    WMDRVL           Claim Net Loss
     C                     MOVELWL0056    WMHJSX           Claim Over 10 D
     C                     MOVELWL0057    WMA4AA           Claim Reason Co
     C                     MOVELWL0058    WMCJSX           Claim Status
     C                     MOVELWL0059    WMPPTX           Claim Called in
      *
      * USER: Processing before Data update
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
     C                     EXSR STRVGN
     C           KLCRSS    KLIST
     C                     KFLD           WMINNX           Claim Number (u
     C                     KFLD           WMG6SX           Claim Product/R
     C                     KFLD           WMTTTX           Claim Short Cus
      * Check for duplicate primary key
     C           KLCRSS    SETLL@NACPZ9                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2860' W0RTN   7
      * Send message 'WF A/R Claim Download  EX'
     C                     MOVEL'USR2860' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C                     WRITE@NACPZ9                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV 1st Warehouse/Ctl  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOAIC3    WQST01           Company Number
     C           *LIKE     DEFN WOC4NB    WQST02           Order Number
      * Define keylist
     C           KPSST     KLIST
     C                     KFLD           WQST01           Company Number
     C                     KFLD           WQST02           Order Number
     C                     KFLD           WODPNB           Order Sequence
     C                     KFLD           WOUENB           Order Secondary
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           Company Number
     C                     KFLD           WQST02           Order Number
      * Setup key
     C                     Z-ADDWMBIC3    WQST01           Company Number
     C                     Z-ADDWMIQNX    WQST02           Order Number
     C                     Z-ADD*ZERO     WODPNB           Order Sequence
     C                     Z-ADD*ZERO     WOUENB           Order Secondary
      * Establish starting position
     C           KPSST     SETLL@BGWKAE                    *
     C           KRSST     READE@BGWKAE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WMAJCD           Warehouse Code
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Warehouse Control  RT - Warehouse  * 
     C                     EXSR SURVGN
      * PAR = DB1 By name
     C                     MOVELWOAJCD    WMAJCD           Warehouse Code
     C                     GOTO STEXIT                     *QUIT
     C           KRSST     READE@BGWKAE                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV Warehouse Control  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WRAJCD           Warehouse Code
      * Setup key
     C                     MOVELWOAJCD    WRAJCD           Warehouse Code
      * Establish starting position
     C           KRSSU     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * CRT DNLD Claims by Cst RT - A/R Claim Resale Product  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0043  1        *Record selecte
     C                     MOVEL*BLANK    WN0044  3        Claim Reason Co
     C                     Z-ADD*ZERO     WN0045 112       Resale Item Amo
     C                     MOVEL*BLANK    WN0046  1        Save *Record Se
     C                     MOVEL*BLANK    WN0047  1        First Time Flag
     C                     Z-ADD*ZERO     WN0048  30       Sequence Number
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WN0047           First Time Flag
     C                     MOVEL'N'       WN0043           *Record selecte
     C                     MOVEL*BLANK    WN0044           Claim Reason Co
     C                     Z-ADD*ZERO     WN0045           Resale Item Amo
     C                     Z-ADD*ZERO     WN0048           Sequence Number
     C                     MOVEL'N'       YL0003           Save *Record Se
      * 04/26/00 PKD PK0212: Added the following initialization.
      * ----- Initialize Download Record fields with Claim information. -
     C                     Z-ADDWAC0C7    YL0004           Claim Number (u
     C                     MOVEL'R'       YL0005           Claim Product/R
     C                     MOVEL'DM'      YL0006           Claim Type
      * Get Order Info.
     C                     EXSR UOSUBR                     Get Order Info.
     C                     Z-ADDWAALNX    YL0011           Claim Order # (
      * RTV Salesperson        RT - Salesperson  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAZLCD    WL0034    P      Salesperson Cod
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0035    YL0012    P      Salesperson Nam
      * CLC Find Last Name     UP - A/R Claim Download Wrkf  * 
     C                     CALL 'POAGUPC'              90  CLC Find Last N
     C                     PARM YL0012    WQ0003 30        Salesperson Nam
     C           YL0013    PARM *BLANK    WQ0004 20        Claim Short Sal
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POAGUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Load Short Explanation
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Claim Status is Denied
      *   |- c2    : PAR.Claim Status is Voided
      *   '-
     C           WACJSX    IFEQ 'D'                        *IF
     C           WACJSX    OREQ 'V'                        *OR
     C                     MOVEL*BLANK    YL0014           Claim Short Exp
     C                     MOVELWATBTX    YL0014           Claim Short Exp
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV First Expln Line RT - A/R Claim Explanation  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAC0C7    WL0036           Claim Number
     C                     MOVELYL0014    WL0037    P      Claim Short Exp
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0037    YL0014    P      Claim Short Exp
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0055  40       YYYY numeric US
     C                     Z-ADD*ZERO     WN0056  20       MM   numeric US
     C                     Z-ADD*ZERO     WN0057  20       DD   numeric US
     C                     MOVEL*BLANK    WN0058  4        YYYY alpha   US
     C                     MOVEL*BLANK    WN0059  2        MM   alpha   US
     C                     MOVEL*BLANK    WN0060  2        DD   alpha   US
      *
      * Convert DTE to mm/dd/yyyy
      * Break apart date.
      * PAR.YYYY numeric USR = PAR.@Date - ATR *YEAR
     C           WAMNDT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    WN0055
      * PAR.MM   numeric USR = PAR.@Date - ATR *MONTH
     C           WAMNDT    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    WN0056
      * PAR.DD   numeric USR = PAR.@Date - ATR *DAY OF MONTH
     C           WAMNDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     WN0057
      * Convert to alpha.
     C                     MOVEL*BLANK    WN0058           YYYY alpha   US
     C                     MOVELWN0055    WN0058           YYYY alpha   US
     C                     MOVELWN0056    WN0059           MM   alpha   US
     C                     MOVELWN0057    WN0060           DD   alpha   US
      * Put back together.
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0059    CAT  '/':ZQ    YL0015    P      Date mm/dd/yyyy
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0015    CAT  WN0060:ZQ YL0015    P      Date mm/dd/yyyy
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0015    CAT  '/':ZQ    YL0015    P      Date mm/dd/yyyy
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0015    CAT  WN0058:ZQ YL0015    P      Date mm/dd/yyyy
     C                     MOVELWAPPTX    YL0016           Claim Called in
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLC0C7    WQSV01           Claim Number
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           Claim Number
      * Setup key
     C                     Z-ADDWAC0C7    WQSV01           Claim Number
      * Establish starting position
     C           KRSSV     SETLL@MPCPWQ                    *
     C           KRSSV     READE@MPCPWQ                  90*
      * Data record not found
     C   90                MOVEL'USR2739' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WN0043           *Record selecte
      * SEL:  Item Code
      * CASE: PAR.Claim Item Code is Entered
     C           P1C1C7    IFNE *ZERO                      *IF
      * CASE: DB1.Resale Item Code NE PAR.Claim Item Code
     C           WLC5C7    IFNE P1C1C7                     *IF
     C                     MOVEL'N'       WN0043           *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * SEL:  Reason Code
      * CASE: PAR.Reason Code is Entered
     C           P1CQCD    IFNE *BLANK                     *IF
      * CASE: DB1.Reason Code NE PAR.Reason Code
     C           WLCQCD    IFNE P1CQCD                     *IF
     C                     MOVEL'N'       WN0043           *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Process Selected Record
      * CASE: PAR.*Record selected is *YES
     C           WN0043    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0003           Save *Record Se
      * First Time Processing
      * CASE: PAR.First Time Flag is Yes
     C           WN0047    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WN0047           First Time Flag
     C                     Z-ADDWLBKC7    YL0017           Ship To Custome
     C                     MOVELWLCQCD    YL0018           Claim Reason Co
     C                     MOVELWACJSX    YL0019           Claim Status
      * ----- Retrieve the Customer Name. -----
      * RTV Customer Name      RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLBKC7    WL0060           Ship To Custome
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0061    YL0020    P      Customer Name
     C                     END                             *FI
      * 04/26/00 PKD PK0212: Added the Build & Create.
      * Build & Create Download Record when Ship To Customer changes.
      * CASE: DB1.Ship To Customer NE LCL.Ship To Customer
     C           WLBKC7    IFNE YL0017                     *IF
      * ----- Create Download Record. -----
      * RTV Claim Reason Codes RT - *Arrays  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0021    WL0005    P      Claim Reason Co
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    YL0021    P      Claim Reason Co
      * RTV Claim Dept Codes RT - *Arrays  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0022    WL0038    P      Claim Departmen
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0038    YL0022    P      Claim Departmen
      * Load Claim Amount & Set Sign.
      * CASE: Claim denied or voided
      *  - c1 OR c2
      *   |- c1    : PAR.Claim Status is Denied
      *   |- c2    : PAR.Claim Status is Voided
      *   '-
     C           WACJSX    IFEQ 'D'                        *IF
     C           WACJSX    OREQ 'V'                        *OR
     C                     Z-ADD*ZERO     YL0023           Claim Amount (u
     C                     ELSE
      * CASE: *OTHERWISE
      * Claim NOT denied or voided.
      * CASE: PAR.Resale Item Amount is greater than zero
     C           WN0045    IFGT *ZERO                      *IF
     C           WN0045    MULT -1        YL0023           Claim Amount (u
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0045    YL0023           Claim Amount (u
     C                     END                             *FI
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) WABIC3' defaulted for 'Claim Company Number'.
      * CRT A/R Claim Download CR - A/R Claim Download Wrkf  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0004    WL0039           Claim Number (u
     C                     MOVELYL0005    WL0040    P      Claim Product/R
     C                     MOVELYL0020    WL0041    P      Claim Short Cus
     C                     MOVELYL0021    WL0042    P      Claim Reason Co
     C                     MOVELYL0006    WL0043    P      Claim Type
     C                     Z-ADDYL0009    WL0044           Claim Load ID (
     C                     Z-ADDYL0007    WL0045           Claim Invoice (
     C                     MOVELYL0010    WL0046    P      Claim Act Shp D
     C                     Z-ADDWABIC3    WL0047           Claim Company N
     C                     Z-ADDYL0011    WL0048           Claim Order # (
     C                     MOVELYL0013    WL0049    P      Claim Short Sal
     C                     MOVELYL0015    WL0050    P      Claim Entry Dat
     C                     MOVELYL0022    WL0051    P      Claim Departmen
     C                     MOVELYL0014    WL0052    P      Claim Short Exp
     C                     Z-ADDYL0023    WL0053           Claim Amount (u
     C                     Z-ADD*ZERO     WL0054           Claim Resale Am
     C                     Z-ADD*ZERO     WL0055           Claim Net Loss
     C                     MOVEL*BLANK    WL0056           Claim Over 10 D
     C                     MOVELYL0018    WL0057    P      Claim Reason Co
     C                     MOVELYL0019    WL0058    P      Claim Status
     C                     MOVELYL0016    WL0059    P      Claim Called in
     C                     EXSR SSCRRC
      * ----- Initialize New Ship To Customer fields. -----
     C                     Z-ADDWLBKC7    YL0017           Ship To Custome
     C                     MOVELWLCQCD    YL0018           Claim Reason Co
     C                     MOVELWACJSX    YL0019           Claim Status
      * RTV Customer Name      RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLBKC7    WL0060           Ship To Custome
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0061    YL0020    P      Customer Name
     C                     Z-ADD*ZERO     WN0045           Resale Item Amo
     C                     Z-ADD*ZERO     WN0048           Sequence Number
      * CLR Reason Code Array DL - *Arrays  * 
     C                     EXSR SBDLRC
      * CLR Dept Code Arrays DL - *Arrays  * 
     C                     EXSR SCDLRC
     C                     END                             *FI
      * ----- Process Record -----
     C                     ADD  1         WN0048           Sequence Number
      * Create Array record with Reason's & Departments for the
      * Ship To Customer.
      * RTV/CRT Reas Cde Array RT - *Arrays  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0048    WL0001           Sequence Number
     C                     MOVELWLCQCD    WL0002    P      Reason Code
     C                     EXSR SERVGN
      * RTV/CRT Dept Cde Array RT - *Arrays  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0048    WL0003           Sequence Number
     C                     MOVELWLFUAA    WL0004    P      Claim Departmen
     C                     EXSR SGRVGN
     C                     ADD  WLBOVL    WN0045           Resale Item Amo
     C                     END                             *FI
     C           KRSSV     READE@MPCPWQ                  90*
     C                     ENDDO
      * USER: Exit processing
      * 04/26/00 PKD PK0212: Added the Build & Create.
      * ----- Create Download Record if Resale existed. -----
      * CASE: LCL.Save *Record Selected USR is *YES
     C           YL0003    IFEQ 'Y'                        *IF
      * RTV Claim Reason Codes RT - *Arrays  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0021    WL0005    P      Claim Reason Co
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    YL0021    P      Claim Reason Co
      * RTV Claim Dept Codes RT - *Arrays  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0022    WL0038    P      Claim Departmen
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0038    YL0022    P      Claim Departmen
      * Load Claim Amount & Set Sign.
      * CASE: Claim denied or voided
      *  - c1 OR c2
      *   |- c1    : PAR.Claim Status is Denied
      *   |- c2    : PAR.Claim Status is Voided
      *   '-
     C           WACJSX    IFEQ 'D'                        *IF
     C           WACJSX    OREQ 'V'                        *OR
     C                     Z-ADD*ZERO     YL0023           Claim Amount (u
     C                     ELSE
      * CASE: *OTHERWISE
      * Claim NOT denied or voided.
      * CASE: PAR.Resale Item Amount is greater than zero
     C           WN0045    IFGT *ZERO                      *IF
     C           WN0045    MULT -1        YL0023           Claim Amount (u
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0045    YL0023           Claim Amount (u
     C                     END                             *FI
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) WABIC3' defaulted for 'Claim Company Number'.
      * CRT A/R Claim Download CR - A/R Claim Download Wrkf  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0004    WL0039           Claim Number (u
     C                     MOVELYL0005    WL0040    P      Claim Product/R
     C                     MOVELYL0020    WL0041    P      Claim Short Cus
     C                     MOVELYL0021    WL0042    P      Claim Reason Co
     C                     MOVELYL0006    WL0043    P      Claim Type
     C                     Z-ADDYL0009    WL0044           Claim Load ID (
     C                     Z-ADDYL0007    WL0045           Claim Invoice (
     C                     MOVELYL0010    WL0046    P      Claim Act Shp D
     C                     Z-ADDWABIC3    WL0047           Claim Company N
     C                     Z-ADDYL0011    WL0048           Claim Order # (
     C                     MOVELYL0013    WL0049    P      Claim Short Sal
     C                     MOVELYL0015    WL0050    P      Claim Entry Dat
     C                     MOVELYL0022    WL0051    P      Claim Departmen
     C                     MOVELYL0014    WL0052    P      Claim Short Exp
     C                     Z-ADDYL0023    WL0053           Claim Amount (u
     C                     Z-ADD*ZERO     WL0054           Claim Resale Am
     C                     Z-ADD*ZERO     WL0055           Claim Net Loss
     C                     MOVEL*BLANK    WL0056           Claim Over 10 D
     C                     MOVELYL0018    WL0057    P      Claim Reason Co
     C                     MOVELYL0019    WL0058    P      Claim Status
     C                     MOVELYL0016    WL0059    P      Claim Called in
     C                     EXSR SSCRRC
     C                     END                             *FI
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV Customer Name      RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WSBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0060    WSBKC7           Ship To Custome
      * Establish starting position
     C           KRSSW     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0061           Customer Name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWSAYTX    WL0061           Customer Name
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV/CRT Claim Reas FileRT - OP Reason Codes  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0061 33        Claim Reason Co
     C                     Z-ADD*ZERO     WN0062  40       Claim Reason Co
     C                     Z-ADD*ZERO     WN0063 112       Claim Reason Co
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@CXRENA                    *
     C                     READ @CXRENA                  90*
      * Data record not found
     C   90                MOVEL'USR0504' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WTVSST    IFEQ 'A'                        *IF
      * Build "Claim Reason Code Desc" field.
     C                     EXSR UPSUBR                     Build "Claim Re
      * RTV Sum for Reason CodeRT - WF A/R Claim Download  * 
     C                     EXSR SYRVGN
      * CRT A/R Claim Reas Dwn CR - WF A/R Claim Reas Dwnld  * 
     C                     EXSR SZCRRC
     C                     END                             *FI
     C                     READ @CXRENA                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV Sum for Reason CodeRT - WF A/R Claim Download  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0062           Claim Reason Co
     C                     Z-ADD*ZERO     WN0063           Claim Reason Co
      * Declare restrictor key work fields
     C           *LIKE     DEFN WVA4AA    WQSY01           Claim Reason Co
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           Claim Reason Co
      * Setup key
     C                     MOVELWTCQCD    WQSY01           Claim Reason Co
      * Establish starting position
     C           KRSSY     SETLL@NACPAB                    *
     C           KRSSY     READE@NACPAB                  90*
      * Data record not found
     C   90                MOVEL'USR2859' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WN0062           Claim Reason Co
     C                     ADD  WVB8VL    WN0063           Claim Reason Co
     C           KRSSY     READE@NACPAB                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZCRRC    BEGSR
      *================================================================
      * CRT A/R Claim Reas Dwn CR - WF A/R Claim Reas Dwnld  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @NBCPAD
     C                     MOVELWTCQCD    WWCQCD           Reason Code
     C                     MOVELWN0061    WWT3TX           Claim Reason Co
     C                     Z-ADDWN0062    WWIVNX           Claim Reason Co
     C                     Z-ADDWN0063    WWB9VL           Claim Reason Co
      *
     C           KLCRSZ    KLIST
     C                     KFLD           WWCQCD           Reason Code
      * Check for duplicate primary key
     C           KLCRSZ    SETLL@NBCPAD                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2865' W0RTN   7
      * Send message 'WF A/R Claim Reas Dwnl EX'
     C                     MOVEL'USR2865' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C                     WRITE@NBCPAD                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Build file based on Claim Products.        (CM/DM)
      *================================================================
      * Clear Arrays.
     C                     EXSR UBSUBR                     Clear Arrays.
      * CRT DNLD Claims by Cst RT - A/R Claim Product  * 
     C                     EXSR SDRVGN
      * CASE: PAR.*Record selected is *YES
     C           WN0001    IFEQ 'Y'                        *IF
      * Build & Create Download Record.
     C                     EXSR UGSUBR                     Build & Create
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Clear Arrays.
      *================================================================
      * CLR Reason Code Array DL - *Arrays  * 
     C                     EXSR SBDLRC
      * CLR Dept Code Arrays DL - *Arrays  * 
     C                     EXSR SCDLRC
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Perform Selections.
      *================================================================
      * Select by Item Code.
     C                     EXSR UDSUBR                     Select by Item
      * Select by Reason Code.
     C                     EXSR UESUBR                     Select by Reaso
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Select by Item Code.
      *================================================================
      * CASE: PAR.Claim Item Code is Entered
     C           P1C1C7    IFNE *ZERO                      *IF
      * CASE: DB1.Claim Item Code NE PAR.Claim Item Code
     C           WDC1C7    IFNE P1C1C7                     *IF
     C                     MOVEL'N'       WN0001           *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Select by Reason Code.
      *================================================================
      * CASE: PAR.Reason Code is Entered
     C           P1CQCD    IFNE *BLANK                     *IF
      * CASE: DB1.Reason Code NE PAR.Reason Code
     C           WDCQCD    IFNE P1CQCD                     *IF
     C                     MOVEL'N'       WN0001           *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Save First Reason Code.
      *================================================================
      * CASE: PAR.First Time Flag is Yes
     C           WN0022    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WN0022           First Time Flag
     C                     MOVELWDCQCD    WN0015           Claim Reason Co
     C                     END                             *FI
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Build & Create Download Record.
      *================================================================
     C                     Z-ADDWAC0C7    WN0003           Claim Number (u
     C                     MOVEL'P'       WN0016           Claim Product/R
      * RTV Claim Reason Codes RT - *Arrays  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0004    WL0005    P      Claim Reason Co
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    WN0004    P      Claim Reason Co
     C                     MOVELWARFTX    WN0005           Claim Short Cus
     C                     MOVELWACHSX    WN0002           Claim Type
      * Get Order Info.
     C                     EXSR UHSUBR                     Get Order Info.
     C                     Z-ADDWAALNX    WN0009           Claim Order # (
      * RTV Salesperson        RT - Salesperson  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAZLCD    WL0034    P      Salesperson Cod
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0035    YL0001    P      Salesperson Nam
      * CLC Find Last Name     UP - A/R Claim Download Wrkf  * 
     C                     CALL 'POAGUPC'              90  CLC Find Last N
     C                     PARM YL0001    WQ0001 30        Salesperson Nam
     C           WN0010    PARM *BLANK    WQ0002 20        Claim Short Sal
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POAGUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Load Short Explanation.
     C                     EXSR UISUBR                     Load Short Expl
      * RTV Claim Dept Codes RT - *Arrays  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0012    WL0038    P      Claim Departmen
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0038    WN0012    P      Claim Departmen
      * Load Claim Amount & Set Sign.
     C                     EXSR UJSUBR                     Load Claim Amou
      *
     C                     Z-ADD*ZERO     WN0036  40       YYYY numeric US
     C                     Z-ADD*ZERO     WN0037  20       MM   numeric US
     C                     Z-ADD*ZERO     WN0038  20       DD   numeric US
     C                     MOVEL*BLANK    WN0039  4        YYYY alpha   US
     C                     MOVEL*BLANK    WN0040  2        MM   alpha   US
     C                     MOVEL*BLANK    WN0041  2        DD   alpha   US
      *
      * Convert DTE to mm/dd/yyyy
      * Break apart date.
      * PAR.YYYY numeric USR = PAR.@Date - ATR *YEAR
     C           WAMNDT    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    WN0036
      * PAR.MM   numeric USR = PAR.@Date - ATR *MONTH
     C           WAMNDT    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    WN0037
      * PAR.DD   numeric USR = PAR.@Date - ATR *DAY OF MONTH
     C           WAMNDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     WN0038
      * Convert to alpha.
     C                     MOVEL*BLANK    WN0039           YYYY alpha   US
     C                     MOVELWN0036    WN0039           YYYY alpha   US
     C                     MOVELWN0037    WN0040           MM   alpha   US
     C                     MOVELWN0038    WN0041           DD   alpha   US
      * Put back together.
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0040    CAT  '/':ZQ    WN0014    P      Date mm/dd/yyyy
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0014    CAT  WN0041:ZQ WN0014    P      Date mm/dd/yyyy
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0014    CAT  '/':ZQ    WN0014    P      Date mm/dd/yyyy
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0014    CAT  WN0039:ZQ WN0014    P      Date mm/dd/yyyy
      * *-------------------------------------------------------*
      * * 10/26/01 PKD T960 Added Resale Amount and Net Loss to Download
      * RTV Calc Resale Total  RT - A/R Claim Resale Product  * 
     C                     EXSR SRRVGN
     C                     Z-ADDYL0002    WN0017           Claim Resale Am
     C                     Z-ADDWAAZVL    WN0018           Claim Net Loss
      * *-------------------------------------------------------*
      * CRT A/R Claim Download CR - WF A/R Claim Download  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0003    WL0039           Claim Number (u
     C                     MOVELWN0016    WL0040    P      Claim Product/R
     C                     MOVELWN0005    WL0041    P      Claim Short Cus
     C                     MOVELWN0004    WL0042    P      Claim Reason Co
     C                     MOVELWN0002    WL0043    P      Claim Type
     C                     Z-ADDWN0006    WL0044           Claim Load ID (
     C                     Z-ADDWN0007    WL0045           Claim Invoice (
     C                     MOVELWN0008    WL0046    P      Claim Act Shp D
     C                     Z-ADDWABIC3    WL0047           Claim Company N
     C                     Z-ADDWN0009    WL0048           Claim Order # (
     C                     MOVELWN0010    WL0049    P      Claim Short Sal
     C                     MOVELWN0014    WL0050    P      Claim Entry Dat
     C                     MOVELWN0012    WL0051    P      Claim Departmen
     C                     MOVELWN0011    WL0052    P      Claim Short Exp
     C                     Z-ADDWN0013    WL0053           Claim Amount (u
     C                     Z-ADDWN0017    WL0054           Claim Resale Am
     C                     Z-ADDWN0018    WL0055           Claim Net Loss
     C                     MOVEL*BLANK    WL0056           Claim Over 10 D
     C                     MOVELWN0015    WL0057    P      Claim Reason Co
     C                     MOVELWACJSX    WL0058    P      Claim Status
     C                     MOVELWAPPTX    WL0059    P      Claim Called in
     C                     EXSR SSCRRC
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Get Order Info.
      *================================================================
      * RTV Claim Order Info   RT - Sales History  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWABIC3    WL0006           Company Number
     C                     Z-ADDWAALNX    WL0007           Order Number
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0008    WUY4CD           Ship To Custome
     C                     MOVELWL0009    WUOSTX    P      Ship To Name
     C                     MOVELWL0010    WUOSTX    P      Customer Purcha
     C                     MOVELWL0011    WUOSTX    P      Carrier Code
     C                     MOVELWL0012    WUOSTX    P      Warehouse Code
     C                     Z-ADDWL0013    WUMTDT           Invoice Date
     C                     Z-ADDWL0014    WN0007           Invoice Number
     C                     MOVELWL0015    WUOSTX    P      Invoice Suffix
     C                     Z-ADDWL0016    WN0019           Actual Shipped
     C                     Z-ADDWL0017    WN0006           Load ID
     C                     MOVELWL0018    WUOSTX    P      Salesperson to
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Claim Order Info   RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWABIC3    WL0021           Company Number
     C                     Z-ADDWAALNX    WL0022           Order Number
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0023    WUY4CD           Ship To Custome
     C                     MOVELWL0024    WUOSTX    P      Ship To Name
     C                     MOVELWL0025    WUOSTX    P      Customer Purcha
     C                     Z-ADDWL0026    WN0019           Actual Shipped
     C                     MOVELWL0027    WUOSTX    P      Carrier Code
     C                     Z-ADDWL0028    WN0006           Load ID
     C                     Z-ADDWL0029    WN0007           Invoice Number
     C                     MOVELWL0030    WUOSTX    P      Invoice Suffix
     C                     Z-ADDWL0031    WUMTDT           Invoice Date
     C                     MOVELWL0032    WUOSTX    P      Salesperson to
     C                     MOVELWL0033    WUOSTX    P      Warehouse Code
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0027  40       YYYY numeric US
     C                     Z-ADD*ZERO     WN0028  20       MM   numeric US
     C                     Z-ADD*ZERO     WN0029  20       DD   numeric US
     C                     MOVEL*BLANK    WN0030  4        YYYY alpha   US
     C                     MOVEL*BLANK    WN0031  2        MM   alpha   US
     C                     MOVEL*BLANK    WN0032  2        DD   alpha   US
      *
      * Convert DTE to mm/dd/yyyy
      * Break apart date.
      * PAR.YYYY numeric USR = PAR.@Date - ATR *YEAR
     C           WN0019    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    WN0027
      * PAR.MM   numeric USR = PAR.@Date - ATR *MONTH
     C           WN0019    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    WN0028
      * PAR.DD   numeric USR = PAR.@Date - ATR *DAY OF MONTH
     C           WN0019    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     WN0029
      * Convert to alpha.
     C                     MOVEL*BLANK    WN0030           YYYY alpha   US
     C                     MOVELWN0027    WN0030           YYYY alpha   US
     C                     MOVELWN0028    WN0031           MM   alpha   US
     C                     MOVELWN0029    WN0032           DD   alpha   US
      * Put back together.
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0031    CAT  '/':ZQ    WN0008    P      Date mm/dd/yyyy
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0008    CAT  WN0032:ZQ WN0008    P      Date mm/dd/yyyy
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0008    CAT  '/':ZQ    WN0008    P      Date mm/dd/yyyy
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0008    CAT  WN0030:ZQ WN0008    P      Date mm/dd/yyyy
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Load Short Explanation.
      *================================================================
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Claim Status is Denied
      *   |- c2    : DB1.Claim Status is Voided
      *   '-
     C           WACJSX    IFEQ 'D'                        *IF
     C           WACJSX    OREQ 'V'                        *OR
     C                     MOVEL*BLANK    WN0011           Claim Short Exp
     C                     MOVELWATBTX    WN0011           Claim Short Exp
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV First Expln Line RT - A/R Claim Explanation  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAC0C7    WL0036           Claim Number
     C                     MOVELWN0011    WL0037    P      Claim Short Exp
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0037    WN0011    P      Claim Short Exp
     C                     END                             *FI
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * Load Claim Amount & Set Sign.
      *================================================================
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Claim Status is Denied
      *   |- c2    : DB1.Claim Status is Voided
      *   '-
     C           WACJSX    IFEQ 'D'                        *IF
     C           WACJSX    OREQ 'V'                        *OR
      * Claim denied or voided
     C                     EXSR UKSUBR                     Claim denied or
     C                     ELSE
      * CASE: *OTHERWISE
      * Claim NOT denied or voided.
     C                     EXSR ULSUBR                     Claim NOT denie
     C                     END                             *FI
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * Claim denied or voided
      *================================================================
     C                     Z-ADD*ZERO     WN0013           Claim Amount (u
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * Claim NOT denied or voided.
      *================================================================
     C                     Z-ADDWAAYVL    WN0013           Claim Amount (u
      * CASE:
      *  - (c1 AND c2) OR (c3 AND c4)
      *   |- c1    : PAR.Claim Type is Debit Memo
      *   |- c2    : PAR.Claim Amount (unpacked) is Greater than Zero
      *   |- c3    : PAR.Claim Type is Credit Memo
      *   |- c4    : PAR.Claim Amount (unpacked) is Less than Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0002    IFEQ 'DM'                       *IF
     C           WN0013    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WN0002    IFEQ 'CM'                       *IF
     C           WN0013    IFLT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MULT -1        WN0013           Claim Amount (u
     C                     END                             *FI
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      * Build file based on Claim Resale Products. (DM)
      *================================================================
      * Clear Arrays.
     C                     EXSR UNSUBR                     Clear Arrays.
      * CRT DNLD Claims by Cst RT - A/R Claim Resale Product  * 
     C                     EXSR SVRVGN
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         UNSUBR    BEGSR
      *================================================================
      * Clear Arrays.
      *================================================================
      * CLR Reason Code Array DL - *Arrays  * 
     C                     EXSR SBDLRC
      * CLR Dept Code Arrays DL - *Arrays  * 
     C                     EXSR SCDLRC
      *================================================================
     CSR         UNEXIT    ENDSR
      /EJECT
     CSR         UOSUBR    BEGSR
      *================================================================
      * Get Order Info.
      *================================================================
      * RTV Claim Order Info   RT - Sales History  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWABIC3    WL0006           Company Number
     C                     Z-ADDWAALNX    WL0007           Order Number
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0008    WUY4CD           Ship To Custome
     C                     MOVELWL0009    WUOSTX    P      Ship To Name
     C                     MOVELWL0010    WUOSTX    P      Customer Purcha
     C                     MOVELWL0011    WUOSTX    P      Carrier Code
     C                     MOVELWL0012    WUOSTX    P      Warehouse Code
     C                     Z-ADDWL0013    WUMTDT           Invoice Date
     C                     Z-ADDWL0014    YL0007           Invoice Number
     C                     MOVELWL0015    WUOSTX    P      Invoice Suffix
     C                     Z-ADDWL0016    YL0008           Actual Shipped
     C                     Z-ADDWL0017    YL0009           Load ID
     C                     MOVELWL0018    WUOSTX    P      Salesperson to
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Claim Order Info   RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWABIC3    WL0021           Company Number
     C                     Z-ADDWAALNX    WL0022           Order Number
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0023    WUY4CD           Ship To Custome
     C                     MOVELWL0024    WUOSTX    P      Ship To Name
     C                     MOVELWL0025    WUOSTX    P      Customer Purcha
     C                     Z-ADDWL0026    YL0008           Actual Shipped
     C                     MOVELWL0027    WUOSTX    P      Carrier Code
     C                     Z-ADDWL0028    YL0009           Load ID
     C                     Z-ADDWL0029    YL0007           Invoice Number
     C                     MOVELWL0030    WUOSTX    P      Invoice Suffix
     C                     Z-ADDWL0031    WUMTDT           Invoice Date
     C                     MOVELWL0032    WUOSTX    P      Salesperson to
     C                     MOVELWL0033    WUOSTX    P      Warehouse Code
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0049  40       YYYY numeric US
     C                     Z-ADD*ZERO     WN0050  20       MM   numeric US
     C                     Z-ADD*ZERO     WN0051  20       DD   numeric US
     C                     MOVEL*BLANK    WN0052  4        YYYY alpha   US
     C                     MOVEL*BLANK    WN0053  2        MM   alpha   US
     C                     MOVEL*BLANK    WN0054  2        DD   alpha   US
      *
      * Convert DTE to mm/dd/yyyy
      * Break apart date.
      * PAR.YYYY numeric USR = PAR.@Date - ATR *YEAR
     C           YL0008    ADD  1000000   XDINDT
     C           1800      ADD  XDINYY    WN0049
      * PAR.MM   numeric USR = PAR.@Date - ATR *MONTH
     C           YL0008    ADD  1000000   XDINDT
     C                     Z-ADDXDINMM    WN0050
      * PAR.DD   numeric USR = PAR.@Date - ATR *DAY OF MONTH
     C           YL0008    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     WN0051
      * Convert to alpha.
     C                     MOVEL*BLANK    WN0052           YYYY alpha   US
     C                     MOVELWN0049    WN0052           YYYY alpha   US
     C                     MOVELWN0050    WN0053           MM   alpha   US
     C                     MOVELWN0051    WN0054           DD   alpha   US
      * Put back together.
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0053    CAT  '/':ZQ    YL0010    P      Date mm/dd/yyyy
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0010    CAT  WN0054:ZQ YL0010    P      Date mm/dd/yyyy
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0010    CAT  '/':ZQ    YL0010    P      Date mm/dd/yyyy
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0010    CAT  WN0052:ZQ YL0010    P      Date mm/dd/yyyy
      *================================================================
     CSR         UOEXIT    ENDSR
      /EJECT
     CSR         UPSUBR    BEGSR
      *================================================================
      * Build "Claim Reason Code Desc" field.
      *================================================================
     C                     Z-ADD*ZERO     ZQ      50
     C           WTCQCD    CAT  '-':ZQ    WN0061    P      Claim Reason Co
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0061    CAT  WTAUNA:ZQ WN0061    P      Claim Reason Co
      *================================================================
     CSR         UPEXIT    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDUDY     BEGSR
      *================================================================
      * Calculate duration, *DAYS
      *================================================================
     C           XDAY1     IFLT 1
     C           XDAY2     ORLT 1
     C                     Z-ADD0         XDURR
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     GOTO XDUDYE
     C                     END
     C           XDAY1     IFGE XDAY2
      * From date2 to date1
     C                     Z-ADDXDAY2     XABEG   60
     C                     Z-ADDXDAY1     XAEND   60
     C                     ELSE
      * From date1 to date2
     C                     Z-ADDXDAY1     XABEG   60
     C                     Z-ADDXDAY2     XAEND   60
     C                     END
     C           XDWSL     IFEQ 0
      * None days of week selected
     C                     Z-ADD0         XDURR
     C                     GOTO XDUDYC
     C                     END
     C           XAEND     SUB  XABEG     XDURR   80
     C           XDWSL     IFEQ 7
      * All days of week selected
     C                     GOTO XDUDYC
     C                     END
      * Some days of week selected
     C                     DIV  7         XDURR
     C                     MVR            XDLSW   10
     C                     MULT XDWSL     XDURR
     C           XDLSW     IFNE 0
      * Determine day of week of the beginning date
     C           XABEG     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
      * Loop: Increment the date by the last week
     C           XDLSW     DOWGT0
      * Increment the day of week
     C                     ADD  1         YY
     C                     SUB  1         XDLSW
      * Put day of week into the range 1-7
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     END
      * Selected day of the last week has been processed
     C           YDOW,YY   IFEQ XDSEL
      * Increment duration
     C                     ADD  1         XDURR
     C                     END
      * End of loop
     C                     END
     C                     END
     C           XDUDYC    TAG
     C           XDURR     IFEQ 0
      * Return Code: Unable to calculate duration
     C                     MOVEL'Y2U0060' W0RTN   7
     C                     ELSE
     C                     MOVEL*BLANK    W0RTN   7
     C                     END
      *================================================================
     CSR         XDUDYE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAC0C7           Claim Number
     C                     Z-ADD*ZERO     WABIC3           Claim Company N
     C                     Z-ADD*ZERO     WAALNX           Claim Order Num
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WAC3C7           Claim Ship to C
     C                     Z-ADD*ZERO     WAAYVL           Claim Amount
     C                     Z-ADD*ZERO     WAAZVL           Claim Net Loss
     C                     Z-ADD*ZERO     WAA0VL           Claim Approved
     C                     Z-ADD*ZERO     WAA1VL           Lab Fee
     C                     Z-ADD*ZERO     WAMLDT           Resolve Claim b
     C                     Z-ADD*ZERO     WAEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WAMMDT           Claim Called in
     C                     Z-ADD*ZERO     WAMNDT           Claim Entry Dat
     C                     Z-ADD*ZERO     WABGTM           Claim Entry Tim
     C                     Z-ADD*ZERO     WAC4C7           Resale Ship to
     C                     Z-ADD*ZERO     WANFDT           Sales Approved
     C                     Z-ADD*ZERO     WABJTM           Sales Approved
     C                     Z-ADD*ZERO     WAMODT           Approved/Denied
     C                     Z-ADD*ZERO     WABHTM           Approved/Denied
     C                     Z-ADD*ZERO     WAMPDT           Memo Created Da
     C                     Z-ADD*ZERO     WABITM           Memo Created Ti
     C                     Z-ADD*ZERO     WAEOVL           Approved Net Lo
     C                     Z-ADD*ZERO     WAEPVL           Total Expense A
     C                     Z-ADD*ZERO     WAP6DT           Memo Post Date
     C                     Z-ADD*ZERO     WACRTM           Memo Post Time
     C                     Z-ADD*ZERO     WAYSNX           TFS Batch Numbe
     C                     Z-ADD*ZERO     WAF7PC           Avg TF Responsi
     C                     Z-ADD*ZERO     WAF8PC           Avg SBF Respons
     C                     Z-ADD*ZERO     WAF9PC           Unused % field
     C                     Z-ADD*ZERO     WAEQVL           AC Unused Value
     C                     Z-ADD*ZERO     WAERVL           AC Unused Value
     C                     Z-ADD*ZERO     WAESVL           AC Unused Value
     C                     Z-ADD*ZERO     WAETVL           AC Unused Value
     C                     Z-ADD*ZERO     WAGAPC           AC Unused % 1
     C                     Z-ADD*ZERO     WAGBPC           AC Unused % 2
     C                     Z-ADD*ZERO     WAMJDT           Create Date
     C                     Z-ADD*ZERO     WABETM           Create Time
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
      *
     C           W0ICL     IFEQ 'Y'
      * Initialize array variables
     C                     MOVEA*HIVAL    YK01
      * Initialize last used element number
     C                     Z-ADD0         YL01    50
     C                     Z-ADD1         Y       50
     C                     ENDIF
      *
      *
     C           W0ICL     IFEQ 'Y'
      * Initialize array variables
     C                     MOVEA*HIVAL    YK02
      * Initialize last used element number
     C                     Z-ADD0         YL02    50
     C                     ENDIF
      *
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDC0C7           Claim Number
     C                     Z-ADD*ZERO     WDAFNX           Claim Item Line
     C                     Z-ADD*ZERO     WDBIC3           Claim Company N
     C                     Z-ADD*ZERO     WDC1C7           Claim Item Code
     C                     Z-ADD*ZERO     WDDPNB           Order Sequence
     C                     Z-ADD*ZERO     WDUENB           Order Secondary
     C                     Z-ADD*ZERO     WDKUQT           Claim Item Quan
     C                     Z-ADD*ZERO     WDHHWG           Claim Item Weig
     C                     Z-ADD*ZERO     WDDIPR           Claim Item Unit
     C                     Z-ADD*ZERO     WDBNVL           Claim Item Amou
     C                     Z-ADD*ZERO     WDFXPR           Inventory Value
     C                     Z-ADD*ZERO     WDALNX           Claim Order Num
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDYTNX           Claim Memo Numb
     C                     Z-ADD*ZERO     WDFYPR           CP Unused Price
     C                     Z-ADD*ZERO     WDFZPR           CP Unused Price
     C                     Z-ADD*ZERO     WDF0PR           CP Unused Price
     C                     Z-ADD*ZERO     WDF1PR           CP Unused Price
     C                     Z-ADD*ZERO     WDF2PR           CP Unused Price
     C                     Z-ADD*ZERO     WDEUVL           CP Unused Value
     C                     Z-ADD*ZERO     WDEVVL           CP Unused Value
     C                     Z-ADD*ZERO     WDEWVL           CP Unused Value
     C                     Z-ADD*ZERO     WDEXVL           CP Unused Value
     C                     Z-ADD*ZERO     WDEYVL           CP Unused Value
     C                     Z-ADD*ZERO     WDMJDT           Create Date
     C                     Z-ADD*ZERO     WDBETM           Create Time
     C                     Z-ADD*ZERO     WDMKDT           Change Date
     C                     Z-ADD*ZERO     WDBFTM           Change Time
      * Define work field Unused Parm - CD7     USR
     C                     Z-ADD*ZERO     WUY4CD  70
      * Define work field Unused Parm - Text    USR
     C                     MOVEL*BLANK    WUOSTX 25
      * Define work field Unused Parm - Date    USR
     C                     Z-ADD*ZERO     WUMTDT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEDPNB           Order Sequence
     C                     Z-ADD*ZERO     WEUENB           Order Secondary
     C                     Z-ADD*ZERO     WEBTC7           Parent Customer
     C                     Z-ADD*ZERO     WEANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEA0DT           Order Date
     C                     Z-ADD*ZERO     WEACDT           Cancel Date
     C                     Z-ADD*ZERO     WETBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WEATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WET3NB           Attach to Order
     C                     Z-ADD*ZERO     WERSRN           Resell Referenc
     C                     Z-ADD*ZERO     WEORIT           Original Item
     C                     Z-ADD*ZERO     WEAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WED0WG           Weight Ordered
     C                     Z-ADD*ZERO     WECCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WEAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WEAKPR           Unit Price
     C                     Z-ADD*ZERO     WEAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WEA5DT           Requested Ship
     C                     Z-ADD*ZERO     WEAWDT           Invoice Date
     C                     Z-ADD*ZERO     WEHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WEAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WEAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WEAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WEAYVA           Extended Amount
     C                     Z-ADD*ZERO     WEL6NB           Contract Number
     C                     Z-ADD*ZERO     WEHCDT           LD Arrival Date
     C                     Z-ADD*ZERO     WEESNB           Accounting Year
     C                     Z-ADD*ZERO     WEETNB           Accounting Peri
     C                     Z-ADD*ZERO     WEBZNB           OM Week
     C                     Z-ADD*ZERO     WEEXQT           Quantity Billed
     C                     Z-ADD*ZERO     WEBYWG           Weight Billed
     C                     Z-ADD*ZERO     WES5NB           Shipped Item Co
     C                     Z-ADD*ZERO     WEMAVA           Billing Detail
     C                     Z-ADD*ZERO     WEKDVA           Billing Detail
     C                     Z-ADD*ZERO     WEUSVA           FOB Gross Amoun
     C                     Z-ADD*ZERO     WEUTVA           Standard Overag
     C                     Z-ADD*ZERO     WEA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WECKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WER8NB           Shipping Compan
     C                     Z-ADD*ZERO     WEBZPR           Price Overage O
     C                     Z-ADD*ZERO     WEEXDT           Market Pricing
     C                     Z-ADD*ZERO     WERGNB           Item Structure
     C                     Z-ADD*ZERO     WERHNB           Item Structure
     C                     Z-ADD*ZERO     WERINB           Item Structure
     C                     Z-ADD*ZERO     WER1NB           Rated Freight
     C                     Z-ADD*ZERO     WECONB           Invoice Number
     C                     Z-ADD*ZERO     WEGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WERMNB           Load ID
     C                     Z-ADD*ZERO     WEAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WESKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WESLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WESMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WEONVA           Actual Freight
     C                     Z-ADD*ZERO     WEB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WEB5NB           PM Line Number
     C                     Z-ADD*ZERO     WEGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WEULVA           Absorbed Freigh
     C                     Z-ADD*ZERO     WEUNVA           Ledgrd Trd Fund
     C                     Z-ADD*ZERO     WEUOVA           Commission Amou
     C                     Z-ADD*ZERO     WEUPVA           Financials Amou
     C                     Z-ADD*ZERO     WEUQVA           Financials Amou
     C                     Z-ADD*ZERO     WECFC7           Order Group Cod
     C                     Z-ADD*ZERO     WEDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WEB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WEIANX           Req Shipping Te
     C                     Z-ADD*ZERO     WEIBNX           Actual Shipping
     C                     Z-ADD*ZERO     WENYDT           Req Delivery Da
     C                     Z-ADD*ZERO     WEBZTM           Req Delivery Ti
     C                     Z-ADD*ZERO     WEZ4NB           MPC Number
     C                     Z-ADD*ZERO     WEOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WEC0C7           Claim Number
     C                     Z-ADD*ZERO     WEA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WEA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WECDPR           Market Value
     C                     Z-ADD*ZERO     WED0PR           Default Cmdty M
     C                     Z-ADD*ZERO     WED0VL           Raw Material Co
     C                     Z-ADD*ZERO     WECEVL           Sales Expense T
     C                     Z-ADD*ZERO     WEOHDT           LD Sail Date
     C                     Z-ADD*ZERO     WED9PR           NonLedgrd TrdFn
     C                     Z-ADD*ZERO     WECFVL           HST Item Target
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGC4NB           Order Number
     C                     Z-ADD*ZERO     WGANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WGBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WGB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WGA0DT           Order Date
     C                     Z-ADD*ZERO     WGA5DT           Requested Ship
     C                     Z-ADD*ZERO     WGGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WGACDT           Cancel Date
     C                     Z-ADD*ZERO     WGAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WGCXDT           Date of Origina
     C                     Z-ADD*ZERO     WGJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WGA1WG           Order Weight To
     C                     Z-ADD*ZERO     WGEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WGAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WGRMNB           Load ID
     C                     Z-ADD*ZERO     WGTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WGR1NB           Rated Freight
     C                     Z-ADD*ZERO     WGRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WGATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WGRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WGT3NB           Attach to Order
     C                     Z-ADD*ZERO     WGCONB           Invoice Number
     C                     Z-ADD*ZERO     WGAWDT           Invoice Date
     C                     Z-ADD*ZERO     WGVRVA           A/R order Value
     C                     Z-ADD*ZERO     WGB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WGNODT           OH Unused Date
     C                     Z-ADD*ZERO     WGNPDT           OH Unused Date
     C                     Z-ADD*ZERO     WGNQDT           OH Unused Date
     C                     Z-ADD*ZERO     WGNRDT           OH Unused Date
     C                     Z-ADD*ZERO     WGNSDT           OH Unused Date
     C                     Z-ADD*ZERO     WGBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WGBQTM           Time of Origina
     C                     Z-ADD*ZERO     WGBRTM           OH Unused Time
     C                     Z-ADD*ZERO     WGBSTM           OH Unused Time
     C                     Z-ADD*ZERO     WGBTTM           OH Unused Time
     C                     Z-ADD*ZERO     WGH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WGH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WGH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WGH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WGH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WGC0C7           Claim Number
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHC4NB           Order Number
     C                     Z-ADD*ZERO     WHDPNB           Order Sequence
     C                     Z-ADD*ZERO     WHUENB           Order Secondary
     C                     Z-ADD*ZERO     WHHGCD           Item Code
     C                     Z-ADD*ZERO     WHBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WHCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WHMAVA           Billing Detail
     C                     Z-ADD*ZERO     WHKDVA           Billing Detail
     C                     Z-ADD*ZERO     WHL8VA           Billing Detail
     C                     Z-ADD*ZERO     WHL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WHAYVA           Extended Amount
     C                     Z-ADD*ZERO     WHEXDT           Market Pricing
     C                     Z-ADD*ZERO     WHBZPR           Price Overage O
     C                     Z-ADD*ZERO     WHL6NB           Contract Number
     C                     Z-ADD*ZERO     WHGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WHR1NB           Rated Freight
     C                     Z-ADD*ZERO     WHAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WHD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WHCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WHAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WHCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WHATWG           Weight Shipped
     C                     Z-ADD*ZERO     WHAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WHAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WHAKPR           Unit Price
     C                     Z-ADD*ZERO     WHALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WHAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WHAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WHA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WHA5DT           Requested Ship
     C                     Z-ADD*ZERO     WHAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WHGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WHRGNB           Item Structure
     C                     Z-ADD*ZERO     WHRHNB           Item Structure
     C                     Z-ADD*ZERO     WHRINB           Item Structure
     C                     Z-ADD*ZERO     WHCXDT           Date of Origina
     C                     Z-ADD*ZERO     WHDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WHB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WHA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WHNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WHNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WHNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WHNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WHNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WHBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WHBVTM           Price Code
     C                     Z-ADD*ZERO     WHBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WHBXTM           Substitution Li
     C                     Z-ADD*ZERO     WHBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WHH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WHH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WHH7NX           OD Item Target
     C                     Z-ADD*ZERO     WHH8NX           OD Minimum Unit
     C                     Z-ADD*ZERO     WHH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WHDVPR           Order Gate Pric
     C                     Z-ADD*ZERO     WHDWPR           OD Base MKT Ovr
     C                     Z-ADD*ZERO     WHDXPR           OD Unused Prc 3
     C                     Z-ADD*ZERO     WHDYPR           OD Unused Prc 4
     C                     Z-ADD*ZERO     WHDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WHGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WHGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WHGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WHPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WHRINY           Delv Ageing Day
     C                     Z-ADD*ZERO     WHTIDT           Production Ovr
     C                     Z-ADD*ZERO     WHTJDT           Production Ovr
     C                     Z-ADD*ZERO     WHTKDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WHTLDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WHTMDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJC0C7           Claim Number
     C                     Z-ADD*ZERO     WJAANX           Claim Explanati
     C                     Z-ADD*ZERO     WJLGNY           Claim Exp Usr S
     C                     Z-ADD*ZERO     WJRRDT           Claim Expl Note
     C                     Z-ADD*ZERO     WJRSDT           Claim Expl Acti
     C                     Z-ADD*ZERO     WJC9TM           Claim Expl Acti
     C                     Z-ADD*ZERO     WJMJDT           Create Date
     C                     Z-ADD*ZERO     WJBETM           Create Time
     C                     Z-ADD*ZERO     WJMKDT           Change Date
     C                     Z-ADD*ZERO     WJBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKMJDT           Create Date
     C                     Z-ADD*ZERO     WKBETM           Create Time
     C                     Z-ADD*ZERO     WKMKDT           Change Date
     C                     Z-ADD*ZERO     WKBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLC0C7           Claim Number
     C                     Z-ADD*ZERO     WLBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WLAKNX           Resale Item Lin
     C                     Z-ADD*ZERO     WLBHC3           Resale Company
     C                     Z-ADD*ZERO     WLC5C7           Resale Item Cod
     C                     Z-ADD*ZERO     WLDPNB           Order Sequence
     C                     Z-ADD*ZERO     WLUENB           Order Secondary
     C                     Z-ADD*ZERO     WLKVQT           Resale Item Qua
     C                     Z-ADD*ZERO     WLHIWG           Resale Item Wei
     C                     Z-ADD*ZERO     WLDJPR           Resale Item Uni
     C                     Z-ADD*ZERO     WLBOVL           Resale Item Amo
     C                     Z-ADD*ZERO     WLMJDT           Create Date
     C                     Z-ADD*ZERO     WLBETM           Create Time
     C                     Z-ADD*ZERO     WLMKDT           Change Date
     C                     Z-ADD*ZERO     WLBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMINNX           Claim Number (u
     C                     Z-ADD*ZERO     WMIONX           Claim Load ID (
     C                     Z-ADD*ZERO     WMIPNX           Claim Invoice (
     C                     Z-ADD*ZERO     WMBIC3           Claim Company N
     C                     Z-ADD*ZERO     WMIQNX           Claim Order # (
     C                     Z-ADD*ZERO     WMB8VL           Claim Amount (u
     C                     Z-ADD*ZERO     WMDQVL           Claim Resale Am
     C                     Z-ADD*ZERO     WMDRVL           Claim Net Loss
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WRBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WRBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WRBUC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WRBVC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WSP3NB           D & B Number
     C                     Z-ADD*ZERO     WSI6DT           Date of D & B R
     C                     Z-ADD*ZERO     WSAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WSANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WSBTC7           Parent Customer
     C                     Z-ADD*ZERO     WSS2NB           Parent Credit L
     C                     Z-ADD*ZERO     WSVHVA           A/R Credit Limi
     C                     Z-ADD*ZERO     WSI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WTAATM           Job Time
     C                     Z-ADD*ZERO     WTAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WWIVNX           Claim Reason Co
     C                     Z-ADD*ZERO     WWB9VL           Claim Reason Co
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002  3
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0003  30
     C                     MOVEL*BLANK    WL0004  3
      * Define local variables for subroutine SIRVGN.
     C                     MOVEL*BLANK    WL0005 11
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  70
     C                     Z-ADD*ZERO     WL0008  70
     C                     MOVEL*BLANK    WL0009 30
     C                     MOVEL*BLANK    WL0010 15
     C                     MOVEL*BLANK    WL0011  3
     C                     MOVEL*BLANK    WL0012  3
     C                     Z-ADD*ZERO     WL0013  70
     C                     Z-ADD*ZERO     WL0014  70
     C                     MOVEL*BLANK    WL0015  2
     C                     Z-ADD*ZERO     WL0016  70
     C                     Z-ADD*ZERO     WL0017  70
     C                     MOVEL*BLANK    WL0018  3
      * Define local variables for subroutine SKRVGN.
     C                     MOVEL*BLANK    WL0019  3
     C                     MOVEL*BLANK    WL0020  3
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0021  30
     C                     Z-ADD*ZERO     WL0022  70
     C                     Z-ADD*ZERO     WL0023  70
     C                     MOVEL*BLANK    WL0024 30
     C                     MOVEL*BLANK    WL0025 15
     C                     Z-ADD*ZERO     WL0026  70
     C                     MOVEL*BLANK    WL0027  3
     C                     Z-ADD*ZERO     WL0028  70
     C                     Z-ADD*ZERO     WL0029  70
     C                     MOVEL*BLANK    WL0030  2
     C                     Z-ADD*ZERO     WL0031  70
     C                     MOVEL*BLANK    WL0032  3
     C                     MOVEL*BLANK    WL0033  3
      * Define local variables for subroutine SNRVGN.
     C                     MOVEL*BLANK    WL0034  3
     C                     MOVEL*BLANK    WL0035 30
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0036  70
     C                     MOVEL*BLANK    WL0037110
      * Define local variables for subroutine SPRVGN.
     C                     MOVEL*BLANK    WL0038 20
      * Define local variables for subroutine SSCRRC.
     C                     Z-ADD*ZERO     WL0039  70
     C                     MOVEL*BLANK    WL0040  1
     C                     MOVEL*BLANK    WL0041 20
     C                     MOVEL*BLANK    WL0042 11
     C                     MOVEL*BLANK    WL0043  2
     C                     Z-ADD*ZERO     WL0044  70
     C                     Z-ADD*ZERO     WL0045  70
     C                     MOVEL*BLANK    WL0046 10
     C                     Z-ADD*ZERO     WL0047  30
     C                     Z-ADD*ZERO     WL0048  70
     C                     MOVEL*BLANK    WL0049 20
     C                     MOVEL*BLANK    WL0050 10
     C                     MOVEL*BLANK    WL0051 20
     C                     MOVEL*BLANK    WL0052110
     C                     Z-ADD*ZERO     WL0053 112
     C                     Z-ADD*ZERO     WL0054 112
     C                     Z-ADD*ZERO     WL0055 112
     C                     MOVEL*BLANK    WL0056  1
     C                     MOVEL*BLANK    WL0057  3
     C                     MOVEL*BLANK    WL0058  1
     C                     MOVEL*BLANK    WL0059 25
      * Define local variables for subroutine SWRVGN.
     C                     Z-ADD*ZERO     WL0060  70
     C                     MOVEL*BLANK    WL0061 30
      * Define local work field Salesperson Name
     C                     MOVEL*BLANK    YL0001 30
      * Define null work field Claim Responsibility
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0002  1
      * Define local work field Resale Total Item Amount
     C                     Z-ADD*ZERO     YL0002 112
      * Define null work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    YN0003  1
      * Define local work field Save *Record Selected USR
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Claim Number (unpacked)
     C                     Z-ADD*ZERO     YL0004  70
      * Define local work field Claim Product/Resale Prod
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field Claim Type
     C                     MOVEL*BLANK    YL0006  2
      * Define local work field Claim Invoice (unpacked)
     C                     Z-ADD*ZERO     YL0007  70
      * Define local work field Actual Shipped Date
     C                     Z-ADD*ZERO     YL0008  70
      * Define local work field Claim Load ID (unpacked)
     C                     Z-ADD*ZERO     YL0009  70
      * Define local work field Claim Act Shp Dte (lotus)
     C                     MOVEL*BLANK    YL0010 10
      * Define local work field Claim Order # (unpacked)
     C                     Z-ADD*ZERO     YL0011  70
      * Define local work field Salesperson Name
     C                     MOVEL*BLANK    YL0012 30
      * Define local work field Claim Short Salesperson
     C                     MOVEL*BLANK    YL0013 20
      * Define local work field Claim Short Explanation
     C                     MOVEL*BLANK    YL0014110
      * Define local work field Claim Entry Date (lotus)
     C                     MOVEL*BLANK    YL0015 10
      * Define local work field Claim Called in by Desc
     C                     MOVEL*BLANK    YL0016 25
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0017  70
      * Define local work field Claim Reason Code (first)
     C                     MOVEL*BLANK    YL0018  3
      * Define local work field Claim Status
     C                     MOVEL*BLANK    YL0019  1
      * Define local work field Claim Short Customer Name
     C                     MOVEL*BLANK    YL0020 20
      * Define local work field Claim Reason Code(s)
     C                     MOVEL*BLANK    YL0021 11
      * Define local work field Claim Department Desc
     C                     MOVEL*BLANK    YL0022 20
      * Define local work field Claim Amount (unpacked)
     C                     Z-ADD*ZERO     YL0023 112
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 ** Unknown **
