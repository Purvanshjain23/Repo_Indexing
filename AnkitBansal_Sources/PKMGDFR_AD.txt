// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKMGDFR
// ?Date: 14.08.2025 Time: 02:49:58
// ?------------------------------------------------------------------------------------------------

//?USER: Initialize program

// PAR.PRT Night Queue Run Sts = CND.No
PAR.PRT_Night_Queue_Run_Sts = 'N';

//?USER: Initialize subfile control

CASE;

// IF WRK.First Time Flag Usr EQ WRK.Blank USR
IF WRK.First_Time_Flag_Usr = WRK.Blank_USR;

// *MO.VE             1183529*Bu = ilt. in functions
WRK.Display_Print_Prompt_Usr = 'Y';

// *MO.VE             1183529*Bu = ilt. in functions
WRK.First_Time_Flag_Usr = 'Y';

ENDIF;

//?USER: Process subfile control (Pre-confirm)

// *MO.VE             1183529*Bu = ilt. in functions
PGM.*Defer_confirm = 'Y';

//?Create
CASE;

// IF CTL.*CMD key is *Create
IF CTL.*CMD_key = '06';

// Call program Zzz/Edt Ofc Help Objs ER.
CALL PROGRAM(Zzz/Edt Ofc Help Objs ER) ('PKMHE1R');
PARAMETER(CTL.OFC_Program_Object);

// *MO.VE             1183529*Bu = ilt. in functions
PGM.*Reload_subfile = 'Y';

// *MO.VE             1183529*Bu = ilt. in functions
PGM.*Defer_confirm = 'N';

ENDIF;

//?F21=Print List
CASE;

// IF CTL.*CMD key is Print List
IF CTL.*CMD_key = '21';

// Call program Pmt Print Options     XF.
CALL PROGRAM(Pmt Print Options     XF) ('PDG0PVR');
PARAMETER('Print Office Help Objects');
PARAMETER(PAR.PRT_Printer_Device);
PARAMETER(PAR.PRT_Hold_Output_Sts);
PARAMETER(PAR.PRT_Save_Output_Sts);
PARAMETER(PAR.PRT_Copies);
PARAMETER(PAR.PRT_Night_Queue_Run_Sts);
PARAMETER(WRK.PRT_Night_Queue);
PARAMETER('P/S');

CASE;

// IF PGM.*Return code is *Normal
IF PGM.*Return_code = *BLANK;

// Execute command - 'SBM Prt Office Objects List'
EXECUTE COMMAND(PRK0380);
PARAMETER(PAR.PRT_Printer_Device);
PARAMETER(PAR.PRT_Hold_Output_Sts);
PARAMETER(PAR.PRT_Save_Output_Sts);
PARAMETER(PAR.PRT_Copies);
PARAMETER(PAR.PRT_Night_Queue);
PARAMETER(PAR.Oms_System_Value_Alpha);

ENDIF;

// *MO.VE             1183529*Bu = ilt. in functions
WRK.Display_Print_Prompt_Usr = 'Y';

// *MO.VE             1183529*Bu = ilt. in functions
PGM.*Reload_subfile = 'Y';

// *MO.VE             1183529*Bu = ilt. in functions
PGM.*Defer_confirm = 'N';

ENDIF;

//?USER: Process subfile record (Pre-confirm)

// *MO.VE             1183529*Bu = ilt. in functions
PGM.*Defer_confirm = 'Y';

//?Edit
CASE;

// IF RCD.*SFLSEL is *Revise request
IF RCD.*SFLSEL = '2'/'2';

// Call program Zzz/Edt Ofc Help Objs ER.
CALL PROGRAM(Zzz/Edt Ofc Help Objs ER) ('PKMHE1R');
PARAMETER(RCD.OFC_Program_Object);

// *MO.VE             1183529*Bu = ilt. in functions
PGM.*Reload_subfile = 'Y';

ENDIF;

//?Copy
CASE;

// IF RCD.*SFLSEL is *Option 3 (Reusable)
IF RCD.*SFLSEL = '3';

// Call program Zzz Object            PV.
CALL PROGRAM(Zzz Object            PV) ('PKO9PVR');
PARAMETER(RCD.OFC_Program_Object);
PARAMETER(RCD.OFC_Document);
PARAMETER(RCD.OFC_Folder);
PARAMETER(RCD.OFC_Help_Text_Label);
PARAMETER(RCD.OFC_Description);

// PGM.*Reload subfile = CND.*YES
PGM.*Reload_subfile = 'Y';

ENDIF;

//?Delete
CASE;

// IF RCD.*SFLSEL is *Delete request
IF RCD.*SFLSEL = '4'/'4';

// *MO.VE             1183529*Bu = ilt. in functions
PGM.*Defer_confirm = 'N';

ENDIF;

//?Print Doc Scrn
CASE;

// IF RCD.*SFLSEL is *Print request
IF RCD.*SFLSEL = '6'/'6';

CASE;

// IF RCD.OFC Folder is HPE
IF RCD.OFC_Folder = 'GUY.IS/DOCHPER';

// Execute command - 'ADDLIBLE HPEMDL'
EXECUTE COMMAND(PRK0599);
PARAMETER('HPEDEVGEN');

// Execute command - 'ADDLIBLE HPEMDL'
EXECUTE COMMAND(PRK0599);
PARAMETER('HPEDEVMDL');

// IF *OTHERWISE
IF *OTHERWISE;

// Execute command - 'ADDLIBLE HPEMDL'
EXECUTE COMMAND(PRK0599);
PARAMETER('OMSDEVGEN');

// Execute command - 'ADDLIBLE HPEMDL'
EXECUTE COMMAND(PRK0599);
PARAMETER('OMSDEVMDL');

ENDIF;

// WRK.@TXT 7 postions user = RCD.OFC Program Object
WRK.@TXT_7_postions_user = RCD.OFC_Program_Object;

// WRK.STDMDL OBJECT = WRK.@TXT 7 postions user
WRK.STDMDL_OBJECT = WRK.@TXT_7_postions_user;

// Call program RTV STDMDL FUNCTION.
CALL PROGRAM(RTV STDMDL FUNCTION) ('UUA1XFR');
PARAMETER(PGM.*Return_code);
PARAMETER(WRK.STDMDL_OBJECT);
PARAMETER(WRK.STDMDL_Name);
PARAMETER(WRK.STDMDL_FILE);

CASE;

// IF PGM.*Return code is *Normal
IF PGM.*Return_code = *BLANK;

//?Print Options Prompt
CASE;

// IF WRK.Display Print Prompt  Usr is Prompt is to be displayed
IF WRK.Display_Print_Prompt_Usr = 'Y';

// Call program Pmt Print Options     XF.
CALL PROGRAM(Pmt Print Options     XF) ('PDG0PVR');
PARAMETER('Print Doc Screen');
PARAMETER(PAR.PRT_Printer_Device);
PARAMETER(PAR.PRT_Hold_Output_Sts);
PARAMETER(PAR.PRT_Save_Output_Sts);
PARAMETER(PAR.PRT_Copies);
PARAMETER(PAR.PRT_Night_Queue_Run_Sts);
PARAMETER(PAR.PRT_Night_Queue);
PARAMETER('P/S');

// *MO.VE             1183529*Bu = ilt. in functions
WRK.Display_Print_Prompt_Usr = 'N';

ENDIF;

CASE;

// IF PGM.*Return code is *User QUIT requested
IF PGM.*Return_code = 'Y2U9999';

// IF *OTHERWISE
IF *OTHERWISE;

// Execute command - 'Print Doc Screen'
EXECUTE COMMAND(PRK0378);
PARAMETER(WRK.STDMDL_Name);
PARAMETER(WRK.STDMDL_FILE);
PARAMETER(PAR.PRT_Printer_Device);
PARAMETER(PAR.PRT_Hold_Output_Sts);
PARAMETER(PAR.PRT_Save_Output_Sts);
PARAMETER(PAR.PRT_Copies);
PARAMETER(PAR.PRT_Night_Queue);

// PGM.*Reload subfile = CND.*YES
PGM.*Reload_subfile = 'Y';

ENDIF;

CASE;

// IF RCD.OFC Folder is HPE
IF RCD.OFC_Folder = 'GUY.IS/DOCHPER';

// Execute command - 'RMVLIBLE &1'
EXECUTE COMMAND(PRK0956);
PARAMETER('HPEDEVGEN');

// Execute command - 'RMVLIBLE &1'
EXECUTE COMMAND(PRK0956);
PARAMETER('HPEDEVMDL');

// IF *OTHERWISE
IF *OTHERWISE;

// Execute command - 'RMVLIBLE &1'
EXECUTE COMMAND(PRK0956);
PARAMETER('OMSDEVGEN');

// Execute command - 'RMVLIBLE &1'
EXECUTE COMMAND(PRK0956);
PARAMETER('OMSDEVMDL');

ENDIF;

// IF *OTHERWISE
IF *OTHERWISE;

// Send error message - 'Function not Found'
ERROR(PRK0377);
MSGPARM(RCD.OFC_Program_Object);

ENDIF;

ENDIF;

//?USER: Final processing (Pre-confirm)

// *MO.VE             1183529*Bu = ilt. in functions
WRK.Display_Print_Prompt_Usr = 'Y';

//?USER: Process subfile record (Post-confirm)

CASE;

// IF RCD.*SFLSEL is *Delete request
IF RCD.*SFLSEL = '4'/'4';

EXECUTE FUNCTION(Dlt Office Help       DL) TYPE(DLTOBJ) FILE(PKA0REP)           AB1100556;
PARAMETER(RCD.OFC_Program_Object);

// *MO.VE             1183529*Bu = ilt. in functions
PGM.*Reload_subfile = 'Y';

ENDIF;

