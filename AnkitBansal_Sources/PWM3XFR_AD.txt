// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PWM3XFR
// ?Date: 14.08.2025 Time: 02:57:00
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(Chk Status for Unpay  RT) TYPE(RTVOBJ) FILE(PWAXCPP)           AB1366659;
PARAMETER(PAR.CC_Company_Number);
PARAMETER(PAR.TRH_Repayment_ID);
PARAMETER(PAR.Continue_Process_USR);
{
 //?USER: Initialize routine

 //?Initialize Continue Flag = Yes
 // PAR.Continue Process USR = CND.Yes
 PAR.Continue_Process_USR = 'Y';

 //?USER: Processing if Data record not found

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 // PAR.Continue Process USR = CND.No
 PAR.Continue_Process_USR = 'N';

 //?USER: Process Data record

 //?If status is other than Created or Unpaid, do not allow Unpay
 CASE;

 // IF DB1.TRD Repayment Status is Invalid for Unpay
 IF DB1.TRD_Repayment_Status = 'D'/'E'/'P'/'Q'/'X'/'I'/'R'/'T';

 // PAR.Continue Process USR = CND.No
 PAR.Continue_Process_USR = 'N';

 QUIT;

 ENDIF;

}


