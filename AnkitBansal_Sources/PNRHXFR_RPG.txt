     H/TITLE Bld Price Sheet       XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 03/28/11  Time  : 09:58:58
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPNF1REL2IF  E           K        DISK
      * RSQ : IP Comm Mkt Price Group   CMktCd/SlsTyp/CPGrp
      *
     FPNGBREL2IF  E           K        DISK
      * RSQ : IP Item Market Details    Mkt/PGrp/Itm
      *
     FPNFZREL1IF  E           K        DISK
      * RTV : IP Item Pricing Dtl       Retrieval index
      *
     FPNF3REL2IF  E           K        DISK
      * RSQ : IP Cust Item Pricing Dtl  Itm/Cust
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FPDNEREL1IF  E           K        DISK
      * RTV : Customer EXT              Retrieval index
      *
     FPMDDREL1IF  E           K        DISK
      * RTV : Sales Market              Retrieval index
      *
     FPNF4REL1IF  E           K        DISK
      * RTV : IP Cust Pricing Dtl       Retrieval index
      *
     FPNF5CPL2IF  E           K        DISK
      * RSQ : IP Cust Item Price        ShpTo/Mkt/Itm/PDte(d)
      *
     FPNF5CPL1IF  E           K        DISK
      * RTV : IP Cust Item Price        Retrieval index
      *
     FPNF5CPL0UF  E           K        DISK                      A
      * UPD : IP Cust Item Price        Update index
      *
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     I@F1REF0
      * IP Comm Mkt Price Group   CMktCd/SlsTyp/CPGrp
      * Renamed input format fields
     I              F1LQCD                          WALQCD
     I              F1LRCD                          WALRCD
     I              F1KZCD                          WAKZCD
     I              F1VSST                          WAVSST
     I              F1MJDT                          WAMJDT
     I              F1BETM                          WABETM
     I              F1CCVN                          WACCVN
     I              F1CDVN                          WACDVN
     I              F1MKDT                          WAMKDT
     I              F1BFTM                          WABFTM
     I              F1CEVN                          WACEVN
     I              F1CFVN                          WACFVN
      *
     I@GBREIE
      * IP Item Market Details    Mkt/PGrp/Itm
      * Renamed input format fields
     I              GBHGCD                          WBHGCD
     I              GBLQCD                          WBLQCD
     I              GBLRCD                          WBLRCD
     I              GBG2PC                          WBG2PC
     I              GBG8PR                          WBG8PR
     I              GBVSST                          WBVSST
     I              GBMJDT                          WBMJDT
     I              GBBETM                          WBBETM
     I              GBCCVN                          WBCCVN
     I              GBCDVN                          WBCDVN
     I              GBMKDT                          WBMKDT
     I              GBBFTM                          WBBFTM
     I              GBCEVN                          WBCEVN
     I              GBCFVN                          WBCFVN
      *
     I@FZREE4
      * IP Item Pricing Dtl       Retrieval index
      * Renamed input format fields
     I              FZHGCD                          WCHGCD
     I              FZILST                          WCILST
     I              FZMGAA                          WCMGAA
     I              FZVSST                          WCVSST
     I              FZMJDT                          WCMJDT
     I              FZBETM                          WCBETM
     I              FZCCVN                          WCCCVN
     I              FZCDVN                          WCCDVN
     I              FZMKDT                          WCMKDT
     I              FZBFTM                          WCBFTM
     I              FZCEVN                          WCCEVN
     I              FZCFVN                          WCCFVN
      *
     I@F3REGF
      * IP Cust Item Pricing Dtl  Itm/Cust
      * Renamed input format fields
     I              F3BKC7                          WDBKC7
     I              F3HGCD                          WDHGCD
     I              F3ILST                          WDILST
     I              F3INST                          WDINST
     I              F3MMAA                          WDMMAA
     I              F3MKAA                          WDMKAA
     I              F3MLAA                          WDMLAA
     I              F3CYC3                          WDCYC3
     I              F3VSST                          WDVSST
     I              F3MJDT                          WDMJDT
     I              F3BETM                          WDBETM
     I              F3CCVN                          WDCCVN
     I              F3CDVN                          WDCDVN
     I              F3MKDT                          WDMKDT
     I              F3BFTM                          WDBFTM
     I              F3CEVN                          WDCEVN
     I              F3CFVN                          WDCFVN
      *
     I@DRRETH
      * User Profile Control      Retrieval index       NV
      * Renamed input format fields
     I              DRAJVN                          WEAJVN
     I              DRAUNA                          WEAUNA
     I              DRB8NA                          WEB8NA
     I              DRAHVN                          WEAHVN
     I              DRI6ST                          WEI6ST
     I              DRI7ST                          WEI7ST
     I              DRXMST                          WEXMST
     I              DRXNST                          WEXNST
     I              DRI8ST                          WEI8ST
     I              DRNLNB                          WENLNB
     I              DRMPNA                          WEMPNA
     I              DRBCCD                          WEBCCD
     I              DRAIC3                          WEAIC3
     I              DRDQCD                          WEDQCD
     I              DRDRCD                          WEDRCD
     I              DRAJCD                          WEAJCD
     I              DRBUVN                          WEBUVN
     I              DRUVST                          WEUVST
     I              DRUWST                          WEUWST
     I              DRUXST                          WEUXST
     I              DRAATM                          WEAATM
     I              DRAYNA                          WEAYNA
     I              DRA0NA                          WEA0NA
     I              DRAXDT                          WEAXDT
      *
     I@DTRETE
      * User Application Profile  Retrieval index       NV
      * Renamed input format fields
     I              DTAJVN                          WFAJVN
     I              DTDNCD                          WFDNCD
     I              DTAIC3                          WFAIC3
     I              DTDQCD                          WFDQCD
     I              DTDRCD                          WFDRCD
     I              DTAJCD                          WFAJCD
     I              DTJFST                          WFJFST
     I              DTUVST                          WFUVST
     I              DTUWST                          WFUWST
     I              DTUXST                          WFUXST
     I              DTAATM                          WFAATM
     I              DTAYNA                          WFAYNA
     I              DTA0NA                          WFA0NA
     I              DTAXDT                          WFAXDT
      *
     I@EOREXM
      * Company Customer          Retrieval index
      * Renamed input format fields
     I              EOAIC3                          WGAIC3
     I              EOBKC7                          WGBKC7
     I              EOAQCD                          WGAQCD
     I              EOR4CD                          WGR4CD
     I              EOBYNA                          WGBYNA
     I              EOB6NA                          WGB6NA
     I              EOBZNA                          WGBZNA
     I              EOLLST                          WGLLST
     I              EOPPST                          WGPPST
     I              EOR5NB                          WGR5NB
     I              EOR6NB                          WGR6NB
     I              EOQGST                          WGQGST
     I              EOBOCD                          WGBOCD
     I              EOTBNB                          WGTBNB
     I              EOMTCU                          WGMTCU
     I              EOW2NB                          WGW2NB
     I              EORPCD                          WGRPCD
     I              EOAJCD                          WGAJCD
     I              EOX9ST                          WGX9ST
     I              EOT9CD                          WGT9CD
     I              EOUBCD                          WGUBCD
     I              EOISTX                          WGISTX
     I              EOLQCD                          WGLQCD
     I              EONJNA                          WGNJNA
     I              EOI0TX                          WGI0TX
     I              EONKNA                          WGNKNA
     I              EOI1TX                          WGI1TX
     I              EOVLST                          WGVLST
     I              EORLST                          WGRLST
     I              EOMMTX                          WGMMTX
     I              EOOHNA                          WGOHNA
     I              EOQ6ST                          WGQ6ST
     I              EOQ8ST                          WGQ8ST
     I              EORBST                          WGRBST
     I              EOREST                          WGREST
     I              EOUVST                          WGUVST
     I              EOUWST                          WGUWST
     I              EOUXST                          WGUXST
     I              EOVSST                          WGVSST
     I              EOAATM                          WGAATM
     I              EOAYNA                          WGAYNA
     I              EOA0NA                          WGA0NA
     I              EOAXDT                          WGAXDT
      *
     I@NEREAT
      * Customer EXT              Retrieval index
      * Renamed input format fields
     I              NEBKC7                          WHBKC7
     I              NEUFTX                          WHUFTX
     I              NEUGTX                          WHUGTX
     I              NEPFNA                          WHPFNA
     I              NEJ5NX                          WHJ5NX
     I              NEU5TX                          WHU5TX
     I              NEU6TX                          WHU6TX
     I              NEW0TX                          WHW0TX
     I              NEHSSX                          WHHSSX
     I              NEHUSX                          WHHUSX
     I              NEHVSX                          WHHVSX
     I              NEAAC8                          WHAAC8
     I              NEP0SX                          WHP0SX
     I              NEP1SX                          WHP1SX
     I              NEP2SX                          WHP2SX
     I              NEP3SX                          WHP3SX
     I              NEP4SX                          WHP4SX
     I              NEP5SX                          WHP5SX
     I              NEP6SX                          WHP6SX
     I              NEUVST                          WHUVST
     I              NEUWST                          WHUWST
     I              NEUXST                          WHUXST
     I              NEVSST                          WHVSST
     I              NEAATM                          WHAATM
     I              NEAYNA                          WHAYNA
     I              NEA0NA                          WHA0NA
     I              NEAXDT                          WHAXDT
      *
     I@DDREQI
      * Sales Market              Retrieval index
      * Renamed input format fields
     I              DDISAA                          WIISAA
     I              DDR3NA                          WIR3NA
     I              DDRSTY                          WIRSTY
     I              DDHHAA                          WIHHAA
     I              DDBCCD                          WIBCCD
     I              DDITAA                          WIITAA
     I              DDKBAA                          WIKBAA
     I              DDVSST                          WIVSST
     I              DDMJDT                          WIMJDT
     I              DDBETM                          WIBETM
     I              DDCCVN                          WICCVN
     I              DDCDVN                          WICDVN
     I              DDMKDT                          WIMKDT
     I              DDBFTM                          WIBFTM
     I              DDCEVN                          WICEVN
     I              DDCFVN                          WICFVN
      *
     I@F4REFS
      * IP Cust Pricing Dtl       Retrieval index
      * Renamed input format fields
     I              F4BKC7                          WJBKC7
     I              F4MMAA                          WJMMAA
     I              F4MKAA                          WJMKAA
     I              F4MLAA                          WJMLAA
     I              F4CXC3                          WJCXC3
     I              F4LQST                          WJLQST
     I              F4ALCD                          WJALCD
     I              F4NAAA                          WJNAAA
     I              F4VSST                          WJVSST
     I              F4MJDT                          WJMJDT
     I              F4BETM                          WJBETM
     I              F4CCVN                          WJCCVN
     I              F4CDVN                          WJCDVN
     I              F4MKDT                          WJMKDT
     I              F4BFTM                          WJBFTM
     I              F4CEVN                          WJCEVN
     I              F4CFVN                          WJCFVN
      *
     I@F5CPFV
      * IP Cust Item Price        ShpTo/Mkt/Itm/PDte(d)
      * Renamed input format fields
     I              F5BKC7                          WKBKC7
     I              F5LQCD                          WKLQCD
     I              F5HGCD                          WKHGCD
     I              F5TPDT                          WKTPDT
     I              F5GXPR                          WKGXPR
     I              F5HCPR                          WKHCPR
     I              F5K2ST                          WKK2ST
     I              F5KZCD                          WKKZCD
     I              F5R4CD                          WKR4CD
     I              F5HHAA                          WKHHAA
     I              F5ALCD                          WKALCD
     I              F5LRCD                          WKLRCD
     I              F5I9ST                          WKI9ST
     I              F5JBST                          WKJBST
     I              F5VSST                          WKVSST
     I              F5MJDT                          WKMJDT
     I              F5BETM                          WKBETM
     I              F5CCVN                          WKCCVN
     I              F5CDVN                          WKCDVN
     I              F5MKDT                          WKMKDT
     I              F5BFTM                          WKBFTM
     I              F5CEVN                          WKCEVN
     I              F5CFVN                          WKCFVN
      *
     I@F5CPFJ
      * IP Cust Item Price        Retrieval index
      * Renamed input format fields
     I              F5BKC7                          WLBKC7
     I              F5LQCD                          WLLQCD
     I              F5HGCD                          WLHGCD
     I              F5TPDT                          WLTPDT
     I              F5GXPR                          WLGXPR
     I              F5HCPR                          WLHCPR
     I              F5K2ST                          WLK2ST
     I              F5KZCD                          WLKZCD
     I              F5R4CD                          WLR4CD
     I              F5HHAA                          WLHHAA
     I              F5ALCD                          WLALCD
     I              F5LRCD                          WLLRCD
     I              F5I9ST                          WLI9ST
     I              F5JBST                          WLJBST
     I              F5VSST                          WLVSST
     I              F5MJDT                          WLMJDT
     I              F5BETM                          WLBETM
     I              F5CCVN                          WLCCVN
     I              F5CDVN                          WLCDVN
     I              F5MKDT                          WLMKDT
     I              F5BFTM                          WLBFTM
     I              F5CEVN                          WLCEVN
     I              F5CFVN                          WLCFVN
      *
     I@F5CPFI
      * IP Cust Item Price        Update index
      * Renamed input format fields
     I              F5BKC7                          WMBKC7
     I              F5LQCD                          WMLQCD
     I              F5HGCD                          WMHGCD
     I              F5TPDT                          WMTPDT
     I              F5GXPR                          WMGXPR
     I              F5HCPR                          WMHCPR
     I              F5K2ST                          WMK2ST
     I              F5KZCD                          WMKZCD
     I              F5R4CD                          WMR4CD
     I              F5HHAA                          WMHHAA
     I              F5ALCD                          WMALCD
     I              F5LRCD                          WMLRCD
     I              F5I9ST                          WMI9ST
     I              F5JBST                          WMJBST
     I              F5VSST                          WMVSST
     I              F5MJDT                          WMMJDT
     I              F5BETM                          WMBETM
     I              F5CCVN                          WMCCVN
     I              F5CDVN                          WMCDVN
     I              F5MKDT                          WMMKDT
     I              F5BFTM                          WMBFTM
     I              F5CEVN                          WMCEVN
     I              F5CFVN                          WMCFVN
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPNF51    E DSPNF5CPL0
      * UPD : IP Cust Item Price        Update index
      * Renamed input format fields
     I              F5BKC7                          WMBKC7
     I              F5LQCD                          WMLQCD
     I              F5HGCD                          WMHGCD
     I              F5TPDT                          WMTPDT
     I              F5GXPR                          WMGXPR
     I              F5HCPR                          WMHCPR
     I              F5K2ST                          WMK2ST
     I              F5KZCD                          WMKZCD
     I              F5R4CD                          WMR4CD
     I              F5HHAA                          WMHHAA
     I              F5ALCD                          WMALCD
     I              F5LRCD                          WMLRCD
     I              F5I9ST                          WMI9ST
     I              F5JBST                          WMJBST
     I              F5VSST                          WMVSST
     I              F5MJDT                          WMMJDT
     I              F5BETM                          WMBETM
     I              F5CCVN                          WMCCVN
     I              F5CDVN                          WMCDVN
     I              F5MKDT                          WMMKDT
     I              F5BFTM                          WMBFTM
     I              F5CEVN                          WMCEVN
     I              F5CFVN                          WMCFVN
      *
     IYARDCS      DS                            114
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: IP Comm Mkt Price Group
      * I :  Commodity Market Code
     I                                        1   3 P1LQCD
      * I :  Sales Type Code
     I                                        4   6 P1KZCD
     IP2PARM      DS
      * I :  CIP Price Date
     I                                    P   1   40P2TPDT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1LQCD    PARM           WP0001  3        Commodity Marke
     C           P1KZCD    PARM           WP0002  3        Sales Type Code
     C           P2TPDT    PARM           WP0003  70       CIP Price Date
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Bld Price Sheet       XF
      * Bld Price Sheet       RT - IP Comm Mkt Price Group  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Bld Price Sheet       RT - IP Comm Mkt Price Group  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WALQCD    WQSA01           Commodity Marke
     C           *LIKE     DEFN WAKZCD    WQSA02           Sales Type Code
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Commodity Marke
     C                     KFLD           WQSA02           Sales Type Code
      * Setup key
     C                     MOVELP1LQCD    WQSA01           Commodity Marke
     C                     MOVELP1KZCD    WQSA02           Sales Type Code
      * Establish starting position
     C           KRSSA     SETLL@F1REF0                    *
     C           KRSSA     READE@F1REF0                  90*
      * Data record not found
     C   90                MOVEL'USR4277' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Bld Price Sheet       RT - IP Item Market Details  * 
     C                     EXSR SBRVGN
     C           KRSSA     READE@F1REF0                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Bld Price Sheet       RT - IP Item Market Details  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBLQCD    WQSB01           Commodity Marke
     C           *LIKE     DEFN WBLRCD    WQSB02           Commodity Price
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Commodity Marke
     C                     KFLD           WQSB02           Commodity Price
      * Setup key
     C                     MOVELWALQCD    WQSB01           Commodity Marke
     C                     MOVELWALRCD    WQSB02           Commodity Price
      * Establish starting position
     C           KRSSB     SETLL@GBREIE                    *
     C           KRSSB     READE@GBREIE                  90*
      * Data record not found
     C   90                MOVEL'USR4314' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV IP Item Prcing Dt RT - IP Item Pricing Dtl  * 
     C                     EXSR SCRVGN
      * Bld Price Sheet       RT - IP Cust Item Pricing Dtl  * 
     C                     EXSR SDRVGN
     C           KRSSB     READE@GBREIE                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV IP Item Prcing Dt RT - IP Item Pricing Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCHGCD           Item Code
      * Setup key
     C                     Z-ADDWBHGCD    WCHGCD           Item Code
      * Establish starting position
     C           KRSSC     CHAIN@FZREE4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4273' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCMGAA    YL0001           IPD Price Sheet
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Bld Price Sheet       RT - IP Cust Item Pricing Dtl  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        CIP Item Price
     C                     MOVEL*BLANK    WN0002  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0003  6        Broker Code
     C                     MOVEL*BLANK    WN0004  3        Buyer Code
     C                     MOVEL*BLANK    WN0005  1        CIP Error Sts
     C                     MOVEL*BLANK    WN0006  6        CIP Error Reaso
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      *
     C                     MOVEL*BLANK    WN0007 10        User Code Model
      *
      * RTV Default Co No App IF
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SERVGN
      * CASE: LCL.Company Number is Equal to zero
     C           YL0003    IFEQ *ZERO                      *IF
      * CASE: PAR.User Code Model is equal to blank
     C           WN0007    IFEQ *BLANK                     *IF
      * RTV First Default Co  RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL##USR     WL0001    P      User Profile Na
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    YL0002           Company Number
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV First Default Co  RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0007    WL0001    P      User Profile Na
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    YL0002           Company Number
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0003    YL0002           Company Number
     C                     END                             *FI
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHGCD    WQSD01           Item Code
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Item Code
      * Setup key
     C                     Z-ADDWBHGCD    WQSD01           Item Code
      * Establish starting position
     C           KRSSD     SETLL@F3REGF                    *
     C           KRSSD     READE@F3REGF                  90*
      * Data record not found
     C   90                MOVEL'USR4281' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    YL0004           Error Status
      * CLC Price Item         XF - Price Method Header  * 
     C                     CALL 'PDG9XFR'              90  CLC Price Item
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0002    WQ0001  30       Company Number
     C                     PARM YL0001    WQ0002  3        Price Method Co
     C                     PARM WDBKC7    WQ0003  70       Ship To Custome
     C                     PARM P2TPDT    WQ0004  70       Actual Shipped
     C                     PARM YL0005    WQ0005  2        U/M - Ordered
     C                     PARM YL0006    WQ0006 112       Quantity Ordere
     C                     PARM P2TPDT    WQ0007  70       Requested Ship
     C           YL0007    PARM YL0007    WQ0008 114       Unit Price
     C           YL0008    PARM YL0008    WQ0009 114       Unit Price Orde
     C                     PARM WDHGCD    WQ0010  70       Item Code
     C                     PARM P2TPDT    WQ0011  70       Date of Orig. E
     C                     PARM WBLQCD    WQ0012  3        Commodity Marke
     C                     PARM P2TPDT    WQ0013  70       Market Pricing
     C           YL0009    PARM YL0009    WQ0014  1        Price Status
     C                     PARM *BLANK    WQ0015  3        Date Method Cod
     C                     PARM *ZERO     WQ0016 114       Price Overage O
     C           YL0010    PARM YL0010    WQ0017  70       Pricing Date Us
     C                     PARM '99'      WQ0018  2        Event Called Fr
     C                     PARM *ZERO     WQ0019 114       OD Ceiling Pric
     C                     PARM *ZERO     WQ0020  70       OD Market Begin
     C                     PARM *ZERO     WQ0021  70       OD Market Endin
     C                     PARM *ZERO     WQ0022  70       Order Number
     C                     PARM P2TPDT    WQ0023  70       Requested Deliv
     C                     PARM *ZERO     WQ0024  30       Order Sequence
     C                     PARM *ZERO     WQ0025  30       Order Secondary
     C           YL0011    PARM YL0011    WQ0026  5        Error Return
     C                     PARM 'S'       WQ0027  1        Price Type Stat
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDG9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.CIP Price Date NE LCL.Pricing Date Used
     C           P2TPDT    IFNE YL0010                     *IF
     C                     MOVEL'E'       WN0005           CIP Error Sts
     C                     MOVEL@CN,002   WN0006           CIP Error Reaso
     C                     END                             *FI
      * RTV Sales Route        RT - Company Customer  * 
     C                     EXSR SGRVGN
      * Rtv Cust Mkt Broker   RT - Customer EXT  * 
     C                     EXSR SHRVGN
      * Rtv Buyer Code        RT - IP Cust Pricing Dtl  * 
     C                     EXSR SJRVGN
      * Rtv Prior Day Price   RT - IP Cust Item Price  * 
     C                     EXSR SKRVGN
      * PAR.CIP Item Price Chg Sts
      * CASE: LCL.Unit Price NE LCL.CIP Item Price
     C           YL0007    IFNE YL0013                     *IF
     C                     MOVEL'Y'       WN0001           CIP Item Price
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WN0001           CIP Item Price
     C                     END                             *FI
      * Upd Cust Item Price   RT - IP Cust Item Price  * 
     C                     EXSR SLRVGN
     C           KRSSD     READE@F3REGF                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEAJVN           User Profile Na
      * Setup key
     C                     MOVEL##USR     WEAJVN           User Profile Na
      * Establish starting position
     C           KRSSE     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,001   W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEAIC3    YL0003           Company Number
     C                     MOVELWEBUVN    WN0007           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV First Default Co  RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAJVN    WQSF01           User Profile Na
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           User Profile Na
      * Setup key
     C                     MOVELWL0001    WQSF01           User Profile Na
      * Establish starting position
     C           KRSSF     SETLL@DTRETE                    *
     C           KRSSF     READE@DTRETE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0767' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0002           Company Number
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFAIC3    WL0002           Company Number
     C                     GOTO SFEXIT                     *QUIT
     C           KRSSF     READE@DTRETE                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Sales Route        RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDYL0002    WGAIC3           Company Number
     C                     Z-ADDWDBKC7    WGBKC7           Ship To Custome
      * Establish starting position
     C           KRSSG     CHAIN@EOREXM              90    *
      * Data record not found
     C   90                MOVEL'USR1007' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGR4CD    WN0002           Sales Route Cod
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Cust Mkt Broker   RT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WHBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWDBKC7    WHBKC7           Ship To Custome
      * Establish starting position
     C           KRSSH     CHAIN@NEREAT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0012           Customer Market
     C                     MOVEL*BLANK    WN0003           Broker Code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHP6SX    YL0012           Customer Market
      * Rtv All values        RT - Sales Market  * 
     C                     EXSR SIRVGN
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv All values        RT - Sales Market  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WIISAA           Market Code
      * Setup key
     C                     MOVELWHP6SX    WIISAA           Market Code
      * Establish starting position
     C           KRSSI     CHAIN@DDREQI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3863' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0003           Broker Code
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIHHAA    WN0003           Broker Code
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Buyer Code        RT - IP Cust Pricing Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WJBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWDBKC7    WJBKC7           Ship To Custome
      * Establish starting position
     C           KRSSJ     CHAIN@F4REFS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4283' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0004           Buyer Code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJALCD    WN0004           Buyer Code
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Prior Day Price   RT - IP Cust Item Price  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKBKC7    WQSK01           Ship To Custome
     C           *LIKE     DEFN WKLQCD    WQSK02           Commodity Marke
     C           *LIKE     DEFN WKHGCD    WQSK03           Item Code
      * Define keylist
     C           KPSSK     KLIST
     C                     KFLD           WQSK01           Ship To Custome
     C                     KFLD           WQSK02           Commodity Marke
     C                     KFLD           WQSK03           Item Code
     C                     KFLD           WKTPDT           CIP Price Date
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Ship To Custome
     C                     KFLD           WQSK02           Commodity Marke
     C                     KFLD           WQSK03           Item Code
      * Setup key
     C                     Z-ADDWDBKC7    WQSK01           Ship To Custome
     C                     MOVEL'SBD'     WQSK02           Commodity Marke
     C                     Z-ADDWDHGCD    WQSK03           Item Code
     C                     Z-ADDP2TPDT    WKTPDT           CIP Price Date
      * Establish starting position
     C           KPSSK     SETLL@F5CPFV                    *
     C           KRSSK     READE@F5CPFV                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4285' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,001   W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0013           CIP Item Price
     C                     Z-ADD*ZERO     YL0014           USR Date Priced
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.CIP Price Date EQ PAR.CIP Price Date
     C           WKTPDT    IFEQ P2TPDT                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.CIP Item Price Override is Not Zeros
     C           WKHCPR    IFNE *ZERO                      *IF
     C                     Z-ADDWKHCPR    YL0013           CIP Item Price
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWKGXPR    YL0013           CIP Item Price
     C                     END                             *FI
     C                     Z-ADDWKTPDT    YL0014           USR Date Priced
     C                     GOTO SKEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSK     READE@F5CPFV                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Upd Cust Item Price   RT - IP Cust Item Price  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0008 114       CIP Item Price
     C                     MOVEL*BLANK    WN0009  1        Record Status
     C                     Z-ADD*ZERO     WN0010  70       Create Date
     C                     Z-ADD*ZERO     WN0011  60       Create Time
     C                     MOVEL*BLANK    WN0012 10        Create User
     C                     MOVEL*BLANK    WN0013 10        Create Program
     C                     Z-ADD*ZERO     WN0014  70       Change Date
     C                     Z-ADD*ZERO     WN0015  60       Change Time
     C                     MOVEL*BLANK    WN0016 10        Change User
     C                     MOVEL*BLANK    WN0017 10        Change Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WLBKC7           Ship To Custome
     C                     KFLD           WLLQCD           Commodity Marke
     C                     KFLD           WLHGCD           Item Code
     C                     KFLD           WLTPDT           CIP Price Date
      * Setup key
     C                     Z-ADDWDBKC7    WLBKC7           Ship To Custome
     C                     MOVELWBLQCD    WLLQCD           Commodity Marke
     C                     Z-ADDWDHGCD    WLHGCD           Item Code
     C                     Z-ADDP2TPDT    WLTPDT           CIP Price Date
      * Establish starting position
     C           KRSSL     CHAIN@F5CPFJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4285' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Cust Item Price   CR - IP Cust Item Price  * 
     C                     EXSR SMCRRC
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Cust Item Price   CH - IP Cust Item Price  * 
     C                     EXSR SNCHRC
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCRRC    BEGSR
      *================================================================
      * Crt Cust Item Price   CR - IP Cust Item Price  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @F5CPFI
     C                     Z-ADDWDBKC7    WMBKC7           Ship To Custome
     C                     MOVELWBLQCD    WMLQCD           Commodity Marke
     C                     Z-ADDWDHGCD    WMHGCD           Item Code
     C                     Z-ADDP2TPDT    WMTPDT           CIP Price Date
     C                     Z-ADDYL0007    WMGXPR           CIP Item Price
     C                     Z-ADDWN0008    WMHCPR           CIP Item Price
     C                     MOVELWN0001    WMK2ST           CIP Item Price
     C                     MOVELWAKZCD    WMKZCD           Sales Type Code
     C                     MOVELWN0002    WMR4CD           Sales Route Cod
     C                     MOVELWN0003    WMHHAA           Broker Code
     C                     MOVELWN0004    WMALCD           Buyer Code
     C                     MOVELWBLRCD    WMLRCD           Commodity Price
     C                     MOVELWN0005    WMI9ST           CIP Error Sts
     C                     MOVELWN0006    WMJBST           CIP Error Reaso
     C                     MOVELWN0009    WMVSST           Record Status
     C                     Z-ADDWN0010    WMMJDT           Create Date
     C                     Z-ADDWN0011    WMBETM           Create Time
     C                     MOVELWN0012    WMCCVN           Create User
     C                     MOVELWN0013    WMCDVN           Create Program
     C                     Z-ADDWN0014    WMMKDT           Change Date
     C                     Z-ADDWN0015    WMBFTM           Change Time
     C                     MOVELWN0016    WMCEVN           Change User
     C                     MOVELWN0017    WMCFVN           Change Program
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WMVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WMMJDT           Create Date
     C                     Z-ADD##JTM     WMBETM           Create Time
     C                     MOVEL##USR     WMCCVN           Create User
     C                     MOVEL##PGM     WMCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD*ZERO     WMMKDT           Change Date
     C                     Z-ADD*ZERO     WMBFTM           Change Time
     C                     MOVEL*BLANK    WMCEVN           Change User
     C                     MOVEL*BLANK    WMCFVN           Change Program
     C           KLCRSM    KLIST
     C                     KFLD           WMBKC7           Ship To Custome
     C                     KFLD           WMLQCD           Commodity Marke
     C                     KFLD           WMHGCD           Item Code
     C                     KFLD           WMTPDT           CIP Price Date
      * Check for duplicate primary key
     C           KLCRSM    SETLL@F5CPFI                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR4286' W0RTN   7
      * Send message 'IP Cust Item Price     EX'
     C                     MOVEL'USR4286' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C                     WRITE@F5CPFI                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCHRC    BEGSR
      *================================================================
      * Chg Cust Item Price   CH - IP Cust Item Price  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0018 114       CIP Item Price
     C                     MOVEL*BLANK    WN0019  1        Record Status
     C                     Z-ADD*ZERO     WN0020  70       Create Date
     C                     Z-ADD*ZERO     WN0021  60       Create Time
     C                     MOVEL*BLANK    WN0022 10        Create User
     C                     MOVEL*BLANK    WN0023 10        Create Program
     C                     Z-ADD*ZERO     WN0024  70       Change Date
     C                     Z-ADD*ZERO     WN0025  60       Change Time
     C                     MOVEL*BLANK    WN0026 10        Change User
     C                     MOVEL*BLANK    WN0027 10        Change Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @F5CPFI
     C                     Z-ADDWLBKC7    WMBKC7           Ship To Custome
     C                     MOVELWLLQCD    WMLQCD    P      Commodity Marke
     C                     Z-ADDWLHGCD    WMHGCD           Item Code
     C                     Z-ADDWLTPDT    WMTPDT           CIP Price Date
      *
     C           KLCHSN    KLIST
     C                     KFLD           WMBKC7           Ship To Custome
     C                     KFLD           WMLQCD           Commodity Marke
     C                     KFLD           WMHGCD           Item Code
     C                     KFLD           WMTPDT           CIP Price Date
     C           KLCHSN    CHAIN@F5CPFI              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PNF5CPL0'MDACP
     C                     MOVEL'@F5CPFI' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPNF51    YARDCS
      * Move non-key fields to @F5CPFI
     C                     Z-ADDYL0007    WMGXPR           CIP Item Price
     C                     MOVELWN0001    WMK2ST    P      CIP Item Price
     C                     MOVELWLKZCD    WMKZCD    P      Sales Type Code
     C                     MOVELWN0002    WMR4CD    P      Sales Route Cod
     C                     MOVELWN0003    WMHHAA    P      Broker Code
     C                     MOVELWN0004    WMALCD    P      Buyer Code
     C                     MOVELWBLRCD    WMLRCD    P      Commodity Price
     C                     MOVELWN0005    WMI9ST    P      CIP Error Sts
     C                     MOVELWN0006    WMJBST    P      CIP Error Reaso
      *
      * Set PGM.*Record Data Changed flag
     C           QPNF51    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Chg Date/Time      IF
     C                     Z-ADD##JDT     WMMKDT           Change Date
     C                     Z-ADD##JTM     WMBFTM           Change Time
     C                     MOVEL##USR     WMCEVN           Change User
     C                     MOVEL##PGM     WMCFVN           Change Program
      * Set PGM.*Record Data Changed flag
     C           QPNF51    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@F5CPFI                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPNF5CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAMJDT           Create Date
     C                     Z-ADD*ZERO     WABETM           Create Time
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBG2PC           Market Percent
     C                     Z-ADD*ZERO     WBG8PR           Market Prem/Ded
     C                     Z-ADD*ZERO     WBMJDT           Create Date
     C                     Z-ADD*ZERO     WBBETM           Create Time
     C                     Z-ADD*ZERO     WBMKDT           Change Date
     C                     Z-ADD*ZERO     WBBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCMJDT           Create Date
     C                     Z-ADD*ZERO     WCBETM           Create Time
     C                     Z-ADD*ZERO     WCMKDT           Change Date
     C                     Z-ADD*ZERO     WCBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDCYC3           CIPD Unused Nbr
     C                     Z-ADD*ZERO     WDMJDT           Create Date
     C                     Z-ADD*ZERO     WDBETM           Create Time
     C                     Z-ADD*ZERO     WDMKDT           Change Date
     C                     Z-ADD*ZERO     WDBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WENLNB           Entity Number
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WGR5NB           Deliver after t
     C                     Z-ADD*ZERO     WGR6NB           Deliver before
     C                     Z-ADD*ZERO     WGTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WGMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WGW2NB           Co/Cust Overage
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WHAAC8           Customer G/L Ve
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIMJDT           Create Date
     C                     Z-ADD*ZERO     WIBETM           Create Time
     C                     Z-ADD*ZERO     WIMKDT           Change Date
     C                     Z-ADD*ZERO     WIBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WJCXC3           TP Sales Compan
     C                     Z-ADD*ZERO     WJMJDT           Create Date
     C                     Z-ADD*ZERO     WJBETM           Create Time
     C                     Z-ADD*ZERO     WJMKDT           Change Date
     C                     Z-ADD*ZERO     WJBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WKHGCD           Item Code
     C                     Z-ADD*ZERO     WKTPDT           CIP Price Date
     C                     Z-ADD*ZERO     WKGXPR           CIP Item Price
     C                     Z-ADD*ZERO     WKHCPR           CIP Item Price
     C                     Z-ADD*ZERO     WKMJDT           Create Date
     C                     Z-ADD*ZERO     WKBETM           Create Time
     C                     Z-ADD*ZERO     WKMKDT           Change Date
     C                     Z-ADD*ZERO     WKBFTM           Change Time
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SFRVGN.
     C                     MOVEL*BLANK    WL0001 10
     C                     Z-ADD*ZERO     WL0002  30
      * Define null work field Price Sheet Item Sts
     C                     MOVEL*BLANK    YN0001  1
      * Define local work field IPD Price Sheet Price Mth
     C                     MOVEL*BLANK    YL0001  3
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0002  30
      * Define null work field Allow Multi-Company
     C                     MOVEL*BLANK    YN0002  1
      * Define null work field Default Printer
     C                     MOVEL*BLANK    YN0003 10
      * Define null work field Salesperson Code
     C                     MOVEL*BLANK    YN0004  3
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0003  30
      * Define local work field Error Status
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field U/M - Ordered
     C                     MOVEL*BLANK    YL0005  2
      * Define local work field Quantity Ordered
     C                     Z-ADD*ZERO     YL0006 112
      * Define local work field Unit Price
     C                     Z-ADD*ZERO     YL0007 114
      * Define local work field Unit Price Ordered U/M
     C                     Z-ADD*ZERO     YL0008 114
      * Define local work field Price Status
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field Pricing Date Used
     C                     Z-ADD*ZERO     YL0010  70
      * Define local work field Error Return
     C                     MOVEL*BLANK    YL0011  5
      * Define local work field Customer Market Code
     C                     MOVEL*BLANK    YL0012  3
      * Define null work field Market Desc
     C                     MOVEL*BLANK    YN0005 30
      * Define null work field Market Type
     C                     MOVEL*BLANK    YN0006  1
      * Define null work field Salesperson Code
     C                     MOVEL*BLANK    YN0007  3
      * Define null work field Regional Salesperson
     C                     MOVEL*BLANK    YN0008  3
      * Define local work field CIP Item Price
     C                     Z-ADD*ZERO     YL0013 114
      * Define local work field USR Date Priced
     C                     Z-ADD*ZERO     YL0014  70
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0005
00002 MKTDTE
