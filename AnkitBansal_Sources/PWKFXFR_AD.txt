// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PWKFXFR
// ?Date: 14.08.2025 Time: 02:56:43
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?MODIFICATIONS
//?H16853 ISE 11/02/2020 CHANGE BUY ORDER NUMBER FIELD LENGTH FROM 5 TO 7
//?Retrieve Delivery Tracking key values OR send error message
CASE;

// IF PAR.DT Movement Number is Entered
IF PAR.DT_Movement_Number <> *ZERO;

EXECUTE FUNCTION(Val DT per Movement   RT) TYPE(RTVOBJ) FILE(PLAFCPP)           AB1248715;
PARAMETER(PAR.CC_Company_Number);
PARAMETER(PAR.DSH_Kill_Date);
PARAMETER(PAR.DT_Delivery_Date);
PARAMETER(PAR.DT_Delivery_Time);
PARAMETER(PAR.DT_Delivery_Time_Seq);
PARAMETER(PAR.DT_Movement_Number);
PARAMETER(LCL.Return_Code_USR);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 // PAR.Return Code USR = CND.*Record does not exist
 PAR.Return_Code_USR = 'Y2U0005';

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

 // PAR.Return Code USR = CND.*Normal
 PAR.Return_Code_USR = *BLANK;

}


//?If record not found, exit program
CASE;

// IF LCL.Return Code USR is *Record does not exist
IF LCL.Return_Code_USR = 'Y2U0005';

// PGM.*Return code = LCL.Return Code USR
PGM.*Return_code = LCL.Return_Code_USR;

RETURN;

ENDIF;

//?Retrieve Delivery Tracking key values OR send error message
// IF PAR.BOH Buy Order Number is NE Zero
IF PAR.BOH_Buy_Order_Number <> *ZERO;

EXECUTE FUNCTION(Val DT per BOL        RT) TYPE(RTVOBJ) FILE(PLAFCPP)           AB1247617;
PARAMETER(PAR.CC_Company_Number);
PARAMETER(PAR.DSH_Kill_Date);
PARAMETER(PAR.DT_Delivery_Date);
PARAMETER(PAR.DT_Delivery_Time);
PARAMETER(PAR.DT_Delivery_Time_Seq);
PARAMETER(PAR.BOH_Company_Number);
PARAMETER(PAR.BOH_Buy_Order_Number);
PARAMETER(PAR.BOL_Load_Number);
PARAMETER(LCL.Return_Code_USR);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 // PAR.Return Code USR = CND.*Record does not exist
 PAR.Return_Code_USR = 'Y2U0005';

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

 // PAR.Return Code USR = CND.*Normal
 PAR.Return_Code_USR = *BLANK;

}


//?If record not found, exit program
CASE;

// IF LCL.Return Code USR is *Record does not exist
IF LCL.Return_Code_USR = 'Y2U0005';

// PGM.*Return code = LCL.Return Code USR
PGM.*Return_code = LCL.Return_Code_USR;

RETURN;

ENDIF;

//?Retrieve Delivery Tracking key values OR send error message
// IF *OTHERWISE
IF *OTHERWISE;

// Send error message - 'Delivery Tracking cannot be displayed'
ERROR(PRK1552);

QUIT;

ENDIF;

// Call program Dsp Delivery Tracking DR.
CALL PROGRAM(Dsp Delivery Tracking DR) ('PWKCD1R');
PARAMETER(PAR.CC_Company_Number);
PARAMETER(PAR.DSH_Kill_Date);
PARAMETER(PAR.DT_Delivery_Date);
PARAMETER(PAR.DT_Delivery_Time);
PARAMETER(PAR.DT_Delivery_Time_Seq);

