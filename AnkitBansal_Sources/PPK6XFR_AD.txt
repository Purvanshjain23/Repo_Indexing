// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PPK6XFR
// ?Date: 14.08.2025 Time: 03:41:02
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?**************************************************************
//?RMC 3/11/05 New function to Delete an OA transaction
//?**************************************************************
//?Delete OA transaction for OA Inv and Ref Inv
EXECUTE FUNCTION(Rtv OA Trans to Del   RT) TYPE(RTVOBJ) FILE(PDNHCPP)           AC1723827;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Invoice_Number);
PARAMETER(PAR.Invoice_Suffix);
PARAMETER(PAR.Reference_Number);
PARAMETER(PAR.Reference_Suffix);
{
 //?USER: Process Data record

 EXECUTE FUNCTION(DLT A/R OA/CM Trans    DL) TYPE(DLTOBJ) FILE(PDNHCPP)          AC1576404;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Invoice_Number);
 PARAMETER(DB1.Invoice_Suffix);
 PARAMETER(DB1.Reference_Number);
 PARAMETER(DB1.Reference_Suffix);
}


EXECUTE FUNCTION(Rtv OA Trans to Del   RT) TYPE(RTVOBJ) FILE(PDNHCPP)           AC1723827;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Reference_Number);
PARAMETER(PAR.Reference_Suffix);
PARAMETER(PAR.Invoice_Number);
PARAMETER(PAR.Invoice_Suffix);
{
 //?USER: Process Data record

 EXECUTE FUNCTION(DLT A/R OA/CM Trans    DL) TYPE(DLTOBJ) FILE(PDNHCPP)          AC1576404;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Invoice_Number);
 PARAMETER(DB1.Invoice_Suffix);
 PARAMETER(DB1.Reference_Number);
 PARAMETER(DB1.Reference_Suffix);
}


//?Delete A/R Detail SPR/ARC transactions for Ref Inv
EXECUTE FUNCTION(RTV Inv to Del Arc/Spr RT) TYPE(RTVOBJ) FILE(ARBECPP)          AC1723828;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Reference_Number);
PARAMETER(PAR.Reference_Suffix);
PARAMETER(*ZERO);
PARAMETER(PAR.Transaction_Amount);
{
 //?USER: Initialize routine

 // WRK.Transaction Amount = CON.*ZERO - PAR.Transaction Amount
 WRK.Transaction_Amount = *ZERO - PAR.Transaction_Amount;

 //?USER: Process Data record

 CASE;

 // IF DB1.Adjustment Type Code is Spread
 IF DB1.Adjustment_Type_Code = 'SPR';

 // AND PAR.Transaction Amount EQ DB1.Transaction Amount
 AND PAR.Transaction_Amount = DB1.Transaction_Amount;

 EXECUTE FUNCTION(DLT A/R Detail         DL) TYPE(DLTOBJ) FILE(ARBECPP)          AC1109993;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Invoice_Number);
 PARAMETER(DB1.Invoice_Suffix);
 PARAMETER(DB1.Sequence_Number);
 ENDIF;

 CASE;

 // IF DB1.Adjustment Type Code is A/R Entry by Customer
 IF DB1.Adjustment_Type_Code = 'ARC';

 // AND WRK.Transaction Amount EQ DB1.Transaction Amount
 AND WRK.Transaction_Amount = DB1.Transaction_Amount;

 EXECUTE FUNCTION(DLT A/R Detail         DL) TYPE(DLTOBJ) FILE(ARBECPP)          AC1109993;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Invoice_Number);
 PARAMETER(DB1.Invoice_Suffix);
 PARAMETER(DB1.Sequence_Number);
 ENDIF;

}


//?Update A/R Hdr for OA Inv:  - Amt Pd and + Rem Bal Due
EXECUTE FUNCTION(RTV Change Amt Pd     RT) TYPE(RTVOBJ) FILE(ARBDCPP)           AC1723831;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Invoice_Number);
PARAMETER(PAR.Invoice_Suffix);
PARAMETER(PAR.Transaction_Amount);
{
 //?USER: Process Data record

 // WRK.Amount Paid = DB1.Amount Paid - PAR.Transaction Amount
 WRK.Amount_Paid = DB1.Amount_Paid - PAR.Transaction_Amount;

 // WRK.Remaining Balance Due = DB1.Remaining Balance Due + PAR.Transaction Amount
 WRK.Remaining_Balance_Due = DB1.Remaining_Balance_Due + PAR.Transaction_Amount;

 CASE;

 // IF WRK.Remaining Balance Due is equal to zero
 IF WRK.Remaining_Balance_Due = *ZERO;

 // WRK.Paid in Full Date = JOB.*Job date
 WRK.Paid_in_Full_Date = JOB.*Job_date;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // WRK.Paid in Full Date = CON.*ZERO
 WRK.Paid_in_Full_Date = *ZERO;

 ENDIF;

 EXECUTE FUNCTION(CHG Adj Amount field   CH) TYPE(CHGOBJ) FILE(ARBDCPP)          AC1339354;
 PARAMETER(PAR.Company_Number);
 PARAMETER(DB1.Invoice_Number);
 PARAMETER(DB1.Invoice_Suffix);
 PARAMETER(DB1.Transaction_Amount);
 PARAMETER(DB1.Adjustment_Amount);
 PARAMETER(WRK.Amount_Paid);
 PARAMETER(WRK.Remaining_Balance_Due);
 PARAMETER(WRK.Paid_in_Full_Date);
 PARAMETER(DB1.Days_to_Pay);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Set Date/Time Stamp   IF) TYPE(EXCINTFUN)                      AC1255766;
  PARAMETER(DB1.Job_Time);
  PARAMETER(DB1.User_Id);
  PARAMETER(DB1.Job_Name);
  PARAMETER(DB1.Job_Date);
  {
   //?Execute internal function

   // PAR.Job Time = JOB.*Job time
   PAR.Job_Time = JOB.*Job_time;

   // PAR.User Id = JOB.*USER
   PAR.User_Id = JOB.*USER;

   // PAR.Job Name = JOB.*JOB
   PAR.Job_Name = JOB.*JOB;

   // PAR.Job Date = JOB.*Job date
   PAR.Job_Date = JOB.*Job_date;

  }

 }

}


//?Update A/R Hdr for Ref Inv:  - Amt Pd and + Rem Bal Due
EXECUTE FUNCTION(RTV Change Amt Pd     RT) TYPE(RTVOBJ) FILE(ARBDCPP)           AC1723831;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Reference_Number);
PARAMETER(PAR.Reference_Suffix);
PARAMETER(PAR.Transaction_Amount);
{
 //?USER: Process Data record

 // WRK.Amount Paid = DB1.Amount Paid - PAR.Transaction Amount
 WRK.Amount_Paid = DB1.Amount_Paid - PAR.Transaction_Amount;

 // WRK.Remaining Balance Due = DB1.Remaining Balance Due + PAR.Transaction Amount
 WRK.Remaining_Balance_Due = DB1.Remaining_Balance_Due + PAR.Transaction_Amount;

 CASE;

 // IF WRK.Remaining Balance Due is equal to zero
 IF WRK.Remaining_Balance_Due = *ZERO;

 // WRK.Paid in Full Date = JOB.*Job date
 WRK.Paid_in_Full_Date = JOB.*Job_date;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // WRK.Paid in Full Date = CON.*ZERO
 WRK.Paid_in_Full_Date = *ZERO;

 ENDIF;

 EXECUTE FUNCTION(CHG Adj Amount field   CH) TYPE(CHGOBJ) FILE(ARBDCPP)          AC1339354;
 PARAMETER(PAR.Company_Number);
 PARAMETER(DB1.Invoice_Number);
 PARAMETER(DB1.Invoice_Suffix);
 PARAMETER(DB1.Transaction_Amount);
 PARAMETER(DB1.Adjustment_Amount);
 PARAMETER(WRK.Amount_Paid);
 PARAMETER(WRK.Remaining_Balance_Due);
 PARAMETER(WRK.Paid_in_Full_Date);
 PARAMETER(DB1.Days_to_Pay);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Set Date/Time Stamp   IF) TYPE(EXCINTFUN)                      AC1255766;
  PARAMETER(DB1.Job_Time);
  PARAMETER(DB1.User_Id);
  PARAMETER(DB1.Job_Name);
  PARAMETER(DB1.Job_Date);
  {
   //?Execute internal function

   // PAR.Job Time = JOB.*Job time
   PAR.Job_Time = JOB.*Job_time;

   // PAR.User Id = JOB.*USER
   PAR.User_Id = JOB.*USER;

   // PAR.Job Name = JOB.*JOB
   PAR.Job_Name = JOB.*JOB;

   // PAR.Job Date = JOB.*Job date
   PAR.Job_Date = JOB.*Job_date;

  }

 }

}


