/***************************************************************** */
/*                                                                 */
/*  PROGRAM NUMBER:  PLWJUPR                                       */
/*  PROGRAM NAME:    Clp Hot Wgt Data SrcD UP                      */
/*  PROGRAMMER:      Julius High                                   */
/*  CREATE DATE:     12/23/2014                                    */
/*                                                                 */
/*  FUNCTION:        This CLP  calls the SEQUEL Viewpoint          */
/*                   HOTWGTDT - Hog Scale Daily Detail and send    */
/*                   XLS to user for specified Kill Date.          */
/*                                                                 */
/*******************************************************************/
/*  Modification History                                           */
/*           E3773 JJH 12/23/14 - Create CLP                       */
/*                                                                 */
/***************************************************************** */
             PGM        PARM(&COMA &KILLDTA &EMAILADR &KILLDTTXT)

/*-----------------------------------------------------------------*/
/*                      PARAMETER                                  */
/*-----------------------------------------------------------------*/
/* Function Specific                                               */
             DCL        VAR(&COMA)      TYPE(*CHAR) LEN(3)
             DCL        VAR(&KILLDTA)   TYPE(*CHAR) LEN(7)
             DCL        VAR(&EMAILADR)  TYPE(*CHAR) LEN(50)
             DCL        VAR(&KILLDTTXT) TYPE(*CHAR) LEN(10)

/*-----------------------------------------------------------------*/
/* Program Variables                                               */
             DCL        VAR(&TEXT)     TYPE(*CHAR) LEN(50)

/* Setup email to send Hot Scale Daily Detail - Excel Spread Sheet*/
             CHGVAR     VAR(&TEXT) VALUE('Hot Scale Daily Detail for +
                          ' *CAT &KILLDTTXT)

/*-----------------------------------------------------------------*/
/* Initialization                                                  */
/*-----------------------------------------------------------------*/
/*                           MAIN                                  */
/*-----------------------------------------------------------------*/

/*******************************************************************/
/* Create Excel Spreadsheet with SEQUEL Viewpoint and email to     */
/* receipient(s).                                                  */

             EXECUTE    VIEW(HOTWGTDT) PCFMT(*XLS) +
                          RECIPIENT(&EMAILADR) EMLMSG(&TEXT) +
                          SETVAR((&COMPANY &COMA) (&SEL_DATE +
                          &KILLDTA)) TEXT(&TEXT)

             MONMSG     MSGID(CPF0000)

/*-----------------------------------------------------------------*/
/*                      PROGRAM END                                */
/*-----------------------------------------------------------------*/
 ENDPGM:
             ENDPGM
