     H/TITLE ADD Ready to Confirm  XL  Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) ACTGRP(*CALLER) BNDDIR(YBNDDIR)
     Z* DBGVIEW(*SOURCE) OPTIMIZE(*BASIC) CVTOPT(*DATETIME)
     Z* TGTRLS(V7R3M0)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJMIST
     H* Date          : 10/27/24  Time  : 02:51:54
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOPEYCPL1  IF   E           K DISK
      * RTV : Order Events              Retrieval index       NV
      *
     FOPBFCPL1  IF   E           K DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOPEYCPL0  IF A E           K DISK
      * UPD : Order Events              Update index
      *
     FOPBFCPL0  UF   E           K DISK
      * UPD : Order Header TRG          Update index
      *
      * Long constants
     D @CN#            S              6    DIM(03)CTDATA PERRCD(1)
     D @CN             S             25    DIM(03) ALT(@CN#)
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
     D QOPEY1        E DS                  EXTNAME(OPEYCPL0)
      * UPD : Order Events              Update index
      * Renamed input format fields
     D  WCAIC3       E                     EXTFLD(EYAIC3)
     D  WCC4NB       E                     EXTFLD(EYC4NB)
     D  WCQ2NB       E                     EXTFLD(EYQ2NB)
     D  WCJPCD       E                     EXTFLD(EYJPCD)
     D  WCAUC3       E                     EXTFLD(EYAUC3)
     D  WCQ7NB       E                     EXTFLD(EYQ7NB)
     D  WCOMST       E                     EXTFLD(EYOMST)
     D  WCD2DT       E                     EXTFLD(EYD2DT)
     D  WCONST       E                     EXTFLD(EYONST)
     D  WCOOST       E                     EXTFLD(EYOOST)
     D  WCOPST       E                     EXTFLD(EYOPST)
     D  WCAWC3       E                     EXTFLD(EYAWC3)
     D  WCQ8NB       E                     EXTFLD(EYQ8NB)
     D  WCQ9NB       E                     EXTFLD(EYQ9NB)
     D  WCBKC7       E                     EXTFLD(EYBKC7)
     D  WCUVST       E                     EXTFLD(EYUVST)
     D  WCUWST       E                     EXTFLD(EYUWST)
     D  WCUXST       E                     EXTFLD(EYUXST)
     D  WCAATM       E                     EXTFLD(EYAATM)
     D  WCAYNA       E                     EXTFLD(EYAYNA)
     D  WCA0NA       E                     EXTFLD(EYA0NA)
     D  WCAXDT       E                     EXTFLD(EYAXDT)
      *
     D QOPBF1        E DS                  EXTNAME(OPBFCPL0)
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     D  WDAIC3       E                     EXTFLD(BEAIC3)
     D  WDC4NB       E                     EXTFLD(BEC4NB)
     D  WDJNCD       E                     EXTFLD(BEJNCD)
     D  WDANC7       E                     EXTFLD(BEANC7)
     D  WDBKC7       E                     EXTFLD(BEBKC7)
     D  WDBRTX       E                     EXTFLD(BEBRTX)
     D  WDHMNA       E                     EXTFLD(BEHMNA)
     D  WDHONA       E                     EXTFLD(BEHONA)
     D  WDHPNA       E                     EXTFLD(BEHPNA)
     D  WDHNNA       E                     EXTFLD(BEHNNA)
     D  WDDBCD       E                     EXTFLD(BEDBCD)
     D  WDCKTX       E                     EXTFLD(BECKTX)
     D  WDB0C7       E                     EXTFLD(BEB0C7)
     D  WDAETX       E                     EXTFLD(BEAETX)
     D  WDB1NA       E                     EXTFLD(BEB1NA)
     D  WDB3NA       E                     EXTFLD(BEB3NA)
     D  WDB4NA       E                     EXTFLD(BEB4NA)
     D  WDB2NA       E                     EXTFLD(BEB2NA)
     D  WDBHCD       E                     EXTFLD(BEBHCD)
     D  WDC8TX       E                     EXTFLD(BEC8TX)
     D  WDBCNA       E                     EXTFLD(BEBCNA)
     D  WDA0DT       E                     EXTFLD(BEA0DT)
     D  WDA5DT       E                     EXTFLD(BEA5DT)
     D  WDGNDT       E                     EXTFLD(BEGNDT)
     D  WDACDT       E                     EXTFLD(BEACDT)
     D  WDAQCD       E                     EXTFLD(BEAQCD)
     D  WDB6NA       E                     EXTFLD(BEB6NA)
     D  WDBYNA       E                     EXTFLD(BEBYNA)
     D  WDBZNA       E                     EXTFLD(BEBZNA)
     D  WDGTST       E                     EXTFLD(BEGTST)
     D  WDGVST       E                     EXTFLD(BEGVST)
     D  WDGUST       E                     EXTFLD(BEGUST)
     D  WDQFST       E                     EXTFLD(BEQFST)
     D  WDCQCD       E                     EXTFLD(BECQCD)
     D  WDGJST       E                     EXTFLD(BEGJST)
     D  WDGWST       E                     EXTFLD(BEGWST)
     D  WDGXST       E                     EXTFLD(BEGXST)
     D  WDGYST       E                     EXTFLD(BEGYST)
     D  WDAODT       E                     EXTFLD(BEAODT)
     D  WDAIVN       E                     EXTFLD(BEAIVN)
     D  WDCXDT       E                     EXTFLD(BECXDT)
     D  WDJZVA       E                     EXTFLD(BEJZVA)
     D  WDA1WG       E                     EXTFLD(BEA1WG)
     D  WDXIST       E                     EXTFLD(BEXIST)
     D  WDXJST       E                     EXTFLD(BEXJST)
     D  WDXKST       E                     EXTFLD(BEXKST)
     D  WDEIDT       E                     EXTFLD(BEEIDT)
     D  WDAFTM       E                     EXTFLD(BEAFTM)
     D  WDE8CD       E                     EXTFLD(BEE8CD)
     D  WDE9CD       E                     EXTFLD(BEE9CD)
     D  WDRMNB       E                     EXTFLD(BERMNB)
     D  WDTBNB       E                     EXTFLD(BETBNB)
     D  WDR1NB       E                     EXTFLD(BER1NB)
     D  WDPJST       E                     EXTFLD(BEPJST)
     D  WDU0ST       E                     EXTFLD(BEU0ST)
     D  WDU1ST       E                     EXTFLD(BEU1ST)
     D  WDQ2CD       E                     EXTFLD(BEQ2CD)
     D  WDU2ST       E                     EXTFLD(BEU2ST)
     D  WDVEST       E                     EXTFLD(BEVEST)
     D  WDVFST       E                     EXTFLD(BEVFST)
     D  WDVGST       E                     EXTFLD(BEVGST)
     D  WDRPCD       E                     EXTFLD(BERPCD)
     D  WDRNNB       E                     EXTFLD(BERNNB)
     D  WDVDST       E                     EXTFLD(BEVDST)
     D  WDATIN       E                     EXTFLD(BEATIN)
     D  WDU4ST       E                     EXTFLD(BEU4ST)
     D  WDU5ST       E                     EXTFLD(BEU5ST)
     D  WDRSRN       E                     EXTFLD(BERSRN)
     D  WDMHNA       E                     EXTFLD(BEMHNA)
     D  WDMINA       E                     EXTFLD(BEMINA)
     D  WDWBST       E                     EXTFLD(BEWBST)
     D  WDR4CD       E                     EXTFLD(BER4CD)
     D  WDBFCD       E                     EXTFLD(BEBFCD)
     D  WDQ4CD       E                     EXTFLD(BEQ4CD)
     D  WDT3NB       E                     EXTFLD(BET3NB)
     D  WDSICD       E                     EXTFLD(BESICD)
     D  WDCONB       E                     EXTFLD(BECONB)
     D  WDCEST       E                     EXTFLD(BECEST)
     D  WDAWDT       E                     EXTFLD(BEAWDT)
     D  WDJPCD       E                     EXTFLD(BEJPCD)
     D  WDXUST       E                     EXTFLD(BEXUST)
     D  WDZ1ST       E                     EXTFLD(BEZ1ST)
     D  WDVRVA       E                     EXTFLD(BEVRVA)
     D  WDOBST       E                     EXTFLD(BEOBST)
     D  WDBCST       E                     EXTFLD(BEBCST)
     D  WDBDST       E                     EXTFLD(BEBDST)
     D  WDB7VL       E                     EXTFLD(BEB7VL)
     D  WDGASX       E                     EXTFLD(BEGASX)
     D  WDGBSX       E                     EXTFLD(BEGBSX)
     D  WDGCSX       E                     EXTFLD(BEGCSX)
     D  WDGDSX       E                     EXTFLD(BEGDSX)
     D  WDFNSX       E                     EXTFLD(BEFNSX)
     D  WDFOSX       E                     EXTFLD(BEFOSX)
     D  WDFPSX       E                     EXTFLD(BEFPSX)
     D  WDFQSX       E                     EXTFLD(BEFQSX)
     D  WDFRSX       E                     EXTFLD(BEFRSX)
     D  WDFSSX       E                     EXTFLD(BEFSSX)
     D  WDFTSX       E                     EXTFLD(BEFTSX)
     D  WDFUSX       E                     EXTFLD(BEFUSX)
     D  WDFVSX       E                     EXTFLD(BEFVSX)
     D  WDFWSX       E                     EXTFLD(BEFWSX)
     D  WDFXSX       E                     EXTFLD(BEFXSX)
     D  WDFYSX       E                     EXTFLD(BEFYSX)
     D  WDNODT       E                     EXTFLD(BENODT)
     D  WDNPDT       E                     EXTFLD(BENPDT)
     D  WDNQDT       E                     EXTFLD(BENQDT)
     D  WDNRDT       E                     EXTFLD(BENRDT)
     D  WDNSDT       E                     EXTFLD(BENSDT)
     D  WDBPTM       E                     EXTFLD(BEBPTM)
     D  WDBQTM       E                     EXTFLD(BEBQTM)
     D  WDBRTM       E                     EXTFLD(BEBRTM)
     D  WDBSTM       E                     EXTFLD(BEBSTM)
     D  WDBTTM       E                     EXTFLD(BEBTTM)
     D  WDH0NX       E                     EXTFLD(BEH0NX)
     D  WDH1NX       E                     EXTFLD(BEH1NX)
     D  WDH2NX       E                     EXTFLD(BEH2NX)
     D  WDH3NX       E                     EXTFLD(BEH3NX)
     D  WDH4NX       E                     EXTFLD(BEH4NX)
     D  WDC0C7       E                     EXTFLD(BEC0C7)
     D  WDUVST       E                     EXTFLD(BEUVST)
     D  WDUWST       E                     EXTFLD(BEUWST)
     D  WDUXST       E                     EXTFLD(BEUXST)
     D  WDAATM       E                     EXTFLD(BEAATM)
     D  WDAYNA       E                     EXTFLD(BEAYNA)
     D  WDA0NA       E                     EXTFLD(BEA0NA)
     D  WDAXDT       E                     EXTFLD(BEAXDT)
      *
     D YARDCS          DS           779
      * Message data for message Y2U0009.
     D MD0009          DS
     D  MDPGM                  1     10
     D  MDACP                 11     20
     D  MDFMT                 21     30
     D  MDACT                 31     34
     D  MDLBL                 35     40
      * Outward parameters
     D PARC            DS           779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     D  PAAIC3                 1      2P 0
      * I :  Order Number
     D  PAC4NB                 3      6P 0
      * I :  Order Type_Sales
     D  PAJNCD                 7      8
      * I :  AR Customer Number
     D  PAANC7                 9     12P 0
      * I :  Ship To Customer
     D  PABKC7                13     16P 0
      * I :  Ship To Name
     D  PABRTX                17     46
      * I :  Ship To Address Line 1
     D  PAHMNA                47     76
      * I :  Ship To Address Line 2
     D  PAHONA                77    106
      * I :  Ship To Address Line 3
     D  PAHPNA               107    136
      * I :  Ship To City
     D  PAHNNA               137    156
      * I :  Ship To State Code
     D  PADBCD               157    158
      * I :  Ship To Zip_Postal Code
     D  PACKTX               159    169
      * I :  Bill to Customer
     D  PAB0C7               170    173P 0
      * I :  Bill to Name
     D  PAAETX               174    203
      * I :  Bill to Address Line 1
     D  PAB1NA               204    233
      * I :  Bill to Address Line 2
     D  PAB3NA               234    263
      * I :  Bill to Address Line 3
     D  PAB4NA               264    293
      * I :  Bill to City
     D  PAB2NA               294    313
      * I :  Bill to State Code
     D  PABHCD               314    315
      * I :  Bill to Zip_Postal Code
     D  PAC8TX               316    326
      * I :  Customer Purchase Order #
     D  PABCNA               327    341
      * I :  Order Date
     D  PAA0DT               342    345P 0
      * I :  Requested Ship Date
     D  PAA5DT               346    349P 0
      * I :  Actual Shipped Date
     D  PAGNDT               350    353P 0
      * I :  Cancel Date
     D  PAACDT               354    357P 0
      * I :  Terms Code
     D  PAAQCD               358    359
      * I :  Special Instructions
     D  PAB6NA               360    399
      * I :  Special Instructions 2
     D  PABYNA               400    439
      * I :  Carrier Code
     D  PABZNA               440    442
      * I :  Comment Print Acknowledge
     D  PAGTST               443    443
      * I :  Comment Print Inv_Cr_Memo
     D  PAGVST               444    444
      * I :  Comment Print Pick Slip
     D  PAGUST               445    445
      * I :  Comment Print Ship Doc
     D  PAQFST               446    446
      * I :  Reason Code
     D  PACQCD               447    449
      * I :  Order in Use
     D  PAGJST               450    450
      * I :  Header Status
     D  PAGWST               451    451
      * I :  Header Status Last
     D  PAGXST               452    452
      * I :  Order Type Print Status
     D  PAGYST               453    453
      * I :  Scheduled Ship Date
     D  PAAODT               454    457P 0
      * I :  User Original Entry
     D  PAAIVN               458    467
      * I :  Date of Original Entry
     D  PACXDT               468    471P 0
      * I :  Order Value Total
     D  PAJZVA               472    477P 2
      * I :  Order Weight Total
     D  PAA1WG               478    483P 2
      * I :  Credit Hold
     D  PAXIST               484    484
      * I :  Production Hold
     D  PAXJST               485    485
      * I :  New Customer Hold
     D  PAXKST               486    486
      * I :  Requested Delivery Date
     D  PAEIDT               487    490P 0
      * I :  Requested Delivery Time
     D  PAAFTM               491    493P 0
      * I :  Accounts Receiv_Ent 1
     D  PAE8CD               494    497
      * I :  Accounts Receiv_Ent 2
     D  PAE9CD               498    509
      * I :  Load ID
     D  PARMNB               510    513P 0
      * I :  Absorbed Freight Rate CWT
     D  PATBNB               514    516P 2
      * I :  Rated Freight
     D  PAR1NB               517    522P 2
      * I :  LTL Flag
     D  PAPJST               523    523
      * I :  Price Audit
     D  PAU0ST               524    524
      * I :  Price Status
     D  PAU1ST               525    525
      * I :  Shipping Method
     D  PAQ2CD               526    527
      * I :  Export Status
     D  PAU2ST               528    528
      * I :  Palletize
     D  PAVEST               529    529
      * I :  Shrink Wrap
     D  PAVFST               530    530
      * I :  Slip Sheet
     D  PAVGST               531    531
      * I :  Age Code
     D  PARPCD               532    532
      * I :  Reefer Temperature
     D  PARNNB               533    535P 2
      * I :  Load Type
     D  PAVDST               536    536
      * I :  Attach to Invoice Number
     D  PAATIN               537    540P 0
      * I :  Load Plan Order
     D  PAU4ST               541    541
      * I :  Print Pick Slip
     D  PAU5ST               542    542
      * I :  Resell Reference Number
     D  PARSRN               543    546P 0
      * I :  Special Comment 1
     D  PAMHNA               547    576
      * I :  Special Comment 2
     D  PAMINA               577    606
      * I :  Affect Auto Accruals
     D  PAWBST               607    607
      * I :  Sales Route Code
     D  PAR4CD               608    610
      * I :  Manager Level Code
     D  PABFCD               611    612
      * I :  VP Level Code
     D  PAQ4CD               613    615
      * I :  Attach to Order Number
     D  PAT3NB               616    619P 0
      * I :  Reason for Price Audit
     D  PASICD               620    622
      * I :  Invoice Number
     D  PACONB               623    626P 0
      * I :  Invoice Suffix
     D  PACEST               627    628
      * I :  Invoice Date
     D  PAAWDT               629    632P 0
      * I :  Event Code
     D  PAJPCD               633    634
      * I :  Trans Contol AS400_Plant
     D  PAXUST               635    635
      * I :  Modified Flag
     D  PAZ1ST               636    636
      * I :  A_R order Value Total
     D  PAVRVA               637    642P 2
      * I :  Billing Activity Type
     D  PAOBST               643    643
      * I :  Block Order Flag
     D  PABCST               644    644
      * I :  Order Certification Flag
     D  PABDST               645    645
      * I :  Invoice Order Value Tot
     D  PAB7VL               646    651P 2
      * I :  Process Sts for 3C
     D  PAGASX               652    652
      * I :  Order Conf Fax Sts
     D  PAGBSX               653    653
      * I :  Manifest Fax Sts
     D  PAGCSX               654    654
      * I :  Invoice Fax Sts
     D  PAGDSX               655    655
      * I :  Transfer in Storage Ind
     D  PAFNSX               656    656
      * I :  Email Cust On Order Ship
     D  PAFOSX               657    657
      * I :  Order Emailed
     D  PAFPSX               658    658
      * I :  Export Docs Go w_Driver
     D  PAFQSX               659    659
      * I :  Shipping Temp Code C_F
     D  PAFRSX               660    660
      * I :  Broker Order Status
     D  PAFSSX               661    661
      * I :  Air Freight Order
     D  PAFTSX               662    662
      * I :  Order Requires Review
     D  PAFUSX               663    664
      * I :  OH Load Plan Ready
     D  PAFVSX               665    666
      * I :  Export USDA Approved
     D  PAFWSX               667    668
      * I :  HPB Ship to Warehouse
     D  PAFXSX               669    671
      * I :  OH TF Exempt Code
     D  PAFYSX               672    674
      * I :  OH Appt Confirmation Dt
     D  PANODT               675    678P 0
      * I :  JPN Invoice Issuance Date
     D  PANPDT               679    682P 0
      * I :  Load Actual Shipped Date
     D  PANQDT               683    686P 0
      * I :  Load BOL Complete Date
     D  PANRDT               687    690P 0
      * I :  Load Truck Departure Date
     D  PANSDT               691    694P 0
      * I :  Maximum Gross Weight
     D  PABPTM               695    698P 0
      * I :  Time of Original Entry
     D  PABQTM               699    702P 0
      * I :  OH Appt Confirmation Tm
     D  PABRTM               703    706P 0
      * I :  Load BOL Complete Time
     D  PABSTM               707    710P 0
      * I :  Load Truck Departure Time
     D  PABTTM               711    714P 0
      * I :  Act Frt Reference Amount
     D  PAH0NX               715    720P 2
      * I :  Act Non_Ref Frt Amount
     D  PAH1NX               721    726P 2
      * I :  OH Fuel Surcharge Amount
     D  PAH2NX               727    732P 2
      * I :  OH Total Non_Ref Frt Amt
     D  PAH3NX               733    738P 2
      * I :  OH Total Ref Frt Amt
     D  PAH4NX               739    744P 2
      * I :  Claim Number
     D  PAC0C7               745    748P 0
      * I :  EDI Status 1
     D  PAUVST               749    749
      * I :  EDI Status 2
     D  PAUWST               750    750
      * I :  EDI Status 3
     D  PAUXST               751    751
      * I :  Job Time
     D  PAAATM               752    755P 0
      * I :  User Id
     D  PAAYNA               756    765
      * I :  Job Name
     D  PAA0NA               766    775
      * I :  Job Date
     D  PAAXDT               776    779P 0
      *
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  WP0001         S              3  0
     D  WP0002         S              7  0
     D  WP0003         S              7  0
     D  WP0004         S              1
     D  WP0005         S              7  0
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  W0CLPG         S             10
     D  WUQ2NB         S              5  0
     D  WQSA01         S                   LIKE(WAAIC3)
     D  WQSA02         S                   LIKE(WAC4NB)
     D  YL0001         S              7  0
     D  YL0002         S              1
     D  YL0003         S              1
     D  WN0001         S              1
     D  WN0002         S              1
     D  WN0003         S              1
     D  WN0004         S              6  0
     D  WN0005         S             10
     D  WN0006         S             10
     D  WN0007         S              7  0
     D  ZADFMF         S             10
     D  WN0008         S              2
     D  WN0009         S              7  0
     D  WN0010         S              7  0
     D  WN0011         S             30
     D  WN0012         S             30
     D  WN0013         S             30
     D  WN0014         S             30
     D  WN0015         S             20
     D  WN0016         S              2
     D  WN0017         S             11
     D  WN0018         S              7  0
     D  WN0019         S             30
     D  WN0020         S             30
     D  WN0021         S             30
     D  WN0022         S             30
     D  WN0023         S             20
     D  WN0024         S              2
     D  WN0025         S             11
     D  WN0026         S             15
     D  WN0027         S              7  0
     D  WN0028         S              7  0
     D  WN0029         S              7  0
     D  WN0030         S              7  0
     D  WN0031         S              2
     D  WN0032         S             40
     D  WN0033         S             40
     D  WN0034         S              3
     D  WN0035         S              1
     D  WN0036         S              1
     D  WN0037         S              1
     D  WN0038         S              1
     D  WN0039         S              3
     D  WN0040         S              1
     D  WN0041         S              1
     D  WN0042         S              7  0
     D  WN0043         S             10
     D  WN0044         S              7  0
     D  WN0045         S             11  2
     D  WN0046         S             11  2
     D  WN0047         S              1
     D  WN0048         S              1
     D  WN0049         S              1
     D  WN0050         S              7  0
     D  WN0051         S              4  0
     D  WN0052         S              4
     D  WN0053         S             12
     D  WN0054         S              7  0
     D  WN0055         S              5  2
     D  WN0056         S             11  2
     D  WN0057         S              1
     D  WN0058         S              1
     D  WN0059         S              1
     D  WN0060         S              2
     D  WN0061         S              1
     D  WN0062         S              1
     D  WN0063         S              1
     D  WN0064         S              1
     D  WN0065         S              1
     D  WN0066         S              5  2
     D  WN0067         S              1
     D  WN0068         S              7  0
     D  WN0069         S              1
     D  WN0070         S              1
     D  WN0071         S              7  0
     D  WN0072         S             30
     D  WN0073         S             30
     D  WN0074         S              1
     D  WN0075         S              3
     D  WN0076         S              2
     D  WN0077         S              3
     D  WN0078         S              7  0
     D  WN0079         S              3
     D  WN0080         S              7  0
     D  WN0081         S              2
     D  WN0082         S              7  0
     D  WN0083         S              1
     D  WN0084         S              1
     D  WN0085         S             11  2
     D  WN0086         S              1
     D  WN0087         S              1
     D  WN0088         S              1
     D  WN0089         S             11  2
     D  WN0090         S              1
     D  WN0091         S              1
     D  WN0092         S              1
     D  WN0093         S              1
     D  WN0094         S              1
     D  WN0095         S              1
     D  WN0096         S              1
     D  WN0097         S              1
     D  WN0098         S              1
     D  WN0099         S              1
     D  WN0100         S              1
     D  WN0101         S              2
     D  WN0102         S              2
     D  WN0103         S              2
     D  WN0104         S              3
     D  WN0105         S              3
     D  WN0106         S              7  0
     D  WN0107         S              7  0
     D  WN0108         S              7  0
     D  WN0109         S              7  0
     D  WN0110         S              7  0
     D  WN0111         S              6  0
     D  WN0112         S              6  0
     D  WN0113         S              6  0
     D  WN0114         S              6  0
     D  WN0115         S              6  0
     D  WN0116         S             11  2
     D  WN0117         S             11  2
     D  WN0118         S             11  2
     D  WN0119         S             11  2
     D  WN0120         S             11  2
     D  WN0121         S              7  0
     D  WN0122         S              1
     D  WN0123         S              1
     D  WN0124         S              1
     D  WN0125         S              6  0
     D  WN0126         S             10
     D  WN0127         S             10
     D  WN0128         S              7  0
     D  YARDC          S              1
     D  YL0004         S              1
     D  WQ0001         S              3  0
     D  WQ0002         S              7  0
     D  WQ0003         S              7  0
     D  WQ0004         S              1
     D  WQ0005         S              7  0
     D  WQ0006         S             10
     D  WQ0007         S              1
     D  WQ0008         S              1
     D  WQ0009         S             10
     D  YL0005         S            256
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  W0MTX          S            132
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  W0PMT          S              1
      /EJECT
      * Parameter declarations
     D P1PARM          DS
      * FLD: Order Detail
      * I :  Company Number
     D  P1AIC3                 1      2P 0
      * I :  Order Number
     D  P1C4NB                 3      6P 0
      * I :  Actual Shipped Date
     D  P1GNDT                 7     10P 0
     D P2PARM          DS
      * B :  Access Denied (Y/N)
     D  P2WVST                 1      1
     D P3PARM          DS
      * FLD: Order Header TRG
      * I :  Scheduled Ship Date
     D  P3AODT                 1      4P 0
     D P4PARM          DS
      * FLD: *Arrays
      * N :  Company Number Alpha
     D  P4E6TX                 1      3
      * N :  Order Number Alpha
     D  P4E7TX                 4     10
      * N :  Date (Alpha) USR
     D  P4R4TX                11     17
      * N :  Date From Alpha       USR
     D  P4V5CD                18     24
     D                 DS
     D  ZAMSDA                 1    132
      * Message data for 'PFS Add Ready to Conf'
      * Company Number Alpha
     D  ZA0001                 1      3
      * Order Number Alpha
     D  ZA0002                 4     10
      * Date (Alpha) USR
     D  ZA0003                11     17
      * Access Denied (Y/N)
     D  ZA0004                18     18
      * Date From Alpha       USR
     D  ZA0005                19     25
      * *Return code
     D  ZA0006                26     32
      * Message data for 'SND Pager Message Aplha'
      * Pager Name USR
     D  ZA0007                 1     10
      * Pager Msg 256 USR
     D  ZA0008                11    266
      * Subject Line USR
     D  ZA0009               267    366
     I@EYCPY2
      * Order Events              Retrieval index       NV
      * Renamed input format fields
     I              EYAIC3                      WAAIC3
     I              EYC4NB                      WAC4NB
     I              EYQ2NB                      WAQ2NB
     I              EYJPCD                      WAJPCD
     I              EYAUC3                      WAAUC3
     I              EYQ7NB                      WAQ7NB
     I              EYOMST                      WAOMST
     I              EYD2DT                      WAD2DT
     I              EYONST                      WAONST
     I              EYOOST                      WAOOST
     I              EYOPST                      WAOPST
     I              EYAWC3                      WAAWC3
     I              EYQ8NB                      WAQ8NB
     I              EYQ9NB                      WAQ9NB
     I              EYBKC7                      WABKC7
     I              EYUVST                      WAUVST
     I              EYUWST                      WAUWST
     I              EYUXST                      WAUXST
     I              EYAATM                      WAAATM
     I              EYAYNA                      WAAYNA
     I              EYA0NA                      WAA0NA
     I              EYAXDT                      WAAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                      WBAIC3
     I              BEC4NB                      WBC4NB
     I              BEJNCD                      WBJNCD
     I              BEANC7                      WBANC7
     I              BEBKC7                      WBBKC7
     I              BEBRTX                      WBBRTX
     I              BEHMNA                      WBHMNA
     I              BEHONA                      WBHONA
     I              BEHPNA                      WBHPNA
     I              BEHNNA                      WBHNNA
     I              BEDBCD                      WBDBCD
     I              BECKTX                      WBCKTX
     I              BEB0C7                      WBB0C7
     I              BEAETX                      WBAETX
     I              BEB1NA                      WBB1NA
     I              BEB3NA                      WBB3NA
     I              BEB4NA                      WBB4NA
     I              BEB2NA                      WBB2NA
     I              BEBHCD                      WBBHCD
     I              BEC8TX                      WBC8TX
     I              BEBCNA                      WBBCNA
     I              BEA0DT                      WBA0DT
     I              BEA5DT                      WBA5DT
     I              BEGNDT                      WBGNDT
     I              BEACDT                      WBACDT
     I              BEAQCD                      WBAQCD
     I              BEB6NA                      WBB6NA
     I              BEBYNA                      WBBYNA
     I              BEBZNA                      WBBZNA
     I              BEGTST                      WBGTST
     I              BEGVST                      WBGVST
     I              BEGUST                      WBGUST
     I              BEQFST                      WBQFST
     I              BECQCD                      WBCQCD
     I              BEGJST                      WBGJST
     I              BEGWST                      WBGWST
     I              BEGXST                      WBGXST
     I              BEGYST                      WBGYST
     I              BEAODT                      WBAODT
     I              BEAIVN                      WBAIVN
     I              BECXDT                      WBCXDT
     I              BEJZVA                      WBJZVA
     I              BEA1WG                      WBA1WG
     I              BEXIST                      WBXIST
     I              BEXJST                      WBXJST
     I              BEXKST                      WBXKST
     I              BEEIDT                      WBEIDT
     I              BEAFTM                      WBAFTM
     I              BEE8CD                      WBE8CD
     I              BEE9CD                      WBE9CD
     I              BERMNB                      WBRMNB
     I              BETBNB                      WBTBNB
     I              BER1NB                      WBR1NB
     I              BEPJST                      WBPJST
     I              BEU0ST                      WBU0ST
     I              BEU1ST                      WBU1ST
     I              BEQ2CD                      WBQ2CD
     I              BEU2ST                      WBU2ST
     I              BEVEST                      WBVEST
     I              BEVFST                      WBVFST
     I              BEVGST                      WBVGST
     I              BERPCD                      WBRPCD
     I              BERNNB                      WBRNNB
     I              BEVDST                      WBVDST
     I              BEATIN                      WBATIN
     I              BEU4ST                      WBU4ST
     I              BEU5ST                      WBU5ST
     I              BERSRN                      WBRSRN
     I              BEMHNA                      WBMHNA
     I              BEMINA                      WBMINA
     I              BEWBST                      WBWBST
     I              BER4CD                      WBR4CD
     I              BEBFCD                      WBBFCD
     I              BEQ4CD                      WBQ4CD
     I              BET3NB                      WBT3NB
     I              BESICD                      WBSICD
     I              BECONB                      WBCONB
     I              BECEST                      WBCEST
     I              BEAWDT                      WBAWDT
     I              BEJPCD                      WBJPCD
     I              BEXUST                      WBXUST
     I              BEZ1ST                      WBZ1ST
     I              BEVRVA                      WBVRVA
     I              BEOBST                      WBOBST
     I              BEBCST                      WBBCST
     I              BEBDST                      WBBDST
     I              BEB7VL                      WBB7VL
     I              BEGASX                      WBGASX
     I              BEGBSX                      WBGBSX
     I              BEGCSX                      WBGCSX
     I              BEGDSX                      WBGDSX
     I              BEFNSX                      WBFNSX
     I              BEFOSX                      WBFOSX
     I              BEFPSX                      WBFPSX
     I              BEFQSX                      WBFQSX
     I              BEFRSX                      WBFRSX
     I              BEFSSX                      WBFSSX
     I              BEFTSX                      WBFTSX
     I              BEFUSX                      WBFUSX
     I              BEFVSX                      WBFVSX
     I              BEFWSX                      WBFWSX
     I              BEFXSX                      WBFXSX
     I              BEFYSX                      WBFYSX
     I              BENODT                      WBNODT
     I              BENPDT                      WBNPDT
     I              BENQDT                      WBNQDT
     I              BENRDT                      WBNRDT
     I              BENSDT                      WBNSDT
     I              BEBPTM                      WBBPTM
     I              BEBQTM                      WBBQTM
     I              BEBRTM                      WBBRTM
     I              BEBSTM                      WBBSTM
     I              BEBTTM                      WBBTTM
     I              BEH0NX                      WBH0NX
     I              BEH1NX                      WBH1NX
     I              BEH2NX                      WBH2NX
     I              BEH3NX                      WBH3NX
     I              BEH4NX                      WBH4NX
     I              BEC0C7                      WBC0C7
     I              BEUVST                      WBUVST
     I              BEUWST                      WBUWST
     I              BEUXST                      WBUXST
     I              BEAATM                      WBAATM
     I              BEAYNA                      WBAYNA
     I              BEA0NA                      WBA0NA
     I              BEAXDT                      WBAXDT
      *
     I@EYCPY3
      * Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                      WCAIC3
     I              EYC4NB                      WCC4NB
     I              EYQ2NB                      WCQ2NB
     I              EYJPCD                      WCJPCD
     I              EYAUC3                      WCAUC3
     I              EYQ7NB                      WCQ7NB
     I              EYOMST                      WCOMST
     I              EYD2DT                      WCD2DT
     I              EYONST                      WCONST
     I              EYOOST                      WCOOST
     I              EYOPST                      WCOPST
     I              EYAWC3                      WCAWC3
     I              EYQ8NB                      WCQ8NB
     I              EYQ9NB                      WCQ9NB
     I              EYBKC7                      WCBKC7
     I              EYUVST                      WCUVST
     I              EYUWST                      WCUWST
     I              EYUXST                      WCUXST
     I              EYAATM                      WCAATM
     I              EYAYNA                      WCAYNA
     I              EYA0NA                      WCA0NA
     I              EYAXDT                      WCAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                      WDAIC3
     I              BEC4NB                      WDC4NB
     I              BEJNCD                      WDJNCD
     I              BEANC7                      WDANC7
     I              BEBKC7                      WDBKC7
     I              BEBRTX                      WDBRTX
     I              BEHMNA                      WDHMNA
     I              BEHONA                      WDHONA
     I              BEHPNA                      WDHPNA
     I              BEHNNA                      WDHNNA
     I              BEDBCD                      WDDBCD
     I              BECKTX                      WDCKTX
     I              BEB0C7                      WDB0C7
     I              BEAETX                      WDAETX
     I              BEB1NA                      WDB1NA
     I              BEB3NA                      WDB3NA
     I              BEB4NA                      WDB4NA
     I              BEB2NA                      WDB2NA
     I              BEBHCD                      WDBHCD
     I              BEC8TX                      WDC8TX
     I              BEBCNA                      WDBCNA
     I              BEA0DT                      WDA0DT
     I              BEA5DT                      WDA5DT
     I              BEGNDT                      WDGNDT
     I              BEACDT                      WDACDT
     I              BEAQCD                      WDAQCD
     I              BEB6NA                      WDB6NA
     I              BEBYNA                      WDBYNA
     I              BEBZNA                      WDBZNA
     I              BEGTST                      WDGTST
     I              BEGVST                      WDGVST
     I              BEGUST                      WDGUST
     I              BEQFST                      WDQFST
     I              BECQCD                      WDCQCD
     I              BEGJST                      WDGJST
     I              BEGWST                      WDGWST
     I              BEGXST                      WDGXST
     I              BEGYST                      WDGYST
     I              BEAODT                      WDAODT
     I              BEAIVN                      WDAIVN
     I              BECXDT                      WDCXDT
     I              BEJZVA                      WDJZVA
     I              BEA1WG                      WDA1WG
     I              BEXIST                      WDXIST
     I              BEXJST                      WDXJST
     I              BEXKST                      WDXKST
     I              BEEIDT                      WDEIDT
     I              BEAFTM                      WDAFTM
     I              BEE8CD                      WDE8CD
     I              BEE9CD                      WDE9CD
     I              BERMNB                      WDRMNB
     I              BETBNB                      WDTBNB
     I              BER1NB                      WDR1NB
     I              BEPJST                      WDPJST
     I              BEU0ST                      WDU0ST
     I              BEU1ST                      WDU1ST
     I              BEQ2CD                      WDQ2CD
     I              BEU2ST                      WDU2ST
     I              BEVEST                      WDVEST
     I              BEVFST                      WDVFST
     I              BEVGST                      WDVGST
     I              BERPCD                      WDRPCD
     I              BERNNB                      WDRNNB
     I              BEVDST                      WDVDST
     I              BEATIN                      WDATIN
     I              BEU4ST                      WDU4ST
     I              BEU5ST                      WDU5ST
     I              BERSRN                      WDRSRN
     I              BEMHNA                      WDMHNA
     I              BEMINA                      WDMINA
     I              BEWBST                      WDWBST
     I              BER4CD                      WDR4CD
     I              BEBFCD                      WDBFCD
     I              BEQ4CD                      WDQ4CD
     I              BET3NB                      WDT3NB
     I              BESICD                      WDSICD
     I              BECONB                      WDCONB
     I              BECEST                      WDCEST
     I              BEAWDT                      WDAWDT
     I              BEJPCD                      WDJPCD
     I              BEXUST                      WDXUST
     I              BEZ1ST                      WDZ1ST
     I              BEVRVA                      WDVRVA
     I              BEOBST                      WDOBST
     I              BEBCST                      WDBCST
     I              BEBDST                      WDBDST
     I              BEB7VL                      WDB7VL
     I              BEGASX                      WDGASX
     I              BEGBSX                      WDGBSX
     I              BEGCSX                      WDGCSX
     I              BEGDSX                      WDGDSX
     I              BEFNSX                      WDFNSX
     I              BEFOSX                      WDFOSX
     I              BEFPSX                      WDFPSX
     I              BEFQSX                      WDFQSX
     I              BEFRSX                      WDFRSX
     I              BEFSSX                      WDFSSX
     I              BEFTSX                      WDFTSX
     I              BEFUSX                      WDFUSX
     I              BEFVSX                      WDFVSX
     I              BEFWSX                      WDFWSX
     I              BEFXSX                      WDFXSX
     I              BEFYSX                      WDFYSX
     I              BENODT                      WDNODT
     I              BENPDT                      WDNPDT
     I              BENQDT                      WDNQDT
     I              BENRDT                      WDNRDT
     I              BENSDT                      WDNSDT
     I              BEBPTM                      WDBPTM
     I              BEBQTM                      WDBQTM
     I              BEBRTM                      WDBRTM
     I              BEBSTM                      WDBSTM
     I              BEBTTM                      WDBTTM
     I              BEH0NX                      WDH0NX
     I              BEH1NX                      WDH1NX
     I              BEH2NX                      WDH2NX
     I              BEH3NX                      WDH3NX
     I              BEH4NX                      WDH4NX
     I              BEC0C7                      WDC0C7
     I              BEUVST                      WDUVST
     I              BEUWST                      WDUWST
     I              BEUXST                      WDUXST
     I              BEAATM                      WDAATM
     I              BEAYNA                      WDAYNA
     I              BEA0NA                      WDA0NA
     I              BEAXDT                      WDAXDT
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
     C     P1AIC3        PARM                    WP0001                         Company Number
     C     P1C4NB        PARM                    WP0002                         Order Number
     C     P1GNDT        PARM                    WP0003                         Actual Shipped
     C     P2WVST        PARM      P2WVST        WP0004                         Access Denied (
     C     P3AODT        PARM                    WP0005                         Scheduled Ship
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * ADD Ready to Confirm  XL
      * ***PLEASE READ DOCUMENTATION BEFORE CHANGING/RECOMPILING!!!***
      * WI517 DN 10/12/23-Setup Eradani's Environment Libraries.
      * Upd Setup Eradani Libs CL - /UT User Programs  * 
     C                   CALL      'PVBFUPC'                            90      Upd Setup Erada
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVBFUPC'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
     C                   Z-ADD     *ZERO         WUQ2NB                         Event Number
      * RTV Next Event Number  RT - Order Events  * 
     C                   EXSR      SARVGN
     C                   ADD       1             WUQ2NB                         Event Number
      * ***** GET SHIP TO CUSTOMER FOR ORDER *****
      * RTV PFS Close Order   RT - Order Header TRG  * 
     C                   EXSR      SBRVGN
      * CASE: LCL.Record Found USR is Record Found
      * CRT OP Order Events    CR - Order Events  * 
     C                   IF        YL0003 = 'Y'
     C                   EXSR      SCCRRC
      * CHG Ord Event & Stat.  CH - Order Header TRG  * 
     C                   EXSR      SDCHRC
     C                   END                                                    *FI
      * WI517 DN 10/04/23-Initialize 'Send Email f/Failed API U'.
     C                   MOVEL     'N'           YL0004                         Send Email f/Fa
      * WI517 DN 10/04/23-Added 'Called From Program' Input Parm.
      * - Added 'Send Email f/Failed API U' Output Parm.
      * WI609_2 JM 10/11/24-Addition of Parm SSCC Pallet ID Valid USR
      * ADD Ready to Confirm   XF - Order Detail  * 
     C                   CALL      'PDN2XFR'                            90      ADD Ready to Co
     C                   PARM      *BLANK        W0RTN
     C                   PARM      P1AIC3        WQ0001                         Company Number
     C                   PARM      P1C4NB        WQ0002                         Order Number
     C                   PARM      P1GNDT        WQ0003                         Actual Shipped
     C     P2WVST        PARM      P2WVST        WQ0004                         Access Denied (
     C                   PARM      P3AODT        WQ0005                         Scheduled Ship
     C                   PARM      @CN(001)      WQ0006                         Called From Pro
     C     YL0004        PARM      *BLANK        WQ0007                         Send Email f/Fa
     C                   PARM      *BLANK        WQ0008                         SSCC Pallet ID
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDN2XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * WI517 DN 10/04/23-If 'Send Email f/Failed API U=Yes' Then Send Em
      * CASE: LCL.Send Email f/Failed API U is Yes
      * Prc Eml Shipping & IT  XF - WIM API Failure Log  * 
     C                   IF        YL0004 = 'Y'
     C                   CALL      'PVA9XFR'                            90      Prc Eml Shippin
     C                   PARM      *BLANK        W0RTN
     C                   PARM      @CN(001)      WQ0009                         Called From Pro
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PVA9XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
     C                   END                                                    *FI
     C                   EVAL      P4E6TX = ' '                                 Company Number
     C                   MOVEL     P1AIC3        P4E6TX                         Company Number
     C                   EVAL      P4E7TX = ' '                                 Order Number Al
     C                   MOVEL     P1C4NB        P4E7TX                         Order Number Al
     C                   EVAL      P4R4TX = ' '                                 Date (Alpha) US
     C                   MOVEL     P1GNDT        P4R4TX                         Date (Alpha) US
     C                   EVAL      P4V5CD = ' '                                 Date From Alpha
     C                   MOVEL     P3AODT        P4V5CD                         Date From Alpha
      * Setup message data for message
     C                   MOVEL     P4E6TX        ZA0001                         Company Number
     C                   MOVEL     P4E7TX        ZA0002                         Order Number Al
     C                   MOVEL     P4R4TX        ZA0003                         Date (Alpha) US
     C                   MOVEL     P2WVST        ZA0004                         Access Denied (
     C                   MOVEL     P4V5CD        ZA0005                         Date From Alpha
     C                   MOVEL     W0RTN         ZA0006                         *Return code
      * Retrieve message PFS Add Ready to Conf
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   CALL      'Y2RVMGC'                            90      *
     C                   PARM      *BLANK        W0RTN                          Return code
     C                   PARM      'USR4351'     ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C     YL0005        PARM                    W0MTX                          Returned messag
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSGF = ' '
      * Setup message data for message
     C                   MOVEL     @CN(002)      ZA0007                         Pager Name USR
     C                   MOVEL     YL0005        ZA0008                         Pager Msg 256 U
     C                   MOVEL     @CN(003)      ZA0009                         Subject Line US
      *
      * Execute message
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   CALL      'Y2EXMCC'                            90      *
     C                   PARM      *BLANK        W0RTN                          Return code
     C                   PARM      'USR3113'     ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSGF = ' '
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   END
      *
      * Error detected during execution
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      *
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * RTV Next Event Number  RT - Order Events  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KPSSA         KLIST
     C                   KFLD                    WQSA01                         Company Number
     C                   KFLD                    WQSA02                         Order Number
     C                   KFLD                    WAQ2NB                         Event Number
      * Define keylist
     C     KRSSA         KLIST
     C                   KFLD                    WQSA01                         Company Number
     C                   KFLD                    WQSA02                         Order Number
      * Setup key
     C                   Z-ADD     P1AIC3        WQSA01                         Company Number
     C                   Z-ADD     P1C4NB        WQSA02                         Order Number
     C                   Z-ADD     WUQ2NB        WAQ2NB                         Event Number
      * Establish starting position
     C     KPSSA         SETLL     @EYCPY2                                      *
     C     KRSSA         READE     @EYCPY2                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR1074'     W0RTN
      * USER: Processing if Data record not found
     C                   Z-ADD     1             WUQ2NB                         Event Number
     C                   GOTO      SAEXIT
     C                   ENDIF
      *
      * USER: Process Data record
     C                   DOW       NOT *IN90
     C                   Z-ADD     WAQ2NB        WUQ2NB                         Event Number
     C     KRSSA         READE     @EYCPY2                                90    *
     C                   ENDDO
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBRVGN        BEGSR
      *================================================================
      * RTV PFS Close Order   RT - Order Header TRG  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Define keylist
     C     KRSSB         KLIST
     C                   KFLD                    WBAIC3                         Company Number
     C                   KFLD                    WBC4NB                         Order Number
      * Setup key
     C                   Z-ADD     P1AIC3        WBAIC3                         Company Number
     C                   Z-ADD     P1C4NB        WBC4NB                         Order Number
      * Establish starting position
     C     KRSSB         CHAIN     @BECPFK                            90        *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR0176'     W0RTN
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                   Z-ADD     *ZERO         YL0001                         Ship To Custome
     C                   EVAL      YL0002 = ' '                                 Header Status
     C                   EVAL      YL0003 = ' '                                 Record Found US
     C                   MOVEL     'N'           YL0003                         Record Found US
     C                   GOTO      SBEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * PAR = DB1 By name
     C                   IF        NOT *IN90
     C                   Z-ADD     WBBKC7        YL0001                         Ship To Custome
     C                   MOVEL     WBGWST        YL0002                         Header Status
     C                   MOVEL     'Y'           YL0003                         Record Found US
     C                   ENDIF
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   SCCRRC        BEGSR
      *================================================================
      * CRT OP Order Events    CR - Order Events  * 
      *================================================================
      *
     C                   EVAL      WN0001 = ' '                                 EDI Status 1
     C                   EVAL      WN0002 = ' '                                 EDI Status 2
     C                   EVAL      WN0003 = ' '                                 EDI Status 3
     C                   Z-ADD     *ZERO         WN0004                         Job Time
     C                   EVAL      WN0005 = ' '                                 User Id
     C                   EVAL      WN0006 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WN0007                         Job Date
      *
     C                   EVAL      W0RTN = ' '
      * Move all fields to @EYCPY3
     C                   Z-ADD     P1AIC3        WCAIC3                         Company Number
     C                   Z-ADD     P1C4NB        WCC4NB                         Order Number
     C                   Z-ADD     WUQ2NB        WCQ2NB                         Event Number
     C                   MOVEL     '04'          WCJPCD                         Event Code
     C                   Z-ADD     *ZERO         WCAUC3                         Invoice_Memo Co
     C                   Z-ADD     *ZERO         WCQ7NB                         Invoice_Memo Nu
     C                   MOVEL     'IN'          WCOMST                         Invoice_Memo Su
     C                   Z-ADD     ##JDT         WCD2DT                         Event Date
     C                   MOVEL     'N'           WCONST                         Activity Comple
     C                   MOVEL     'N'           WCOOST                         Activity Hold
     C                   MOVEL     'N'           WCOPST                         Post Cash Compl
     C                   Z-ADD     *ZERO         WCAWC3                         Cross Event Ref
     C                   Z-ADD     *ZERO         WCQ8NB                         Cross Event Ref
     C                   Z-ADD     *ZERO         WCQ9NB                         Cross Event Ref
     C                   Z-ADD     YL0001        WCBKC7                         Ship To Custome
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                   Z-ADD     ##JTM         WCAATM                         Job Time
     C                   MOVEL     ##USR         WCAYNA                         User Id
     C                   MOVEL     ##JOB         WCA0NA                         Job Name
     C                   Z-ADD     ##JDT         WCAXDT                         Job Date
     C     KLCRSC        KLIST
     C                   KFLD                    WCAIC3                         Company Number
     C                   KFLD                    WCC4NB                         Order Number
     C                   KFLD                    WCQ2NB                         Event Number
      * Check for duplicate primary key
     C     KLCRSC        SETLL     @EYCPY3                                90    *
     C                   IF        *IN90
     C                   MOVEL     'USR1075'     W0RTN
      * Send message 'Order Events           EX'
     C                   MOVEL     'USR1075'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      SCEXIT
     C                   ENDIF
      *
     C                   WRITE     @EYCPY3                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   SCEXIT        ENDSR
      /EJECT
     CSR   SDCHRC        BEGSR
      *================================================================
      * CHG Ord Event & Stat.  CH - Order Header TRG  * 
      *================================================================
      *
     C                   EVAL      WN0008 = ' '                                 Order Type_Sale
     C                   Z-ADD     *ZERO         WN0009                         AR Customer Num
     C                   Z-ADD     *ZERO         WN0010                         Ship To Custome
     C                   EVAL      WN0011 = ' '                                 Ship To Name
     C                   EVAL      WN0012 = ' '                                 Ship To Address
     C                   EVAL      WN0013 = ' '                                 Ship To Address
     C                   EVAL      WN0014 = ' '                                 Ship To Address
     C                   EVAL      WN0015 = ' '                                 Ship To City
     C                   EVAL      WN0016 = ' '                                 Ship To State C
     C                   EVAL      WN0017 = ' '                                 Ship To Zip_Pos
     C                   Z-ADD     *ZERO         WN0018                         Bill to Custome
     C                   EVAL      WN0019 = ' '                                 Bill to Name
     C                   EVAL      WN0020 = ' '                                 Bill to Address
     C                   EVAL      WN0021 = ' '                                 Bill to Address
     C                   EVAL      WN0022 = ' '                                 Bill to Address
     C                   EVAL      WN0023 = ' '                                 Bill to City
     C                   EVAL      WN0024 = ' '                                 Bill to State C
     C                   EVAL      WN0025 = ' '                                 Bill to Zip_Pos
     C                   EVAL      WN0026 = ' '                                 Customer Purcha
     C                   Z-ADD     *ZERO         WN0027                         Order Date
     C                   Z-ADD     *ZERO         WN0028                         Requested Ship
     C                   Z-ADD     *ZERO         WN0029                         Actual Shipped
     C                   Z-ADD     *ZERO         WN0030                         Cancel Date
     C                   EVAL      WN0031 = ' '                                 Terms Code
     C                   EVAL      WN0032 = ' '                                 Special Instruc
     C                   EVAL      WN0033 = ' '                                 Special Instruc
     C                   EVAL      WN0034 = ' '                                 Carrier Code
     C                   EVAL      WN0035 = ' '                                 Comment Print A
     C                   EVAL      WN0036 = ' '                                 Comment Print I
     C                   EVAL      WN0037 = ' '                                 Comment Print P
     C                   EVAL      WN0038 = ' '                                 Comment Print S
     C                   EVAL      WN0039 = ' '                                 Reason Code
     C                   EVAL      WN0040 = ' '                                 Order in Use
     C                   EVAL      WN0041 = ' '                                 Order Type Prin
     C                   Z-ADD     *ZERO         WN0042                         Scheduled Ship
     C                   EVAL      WN0043 = ' '                                 User Original E
     C                   Z-ADD     *ZERO         WN0044                         Date of Origina
     C                   Z-ADD     *ZERO         WN0045                         Order Value Tot
     C                   Z-ADD     *ZERO         WN0046                         Order Weight To
     C                   EVAL      WN0047 = ' '                                 Credit Hold
     C                   EVAL      WN0048 = ' '                                 Production Hold
     C                   EVAL      WN0049 = ' '                                 New Customer Ho
     C                   Z-ADD     *ZERO         WN0050                         Requested Deliv
     C                   Z-ADD     *ZERO         WN0051                         Requested Deliv
     C                   EVAL      WN0052 = ' '                                 Accounts Receiv
     C                   EVAL      WN0053 = ' '                                 Accounts Receiv
     C                   Z-ADD     *ZERO         WN0054                         Load ID
     C                   Z-ADD     *ZERO         WN0055                         Absorbed Freigh
     C                   Z-ADD     *ZERO         WN0056                         Rated Freight
     C                   EVAL      WN0057 = ' '                                 LTL Flag
     C                   EVAL      WN0058 = ' '                                 Price Audit
     C                   EVAL      WN0059 = ' '                                 Price Status
     C                   EVAL      WN0060 = ' '                                 Shipping Method
     C                   EVAL      WN0061 = ' '                                 Export Status
     C                   EVAL      WN0062 = ' '                                 Palletize
     C                   EVAL      WN0063 = ' '                                 Shrink Wrap
     C                   EVAL      WN0064 = ' '                                 Slip Sheet
     C                   EVAL      WN0065 = ' '                                 Age Code
     C                   Z-ADD     *ZERO         WN0066                         Reefer Temperat
     C                   EVAL      WN0067 = ' '                                 Load Type
     C                   Z-ADD     *ZERO         WN0068                         Attach to Invoi
     C                   EVAL      WN0069 = ' '                                 Load Plan Order
     C                   EVAL      WN0070 = ' '                                 Print Pick Slip
     C                   Z-ADD     *ZERO         WN0071                         Resell Referenc
     C                   EVAL      WN0072 = ' '                                 Special Comment
     C                   EVAL      WN0073 = ' '                                 Special Comment
     C                   EVAL      WN0074 = ' '                                 Affect Auto Acc
     C                   EVAL      WN0075 = ' '                                 Sales Route Cod
     C                   EVAL      WN0076 = ' '                                 Manager Level C
     C                   EVAL      WN0077 = ' '                                 VP Level Code
     C                   Z-ADD     *ZERO         WN0078                         Attach to Order
     C                   EVAL      WN0079 = ' '                                 Reason for Pric
     C                   Z-ADD     *ZERO         WN0080                         Invoice Number
     C                   EVAL      WN0081 = ' '                                 Invoice Suffix
     C                   Z-ADD     *ZERO         WN0082                         Invoice Date
     C                   EVAL      WN0083 = ' '                                 Trans Contol AS
     C                   EVAL      WN0084 = ' '                                 Modified Flag
     C                   Z-ADD     *ZERO         WN0085                         A_R order Value
     C                   EVAL      WN0086 = ' '                                 Billing Activit
     C                   EVAL      WN0087 = ' '                                 Block Order Fla
     C                   EVAL      WN0088 = ' '                                 Order Certifica
     C                   Z-ADD     *ZERO         WN0089                         Invoice Order V
     C                   EVAL      WN0090 = ' '                                 Process Sts for
     C                   EVAL      WN0091 = ' '                                 Order Conf Fax
     C                   EVAL      WN0092 = ' '                                 Manifest Fax St
     C                   EVAL      WN0093 = ' '                                 Invoice Fax Sts
     C                   EVAL      WN0094 = ' '                                 Transfer in Sto
     C                   EVAL      WN0095 = ' '                                 Email Cust On O
     C                   EVAL      WN0096 = ' '                                 Order Emailed
     C                   EVAL      WN0097 = ' '                                 Export Docs Go
     C                   EVAL      WN0098 = ' '                                 Shipping Temp C
     C                   EVAL      WN0099 = ' '                                 Broker Order St
     C                   EVAL      WN0100 = ' '                                 Air Freight Ord
     C                   EVAL      WN0101 = ' '                                 Order Requires
     C                   EVAL      WN0102 = ' '                                 OH Load Plan Re
     C                   EVAL      WN0103 = ' '                                 Export USDA App
     C                   EVAL      WN0104 = ' '                                 HPB Ship to War
     C                   EVAL      WN0105 = ' '                                 OH TF Exempt Co
     C                   Z-ADD     *ZERO         WN0106                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WN0107                         JPN Invoice Iss
     C                   Z-ADD     *ZERO         WN0108                         Load Actual Shi
     C                   Z-ADD     *ZERO         WN0109                         Load BOL Comple
     C                   Z-ADD     *ZERO         WN0110                         Load Truck Depa
     C                   Z-ADD     *ZERO         WN0111                         Maximum Gross W
     C                   Z-ADD     *ZERO         WN0112                         Time of Origina
     C                   Z-ADD     *ZERO         WN0113                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WN0114                         Load BOL Comple
     C                   Z-ADD     *ZERO         WN0115                         Load Truck Depa
     C                   Z-ADD     *ZERO         WN0116                         Act Frt Referen
     C                   Z-ADD     *ZERO         WN0117                         Act Non_Ref Frt
     C                   Z-ADD     *ZERO         WN0118                         OH Fuel Surchar
     C                   Z-ADD     *ZERO         WN0119                         OH Total Non_Re
     C                   Z-ADD     *ZERO         WN0120                         OH Total Ref Fr
     C                   Z-ADD     *ZERO         WN0121                         Claim Number
     C                   EVAL      WN0122 = ' '                                 EDI Status 1
     C                   EVAL      WN0123 = ' '                                 EDI Status 2
     C                   EVAL      WN0124 = ' '                                 EDI Status 3
     C                   Z-ADD     *ZERO         WN0125                         Job Time
     C                   EVAL      WN0126 = ' '                                 User Id
     C                   EVAL      WN0127 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WN0128                         Job Date
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YARDC = ' '
      *
      * Move key fields to @BECPFJ
     C                   Z-ADD     P1AIC3        WDAIC3                         Company Number
     C                   Z-ADD     P1C4NB        WDC4NB                         Order Number
      *
     C     KLCHSD        KLIST
     C                   KFLD                    WDAIC3                         Company Number
     C                   KFLD                    WDC4NB                         Order Number
     C     KLCHSD        CHAIN     @BECPFJ                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'OPBFCPL0'    MDACP
     C                   MOVEL     '@BECPFJ'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL001.
     C                   MOVEL     'LBL001'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SDEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SDEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QOPBF1        YARDCS
      * Move non-key fields to @BECPFJ
     C                   MOVEL(P)  'R'           WDGWST                         Header Status
     C                   MOVEL(P)  YL0002        WDGXST                         Header Status L
     C                   MOVEL(P)  '04'          WDJPCD                         Event Code
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QOPBF1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                   Z-ADD     ##JTM         WDAATM                         Job Time
     C                   MOVEL     ##USR         WDAYNA                         User Id
     C                   MOVEL     ##PGM         WDA0NA                         Job Name
     C                   Z-ADD     ##JDT         WDAXDT                         Job Date
      * TRG Order Hdr CHG Trig XT - Order Header TRG  * 
     C                   CLEAR                   PARC
     C                   Z-ADD     WDAIC3        PAAIC3                         Company Number
     C                   Z-ADD     WDC4NB        PAC4NB                         Order Number
     C                   MOVEL(P)  WDJNCD        PAJNCD                         Order Type_Sale
     C                   Z-ADD     WDANC7        PAANC7                         AR Customer Num
     C                   Z-ADD     WDBKC7        PABKC7                         Ship To Custome
     C                   MOVEL(P)  WDBRTX        PABRTX                         Ship To Name
     C                   MOVEL(P)  WDHMNA        PAHMNA                         Ship To Address
     C                   MOVEL(P)  WDHONA        PAHONA                         Ship To Address
     C                   MOVEL(P)  WDHPNA        PAHPNA                         Ship To Address
     C                   MOVEL(P)  WDHNNA        PAHNNA                         Ship To City
     C                   MOVEL(P)  WDDBCD        PADBCD                         Ship To State C
     C                   MOVEL(P)  WDCKTX        PACKTX                         Ship To Zip_Pos
     C                   Z-ADD     WDB0C7        PAB0C7                         Bill to Custome
     C                   MOVEL(P)  WDAETX        PAAETX                         Bill to Name
     C                   MOVEL(P)  WDB1NA        PAB1NA                         Bill to Address
     C                   MOVEL(P)  WDB3NA        PAB3NA                         Bill to Address
     C                   MOVEL(P)  WDB4NA        PAB4NA                         Bill to Address
     C                   MOVEL(P)  WDB2NA        PAB2NA                         Bill to City
     C                   MOVEL(P)  WDBHCD        PABHCD                         Bill to State C
     C                   MOVEL(P)  WDC8TX        PAC8TX                         Bill to Zip_Pos
     C                   MOVEL(P)  WDBCNA        PABCNA                         Customer Purcha
     C                   Z-ADD     WDA0DT        PAA0DT                         Order Date
     C                   Z-ADD     WDA5DT        PAA5DT                         Requested Ship
     C                   Z-ADD     WDGNDT        PAGNDT                         Actual Shipped
     C                   Z-ADD     WDACDT        PAACDT                         Cancel Date
     C                   MOVEL(P)  WDAQCD        PAAQCD                         Terms Code
     C                   MOVEL(P)  WDB6NA        PAB6NA                         Special Instruc
     C                   MOVEL(P)  WDBYNA        PABYNA                         Special Instruc
     C                   MOVEL(P)  WDBZNA        PABZNA                         Carrier Code
     C                   MOVEL(P)  WDGTST        PAGTST                         Comment Print A
     C                   MOVEL(P)  WDGVST        PAGVST                         Comment Print I
     C                   MOVEL(P)  WDGUST        PAGUST                         Comment Print P
     C                   MOVEL(P)  WDQFST        PAQFST                         Comment Print S
     C                   MOVEL(P)  WDCQCD        PACQCD                         Reason Code
     C                   MOVEL(P)  WDGJST        PAGJST                         Order in Use
     C                   MOVEL(P)  WDGWST        PAGWST                         Header Status
     C                   MOVEL(P)  WDGXST        PAGXST                         Header Status L
     C                   MOVEL(P)  WDGYST        PAGYST                         Order Type Prin
     C                   Z-ADD     WDAODT        PAAODT                         Scheduled Ship
     C                   MOVEL(P)  WDAIVN        PAAIVN                         User Original E
     C                   Z-ADD     WDCXDT        PACXDT                         Date of Origina
     C                   Z-ADD     WDJZVA        PAJZVA                         Order Value Tot
     C                   Z-ADD     WDA1WG        PAA1WG                         Order Weight To
     C                   MOVEL(P)  WDXIST        PAXIST                         Credit Hold
     C                   MOVEL(P)  WDXJST        PAXJST                         Production Hold
     C                   MOVEL(P)  WDXKST        PAXKST                         New Customer Ho
     C                   Z-ADD     WDEIDT        PAEIDT                         Requested Deliv
     C                   Z-ADD     WDAFTM        PAAFTM                         Requested Deliv
     C                   MOVEL(P)  WDE8CD        PAE8CD                         Accounts Receiv
     C                   MOVEL(P)  WDE9CD        PAE9CD                         Accounts Receiv
     C                   Z-ADD     WDRMNB        PARMNB                         Load ID
     C                   Z-ADD     WDTBNB        PATBNB                         Absorbed Freigh
     C                   Z-ADD     WDR1NB        PAR1NB                         Rated Freight
     C                   MOVEL(P)  WDPJST        PAPJST                         LTL Flag
     C                   MOVEL(P)  WDU0ST        PAU0ST                         Price Audit
     C                   MOVEL(P)  WDU1ST        PAU1ST                         Price Status
     C                   MOVEL(P)  WDQ2CD        PAQ2CD                         Shipping Method
     C                   MOVEL(P)  WDU2ST        PAU2ST                         Export Status
     C                   MOVEL(P)  WDVEST        PAVEST                         Palletize
     C                   MOVEL(P)  WDVFST        PAVFST                         Shrink Wrap
     C                   MOVEL(P)  WDVGST        PAVGST                         Slip Sheet
     C                   MOVEL(P)  WDRPCD        PARPCD                         Age Code
     C                   Z-ADD     WDRNNB        PARNNB                         Reefer Temperat
     C                   MOVEL(P)  WDVDST        PAVDST                         Load Type
     C                   Z-ADD     WDATIN        PAATIN                         Attach to Invoi
     C                   MOVEL(P)  WDU4ST        PAU4ST                         Load Plan Order
     C                   MOVEL(P)  WDU5ST        PAU5ST                         Print Pick Slip
     C                   Z-ADD     WDRSRN        PARSRN                         Resell Referenc
     C                   MOVEL(P)  WDMHNA        PAMHNA                         Special Comment
     C                   MOVEL(P)  WDMINA        PAMINA                         Special Comment
     C                   MOVEL(P)  WDWBST        PAWBST                         Affect Auto Acc
     C                   MOVEL(P)  WDR4CD        PAR4CD                         Sales Route Cod
     C                   MOVEL(P)  WDBFCD        PABFCD                         Manager Level C
     C                   MOVEL(P)  WDQ4CD        PAQ4CD                         VP Level Code
     C                   Z-ADD     WDT3NB        PAT3NB                         Attach to Order
     C                   MOVEL(P)  WDSICD        PASICD                         Reason for Pric
     C                   Z-ADD     WDCONB        PACONB                         Invoice Number
     C                   MOVEL(P)  WDCEST        PACEST                         Invoice Suffix
     C                   Z-ADD     WDAWDT        PAAWDT                         Invoice Date
     C                   MOVEL(P)  WDJPCD        PAJPCD                         Event Code
     C                   MOVEL(P)  WDXUST        PAXUST                         Trans Contol AS
     C                   MOVEL(P)  WDZ1ST        PAZ1ST                         Modified Flag
     C                   Z-ADD     WDVRVA        PAVRVA                         A_R order Value
     C                   MOVEL(P)  WDOBST        PAOBST                         Billing Activit
     C                   MOVEL(P)  WDBCST        PABCST                         Block Order Fla
     C                   MOVEL(P)  WDBDST        PABDST                         Order Certifica
     C                   Z-ADD     WDB7VL        PAB7VL                         Invoice Order V
     C                   MOVEL(P)  WDGASX        PAGASX                         Process Sts for
     C                   MOVEL(P)  WDGBSX        PAGBSX                         Order Conf Fax
     C                   MOVEL(P)  WDGCSX        PAGCSX                         Manifest Fax St
     C                   MOVEL(P)  WDGDSX        PAGDSX                         Invoice Fax Sts
     C                   MOVEL(P)  WDFNSX        PAFNSX                         Transfer in Sto
     C                   MOVEL(P)  WDFOSX        PAFOSX                         Email Cust On O
     C                   MOVEL(P)  WDFPSX        PAFPSX                         Order Emailed
     C                   MOVEL(P)  WDFQSX        PAFQSX                         Export Docs Go
     C                   MOVEL(P)  WDFRSX        PAFRSX                         Shipping Temp C
     C                   MOVEL(P)  WDFSSX        PAFSSX                         Broker Order St
     C                   MOVEL(P)  WDFTSX        PAFTSX                         Air Freight Ord
     C                   MOVEL(P)  WDFUSX        PAFUSX                         Order Requires
     C                   MOVEL(P)  WDFVSX        PAFVSX                         OH Load Plan Re
     C                   MOVEL(P)  WDFWSX        PAFWSX                         Export USDA App
     C                   MOVEL(P)  WDFXSX        PAFXSX                         HPB Ship to War
     C                   MOVEL(P)  WDFYSX        PAFYSX                         OH TF Exempt Co
     C                   Z-ADD     WDNODT        PANODT                         OH Appt Confirm
     C                   Z-ADD     WDNPDT        PANPDT                         JPN Invoice Iss
     C                   Z-ADD     WDNQDT        PANQDT                         Load Actual Shi
     C                   Z-ADD     WDNRDT        PANRDT                         Load BOL Comple
     C                   Z-ADD     WDNSDT        PANSDT                         Load Truck Depa
     C                   Z-ADD     WDBPTM        PABPTM                         Maximum Gross W
     C                   Z-ADD     WDBQTM        PABQTM                         Time of Origina
     C                   Z-ADD     WDBRTM        PABRTM                         OH Appt Confirm
     C                   Z-ADD     WDBSTM        PABSTM                         Load BOL Comple
     C                   Z-ADD     WDBTTM        PABTTM                         Load Truck Depa
     C                   Z-ADD     WDH0NX        PAH0NX                         Act Frt Referen
     C                   Z-ADD     WDH1NX        PAH1NX                         Act Non_Ref Frt
     C                   Z-ADD     WDH2NX        PAH2NX                         OH Fuel Surchar
     C                   Z-ADD     WDH3NX        PAH3NX                         OH Total Non_Re
     C                   Z-ADD     WDH4NX        PAH4NX                         OH Total Ref Fr
     C                   Z-ADD     WDC0C7        PAC0C7                         Claim Number
     C                   MOVEL(P)  WDUVST        PAUVST                         EDI Status 1
     C                   MOVEL(P)  WDUWST        PAUWST                         EDI Status 2
     C                   MOVEL(P)  WDUXST        PAUXST                         EDI Status 3
     C                   Z-ADD     WDAATM        PAAATM                         Job Time
     C                   MOVEL(P)  WDAYNA        PAAYNA                         User Id
     C                   MOVEL(P)  WDA0NA        PAA0NA                         Job Name
     C                   Z-ADD     WDAXDT        PAAXDT                         Job Date
      *
     C                   CALL      'PDW9XFR'                            90      TRG Order Hdr C
     C                   PARM      *BLANK        W0RTN
     C                   PARM                    PARC                           RCD: Order Head
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDW9XFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * Set PGM.*Record Data Changed flag
     C                   IF        QOPBF1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YARDC = 'Y'
     C                   UPDATE    @BECPFJ                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    OPBFCPL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SDEXIT        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
      * If no message file specified, use default
     C                   IF        ZAMSGF = ' '
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      *
      * Clear all neither parameters
     C                   EVAL      P4E6TX = ' '                                 Company Number
     C                   EVAL      P4E7TX = ' '                                 Order Number Al
     C                   EVAL      P4R4TX = ' '                                 Date (Alpha) US
     C                   EVAL      P4V5CD = ' '                                 Date From Alpha
      *
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Define work field Event Number
     C                   Z-ADD     *ZERO         WUQ2NB
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAAIC3                         Company Number
     C                   Z-ADD     *ZERO         WAC4NB                         Order Number
     C                   Z-ADD     *ZERO         WAQ2NB                         Event Number
     C                   Z-ADD     *ZERO         WAAUC3                         Invoice_Memo Co
     C                   Z-ADD     *ZERO         WAQ7NB                         Invoice_Memo Nu
     C                   Z-ADD     *ZERO         WAD2DT                         Event Date
     C                   Z-ADD     *ZERO         WAAWC3                         Cross Event Ref
     C                   Z-ADD     *ZERO         WAQ8NB                         Cross Event Ref
     C                   Z-ADD     *ZERO         WAQ9NB                         Cross Event Ref
     C                   Z-ADD     *ZERO         WABKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WAAATM                         Job Time
     C                   Z-ADD     *ZERO         WAAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WBAIC3                         Company Number
     C                   Z-ADD     *ZERO         WBC4NB                         Order Number
     C                   Z-ADD     *ZERO         WBANC7                         AR Customer Num
     C                   Z-ADD     *ZERO         WBBKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WBB0C7                         Bill to Custome
     C                   Z-ADD     *ZERO         WBA0DT                         Order Date
     C                   Z-ADD     *ZERO         WBA5DT                         Requested Ship
     C                   Z-ADD     *ZERO         WBGNDT                         Actual Shipped
     C                   Z-ADD     *ZERO         WBACDT                         Cancel Date
     C                   Z-ADD     *ZERO         WBAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         WBCXDT                         Date of Origina
     C                   Z-ADD     *ZERO         WBJZVA                         Order Value Tot
     C                   Z-ADD     *ZERO         WBA1WG                         Order Weight To
     C                   Z-ADD     *ZERO         WBEIDT                         Requested Deliv
     C                   Z-ADD     *ZERO         WBAFTM                         Requested Deliv
     C                   Z-ADD     *ZERO         WBRMNB                         Load ID
     C                   Z-ADD     *ZERO         WBTBNB                         Absorbed Freigh
     C                   Z-ADD     *ZERO         WBR1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WBRNNB                         Reefer Temperat
     C                   Z-ADD     *ZERO         WBATIN                         Attach to Invoi
     C                   Z-ADD     *ZERO         WBRSRN                         Resell Referenc
     C                   Z-ADD     *ZERO         WBT3NB                         Attach to Order
     C                   Z-ADD     *ZERO         WBCONB                         Invoice Number
     C                   Z-ADD     *ZERO         WBAWDT                         Invoice Date
     C                   Z-ADD     *ZERO         WBVRVA                         A_R order Value
     C                   Z-ADD     *ZERO         WBB7VL                         Invoice Order V
     C                   Z-ADD     *ZERO         WBNODT                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WBNPDT                         JPN Invoice Iss
     C                   Z-ADD     *ZERO         WBNQDT                         Load Actual Shi
     C                   Z-ADD     *ZERO         WBNRDT                         Load BOL Comple
     C                   Z-ADD     *ZERO         WBNSDT                         Load Truck Depa
     C                   Z-ADD     *ZERO         WBBPTM                         Maximum Gross W
     C                   Z-ADD     *ZERO         WBBQTM                         Time of Origina
     C                   Z-ADD     *ZERO         WBBRTM                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WBBSTM                         Load BOL Comple
     C                   Z-ADD     *ZERO         WBBTTM                         Load Truck Depa
     C                   Z-ADD     *ZERO         WBH0NX                         Act Frt Referen
     C                   Z-ADD     *ZERO         WBH1NX                         Act Non_Ref Frt
     C                   Z-ADD     *ZERO         WBH2NX                         OH Fuel Surchar
     C                   Z-ADD     *ZERO         WBH3NX                         OH Total Non_Re
     C                   Z-ADD     *ZERO         WBH4NX                         OH Total Ref Fr
     C                   Z-ADD     *ZERO         WBC0C7                         Claim Number
     C                   Z-ADD     *ZERO         WBAATM                         Job Time
     C                   Z-ADD     *ZERO         WBAXDT                         Job Date
      * Clear all neither parameters
      * CRT OP Order Events    CR - Order Events  * 
     C                   Z-ADD     *ZERO         WCAATM                         Job Time
     C                   Z-ADD     *ZERO         WCAXDT                         Job Date
      * Obtain default message file
     C     *DTAARA       DEFINE    CAMGFLA       ZADFMF
     C                   IN        ZADFMF
      * Dummy move for compiler
     C                   MOVE      '0'           @CN#(1)
     C                   MOVEL     @CN(1)        @CN(1)
     C                   MOVEL     'N'           W0PMT
      * Define local work field Ship To Customer
     C                   Z-ADD     *ZERO         YL0001
      * Define local work field Header Status Last
     C                   EVAL      YL0002 = ' '
      * Define local work field Record Found USR
     C                   EVAL      YL0003 = ' '
      * Define local work field Send Email f/Failed API U
     C                   EVAL      YL0004 = ' '
      * Define local work field Pager Msg 256 USR
     C                   EVAL      YL0005 = ' '
      *================================================================
     CSR   ZZEXIT        ENDSR
** @CN
00001 PNTKXFR
00002 PRKDEV3
00003 Add Ready to Confirm
