PGM       PARM(&RTNCDE &FUNCTION)
/*T: Output file for DSPOBJD   By User/Object */
/*Z: CRTCLPGM */

/*H: Generated by  : SYNON/2P  Version:  1035 */
/*H: Company       : HPEDEVMDL                     n */
/*H: System        : HPEDEVMDL */
/*H: User name     : ISRCENT */
/*H: Date          : 09/25/98  Time  : 09:32:28 */
/*H: Copyright     : HPEDEVMDL                     n */
/*H:  */
/*============================================================*/
/*M: Maintenance   : */
/*============================================================*/
DCL       &RTNCDE        *CHAR     7    /* O: Return Code */
DCL       &FUNCTION      *CHAR     3    /* I: Requested function */
DCL       &MSGDTA        *CHAR     132
DCL       &MSGID         *CHAR     7
DCL       &MSGF          *CHAR     10
DCL       &MSGFLIB       *CHAR     10

          MONMSG MSGID(CPF0000) EXEC(GOTO ERROR)

          CHGVAR &RTNCDE ' '
          CHGVAR &MSGID  ' '

          IF   (&FUNCTION = OPN) +
          THEN(DO)
             OPNQRYF +
               FILE(HPEALLL5) +
               OPTION(*INP) +
               FORMAT(HPEALL5) +
               KEYFLD( +
                      ODCRTU +
                      ODLBNM +
                      ODOBNM +
                      ODOBTP +
                      ODOBAT +
                   ) +
               UNIQUEKEY(*NONE) +
               OPTIMIZE(*ALLIO  ) +
               SEQONLY(*NO) +
               TYPE(*PERM)
          ENDDO
          ELSE DO
             CLOF OPNID(HPEALLL5)
          ENDDO

EXITPGM:
          IF (&MSGID¬= ' ') DO
             SNDPGMMSG MSGID(&MSGID) +
                       MSGF(&MSGFLIB/&MSGF) +
                       MSGDTA(&MSGDTA) +
                       MSGTYPE(*ESCAPE)
             MONMSG MSGID(CPF0000)
          ENDDO
          RMVMSG CLEAR(*ALL)
          MONMSG MSGID(CPF0000)
          RETURN

ERROR:
          CHGVAR &RTNCDE YYY9999
          RCVMSG MSGTYPE(*EXCP) +
                 MSGDTA(&MSGDTA) MSGID(&MSGID) +
                 MSGF(&MSGF) MSGFLIB(&MSGFLIB)
          MONMSG MSGID(CPF0000)

          GOTO EXITPGM
ENDPGM
