/********************************************************************/
/*                                                                  */
/*                                                                  */
/* Program name . . . . . . . . . . . . . . :   PDX9CLPJ          PN*/
/* Library name . . . . . . . . . . . . . . :   OMSDEVGEN         PL*/
/*                                                                ED*/
/*  SYNOPSIS - THIS CALLS THE DAILY HOLDOVER REPORT FROM THE JOB   */
/*             SCHEDULER PER GARY M'S REQUEST                       */
/*                                                                  */
/*  SYSTEM    - ORDER MANAGEMENT SYSTEM                             */
/*  PROGRAM   - PRINT DAILY HOLDOVER REPORT FROM JOB SCHEDULER      */
/*  DATE      -  2/18/09                                            */
/*                                                                  */
/*      PARAMETERS RECEIVED:                                        */
/*                                                                  */
/********************************************************************/
/* MODIFICATION:                                                    */
/* RMC 6/01/09 CREATED 2ND EMAIL LIST FOR 960 SO THEY CAN HAVE      */
/*             DIFF RECIPS                                          */
/* 05/05/2014 RMC E003072  PASS IN "TARGET DEILVERY DATE" FOR LJB   */
/* 03/05/2015 LJB E003914  ADD CARRIER CODE AND PASS IT AS BLANKS   */
/* 04/17/2015 LJB E004076  SEND Y/N FLAG ADDED, NOT USED HERE       */
/* 02/16/2017 JBB E9064    Add Processing for company 440           */
/* 06/12/2017 RMC E09064   SEND 440 IF SEND FLAG IS YES             */
/* 10/11/2017 RMC S11838   SEND 440 ALWAYS -- LIVE NOW              */
/********************************************************************/
 PDX9CLPJ:   PGM

             DCL        VAR(&COMP) TYPE(*DEC) LEN(3) VALUE(360)
             DCL        &PDATE      *DEC
             DCL        &TDATE      *DEC
             DCL        &PDATE2     *DEC    7 0
             DCL        &TDATE2     *DEC    7 0
             DCL        &DAYS       *DEC    3 0
             DCL        &DAYS2      *DEC    8 0
             DCL        &DATE       *CHAR   7
             DCL        &JOBDTE     *CHAR   7
             DCL        &JOBDATE    *CHAR   6
             DCL        &CARRIER    *CHAR   3  VALUE('   ')
E004076:     DCL        &SENDYN     *CHAR   1
E004076_2:   DCL        VAR(&EMAIL)   TYPE(*CHAR) LEN(50)
             DCL        VAR(&EMAIL1)  TYPE(*CHAR) LEN(25)
             DCL        VAR(&EMAIL2)  TYPE(*CHAR) LEN(25)
             DCL        VAR(&RECIP)   TYPE(*CHAR) LEN(40)
             DCL        VAR(&SUBJECT) TYPE(*CHAR) LEN(40)

             RTVJOBA    DATE(&JOBDATE)
             CVTDAT     DATE(&JOBDATE) TOVAR(&JOBDTE) FROMFMT(*MDY) +
                          TOFMT(*CYMD) TOSEP(*NONE)
             CHGVAR     VAR(&DATE) VALUE(&JOBDTE)
             MONMSG     MSGID(CPF0000)

             CHGVAR     VAR(&TDATE) VALUE(&DATE)
             CHGVAR     VAR(&DAYS) VALUE(1)
             CHGVAR     VAR(&TDATE2) VALUE(&TDATE)
             CALL       PGM(POE7XFR) PARM(' ' &COMP &TDATE2 &DAYS +
                          &PDATE2)

             CHGVAR     VAR(&DAYS2) VALUE(3)
             CALL       PGM(PDNKXFR) PARM(' ' &TDATE2 &COMP &PDATE2 +
                          &DAYS2)
             CHGVAR     VAR(&PDATE) VALUE(&PDATE2)
/*------------------------------------------------------------------*/
/* DAILY HOLDOVER FOR PREVIOUS DAY WITH REPORT TYPE = 1             */
/*------------------------------------------------------------------*/
             CHGVAR     VAR(&SENDYN) VALUE(' ')
             CHGVAR     VAR(&PDATE) VALUE(&PDATE2)

/*----------- C O M P A N Y   3 6 0   P R O C E S S I N G ----------*/
             CALL       PGM(PDX9CLP) PARM(360.00000 &PDATE 0.00000 +
                          '1' 0.00000 0.00000 'QPRINT2' '*NO' '*NO' +
                          1.00000 '*JOBD' 'GB1' ' ' ' ' ' ' ' ' ' ' +
                          ' ' ' ' ' ' ' ' 'O' 0.00000 '   ' &SENDYN +
                          &EMAIL1 &EMAIL2)
             CHGVAR     VAR(&RECIP) VALUE('prk hold over 360')
             CHGVAR     VAR(&SUBJECT) VALUE('360 Hold Over Report')
             ESEND/ESNDMAIL RECIPIENT(&RECIP) SUBJECT(&SUBJECT) +
                          ATTLIST((* *DFT *N PDX9PFR$))
             MONMSG     MSGID(CPF0000)

/*----------- C O M P A N Y   4 4 0   P R O C E S S I N G ----------*/
             CALL       PGM(PDX9CLP) PARM(440.00000 &PDATE 0.00000 +
                          '1' 0.00000 0.00000 'QPRINT2' '*NO' '*NO' +
                          1.00000 '*JOBD' 'STB' ' ' ' ' ' ' ' ' ' ' +
                          ' ' ' ' ' ' ' ' 'O' 0.00000 '   ' &SENDYN +
                          &EMAIL1 &EMAIL2)
   /*        IF         COND(&SENDYN *EQ 'Y') THEN(DO)           */
             CHGVAR     VAR(&RECIP) VALUE('prk hold over 440')
             CHGVAR     VAR(&SUBJECT) VALUE('440 Hold Over Report')
             ESEND/ESNDMAIL RECIPIENT(&RECIP) SUBJECT(&SUBJECT) +
                          ATTLIST((* *DFT *N PDX9PFR$))
             MONMSG     MSGID(CPF0000)
  /*         ENDDO                                                 */

/*----------- C O M P A N Y   9 6 0   P R O C E S S I N G ----------*/

             CALL       PGM(PDX9CLP) PARM(960.00000 &PDATE 0.00000 +
                          '1' 0.00000 0.00000 'QPRINT2' '*NO' '*NO' +
                          1.00000 '*JOBD' 'SB1' ' ' ' ' ' ' ' ' ' ' +
                          ' ' ' ' ' ' ' ' 'O' 0.00000 '   ' &SENDYN +
                          &EMAIL1 &EMAIL2)
             CHGVAR     VAR(&RECIP) VALUE('prk hold over 960')
             CHGVAR     VAR(&SUBJECT) VALUE('960 Hold Over Report')
             ESEND/ESNDMAIL RECIPIENT(&RECIP) SUBJECT(&SUBJECT) +
                          ATTLIST((* *DFT *N PDX9PFR$))
             MONMSG     MSGID(CPF0000)

 END:        ENDPGM
