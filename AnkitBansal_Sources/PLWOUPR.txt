/***************************************************************** */
/*                                                                 */
/*  PROGRAM NUMBER:  PLWJUPR                                       */
/*  PROGRAM NAME:    Clp Hot Wgt Data SrcS UP                      */
/*  PROGRAMMER:      Julius High                                   */
/*  CREATE DATE:     12/29/2014                                    */
/*                                                                 */
/*  FUNCTION:        This CLP  calls the SEQUEL Viewpoint          */
/*                   HOTWGTSM - Hog Weight Data Summary  and send  */
/*                   XLS to user for specified Kill Date Range.    */
/*                                                                 */
/*******************************************************************/
/*  Modification History                                           */
/*                  E3773 JJH 12/29/14 - Create CLP                */
/*                                                                 */
/***************************************************************** */
             PGM        PARM(&COMA &KILLDTFMA &KILLDTTOA &EMAILADR +
                          &KILLDTTXT)

/*-----------------------------------------------------------------*/
/*                      PARAMETER                                  */
/*-----------------------------------------------------------------*/
/* Function Specific                                               */
             DCL        VAR(&COMA)      TYPE(*CHAR) LEN(3)
             DCL        VAR(&KILLDTFMA) TYPE(*CHAR) LEN(7)
             DCL        VAR(&KILLDTTOA) TYPE(*CHAR) LEN(7)
             DCL        VAR(&EMAILADR)  TYPE(*CHAR) LEN(50)
             DCL        VAR(&KILLDTTXT) TYPE(*CHAR) LEN(25)

/*-----------------------------------------------------------------*/
/* Program Variables                                               */
             DCL        VAR(&COM)       TYPE(*DEC) LEN(3)
             DCL        VAR(&KILLDTFM)  TYPE(*DEC) LEN(7)
             DCL        VAR(&KILLDTTO)  TYPE(*DEC) LEN(7)
             DCL        VAR(&TEXTPD)    TYPE(*CHAR) LEN(50)
             DCL        VAR(&TEXTDL)    TYPE(*CHAR) LEN(50)
             DCL        VAR(&TEXT)      TYPE(*CHAR) LEN(50)


/*-----------------------------------------------------------------*/
/* Initialization                                                  */
/*-----------------------------------------------------------------*/
/*                           MAIN                                  */
/*-----------------------------------------------------------------*/

/* Build Eval Trans UPL ERP Sum (PLB7CPP) Work File in QTEMP       */

             CHGVAR     VAR(&COM) VALUE(&COMA)
             CHGVAR     VAR(&KILLDTFM) VALUE(&KILLDTFMA)
             CHGVAR     VAR(&KILLDTTO) VALUE(&KILLDTTOA)

             CALL       PGM(PLWPXFR) PARM('' &COM &KILLDTFM &KILLDTTO)
/*******************************************************************/
/* Create Excel Spreadsheet with SEQUEL Viewpoint and email to     */
/* receipient(s).                                                  */

/* Setup email to send Hot Weight Data Summary - Excel Spread Sheet*/
             CHGVAR     VAR(&TEXTPD) VALUE('Hot Scale Data Period +
                          Summary')
             CHGVAR     VAR(&TEXTDL) VALUE('Hot Scale Data Daily +
                          Summary')
             CHGVAR     VAR(&TEXT) VALUE('Hot Scale Data Summary +
                          for ' *CAT &KILLDTTXT)

/*           EXECUTE    VIEW(HOTWGTDT) PCFMT(*XLS) +               */
/*                        RECIPIENT(&EMAILADR) EMLMSG(&TEXT) +     */
/*                        SETVAR((&COMPANY &COMA) (&SEL_DATE +     */
/*                        &KILLDTA)) TEXT(&TEXT)                   */

             MONMSG     MSGID(CPF0000)

/*-----------------------------------------------------------------*/
/*                      PROGRAM END                                */
/*-----------------------------------------------------------------*/
 ENDPGM:
             ENDPGM
