// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PDPMSRR
// ?Date: 14.08.2025 Time: 03:32:45
// ?------------------------------------------------------------------------------------------------

//?USER: Load subfile record from DBF record

// PGM.*Record selected = CND.*YES
PGM.*Record_selected = 'Y';

//?Select only orders to be invoiced
CASE;

// IF DB1.Billing Activity Type is Invoice
IF DB1.Billing_Activity_Type = '1';

//?Select only orders to be invoiced
// IF *OTHERWISE
IF *OTHERWISE;

// PGM.*Record selected = CND.*NO
PGM.*Record_selected = 'N';

ENDIF;

//?Omit Closed or Cancelled orders
CASE;

// IF DB1.Header Status is Closed or Cancelled
IF DB1.Header_Status = 'X'/'C';

// PGM.*Record selected = CND.*NO
PGM.*Record_selected = 'N';

ENDIF;

//?Omit records Invoiced through History
CASE;

// IF DB1.Event Code is Invoiced thru History
IF DB1.Event_Code >= '06';
AND DB1.Event_Code <= '07';

// PGM.*Record selected = CND.*NO
PGM.*Record_selected = 'N';

ENDIF;

