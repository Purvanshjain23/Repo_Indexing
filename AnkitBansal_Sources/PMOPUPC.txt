/***************************************************************** */
/*                                                                 */
/*  PROGRAM NUMBER:  PMOPUPC                                       */
/*  PROGRAM NAME:    COPY PURGED FILE MEMBERS TO TAPE               */
/*  PROGRAMMER:      LARA BUSER                                    */
/*  CREATE DATE:     10/12/2007                                    */
/*                                                                 */
/*  FUNCTION:        COPY 'Z' MEMBERS TO TAPE                      */
/*                                                                 */
/*                   THIS PROCESS WILL BE CALLED TWICE FOR EACH    */
/*                   PURGE CONTROL GROUP CODE.                     */
/*                                                                 */
/*-----------------------------------------------------------------*/
/* MAINTENANCE LOG:                                                */
/* 04/29/2009 LJB  E00351 CHANGE "SAVOBJ" TO "SAVOBJBRM" PER LEE   */
/*   CHRISTINA TO MAKE RESTORING FROM TAPE LATER ON AN EASIER      */
/*   TASK.                                                         */
/* 04/24/2009 LJB  E00351 REMOVE THE VOLUME IDENTIFIER FROM THE    */
/*   SAVOBJ. IT IS NO LONGER NEEDED WITH THE NEW TAPE DRIVE.       */
/* 02/12/2008 LJB  ADD THE "TO LIBRARY" TO THE LIBRARY LIST        */
/* 01/29/2008 LJB  PASS IN THE "TO LIBRARY" WHICH IS THE SAVE LIB  */
/*   THE PURGED RECORDS WERE COPIED TO.                            */
/*******************************************************************/
             PGM        PARM(&RTNCDE &PCGCODE &LIB &PCACODE +
                          &PCTAPEF &TAPE &VOL &TOLIB)

             DCL        VAR(&RTNCDE) TYPE(*CHAR) LEN(7)
             DCL        VAR(&PCGCODE) TYPE(*CHAR) LEN(3)
             DCL        VAR(&LIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PCACODE) TYPE(*CHAR) LEN(6)
             DCL        VAR(&PCTAPEF) TYPE(*CHAR) LEN(10)
             DCL        VAR(&RTNCDE) TYPE(*CHAR) LEN(7)
             DCL        VAR(&TAPE) TYPE(*CHAR) LEN(10)
             DCL        VAR(&VOL) TYPE(*CHAR) LEN(7)
             DCL        VAR(&TOLIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&MBRNAME) TYPE(*CHAR) LEN(10)
             DCL        VAR(&MBRS) TYPE(*CHAR) LEN(1)

             MONMSG     MSGID(CPF0000)

             ADDLIBLE   LIB(&TOLIB)

/*-----------------------------------------------------------------*/
/* SAVE Z* MEMBERS OF THE FILE TO TAPE, THE RTVMBRD RETRIEVES      */
/*   THE MEMBER NAME OF THE "Z" MEMBERS. THE FILES ARE RETRIEVED   */
/*   FROM THE SAVE LIBRARY THAT IS PASSED IN FROM THE PURGE        */
/*   CONTROL GROUP FILE.                                           */
/* CHANGE "SAVOBJ" TO "SAVOBJBRM"         04/29/2009 E00351        */
/*-----------------------------------------------------------------*/
             CHGVAR     VAR(&MBRS) VALUE('Y')
             RTVMBRD    FILE(&TOLIB/&PCTAPEF) MBR(Z*) RTNMBR(&MBRNAME)
             MONMSG     MSGID(CPF0000) EXEC(CHGVAR VAR(&MBRS) +
                          VALUE('N'))
             IF         COND(&MBRS *EQ 'Y') THEN(DO)
             SAVOBJBRM  LIB(&TOLIB) OBJ(&PCTAPEF) DEV(&TAPE) +
                          OBJTYPE(*FILE) MEDPCY(PURGE) ENDOPT(*LEAVE)

/******      SAVOBJ     OBJ(&PCTAPEF) LIB(&TOLIB) DEV(&TAPE) +
                          OBJTYPE(*FILE) ENDOPT(*LEAVE) UPDHST(*NO) +
                          FILEMBR((&PCTAPEF (Z*)))         **********/
             ENDDO
             RETURN

             RMVLIBLE   LIB(&TOLIB)

 END:        ENDPGM
