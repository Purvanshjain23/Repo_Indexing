     H/TITLE UPD Auto Accruals      XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 09/24/20  Time  : 11:57:00
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FOMHLREL5IF  E           K        DISK
      * RTV : Accrual Program           ACde Product Programs
      *
     FPBAMREL1IF  E           K        DISK
      * RTV : Accrual Program EXT       Retrieval index
      *
     FPMD2REL1IF  E           K        DISK
      * RTV : Accrual Prod Pgm          Retrieval index
      *
     FPMD3REL1IF  E           K        DISK
      * RTV : Accrual Prod Pgm Item     Retrieval index
      *
     FPNFJREL1IF  E           K        DISK
      * RTV : Accrual Prod Pgm Cust     Retrieval index
      *
     FOMCRWKL1IF  E           K        DISK
      * RTV : Order Detail Fin          Retrieval index
      *
     FOMHLREL1IF  E           K        DISK
      * RTV : Accrual Program           Retrieval index
      *
     FOMHOREL7IF  E           K        DISK
      * RSQ : Customer Accrual          ShipTo/CommSts/AccrlCd/S
      *
     FOMHLREL3IF  E           K        DISK
      * RTV : Accrual Program           Active Records Only
      *
     FPDNEREL1IF  E           K        DISK
      * RTV : Customer EXT              Retrieval index
      *
     FPOC5REL0IF  E           K        DISK
      * RTV : Broker                    Retrieval index
      *
     FOMHRCPLEIF  E           K        DISK
      * RSQ : Shipping Dtl Accrual      Co/Ord/ACde/ATyp
      *
     FOPBFCPLLIF  E           K        DISK
      * RSQ : Order Header TRG          Ld(d)/Ord
      *
     FOMHPREL1IF  E           K        DISK
      * RTV : Customer Accrual Item     Retrieval index
      *
     FPOC8REL1IF  E           K        DISK
      * RTV : Customer Accrual Str      Retrieval index
      *
     FOMHRCPL1IF  E           K        DISK
      * RTV : Shipping Dtl Accrual      Retrieval index
      *
     FCAATREL1IF  E           K        DISK
      * RTV : Calendar Summary          Retrieval index
      *
     FOMHRCPL6IF  E           K        DISK
      * RSQ : Shipping Dtl Accrual      Acc/Shpto/ShpDt/Item
      *
     FOMHQCPL1IF  E           K        DISK
      * RTV : Order Detail Accrual      Retrieval index
      *
     FOMHRCPL0IF  E           K        DISK                      A
      * UPD : Shipping Dtl Accrual      Update index
      *
     E                    YDOW        7  1               *Days of week
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WAAIC3
     I              OMC4NB                          WAC4NB
     I              OMDPNB                          WADPNB
     I              OMUENB                          WAUENB
     I              OMHGCD                          WAHGCD
     I              OMAJCD                          WAAJCD
     I              OMBKC7                          WABKC7
     I              OMCFC7                          WACFC7
     I              OMGMST                          WAGMST
     I              OMGNST                          WAGNST
     I              OMMAVA                          WAMAVA
     I              OMKDVA                          WAKDVA
     I              OML8VA                          WAL8VA
     I              OML9VA                          WAL9VA
     I              OMGTST                          WAGTST
     I              OMGVST                          WAGVST
     I              OMGUST                          WAGUST
     I              OMQFST                          WAQFST
     I              OMAYVA                          WAAYVA
     I              OMEXDT                          WAEXDT
     I              OMLQCD                          WALQCD
     I              OMRDCD                          WARDCD
     I              OMQ7CD                          WAQ7CD
     I              OMBZPR                          WABZPR
     I              OML6NB                          WAL6NB
     I              OMU1ST                          WAU1ST
     I              OMGIDT                          WAGIDT
     I              OMCRCD                          WACRCD
     I              OMAGCD                          WAAGCD
     I              OMRZST                          WARZST
     I              OMR0ST                          WAR0ST
     I              OMR1ST                          WAR1ST
     I              OMG7NA                          WAG7NA
     I              OMG8NA                          WAG8NA
     I              OMRPCD                          WARPCD
     I              OMVEST                          WAVEST
     I              OMVGST                          WAVGST
     I              OMAVST                          WAAVST
     I              OMU0ST                          WAU0ST
     I              OMRFCD                          WARFCD
     I              OMFZST                          WAFZST
     I              OMR1NB                          WAR1NB
     I              OMAVQT                          WAAVQT
     I              OMD0WG                          WAD0WG
     I              OMCCQT                          WACCQT
     I              OMAUWG                          WAAUWG
     I              OMCBQT                          WACBQT
     I              OMATWG                          WAATWG
     I              OMAQCS                          WAAQCS
     I              OMAGCS                          WAAGCS
     I              OMAKPR                          WAAKPR
     I              OMALPR                          WAALPR
     I              OMAUPR                          WAAUPR
     I              OMAVWG                          WAAVWG
     I              OMA4WG                          WAA4WG
     I              OMA5DT                          WAA5DT
     I              OMAODT                          WAAODT
     I              OMGNDT                          WAGNDT
     I              OMAMST                          WAAMST
     I              OMANST                          WAANST
     I              OMVAST                          WAVAST
     I              OMRGNB                          WARGNB
     I              OMRHNB                          WARHNB
     I              OMRINB                          WARINB
     I              OMRBCD                          WARBCD
     I              OMHICD                          WAHICD
     I              OMRNCD                          WARNCD
     I              OMROCD                          WAROCD
     I              OMCXDT                          WACXDT
     I              OMAJVN                          WAAJVN
     I              OMKXCD                          WAKXCD
     I              OMJPCD                          WAJPCD
     I              OMCQCD                          WACQCD
     I              OMR4CD                          WAR4CD
     I              OMZ1ST                          WAZ1ST
     I              OMZ3ST                          WAZ3ST
     I              OMZ4ST                          WAZ4ST
     I              OMDUPR                          WADUPR
     I              OMB6VL                          WAB6VL
     I              OMA1AA                          WAA1AA
     I              OMFZSX                          WAFZSX
     I              OMF0SX                          WAF0SX
     I              OMF1SX                          WAF1SX
     I              OMF2SX                          WAF2SX
     I              OMF3SX                          WAF3SX
     I              OMF4SX                          WAF4SX
     I              OMF5SX                          WAF5SX
     I              OMF6SX                          WAF6SX
     I              OMF7SX                          WAF7SX
     I              OMNTDT                          WANTDT
     I              OMNUDT                          WANUDT
     I              OMNVDT                          WANVDT
     I              OMNWDT                          WANWDT
     I              OMNXDT                          WANXDT
     I              OMBUTM                          WABUTM
     I              OMBVTM                          WABVTM
     I              OMBWTM                          WABWTM
     I              OMBXTM                          WABXTM
     I              OMBYTM                          WABYTM
     I              OMH5NX                          WAH5NX
     I              OMH6NX                          WAH6NX
     I              OMH7NX                          WAH7NX
     I              OMH8NX                          WAH8NX
     I              OMH9NX                          WAH9NX
     I              OMDVPR                          WADVPR
     I              OMDWPR                          WADWPR
     I              OMDXPR                          WADXPR
     I              OMDYPR                          WADYPR
     I              OMDZPR                          WADZPR
     I              OMGSPR                          WAGSPR
     I              OMGTPR                          WAGTPR
     I              OMGUPR                          WAGUPR
     I              OMHOST                          WAHOST
     I              OMHPST                          WAHPST
     I              OMIOST                          WAIOST
     I              OMPEWG                          WAPEWG
     I              OMRINY                          WARINY
     I              OMTIDT                          WATIDT
     I              OMTJDT                          WATJDT
     I              OMH2ST                          WAH2ST
     I              OMH0ST                          WAH0ST
     I              OMH1ST                          WAH1ST
     I              OMTKDT                          WATKDT
     I              OMTLDT                          WATLDT
     I              OMTMDT                          WATMDT
     I              OMUVST                          WAUVST
     I              OMUWST                          WAUWST
     I              OMUXST                          WAUXST
     I              OMAATM                          WAAATM
     I              OMAYNA                          WAAYNA
     I              OMA0NA                          WAA0NA
     I              OMAXDT                          WAAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WCAJCD
     I              ADF8NA                          WCF8NA
     I              ADACNA                          WCACNA
     I              ADADNA                          WCADNA
     I              ADAENA                          WCAENA
     I              ADAJNA                          WCAJNA
     I              ADBTTX                          WCBTTX
     I              ADAOCD                          WCAOCD
     I              ADBGCD                          WCBGCD
     I              ADVHST                          WCVHST
     I              ADMPNA                          WCMPNA
     I              ADWPST                          WCWPST
     I              ADXUST                          WCXUST
     I              ADT0ST                          WCT0ST
     I              ADT1ST                          WCT1ST
     I              ADDBNB                          WCDBNB
     I              ADT2ST                          WCT2ST
     I              ADT3ST                          WCT3ST
     I              ADT4ST                          WCT4ST
     I              ADT6ST                          WCT6ST
     I              ADBWC3                          WCBWC3
     I              ADBTC3                          WCBTC3
     I              ADBUC3                          WCBUC3
     I              ADBVC3                          WCBVC3
     I              ADFCAA                          WCFCAA
     I              ADRQSX                          WCRQSX
     I              ADRRSX                          WCRRSX
     I              ADRSSX                          WCRSSX
     I              ADRTSX                          WCRTSX
     I              ADT7ST                          WCT7ST
     I              ADT8ST                          WCT8ST
     I              ADRNSX                          WCRNSX
     I              ADROSX                          WCROSX
     I              ADRPSX                          WCRPSX
     I              ADUVST                          WCUVST
     I              ADUWST                          WCUWST
     I              ADUXST                          WCUXST
     I              ADVSST                          WCVSST
     I              ADAATM                          WCAATM
     I              ADAYNA                          WCAYNA
     I              ADA0NA                          WCA0NA
     I              ADAXDT                          WCAXDT
      *
     I@HLRET0
      * Accrual Program           ACde Product Programs
      * Renamed input format fields
     I              HLOJCD                          WDOJCD
     I              HLLENA                          WDLENA
     I              HLTOST                          WDTOST
     I              HLTQST                          WDTQST
     I              HLTRST                          WDTRST
     I              HLTSST                          WDTSST
     I              HLOKCD                          WDOKCD
     I              HLTYST                          WDTYST
     I              HLOQCD                          WDOQCD
     I              HLHHCD                          WDHHCD
     I              HLI2TX                          WDI2TX
     I              HLJFTX                          WDJFTX
     I              HLI3TX                          WDI3TX
     I              HLJGTX                          WDJGTX
     I              HLLEDG                          WDLEDG
     I              HLTTST                          WDTTST
     I              HLBKPR                          WDBKPR
     I              HLSHSX                          WDSHSX
     I              HLQFSX                          WDQFSX
     I              HLFDTX                          WDFDTX
     I              HLFETX                          WDFETX
     I              HLFFTX                          WDFFTX
     I              HLFGTX                          WDFGTX
     I              HLHQVL                          WDHQVL
     I              HLFHTX                          WDFHTX
     I              HLUVST                          WDUVST
     I              HLUWST                          WDUWST
     I              HLUXST                          WDUXST
     I              HLVSST                          WDVSST
     I              HLAATM                          WDAATM
     I              HLAYNA                          WDAYNA
     I              HLA0NA                          WDA0NA
     I              HLAXDT                          WDAXDT
      *
     I@AMREN7
      * Accrual Program EXT       Retrieval index
      * Renamed input format fields
     I              AMOJCD                          WEOJCD
     I              AMPNAA                          WEPNAA
     I              AMPAST                          WEPAST
     I              AMVSST                          WEVSST
     I              AMMJDT                          WEMJDT
     I              AMBETM                          WEBETM
     I              AMCCVN                          WECCVN
     I              AMCDVN                          WECDVN
     I              AMMKDT                          WEMKDT
     I              AMBFTM                          WEBFTM
     I              AMCEVN                          WECEVN
     I              AMCFVN                          WECFVN
      *
     I@D2RET9
      * Accrual Prod Pgm          Retrieval index
      * Renamed input format fields
     I              D2OJCD                          WFOJCD
     I              D2MSNY                          WFMSNY
     I              D2SCDT                          WFSCDT
     I              D2SDDT                          WFSDDT
     I              D2O9TX                          WFO9TX
     I              D2EWST                          WFEWST
     I              D2VSST                          WFVSST
     I              D2MJDT                          WFMJDT
     I              D2BETM                          WFBETM
     I              D2CCVN                          WFCCVN
     I              D2CDVN                          WFCDVN
     I              D2MKDT                          WFMKDT
     I              D2BFTM                          WFBFTM
     I              D2CEVN                          WFCEVN
     I              D2CFVN                          WFCFVN
      *
     I@D3REUC
      * Accrual Prod Pgm Item     Retrieval index
      * Renamed input format fields
     I              D3OJCD                          WGOJCD
     I              D3MSNY                          WGMSNY
     I              D3HGCD                          WGHGCD
     I              D3SHSX                          WGSHSX
     I              D3BKPR                          WGBKPR
     I              D3VSST                          WGVSST
     I              D3MJDT                          WGMJDT
     I              D3BETM                          WGBETM
     I              D3CCVN                          WGCCVN
     I              D3CDVN                          WGCDVN
     I              D3MKDT                          WGMKDT
     I              D3BFTM                          WGBFTM
     I              D3CEVN                          WGCEVN
     I              D3CFVN                          WGCFVN
      *
     I@FJREBY
      * Accrual Prod Pgm Cust     Retrieval index
      * Renamed input format fields
     I              FJOJCD                          WHOJCD
     I              FJMSNY                          WHMSNY
     I              FJBKC7                          WHBKC7
     I              FJVSST                          WHVSST
     I              FJMJDT                          WHMJDT
     I              FJBETM                          WHBETM
     I              FJCCVN                          WHCCVN
     I              FJCDVN                          WHCDVN
     I              FJMKDT                          WHMKDT
     I              FJBFTM                          WHBFTM
     I              FJCEVN                          WHCEVN
     I              FJCFVN                          WHCFVN
      *
     I@CRWKL1
      * Order Detail Fin          Retrieval index
      * Renamed input format fields
     I              N1AIC3                          WIAIC3
     I              N1C4NB                          WIC4NB
     I              N1DPNB                          WIDPNB
     I              N1UENB                          WIUENB
     I              N1DXNB                          WIDXNB
     I              N1G4ST                          WIG4ST
     I              N1BSVA                          WIBSVA
     I              N1G5NA                          WIG5NA
     I              N1DQCD                          WIDQCD
     I              N1DRCD                          WIDRCD
     I              N1AVNB                          WIAVNB
     I              N1DSCD                          WIDSCD
     I              N1GFST                          WIGFST
     I              N1SANB                          WISANB
     I              N1OJCD                          WIOJCD
     I              N1UVCD                          WIUVCD
     I              N1CKNB                          WICKNB
     I              N1BMST                          WIBMST
     I              N1UVST                          WIUVST
     I              N1UWST                          WIUWST
     I              N1UXST                          WIUXST
     I              N1AATM                          WIAATM
     I              N1AYNA                          WIAYNA
     I              N1A0NA                          WIA0NA
     I              N1AXDT                          WIAXDT
      *
     I@HLREK4
      * Accrual Program           Retrieval index
      * Renamed input format fields
     I              HLOJCD                          WJOJCD
     I              HLLENA                          WJLENA
     I              HLTOST                          WJTOST
     I              HLTQST                          WJTQST
     I              HLTRST                          WJTRST
     I              HLTSST                          WJTSST
     I              HLOKCD                          WJOKCD
     I              HLTYST                          WJTYST
     I              HLOQCD                          WJOQCD
     I              HLHHCD                          WJHHCD
     I              HLI2TX                          WJI2TX
     I              HLJFTX                          WJJFTX
     I              HLI3TX                          WJI3TX
     I              HLJGTX                          WJJGTX
     I              HLLEDG                          WJLEDG
     I              HLTTST                          WJTTST
     I              HLBKPR                          WJBKPR
     I              HLSHSX                          WJSHSX
     I              HLQFSX                          WJQFSX
     I              HLFDTX                          WJFDTX
     I              HLFETX                          WJFETX
     I              HLFFTX                          WJFFTX
     I              HLFGTX                          WJFGTX
     I              HLHQVL                          WJHQVL
     I              HLFHTX                          WJFHTX
     I              HLUVST                          WJUVST
     I              HLUWST                          WJUWST
     I              HLUXST                          WJUXST
     I              HLVSST                          WJVSST
     I              HLAATM                          WJAATM
     I              HLAYNA                          WJAYNA
     I              HLA0NA                          WJA0NA
     I              HLAXDT                          WJAXDT
      *
     I@HRCPLL
      * Shipping Dtl Accrual      Update index
      * Renamed input format fields
     I              HRAIC3                          WKAIC3
     I              HRC4NB                          WKC4NB
     I              HRDPNB                          WKDPNB
     I              HRUENB                          WKUENB
     I              HRDXNB                          WKDXNB
     I              HRBKPR                          WKBKPR
     I              HRC5PC                          WKC5PC
     I              HRAYVA                          WKAYVA
     I              HREDVL                          WKEDVL
     I              HRHGCD                          WKHGCD
     I              HRBKC7                          WKBKC7
     I              HRDUC7                          WKDUC7
     I              HRHHAA                          WKHHAA
     I              HRPODT                          WKPODT
     I              HRBYWG                          WKBYWG
     I              HRBVST                          WKBVST
     I              HRP7SX                          WKP7SX
     I              HROKCD                          WKOKCD
     I              HRP8SX                          WKP8SX
     I              HRP9SX                          WKP9SX
     I              HRQASX                          WKQASX
     I              HRQBSX                          WKQBSX
     I              HRPPDT                          WKPPDT
     I              HRPQDT                          WKPQDT
     I              HREEVL                          WKEEVL
     I              HREFVL                          WKEFVL
     I              HRFITX                          WKFITX
     I              HRFJTX                          WKFJTX
     I              HRQ8DT                          WKQ8DT
     I              HRFKTX                          WKFKTX
     I              HRH0NY                          WKH0NY
     I              HRKQT1                          WKKQT1
     I              HRKTT1                          WKKTT1
     I              HRHIAA                          WKHIAA
     I              HRHLAA                          WKHLAA
     I              HROJCD                          WKOJCD
     I              HRAVNB                          WKAVNB
     I              HRDSCD                          WKDSCD
     I              HRUVST                          WKUVST
     I              HRUWST                          WKUWST
     I              HRUXST                          WKUXST
     I              HRAATM                          WKAATM
     I              HRAYNA                          WKAYNA
     I              HRA0NA                          WKA0NA
     I              HRAXDT                          WKAXDT
      *
     I@HOREKH
      * Customer Accrual          ShipTo/CommSts/AccrlCd/S
      * Renamed input format fields
     I              HOBKC7                          WLBKC7
     I              HOOJCD                          WLOJCD
     I              HOGUNY                          WLGUNY
     I              HOBFDT                          WLBFDT
     I              HOA2DT                          WLA2DT
     I              HOBKPR                          WLBKPR
     I              HOTTST                          WLTTST
     I              HOSHSX                          WLSHSX
     I              HOQDSX                          WLQDSX
     I              HOPJDT                          WLPJDT
     I              HOPKDT                          WLPKDT
     I              HOECVL                          WLECVL
     I              HOQESX                          WLQESX
     I              HOQFSX                          WLQFSX
     I              HOHHAA                          WLHHAA
     I              HOHQVL                          WLHQVL
     I              HOQGSX                          WLQGSX
     I              HOQHSX                          WLQHSX
     I              HOQISX                          WLQISX
     I              HOQJSX                          WLQJSX
     I              HOUVST                          WLUVST
     I              HOUWST                          WLUWST
     I              HOUXST                          WLUXST
     I              HOAATM                          WLAATM
     I              HOAYNA                          WLAYNA
     I              HOA0NA                          WLA0NA
     I              HOAXDT                          WLAXDT
      *
     I@HLREU8
      * Accrual Program           Active Records Only
      * Renamed input format fields
     I              HLOJCD                          WMOJCD
     I              HLLENA                          WMLENA
     I              HLTOST                          WMTOST
     I              HLTQST                          WMTQST
     I              HLTRST                          WMTRST
     I              HLTSST                          WMTSST
     I              HLOKCD                          WMOKCD
     I              HLTYST                          WMTYST
     I              HLOQCD                          WMOQCD
     I              HLHHCD                          WMHHCD
     I              HLI2TX                          WMI2TX
     I              HLJFTX                          WMJFTX
     I              HLI3TX                          WMI3TX
     I              HLJGTX                          WMJGTX
     I              HLLEDG                          WMLEDG
     I              HLTTST                          WMTTST
     I              HLBKPR                          WMBKPR
     I              HLSHSX                          WMSHSX
     I              HLQFSX                          WMQFSX
     I              HLFDTX                          WMFDTX
     I              HLFETX                          WMFETX
     I              HLFFTX                          WMFFTX
     I              HLFGTX                          WMFGTX
     I              HLHQVL                          WMHQVL
     I              HLFHTX                          WMFHTX
     I              HLUVST                          WMUVST
     I              HLUWST                          WMUWST
     I              HLUXST                          WMUXST
     I              HLVSST                          WMVSST
     I              HLAATM                          WMAATM
     I              HLAYNA                          WMAYNA
     I              HLA0NA                          WMA0NA
     I              HLAXDT                          WMAXDT
      *
     I@NEREAT
      * Customer EXT              Retrieval index
      * Renamed input format fields
     I              NEBKC7                          WOBKC7
     I              NEUFTX                          WOUFTX
     I              NEUGTX                          WOUGTX
     I              NEPFNA                          WOPFNA
     I              NEJ5NX                          WOJ5NX
     I              NEU5TX                          WOU5TX
     I              NEU6TX                          WOU6TX
     I              NEW0TX                          WOW0TX
     I              NEHSSX                          WOHSSX
     I              NEHUSX                          WOHUSX
     I              NEHVSX                          WOHVSX
     I              NEAAC8                          WOAAC8
     I              NEP0SX                          WOP0SX
     I              NEP1SX                          WOP1SX
     I              NEP2SX                          WOP2SX
     I              NEP3SX                          WOP3SX
     I              NEP4SX                          WOP4SX
     I              NEP5SX                          WOP5SX
     I              NEP6SX                          WOP6SX
     I              NEUVST                          WOUVST
     I              NEUWST                          WOUWST
     I              NEUXST                          WOUXST
     I              NEVSST                          WOVSST
     I              NEAATM                          WOAATM
     I              NEAYNA                          WOAYNA
     I              NEA0NA                          WOA0NA
     I              NEAXDT                          WOAXDT
      *
     I@C5RESJ
      * Broker                    Retrieval index
      * Renamed input format fields
     I              C5HHAA                          WRHHAA
     I              C5C4T1                          WRC4T1
     I              C5QMNA                          WRQMNA
     I              C5QNNA                          WRQNNA
     I              C5QONA                          WRQONA
     I              C5QPNA                          WRQPNA
     I              C5C5T1                          WRC5T1
     I              C5C6T1                          WRC6T1
     I              C5C7T1                          WRC7T1
     I              C5C8T1                          WRC8T1
     I              C5C9T1                          WRC9T1
     I              C5DAT1                          WRDAT1
     I              C5DBT1                          WRDBT1
     I              C5DCT1                          WRDCT1
     I              C5DDT1                          WRDDT1
     I              C5PWSX                          WRPWSX
     I              C5PXSX                          WRPXSX
     I              C5PYSX                          WRPYSX
     I              C5PZSX                          WRPZSX
     I              C5BCCD                          WRBCCD
     I              C5UVST                          WRUVST
     I              C5UWST                          WRUWST
     I              C5UXST                          WRUXST
     I              C5VSST                          WRVSST
     I              C5AATM                          WRAATM
     I              C5AYNA                          WRAYNA
     I              C5A0NA                          WRA0NA
     I              C5AXDT                          WRAXDT
      *
     I@HRCPC9
      * Shipping Dtl Accrual      Co/Ord/ACde/ATyp
      * Renamed input format fields
     I              HRAIC3                          WSAIC3
     I              HRC4NB                          WSC4NB
     I              HRDPNB                          WSDPNB
     I              HRUENB                          WSUENB
     I              HRDXNB                          WSDXNB
     I              HRBKPR                          WSBKPR
     I              HRC5PC                          WSC5PC
     I              HRAYVA                          WSAYVA
     I              HREDVL                          WSEDVL
     I              HRHGCD                          WSHGCD
     I              HRBKC7                          WSBKC7
     I              HRDUC7                          WSDUC7
     I              HRHHAA                          WSHHAA
     I              HRPODT                          WSPODT
     I              HRBYWG                          WSBYWG
     I              HRBVST                          WSBVST
     I              HRP7SX                          WSP7SX
     I              HROKCD                          WSOKCD
     I              HRP8SX                          WSP8SX
     I              HRP9SX                          WSP9SX
     I              HRQASX                          WSQASX
     I              HRQBSX                          WSQBSX
     I              HRPPDT                          WSPPDT
     I              HRPQDT                          WSPQDT
     I              HREEVL                          WSEEVL
     I              HREFVL                          WSEFVL
     I              HRFITX                          WSFITX
     I              HRFJTX                          WSFJTX
     I              HRQ8DT                          WSQ8DT
     I              HRFKTX                          WSFKTX
     I              HRH0NY                          WSH0NY
     I              HRKQT1                          WSKQT1
     I              HRKTT1                          WSKTT1
     I              HRHIAA                          WSHIAA
     I              HRHLAA                          WSHLAA
     I              HROJCD                          WSOJCD
     I              HRAVNB                          WSAVNB
     I              HRDSCD                          WSDSCD
     I              HRUVST                          WSUVST
     I              HRUWST                          WSUWST
     I              HRUXST                          WSUXST
     I              HRAATM                          WSAATM
     I              HRAYNA                          WSAYNA
     I              HRA0NA                          WSA0NA
     I              HRAXDT                          WSAXDT
      *
     I@BFCPR0
      * Order Header TRG          Ld(d)/Ord
      * Renamed input format fields
     I              BEAIC3                          WTAIC3
     I              BEC4NB                          WTC4NB
     I              BEJNCD                          WTJNCD
     I              BEANC7                          WTANC7
     I              BEBKC7                          WTBKC7
     I              BEBRTX                          WTBRTX
     I              BEHMNA                          WTHMNA
     I              BEHONA                          WTHONA
     I              BEHPNA                          WTHPNA
     I              BEHNNA                          WTHNNA
     I              BEDBCD                          WTDBCD
     I              BECKTX                          WTCKTX
     I              BEB0C7                          WTB0C7
     I              BEAETX                          WTAETX
     I              BEB1NA                          WTB1NA
     I              BEB3NA                          WTB3NA
     I              BEB4NA                          WTB4NA
     I              BEB2NA                          WTB2NA
     I              BEBHCD                          WTBHCD
     I              BEC8TX                          WTC8TX
     I              BEBCNA                          WTBCNA
     I              BEA0DT                          WTA0DT
     I              BEA5DT                          WTA5DT
     I              BEGNDT                          WTGNDT
     I              BEACDT                          WTACDT
     I              BEAQCD                          WTAQCD
     I              BEB6NA                          WTB6NA
     I              BEBYNA                          WTBYNA
     I              BEBZNA                          WTBZNA
     I              BEGTST                          WTGTST
     I              BEGVST                          WTGVST
     I              BEGUST                          WTGUST
     I              BEQFST                          WTQFST
     I              BECQCD                          WTCQCD
     I              BEGJST                          WTGJST
     I              BEGWST                          WTGWST
     I              BEGXST                          WTGXST
     I              BEGYST                          WTGYST
     I              BEAODT                          WTAODT
     I              BEAIVN                          WTAIVN
     I              BECXDT                          WTCXDT
     I              BEJZVA                          WTJZVA
     I              BEA1WG                          WTA1WG
     I              BEXIST                          WTXIST
     I              BEXJST                          WTXJST
     I              BEXKST                          WTXKST
     I              BEEIDT                          WTEIDT
     I              BEAFTM                          WTAFTM
     I              BEE8CD                          WTE8CD
     I              BEE9CD                          WTE9CD
     I              BERMNB                          WTRMNB
     I              BETBNB                          WTTBNB
     I              BER1NB                          WTR1NB
     I              BEPJST                          WTPJST
     I              BEU0ST                          WTU0ST
     I              BEU1ST                          WTU1ST
     I              BEQ2CD                          WTQ2CD
     I              BEU2ST                          WTU2ST
     I              BEVEST                          WTVEST
     I              BEVFST                          WTVFST
     I              BEVGST                          WTVGST
     I              BERPCD                          WTRPCD
     I              BERNNB                          WTRNNB
     I              BEVDST                          WTVDST
     I              BEATIN                          WTATIN
     I              BEU4ST                          WTU4ST
     I              BEU5ST                          WTU5ST
     I              BERSRN                          WTRSRN
     I              BEMHNA                          WTMHNA
     I              BEMINA                          WTMINA
     I              BEWBST                          WTWBST
     I              BER4CD                          WTR4CD
     I              BEBFCD                          WTBFCD
     I              BEQ4CD                          WTQ4CD
     I              BET3NB                          WTT3NB
     I              BESICD                          WTSICD
     I              BECONB                          WTCONB
     I              BECEST                          WTCEST
     I              BEAWDT                          WTAWDT
     I              BEJPCD                          WTJPCD
     I              BEXUST                          WTXUST
     I              BEZ1ST                          WTZ1ST
     I              BEVRVA                          WTVRVA
     I              BEOBST                          WTOBST
     I              BEBCST                          WTBCST
     I              BEBDST                          WTBDST
     I              BEB7VL                          WTB7VL
     I              BEGASX                          WTGASX
     I              BEGBSX                          WTGBSX
     I              BEGCSX                          WTGCSX
     I              BEGDSX                          WTGDSX
     I              BEFNSX                          WTFNSX
     I              BEFOSX                          WTFOSX
     I              BEFPSX                          WTFPSX
     I              BEFQSX                          WTFQSX
     I              BEFRSX                          WTFRSX
     I              BEFSSX                          WTFSSX
     I              BEFTSX                          WTFTSX
     I              BEFUSX                          WTFUSX
     I              BEFVSX                          WTFVSX
     I              BEFWSX                          WTFWSX
     I              BEFXSX                          WTFXSX
     I              BEFYSX                          WTFYSX
     I              BENODT                          WTNODT
     I              BENPDT                          WTNPDT
     I              BENQDT                          WTNQDT
     I              BENRDT                          WTNRDT
     I              BENSDT                          WTNSDT
     I              BEBPTM                          WTBPTM
     I              BEBQTM                          WTBQTM
     I              BEBRTM                          WTBRTM
     I              BEBSTM                          WTBSTM
     I              BEBTTM                          WTBTTM
     I              BEH0NX                          WTH0NX
     I              BEH1NX                          WTH1NX
     I              BEH2NX                          WTH2NX
     I              BEH3NX                          WTH3NX
     I              BEH4NX                          WTH4NX
     I              BEC0C7                          WTC0C7
     I              BEUVST                          WTUVST
     I              BEUWST                          WTUWST
     I              BEUXST                          WTUXST
     I              BEAATM                          WTAATM
     I              BEAYNA                          WTAYNA
     I              BEA0NA                          WTA0NA
     I              BEAXDT                          WTAXDT
      *
     I@HPRELD
      * Customer Accrual Item     Retrieval index
      * Renamed input format fields
     I              HPBKC7                          WVBKC7
     I              HPOJCD                          WVOJCD
     I              HPGUNY                          WVGUNY
     I              HPHGCD                          WVHGCD
     I              HPBKPR                          WVBKPR
     I              HPSHSX                          WVSHSX
     I              HPUVST                          WVUVST
     I              HPUWST                          WVUWST
     I              HPUXST                          WVUXST
     I              HPAATM                          WVAATM
     I              HPAYNA                          WVAYNA
     I              HPA0NA                          WVA0NA
     I              HPAXDT                          WVAXDT
      *
     I@C8RES1
      * Customer Accrual Str      Retrieval index
      * Renamed input format fields
     I              C8BKC7                          WWBKC7
     I              C8OJCD                          WWOJCD
     I              C8GUNY                          WWGUNY
     I              C8RGNB                          WWRGNB
     I              C8RHNB                          WWRHNB
     I              C8RINB                          WWRINB
     I              C8BKPR                          WWBKPR
     I              C8SHSX                          WWSHSX
     I              C8QTSX                          WWQTSX
     I              C8QUSX                          WWQUSX
     I              C8FKPR                          WWFKPR
     I              C8FLPR                          WWFLPR
     I              C8UVST                          WWUVST
     I              C8UWST                          WWUWST
     I              C8UXST                          WWUXST
     I              C8VSST                          WWVSST
     I              C8AATM                          WWAATM
     I              C8AYNA                          WWAYNA
     I              C8A0NA                          WWA0NA
     I              C8AXDT                          WWAXDT
      *
     I@HRCPLM
      * Shipping Dtl Accrual      Retrieval index
      * Renamed input format fields
     I              HRAIC3                          WXAIC3
     I              HRC4NB                          WXC4NB
     I              HRDPNB                          WXDPNB
     I              HRUENB                          WXUENB
     I              HRDXNB                          WXDXNB
     I              HRBKPR                          WXBKPR
     I              HRC5PC                          WXC5PC
     I              HRAYVA                          WXAYVA
     I              HREDVL                          WXEDVL
     I              HRHGCD                          WXHGCD
     I              HRBKC7                          WXBKC7
     I              HRDUC7                          WXDUC7
     I              HRHHAA                          WXHHAA
     I              HRPODT                          WXPODT
     I              HRBYWG                          WXBYWG
     I              HRBVST                          WXBVST
     I              HRP7SX                          WXP7SX
     I              HROKCD                          WXOKCD
     I              HRP8SX                          WXP8SX
     I              HRP9SX                          WXP9SX
     I              HRQASX                          WXQASX
     I              HRQBSX                          WXQBSX
     I              HRPPDT                          WXPPDT
     I              HRPQDT                          WXPQDT
     I              HREEVL                          WXEEVL
     I              HREFVL                          WXEFVL
     I              HRFITX                          WXFITX
     I              HRFJTX                          WXFJTX
     I              HRQ8DT                          WXQ8DT
     I              HRFKTX                          WXFKTX
     I              HRH0NY                          WXH0NY
     I              HRKQT1                          WXKQT1
     I              HRKTT1                          WXKTT1
     I              HRHIAA                          WXHIAA
     I              HRHLAA                          WXHLAA
     I              HROJCD                          WXOJCD
     I              HRAVNB                          WXAVNB
     I              HRDSCD                          WXDSCD
     I              HRUVST                          WXUVST
     I              HRUWST                          WXUWST
     I              HRUXST                          WXUXST
     I              HRAATM                          WXAATM
     I              HRAYNA                          WXAYNA
     I              HRA0NA                          WXA0NA
     I              HRAXDT                          WXAXDT
      *
     I@ATRECF
      * Calendar Summary          Retrieval index
      * Renamed input format fields
     I              ATAIC3                          WYAIC3
     I              ATESNB                          WYESNB
     I              ATETNB                          WYETNB
     I              ATBZNB                          WYBZNB
     I              ATTBST                          WYTBST
     I              ATBFDT                          WYBFDT
     I              ATA2DT                          WYA2DT
     I              ATUVST                          WYUVST
     I              ATUWST                          WYUWST
     I              ATUXST                          WYUXST
     I              ATAATM                          WYAATM
     I              ATAYNA                          WYAYNA
     I              ATA0NA                          WYA0NA
     I              ATAXDT                          WYAXDT
      *
     I@HRCPV5
      * Shipping Dtl Accrual      Acc/Shpto/ShpDt/Item
      * Renamed input format fields
     I              HRAIC3                          TAAIC3
     I              HRC4NB                          TAC4NB
     I              HRDPNB                          TADPNB
     I              HRUENB                          TAUENB
     I              HRDXNB                          TADXNB
     I              HRBKPR                          TABKPR
     I              HRC5PC                          TAC5PC
     I              HRAYVA                          TAAYVA
     I              HREDVL                          TAEDVL
     I              HRHGCD                          TAHGCD
     I              HRBKC7                          TABKC7
     I              HRDUC7                          TADUC7
     I              HRHHAA                          TAHHAA
     I              HRPODT                          TAPODT
     I              HRBYWG                          TABYWG
     I              HRBVST                          TABVST
     I              HRP7SX                          TAP7SX
     I              HROKCD                          TAOKCD
     I              HRP8SX                          TAP8SX
     I              HRP9SX                          TAP9SX
     I              HRQASX                          TAQASX
     I              HRQBSX                          TAQBSX
     I              HRPPDT                          TAPPDT
     I              HRPQDT                          TAPQDT
     I              HREEVL                          TAEEVL
     I              HREFVL                          TAEFVL
     I              HRFITX                          TAFITX
     I              HRFJTX                          TAFJTX
     I              HRQ8DT                          TAQ8DT
     I              HRFKTX                          TAFKTX
     I              HRH0NY                          TAH0NY
     I              HRKQT1                          TAKQT1
     I              HRKTT1                          TAKTT1
     I              HRHIAA                          TAHIAA
     I              HRHLAA                          TAHLAA
     I              HROJCD                          TAOJCD
     I              HRAVNB                          TAAVNB
     I              HRDSCD                          TADSCD
     I              HRUVST                          TAUVST
     I              HRUWST                          TAUWST
     I              HRUXST                          TAUXST
     I              HRAATM                          TAAATM
     I              HRAYNA                          TAAYNA
     I              HRA0NA                          TAA0NA
     I              HRAXDT                          TAAXDT
      *
     I@HQCPLJ
      * Order Detail Accrual      Retrieval index
      * Renamed input format fields
     I              HQAIC3                          TBAIC3
     I              HQC4NB                          TBC4NB
     I              HQDPNB                          TBDPNB
     I              HQUENB                          TBUENB
     I              HQDXNB                          TBDXNB
     I              HQBKPR                          TBBKPR
     I              HQSHSX                          TBSHSX
     I              HQOKCD                          TBOKCD
     I              HQTINA                          TBTINA
     I              HQDSCD                          TBDSCD
     I              HQHAST                          TBHAST
     I              HQHBST                          TBHBST
     I              HQHCST                          TBHCST
     I              HQHDST                          TBHDST
     I              HQHEST                          TBHEST
     I              HQHFST                          TBHFST
     I              HQOJCD                          TBOJCD
     I              HQL8AA                          TBL8AA
     I              HQVSST                          TBVSST
     I              HQMJDT                          TBMJDT
     I              HQBETM                          TBBETM
     I              HQCCVN                          TBCCVN
     I              HQCDVN                          TBCDVN
     I              HQMKDT                          TBMKDT
     I              HQBFTM                          TBBFTM
     I              HQCEVN                          TBCEVN
     I              HQCFVN                          TBCFVN
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQOMHR1    E DSOMHRCPL0
      * UPD : Shipping Dtl Accrual      Update index
      * Renamed input format fields
     I              HRAIC3                          WKAIC3
     I              HRC4NB                          WKC4NB
     I              HRDPNB                          WKDPNB
     I              HRUENB                          WKUENB
     I              HRDXNB                          WKDXNB
     I              HRBKPR                          WKBKPR
     I              HRC5PC                          WKC5PC
     I              HRAYVA                          WKAYVA
     I              HREDVL                          WKEDVL
     I              HRHGCD                          WKHGCD
     I              HRBKC7                          WKBKC7
     I              HRDUC7                          WKDUC7
     I              HRHHAA                          WKHHAA
     I              HRPODT                          WKPODT
     I              HRBYWG                          WKBYWG
     I              HRBVST                          WKBVST
     I              HRP7SX                          WKP7SX
     I              HROKCD                          WKOKCD
     I              HRP8SX                          WKP8SX
     I              HRP9SX                          WKP9SX
     I              HRQASX                          WKQASX
     I              HRQBSX                          WKQBSX
     I              HRPPDT                          WKPPDT
     I              HRPQDT                          WKPQDT
     I              HREEVL                          WKEEVL
     I              HREFVL                          WKEFVL
     I              HRFITX                          WKFITX
     I              HRFJTX                          WKFJTX
     I              HRQ8DT                          WKQ8DT
     I              HRFKTX                          WKFKTX
     I              HRH0NY                          WKH0NY
     I              HRKQT1                          WKKQT1
     I              HRKTT1                          WKKTT1
     I              HRHIAA                          WKHIAA
     I              HRHLAA                          WKHLAA
     I              HROJCD                          WKOJCD
     I              HRAVNB                          WKAVNB
     I              HRDSCD                          WKDSCD
     I              HRUVST                          WKUVST
     I              HRUWST                          WKUWST
     I              HRUXST                          WKUXST
     I              HRAATM                          WKAATM
     I              HRAYNA                          WKAYNA
     I              HRA0NA                          WKA0NA
     I              HRAXDT                          WKAXDT
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Detail
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Order Number
     I                                    P   3   60P1C4NB
     IP2PARM      DS
      * FLD: Order Header TRG
      * I :  A/R Customer Number
     I                                    P   1   40P2ANC7
      * I :  Date of Original Entry
     I                                    P   5   80P2CXDT
      * I :  Load ID
     I                                    P   9  120P2RMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P  13  152P2TBNB
      * I :  Attach to Order Number
     I                                    P  16  190P2T3NB
      * I :  Invoice Date
     I                                    P  20  230P2AWDT
      * I :  Billing Activity Type
     I                                       24  24 P2OBST
     IP3PARM      DS
      * N :  Extended Amt Total
     I                                    P   1   62P3EJVL
     IP4PARM      DS
      * N :  Weight Total 13.2     USR
     I                                    P   1   72P4ETWG
     IP5PARM      DS
      * N :  Quantity Total S
     I                                    P   1   62P5BKQT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P2ANC7    PARM           WP0003  70       A/R Customer Nu
     C           P2CXDT    PARM           WP0004  70       Date of Origina
     C           P2RMNB    PARM           WP0005  70       Load ID
     C           P2TBNB    PARM           WP0006  52       Absorbed Freigh
     C           P2T3NB    PARM           WP0007  70       Attach to Order
     C           P2AWDT    PARM           WP0008  70       Invoice Date
     C           P2OBST    PARM           WP0009  1        Billing Activit
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * UPD Auto Accruals      XF
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * RTV Total Qty,Wgt Ext  RT - Order Detail  * 
     C                     EXSR SARVGN
      * 06/26/14 PKD E3164 Added Exclude Collect Truck flag to the
      *              Accrual Program EXT.  Need to send in the Shipping M
      *              for selection criteria for the Accrual Program.
      * Rtv Shipping Method   RT - Order Header TRG  * 
     C                     EXSR SBRVGN
      * UPD Auto Accruals      RT - Order Detail  * 
     C                     EXSR SCRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Total Qty,Wgt Ext  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     P3EJVL           Extended Amount
     C                     Z-ADD*ZERO     P5BKQT           Quantity Shippe
     C                     Z-ADD*ZERO     P4ETWG           Weight Shipped
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSA02           Order Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
     C                     Z-ADDP1C4NB    WQSA02           Order Number
      * Establish starting position
     C           KRSSA     SETLL@BGWKL1                    *
     C           KRSSA     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Not cancelled
     C           WAGMST    IFEQ 'L'                        *IF
     C           WAGMST    OREQ 'A'
     C           WAGMST    OREQ 'C'
     C           WAGMST    OREQ 'R'
     C           WAGMST    OREQ 'E'
     C           WAGMST    OREQ 'H'
     C           WAGMST    OREQ 'I'
     C                     ADD  WACBQT    P5BKQT           Quantity Shippe
     C                     ADD  WAATWG    P4ETWG           Weight Shipped
     C                     ADD  WAAYVA    P3EJVL           Extended Amount
     C                     END                             *FI
     C           KRSSA     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Shipping Method   RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WBAIC3           Company Number
     C                     Z-ADDP1C4NB    WBC4NB           Order Number
      * Establish starting position
     C           KRSSB     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           Shipping Method
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBQ2CD    YL0001           Shipping Method
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * UPD Auto Accruals      RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  30       Sequence Number
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E4057 JJH 04/27/15 - New input Parm: SDA Atch to Ord ActShpDt
     C                     Z-ADD0         WN0001           Sequence Number
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WAC4NB    WQSC02           Order Number
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSC01           Company Number
     C                     Z-ADDP1C4NB    WQSC02           Order Number
      * Establish starting position
     C           KRSSC     SETLL@BGWKL1                    *
     C           KRSSC     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * ***** MAINTENANCE LOG
     C                     EXSR UBSUBR                     ***** MAINTENAN
      * E4057 JJH 05/11/15 - Rtv Actual Ship Date of Attach to Order Nbr
      * Populate SDA Atch to Ord ActShpDt
      * CASE: PAR.Billing Activity Type is Credit or Debit Memo
     C           P2OBST    IFEQ '2'                        *IF
     C           P2OBST    OREQ '3'
     C                     Z-ADDWATMDT    YL0002           SDA Atch to Ord
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         YL0002           SDA Atch to Ord
     C                     END                             *FI
      * CASE: Quantity Shipped or Weight Shipped <> Zero
      *  - c1 OR c2
      *   |- c1    : DB1.Quantity Shipped Total is not equal zero
      *   |- c2    : DB1.Weight Shipped Total is Not equal zero
      *   '-
     C           WACBQT    IFNE 0                          *IF
     C           WAATWG    ORNE 0                          *OR
      * Rtv Acct&Ship Co      RT - Warehouse  * 
     C                     EXSR SDRVGN
      * *---------------------------------------------------------------*
      * ***** MAINTENANCE LOG: Product Program
     C                     EXSR UCSUBR                     ***** MAINTENAN
      * RTV Write Accrual Rcd RT - Accrual Program  * 
     C                     EXSR SERVGN
      * *---------------------------------------------------------------*
      * ***** MAINTENANCE LOG: Customer Accrual
     C                     EXSR UFSUBR                     ***** MAINTENAN
      * RTV Write Accrual Rcd RT - Customer Accrual  * 
     C                     EXSR SMRVGN
      * *---------------------------------------------------------------*
      * ***** MAINTENANCE LOG: Order Detail Accrual
     C                     EXSR UGSUBR                     ***** MAINTENAN
      * Logic only for Regular Sales Orders. CM/DMs are not allowed to
      * create Order Dtl Accrual.
      * RTV Write Accrual Rcd RT - Order Detail Accrual  * 
     C                     EXSR SXRVGN
     C                     END                             *FI
     C           KRSSC     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Acct&Ship Co      RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWAAJCD    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSD     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0003           Accounting Comp
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCBTC3    YL0003           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Write Accrual Rcd RT - Accrual Program  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0002 30        Accrual Descrip
     C                     MOVEL*BLANK    WN0003  1        Automatic Accru
     C                     MOVEL*BLANK    WN0004  1        Print On Invoic
     C                     MOVEL*BLANK    WN0005  1        Rate Usage
     C                     MOVEL*BLANK    WN0006  1        Add-on/Allowanc
     C                     MOVEL*BLANK    WN0007  2        Accrual Type
     C                     MOVEL*BLANK    WN0008  2        Sub Ledger Code
     C                     MOVEL*BLANK    WN0009  3        Reverse Accrual
     C                     MOVEL*BLANK    WN0010  2        U/M - Primary D
     C                     MOVEL*BLANK    WN0011  8        G/L Code Dr
     C                     MOVEL*BLANK    WN0012  8        G/L Code Cr
     C                     MOVEL*BLANK    WN0013  1        Post to G/L (Y/
     C                     MOVEL*BLANK    WN0014  2        Accrual Rate Ty
     C                     MOVEL*BLANK    WN0015  1        Affect Sales Re
     C                     MOVEL*BLANK    WN0016  1        Affect Invoice
     C                     MOVEL*BLANK    WN0017  2        Invoice Print T
     C                     Z-ADD*ZERO     WN0018 112       Item Accrual Am
     C                     MOVEL*BLANK    WN0019  1        Retro Comm Calc
     C                     MOVEL*BLANK    WN0020  1        SDA Affect Sale
     C                     MOVEL*BLANK    WN0021  1        SDA Affect Invo
     C                     MOVEL*BLANK    WN0022  1        SDA Print on In
     C                     MOVEL*BLANK    WN0023  2        SDA Invoice Pri
     C                     Z-ADD*ZERO     WN0024  70       SDA Ord Dtl Acr
     C                     Z-ADD*ZERO     WN0025 112       SDA Unused Amt
     C                     Z-ADD*ZERO     WN0026 112       SDA Unused Amt
     C                     Z-ADD*ZERO     WN0027  80       SDA G/L Sub Led
     C                     MOVEL*BLANK    WN0028  8        SDA G/L Code Dr
     C                     MOVEL*BLANK    WN0029  8        SDA G/L Code Cr
     C                     MOVEL*BLANK    WN0030  8        SDA JDE Account
     C                     MOVEL*BLANK    WN0031  8        SDA JDE Account
     C                     Z-ADD*ZERO     WN0032  70       AD Period Begin
     C                     Z-ADD*ZERO     WN0033  70       AD Period Endin
     C                     Z-ADD*ZERO     WN0034  80       AD Sub Ledger
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@HLRET0                    *
     C                     READ @HLRET0                  90*
      * Data record not found
     C   90                MOVEL'USR1514' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * *------------ MAINTENANCE LOG ------------*
     C                     EXSR UDSUBR                     *------------ M
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * E4057 JJH 05/13/15 - Reset Extended Amount to Zero
     C                     Z-ADD0         WUAYVA           Extended Amount
      * Rtv Accr Prog EXT     RT - Accrual Program EXT  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWDOJCD    WL0001    P      Accrual Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YN0002    P      G/L Account Cat
     C                     MOVELWL0003    YL0004    P      APE Excl Collec
     C                     MOVELWL0004    YN0003    P      Record Status
      * OMIT:  Shipping Method = Collect Rail or Truck
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.APE Excl Collect ShpMthd is Yes
      *   |- c2    : PAR.Shipping Method is Collect
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0004    IFEQ 'Y'                        *IF
     C           YL0001    IFEQ 'CR'                       *IF
     C           YL0001    OREQ 'CT'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Process Accrual Program
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: DB1.Automatic Accrual (Y/N) is Yes
     C           WDTOST    IFEQ 'Y'                        *IF
      * E4057 JJH 04/24/14 - Add I parm for: SDA Atch to Ord ActShpDt
      * RTV Write Accrual Rcd RT - Accrual Prod Pgm  * 
     C                     EXSR SGRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @HLRET0                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Accr Prog EXT     RT - Accrual Program EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WEOJCD           Accrual Code
      * Setup key
     C                     MOVELWL0001    WEOJCD           Accrual Code
      * Establish starting position
     C           KRSSF     CHAIN@AMREN7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4529' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           G/L Account Cat
     C                     MOVEL*BLANK    WL0003           APE Excl Collec
     C                     MOVEL*BLANK    WL0004           Record Status
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEPNAA    WL0002           G/L Account Cat
     C                     MOVELWEPAST    WL0003           APE Excl Collec
     C                     MOVELWEVSST    WL0004           Record Status
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Write Accrual Rcd RT - Accrual Prod Pgm  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0035 112       Item Accrual Am
     C                     MOVEL*BLANK    WN0036  1        Retro Comm Calc
     C                     MOVEL*BLANK    WN0037  1        SDA Affect Sale
     C                     MOVEL*BLANK    WN0038  1        SDA Affect Invo
     C                     MOVEL*BLANK    WN0039  1        SDA Print on In
     C                     MOVEL*BLANK    WN0040  2        SDA Invoice Pri
     C                     Z-ADD*ZERO     WN0041  70       SDA Ord Dtl Acr
     C                     Z-ADD*ZERO     WN0042 112       SDA Unused Amt
     C                     Z-ADD*ZERO     WN0043 112       SDA Unused Amt
     C                     Z-ADD*ZERO     WN0044  80       SDA G/L Sub Led
     C                     MOVEL*BLANK    WN0045  8        SDA G/L Code Dr
     C                     MOVEL*BLANK    WN0046  8        SDA G/L Code Cr
     C                     MOVEL*BLANK    WN0047  8        SDA JDE Account
     C                     MOVEL*BLANK    WN0048  8        SDA JDE Account
     C                     MOVEL*BLANK    WN0049  8        G/L Sub Account
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFOJCD    WQSG01           Accrual Code
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Accrual Code
      * Setup key
     C                     MOVELWDOJCD    WQSG01           Accrual Code
      * Establish starting position
     C           KRSSG     SETLL@D2RET9                    *
     C           KRSSG     READE@D2RET9                  90*
      * Data record not found
     C   90                MOVEL'USR3972' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * *------------ MAINTENANCE LOG ------------*
     C                     EXSR UESUBR                     *------------ M
      * E4057 JJH 04/24/14 - Determine Actual Ship Date used for calcs
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Billing Activity Type is Credit or Debit Memo
      *   |- c2    : PAR.SDA Atch to Ord ActShpDt is entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2OBST    IFEQ '2'                        *IF
     C           P2OBST    OREQ '3'
     C           YL0002    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0002    YL0005           Actual Shipped
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAGNDT    YL0005           Actual Shipped
     C                     END                             *FI
      * E4057 JJH 04/24/14 - Use LCL.Actual Ship Date
      * CALC: Accrual
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Actual Shipped Date GE DB1.AD Period Beginning D
      *   |- c2    : LCL.Actual Shipped Date LE DB1.AD Period Ending Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0005    IFGE WFSCDT                     *IF
     C           YL0005    IFLE WFSDDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVELWDI2TX    WN0045           SDA G/L Code Dr
     C                     MOVELWDJFTX    WN0046           SDA G/L Code Cr
      * Val G/L Act Cde 2 HPE XF - STR Hog Prcr & Eval Sys  * G/L Code Dr
     C                     CALL 'PKVBXFR'              90  Val G/L Act Cde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0003    WQ0001  30       Company Number
     C                     PARM WDI2TX    WQ0002  8        G/L Account Cod
     C           WUIYTX    PARM *BLANK    WQ0003 25        G/L Code Desc U
     C           WN0047    PARM *BLANK    WQ0004  8        G/L Account Id
     C                     PARM *BLANK    WQ0005  3        G/L Account Typ
     C                     PARM *BLANK    WQ0006  3        G/L Account Typ
     C           YL0006    PARM *BLANK    WQ0007  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKVBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Val G/L Act Cde 2 HPE XF - STR Hog Prcr & Eval Sys  * G/L Code Cr
     C                     CALL 'PKVBXFR'              90  Val G/L Act Cde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0003    WQ0008  30       Company Number
     C                     PARM WDJFTX    WQ0009  8        G/L Account Cod
     C           WUIYTX    PARM *BLANK    WQ0010 25        G/L Code Desc U
     C           WN0048    PARM *BLANK    WQ0011  8        G/L Account Id
     C                     PARM *BLANK    WQ0012  3        G/L Account Typ
     C                     PARM *BLANK    WQ0013  3        G/L Account Typ
     C           YL0006    PARM *BLANK    WQ0014  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKVBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDWFO9TX    WN0044           SDA G/L Sub Led
     C                     MOVELWDI3TX    WN0049           G/L Sub Account
     C                     MOVEL'N'       WUB8ST           Status - Y or N
      * If all products flag is no
      * CASE: PAR.All Products (Y/N) is No
     C           WDTTST    IFEQ 'N'                        *IF
      * RTV: Accrual Rate & Type
      * CASE: PAR.Accrual Detail Search is Item
     C           WDQFSX    IFEQ 'I'                        *IF
      * RTV & Chk Rate Exists  RT - Accrual Prod Pgm Item  * 
     C                     EXSR SHRVGN
     C                     END                             *FI
      * Check if Rate > 0
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : WRK.Accrual Rate is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           WUBKPR    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
     C                     END                             *FI
     C                     END                             *FI
      * 12/15/10 PKD TFS: C1208 Only check the Customer Selection if
      *              Product is applicable for the program.
      * CASE: WRK.Status - Y or N is yes
     C           WUB8ST    IFEQ 'Y'                        *IF
      * If all customers is no
      * CASE: DB1.AD All Customers is no
     C           WFEWST    IFEQ 'N'                        *IF
      * RTV: Ship To Customer and check status (skip if inactive)
      * RTV Acr Prod Pgm Cust RT - Accrual Prod Pgm Cust  * 
     C                     EXSR SIRVGN
     C                     END                             *FI
     C                     END                             *FI
      * Calc Accrual
      * CASE: WRK.Status - Y or N is yes
     C           WUB8ST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUTUST           Error Status  2
      * RTV Chk for Rvrs Accru RT - Order Detail Fin  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0005           Company Number
     C                     Z-ADDWAC4NB    WL0006           Order Number
     C                     Z-ADDWADPNB    WL0007           Order Sequence
     C                     Z-ADDWAUENB    WL0008           Order Secondary
     C                     MOVELWFOJCD    WL0009    P      Accrual Code
     C                     MOVELWUTUST    WL0010    P      Error Status  2
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    WUTUST    P      Error Status  2
      * CASE: WRK.Error Status  2 is No
     C           WUTUST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       WUTXST           Error Status  3
      * CASE: WRK.Error Status  3 is No
     C           WUTXST    IFEQ 'N'                        *IF
      * Calculate Extended Amount (which is the Accrual Amount)
      * E4057 JJH 04/29/15 - Rewrite Calc logic to utizile Affect Sales
      *  Pounds Status and Affect Sales Dollar Status
      * Calc Accrual
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Accrual Rate Type is $/Lb
      *   |- c2    : PAR.Affect Sales Pnds Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUSHSX    IFEQ 'W'                        *IF
     C           WAVAST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           WUBKPR    MULT WAATWG    WUAYVA           Extended Amount
     C                     END                             *FI
      * Change trans amount according to add-on/allowance flag
      * CASE:
      *  - c1AND(c2ORc3)
      *   |- c1    : PAR.Add-on/Allowance is Allowance
      *   |- c2    : PAR.Billing Activity Type is Invoice
      *   |- c3    : PAR.Billing Activity Type is Debit Memo
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WDTSST    IFEQ 'S'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           P2OBST    IFEQ '1'                        *IF
     C           P2OBST    OREQ '3'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           0         SUB  WUAYVA    WUAYVA           Extended Amount
     C                     END                             *FI
      * Change trans amount according to Credit Memo & Addon allow 4/14/1
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Billing Activity Type is Credit Memo
      *   |- c2    : PAR.Add-on/Allowance is Add-on
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2OBST    IFEQ '2'                        *IF
     C           WDTSST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           0         SUB  WUAYVA    WUAYVA           Extended Amount
     C                     END                             *FI
     C                     Z-ADDWUAYVA    WN0035           Item Accrual Am
     C                     ADD  1         WN0001           Sequence Number
      * E4057 JJH 04/27/15 - Populate: SDA Atch to Ord ActShpDt
      * CASE: WRK.Extended Amount is not equal to zeros
     C           WUAYVA    IFNE 0                          *IF
      * E4057 JJH 05/13/15 - Only crt record if Extended Amount NE 0
      * CRT OM Ship Dtl Accrul CR - Shipping Dtl Accrual  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDWAC4NB    WL0012           Order Number
     C                     Z-ADDWADPNB    WL0013           Order Sequence
     C                     Z-ADDWAUENB    WL0014           Order Secondary
     C                     Z-ADDWN0001    WL0015           Sequence Number
     C                     Z-ADDWUBKPR    WL0016           Accrual Rate
     C                     Z-ADDWUC5PC    WL0017           Accrual Percent
     C                     Z-ADDWUAYVA    WL0018           Extended Amount
     C                     Z-ADDWN0035    WL0019           Item Accrual Am
     C                     Z-ADDWAHGCD    WL0020           Item Code
     C                     Z-ADDWABKC7    WL0021           Ship To Custome
     C                     Z-ADDP2ANC7    WL0022           A/R Customer
     C                     MOVELYL0007    WL0023    P      Broker Code
     C                     Z-ADDWAGNDT    WL0024           SDA Actual Ship
     C                     Z-ADDWAATWG    WL0025           Weight Billed
     C                     MOVEL'Y'       WL0026    P      Use G/L Code Dr
     C                     MOVELWN0036    WL0027    P      Retro Comm Calc
     C                     MOVELWDOKCD    WL0028    P      Accrual Type
     C                     MOVELWDFETX    WL0029    P      SDA Affect Sale
     C                     MOVELWDFFTX    WL0030    P      SDA Affect Invo
     C                     MOVELWDTQST    WL0031    P      SDA Print on In
     C                     MOVELWDFGTX    WL0032    P      SDA Invoice Pri
     C                     Z-ADDWN0041    WL0033           SDA Ord Dtl Acr
     C                     Z-ADDYL0002    WL0034           SDA Atch to Ord
     C                     Z-ADDWN0042    WL0035           SDA Unused Amt
     C                     Z-ADDWN0043    WL0036           SDA Unused Amt
     C                     MOVELWDLEDG    WL0037    P      SDA Post to G/L
     C                     MOVELWUSHSX    WL0038    P      SDA Accrual Rat
     C                     Z-ADDP2AWDT    WL0039           SDA Invoice Dat
     C                     MOVELWDTYST    WL0040    P      SDA Sub Ledger
     C                     Z-ADDWN0044    WL0041           SDA G/L Sub Led
     C                     MOVELWN0045    WL0042    P      SDA G/L Code Dr
     C                     MOVELWN0046    WL0043    P      SDA G/L Code Cr
     C                     MOVELWN0047    WL0044    P      SDA JDE Account
     C                     MOVELWN0048    WL0045    P      SDA JDE Account
     C                     MOVELWFOJCD    WL0046    P      Accrual Code
     C                     MOVELWDJGTX    WL0047    P      SH Expense Buck
     C                     MOVELWN0049    WL0048    P      G/L Sub Account
     C                     MOVELYL0008    WL0049    P      EDI Status 1
     C                     MOVELYL0009    WL0050    P      EDI Status 2
     C                     MOVELYL0010    WL0051    P      EDI Status 3
     C                     Z-ADDYL0011    WL0052           Job Time
     C                     MOVELYL0012    WL0053    P      User Id
     C                     MOVELYL0013    WL0054    P      Job Name
     C                     Z-ADDYL0014    WL0055           Job Date
     C                     EXSR SLCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSG     READE@D2RET9                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV & Chk Rate Exists  RT - Accrual Prod Pgm Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WGOJCD           Accrual Code
     C                     KFLD           WGMSNY           AD Program Numb
     C                     KFLD           WGHGCD           Item Code
      * Setup key
     C                     MOVELWFOJCD    WGOJCD           Accrual Code
     C                     Z-ADDWFMSNY    WGMSNY           AD Program Numb
     C                     Z-ADDWAHGCD    WGHGCD           Item Code
      * Establish starting position
     C           KRSSH     CHAIN@D3REUC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3974' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WUSHSX           Accrual Rate Ty
     C                     Z-ADD*ZERO     WUBKPR           Accrual Rate
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWGSHSX    WUSHSX           Accrual Rate Ty
     C                     Z-ADDWGBKPR    WUBKPR           Accrual Rate
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Acr Prod Pgm Cust RT - Accrual Prod Pgm Cust  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0050  1        Record Status
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WHOJCD           Accrual Code
     C                     KFLD           WHMSNY           AD Program Numb
     C                     KFLD           WHBKC7           Ship To Custome
      * Setup key
     C                     MOVELWFOJCD    WHOJCD           Accrual Code
     C                     Z-ADDWFMSNY    WHMSNY           AD Program Numb
     C                     Z-ADDWABKC7    WHBKC7           Ship To Custome
      * Establish starting position
     C           KRSSI     CHAIN@FJREBY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4157' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     MOVEL'N'       WUB8ST           Status - Y or N
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WHVSST    IFEQ 'A'                        *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Chk for Rvrs Accru RT - Order Detail Fin  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN WIC4NB    WQSJ02           Order Number
     C           *LIKE     DEFN WIDPNB    WQSJ03           Order Sequence
     C           *LIKE     DEFN WIUENB    WQSJ04           Order Secondary
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Order Number
     C                     KFLD           WQSJ03           Order Sequence
     C                     KFLD           WQSJ04           Order Secondary
      * Setup key
     C                     Z-ADDWL0005    WQSJ01           Company Number
     C                     Z-ADDWL0006    WQSJ02           Order Number
     C                     Z-ADDWL0007    WQSJ03           Order Sequence
     C                     Z-ADDWL0008    WQSJ04           Order Secondary
      * Establish starting position
     C           KRSSJ     SETLL@CRWKL1                    *
     C           KRSSJ     READE@CRWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1317' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Financial Type is Accrual Charge
     C           WIG4ST    IFEQ 'A'                        *IF
      * RTV Reverse Code       RT - Accrual Code Master  * 
     C                     EXSR SKRVGN
      * CASE: PAR.Accrual Code EQ WRK.Reverse Accrual Code
     C           WL0009    IFEQ WUOQCD                     *IF
     C                     MOVEL'Y'       WL0010           Error Status  2
     C                     GOTO SJEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSJ     READE@CRWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Reverse Code       RT - Accrual Code Master  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0051  1        Automatic Accru
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WJOJCD           Accrual Code
      * Setup key
     C                     MOVELWIOJCD    WJOJCD           Accrual Code
      * Establish starting position
     C           KRSSK     CHAIN@HLREK4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1514' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0051           Automatic Accru
     C                     MOVEL*BLANK    WUOQCD           Reverse Accrual
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWJTOST    WN0051           Automatic Accru
     C                     MOVELWJOQCD    WUOQCD           Reverse Accrual
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCRRC    BEGSR
      *================================================================
      * CRT OM Ship Dtl Accrul CR - Shipping Dtl Accrual  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @HRCPLL
     C                     Z-ADDWL0011    WKAIC3           Company Number
     C                     Z-ADDWL0012    WKC4NB           Order Number
     C                     Z-ADDWL0013    WKDPNB           Order Sequence
     C                     Z-ADDWL0014    WKUENB           Order Secondary
     C                     Z-ADDWL0015    WKDXNB           Sequence Number
     C                     Z-ADDWL0016    WKBKPR           Accrual Rate
     C                     Z-ADDWL0017    WKC5PC           Accrual Percent
     C                     Z-ADDWL0018    WKAYVA           Extended Amount
     C                     Z-ADDWL0019    WKEDVL           Item Accrual Am
     C                     Z-ADDWL0020    WKHGCD           Item Code
     C                     Z-ADDWL0021    WKBKC7           Ship To Custome
     C                     Z-ADDWL0022    WKDUC7           A/R Customer
     C                     MOVELWL0023    WKHHAA           Broker Code
     C                     Z-ADDWL0024    WKPODT           SDA Actual Ship
     C                     Z-ADDWL0025    WKBYWG           Weight Billed
     C                     MOVELWL0026    WKBVST           Use G/L Code Dr
     C                     MOVELWL0027    WKP7SX           Retro Comm Calc
     C                     MOVELWL0028    WKOKCD           Accrual Type
     C                     MOVELWL0029    WKP8SX           SDA Affect Sale
     C                     MOVELWL0030    WKP9SX           SDA Affect Invo
     C                     MOVELWL0031    WKQASX           SDA Print on In
     C                     MOVELWL0032    WKQBSX           SDA Invoice Pri
     C                     Z-ADDWL0033    WKPPDT           SDA Ord Dtl Acr
     C                     Z-ADDWL0034    WKPQDT           SDA Atch to Ord
     C                     Z-ADDWL0035    WKEEVL           SDA Unused Amt
     C                     Z-ADDWL0036    WKEFVL           SDA Unused Amt
     C                     MOVELWL0037    WKFITX           SDA Post to G/L
     C                     MOVELWL0038    WKFJTX           SDA Accrual Rat
     C                     Z-ADDWL0039    WKQ8DT           SDA Invoice Dat
     C                     MOVELWL0040    WKFKTX           SDA Sub Ledger
     C                     Z-ADDWL0041    WKH0NY           SDA G/L Sub Led
     C                     MOVELWL0042    WKKQT1           SDA G/L Code Dr
     C                     MOVELWL0043    WKKTT1           SDA G/L Code Cr
     C                     MOVELWL0044    WKHIAA           SDA JDE Account
     C                     MOVELWL0045    WKHLAA           SDA JDE Account
     C                     MOVELWL0046    WKOJCD           Accrual Code
     C                     MOVELWL0047    WKAVNB           SH Expense Buck
     C                     MOVELWL0048    WKDSCD           G/L Sub Account
     C                     MOVELWL0049    WKUVST           EDI Status 1
     C                     MOVELWL0050    WKUWST           EDI Status 2
     C                     MOVELWL0051    WKUXST           EDI Status 3
     C                     Z-ADDWL0052    WKAATM           Job Time
     C                     MOVELWL0053    WKAYNA           User Id
     C                     MOVELWL0054    WKA0NA           Job Name
     C                     Z-ADDWL0055    WKAXDT           Job Date
      *
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##JOB     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
     C           KLCRSL    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKC4NB           Order Number
     C                     KFLD           WKDPNB           Order Sequence
     C                     KFLD           WKUENB           Order Secondary
     C                     KFLD           WKDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSL    SETLL@HRCPLL                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1527' W0RTN   7
      * Send message 'Shipping Dtl Accrual   EX'
     C                     MOVEL'USR1527' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C                     WRITE@HRCPLL                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Write Accrual Rcd RT - Customer Accrual  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0052 30        Accrual Descrip
     C                     MOVEL*BLANK    WN0053  1        Automatic Accru
     C                     MOVEL*BLANK    WN0054  1        Print On Invoic
     C                     MOVEL*BLANK    WN0055  1        Rate Usage
     C                     MOVEL*BLANK    WN0056  1        Add-on/Allowanc
     C                     MOVEL*BLANK    WN0057  2        Accrual Type
     C                     MOVEL*BLANK    WN0058  2        Sub Ledger Code
     C                     MOVEL*BLANK    WN0059  3        Reverse Accrual
     C                     MOVEL*BLANK    WN0060  2        U/M - Primary D
     C                     MOVEL*BLANK    WN0061  8        G/L Code Dr
     C                     MOVEL*BLANK    WN0062  8        G/L Code Cr
     C                     MOVEL*BLANK    WN0063  8        G/L Sub Account
     C                     MOVEL*BLANK    WN0064  8        Sales History E
     C                     MOVEL*BLANK    WN0065  1        Post to G/L (Y/
     C                     MOVEL*BLANK    WN0066  2        Accrual Rate Ty
     C                     MOVEL*BLANK    WN0067  1        Affect Sales Re
     C                     MOVEL*BLANK    WN0068  1        Affect Invoice
     C                     MOVEL*BLANK    WN0069  2        Invoice Print T
     C                     Z-ADD*ZERO     WN0070 112       Item Accrual Am
     C                     MOVEL*BLANK    WN0071  1        Retro Comm Calc
     C                     MOVEL*BLANK    WN0072  1        SDA Affect Sale
     C                     MOVEL*BLANK    WN0073  1        SDA Affect Invo
     C                     MOVEL*BLANK    WN0074  1        SDA Print on In
     C                     MOVEL*BLANK    WN0075  2        SDA Invoice Pri
     C                     Z-ADD*ZERO     WN0076  70       SDA Ord Dtl Acr
     C                     Z-ADD*ZERO     WN0077 112       SDA Unused Amt
     C                     Z-ADD*ZERO     WN0078 112       SDA Unused Amt
     C                     Z-ADD*ZERO     WN0079  80       SDA G/L Sub Led
     C                     MOVEL*BLANK    WN0080  8        SDA G/L Code Dr
     C                     MOVEL*BLANK    WN0081  8        SDA G/L Code Cr
     C                     MOVEL*BLANK    WN0082  8        SDA JDE Account
     C                     MOVEL*BLANK    WN0083  8        SDA JDE Account
     C                     MOVEL*BLANK    WN0084  8        G/L Sub Account
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLBKC7    WQSM01           Ship To Custome
      * Define keylist
     C           KPSSM     KLIST
     C                     KFLD           WQSM01           Ship To Custome
     C                     KFLD           WLQGSX           Commission/Not
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Ship To Custome
      * Setup key
     C                     Z-ADDWABKC7    WQSM01           Ship To Custome
     C                     MOVEL'1'       WLQGSX           Commission/Not
      * Establish starting position
     C           KPSSM     SETLL@HOREKH                    *
     C           KRSSM     READE@HOREKH                  90*
      * Data record not found
     C   90                MOVEL'USR1520' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * E4057 JJH 05/13/15 - Reset Extended Amount to Zero
     C                     Z-ADD0         WUAYVA           Extended Amount
      * Rtv Accr Prog EXT     RT - Accrual Program EXT  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWLOJCD    WL0001    P      Accrual Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YN0004    P      G/L Account Cat
     C                     MOVELWL0003    YL0015    P      APE Excl Collec
     C                     MOVELWL0004    YN0005    P      Record Status
      * OMIT:  Shipping Method = Collect Rail or Truck
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.APE Excl Collect ShpMthd is Yes
      *   |- c2    : PAR.Shipping Method is Collect
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0015    IFEQ 'Y'                        *IF
     C           YL0001    IFEQ 'CR'                       *IF
     C           YL0001    OREQ 'CT'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     MOVEL*BLANK    WN0071           Retro Comm Calc
      * E4057 JJH 04/24/14 - Revised logic for Actual Ship Date
      * Process Accrual Program
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Billing Activity Type is Credit or Debit Memo
      *   |- c2    : PAR.SDA Atch to Ord ActShpDt is entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2OBST    IFEQ '2'                        *IF
     C           P2OBST    OREQ '3'
     C           YL0002    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0002    YL0016           Actual Shipped
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAGNDT    YL0016           Actual Shipped
     C                     END                             *FI
      * E4057 JJH 04/24/14 - Utilize LCL.Actual Ship Date
      * Actual Ship Date between Priod Begin & Period End Date
      * CASE: Period Begin <= Actual Ship Date <= Period End
      *  - c1 AND c2
      *   |- c1    : LCL.Actual Shipped Date GE DB1.Period Beginning Date
      *   |- c2    : LCL.Actual Shipped Date LE DB1.Period Ending Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0016    IFGE WLBFDT                     *IF
     C           YL0016    IFLE WLA2DT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV All Values Act NEW RT - Accrual Program  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWLOJCD    WL0056    P      Accrual Code
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0057    WN0052    P      Accrual Descrip
     C                     MOVELWL0058    WN0053    P      Automatic Accru
     C                     MOVELWL0059    WN0054    P      Print On Invoic
     C                     MOVELWL0060    WN0055    P      Rate Usage
     C                     MOVELWL0061    WN0056    P      Add-on/Allowanc
     C                     MOVELWL0062    WN0057    P      Accrual Type
     C                     MOVELWL0063    WN0058    P      Sub Ledger Code
     C                     MOVELWL0064    WN0059    P      Reverse Accrual
     C                     MOVELWL0065    WN0060    P      U/M - Primary D
     C                     MOVELWL0066    WN0061    P      G/L Code Dr
     C                     MOVELWL0067    WN0062    P      G/L Code Cr
     C                     MOVELWL0068    WN0063    P      G/L Sub Account
     C                     MOVELWL0069    WN0064    P      Sales History E
     C                     MOVELWL0070    WN0065    P      Post to G/L (Y/
     C                     MOVELWL0071    WN0066    P      Accrual Rate Ty
     C                     MOVELWL0072    WN0067    P      Affect Sales Re
     C                     MOVELWL0073    WN0068    P      Affect Invoice
     C                     MOVELWL0074    WN0069    P      Invoice Print T
     C                     MOVELWN0061    WN0080           SDA G/L Code Dr
     C                     MOVELWN0062    WN0081           SDA G/L Code Cr
      * Val G/L Act Cde 2 HPE XF - STR Hog Prcr & Eval Sys  * G/L Code Dr
     C                     CALL 'PKVBXFR'              90  Val G/L Act Cde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0003    WQ0015  30       Company Number
     C                     PARM WN0061    WQ0016  8        G/L Account Cod
     C           WUIYTX    PARM *BLANK    WQ0017 25        G/L Code Desc U
     C           WN0082    PARM *BLANK    WQ0018  8        G/L Account Id
     C                     PARM *BLANK    WQ0019  3        G/L Account Typ
     C                     PARM *BLANK    WQ0020  3        G/L Account Typ
     C           YL0017    PARM *BLANK    WQ0021  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKVBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Val G/L Act Cde 2 HPE XF - STR Hog Prcr & Eval Sys  * G/L Code Cr
     C                     CALL 'PKVBXFR'              90  Val G/L Act Cde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0003    WQ0022  30       Company Number
     C                     PARM WN0062    WQ0023  8        G/L Account Cod
     C           WUIYTX    PARM *BLANK    WQ0024 25        G/L Code Desc U
     C           WN0083    PARM *BLANK    WQ0025  8        G/L Account Id
     C                     PARM *BLANK    WQ0026  3        G/L Account Typ
     C                     PARM *BLANK    WQ0027  3        G/L Account Typ
     C           YL0017    PARM *BLANK    WQ0028  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKVBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD*ZERO     WN0079           G/L Sub Ledger
      * G/L Sub Ledger DRV
      * A/R Customer
      * CASE: PAR.Sub Ledger Code is A/R Customer
     C           WN0058    IFEQ 'A'                        *IF
      * Rtv g/l Vendor        RT - Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2ANC7    WL0075           Ship To Custome
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0076    WN0079           Customer G/L Ve
     C                     END                             *FI
      * Ship To Customer
      * CASE: PAR.Sub Ledger Code is Ship To Customer
     C           WN0058    IFEQ 'S'                        *IF
      * Rtv g/l Vendor        RT - Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLBKC7    WL0075           Ship To Custome
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0076    WN0079           Customer G/L Ve
     C                     END                             *FI
      * Broker
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Sub Ledger Code is Broker
      *   |- c2    : PAR.Sub Ledger Code is Buyer Group
      *   '-
     C           WN0058    IFEQ 'B'                        *IF
     C           WN0058    OREQ 'G'                        *OR
      * Rtv Broker Info       RT - Broker  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWLHHAA    WL0077    P      Broker Code
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0078    YL0018    P      Broker Name
     C                     MOVELWL0079    YL0019    P      Broker Address
     C                     MOVELWL0080    YL0020    P      Broker Address
     C                     MOVELWL0081    YL0021    P      Broker City
     C                     MOVELWL0082    YL0022    P      Broker State
     C                     MOVELWL0083    YL0023    P      Broker Zip
     C                     MOVELWL0084    YL0024    P      Broker Office M
     C                     MOVELWL0085    YL0025    P      Broker Telephon
     C                     MOVELWL0086    YL0026    P      Broker Fax Numb
     C                     MOVELWL0087    YL0027    P      Broker Email Ad
     C                     Z-ADDWL0088    WN0079           Broker G/L Vend
     C                     MOVELWL0089    YL0028    P      Salesperson Cod
     C                     END                             *FI
     C                     MOVELWN0063    WN0084           G/L Sub Account
      * E4057 JJH 04/29/15 - Rewrite Calc logic to utizile Affect Sales
      *  Pounds Status and Affect Sales Dollar Status
      * Determine Rate & Calculate Accrual Amount
      * CASE: PAR.Automatic Accrual (Y/N) is Yes
     C           WN0053    IFEQ 'Y'                        *IF
      * E4057 JJH 05/04/15 - Revised logic for Accrual Rates
      * Accrual Type is : Not Commission - same as Commission now DLY029
      * CASE: DB1.Commission/Not Comm Sts is Not Commission
     C           WLQGSX    IFEQ '1'                        *IF
     C                     MOVEL'N'       WUB8ST           Status - Y or N
      * If all products is Yes
      * CASE: DB1.All Products (Y/N) is Yes
     C           WLTTST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
      * Accrual Rate
      * CASE: DB1.Accrual Rate Type is All Sales
     C           WLSHSX    IFEQ 'W'                        *IF
     C           WLSHSX    OREQ 'S'
     C           WLSHSX    OREQ 'Q'
     C           WLSHSX    OREQ 'G'
     C           WLSHSX    OREQ 'FA'
      * RMC 08/09/07 add "G" (% of gross ext amt) to All Sales condition
     C                     Z-ADDWLBKPR    WUBKPR           Accrual Rate
     C                     MOVELWLSHSX    WUSHSX           Accrual Rate Ty
     C                     ELSE
      * CASE: DB1.Accrual Rate Type is NetSls-3rdParty Adj
     C           WLSHSX    IFEQ 'SA'                       *IF
      * E4057 JJH 05/04/15 - Per Purva Droge, Leave as is because this is
      *   NOT affected by Customer Accrual.
      * ** Exclude 3rd Party Sales Adjustments      FP1314 LJB
     C                     MOVEL'N'       WUB8ST           Status - Y or N
     C                     ELSE
      * CASE: DB1.Accrual Rate Type is Flat Order Amount
     C           WLSHSX    IFEQ 'FO'                       *IF
      * E4057 JJH 05/04/15 - Revised logic for Flat Load Amount
      * Process by Billing Activity Type
      * CASE:
      *  - c1 OR (c2 AND c3)
      *   |- c1    : PAR.Billing Activity Type is Invoice
      *   |- c2    : PAR.Billing Activity Type is Credit Memo
      *   |- c3    : PAR.OD Full Return to Plant is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2OBST    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           P2OBST    IFEQ '2'                        *IF
     C           WAH0ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Val Accrual Exists    RT - Shipping Dtl Accrual  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0090           Company Number
     C                     Z-ADDWAC4NB    WL0091           Order Number
     C                     MOVELWLOJCD    WL0092    P      Accrual Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0093    YL0017    P      Record Found US
      * CASE: LCL.Record Found USR is Record Not Found
     C           YL0017    IFEQ 'N'                        *IF
     C                     Z-ADDWLBKPR    WUBKPR           Accrual Rate
     C                     MOVELWLSHSX    WUSHSX           Accrual Rate Ty
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUB8ST           Status - Y or N
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUB8ST           Status - Y or N
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.Accrual Rate Type is Flat Load Amount
     C           WLSHSX    IFEQ 'FL'                       *IF
      * E4057 JJH 05/04/15 - Revised logic for Flat Load Amount
      * Process by Billing Activity Type
      * CASE:
      *  - (c1 AND c2) OR (c3 AND c4)
      *   |- c1    : PAR.Billing Activity Type is Invoice
      *   |- c2    : PAR.Load ID is NE Blank
      *   |- c3    : PAR.Billing Activity Type is Credit Memo
      *   |- c4    : PAR.OD Full Return to Plant is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2OBST    IFEQ '1'                        *IF
     C           P2RMNB    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           P2OBST    IFEQ '2'                        *IF
     C           WAH0ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: PAR.Billing Activity Type is Invoice
     C           P2OBST    IFEQ '1'                        *IF
      * Val Accrual Exists    RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2RMNB    WL0094           Load ID
     C                     MOVELWLOJCD    WL0095    P      Accrual Code
     C                     MOVELWN0057    WL0096    P      Accrual Type
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0097    YL0017    P      Record Found US
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Accrual Exists    RT - Shipping Dtl Accrual  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0090           Company Number
     C                     Z-ADDWAC4NB    WL0091           Order Number
     C                     MOVELWLOJCD    WL0092    P      Accrual Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0093    YL0017    P      Record Found US
     C                     END                             *FI
      * CASE: LCL.Record Found USR is Record Not Found
     C           YL0017    IFEQ 'N'                        *IF
     C                     Z-ADDWLBKPR    WUBKPR           Accrual Rate
     C                     MOVELWLSHSX    WUSHSX           Accrual Rate Ty
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUB8ST           Status - Y or N
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUB8ST           Status - Y or N
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * If all products flag is no/yes+exceptions, check for item exists
      * CASE: DB1.All Products (Y/N) is No
     C           WLTTST    IFEQ 'N'                        *IF
      * RTV: Accrual Rate
      * CASE: DB1.Accrual Detail Search is Item
     C           WLQFSX    IFEQ 'I'                        *IF
      * RTV & Chk Rate Exists  RT - Customer Accrual Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLBKC7    WL0098           Ship To Custome
     C                     MOVELWLOJCD    WL0099    P      Accrual Code
     C                     Z-ADDWLGUNY    WL0100           CAH Sequence No
     C                     Z-ADDWAHGCD    WL0101           Item Code
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0102    WUBKPR           Accrual Rate
     C                     MOVELWL0103    WUSHSX    P      Accrual Rate Ty
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLBKC7    WL0104           Ship To Custome
     C                     MOVELWLOJCD    WL0105    P      Accrual Code
     C                     Z-ADDWLGUNY    WL0106           CAH Sequence No
     C                     Z-ADDWARGNB    WL0107           Item Structure
     C                     Z-ADDWARHNB    WL0108           Item Structure
     C                     Z-ADDWARINB    WL0109           Item Structure
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0110    WUBKPR           Accrual Rate
     C                     MOVELWL0111    WUSHSX    P      Accrual Rate Ty
      * Check for item str type/group without the class  RMC 08/07/07
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLBKC7    WL0104           Ship To Custome
     C                     MOVELWLOJCD    WL0105    P      Accrual Code
     C                     Z-ADDWLGUNY    WL0106           CAH Sequence No
     C                     Z-ADDWARGNB    WL0107           Item Structure
     C                     Z-ADDWARHNB    WL0108           Item Structure
     C                     Z-ADD0         WL0109           Item Structure
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0110    WUBKPR           Accrual Rate
     C                     MOVELWL0111    WUSHSX    P      Accrual Rate Ty
     C                     END                             *FI
     C                     END                             *FI
      * 05/09/08 PKD/SZ Only calculate the Accrual if Rate > 0
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : WRK.Accrual Rate is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           WUBKPR    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If Yes + Exc
      * CASE: DB1.All Products (Y/N) is Yes + Exceptions
     C           WLTTST    IFEQ 'X'                        *IF
      * RTV: Accrual Rate
      * CASE: DB1.Accrual Detail Search is Item
     C           WLQFSX    IFEQ 'I'                        *IF
      * RTV & Chk Rate Exists  RT - Customer Accrual Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLBKC7    WL0098           Ship To Custome
     C                     MOVELWLOJCD    WL0099    P      Accrual Code
     C                     Z-ADDWLGUNY    WL0100           CAH Sequence No
     C                     Z-ADDWAHGCD    WL0101           Item Code
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0102    WUBKPR           Accrual Rate
     C                     MOVELWL0103    WUSHSX    P      Accrual Rate Ty
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLBKC7    WL0104           Ship To Custome
     C                     MOVELWLOJCD    WL0105    P      Accrual Code
     C                     Z-ADDWLGUNY    WL0106           CAH Sequence No
     C                     Z-ADDWARGNB    WL0107           Item Structure
     C                     Z-ADDWARHNB    WL0108           Item Structure
     C                     Z-ADDWARINB    WL0109           Item Structure
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0110    WUBKPR           Accrual Rate
     C                     MOVELWL0111    WUSHSX    P      Accrual Rate Ty
      * Check for item str type/group without the class  RMC 08/07/07
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLBKC7    WL0104           Ship To Custome
     C                     MOVELWLOJCD    WL0105    P      Accrual Code
     C                     Z-ADDWLGUNY    WL0106           CAH Sequence No
     C                     Z-ADDWARGNB    WL0107           Item Structure
     C                     Z-ADDWARHNB    WL0108           Item Structure
     C                     Z-ADD0         WL0109           Item Structure
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0110    WUBKPR           Accrual Rate
     C                     MOVELWL0111    WUSHSX    P      Accrual Rate Ty
     C                     END                             *FI
     C                     END                             *FI
      * Calcualte only if Rate exists
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
      * 11/26/02 Exception may exist as 0 -- then dont calc accrual
      * CASE: WRK.Accrual Rate is equal to zero
     C           WUBKPR    IFEQ 0                          *IF
     C                     MOVEL'N'       WUB8ST           Status - Y or N
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWLBKPR    WUBKPR           Accrual Rate
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
     C                     MOVELWLSHSX    WUSHSX           Accrual Rate Ty
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Calc Accrual
      * CASE: WRK.Status - Y or N is yes
     C           WUB8ST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUTUST           Error Status  2
      * RTV Chk for Rvrs Accru RT - Order Detail Fin  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0005           Company Number
     C                     Z-ADDWAC4NB    WL0006           Order Number
     C                     Z-ADDWADPNB    WL0007           Order Sequence
     C                     Z-ADDWAUENB    WL0008           Order Secondary
     C                     MOVELWLOJCD    WL0009    P      Accrual Code
     C                     MOVELWUTUST    WL0010    P      Error Status  2
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    WUTUST    P      Error Status  2
      * Calc Accrual
      * CASE: WRK.Error Status  2 is No
     C           WUTUST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       WUTXST           Error Status  3
      * CASE: WRK.Error Status  3 is No
     C           WUTXST    IFEQ 'N'                        *IF
      * Calculate Extended Amount (which is the Accrual Amount)
      * E4057 JJH 05/04/15 - Revised logic for Accrual Rates
      * Calc Accrual
      * CASE:
      *  - c1 AND c3
      *   |- c1    : WRK.Accrual Rate Type is $/Lb
      *   |- c3    : PAR.Affect Sales Pnds Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUSHSX    IFEQ 'W'                        *IF
     C           WAVAST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           WUBKPR    MULT WAATWG    WUAYVA           Extended Amount
     C                     ELSE
      * CASE:
      *  - c1 AND c3
      *   |- c1    : WRK.Accrual Rate Type is $/Quantity
      *   |- c3    : PAR.Affect Sales Pnds Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUSHSX    IFEQ 'Q'                        *IF
     C           WAVAST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           WUBKPR    MULT WACBQT    WUAYVA           Extended Amount
     C                     ELSE
      * CASE:
      *  - c1 AND c4
      *   |- c1    : WRK.Accrual Rate Type is % of Net Sales
      *   |- c4    : PAR.Affect Sales Doll Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUSHSX    IFEQ 'S'                        *IF
     C           WAANST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * (RMC Added check for "SS" for new Seidai contract)
      * Accr Amount = order dtl extended amt - TF Accruals - Absorbed Frt
      * Rtv TF accrl total    RT - Shipping Dtl Accrual  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0112           Company Number
     C                     Z-ADDWAC4NB    WL0113           Order Number
     C                     Z-ADDWADPNB    WL0114           Order Sequence
     C                     Z-ADDWAUENB    WL0115           Order Secondary
     C                     Z-ADD1         WL0116           Sequence Number
     C                     Z-ADDWUMFQT    WL0117           Total Amount
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0117    WUMFQT           Total Amount
      * Calculate Absorbed Freight Amount
     C           P2TBNB    DIV  100       WUWB      H      *Synon (15,5) w
     C           WAATWG    MULT WUWB      WUULVA    H      Absorbed Freigh
      * Compute: Accr Amt f/Sales
      * WRK.Extended Amount =
      *    *COMPUTE ((x1-x2-x3)*x4)
      * x1    : PAR.Extended Amount
      * -     : PGM.*Synon (15,2) work field
      * x2    : WRK.Total Amount
      * -     : PGM.*Synon (15,2) work field
      * x3    : WRK.Absorbed Freight Amount
      * *     : PGM.*Synon (15,2) work field *
      * x4    : WRK.Accrual Rate
     C           WAAYVA    SUB  WUMFQT    W0WA02           *Synon (15,2) w
     C           W0WA02    SUB  WUULVA    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT WUBKPR    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUAYVA           Extended Amount
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Accrual Rate Type is % of Gross Extended Amt
      *   |- c2    : PAR.Affect Sales Doll Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUSHSX    IFEQ 'G'                        *IF
     C           WAANST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Accrual = gross extended amt from Order dtl * accrual rate
      * WRK.Extended Amount
      * WRK.Extended Amount =
      *    *COMPUTE ((x1 * x2) / x3)
      * x1    : WRK.Accrual Rate
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Extended Amount
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           WUBKPR    MULT WAAYVA    W0WA01    H      *Synon (15,2) w
     C           W0WA01    DIV  100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUAYVA           Extended Amount
      * E4057 JJH 06/04/15 - Correction for Flat Load Amount & Invoice
     C                     ELSE
      * CASE:
      *  - (c2 AND c3 AND c4) OR (c2 AND c5)
      *   |- c2    : WRK.Accrual Rate Type is Flat Load Amount
      *   |- c3    : PAR.Billing Activity Type is Credit Memo
      *   |- c4    : PAR.OD Full Return to Plant is Yes
      *   |- c5    : PAR.Billing Activity Type is Invoice
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUSHSX    IFEQ 'FL'                       *IF
     C           P2OBST    IFEQ '2'                        *IF
     C           WAH0ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WUSHSX    IFEQ 'FL'                       *IF
     C           P2OBST    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWUBKPR    WUAYVA           Extended Amount
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Change trans amount according to add-on/allowance flag
      * CASE:
      *  - c1AND(c2ORc3)
      *   |- c1    : PAR.Add-on/Allowance is Allowance
      *   |- c2    : PAR.Billing Activity Type is Invoice
      *   |- c3    : PAR.Billing Activity Type is Debit Memo
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0056    IFEQ 'S'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           P2OBST    IFEQ '1'                        *IF
     C           P2OBST    OREQ '3'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           0         SUB  WUAYVA    WUAYVA           Extended Amount
     C                     END                             *FI
      * Change trans amount according to Credit Memo & Addon allow  4/14/
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Billing Activity Type is Credit Memo
      *   |- c2    : PAR.Add-on/Allowance is Add-on
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2OBST    IFEQ '2'                        *IF
     C           WN0056    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           0         SUB  WUAYVA    WUAYVA           Extended Amount
     C                     END                             *FI
     C                     Z-ADDWUAYVA    WN0070           Item Accrual Am
     C                     ADD  1         WN0001           Sequence Number
      * db1.accrual percent changed to wrk. context    10/13
      * db1.company changed to par. context    10/22/04
      * RMC DLY029 5/23/07 output new fields
      * ** Don't create the record if the accrual amount = zeros  FP1314
      * CASE: WRK.Extended Amount is not equal to zeros
     C           WUAYVA    IFNE 0                          *IF
      * E4057 JJH 04/27/15 - Populate: SDA Atch to Ord ActShpDt
      * CRT OM Ship Dtl Accrul CR - Shipping Dtl Accrual  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDWAC4NB    WL0012           Order Number
     C                     Z-ADDWADPNB    WL0013           Order Sequence
     C                     Z-ADDWAUENB    WL0014           Order Secondary
     C                     Z-ADDWN0001    WL0015           Sequence Number
     C                     Z-ADDWUBKPR    WL0016           Accrual Rate
     C                     Z-ADDWUC5PC    WL0017           Accrual Percent
     C                     Z-ADDWUAYVA    WL0018           Extended Amount
     C                     Z-ADDWN0070    WL0019           Item Accrual Am
     C                     Z-ADDWAHGCD    WL0020           Item Code
     C                     Z-ADDWLBKC7    WL0021           Ship To Custome
     C                     Z-ADDP2ANC7    WL0022           A/R Customer
     C                     MOVELWLHHAA    WL0023    P      Broker Code
     C                     Z-ADDWAGNDT    WL0024           SDA Actual Ship
     C                     Z-ADDWAATWG    WL0025           Weight Billed
     C                     MOVEL'Y'       WL0026    P      Use G/L Code Dr
     C                     MOVELWN0071    WL0027    P      Retro Comm Calc
     C                     MOVELWN0057    WL0028    P      Accrual Type
     C                     MOVELWN0067    WL0029    P      SDA Affect Sale
     C                     MOVELWN0068    WL0030    P      SDA Affect Invo
     C                     MOVELWN0054    WL0031    P      SDA Print on In
     C                     MOVELWN0069    WL0032    P      SDA Invoice Pri
     C                     Z-ADDWN0076    WL0033           SDA Ord Dtl Acr
     C                     Z-ADDYL0002    WL0034           SDA Atch to Ord
     C                     Z-ADDWN0077    WL0035           SDA Unused Amt
     C                     Z-ADDWN0078    WL0036           SDA Unused Amt
     C                     MOVELWN0065    WL0037    P      SDA Post to G/L
     C                     MOVELWUSHSX    WL0038    P      SDA Accrual Rat
     C                     Z-ADDP2AWDT    WL0039           SDA Invoice Dat
     C                     MOVELWN0058    WL0040    P      SDA Sub Ledger
     C                     Z-ADDWN0079    WL0041           SDA G/L Sub Led
     C                     MOVELWN0080    WL0042    P      SDA G/L Code Dr
     C                     MOVELWN0081    WL0043    P      SDA G/L Code Cr
     C                     MOVELWN0082    WL0044    P      SDA JDE Account
     C                     MOVELWN0083    WL0045    P      SDA JDE Account
     C                     MOVELWLOJCD    WL0046    P      Accrual Code
     C                     MOVELWN0064    WL0047    P      SH Expense Buck
     C                     MOVELWN0084    WL0048    P      G/L Sub Account
     C                     MOVELWLUVST    WL0049    P      EDI Status 1
     C                     MOVELWLUWST    WL0050    P      EDI Status 2
     C                     MOVELWLUXST    WL0051    P      EDI Status 3
     C                     Z-ADDWLAATM    WL0052           Job Time
     C                     MOVELWLAYNA    WL0053    P      User Id
     C                     MOVELWLA0NA    WL0054    P      Job Name
     C                     Z-ADDWLAXDT    WL0055           Job Date
     C                     EXSR SLCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * E4057 JJH 05/04/15 - Revised logic for Accrual Rates
      * E4057 JJH 05/04/15 - Remove logic for Invoices only on Customer
      *   Accrual. Will now process all Billing Types to include Invoices
      *   Credit Memos, and Debit Memos.
      * Accrual Type is : Commission
      * CASE: Commission & Broker Entered
      *  - c1ANDc3
      *   |- c1    : DB1.Commission/Not Comm Sts is Commission
      *   |- c3    : DB1.Broker Code is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WLQGSX    IFEQ '9'                        *IF
     C           WLHHAA    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RMC 4/13/05 check for broker code too before calc'ing.
     C                     MOVEL'N'       WUB8ST           Status - Y or N
      * If all products is Yes
      * CASE: DB1.All Products (Y/N) is Yes
     C           WLTTST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
      * CASE: DB1.Accrual Rate Type is All Sales
     C           WLSHSX    IFEQ 'W'                        *IF
     C           WLSHSX    OREQ 'S'
     C           WLSHSX    OREQ 'Q'
     C           WLSHSX    OREQ 'G'
     C           WLSHSX    OREQ 'FA'
      * RMC 08/09/07 add "G" (% of gross ext amt) to All Sales condition
     C                     Z-ADDWLBKPR    WUBKPR           Accrual Rate
     C                     MOVELWLSHSX    WUSHSX           Accrual Rate Ty
     C                     ELSE
      * CASE: DB1.Accrual Rate Type is Flat Load Amount
     C           WLSHSX    IFEQ 'FL'                       *IF
      * RMC Added 9-24-20
      * Process by Billing Activity Type
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Billing Activity Type is Invoice
      *   |- c2    : PAR.Load ID is NE Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2OBST    IFEQ '1'                        *IF
     C           P2RMNB    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Val Accrual Exists    RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2RMNB    WL0094           Load ID
     C                     MOVELWLOJCD    WL0095    P      Accrual Code
     C                     MOVELWN0057    WL0096    P      Accrual Type
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0097    YL0017    P      Record Found US
      * CASE: LCL.Record Found USR is Record Not Found
     C           YL0017    IFEQ 'N'                        *IF
     C                     Z-ADDWLBKPR    WUBKPR           Accrual Rate
     C                     MOVELWLSHSX    WUSHSX           Accrual Rate Ty
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUB8ST           Status - Y or N
     C                     Z-ADD0         WUBKPR           Accrual Rate
     C                     MOVEL*BLANK    WUSHSX           Accrual Rate Ty
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUB8ST           Status - Y or N
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * If all products flag is no/yes+exceptions, check for item exists
      * CASE: DB1.All Products (Y/N) is No
     C           WLTTST    IFEQ 'N'                        *IF
      * CASE: DB1.Accrual Detail Search is Item
     C           WLQFSX    IFEQ 'I'                        *IF
      * RTV & Chk Rate Exists  RT - Customer Accrual Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLBKC7    WL0098           Ship To Custome
     C                     MOVELWLOJCD    WL0099    P      Accrual Code
     C                     Z-ADDWLGUNY    WL0100           CAH Sequence No
     C                     Z-ADDWAHGCD    WL0101           Item Code
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0102    WUBKPR           Accrual Rate
     C                     MOVELWL0103    WUSHSX    P      Accrual Rate Ty
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLBKC7    WL0104           Ship To Custome
     C                     MOVELWLOJCD    WL0105    P      Accrual Code
     C                     Z-ADDWLGUNY    WL0106           CAH Sequence No
     C                     Z-ADDWARGNB    WL0107           Item Structure
     C                     Z-ADDWARHNB    WL0108           Item Structure
     C                     Z-ADDWARINB    WL0109           Item Structure
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0110    WUBKPR           Accrual Rate
     C                     MOVELWL0111    WUSHSX    P      Accrual Rate Ty
      * Check for item str type/group without the class  RMC 08/07/07
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLBKC7    WL0104           Ship To Custome
     C                     MOVELWLOJCD    WL0105    P      Accrual Code
     C                     Z-ADDWLGUNY    WL0106           CAH Sequence No
     C                     Z-ADDWARGNB    WL0107           Item Structure
     C                     Z-ADDWARHNB    WL0108           Item Structure
     C                     Z-ADD0         WL0109           Item Structure
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0110    WUBKPR           Accrual Rate
     C                     MOVELWL0111    WUSHSX    P      Accrual Rate Ty
     C                     END                             *FI
     C                     END                             *FI
      * 05/09/08 PKD/SZ Only calculate the Accrual if Rate > 0
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Normal
      *   |- c2    : WRK.Accrual Rate is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RTN     IFEQ *BLANK                     *IF
     C           WUBKPR    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * If Yes + Exc
      * CASE: DB1.All Products (Y/N) is Yes + Exceptions
     C           WLTTST    IFEQ 'X'                        *IF
      * CASE: DB1.Accrual Detail Search is Item
     C           WLQFSX    IFEQ 'I'                        *IF
      * RTV & Chk Rate Exists  RT - Customer Accrual Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLBKC7    WL0098           Ship To Custome
     C                     MOVELWLOJCD    WL0099    P      Accrual Code
     C                     Z-ADDWLGUNY    WL0100           CAH Sequence No
     C                     Z-ADDWAHGCD    WL0101           Item Code
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0102    WUBKPR           Accrual Rate
     C                     MOVELWL0103    WUSHSX    P      Accrual Rate Ty
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLBKC7    WL0104           Ship To Custome
     C                     MOVELWLOJCD    WL0105    P      Accrual Code
     C                     Z-ADDWLGUNY    WL0106           CAH Sequence No
     C                     Z-ADDWARGNB    WL0107           Item Structure
     C                     Z-ADDWARHNB    WL0108           Item Structure
     C                     Z-ADDWARINB    WL0109           Item Structure
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0110    WUBKPR           Accrual Rate
     C                     MOVELWL0111    WUSHSX    P      Accrual Rate Ty
      * Check for item str type/group without the class  RMC 08/07/07
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWLBKC7    WL0104           Ship To Custome
     C                     MOVELWLOJCD    WL0105    P      Accrual Code
     C                     Z-ADDWLGUNY    WL0106           CAH Sequence No
     C                     Z-ADDWARGNB    WL0107           Item Structure
     C                     Z-ADDWARHNB    WL0108           Item Structure
     C                     Z-ADD0         WL0109           Item Structure
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0110    WUBKPR           Accrual Rate
     C                     MOVELWL0111    WUSHSX    P      Accrual Rate Ty
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
      * 11/26/02 Exception may exist as 0 -- then dont calc accrual
      * CASE: WRK.Accrual Rate is equal to zero
     C           WUBKPR    IFEQ 0                          *IF
     C                     MOVEL'N'       WUB8ST           Status - Y or N
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWLBKPR    WUBKPR           Accrual Rate
     C                     MOVEL'Y'       WUB8ST           Status - Y or N
     C                     MOVELWLSHSX    WUSHSX           Accrual Rate Ty
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Calc Accrual
      * CASE: WRK.Status - Y or N is yes
     C           WUB8ST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUTUST           Error Status  2
      * RTV Chk for Rvrs Accru RT - Order Detail Fin  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0005           Company Number
     C                     Z-ADDWAC4NB    WL0006           Order Number
     C                     Z-ADDWADPNB    WL0007           Order Sequence
     C                     Z-ADDWAUENB    WL0008           Order Secondary
     C                     MOVELWLOJCD    WL0009    P      Accrual Code
     C                     MOVELWUTUST    WL0010    P      Error Status  2
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    WUTUST    P      Error Status  2
      * CASE: WRK.Error Status  2 is No
     C           WUTUST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       WUTXST           Error Status  3
      * CASE: WRK.Error Status  3 is No
     C           WUTXST    IFEQ 'N'                        *IF
      * Calculate Extended Amount (which is the Accrual Amount)
      * 4/13/05 Use wrk.accrual rate type since it may come from the item
      * EXPCOM 11/10/04 RMC - New for exp commission And different Rate t
      * Calc Accrual
      * CASE:
      *  - c1 AND c3
      *   |- c1    : WRK.Accrual Rate Type is $/Lb
      *   |- c3    : PAR.Affect Sales Pnds Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUSHSX    IFEQ 'W'                        *IF
     C           WAVAST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           WUBKPR    MULT WAATWG    WUAYVA           Extended Amount
     C                     ELSE
      * CASE:
      *  - c1 AND c3
      *   |- c1    : WRK.Accrual Rate Type is $/Quantity
      *   |- c3    : PAR.Affect Sales Pnds Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUSHSX    IFEQ 'Q'                        *IF
     C           WAVAST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           WUBKPR    MULT WACBQT    WUAYVA           Extended Amount
     C                     ELSE
      * CASE:
      *  - c1 AND c4
      *   |- c1    : WRK.Accrual Rate Type is % of Net Sales
      *   |- c4    : PAR.Affect Sales Doll Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUSHSX    IFEQ 'S'                        *IF
     C           WAANST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * (RMC Added check for "SS" for new Seidai contract)
      * Accr Amount = order dtl extended amt - TF Accruals - Absorbed Frt
      * Rtv TF accrl total    RT - Shipping Dtl Accrual  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0112           Company Number
     C                     Z-ADDWAC4NB    WL0113           Order Number
     C                     Z-ADDWADPNB    WL0114           Order Sequence
     C                     Z-ADDWAUENB    WL0115           Order Secondary
     C                     Z-ADD1         WL0116           Sequence Number
     C                     Z-ADDWUMFQT    WL0117           Total Amount
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0117    WUMFQT           Total Amount
      * Calculate Absorbed Freight Amount
     C           P2TBNB    DIV  100       WUWB      H      *Synon (15,5) w
     C           WAATWG    MULT WUWB      WUULVA    H      Absorbed Freigh
      * Compute: Accr Amt f/Sales
      * WRK.Extended Amount =
      *    *COMPUTE ((x1-x2-x3)*x4)
      * x1    : PAR.Extended Amount
      * -     : PGM.*Synon (15,2) work field
      * x2    : WRK.Total Amount
      * -     : PGM.*Synon (15,2) work field
      * x3    : WRK.Absorbed Freight Amount
      * *     : PGM.*Synon (15,2) work field *
      * x4    : WRK.Accrual Rate
     C           WAAYVA    SUB  WUMFQT    W0WA02           *Synon (15,2) w
     C           W0WA02    SUB  WUULVA    W0WA01           *Synon (15,2) w
     C           W0WA01    MULT WUBKPR    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUAYVA           Extended Amount
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Accrual Rate Type is % of Gross Extended Amt
      *   |- c2    : PAR.Affect Sales Doll Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUSHSX    IFEQ 'G'                        *IF
     C           WAANST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Accrual = gross extended amt from Order dtl * accrual rate
     C           WUBKPR    MULT WAAYVA    WUAYVA           Extended Amount
      * E4057 JJH 06/04/15 - Correction for Flat Load Amount & Invoice
     C                     ELSE
      * CASE:
      *  - (c2 AND c3 AND c4) OR (c2 AND c5)
      *   |- c2    : WRK.Accrual Rate Type is Flat Load Amount
      *   |- c3    : PAR.Billing Activity Type is Credit Memo
      *   |- c4    : PAR.OD Full Return to Plant is Yes
      *   |- c5    : PAR.Billing Activity Type is Invoice
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUSHSX    IFEQ 'FL'                       *IF
     C           P2OBST    IFEQ '2'                        *IF
     C           WAH0ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WUSHSX    IFEQ 'FL'                       *IF
     C           P2OBST    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWUBKPR    WUAYVA           Extended Amount
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Change trans amount according to add-on/allowance flag
      * CASE:
      *  - c1AND(c2ORc3)
      *   |- c1    : PAR.Add-on/Allowance is Allowance
      *   |- c2    : PAR.Billing Activity Type is Invoice
      *   |- c3    : PAR.Billing Activity Type is Debit Memo
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0056    IFEQ 'S'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           P2OBST    IFEQ '1'                        *IF
     C           P2OBST    OREQ '3'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           0         SUB  WUAYVA    WUAYVA           Extended Amount
     C                     END                             *FI
      * Change trans amount according to Credit Memo
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Billing Activity Type is Credit Memo
      *   |- c2    : PAR.Add-on/Allowance is Add-on
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2OBST    IFEQ '2'                        *IF
     C           WN0056    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           0         SUB  WUAYVA    WUAYVA           Extended Amount
     C                     END                             *FI
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.Comm Min Amt /Period is Zero
      *   |- c2    : DB1.Comm Retroactive Sts is yes
      *   '-
     C           WLECVL    IFEQ 0                          *IF
     C           WLQESX    OREQ 'Y'                        *OR
     C                     Z-ADDWUAYVA    WN0070           Item Accrual Am
     C                     END                             *FI
      * Comm Threshhold is > 0 and Retro Sts is NO
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Comm Min Amt /Period is Greater than zero
      *   |- c2    : DB1.Comm Retroactive Sts is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WLECVL    IFGT 0                          *IF
     C           WLQESX    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DB1.Comm Threshold Period is Calendar Month
     C           WLQDSX    IFEQ 'CM'                       *IF
     C           WAGNDT    DIV  100       YL0030           Year Length USR
     C                     MOVEL*BLANK    YL0031           AS Date MM/DD
     C                     MOVELYL0030    YL0031           AS Date MM/DD
     C                     Z-ADD0         ZQ      50
     C           YL0031    CAT  '01':ZQ   YL0032    P      Date (Alpha) US
     C                     MOVE YL0032    YL0033           Period Beginnin
      * LCL.DD   numeric USR = PAR.Actual Shipped Date *MONTH LENGTH
     C           WAGNDT    ADD  1000000   XDINDT
     C                     Z-ADD0         XDINDD
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     ADD  1         XDINMM
     C                     EXSR XCVTA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
     C                     MOVE XDURR     YL0034
     C                     MOVELYL0034    YL0035           DD   alpha   US
     C                     Z-ADD0         ZQ      50
     C           YL0031    CAT  YL0035:ZQ YL0032    P      Date (Alpha) US
     C                     MOVE YL0032    YL0036           Period Ending D
     C                     ELSE
      * CASE: DB1.Comm Threshold Period is Accounting Period
     C           WLQDSX    IFEQ 'AP'                       *IF
      * RTV Year/Period/Week   XF - Calendar  * 
     C                     CALL 'PDT3XFR'              90  RTV Year/Period
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAIC3    WQ0029  30       Company Number
     C                     PARM WAGNDT    WQ0030  70       Post to G/L Dat
     C           YL0037    PARM *ZERO     WQ0031  40       Accounting Year
     C           YL0038    PARM *ZERO     WQ0032  20       Accounting Peri
     C           YL0039    PARM *ZERO     WQ0033  30       OM Week
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDT3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Period Start/End  RT - Calendar Summary  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0118           Company Number
     C                     Z-ADDYL0037    WL0119           Accounting Year
     C                     Z-ADDYL0038    WL0120           Accounting Peri
     C                     EXSR SVRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0121    YL0033           Period Beginnin
     C                     Z-ADDWL0122    YL0036           Period Ending D
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Tot Acc p/Per ALL RT - Shipping Dtl Accrual  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWLOJCD    WL0123    P      Accrual Code
     C                     Z-ADDWLBKC7    WL0124           Ship To Custome
     C                     Z-ADDYL0033    WL0125           SDA Actual Ship
     C                     Z-ADDYL0033    WL0126           Period Beginnin
     C                     Z-ADDYL0036    WL0127           Period Ending D
     C                     Z-ADDYL0041    WL0128           Item Accrual Am
     C                     Z-ADDWUJZWG    WL0129           Extended Amount
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0128    YL0041           Item Accrual Am
     C                     Z-ADDWL0129    WUJZWG           Extended Amount
     C           WUAYVA    ADD  YL0041    YL0042           USR amount 1  1
     C                     Z-ADDWUAYVA    WN0070           Item Accrual Am
      * CASE: LCL.USR amount 1  11.2 GT DB1.Comm Min Amt /Period
     C           YL0042    IFGT WLECVL                     *IF
     C           YL0042    SUB  WLECVL    WUAYVA           Extended Amount
      * CASE: WRK.Extended Amount GT PAR.Item Accrual Amt
     C           WUAYVA    IFGT WN0070                     *IF
     C                     Z-ADDWN0070    WUAYVA           Extended Amount
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD0         WUAYVA           Extended Amount
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DB1.Comm Retroactive Sts is yes
     C           WLQESX    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WN0071           Retro Comm Calc
     C                     END                             *FI
     C                     ADD  1         WN0001           Sequence Number
      * db1.accrual percent changed to wrk. context    10/13
      * db1.company changed to par. context    10/22/04
      * RMC DLY029 5/23/07 output new fields
      * E4057 JJH 05/13/15 - Do not create record if Extended Amt = 0
      * ** Don't create the record if the accrual amount = zeros  FP1314
      * CASE: WRK.Extended Amount is not equal to zeros
     C           WUAYVA    IFNE 0                          *IF
      * E4057 JJH 04/27/15 - Populate: SDA Atch to Ord ActShpDt
      * CRT OM Ship Dtl Accrul CR - Shipping Dtl Accrual  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDWAC4NB    WL0012           Order Number
     C                     Z-ADDWADPNB    WL0013           Order Sequence
     C                     Z-ADDWAUENB    WL0014           Order Secondary
     C                     Z-ADDWN0001    WL0015           Sequence Number
     C                     Z-ADDWUBKPR    WL0016           Accrual Rate
     C                     Z-ADDWUC5PC    WL0017           Accrual Percent
     C                     Z-ADDWUAYVA    WL0018           Extended Amount
     C                     Z-ADDWN0070    WL0019           Item Accrual Am
     C                     Z-ADDWAHGCD    WL0020           Item Code
     C                     Z-ADDWLBKC7    WL0021           Ship To Custome
     C                     Z-ADDP2ANC7    WL0022           A/R Customer
     C                     MOVELWLHHAA    WL0023    P      Broker Code
     C                     Z-ADDWAGNDT    WL0024           SDA Actual Ship
     C                     Z-ADDWAATWG    WL0025           Weight Billed
     C                     MOVEL'Y'       WL0026    P      Use G/L Code Dr
     C                     MOVELWN0071    WL0027    P      Retro Comm Calc
     C                     MOVELWN0057    WL0028    P      Accrual Type
     C                     MOVELWN0067    WL0029    P      SDA Affect Sale
     C                     MOVELWN0068    WL0030    P      SDA Affect Invo
     C                     MOVELWN0054    WL0031    P      SDA Print on In
     C                     MOVELWN0069    WL0032    P      SDA Invoice Pri
     C                     Z-ADDWN0076    WL0033           SDA Ord Dtl Acr
     C                     Z-ADDYL0002    WL0034           SDA Atch to Ord
     C                     Z-ADDWN0077    WL0035           SDA Unused Amt
     C                     Z-ADDWN0078    WL0036           SDA Unused Amt
     C                     MOVELWN0065    WL0037    P      SDA Post to G/L
     C                     MOVELWUSHSX    WL0038    P      SDA Accrual Rat
     C                     Z-ADDP2AWDT    WL0039           SDA Invoice Dat
     C                     MOVELWN0058    WL0040    P      SDA Sub Ledger
     C                     Z-ADDWN0079    WL0041           SDA G/L Sub Led
     C                     MOVELWN0080    WL0042    P      SDA G/L Code Dr
     C                     MOVELWN0081    WL0043    P      SDA G/L Code Cr
     C                     MOVELWN0082    WL0044    P      SDA JDE Account
     C                     MOVELWN0083    WL0045    P      SDA JDE Account
     C                     MOVELWLOJCD    WL0046    P      Accrual Code
     C                     MOVELWN0064    WL0047    P      SH Expense Buck
     C                     MOVELWN0084    WL0048    P      G/L Sub Account
     C                     MOVELWLUVST    WL0049    P      EDI Status 1
     C                     MOVELWLUWST    WL0050    P      EDI Status 2
     C                     MOVELWLUXST    WL0051    P      EDI Status 3
     C                     Z-ADDWLAATM    WL0052           Job Time
     C                     MOVELWLAYNA    WL0053    P      User Id
     C                     MOVELWLA0NA    WL0054    P      Job Name
     C                     Z-ADDWLAXDT    WL0055           Job Date
     C                     EXSR SLCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSM     READE@HOREKH                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV All Values Act NEW RT - Accrual Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * RMC DLY029 5/23/07 Db Change - this outputs the new fields
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WMOJCD           Accrual Code
      * Setup key
     C                     MOVELWL0056    WMOJCD           Accrual Code
      * Establish starting position
     C           KRSSN     CHAIN@HLREU8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1514' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0057           Accrual Descrip
     C                     MOVEL*BLANK    WL0058           Automatic Accru
     C                     MOVEL*BLANK    WL0059           Print On Invoic
     C                     MOVEL*BLANK    WL0060           Rate Usage
     C                     MOVEL*BLANK    WL0061           Add-on/Allowanc
     C                     MOVEL*BLANK    WL0062           Accrual Type
     C                     MOVEL*BLANK    WL0063           Sub Ledger Code
     C                     MOVEL*BLANK    WL0064           Reverse Accrual
     C                     MOVEL*BLANK    WL0065           U/M - Primary D
     C                     MOVEL*BLANK    WL0066           G/L Code Dr
     C                     MOVEL*BLANK    WL0067           G/L Code Cr
     C                     MOVEL*BLANK    WL0068           G/L Sub Account
     C                     MOVEL*BLANK    WL0069           Sales History E
     C                     MOVEL*BLANK    WL0070           Post to G/L (Y/
     C                     MOVEL*BLANK    WL0071           Accrual Rate Ty
     C                     MOVEL*BLANK    WL0072           Affect Sales Re
     C                     MOVEL*BLANK    WL0073           Affect Invoice
     C                     MOVEL*BLANK    WL0074           Invoice Print T
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWMLENA    WL0057           Accrual Descrip
     C                     MOVELWMTOST    WL0058           Automatic Accru
     C                     MOVELWMTQST    WL0059           Print On Invoic
     C                     MOVELWMTRST    WL0060           Rate Usage
     C                     MOVELWMTSST    WL0061           Add-on/Allowanc
     C                     MOVELWMOKCD    WL0062           Accrual Type
     C                     MOVELWMTYST    WL0063           Sub Ledger Code
     C                     MOVELWMOQCD    WL0064           Reverse Accrual
     C                     MOVELWMHHCD    WL0065           U/M - Primary D
     C                     MOVELWMI2TX    WL0066           G/L Code Dr
     C                     MOVELWMJFTX    WL0067           G/L Code Cr
     C                     MOVELWMI3TX    WL0068           G/L Sub Account
     C                     MOVELWMJGTX    WL0069           Sales History E
     C                     MOVELWMLEDG    WL0070           Post to G/L (Y/
     C                     MOVELWMSHSX    WL0071           Accrual Rate Ty
     C                     MOVELWMFETX    WL0072           Affect Sales Re
     C                     MOVELWMFFTX    WL0073           Affect Invoice
     C                     MOVELWMFGTX    WL0074           Invoice Print T
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv g/l Vendor        RT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WOBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0075    WOBKC7           Ship To Custome
      * Establish starting position
     C           KRSSO     CHAIN@NEREAT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0076           Customer G/L Ve
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWOAAC8    WL0076           Customer G/L Ve
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Broker Info       RT - Broker  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WRHHAA           Broker Code
      * Setup key
     C                     MOVELWL0077    WRHHAA           Broker Code
      * Establish starting position
     C           KRSSP     CHAIN@C5RESJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3288' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0078           Broker Name
     C                     MOVEL*BLANK    WL0079           Broker Address
     C                     MOVEL*BLANK    WL0080           Broker Address
     C                     MOVEL*BLANK    WL0081           Broker City
     C                     MOVEL*BLANK    WL0082           Broker State
     C                     MOVEL*BLANK    WL0083           Broker Zip
     C                     MOVEL*BLANK    WL0084           Broker Office M
     C                     MOVEL*BLANK    WL0085           Broker Telephon
     C                     MOVEL*BLANK    WL0086           Broker Fax Numb
     C                     MOVEL*BLANK    WL0087           Broker Email Ad
     C                     Z-ADD*ZERO     WL0088           Broker G/L Vend
     C                     MOVEL*BLANK    WL0089           Salesperson Cod
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWRC4T1    WL0078           Broker Name
     C                     MOVELWRQMNA    WL0079           Broker Address
     C                     MOVELWRQNNA    WL0080           Broker Address
     C                     MOVELWRQONA    WL0081           Broker City
     C                     MOVELWRQPNA    WL0082           Broker State
     C                     MOVELWRC5T1    WL0083           Broker Zip
     C                     MOVELWRC6T1    WL0084           Broker Office M
     C                     MOVELWRC7T1    WL0085           Broker Telephon
     C                     MOVELWRC8T1    WL0086           Broker Fax Numb
     C                     MOVELWRC9T1    WL0087           Broker Email Ad
     C                     Z-ADDWRDAT1    WL0088           Broker G/L Vend
     C                     MOVELWRBCCD    WL0089           Salesperson Cod
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Val Accrual Exists    RT - Shipping Dtl Accrual  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WL0093           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSAIC3    WQSQ01           Company Number
     C           *LIKE     DEFN WSC4NB    WQSQ02           Order Number
     C           *LIKE     DEFN WSOJCD    WQSQ03           Accrual Code
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Company Number
     C                     KFLD           WQSQ02           Order Number
     C                     KFLD           WQSQ03           Accrual Code
      * Setup key
     C                     Z-ADDWL0090    WQSQ01           Company Number
     C                     Z-ADDWL0091    WQSQ02           Order Number
     C                     MOVELWL0092    WQSQ03           Accrual Code
      * Establish starting position
     C           KRSSQ     SETLL@HRCPC9                    *
     C           KRSSQ     READE@HRCPC9                  90*
      * Data record not found
     C   90                MOVEL'USR1526' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WL0093           Record Found US
     C                     GOTO SQEXIT                     *QUIT
     C           KRSSQ     READE@HRCPC9                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Val Accrual Exists    RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WL0097           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTRMNB    WQSR01           Load ID
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           Load ID
      * Setup key
     C                     Z-ADDWL0094    WQSR01           Load ID
      * Establish starting position
     C           KRSSR     SETLL@BFCPR0                    *
     C           KRSSR     READE@BFCPR0                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Val Accrual Exists    RT - Shipping Dtl Accrual  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWTAIC3    WL0090           Company Number
     C                     Z-ADDWTC4NB    WL0091           Order Number
     C                     MOVELWL0095    WL0092    P      Accrual Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0093    YL0029    P      Record Found US
      * CASE: LCL.Record Found USR is Record Found
     C           YL0029    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WL0097           Record Found US
     C                     GOTO SREXIT                     *QUIT
     C                     END                             *FI
     C           KRSSR     READE@BFCPR0                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV & Chk Rate Exists  RT - Customer Accrual Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WVBKC7           Ship To Custome
     C                     KFLD           WVOJCD           Accrual Code
     C                     KFLD           WVGUNY           CAH Sequence No
     C                     KFLD           WVHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0098    WVBKC7           Ship To Custome
     C                     MOVELWL0099    WVOJCD           Accrual Code
     C                     Z-ADDWL0100    WVGUNY           CAH Sequence No
     C                     Z-ADDWL0101    WVHGCD           Item Code
      * Establish starting position
     C           KRSSS     CHAIN@HPRELD              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1522' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0102           Accrual Rate
     C                     MOVEL*BLANK    WL0103           Accrual Rate Ty
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     Z-ADDWVBKPR    WL0102           Accrual Rate
     C                     MOVELWVSHSX    WL0103           Accrual Rate Ty
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV & Chk Rate Exists RT - Customer Accrual Str  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WWBKC7           Ship To Custome
     C                     KFLD           WWOJCD           Accrual Code
     C                     KFLD           WWGUNY           CAH Sequence No
     C                     KFLD           WWRGNB           Item Structure
     C                     KFLD           WWRHNB           Item Structure
     C                     KFLD           WWRINB           Item Structure
      * Setup key
     C                     Z-ADDWL0104    WWBKC7           Ship To Custome
     C                     MOVELWL0105    WWOJCD           Accrual Code
     C                     Z-ADDWL0106    WWGUNY           CAH Sequence No
     C                     Z-ADDWL0107    WWRGNB           Item Structure
     C                     Z-ADDWL0108    WWRHNB           Item Structure
     C                     Z-ADDWL0109    WWRINB           Item Structure
      * Establish starting position
     C           KRSST     CHAIN@C8RES1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3294' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0110           Accrual Rate
     C                     MOVEL*BLANK    WL0111           Accrual Rate Ty
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWWBKPR    WL0110           Accrual Rate
     C                     MOVELWWSHSX    WL0111           Accrual Rate Ty
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv TF accrl total    RT - Shipping Dtl Accrual  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WL0117           Total Amount
      * Declare restrictor key work fields
     C           *LIKE     DEFN WXAIC3    WQSU01           Company Number
     C           *LIKE     DEFN WXC4NB    WQSU02           Order Number
     C           *LIKE     DEFN WXDPNB    WQSU03           Order Sequence
     C           *LIKE     DEFN WXUENB    WQSU04           Order Secondary
      * Define keylist
     C           KPSSU     KLIST
     C                     KFLD           WQSU01           Company Number
     C                     KFLD           WQSU02           Order Number
     C                     KFLD           WQSU03           Order Sequence
     C                     KFLD           WQSU04           Order Secondary
     C                     KFLD           WXDXNB           Sequence Number
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           Company Number
     C                     KFLD           WQSU02           Order Number
     C                     KFLD           WQSU03           Order Sequence
     C                     KFLD           WQSU04           Order Secondary
      * Setup key
     C                     Z-ADDWL0112    WQSU01           Company Number
     C                     Z-ADDWL0113    WQSU02           Order Number
     C                     Z-ADDWL0114    WQSU03           Order Sequence
     C                     Z-ADDWL0115    WQSU04           Order Secondary
     C                     Z-ADDWL0116    WXDXNB           Sequence Number
      * Establish starting position
     C           KPSSU     SETLL@HRCPLM                    *
     C           KRSSU     READE@HRCPLM                  90*
      * Data record not found
     C   90                MOVEL'USR1526' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * 11/13/03 Accum Trade Fund Accruals only ...   PK0519
      * 06/18/07 Chg CASE to select Affect Invoice price=Y    DLY029
      * CASE: DB1.SDA Affect Invoice Price is Yes
     C           WXP9SX    IFEQ 'Y'                        *IF
     C                     ADD  WXAYVA    WL0117           Total Amount
     C                     END                             *FI
     C           KRSSU     READE@HRCPLM                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Period Start/End  RT - Calendar Summary  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       YL0040           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WYAIC3    WQSV01           Company Number
     C           *LIKE     DEFN WYESNB    WQSV02           Accounting Year
     C           *LIKE     DEFN WYETNB    WQSV03           Accounting Peri
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           Company Number
     C                     KFLD           WQSV02           Accounting Year
     C                     KFLD           WQSV03           Accounting Peri
      * Setup key
     C                     Z-ADDWL0118    WQSV01           Company Number
     C                     Z-ADDWL0119    WQSV02           Accounting Year
     C                     Z-ADDWL0120    WQSV03           Accounting Peri
      * Establish starting position
     C           KRSSV     SETLL@ATRECF                    *
     C           KRSSV     READE@ATRECF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0060' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0121           Period Beginnin
     C                     Z-ADD*ZERO     WL0122           Period Ending D
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.First Time Flag is Yes
     C           YL0040    IFEQ 'Y'                        *IF
     C                     Z-ADDWYBFDT    WL0121           Period Beginnin
     C                     MOVEL'N'       YL0040           First Time Flag
     C                     END                             *FI
     C                     Z-ADDWYA2DT    WL0122           Period Ending D
     C           KRSSV     READE@ATRECF                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Tot Acc p/Per ALL RT - Shipping Dtl Accrual  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WL0128           Item Accrual Am
     C                     Z-ADD0         WL0129           Extended Amount
      * Declare restrictor key work fields
     C           *LIKE     DEFN TAOJCD    WQSW01           Accrual Code
     C           *LIKE     DEFN TABKC7    WQSW02           Ship To Custome
      * Define keylist
     C           KPSSW     KLIST
     C                     KFLD           WQSW01           Accrual Code
     C                     KFLD           WQSW02           Ship To Custome
     C                     KFLD           TAPODT           SDA Actual Ship
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           Accrual Code
     C                     KFLD           WQSW02           Ship To Custome
      * Setup key
     C                     MOVELWL0123    WQSW01           Accrual Code
     C                     Z-ADDWL0124    WQSW02           Ship To Custome
     C                     Z-ADDWL0125    TAPODT           SDA Actual Ship
      * Establish starting position
     C           KPSSW     SETLL@HRCPV5                    *
     C           KRSSW     READE@HRCPV5                  90*
      * Data record not found
     C   90                MOVEL'USR1526' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.SDA Actual Ship Date GE PAR.Period Beginning Dat
      *   |- c2    : DB1.SDA Actual Ship Date LE PAR.Period Ending Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           TAPODT    IFGE WL0126                     *IF
     C           TAPODT    IFLE WL0127                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  TAEDVL    WL0128           Item Accrual Am
     C                     ADD  TAAYVA    WL0129           Extended Amount
     C                     ELSE
      * CASE: *OTHERWISE
     C                     GOTO SWEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSW     READE@HRCPV5                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Write Accrual Rcd RT - Order Detail Accrual  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0085 30        Accrual Descrip
     C                     MOVEL*BLANK    WN0086  1        Automatic Accru
     C                     MOVEL*BLANK    WN0087  1        Print On Invoic
     C                     MOVEL*BLANK    WN0088  1        Rate Usage
     C                     MOVEL*BLANK    WN0089  1        Add-on/Allowanc
     C                     MOVEL*BLANK    WN0090  2        Accrual Type
     C                     MOVEL*BLANK    WN0091  2        Sub Ledger Code
     C                     MOVEL*BLANK    WN0092  3        Reverse Accrual
     C                     MOVEL*BLANK    WN0093  2        U/M - Primary D
     C                     MOVEL*BLANK    WN0094  8        G/L Code Dr
     C                     MOVEL*BLANK    WN0095  8        G/L Code Cr
     C                     MOVEL*BLANK    WN0096  8        G/L Sub Account
     C                     MOVEL*BLANK    WN0097  8        Sales History E
     C                     MOVEL*BLANK    WN0098  1        Post to G/L (Y/
     C                     MOVEL*BLANK    WN0099  2        Accrual Rate Ty
     C                     MOVEL*BLANK    WN0100  1        Affect Sales Re
     C                     MOVEL*BLANK    WN0101  1        Affect Invoice
     C                     MOVEL*BLANK    WN0102  2        Invoice Print T
     C                     Z-ADD*ZERO     WN0103 112       Item Accrual Am
     C                     MOVEL*BLANK    WN0104  6        Broker Code
     C                     MOVEL*BLANK    WN0105  1        Retro Comm Calc
     C                     MOVEL*BLANK    WN0106  1        SDA Affect Sale
     C                     MOVEL*BLANK    WN0107  1        SDA Affect Invo
     C                     MOVEL*BLANK    WN0108  1        SDA Print on In
     C                     MOVEL*BLANK    WN0109  2        SDA Invoice Pri
     C                     Z-ADD*ZERO     WN0110  70       SDA Ord Dtl Acr
     C                     Z-ADD*ZERO     WN0111 112       SDA Unused Amt
     C                     Z-ADD*ZERO     WN0112 112       SDA Unused Amt
     C                     Z-ADD*ZERO     WN0113  80       SDA G/L Sub Led
     C                     MOVEL*BLANK    WN0114  8        SDA G/L Code Dr
     C                     MOVEL*BLANK    WN0115  8        SDA G/L Code Cr
     C                     MOVEL*BLANK    WN0116  8        SDA JDE Account
     C                     MOVEL*BLANK    WN0117  8        SDA JDE Account
     C                     MOVEL*BLANK    WN0118  8        G/L Sub Account
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E1812 RMC 11/22/11 Added here: Accrual type -->  % of Gross Ext A
      *                    And  Accrual type -->  $ per Qty/1000      "QT
      * 06/26/14 PKD E3164 add omit criteria for Exclude Collect Truck/Ra
      * Declare restrictor key work fields
     C           *LIKE     DEFN TBAIC3    WQSX01           Company Number
     C           *LIKE     DEFN TBC4NB    WQSX02           Order Number
     C           *LIKE     DEFN TBDPNB    WQSX03           Order Sequence
     C           *LIKE     DEFN TBUENB    WQSX04           Order Secondary
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           Company Number
     C                     KFLD           WQSX02           Order Number
     C                     KFLD           WQSX03           Order Sequence
     C                     KFLD           WQSX04           Order Secondary
      * Setup key
     C                     Z-ADDWAAIC3    WQSX01           Company Number
     C                     Z-ADDWAC4NB    WQSX02           Order Number
     C                     Z-ADDWADPNB    WQSX03           Order Sequence
     C                     Z-ADDWAUENB    WQSX04           Order Secondary
      * Establish starting position
     C           KRSSX     SETLL@HQCPLJ                    *
     C           KRSSX     READE@HQCPLJ                  90*
      * Data record not found
     C   90                MOVEL'USR1524' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WN0105           Retro Comm Calc
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * E4057 JJH 05/13/15 - Reset Extended Amount to Zero
     C                     Z-ADD0         WUAYVA           Extended Amount
      * Rtv Accr Prog EXT     RT - Accrual Program EXT  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELTBOJCD    WL0001    P      Accrual Code
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YN0006    P      G/L Account Cat
     C                     MOVELWL0003    YL0043    P      APE Excl Collec
     C                     MOVELWL0004    YN0007    P      Record Status
      * OMIT:  Shipping Method = Collect Rail or Truck
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.APE Excl Collect ShpMthd is Yes
      *   |- c2    : PAR.Shipping Method is Collect
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0043    IFEQ 'Y'                        *IF
     C           YL0001    IFEQ 'CR'                       *IF
     C           YL0001    OREQ 'CT'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Process Accrual Program
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * RTV All Values Act NEW RT - Accrual Program  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELTBOJCD    WL0056    P      Accrual Code
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0057    WN0085    P      Accrual Descrip
     C                     MOVELWL0058    WN0086    P      Automatic Accru
     C                     MOVELWL0059    WN0087    P      Print On Invoic
     C                     MOVELWL0060    WN0088    P      Rate Usage
     C                     MOVELWL0061    WN0089    P      Add-on/Allowanc
     C                     MOVELWL0062    WN0090    P      Accrual Type
     C                     MOVELWL0063    WN0091    P      Sub Ledger Code
     C                     MOVELWL0064    WN0092    P      Reverse Accrual
     C                     MOVELWL0065    WN0093    P      U/M - Primary D
     C                     MOVELWL0066    WN0094    P      G/L Code Dr
     C                     MOVELWL0067    WN0095    P      G/L Code Cr
     C                     MOVELWL0068    WN0096    P      G/L Sub Account
     C                     MOVELWL0069    WN0097    P      Sales History E
     C                     MOVELWL0070    WN0098    P      Post to G/L (Y/
     C                     MOVELWL0071    WN0099    P      Accrual Rate Ty
     C                     MOVELWL0072    WN0100    P      Affect Sales Re
     C                     MOVELWL0073    WN0101    P      Affect Invoice
     C                     MOVELWL0074    WN0102    P      Invoice Print T
     C                     MOVELWN0094    WN0114           SDA G/L Code Dr
     C                     MOVELWN0095    WN0115           SDA G/L Code Cr
      * Val G/L Act Cde 2 HPE XF - STR Hog Prcr & Eval Sys  * G/L Code Dr
     C                     CALL 'PKVBXFR'              90  Val G/L Act Cde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0003    WQ0034  30       Company Number
     C                     PARM WN0094    WQ0035  8        G/L Account Cod
     C           WUIYTX    PARM *BLANK    WQ0036 25        G/L Code Desc U
     C           WN0116    PARM *BLANK    WQ0037  8        G/L Account Id
     C                     PARM *BLANK    WQ0038  3        G/L Account Typ
     C                     PARM *BLANK    WQ0039  3        G/L Account Typ
     C           YL0044    PARM *BLANK    WQ0040  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKVBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Val G/L Act Cde 2 HPE XF - STR Hog Prcr & Eval Sys  * G/L Code Cr
     C                     CALL 'PKVBXFR'              90  Val G/L Act Cde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0003    WQ0041  30       Company Number
     C                     PARM WN0095    WQ0042  8        G/L Account Cod
     C           WUIYTX    PARM *BLANK    WQ0043 25        G/L Code Desc U
     C           WN0117    PARM *BLANK    WQ0044  8        G/L Account Id
     C                     PARM *BLANK    WQ0045  3        G/L Account Typ
     C                     PARM *BLANK    WQ0046  3        G/L Account Typ
     C           YL0044    PARM *BLANK    WQ0047  1        Record Found US
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKVBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD*ZERO     WN0113           G/L Sub Ledger
      * G/L Sub Ledger DRV
      * A/R Customer
      * CASE: PAR.Sub Ledger Code is A/R Customer
     C           WN0091    IFEQ 'A'                        *IF
      * Rtv g/l Vendor        RT - Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP2ANC7    WL0075           Ship To Custome
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0076    WN0113           Customer G/L Ve
     C                     END                             *FI
      * Ship To Customer
      * CASE: PAR.Sub Ledger Code is Ship To Customer
     C           WN0091    IFEQ 'S'                        *IF
      * Rtv g/l Vendor        RT - Customer EXT  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWABKC7    WL0075           Ship To Custome
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0076    WN0113           Customer G/L Ve
     C                     END                             *FI
      * Broker
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Sub Ledger Code is Broker
      *   |- c2    : PAR.Sub Ledger Code is Buyer Group
      *   '-
     C           WN0091    IFEQ 'B'                        *IF
     C           WN0091    OREQ 'G'                        *OR
      * Rtv Broker Info       RT - Broker  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0045    WL0077    P      Broker Code
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0078    YL0018    P      Broker Name
     C                     MOVELWL0079    YL0019    P      Broker Address
     C                     MOVELWL0080    YL0020    P      Broker Address
     C                     MOVELWL0081    YL0021    P      Broker City
     C                     MOVELWL0082    YL0022    P      Broker State
     C                     MOVELWL0083    YL0023    P      Broker Zip
     C                     MOVELWL0084    YL0024    P      Broker Office M
     C                     MOVELWL0085    YL0025    P      Broker Telephon
     C                     MOVELWL0086    YL0026    P      Broker Fax Numb
     C                     MOVELWL0087    YL0027    P      Broker Email Ad
     C                     Z-ADDWL0088    WN0113           Broker G/L Vend
     C                     MOVELWL0089    YL0028    P      Salesperson Cod
     C                     END                             *FI
     C                     MOVEL*BLANK    WN0104           Broker Code
     C                     MOVELTBDSCD    WN0118           G/L Sub Account
     C                     Z-ADDTBDXNB    WN0110           SDA Ord Dtl Acr
     C                     MOVEL'N'       WUTXST           Error Status  3
      * E4057 JJH 04/29/15 - Rewrite Calc logic to utizile Affect Sales
      *  Pounds Status and Affect Sales Dollar Status
      * Calc Accrual
      * CASE: WRK.Error Status  3 is No
     C           WUTXST    IFEQ 'N'                        *IF
      * Calculate Extended Amount (which is the Accrual Amount)
      * Calc Accrual
      * CASE:
      *  - c1 AND c3
      *   |- c1    : DB1.Accrual Rate Type is $/Quantity
      *   |- c3    : PAR.Affect Sales Pnds Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           TBSHSX    IFEQ 'Q'                        *IF
     C           WAVAST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           TBBKPR    MULT WACBQT    WUAYVA           Extended Amount
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Accrual Rate Type is Flat Amount
      *   |- c2    : PAR.Affect Sales Doll Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           TBSHSX    IFEQ 'FA'                       *IF
     C           WAANST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDTBBKPR    WUAYVA           Extended Amount
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Accrual Rate Type is % of Gross Extended Amt
      *   |- c2    : PAR.Affect Sales Doll Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           TBSHSX    IFEQ 'G'                        *IF
     C           WAANST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Accrual = gross extended amt from Order dtl * accrual rate
      * WRK.Extended Amount
      * WRK.Extended Amount =
      *    *COMPUTE ((x1 * x2) / x3)
      * x1    : DB1.Accrual Rate
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Extended Amount
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           TBBKPR    MULT WAAYVA    W0WA01    H      *Synon (15,2) w
     C           W0WA01    DIV  100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUAYVA           Extended Amount
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Accrual Rate Type is $/Quantity/1000
      *   |- c2    : PAR.Affect Sales Pnds Status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           TBSHSX    IFEQ 'QT'                       *IF
     C           WAVAST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Compute: Amt/1000 qty
      * WRK.Extended Amount =
      *    *COMPUTE (x1 * x2 / x3)
      * x1    : DB1.Accrual Rate
      * *     : PGM.*Synon (17,7) work field *
      * x2    : PAR.Quantity Shipped Total
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.1000
     C           TBBKPR    MULT WACBQT    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  1000      W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUAYVA           Extended Amount
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Change trans amount according to add-on/allowance flag
      * CASE:
      *  - c1AND(c2ORc3)
      *   |- c1    : PAR.Add-on/Allowance is Allowance
      *   |- c2    : PAR.Billing Activity Type is Invoice
      *   |- c3    : PAR.Billing Activity Type is Debit Memo
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0089    IFEQ 'S'                        *IF
     C                     MOVEL'0'       Y0CX02  1
     C           P2OBST    IFEQ '1'                        *IF
     C           P2OBST    OREQ '3'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Do for debit memo too     RMC    4/14/10
     C           0         SUB  WUAYVA    WUAYVA           Extended Amount
     C                     END                             *FI
      * Change trans amount according to Credit Memo  - look at add/on 4/
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Billing Activity Type is Credit Memo
      *   |- c2    : PAR.Add-on/Allowance is Add-on
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2OBST    IFEQ '2'                        *IF
     C           WN0089    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Before  4/14 wasnt loking at add-on/allowance status -- So
      * if accrual is Add on, then subtract it for CR Memos (do the oppos
     C           0         SUB  WUAYVA    WUAYVA           Extended Amount
     C                     END                             *FI
     C                     Z-ADDWUAYVA    WN0103           Item Accrual Am
     C                     ADD  1         WN0001           Sequence Number
      * ** Don't create the record if the accrual amount = zeros
      * CASE: WRK.Extended Amount is not equal to zeros
     C           WUAYVA    IFNE 0                          *IF
      * E4057 JJH 04/27/15 - Populate: SDA Atch to Ord ActShpDt
      * CRT OM Ship Dtl Accrul CR - Shipping Dtl Accrual  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIC3    WL0011           Company Number
     C                     Z-ADDWAC4NB    WL0012           Order Number
     C                     Z-ADDWADPNB    WL0013           Order Sequence
     C                     Z-ADDWAUENB    WL0014           Order Secondary
     C                     Z-ADDWN0001    WL0015           Sequence Number
     C                     Z-ADDTBBKPR    WL0016           Accrual Rate
     C                     Z-ADDWUC5PC    WL0017           Accrual Percent
     C                     Z-ADDWUAYVA    WL0018           Extended Amount
     C                     Z-ADDWN0103    WL0019           Item Accrual Am
     C                     Z-ADDWAHGCD    WL0020           Item Code
     C                     Z-ADDWABKC7    WL0021           Ship To Custome
     C                     Z-ADDP2ANC7    WL0022           A/R Customer
     C                     MOVELWN0104    WL0023    P      Broker Code
     C                     Z-ADDWAGNDT    WL0024           SDA Actual Ship
     C                     Z-ADDWAATWG    WL0025           Weight Billed
     C                     MOVEL'Y'       WL0026    P      Use G/L Code Dr
     C                     MOVELWN0105    WL0027    P      Retro Comm Calc
     C                     MOVELWN0090    WL0028    P      Accrual Type
     C                     MOVELWN0100    WL0029    P      SDA Affect Sale
     C                     MOVELWN0101    WL0030    P      SDA Affect Invo
     C                     MOVELWN0087    WL0031    P      SDA Print on In
     C                     MOVELWN0102    WL0032    P      SDA Invoice Pri
     C                     Z-ADDWN0110    WL0033           SDA Ord Dtl Acr
     C                     Z-ADDYL0002    WL0034           SDA Atch to Ord
     C                     Z-ADDWN0111    WL0035           SDA Unused Amt
     C                     Z-ADDWN0112    WL0036           SDA Unused Amt
     C                     MOVELWN0098    WL0037    P      SDA Post to G/L
     C                     MOVELTBSHSX    WL0038    P      SDA Accrual Rat
     C                     Z-ADDP2AWDT    WL0039           SDA Invoice Dat
     C                     MOVELWN0091    WL0040    P      SDA Sub Ledger
     C                     Z-ADDWN0113    WL0041           SDA G/L Sub Led
     C                     MOVELWN0114    WL0042    P      SDA G/L Code Dr
     C                     MOVELWN0115    WL0043    P      SDA G/L Code Cr
     C                     MOVELWN0116    WL0044    P      SDA JDE Account
     C                     MOVELWN0117    WL0045    P      SDA JDE Account
     C                     MOVELTBOJCD    WL0046    P      Accrual Code
     C                     MOVELWN0097    WL0047    P      SH Expense Buck
     C                     MOVELWN0118    WL0048    P      G/L Sub Account
     C                     MOVELWUGSTX    WL0049    P      EDI Status 1
     C                     MOVELWUGSTX    WL0050    P      EDI Status 2
     C                     MOVELWUGSTX    WL0051    P      EDI Status 3
     C                     Z-ADD##JTM     WL0052           Job Time
     C                     MOVEL##USR     WL0053    P      User Id
     C                     MOVEL##JOB     WL0054    P      Job Name
     C                     Z-ADD##JDT     WL0055           Job Date
     C                     EXSR SLCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSX     READE@HQCPLJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * W 69422 9/24/2020 RMC added FL rate type calc under Commission/al
      * EXPCOM 11/10/04 RMC -- new to use in the accrual by range calcs
      * DLY029 05/23/07 RMC -- DB Changes,new rate type "SS" for SEIDAI b
      * DLY029 08/08/07 RMC -- New rate type "G " for % of gross ext amt
      *       will be used for sales tax calc
      * DLY029 08/09/07 RMC -- All accr types can have rate types & dtl n
      *   so do same calcs as CM-commission
      * 05/27/09 LJB E00422 -- Accrual prod pgm can be by customer, if
      *   All Customers = No, see if a customer exists and is Active, els
      * 11/11/09 LJB E00513 -- Condition the write of the commission reco
      *   to Shipping Dtl Accrual from Customer Accrual on the Affect
      *   Commission flag. If No, skip.
      * 03/23/10 PKD E0648 - for db/cr, add accrual processing
      * 04/14/10 RMC C0699 - for db/cm look at add-on allow for accruals
      *    when deciding when to reverse the sign on the accr amt
      * 11/22/11 RMC E1812 - Order Dtl level: added rate types "G " and "
      *   HPB (but anyone can use)  G= % of gross extended : "QT"= $/Qty/
      * E4057 JJH 04/23/15 - Price Credit Memo Fixes
      * - Add I Parm for Attach to Order Number
      * - Rtv Actual Ship Date of Attach to Order Number for Credit
      *   and Debit Memos
      * - Pass in OD Full Return to Plant from Order Detail.  This will
      *   be used to update accurals for selected Flat Amount calculation
      * - Comment out logic for Accrual Rate Type that have never been us
      *   Product  (W ) $/Quantity
      *   Product   (FA) Flat Amount
      *   Customer  (WR) $/LB by Weight Billed
      *   Customer  (QR) $/Quantity by Qty Shipped
      *   Customer  (SR) % ofNetSls by NetSls/Lb
      *   Customer  (SS) % ofNetSls by NetSls/Month
      *   Customer  (FA) Flat Amount
      *   Order Dtl (W ) $/Lb
      *   Order Dtl (WR) $/Lb Weight Billed
      *   Order Dtl (QR) $/Quantity by Qty Shipped
      * - All logic for By Range LST for Accrual Rate Type commented out
      *   because By Range is no longer required.
      * - Remove logic for Invoices only on Customer Accural.  Customer
      *   will now process Invoices, Credit Memos, and Debit Memos.
      * - Correction to allow Flat Load Amount and Invoice to process.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * ***** MAINTENANCE LOG
      *================================================================
      * * 12/02/03 PKD Only calculate accrual if Quantity or Weight is
      * *              not zero.
      * E4057 JJH 04/27/15 - See comments in 3 Maintenance Logs below
      * - RTV Write Accrual Rcd RT - Accrual Program  *
      * - RTV Write Accrual Rcd RT - Customer Accrual  *
      * - RTV Write Accrual Rcd RT - Order Detail Accrual  *
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * ***** MAINTENANCE LOG: Product Program
      *================================================================
      * * 07/16/08 PKD E00193 Product Accrual
      * * 12/03/09 PKD FP1322 Added Flat Amount Accrual Rate Type
      * * 3/23/10 PKD E00648 upd accruals for db/cm
      * * 4/14/10 RMC E00648 for db/cm look at addon allow flag
      * *12/15/10 PKD TFS: C1208 If product is not applicable, then do
      *               do not check if Ship To is applicable for the pgm.
      * 06/26/14 PKD E3164 Send in Shipping Method as a parameter
      * E4057 JJH 04/24/14 - Price Credit Memo Fixes
      * - Add I parm for: SDA Atch to Ord ActShpDt
      * - Add I parm for: Affect Sales Doll Status
      * - Add I parm for: Affect Sales Pnds Status
      * - Comment out logic for Affect Trade Fund & Affect Commission
      * - Pass in OD Full Retturn to Plant from Order Detail.  This will
      *   be used to update accurals for selected Flat Amount calculation
      * - Comment out logic for Accrual Rate Type that have never been us
      *   Product  (W ) $/Quantity
      *   Product   (FA) Flat Amount
      * - Use Actual Ship Date from Original Order when determining if
      *   the Accrual should be applied based on the Accrual Date Range
      * - Reset the WRK.Extended Amount to zero for each record
      * - Only create Shipping Detail Accrual records if the Extended
      *   Amount is GT Zero.
      * - Comment Out Accrual Rate Type processing that has never been
      *   used.
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * *------------ MAINTENANCE LOG ------------*
      *================================================================
      * 07/16/08 PKD E00193 Product Accrual
      * 06/26/14 PKD E3164 add omit criteria for Exclude Collect Truck/Ra
      * E4057 JJH 04/29/15 - Price Credit Memo Fixes
      * - Use Actual Ship Date from Original Order when determining if
      *   the Accrual should be applied based on the Accrual Date Range
      * - Reset the WRK.Extended Amount to zero for each record
      * - Only create Shipping Detail Accrual records if the Extended
      *   Amount is GT Zero.
      * - Comment Out Accrual Rate Type processing that has never been
      *   used.
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * *------------ MAINTENANCE LOG ------------*
      *================================================================
      * 05/27/09 LJB E00422 Accrual Prod Pgm Cust -
      *   If All Customers = No, see if a customer exists and is active
      * 07/16/08 PKD E00193 Product Accrual
      * E4057 JJH 04/24/14 - Price Credit Memo Fixes
      * - Use Actual Ship Date from Original Order when determining if
      *   the Accrual should be applied based on the Accrual Date Range
      * - Reset the WRK.Extended Amount to zero for each record
      * - Only create Shipping Detail Accrual records if the Extended
      *   Amount is GT Zero.
      * - Comment Out Accrual Rate Type processing that has never been
      *   used.
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * ***** MAINTENANCE LOG: Customer Accrual
      *================================================================
      * *---------------------------------------------------------------*
      * * 09/28/00 PKD Added Ship To Customer as a Restrictor Parm.
      * *              Added Scheduled Ship Date as an Input Parm.
      * * 11/10/04 RMC Added par.quantity & weight & extended amt & abs f
      * * 11/10/04 RMC Create Trade Fund Accruals before commission
      * * 08/15/05 RMC Rtv Broker from Cust Ext instead of Order, it may
      * * 05/23/07 RMC DLY029 use broker from customer accrual file
      * * 06/18/07 RMC DLY029 DO COMMISSION ACCRUAL LAST -- ALL OTHERS FI
      * *   so read Cust Accrual in Ship to /Comm sts seq
      * *   Comm Sts = 1 if not commission, and =9 if it is commission
      * * 11/11/09 LJB E00513 Condition commission on Affect Commision fl
      * *   if NO then skip (don't write Shipping Dtl Accrual rec)
      * * 12/03/09 PKD FP1322 Added Flat Amount Accrual Rate Type
      * * 3/23/10 PKD E00648 upd accruals for db/cm
      * * 4/14/10 RMC E00648 for db/cm look at addon allow flag
      * 06/26/14 PKD E3164 Send in Shipping Method as a parameter
      * E4057 JJH 04/24/14
      * - Add I parm for: SDA Atch to Ord ActShpDt
      * - Add I parm for: Affect Sales Doll Status
      * - Add I parm for: Affect Sales Pnds Status
      * - Comment out logic for Affect Trade Fund & Affect Commission
      * - Pass in OD Full Return to Plant from Order Detail.  This will
      *   be used to update accurals for selected Flat Amount calculation
      * - Comment out logic for Accrual Rate Type that have never been us
      *   Customer  (WR) $/LB by Weight Billed
      *   Customer  (QR) $/Quantity by Qty Shipped
      *   Customer  (SR) % ofNetSls by NetSls/Lb
      *   Customer  (SS) % ofNetSls by NetSls/Month
      *   Customer  (FA) Flat Amount
      * - Remove logic for Invoices only on Customer Accural.  Customer
      *   will now process Invoices, Credit Memos, and Debit Memos.
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * ***** MAINTENANCE LOG: Order Detail Accrual
      *================================================================
      * *---------------------------------------------------------------*
      * * 10/20/09 PKD Add accrual by Order Detail.
      * * 12/03/09 PKD FP1322 Added Flat Amount Accrual Rate Type
      * * 3/23/10 PKD E00648 upd accruals for db/cm
      * * 4/14/10 RMC E00648 for db/cm look at addon allow flag
      * * 11/22/11 RMC E1812 Added Rate type "G" % of gross extended and
      * *                    Added Rate type "QT" $ per qty/ 1000
      * 06/26/14 PKD E3164 Send in Shipping Method as a parameter
      * E4057 JJH 04/24/14
      * - Add I parm for: SDA Atch to Ord ActShpDt
      * - Add I parm for: Affect Sales Doll Status
      * - Add I parm for: Affect Sales Pnds Status
      * - Comment out logic for Affect Trade Fund & Affect Commission
      * - Pass in OD Full Retturn to Plant from Order Detail.  This will
      *   be used to update accurals for selected Flat Amount calculation
      * - Comment out logic for Accrual Rate Type that have never been us
      *   Order Dtl (W ) $/Lb
      *   Order Dtl (WR) $/Lb Weight Billed
      *   Order Dtl (QR) $/Quantity by Qty Shipped
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDUDY     BEGSR
      *================================================================
      * Calculate duration, *DAYS
      *================================================================
     C           XDAY1     IFLT 1
     C           XDAY2     ORLT 1
     C                     Z-ADD0         XDURR
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     GOTO XDUDYE
     C                     END
     C           XDAY1     IFGE XDAY2
      * From date2 to date1
     C                     Z-ADDXDAY2     XABEG   60
     C                     Z-ADDXDAY1     XAEND   60
     C                     ELSE
      * From date1 to date2
     C                     Z-ADDXDAY1     XABEG   60
     C                     Z-ADDXDAY2     XAEND   60
     C                     END
     C           XDWSL     IFEQ 0
      * None days of week selected
     C                     Z-ADD0         XDURR
     C                     GOTO XDUDYC
     C                     END
     C           XAEND     SUB  XABEG     XDURR   80
     C           XDWSL     IFEQ 7
      * All days of week selected
     C                     GOTO XDUDYC
     C                     END
      * Some days of week selected
     C                     DIV  7         XDURR
     C                     MVR            XDLSW   10
     C                     MULT XDWSL     XDURR
     C           XDLSW     IFNE 0
      * Determine day of week of the beginning date
     C           XABEG     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
      * Loop: Increment the date by the last week
     C           XDLSW     DOWGT0
      * Increment the day of week
     C                     ADD  1         YY
     C                     SUB  1         XDLSW
      * Put day of week into the range 1-7
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     END
      * Selected day of the last week has been processed
     C           YDOW,YY   IFEQ XDSEL
      * Increment duration
     C                     ADD  1         XDURR
     C                     END
      * End of loop
     C                     END
     C                     END
     C           XDUDYC    TAG
     C           XDURR     IFEQ 0
      * Return Code: Unable to calculate duration
     C                     MOVEL'Y2U0060' W0RTN   7
     C                     ELSE
     C                     MOVEL*BLANK    W0RTN   7
     C                     END
      *================================================================
     CSR         XDUDYE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P3EJVL           Extended Amt To
     C                     Z-ADD*ZERO     P4ETWG           Weight Total 13
     C                     Z-ADD*ZERO     P5BKQT           Quantity Total
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WACFC7           Order Group Cod
     C                     Z-ADD*ZERO     WAMAVA           Billing Detail
     C                     Z-ADD*ZERO     WAKDVA           Billing Detail
     C                     Z-ADD*ZERO     WAL8VA           Billing Detail
     C                     Z-ADD*ZERO     WAL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WAEXDT           Market Pricing
     C                     Z-ADD*ZERO     WABZPR           Price Overage O
     C                     Z-ADD*ZERO     WAL6NB           Contract Number
     C                     Z-ADD*ZERO     WAGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WAAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WAD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WACCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WAAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WACBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WAATWG           Weight Shipped
     C                     Z-ADD*ZERO     WAAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WAAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WAAKPR           Unit Price
     C                     Z-ADD*ZERO     WAALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WAAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WAAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WAA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WAA5DT           Requested Ship
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WAGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WACXDT           Date of Origina
     C                     Z-ADD*ZERO     WADUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WAB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WAA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WANTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WANUDT           Consumed Item C
     C                     Z-ADD*ZERO     WANVDT           Deadline Depart
     C                     Z-ADD*ZERO     WANWDT           OD Price Type R
     C                     Z-ADD*ZERO     WANXDT           OD Firm Date
     C                     Z-ADD*ZERO     WABUTM           Deadline Depart
     C                     Z-ADD*ZERO     WABVTM           Price Code
     C                     Z-ADD*ZERO     WABWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WABXTM           Substitution Li
     C                     Z-ADD*ZERO     WABYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WAH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WAH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WAH7NX           OD Item Target
     C                     Z-ADD*ZERO     WAH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WAH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WADVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WADWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WADXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WADYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WADZPR           OD Original Ord
     C                     Z-ADD*ZERO     WAGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WAGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WAGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WAPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WARINY           Item Age Days
     C                     Z-ADD*ZERO     WATIDT           Production Ovr
     C                     Z-ADD*ZERO     WATJDT           Production Ovr
     C                     Z-ADD*ZERO     WATKDT           OD Market Begin
     C                     Z-ADD*ZERO     WATLDT           OD Market Endin
     C                     Z-ADD*ZERO     WATMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A/R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WBNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WBNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WBNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WBNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WBBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WBBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WCBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WCBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WCBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WCBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WDHQVL           Max Accrual Amo
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Extended Amount
     C                     Z-ADD*ZERO     WUAYVA 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEMJDT           Create Date
     C                     Z-ADD*ZERO     WEBETM           Create Time
     C                     Z-ADD*ZERO     WEMKDT           Change Date
     C                     Z-ADD*ZERO     WEBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFMSNY           AD Program Numb
     C                     Z-ADD*ZERO     WFSCDT           AD Period Begin
     C                     Z-ADD*ZERO     WFSDDT           AD Period Endin
     C                     Z-ADD*ZERO     WFO9TX           AD Sub Ledger
     C                     Z-ADD*ZERO     WFMJDT           Create Date
     C                     Z-ADD*ZERO     WFBETM           Create Time
     C                     Z-ADD*ZERO     WFMKDT           Change Date
     C                     Z-ADD*ZERO     WFBFTM           Change Time
      * Define work field G/L Code Desc USR
     C                     MOVEL*BLANK    WUIYTX 25
      * Define work field Status - Y or N
     C                     MOVEL*BLANK    WUB8ST  1
      * Define work field Accrual Rate Type
     C                     MOVEL*BLANK    WUSHSX  2
      * Define work field Accrual Rate
     C                     Z-ADD*ZERO     WUBKPR  96
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGMSNY           AD Program Numb
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WGMJDT           Create Date
     C                     Z-ADD*ZERO     WGBETM           Create Time
     C                     Z-ADD*ZERO     WGMKDT           Change Date
     C                     Z-ADD*ZERO     WGBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHMSNY           AD Program Numb
     C                     Z-ADD*ZERO     WHBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WHMJDT           Create Date
     C                     Z-ADD*ZERO     WHBETM           Create Time
     C                     Z-ADD*ZERO     WHMKDT           Change Date
     C                     Z-ADD*ZERO     WHBFTM           Change Time
      * Define work field Error Status  2
     C                     MOVEL*BLANK    WUTUST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WIC4NB           Order Number
     C                     Z-ADD*ZERO     WIDPNB           Order Sequence
     C                     Z-ADD*ZERO     WIUENB           Order Secondary
     C                     Z-ADD*ZERO     WIDXNB           Sequence Number
     C                     Z-ADD*ZERO     WIBSVA           Transaction Amo
     C                     Z-ADD*ZERO     WISANB           Special Charge
     C                     Z-ADD*ZERO     WICKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Define work field Reverse Accrual Code
     C                     MOVEL*BLANK    WUOQCD  3
      * Define work field Error Status  3
     C                     MOVEL*BLANK    WUTXST  1
      * Define work field Accrual Percent
     C                     Z-ADD*ZERO     WUC5PC  52
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKC4NB           Order Number
     C                     Z-ADD*ZERO     WKDPNB           Order Sequence
     C                     Z-ADD*ZERO     WKUENB           Order Secondary
     C                     Z-ADD*ZERO     WKDXNB           Sequence Number
     C                     Z-ADD*ZERO     WKBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WKC5PC           Accrual Percent
     C                     Z-ADD*ZERO     WKAYVA           Extended Amount
     C                     Z-ADD*ZERO     WKEDVL           Item Accrual Am
     C                     Z-ADD*ZERO     WKHGCD           Item Code
     C                     Z-ADD*ZERO     WKBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WKDUC7           A/R Customer
     C                     Z-ADD*ZERO     WKPODT           SDA Actual Ship
     C                     Z-ADD*ZERO     WKBYWG           Weight Billed
     C                     Z-ADD*ZERO     WKPPDT           SDA Ord Dtl Acr
     C                     Z-ADD*ZERO     WKPQDT           SDA Atch to Ord
     C                     Z-ADD*ZERO     WKEEVL           SDA Unused Amt
     C                     Z-ADD*ZERO     WKEFVL           SDA Unused Amt
     C                     Z-ADD*ZERO     WKQ8DT           SDA Invoice Dat
     C                     Z-ADD*ZERO     WKH0NY           SDA G/L Sub Led
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WLGUNY           CAH Sequence No
     C                     Z-ADD*ZERO     WLBFDT           Period Beginnin
     C                     Z-ADD*ZERO     WLA2DT           Period Ending D
     C                     Z-ADD*ZERO     WLBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WLPJDT           CAH Unused Date
     C                     Z-ADD*ZERO     WLPKDT           CAH Unused Date
     C                     Z-ADD*ZERO     WLECVL           Comm Min Amt /P
     C                     Z-ADD*ZERO     WLHQVL           Max Accrual Amo
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WOAAC8           Customer G/L Ve
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRDAT1           Broker G/L Vend
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WVBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WVGUNY           CAH Sequence No
     C                     Z-ADD*ZERO     WVHGCD           Item Code
     C                     Z-ADD*ZERO     WVBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WVAATM           Job Time
     C                     Z-ADD*ZERO     WVAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WWBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WWGUNY           CAH Sequence No
     C                     Z-ADD*ZERO     WWRGNB           Item Structure
     C                     Z-ADD*ZERO     WWRHNB           Item Structure
     C                     Z-ADD*ZERO     WWRINB           Item Structure
     C                     Z-ADD*ZERO     WWBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WWFKPR           CAS Rate Unused
     C                     Z-ADD*ZERO     WWFLPR           CAS Rate Unused
     C                     Z-ADD*ZERO     WWAATM           Job Time
     C                     Z-ADD*ZERO     WWAXDT           Job Date
      * Define work field Total Amount
     C                     Z-ADD*ZERO     WUMFQT 112
      * Define work field *Synon (15,5) work field
     C                     Z-ADD*ZERO     WUWB   155
      * Define work field Absorbed Freight Amount
     C                     Z-ADD*ZERO     WUULVA 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WYAIC3           Company Number
     C                     Z-ADD*ZERO     WYESNB           Accounting Year
     C                     Z-ADD*ZERO     WYETNB           Accounting Peri
     C                     Z-ADD*ZERO     WYBZNB           OM Week
     C                     Z-ADD*ZERO     WYBFDT           Period Beginnin
     C                     Z-ADD*ZERO     WYA2DT           Period Ending D
     C                     Z-ADD*ZERO     WYAATM           Job Time
     C                     Z-ADD*ZERO     WYAXDT           Job Date
      * Define work field Not Used Wgt
     C                     Z-ADD*ZERO     WUJZWG 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TBAIC3           Company Number
     C                     Z-ADD*ZERO     TBC4NB           Order Number
     C                     Z-ADD*ZERO     TBDPNB           Order Sequence
     C                     Z-ADD*ZERO     TBUENB           Order Secondary
     C                     Z-ADD*ZERO     TBDXNB           Sequence Number
     C                     Z-ADD*ZERO     TBBKPR           Accrual Rate
     C                     Z-ADD*ZERO     TBMJDT           Create Date
     C                     Z-ADD*ZERO     TBBETM           Create Time
     C                     Z-ADD*ZERO     TBMKDT           Change Date
     C                     Z-ADD*ZERO     TBBFTM           Change Time
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WA02 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SFRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002  3
     C                     MOVEL*BLANK    WL0003  1
     C                     MOVEL*BLANK    WL0004  1
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0005  30
     C                     Z-ADD*ZERO     WL0006  70
     C                     Z-ADD*ZERO     WL0007  30
     C                     Z-ADD*ZERO     WL0008  30
     C                     MOVEL*BLANK    WL0009  3
     C                     MOVEL*BLANK    WL0010  1
      * Define local variables for subroutine SLCRRC.
     C                     Z-ADD*ZERO     WL0011  30
     C                     Z-ADD*ZERO     WL0012  70
     C                     Z-ADD*ZERO     WL0013  30
     C                     Z-ADD*ZERO     WL0014  30
     C                     Z-ADD*ZERO     WL0015  30
     C                     Z-ADD*ZERO     WL0016  96
     C                     Z-ADD*ZERO     WL0017  52
     C                     Z-ADD*ZERO     WL0018 112
     C                     Z-ADD*ZERO     WL0019 112
     C                     Z-ADD*ZERO     WL0020  70
     C                     Z-ADD*ZERO     WL0021  70
     C                     Z-ADD*ZERO     WL0022  70
     C                     MOVEL*BLANK    WL0023  6
     C                     Z-ADD*ZERO     WL0024  70
     C                     Z-ADD*ZERO     WL0025 112
     C                     MOVEL*BLANK    WL0026  1
     C                     MOVEL*BLANK    WL0027  1
     C                     MOVEL*BLANK    WL0028  2
     C                     MOVEL*BLANK    WL0029  1
     C                     MOVEL*BLANK    WL0030  1
     C                     MOVEL*BLANK    WL0031  1
     C                     MOVEL*BLANK    WL0032  2
     C                     Z-ADD*ZERO     WL0033  70
     C                     Z-ADD*ZERO     WL0034  70
     C                     Z-ADD*ZERO     WL0035 112
     C                     Z-ADD*ZERO     WL0036 112
     C                     MOVEL*BLANK    WL0037  1
     C                     MOVEL*BLANK    WL0038  2
     C                     Z-ADD*ZERO     WL0039  70
     C                     MOVEL*BLANK    WL0040  2
     C                     Z-ADD*ZERO     WL0041  80
     C                     MOVEL*BLANK    WL0042  8
     C                     MOVEL*BLANK    WL0043  8
     C                     MOVEL*BLANK    WL0044  8
     C                     MOVEL*BLANK    WL0045  8
     C                     MOVEL*BLANK    WL0046  3
     C                     MOVEL*BLANK    WL0047  6
     C                     MOVEL*BLANK    WL0048  8
     C                     MOVEL*BLANK    WL0049  1
     C                     MOVEL*BLANK    WL0050  1
     C                     MOVEL*BLANK    WL0051  1
     C                     Z-ADD*ZERO     WL0052  60
     C                     MOVEL*BLANK    WL0053 10
     C                     MOVEL*BLANK    WL0054 10
     C                     Z-ADD*ZERO     WL0055  70
      * Define local variables for subroutine SNRVGN.
     C                     MOVEL*BLANK    WL0056  3
     C                     MOVEL*BLANK    WL0057 30
     C                     MOVEL*BLANK    WL0058  1
     C                     MOVEL*BLANK    WL0059  1
     C                     MOVEL*BLANK    WL0060  1
     C                     MOVEL*BLANK    WL0061  1
     C                     MOVEL*BLANK    WL0062  2
     C                     MOVEL*BLANK    WL0063  2
     C                     MOVEL*BLANK    WL0064  3
     C                     MOVEL*BLANK    WL0065  2
     C                     MOVEL*BLANK    WL0066  8
     C                     MOVEL*BLANK    WL0067  8
     C                     MOVEL*BLANK    WL0068  8
     C                     MOVEL*BLANK    WL0069  8
     C                     MOVEL*BLANK    WL0070  1
     C                     MOVEL*BLANK    WL0071  2
     C                     MOVEL*BLANK    WL0072  1
     C                     MOVEL*BLANK    WL0073  1
     C                     MOVEL*BLANK    WL0074  2
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0075  70
     C                     Z-ADD*ZERO     WL0076  80
      * Define local variables for subroutine SPRVGN.
     C                     MOVEL*BLANK    WL0077  6
     C                     MOVEL*BLANK    WL0078 30
     C                     MOVEL*BLANK    WL0079 30
     C                     MOVEL*BLANK    WL0080 30
     C                     MOVEL*BLANK    WL0081 20
     C                     MOVEL*BLANK    WL0082  2
     C                     MOVEL*BLANK    WL0083 11
     C                     MOVEL*BLANK    WL0084 30
     C                     MOVEL*BLANK    WL0085 25
     C                     MOVEL*BLANK    WL0086 25
     C                     MOVEL*BLANK    WL0087 50
     C                     Z-ADD*ZERO     WL0088  80
     C                     MOVEL*BLANK    WL0089  3
      * Define local variables for subroutine SQRVGN.
     C                     Z-ADD*ZERO     WL0090  30
     C                     Z-ADD*ZERO     WL0091  70
     C                     MOVEL*BLANK    WL0092  3
     C                     MOVEL*BLANK    WL0093  1
      * Define local variables for subroutine SRRVGN.
     C                     Z-ADD*ZERO     WL0094  70
     C                     MOVEL*BLANK    WL0095  3
     C                     MOVEL*BLANK    WL0096  2
     C                     MOVEL*BLANK    WL0097  1
      * Define local variables for subroutine SSRVGN.
     C                     Z-ADD*ZERO     WL0098  70
     C                     MOVEL*BLANK    WL0099  3
     C                     Z-ADD*ZERO     WL0100  50
     C                     Z-ADD*ZERO     WL0101  70
     C                     Z-ADD*ZERO     WL0102  96
     C                     MOVEL*BLANK    WL0103  2
      * Define local variables for subroutine STRVGN.
     C                     Z-ADD*ZERO     WL0104  70
     C                     MOVEL*BLANK    WL0105  3
     C                     Z-ADD*ZERO     WL0106  50
     C                     Z-ADD*ZERO     WL0107  30
     C                     Z-ADD*ZERO     WL0108  30
     C                     Z-ADD*ZERO     WL0109  30
     C                     Z-ADD*ZERO     WL0110  96
     C                     MOVEL*BLANK    WL0111  2
      * Define local variables for subroutine SURVGN.
     C                     Z-ADD*ZERO     WL0112  30
     C                     Z-ADD*ZERO     WL0113  70
     C                     Z-ADD*ZERO     WL0114  30
     C                     Z-ADD*ZERO     WL0115  30
     C                     Z-ADD*ZERO     WL0116  30
     C                     Z-ADD*ZERO     WL0117 112
      * Define local variables for subroutine SVRVGN.
     C                     Z-ADD*ZERO     WL0118  30
     C                     Z-ADD*ZERO     WL0119  40
     C                     Z-ADD*ZERO     WL0120  20
     C                     Z-ADD*ZERO     WL0121  70
     C                     Z-ADD*ZERO     WL0122  70
      * Define local variables for subroutine SWRVGN.
     C                     MOVEL*BLANK    WL0123  3
     C                     Z-ADD*ZERO     WL0124  70
     C                     Z-ADD*ZERO     WL0125  70
     C                     Z-ADD*ZERO     WL0126  70
     C                     Z-ADD*ZERO     WL0127  70
     C                     Z-ADD*ZERO     WL0128 112
     C                     Z-ADD*ZERO     WL0129 112
      * Define local work field Shipping Method
     C                     MOVEL*BLANK    YL0001  2
      * Define local work field SDA Atch to Ord ActShpDt
     C                     Z-ADD*ZERO     YL0002  70
      * Define null work field Shipping Company
     C                     Z-ADD*ZERO     YN0001  30
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0003  30
      * Define null work field G/L Account Category
     C                     MOVEL*BLANK    YN0002  3
      * Define local work field APE Excl Collect ShpMthd
     C                     MOVEL*BLANK    YL0004  1
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0003  1
      * Define local work field Actual Shipped Date
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Broker Code
     C                     MOVEL*BLANK    YL0007  6
      * Define local work field EDI Status 1
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field EDI Status 2
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field EDI Status 3
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field Job Time
     C                     Z-ADD*ZERO     YL0011  60
      * Define local work field User Id
     C                     MOVEL*BLANK    YL0012 10
      * Define local work field Job Name
     C                     MOVEL*BLANK    YL0013 10
      * Define local work field Job Date
     C                     Z-ADD*ZERO     YL0014  70
      * Define null work field G/L Account Category
     C                     MOVEL*BLANK    YN0004  3
      * Define local work field APE Excl Collect ShpMthd
     C                     MOVEL*BLANK    YL0015  1
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0005  1
      * Define local work field Actual Shipped Date
     C                     Z-ADD*ZERO     YL0016  70
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0017  1
      * Define local work field Broker Name
     C                     MOVEL*BLANK    YL0018 30
      * Define local work field Broker Address Line 1
     C                     MOVEL*BLANK    YL0019 30
      * Define local work field Broker Address Line 2
     C                     MOVEL*BLANK    YL0020 30
      * Define local work field Broker City
     C                     MOVEL*BLANK    YL0021 20
      * Define local work field Broker State
     C                     MOVEL*BLANK    YL0022  2
      * Define local work field Broker Zip
     C                     MOVEL*BLANK    YL0023 11
      * Define local work field Broker Office Manager
     C                     MOVEL*BLANK    YL0024 30
      * Define local work field Broker Telephone Number
     C                     MOVEL*BLANK    YL0025 25
      * Define local work field Broker Fax Number
     C                     MOVEL*BLANK    YL0026 25
      * Define local work field Broker Email Address
     C                     MOVEL*BLANK    YL0027 50
      * Define local work field Salesperson Code
     C                     MOVEL*BLANK    YL0028  3
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0029  1
      * Define local work field Year Length USR
     C                     Z-ADD*ZERO     YL0030  50
      * Define local work field AS Date MM/DD
     C                     MOVEL*BLANK    YL0031  5
      * Define local work field Date (Alpha) USR
     C                     MOVEL*BLANK    YL0032  7
      * Define local work field Period Beginning Date
     C                     Z-ADD*ZERO     YL0033  70
      * Define local work field DD   numeric USR
     C                     Z-ADD*ZERO     YL0034  20
      * Define local work field DD   alpha   USR
     C                     MOVEL*BLANK    YL0035  2
      * Define local work field Period Ending Date
     C                     Z-ADD*ZERO     YL0036  70
      * Define local work field Accounting Year Code
     C                     Z-ADD*ZERO     YL0037  40
      * Define local work field Accounting Period Code
     C                     Z-ADD*ZERO     YL0038  20
      * Define local work field OM Week
     C                     Z-ADD*ZERO     YL0039  30
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0040  1
      * Define local work field Item Accrual Amt
     C                     Z-ADD*ZERO     YL0041 112
      * Define local work field USR amount 1  11.2
     C                     Z-ADD*ZERO     YL0042 112
      * Define null work field G/L Account Category
     C                     MOVEL*BLANK    YN0006  3
      * Define local work field APE Excl Collect ShpMthd
     C                     MOVEL*BLANK    YL0043  1
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0007  1
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0044  1
      * Define local work field Broker Code
     C                     MOVEL*BLANK    YL0045  6
      *================================================================
     CSR         ZZEXIT    ENDSR
