     H/TITLE Upd OHE EDI 601/824 InfXF Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) ACTGRP(*CALLER) BNDDIR(YBNDDIR)
     Z* DBGVIEW(*SOURCE) OPTIMIZE(*BASIC) CVTOPT(*DATETIME)
     Z* TGTRLS(V7R3M0)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSGOYA
     H* Date          : 12/31/24  Time  : 03:40:14
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPMAMREL2  IF   E           K DISK
      * RSQ : Order Header Extension    Load ID/Order#/Co#
      *
     FPMAMRELO  IF   E           K DISK
      * RSQ : Order Header Extension    AES ITN#
      *
     FPMAMREL0  UF   E           K DISK
      * UPD : Order Header Extension    Update index
      *
      * Long constants
     D @CN#            S              6    DIM(01)CTDATA PERRCD(1)
     D @CN             S             25    DIM(01) ALT(@CN#)
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
     D QPMAM1        E DS                  EXTNAME(PMAMREL0)
      * UPD : Order Header Extension    Update index
      * Renamed input format fields
     D  WBAIC3       E                     EXTFLD(AMAIC3)
     D  WBC4NB       E                     EXTFLD(AMC4NB)
     D  WBRMNB       E                     EXTFLD(AMRMNB)
     D  WBRUNB       E                     EXTFLD(AMRUNB)
     D  WBXACD       E                     EXTFLD(AMXACD)
     D  WBOANA       E                     EXTFLD(AMOANA)
     D  WBHBAA       E                     EXTFLD(AMHBAA)
     D  WBJ0T1       E                     EXTFLD(AMJ0T1)
     D  WBGENY       E                     EXTFLD(AMGENY)
     D  WBJ1T1       E                     EXTFLD(AMJ1T1)
     D  WBHCAA       E                     EXTFLD(AMHCAA)
     D  WBQWDT       E                     EXTFLD(AMQWDT)
     D  WBQXDT       E                     EXTFLD(AMQXDT)
     D  WBQYDT       E                     EXTFLD(AMQYDT)
     D  WBHDAA       E                     EXTFLD(AMHDAA)
     D  WBCCTX       E                     EXTFLD(AMCCTX)
     D  WBJ2T1       E                     EXTFLD(AMJ2T1)
     D  WBRLNA       E                     EXTFLD(AMRLNA)
     D  WBRMNA       E                     EXTFLD(AMRMNA)
     D  WBGINY       E                     EXTFLD(AMGINY)
     D  WBGFNY       E                     EXTFLD(AMGFNY)
     D  WBGGNY       E                     EXTFLD(AMGGNY)
     D  WBGHNY       E                     EXTFLD(AMGHNY)
     D  WBHEVL       E                     EXTFLD(AMHEVL)
     D  WBHFVL       E                     EXTFLD(AMHFVL)
     D  WBHGVL       E                     EXTFLD(AMHGVL)
     D  WBQZDT       E                     EXTFLD(AMQZDT)
     D  WBQ0DT       E                     EXTFLD(AMQ0DT)
     D  WBQ1DT       E                     EXTFLD(AMQ1DT)
     D  WBQ2DT       E                     EXTFLD(AMQ2DT)
     D  WBC2TX       E                     EXTFLD(AMC2TX)
     D  WBC3TX       E                     EXTFLD(AMC3TX)
     D  WBC6TX       E                     EXTFLD(AMC6TX)
     D  WBCHTX       E                     EXTFLD(AMCHTX)
     D  WBCITX       E                     EXTFLD(AMCITX)
     D  WBCLTX       E                     EXTFLD(AMCLTX)
     D  WBB4TX       E                     EXTFLD(AMB4TX)
     D  WBCUTX       E                     EXTFLD(AMCUTX)
     D  WBCVTX       E                     EXTFLD(AMCVTX)
     D  WBB9TX       E                     EXTFLD(AMB9TX)
     D  WBJWSC       E                     EXTFLD(AMJWSC)
     D  WBITNY       E                     EXTFLD(AMITNY)
     D  WBLMT1       E                     EXTFLD(AMLMT1)
     D  WBLWAA       E                     EXTFLD(AMLWAA)
     D  WBFVST       E                     EXTFLD(AMFVST)
     D  WBF0ST       E                     EXTFLD(AMF0ST)
     D  WBF2ST       E                     EXTFLD(AMF2ST)
     D  WBF3ST       E                     EXTFLD(AMF3ST)
     D  WBJUSC       E                     EXTFLD(AMJUSC)
     D  WBJVSC       E                     EXTFLD(AMJVSC)
     D  WBV3T1       E                     EXTFLD(AMV3T1)
     D  WBV4T1       E                     EXTFLD(AMV4T1)
     D  WBV5T1       E                     EXTFLD(AMV5T1)
     D  WBV6T1       E                     EXTFLD(AMV6T1)
     D  WBV7T1       E                     EXTFLD(AMV7T1)
     D  WBV8T1       E                     EXTFLD(AMV8T1)
     D  WBV9T1       E                     EXTFLD(AMV9T1)
     D  WBWAT1       E                     EXTFLD(AMWAT1)
     D  WBWBT1       E                     EXTFLD(AMWBT1)
     D  WBWCT1       E                     EXTFLD(AMWCT1)
     D  WBWDT1       E                     EXTFLD(AMWDT1)
     D  WBQJNY       E                     EXTFLD(AMQJNY)
     D  WBQKNY       E                     EXTFLD(AMQKNY)
     D  WBQLNY       E                     EXTFLD(AMQLNY)
     D  WBP8NY       E                     EXTFLD(AMP8NY)
     D  WBP9NY       E                     EXTFLD(AMP9NY)
     D  WBQANY       E                     EXTFLD(AMQANY)
     D  WBQCNY       E                     EXTFLD(AMQCNY)
     D  WBQDNY       E                     EXTFLD(AMQDNY)
     D  WBQENY       E                     EXTFLD(AMQENY)
     D  WBQFNY       E                     EXTFLD(AMQFNY)
     D  WBQGNY       E                     EXTFLD(AMQGNY)
     D  WBQHNY       E                     EXTFLD(AMQHNY)
     D  WBQINY       E                     EXTFLD(AMQINY)
     D  WBQMNY       E                     EXTFLD(AMQMNY)
     D  WBMYU1       E                     EXTFLD(AMMYU1)
     D  WBJXSC       E                     EXTFLD(AMJXSC)
     D  WBJYSC       E                     EXTFLD(AMJYSC)
     D  WBJZSC       E                     EXTFLD(AMJZSC)
     D  WBJ0SC       E                     EXTFLD(AMJ0SC)
     D  WBMZU1       E                     EXTFLD(AMMZU1)
     D  WBM0U1       E                     EXTFLD(AMM0U1)
     D  WBM1U1       E                     EXTFLD(AMM1U1)
     D  WBM2U1       E                     EXTFLD(AMM2U1)
     D  WBM3U1       E                     EXTFLD(AMM3U1)
     D  WBW5DT       E                     EXTFLD(AMW5DT)
     D  WBW6DT       E                     EXTFLD(AMW6DT)
     D  WBUVST       E                     EXTFLD(AMUVST)
     D  WBUWST       E                     EXTFLD(AMUWST)
     D  WBUXST       E                     EXTFLD(AMUXST)
     D  WBVSST       E                     EXTFLD(AMVSST)
     D  WBAATM       E                     EXTFLD(AMAATM)
     D  WBAYNA       E                     EXTFLD(AMAYNA)
     D  WBA0NA       E                     EXTFLD(AMA0NA)
     D  WBAXDT       E                     EXTFLD(AMAXDT)
      *
     D YARDCS          DS           894
      * Message data for message Y2U0009.
     D MD0009          DS
     D  MDPGM                  1     10
     D  MDACP                 11     20
     D  MDFMT                 21     30
     D  MDACT                 31     34
     D  MDLBL                 35     40
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  WP0001         S              7  0
     D  WP0002         S             15
     D  WP0003         S              1
     D  WP0004         S              2
     D  WP0005         S             15
     D  WP0006         S             15
     D  WP0007         S              7  0
     D  WP0008         S              1
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  WQSA01         S                   LIKE(WARMNB)
     D  WL0001         S              3  0
     D  WL0002         S              7  0
     D  WL0003         S              1
     D  WL0004         S              2
     D  WL0005         S             15
     D  WN0001         S              7  0
     D  WN0002         S              5  0
     D  WN0003         S              3
     D  WN0004         S             20
     D  WN0005         S             25
     D  WN0006         S             30
     D  WN0007         S             15
     D  WN0008         S             15
     D  WN0009         S             20
     D  WN0010         S              7  0
     D  WN0011         S              7  0
     D  WN0012         S              7  0
     D  WN0013         S              3
     D  WN0014         S              1
     D  WN0015         S             12
     D  WN0016         S             35
     D  WN0017         S             75
     D  WN0018         S             11  0
     D  WN0019         S             11  0
     D  WN0020         S             11  0
     D  WN0021         S             11  0
     D  WN0022         S             11  2
     D  WN0023         S             11  2
     D  WN0024         S             11  2
     D  WN0025         S              7  0
     D  WN0026         S              7  0
     D  WN0027         S              7  0
     D  WN0028         S              7  0
     D  WN0029         S              4
     D  WN0030         S              4
     D  WN0031         S              4
     D  WN0032         S              2
     D  WN0033         S              2
     D  WN0034         S              2
     D  WN0035         S              3
     D  WN0036         S              3
     D  WN0037         S              3
     D  WN0038         S              5
     D  WN0039         S              5
     D  WN0040         S              5  0
     D  WN0041         S             38
     D  WN0042         S              6
     D  WN0043         S              6
     D  WN0044         S              6
     D  WN0045         S              6
     D  WN0046         S              6
     D  WN0047         S              1
     D  WN0048         S             10
     D  WN0049         S             10
     D  WN0050         S             10
     D  WN0051         S             15
     D  WN0052         S             15
     D  WN0053         S             15
     D  WN0054         S             30
     D  WN0055         S             30
     D  WN0056         S             30
     D  WN0057         S             50
     D  WN0058         S             50
     D  WN0059         S              3  0
     D  WN0060         S              3  0
     D  WN0061         S              3  0
     D  WN0062         S              5  2
     D  WN0063         S              5  2
     D  WN0064         S              5  0
     D  WN0065         S              6  0
     D  WN0066         S              6  0
     D  WN0067         S              6  0
     D  WN0068         S              6  0
     D  WN0069         S              9  0
     D  WN0070         S              9  0
     D  WN0071         S              9  0
     D  WN0072         S              9  6
     D  WN0073         S             15
     D  WN0074         S              1
     D  WN0075         S              1
     D  WN0076         S              2
     D  WN0077         S              5
     D  WN0078         S              5
     D  WN0079         S             15
     D  WN0080         S             30
     D  WN0081         S              7  0
     D  WN0082         S              7  0
     D  WN0083         S              1
     D  WN0084         S              1
     D  WN0085         S              1
     D  WN0086         S              1
     D  WN0087         S              6  0
     D  WN0088         S             10
     D  WN0089         S             10
     D  WN0090         S              7  0
     D  YARDC          S              1
     D  Y0CX01         S              1
     D  WQSC01         S                   LIKE(WCM2U1)
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  W0PMT          S              1
      /EJECT
      * Parameter declarations
     D P1PARM          DS
      * FLD: Order Header Extension
      * I :  Load ID
     D  P1RMNB                 1      4P 0
      * I :  OHE Booking Number
     D  P1J1T1                 5     19
      * I :  OHE EDI 824 Action
     D  P1JVSC                20     20
      * I :  OHE EDI 601 Action
     D  P1JZSC                21     22
      * I :  OHE EDI 824 AES ITN #
     D  P1M2U1                23     37
     D P2PARM          DS
      * I :  OHE EDI 824 AES ITN # US
     D  P2WYU1                 1     15
     D P3PARM          DS
      * O :  Load ID USR
     D  P3LOID                 1      4P 0
     D P4PARM          DS
      * O :  New LID added to order
     D  P4QTSC                 1      1
     D                 DS
     D  ZAMSDA                 1    132
     I@AMREJM
      * Order Header Extension    Load ID/Order#/Co#
      * Renamed input format fields
     I              AMAIC3                      WAAIC3
     I              AMC4NB                      WAC4NB
     I              AMRMNB                      WARMNB
     I              AMRUNB                      WARUNB
     I              AMXACD                      WAXACD
     I              AMOANA                      WAOANA
     I              AMHBAA                      WAHBAA
     I              AMJ0T1                      WAJ0T1
     I              AMGENY                      WAGENY
     I              AMJ1T1                      WAJ1T1
     I              AMHCAA                      WAHCAA
     I              AMQWDT                      WAQWDT
     I              AMQXDT                      WAQXDT
     I              AMQYDT                      WAQYDT
     I              AMHDAA                      WAHDAA
     I              AMCCTX                      WACCTX
     I              AMJ2T1                      WAJ2T1
     I              AMRLNA                      WARLNA
     I              AMRMNA                      WARMNA
     I              AMGINY                      WAGINY
     I              AMGFNY                      WAGFNY
     I              AMGGNY                      WAGGNY
     I              AMGHNY                      WAGHNY
     I              AMHEVL                      WAHEVL
     I              AMHFVL                      WAHFVL
     I              AMHGVL                      WAHGVL
     I              AMQZDT                      WAQZDT
     I              AMQ0DT                      WAQ0DT
     I              AMQ1DT                      WAQ1DT
     I              AMQ2DT                      WAQ2DT
     I              AMC2TX                      WAC2TX
     I              AMC3TX                      WAC3TX
     I              AMC6TX                      WAC6TX
     I              AMCHTX                      WACHTX
     I              AMCITX                      WACITX
     I              AMCLTX                      WACLTX
     I              AMB4TX                      WAB4TX
     I              AMCUTX                      WACUTX
     I              AMCVTX                      WACVTX
     I              AMB9TX                      WAB9TX
     I              AMJWSC                      WAJWSC
     I              AMITNY                      WAITNY
     I              AMLMT1                      WALMT1
     I              AMLWAA                      WALWAA
     I              AMFVST                      WAFVST
     I              AMF0ST                      WAF0ST
     I              AMF2ST                      WAF2ST
     I              AMF3ST                      WAF3ST
     I              AMJUSC                      WAJUSC
     I              AMJVSC                      WAJVSC
     I              AMV3T1                      WAV3T1
     I              AMV4T1                      WAV4T1
     I              AMV5T1                      WAV5T1
     I              AMV6T1                      WAV6T1
     I              AMV7T1                      WAV7T1
     I              AMV8T1                      WAV8T1
     I              AMV9T1                      WAV9T1
     I              AMWAT1                      WAWAT1
     I              AMWBT1                      WAWBT1
     I              AMWCT1                      WAWCT1
     I              AMWDT1                      WAWDT1
     I              AMQJNY                      WAQJNY
     I              AMQKNY                      WAQKNY
     I              AMQLNY                      WAQLNY
     I              AMP8NY                      WAP8NY
     I              AMP9NY                      WAP9NY
     I              AMQANY                      WAQANY
     I              AMQCNY                      WAQCNY
     I              AMQDNY                      WAQDNY
     I              AMQENY                      WAQENY
     I              AMQFNY                      WAQFNY
     I              AMQGNY                      WAQGNY
     I              AMQHNY                      WAQHNY
     I              AMQINY                      WAQINY
     I              AMQMNY                      WAQMNY
     I              AMMYU1                      WAMYU1
     I              AMJXSC                      WAJXSC
     I              AMJYSC                      WAJYSC
     I              AMJZSC                      WAJZSC
     I              AMJ0SC                      WAJ0SC
     I              AMMZU1                      WAMZU1
     I              AMM0U1                      WAM0U1
     I              AMM1U1                      WAM1U1
     I              AMM2U1                      WAM2U1
     I              AMM3U1                      WAM3U1
     I              AMW5DT                      WAW5DT
     I              AMW6DT                      WAW6DT
     I              AMUVST                      WAUVST
     I              AMUWST                      WAUWST
     I              AMUXST                      WAUXST
     I              AMVSST                      WAVSST
     I              AMAATM                      WAAATM
     I              AMAYNA                      WAAYNA
     I              AMA0NA                      WAA0NA
     I              AMAXDT                      WAAXDT
      *
     I@AMREJE
      * Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                      WBAIC3
     I              AMC4NB                      WBC4NB
     I              AMRMNB                      WBRMNB
     I              AMRUNB                      WBRUNB
     I              AMXACD                      WBXACD
     I              AMOANA                      WBOANA
     I              AMHBAA                      WBHBAA
     I              AMJ0T1                      WBJ0T1
     I              AMGENY                      WBGENY
     I              AMJ1T1                      WBJ1T1
     I              AMHCAA                      WBHCAA
     I              AMQWDT                      WBQWDT
     I              AMQXDT                      WBQXDT
     I              AMQYDT                      WBQYDT
     I              AMHDAA                      WBHDAA
     I              AMCCTX                      WBCCTX
     I              AMJ2T1                      WBJ2T1
     I              AMRLNA                      WBRLNA
     I              AMRMNA                      WBRMNA
     I              AMGINY                      WBGINY
     I              AMGFNY                      WBGFNY
     I              AMGGNY                      WBGGNY
     I              AMGHNY                      WBGHNY
     I              AMHEVL                      WBHEVL
     I              AMHFVL                      WBHFVL
     I              AMHGVL                      WBHGVL
     I              AMQZDT                      WBQZDT
     I              AMQ0DT                      WBQ0DT
     I              AMQ1DT                      WBQ1DT
     I              AMQ2DT                      WBQ2DT
     I              AMC2TX                      WBC2TX
     I              AMC3TX                      WBC3TX
     I              AMC6TX                      WBC6TX
     I              AMCHTX                      WBCHTX
     I              AMCITX                      WBCITX
     I              AMCLTX                      WBCLTX
     I              AMB4TX                      WBB4TX
     I              AMCUTX                      WBCUTX
     I              AMCVTX                      WBCVTX
     I              AMB9TX                      WBB9TX
     I              AMJWSC                      WBJWSC
     I              AMITNY                      WBITNY
     I              AMLMT1                      WBLMT1
     I              AMLWAA                      WBLWAA
     I              AMFVST                      WBFVST
     I              AMF0ST                      WBF0ST
     I              AMF2ST                      WBF2ST
     I              AMF3ST                      WBF3ST
     I              AMJUSC                      WBJUSC
     I              AMJVSC                      WBJVSC
     I              AMV3T1                      WBV3T1
     I              AMV4T1                      WBV4T1
     I              AMV5T1                      WBV5T1
     I              AMV6T1                      WBV6T1
     I              AMV7T1                      WBV7T1
     I              AMV8T1                      WBV8T1
     I              AMV9T1                      WBV9T1
     I              AMWAT1                      WBWAT1
     I              AMWBT1                      WBWBT1
     I              AMWCT1                      WBWCT1
     I              AMWDT1                      WBWDT1
     I              AMQJNY                      WBQJNY
     I              AMQKNY                      WBQKNY
     I              AMQLNY                      WBQLNY
     I              AMP8NY                      WBP8NY
     I              AMP9NY                      WBP9NY
     I              AMQANY                      WBQANY
     I              AMQCNY                      WBQCNY
     I              AMQDNY                      WBQDNY
     I              AMQENY                      WBQENY
     I              AMQFNY                      WBQFNY
     I              AMQGNY                      WBQGNY
     I              AMQHNY                      WBQHNY
     I              AMQINY                      WBQINY
     I              AMQMNY                      WBQMNY
     I              AMMYU1                      WBMYU1
     I              AMJXSC                      WBJXSC
     I              AMJYSC                      WBJYSC
     I              AMJZSC                      WBJZSC
     I              AMJ0SC                      WBJ0SC
     I              AMMZU1                      WBMZU1
     I              AMM0U1                      WBM0U1
     I              AMM1U1                      WBM1U1
     I              AMM2U1                      WBM2U1
     I              AMM3U1                      WBM3U1
     I              AMW5DT                      WBW5DT
     I              AMW6DT                      WBW6DT
     I              AMUVST                      WBUVST
     I              AMUWST                      WBUWST
     I              AMUXST                      WBUXST
     I              AMVSST                      WBVSST
     I              AMAATM                      WBAATM
     I              AMAYNA                      WBAYNA
     I              AMA0NA                      WBA0NA
     I              AMAXDT                      WBAXDT
      *
     I@AMREWU
      * Order Header Extension    AES ITN#
      * Renamed input format fields
     I              AMAIC3                      WCAIC3
     I              AMC4NB                      WCC4NB
     I              AMRMNB                      WCRMNB
     I              AMRUNB                      WCRUNB
     I              AMXACD                      WCXACD
     I              AMOANA                      WCOANA
     I              AMHBAA                      WCHBAA
     I              AMJ0T1                      WCJ0T1
     I              AMGENY                      WCGENY
     I              AMJ1T1                      WCJ1T1
     I              AMHCAA                      WCHCAA
     I              AMQWDT                      WCQWDT
     I              AMQXDT                      WCQXDT
     I              AMQYDT                      WCQYDT
     I              AMHDAA                      WCHDAA
     I              AMCCTX                      WCCCTX
     I              AMJ2T1                      WCJ2T1
     I              AMRLNA                      WCRLNA
     I              AMRMNA                      WCRMNA
     I              AMGINY                      WCGINY
     I              AMGFNY                      WCGFNY
     I              AMGGNY                      WCGGNY
     I              AMGHNY                      WCGHNY
     I              AMHEVL                      WCHEVL
     I              AMHFVL                      WCHFVL
     I              AMHGVL                      WCHGVL
     I              AMQZDT                      WCQZDT
     I              AMQ0DT                      WCQ0DT
     I              AMQ1DT                      WCQ1DT
     I              AMQ2DT                      WCQ2DT
     I              AMC2TX                      WCC2TX
     I              AMC3TX                      WCC3TX
     I              AMC6TX                      WCC6TX
     I              AMCHTX                      WCCHTX
     I              AMCITX                      WCCITX
     I              AMCLTX                      WCCLTX
     I              AMB4TX                      WCB4TX
     I              AMCUTX                      WCCUTX
     I              AMCVTX                      WCCVTX
     I              AMB9TX                      WCB9TX
     I              AMJWSC                      WCJWSC
     I              AMITNY                      WCITNY
     I              AMLMT1                      WCLMT1
     I              AMLWAA                      WCLWAA
     I              AMFVST                      WCFVST
     I              AMF0ST                      WCF0ST
     I              AMF2ST                      WCF2ST
     I              AMF3ST                      WCF3ST
     I              AMJUSC                      WCJUSC
     I              AMJVSC                      WCJVSC
     I              AMV3T1                      WCV3T1
     I              AMV4T1                      WCV4T1
     I              AMV5T1                      WCV5T1
     I              AMV6T1                      WCV6T1
     I              AMV7T1                      WCV7T1
     I              AMV8T1                      WCV8T1
     I              AMV9T1                      WCV9T1
     I              AMWAT1                      WCWAT1
     I              AMWBT1                      WCWBT1
     I              AMWCT1                      WCWCT1
     I              AMWDT1                      WCWDT1
     I              AMQJNY                      WCQJNY
     I              AMQKNY                      WCQKNY
     I              AMQLNY                      WCQLNY
     I              AMP8NY                      WCP8NY
     I              AMP9NY                      WCP9NY
     I              AMQANY                      WCQANY
     I              AMQCNY                      WCQCNY
     I              AMQDNY                      WCQDNY
     I              AMQENY                      WCQENY
     I              AMQFNY                      WCQFNY
     I              AMQGNY                      WCQGNY
     I              AMQHNY                      WCQHNY
     I              AMQINY                      WCQINY
     I              AMQMNY                      WCQMNY
     I              AMMYU1                      WCMYU1
     I              AMJXSC                      WCJXSC
     I              AMJYSC                      WCJYSC
     I              AMJZSC                      WCJZSC
     I              AMJ0SC                      WCJ0SC
     I              AMMZU1                      WCMZU1
     I              AMM0U1                      WCM0U1
     I              AMM1U1                      WCM1U1
     I              AMM2U1                      WCM2U1
     I              AMM3U1                      WCM3U1
     I              AMW5DT                      WCW5DT
     I              AMW6DT                      WCW6DT
     I              AMUVST                      WCUVST
     I              AMUWST                      WCUWST
     I              AMUXST                      WCUXST
     I              AMVSST                      WCVSST
     I              AMAATM                      WCAATM
     I              AMAYNA                      WCAYNA
     I              AMA0NA                      WCA0NA
     I              AMAXDT                      WCAXDT
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
     C     P1RMNB        PARM                    WP0001                         Load ID
     C     P1J1T1        PARM                    WP0002                         OHE Booking Num
     C     P1JVSC        PARM                    WP0003                         OHE EDI 824 Act
     C     P1JZSC        PARM                    WP0004                         OHE EDI 601 Act
     C     P1M2U1        PARM                    WP0005                         OHE EDI 824 AES
     C     P2WYU1        PARM                    WP0006                         OHE EDI 824 AES
     C                   PARM      P3LOID        WP0007                         Load ID USR
     C                   PARM      P4QTSC        WP0008                         New LID added t
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Upd OHE EDI 601/824 InfXF
      * Upd OHE EDI 601/824 InfRT - Order Header Extension  * 
     C                   EXSR      SARVGN
     C                   MOVEL     'N'           P4QTSC                         New LID added t
      * Search order with ITN# as old load id is deleted
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Return code is *Record does not exist
      *   |- c2    : PAR.OHE EDI 824 AES ITN # US is Entered
      *   '-
     C                   MOVEL     '0'           Y0CX01
     C                   IF        W0RTN = @CN(001)
     C                   IF        P2WYU1 <> ' '
     C                   MOVEL     '1'           Y0CX01
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Upd OHE EDI 601/824 In1RT - Order Header Extension  * 
     C                   IF        Y0CX01 = '1'
     C                   EXSR      SCRVGN
     C                   END                                                    *FI
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * Upd OHE EDI 601/824 InfRT - Order Header Extension  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
     C                   EVAL      W0RTN = ' '                                  *Return code
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSA         KLIST
     C                   KFLD                    WQSA01                         Load ID
      * Setup key
     C                   Z-ADD     P1RMNB        WQSA01                         Load ID
      * Establish starting position
     C     KRSSA         SETLL     @AMREJM                                      *
     C     KRSSA         READE     @AMREJM                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'USR3697'     W0RTN
      * USER: Processing if Data record not found
     C                   MOVEL     'Y2U0005'     W0RTN                          *Return code
     C                   GOTO      SAEXIT
     C                   ENDIF
      *
      * USER: Process Data record
      * Update OHE EDI 601/824 Info to Blank.
      * CASE: PAR.OHE Booking Number EQ DB1.OHE Booking Number
     C                   DOW       NOT *IN90
      * CHG OHE EDI 601/824 InfCH - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                   IF        P1J1T1 = WAJ1T1
     C                   Z-ADD     WAAIC3        WL0001                         Company Number
     C                   Z-ADD     WAC4NB        WL0002                         Order Number
     C                   MOVEL(P)  P1JVSC        WL0003                         OHE EDI 824 Act
     C                   MOVEL(P)  P1JZSC        WL0004                         OHE EDI 601 Act
     C                   MOVEL(P)  P1M2U1        WL0005                         OHE EDI 824 AES
     C                   EXSR      SBCHRC
     C                   END                                                    *FI
     C     KRSSA         READE     @AMREJM                                90    *
     C                   ENDDO
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBCHRC        BEGSR
      *================================================================
      * CHG OHE EDI 601/824 InfCH - Order Header Extension  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0001                         Load ID
     C                   Z-ADD     *ZERO         WN0002                         Stop_Drop Seque
     C                   EVAL      WN0003 = ' '                                 Shipping Line
     C                   EVAL      WN0004 = ' '                                 Port Delv Termi
     C                   EVAL      WN0005 = ' '                                 OHE City
     C                   EVAL      WN0006 = ' '                                 OHE Vessel_Airl
     C                   EVAL      WN0007 = ' '                                 OHE Voyage_Flig
     C                   EVAL      WN0008 = ' '                                 OHE Booking Num
     C                   EVAL      WN0009 = ' '                                 OHE Discharge P
     C                   Z-ADD     *ZERO         WN0010                         OHE Sail_Flight
     C                   Z-ADD     *ZERO         WN0011                         OHE Port Cut Da
     C                   Z-ADD     *ZERO         WN0012                         OHE Arrival Dat
     C                   EVAL      WN0013 = ' '                                 OHE Late Delive
     C                   EVAL      WN0014 = ' '                                 OHE Ship Status
     C                   EVAL      WN0015 = ' '                                 OHE Container N
     C                   EVAL      WN0016 = ' '                                 OHE Comment 1
     C                   EVAL      WN0017 = ' '                                 OHE Comment 2
     C                   Z-ADD     *ZERO         WN0018                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0019                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0020                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0021                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0022                         OHE HPB RIN Equ
     C                   Z-ADD     *ZERO         WN0023                         OHE HPB RIN Pri
     C                   Z-ADD     *ZERO         WN0024                         Transload Termi
     C                   Z-ADD     *ZERO         WN0025                         OHE Est Arrv at
     C                   Z-ADD     *ZERO         WN0026                         OHE Backhaul ET
     C                   Z-ADD     *ZERO         WN0027                         OHE Port_Pier P
     C                   Z-ADD     *ZERO         WN0028                         OHE Actual Ship
     C                   EVAL      WN0029 = ' '                                 OHE Carrier SCA
     C                   EVAL      WN0030 = ' '                                 OHE Spot Buy
     C                   EVAL      WN0031 = ' '                                 OHE PO ACK Flag
     C                   EVAL      WN0032 = ' '                                 OHE Override Ty
     C                   EVAL      WN0033 = ' '                                 OHE Backhaul St
     C                   EVAL      WN0034 = ' '                                 OHE Backhaul ET
     C                   EVAL      WN0035 = ' '                                 OHE Load Haul T
     C                   EVAL      WN0036 = ' '                                 OHE Backhaul Ca
     C                   EVAL      WN0037 = ' '                                 OHE Bookings Co
     C                   EVAL      WN0038 = ' '                                 OHE EDI Error R
     C                   EVAL      WN0039 = ' '                                 OHE EDI Error R
     C                   Z-ADD     *ZERO         WN0040                         HPB COA Batch N
     C                   EVAL      WN0041 = ' '                                 Delivery P_O  N
     C                   EVAL      WN0042 = ' '                                 OHE Intended fo
     C                   EVAL      WN0043 = ' '                                 OHE EDI 943 Act
     C                   EVAL      WN0044 = ' '                                 OHE EDI 944 Act
     C                   EVAL      WN0045 = ' '                                 OHE EDI 940 Act
     C                   EVAL      WN0046 = ' '                                 OHE EDI 945 Act
     C                   EVAL      WN0047 = ' '                                 OHE EDI 856 Act
     C                   EVAL      WN0048 = ' '                                 OHE Transload S
     C                   EVAL      WN0049 = ' '                                 OHE Abs Rate Ov
     C                   EVAL      WN0050 = ' '                                 OHE Appt Confir
     C                   EVAL      WN0051 = ' '                                 OHE Backhaul Co
     C                   EVAL      WN0052 = ' '                                 OHE Backhaul Ch
     C                   EVAL      WN0053 = ' '                                 OHE Transload C
     C                   EVAL      WN0054 = ' '                                 OHE Pier Pass I
     C                   EVAL      WN0055 = ' '                                 OHE Carrier Nm
     C                   EVAL      WN0056 = ' '                                 OHE Appt Confir
     C                   EVAL      WN0057 = ' '                                 OHE Backhaul Co
     C                   EVAL      WN0058 = ' '                                 Letter of Credi
     C                   Z-ADD     *ZERO         WN0059                         OHE Backhaul Re
     C                   Z-ADD     *ZERO         WN0060                         LD Stop_Drop
     C                   Z-ADD     *ZERO         WN0061                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WN0062                         OHE Pier Pass F
     C                   Z-ADD     *ZERO         WN0063                         OHE Port Check
     C                   Z-ADD     *ZERO         WN0064                         OHE Port Cut Ti
     C                   Z-ADD     *ZERO         WN0065                         OHE Backhaul Tr
     C                   Z-ADD     *ZERO         WN0066                         OHE Load Sched
     C                   Z-ADD     *ZERO         WN0067                         Original Appoin
     C                   Z-ADD     *ZERO         WN0068                         Original Appoin
     C                   Z-ADD     *ZERO         WN0069                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WN0070                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WN0071                         OHE Unused Nume
     C                   Z-ADD     *ZERO         WN0072                         OHE Orig ABS Fr
     C                   EVAL      WN0073 = ' '                                 OHE Genset Numb
     C                   EVAL      WN0074 = ' '                                 OHE Email BOL_S
     C                   EVAL      WN0075 = ' '                                 OHE EDI Order A
     C                   EVAL      WN0076 = ' '                                 OHE Unused Stat
     C                   EVAL      WN0077 = ' '                                 OHE Unused Text
     C                   EVAL      WN0078 = ' '                                 OHE Unused Text
     C                   EVAL      WN0079 = ' '                                 OHE Customer Ve
     C                   EVAL      WN0080 = ' '                                 OHE Unused Text
     C                   Z-ADD     *ZERO         WN0081                         OHE Unused Date
     C                   Z-ADD     *ZERO         WN0082                         OHE Unused Date
     C                   EVAL      WN0083 = ' '                                 EDI Status 1
     C                   EVAL      WN0084 = ' '                                 EDI Status 2
     C                   EVAL      WN0085 = ' '                                 EDI Status 3
     C                   EVAL      WN0086 = ' '                                 Record Status
     C                   Z-ADD     *ZERO         WN0087                         Job Time
     C                   EVAL      WN0088 = ' '                                 User Id
     C                   EVAL      WN0089 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WN0090                         Job Date
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YARDC = ' '
      *
      * Move key fields to @AMREJE
     C                   Z-ADD     WL0001        WBAIC3                         Company Number
     C                   Z-ADD     WL0002        WBC4NB                         Order Number
      *
     C     KLCHSB        KLIST
     C                   KFLD                    WBAIC3                         Company Number
     C                   KFLD                    WBC4NB                         Order Number
     C     KLCHSB        CHAIN     @AMREJE                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'PMAMREL0'    MDACP
     C                   MOVEL     '@AMREJE'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL001.
     C                   MOVEL     'LBL001'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SBEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SBEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QPMAM1        YARDCS
      * Move non-key fields to @AMREJE
     C                   MOVEL(P)  WL0003        WBJVSC                         OHE EDI 824 Act
     C                   MOVEL(P)  WL0004        WBJZSC                         OHE EDI 601 Act
     C                   MOVEL(P)  WL0005        WBM2U1                         OHE EDI 824 AES
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QPMAM1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * USER: Processing before Data update
     C                   Z-ADD     ##JTM         WBAATM                         Job Time
     C                   Z-ADD     ##JDT         WBAXDT                         Job Date
     C                   MOVEL     ##PGM         WBA0NA                         Job Name
     C                   MOVEL     ##USR         WBAYNA                         User Id
      * Set PGM.*Record Data Changed flag
     C                   IF        QPMAM1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YARDC = 'Y'
     C                   UPDATE    @AMREJE                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    PMAMREL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   SCRVGN        BEGSR
      *================================================================
      * Upd OHE EDI 601/824 In1RT - Order Header Extension  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * USER: Initialize routine
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSC         KLIST
     C                   KFLD                    WQSC01                         OHE EDI 824 AES
      * Setup key
     C                   MOVEL     P2WYU1        WQSC01                         OHE EDI 824 AES
      * Establish starting position
     C     KRSSC         SETLL     @AMREWU                                      *
     C     KRSSC         READE     @AMREWU                                90    *
      * Data record not found
     C   90              MOVEL     'USR3697'     W0RTN
      * USER: Process Data record
      * Update OHE EDI 601/824 Info to Blank.
      * CASE: PAR.OHE Booking Number EQ DB1.OHE Booking Number
     C                   DOW       NOT *IN90
      * CHG OHE EDI 601/824 InfCH - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                   IF        P1J1T1 = WCJ1T1
     C                   Z-ADD     WCAIC3        WL0001                         Company Number
     C                   Z-ADD     WCC4NB        WL0002                         Order Number
     C                   MOVEL(P)  P1JVSC        WL0003                         OHE EDI 824 Act
     C                   MOVEL(P)  P1JZSC        WL0004                         OHE EDI 601 Act
     C                   MOVEL(P)  P1M2U1        WL0005                         OHE EDI 824 AES
     C                   EXSR      SBCHRC
     C                   MOVEL     'Y'           P4QTSC                         New LID added t
     C                   Z-ADD     WCRMNB        P3LOID                         Load ID
     C                   END                                                    *FI
     C     KRSSC         READE     @AMREWU                                90    *
     C                   ENDDO
      *================================================================
     CSR   SCEXIT        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      *
      *
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAAIC3                         Company Number
     C                   Z-ADD     *ZERO         WAC4NB                         Order Number
     C                   Z-ADD     *ZERO         WARMNB                         Load ID
     C                   Z-ADD     *ZERO         WARUNB                         Stop_Drop Seque
     C                   Z-ADD     *ZERO         WAQWDT                         OHE Sail_Flight
     C                   Z-ADD     *ZERO         WAQXDT                         OHE Port Cut Da
     C                   Z-ADD     *ZERO         WAQYDT                         OHE Arrival Dat
     C                   Z-ADD     *ZERO         WAGINY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WAGFNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WAGGNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WAGHNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WAHEVL                         OHE HPB RIN Equ
     C                   Z-ADD     *ZERO         WAHFVL                         OHE HPB RIN Pri
     C                   Z-ADD     *ZERO         WAHGVL                         Transload Termi
     C                   Z-ADD     *ZERO         WAQZDT                         OHE Est Arrv at
     C                   Z-ADD     *ZERO         WAQ0DT                         OHE Backhaul ET
     C                   Z-ADD     *ZERO         WAQ1DT                         OHE Port_Pier P
     C                   Z-ADD     *ZERO         WAQ2DT                         OHE Actual Ship
     C                   Z-ADD     *ZERO         WAITNY                         HPB COA Batch N
     C                   Z-ADD     *ZERO         WAQJNY                         OHE Backhaul Re
     C                   Z-ADD     *ZERO         WAQKNY                         LD Stop_Drop
     C                   Z-ADD     *ZERO         WAQLNY                         OHE Unused Numb
     C                   Z-ADD     *ZERO         WAP8NY                         OHE Pier Pass F
     C                   Z-ADD     *ZERO         WAP9NY                         OHE Port Check
     C                   Z-ADD     *ZERO         WAQANY                         OHE Port Cut Ti
     C                   Z-ADD     *ZERO         WAQCNY                         OHE Backhaul Tr
     C                   Z-ADD     *ZERO         WAQDNY                         OHE Load Sched
     C                   Z-ADD     *ZERO         WAQENY                         Original Appoin
     C                   Z-ADD     *ZERO         WAQFNY                         Original Appoin
     C                   Z-ADD     *ZERO         WAQGNY                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WAQHNY                         OHE PowerPro Lo
     C                   Z-ADD     *ZERO         WAQINY                         OHE Unused Nume
     C                   Z-ADD     *ZERO         WAQMNY                         OHE Orig ABS Fr
     C                   Z-ADD     *ZERO         WAW5DT                         OHE Unused Date
     C                   Z-ADD     *ZERO         WAW6DT                         OHE Unused Date
     C                   Z-ADD     *ZERO         WAAATM                         Job Time
     C                   Z-ADD     *ZERO         WAAXDT                         Job Date
      * Dummy move for compiler
     C                   MOVE      '0'           @CN#(1)
     C                   MOVEL     @CN(1)        @CN(1)
     C                   MOVEL     'N'           W0PMT
      * Define local variables for subroutine SBCHRC.
     C                   Z-ADD     *ZERO         WL0001
     C                   Z-ADD     *ZERO         WL0002
     C                   EVAL      WL0003 = ' '
     C                   EVAL      WL0004 = ' '
     C                   EVAL      WL0005 = ' '
      *================================================================
     CSR   ZZEXIT        ENDSR
** @CN
00001 Y2U0005
