/*  PROGRAM NUMBER:  PWJNPVRCLP                                    */
/*                                                                 */
/*  PROGRAM NAME:    Perform history from                          */
/*                   reporting for 2007 - 2018.                    */
/*                                                                 */
/*  PROGRAMMER:      Susan Mason                                   */
/*  ************     ********************************************* */
/*  Function:        This cl was developed to allow the user       */
/*                   to pick which year and the year will be       */
/*                   history that we will be using in the          */
/*                   enviorment that has been restore from tape    */
/*                   Year 2007 - 2018                              */
/*                   FUNCTION FILE : STR ORDER MANAGEMENT SYS      */
/*                   FUNCTION. . . : VAL APPLICATION/USER  IF      */
/*                   Will be used to pull the company for this      */
/*                   user.                                         */
/*                                                                 */
/*                   Help desk will restore each yearly libs       */
/*                   Tapes will restore to 07 - 18 enviorments     */
/*******************************************************************/
/* &OPTION selection                                               */
/*  01 HOG PROCUREMENT PERF. REPORT PKUDPVR ' '                    */
/*  03 HOG POPULATION REPORT PKUUPVR ' '                           */
/*  05 PURCHASE JOURNAL BY DATE PKUDFVR ' '                        */
/*                                                                 */
/*                   Then the option will state which report to    */
/*                   run,                                          */
/*******************************************************************/
/*  Modification History                                           */
/*  8/6/2019  Creation Susan L, Blakey                             */
/*******************************************************************/
             PGM        PARM(&OPTION)

             DCL        VAR(&OPTION) TYPE(*CHAR) LEN(2)
             DCL        VAR(&YEARLY) TYPE(*DEC)  LEN(4)
             DCL        VAR(&Y2D)    TYPE(*DEC)  LEN(2)
             DCL        VAR(&CO)     TYPE(*DEC)  LEN(3) VALUE(000)
/*   ALPHA USAGE                                                  */
             DCL        VAR(&Y2DNOA) TYPE(*CHAR) LEN(2)
             DCL        VAR(&PLIB1) TYPE(*CHAR) LEN(7)
             DCL        VAR(&FLIB1) TYPE(*CHAR) LEN(7)
             DCL        VAR(&HLIB1) TYPE(*CHAR) LEN(7)
             DCL        VAR(&HLIB2) TYPE(*CHAR) LEN(7)
             DCL        VAR(&HLIB3) TYPE(*CHAR) LEN(7)

             DCL        VAR(&PLIBE) TYPE(*CHAR) LEN(10)
             DCL        VAR(&FLIBE) TYPE(*CHAR) LEN(10)
             DCL        VAR(&HLIBE1) TYPE(*CHAR) LEN(10)
             DCL        VAR(&HLIBE2) TYPE(*CHAR) LEN(10)
             DCL        VAR(&HLIBE3) TYPE(*CHAR) LEN(10)

             CHGVAR     VAR(&PLIB1)  VALUE(PRKPLIB)
             CHGVAR     VAR(&FLIB1)  VALUE(PRKFLIB)
             CHGVAR     VAR(&HLIB1)  VALUE(PRKFGUP)
             CHGVAR     VAR(&HLIB2)  VALUE(PRKFTFP)
             CHGVAR     VAR(&HLIB3)  VALUE(PRKFSTP)

/*PERFORM PSHLIBL TO KEEP THE LIBRARY LIST BEFORE WE START.       */
             PSHLIBL

/* &CO Based on the User profile which is used inside this progran */
             CALL       PGM(PWJNPVR) PARM(' ' &YEARLY &Y2D &CO)

             CHGVAR     VAR(&Y2DNOA) VALUE(&Y2D)
             CHGVAR     VAR(&PLIBE)  VALUE(&PLIB1 *CAT &Y2DNOA)
             CHGVAR     VAR(&FLIBE)  VALUE(&FLIB1 *CAT &Y2DNOA)
             CHGVAR     VAR(&HLIBE1) VALUE(&HLIB1 *CAT &Y2DNOA)
             CHGVAR     VAR(&HLIBE2) VALUE(&HLIB2 *CAT &Y2DNOA)
             CHGVAR     VAR(&HLIBE3) VALUE(&HLIB3 *CAT &Y2DNOA)

             DMPCLPGM

             IF         COND(&CO *EQ 360) THEN(DO)
/*  SETLIBL FOR 360  BASE TEST                                    */
             SETLIBL PRKTSTGUP
             GOTO YR2018
             ENDDO
/*  SETLIBL FOR 960  BASE TEST                                    */
             IF         COND(&CO *EQ 960) THEN(DO)
             SETLIBL PRKTSTTFP
             GOTO YR2018
             ENDDO
/*  SETLIBL FOR 440  BASE TEST                                    */
             IF         COND(&CO *EQ 440) THEN(DO)
             SETLIBL PRKTSTSTP
             GOTO YR2018
             ENDDO

             GOTO NOSEL

YR2018:

             IF         COND(&YEARLY *EQ 0000) THEN(DO)
             GOTO NOSEL
             ENDDO

             ADDLIBLE   LIB(&PLIBE) POSITION(*BEFORE PRKTESTP)
             ADDLIBLE   LIB(&FLIBE) POSITION(*BEFORE TPMTESTF)
/*  ADDLIBLE LIBR FOR YEAR AND GUYMON FOODS                       */
             IF         COND(&CO *EQ 360) THEN(DO)
             ADDLIBLE   LIB(&HLIBE1) POSITION(*BEFORE PRKFTSTGUP)
             ENDDO
/*  ADDLIBLE LIBR FOR YEAR AND TRIUMPH FOODS                      */
             IF         COND(&CO *EQ 960) THEN(DO)
             ADDLIBLE   LIB(&HLIBE2) POSITION(*BEFORE PRKFTSTTFP)
             ENDDO
/*  ADDLIBLE LIBR FOR YEAR AND SEABOARD TRIUMPH FOODS             */
             IF         COND(&CO *EQ 440) THEN(DO)
             ADDLIBLE   LIB(&HLIBE3) POSITION(*BEFORE PRKFTSTSTP)
             ENDDO

RUNRPTS:
             DSPLIBL

/*   Now run the report that was selected from the menu          */
IF COND(&OPTION *EQ '01') THEN(DO)
/***  01 Hog Procurement Perf. Report PKUDPVR ' '              ***/
             CALL       PGM(PKUDPVR) PARM('')
             ENDDO
IF COND(&OPTION *EQ '03') THEN(DO)
/***  03 Hog Population Report PKUUPVR ' '                     ***/
             CALL       PGM(PKUUPVR) PARM('')
             ENDDO
IF COND(&OPTION *EQ '05') THEN(DO)
/***  05 Purchase Journal by Date PKUDFVR ' '                  ***/
             CALL       PGM(PKUDFVR) PARM('')
             ENDDO

NOSEL:

ENDRPT:
/*   Now push the library list back                              */
             POPLIBL
             DSPLIBL    OUTPUT(*PRINT)

             DLTOVR     FILE(*ALL)
ENDPGM

