     H/TITLE Exc Crt WF For FG Var XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 11/16/12  Time  : 11:40:30
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPOAZCPL1IF  E           K        DISK
      * RTV : Packaging BOM             Retrieval index
      *
     FCAB7CPM0IF  E           K        DISK
      * RSQ : Item Transaction Detail   Co/Item/Prod Date(D)RrAP
      *
     FPMALCPL0IF  E           K        DISK                      A
      * UPD : WF ISC Trans Sum/Pkg Var  Update index
      *
     I@AZCPHT
      * Packaging BOM             Retrieval index
      * Renamed input format fields
     I              AZAIC3                          WAAIC3
     I              AZHGCD                          WAHGCD
     I              AZBRAA                          WABRAA
     I              AZM1QT                          WAM1QT
     I              AZI5SX                          WAI5SX
     I              AZD8AA                          WAD8AA
     I              AZM3SX                          WAM3SX
     I              AZM7SX                          WAM7SX
     I              AZM8SX                          WAM8SX
     I              AZVSST                          WAVSST
     I              AZMJDT                          WAMJDT
     I              AZBETM                          WABETM
     I              AZCCVN                          WACCVN
     I              AZCDVN                          WACDVN
     I              AZMKDT                          WAMKDT
     I              AZBFTM                          WABFTM
     I              AZCEVN                          WACEVN
     I              AZCFVN                          WACFVN
      *
     I@B7CPPM
      * Item Transaction Detail   Co/Item/Prod Date(D)RrAP
      * Renamed input format fields
     I              B7AIC3                          WBAIC3
     I              B7HGCD                          WBHGCD
     I              B7AJCD                          WBAJCD
     I              B7W9ST                          WBW9ST
     I              B7BSST                          WBBSST
     I              B7B4DT                          WBB4DT
     I              B7C4NY                          WBC4NY
     I              B7DXNB                          WBDXNB
     I              B7ELDT                          WBELDT
     I              B7HVCD                          WBHVCD
     I              B7F1ST                          WBF1ST
     I              B7AUNA                          WBAUNA
     I              B7A5QT                          WBA5QT
     I              B7AHWG                          WBAHWG
     I              B7AKCS                          WBAKCS
     I              B7CGCD                          WBCGCD
     I              B7AYVA                          WBAYVA
     I              B7BJNA                          WBBJNA
     I              B7CKNB                          WBCKNB
     I              B7BMST                          WBBMST
     I              B7CQCD                          WBCQCD
     I              B7DTCD                          WBDTCD
     I              B7MGNA                          WBMGNA
     I              B7TRBN                          WBTRBN
     I              B7TRBS                          WBTRBS
     I              B7C4NB                          WBC4NB
     I              B7RINB                          WBRINB
     I              B7RHNB                          WBRHNB
     I              B7RGNB                          WBRGNB
     I              B7M3NA                          WBM3NA
     I              B7AWTM                          WBAWTM
     I              B7XLCD                          WBXLCD
     I              B7K7DT                          WBK7DT
     I              B7UVST                          WBUVST
     I              B7UWST                          WBUWST
     I              B7UXST                          WBUXST
     I              B7VSST                          WBVSST
     I              B7AATM                          WBAATM
     I              B7AYNA                          WBAYNA
     I              B7A0NA                          WBA0NA
     I              B7AXDT                          WBAXDT
      *
     I@ALCPJB
      * WF ISC Trans Sum/Pkg Var  Update index
      * Renamed input format fields
     I              ALAIDX                          WCAIDX
     I              ALB2C3                          WCB2C3
     I              ALGRAA                          WCGRAA
     I              ALEJC7                          WCEJC7
     I              ALMQWG                          WCMQWG
     I              ALM5WG                          WCM5WG
     I              ALOEQT                          WCOEQT
     I              ALOTQT                          WCOTQT
     I              ALM2WG                          WCM2WG
     I              ALOQQT                          WCOQQT
     I              ALM1WG                          WCM1WG
     I              ALOPQT                          WCOPQT
     I              ALNOWG                          WCNOWG
     I              ALOYQT                          WCOYQT
     I              ALNPWG                          WCNPWG
     I              ALOZQT                          WCOZQT
     I              ALNQWG                          WCNQWG
     I              ALNRWG                          WCNRWG
     I              ALNSWG                          WCNSWG
     I              ALNTWG                          WCNTWG
     I              ALNUWG                          WCNUWG
     I              ALNVWG                          WCNVWG
     I              ALO4QT                          WCO4QT
     I              ALO0QT                          WCO0QT
     I              ALO5QT                          WCO5QT
     I              ALO1QT                          WCO1QT
     I              ALO2QT                          WCO2QT
     I              ALO3QT                          WCO3QT
     I              ALNWWG                          WCNWWG
     I              ALO6QT                          WCO6QT
     I              ALNXWG                          WCNXWG
     I              ALO7QT                          WCO7QT
     I              ALNYWG                          WCNYWG
     I              ALO8QT                          WCO8QT
     I              ALNZWG                          WCNZWG
     I              ALO9QT                          WCO9QT
     I              ALN0WG                          WCN0WG
     I              ALPAQT                          WCPAQT
     I              ALN1WG                          WCN1WG
     I              ALPBQT                          WCPBQT
     I              ALN2WG                          WCN2WG
     I              ALPCQT                          WCPCQT
     I              ALN3WG                          WCN3WG
     I              ALPDQT                          WCPDQT
     I              ALN4WG                          WCN4WG
     I              ALPEQT                          WCPEQT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPMAL1    E DSPMALCPL0
      * UPD : WF ISC Trans Sum/Pkg Var  Update index
      * Renamed input format fields
     I              ALAIDX                          WCAIDX
     I              ALB2C3                          WCB2C3
     I              ALGRAA                          WCGRAA
     I              ALEJC7                          WCEJC7
     I              ALMQWG                          WCMQWG
     I              ALM5WG                          WCM5WG
     I              ALOEQT                          WCOEQT
     I              ALOTQT                          WCOTQT
     I              ALM2WG                          WCM2WG
     I              ALOQQT                          WCOQQT
     I              ALM1WG                          WCM1WG
     I              ALOPQT                          WCOPQT
     I              ALNOWG                          WCNOWG
     I              ALOYQT                          WCOYQT
     I              ALNPWG                          WCNPWG
     I              ALOZQT                          WCOZQT
     I              ALNQWG                          WCNQWG
     I              ALNRWG                          WCNRWG
     I              ALNSWG                          WCNSWG
     I              ALNTWG                          WCNTWG
     I              ALNUWG                          WCNUWG
     I              ALNVWG                          WCNVWG
     I              ALO4QT                          WCO4QT
     I              ALO0QT                          WCO0QT
     I              ALO5QT                          WCO5QT
     I              ALO1QT                          WCO1QT
     I              ALO2QT                          WCO2QT
     I              ALO3QT                          WCO3QT
     I              ALNWWG                          WCNWWG
     I              ALO6QT                          WCO6QT
     I              ALNXWG                          WCNXWG
     I              ALO7QT                          WCO7QT
     I              ALNYWG                          WCNYWG
     I              ALO8QT                          WCO8QT
     I              ALNZWG                          WCNZWG
     I              ALO9QT                          WCO9QT
     I              ALN0WG                          WCN0WG
     I              ALPAQT                          WCPAQT
     I              ALN1WG                          WCN1WG
     I              ALPBQT                          WCPBQT
     I              ALN2WG                          WCN2WG
     I              ALPCQT                          WCPCQT
     I              ALN3WG                          WCN3WG
     I              ALPDQT                          WCPDQT
     I              ALN4WG                          WCN4WG
     I              ALPEQT                          WCPEQT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Company Number
     I                                    P   1   20P1AIC3
     IP2PARM      DS
      * I :  Date From             USR
     I                                    P   1   40P2JEDT
     IP3PARM      DS
      * I :  Date To               USR
     I                                    P   1   40P3JFDT
     IP4PARM      DS
      * I :  Status - Y or N
     I                                        1   1 P4B8ST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P2JEDT    PARM           WP0002  70       Date From
     C           P3JFDT    PARM           WP0003  70       Date To
     C           P4B8ST    PARM           WP0004  1        Status - Y or N
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Exc Crt WF For FG Var  XF
      * RMC E00458 07/29/09
      *   Include these adjustment types in the "RR" production bucket:
      *   type "A" "A " Reason= "ADD" (I03 in carlisle), "SAD" (I04 in Ca
      *   See more explanation in lower RTV
      * RMC NEW 3/07/08
      * Create workfile for Pkg FG Variance with FG Items RR, A,AP totals
      *  for the Date Range specified.
      * (when the print runs, read this file instead of reading the item
      *  trans dtl multiple times for the same FG item.)
      * PAR.Status - Y or N is yes  :  Accum transactions with a trans
      *   date after the production date only
      * RTV Crt WF for FG Var RT - Packaging BOM  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Crt WF for FG Var RT - Packaging BOM  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
      * Establish starting position
     C           KRSSA     SETLL@AZCPHT                    *
     C           KRSSA     READE@AZCPHT                  90*
      * Data record not found
     C   90                MOVEL'USR3007' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Item Code NE LCL.Item Code
     C           WAHGCD    IFNE YL0001                     *IF
     C                     Z-ADDWAHGCD    YL0001           Item Code
      * Rtv Trans qty f/Workf RT - Item Transaction Detail  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@AZCPHT                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Trans qty f/Workf RT - Item Transaction Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * E00458 RMC 7/29/09 Add type "A " & reason ADD/SAD to production a
      *   These are from carlisle trans I03 and I04, phantom boxes
      *  Phantom Box is a box that was supposed to be rejected but makes
      *  into storage and is eventually shipped. When carlisle ships them
      *  trans types I03 and S01 are sent. If the box hits the production
      *  trans types P01 and I04 are sent. The I03 and I04 have opposite
      *  so they cancel each other if both are sent. we want to include
      * the (I04+I03) as production without overstating production.
      * ____________________________________________
      * PAR.Status - Y or N = yes :  Accum transactions with a trans
      *    date after the production date only
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0002           Qty Produced
     C                     Z-ADD*ZERO     YL0003           Qty Prod Adjust
     C                     Z-ADD*ZERO     YL0004           Qty Produced 2
     C                     Z-ADD*ZERO     YL0005           Qty Prod Adjust
     C                     Z-ADD0         YL0006           Production Date
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBHGCD    WQSB02           Item Code
      * Define keylist
     C           KPSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Item Code
     C                     KFLD           WBELDT           Production Date
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Item Code
      * Setup key
     C                     Z-ADDWAAIC3    WQSB01           Company Number
     C                     Z-ADDWAHGCD    WQSB02           Item Code
     C                     Z-ADDP3JFDT    WBELDT           Production Date
      * Establish starting position
     C           KPSSB     SETLL@B7CPPM                    *
     C           KRSSB     READE@B7CPPM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0344' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0002           Qty Produced
     C                     Z-ADD*ZERO     YL0003           Qty Prod Adjust
     C                     Z-ADD*ZERO     YL0004           Qty Produced 2
     C                     Z-ADD*ZERO     YL0005           Qty Prod Adjust
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Production Date GE PAR.Date From             USR
      *   |- c2    : DB1.Production Date LE PAR.Date To               USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WBELDT    IFGE P2JEDT                     *IF
     C           WBELDT    IFLE P3JFDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Production Date Break- create workf record
      * CASE: DB1.Production Date NE LCL.Production Date
     C           WBELDT    IFNE YL0006                     *IF
      * CASE: LCL.Production Date is entered
     C           YL0006    IFNE *ZERO                      *IF
      * Crt WF ISC Trans Sum  CR - WF ISC Trans Sum/Pkg Var  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0006    WL0001           ISC Week Ending
     C                     Z-ADDWBAIC3    WL0002           ISC Warehouse C
     C                     MOVEL'GP1'     WL0003    P      ISC Warehouse C
     C                     Z-ADDYL0007    WL0004           ISC Item Code
     C                     Z-ADD*ZERO     WL0005           ISC Beg Inv Fin
     C                     Z-ADD*ZERO     WL0006           ISC End Inv Fin
     C                     Z-ADD*ZERO     WL0007           ISC Beg Inv Fin
     C                     Z-ADD*ZERO     WL0008           ISC End Inv Fin
     C                     Z-ADD*ZERO     WL0009           ISC Unsh/Ship I
     C                     Z-ADD*ZERO     WL0010           ISC Unsh/Ship I
     C                     Z-ADD*ZERO     WL0011           ISC Sun Shp Inv
     C                     Z-ADD*ZERO     WL0012           ISC Sun Shp Inv
     C                     Z-ADD*ZERO     WL0013           WF Estimated En
     C                     Z-ADD*ZERO     WL0014           WF Estimated En
     C                     Z-ADD*ZERO     WL0015           WF ISC Part/Rej
     C                     Z-ADD*ZERO     WL0016           WF ISC Part/Rej
     C                     Z-ADD*ZERO     WL0017           WF Trans Total
     C                     Z-ADD*ZERO     WL0018           WF Trans total
     C                     Z-ADD*ZERO     WL0019           WF Trans Total
     C                     Z-ADD*ZERO     WL0020           WF Trans total
     C                     Z-ADD*ZERO     WL0021           WF Trans Total
     C                     Z-ADD*ZERO     WL0022           WF Trans total
     C                     Z-ADDYL0002    WL0023           WF Trans Total
     C                     Z-ADDYL0005    WL0024           WF Trans Total
     C                     Z-ADD*ZERO     WL0025           WF Trans total
     C                     Z-ADD*ZERO     WL0026           WF Trans total
     C                     Z-ADDYL0003    WL0027           WF Trans Total
     C                     Z-ADD*ZERO     WL0028           WF Trans total
     C                     Z-ADD*ZERO     WL0029           WF ISC Floor Pr
     C                     Z-ADD*ZERO     WL0030           WF ISC Floor Pr
     C                     Z-ADD*ZERO     WL0031           WF ISC Part/Rej
     C                     Z-ADDYL0004    WL0032           WF ISC Part/Rej
     C                     Z-ADD*ZERO     WL0033           WF ISC End Inv
     C                     Z-ADD*ZERO     WL0034           WF ISC End Inv
     C                     Z-ADD*ZERO     WL0035           WF Lst End Inv
     C                     Z-ADD*ZERO     WL0036           WF Lst End Inv
     C                     Z-ADD*ZERO     WL0037           WF Lst Sun Shp
     C                     Z-ADD*ZERO     WL0038           WF Lst Sun Shp
     C                     Z-ADD*ZERO     WL0039           WF Lst Unsh/Shi
     C                     Z-ADD*ZERO     WL0040           WF Lst Unsh/Shi
     C                     Z-ADD*ZERO     WL0041           WF Trans Total
     C                     Z-ADD*ZERO     WL0042           WF Trans Total
     C                     Z-ADD*ZERO     WL0043           WF Trans Total
     C                     Z-ADD*ZERO     WL0044           WF Trans Total
     C                     Z-ADD*ZERO     WL0045           WF Unused Lbs 3
     C                     Z-ADD*ZERO     WL0046           WF Unused Qty 3
     C                     EXSR SCCRRC
     C                     END                             *FI
     C                     Z-ADDWBELDT    YL0006           Production Date
     C                     Z-ADDWBHGCD    YL0007           Item Code
     C                     Z-ADD*ZERO     YL0002           Qty Produced
     C                     Z-ADD*ZERO     YL0004           Qty Produced 2
     C                     Z-ADD*ZERO     YL0003           Qty Prod Adjust
     C                     Z-ADD*ZERO     YL0005           Qty Prod Adjust
     C                     END                             *FI
      * CASE:
      *  - c1OR(c2ANDc3)
      *   |- c1    : PAR.Status - Y or N is Not Yes
      *   |- c2    : PAR.Status - Y or N is yes
      *   |- c3    : DB1.Transaction Date Code GT PAR.Date To
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P4B8ST    IFEQ *BLANK                     *IF
     C           P4B8ST    OREQ 'N'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           P4B8ST    IFEQ 'Y'                        *IF
     C           WBB4DT    IFGT P3JFDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Accum RR/AP/A/RR-
      * CASE: DB1.Inventory Trans. Type is Receipt Production
     C           WBBSST    IFEQ 'RR'                       *IF
      * CASE: DB1.Transaction Quantity is Greater than zero
     C           WBA5QT    IFGT *ZERO                      *IF
     C                     ADD  WBA5QT    YL0002           Qty Produced
     C                     ELSE
      * CASE: *OTHERWISE
      * rework are -RR
     C                     ADD  WBA5QT    YL0004           Qty Produced 2
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.Inventory Trans. Type is Adjustment Physical
     C           WBBSST    IFEQ 'AP'                       *IF
     C                     ADD  WBA5QT    YL0003           Qty Prod Adjust
     C                     ELSE
      * CASE: DB1.Inventory Trans. Type is Adjustment Quantity
     C           WBBSST    IFEQ 'A'                        *IF
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.Reason Code is I03: Add
      *   |- c2    : DB1.Reason Code is I04: Shipping Add
      *   '-
     C           WBCQCD    IFEQ 'ADD'                      *IF
     C           WBCQCD    OREQ 'SAD'                      *OR
      * E00458 RMC 7/29/09 Add these to production accum
     C                     ADD  WBA5QT    YL0002           Qty Produced
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  WBA5QT    YL0005           Qty Prod Adjust
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Write last rcd
      * CASE:
      *  - c1ORc2ORc3ORc4
      *   |- c1    : PAR.Qty Produced          USR is Entered
      *   |- c2    : PAR.Qty Prod Adjusted 1 USR is NE Zero
      *   |- c3    : PAR.Qty Produced 2        USR is NE 0
      *   |- c4    : PAR.Qty Prod Adjusted 2 USR is NE Zero
      *   '-
     C           YL0002    IFGT 0                          *IF
     C           YL0003    ORNE *ZERO                      *OR
     C           YL0004    ORNE *ZERO                      *OR
     C           YL0005    ORNE *ZERO                      *OR
      * Crt WF ISC Trans Sum  CR - WF ISC Trans Sum/Pkg Var  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0006    WL0001           ISC Week Ending
     C                     Z-ADDWBAIC3    WL0002           ISC Warehouse C
     C                     MOVEL'GP1'     WL0003    P      ISC Warehouse C
     C                     Z-ADDYL0007    WL0004           ISC Item Code
     C                     Z-ADD*ZERO     WL0005           ISC Beg Inv Fin
     C                     Z-ADD*ZERO     WL0006           ISC End Inv Fin
     C                     Z-ADD*ZERO     WL0007           ISC Beg Inv Fin
     C                     Z-ADD*ZERO     WL0008           ISC End Inv Fin
     C                     Z-ADD*ZERO     WL0009           ISC Unsh/Ship I
     C                     Z-ADD*ZERO     WL0010           ISC Unsh/Ship I
     C                     Z-ADD*ZERO     WL0011           ISC Sun Shp Inv
     C                     Z-ADD*ZERO     WL0012           ISC Sun Shp Inv
     C                     Z-ADD*ZERO     WL0013           WF Estimated En
     C                     Z-ADD*ZERO     WL0014           WF Estimated En
     C                     Z-ADD*ZERO     WL0015           WF ISC Part/Rej
     C                     Z-ADD*ZERO     WL0016           WF ISC Part/Rej
     C                     Z-ADD*ZERO     WL0017           WF Trans Total
     C                     Z-ADD*ZERO     WL0018           WF Trans total
     C                     Z-ADD*ZERO     WL0019           WF Trans Total
     C                     Z-ADD*ZERO     WL0020           WF Trans total
     C                     Z-ADD*ZERO     WL0021           WF Trans Total
     C                     Z-ADD*ZERO     WL0022           WF Trans total
     C                     Z-ADDYL0002    WL0023           WF Trans Total
     C                     Z-ADDYL0005    WL0024           WF Trans Total
     C                     Z-ADD*ZERO     WL0025           WF Trans total
     C                     Z-ADD*ZERO     WL0026           WF Trans total
     C                     Z-ADDYL0003    WL0027           WF Trans Total
     C                     Z-ADD*ZERO     WL0028           WF Trans total
     C                     Z-ADD*ZERO     WL0029           WF ISC Floor Pr
     C                     Z-ADD*ZERO     WL0030           WF ISC Floor Pr
     C                     Z-ADD*ZERO     WL0031           WF ISC Part/Rej
     C                     Z-ADDYL0004    WL0032           WF ISC Part/Rej
     C                     Z-ADD*ZERO     WL0033           WF ISC End Inv
     C                     Z-ADD*ZERO     WL0034           WF ISC End Inv
     C                     Z-ADD*ZERO     WL0035           WF Lst End Inv
     C                     Z-ADD*ZERO     WL0036           WF Lst End Inv
     C                     Z-ADD*ZERO     WL0037           WF Lst Sun Shp
     C                     Z-ADD*ZERO     WL0038           WF Lst Sun Shp
     C                     Z-ADD*ZERO     WL0039           WF Lst Unsh/Shi
     C                     Z-ADD*ZERO     WL0040           WF Lst Unsh/Shi
     C                     Z-ADD*ZERO     WL0041           WF Trans Total
     C                     Z-ADD*ZERO     WL0042           WF Trans Total
     C                     Z-ADD*ZERO     WL0043           WF Trans Total
     C                     Z-ADD*ZERO     WL0044           WF Trans Total
     C                     Z-ADD*ZERO     WL0045           WF Unused Lbs 3
     C                     Z-ADD*ZERO     WL0046           WF Unused Qty 3
     C                     EXSR SCCRRC
     C                     END                             *FI
     C                     GOTO SBEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSB     READE@B7CPPM                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCRRC    BEGSR
      *================================================================
      * Crt WF ISC Trans Sum  CR - WF ISC Trans Sum/Pkg Var  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @ALCPJB
     C                     Z-ADDWL0001    WCAIDX           ISC Week Ending
     C                     Z-ADDWL0002    WCB2C3           ISC Warehouse C
     C                     MOVELWL0003    WCGRAA           ISC Warehouse C
     C                     Z-ADDWL0004    WCEJC7           ISC Item Code
     C                     Z-ADDWL0005    WCMQWG           ISC Beg Inv Fin
     C                     Z-ADDWL0006    WCM5WG           ISC End Inv Fin
     C                     Z-ADDWL0007    WCOEQT           ISC Beg Inv Fin
     C                     Z-ADDWL0008    WCOTQT           ISC End Inv Fin
     C                     Z-ADDWL0009    WCM2WG           ISC Unsh/Ship I
     C                     Z-ADDWL0010    WCOQQT           ISC Unsh/Ship I
     C                     Z-ADDWL0011    WCM1WG           ISC Sun Shp Inv
     C                     Z-ADDWL0012    WCOPQT           ISC Sun Shp Inv
     C                     Z-ADDWL0013    WCNOWG           WF Estimated En
     C                     Z-ADDWL0014    WCOYQT           WF Estimated En
     C                     Z-ADDWL0015    WCNPWG           WF ISC Part/Rej
     C                     Z-ADDWL0016    WCOZQT           WF ISC Part/Rej
     C                     Z-ADDWL0017    WCNQWG           WF Trans Total
     C                     Z-ADDWL0018    WCNRWG           WF Trans total
     C                     Z-ADDWL0019    WCNSWG           WF Trans Total
     C                     Z-ADDWL0020    WCNTWG           WF Trans total
     C                     Z-ADDWL0021    WCNUWG           WF Trans Total
     C                     Z-ADDWL0022    WCNVWG           WF Trans total
     C                     Z-ADDWL0023    WCO4QT           WF Trans Total
     C                     Z-ADDWL0024    WCO0QT           WF Trans Total
     C                     Z-ADDWL0025    WCO5QT           WF Trans total
     C                     Z-ADDWL0026    WCO1QT           WF Trans total
     C                     Z-ADDWL0027    WCO2QT           WF Trans Total
     C                     Z-ADDWL0028    WCO3QT           WF Trans total
     C                     Z-ADDWL0029    WCNWWG           WF ISC Floor Pr
     C                     Z-ADDWL0030    WCO6QT           WF ISC Floor Pr
     C                     Z-ADDWL0031    WCNXWG           WF ISC Part/Rej
     C                     Z-ADDWL0032    WCO7QT           WF ISC Part/Rej
     C                     Z-ADDWL0033    WCNYWG           WF ISC End Inv
     C                     Z-ADDWL0034    WCO8QT           WF ISC End Inv
     C                     Z-ADDWL0035    WCNZWG           WF Lst End Inv
     C                     Z-ADDWL0036    WCO9QT           WF Lst End Inv
     C                     Z-ADDWL0037    WCN0WG           WF Lst Sun Shp
     C                     Z-ADDWL0038    WCPAQT           WF Lst Sun Shp
     C                     Z-ADDWL0039    WCN1WG           WF Lst Unsh/Shi
     C                     Z-ADDWL0040    WCPBQT           WF Lst Unsh/Shi
     C                     Z-ADDWL0041    WCN2WG           WF Trans Total
     C                     Z-ADDWL0042    WCPCQT           WF Trans Total
     C                     Z-ADDWL0043    WCN3WG           WF Trans Total
     C                     Z-ADDWL0044    WCPDQT           WF Trans Total
     C                     Z-ADDWL0045    WCN4WG           WF Unused Lbs 3
     C                     Z-ADDWL0046    WCPEQT           WF Unused Qty 3
      *
     C           KLCRSC    KLIST
     C                     KFLD           WCAIDX           ISC Week Ending
     C                     KFLD           WCB2C3           ISC Warehouse C
     C                     KFLD           WCGRAA           ISC Warehouse C
     C                     KFLD           WCEJC7           ISC Item Code
      * Check for duplicate primary key
     C           KLCRSC    SETLL@ALCPJB                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3696' W0RTN   7
      * Send message 'WF ISC Trans Sum/Pkg V EX'
     C                     MOVEL'USR3696' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C                     WRITE@ALCPJB                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAM1QT           Packaging Item
     C                     Z-ADD*ZERO     WAMJDT           Create Date
     C                     Z-ADD*ZERO     WABETM           Create Time
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WBC4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     WBDXNB           Sequence Number
     C                     Z-ADD*ZERO     WBELDT           Production Date
     C                     Z-ADD*ZERO     WBA5QT           Transaction Qua
     C                     Z-ADD*ZERO     WBAHWG           Transaction Wei
     C                     Z-ADD*ZERO     WBAKCS           USR Transaction
     C                     Z-ADD*ZERO     WBAYVA           Extended Amount
     C                     Z-ADD*ZERO     WBCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WBTRBN           Transfer Batch
     C                     Z-ADD*ZERO     WBTRBS           Transfer Batch
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBAWTM           Production Time
     C                     Z-ADD*ZERO     WBK7DT           Label Date
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIDX           ISC Week Ending
     C                     Z-ADD*ZERO     WCB2C3           ISC Warehouse C
     C                     Z-ADD*ZERO     WCEJC7           ISC Item Code
     C                     Z-ADD*ZERO     WCMQWG           ISC Beg Inv Fin
     C                     Z-ADD*ZERO     WCM5WG           ISC End Inv Fin
     C                     Z-ADD*ZERO     WCOEQT           ISC Beg Inv Fin
     C                     Z-ADD*ZERO     WCOTQT           ISC End Inv Fin
     C                     Z-ADD*ZERO     WCM2WG           ISC Unsh/Ship I
     C                     Z-ADD*ZERO     WCOQQT           ISC Unsh/Ship I
     C                     Z-ADD*ZERO     WCM1WG           ISC Sun Shp Inv
     C                     Z-ADD*ZERO     WCOPQT           ISC Sun Shp Inv
     C                     Z-ADD*ZERO     WCNOWG           WF Estimated En
     C                     Z-ADD*ZERO     WCOYQT           WF Estimated En
     C                     Z-ADD*ZERO     WCNPWG           WF ISC Part/Rej
     C                     Z-ADD*ZERO     WCOZQT           WF ISC Part/Rej
     C                     Z-ADD*ZERO     WCNQWG           WF Trans Total
     C                     Z-ADD*ZERO     WCNRWG           WF Trans total
     C                     Z-ADD*ZERO     WCNSWG           WF Trans Total
     C                     Z-ADD*ZERO     WCNTWG           WF Trans total
     C                     Z-ADD*ZERO     WCNUWG           WF Trans Total
     C                     Z-ADD*ZERO     WCNVWG           WF Trans total
     C                     Z-ADD*ZERO     WCO4QT           WF Trans Total
     C                     Z-ADD*ZERO     WCO0QT           WF Trans Total
     C                     Z-ADD*ZERO     WCO5QT           WF Trans total
     C                     Z-ADD*ZERO     WCO1QT           WF Trans total
     C                     Z-ADD*ZERO     WCO2QT           WF Trans Total
     C                     Z-ADD*ZERO     WCO3QT           WF Trans total
     C                     Z-ADD*ZERO     WCNWWG           WF ISC Floor Pr
     C                     Z-ADD*ZERO     WCO6QT           WF ISC Floor Pr
     C                     Z-ADD*ZERO     WCNXWG           WF ISC Part/Rej
     C                     Z-ADD*ZERO     WCO7QT           WF ISC Part/Rej
     C                     Z-ADD*ZERO     WCNYWG           WF ISC End Inv
     C                     Z-ADD*ZERO     WCO8QT           WF ISC End Inv
     C                     Z-ADD*ZERO     WCNZWG           WF Lst End Inv
     C                     Z-ADD*ZERO     WCO9QT           WF Lst End Inv
     C                     Z-ADD*ZERO     WCN0WG           WF Lst Sun Shp
     C                     Z-ADD*ZERO     WCPAQT           WF Lst Sun Shp
     C                     Z-ADD*ZERO     WCN1WG           WF Lst Unsh/Shi
     C                     Z-ADD*ZERO     WCPBQT           WF Lst Unsh/Shi
     C                     Z-ADD*ZERO     WCN2WG           WF Trans Total
     C                     Z-ADD*ZERO     WCPCQT           WF Trans Total
     C                     Z-ADD*ZERO     WCN3WG           WF Trans Total
     C                     Z-ADD*ZERO     WCPDQT           WF Trans Total
     C                     Z-ADD*ZERO     WCN4WG           WF Unused Lbs 3
     C                     Z-ADD*ZERO     WCPEQT           WF Unused Qty 3
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCCRRC.
     C                     Z-ADD*ZERO     WL0001  80
     C                     Z-ADD*ZERO     WL0002  30
     C                     MOVEL*BLANK    WL0003  3
     C                     Z-ADD*ZERO     WL0004  70
     C                     Z-ADD*ZERO     WL0005 112
     C                     Z-ADD*ZERO     WL0006 112
     C                     Z-ADD*ZERO     WL0007 112
     C                     Z-ADD*ZERO     WL0008 112
     C                     Z-ADD*ZERO     WL0009 112
     C                     Z-ADD*ZERO     WL0010 112
     C                     Z-ADD*ZERO     WL0011 112
     C                     Z-ADD*ZERO     WL0012 112
     C                     Z-ADD*ZERO     WL0013 112
     C                     Z-ADD*ZERO     WL0014 112
     C                     Z-ADD*ZERO     WL0015 112
     C                     Z-ADD*ZERO     WL0016 112
     C                     Z-ADD*ZERO     WL0017 112
     C                     Z-ADD*ZERO     WL0018 112
     C                     Z-ADD*ZERO     WL0019 112
     C                     Z-ADD*ZERO     WL0020 112
     C                     Z-ADD*ZERO     WL0021 112
     C                     Z-ADD*ZERO     WL0022 112
     C                     Z-ADD*ZERO     WL0023 112
     C                     Z-ADD*ZERO     WL0024 112
     C                     Z-ADD*ZERO     WL0025 112
     C                     Z-ADD*ZERO     WL0026 112
     C                     Z-ADD*ZERO     WL0027 112
     C                     Z-ADD*ZERO     WL0028 112
     C                     Z-ADD*ZERO     WL0029 112
     C                     Z-ADD*ZERO     WL0030 112
     C                     Z-ADD*ZERO     WL0031 112
     C                     Z-ADD*ZERO     WL0032 112
     C                     Z-ADD*ZERO     WL0033 112
     C                     Z-ADD*ZERO     WL0034 112
     C                     Z-ADD*ZERO     WL0035 112
     C                     Z-ADD*ZERO     WL0036 112
     C                     Z-ADD*ZERO     WL0037 112
     C                     Z-ADD*ZERO     WL0038 112
     C                     Z-ADD*ZERO     WL0039 112
     C                     Z-ADD*ZERO     WL0040 112
     C                     Z-ADD*ZERO     WL0041 112
     C                     Z-ADD*ZERO     WL0042 112
     C                     Z-ADD*ZERO     WL0043 112
     C                     Z-ADD*ZERO     WL0044 112
     C                     Z-ADD*ZERO     WL0045 112
     C                     Z-ADD*ZERO     WL0046 112
      * Define local work field Item Code
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field Qty Produced          USR
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field Qty Prod Adjusted 1 USR
     C                     Z-ADD*ZERO     YL0003  50
      * Define local work field Qty Produced 2        USR
     C                     Z-ADD*ZERO     YL0004  70
      * Define local work field Qty Prod Adjusted 2 USR
     C                     Z-ADD*ZERO     YL0005  50
      * Define local work field Production Date
     C                     Z-ADD*ZERO     YL0006  70
      * Define local work field Item Code
     C                     Z-ADD*ZERO     YL0007  70
      *================================================================
     CSR         ZZEXIT    ENDSR
