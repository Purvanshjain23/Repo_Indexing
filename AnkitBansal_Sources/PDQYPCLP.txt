/********************************************************************/
/*                                                                  */
/*  SYNOPSIS - PRINT CREDIT/DEBIT MEMO                              */
/*                                                                  */
/*  SYSTEM    - ORDER MANAGEMENT SYSTEM                             */
/*  PROGRAM   - PRINT CREDIT/DEBIT MEMO                             */
/*  DATE      -  6/09/95                                            */
/*                                                                  */
/*      PARAMETERS RECEIVED:                                        */
/*                                                                  */
/*          &COMPNYN    - COMPANY NUMBER - BLANK FOR ALL            */
/*          &ORDN       - FROM ORDER                                */
/*          &OUTQ       - OUTPUT QUEUE                              */
/*          &HOLD       - HOLD PRINT                                */
/*          &SAVE       - SAVE PRINT                                */
/*          &COPYN      - NUMBER OF COPIES                          */
/*          &NIGHTQ     - NIGHT OUTPUT QUEUE                        */
/*  12/20/96 PLL ADDED OVERRIDES DUE TO PROBLEM WITH IMPLEMENTER    */
/*  05/29/01 RMC  CHANGE FORM LENGTH TO 88 AND PORTRAIT             */
/*  05/10/05 RMC  PRINT MEMOS FROM DRAWER(3) IF PRKPRT02            */
/*  05/17/05 RMC  DO THE ABOVE IF PRKPRT02                          */
/*  SLM 06/25/07  Add logic for Standard/Custom Invoices            */
/*                add logic for generic company document file       */
/*                for the custom invoice program                    */
/*                and for the custom invoice overlay                */
/*                Add logic If record found of INCST1               */
/*                THEN perform the custom invoice routine           */
/*                we also have to perform this custom invoice       */
/*                prgram 3 times one for customer copy              */
/*                orginal copy, and office copy                     */
/*  RMC 05/30/08  Change to print HPB MEMO which uses an overlay    */
/*                SAME PGM AS HPB INVOICE PRINT                     */
/*  LJB 04/16/10  P000198  ADDED PROGRAM TO DELETE THE PDJ4CPP      */
/*                WORK FILE RECORD                                  */
/********************************************************************/
 PDQYPCLP:   PGM        PARM(&COMPNYN &ORDN &APPLIC &OUTQ &HOLD +
                          &SAVE &COPYN &NIGHTQ)

/* PARMS                                                                      */
        DCL    &COMPNYN    *DEC                  /* Company Number (Passed)   */
        DCL    &ORDN       *DEC                  /* Order Number   (Passed)   */
        DCL    &APPLIC     *CHAR   (10)          /* Application Code          */
        DCL    &OUTQ       *CHAR   (10)          /* Output Queue              */
        DCL    &HOLD       *CHAR   (4)           /* Hold Status               */
        DCL    &SAVE       *CHAR   (4)           /* Save Status               */
        DCL    &COPYN      *DEC                  /* No. of Copies  (Passed)   */
        DCL    &NIGHTQ     *CHAR   (10)          /* Night Job Queue           */
        DCL    &COMMAND    *CHAR   (512)

/* INTERNAL FIELDS                                                            */
        DCL    &COPY       *DEC    (2 0)         /* Number of copies          */
        DCL    &COMPANY    *DEC    (3 0)         /* Company Number            */
        DCL    &ORDR       *DEC    (7 0)         /* Order Number              */
/********************************************************************/
/* GET CUSTOM INVOICE DOCUMENT OVERLAY INFORMATION                  */
/* PARMS FOR THE RETRIEVE OVERLAY PARAMETERS PROGRAM                */
/********************************************************************/
             DCL        VAR(&TYPE) TYPE(*CHAR) LEN(2)
             DCL        VAR(&DEPT) TYPE(*CHAR) LEN(6)
             DCL        VAR(&OVERLAY) TYPE(*CHAR) LEN(8)
             DCL        VAR(&CDDPGM) TYPE(*CHAR) LEN(10)
             DCL        VAR(&CDDFILE) TYPE(*CHAR) LEN(10)
             DCL        VAR(&ADDLOBJ) TYPE(*CHAR) LEN(10)
             DCL        VAR(&SENDPHONE) TYPE(*CHAR) LEN(10)
             DCL        VAR(&SENDFAX) TYPE(*CHAR) LEN(10)
             DCL        VAR(&OVOUTQ) TYPE(*CHAR) LEN(10)
             DCL        VAR(&OVHOLD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&OVSAVE) TYPE(*CHAR) LEN(4)
             DCL        VAR(&DRAWER) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&PRTDEVTYPE) TYPE(*CHAR) LEN(10)
             DCL        VAR(&LENGTH) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&WIDTH) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&CPI) TYPE(*DEC) LEN(3 1)
             DCL        VAR(&LPI) TYPE(*DEC) LEN(2 0)
             DCL        VAR(&OVERFLOW) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&ROTATE) TYPE(*CHAR) LEN(5)
             DCL        VAR(&COMMENT1) TYPE(*CHAR) LEN(50)
             DCL        VAR(&COMMENT2) TYPE(*CHAR) LEN(50)
             DCL        VAR(&COMMENT3) TYPE(*CHAR) LEN(50)
             DCL        VAR(&COMMENT4) TYPE(*CHAR) LEN(50)
             DCL        VAR(&COMMENT5) TYPE(*CHAR) LEN(50)
             DCL        VAR(&RECSTS) TYPE(*CHAR) LEN(1)
             DCL        VAR(&JOBNME) TYPE(*CHAR) LEN(10) /* Job Name */

/********************************************************************/
/* CHANGE VARIABLES FOR USE IN PROGRAM                              */
/********************************************************************/
             CHGVAR     VAR(&COMPANY) VALUE(&COMPNYN)
             CHGVAR     VAR(&ORDR) VALUE(&ORDN)
             CHGVAR     VAR(&COPY) VALUE(&COPYN)

/********************************************************************/
/* Determine if we have a Standard Invoice or a Custom Invoice      */
/* The Custom Invoice will have a overlay                           */
/* At this time the Standard Invoice does not have a overlay        */
/********************************************************************/
/* CALL THE GENERIC RETRIEVE COMPANY DOCUMENT DEFAULTS FIELDS       */
/* PROGRAM. COMPANY, TYPE, DEPARTMENT, AND OVERLAY NAME ARE         */
/* INPUT RESTRICTED, THE REST ARE OUTPUT PARMS.                     */
/*----------------------------------------------------------------- */
/*-  Custom Invoice                                              -- */
/*-  If found then do not print the standard invoice             -- */
/*----------------------------------------------------------------- */
             CHGVAR     VAR(&TYPE) VALUE('IN') /* INVOICE */
             CHGVAR     VAR(&DEPT) VALUE('INCST1') /* CUSTOM +
                          INVOICE */
/*----------------------------------------------------------------- */
             CALL       PGM(PMG9XFR) PARM(' ' &COMPANY &TYPE &DEPT +
                          &OVERLAY &CDDPGM &CDDFILE &ADDLOBJ +
                          &SENDPHONE &SENDFAX &OVOUTQ &OVHOLD +
                          &OVSAVE &DRAWER &PRTDEVTYPE &LENGTH +
                          &WIDTH &LPI &CPI &OVERFLOW &ROTATE +
                          &COMMENT1 &COMMENT2 &COMMENT3 &COMMENT4 +
                          &COMMENT5 &RECSTS)

             IF         COND(&OUTQ *EQ '     ') THEN(CHGVAR +
                          VAR(&OUTQ) VALUE(&OVOUTQ))

             IF         COND(&HOLD *EQ '     ') THEN(CHGVAR +
                          VAR(&OUTQ) VALUE(&OVHOLD))

             IF         COND(&SAVE *EQ '     ') THEN(CHGVAR +
                          VAR(&OUTQ) VALUE(&OVSAVE))

             IF         COND(&OUTQ *EQ 'PRKPRT02') THEN(OVRPRTF +
                          FILE(PDR4PFR$) PAGESIZE(88 125) LPI(8) +
                          CPI(15) OVRFLW(82) DRAWER(3) OUTQ(&OUTQ) +
                          FORMTYPE(*INV) COPIES(&COPY) HOLD(&HOLD) +
                          SAVE(&SAVE))

             ELSE       CMD(OVRPRTF FILE(PDR4PFR$) PAGESIZE(88 125) +
                          LPI(8) CPI(15) OVRFLW(82) DRAWER(1) +
                          OUTQ(&OUTQ) FORMTYPE(*INV) COPIES(&COPY) +
                          HOLD(&HOLD) SAVE(&SAVE))

   /*        IF         COND(&CDDPGM *EQ 'PMIVPFR') THEN(DO)        */
             IF         COND(&CDDPGM *NE '       ') THEN(DO)

             OVRPRTF    FILE(&CDDFILE) DEVTYPE(&PRTDEVTYPE) +
                          PAGESIZE(&LENGTH &WIDTH) LPI(&LPI) +
                          CPI(&CPI) OVRFLW(&OVERFLOW) +
                          DRAWER(&DRAWER) PAGRTT(&ROTATE) +
                          FRONTOVL(&OVERLAY) OUTQ(&OUTQ) +
                          HOLD(&HOLD) SAVE(&SAVE)
             ENDDO
/*********************************************************************/
/*   CALL PRINT PROGRAM -
/*********************************************************************/

 /*          IF         COND(&CDDPGM *NE 'PMIVPFR') THEN(DO)  */
             IF         COND(&CDDPGM *EQ '       ') THEN(DO)
             CALL       PGM(PDR4PFR) PARM(' ' &COMPANY &ORDR 'N')
                        ENDDO

/* CUSTOM INVOICE PROGRAM   - dailys                                */
             IF         COND(&CDDPGM *EQ 'PMIVPFR') THEN(DO)

/* Customer copy                                                    */
             CALL         PGM(PMIVPFR) PARM(' ' &COMPANY &ORDR +
                          'R' 'CS' &JOBNME)
/* Office copy                                                      */
             CALL         PGM(PMIVPFR) PARM(' ' &COMPANY &ORDR +
                          'R' 'OF' &JOBNME)
/* Orginal copy                                                     */
             CALL         PGM(PMIVPFR) PARM(' ' &COMPANY &ORDR +
                          'R' 'OR' &JOBNME)
             ENDDO

hpbinv:      IF         COND(&CDDPGM *EQ 'PMRCPFR') THEN(DO)
             CALL         PGM(PMRCPFR) PARM(' ' &COMPANY &ORDR +
                          'N')
                        ENDDO

/* DELETE WORK FILE RECORD                                          */
             CALL       PGM(PPUPXFR) PARM(' ' &JOBNME)

 END:        ENDPGM
