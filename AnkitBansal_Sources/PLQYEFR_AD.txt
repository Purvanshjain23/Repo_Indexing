// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PLQYEFR
// ?Date: 14.08.2025 Time: 02:55:13
// ?------------------------------------------------------------------------------------------------

//?USER: Initialize program

// Execute function Mov ApplN to Company  US.
EXECUTE FUNCTION(Mov ApplN to Company  US) TYPE(EXCUSRSRC) ('PKMFUFR');
PARAMETER(PAR.Oms_System_Value_Alpha);
{
 C***   MOVE USER SOURCE                      ***
 C                     MOVEL#IEVTX    ##CMP
}


//?USER: Initialize subfile header

// CTL.Sel Line 1 Usr = CON.4=Delete Line
CTL.Sel_Line_1_Usr = '4=Delete Line';

// CTL.Sel Line 2 Usr = CON.*BLANK
CTL.Sel_Line_2_Usr = *BLANK;

CASE;

// IF PAR.COPR Value is TRKNOATTXT
IF PAR.COPR_Value = 'TRKNOATTXT';

// CTL.Sel Line 2 Usr = CONCAT(CON.Cell Phone & Carrier No:,CON.Contact:,CON.35)
CTL.Sel_Line_2_Usr = 'Cell Phone & Carrier No:' + 'Contact:' (35);

// IF *OTHERWISE
IF *OTHERWISE;

// CTL.Sel Line 2 Usr = CONCAT(CON.Email:,CON.Contact:,CON.50)
CTL.Sel_Line_2_Usr = 'Email:' + 'Contact:' (50);

ENDIF;

//?USER: Initialize subfile record (new record)

// RCD.RS Record Status = CND.Active
RCD.RS_Record_Status = 'A';

//?USER: Create DBF record

EXECUTE FUNCTION(Crt Company Process VaIF) TYPE(EXCINTFUN) FILE(PLBFREP)        AB1304970;
PARAMETER(RCD.CC_Company_Number);
PARAMETER(RCD.COPR_Value);
PARAMETER(RCD.CPVD_Sequence);
PARAMETER(RCD.CPVD_Email_Line);
PARAMETER(RCD.CPVD_Description);
{
 //?Execute internal function

 EXECUTE FUNCTION(Rtv EmlDtlNxtLneNo     RT) TYPE(RTVOBJ) FILE(PLBFREP)          AB1304973;
 PARAMETER(PAR.CC_Company_Number);
 PARAMETER(PAR.COPR_Value);
 PARAMETER(LCL.CPVD_Sequence);
 {
  //?USER: Processing if Data record not found

  // PAR.CPVD Sequence = CON.1
  PAR.CPVD_Sequence = 1;

  //?USER: Process Data record

  // PAR.CPVD Sequence = DB1.CPVD Sequence + CON.1
  PAR.CPVD_Sequence = DB1.CPVD_Sequence + 1;

  QUIT;

 }

 EXECUTE FUNCTION(Crt Company Process VaCO) TYPE(CRTOBJ) FILE(PLBFREP)           AB1304863;
 PARAMETER(PAR.CC_Company_Number);
 PARAMETER(PAR.COPR_Value);
 PARAMETER(LCL.CPVD_Sequence);
 PARAMETER(PAR.CPVD_Email_Line);
 PARAMETER(PAR.CPVD_Description);
 PARAMETER('A');
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Rtv Add Stamp-Sys Dt  IF) TYPE(EXCINTFUN)                      AB1237005;
  PARAMETER(DB1.RS_Record_Status);
  PARAMETER(DB1.RS_Job);
  PARAMETER(DB1.RS_Program);
  PARAMETER(DB1.RS_User_Added);
  PARAMETER(DB1.RS_Date_Added);
  PARAMETER(DB1.RS_Time_Added);
  {
   //?Execute internal function

   // PAR.RS Record Status = CND.Active
   PAR.RS_Record_Status = 'A';

   // PAR.RS User Added = JOB.*USER
   PAR.RS_User_Added = JOB.*USER;

   // Call program Rtv System Date & Tim UP.
   CALL PROGRAM(Rtv System Date & Tim UP) ('PKWDUPC');
   PARAMETER(PAR.RS_Date_Added);
   PARAMETER(PAR.RS_Time_Added);

   // PAR.RS Program = JOB.*PROGRAM
   PAR.RS_Program = JOB.*PROGRAM;

   // PAR.RS Job = JOB.*JOB
   PAR.RS_Job = JOB.*JOB;

  }

 }

}


//?USER: Delete DBF record

EXECUTE FUNCTION(Del Company Process VaDO) TYPE(DLTOBJ) FILE(PLBFREP)           AB1304865;
PARAMETER(RCD.CC_Company_Number);
PARAMETER(RCD.COPR_Value);
PARAMETER(RCD.CPVD_Sequence);

//?USER: Change DBF record

EXECUTE FUNCTION(Chg Company Process VaCH) TYPE(CHGOBJ) FILE(PLBFREP)           AB1304864;
PARAMETER(RCD.CC_Company_Number);
PARAMETER(RCD.COPR_Value);
PARAMETER(RCD.CPVD_Sequence);
PARAMETER(RCD.CPVD_Email_Line);
PARAMETER(RCD.CPVD_Description);
PARAMETER(RCD.RS_User_Changed);
PARAMETER(RCD.RS_Date_Changed);
PARAMETER(RCD.RS_Time_Changed);
PARAMETER(RCD.RS_Record_Status);
PARAMETER(RCD.RS_Job);
PARAMETER(RCD.RS_Program);
PARAMETER(RCD.RS_User_Added);
PARAMETER(RCD.RS_Date_Added);
PARAMETER(RCD.RS_Time_Added);
{
 //?USER: Processing before Data update

 EXECUTE FUNCTION(Rtv Change Stamp-SysDtIF) TYPE(EXCINTFUN)                      AB1237006;
 PARAMETER(DB1.RS_User_Changed);
 PARAMETER(DB1.RS_Date_Changed);
 PARAMETER(DB1.RS_Time_Changed);
 PARAMETER(DB1.RS_Job);
 PARAMETER(DB1.RS_Program);
 {
  //?Execute internal function

  // PAR.RS User Changed = JOB.*USER
  PAR.RS_User_Changed = JOB.*USER;

  // Call program Rtv System Date & Tim UP.
  CALL PROGRAM(Rtv System Date & Tim UP) ('PKWDUPC');
  PARAMETER(PAR.RS_Date_Changed);
  PARAMETER(PAR.RS_Time_Changed);

  // PAR.RS Job = JOB.*JOB
  PAR.RS_Job = JOB.*JOB;

  // PAR.RS Program = JOB.*PROGRAM
  PAR.RS_Program = JOB.*PROGRAM;

 }

}


