     H/TITLE Rtv Repay 4-Char Desc XF  Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISJBADE
     H* Date          : 06/28/21  Time  : 10:22:44
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  WP0001         S              1
     D  WP0002         S              1
     D  WP0003         S              1
     D  WP0004         S              4
     D  WP0005         S              8
     D  WP0006         S              4
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  YILE           S              1
     D  W0PMT          S              1
      /EJECT
      * Parameter declarations
     D P1PARM          DS
      * FLD: Tattoo Repayment Header
      * I :  TRH Repayment Status
     D  P1MASS                 1      1
     D P2PARM          DS
      * FLD: Tattoo Repayment Detail
      * I :  TRD Repayment Status
     D  P2MCSS                 1      1
     D P3PARM          DS
      * FLD: Tattoo Repayment Comment
      * I :  TRC Comment Type
     D  P3MKSS                 1      1
     D P4PARM          DS
      * O :  Tattoo Repay Hdr Sts Desc
     D  P4HUT1                 1      4
     D P5PARM          DS
      * O :  Tattoo Repay Dtl Sts Desc
     D  P5HVT1                 1      8
     D P6PARM          DS
      * O :  Tattoo Repay Com Typ Desc
     D  P6HWT1                 1      4
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
     C     P1MASS        PARM                    WP0001                         TRH Repayment S
     C     P2MCSS        PARM                    WP0002                         TRD Repayment S
     C     P3MKSS        PARM                    WP0003                         TRC Comment Typ
     C     P4HUT1        PARM      P4HUT1        WP0004                         Tattoo Repay Hd
     C     P5HVT1        PARM      P5HVT1        WP0005                         Tattoo Repay Dt
     C     P6HWT1        PARM      P6HWT1        WP0006                         Tattoo Repay Co
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Rtv Repay 4-Char Desc XF
      * Modification history
     C                   EXSR      UASUBR                                       Modification hi
      * Load Tattoo Repayment Header Status description
      * CASE: PAR.TRH Repayment Status is *ALL values
      * Load 4-character Header description
      * CASE: PAR.TRH Repayment Status is Created
     C                   IF        P1MASS = 'C' OR
     C                             P1MASS = 'I' OR
     C                             P1MASS = 'R' OR
     C                             P1MASS = 'X'
     C                   IF        P1MASS = 'C'
     C                   MOVEL     'Crtd'        P4HUT1                         Tattoo Repay Hd
     C                   ELSE
      * CASE: PAR.TRH Repayment Status is In Progress
     C                   IF        P1MASS = 'I'
     C                   MOVEL     'InPr'        P4HUT1                         Tattoo Repay Hd
     C                   ELSE
      * CASE: PAR.TRH Repayment Status is Repaid
     C                   IF        P1MASS = 'R'
     C                   MOVEL     'Repd'        P4HUT1                         Tattoo Repay Hd
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   ELSE
      * CASE: PAR.TRD Repayment Status is *ALL values
      * Load 4-character Detail description
      * CASE: PAR.TRD Repayment Status is Created
     C                   IF        P2MCSS = 'C' OR
     C                             P2MCSS = 'R' OR
     C                             P2MCSS = 'I' OR
     C                             P2MCSS = 'U' OR
     C                             P2MCSS = 'E' OR
     C                             P2MCSS = 'P' OR
     C                             P2MCSS = 'Q' OR
     C                             P2MCSS = 'D' OR
     C                             P2MCSS = 'X'
     C                   IF        P2MCSS = 'C'
     C                   EVAL      P5HVT1 = ' '                                 Tattoo Repay Dt
     C                   MOVEL     'Crtd'        P5HVT1                         Tattoo Repay Dt
     C                   ELSE
      * CASE: PAR.TRD Repayment Status is Unpaid
     C                   IF        P2MCSS = 'U'
     C                   EVAL      P5HVT1 = ' '                                 Tattoo Repay Dt
     C                   MOVEL     'UnPd'        P5HVT1                         Tattoo Repay Dt
     C                   ELSE
      * CASE: PAR.TRD Repayment Status is Edited
     C                   IF        P2MCSS = 'E'
     C                   EVAL      P5HVT1 = ' '                                 Tattoo Repay Dt
     C                   MOVEL     'Edtd'        P5HVT1                         Tattoo Repay Dt
     C                   ELSE
      * CASE: PAR.TRD Repayment Status is Repaid
     C                   IF        P2MCSS = 'R'
     C                   EVAL      P5HVT1 = ' '                                 Tattoo Repay Dt
     C                   MOVEL     'Repd'        P5HVT1                         Tattoo Repay Dt
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   ELSE
      * CASE: PAR.TRC Comment Type is System or User Comment
      * Load 4-character Comment Type description
      * CASE: PAR.TRC Comment Type is System Generated
     C                   IF        P3MKSS = 'S' OR
     C                             P3MKSS = 'U'
     C                   IF        P3MKSS = 'S'
     C                   EVAL      P6HWT1 = ' '                                 Tattoo Repay Co
     C                   MOVEL     'Sys'         P6HWT1                         Tattoo Repay Co
     C                   ELSE
      * CASE: PAR.TRC Comment Type is User Generated
     C                   IF        P3MKSS = 'U'
     C                   MOVEL     'User'        P6HWT1                         Tattoo Repay Co
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   UASUBR        BEGSR
      *================================================================
      * Modification history
      *================================================================
      *  5/25/2021 JBB SDN619 - Repayments by Business
      *                         Function created.  Input Repayment Status
      *                         value.  Return 4-character description.
      *================================================================
     CSR   UAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                   CALL      'Y2CPMSC'
     C                   PARM                    ##PGM
     C                   PARM      'Y'           YILE
      *
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
     C                   MOVEL     'N'           W0PMT
      *================================================================
     CSR   ZZEXIT        ENDSR
