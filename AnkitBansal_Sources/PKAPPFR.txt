     H/TITLE Prt Payment Edit/pst wrka Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by  : SYNON/2  Version:  1418
     H* Function type : Print file
      *
     H* Company       : HPEDEVMDL                     n
     H* System        : HPEDEVMDL
     H* User name     : ISRCENT
     H* Date          : 11/14/96  Time  : 14:08:57
     H* Copyright     : HPEDEVMDL                     n
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKBKCPL7IF  E           K        DISK
      * RSQ : Hog Voucher Header        Lst Vch Batch #
      *
     FPKA1CPLVIF  E           K        DISK
      * RSQ : Tattoo Header             Co/Prd/KlDte/Tto/Unpd
      *
     FPKAWCPL1IF  E           K        DISK
      * RTV : Buy Order Header          Retrieval index
      *
     FPKCDCPL1IF  E           K        DISK
      * RTV : Tattoo Ded/Add            Retrieval index
      *
     FPKBKCPL5IF  E           K        DISK
      * RSQ : Hog Voucher Header        Lst Vch Hdr #
      *
     FPKBFREL1IF  E           K        DISK
      * RTV : Producer Std Split        Retrieval index
      *
     FPKACREL1IF  E           K        DISK
      * RTV : Producer                  Retrieval index
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKDNCPL1IF  E           K        DISK
      * RTV : Tattoo Header EXT         Retrieval index
      *
     FPKBKCPL0IF  E           K        DISK
      * RTV : Hog Voucher Header        Retrieval index
      *
     FPKBFREL2IF  E           K        DISK
      * RSQ : Producer Std Split        Active Prdcr Splits
      *
     FPKAAREL0IF  E           K        DISK
      * RTV : Source                    Retrieval index
      *
     FPKBLCPL1IF  E           K        DISK
      * RTV : Hog Voucher Detail        Retrieval index
      *
     FPKC6CPL0IF  E           K        DISK                      A
      * UPD : Tattoo Header Driver      Update index
      *
     FPKBKCPL1UF  E           K        DISK                      A
      * UPD : Hog Voucher Header        Update index
      *
     FPKBLCPL0IF  E           K        DISK                      A
      * UPD : Hog Voucher Detail        Update index
      *
     FPKCACPL0IF  E           K        DISK                      A
      * UPD : Hog Voucher Split         Update index
      *
     FPKAPPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Prt Payment Edit/pst wrka Print file
      *
      * Long constants
     E                    @CN#    1   1  6   @CN    25
     I@BKCPJR
      * Hog Voucher Header        Lst Vch Hdr #
      * Renamed input format fields
     I              BKHNNB                          WAHNNB
     I              BKLWNB                          WALWNB
     I              BKG9NB                          WAG9NB
     I              BKLXNB                          WALXNB
     I              BKLYNB                          WALYNB
     I              BKCSST                          WACSST
     I              BKDKNB                          WADKNB
     I              BKA2DT                          WAA2DT
     I              BKCIPR                          WACIPR
     I              BKCJPR                          WACJPR
     I              BKCKPR                          WACKPR
     I              BKCLPR                          WACLPR
     I              BKCMPR                          WACMPR
     I              BKAUVA                          WAAUVA
     I              BKAVVA                          WAAVVA
     I              BKCHPR                          WACHPR
     I              BKAJVA                          WAAJVA
     I              BKBUPC                          WABUPC
     I              BKJHST                          WAJHST
     I              BKC0ST                          WAC0ST
     I              BKA4DT                          WAA4DT
     I              BKCUST                          WACUST
     I              BKABCD                          WAABCD
     I              BKBNCD                          WABNCD
     I              BKCFCD                          WACFCD
     I              BKAAVN                          WAAAVN
     I              BKAADT                          WAAADT
     I              BKAMTM                          WAAMTM
     I              BKAJST                          WAAJST
     I              BKAHVN                          WAAHVN
     I              BKAGVN                          WAAGVN
     I              BKABVN                          WAABVN
     I              BKABDT                          WAABDT
     I              BKABTM                          WAABTM
      *
     I@A1CPC4
      * Tattoo Header             Retrieval index
      * Renamed input format fields
     I              A1HMNB                          WBHMNB
     I              A1BNNB                          WBBNNB
     I              A1BONB                          WBBONB
     I              A1CVNB                          WBCVNB
     I              A1B0DT                          WBB0DT
     I              A1AWDT                          WBAWDT
     I              A1BICD                          WBBICD
     I              A1CPST                          WBCPST
     I              A1ACPR                          WBACPR
     I              A1B9PR                          WBB9PR
     I              A1CAPR                          WBCAPR
     I              A1C4ST                          WBC4ST
     I              A1AIPR                          WBAIPR
     I              A1A6DT                          WBA6DT
     I              A1C2ST                          WBC2ST
     I              A1CXNB                          WBCXNB
     I              A1CWNB                          WBCWNB
     I              A1FCNB                          WBFCNB
     I              A1H9NB                          WBH9NB
     I              A1FDNB                          WBFDNB
     I              A1FENB                          WBFENB
     I              A1HENB                          WBHENB
     I              A1HFNB                          WBHFNB
     I              A1CYNB                          WBCYNB
     I              A1LRNB                          WBLRNB
     I              A1E0NB                          WBE0NB
     I              A1A5PC                          WBA5PC
     I              A1FBNB                          WBFBNB
     I              A1A4PC                          WBA4PC
     I              A1F7NB                          WBF7NB
     I              A1HDNB                          WBHDNB
     I              A1F5NB                          WBF5NB
     I              A1F4NB                          WBF4NB
     I              A1F3NB                          WBF3NB
     I              A1F2NB                          WBF2NB
     I              A1AVPC                          WBAVPC
     I              A1AWPC                          WBAWPC
     I              A1CWPC                          WBCWPC
     I              A1A8PC                          WBA8PC
     I              A1A7PC                          WBA7PC
     I              A1B8PR                          WBB8PR
     I              A1AMPR                          WBAMPR
     I              A1ANPR                          WBANPR
     I              A1AYVA                          WBAYVA
     I              A1AWVA                          WBAWVA
     I              A1AOPR                          WBAOPR
     I              A1AXVA                          WBAXVA
     I              A1APPR                          WBAPPR
     I              A1ASPR                          WBASPR
     I              A1A4VA                          WBA4VA
     I              A1ATPR                          WBATPR
     I              A1A5VA                          WBA5VA
     I              A1CBPR                          WBCBPR
     I              A1CCPR                          WBCCPR
     I              A1LPNB                          WBLPNB
     I              A1CDPR                          WBCDPR
     I              A1A7VA                          WBA7VA
     I              A1A2PR                          WBA2PR
     I              A1JWST                          WBJWST
     I              A1CWST                          WBCWST
     I              A1D7ST                          WBD7ST
     I              A1D8ST                          WBD8ST
     I              A1DWST                          WBDWST
     I              A1D6ST                          WBD6ST
     I              A1GHNB                          WBGHNB
     I              A1BYDT                          WBBYDT
     I              A1E0ST                          WBE0ST
     I              A1E1ST                          WBE1ST
     I              A1E2ST                          WBE2ST
     I              A1BSDT                          WBBSDT
     I              A1BTDT                          WBBTDT
     I              A1BUDT                          WBBUDT
     I              A1HGNB                          WBHGNB
     I              A1HHNB                          WBHHNB
     I              A1HINB                          WBHINB
     I              A1A3PR                          WBA3PR
     I              A1A4PR                          WBA4PR
     I              A1A6PR                          WBA6PR
     I              A1J9NB                          WBJ9NB
     I              A1D6PR                          WBD6PR
     I              A1D7PR                          WBD7PR
     I              A1D8PR                          WBD8PR
     I              A1D9PR                          WBD9PR
     I              A1EAPR                          WBEAPR
     I              A1EBPR                          WBEBPR
     I              A1ECPR                          WBECPR
     I              A1EDPR                          WBEDPR
     I              A1EEPR                          WBEEPR
     I              A1EFPR                          WBEFPR
     I              A1EGPR                          WBEGPR
     I              A1EHPR                          WBEHPR
     I              A1KAST                          WBKAST
     I              A1J7ST                          WBJ7ST
     I              A1J9ST                          WBJ9ST
     I              A1OXNB                          WBOXNB
     I              A1LKST                          WBLKST
     I              A1LLST                          WBLLST
     I              A1J8ST                          WBJ8ST
     I              A1LIST                          WBLIST
     I              A1LJST                          WBLJST
     I              A1AGCD                          WBAGCD
     I              A1BECD                          WBBECD
     I              A1BDCD                          WBBDCD
     I              A1CSCD                          WBCSCD
     I              A1ABCD                          WBABCD
     I              A1AECD                          WBAECD
     I              A1ACCD                          WBACCD
     I              A1AAVN                          WBAAVN
     I              A1AADT                          WBAADT
     I              A1AMTM                          WBAMTM
     I              A1AJST                          WBAJST
     I              A1AHVN                          WBAHVN
     I              A1AGVN                          WBAGVN
     I              A1ABVN                          WBABVN
     I              A1ABDT                          WBABDT
     I              A1ABTM                          WBABTM
      *
     I@BKCPEJ
      * Hog Voucher Header        Retrieval index
      * Renamed input format fields
     I              BKHNNB                          WCHNNB
     I              BKLWNB                          WCLWNB
     I              BKG9NB                          WCG9NB
     I              BKLXNB                          WCLXNB
     I              BKLYNB                          WCLYNB
     I              BKCSST                          WCCSST
     I              BKDKNB                          WCDKNB
     I              BKA2DT                          WCA2DT
     I              BKCIPR                          WCCIPR
     I              BKCJPR                          WCCJPR
     I              BKCKPR                          WCCKPR
     I              BKCLPR                          WCCLPR
     I              BKCMPR                          WCCMPR
     I              BKAUVA                          WCAUVA
     I              BKAVVA                          WCAVVA
     I              BKCHPR                          WCCHPR
     I              BKAJVA                          WCAJVA
     I              BKBUPC                          WCBUPC
     I              BKJHST                          WCJHST
     I              BKC0ST                          WCC0ST
     I              BKA4DT                          WCA4DT
     I              BKCUST                          WCCUST
     I              BKABCD                          WCABCD
     I              BKBNCD                          WCBNCD
     I              BKCFCD                          WCCFCD
     I              BKAAVN                          WCAAVN
     I              BKAADT                          WCAADT
     I              BKAMTM                          WCAMTM
     I              BKAJST                          WCAJST
     I              BKAHVN                          WCAHVN
     I              BKAGVN                          WCAGVN
     I              BKABVN                          WCABVN
     I              BKABDT                          WCABDT
     I              BKABTM                          WCABTM
      *
     I@BFREOG
      * Producer Std Split        Active Prdcr Splits
      * Renamed input format fields
     I              BFABCD                          WDABCD
     I              BFBTCD                          WDBTCD
     I              BFAYDT                          WDAYDT
     I              BFABPC                          WDABPC
     I              BFAAVN                          WDAAVN
     I              BFAADT                          WDAADT
     I              BFAMTM                          WDAMTM
     I              BFAJST                          WDAJST
     I              BFAHVN                          WDAHVN
     I              BFAGVN                          WDAGVN
     I              BFABVN                          WDABVN
     I              BFABDT                          WDABDT
     I              BFABTM                          WDABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IQPKBK1    E DSPKBKCPL1
      * UPD : Hog Voucher Header        Update index
     IYARDCS      DS                            151
     IYBRDCS      DS                            151
     IYCRDCS      DS                            151
     IYDRDCS      DS                            151
      /EJECT
      * Parameter declarations
     IP1PARM      DS                             15
      * KEY: Tattoo Header             Co/Prd/KlDte/Tto/Unpd
      * I : RST BOH Company Number
     I                                    P   1   20P1HMNB
      * I : MAP TH Kill Date
     I                                    P   9  120P1B0DT
     IP2PARM      DS
      * I : MAP @Status Edit/Post
     I                                        1   1 P2J2ST
     IP3PARM      DS
      * I : MAP Oms System Value Alpha
     I                                        1  40 P3EVTX
     IP4PARM      DS
      * I : MAP @Status Unpaid/All Usr
     I                                        1   1 P4J4ST
     IP5PARM      DS
      * B : MAP Pmt Payment Error
     I                                        1   1 P5KLST
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           KEY: Tattoo Hea
     C           P2J2ST    PARM           WP0001  1        @Status Edit/Po
     C           P3EVTX    PARM           WP0002 40        Oms System Valu
     C           P4J4ST    PARM           WP0003  1        @Status Unpaid/
     C           P5KLST    PARM P5KLST    WP0004  1        Pmt Payment Err
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prt Payment Edit/pst wrka: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$IENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Prt Payment Edit/pst wrka: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQKA01           BOH Company Num
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           BOH Company Num
      * Setup key
     C                     Z-ADDP1HMNB    WQKA01           BOH Company Num
      * Establish starting position
     C           KRSA      SETLL@A1CPQN                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        BOH Company Num
     C                     MOVEL'Y'       W0AL01  1        PD Producer Cod
     C                     MOVEL'Y'       W0AL02  1        TH Kill Date
     C                     MOVEL'Y'       W0AL03  1        TH Tattoo Numbe
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $HB4NB           Head Total SUM
     C                     Z-ADD*ZERO     $HLWNB           VCH Batch Numbe
     C                     Z-ADD*ZERO     $HBBVA           Gross Total SUM
     C                     Z-ADD*ZERO     $HBCVA           Ded Total SUM
     C                     Z-ADD*ZERO     $HBDVA           Net Total SUM
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP03  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDA1HMNB    $DHMNB           BOH Company Num
     C                     MOVELA1ABCD    $DABCD           PD Producer Cod
     C                     Z-ADDA1CVNB    $DCVNB           TH Tattoo Numbe
     C                     Z-ADDA1FENB    $DFENB           TH Head Killed
     C                     Z-ADDA1AWPC    $DAWPC           TH Actual Yield
     C                     Z-ADDA1CYNB    $DCYNB           TH Live Wgt
     C                     Z-ADDA1F4NB    $DF4NB           TH Avg Lean Per
     C                     Z-ADDA1ANPR    $DANPR           TH CM Base Mkt
     C                     Z-ADDA1AXVA    $DAXVA           TH CM LN AddOn/
     C                     Z-ADDA1AWVA    $DAWVA           TH CM Yield Gai
     C                     Z-ADDA1AYVA    $DAYVA           TH CM Sort Disc
     C                     Z-ADDA1AOPR    $DAOPR           TH CM Base Carc
     C                     Z-ADDA1CBPR    $DCBPR           TH Payment Gros
     C                     Z-ADDA1A5VA    $DA5VA           TH Additions Am
     C                     Z-ADDA1ASPR    $DASPR           TH Deduction Am
     C                     Z-ADDA1CCPR    $DCCPR           Th Payment Net
     C                     MOVELA1BICD    $DBICD           TH Tattoo Refer
     C                     MOVELA1CPST    $DCPST           TH Live Purchas
     C                     Z-ADDA1ACPR    $DACPR           TH Live Purchas
     C                     Z-ADDA1CXNB    $DCXNB           TH Dead On Arri
     C                     Z-ADDA1FCNB    $DFCNB           TH Yard Deads
     C                     Z-ADDA1FDNB    $DFDNB           TH Head Condemn
     C                     Z-ADDA1HENB    $DHENB           TH Head Adds
     C                     Z-ADDA1HFNB    $DHFNB           TH Head Analyze
     C                     Z-ADDA1LRNB    $DLRNB           TH Adj Live Wgt
     C                     Z-ADDA1E0NB    $DE0NB           TH Hot Wgt
     C                     Z-ADDA1A5PC    $DA5PC           TH Tot Loin Eye
     C                     Z-ADDA1FBNB    $DFBNB           TH Tot Backfat
     C                     Z-ADDA1A4PC    $DA4PC           TH Tot Light Re
     C                     Z-ADDA1F7NB    $DF7NB           TH Avg Live Wgt
     C                     Z-ADDA1HDNB    $DHDNB           TH Avg Hot Wgt
     C                     Z-ADDA1F5NB    $DF5NB           TH Avg Light Re
     C                     Z-ADDA1F3NB    $DF3NB           TH Avg Loin Eye
     C                     Z-ADDA1F2NB    $DF2NB           TH Avg Backfat
     C                     Z-ADDA1AVPC    $DAVPC           TH Std Yield Pe
     C                     Z-ADDA1CWPC    $DCWPC           TH Adj Actual Y
     C                     Z-ADDA1A8PC    $DA8PC           TH Yield Differ
     C                     Z-ADDA1A7PC    $DA7PC           TH UnUsed Field
     C                     Z-ADDA1B0DT    $DB0DT           TH Kill Date
     C                     Z-ADDA1AMPR    $DAMPR           TH CM Base Mkt
     C                     MOVELA1CWST    $DCWST           TH Payment Sts
     C                     Z-ADDA1B9PR    $DB9PR           TH Live Gross A
     C                     Z-ADDA1CAPR    $DCAPR           TH LIve Net Amt
     C                     Z-ADDA1BNNB    $DBNNB           BOH Buy Order N
     C                     Z-ADDA1CWNB    $DCWNB           TH Head Receive
     C                     Z-ADDA1B8PR    $DB8PR           TH CM Market Pr
     C                     MOVELA1CSCD    $DCSCD           THP Process Cod
     C                     Z-ADDA1APPR    $DAPPR           TH CM Carcass G
     C                     Z-ADDA1ATPR    $DATPR           TH Carcass Net
     C                     Z-ADDA1BONB    $DBONB           BOL Load Number
     C                     Z-ADDA1H9NB    $DH9NB           TH Held Over
     C                     Z-ADDA1AWDT    $DAWDT           TH Purchase Dat
     C                     MOVELA1BECD    $DBECD           HC Class Code
     C                     Z-ADDA1A4VA    $DA4VA           TH Total Net WO
     C                     Z-ADDA1LPNB    $DLPNB           TH AP Voucher/D
     C                     Z-ADDA1CDPR    $DCDPR           TH Freight Amou
     C                     Z-ADDA1A7VA    $DA7VA           TH Contract Adj
     C                     Z-ADDA1A2PR    $DA2PR           TH Actual Value
     C                     MOVELA1JWST    $DJWST           TH Calc Net Sts
     C                     MOVELA1D7ST    $DD7ST           TH Header Error
     C                     MOVELA1D8ST    $DD8ST           TH Detail Error
     C                     MOVELA1DWST    $DDWST           TH Kill Balanci
     C                     MOVELA1D6ST    $DD6ST           TH Bal to Kill
     C                     Z-ADDA1GHNB    $DGHNB           TH UnUsed Fld
     C                     Z-ADDA1BYDT    $DBYDT           TH Voucher Paym
     C                     MOVELA1E0ST    $DE0ST           TH User Error O
     C                     MOVELA1E1ST    $DE1ST           TH Held Over Re
     C                     MOVELA1E2ST    $DE2ST           TH Sex
     C                     Z-ADDA1BSDT    $DBSDT           TH Held/Ovr Com
     C                     Z-ADDA1BTDT    $DBTDT           TH Unused Date
     C                     Z-ADDA1BUDT    $DBUDT           TH Unused Date
     C                     Z-ADDA1HGNB    $DHGNB           TH Shipped Weig
     C                     Z-ADDA1HHNB    $DHHNB           TH Unused Wgt 2
     C                     Z-ADDA1HINB    $DHINB           TH FFLI
     C                     Z-ADDA1A3PR    $DA3PR           TH Kill Product
     C                     Z-ADDA1A4PR    $DA4PR           TH Cut Product
     C                     Z-ADDA1A6PR    $DA6PR           TH Render Produ
     C                     Z-ADDA1J9NB    $DJ9NB           TH Head Deletes
     C                     Z-ADDA1D6PR    $DD6PR           TH CM Bse Mkt L
     C                     Z-ADDA1D7PR    $DD7PR           TH CM Bse Mkt C
     C                     Z-ADDA1D8PR    $DD8PR           TH CM Srt Dsc L
     C                     Z-ADDA1D9PR    $DD9PR           TH CM Srt Dsc C
     C                     Z-ADDA1EAPR    $DEAPR           TH CM Yld G/L L
     C                     Z-ADDA1EBPR    $DEBPR           TH CM Yld G/L C
     C                     Z-ADDA1ECPR    $DECPR           TH CM Crc Val L
     C                     Z-ADDA1EDPR    $DEDPR           TH CM Crc Val C
     C                     Z-ADDA1EEPR    $DEEPR           TH CM Lean Prem
     C                     Z-ADDA1EFPR    $DEFPR           TH CM Lean Prem
     C                     Z-ADDA1EGPR    $DEGPR           TH CM Gross Liv
     C                     Z-ADDA1EHPR    $DEHPR           TH CM Gross Car
     C                     MOVELA1KAST    $DKAST           TH Source Type
     C                     MOVELA1J7ST    $DJ7ST           TH Scale Ticket
     C                     MOVELA1J8ST    $DJ8ST           TH Posted to HP
     C                     MOVELA1LIST    $DLIST           TH Unused Sts 1
     C                     MOVELA1LJST    $DLJST           TH Unused Sts 2
     C                     MOVELA1J9ST    $DJ9ST           TH Payment Type
     C                     Z-ADDA1OXNB    $DOXNB           TH Movement Ref
     C                     MOVELA1LKST    $DLKST           TH Source Code
     C                     MOVELA1LLST    $DLLST           TH Hog Class Ty
     C                     MOVELA1AGCD    $DAGCD           GN Genetic Code
     C                     MOVELA1C4ST    $DC4ST           TH Resale UOM
     C                     Z-ADDA1AIPR    $DAIPR           TH Resale Price
     C                     Z-ADDA1A6DT    $DA6DT           TH Resale Invoi
     C                     MOVELA1C2ST    $DC2ST           TH Resale Print
     C                     MOVELA1BDCD    $DBDCD           DF Defect Code
     C                     MOVELA1AECD    $DAECD           PL Location Cod
     C                     MOVELA1ACCD    $DACCD           HB Buyer Code
     C                     MOVELA1AAVN    $DAAVN           RS User Changed
     C                     Z-ADDA1AADT    $DAADT           RS Date Changed
     C                     Z-ADDA1AMTM    $DAMTM           RS Time Changed
     C                     MOVELA1AJST    $DAJST           RS Record Statu
     C                     MOVELA1AHVN    $DAHVN           RS Job
     C                     MOVELA1AGVN    $DAGVN           RS Program
     C                     MOVELA1ABVN    $DABVN           RS User Added
     C                     Z-ADDA1ABDT    $DABDT           RS Date Added
     C                     Z-ADDA1ABTM    $DABTM           RS Time Added
      * USER: Process before print of detail format
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : PO BO Header
     C                     EXSR UASUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : Prt Tattoo Ded/Add    PO
     C                     EXSR UBSUBR                     Embedded PRTOBJ
      * USER: Process after print of detail format
     C                     ADD  $DFENB    $HB4NB           Head Total SUM
     C                     ADD  $DCBPR    $HBBVA           Gross Total SUM
     C                     ADD  WUBEVA    $HBCVA           Ded Total SUM
     C                     ADD  $DCCPR    $HBDVA           Net Total SUM
      * If Posting routine then Post unpaid Producer's
      * CASE: PAR.@Status Edit/Post is Post
     C           P2J2ST    IFEQ 'P'                        *IF
      * CASE: CUR.TH Payment Sts is Unpaid Producer
     C           $DCWST    IFEQ 'ML'                       *IF
     C           $DCWST    OREQ 'SL'
     C           $DCWST    OREQ 'SC'
     C           $DCWST    OREQ 'IC'
     C           $DCWST    OREQ 'IL'
     C           $DCWST    OREQ *BLANK
      * CASE: CUR.TH Held Over Record is Not a Held Over Ttt Rcd
     C           $DE1ST    IFEQ *BLANK                     *IF
     C           $DE1ST    OREQ 'N'
      * All records except the last held over record
      * the held over record will be accumulate in the next section
      * Tattoo header Driver used to create carcass summary
      * CASE: Market or subject create a tattoo header driver
      *  - c1 OR c2
      *   |- c1    : DB1.TH Hog Class Type is Market
      *   |- c2    : DB1.TH Hog Class Type is Subject
      *   '-
     C           A1LLST    IFEQ 'M'                        *IF
     C           A1LLST    OREQ 'S'                        *OR
      * Externals check to create a tattoo driver- 1 for carc sum,1 for c
      * CASE: select live, or mark live
      *  - c1 OR c2
      *   |- c1    : CUR.TH Payment Sts is Mark Live Payment
      *   |- c2    : CUR.TH Payment Sts is Select Live
      *   '-
     C           $DCWST    IFEQ 'ML'                       *IF
     C           $DCWST    OREQ 'SL'                       *OR
     C                     ADD  1         WUN5NB           Tattoo Sequence
      * Create Tattoo Header Driv - Tattoo Header Driver  * 
     C                     EXSR SBCRRC
     C                     ADD  1         WUN5NB           Tattoo Sequence
      * Create Tattoo Header Driv - Tattoo Header Driver  * 
     C                     EXSR SCCRRC
     C                     ELSE
      * CASE: CUR.TH Payment Sts is Sl Carcass Merit
     C           $DCWST    IFEQ 'SC'                       *IF
     C                     ADD  1         WUN5NB           Tattoo Sequence
      * Create Tattoo Header Driv - Tattoo Header Driver  * 
     C                     EXSR SDCRRC
     C                     ADD  1         WUN5NB           Tattoo Sequence
      * Create Tattoo Header Driv - Tattoo Header Driver  * 
     C                     EXSR SECRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Crt Live Vchr Detail  IF
      * Accumulate gross, net, d/a amts and create voucher header, detail
      * Break in producer  or kill date
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.PD Producer Code NE WRK.Producer Code         US
      *   |- c2    : PAR.TH Kill Date NE WRK.TH Kill Date
      *   '-
     C           $DABCD    IFNE WUARCD                     *IF
     C           $DB0DT    ORNE WUB0DT                     *OR
     C                     MOVEL$DABCD    WUARCD           Producer Code
     C                     Z-ADD$DB0DT    WUB0DT           TH Kill Date
      * Rtv Nxt Vch Header#   RT - Hog Voucher Header  * 
     C                     EXSR SFRVGN
      * Rtv Producer Split    RT - Producer Std Split  * 
     C                     EXSR SGRVGN
      * Rtv Prdcr Vendor#,Src RT - Producer  * 
     C                     EXSR SHRVGN
      * Payee type values
      * CASE: PAR.TH Source Type is Internal
     C           $DKAST    IFEQ 'I'                        *IF
     C                     MOVEL'I'       WUCSST           VCH Payee Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       WUCSST           VCH Payee Type
     C                     END                             *FI
      * Crt Voucher Header    CR - Hog Voucher Header  * 
     C                     EXSR SICRRC
     C                     Z-ADD*ZERO     WUAUVA           VCH Gross Amt
     C                     Z-ADD*ZERO     WUAJVA           VCH Net Amt
     C                     Z-ADD*ZERO     WUCHPR           VCH Less Split
     C                     Z-ADD*ZERO     WUAVVA           VCH Deduction A
     C                     Z-ADD*ZERO     WUCIPR           VCH Base Mkt Pr
     C                     Z-ADD*ZERO     WUCJPR           VCH Sort Disc A
     C                     Z-ADD*ZERO     WUCKPR           VCH Yield Gain/
     C                     Z-ADD*ZERO     WUCLPR           VCH Base Carcas
     C                     Z-ADD*ZERO     WUCMPR           VCH LN Add on/D
     C                     Z-ADD*ZERO     WUDLNB           VCD Line
     C                     END                             *FI
     C                     ADD  1         WUDLNB           VCD Line
      * Detail totals
      * Accum total Tattoo amounts into work fields for Voucher Header
      * CASE: If held over, call tattoo total function
      *  - c1 OR c2
      *   |- c1    : PAR.TH Held Over is greater than 0
      *   |- c2    : PAR.TH Held/Ovr Completed Dte is Greater than 0
      *   '-
     C           $DH9NB    IFGT *ZERO                      *IF
     C           $DBSDT    ORGT *ZERO                      *OR
      * Clear all neither parameters
     C                     Z-ADD*ZERO     WN0001 152       Lean % * Wgt US
     C                     Z-ADD*ZERO     WN0002 152       Backfat * Wgt U
     C                     Z-ADD*ZERO     WN0003 152       Loin-Eye * Wgt
      *
      * Prt Crc Sum (Hld Ovr) IF
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUB5DT           TH Kill Date
     C                     Z-ADD*ZERO     WUCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WUFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WUFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WUFENB           TH Head Killed
     C                     Z-ADD*ZERO     WUHENB           TH Head Adds
     C                     Z-ADD*ZERO     WUCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WULRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WUE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WUF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WUHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WUF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WUF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WUF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WUAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WUCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WUANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WUAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WUAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WUAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WUAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WUAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WUASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WUATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WUA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WUCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WUCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WUHINB           TH FFLI
     C                     Z-ADD*ZERO     WUD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WUD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WUD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WUD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WUEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WUEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WUECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WUEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WUEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WUEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WUEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WUEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WN0001           Lean % * Wgt US
     C                     Z-ADD*ZERO     WN0002           Backfat * Wgt U
     C                     Z-ADD*ZERO     WN0003           Loin-Eye * Wgt
      * Prt Crc Sum (Hld Ovr) RT - Tattoo Header  * 
     C                     EXSR SJRVGN
      * Calculate Live /CWT and Carc /CWT
      * CASE: WRK.#Sequence Block is NULL
     C           WUJ0ST    IFEQ *BLANK                     *IF
      * Calculate Carc/CWT if Par.Th Hot Wt is n= 0
      * CASE: PAR.TH Hot Wgt NE WRK.Zero USR
     C           WUE0NB    IFNE WUE9NB                     *IF
      * TH CM Bse Mkt Carc /CWT
      * PAR.TH CM Bse Mkt Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Base Mkt Price Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WUE0NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WUANPR    DIV  W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUD7PR           TH CM Bse Mkt C
      * TH CM Srt Dsc Carc /CWT
      * PAR.TH CM Srt Dsc Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Sort Discount Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WUE0NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WUAYVA    DIV  W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUD9PR           TH CM Srt Dsc C
      * TH CM Yld G/L Carc /CWT
      * PAR.TH CM Yld G/L Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Yield Gain/Loss Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WUE0NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WUAWVA    DIV  W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUEBPR           TH CM Yld G/L C
      * TH CM Crc Val Carc /CWT
      * PAR.TH CM Crc Val Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Base Carcass Value
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WUE0NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WUAOPR    DIV  W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUEDPR           TH CM Crc Val C
      * TH CM Lean Prem Carc /CWT
      * PAR.TH CM Lean Prem Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM LN AddOn/Deduct Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WUE0NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WUAXVA    DIV  W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUEFPR           TH CM Lean Prem
      * TH CM Gross Carc /CWT
      * PAR.TH CM Gross Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Carcass Gross Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WUE0NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WUAPPR    DIV  W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUEHPR           TH CM Gross Car
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WUD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WUEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WUEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WUEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WUEHPR           TH CM Gross Car
     C                     END                             *FI
      * Calculate Live/CWT if Par.Th live wt is n= 0
      * CASE: PAR.TH Live Wgt NE WRK.Zero USR
     C           WUCYNB    IFNE WUE9NB                     *IF
      * TH CM Bse Mkt Live /CWT
      * PAR.TH CM Bse Mkt Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Base Mkt Price Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WUCYNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WUANPR    DIV  W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUD6PR           TH CM Bse Mkt L
      * TH CM Srt Dsc Live /CWT
      * PAR.TH CM Srt Dsc Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Sort Discount Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WUCYNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WUAYVA    DIV  W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUD8PR           TH CM Srt Dsc L
      * TH CM Yld G/L Live /CWT
      * PAR.TH CM Yld G/L Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Yield Gain/Loss Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WUCYNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WUAWVA    DIV  W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUEAPR           TH CM Yld G/L L
      * TH CM Crc Val Live /CWT
      * PAR.TH CM Crc Val Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Base Carcass Value
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WUCYNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WUAOPR    DIV  W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUECPR           TH CM Crc Val L
      * TH CM Lean Prem Live /CWT
      * PAR.TH CM Lean Prem Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM LN AddOn/Deduct Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WUCYNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WUAXVA    DIV  W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUEEPR           TH CM Lean Prem
      * TH CM Gross Live /CWT
      * PAR.TH CM Gross Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Carcass Gross Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           WUCYNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           WUAPPR    DIV  W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUEGPR           TH CM Gross Liv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WUD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WUEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WUECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WUEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WUEGPR           TH CM Gross Liv
     C                     END                             *FI
     C                     END                             *FI
      * Calc Avg Live Wt
      * CASE: PAR.TH Head Received is *Zeros
     C           WUCWNB    IFEQ *ZERO                      *IF
     C                     Z-ADD*ZERO     WUF7NB           TH Avg Live Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C           WUCYNB    DIV  WUCWNB    WUF7NB    H      TH Avg Live Wgt
     C                     END                             *FI
      * Calc Adj Live Weight
      * CASE: PAR.TH Head Received EQ PAR.TH Head Killed
     C           WUCWNB    IFEQ WUFENB                     *IF
     C                     Z-ADDWUCYNB    WULRNB           TH Adj Live Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C           WUFENB    MULT WUF7NB    WULRNB           TH Adj Live Wgt
     C                     END                             *FI
     C                     Z-ADDWUF7NB    WUF7NB           TH Avg Live Wgt
     C                     Z-ADDWULRNB    WULRNB           TH Adj Live Wgt
      * Calc Actual Yield %
      * CASE: PAR.TH Live Wgt NE WRK.Zero USR
     C           WUCYNB    IFNE WUE9NB                     *IF
      * TH Actual Yield %
      * PAR.TH Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           WUE0NB    DIV  WUCYNB    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUAWPC           TH Actual Yield
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUAWPC           TH Actual Yield
     C                     END                             *FI
      * Calc Adj Actual Yield %
      * CASE: PAR.TH Adj Live Wgt NE WRK.Zero USR
     C           WULRNB    IFNE WUE9NB                     *IF
      * TH Adj Actual Yield %
      * PAR.TH Adj Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : PAR.TH Adj Live Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           WUE0NB    DIV  WULRNB    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCWPC           TH Adj Actual Y
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUCWPC           TH Adj Actual Y
     C                     END                             *FI
      * Calc Avg Hot Wt
      * CASE: PAR.TH Head Killed NE WRK.Zero USR
     C           WUFENB    IFNE WUE9NB                     *IF
     C           WUE0NB    DIV  WUFENB    WUHDNB    H      TH Avg Hot Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUHDNB           TH Avg Hot Wgt
     C                     END                             *FI
      * Calc Avg Lean %, Loin eye, & Backfat
      * CASE: PAR.TH Hot Wgt NE WRK.Zero USR
     C           WUE0NB    IFNE WUE9NB                     *IF
     C           WN0001    DIV  WUE0NB    WUF4NB    H      TH Avg Lean Per
     C           WN0003    DIV  WUE0NB    WUF3NB    H      TH Avg Loin Eye
     C           WN0002    DIV  WUE0NB    WUF2NB    H      TH Avg Backfat
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WUF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WUF2NB           TH Avg Backfat
     C                     END                             *FI
      * TH FFLI
      * PAR.TH FFLI =
      *    *COMPUTE (x1 + (x2 * x3) - (x4 * x5))
      * x1    : CON.51.537
      * +     : PGM.*Synon (17,7) work field
      * x2    : CON..035
      * *     : PGM.*Synon (17,7) work field *
      * x3    : PAR.TH Hot Wgt
      * -     : PGM.*Synon (17,7) work field
      * x4    : CON.12.26
      * *     : PGM.*Synon (17,7) work field *
      * x5    : PAR.TH Avg Backfat
     C           .035      MULT WUE0NB    W0WD02           *Synon (17,7) w
     C           51.537    ADD  W0WD02    W0WD01           *Synon (17,7) w
     C           12.26     MULT WUF2NB    W0WD03           *Synon (17,7) w
     C           W0WD01    SUB  W0WD03    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WUHINB           TH FFLI
     C           WUA5VA    SUB  WUASPR    WUA9VA           Net Ded/Add amo
     C                     Z-ADDWUCCPR    WUAMVA           VCD Net Amt
      * Header Totals
     C                     ADD  WUCBPR    WUAUVA           VCH Gross Amt
     C                     ADD  WUCCPR    WUAJVA           VCH Net Amt
     C                     ADD  WUA9VA    WUAVVA           VCH Deduction A
      * If carcass payment, output carcass related fields; else zero them
      * CASE: PAR.TH Payment Type is Carcass Merit
     C           $DJ9ST    IFEQ 'C'                        *IF
     C                     ADD  WUANPR    WUCIPR           VCH Base Mkt Pr
     C                     ADD  WUAYVA    WUCJPR           VCH Sort Disc A
     C                     ADD  WUAWVA    WUCKPR           VCH Yield Gain/
     C                     ADD  WUAOPR    WUCLPR           VCH Base Carcas
     C                     ADD  WUAXVA    WUCMPR           VCH LN Add on/D
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WUAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WUAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WUAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WUAXVA           TH CM LN AddOn/
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C           $DA5VA    SUB  $DASPR    WUA9VA           Net Ded/Add amo
     C                     Z-ADD$DCCPR    WUAMVA           VCD Net Amt
      * Header Totals
     C                     ADD  $DCBPR    WUAUVA           VCH Gross Amt
     C                     ADD  $DCCPR    WUAJVA           VCH Net Amt
     C                     ADD  WUA9VA    WUAVVA           VCH Deduction A
      * If Carcass payment, output carcass related fields; else zero them
      * CASE: PAR.TH Payment Type is Carcass Merit
     C           $DJ9ST    IFEQ 'C'                        *IF
     C                     ADD  $DANPR    WUCIPR           VCH Base Mkt Pr
     C                     ADD  $DAYVA    WUCJPR           VCH Sort Disc A
     C                     ADD  $DAWVA    WUCKPR           VCH Yield Gain/
     C                     ADD  $DAOPR    WUCLPR           VCH Base Carcas
     C                     ADD  $DAXVA    WUCMPR           VCH LN Add on/D
     C                     Z-ADD$DANPR    WUANPR           TH CM Base Mkt
     C                     Z-ADD$DAYVA    WUAYVA           TH CM Sort Disc
     C                     Z-ADD$DAWVA    WUAWVA           TH CM Yield Gai
     C                     Z-ADD$DAOPR    WUAOPR           TH CM Base Carc
     C                     Z-ADD$DAXVA    WUAXVA           TH CM LN AddOn/
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WUAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WUAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WUAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WUAXVA           TH CM LN AddOn/
     C                     END                             *FI
     C                     Z-ADD$DCCPR    WUCCPR           Th Payment Net
     C                     Z-ADD$DCBPR    WUCBPR           TH Payment Gros
     C                     END                             *FI
      * If Split producer - calc split amt and new net amount
      * CASE: WRK.VCH Split % is Not 100 %
     C           WUBUPC    IFNE 100                        *IF
     C           WUBUPC    DIV  100       WUL9NB           Percent Decimal
     C           WUL9NB    MULT WUCCPR    WUAMVA    H      VCD Net Amt
     C           WUAMVA    SUB  WUCCPR    WUCVPR           VCD Less Split
     C                     ADD  WUCVPR    WUCHPR           VCH Less Split
     C                     ADD  WUCVPR    WUAJVA           VCH Net Amt
      * (Split amount is negative in voucher header,detail files.)
     C                     END                             *FI
      * Rtv BOH Py Typ,BO Typ RT - Buy Order Header  * 
     C                     EXSR SLRVGN
      * WRK.HC Description = Condition name of PAR.TH Hog Class Type
     C                     CALL 'PKRVCNR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1110255   Y2LSNO  70       List number
     C                     PARM $DLLST    W0INVL 20        TH Hog Class Ty
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WUBDTX    PARM           W0CNNM 25        HC Description
      *
     C                     Z-ADD$DCVNB    WUMLNB           Tattoo Nbr 4
     C                     MOVEL*BLANK    WUDUCD           Tattoo Nbr Alph
     C                     MOVELWUMLNB    WUDUCD           Tattoo Nbr Alph
     C                     Z-ADD2         ZQ      50
     C           WUDUCD    CAT  WUBDTX:ZQ WUF5TX    P      VCD Check Descr
     C                     MOVEL$DLLST    WUJIST           VCD Hog Class T
      * TATTOO ACTION OF CARCASS TO LIVE, OR LIVE TO CARCASS
      * CASE: WRK.BOH Payment Type NE PAR.TH Payment Type
     C           WUA4ST    IFNE $DJ9ST                     *IF
      * CASE: PAR.TH Hog Class Type is Not Subject
     C           $DLLST    IFEQ 'M'                        *IF
     C           $DLLST    OREQ 'R'
      * CASE: PAR.TH Payment Type is Live
     C           $DJ9ST    IFEQ 'L'                        *IF
      * Crt Tattoo Action Comm XF - Tattoo Header Comment  * 
     C                     CALL 'PKV4XFR'              90  Crt Tattoo Acti
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $DHMNB    WQ0001  30       BOH Company Num
     C                     PARM $DBNNB    WQ0002  50       BOH Buy Order N
     C                     PARM $DBONB    WQ0003  50       BOL Load Number
     C                     PARM $DCVNB    WQ0004  50       TH Tattoo Numbe
     C                     PARM $DB0DT    WQ0005  70       TH Kill Date
     C                     PARM *ZERO     WQ0006  50       TH Head Receive
     C                     PARM *ZERO     WQ0007  50       TH Held Over
     C                     PARM *ZERO     WQ0008  80       TH AP Voucher/D
     C                     PARM *ZERO     WQ0009  70       TH Voucher Paym
     C                     PARM 'CL'      WQ0010  2        Tattoo Action U
     C                     PARM *BLANK    WQ0011  5        Tattoo Nbr Alph
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKV4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Crt Tattoo Action Comm XF - Tattoo Header Comment  * 
     C                     CALL 'PKV4XFR'              90  Crt Tattoo Acti
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $DHMNB    WQ0012  30       BOH Company Num
     C                     PARM $DBNNB    WQ0013  50       BOH Buy Order N
     C                     PARM $DBONB    WQ0014  50       BOL Load Number
     C                     PARM $DCVNB    WQ0015  50       TH Tattoo Numbe
     C                     PARM $DB0DT    WQ0016  70       TH Kill Date
     C                     PARM *ZERO     WQ0017  50       TH Head Receive
     C                     PARM *ZERO     WQ0018  50       TH Held Over
     C                     PARM *ZERO     WQ0019  80       TH AP Voucher/D
     C                     PARM *ZERO     WQ0020  70       TH Voucher Paym
     C                     PARM 'LC'      WQ0021  2        Tattoo Action U
     C                     PARM *BLANK    WQ0022  5        Tattoo Nbr Alph
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKV4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Crt Voucher Detail    CR - Hog Voucher Detail  * 
     C                     EXSR SMCRRC
     C                     MOVEL'R'       WUKFST           @Status Crt Vch
      * hpe taken control of updating the tattoo header because of jde.
     C                     ADD  1         WULPNB           TH AP Voucher/D
      * Rtv/Chg TH Vchr Info  XF - STR HPE Interface/OthSys  * 
     C                     CALL 'PKTKXFR'              90  Rtv/Chg TH Vchr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM A1HMNB    WQ0034  30       BOH Company Num
     C                     PARM A1BNNB    WQ0035  50       BOH Buy Order N
     C                     PARM A1BONB    WQ0036  50       BOL Load Number
     C                     PARM A1CVNB    WQ0037  50       TH Tattoo Numbe
     C                     PARM WULPNB    WQ0038  80       TH AP Voucher/D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKTKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'N'       WUKTST           @Status Kill Dt
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN A1HMNB    WZA001           BOH Company Num
     C                     Z-ADDA1HMNB    WZA001
     C           *LIKE     DEFN A1ABCD    WZA002           PD Producer Cod
     C                     MOVELA1ABCD    WZA002
     C           *LIKE     DEFN A1B0DT    WZA003           TH Kill Date
     C                     Z-ADDA1B0DT    WZA003
     C           *LIKE     DEFN A1CVNB    WZA004           TH Tattoo Numbe
     C                     Z-ADDA1CVNB    WZA004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@A1CPQN                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * Kill Date/ Also Check Held Over's
      * CASE: DB1.TH Kill Date LE PAR.TH Kill Date
     C           A1B0DT    IFLE P1B0DT                     *IF
      * Held over
      * CASE: DB1.TH Held Over NE WRK.Zero USR
     C           A1H9NB    IFNE WUE9NB                     *IF
      * CASE: DB1.TH Held/Ovr Completed Dte NE WRK.Zero USR
     C           A1BSDT    IFNE WUE9NB                     *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0AL01  1        PD Producer Cod
     C                     MOVEL*BLANK    W0AL02  1        TH Kill Date
     C                     MOVEL*BLANK    W0AL03  1        TH Tattoo Numbe
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        BOH Company Num
     C                     MOVEL'Y'       W0AL01  1        PD Producer Cod
     C                     MOVEL'Y'       W0AL02  1        TH Kill Date
     C                     MOVEL'Y'       W0AL03  1        TH Tattoo Numbe
     C                     ELSE
      * Next record - Detect level breaks
     C           A1HMNB    IFNE WZA001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           A1ABCD    IFNE WZA002                     PD Producer Cod
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           A1B0DT    IFNE WZA003                     TH Kill Date
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C           A1CVNB    IFNE WZA004                     TH Tattoo Numbe
     C           W0AL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL03
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP03
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
      * USER: Process after print of TH Kill Date format
      * CASE: PAR.@Status Edit/Post is Post
     C           P2J2ST    IFEQ 'P'                        *IF
      * Crt Live Vchr Totals  IF
      * CASE: WRK.Producer Code         USR NE WRK.Blank USR
     C           WUARCD    IFNE WUCRTX                     *IF
      * Rtv/Chg Voucher Hdr   RT - Hog Voucher Header  * 
     C                     EXSR SNRVGN
     C                     MOVEL'Y'       WUABST           @Status (Yes/No
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUABST           @Status (Yes/No
     C                     END                             *FI
     C                     Z-ADD*ZERO     WUAKVA           VCD Gross Amt
     C                     Z-ADD*ZERO     WUAMVA           VCD Net Amt
     C                     Z-ADD*ZERO     WUCVPR           VCD Less Split
     C                     Z-ADD*ZERO     WUCNPR           VCD Base Mkt Pr
     C                     Z-ADD*ZERO     WUCOPR           VCD Sort Disc A
     C                     Z-ADD*ZERO     WUCPPR           VCD Yield Gain/
     C                     Z-ADD*ZERO     WUCQPR           VCD Base Carcas
     C                     Z-ADD*ZERO     WUCRPR           VCD LN Add on/D
     C                     Z-ADD*ZERO     WUA9VA           Net Ded/Add amo
     C                     Z-ADD*ZERO     WUAUVA           VCH Gross Amt
     C                     Z-ADD*ZERO     WUAJVA           VCH Net Amt
     C                     Z-ADD*ZERO     WUAVVA           VCH Deduction A
     C                     Z-ADD*ZERO     WUCHPR           VCH Less Split
     C                     Z-ADD*ZERO     WUCIPR           VCH Base Mkt Pr
     C                     Z-ADD*ZERO     WUCJPR           VCH Sort Disc A
     C                     Z-ADD*ZERO     WUCKPR           VCH Yield Gain/
     C                     Z-ADD*ZERO     WUCLPR           VCH Base Carcas
     C                     Z-ADD*ZERO     WUCMPR           VCH LN Add on/D
      * Rtv/Chg PrcCd,CrtSplt RT - Hog Voucher Header  * 
     C                     EXSR SPRVGN
     C                     MOVEL'Y'       WUKTST           @Status Kill Dt
     C                     END                             *FI
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
      * USER: Process after print of PD Producer Code format
      * CASE: PAR.@Status Edit/Post is Post
     C           P2J2ST    IFEQ 'P'                        *IF
      * CASE: WRK.@Status Kill Dt Break is Yes
     C           WUKTST    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Crt Live Vchr Totals  IF
      * CASE: WRK.Producer Code         USR NE WRK.Blank USR
     C           WUARCD    IFNE WUCRTX                     *IF
      * Rtv/Chg Voucher Hdr   RT - Hog Voucher Header  * 
     C                     EXSR TARVGN
     C                     MOVEL'Y'       WUABST           @Status (Yes/No
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUABST           @Status (Yes/No
     C                     END                             *FI
     C                     Z-ADD*ZERO     WUAKVA           VCD Gross Amt
     C                     Z-ADD*ZERO     WUAMVA           VCD Net Amt
     C                     Z-ADD*ZERO     WUCVPR           VCD Less Split
     C                     Z-ADD*ZERO     WUCNPR           VCD Base Mkt Pr
     C                     Z-ADD*ZERO     WUCOPR           VCD Sort Disc A
     C                     Z-ADD*ZERO     WUCPPR           VCD Yield Gain/
     C                     Z-ADD*ZERO     WUCQPR           VCD Base Carcas
     C                     Z-ADD*ZERO     WUCRPR           VCD LN Add on/D
     C                     Z-ADD*ZERO     WUA9VA           Net Ded/Add amo
     C                     Z-ADD*ZERO     WUAUVA           VCH Gross Amt
     C                     Z-ADD*ZERO     WUAJVA           VCH Net Amt
     C                     Z-ADD*ZERO     WUAVVA           VCH Deduction A
     C                     Z-ADD*ZERO     WUCHPR           VCH Less Split
     C                     Z-ADD*ZERO     WUCIPR           VCH Base Mkt Pr
     C                     Z-ADD*ZERO     WUCJPR           VCH Sort Disc A
     C                     Z-ADD*ZERO     WUCKPR           VCH Yield Gain/
     C                     Z-ADD*ZERO     WUCLPR           VCH Base Carcas
     C                     Z-ADD*ZERO     WUCMPR           VCH LN Add on/D
      * Rtv/Chg PrcCd,CrtSplt RT - Hog Voucher Header  * 
     C                     EXSR TCRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of final totals format
      * CASE: WRK.@Status Crt Vch Rec usr is Records written
     C           WUKFST    IFEQ 'R'                        *IF
      * For Testing only Susan Mason will * out when through Testing
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$HFINTTL
     C                     END
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * PO BO Header: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN AWHMNB    WQKB01           BOH Company Num
     C           *LIKE     DEFN AWBNNB    WQKB02           BOH Buy Order N
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           BOH Company Num
     C                     KFLD           WQKB02           BOH Buy Order N
      * Setup key
     C                     Z-ADD$DHMNB    WQKB01           BOH Company Num
     C                     Z-ADD$DBNNB    WQKB02           BOH Buy Order N
      * Establish starting position
     C           KRSB      SETLL@AWCPBI                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        BOH Company Num
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDAWHMNB    $EHMNB           BOH Company Num
     C                     Z-ADDAWBNNB    $EBNNB           BOH Buy Order N
     C                     Z-ADDAWARDT    $EARDT           BOH Buy Order D
     C                     Z-ADDAWASDT    $EASDT           BOH Kill Date
     C                     MOVELAWA4ST    $EA4ST           BOH Payment Typ
     C                     MOVELAWA5ST    $EA5ST           BOH Buy Order T
     C                     Z-ADDAWAAPR    $EAAPR           BOH Market Add/
     C                     MOVELAWA6ST    $EA6ST           BOH Status
     C                     MOVELAWA7ST    $EA7ST           BOH Delv Plan P
     C                     MOVELAWB3ST    $EB3ST           BOH Quote Price
     C                     Z-ADDAWALPR    $EALPR           BOH Quoted Base
     C                     MOVELAWETCD    $EETCD           BOH Commodity M
     C                     MOVELAWEUCD    $EEUCD           BOH Commodity P
     C                     MOVELAWJ5TX    $EJ5TX           BOH Market Date
     C                     Z-ADDAWHXNB    $EHXNB           PPWS Company Nu
     C                     Z-ADDAWGANB    $EGANB           CW Year
     C                     Z-ADDAWGBNB    $EGBNB           CW Week Number
     C                     MOVELAWABCD    $EABCD           PD Producer Cod
     C                     MOVELAWAECD    $EAECD           PL Location Cod
     C                     MOVELAWAKCD    $EAKCD           PC Contract Cod
     C                     MOVELAWALCD    $EALCD           PSC Sub-Contrac
     C                     MOVELAWAGCD    $EAGCD           GN Genetic Code
     C                     MOVELAWAICD    $EAICD           PO Option Code
     C                     MOVELAWAMCD    $EAMCD           CMP Program Cod
     C                     MOVELAWACCD    $EACCD           HB Buyer Code
     C                     MOVELAWAAVN    $EAAVN           RS User Changed
     C                     Z-ADDAWAADT    $EAADT           RS Date Changed
     C                     Z-ADDAWAMTM    $EAMTM           RS Time Changed
     C                     MOVELAWAJST    $EAJST           RS Record Statu
     C                     MOVELAWAHVN    $EAHVN           RS Job
     C                     MOVELAWAGVN    $EAGVN           RS Program
     C                     MOVELAWABVN    $EABVN           RS User Added
     C                     Z-ADDAWABDT    $EABDT           RS Date Added
     C                     Z-ADDAWABTM    $EABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN AWHMNB    WZB001           BOH Company Num
     C                     Z-ADDAWHMNB    WZB001
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@AWCPBI                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        BOH Company Num
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        BOH Company Num
     C                     ELSE
      * Next record - Detect level breaks
     C           AWHMNB    IFNE WZB001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         C0MAIN    BEGSR
      *================================================================
      * Prt Tattoo Ded/Add    PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN CDHMNB    WQKC01           BOH Company Num
     C           *LIKE     DEFN CDBNNB    WQKC02           BOH Buy Order N
     C           *LIKE     DEFN CDBONB    WQKC03           BOL Load Number
     C           *LIKE     DEFN CDCVNB    WQKC04           TH Tattoo Numbe
     C           *LIKE     DEFN CDB0DT    WQKC05           TH Kill Date
      * Define keylist
     C           KRSC      KLIST
     C                     KFLD           WQKC01           BOH Company Num
     C                     KFLD           WQKC02           BOH Buy Order N
     C                     KFLD           WQKC03           BOL Load Number
     C                     KFLD           WQKC04           TH Tattoo Numbe
     C                     KFLD           WQKC05           TH Kill Date
      * Setup key
     C                     Z-ADD$DHMNB    WQKC01           BOH Company Num
     C                     Z-ADD$DBNNB    WQKC02           BOH Buy Order N
     C                     Z-ADD$DBONB    WQKC03           BOL Load Number
     C                     Z-ADD$DCVNB    WQKC04           TH Tattoo Numbe
     C                     Z-ADD$DB0DT    WQKC05           TH Kill Date
      * Establish starting position
     C           KRSC      SETLL@CDCPIU                    *
      * Read first record with user selection
     C                     EXSR C3READ
     C           W0EOFC    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0CL1P  1        First page
     C                     MOVEL'Y'       W0CL00  1        BOH Company Num
     C                     MOVEL'Y'       W0CL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0CL02  1        BOL Load Number
     C                     MOVEL'Y'       W0CL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0CL04  1        TH Kill Date
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      * Print report body
     C           W0EOFC    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR C1PHDR
      * Print report detail line
     C                     EXSR C2PDTL
      * Read next record with user selection
     C                     EXSR C3READ
      * Print totals
     C                     EXSR C4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         C0EXIT    ENDSR
      /EJECT
     CSR         C1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0CL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP1P  1
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP00  1
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP01  1
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP02  1
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP03  1
     C                     END
      *
     C           W0CL04    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDCDHMNB    $GHMNB           BOH Company Num
     C                     Z-ADDCDBNNB    $GBNNB           BOH Buy Order N
     C                     Z-ADDCDBONB    $GBONB           BOL Load Number
     C                     Z-ADDCDCVNB    $GCVNB           TH Tattoo Numbe
     C                     Z-ADDCDB0DT    $GB0DT           TH Kill Date
     C                     MOVELCDBQCD    $GBQCD           DED D/A Code
     C                     Z-ADDCDAZVA    $GAZVA           THD Unit Amt
     C                     Z-ADDCDA0VA    $GA0VA           THD Ded/Add Amo
     C                     MOVELCDJBST    $GJBST           THD Unit Amt Si
     C                     MOVELCDEIST    $GEIST           THD UOM
     C                     MOVELCDJDST    $GJDST           THD Transaction
     C                     MOVELCDDPCD    $GDPCD           THD GL Code
     C                     MOVELCDAAVN    $GAAVN           RS User Changed
     C                     Z-ADDCDAADT    $GAADT           RS Date Changed
     C                     Z-ADDCDAMTM    $GAMTM           RS Time Changed
     C                     MOVELCDAJST    $GAJST           RS Record Statu
     C                     MOVELCDAHVN    $GAHVN           RS Job
     C                     MOVELCDAGVN    $GAGVN           RS Program
     C                     MOVELCDABVN    $GABVN           RS User Added
     C                     Z-ADDCDABDT    $GABDT           RS Date Added
     C                     Z-ADDCDABTM    $GABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP04  1
     C                     END
      *
      *================================================================
     CSR         C1EXIT    ENDSR
      /EJECT
     CSR         C2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDCDHMNB    $FHMNB           BOH Company Num
     C                     Z-ADDCDBNNB    $FBNNB           BOH Buy Order N
     C                     Z-ADDCDBONB    $FBONB           BOL Load Number
     C                     Z-ADDCDCVNB    $FCVNB           TH Tattoo Numbe
     C                     Z-ADDCDB0DT    $FB0DT           TH Kill Date
     C                     MOVELCDBQCD    $FBQCD           DED D/A Code
     C                     Z-ADDCDAZVA    $FAZVA           THD Unit Amt
     C                     Z-ADDCDA0VA    $FA0VA           THD Ded/Add Amo
     C                     MOVELCDJBST    $FJBST           THD Unit Amt Si
     C                     MOVELCDEIST    $FEIST           THD UOM
     C                     MOVELCDJDST    $FJDST           THD Transaction
     C                     MOVELCDDPCD    $FDPCD           THD GL Code
     C                     MOVELCDE3CD    $FE3CD           THD Contra Gl C
     C                     Z-ADDCDAQNB    $FAQNB           THD Re-imbursem
     C                     MOVELCDOCST    $FOCST           THD Payment Sts
     C                     MOVELCDAAVN    $FAAVN           RS User Changed
     C                     Z-ADDCDAADT    $FAADT           RS Date Changed
     C                     Z-ADDCDAMTM    $FAMTM           RS Time Changed
     C                     MOVELCDAJST    $FAJST           RS Record Statu
     C                     MOVELCDAHVN    $FAHVN           RS Job
     C                     MOVELCDAGVN    $FAGVN           RS Program
     C                     MOVELCDABVN    $FABVN           RS User Added
     C                     Z-ADDCDABDT    $FABDT           RS Date Added
     C                     Z-ADDCDABTM    $FABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         C2EXIT    ENDSR
      /EJECT
     CSR         C3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN CDHMNB    WZC001           BOH Company Num
     C                     Z-ADDCDHMNB    WZC001
     C           *LIKE     DEFN CDBNNB    WZC002           BOH Buy Order N
     C                     Z-ADDCDBNNB    WZC002
     C           *LIKE     DEFN CDBONB    WZC003           BOL Load Number
     C                     Z-ADDCDBONB    WZC003
     C           *LIKE     DEFN CDCVNB    WZC004           TH Tattoo Numbe
     C                     Z-ADDCDCVNB    WZC004
     C           *LIKE     DEFN CDB0DT    WZC005           TH Kill Date
     C                     Z-ADDCDB0DT    WZC005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFC    OREQ '1'
     C           KRSC      READE@CDCPIU                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFC  1
      * Quit if no record read
     C           W0EOFC    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0CL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0CL01  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0CL02  1        BOL Load Number
     C                     MOVEL*BLANK    W0CL03  1        TH Tattoo Numbe
     C                     MOVEL*BLANK    W0CL04  1        TH Kill Date
     C           W0EOFC    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0CL00  1        BOH Company Num
     C                     MOVEL'Y'       W0CL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0CL02  1        BOL Load Number
     C                     MOVEL'Y'       W0CL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0CL04  1        TH Kill Date
     C                     ELSE
      * Next record - Detect level breaks
     C           CDHMNB    IFNE WZC001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL00
     C                     END
     C           CDBNNB    IFNE WZC002                     BOH Buy Order N
     C           W0CL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL01
     C                     END
     C           CDBONB    IFNE WZC003                     BOL Load Number
     C           W0CL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL02
     C                     END
     C           CDCVNB    IFNE WZC004                     TH Tattoo Numbe
     C           W0CL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL03
     C                     END
     C           CDB0DT    IFNE WZC005                     TH Kill Date
     C           W0CL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL04
     C                     END
     C                     END
      *================================================================
     CSR         C3EXIT    ENDSR
      /EJECT
     CSR         C4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0CL04    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 3
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
     C                     MOVEL'0'       *IN79
     C           $DHMNB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$GKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP04
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP03
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP02
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP01
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP00
     C                     END
      *
     C           W0EOFC    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         C4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of Prt Payment Edit/pst wrka
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Prt Payment Edit/pst wrka
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Print format
     C                     WRITE$C1STPAG
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print BOH Company Number of Prt Payment Edit/pst wrka
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print PD Producer Code of Prt Payment Edit/pst wrka
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print TH Kill Date of Prt Payment Edit/pst wrka
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print TH Tattoo Number of Prt Payment Edit/pst wrka
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP03
     C                     END                             FI
      * Print Detail line. of Prt Payment Edit/pst wrka
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
      * Convert fields to external form
      * Convert TH Kill Date to display format
     C           1000000   ADD  $DB0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDB0DT
      * Convert TH Purchase Date to display format
     C           1000000   ADD  $DAWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDAWDT
      * Convert TH Resale Invoice Date to display format
     C           1000000   ADD  $DA6DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDA6DT
     C                     MOVEL'0'       *IN79
     C           $DCWST    IFEQ 'ML'                       *IF
     C           $DCWST    OREQ 'SL'
     C           $DCWST    OREQ 'SC'
     C           $DCWST    OREQ 'IC'
     C           $DCWST    OREQ 'IL'
     C           $DCWST    OREQ *BLANK
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           $DH9NB    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$DCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$DDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of PO BO Header
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print BOH Company Number of PO BO Header
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print Detail line. of PO BO Header
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
      * Convert fields to external form
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$ECOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$EDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print First Page Format of Prt Tattoo Ded/Add    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0CL1P
     C                     END                             FI
      * Print BOH Company Number of Prt Tattoo Ded/Add    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP00
     C                     END                             FI
      * Print BOH Buy Order Number of Prt Tattoo Ded/Add    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP01
     C                     END                             FI
      * Print BOL Load Number of Prt Tattoo Ded/Add    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP02
     C                     END                             FI
      * Print TH Tattoo Number of Prt Tattoo Ded/Add    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP03
     C                     END                             FI
      * Print TH Kill Date of Prt Tattoo Ded/Add    PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP04
     C                     END                             FI
      * Print Detail line. of Prt Tattoo Ded/Add    PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0CCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CPDT    ANDEQ'P'
      * Convert fields to external form
      * Print column headings if required
     C           W0CCDT    IFEQ 'Y'
     C                     WRITE$FCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0CCDT
     C                     END                             FI
      * Print format
     C                     WRITE$FDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C                     Z-ADD@$CLN     W0FSUM  30
     C                     Z-ADD*ZERO     W0DTLN  30
     C                     Z-ADD*ZERO     W0COLN  30
      * * First Page Format of Prt Payment Edit/pst wrka
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt Payment Edit/pst wrka
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * PD Producer Code of Prt Payment Edit/pst wrka
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Prt Payment Edit/pst wrka
     C           W0AP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt Payment Edit/pst wrka
     C           W0AP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Payment Edit/pst wrka
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD6         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD5         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of PO BO Header
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of PO BO Header
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of PO BO Header
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Tattoo Ded/Add    PO
     C           W0CP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt Tattoo Ded/Add    PO
     C           W0CP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of Prt Tattoo Ded/Add    PO
     C           W0CP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of Prt Tattoo Ded/Add    PO
     C           W0CP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt Tattoo Ded/Add    PO
     C           W0CP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Prt Tattoo Ded/Add    PO
     C           W0CP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Tattoo Ded/Add    PO
     C           W0CPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0CCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
     C                     Z-ADDP1B0DT    $BB0DT           TH Kill Date
      * Convert fields to external form
      * Convert TH Kill Date to display format
     C           1000000   ADD  $BB0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBB0DT
     C                     MOVEL'0'       *IN79
     C           P2J2ST    IFEQ 'E'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           P2J2ST    IFEQ 'P'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Nxt Vch Batch #   RT - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BKHNNB    WQSA01           VCH Company num
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           VCH Company num
      * Setup key
     C                     Z-ADDP1HMNB    WQSA01           VCH Company num
      * Establish starting position
     C           KRSSA     SETLL@BKCPN2                    *
     C           KRSSA     READE@BKCPN2                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0099' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WULWNB           VCH Batch Numbe
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           BKLWNB    ADD  1         WULWNB           VCH Batch Numbe
     C                     GOTO SAEXIT                     *QUIT
     C           KRSSA     READE@BKCPN2                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCRRC    BEGSR
      *================================================================
      * Create Tattoo Header Driv - Tattoo Header Driver  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @C6CPPW
     C                     Z-ADDWUN5NB    C6N5NB           Tattoo Sequence
     C                     MOVE *BLANK    C6IOTX           Tattoo Header A
     C                     MOVEL'Carc Sum'C6IOTX           Tattoo Header A
     C                     Z-ADD$DLPNB    C6LPNB           TH AP Voucher/D
     C                     Z-ADD$DBYDT    C6BYDT           TH Voucher Paym
     C                     Z-ADD$DHMNB    C6HMNB           BOH Company Num
     C                     Z-ADD$DBNNB    C6BNNB           BOH Buy Order N
     C                     Z-ADD$DBONB    C6BONB           BOL Load Number
     C                     Z-ADD$DCVNB    C6CVNB           TH Tattoo Numbe
     C                     Z-ADD$DB0DT    C6B0DT           TH Kill Date
     C                     MOVEL$DAAVN    C6AAVN           RS User Changed
     C                     Z-ADD$DAADT    C6AADT           RS Date Changed
     C                     Z-ADD$DAMTM    C6AMTM           RS Time Changed
     C                     MOVEL$DAJST    C6AJST           RS Record Statu
     C                     MOVEL$DAHVN    C6AHVN           RS Job
     C                     MOVEL$DAGVN    C6AGVN           RS Program
     C                     MOVEL$DABVN    C6ABVN           RS User Added
     C                     Z-ADD$DABDT    C6ABDT           RS Date Added
     C                     Z-ADD$DABTM    C6ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       C6AJST           RS Record Statu
     C                     MOVEL##USR     C6ABVN           RS User Added
     C                     Z-ADD##JDT     C6ABDT           RS Date Added
     C                     Z-ADD##JTM     C6ABTM           RS Time Added
     C                     MOVEL##PGM     C6AGVN           RS Program
     C                     MOVEL##JOB     C6AHVN           RS Job
     C           KLCRSB    KLIST
     C                     KFLD           C6N5NB           Tattoo Sequence
      * Check for duplicate primary key
     C           KLCRSB    SETLL@C6CPPW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0449' W0RTN   7
      * Send message 'Tattoo Header Driver   EX'
     C                     MOVEL'PRK0449' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C                     WRITE@C6CPPW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCRRC    BEGSR
      *================================================================
      * Create Tattoo Header Driv - Tattoo Header Driver  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @C6CPPW
     C                     Z-ADDWUN5NB    C6N5NB           Tattoo Sequence
     C                     MOVEL@CN,01    C6IOTX           Tattoo Header A
     C                     Z-ADD$DLPNB    C6LPNB           TH AP Voucher/D
     C                     Z-ADD$DBYDT    C6BYDT           TH Voucher Paym
     C                     Z-ADD$DHMNB    C6HMNB           BOH Company Num
     C                     Z-ADD$DBNNB    C6BNNB           BOH Buy Order N
     C                     Z-ADD$DBONB    C6BONB           BOL Load Number
     C                     Z-ADD$DCVNB    C6CVNB           TH Tattoo Numbe
     C                     Z-ADD$DB0DT    C6B0DT           TH Kill Date
     C                     MOVEL$DAAVN    C6AAVN           RS User Changed
     C                     Z-ADD$DAADT    C6AADT           RS Date Changed
     C                     Z-ADD$DAMTM    C6AMTM           RS Time Changed
     C                     MOVEL$DAJST    C6AJST           RS Record Statu
     C                     MOVEL$DAHVN    C6AHVN           RS Job
     C                     MOVEL$DAGVN    C6AGVN           RS Program
     C                     MOVEL$DABVN    C6ABVN           RS User Added
     C                     Z-ADD$DABDT    C6ABDT           RS Date Added
     C                     Z-ADD$DABTM    C6ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       C6AJST           RS Record Statu
     C                     MOVEL##USR     C6ABVN           RS User Added
     C                     Z-ADD##JDT     C6ABDT           RS Date Added
     C                     Z-ADD##JTM     C6ABTM           RS Time Added
     C                     MOVEL##PGM     C6AGVN           RS Program
     C                     MOVEL##JOB     C6AHVN           RS Job
     C           KLCRSC    KLIST
     C                     KFLD           C6N5NB           Tattoo Sequence
      * Check for duplicate primary key
     C           KLCRSC    SETLL@C6CPPW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0449' W0RTN   7
      * Send message 'Tattoo Header Driver   EX'
     C                     MOVEL'PRK0449' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C                     WRITE@C6CPPW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCRRC    BEGSR
      *================================================================
      * Create Tattoo Header Driv - Tattoo Header Driver  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @C6CPPW
     C                     Z-ADDWUN5NB    C6N5NB           Tattoo Sequence
     C                     MOVE *BLANK    C6IOTX           Tattoo Header A
     C                     MOVEL'Carc Sum'C6IOTX           Tattoo Header A
     C                     Z-ADD$DLPNB    C6LPNB           TH AP Voucher/D
     C                     Z-ADD$DBYDT    C6BYDT           TH Voucher Paym
     C                     Z-ADD$DHMNB    C6HMNB           BOH Company Num
     C                     Z-ADD$DBNNB    C6BNNB           BOH Buy Order N
     C                     Z-ADD$DBONB    C6BONB           BOL Load Number
     C                     Z-ADD$DCVNB    C6CVNB           TH Tattoo Numbe
     C                     Z-ADD$DB0DT    C6B0DT           TH Kill Date
     C                     MOVEL$DAAVN    C6AAVN           RS User Changed
     C                     Z-ADD$DAADT    C6AADT           RS Date Changed
     C                     Z-ADD$DAMTM    C6AMTM           RS Time Changed
     C                     MOVEL$DAJST    C6AJST           RS Record Statu
     C                     MOVEL$DAHVN    C6AHVN           RS Job
     C                     MOVEL$DAGVN    C6AGVN           RS Program
     C                     MOVEL$DABVN    C6ABVN           RS User Added
     C                     Z-ADD$DABDT    C6ABDT           RS Date Added
     C                     Z-ADD$DABTM    C6ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       C6AJST           RS Record Statu
     C                     MOVEL##USR     C6ABVN           RS User Added
     C                     Z-ADD##JDT     C6ABDT           RS Date Added
     C                     Z-ADD##JTM     C6ABTM           RS Time Added
     C                     MOVEL##PGM     C6AGVN           RS Program
     C                     MOVEL##JOB     C6AHVN           RS Job
     C           KLCRSD    KLIST
     C                     KFLD           C6N5NB           Tattoo Sequence
      * Check for duplicate primary key
     C           KLCRSD    SETLL@C6CPPW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0449' W0RTN   7
      * Send message 'Tattoo Header Driver   EX'
     C                     MOVEL'PRK0449' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C                     WRITE@C6CPPW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * Create Tattoo Header Driv - Tattoo Header Driver  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @C6CPPW
     C                     Z-ADDWUN5NB    C6N5NB           Tattoo Sequence
     C                     MOVEL@CN,01    C6IOTX           Tattoo Header A
     C                     Z-ADD$DLPNB    C6LPNB           TH AP Voucher/D
     C                     Z-ADD$DBYDT    C6BYDT           TH Voucher Paym
     C                     Z-ADD$DHMNB    C6HMNB           BOH Company Num
     C                     Z-ADD$DBNNB    C6BNNB           BOH Buy Order N
     C                     Z-ADD$DBONB    C6BONB           BOL Load Number
     C                     Z-ADD$DCVNB    C6CVNB           TH Tattoo Numbe
     C                     Z-ADD$DB0DT    C6B0DT           TH Kill Date
     C                     MOVEL$DAAVN    C6AAVN           RS User Changed
     C                     Z-ADD$DAADT    C6AADT           RS Date Changed
     C                     Z-ADD$DAMTM    C6AMTM           RS Time Changed
     C                     MOVEL$DAJST    C6AJST           RS Record Statu
     C                     MOVEL$DAHVN    C6AHVN           RS Job
     C                     MOVEL$DAGVN    C6AGVN           RS Program
     C                     MOVEL$DABVN    C6ABVN           RS User Added
     C                     Z-ADD$DABDT    C6ABDT           RS Date Added
     C                     Z-ADD$DABTM    C6ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       C6AJST           RS Record Statu
     C                     MOVEL##USR     C6ABVN           RS User Added
     C                     Z-ADD##JDT     C6ABDT           RS Date Added
     C                     Z-ADD##JTM     C6ABTM           RS Time Added
     C                     MOVEL##PGM     C6AGVN           RS Program
     C                     MOVEL##JOB     C6AHVN           RS Job
     C           KLCRSE    KLIST
     C                     KFLD           C6N5NB           Tattoo Sequence
      * Check for duplicate primary key
     C           KLCRSE    SETLL@C6CPPW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0449' W0RTN   7
      * Send message 'Tattoo Header Driver   EX'
     C                     MOVEL'PRK0449' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@C6CPPW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Nxt Vch Header#   RT - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHNNB    WQSF01           VCH Company num
     C           *LIKE     DEFN WALWNB    WQSF02           VCH Batch Numbe
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           VCH Company num
     C                     KFLD           WQSF02           VCH Batch Numbe
      * Setup key
     C                     Z-ADD$DHMNB    WQSF01           VCH Company num
     C                     Z-ADDWULWNB    WQSF02           VCH Batch Numbe
      * Establish starting position
     C           KRSSF     SETLL@BKCPJR                    *
     C           KRSSF     READE@BKCPJR                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0099' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD00001     WUG9NB           VCH Header Numb
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WAG9NB    ADD  1         WUG9NB           VCH Header Numb
     C                     GOTO SFEXIT                     *QUIT
     C           KRSSF     READE@BKCPJR                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Producer Split    RT - Producer Std Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           BFABCD           PD Producer Cod
     C                     KFLD           BFBTCD           BOS Split Produ
      * Setup key
     C                     MOVEL$DABCD    BFABCD           PD Producer Cod
     C                     MOVEL$DABCD    BFBTCD           BOS Split Produ
      * Establish starting position
     C           KRSSG     CHAIN@BFREE4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0089' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD100       WUBUPC           PSS Split Perce
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBFABPC    WUBUPC           PSS Split Perce
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Prdcr Vendor#,Src RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVEL$DABCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSSH     CHAIN@ACREAI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0009' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WULXNB           PD VND Address
     C                     MOVEL*BLANK    WUAACD           SR Source Code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDACGCNB    WULXNB           PD VND Address
     C                     MOVELACAACD    WUAACD           SR Source Code
     C                     GOTO SHEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICRRC    BEGSR
      *================================================================
      * Crt Voucher Header    CR - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BKCPEK
     C                     Z-ADD$DHMNB    BKHNNB           VCH Company num
     C                     Z-ADDWULWNB    BKLWNB           VCH Batch Numbe
     C                     Z-ADDWUG9NB    BKG9NB           VCH Header Numb
     C                     Z-ADDWULXNB    BKLXNB           VCH AP Address
     C                     Z-ADD*ZERO     BKLYNB           VCH AP Voucher
     C                     MOVELWUCSST    BKCSST           VCH Payee Type
     C                     Z-ADD*ZERO     BKDKNB           VCH Manual Chec
     C                     Z-ADD*ZERO     BKA2DT           VCH Manual Chec
     C                     Z-ADD*ZERO     BKCIPR           VCH Base Mkt Pr
     C                     Z-ADD*ZERO     BKCJPR           VCH Sort Disc A
     C                     Z-ADD*ZERO     BKCKPR           VCH Yield Gain/
     C                     Z-ADD*ZERO     BKCLPR           VCH Base Carcas
     C                     Z-ADD*ZERO     BKCMPR           VCH LN Add on/D
     C                     Z-ADD*ZERO     BKAUVA           VCH Gross Amt
     C                     Z-ADD*ZERO     BKAVVA           VCH Deduction A
     C                     Z-ADD*ZERO     BKCHPR           VCH Less Split
     C                     Z-ADD*ZERO     BKAJVA           VCH Net Amt
     C                     Z-ADDWUBUPC    BKBUPC           VCH Split %
     C                     MOVEL'N'       BKJHST           VCH Split Check
     C                     MOVEL'O'       BKC0ST           VCH Process Sta
     C                     Z-ADD$DB0DT    BKA4DT           VCH G/L Date
     C                     MOVEL'R'       BKCUST           VCH Check Type
     C                     MOVEL$DABCD    BKABCD           PD Producer Cod
     C                     MOVEL*BLANK    BKBNCD           TRK Trucker Cod
     C                     MOVEL*BLANK    BKCFCD           VR Reason Code
     C                     MOVEL*BLANK    BKAAVN           RS User Changed
     C                     Z-ADD*ZERO     BKAADT           RS Date Changed
     C                     Z-ADD*ZERO     BKAMTM           RS Time Changed
     C                     MOVEL'A'       BKAJST           RS Record Statu
     C                     MOVEL*BLANK    BKAHVN           RS Job
     C                     MOVEL*BLANK    BKAGVN           RS Program
     C                     MOVEL*BLANK    BKABVN           RS User Added
     C                     Z-ADD*ZERO     BKABDT           RS Date Added
     C                     Z-ADD*ZERO     BKABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       BKAJST           RS Record Statu
     C                     MOVEL##USR     BKABVN           RS User Added
     C                     Z-ADD##JDT     BKABDT           RS Date Added
     C                     Z-ADD##JTM     BKABTM           RS Time Added
     C                     MOVEL##PGM     BKAGVN           RS Program
     C                     MOVEL##JOB     BKAHVN           RS Job
     C           KLCRSI    KLIST
     C                     KFLD           BKHNNB           VCH Company num
     C                     KFLD           BKLWNB           VCH Batch Numbe
     C                     KFLD           BKG9NB           VCH Header Numb
      * Check for duplicate primary key
     C           KLCRSI    SETLL@BKCPEK                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0100' W0RTN   7
      * Send message 'Hog Voucher Header     EX'
     C                     MOVEL'PRK0100' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C                     WRITE@BKCPEK                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Prt Crc Sum (Hld Ovr) RT - Tattoo Header  * 
      *================================================================
      * Clear all neither parameters
     C                     Z-ADD*ZERO     WN0004  72       TH CA Base Mkt
     C                     Z-ADD*ZERO     WN0005  72       TH CA Sort Disc
     C                     Z-ADD*ZERO     WN0006  72       TH CA Yield Gai
     C                     Z-ADD*ZERO     WN0007  72       TH CA Base Carc
     C                     Z-ADD*ZERO     WN0008  72       TH CA Lean Prem
     C                     Z-ADD*ZERO     WN0009  72       TH CA Carcass G
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUHBST           First Time Flag
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUB5DT           TH Kill Date
     C                     Z-ADD*ZERO     WUCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WUFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WUFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WUFENB           TH Head Killed
     C                     Z-ADD*ZERO     WUHENB           TH Head Adds
     C                     Z-ADD*ZERO     WUCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WULRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WUE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WUANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WUAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WUAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WUAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WUAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WUAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WUASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WUATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WUA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WUCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WUCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WN0001           Lean % * Wgt US
     C                     Z-ADD*ZERO     WN0002           Backfat * Wgt U
     C                     Z-ADD*ZERO     WN0003           Loin-Eye * Wgt
     C                     Z-ADD*ZERO     WN0004           TH CA Base Mkt
     C                     Z-ADD*ZERO     WN0005           TH CA Sort Disc
     C                     Z-ADD*ZERO     WN0006           TH CA Yield Gai
     C                     Z-ADD*ZERO     WN0007           TH CA Base Carc
     C                     Z-ADD*ZERO     WN0008           TH CA Lean Prem
     C                     Z-ADD*ZERO     WN0009           TH CA Carcass G
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQSJ01           BOH Company Num
     C           *LIKE     DEFN WBBNNB    WQSJ02           BOH Buy Order N
     C           *LIKE     DEFN WBBONB    WQSJ03           BOL Load Number
     C           *LIKE     DEFN WBCVNB    WQSJ04           TH Tattoo Numbe
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           BOH Company Num
     C                     KFLD           WQSJ02           BOH Buy Order N
     C                     KFLD           WQSJ03           BOL Load Number
     C                     KFLD           WQSJ04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADD$DHMNB    WQSJ01           BOH Company Num
     C                     Z-ADD$DBNNB    WQSJ02           BOH Buy Order N
     C                     Z-ADD$DBONB    WQSJ03           BOL Load Number
     C                     Z-ADD$DCVNB    WQSJ04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSJ     SETLL@A1CPC4                    *
     C           KRSSJ     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * First Kill Date
      * CASE: WRK.First Time Flag Usr is Yes
     C           WUHBST    IFEQ 'Y'                        *IF
     C                     Z-ADDWBB0DT    WUB5DT           TH Kill Date
     C                     MOVEL'N'       WUHBST           First Time Flag
     C                     END                             *FI
     C                     ADD  WBCWNB    WUCWNB           TH Head Receive
     C                     ADD  WBFCNB    WUFCNB           TH Yard Deads
     C                     ADD  WBFDNB    WUFDNB           TH Head Condemn
     C                     ADD  WBFENB    WUFENB           TH Head Killed
     C                     ADD  WBHENB    WUHENB           TH Head Adds
     C                     ADD  WBCYNB    WUCYNB           TH Live Wgt
     C                     ADD  WBLRNB    WULRNB           TH Adj Live Wgt
     C                     ADD  WBE0NB    WUE0NB           TH Hot Wgt
     C                     ADD  WBANPR    WUANPR           TH CM Base Mkt
     C                     ADD  WBAYVA    WUAYVA           TH CM Sort Disc
     C                     ADD  WBAWVA    WUAWVA           TH CM Yield Gai
     C                     ADD  WBAOPR    WUAOPR           TH CM Base Carc
     C                     ADD  WBAXVA    WUAXVA           TH CM LN AddOn/
     C                     ADD  WBAPPR    WUAPPR           TH CM Carcass G
     C                     ADD  WBATPR    WUATPR           TH Carcass Net
     C                     ADD  WBCBPR    WUCBPR           TH Payment Gros
     C                     ADD  WBCCPR    WUCCPR           Th Payment Net
      * Lean % * Wgt USR
      * PAR.Lean % * Wgt USR =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.Lean % * Wgt USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.TH Avg Lean Percent
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : DB1.TH Hot Wgt
     C           WBF4NB    MULT WBE0NB    W0WD01           *Synon (17,7) w
     C           WN0001    ADD  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0001           Lean % * Wgt US
      * Backfat * Wgt USR
      * PAR.Backfat * Wgt USR =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.Backfat * Wgt USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.TH Avg Backfat
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : DB1.TH Hot Wgt
     C           WBF2NB    MULT WBE0NB    W0WD01           *Synon (17,7) w
     C           WN0002    ADD  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0002           Backfat * Wgt U
      * Loin-Eye * Wgt USR
      * PAR.Loin-Eye * Wgt USR =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.Loin-Eye * Wgt USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.TH Avg Loin Eye Depth
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : DB1.TH Hot Wgt
     C           WBF3NB    MULT WBE0NB    W0WD01           *Synon (17,7) w
     C           WN0003    ADD  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0003           Loin-Eye * Wgt
     C                     ADD  WBASPR    WUASPR           TH Deduction Am
     C                     ADD  WBA5VA    WUA5VA           TH Additions Am
      * Analysis to Payments
      * CASE: PAR.Print Carcass Analysis Us is Yes
     C           WUMVST    IFEQ 'Y'                        *IF
      * Prt Crc Sum (Hld Ovr) RT - Tattoo Header EXT  * 
     C                     EXSR SKRVGN
     C                     ADD  WUI6PR    WN0004           TH CA Base Mkt
     C                     ADD  WUI7PR    WN0005           TH CA Sort Disc
     C                     ADD  WUI8PR    WN0006           TH CA Yield Gai
     C                     ADD  WUI9PR    WN0007           TH CA Base Carc
     C                     ADD  WUJAPR    WN0008           TH CA Lean Prem
     C                     ADD  WUJCPR    WN0009           TH CA Carcass G
     C                     END                             *FI
     C           KRSSJ     READE@A1CPC4                  90*
     C                     ENDDO
      * USER: Exit processing
      * Analysis to Payments
      * CASE: PAR.Print Carcass Analysis Us is Yes
     C           WUMVST    IFEQ 'Y'                        *IF
     C                     Z-ADDWN0004    WUANPR           TH CM Base Mkt
     C                     Z-ADDWN0005    WUAYVA           TH CM Sort Disc
     C                     Z-ADDWN0006    WUAWVA           TH CM Yield Gai
     C                     Z-ADDWN0007    WUAOPR           TH CM Base Carc
     C                     Z-ADDWN0008    WUAXVA           TH CM LN AddOn/
     C                     Z-ADDWN0009    WUAPPR           TH CM Carcass G
     C                     END                             *FI
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Prt Crc Sum (Hld Ovr) RT - Tattoo Header EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           DNHMNB           BOH Company Num
     C                     KFLD           DNBNNB           BOH Buy Order N
     C                     KFLD           DNBONB           BOL Load Number
     C                     KFLD           DNCVNB           TH Tattoo Numbe
     C                     KFLD           DNB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDWBHMNB    DNHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    DNBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    DNBONB           BOL Load Number
     C                     Z-ADDWBCVNB    DNCVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    DNB0DT           TH Kill Date
      * Establish starting position
     C           KRSSK     CHAIN@DNCPUY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0637' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUI6PR           TH CA Base Mkt
     C                     Z-ADD*ZERO     WUI7PR           TH CA Sort Disc
     C                     Z-ADD*ZERO     WUI8PR           TH CA Yield Gai
     C                     Z-ADD*ZERO     WUI9PR           TH CA Base Carc
     C                     Z-ADD*ZERO     WUJAPR           TH CA Lean Prem
     C                     Z-ADD*ZERO     WUJCPR           TH CA Carcass G
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDNI6PR    WUI6PR           TH CA Base Mkt
     C                     Z-ADDDNI7PR    WUI7PR           TH CA Sort Disc
     C                     Z-ADDDNI8PR    WUI8PR           TH CA Yield Gai
     C                     Z-ADDDNI9PR    WUI9PR           TH CA Base Carc
     C                     Z-ADDDNJAPR    WUJAPR           TH CA Lean Prem
     C                     Z-ADDDNJCPR    WUJCPR           TH CA Carcass G
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv BOH Py Typ,BO Typ RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           AWHMNB           BOH Company Num
     C                     KFLD           AWBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADD$DHMNB    AWHMNB           BOH Company Num
     C                     Z-ADD$DBNNB    AWBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSSL     CHAIN@AWCPBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0049' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'L'       WUA4ST           BOH Payment Typ
     C                     MOVEL'O'       WUA5ST           BOH Buy Order T
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAWA4ST    WUA4ST           BOH Payment Typ
     C                     MOVELAWA5ST    WUA5ST           BOH Buy Order T
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCRRC    BEGSR
      *================================================================
      * Crt Voucher Detail    CR - Hog Voucher Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BLCPEI
     C                     Z-ADD$DHMNB    BLHNNB           VCH Company num
     C                     Z-ADDWULWNB    BLLWNB           VCH Batch Numbe
     C                     Z-ADDWUG9NB    BLG9NB           VCH Header Numb
     C                     Z-ADDWUDLNB    BLDLNB           VCD Line
     C                     Z-ADDWUANPR    BLCNPR           VCD Base Mkt Pr
     C                     Z-ADDWUAYVA    BLCOPR           VCD Sort Disc A
     C                     Z-ADDWUAWVA    BLCPPR           VCD Yield Gain/
     C                     Z-ADDWUAOPR    BLCQPR           VCD Base Carcas
     C                     Z-ADDWUAXVA    BLCRPR           VCD LN Add on/D
     C                     Z-ADDWUCBPR    BLAKVA           VCD Gross Amt
     C                     Z-ADDWUA9VA    BLALVA           VCD Deduction A
     C                     Z-ADDWUCVPR    BLCVPR           VCD Less Split
     C                     Z-ADDWUAMVA    BLAMVA           VCD Net Amt
     C                     Z-ADDWUBUPC    BLAEPC           VCD Split Perce
     C                     MOVEL$DJ9ST    BLI6ST           VCD Payment Typ
     C                     MOVELWUJIST    BLJIST           VCD Hog Class T
     C                     MOVELWUA5ST    BLJPST           VCD BO Type
     C                     MOVEL*BLANK    BLJQST           VCD Unused Sts
     C                     MOVELWUF5TX    BLF5TX           VCD Check Descr
     C                     Z-ADD$DHMNB    BLHMNB           BOH Company Num
     C                     Z-ADD$DBNNB    BLBNNB           BOH Buy Order N
     C                     Z-ADD$DBONB    BLBONB           BOL Load Number
     C                     Z-ADD$DCVNB    BLCVNB           TH Tattoo Numbe
     C                     Z-ADD$DB0DT    BLB0DT           TH Kill Date
     C                     MOVEL*BLANK    BLAAVN           RS User Changed
     C                     Z-ADD*ZERO     BLAADT           RS Date Changed
     C                     Z-ADD*ZERO     BLAMTM           RS Time Changed
     C                     MOVEL'A'       BLAJST           RS Record Statu
     C                     MOVEL*BLANK    BLAHVN           RS Job
     C                     MOVEL*BLANK    BLAGVN           RS Program
     C                     MOVEL*BLANK    BLABVN           RS User Added
     C                     Z-ADD*ZERO     BLABDT           RS Date Added
     C                     Z-ADD*ZERO     BLABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       BLAJST           RS Record Statu
     C                     MOVEL##USR     BLABVN           RS User Added
     C                     Z-ADD##JDT     BLABDT           RS Date Added
     C                     Z-ADD##JTM     BLABTM           RS Time Added
     C                     MOVEL##PGM     BLAGVN           RS Program
     C                     MOVEL##JOB     BLAHVN           RS Job
     C           KLCRSM    KLIST
     C                     KFLD           BLHNNB           VCH Company num
     C                     KFLD           BLLWNB           VCH Batch Numbe
     C                     KFLD           BLG9NB           VCH Header Numb
     C                     KFLD           BLDLNB           VCD Line
      * Check for duplicate primary key
     C           KLCRSM    SETLL@BLCPEI                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0102' W0RTN   7
      * Send message 'Hog Voucher Detail     EX'
     C                     MOVEL'PRK0102' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C                     WRITE@BLCPEI                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * CASE: DB1.VCD Split Percent is 100 %
     C           BLAEPC    IFEQ 100                        *IF
      * Crt Tattoo Action Comm XF - Tattoo Header Comment  * 
     C                     CALL 'PKV4XFR'              90  Crt Tattoo Acti
     C                     PARM *BLANK    W0RTN   7
     C                     PARM BLHMNB    WQ0023  30       BOH Company Num
     C                     PARM BLBNNB    WQ0024  50       BOH Buy Order N
     C                     PARM BLBONB    WQ0025  50       BOL Load Number
     C                     PARM BLCVNB    WQ0026  50       TH Tattoo Numbe
     C                     PARM BLB0DT    WQ0027  70       TH Kill Date
     C                     PARM *ZERO     WQ0028  50       TH Head Receive
     C                     PARM *ZERO     WQ0029  50       TH Held Over
     C                     PARM *ZERO     WQ0030  80       TH AP Voucher/D
     C                     PARM *ZERO     WQ0031  70       TH Voucher Paym
     C                     PARM 'CV'      WQ0032  2        Tattoo Action U
     C                     PARM *BLANK    WQ0033  5        Tattoo Nbr Alph
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKV4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv/Chg Voucher Hdr   RT - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WCHNNB           VCH Company num
     C                     KFLD           WCLWNB           VCH Batch Numbe
     C                     KFLD           WCG9NB           VCH Header Numb
      * Setup key
     C                     Z-ADDP1HMNB    WCHNNB           VCH Company num
     C                     Z-ADDWULWNB    WCLWNB           VCH Batch Numbe
     C                     Z-ADDWUG9NB    WCG9NB           VCH Header Numb
      * Establish starting position
     C           KRSSN     CHAIN@BKCPEJ              90    *
      * Data record not found
     C   90                MOVEL'PRK0099' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Voucher Header    CH - Hog Voucher Header  * 
     C                     EXSR SOCHRC
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCHRC    BEGSR
      *================================================================
      * Chg Voucher Header    CH - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE 'N'       YARDC   1
      *
      * Move key fields to @BKCPEK
     C                     Z-ADDWCHNNB    BKHNNB           VCH Company num
     C                     Z-ADDWCLWNB    BKLWNB           VCH Batch Numbe
     C                     Z-ADDWCG9NB    BKG9NB           VCH Header Numb
      *
     C           KLCHSO    KLIST
     C                     KFLD           BKHNNB           VCH Company num
     C                     KFLD           BKLWNB           VCH Batch Numbe
     C                     KFLD           BKG9NB           VCH Header Numb
     C           KLCHSO    CHAIN@BKCPEK              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO SOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBK1    YARDCS
      * Move non-key fields to @BKCPEK
     C                     Z-ADDWCLXNB    BKLXNB           VCH AP Address
     C                     Z-ADDWCLYNB    BKLYNB           VCH AP Voucher
     C                     MOVELWCCSST    BKCSST           VCH Payee Type
     C                     Z-ADDWCDKNB    BKDKNB           VCH Manual Chec
     C                     Z-ADDWCA2DT    BKA2DT           VCH Manual Chec
     C                     Z-ADDWUCIPR    BKCIPR           VCH Base Mkt Pr
     C                     Z-ADDWUCJPR    BKCJPR           VCH Sort Disc A
     C                     Z-ADDWUCKPR    BKCKPR           VCH Yield Gain/
     C                     Z-ADDWUCLPR    BKCLPR           VCH Base Carcas
     C                     Z-ADDWUCMPR    BKCMPR           VCH LN Add on/D
     C                     Z-ADDWUAUVA    BKAUVA           VCH Gross Amt
     C                     Z-ADDWUAVVA    BKAVVA           VCH Deduction A
     C                     Z-ADDWUCHPR    BKCHPR           VCH Less Split
     C                     Z-ADDWUAJVA    BKAJVA           VCH Net Amt
     C                     Z-ADDWCBUPC    BKBUPC           VCH Split %
     C                     MOVELWCJHST    BKJHST           VCH Split Check
     C                     MOVEL'C'       BKC0ST           VCH Process Sta
     C                     Z-ADDWCA4DT    BKA4DT           VCH G/L Date
     C                     MOVELWCCUST    BKCUST           VCH Check Type
     C                     MOVELWCABCD    BKABCD           PD Producer Cod
     C                     MOVELWCBNCD    BKBNCD           TRK Trucker Cod
     C                     MOVELWCCFCD    BKCFCD           VR Reason Code
     C                     MOVELWCAAVN    BKAAVN           RS User Changed
     C                     Z-ADDWCAADT    BKAADT           RS Date Changed
     C                     Z-ADDWCAMTM    BKAMTM           RS Time Changed
     C                     MOVELWCAJST    BKAJST           RS Record Statu
     C                     MOVELWCAHVN    BKAHVN           RS Job
     C                     MOVELWCAGVN    BKAGVN           RS Program
     C                     MOVELWCABVN    BKABVN           RS User Added
     C                     Z-ADDWCABDT    BKABDT           RS Date Added
     C                     Z-ADDWCABTM    BKABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBK1    IFNE YARDCS
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     BKAAVN           RS User Changed
     C                     Z-ADD##JDT     BKAADT           RS Date Changed
     C                     Z-ADD##JTM     BKAMTM           RS Time Changed
     C                     MOVEL##JOB     BKAHVN           RS Job
     C                     MOVEL##PGM     BKAGVN           RS Program
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BKCPEK                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBKCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv/Chg PrcCd,CrtSplt RT - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WCHNNB           VCH Company num
     C                     KFLD           WCLWNB           VCH Batch Numbe
     C                     KFLD           WCG9NB           VCH Header Numb
      * Setup key
     C                     Z-ADDP1HMNB    WCHNNB           VCH Company num
     C                     Z-ADDWULWNB    WCLWNB           VCH Batch Numbe
     C                     Z-ADDWUG9NB    WCG9NB           VCH Header Numb
      * Establish starting position
     C           KRSSP     CHAIN@BKCPEJ              90    *
      * Data record not found
     C   90                MOVEL'PRK0099' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Recalc Net and Deduction amts if a Manual Check was written for a
      * CASE: PAR.Manual Chk Adj Diff   USR is Not Zero
     C           *ZERO     IFNE *ZERO                      *IF
     C           WCAVVA    ADD  *ZERO     WUAVVA           VCH Deduction A
     C                     Z-ADDWUAJVA    WUAJVA           VCH Net Amt
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWCAVVA    WUAVVA           VCH Deduction A
     C                     Z-ADDWCAJVA    WUAJVA           VCH Net Amt
     C                     END                             *FI
      * Chg Voucher Header    CH - Hog Voucher Header  * 
     C                     EXSR SQCHRC
      * Create Split Voucher Hdr/Dtl if Split Producer
      * CASE: DB1.VCH Less Split Amount is Not Zeros
     C           WCCHPR    IFNE *ZERO                      *IF
      * Rtv/Crt Prdcr Vch Splt RT - Producer Std Split  * 
     C                     EXSR SRRVGN
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCHRC    BEGSR
      *================================================================
      * Chg Voucher Header    CH - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE 'N'       YBRDC   1
      *
      * Move key fields to @BKCPEK
     C                     Z-ADDWCHNNB    BKHNNB           VCH Company num
     C                     Z-ADDWCLWNB    BKLWNB           VCH Batch Numbe
     C                     Z-ADDWCG9NB    BKG9NB           VCH Header Numb
      *
     C           KLCHSQ    KLIST
     C                     KFLD           BKHNNB           VCH Company num
     C                     KFLD           BKLWNB           VCH Batch Numbe
     C                     KFLD           BKG9NB           VCH Header Numb
     C           KLCHSQ    CHAIN@BKCPEK              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBK1    YBRDCS
      * Move non-key fields to @BKCPEK
     C                     Z-ADDWCLXNB    BKLXNB           VCH AP Address
     C                     Z-ADDWCLYNB    BKLYNB           VCH AP Voucher
     C                     MOVELWCCSST    BKCSST           VCH Payee Type
     C                     Z-ADDWCDKNB    BKDKNB           VCH Manual Chec
     C                     Z-ADDWCA2DT    BKA2DT           VCH Manual Chec
     C                     Z-ADDWCCIPR    BKCIPR           VCH Base Mkt Pr
     C                     Z-ADDWCCJPR    BKCJPR           VCH Sort Disc A
     C                     Z-ADDWCCKPR    BKCKPR           VCH Yield Gain/
     C                     Z-ADDWCCLPR    BKCLPR           VCH Base Carcas
     C                     Z-ADDWCCMPR    BKCMPR           VCH LN Add on/D
     C                     Z-ADDWCAUVA    BKAUVA           VCH Gross Amt
     C                     Z-ADDWUAVVA    BKAVVA           VCH Deduction A
     C                     Z-ADDWCCHPR    BKCHPR           VCH Less Split
     C                     Z-ADDWUAJVA    BKAJVA           VCH Net Amt
     C                     Z-ADDWCBUPC    BKBUPC           VCH Split %
     C                     MOVELWCJHST    BKJHST           VCH Split Check
     C                     MOVEL'C'       BKC0ST           VCH Process Sta
     C                     Z-ADDWCA4DT    BKA4DT           VCH G/L Date
     C                     MOVELWCCUST    BKCUST           VCH Check Type
     C                     MOVELWCABCD    BKABCD           PD Producer Cod
     C                     MOVELWCBNCD    BKBNCD           TRK Trucker Cod
     C                     MOVELWCCFCD    BKCFCD           VR Reason Code
     C                     MOVELWCAAVN    BKAAVN           RS User Changed
     C                     Z-ADDWCAADT    BKAADT           RS Date Changed
     C                     Z-ADDWCAMTM    BKAMTM           RS Time Changed
     C                     MOVELWCAJST    BKAJST           RS Record Statu
     C                     MOVELWCAHVN    BKAHVN           RS Job
     C                     MOVELWCAGVN    BKAGVN           RS Program
     C                     MOVELWCABVN    BKABVN           RS User Added
     C                     Z-ADDWCABDT    BKABDT           RS Date Added
     C                     Z-ADDWCABTM    BKABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBK1    IFNE YBRDCS
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     BKAAVN           RS User Changed
     C                     Z-ADD##JDT     BKAADT           RS Date Changed
     C                     Z-ADD##JTM     BKAMTM           RS Time Changed
     C                     MOVEL##JOB     BKAHVN           RS Job
     C                     MOVEL##PGM     BKAGVN           RS Program
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BKCPEK                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBKCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv/Crt Prdcr Vch Splt RT - Producer Std Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDABCD    WQSR01           PD Producer Cod
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           PD Producer Cod
      * Setup key
     C                     MOVELWCABCD    WQSR01           PD Producer Cod
      * Establish starting position
     C           KRSSR     SETLL@BFREOG                    *
     C           KRSSR     READE@BFREOG                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0089' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Hog Voucher Split CR - Hog Voucher Split  * 
     C                     EXSR SSCRRC
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Crt Hog Voucher Split CR - Hog Voucher Split  * 
     C                     EXSR STCRRC
      * Create Split producer voucher header and detail rcds ...
      * CASE: DB1.BOS Split Producer Code NE PAR.PD Producer Code
     C           WDBTCD    IFNE WCABCD                     *IF
      *   ... If not the original producer's split record
      * Create Header record for split producer
      * (Split amount is negative in voucher header,detail files.)
     C           WCAJVA    SUB  WCCHPR    WUA8VA           Net Amount
     C           WDABPC    DIV  100       WUL9NB           Percent Decimal
     C           WUA8VA    MULT WUL9NB    WUAJVA    H      VCH Net Amt
     C                     Z-ADDWUAJVA    WUAUVA           VCH Gross Amt
      * Rtv Prdcr Vendor#,Src RT - Producer  * 
     C                     EXSR SURVGN
      * Rtv Source Type       RT - Source  * 
     C                     EXSR SVRVGN
      * Payee type values
      * CASE: WRK.SR Type is Internal
     C           WUIXST    IFEQ 'I'                        *IF
     C                     MOVEL'I'       WUCSST           VCH Payee Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       WUCSST           VCH Payee Type
     C                     END                             *FI
      * Rtv Nxt Vch Header#   RT - Hog Voucher Header  * 
     C                     EXSR SWRVGN
      * Crt Voucher Header    CR - Hog Voucher Header  * 
     C                     EXSR SXCRRC
      * Create Detail records for split producer
      * Rtv/Crt Vch Dtl Splt  RT - Hog Voucher Detail  * 
     C                     EXSR SYRVGN
     C                     END                             *FI
     C           KRSSR     READE@BFREOG                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCRRC    BEGSR
      *================================================================
      * Crt Hog Voucher Split CR - Hog Voucher Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CACPIH
     C                     Z-ADDWCHNNB    CAHNNB           VCH Company num
     C                     Z-ADDWCLWNB    CALWNB           VCH Batch Numbe
     C                     Z-ADDWCG9NB    CAG9NB           VCH Header Numb
     C                     MOVELWCABCD    CABTCD           BOS Split Produ
     C                     MOVELWCABCD    CAABCD           PD Producer Cod
     C                     Z-ADD100       CAA6PC           BOS Split Perce
     C                     MOVEL*BLANK    CAAAVN           RS User Changed
     C                     Z-ADD*ZERO     CAAADT           RS Date Changed
     C                     Z-ADD*ZERO     CAAMTM           RS Time Changed
     C                     MOVEL'A'       CAAJST           RS Record Statu
     C                     MOVEL*BLANK    CAAHVN           RS Job
     C                     MOVEL*BLANK    CAAGVN           RS Program
     C                     MOVEL*BLANK    CAABVN           RS User Added
     C                     Z-ADD*ZERO     CAABDT           RS Date Added
     C                     Z-ADD*ZERO     CAABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       CAAJST           RS Record Statu
     C                     MOVEL##USR     CAABVN           RS User Added
     C                     Z-ADD##JDT     CAABDT           RS Date Added
     C                     Z-ADD##JTM     CAABTM           RS Time Added
     C                     MOVEL##PGM     CAAGVN           RS Program
     C                     MOVEL##JOB     CAAHVN           RS Job
     C           KLCRSS    KLIST
     C                     KFLD           CAHNNB           VCH Company num
     C                     KFLD           CALWNB           VCH Batch Numbe
     C                     KFLD           CAG9NB           VCH Header Numb
     C                     KFLD           CABTCD           BOS Split Produ
     C                     KFLD           CAABCD           PD Producer Cod
      * Check for duplicate primary key
     C           KLCRSS    SETLL@CACPIH                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0169' W0RTN   7
      * Send message 'Hog Voucher Split      EX'
     C                     MOVEL'PRK0169' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C                     WRITE@CACPIH                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCRRC    BEGSR
      *================================================================
      * Crt Hog Voucher Split CR - Hog Voucher Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CACPIH
     C                     Z-ADDWCHNNB    CAHNNB           VCH Company num
     C                     Z-ADDWCLWNB    CALWNB           VCH Batch Numbe
     C                     Z-ADDWCG9NB    CAG9NB           VCH Header Numb
     C                     MOVELWDBTCD    CABTCD           BOS Split Produ
     C                     MOVELWDABCD    CAABCD           PD Producer Cod
     C                     Z-ADDWDABPC    CAA6PC           BOS Split Perce
     C                     MOVEL*BLANK    CAAAVN           RS User Changed
     C                     Z-ADD*ZERO     CAAADT           RS Date Changed
     C                     Z-ADD*ZERO     CAAMTM           RS Time Changed
     C                     MOVEL'A'       CAAJST           RS Record Statu
     C                     MOVEL*BLANK    CAAHVN           RS Job
     C                     MOVEL*BLANK    CAAGVN           RS Program
     C                     MOVEL*BLANK    CAABVN           RS User Added
     C                     Z-ADD*ZERO     CAABDT           RS Date Added
     C                     Z-ADD*ZERO     CAABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       CAAJST           RS Record Statu
     C                     MOVEL##USR     CAABVN           RS User Added
     C                     Z-ADD##JDT     CAABDT           RS Date Added
     C                     Z-ADD##JTM     CAABTM           RS Time Added
     C                     MOVEL##PGM     CAAGVN           RS Program
     C                     MOVEL##JOB     CAAHVN           RS Job
     C           KLCRST    KLIST
     C                     KFLD           CAHNNB           VCH Company num
     C                     KFLD           CALWNB           VCH Batch Numbe
     C                     KFLD           CAG9NB           VCH Header Numb
     C                     KFLD           CABTCD           BOS Split Produ
     C                     KFLD           CAABCD           PD Producer Cod
      * Check for duplicate primary key
     C           KLCRST    SETLL@CACPIH                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0169' W0RTN   7
      * Send message 'Hog Voucher Split      EX'
     C                     MOVEL'PRK0169' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C                     WRITE@CACPIH                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Prdcr Vendor#,Src RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVELWDBTCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSSU     CHAIN@ACREAI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0009' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WULXNB           PD VND Address
     C                     MOVEL*BLANK    WUAACD           SR Source Code
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDACGCNB    WULXNB           PD VND Address
     C                     MOVELACAACD    WUAACD           SR Source Code
     C                     GOTO SUEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Source Type       RT - Source  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           AAAACD           SR Source Code
      * Setup key
     C                     MOVELWUAACD    AAAACD           SR Source Code
      * Establish starting position
     C           KRSSV     CHAIN@AAREAC              90    *
      * Data record not found
     C   90                MOVEL'PRK0005' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAAIXST    WUIXST           SR Type
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Nxt Vch Header#   RT - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHNNB    WQSW01           VCH Company num
     C           *LIKE     DEFN WALWNB    WQSW02           VCH Batch Numbe
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           VCH Company num
     C                     KFLD           WQSW02           VCH Batch Numbe
      * Setup key
     C                     Z-ADDWCHNNB    WQSW01           VCH Company num
     C                     Z-ADDWCLWNB    WQSW02           VCH Batch Numbe
      * Establish starting position
     C           KRSSW     SETLL@BKCPJR                    *
     C           KRSSW     READE@BKCPJR                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0099' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD00001     WUL4NB           VCH Header Numb
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WAG9NB    ADD  1         WUL4NB           VCH Header Numb
     C                     GOTO SWEXIT                     *QUIT
     C           KRSSW     READE@BKCPJR                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCRRC    BEGSR
      *================================================================
      * Crt Voucher Header    CR - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BKCPEK
     C                     Z-ADDWCHNNB    BKHNNB           VCH Company num
     C                     Z-ADDWCLWNB    BKLWNB           VCH Batch Numbe
     C                     Z-ADDWUL4NB    BKG9NB           VCH Header Numb
     C                     Z-ADDWULXNB    BKLXNB           VCH AP Address
     C                     Z-ADDWCLYNB    BKLYNB           VCH AP Voucher
     C                     MOVELWUCSST    BKCSST           VCH Payee Type
     C                     Z-ADDWCDKNB    BKDKNB           VCH Manual Chec
     C                     Z-ADDWCA2DT    BKA2DT           VCH Manual Chec
     C                     Z-ADD*ZERO     BKCIPR           VCH Base Mkt Pr
     C                     Z-ADD*ZERO     BKCJPR           VCH Sort Disc A
     C                     Z-ADD*ZERO     BKCKPR           VCH Yield Gain/
     C                     Z-ADD*ZERO     BKCLPR           VCH Base Carcas
     C                     Z-ADD*ZERO     BKCMPR           VCH LN Add on/D
     C                     Z-ADDWUAUVA    BKAUVA           VCH Gross Amt
     C                     Z-ADD*ZERO     BKAVVA           VCH Deduction A
     C                     Z-ADD*ZERO     BKCHPR           VCH Less Split
     C                     Z-ADDWUAJVA    BKAJVA           VCH Net Amt
     C                     Z-ADD*ZERO     BKBUPC           VCH Split %
     C                     MOVEL'Y'       BKJHST           VCH Split Check
     C                     MOVEL'C'       BKC0ST           VCH Process Sta
     C                     Z-ADDWCA4DT    BKA4DT           VCH G/L Date
     C                     MOVELWCCUST    BKCUST           VCH Check Type
     C                     MOVELWDBTCD    BKABCD           PD Producer Cod
     C                     MOVELWCBNCD    BKBNCD           TRK Trucker Cod
     C                     MOVELWCCFCD    BKCFCD           VR Reason Code
     C                     MOVEL*BLANK    BKAAVN           RS User Changed
     C                     Z-ADD*ZERO     BKAADT           RS Date Changed
     C                     Z-ADD*ZERO     BKAMTM           RS Time Changed
     C                     MOVEL'A'       BKAJST           RS Record Statu
     C                     MOVEL*BLANK    BKAHVN           RS Job
     C                     MOVEL*BLANK    BKAGVN           RS Program
     C                     MOVEL*BLANK    BKABVN           RS User Added
     C                     Z-ADD*ZERO     BKABDT           RS Date Added
     C                     Z-ADD*ZERO     BKABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       BKAJST           RS Record Statu
     C                     MOVEL##USR     BKABVN           RS User Added
     C                     Z-ADD##JDT     BKABDT           RS Date Added
     C                     Z-ADD##JTM     BKABTM           RS Time Added
     C                     MOVEL##PGM     BKAGVN           RS Program
     C                     MOVEL##JOB     BKAHVN           RS Job
     C           KLCRSX    KLIST
     C                     KFLD           BKHNNB           VCH Company num
     C                     KFLD           BKLWNB           VCH Batch Numbe
     C                     KFLD           BKG9NB           VCH Header Numb
      * Check for duplicate primary key
     C           KLCRSX    SETLL@BKCPEK                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0100' W0RTN   7
      * Send message 'Hog Voucher Header     EX'
     C                     MOVEL'PRK0100' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C                     WRITE@BKCPEK                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv/Crt Vch Dtl Splt  RT - Hog Voucher Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BLHNNB    WQSY01           VCH Company num
     C           *LIKE     DEFN BLLWNB    WQSY02           VCH Batch Numbe
     C           *LIKE     DEFN BLG9NB    WQSY03           VCH Header Numb
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           VCH Company num
     C                     KFLD           WQSY02           VCH Batch Numbe
     C                     KFLD           WQSY03           VCH Header Numb
      * Setup key
     C                     Z-ADDWCHNNB    WQSY01           VCH Company num
     C                     Z-ADDWCLWNB    WQSY02           VCH Batch Numbe
     C                     Z-ADDWCG9NB    WQSY03           VCH Header Numb
      * Establish starting position
     C           KRSSY     SETLL@BLCPEP                    *
     C           KRSSY     READE@BLCPEP                  90*
      * Data record not found
     C   90                MOVEL'PRK0101' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Add Net to Split amt to get Net amt before the split was calc'd.
      * (Split amount is negative in the voucher detail,header files)
     C           BLAMVA    SUB  BLCVPR    WUAMVA           VCD Net Amt
      * Calc net and gross for the splitee producer
     C           WDABPC    DIV  100       WUL9NB           Percent Decimal
     C                     MULT WUL9NB    WUAMVA    H      VCD Net Amt
     C                     Z-ADDWUAMVA    WUAKVA           VCD Gross Amt
      * Crt Voucher Detail    CR - Hog Voucher Detail  * 
     C                     EXSR SZCRRC
     C           KRSSY     READE@BLCPEP                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZCRRC    BEGSR
      *================================================================
      * Crt Voucher Detail    CR - Hog Voucher Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BLCPEI
     C                     Z-ADDWUL4NB    BLG9NB           VCH Header Numb
     C                     Z-ADD*ZERO     BLCNPR           VCD Base Mkt Pr
     C                     Z-ADD*ZERO     BLCOPR           VCD Sort Disc A
     C                     Z-ADD*ZERO     BLCPPR           VCD Yield Gain/
     C                     Z-ADD*ZERO     BLCQPR           VCD Base Carcas
     C                     Z-ADD*ZERO     BLCRPR           VCD LN Add on/D
     C                     Z-ADDWUAKVA    BLAKVA           VCD Gross Amt
     C                     Z-ADD*ZERO     BLALVA           VCD Deduction A
     C                     Z-ADD*ZERO     BLCVPR           VCD Less Split
     C                     Z-ADDWUAMVA    BLAMVA           VCD Net Amt
     C                     Z-ADD*ZERO     BLAEPC           VCD Split Perce
     C                     MOVEL*BLANK    BLJQST           VCD Unused Sts
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       BLAJST           RS Record Statu
     C                     MOVEL##USR     BLABVN           RS User Added
     C                     Z-ADD##JDT     BLABDT           RS Date Added
     C                     Z-ADD##JTM     BLABTM           RS Time Added
     C                     MOVEL##PGM     BLAGVN           RS Program
     C                     MOVEL##JOB     BLAHVN           RS Job
     C           KLCRSZ    KLIST
     C                     KFLD           BLHNNB           VCH Company num
     C                     KFLD           BLLWNB           VCH Batch Numbe
     C                     KFLD           BLG9NB           VCH Header Numb
     C                     KFLD           BLDLNB           VCD Line
      * Check for duplicate primary key
     C           KLCRSZ    SETLL@BLCPEI                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0102' W0RTN   7
      * Send message 'Hog Voucher Detail     EX'
     C                     MOVEL'PRK0102' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C                     WRITE@BLCPEI                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * CASE: DB1.VCD Split Percent is 100 %
     C           BLAEPC    IFEQ 100                        *IF
      * Crt Tattoo Action Comm XF - Tattoo Header Comment  * 
     C                     CALL 'PKV4XFR'              90  Crt Tattoo Acti
     C                     PARM *BLANK    W0RTN   7
     C                     PARM BLHMNB    WQ0039  30       BOH Company Num
     C                     PARM BLBNNB    WQ0040  50       BOH Buy Order N
     C                     PARM BLBONB    WQ0041  50       BOL Load Number
     C                     PARM BLCVNB    WQ0042  50       TH Tattoo Numbe
     C                     PARM BLB0DT    WQ0043  70       TH Kill Date
     C                     PARM *ZERO     WQ0044  50       TH Head Receive
     C                     PARM *ZERO     WQ0045  50       TH Held Over
     C                     PARM *ZERO     WQ0046  80       TH AP Voucher/D
     C                     PARM *ZERO     WQ0047  70       TH Voucher Paym
     C                     PARM 'CV'      WQ0048  2        Tattoo Action U
     C                     PARM *BLANK    WQ0049  5        Tattoo Nbr Alph
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKV4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Rtv/Chg Voucher Hdr   RT - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WCHNNB           VCH Company num
     C                     KFLD           WCLWNB           VCH Batch Numbe
     C                     KFLD           WCG9NB           VCH Header Numb
      * Setup key
     C                     Z-ADDP1HMNB    WCHNNB           VCH Company num
     C                     Z-ADDWULWNB    WCLWNB           VCH Batch Numbe
     C                     Z-ADDWUG9NB    WCG9NB           VCH Header Numb
      * Establish starting position
     C           KRSTA     CHAIN@BKCPEJ              90    *
      * Data record not found
     C   90                MOVEL'PRK0099' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Voucher Header    CH - Hog Voucher Header  * 
     C                     EXSR TBCHRC
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBCHRC    BEGSR
      *================================================================
      * Chg Voucher Header    CH - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE 'N'       YCRDC   1
      *
      * Move key fields to @BKCPEK
     C                     Z-ADDWCHNNB    BKHNNB           VCH Company num
     C                     Z-ADDWCLWNB    BKLWNB           VCH Batch Numbe
     C                     Z-ADDWCG9NB    BKG9NB           VCH Header Numb
      *
     C           KLCHTB    KLIST
     C                     KFLD           BKHNNB           VCH Company num
     C                     KFLD           BKLWNB           VCH Batch Numbe
     C                     KFLD           BKG9NB           VCH Header Numb
     C           KLCHTB    CHAIN@BKCPEK              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO TBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBK1    YCRDCS
      * Move non-key fields to @BKCPEK
     C                     Z-ADDWCLXNB    BKLXNB           VCH AP Address
     C                     Z-ADDWCLYNB    BKLYNB           VCH AP Voucher
     C                     MOVELWCCSST    BKCSST           VCH Payee Type
     C                     Z-ADDWCDKNB    BKDKNB           VCH Manual Chec
     C                     Z-ADDWCA2DT    BKA2DT           VCH Manual Chec
     C                     Z-ADDWUCIPR    BKCIPR           VCH Base Mkt Pr
     C                     Z-ADDWUCJPR    BKCJPR           VCH Sort Disc A
     C                     Z-ADDWUCKPR    BKCKPR           VCH Yield Gain/
     C                     Z-ADDWUCLPR    BKCLPR           VCH Base Carcas
     C                     Z-ADDWUCMPR    BKCMPR           VCH LN Add on/D
     C                     Z-ADDWUAUVA    BKAUVA           VCH Gross Amt
     C                     Z-ADDWUAVVA    BKAVVA           VCH Deduction A
     C                     Z-ADDWUCHPR    BKCHPR           VCH Less Split
     C                     Z-ADDWUAJVA    BKAJVA           VCH Net Amt
     C                     Z-ADDWCBUPC    BKBUPC           VCH Split %
     C                     MOVELWCJHST    BKJHST           VCH Split Check
     C                     MOVEL'C'       BKC0ST           VCH Process Sta
     C                     Z-ADDWCA4DT    BKA4DT           VCH G/L Date
     C                     MOVELWCCUST    BKCUST           VCH Check Type
     C                     MOVELWCABCD    BKABCD           PD Producer Cod
     C                     MOVELWCBNCD    BKBNCD           TRK Trucker Cod
     C                     MOVELWCCFCD    BKCFCD           VR Reason Code
     C                     MOVELWCAAVN    BKAAVN           RS User Changed
     C                     Z-ADDWCAADT    BKAADT           RS Date Changed
     C                     Z-ADDWCAMTM    BKAMTM           RS Time Changed
     C                     MOVELWCAJST    BKAJST           RS Record Statu
     C                     MOVELWCAHVN    BKAHVN           RS Job
     C                     MOVELWCAGVN    BKAGVN           RS Program
     C                     MOVELWCABVN    BKABVN           RS User Added
     C                     Z-ADDWCABDT    BKABDT           RS Date Added
     C                     Z-ADDWCABTM    BKABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBK1    IFNE YCRDCS
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     BKAAVN           RS User Changed
     C                     Z-ADD##JDT     BKAADT           RS Date Changed
     C                     Z-ADD##JTM     BKAMTM           RS Time Changed
     C                     MOVEL##JOB     BKAHVN           RS Job
     C                     MOVEL##PGM     BKAGVN           RS Program
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BKCPEK                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBKCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Rtv/Chg PrcCd,CrtSplt RT - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WCHNNB           VCH Company num
     C                     KFLD           WCLWNB           VCH Batch Numbe
     C                     KFLD           WCG9NB           VCH Header Numb
      * Setup key
     C                     Z-ADDP1HMNB    WCHNNB           VCH Company num
     C                     Z-ADDWULWNB    WCLWNB           VCH Batch Numbe
     C                     Z-ADDWUG9NB    WCG9NB           VCH Header Numb
      * Establish starting position
     C           KRSTC     CHAIN@BKCPEJ              90    *
      * Data record not found
     C   90                MOVEL'PRK0099' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Recalc Net and Deduction amts if a Manual Check was written for a
      * CASE: PAR.Manual Chk Adj Diff   USR is Not Zero
     C           *ZERO     IFNE *ZERO                      *IF
     C           WCAVVA    ADD  *ZERO     WUAVVA           VCH Deduction A
     C                     Z-ADDWUAJVA    WUAJVA           VCH Net Amt
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWCAVVA    WUAVVA           VCH Deduction A
     C                     Z-ADDWCAJVA    WUAJVA           VCH Net Amt
     C                     END                             *FI
      * Chg Voucher Header    CH - Hog Voucher Header  * 
     C                     EXSR TDCHRC
      * Create Split Voucher Hdr/Dtl if Split Producer
      * CASE: DB1.VCH Less Split Amount is Not Zeros
     C           WCCHPR    IFNE *ZERO                      *IF
      * Rtv/Crt Prdcr Vch Splt RT - Producer Std Split  * 
     C                     EXSR TERVGN
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDCHRC    BEGSR
      *================================================================
      * Chg Voucher Header    CH - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE 'N'       YDRDC   1
      *
      * Move key fields to @BKCPEK
     C                     Z-ADDWCHNNB    BKHNNB           VCH Company num
     C                     Z-ADDWCLWNB    BKLWNB           VCH Batch Numbe
     C                     Z-ADDWCG9NB    BKG9NB           VCH Header Numb
      *
     C           KLCHTD    KLIST
     C                     KFLD           BKHNNB           VCH Company num
     C                     KFLD           BKLWNB           VCH Batch Numbe
     C                     KFLD           BKG9NB           VCH Header Numb
     C           KLCHTD    CHAIN@BKCPEK              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     GOTO TDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKBK1    YDRDCS
      * Move non-key fields to @BKCPEK
     C                     Z-ADDWCLXNB    BKLXNB           VCH AP Address
     C                     Z-ADDWCLYNB    BKLYNB           VCH AP Voucher
     C                     MOVELWCCSST    BKCSST           VCH Payee Type
     C                     Z-ADDWCDKNB    BKDKNB           VCH Manual Chec
     C                     Z-ADDWCA2DT    BKA2DT           VCH Manual Chec
     C                     Z-ADDWCCIPR    BKCIPR           VCH Base Mkt Pr
     C                     Z-ADDWCCJPR    BKCJPR           VCH Sort Disc A
     C                     Z-ADDWCCKPR    BKCKPR           VCH Yield Gain/
     C                     Z-ADDWCCLPR    BKCLPR           VCH Base Carcas
     C                     Z-ADDWCCMPR    BKCMPR           VCH LN Add on/D
     C                     Z-ADDWCAUVA    BKAUVA           VCH Gross Amt
     C                     Z-ADDWUAVVA    BKAVVA           VCH Deduction A
     C                     Z-ADDWCCHPR    BKCHPR           VCH Less Split
     C                     Z-ADDWUAJVA    BKAJVA           VCH Net Amt
     C                     Z-ADDWCBUPC    BKBUPC           VCH Split %
     C                     MOVELWCJHST    BKJHST           VCH Split Check
     C                     MOVEL'C'       BKC0ST           VCH Process Sta
     C                     Z-ADDWCA4DT    BKA4DT           VCH G/L Date
     C                     MOVELWCCUST    BKCUST           VCH Check Type
     C                     MOVELWCABCD    BKABCD           PD Producer Cod
     C                     MOVELWCBNCD    BKBNCD           TRK Trucker Cod
     C                     MOVELWCCFCD    BKCFCD           VR Reason Code
     C                     MOVELWCAAVN    BKAAVN           RS User Changed
     C                     Z-ADDWCAADT    BKAADT           RS Date Changed
     C                     Z-ADDWCAMTM    BKAMTM           RS Time Changed
     C                     MOVELWCAJST    BKAJST           RS Record Statu
     C                     MOVELWCAHVN    BKAHVN           RS Job
     C                     MOVELWCAGVN    BKAGVN           RS Program
     C                     MOVELWCABVN    BKABVN           RS User Added
     C                     Z-ADDWCABDT    BKABDT           RS Date Added
     C                     Z-ADDWCABTM    BKABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKBK1    IFNE YDRDCS
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     BKAAVN           RS User Changed
     C                     Z-ADD##JDT     BKAADT           RS Date Changed
     C                     Z-ADD##JTM     BKAMTM           RS Time Changed
     C                     MOVEL##JOB     BKAHVN           RS Job
     C                     MOVEL##PGM     BKAGVN           RS Program
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@BKCPEK                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKBKCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Rtv/Crt Prdcr Vch Splt RT - Producer Std Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDABCD    WQTE01           PD Producer Cod
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WQTE01           PD Producer Cod
      * Setup key
     C                     MOVELWCABCD    WQTE01           PD Producer Cod
      * Establish starting position
     C           KRSTE     SETLL@BFREOG                    *
     C           KRSTE     READE@BFREOG                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0089' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Hog Voucher Split CR - Hog Voucher Split  * 
     C                     EXSR TFCRRC
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Crt Hog Voucher Split CR - Hog Voucher Split  * 
     C                     EXSR TGCRRC
      * Create Split producer voucher header and detail rcds ...
      * CASE: DB1.BOS Split Producer Code NE PAR.PD Producer Code
     C           WDBTCD    IFNE WCABCD                     *IF
      *   ... If not the original producer's split record
      * Create Header record for split producer
      * (Split amount is negative in voucher header,detail files.)
     C           WCAJVA    SUB  WCCHPR    WUA8VA           Net Amount
     C           WDABPC    DIV  100       WUL9NB           Percent Decimal
     C           WUA8VA    MULT WUL9NB    WUAJVA    H      VCH Net Amt
     C                     Z-ADDWUAJVA    WUAUVA           VCH Gross Amt
      * Rtv Prdcr Vendor#,Src RT - Producer  * 
     C                     EXSR THRVGN
      * Rtv Source Type       RT - Source  * 
     C                     EXSR TIRVGN
      * Payee type values
      * CASE: WRK.SR Type is Internal
     C           WUIXST    IFEQ 'I'                        *IF
     C                     MOVEL'I'       WUCSST           VCH Payee Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       WUCSST           VCH Payee Type
     C                     END                             *FI
      * Rtv Nxt Vch Header#   RT - Hog Voucher Header  * 
     C                     EXSR TJRVGN
      * Crt Voucher Header    CR - Hog Voucher Header  * 
     C                     EXSR TKCRRC
      * Create Detail records for split producer
      * Rtv/Crt Vch Dtl Splt  RT - Hog Voucher Detail  * 
     C                     EXSR TLRVGN
     C                     END                             *FI
     C           KRSTE     READE@BFREOG                  90*
     C                     ENDDO
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFCRRC    BEGSR
      *================================================================
      * Crt Hog Voucher Split CR - Hog Voucher Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CACPIH
     C                     Z-ADDWCHNNB    CAHNNB           VCH Company num
     C                     Z-ADDWCLWNB    CALWNB           VCH Batch Numbe
     C                     Z-ADDWCG9NB    CAG9NB           VCH Header Numb
     C                     MOVELWCABCD    CABTCD           BOS Split Produ
     C                     MOVELWCABCD    CAABCD           PD Producer Cod
     C                     Z-ADD100       CAA6PC           BOS Split Perce
     C                     MOVEL*BLANK    CAAAVN           RS User Changed
     C                     Z-ADD*ZERO     CAAADT           RS Date Changed
     C                     Z-ADD*ZERO     CAAMTM           RS Time Changed
     C                     MOVEL'A'       CAAJST           RS Record Statu
     C                     MOVEL*BLANK    CAAHVN           RS Job
     C                     MOVEL*BLANK    CAAGVN           RS Program
     C                     MOVEL*BLANK    CAABVN           RS User Added
     C                     Z-ADD*ZERO     CAABDT           RS Date Added
     C                     Z-ADD*ZERO     CAABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       CAAJST           RS Record Statu
     C                     MOVEL##USR     CAABVN           RS User Added
     C                     Z-ADD##JDT     CAABDT           RS Date Added
     C                     Z-ADD##JTM     CAABTM           RS Time Added
     C                     MOVEL##PGM     CAAGVN           RS Program
     C                     MOVEL##JOB     CAAHVN           RS Job
     C           KLCRTF    KLIST
     C                     KFLD           CAHNNB           VCH Company num
     C                     KFLD           CALWNB           VCH Batch Numbe
     C                     KFLD           CAG9NB           VCH Header Numb
     C                     KFLD           CABTCD           BOS Split Produ
     C                     KFLD           CAABCD           PD Producer Cod
      * Check for duplicate primary key
     C           KLCRTF    SETLL@CACPIH                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0169' W0RTN   7
      * Send message 'Hog Voucher Split      EX'
     C                     MOVEL'PRK0169' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C                     WRITE@CACPIH                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGCRRC    BEGSR
      *================================================================
      * Crt Hog Voucher Split CR - Hog Voucher Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CACPIH
     C                     Z-ADDWCHNNB    CAHNNB           VCH Company num
     C                     Z-ADDWCLWNB    CALWNB           VCH Batch Numbe
     C                     Z-ADDWCG9NB    CAG9NB           VCH Header Numb
     C                     MOVELWDBTCD    CABTCD           BOS Split Produ
     C                     MOVELWDABCD    CAABCD           PD Producer Cod
     C                     Z-ADDWDABPC    CAA6PC           BOS Split Perce
     C                     MOVEL*BLANK    CAAAVN           RS User Changed
     C                     Z-ADD*ZERO     CAAADT           RS Date Changed
     C                     Z-ADD*ZERO     CAAMTM           RS Time Changed
     C                     MOVEL'A'       CAAJST           RS Record Statu
     C                     MOVEL*BLANK    CAAHVN           RS Job
     C                     MOVEL*BLANK    CAAGVN           RS Program
     C                     MOVEL*BLANK    CAABVN           RS User Added
     C                     Z-ADD*ZERO     CAABDT           RS Date Added
     C                     Z-ADD*ZERO     CAABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       CAAJST           RS Record Statu
     C                     MOVEL##USR     CAABVN           RS User Added
     C                     Z-ADD##JDT     CAABDT           RS Date Added
     C                     Z-ADD##JTM     CAABTM           RS Time Added
     C                     MOVEL##PGM     CAAGVN           RS Program
     C                     MOVEL##JOB     CAAHVN           RS Job
     C           KLCRTG    KLIST
     C                     KFLD           CAHNNB           VCH Company num
     C                     KFLD           CALWNB           VCH Batch Numbe
     C                     KFLD           CAG9NB           VCH Header Numb
     C                     KFLD           CABTCD           BOS Split Produ
     C                     KFLD           CAABCD           PD Producer Cod
      * Check for duplicate primary key
     C           KLCRTG    SETLL@CACPIH                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0169' W0RTN   7
      * Send message 'Hog Voucher Split      EX'
     C                     MOVEL'PRK0169' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C                     WRITE@CACPIH                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Rtv Prdcr Vendor#,Src RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVELWDBTCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSTH     CHAIN@ACREAI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0009' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WULXNB           PD VND Address
     C                     MOVEL*BLANK    WUAACD           SR Source Code
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDACGCNB    WULXNB           PD VND Address
     C                     MOVELACAACD    WUAACD           SR Source Code
     C                     GOTO THEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * Rtv Source Type       RT - Source  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           AAAACD           SR Source Code
      * Setup key
     C                     MOVELWUAACD    AAAACD           SR Source Code
      * Establish starting position
     C           KRSTI     CHAIN@AAREAC              90    *
      * Data record not found
     C   90                MOVEL'PRK0005' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAAIXST    WUIXST           SR Type
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * Rtv Nxt Vch Header#   RT - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHNNB    WQTJ01           VCH Company num
     C           *LIKE     DEFN WALWNB    WQTJ02           VCH Batch Numbe
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WQTJ01           VCH Company num
     C                     KFLD           WQTJ02           VCH Batch Numbe
      * Setup key
     C                     Z-ADDWCHNNB    WQTJ01           VCH Company num
     C                     Z-ADDWCLWNB    WQTJ02           VCH Batch Numbe
      * Establish starting position
     C           KRSTJ     SETLL@BKCPJR                    *
     C           KRSTJ     READE@BKCPJR                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0099' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD00001     WUL4NB           VCH Header Numb
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WAG9NB    ADD  1         WUL4NB           VCH Header Numb
     C                     GOTO TJEXIT                     *QUIT
     C           KRSTJ     READE@BKCPJR                  90*
     C                     ENDDO
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKCRRC    BEGSR
      *================================================================
      * Crt Voucher Header    CR - Hog Voucher Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BKCPEK
     C                     Z-ADDWCHNNB    BKHNNB           VCH Company num
     C                     Z-ADDWCLWNB    BKLWNB           VCH Batch Numbe
     C                     Z-ADDWUL4NB    BKG9NB           VCH Header Numb
     C                     Z-ADDWULXNB    BKLXNB           VCH AP Address
     C                     Z-ADDWCLYNB    BKLYNB           VCH AP Voucher
     C                     MOVELWUCSST    BKCSST           VCH Payee Type
     C                     Z-ADDWCDKNB    BKDKNB           VCH Manual Chec
     C                     Z-ADDWCA2DT    BKA2DT           VCH Manual Chec
     C                     Z-ADD*ZERO     BKCIPR           VCH Base Mkt Pr
     C                     Z-ADD*ZERO     BKCJPR           VCH Sort Disc A
     C                     Z-ADD*ZERO     BKCKPR           VCH Yield Gain/
     C                     Z-ADD*ZERO     BKCLPR           VCH Base Carcas
     C                     Z-ADD*ZERO     BKCMPR           VCH LN Add on/D
     C                     Z-ADDWUAUVA    BKAUVA           VCH Gross Amt
     C                     Z-ADD*ZERO     BKAVVA           VCH Deduction A
     C                     Z-ADD*ZERO     BKCHPR           VCH Less Split
     C                     Z-ADDWUAJVA    BKAJVA           VCH Net Amt
     C                     Z-ADD*ZERO     BKBUPC           VCH Split %
     C                     MOVEL'Y'       BKJHST           VCH Split Check
     C                     MOVEL'C'       BKC0ST           VCH Process Sta
     C                     Z-ADDWCA4DT    BKA4DT           VCH G/L Date
     C                     MOVELWCCUST    BKCUST           VCH Check Type
     C                     MOVELWDBTCD    BKABCD           PD Producer Cod
     C                     MOVELWCBNCD    BKBNCD           TRK Trucker Cod
     C                     MOVELWCCFCD    BKCFCD           VR Reason Code
     C                     MOVEL*BLANK    BKAAVN           RS User Changed
     C                     Z-ADD*ZERO     BKAADT           RS Date Changed
     C                     Z-ADD*ZERO     BKAMTM           RS Time Changed
     C                     MOVEL'A'       BKAJST           RS Record Statu
     C                     MOVEL*BLANK    BKAHVN           RS Job
     C                     MOVEL*BLANK    BKAGVN           RS Program
     C                     MOVEL*BLANK    BKABVN           RS User Added
     C                     Z-ADD*ZERO     BKABDT           RS Date Added
     C                     Z-ADD*ZERO     BKABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       BKAJST           RS Record Statu
     C                     MOVEL##USR     BKABVN           RS User Added
     C                     Z-ADD##JDT     BKABDT           RS Date Added
     C                     Z-ADD##JTM     BKABTM           RS Time Added
     C                     MOVEL##PGM     BKAGVN           RS Program
     C                     MOVEL##JOB     BKAHVN           RS Job
     C           KLCRTK    KLIST
     C                     KFLD           BKHNNB           VCH Company num
     C                     KFLD           BKLWNB           VCH Batch Numbe
     C                     KFLD           BKG9NB           VCH Header Numb
      * Check for duplicate primary key
     C           KLCRTK    SETLL@BKCPEK                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0100' W0RTN   7
      * Send message 'Hog Voucher Header     EX'
     C                     MOVEL'PRK0100' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C                     WRITE@BKCPEK                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * Rtv/Crt Vch Dtl Splt  RT - Hog Voucher Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BLHNNB    WQTL01           VCH Company num
     C           *LIKE     DEFN BLLWNB    WQTL02           VCH Batch Numbe
     C           *LIKE     DEFN BLG9NB    WQTL03           VCH Header Numb
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WQTL01           VCH Company num
     C                     KFLD           WQTL02           VCH Batch Numbe
     C                     KFLD           WQTL03           VCH Header Numb
      * Setup key
     C                     Z-ADDWCHNNB    WQTL01           VCH Company num
     C                     Z-ADDWCLWNB    WQTL02           VCH Batch Numbe
     C                     Z-ADDWCG9NB    WQTL03           VCH Header Numb
      * Establish starting position
     C           KRSTL     SETLL@BLCPEP                    *
     C           KRSTL     READE@BLCPEP                  90*
      * Data record not found
     C   90                MOVEL'PRK0101' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Add Net to Split amt to get Net amt before the split was calc'd.
      * (Split amount is negative in the voucher detail,header files)
     C           BLAMVA    SUB  BLCVPR    WUAMVA           VCD Net Amt
      * Calc net and gross for the splitee producer
     C           WDABPC    DIV  100       WUL9NB           Percent Decimal
     C                     MULT WUL9NB    WUAMVA    H      VCD Net Amt
     C                     Z-ADDWUAMVA    WUAKVA           VCD Gross Amt
      * Crt Voucher Detail    CR - Hog Voucher Detail  * 
     C                     EXSR TMCRRC
     C           KRSTL     READE@BLCPEP                  90*
     C                     ENDDO
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMCRRC    BEGSR
      *================================================================
      * Crt Voucher Detail    CR - Hog Voucher Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BLCPEI
     C                     Z-ADDWUL4NB    BLG9NB           VCH Header Numb
     C                     Z-ADD*ZERO     BLCNPR           VCD Base Mkt Pr
     C                     Z-ADD*ZERO     BLCOPR           VCD Sort Disc A
     C                     Z-ADD*ZERO     BLCPPR           VCD Yield Gain/
     C                     Z-ADD*ZERO     BLCQPR           VCD Base Carcas
     C                     Z-ADD*ZERO     BLCRPR           VCD LN Add on/D
     C                     Z-ADDWUAKVA    BLAKVA           VCD Gross Amt
     C                     Z-ADD*ZERO     BLALVA           VCD Deduction A
     C                     Z-ADD*ZERO     BLCVPR           VCD Less Split
     C                     Z-ADDWUAMVA    BLAMVA           VCD Net Amt
     C                     Z-ADD*ZERO     BLAEPC           VCD Split Perce
     C                     MOVEL*BLANK    BLJQST           VCD Unused Sts
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       BLAJST           RS Record Statu
     C                     MOVEL##USR     BLABVN           RS User Added
     C                     Z-ADD##JDT     BLABDT           RS Date Added
     C                     Z-ADD##JTM     BLABTM           RS Time Added
     C                     MOVEL##PGM     BLAGVN           RS Program
     C                     MOVEL##JOB     BLAHVN           RS Job
     C           KLCRTM    KLIST
     C                     KFLD           BLHNNB           VCH Company num
     C                     KFLD           BLLWNB           VCH Batch Numbe
     C                     KFLD           BLG9NB           VCH Header Numb
     C                     KFLD           BLDLNB           VCD Line
      * Check for duplicate primary key
     C           KLCRTM    SETLL@BLCPEI                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0102' W0RTN   7
      * Send message 'Hog Voucher Detail     EX'
     C                     MOVEL'PRK0102' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C                     WRITE@BLCPEI                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * CASE: DB1.VCD Split Percent is 100 %
     C           BLAEPC    IFEQ 100                        *IF
      * Crt Tattoo Action Comm XF - Tattoo Header Comment  * 
     C                     CALL 'PKV4XFR'              90  Crt Tattoo Acti
     C                     PARM *BLANK    W0RTN   7
     C                     PARM BLHMNB    WQ0050  30       BOH Company Num
     C                     PARM BLBNNB    WQ0051  50       BOH Buy Order N
     C                     PARM BLBONB    WQ0052  50       BOL Load Number
     C                     PARM BLCVNB    WQ0053  50       TH Tattoo Numbe
     C                     PARM BLB0DT    WQ0054  70       TH Kill Date
     C                     PARM *ZERO     WQ0055  50       TH Head Receive
     C                     PARM *ZERO     WQ0056  50       TH Held Over
     C                     PARM *ZERO     WQ0057  80       TH AP Voucher/D
     C                     PARM *ZERO     WQ0058  70       TH Voucher Paym
     C                     PARM 'CV'      WQ0059  2        Tattoo Action U
     C                     PARM *BLANK    WQ0060  5        Tattoo Nbr Alph
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKV4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : PO BO Header
      *================================================================
      * PO BO Header: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Tattoo Ded/Add    PO
      *================================================================
      * Prt Tattoo Ded/Add    PO: Mainline
     C                     EXSR C0MAIN
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Setup job date/time
      *
     C                     Z-ADDUDATE     ##JDT
      * Set century digit (If YY prior to 1940 treat as 20YY)
     C           ##JYY     IFLT 40
     C                     Z-ADD1         ##JCC
     C                     ELSE
     C                     Z-ADD0         ##JCC
     C                     END
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field TH AP Voucher/Document#
     C                     Z-ADD*ZERO     WULPNB  80
      * Define work field VCH Batch Number
     C                     Z-ADD*ZERO     WULWNB  50
      * Define work field Producer Code         USR
     C                     MOVEL*BLANK    WUARCD  6
      * Define work field @Status Crt Vch Rec usr
     C                     MOVEL*BLANK    WUKFST  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    A1HMNB           BOH Company Num
     C                     MOVEL*LOVAL    A1ABCD           PD Producer Cod
     C                     MOVEL*LOVAL    A1B0DT           TH Kill Date
     C                     MOVEL*LOVAL    A1CVNB           TH Tattoo Numbe
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    AWHMNB           BOH Company Num
     C                     MOVEL*LOVAL    AWBNNB           BOH Buy Order N
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    CDHMNB           BOH Company Num
     C                     MOVEL*LOVAL    CDBNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    CDBONB           BOL Load Number
     C                     MOVEL*LOVAL    CDCVNB           TH Tattoo Numbe
     C                     MOVEL*LOVAL    CDB0DT           TH Kill Date
     C                     MOVEL*LOVAL    CDBQCD           DED D/A Code
      * Define work field Deds/Add Totals Usr
     C                     Z-ADD*ZERO     WUBEVA  92
      * Define work field Tattoo Sequence Number
     C                     Z-ADD*ZERO     WUN5NB  50
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field VCH Header Number
     C                     Z-ADD*ZERO     WUG9NB  50
      * Define work field TH Kill Date
     C                     Z-ADD*ZERO     WUB0DT  70
      * Define work field VCH Split %
     C                     Z-ADD*ZERO     WUBUPC  30
      * Define work field VCH AP Address Number
     C                     Z-ADD*ZERO     WULXNB  80
      * Define work field SR Source Code
     C                     MOVEL*BLANK    WUAACD  3
      * Define work field VCH Payee Type
     C                     MOVEL*BLANK    WUCSST  1
      * Define work field VCH Gross Amt
     C                     Z-ADD*ZERO     WUAUVA  92
      * Define work field VCH Net Amt
     C                     Z-ADD*ZERO     WUAJVA  92
      * Define work field VCH Less Split Amount
     C                     Z-ADD*ZERO     WUCHPR  72
      * Define work field VCH Deduction Amt
     C                     Z-ADD*ZERO     WUAVVA  92
      * Define work field VCH Base Mkt Price Amt
     C                     Z-ADD*ZERO     WUCIPR  72
      * Define work field VCH Sort Disc Amt
     C                     Z-ADD*ZERO     WUCJPR  72
      * Define work field VCH Yield Gain/Loss Amt
     C                     Z-ADD*ZERO     WUCKPR  72
      * Define work field VCH Base Carcass Value
     C                     Z-ADD*ZERO     WUCLPR  72
      * Define work field VCH LN Add on/Deduct Amt
     C                     Z-ADD*ZERO     WUCMPR  72
      * Define work field VCD Line
     C                     Z-ADD*ZERO     WUDLNB  30
      * Define work field Date USR
     C                     Z-ADD*ZERO     WUB5DT  70
      * Define work field TH Head Received
     C                     Z-ADD*ZERO     WUCWNB  50
      * Define work field TH Yard Deads
     C                     Z-ADD*ZERO     WUFCNB  50
      * Define work field TH Head Condemned
     C                     Z-ADD*ZERO     WUFDNB  50
      * Define work field TH Head Killed
     C                     Z-ADD*ZERO     WUFENB  50
      * Define work field TH Head Adds
     C                     Z-ADD*ZERO     WUHENB  50
      * Define work field TH Live Wgt
     C                     Z-ADD*ZERO     WUCYNB  71
      * Define work field TH Adj Live Wgt
     C                     Z-ADD*ZERO     WULRNB  71
      * Define work field TH Hot Wgt
     C                     Z-ADD*ZERO     WUE0NB  71
      * Define work field TH Avg Live Wgt
     C                     Z-ADD*ZERO     WUF7NB  51
      * Define work field TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WUHDNB  51
      * Define work field TH Avg Lean Percent
     C                     Z-ADD*ZERO     WUF4NB  31
      * Define work field TH Avg Loin Eye Depth
     C                     Z-ADD*ZERO     WUF3NB  31
      * Define work field TH Avg Backfat
     C                     Z-ADD*ZERO     WUF2NB  31
      * Define work field TH Actual Yield %
     C                     Z-ADD*ZERO     WUAWPC  52
      * Define work field TH Adj Actual Yield %
     C                     Z-ADD*ZERO     WUCWPC  52
      * Define work field TH CM Base Mkt Price Amt
     C                     Z-ADD*ZERO     WUANPR  72
      * Define work field TH CM Sort Discount Amt
     C                     Z-ADD*ZERO     WUAYVA  72
      * Define work field TH CM Yield Gain/Loss Amt
     C                     Z-ADD*ZERO     WUAWVA  72
      * Define work field TH CM Base Carcass Value
     C                     Z-ADD*ZERO     WUAOPR  72
      * Define work field TH CM LN AddOn/Deduct Amt
     C                     Z-ADD*ZERO     WUAXVA  72
      * Define work field TH CM Carcass Gross Amt
     C                     Z-ADD*ZERO     WUAPPR  72
      * Define work field TH Deduction Amt
     C                     Z-ADD*ZERO     WUASPR  72
      * Define work field TH Carcass Net Amt
     C                     Z-ADD*ZERO     WUATPR  72
      * Define work field TH Additions Amt
     C                     Z-ADD*ZERO     WUA5VA  72
      * Define work field TH Payment Gross
     C                     Z-ADD*ZERO     WUCBPR  72
      * Define work field Th Payment Net Amt
     C                     Z-ADD*ZERO     WUCCPR  72
      * Define work field TH FFLI
     C                     Z-ADD*ZERO     WUHINB  31
      * Define work field TH CM Bse Mkt Live /CWT
     C                     Z-ADD*ZERO     WUD6PR  52
      * Define work field TH CM Bse Mkt Carc /CWT
     C                     Z-ADD*ZERO     WUD7PR  52
      * Define work field TH CM Srt Dsc Live /CWT
     C                     Z-ADD*ZERO     WUD8PR  52
      * Define work field TH CM Srt Dsc Carc /CWT
     C                     Z-ADD*ZERO     WUD9PR  52
      * Define work field TH CM Yld G/L Live /CWT
     C                     Z-ADD*ZERO     WUEAPR  52
      * Define work field TH CM Yld G/L Carc /CWT
     C                     Z-ADD*ZERO     WUEBPR  52
      * Define work field TH CM Crc Val Live /CWT
     C                     Z-ADD*ZERO     WUECPR  52
      * Define work field TH CM Crc Val Carc /CWT
     C                     Z-ADD*ZERO     WUEDPR  52
      * Define work field TH CM Lean Prem Live /CWT
     C                     Z-ADD*ZERO     WUEEPR  52
      * Define work field TH CM Lean Prem Carc /CWT
     C                     Z-ADD*ZERO     WUEFPR  52
      * Define work field TH CM Gross Live /CWT
     C                     Z-ADD*ZERO     WUEGPR  52
      * Define work field TH CM Gross Carc /CWT
     C                     Z-ADD*ZERO     WUEHPR  52
      * Define work field Print Carcass Analysis Us
     C                     MOVEL*BLANK    WUMVST  1
      * Define work field First Time Flag Usr
     C                     MOVEL*BLANK    WUHBST  1
      * Define work field TH CA Base Mkt Price Amt
     C                     Z-ADD*ZERO     WUI6PR  72
      * Define work field TH CA Sort Discount Amt
     C                     Z-ADD*ZERO     WUI7PR  72
      * Define work field TH CA Yield Gain/Loss Amt
     C                     Z-ADD*ZERO     WUI8PR  72
      * Define work field TH CA Base Carcass Value
     C                     Z-ADD*ZERO     WUI9PR  72
      * Define work field TH CA Lean Premium Amt
     C                     Z-ADD*ZERO     WUJAPR  72
      * Define work field TH CA Carcass Gross Amt
     C                     Z-ADD*ZERO     WUJCPR  72
      * Define work field #Sequence Block
     C                     MOVEL*BLANK    WUJ0ST  1
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Define work field Net Ded/Add amount    USR
     C                     Z-ADD*ZERO     WUA9VA  92
      * Define work field VCD Net Amt
     C                     Z-ADD*ZERO     WUAMVA  92
      * Define work field Percent Decimal       USR
     C                     Z-ADD*ZERO     WUL9NB  74
      * Define work field VCD Less Split Amount
     C                     Z-ADD*ZERO     WUCVPR  72
      * Define work field BOH Payment Type
     C                     MOVEL*BLANK    WUA4ST  1
      * Define work field BOH Buy Order Type
     C                     MOVEL*BLANK    WUA5ST  1
      * Define work field HC Description
     C                     MOVEL*BLANK    WUBDTX 25
      * Define work field Tattoo Nbr 4          USR
     C                     Z-ADD*ZERO     WUMLNB  40
      * Define work field Tattoo Nbr Alpha 4    USR
     C                     MOVEL*BLANK    WUDUCD  4
      * Define work field VCD Check Description
     C                     MOVEL*BLANK    WUF5TX 20
      * Define work field VCD Hog Class Type
     C                     MOVEL*BLANK    WUJIST  1
      * Define work field @Status Kill Dt Break
     C                     MOVEL*BLANK    WUKTST  1
      * Define work field VCD Base Mkt Price Amt
     C                     Z-ADD*ZERO     WUCNPR  72
      * Define work field VCD Sort Disc Amt
     C                     Z-ADD*ZERO     WUCOPR  72
      * Define work field VCD Yield Gain/Loss
     C                     Z-ADD*ZERO     WUCPPR  72
      * Define work field VCD Base Carcass Value
     C                     Z-ADD*ZERO     WUCQPR  72
      * Define work field VCD LN Add on/Deduct Amt
     C                     Z-ADD*ZERO     WUCRPR  72
      * Define work field VCD Gross Amt
     C                     Z-ADD*ZERO     WUAKVA  92
      * Define work field @Status (Yes/No)
     C                     MOVEL*BLANK    WUABST  1
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Define work field Net Amount           USR
     C                     Z-ADD*ZERO     WUA8VA  92
      * Define work field SR Type
     C                     MOVEL*BLANK    WUIXST  1
      * Define work field Header Number   USR
     C                     Z-ADD*ZERO     WUL4NB  50
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD03 177       *Synon (17,7) w
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * Mov ApplN to Co-PRINT US - STR User Source Functions  * 
     C***   MOVE USER SOURCE                      ***
     C                     MOVELP3EVTX    $ACMP
     C                     Z-ADD*ZERO     WULPNB           TH AP Voucher/D
      * ONLY on Posting Init routine for vouchers
      * CASE: PAR.@Status Edit/Post is Post
     C           P2J2ST    IFEQ 'P'                        *IF
      * Crt Live Vchr Init    IF
     C                     MOVEL*BLANK    WUARCD           Producer Code
      * Rtv Nxt Vch Batch #   RT - Hog Voucher Header  * 
     C                     EXSR SARVGN
     C                     END                             *FI
     C                     MOVEL*BLANK    WUKFST           @Status Crt Vch
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Prt CrcDtl
