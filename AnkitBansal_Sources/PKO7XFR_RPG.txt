     H/TITLE UPD EvUPL - EvTrans    XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISJBADE
     H* Date          : 08/20/21  Time  : 12:56:47
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKA2CPLHIF  E           K        DISK
      * RSQ : Tattoo Detail             Co/Kld/Drd/DrT/Tatto 910
      *
     FPKA1CPLIIF  E           K        DISK
      * RSQ : Tattoo Header             Co/Bol/Ttt
      *
     FPKDYCPL1IF  E           K        DISK
      * RTV : Tattoo Detail Ext         Retrieval index
      *
     FPKCPCPLCIF  E           K        DISK
      * RSQ : Eval Trans UPL            RTV Kill/Tto UnPrcss
      *
     FPKBVCPL2IF  E           K        DISK
      * RSQ : Eval Trans                Next Eval Trans
      *
     FPKCPCPLAIF  E           K        DISK
      * RSQ : Eval Trans UPL            Kill/Seq Unprcss
      *
     FPKCQCPL2IF  E           K        DISK
      * RSQ : Eval Trans Invalid UPL    Next Number
      *
     FPKCPCPL2IF  E           K        DISK
      * RSQ : RTV Kill/Sft/Tto UnPrcss Retrieval Index
      *
     FPKA1CPLBIF  E           K        DISK
      * RSQ : Tattoo Header             Kill/Ttto Only/Active
      *
     FPKDYCPL0UF  E           K        DISK                      A
      * UPD : Tattoo Detail Ext         Update index
      *
     FPKBVCPL0IF  E           K        DISK                      A
      * UPD : Eval Trans                Update index
      *
     FPKCPCPL0UF  E           K        DISK
      * UPD : Eval Trans UPL            Update index
      *
     FPKCQCPL0IF  E           K        DISK                      A
      * UPD : Eval Trans Invalid UPL    Update index
      *
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     I@A2CPBA
      * Tattoo Detail             Co/Kld/Drd/DrT/Tatto 910
      * Renamed input format fields
     I              A2HMNB                          WAHMNB
     I              A2BNNB                          WABNNB
     I              A2BONB                          WABONB
     I              A2CVNB                          WACVNB
     I              A2B0DT                          WAB0DT
     I              A2C2NB                          WAC2NB
     I              A2CZNB                          WACZNB
     I              A2C0NB                          WAC0NB
     I              A2D8NB                          WAD8NB
     I              A2H7NB                          WAH7NB
     I              A2GGST                          WAGGST
     I              A2AJTM                          WAAJTM
     I              A2JEA1                          WAJEA1
     I              A2B7CD                          WAB7CD
     I              A2D7NB                          WAD7NB
     I              A2D9ST                          WAD9ST
     I              A2E3ST                          WAE3ST
     I              A2E4ST                          WAE4ST
     I              A2E5ST                          WAE5ST
     I              A2BVDT                          WABVDT
     I              A2BWDT                          WABWDT
     I              A2BXDT                          WABXDT
     I              A2HVNB                          WAHVNB
     I              A2CMCD                          WACMCD
     I              A2B9CD                          WAB9CD
     I              A2H8NB                          WAH8NB
     I              A2CYCD                          WACYCD
     I              A2AAVN                          WAAAVN
     I              A2AADT                          WAAADT
     I              A2AMTM                          WAAMTM
     I              A2AJST                          WAAJST
     I              A2AHVN                          WAAHVN
     I              A2AGVN                          WAAGVN
     I              A2ABVN                          WAABVN
     I              A2ABDT                          WAABDT
     I              A2ABTM                          WAABTM
      *
     I@A1CPOI
      * Tattoo Header             Co/Bol/Ttt
      * Renamed input format fields
     I              A1HMNB                          WBHMNB
     I              A1BNNB                          WBBNNB
     I              A1BONB                          WBBONB
     I              A1CVNB                          WBCVNB
     I              A1B0DT                          WBB0DT
     I              A1AWDT                          WBAWDT
     I              A1BICD                          WBBICD
     I              A1CPST                          WBCPST
     I              A1ACPR                          WBACPR
     I              A1B9PR                          WBB9PR
     I              A1CAPR                          WBCAPR
     I              A1C4ST                          WBC4ST
     I              A1AIPR                          WBAIPR
     I              A1A6DT                          WBA6DT
     I              A1C2ST                          WBC2ST
     I              A1CXNB                          WBCXNB
     I              A1CWNB                          WBCWNB
     I              A1FCNB                          WBFCNB
     I              A1H9NB                          WBH9NB
     I              A1FDNB                          WBFDNB
     I              A1FENB                          WBFENB
     I              A1HENB                          WBHENB
     I              A1HFNB                          WBHFNB
     I              A1CYNB                          WBCYNB
     I              A1LRNB                          WBLRNB
     I              A1E0NB                          WBE0NB
     I              A1A5PC                          WBA5PC
     I              A1FBNB                          WBFBNB
     I              A1A4PC                          WBA4PC
     I              A1F7NB                          WBF7NB
     I              A1HDNB                          WBHDNB
     I              A1F5NB                          WBF5NB
     I              A1F4NB                          WBF4NB
     I              A1F3NB                          WBF3NB
     I              A1F2NB                          WBF2NB
     I              A1AVPC                          WBAVPC
     I              A1AWPC                          WBAWPC
     I              A1CWPC                          WBCWPC
     I              A1A8PC                          WBA8PC
     I              A1A7PC                          WBA7PC
     I              A1B8PR                          WBB8PR
     I              A1AMPR                          WBAMPR
     I              A1ANPR                          WBANPR
     I              A1AYVA                          WBAYVA
     I              A1AWVA                          WBAWVA
     I              A1AOPR                          WBAOPR
     I              A1AXVA                          WBAXVA
     I              A1APPR                          WBAPPR
     I              A1ASPR                          WBASPR
     I              A1A4VA                          WBA4VA
     I              A1ATPR                          WBATPR
     I              A1A5VA                          WBA5VA
     I              A1CBPR                          WBCBPR
     I              A1CCPR                          WBCCPR
     I              A1LPNB                          WBLPNB
     I              A1CDPR                          WBCDPR
     I              A1A7VA                          WBA7VA
     I              A1A2PR                          WBA2PR
     I              A1JWST                          WBJWST
     I              A1CWST                          WBCWST
     I              A1D7ST                          WBD7ST
     I              A1D8ST                          WBD8ST
     I              A1DWST                          WBDWST
     I              A1D6ST                          WBD6ST
     I              A1GHNB                          WBGHNB
     I              A1BYDT                          WBBYDT
     I              A1E0ST                          WBE0ST
     I              A1E1ST                          WBE1ST
     I              A1E2ST                          WBE2ST
     I              A1BSDT                          WBBSDT
     I              A1BTDT                          WBBTDT
     I              A1BUDT                          WBBUDT
     I              A1HGNB                          WBHGNB
     I              A1HHNB                          WBHHNB
     I              A1HINB                          WBHINB
     I              A1A3PR                          WBA3PR
     I              A1A4PR                          WBA4PR
     I              A1A6PR                          WBA6PR
     I              A1J9NB                          WBJ9NB
     I              A1D6PR                          WBD6PR
     I              A1D7PR                          WBD7PR
     I              A1D8PR                          WBD8PR
     I              A1D9PR                          WBD9PR
     I              A1EAPR                          WBEAPR
     I              A1EBPR                          WBEBPR
     I              A1ECPR                          WBECPR
     I              A1EDPR                          WBEDPR
     I              A1EEPR                          WBEEPR
     I              A1EFPR                          WBEFPR
     I              A1EGPR                          WBEGPR
     I              A1EHPR                          WBEHPR
     I              A1KAST                          WBKAST
     I              A1J7ST                          WBJ7ST
     I              A1J9ST                          WBJ9ST
     I              A1OXNB                          WBOXNB
     I              A1LKST                          WBLKST
     I              A1LLST                          WBLLST
     I              A1J8ST                          WBJ8ST
     I              A1LIST                          WBLIST
     I              A1LJST                          WBLJST
     I              A1NZTX                          WBNZTX
     I              A1HJCD                          WBHJCD
     I              A1R4ST                          WBR4ST
     I              A1R5ST                          WBR5ST
     I              A1R6ST                          WBR6ST
     I              A1R7ST                          WBR7ST
     I              A1THWT                          WBTHWT
     I              A1T2WT                          WBT2WT
     I              A1THHD                          WBTHHD
     I              A1T2HD                          WBT2HD
     I              A1OBPR                          WBOBPR
     I              A1KOER                          WBKOER
     I              A1OPIR                          WBOPIR
     I              A1OPEM                          WBOPEM
     I              A1IORP                          WBIORP
     I              A1OWEO                          WBOWEO
     I              A1OQET                          WBOQET
     I              A1URST                          WBURST
     I              A1USST                          WBUSST
     I              A1HHPC                          WBHHPC
     I              A1S9PR                          WBS9PR
     I              A1TAPR                          WBTAPR
     I              A1TBPR                          WBTBPR
     I              A1JFUR                          WBJFUR
     I              A1KRIF                          WBKRIF
     I              A1KORF                          WBKORF
     I              A1KAPR                          WBKAPR
     I              A1KROT                          WBKROT
     I              A1OTJG                          WBOTJG
     I              A1IRJG                          WBIRJG
     I              A1IMJF                          WBIMJF
     I              A1IRGF                          WBIRGF
     I              A1KRJF                          WBKRJF
     I              A1OJRF                          WBOJRF
     I              A1KFOR                          WBKFOR
     I              A1ORJK                          WBORJK
     I              A1OMVJ                          WBOMVJ
     I              A1MVNF                          WBMVNF
     I              A1MCNF                          WBMCNF
     I              A1NCNF                          WBNCNF
     I              A1NCHF                          WBNCHF
     I              A1IGIR                          WBIGIR
     I              A1KFJR                          WBKFJR
     I              A1EADT                          WBEADT
     I              A1EBDT                          WBEBDT
     I              A1ECDT                          WBECDT
     I              A1EDDT                          WBEDDT
     I              A1EEDT                          WBEEDT
     I              A1U4ST                          WBU4ST
     I              A1U5ST                          WBU5ST
     I              A1U6ST                          WBU6ST
     I              A1U7ST                          WBU7ST
     I              A1U8ST                          WBU8ST
     I              A1U9ST                          WBU9ST
     I              A1VAST                          WBVAST
     I              A1VBST                          WBVBST
     I              A1BDCD                          WBBDCD
     I              A1CSCD                          WBCSCD
     I              A1ABCD                          WBABCD
     I              A1AECD                          WBAECD
     I              A1ACCD                          WBACCD
     I              A1AGCD                          WBAGCD
     I              A1BECD                          WBBECD
     I              A1AAVN                          WBAAVN
     I              A1AADT                          WBAADT
     I              A1AMTM                          WBAMTM
     I              A1AJST                          WBAJST
     I              A1AHVN                          WBAHVN
     I              A1AGVN                          WBAGVN
     I              A1ABVN                          WBABVN
     I              A1ABDT                          WBABDT
     I              A1ABTM                          WBABTM
      *
     I@DYCPXX
      * Tattoo Detail Ext         Retrieval index
      * Renamed input format fields
     I              DYHMNB                          WCHMNB
     I              DYBNNB                          WCBNNB
     I              DYBONB                          WCBONB
     I              DYCVNB                          WCCVNB
     I              DYB0DT                          WCB0DT
     I              DYC2NB                          WCC2NB
     I              DYP3ST                          WCP3ST
     I              DYLENB                          WCLENB
     I              DYLFNB                          WCLFNB
     I              DYLINB                          WCLINB
     I              DYP4ST                          WCP4ST
     I              DYP5ST                          WCP5ST
     I              DYAAVN                          WCAAVN
     I              DYAADT                          WCAADT
     I              DYAMTM                          WCAMTM
     I              DYAJST                          WCAJST
     I              DYAHVN                          WCAHVN
     I              DYAGVN                          WCAGVN
     I              DYABVN                          WCABVN
     I              DYABDT                          WCABDT
     I              DYABTM                          WCABTM
      *
     I@DYCPXW
      * Tattoo Detail Ext         Update index
      * Renamed input format fields
     I              DYHMNB                          WDHMNB
     I              DYBNNB                          WDBNNB
     I              DYBONB                          WDBONB
     I              DYCVNB                          WDCVNB
     I              DYB0DT                          WDB0DT
     I              DYC2NB                          WDC2NB
     I              DYP3ST                          WDP3ST
     I              DYLENB                          WDLENB
     I              DYLFNB                          WDLFNB
     I              DYLINB                          WDLINB
     I              DYP4ST                          WDP4ST
     I              DYP5ST                          WDP5ST
     I              DYAAVN                          WDAAVN
     I              DYAADT                          WDAADT
     I              DYAMTM                          WDAMTM
     I              DYAJST                          WDAJST
     I              DYAHVN                          WDAHVN
     I              DYAGVN                          WDAGVN
     I              DYABVN                          WDABVN
     I              DYABDT                          WDABDT
     I              DYABTM                          WDABTM
      *
     I@CPCPEH
      * Eval Trans UPL            RTV Kill/Tto UnPrcss
      * Renamed input format fields
     I              CPHKST                          WEHKST
     I              CPB7DT                          WEB7DT
     I              CPKINB                          WEKINB
     I              CPKHNB                          WEKHNB
     I              CPLNNB                          WELNNB
     I              CPHLST                          WEHLST
     I              CPKJNB                          WEKJNB
     I              CPKKNB                          WEKKNB
     I              CPBQPC                          WEBQPC
     I              CPBRPC                          WEBRPC
     I              CPHMST                          WEHMST
     I              CPHNST                          WEHNST
     I              CPHTST                          WEHTST
     I              CPHUST                          WEHUST
     I              CPX6NB                          WEX6NB
     I              CPFQPC                          WEFQPC
     I              CPFRPC                          WEFRPC
     I              CPM7CD                          WEM7CD
     I              CPX7ST                          WEX7ST
     I              CPX8ST                          WEX8ST
     I              CPX9ST                          WEX9ST
     I              CPYAST                          WEYAST
     I              CPYBST                          WEYBST
     I              CPYCST                          WEYCST
     I              CPZJST                          WEZJST
     I              CPZKST                          WEZKST
     I              CPZLST                          WEZLST
     I              CPB8DT                          WEB8DT
     I              CPAOTM                          WEAOTM
      *
     I@BVCPNE
      * Eval Trans                Next Eval Trans
      * Renamed input format fields
     I              BVHSNB                          WFHSNB
     I              BVA9DT                          WFA9DT
     I              BVFJNB                          WFFJNB
     I              BVHCNB                          WFHCNB
     I              BVGDNB                          WFGDNB
     I              BVFINB                          WFFINB
     I              BVLKNB                          WFLKNB
     I              BVEAST                          WFEAST
     I              BVAMPC                          WFAMPC
     I              BVAIPC                          WFAIPC
     I              BVAJPC                          WFAJPC
     I              BVAKPC                          WFAKPC
     I              BVX8NB                          WFX8NB
     I              BVFVPC                          WFFVPC
     I              BVFWPC                          WFFWPC
     I              BVFXPC                          WFFXPC
     I              BVALPC                          WFALPC
     I              BVDIST                          WFDIST
     I              BVFYST                          WFFYST
     I              BVD2ST                          WFD2ST
     I              BVEHST                          WFEHST
     I              BVG1ST                          WFG1ST
     I              BVH4ST                          WFH4ST
     I              BVJLST                          WFJLST
     I              BVUUST                          WFUUST
     I              BVVHST                          WFVHST
     I              BVVIST                          WFVIST
     I              BVVJST                          WFVJST
     I              BVVKST                          WFVKST
     I              BVVLST                          WFVLST
     I              BVHMNB                          WFHMNB
     I              BVBNNB                          WFBNNB
     I              BVBONB                          WFBONB
     I              BVCVNB                          WFCVNB
     I              BVB0DT                          WFB0DT
     I              BVAAVN                          WFAAVN
     I              BVAADT                          WFAADT
     I              BVAMTM                          WFAMTM
     I              BVAJST                          WFAJST
     I              BVAHVN                          WFAHVN
     I              BVAGVN                          WFAGVN
     I              BVABVN                          WFABVN
     I              BVABDT                          WFABDT
     I              BVABTM                          WFABTM
     I              BVB8DT                          WFB8DT
     I              BVAOTM                          WFAOTM
      *
     I@BVCPF0
      * Eval Trans                Update index
      * Renamed input format fields
     I              BVHSNB                          WGHSNB
     I              BVA9DT                          WGA9DT
     I              BVFJNB                          WGFJNB
     I              BVHCNB                          WGHCNB
     I              BVGDNB                          WGGDNB
     I              BVFINB                          WGFINB
     I              BVLKNB                          WGLKNB
     I              BVEAST                          WGEAST
     I              BVAMPC                          WGAMPC
     I              BVAIPC                          WGAIPC
     I              BVAJPC                          WGAJPC
     I              BVAKPC                          WGAKPC
     I              BVX8NB                          WGX8NB
     I              BVFVPC                          WGFVPC
     I              BVFWPC                          WGFWPC
     I              BVFXPC                          WGFXPC
     I              BVALPC                          WGALPC
     I              BVDIST                          WGDIST
     I              BVFYST                          WGFYST
     I              BVD2ST                          WGD2ST
     I              BVEHST                          WGEHST
     I              BVG1ST                          WGG1ST
     I              BVH4ST                          WGH4ST
     I              BVJLST                          WGJLST
     I              BVUUST                          WGUUST
     I              BVVHST                          WGVHST
     I              BVVIST                          WGVIST
     I              BVVJST                          WGVJST
     I              BVVKST                          WGVKST
     I              BVVLST                          WGVLST
     I              BVHMNB                          WGHMNB
     I              BVBNNB                          WGBNNB
     I              BVBONB                          WGBONB
     I              BVCVNB                          WGCVNB
     I              BVB0DT                          WGB0DT
     I              BVAAVN                          WGAAVN
     I              BVAADT                          WGAADT
     I              BVAMTM                          WGAMTM
     I              BVAJST                          WGAJST
     I              BVAHVN                          WGAHVN
     I              BVAGVN                          WGAGVN
     I              BVABVN                          WGABVN
     I              BVABDT                          WGABDT
     I              BVABTM                          WGABTM
     I              BVB8DT                          WGB8DT
     I              BVAOTM                          WGAOTM
      *
     I@CPCPMW
      * Eval Trans UPL            Update index
      * Renamed input format fields
     I              CPHKST                          WHHKST
     I              CPB7DT                          WHB7DT
     I              CPKINB                          WHKINB
     I              CPKHNB                          WHKHNB
     I              CPLNNB                          WHLNNB
     I              CPHLST                          WHHLST
     I              CPKJNB                          WHKJNB
     I              CPKKNB                          WHKKNB
     I              CPBQPC                          WHBQPC
     I              CPBRPC                          WHBRPC
     I              CPHMST                          WHHMST
     I              CPHNST                          WHHNST
     I              CPHTST                          WHHTST
     I              CPHUST                          WHHUST
     I              CPX6NB                          WHX6NB
     I              CPFQPC                          WHFQPC
     I              CPFRPC                          WHFRPC
     I              CPM7CD                          WHM7CD
     I              CPX7ST                          WHX7ST
     I              CPX8ST                          WHX8ST
     I              CPX9ST                          WHX9ST
     I              CPYAST                          WHYAST
     I              CPYBST                          WHYBST
     I              CPYCST                          WHYCST
     I              CPZJST                          WHZJST
     I              CPZKST                          WHZKST
     I              CPZLST                          WHZLST
     I              CPB8DT                          WHB8DT
     I              CPAOTM                          WHAOTM
      *
     I@CPCPBB
      * Eval Trans UPL            Kill/Seq Unprcss
      * Renamed input format fields
     I              CPHKST                          WIHKST
     I              CPB7DT                          WIB7DT
     I              CPKINB                          WIKINB
     I              CPKHNB                          WIKHNB
     I              CPLNNB                          WILNNB
     I              CPHLST                          WIHLST
     I              CPKJNB                          WIKJNB
     I              CPKKNB                          WIKKNB
     I              CPBQPC                          WIBQPC
     I              CPBRPC                          WIBRPC
     I              CPHMST                          WIHMST
     I              CPHNST                          WIHNST
     I              CPHTST                          WIHTST
     I              CPHUST                          WIHUST
     I              CPX6NB                          WIX6NB
     I              CPFQPC                          WIFQPC
     I              CPFRPC                          WIFRPC
     I              CPM7CD                          WIM7CD
     I              CPX7ST                          WIX7ST
     I              CPX8ST                          WIX8ST
     I              CPX9ST                          WIX9ST
     I              CPYAST                          WIYAST
     I              CPYBST                          WIYBST
     I              CPYCST                          WIYCST
     I              CPZJST                          WIZJST
     I              CPZKST                          WIZKST
     I              CPZLST                          WIZLST
     I              CPB8DT                          WIB8DT
     I              CPAOTM                          WIAOTM
      *
     I@CQCPNS
      * Eval Trans Invalid UPL    Next Number
      * Renamed input format fields
     I              CQKMNB                          WJKMNB
     I              CQB9DT                          WJB9DT
     I              CQKONB                          WJKONB
     I              CQKNNB                          WJKNNB
     I              CQLMNB                          WJLMNB
     I              CQHOST                          WJHOST
     I              CQKPNB                          WJKPNB
     I              CQKQNB                          WJKQNB
     I              CQBSPC                          WJBSPC
     I              CQBTPC                          WJBTPC
     I              CQX7NB                          WJX7NB
     I              CQFTPC                          WJFTPC
     I              CQFUPC                          WJFUPC
     I              CQHPST                          WJHPST
     I              CQHQST                          WJHQST
     I              CQHSST                          WJHSST
     I              CQIFST                          WJIFST
     I              CQM8CD                          WJM8CD
     I              CQZMST                          WJZMST
     I              CQZNST                          WJZNST
     I              CQZOST                          WJZOST
     I              CQZPST                          WJZPST
     I              CQZQST                          WJZQST
     I              CQZRST                          WJZRST
     I              CQZSST                          WJZSST
     I              CQZTST                          WJZTST
     I              CQZUST                          WJZUST
     I              CQB8DT                          WJB8DT
     I              CQAOTM                          WJAOTM
      *
     I@CQCPMZ
      * Eval Trans Invalid UPL    Update index
      * Renamed input format fields
     I              CQKMNB                          WKKMNB
     I              CQB9DT                          WKB9DT
     I              CQKONB                          WKKONB
     I              CQKNNB                          WKKNNB
     I              CQLMNB                          WKLMNB
     I              CQHOST                          WKHOST
     I              CQKPNB                          WKKPNB
     I              CQKQNB                          WKKQNB
     I              CQBSPC                          WKBSPC
     I              CQBTPC                          WKBTPC
     I              CQX7NB                          WKX7NB
     I              CQFTPC                          WKFTPC
     I              CQFUPC                          WKFUPC
     I              CQHPST                          WKHPST
     I              CQHQST                          WKHQST
     I              CQHSST                          WKHSST
     I              CQIFST                          WKIFST
     I              CQM8CD                          WKM8CD
     I              CQZMST                          WKZMST
     I              CQZNST                          WKZNST
     I              CQZOST                          WKZOST
     I              CQZPST                          WKZPST
     I              CQZQST                          WKZQST
     I              CQZRST                          WKZRST
     I              CQZSST                          WKZSST
     I              CQZTST                          WKZTST
     I              CQZUST                          WKZUST
     I              CQB8DT                          WKB8DT
     I              CQAOTM                          WKAOTM
      *
     I@CPCPNC
      * RTV Kill/Sft/Tto UnPrcss Retrieval Index
      * Renamed input format fields
     I              CPHKST                          WLHKST
     I              CPB7DT                          WLB7DT
     I              CPKINB                          WLKINB
     I              CPKHNB                          WLKHNB
     I              CPLNNB                          WLLNNB
     I              CPHLST                          WLHLST
     I              CPKJNB                          WLKJNB
     I              CPKKNB                          WLKKNB
     I              CPBQPC                          WLBQPC
     I              CPBRPC                          WLBRPC
     I              CPHMST                          WLHMST
     I              CPHNST                          WLHNST
     I              CPHTST                          WLHTST
     I              CPHUST                          WLHUST
     I              CPX6NB                          WLX6NB
     I              CPFQPC                          WLFQPC
     I              CPFRPC                          WLFRPC
     I              CPM7CD                          WLM7CD
     I              CPX7ST                          WLX7ST
     I              CPX8ST                          WLX8ST
     I              CPX9ST                          WLX9ST
     I              CPYAST                          WLYAST
     I              CPYBST                          WLYBST
     I              CPYCST                          WLYCST
     I              CPZJST                          WLZJST
     I              CPZKST                          WLZKST
     I              CPZLST                          WLZLST
     I              CPB8DT                          WLB8DT
     I              CPAOTM                          WLAOTM
      *
     I@A1CPND
      * Tattoo Header             Kill/Ttto Only/Active
      * Renamed input format fields
     I              A1HMNB                          WMHMNB
     I              A1BNNB                          WMBNNB
     I              A1BONB                          WMBONB
     I              A1CVNB                          WMCVNB
     I              A1B0DT                          WMB0DT
     I              A1AWDT                          WMAWDT
     I              A1BICD                          WMBICD
     I              A1CPST                          WMCPST
     I              A1ACPR                          WMACPR
     I              A1B9PR                          WMB9PR
     I              A1CAPR                          WMCAPR
     I              A1C4ST                          WMC4ST
     I              A1AIPR                          WMAIPR
     I              A1A6DT                          WMA6DT
     I              A1C2ST                          WMC2ST
     I              A1CXNB                          WMCXNB
     I              A1CWNB                          WMCWNB
     I              A1FCNB                          WMFCNB
     I              A1H9NB                          WMH9NB
     I              A1FDNB                          WMFDNB
     I              A1FENB                          WMFENB
     I              A1HENB                          WMHENB
     I              A1HFNB                          WMHFNB
     I              A1CYNB                          WMCYNB
     I              A1LRNB                          WMLRNB
     I              A1E0NB                          WME0NB
     I              A1A5PC                          WMA5PC
     I              A1FBNB                          WMFBNB
     I              A1A4PC                          WMA4PC
     I              A1F7NB                          WMF7NB
     I              A1HDNB                          WMHDNB
     I              A1F5NB                          WMF5NB
     I              A1F4NB                          WMF4NB
     I              A1F3NB                          WMF3NB
     I              A1F2NB                          WMF2NB
     I              A1AVPC                          WMAVPC
     I              A1AWPC                          WMAWPC
     I              A1CWPC                          WMCWPC
     I              A1A8PC                          WMA8PC
     I              A1A7PC                          WMA7PC
     I              A1B8PR                          WMB8PR
     I              A1AMPR                          WMAMPR
     I              A1ANPR                          WMANPR
     I              A1AYVA                          WMAYVA
     I              A1AWVA                          WMAWVA
     I              A1AOPR                          WMAOPR
     I              A1AXVA                          WMAXVA
     I              A1APPR                          WMAPPR
     I              A1ASPR                          WMASPR
     I              A1A4VA                          WMA4VA
     I              A1ATPR                          WMATPR
     I              A1A5VA                          WMA5VA
     I              A1CBPR                          WMCBPR
     I              A1CCPR                          WMCCPR
     I              A1LPNB                          WMLPNB
     I              A1CDPR                          WMCDPR
     I              A1A7VA                          WMA7VA
     I              A1A2PR                          WMA2PR
     I              A1JWST                          WMJWST
     I              A1CWST                          WMCWST
     I              A1D7ST                          WMD7ST
     I              A1D8ST                          WMD8ST
     I              A1DWST                          WMDWST
     I              A1D6ST                          WMD6ST
     I              A1GHNB                          WMGHNB
     I              A1BYDT                          WMBYDT
     I              A1E0ST                          WME0ST
     I              A1E1ST                          WME1ST
     I              A1E2ST                          WME2ST
     I              A1BSDT                          WMBSDT
     I              A1BTDT                          WMBTDT
     I              A1BUDT                          WMBUDT
     I              A1HGNB                          WMHGNB
     I              A1HHNB                          WMHHNB
     I              A1HINB                          WMHINB
     I              A1A3PR                          WMA3PR
     I              A1A4PR                          WMA4PR
     I              A1A6PR                          WMA6PR
     I              A1J9NB                          WMJ9NB
     I              A1D6PR                          WMD6PR
     I              A1D7PR                          WMD7PR
     I              A1D8PR                          WMD8PR
     I              A1D9PR                          WMD9PR
     I              A1EAPR                          WMEAPR
     I              A1EBPR                          WMEBPR
     I              A1ECPR                          WMECPR
     I              A1EDPR                          WMEDPR
     I              A1EEPR                          WMEEPR
     I              A1EFPR                          WMEFPR
     I              A1EGPR                          WMEGPR
     I              A1EHPR                          WMEHPR
     I              A1KAST                          WMKAST
     I              A1J7ST                          WMJ7ST
     I              A1J9ST                          WMJ9ST
     I              A1OXNB                          WMOXNB
     I              A1LKST                          WMLKST
     I              A1LLST                          WMLLST
     I              A1J8ST                          WMJ8ST
     I              A1LIST                          WMLIST
     I              A1LJST                          WMLJST
     I              A1NZTX                          WMNZTX
     I              A1HJCD                          WMHJCD
     I              A1R4ST                          WMR4ST
     I              A1R5ST                          WMR5ST
     I              A1R6ST                          WMR6ST
     I              A1R7ST                          WMR7ST
     I              A1THWT                          WMTHWT
     I              A1T2WT                          WMT2WT
     I              A1THHD                          WMTHHD
     I              A1T2HD                          WMT2HD
     I              A1OBPR                          WMOBPR
     I              A1KOER                          WMKOER
     I              A1OPIR                          WMOPIR
     I              A1OPEM                          WMOPEM
     I              A1IORP                          WMIORP
     I              A1OWEO                          WMOWEO
     I              A1OQET                          WMOQET
     I              A1URST                          WMURST
     I              A1USST                          WMUSST
     I              A1HHPC                          WMHHPC
     I              A1S9PR                          WMS9PR
     I              A1TAPR                          WMTAPR
     I              A1TBPR                          WMTBPR
     I              A1JFUR                          WMJFUR
     I              A1KRIF                          WMKRIF
     I              A1KORF                          WMKORF
     I              A1KAPR                          WMKAPR
     I              A1KROT                          WMKROT
     I              A1OTJG                          WMOTJG
     I              A1IRJG                          WMIRJG
     I              A1IMJF                          WMIMJF
     I              A1IRGF                          WMIRGF
     I              A1KRJF                          WMKRJF
     I              A1OJRF                          WMOJRF
     I              A1KFOR                          WMKFOR
     I              A1ORJK                          WMORJK
     I              A1OMVJ                          WMOMVJ
     I              A1MVNF                          WMMVNF
     I              A1MCNF                          WMMCNF
     I              A1NCNF                          WMNCNF
     I              A1NCHF                          WMNCHF
     I              A1IGIR                          WMIGIR
     I              A1KFJR                          WMKFJR
     I              A1EADT                          WMEADT
     I              A1EBDT                          WMEBDT
     I              A1ECDT                          WMECDT
     I              A1EDDT                          WMEDDT
     I              A1EEDT                          WMEEDT
     I              A1U4ST                          WMU4ST
     I              A1U5ST                          WMU5ST
     I              A1U6ST                          WMU6ST
     I              A1U7ST                          WMU7ST
     I              A1U8ST                          WMU8ST
     I              A1U9ST                          WMU9ST
     I              A1VAST                          WMVAST
     I              A1VBST                          WMVBST
     I              A1BDCD                          WMBDCD
     I              A1CSCD                          WMCSCD
     I              A1ABCD                          WMABCD
     I              A1AECD                          WMAECD
     I              A1ACCD                          WMACCD
     I              A1AGCD                          WMAGCD
     I              A1BECD                          WMBECD
     I              A1AAVN                          WMAAVN
     I              A1AADT                          WMAADT
     I              A1AMTM                          WMAMTM
     I              A1AJST                          WMAJST
     I              A1AHVN                          WMAHVN
     I              A1AGVN                          WMAGVN
     I              A1ABVN                          WMABVN
     I              A1ABDT                          WMABDT
     I              A1ABTM                          WMABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKDY1    E DSPKDYCPL0
      * UPD : Tattoo Detail Ext         Update index
      * Renamed input format fields
     I              DYHMNB                          WDHMNB
     I              DYBNNB                          WDBNNB
     I              DYBONB                          WDBONB
     I              DYCVNB                          WDCVNB
     I              DYB0DT                          WDB0DT
     I              DYC2NB                          WDC2NB
     I              DYP3ST                          WDP3ST
     I              DYLENB                          WDLENB
     I              DYLFNB                          WDLFNB
     I              DYLINB                          WDLINB
     I              DYP4ST                          WDP4ST
     I              DYP5ST                          WDP5ST
     I              DYAAVN                          WDAAVN
     I              DYAADT                          WDAADT
     I              DYAMTM                          WDAMTM
     I              DYAJST                          WDAJST
     I              DYAHVN                          WDAHVN
     I              DYAGVN                          WDAGVN
     I              DYABVN                          WDABVN
     I              DYABDT                          WDABDT
     I              DYABTM                          WDABTM
      *
     IQPKBV1    E DSPKBVCPL0
      * UPD : Eval Trans                Update index
      * Renamed input format fields
     I              BVHSNB                          WGHSNB
     I              BVA9DT                          WGA9DT
     I              BVFJNB                          WGFJNB
     I              BVHCNB                          WGHCNB
     I              BVGDNB                          WGGDNB
     I              BVFINB                          WGFINB
     I              BVLKNB                          WGLKNB
     I              BVEAST                          WGEAST
     I              BVAMPC                          WGAMPC
     I              BVAIPC                          WGAIPC
     I              BVAJPC                          WGAJPC
     I              BVAKPC                          WGAKPC
     I              BVX8NB                          WGX8NB
     I              BVFVPC                          WGFVPC
     I              BVFWPC                          WGFWPC
     I              BVFXPC                          WGFXPC
     I              BVALPC                          WGALPC
     I              BVDIST                          WGDIST
     I              BVFYST                          WGFYST
     I              BVD2ST                          WGD2ST
     I              BVEHST                          WGEHST
     I              BVG1ST                          WGG1ST
     I              BVH4ST                          WGH4ST
     I              BVJLST                          WGJLST
     I              BVUUST                          WGUUST
     I              BVVHST                          WGVHST
     I              BVVIST                          WGVIST
     I              BVVJST                          WGVJST
     I              BVVKST                          WGVKST
     I              BVVLST                          WGVLST
     I              BVHMNB                          WGHMNB
     I              BVBNNB                          WGBNNB
     I              BVBONB                          WGBONB
     I              BVCVNB                          WGCVNB
     I              BVB0DT                          WGB0DT
     I              BVAAVN                          WGAAVN
     I              BVAADT                          WGAADT
     I              BVAMTM                          WGAMTM
     I              BVAJST                          WGAJST
     I              BVAHVN                          WGAHVN
     I              BVAGVN                          WGAGVN
     I              BVABVN                          WGABVN
     I              BVABDT                          WGABDT
     I              BVABTM                          WGABTM
     I              BVB8DT                          WGB8DT
     I              BVAOTM                          WGAOTM
      *
     IQPKCP1    E DSPKCPCPL0
      * UPD : Eval Trans UPL            Update index
      * Renamed input format fields
     I              CPHKST                          WHHKST
     I              CPB7DT                          WHB7DT
     I              CPKINB                          WHKINB
     I              CPKHNB                          WHKHNB
     I              CPLNNB                          WHLNNB
     I              CPHLST                          WHHLST
     I              CPKJNB                          WHKJNB
     I              CPKKNB                          WHKKNB
     I              CPBQPC                          WHBQPC
     I              CPBRPC                          WHBRPC
     I              CPHMST                          WHHMST
     I              CPHNST                          WHHNST
     I              CPHTST                          WHHTST
     I              CPHUST                          WHHUST
     I              CPX6NB                          WHX6NB
     I              CPFQPC                          WHFQPC
     I              CPFRPC                          WHFRPC
     I              CPM7CD                          WHM7CD
     I              CPX7ST                          WHX7ST
     I              CPX8ST                          WHX8ST
     I              CPX9ST                          WHX9ST
     I              CPYAST                          WHYAST
     I              CPYBST                          WHYBST
     I              CPYCST                          WHYCST
     I              CPZJST                          WHZJST
     I              CPZKST                          WHZKST
     I              CPZLST                          WHZLST
     I              CPB8DT                          WHB8DT
     I              CPAOTM                          WHAOTM
      *
     IYARDCS      DS                             59
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                             88
     IYCRDCS      DS                             88
     IQPKCQ1    E DSPKCQCPL0
      * UPD : Eval Trans Invalid UPL    Update index
      * Renamed input format fields
     I              CQKMNB                          WKKMNB
     I              CQB9DT                          WKB9DT
     I              CQKONB                          WKKONB
     I              CQKNNB                          WKKNNB
     I              CQLMNB                          WKLMNB
     I              CQHOST                          WKHOST
     I              CQKPNB                          WKKPNB
     I              CQKQNB                          WKKQNB
     I              CQBSPC                          WKBSPC
     I              CQBTPC                          WKBTPC
     I              CQX7NB                          WKX7NB
     I              CQFTPC                          WKFTPC
     I              CQFUPC                          WKFUPC
     I              CQHPST                          WKHPST
     I              CQHQST                          WKHQST
     I              CQHSST                          WKHSST
     I              CQIFST                          WKIFST
     I              CQM8CD                          WKM8CD
     I              CQZMST                          WKZMST
     I              CQZNST                          WKZNST
     I              CQZOST                          WKZOST
     I              CQZPST                          WKZPST
     I              CQZQST                          WKZQST
     I              CQZRST                          WKZRST
     I              CQZSST                          WKZSST
     I              CQZTST                          WKZTST
     I              CQZUST                          WKZUST
     I              CQB8DT                          WKB8DT
     I              CQAOTM                          WKAOTM
      *
     IYDRDCS      DS                             59
     IYERDCS      DS                             59
     IYFRDCS      DS                             59
     IYGRDCS      DS                             59
     IYHRDCS      DS                             59
      * Outward parameters
     IPARC        DS                             10
      * KEY : Eval Trans Invalid UPL    Retrieval index
      * I : RST EB Company Number
     I                                    P   1   20PAKMNB
      * I : RST EB Kill Date
     I                                    P   3   60PAB9DT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Eval Trans UPL
      * I : MAP EA Company Number
     I                                    P   1   20P1HKST
      * I : MAP EA Kill Date
     I                                    P   3   60P1B7DT
      * I : MAP EA Shift
     I                                        7   7 P1HLST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Invalid Company Number'
      * CC Company Number
     I                                    P   1   20ZA0001
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HKST    PARM           WP0001  30       EA Company Numb
     C           P1B7DT    PARM           WP0002  70       EA Kill Date
     C           P1HLST    PARM           WP0003  1        EA Shift
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * UPD EvUPL - EvTrans    XF
      * Modification history
     C                     EXSR UASUBR                     Modification hi
      * Rtv Company Values    XF - STR Order Management Sys  * HPERESEARC
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HKST    WQ0001  30       BOH Company Num
     C                     PARM @CN,001   WQ0002 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0003 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    WUA7SS           Status 4
      * If Company processes research hogs. (Currently only Guymon)
      * CASE: WRK.Status 4 is Yes
     C           WUA7SS    IFEQ 'Y'                        *IF
      * 9/8/2014 slm
      * 9/8/2014 review and do not perform the next if this is Triumph Fo
      * 5/25/2021 Access oath PKA2CPLH selection criteria changed
      * Rtv TtoDtl-Int9100 Prc RT - Tattoo Detail  * 
     C                     EXSR SARVGN
      * Mark remaining 9100-9850 tattoos as processed and write Inv Tt rc
      * 9/8/2014 review and do not perform the next if this is Triumph Fo
      * Rtv/Chg Eval Trn IntUnpRT - Eval Trans UPL  * 
     C                     EXSR SORVGN
     C                     END                             *FI
      * Org processing of the Eval Tran Upl
      * UPD EvUPL-EvTrans     RT - Eval Trans UPL  * 
     C                     EXSR SSRVGN
      * Prt Eval Trans Invalid PF - Eval Trans Invalid UPL  * 
     C                     CLEARPARC
     C                     Z-ADDP1HKST    PAKMNB           EB Company Numb
     C                     Z-ADDP1B7DT    PAB9DT           EB Kill Date
      *
     C                     CALL 'PKPAPFR'              90  Prt Eval Trans
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Eval Trans
     C                     PARM WUEVTX    WQ0007 40        Oms System Valu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKPAPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv TtoDtl-Int9100 Prc RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQSA01           BOH Company Num
     C           *LIKE     DEFN WAB0DT    WQSA02           TH Kill Date
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           BOH Company Num
     C                     KFLD           WQSA02           TH Kill Date
      * Setup key
     C                     Z-ADDP1HKST    WQSA01           BOH Company Num
     C                     Z-ADDP1B7DT    WQSA02           TH Kill Date
      * Establish starting position
     C           KRSSA     SETLL@A2CPBA                    *
     C           KRSSA     READE@A2CPBA                  90*
      * Data record not found
     C   90                MOVEL'PRK0063' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WAC0NB    SUB  WAD8NB    WUF6NB           Net Head Usr
      * CASE: WRK.Net Head Usr GT WRK.Zero USR
     C           WUF6NB    IFGT WUE9NB                     *IF
      * Rtv Tatts Int Info    RT - Tattoo Header  * 
     C                     EXSR SBRVGN
      * CASE:
      *  - (c1 OR c2) AND c3
      *   |- c1    : WRK.THP Process Code is Receiving
      *   |- c2    : WRK.THP Process Code is Slaughter
      *   |- c3    : WRK.TH Hog Class Type is Not Resale
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C                     MOVEL'0'       Y0CX02  1
     C           WUCSCD    IFEQ 'RECV'                     *IF
     C           WUCSCD    OREQ 'SLG'                      *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C           WULLST    IFEQ 'M'                        *IF
     C           WULLST    OREQ 'S'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RtvCrt TdEX HotHd/CpST RT - Tattoo Detail Ext  * 
     C                     EXSR SCRVGN
     C                     SUB  WULFNB    WUF6NB           Net Head Usr
      * CASE: WRK.Completed Status is No
     C           WUP3ST    IFEQ 'N'                        *IF
      * Rtv/Chg ET IntPre     RT - Eval Trans UPL  * 
     C                     EXSR SERVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@A2CPBA                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Tatts Int Info    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQSB01           BOH Company Num
     C           *LIKE     DEFN WBBNNB    WQSB02           BOH Buy Order N
     C           *LIKE     DEFN WBBONB    WQSB03           BOL Load Number
     C           *LIKE     DEFN WBCVNB    WQSB04           TH Tattoo Numbe
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           BOH Company Num
     C                     KFLD           WQSB02           BOH Buy Order N
     C                     KFLD           WQSB03           BOL Load Number
     C                     KFLD           WQSB04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWAHMNB    WQSB01           BOH Company Num
     C                     Z-ADDWABNNB    WQSB02           BOH Buy Order N
     C                     Z-ADDWABONB    WQSB03           BOL Load Number
     C                     Z-ADDWACVNB    WQSB04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSB     SETLL@A1CPOI                    *
     C           KRSSB     READE@A1CPOI                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUE2ST           TH Sex
     C                     MOVEL*BLANK    WUKAST           TH Source Type
     C                     MOVEL*BLANK    WULLST           TH Hog Class Ty
     C                     MOVEL*BLANK    WUCSCD           THP Process Cod
     C                     MOVEL*BLANK    WUBECD           HC Class Code
     C                     MOVEL*BLANK    WULMST           Return Code USR
     C                     MOVEL'Y2U0005' WULMST           Return Code USR
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBE2ST    WUE2ST           TH Sex
     C                     MOVELWBKAST    WUKAST           TH Source Type
     C                     MOVELWBLLST    WULLST           TH Hog Class Ty
     C                     MOVELWBCSCD    WUCSCD           THP Process Cod
     C                     MOVELWBBECD    WUBECD           HC Class Code
     C           KRSSB     READE@A1CPOI                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RtvCrt TdEX HotHd/CpST RT - Tattoo Detail Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCC2NB           TD Sequence Num
      * Setup key
     C                     Z-ADDWAHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WCBONB           BOL Load Number
     C                     Z-ADDWACVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WCB0DT           TH Kill Date
     C                     Z-ADDWAC2NB    WCC2NB           TD Sequence Num
      * Establish starting position
     C           KRSSC     CHAIN@DYCPXX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0733' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WUP3ST           Completed Statu
     C                     Z-ADD*ZERO     WULENB           Hot Head
      * Crt Tattoo Detail Ext  CR - Tattoo Detail Ext  * 
     C                     EXSR SDCRRC
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCP3ST    WUP3ST           Completed Statu
     C                     Z-ADDWCLENB    WULENB           Hot Head
     C                     Z-ADDWCLFNB    WULFNB           TDE Head Condem
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCRRC    BEGSR
      *================================================================
      * Crt Tattoo Detail Ext  CR - Tattoo Detail Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DYCPXW
     C                     Z-ADDWAHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WDBONB           BOL Load Number
     C                     Z-ADDWACVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WDB0DT           TH Kill Date
     C                     Z-ADDWAC2NB    WDC2NB           TD Sequence Num
     C                     MOVEL'N'       WDP3ST           Completed Statu
     C                     Z-ADD*ZERO     WDLENB           Hot Head
     C                     Z-ADD*ZERO     WDLFNB           TDE Head Condem
     C                     Z-ADD*ZERO     WDLINB           Head 2
     C                     MOVEL'N'       WDP4ST           Status 1
     C                     MOVEL'N'       WDP5ST           Status 2
     C                     MOVEL*BLANK    WDAAVN           RS User Changed
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##JOB     WDAHVN           RS Job
     C           KLCRSD    KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
     C                     KFLD           WDCVNB           TH Tattoo Numbe
     C                     KFLD           WDB0DT           TH Kill Date
     C                     KFLD           WDC2NB           TD Sequence Num
      * Check for duplicate primary key
     C           KLCRSD    SETLL@DYCPXW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0734' W0RTN   7
      * Send message 'Tattoo Detail Ext      EX'
     C                     MOVEL'PRK0734' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C                     WRITE@DYCPXW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv/Chg ET IntPre     RT - Eval Trans UPL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEHKST    WQSE01           EA Company Numb
     C           *LIKE     DEFN WEB7DT    WQSE02           EA Kill Date
     C           *LIKE     DEFN WEKHNB    WQSE03           EA Tattoo Numbe
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           EA Company Numb
     C                     KFLD           WQSE02           EA Kill Date
     C                     KFLD           WQSE03           EA Tattoo Numbe
      * Setup key
     C                     Z-ADDWAHMNB    WQSE01           EA Company Numb
     C                     Z-ADDWAB0DT    WQSE02           EA Kill Date
     C                     Z-ADDWACVNB    WQSE03           EA Tattoo Numbe
      * Establish starting position
     C           KRSSE     SETLL@CPCPEH                    *
     C           KRSSE     READE@CPCPEH                  90*
      * Data record not found
     C   90                MOVEL'PRK0341' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WULENB           Hot Head
      * CASE: PAR.Hot Head LE PAR.Net Head Usr
     C           WULENB    IFLE WUF6NB                     *IF
      * Valid record
     C                     EXSR UCSUBR                     Valid record
     C                     END                             *FI
      * CASE: PAR.Hot Head EQ PAR.Net Head Usr
     C           WULENB    IFEQ WUF6NB                     *IF
      * Chg/Crt TDtlExt HotHd/ RT - Tattoo Detail Ext  * 
     C                     EXSR SIRVGN
     C                     GOTO SEEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Chg/Crt TDtlExt HotHd/ RT - Tattoo Detail Ext  * 
     C                     EXSR SLRVGN
     C                     END                             *FI
     C           KRSSE     READE@CPCPEH                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Eval Next#        RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFHSNB    WQSF01           ET Company Numb
     C           *LIKE     DEFN WFA9DT    WQSF02           ET Kill Date
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           ET Company Numb
     C                     KFLD           WQSF02           ET Kill Date
      * Setup key
     C                     Z-ADDWEHKST    WQSF01           ET Company Numb
     C                     Z-ADDWEB7DT    WQSF02           ET Kill Date
      * Establish starting position
     C           KRSSF     SETLL@BVCPNE                    *
     C           KRSSF     READE@BVCPNE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0121' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WUKINB           ET Scale Sequen
     C                     GOTO SFEXIT                     *QUIT
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.ET Scale Sequence Number is Entry Allowed
     C           WFFJNB    IFGE 000001                     *IF
     C           WFFJNB    ANDLE699999
     C           WFFJNB    ADD  1         WUKINB           ET Scale Sequen
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSF     READE@BVCPNE                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCRRC    BEGSR
      *================================================================
      * Create Evaluation Transac - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BVCPF0
     C                     Z-ADDWEHKST    WGHSNB           ET Company Numb
     C                     Z-ADDWEB7DT    WGA9DT           ET Kill Date
     C                     Z-ADDWUKINB    WGFJNB           ET Scale Sequen
     C                     Z-ADDWUKINB    WGHCNB           ET Carcass Numb
     C                     Z-ADD000001    WGGDNB           ET Carcass Numb
     C                     Z-ADDWEKHNB    WGFINB           ET Tattoo Numbe
     C                     Z-ADDWELNNB    WGLKNB           ET Lot
     C                     MOVELWEHLST    WGEAST           ET Shift
     C                     Z-ADDWEKJNB    WGAMPC           ET Hot Wgt
     C                     Z-ADDWEKKNB    WGAIPC           ET Backfat Thic
     C                     Z-ADDWEBQPC    WGAJPC           ET Loin-Eye Dep
     C                     Z-ADDWUAKPC    WGAKPC           ET Lean Percent
     C                     Z-ADDWEX6NB    WGX8NB           ET Backfat Thic
     C                     Z-ADDWEFQPC    WGFVPC           ET Loineye Dept
     C                     Z-ADDWEFRPC    WGFWPC           ET Light Reflec
     C                     Z-ADDWUFXPC    WGFXPC           ET Lean Percent
     C                     Z-ADDWEBRPC    WGALPC           ET Light Reflec
     C                     MOVELWEHMST    WGDIST           ET Trim Area
     C                     MOVELWUFYST    WGFYST           ET Carcass Sex
     C                     MOVEL*BLANK    WGD2ST           ET Error Sts
     C                     MOVEL*BLANK    WGEHST           ET Record Add/D
     C                     MOVEL*BLANK    WGG1ST           ET Record Creat
     C                     MOVEL'P'       WGH4ST           ET Record Creat
     C                     MOVEL'N'       WGJLST           ET User Error O
     C                     MOVEL*BLANK    WGUUST           ET Adjust/Add T
     C                     MOVELWEX7ST    WGVHST           ET Broken Back
     C                     MOVELWN0001    WGVIST           ET Unused Sts 2
     C                     MOVELWUVJST    WGVJST           ET Adjust/Add S
     C                     MOVELWN0002    WGVKST           ET Unused Sts 4
     C                     MOVELWN0003    WGVLST           ET Unused Sts 5
     C                     Z-ADDWEHKST    WGHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WGBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WGBONB           BOL Load Number
     C                     Z-ADDWEKHNB    WGCVNB           TH Tattoo Numbe
     C                     Z-ADDWEB7DT    WGB0DT           TH Kill Date
     C                     MOVEL*BLANK    WGAAVN           RS User Changed
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     MOVEL'A'       WGAJST           RS Record Statu
     C                     MOVEL*BLANK    WGAHVN           RS Job
     C                     MOVEL*BLANK    WGAGVN           RS Program
     C                     MOVEL*BLANK    WGABVN           RS User Added
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
     C                     Z-ADDWEB8DT    WGB8DT           RU Date
     C                     Z-ADDWEAOTM    WGAOTM           RU Time
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WGAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WGAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WGAJST           RS Record Statu
     C                     MOVEL##USR     WGABVN           RS User Added
     C                     Z-ADD##JDT     WGABDT           RS Date Added
     C                     Z-ADD##JTM     WGABTM           RS Time Added
     C                     MOVEL##PGM     WGAGVN           RS Program
     C                     MOVEL##JOB     WGAHVN           RS Job
     C           KLCRSG    KLIST
     C                     KFLD           WGHSNB           ET Company Numb
     C                     KFLD           WGA9DT           ET Kill Date
     C                     KFLD           WGFJNB           ET Scale Sequen
     C                     KFLD           WGHCNB           ET Carcass Numb
     C                     KFLD           WGGDNB           ET Carcass Numb
      * Check for duplicate primary key
     C           KLCRSG    SETLL@BVCPF0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0122' W0RTN   7
      * Send message 'Eval Trans             EX'
     C                     MOVEL'PRK0122' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C                     WRITE@BVCPF0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCHRC    BEGSR
      *================================================================
      * Chg Eval Trans UPL    CH - Eval Trans UPL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @CPCPMW
     C                     Z-ADDWEHKST    WHHKST           EA Company Numb
     C                     Z-ADDWEB7DT    WHB7DT           EA Kill Date
     C                     Z-ADDWEKINB    WHKINB           EA Scale Sequen
      *
     C           KLCHSH    KLIST
     C                     KFLD           WHHKST           EA Company Numb
     C                     KFLD           WHB7DT           EA Kill Date
     C                     KFLD           WHKINB           EA Scale Sequen
     C           KLCHSH    CHAIN@CPCPMW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCPCPL0'MDACP
     C                     MOVEL'@CPCPMW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCP1    YARDCS
      * Move non-key fields to @CPCPMW
     C                     Z-ADDWEKHNB    WHKHNB           EA Tattoo Numbe
     C                     Z-ADDWELNNB    WHLNNB           EA Lot
     C                     MOVELWEHLST    WHHLST    P      EA Shift
     C                     Z-ADDWEKJNB    WHKJNB           EA Hot Weight
     C                     Z-ADDWEKKNB    WHKKNB           EA Backfat Thic
     C                     Z-ADDWEBQPC    WHBQPC           EA Loin-Eye Dep
     C                     Z-ADDWEBRPC    WHBRPC           EA Light Reflec
     C                     MOVELWEHMST    WHHMST    P      EA Trim Area
     C                     MOVELWEHNST    WHHNST    P      EA Carcass Sex
     C                     MOVELWEHTST    WHHTST    P      EA Record Creat
     C                     MOVEL'Y'       WHHUST    P      EA Record Proce
     C                     Z-ADDWEX6NB    WHX6NB           EA Backfat MM
     C                     Z-ADDWEFQPC    WHFQPC           EA LoinEye MM
     C                     Z-ADDWEFRPC    WHFRPC           EA Light Refl M
     C                     MOVELWEM7CD    WHM7CD    P      EA Trolley Id
     C                     MOVELWEX7ST    WHX7ST    P      EA Broken Back
     C                     MOVELWEX8ST    WHX8ST    P      EA Unused Sts 1
     C                     MOVELWEX9ST    WHX9ST    P      EA Unused Sts 2
     C                     MOVELWEYAST    WHYAST    P      EA Unused Sts 3
     C                     MOVELWEYBST    WHYBST    P      EA Unused Sts 4
     C                     MOVELWEYCST    WHYCST    P      EA Unused Sts 5
     C                     MOVELWEZJST    WHZJST    P      EA Unused Sts 6
     C                     MOVELWEZKST    WHZKST    P      EA Unused Sts 7
     C                     MOVELWEZLST    WHZLST    P      EA Unused Sts 8
     C                     Z-ADDWEB8DT    WHB8DT           RU Date
     C                     Z-ADDWEAOTM    WHAOTM           RU Time
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCP1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@CPCPMW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCPCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Chg/Crt TDtlExt HotHd/ RT - Tattoo Detail Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCC2NB           TD Sequence Num
      * Setup key
     C                     Z-ADDWAHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WCBONB           BOL Load Number
     C                     Z-ADDWACVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WCB0DT           TH Kill Date
     C                     Z-ADDWAC2NB    WCC2NB           TD Sequence Num
      * Establish starting position
     C           KRSSI     CHAIN@DYCPXX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0733' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Tattoo Detail Ext  CR - Tattoo Detail Ext  * 
     C                     EXSR SJCRRC
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Tattoo Detail Ext  CH - Tattoo Detail Ext  * 
     C                     EXSR SKCHRC
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCRRC    BEGSR
      *================================================================
      * Crt Tattoo Detail Ext  CR - Tattoo Detail Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DYCPXW
     C                     Z-ADDWAHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WDBONB           BOL Load Number
     C                     Z-ADDWACVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WDB0DT           TH Kill Date
     C                     Z-ADDWAC2NB    WDC2NB           TD Sequence Num
     C                     MOVEL'Y'       WDP3ST           Completed Statu
     C                     Z-ADDWULENB    WDLENB           Hot Head
     C                     Z-ADD*ZERO     WDLFNB           TDE Head Condem
     C                     Z-ADD*ZERO     WDLINB           Head 2
     C                     MOVEL'N'       WDP4ST           Status 1
     C                     MOVEL'N'       WDP5ST           Status 2
     C                     MOVEL*BLANK    WDAAVN           RS User Changed
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##JOB     WDAHVN           RS Job
     C           KLCRSJ    KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
     C                     KFLD           WDCVNB           TH Tattoo Numbe
     C                     KFLD           WDB0DT           TH Kill Date
     C                     KFLD           WDC2NB           TD Sequence Num
      * Check for duplicate primary key
     C           KLCRSJ    SETLL@DYCPXW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0734' W0RTN   7
      * Send message 'Tattoo Detail Ext      EX'
     C                     MOVEL'PRK0734' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C                     WRITE@DYCPXW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCHRC    BEGSR
      *================================================================
      * Chg Tattoo Detail Ext  CH - Tattoo Detail Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @DYCPXW
     C                     Z-ADDWAHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WDBONB           BOL Load Number
     C                     Z-ADDWACVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WDB0DT           TH Kill Date
     C                     Z-ADDWAC2NB    WDC2NB           TD Sequence Num
      *
     C           KLCHSK    KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
     C                     KFLD           WDCVNB           TH Tattoo Numbe
     C                     KFLD           WDB0DT           TH Kill Date
     C                     KFLD           WDC2NB           TD Sequence Num
     C           KLCHSK    CHAIN@DYCPXW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDYCPL0'MDACP
     C                     MOVEL'@DYCPXW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDY1    YBRDCS
      * USER: Processing after Data read
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Move non-key fields to @DYCPXW
     C                     MOVEL'Y'       WDP3ST    P      Completed Statu
     C                     Z-ADDWULENB    WDLENB           Hot Head
     C                     Z-ADDWCLFNB    WDLFNB           TDE Head Condem
     C                     Z-ADDWCLINB    WDLINB           Head 2
     C                     MOVELWCP4ST    WDP4ST    P      Status 1
     C                     MOVELWCP5ST    WDP5ST    P      Status 2
     C                     MOVELWCAAVN    WDAAVN    P      RS User Changed
     C                     Z-ADDWCAADT    WDAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WDAMTM           RS Time Changed
     C                     MOVELWCAJST    WDAJST    P      RS Record Statu
     C                     MOVELWCAHVN    WDAHVN    P      RS Job
     C                     MOVELWCAGVN    WDAGVN    P      RS Program
     C                     MOVELWCABVN    WDABVN    P      RS User Added
     C                     Z-ADDWCABDT    WDABDT           RS Date Added
     C                     Z-ADDWCABTM    WDABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDY1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@DYCPXW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDYCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Chg/Crt TDtlExt HotHd/ RT - Tattoo Detail Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCC2NB           TD Sequence Num
      * Setup key
     C                     Z-ADDWAHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WCBONB           BOL Load Number
     C                     Z-ADDWACVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WCB0DT           TH Kill Date
     C                     Z-ADDWAC2NB    WCC2NB           TD Sequence Num
      * Establish starting position
     C           KRSSL     CHAIN@DYCPXX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0733' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Tattoo Detail Ext  CR - Tattoo Detail Ext  * 
     C                     EXSR SMCRRC
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Tattoo Detail Ext  CH - Tattoo Detail Ext  * 
     C                     EXSR SNCHRC
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCRRC    BEGSR
      *================================================================
      * Crt Tattoo Detail Ext  CR - Tattoo Detail Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DYCPXW
     C                     Z-ADDWAHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WDBONB           BOL Load Number
     C                     Z-ADDWACVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WDB0DT           TH Kill Date
     C                     Z-ADDWAC2NB    WDC2NB           TD Sequence Num
     C                     MOVEL'N'       WDP3ST           Completed Statu
     C                     Z-ADDWULENB    WDLENB           Hot Head
     C                     Z-ADD*ZERO     WDLFNB           TDE Head Condem
     C                     Z-ADD*ZERO     WDLINB           Head 2
     C                     MOVEL'N'       WDP4ST           Status 1
     C                     MOVEL'N'       WDP5ST           Status 2
     C                     MOVEL*BLANK    WDAAVN           RS User Changed
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##JOB     WDAHVN           RS Job
     C           KLCRSM    KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
     C                     KFLD           WDCVNB           TH Tattoo Numbe
     C                     KFLD           WDB0DT           TH Kill Date
     C                     KFLD           WDC2NB           TD Sequence Num
      * Check for duplicate primary key
     C           KLCRSM    SETLL@DYCPXW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0734' W0RTN   7
      * Send message 'Tattoo Detail Ext      EX'
     C                     MOVEL'PRK0734' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C                     WRITE@DYCPXW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCHRC    BEGSR
      *================================================================
      * Chg Tattoo Detail Ext  CH - Tattoo Detail Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @DYCPXW
     C                     Z-ADDWAHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WDBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WDBONB           BOL Load Number
     C                     Z-ADDWACVNB    WDCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WDB0DT           TH Kill Date
     C                     Z-ADDWAC2NB    WDC2NB           TD Sequence Num
      *
     C           KLCHSN    KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
     C                     KFLD           WDBONB           BOL Load Number
     C                     KFLD           WDCVNB           TH Tattoo Numbe
     C                     KFLD           WDB0DT           TH Kill Date
     C                     KFLD           WDC2NB           TD Sequence Num
     C           KLCHSN    CHAIN@DYCPXW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDYCPL0'MDACP
     C                     MOVEL'@DYCPXW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKDY1    YCRDCS
      * USER: Processing after Data read
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WDAAVN           RS User Changed
     C                     Z-ADD##JDT     WDAADT           RS Date Changed
     C                     Z-ADD##JTM     WDAMTM           RS Time Changed
     C                     MOVEL##JOB     WDAHVN           RS Job
     C                     MOVEL##PGM     WDAGVN           RS Program
      * Move non-key fields to @DYCPXW
     C                     MOVEL'N'       WDP3ST    P      Completed Statu
     C                     Z-ADDWULENB    WDLENB           Hot Head
     C                     Z-ADDWCLFNB    WDLFNB           TDE Head Condem
     C                     Z-ADDWCLINB    WDLINB           Head 2
     C                     MOVELWCP4ST    WDP4ST    P      Status 1
     C                     MOVELWCP5ST    WDP5ST    P      Status 2
     C                     MOVELWCAAVN    WDAAVN    P      RS User Changed
     C                     Z-ADDWCAADT    WDAADT           RS Date Changed
     C                     Z-ADDWCAMTM    WDAMTM           RS Time Changed
     C                     MOVELWCAJST    WDAJST    P      RS Record Statu
     C                     MOVELWCAHVN    WDAHVN    P      RS Job
     C                     MOVELWCAGVN    WDAGVN    P      RS Program
     C                     MOVELWCABVN    WDABVN    P      RS User Added
     C                     Z-ADDWCABDT    WDABDT           RS Date Added
     C                     Z-ADDWCABTM    WDABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKDY1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@DYCPXW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKDYCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv/Chg Eval Trn IntUnpRT - Eval Trans UPL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIHKST    WQSO01           EA Company Numb
     C           *LIKE     DEFN WIB7DT    WQSO02           EA Kill Date
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           EA Company Numb
     C                     KFLD           WQSO02           EA Kill Date
      * Setup key
     C                     Z-ADDP1HKST    WQSO01           EA Company Numb
     C                     Z-ADDP1B7DT    WQSO02           EA Kill Date
      * Establish starting position
     C           KRSSO     SETLL@CPCPBB                    *
     C           KRSSO     READE@CPCPBB                  90*
      * Data record not found
     C   90                MOVEL'PRK0341' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Mark any remaining 9100-9850 tattoos as processed, and write Inv
      * Invalid tattoo number
      *
     C                     Z-ADD*ZERO     WN0005  74       Loss Percent
      *
      * CRT Evl Trns Inv    IF
      * Rtv Evl Trns Inv Next RT - Eval Trans Invalid UPL  * 
     C                     EXSR SPRVGN
      * Create Eval Trans Invalid - Eval Trans Invalid UPL  * 
     C                     EXSR SQCRRC
      * Chg Eval Trans UPL    CH - Eval Trans UPL  * 
     C                     EXSR SRCHRC
     C           KRSSO     READE@CPCPBB                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Evl Trns Inv Next RT - Eval Trans Invalid UPL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJKMNB    WQSP01           EB Company Numb
     C           *LIKE     DEFN WJB9DT    WQSP02           EB Kill Date
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           EB Company Numb
     C                     KFLD           WQSP02           EB Kill Date
      * Setup key
     C                     Z-ADDWIHKST    WQSP01           EB Company Numb
     C                     Z-ADDWIB7DT    WQSP02           EB Kill Date
      * Establish starting position
     C           KRSSP     SETLL@CQCPNS                    *
     C           KRSSP     READE@CQCPNS                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0345' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD000001    WUKONB           EB Scale Sequen
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.EB Scale Sequence Number is Entry Allowed
     C           WJKONB    IFGE 000001                     *IF
     C           WJKONB    ANDLE699999
     C           WJKONB    ADD  1         WUKONB           EB Scale Sequen
     C                     GOTO SPEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSP     READE@CQCPNS                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCRRC    BEGSR
      *================================================================
      * Create Eval Trans Invalid - Eval Trans Invalid UPL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CQCPMZ
     C                     Z-ADDWIHKST    WKKMNB           EB Company Numb
     C                     Z-ADDWIB7DT    WKB9DT           EB Kill Date
     C                     Z-ADDWUKONB    WKKONB           EB Scale Sequen
     C                     Z-ADDWIKHNB    WKKNNB           EB Tattoo Numbe
     C                     Z-ADDWILNNB    WKLMNB           EB Lot
     C                     MOVELWIHLST    WKHOST           EB Shift
     C                     Z-ADDWIKJNB    WKKPNB           EB Hot Weight
     C                     Z-ADDWIKKNB    WKKQNB           EB Backfat Thic
     C                     Z-ADDWIBQPC    WKBSPC           EB Loin-Eye Dep
     C                     Z-ADDWIBRPC    WKBTPC           EB Light Reflec
     C                     Z-ADDWIX6NB    WKX7NB           EB Backfat Thic
     C                     Z-ADDWIFQPC    WKFTPC           EB Loineye Dept
     C                     Z-ADDWIFRPC    WKFUPC           EB Light Reflec
     C                     MOVELWIHMST    WKHPST           EB Trim Area
     C                     MOVELWIHNST    WKHQST           EB Carcass Sex
     C                     MOVELWIHTST    WKHSST           EB Record Creat
     C                     MOVEL'T'       WKIFST           EB Error Type
     C                     MOVELWIM7CD    WKM8CD           EB Trolley Id
     C                     MOVELWIX7ST    WKZMST           EB Broken Back
     C                     MOVELWIX8ST    WKZNST           EB Unused Sts 1
     C                     MOVELWIX9ST    WKZOST           EB Unused Sts 2
     C                     MOVELWIYAST    WKZPST           EB Unused Sts 3
     C                     MOVELWIYBST    WKZQST           EB Unused Sts 4
     C                     MOVELWIYCST    WKZRST           EB Unused Sts 5
     C                     MOVELWIZJST    WKZSST           EB Unused Sts 6
     C                     MOVELWIZKST    WKZTST           EB Unused Sts 7
     C                     MOVELWIZLST    WKZUST           EB Unused Sts 8
     C                     Z-ADDWIB8DT    WKB8DT           RU Date
     C                     Z-ADDWIAOTM    WKAOTM           RU Time
      *
     C           KLCRSQ    KLIST
     C                     KFLD           WKKMNB           EB Company Numb
     C                     KFLD           WKB9DT           EB Kill Date
     C                     KFLD           WKKONB           EB Scale Sequen
      * Check for duplicate primary key
     C           KLCRSQ    SETLL@CQCPMZ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0346' W0RTN   7
      * Send message 'Eval Trans Invalid UPL EX'
     C                     MOVEL'PRK0346' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C                     WRITE@CQCPMZ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCHRC    BEGSR
      *================================================================
      * Chg Eval Trans UPL    CH - Eval Trans UPL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @CPCPMW
     C                     Z-ADDWIHKST    WHHKST           EA Company Numb
     C                     Z-ADDWIB7DT    WHB7DT           EA Kill Date
     C                     Z-ADDWIKINB    WHKINB           EA Scale Sequen
      *
     C           KLCHSR    KLIST
     C                     KFLD           WHHKST           EA Company Numb
     C                     KFLD           WHB7DT           EA Kill Date
     C                     KFLD           WHKINB           EA Scale Sequen
     C           KLCHSR    CHAIN@CPCPMW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCPCPL0'MDACP
     C                     MOVEL'@CPCPMW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCP1    YDRDCS
      * Move non-key fields to @CPCPMW
     C                     Z-ADDWIKHNB    WHKHNB           EA Tattoo Numbe
     C                     Z-ADDWILNNB    WHLNNB           EA Lot
     C                     MOVELWIHLST    WHHLST    P      EA Shift
     C                     Z-ADDWIKJNB    WHKJNB           EA Hot Weight
     C                     Z-ADDWIKKNB    WHKKNB           EA Backfat Thic
     C                     Z-ADDWIBQPC    WHBQPC           EA Loin-Eye Dep
     C                     Z-ADDWIBRPC    WHBRPC           EA Light Reflec
     C                     MOVELWIHMST    WHHMST    P      EA Trim Area
     C                     MOVELWIHNST    WHHNST    P      EA Carcass Sex
     C                     MOVELWIHTST    WHHTST    P      EA Record Creat
     C                     MOVEL'Y'       WHHUST    P      EA Record Proce
     C                     Z-ADDWIX6NB    WHX6NB           EA Backfat MM
     C                     Z-ADDWIFQPC    WHFQPC           EA LoinEye MM
     C                     Z-ADDWIFRPC    WHFRPC           EA Light Refl M
     C                     MOVELWIM7CD    WHM7CD    P      EA Trolley Id
     C                     MOVELWIX7ST    WHX7ST    P      EA Broken Back
     C                     MOVELWIX8ST    WHX8ST    P      EA Unused Sts 1
     C                     MOVELWIX9ST    WHX9ST    P      EA Unused Sts 2
     C                     MOVELWIYAST    WHYAST    P      EA Unused Sts 3
     C                     MOVELWIYBST    WHYBST    P      EA Unused Sts 4
     C                     MOVELWIYCST    WHYCST    P      EA Unused Sts 5
     C                     MOVELWIZJST    WHZJST    P      EA Unused Sts 6
     C                     MOVELWIZKST    WHZKST    P      EA Unused Sts 7
     C                     MOVELWIZLST    WHZLST    P      EA Unused Sts 8
     C                     Z-ADDWIB8DT    WHB8DT           RU Date
     C                     Z-ADDWIAOTM    WHAOTM           RU Time
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCP1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@CPCPMW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCPCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * UPD EvUPL-EvTrans     RT - Eval Trans UPL  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0006  74       Loss Percent
     C                     Z-ADD*ZERO     WN0007  71       LTA Wgt
     C                     Z-ADD*ZERO     WN0008  74       Loss Percent
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLHKST    WQSS01           EA Company Numb
     C           *LIKE     DEFN WLB7DT    WQSS02           EA Kill Date
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           EA Company Numb
     C                     KFLD           WQSS02           EA Kill Date
      * Setup key
     C                     Z-ADDP1HKST    WQSS01           EA Company Numb
     C                     Z-ADDP1B7DT    WQSS02           EA Kill Date
      * Establish starting position
     C           KRSSS     SETLL@CPCPNC                    *
     C           KRSSS     READE@CPCPNC                  90*
      * Data record not found
     C   90                MOVEL'PRK0341' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.First Time Flag Usr is Yes
     C           WUHBST    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Val Company Number    IF
      * Val Company Number    XF - STR Order Management Sys  * 
     C                     CALL 'PDGZXFR'              90  Val Company Num
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WLHKST    WQ0004  30       CC Company Numb
     C           WUEUTX    PARM *BLANK    WQ0005 30        Oms Name
     C           WUG3ST    PARM *BLANK    WQ0006  1        Invalid Y/N USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGZXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Invalid Y/N USR is Yes
     C           WUG3ST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADDWLHKST    ZA0001           CC Company Numb
      * Send message 'Invalid Company Number'
     C                     MOVEL'PRK0299' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     MOVELWUG3ST    WUG3ST           Invalid Y/N USR
     C                     MOVEL'Y'       WUHBST           First Time Flag
     C                     END                             *FI
     C                     MOVEL*BLANK    WULMST           Return Code USR
      * Rtv Tatts/Bo Load     RT - Tattoo Header  * 
     C                     EXSR STRVGN
      * CASE: WRK.Return Code USR is *Record does not exist
     C           WULMST    IFEQ @CN,002                    *IF
      * Invalid tattoo number
      *
     C                     Z-ADD*ZERO     WN0009  74       Loss Percent
      *
      * CRT Evl Trns Inv    IF
      * Rtv Evl Trns Inv Next RT - Eval Trans Invalid UPL  * 
     C                     EXSR SURVGN
      * Create Eval Trans Invalid - Eval Trans Invalid UPL  * 
     C                     EXSR SVCRRC
      * Chg Eval Trans UPL    CH - Eval Trans UPL  * 
     C                     EXSR SWCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.TH Hog Class Type is Resale
     C           WULLST    IFEQ 'R'                        *IF
      *
     C                     Z-ADD*ZERO     WN0010  74       Loss Percent
      *
      * CRT Evl Trns Inv    IF
      * Rtv Evl Trns Inv Next RT - Eval Trans Invalid UPL  * 
     C                     EXSR SXRVGN
      * Create Eval Trans Invalid - Eval Trans Invalid UPL  * 
     C                     EXSR SYCRRC
      * Chg Eval Trans UPL    CH - Eval Trans UPL  * 
     C                     EXSR SZCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : WRK.THP Process Code is Receiving
      *   |- c2    : WRK.THP Process Code is Slaughter
      *   '-
     C           WUCSCD    IFEQ 'RECV'                     *IF
     C           WUCSCD    OREQ 'SLG'                      *OR
      * Valid record
      * Valid record
     C                     EXSR UDSUBR                     Valid record
     C                     ELSE
      * CASE: *OTHERWISE
      * Invalid:  Do not want to receive records either to early or
      *           to late
      * Tattoo Process is either in scaleing, or payment
      *
     C                     Z-ADD*ZERO     WN0015  74       Loss Percent
      *
      * CRT Evl Trns Inv    IF
      * Rtv Evl Trns Inv Next RT - Eval Trans Invalid UPL  * 
     C                     EXSR TDRVGN
      * Create Eval Trans Invalid - Eval Trans Invalid UPL  * 
     C                     EXSR TECRRC
      * Chg Eval Trans UPL    CH - Eval Trans UPL  * 
     C                     EXSR TFCHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSS     READE@CPCPNC                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv Tatts/Bo Load     RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMHMNB    WQST01           BOH Company Num
     C           *LIKE     DEFN WMB0DT    WQST02           TH Kill Date
     C           *LIKE     DEFN WMCVNB    WQST03           TH Tattoo Numbe
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           BOH Company Num
     C                     KFLD           WQST02           TH Kill Date
     C                     KFLD           WQST03           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWLHKST    WQST01           BOH Company Num
     C                     Z-ADDWLB7DT    WQST02           TH Kill Date
     C                     Z-ADDWLKHNB    WQST03           TH Tattoo Numbe
      * Establish starting position
     C           KRSST     SETLL@A1CPND                    *
     C           KRSST     READE@A1CPND                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WUBONB           BOL Load Number
     C                     MOVEL*BLANK    WUE2ST           TH Sex
     C                     MOVEL*BLANK    WUKAST           TH Source Type
     C                     MOVEL*BLANK    WULLST           TH Hog Class Ty
     C                     MOVEL*BLANK    WUCSCD           THP Process Cod
     C                     MOVEL*BLANK    WUBECD           HC Class Code
     C                     MOVEL*BLANK    WULMST           Return Code USR
     C                     MOVEL'Y2U0005' WULMST           Return Code USR
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWMBNNB    WUBNNB           BOH Buy Order N
     C                     Z-ADDWMBONB    WUBONB           BOL Load Number
     C                     MOVELWME2ST    WUE2ST           TH Sex
     C                     MOVELWMKAST    WUKAST           TH Source Type
     C                     MOVELWMLLST    WULLST           TH Hog Class Ty
     C                     MOVELWMCSCD    WUCSCD           THP Process Cod
     C                     MOVELWMBECD    WUBECD           HC Class Code
     C                     GOTO STEXIT                     *QUIT
     C           KRSST     READE@A1CPND                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Evl Trns Inv Next RT - Eval Trans Invalid UPL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJKMNB    WQSU01           EB Company Numb
     C           *LIKE     DEFN WJB9DT    WQSU02           EB Kill Date
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           EB Company Numb
     C                     KFLD           WQSU02           EB Kill Date
      * Setup key
     C                     Z-ADDWLHKST    WQSU01           EB Company Numb
     C                     Z-ADDWLB7DT    WQSU02           EB Kill Date
      * Establish starting position
     C           KRSSU     SETLL@CQCPNS                    *
     C           KRSSU     READE@CQCPNS                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0345' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD000001    WUKONB           EB Scale Sequen
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.EB Scale Sequence Number is Entry Allowed
     C           WJKONB    IFGE 000001                     *IF
     C           WJKONB    ANDLE699999
     C           WJKONB    ADD  1         WUKONB           EB Scale Sequen
     C                     GOTO SUEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSU     READE@CQCPNS                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCRRC    BEGSR
      *================================================================
      * Create Eval Trans Invalid - Eval Trans Invalid UPL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CQCPMZ
     C                     Z-ADDWLHKST    WKKMNB           EB Company Numb
     C                     Z-ADDWLB7DT    WKB9DT           EB Kill Date
     C                     Z-ADDWUKONB    WKKONB           EB Scale Sequen
     C                     Z-ADDWLKHNB    WKKNNB           EB Tattoo Numbe
     C                     Z-ADDWLLNNB    WKLMNB           EB Lot
     C                     MOVELWLHLST    WKHOST           EB Shift
     C                     Z-ADDWLKJNB    WKKPNB           EB Hot Weight
     C                     Z-ADDWLKKNB    WKKQNB           EB Backfat Thic
     C                     Z-ADDWLBQPC    WKBSPC           EB Loin-Eye Dep
     C                     Z-ADDWLBRPC    WKBTPC           EB Light Reflec
     C                     Z-ADDWLX6NB    WKX7NB           EB Backfat Thic
     C                     Z-ADDWLFQPC    WKFTPC           EB Loineye Dept
     C                     Z-ADDWLFRPC    WKFUPC           EB Light Reflec
     C                     MOVELWLHMST    WKHPST           EB Trim Area
     C                     MOVELWLHNST    WKHQST           EB Carcass Sex
     C                     MOVELWLHTST    WKHSST           EB Record Creat
     C                     MOVEL'T'       WKIFST           EB Error Type
     C                     MOVELWLM7CD    WKM8CD           EB Trolley Id
     C                     MOVELWLX7ST    WKZMST           EB Broken Back
     C                     MOVELWLX8ST    WKZNST           EB Unused Sts 1
     C                     MOVELWLX9ST    WKZOST           EB Unused Sts 2
     C                     MOVELWLYAST    WKZPST           EB Unused Sts 3
     C                     MOVELWLYBST    WKZQST           EB Unused Sts 4
     C                     MOVELWLYCST    WKZRST           EB Unused Sts 5
     C                     MOVELWLZJST    WKZSST           EB Unused Sts 6
     C                     MOVELWLZKST    WKZTST           EB Unused Sts 7
     C                     MOVELWLZLST    WKZUST           EB Unused Sts 8
     C                     Z-ADDWLB8DT    WKB8DT           RU Date
     C                     Z-ADDWLAOTM    WKAOTM           RU Time
      *
     C           KLCRSV    KLIST
     C                     KFLD           WKKMNB           EB Company Numb
     C                     KFLD           WKB9DT           EB Kill Date
     C                     KFLD           WKKONB           EB Scale Sequen
      * Check for duplicate primary key
     C           KLCRSV    SETLL@CQCPMZ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0346' W0RTN   7
      * Send message 'Eval Trans Invalid UPL EX'
     C                     MOVEL'PRK0346' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C                     WRITE@CQCPMZ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWCHRC    BEGSR
      *================================================================
      * Chg Eval Trans UPL    CH - Eval Trans UPL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @CPCPMW
     C                     Z-ADDWLHKST    WHHKST           EA Company Numb
     C                     Z-ADDWLB7DT    WHB7DT           EA Kill Date
     C                     Z-ADDWLKINB    WHKINB           EA Scale Sequen
      *
     C           KLCHSW    KLIST
     C                     KFLD           WHHKST           EA Company Numb
     C                     KFLD           WHB7DT           EA Kill Date
     C                     KFLD           WHKINB           EA Scale Sequen
     C           KLCHSW    CHAIN@CPCPMW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCPCPL0'MDACP
     C                     MOVEL'@CPCPMW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCP1    YERDCS
      * Move non-key fields to @CPCPMW
     C                     Z-ADDWLKHNB    WHKHNB           EA Tattoo Numbe
     C                     Z-ADDWLLNNB    WHLNNB           EA Lot
     C                     MOVELWLHLST    WHHLST    P      EA Shift
     C                     Z-ADDWLKJNB    WHKJNB           EA Hot Weight
     C                     Z-ADDWLKKNB    WHKKNB           EA Backfat Thic
     C                     Z-ADDWLBQPC    WHBQPC           EA Loin-Eye Dep
     C                     Z-ADDWLBRPC    WHBRPC           EA Light Reflec
     C                     MOVELWLHMST    WHHMST    P      EA Trim Area
     C                     MOVELWLHNST    WHHNST    P      EA Carcass Sex
     C                     MOVELWLHTST    WHHTST    P      EA Record Creat
     C                     MOVEL'Y'       WHHUST    P      EA Record Proce
     C                     Z-ADDWLX6NB    WHX6NB           EA Backfat MM
     C                     Z-ADDWLFQPC    WHFQPC           EA LoinEye MM
     C                     Z-ADDWLFRPC    WHFRPC           EA Light Refl M
     C                     MOVELWLM7CD    WHM7CD    P      EA Trolley Id
     C                     MOVELWLX7ST    WHX7ST    P      EA Broken Back
     C                     MOVELWLX8ST    WHX8ST    P      EA Unused Sts 1
     C                     MOVELWLX9ST    WHX9ST    P      EA Unused Sts 2
     C                     MOVELWLYAST    WHYAST    P      EA Unused Sts 3
     C                     MOVELWLYBST    WHYBST    P      EA Unused Sts 4
     C                     MOVELWLYCST    WHYCST    P      EA Unused Sts 5
     C                     MOVELWLZJST    WHZJST    P      EA Unused Sts 6
     C                     MOVELWLZKST    WHZKST    P      EA Unused Sts 7
     C                     MOVELWLZLST    WHZLST    P      EA Unused Sts 8
     C                     Z-ADDWLB8DT    WHB8DT           RU Date
     C                     Z-ADDWLAOTM    WHAOTM           RU Time
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCP1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@CPCPMW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCPCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Rtv Evl Trns Inv Next RT - Eval Trans Invalid UPL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJKMNB    WQSX01           EB Company Numb
     C           *LIKE     DEFN WJB9DT    WQSX02           EB Kill Date
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           EB Company Numb
     C                     KFLD           WQSX02           EB Kill Date
      * Setup key
     C                     Z-ADDWLHKST    WQSX01           EB Company Numb
     C                     Z-ADDWLB7DT    WQSX02           EB Kill Date
      * Establish starting position
     C           KRSSX     SETLL@CQCPNS                    *
     C           KRSSX     READE@CQCPNS                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0345' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD000001    WUKONB           EB Scale Sequen
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.EB Scale Sequence Number is Entry Allowed
     C           WJKONB    IFGE 000001                     *IF
     C           WJKONB    ANDLE699999
     C           WJKONB    ADD  1         WUKONB           EB Scale Sequen
     C                     GOTO SXEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSX     READE@CQCPNS                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCRRC    BEGSR
      *================================================================
      * Create Eval Trans Invalid - Eval Trans Invalid UPL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CQCPMZ
     C                     Z-ADDWLHKST    WKKMNB           EB Company Numb
     C                     Z-ADDWLB7DT    WKB9DT           EB Kill Date
     C                     Z-ADDWUKONB    WKKONB           EB Scale Sequen
     C                     Z-ADDWLKHNB    WKKNNB           EB Tattoo Numbe
     C                     Z-ADDWLLNNB    WKLMNB           EB Lot
     C                     MOVELWLHLST    WKHOST           EB Shift
     C                     Z-ADDWLKJNB    WKKPNB           EB Hot Weight
     C                     Z-ADDWLKKNB    WKKQNB           EB Backfat Thic
     C                     Z-ADDWLBQPC    WKBSPC           EB Loin-Eye Dep
     C                     Z-ADDWLBRPC    WKBTPC           EB Light Reflec
     C                     Z-ADDWLX6NB    WKX7NB           EB Backfat Thic
     C                     Z-ADDWLFQPC    WKFTPC           EB Loineye Dept
     C                     Z-ADDWLFRPC    WKFUPC           EB Light Reflec
     C                     MOVELWLHMST    WKHPST           EB Trim Area
     C                     MOVELWLHNST    WKHQST           EB Carcass Sex
     C                     MOVELWLHTST    WKHSST           EB Record Creat
     C                     MOVEL'R'       WKIFST           EB Error Type
     C                     MOVELWLM7CD    WKM8CD           EB Trolley Id
     C                     MOVELWLX7ST    WKZMST           EB Broken Back
     C                     MOVELWLX8ST    WKZNST           EB Unused Sts 1
     C                     MOVELWLX9ST    WKZOST           EB Unused Sts 2
     C                     MOVELWLYAST    WKZPST           EB Unused Sts 3
     C                     MOVELWLYBST    WKZQST           EB Unused Sts 4
     C                     MOVELWLYCST    WKZRST           EB Unused Sts 5
     C                     MOVELWLZJST    WKZSST           EB Unused Sts 6
     C                     MOVELWLZKST    WKZTST           EB Unused Sts 7
     C                     MOVELWLZLST    WKZUST           EB Unused Sts 8
     C                     Z-ADDWLB8DT    WKB8DT           RU Date
     C                     Z-ADDWLAOTM    WKAOTM           RU Time
      *
     C           KLCRSY    KLIST
     C                     KFLD           WKKMNB           EB Company Numb
     C                     KFLD           WKB9DT           EB Kill Date
     C                     KFLD           WKKONB           EB Scale Sequen
      * Check for duplicate primary key
     C           KLCRSY    SETLL@CQCPMZ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0346' W0RTN   7
      * Send message 'Eval Trans Invalid UPL EX'
     C                     MOVEL'PRK0346' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C                     WRITE@CQCPMZ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZCHRC    BEGSR
      *================================================================
      * Chg Eval Trans UPL    CH - Eval Trans UPL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @CPCPMW
     C                     Z-ADDWLHKST    WHHKST           EA Company Numb
     C                     Z-ADDWLB7DT    WHB7DT           EA Kill Date
     C                     Z-ADDWLKINB    WHKINB           EA Scale Sequen
      *
     C           KLCHSZ    KLIST
     C                     KFLD           WHHKST           EA Company Numb
     C                     KFLD           WHB7DT           EA Kill Date
     C                     KFLD           WHKINB           EA Scale Sequen
     C           KLCHSZ    CHAIN@CPCPMW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCPCPL0'MDACP
     C                     MOVEL'@CPCPMW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCP1    YFRDCS
      * Move non-key fields to @CPCPMW
     C                     Z-ADDWLKHNB    WHKHNB           EA Tattoo Numbe
     C                     Z-ADDWLLNNB    WHLNNB           EA Lot
     C                     MOVELWLHLST    WHHLST    P      EA Shift
     C                     Z-ADDWLKJNB    WHKJNB           EA Hot Weight
     C                     Z-ADDWLKKNB    WHKKNB           EA Backfat Thic
     C                     Z-ADDWLBQPC    WHBQPC           EA Loin-Eye Dep
     C                     Z-ADDWLBRPC    WHBRPC           EA Light Reflec
     C                     MOVELWLHMST    WHHMST    P      EA Trim Area
     C                     MOVELWLHNST    WHHNST    P      EA Carcass Sex
     C                     MOVELWLHTST    WHHTST    P      EA Record Creat
     C                     MOVEL'Y'       WHHUST    P      EA Record Proce
     C                     Z-ADDWLX6NB    WHX6NB           EA Backfat MM
     C                     Z-ADDWLFQPC    WHFQPC           EA LoinEye MM
     C                     Z-ADDWLFRPC    WHFRPC           EA Light Refl M
     C                     MOVELWLM7CD    WHM7CD    P      EA Trolley Id
     C                     MOVELWLX7ST    WHX7ST    P      EA Broken Back
     C                     MOVELWLX8ST    WHX8ST    P      EA Unused Sts 1
     C                     MOVELWLX9ST    WHX9ST    P      EA Unused Sts 2
     C                     MOVELWLYAST    WHYAST    P      EA Unused Sts 3
     C                     MOVELWLYBST    WHYBST    P      EA Unused Sts 4
     C                     MOVELWLYCST    WHYCST    P      EA Unused Sts 5
     C                     MOVELWLZJST    WHZJST    P      EA Unused Sts 6
     C                     MOVELWLZKST    WHZKST    P      EA Unused Sts 7
     C                     MOVELWLZLST    WHZLST    P      EA Unused Sts 8
     C                     Z-ADDWLB8DT    WHB8DT           RU Date
     C                     Z-ADDWLAOTM    WHAOTM           RU Time
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCP1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@CPCPMW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCPCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Rtv Eval Next#        RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFHSNB    WQTA01           ET Company Numb
     C           *LIKE     DEFN WFA9DT    WQTA02           ET Kill Date
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           ET Company Numb
     C                     KFLD           WQTA02           ET Kill Date
      * Setup key
     C                     Z-ADDWLHKST    WQTA01           ET Company Numb
     C                     Z-ADDWLB7DT    WQTA02           ET Kill Date
      * Establish starting position
     C           KRSTA     SETLL@BVCPNE                    *
     C           KRSTA     READE@BVCPNE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0121' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WUKINB           ET Scale Sequen
     C                     GOTO TAEXIT                     *QUIT
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.ET Scale Sequence Number is Entry Allowed
     C           WFFJNB    IFGE 000001                     *IF
     C           WFFJNB    ANDLE699999
     C           WFFJNB    ADD  1         WUKINB           ET Scale Sequen
     C                     GOTO TAEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTA     READE@BVCPNE                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBCRRC    BEGSR
      *================================================================
      * Create Evaluation Transac - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BVCPF0
     C                     Z-ADDWLHKST    WGHSNB           ET Company Numb
     C                     Z-ADDWLB7DT    WGA9DT           ET Kill Date
     C                     Z-ADDWUKINB    WGFJNB           ET Scale Sequen
     C                     Z-ADDWUKINB    WGHCNB           ET Carcass Numb
     C                     Z-ADD000001    WGGDNB           ET Carcass Numb
     C                     Z-ADDWLKHNB    WGFINB           ET Tattoo Numbe
     C                     Z-ADDWLLNNB    WGLKNB           ET Lot
     C                     MOVELWLHLST    WGEAST           ET Shift
     C                     Z-ADDWLKJNB    WGAMPC           ET Hot Wgt
     C                     Z-ADDWLKKNB    WGAIPC           ET Backfat Thic
     C                     Z-ADDWLBQPC    WGAJPC           ET Loin-Eye Dep
     C                     Z-ADDWUAKPC    WGAKPC           ET Lean Percent
     C                     Z-ADDWLX6NB    WGX8NB           ET Backfat Thic
     C                     Z-ADDWLFQPC    WGFVPC           ET Loineye Dept
     C                     Z-ADDWLFRPC    WGFWPC           ET Light Reflec
     C                     Z-ADDWUFXPC    WGFXPC           ET Lean Percent
     C                     Z-ADDWLBRPC    WGALPC           ET Light Reflec
     C                     MOVELWLHMST    WGDIST           ET Trim Area
     C                     MOVELWUFYST    WGFYST           ET Carcass Sex
     C                     MOVEL*BLANK    WGD2ST           ET Error Sts
     C                     MOVEL*BLANK    WGEHST           ET Record Add/D
     C                     MOVEL*BLANK    WGG1ST           ET Record Creat
     C                     MOVEL'P'       WGH4ST           ET Record Creat
     C                     MOVEL'N'       WGJLST           ET User Error O
     C                     MOVEL*BLANK    WGUUST           ET Adjust/Add T
     C                     MOVELWLX7ST    WGVHST           ET Broken Back
     C                     MOVELWN0011    WGVIST           ET Unused Sts 2
     C                     MOVELWUVJST    WGVJST           ET Adjust/Add S
     C                     MOVELWN0012    WGVKST           ET Unused Sts 4
     C                     MOVELWN0013    WGVLST           ET Unused Sts 5
     C                     Z-ADDWLHKST    WGHMNB           BOH Company Num
     C                     Z-ADDWUBNNB    WGBNNB           BOH Buy Order N
     C                     Z-ADDWUBONB    WGBONB           BOL Load Number
     C                     Z-ADDWLKHNB    WGCVNB           TH Tattoo Numbe
     C                     Z-ADDWLB7DT    WGB0DT           TH Kill Date
     C                     MOVEL*BLANK    WGAAVN           RS User Changed
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     MOVEL'A'       WGAJST           RS Record Statu
     C                     MOVEL*BLANK    WGAHVN           RS Job
     C                     MOVEL*BLANK    WGAGVN           RS Program
     C                     MOVEL*BLANK    WGABVN           RS User Added
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
     C                     Z-ADDWLB8DT    WGB8DT           RU Date
     C                     Z-ADDWLAOTM    WGAOTM           RU Time
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WGAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WGAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WGAJST           RS Record Statu
     C                     MOVEL##USR     WGABVN           RS User Added
     C                     Z-ADD##JDT     WGABDT           RS Date Added
     C                     Z-ADD##JTM     WGABTM           RS Time Added
     C                     MOVEL##PGM     WGAGVN           RS Program
     C                     MOVEL##JOB     WGAHVN           RS Job
     C           KLCRTB    KLIST
     C                     KFLD           WGHSNB           ET Company Numb
     C                     KFLD           WGA9DT           ET Kill Date
     C                     KFLD           WGFJNB           ET Scale Sequen
     C                     KFLD           WGHCNB           ET Carcass Numb
     C                     KFLD           WGGDNB           ET Carcass Numb
      * Check for duplicate primary key
     C           KLCRTB    SETLL@BVCPF0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0122' W0RTN   7
      * Send message 'Eval Trans             EX'
     C                     MOVEL'PRK0122' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C                     WRITE@BVCPF0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCCHRC    BEGSR
      *================================================================
      * Chg Eval Trans UPL    CH - Eval Trans UPL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @CPCPMW
     C                     Z-ADDWLHKST    WHHKST           EA Company Numb
     C                     Z-ADDWLB7DT    WHB7DT           EA Kill Date
     C                     Z-ADDWLKINB    WHKINB           EA Scale Sequen
      *
     C           KLCHTC    KLIST
     C                     KFLD           WHHKST           EA Company Numb
     C                     KFLD           WHB7DT           EA Kill Date
     C                     KFLD           WHKINB           EA Scale Sequen
     C           KLCHTC    CHAIN@CPCPMW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCPCPL0'MDACP
     C                     MOVEL'@CPCPMW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCP1    YGRDCS
      * Move non-key fields to @CPCPMW
     C                     Z-ADDWLKHNB    WHKHNB           EA Tattoo Numbe
     C                     Z-ADDWLLNNB    WHLNNB           EA Lot
     C                     MOVELWLHLST    WHHLST    P      EA Shift
     C                     Z-ADDWLKJNB    WHKJNB           EA Hot Weight
     C                     Z-ADDWLKKNB    WHKKNB           EA Backfat Thic
     C                     Z-ADDWLBQPC    WHBQPC           EA Loin-Eye Dep
     C                     Z-ADDWLBRPC    WHBRPC           EA Light Reflec
     C                     MOVELWLHMST    WHHMST    P      EA Trim Area
     C                     MOVELWLHNST    WHHNST    P      EA Carcass Sex
     C                     MOVELWLHTST    WHHTST    P      EA Record Creat
     C                     MOVEL'Y'       WHHUST    P      EA Record Proce
     C                     Z-ADDWLX6NB    WHX6NB           EA Backfat MM
     C                     Z-ADDWLFQPC    WHFQPC           EA LoinEye MM
     C                     Z-ADDWLFRPC    WHFRPC           EA Light Refl M
     C                     MOVELWLM7CD    WHM7CD    P      EA Trolley Id
     C                     MOVELWLX7ST    WHX7ST    P      EA Broken Back
     C                     MOVELWLX8ST    WHX8ST    P      EA Unused Sts 1
     C                     MOVELWLX9ST    WHX9ST    P      EA Unused Sts 2
     C                     MOVELWLYAST    WHYAST    P      EA Unused Sts 3
     C                     MOVELWLYBST    WHYBST    P      EA Unused Sts 4
     C                     MOVELWLYCST    WHYCST    P      EA Unused Sts 5
     C                     MOVELWLZJST    WHZJST    P      EA Unused Sts 6
     C                     MOVELWLZKST    WHZKST    P      EA Unused Sts 7
     C                     MOVELWLZLST    WHZLST    P      EA Unused Sts 8
     C                     Z-ADDWLB8DT    WHB8DT           RU Date
     C                     Z-ADDWLAOTM    WHAOTM           RU Time
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCP1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@CPCPMW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCPCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv Evl Trns Inv Next RT - Eval Trans Invalid UPL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJKMNB    WQTD01           EB Company Numb
     C           *LIKE     DEFN WJB9DT    WQTD02           EB Kill Date
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           EB Company Numb
     C                     KFLD           WQTD02           EB Kill Date
      * Setup key
     C                     Z-ADDWLHKST    WQTD01           EB Company Numb
     C                     Z-ADDWLB7DT    WQTD02           EB Kill Date
      * Establish starting position
     C           KRSTD     SETLL@CQCPNS                    *
     C           KRSTD     READE@CQCPNS                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0345' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD000001    WUKONB           EB Scale Sequen
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.EB Scale Sequence Number is Entry Allowed
     C           WJKONB    IFGE 000001                     *IF
     C           WJKONB    ANDLE699999
     C           WJKONB    ADD  1         WUKONB           EB Scale Sequen
     C                     GOTO TDEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTD     READE@CQCPNS                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TECRRC    BEGSR
      *================================================================
      * Create Eval Trans Invalid - Eval Trans Invalid UPL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CQCPMZ
     C                     Z-ADDWLHKST    WKKMNB           EB Company Numb
     C                     Z-ADDWLB7DT    WKB9DT           EB Kill Date
     C                     Z-ADDWUKONB    WKKONB           EB Scale Sequen
     C                     Z-ADDWLKHNB    WKKNNB           EB Tattoo Numbe
     C                     Z-ADDWLLNNB    WKLMNB           EB Lot
     C                     MOVELWLHLST    WKHOST           EB Shift
     C                     Z-ADDWLKJNB    WKKPNB           EB Hot Weight
     C                     Z-ADDWLKKNB    WKKQNB           EB Backfat Thic
     C                     Z-ADDWLBQPC    WKBSPC           EB Loin-Eye Dep
     C                     Z-ADDWLBRPC    WKBTPC           EB Light Reflec
     C                     Z-ADDWLX6NB    WKX7NB           EB Backfat Thic
     C                     Z-ADDWLFQPC    WKFTPC           EB Loineye Dept
     C                     Z-ADDWLFRPC    WKFUPC           EB Light Reflec
     C                     MOVELWLHMST    WKHPST           EB Trim Area
     C                     MOVELWLHNST    WKHQST           EB Carcass Sex
     C                     MOVELWLHTST    WKHSST           EB Record Creat
     C                     MOVEL'P'       WKIFST           EB Error Type
     C                     MOVELWLM7CD    WKM8CD           EB Trolley Id
     C                     MOVELWLX7ST    WKZMST           EB Broken Back
     C                     MOVELWLX8ST    WKZNST           EB Unused Sts 1
     C                     MOVELWLX9ST    WKZOST           EB Unused Sts 2
     C                     MOVELWLYAST    WKZPST           EB Unused Sts 3
     C                     MOVELWLYBST    WKZQST           EB Unused Sts 4
     C                     MOVELWLYCST    WKZRST           EB Unused Sts 5
     C                     MOVELWLZJST    WKZSST           EB Unused Sts 6
     C                     MOVELWLZKST    WKZTST           EB Unused Sts 7
     C                     MOVELWLZLST    WKZUST           EB Unused Sts 8
     C                     Z-ADDWLB8DT    WKB8DT           RU Date
     C                     Z-ADDWLAOTM    WKAOTM           RU Time
      *
     C           KLCRTE    KLIST
     C                     KFLD           WKKMNB           EB Company Numb
     C                     KFLD           WKB9DT           EB Kill Date
     C                     KFLD           WKKONB           EB Scale Sequen
      * Check for duplicate primary key
     C           KLCRTE    SETLL@CQCPMZ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0346' W0RTN   7
      * Send message 'Eval Trans Invalid UPL EX'
     C                     MOVEL'PRK0346' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C                     WRITE@CQCPMZ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFCHRC    BEGSR
      *================================================================
      * Chg Eval Trans UPL    CH - Eval Trans UPL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @CPCPMW
     C                     Z-ADDWLHKST    WHHKST           EA Company Numb
     C                     Z-ADDWLB7DT    WHB7DT           EA Kill Date
     C                     Z-ADDWLKINB    WHKINB           EA Scale Sequen
      *
     C           KLCHTF    KLIST
     C                     KFLD           WHHKST           EA Company Numb
     C                     KFLD           WHB7DT           EA Kill Date
     C                     KFLD           WHKINB           EA Scale Sequen
     C           KLCHTF    CHAIN@CPCPMW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCPCPL0'MDACP
     C                     MOVEL'@CPCPMW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCP1    YHRDCS
      * Move non-key fields to @CPCPMW
     C                     Z-ADDWLKHNB    WHKHNB           EA Tattoo Numbe
     C                     Z-ADDWLLNNB    WHLNNB           EA Lot
     C                     MOVELWLHLST    WHHLST    P      EA Shift
     C                     Z-ADDWLKJNB    WHKJNB           EA Hot Weight
     C                     Z-ADDWLKKNB    WHKKNB           EA Backfat Thic
     C                     Z-ADDWLBQPC    WHBQPC           EA Loin-Eye Dep
     C                     Z-ADDWLBRPC    WHBRPC           EA Light Reflec
     C                     MOVELWLHMST    WHHMST    P      EA Trim Area
     C                     MOVELWLHNST    WHHNST    P      EA Carcass Sex
     C                     MOVELWLHTST    WHHTST    P      EA Record Creat
     C                     MOVEL'Y'       WHHUST    P      EA Record Proce
     C                     Z-ADDWLX6NB    WHX6NB           EA Backfat MM
     C                     Z-ADDWLFQPC    WHFQPC           EA LoinEye MM
     C                     Z-ADDWLFRPC    WHFRPC           EA Light Refl M
     C                     MOVELWLM7CD    WHM7CD    P      EA Trolley Id
     C                     MOVELWLX7ST    WHX7ST    P      EA Broken Back
     C                     MOVELWLX8ST    WHX8ST    P      EA Unused Sts 1
     C                     MOVELWLX9ST    WHX9ST    P      EA Unused Sts 2
     C                     MOVELWLYAST    WHYAST    P      EA Unused Sts 3
     C                     MOVELWLYBST    WHYBST    P      EA Unused Sts 4
     C                     MOVELWLYCST    WHYCST    P      EA Unused Sts 5
     C                     MOVELWLZJST    WHZJST    P      EA Unused Sts 6
     C                     MOVELWLZKST    WHZKST    P      EA Unused Sts 7
     C                     MOVELWLZLST    WHZLST    P      EA Unused Sts 8
     C                     Z-ADDWLB8DT    WHB8DT           RU Date
     C                     Z-ADDWLAOTM    WHAOTM           RU Time
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCP1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@CPCPMW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCPCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modification history
      *================================================================
      * E78930 JBB  8/20/21 - Access path PKA2CPLH change
      *                       Access path PKA2CPLH changed to select
      *                       records with Tattoo Number range being 9100
      *                       thru 9850.
      * E78930 JBB  5/25/21 - Access path PKA2CPLH change
      *                       Access path PKA2CPLH changed to select
      *                       records with Tattoo Number range being 9500
      *                       thru 9850.  This includes internal Pre-Tatt
      *                       and Reseach hogs.
      * H16853 ISE 11/02/20 - Increased the Buy Order Number field
      *                       length from 5 to 7.
      * E3407 - allow only Guymon to perform research hogs on
      * tattoo detail ext
      * Guymon IS the only plant that will used research hogs
      * Method 1    is what we are going with at present time
      * Read the Tattoo Dtl of 7000 for internals and change
      *      the tattoo number in the Eval Tran Upl of (9999) only
      *      also create the tattoo detail ext and count hot head
      * DOC:  03/07/02 100% Tattooing
     C                     EXSR UBSUBR                     DOC:  03/07/02
      * For Pre-tattooed internal hogs 9100-9850, read the TD for the net
      *  then if received/slaughter, & not resale, read the net head numb
      *   of eval trans upl rcds and create the eval trans rcds with that
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * DOC:  03/07/02 100% Tattooing
      *================================================================
      * 03/06/02 PKD Starting 03/35/02, all of the Tattoo's are going
      *              to be tattooed 100%.  This includes internal hogs
      *              and externals.  The internals do not need to be in
      *              the 7000 series and Top Loads also do not need to
      *              be in a special series.  The window for valid
      *              Tattoo Number has now been opened from 1111 to 8999.
      *              9999 Tattoo Number carcasses will not be matched wit
      *              a 7000 series number.  The following two retrieves
      *              have been commented out.
      * 09/08/14 SLM Review how to allow TF not to validate tattoo number
      * on HPERESEARC hogs
      * company value of  HPERESEARC  Create Research Hogs=Y
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Valid record
      *================================================================
      * CASE: DB1.EA Carcass Sex EQ WRK.Blank USR
     C           WEHNST    IFEQ WUCRTX                     *IF
     C                     MOVELWUE2ST    WUFYST           ET Carcass Sex
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWEHNST    WUFYST           ET Carcass Sex
     C                     END                             *FI
     C                     Z-ADD*ZERO     WUAKPC           ET Lean Percent
     C                     Z-ADD*ZERO     WUFXPC           ET Lean Percent
      *
     C                     MOVEL*BLANK    WN0001  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0002  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0003  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0004  30       Carcass number
      *
      * Crt Eval Trans Rec    IF
     C                     Z-ADD1         WN0004           Carcass number
      * DO WHILE: PAR.Carcass number        USR is GT Zero
     C           WN0004    DOWGT0                          *DOW
      * Rtv Eval Next#        RT - Eval Trans  * 
     C                     EXSR SFRVGN
      * Create Evaluation Transac - Eval Trans  * 
     C                     EXSR SGCRRC
     C                     SUB  1         WN0004           Carcass number
     C                     END                             *ITR
      * Chg Eval Trans UPL    CH - Eval Trans UPL  * 
     C                     EXSR SHCHRC
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Valid record
      *================================================================
      * CASE: DB1.EA Carcass Sex EQ WRK.Blank USR
     C           WLHNST    IFEQ WUCRTX                     *IF
     C                     MOVELWUE2ST    WUFYST           ET Carcass Sex
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWLHNST    WUFYST           ET Carcass Sex
     C                     END                             *FI
     C                     Z-ADD*ZERO     WUAKPC           ET Lean Percent
     C                     Z-ADD*ZERO     WUFXPC           ET Lean Percent
      *
     C                     MOVEL*BLANK    WN0011  1        ET Unused Sts 2
     C                     MOVEL*BLANK    WN0012  2        ET Unused Sts 4
     C                     MOVEL*BLANK    WN0013  3        ET Unused Sts 5
     C                     Z-ADD*ZERO     WN0014  30       Carcass number
      *
      * Crt Eval Trans Rec    IF
     C                     Z-ADD1         WN0014           Carcass number
      * DO WHILE: PAR.Carcass number        USR is GT Zero
     C           WN0014    DOWGT0                          *DOW
      * Rtv Eval Next#        RT - Eval Trans  * 
     C                     EXSR TARVGN
      * Create Evaluation Transac - Eval Trans  * 
     C                     EXSR TBCRRC
     C                     SUB  1         WN0014           Carcass number
     C                     END                             *ITR
      * We want to do this after the carcasses are balanced.
      * Chg Eval Trans UPL    CH - Eval Trans UPL  * 
     C                     EXSR TCCHRC
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field System Value Alpha    USR
     C                     MOVEL*BLANK    WUKBTX 40
      * Define work field Status 4
     C                     MOVEL*BLANK    WUA7SS  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WAC2NB           TD Sequence Num
     C                     Z-ADD*ZERO     WACZNB           TD Live Wgt
     C                     Z-ADD*ZERO     WAC0NB           TD Pen Head
     C                     Z-ADD*ZERO     WAD8NB           TD Yard Dead
     C                     Z-ADD*ZERO     WAH7NB           TD Held Over
     C                     Z-ADD*ZERO     WAAJTM           TD Drive Time
     C                     Z-ADD*ZERO     WAJEA1           TD Drive Hour
     C                     Z-ADD*ZERO     WAB7CD           TD Drive Card N
     C                     Z-ADD*ZERO     WAD7NB           TD Avg Live Wgt
     C                     Z-ADD*ZERO     WABVDT           TD User Date 1
     C                     Z-ADD*ZERO     WABWDT           TD User Date 2
     C                     Z-ADD*ZERO     WABXDT           TD Drive Date
     C                     Z-ADD*ZERO     WAHVNB           Pen Company Num
     C                     Z-ADD*ZERO     WAH8NB           Held Over Pen C
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field Net Head Usr
     C                     Z-ADD*ZERO     WUF6NB  50
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Define work field TH Sex
     C                     MOVEL*BLANK    WUE2ST  1
      * Define work field TH Source Type
     C                     MOVEL*BLANK    WUKAST  1
      * Define work field TH Hog Class Type
     C                     MOVEL*BLANK    WULLST  1
      * Define work field THP Process Code
     C                     MOVEL*BLANK    WUCSCD  6
      * Define work field HC Class Code
     C                     MOVEL*BLANK    WUBECD  3
      * Define work field Return Code USR
     C                     MOVEL*BLANK    WULMST  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBBONB           BOL Load Number
     C                     Z-ADD*ZERO     WBCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WBB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WBAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WBACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WBB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WBCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WBAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WBA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WBCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WBCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WBFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WBH9NB           TH Held Over
     C                     Z-ADD*ZERO     WBFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WBFENB           TH Head Killed
     C                     Z-ADD*ZERO     WBHENB           TH Head Adds
     C                     Z-ADD*ZERO     WBHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WBCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WBLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WBE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WBA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WBFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WBA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WBF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WBHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WBF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WBF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WBF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WBF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WBAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WBAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WBCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WBA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WBA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WBB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WBAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WBANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WBAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WBAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WBAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WBAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WBAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WBASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WBA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WBATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WBA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WBCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WBCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WBLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WBCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WBA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WBA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WBGHNB           TH Commission A
     C                     Z-ADD*ZERO     WBBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WBBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WBBTDT           TH Commission P
     C                     Z-ADD*ZERO     WBBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WBHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WBHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WBHINB           TH FFLI
     C                     Z-ADD*ZERO     WBA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WBA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WBA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WBJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WBD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WBD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WBD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WBD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WBEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WBEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WBECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WBEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WBEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WBEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WBEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WBEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WBOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WBTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WBT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WBTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WBT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WBOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WBKOER           TH Head Identif
     C                     Z-ADD*ZERO     WBOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WBOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WBIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WBOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WBHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WBS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WBTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WBTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WBJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WBKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WBKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WBKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WBKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WBOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WBIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WBIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WBIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WBKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WBOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WBKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WBORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WBOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WBMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WBMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WBNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WBNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WBIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WBKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WBEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WBEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WBECDT           TH Head LFT
     C                     Z-ADD*ZERO     WBEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WBEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Define work field Completed Status
     C                     MOVEL*BLANK    WUP3ST  1
      * Define work field Hot Head
     C                     Z-ADD*ZERO     WULENB  50
      * Define work field TDE Head Condemned
     C                     Z-ADD*ZERO     WULFNB  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WCBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WCBONB           BOL Load Number
     C                     Z-ADD*ZERO     WCCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WCB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WCC2NB           TD Sequence Num
     C                     Z-ADD*ZERO     WCLENB           Hot Head
     C                     Z-ADD*ZERO     WCLFNB           TDE Head Condem
     C                     Z-ADD*ZERO     WCLINB           Head 2
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEHKST           EA Company Numb
     C                     Z-ADD*ZERO     WEB7DT           EA Kill Date
     C                     Z-ADD*ZERO     WEKINB           EA Scale Sequen
     C                     Z-ADD*ZERO     WEKHNB           EA Tattoo Numbe
     C                     Z-ADD*ZERO     WELNNB           EA Lot
     C                     Z-ADD*ZERO     WEKJNB           EA Hot Weight
     C                     Z-ADD*ZERO     WEKKNB           EA Backfat Thic
     C                     Z-ADD*ZERO     WEBQPC           EA Loin-Eye Dep
     C                     Z-ADD*ZERO     WEBRPC           EA Light Reflec
     C                     Z-ADD*ZERO     WEX6NB           EA Backfat MM
     C                     Z-ADD*ZERO     WEFQPC           EA LoinEye MM
     C                     Z-ADD*ZERO     WEFRPC           EA Light Refl M
     C                     Z-ADD*ZERO     WEB8DT           RU Date
     C                     Z-ADD*ZERO     WEAOTM           RU Time
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Define work field ET Carcass Sex
     C                     MOVEL*BLANK    WUFYST  1
      * Define work field ET Lean Percent NPPC
     C                     Z-ADD*ZERO     WUAKPC  31
      * Define work field ET Lean Percent FOM
     C                     Z-ADD*ZERO     WUFXPC  31
      * Define work field EA Scale Sequence Number
     C                     Z-ADD*ZERO     WUKINB  60
      * Define work field ET Carcass Number
     C                     Z-ADD*ZERO     WUHCNB  60
      * Define work field ET Adjust/Add Source
     C                     MOVEL*BLANK    WUVJST  2
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFHSNB           ET Company Numb
     C                     Z-ADD*ZERO     WFA9DT           ET Kill Date
     C                     Z-ADD*ZERO     WFFJNB           ET Scale Sequen
     C                     Z-ADD*ZERO     WFHCNB           ET Carcass Numb
     C                     Z-ADD*ZERO     WFGDNB           ET Carcass Numb
     C                     Z-ADD*ZERO     WFFINB           ET Tattoo Numbe
     C                     Z-ADD*ZERO     WFLKNB           ET Lot
     C                     Z-ADD*ZERO     WFAMPC           ET Hot Wgt
     C                     Z-ADD*ZERO     WFAIPC           ET Backfat Thic
     C                     Z-ADD*ZERO     WFAJPC           ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WFAKPC           ET Lean Percent
     C                     Z-ADD*ZERO     WFX8NB           ET Backfat Thic
     C                     Z-ADD*ZERO     WFFVPC           ET Loineye Dept
     C                     Z-ADD*ZERO     WFFWPC           ET Light Reflec
     C                     Z-ADD*ZERO     WFFXPC           ET Lean Percent
     C                     Z-ADD*ZERO     WFALPC           ET Light Reflec
     C                     Z-ADD*ZERO     WFHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WFBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WFBONB           BOL Load Number
     C                     Z-ADD*ZERO     WFCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WFB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WFAADT           RS Date Changed
     C                     Z-ADD*ZERO     WFAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WFABDT           RS Date Added
     C                     Z-ADD*ZERO     WFABTM           RS Time Added
     C                     Z-ADD*ZERO     WFB8DT           RU Date
     C                     Z-ADD*ZERO     WFAOTM           RU Time
      * Define work field EB Scale Sequence Number
     C                     Z-ADD*ZERO     WUKONB  60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJKMNB           EB Company Numb
     C                     Z-ADD*ZERO     WJB9DT           EB Kill Date
     C                     Z-ADD*ZERO     WJKONB           EB Scale Sequen
     C                     Z-ADD*ZERO     WJKNNB           EB Tattoo Numbe
     C                     Z-ADD*ZERO     WJLMNB           EB Lot
     C                     Z-ADD*ZERO     WJKPNB           EB Hot Weight
     C                     Z-ADD*ZERO     WJKQNB           EB Backfat Thic
     C                     Z-ADD*ZERO     WJBSPC           EB Loin-Eye Dep
     C                     Z-ADD*ZERO     WJBTPC           EB Light Reflec
     C                     Z-ADD*ZERO     WJX7NB           EB Backfat Thic
     C                     Z-ADD*ZERO     WJFTPC           EB Loineye Dept
     C                     Z-ADD*ZERO     WJFUPC           EB Light Reflec
     C                     Z-ADD*ZERO     WJB8DT           RU Date
     C                     Z-ADD*ZERO     WJAOTM           RU Time
      * Define work field First Time Flag Usr
     C                     MOVEL*BLANK    WUHBST  1
      * Define work field Oms Name
     C                     MOVEL*BLANK    WUEUTX 30
      * Define work field Invalid Y/N USR
     C                     MOVEL*BLANK    WUG3ST  1
      * Define work field BOH Buy Order Number
     C                     Z-ADD*ZERO     WUBNNB  70
      * Define work field BOL Load Number
     C                     Z-ADD*ZERO     WUBONB  50
      * Define work field Oms System Value Alpha
     C                     MOVEL*BLANK    WUEVTX 40
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 HPERESEARC
00002 Y2U0005
