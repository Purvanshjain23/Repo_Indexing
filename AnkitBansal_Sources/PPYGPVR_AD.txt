// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PPYGPVR
// ?Date: 14.08.2025 Time: 03:42:19
// ?------------------------------------------------------------------------------------------------

//?USER: Initialize program

//?***** Change Log and Comments
DO;

//?*****
//?** 05/23/2006 LJB
//?** This is a FIX. The Bal Avg Days to Pay field in the A/R
//?** Balance File was truncated to 3.0 during calculations. This is
//?** to recalculate the avg days to pay and update the file.
//?*****
//?** 09/12/2006 LJB L60906C
//?** Remove the beginning and ending date from the screen.
//?** Change to use RTV Days MTD from the A/R Header to get the
//?** Days to Pay field. Update A/R Balance Days to Pay.
//?*****
ENDDO;

//?USER: Load screen

// DTL.A/R Balance Year = CON.2006
DTL.A_R_Balance_Year = 2006;

// DTL.A/R Balance Month = CON.01
DTL.A_R_Balance_Month = 01;

//?USER: Validate fields

CASE;

// IF DTL.A/R Balance Year is equal to zero
IF DTL.A_R_Balance_Year = *ZERO;

// DTL.A/R Balance Year = CON.2006
DTL.A_R_Balance_Year = 2006;

ENDIF;

CASE;

// IF DTL.A/R Balance Month is Zero
IF DTL.A_R_Balance_Month = *ZERO;

// DTL.A/R Balance Month = CON.01
DTL.A_R_Balance_Month = 01;

ENDIF;

//?CALC: Screen function fields

SET CURSOR;

//?USER: User defined action

// Call program Zzz Bal Avg Days to Py XF.
CALL PROGRAM(Zzz Bal Avg Days to Py XF) ('PPYHXFR');
PARAMETER(DTL.A_R_Balance_Year);
PARAMETER(DTL.A_R_Balance_Month);

// PGM.*Defer confirm = CND.Defer confirm
PGM.*Defer_confirm = 'Y';

// Send information message - 'Job &1 has been submitted to job queue &2.'
MESSAGE(USR2685 *INFO);
MSGPARM(JOB.*JOB);
MSGPARM(*BLANK);

