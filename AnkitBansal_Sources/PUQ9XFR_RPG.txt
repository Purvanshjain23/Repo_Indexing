     H/TITLE Exc TRG OMFJCPP ProcessXF Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 05/29/20  Time  : 15:40:27
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPUB2CPL0  IF A E           K DISK
      * UPD : Load Header TRG           Update index
      *
      * Long constants
     D @CN#            S              6    DIM(01)CTDATA PERRCD(1)
     D @CN             S             25    DIM(01) ALT(@CN#)
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
     D QPUB21        E DS                  EXTNAME(PUB2CPL0)
      * UPD : Load Header TRG           Update index
      * Renamed input format fields
     D  WARMNB       E                     EXTFLD(B2RMNB)
     D  WAA8TS       E                     EXTFLD(B2A8TS)
     D  WAK9SC       E                     EXTFLD(B2K9SC)
     D  WALASC       E                     EXTFLD(B2LASC)
     D  WABPDX       E                     EXTFLD(B2BPDX)
      *
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  WP0001         S              1
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  XDTSDL         S             26
     D  WL0001         S              7  0
     D  WL0002         S              1
     D  WL0003         S              2
     D  WL0004         S              8  0
     D  WN0001         S             26
     D  ##TMS          S             26
     D  ZADFMF         S             10
     D  YL0001         S              1
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  W0PMT          S              1
      /EJECT
      * Parameter declarations
     D P1PARM          DS           793
      * RCD: Load Header               Retrieval index
      * I :  Load ID
     D  P1RMNB                 1      4P 0
      * I :  Company Number
     D  P1AIC3                 5      6P 0
      * I :  Scheduled Ship Date
     D  P1AODT                 7     10P 0
      * I :  LTL Flag
     D  P1PJST                11     11
      * I :  Load Status
     D  P1PKST                12     12
      * I :  Reefer Temperature
     D  P1RNNB                13     15P 2
      * I :  Seal 1
     D  P1DMTX                16     30
      * I :  Seal 2
     D  P1DNTX                31     45
      * I :  Seal 3
     D  P1DOTX                46     60
      * I :  Seal 4
     D  P1WTTX                61     75
      * I :  Seal 2 Unused
     D  P1WUTX                76     90
      * I :  Total Load Order Weight
     D  P1RPNB                91     94P 0
      * I :  Flat Amount
     D  P1FLAM                95    100P 2
      * I :  Allocate Pounds/Miles
     D  P1XQST               101    101
      * I :  Total Stops
     D  P1RRNB               102    104P 0
      * I :  Trailer Id
     D  P1DXTX               105    124
      * I :  Transloader Carrier Code
     D  P1DYTX               125    127
      * I :  BOL Time
     D  P1SBNB               128    130P 0
      * I :  Carrier Code
     D  P1BZNA               131    133
      * I :  Truck Size
     D  P1RONB               134    140
      * I :  Ld Hdr/Ld Dtl Unused
     D  P1SQNB               141    144P 0
      * I :  Rated Freight
     D  P1R1NB               145    150P 2
      * I :  Ship Status
     D  P1VCST               151    151
      * I :  Load Type
     D  P1VDST               152    152
      * I :  Number Pallets Received
     D  P1SDNB               153    155P 0
      * I :  Number Pallets Loaded
     D  P1PAOU               156    158P 0
      * I :  Load Carrier Pay Amt
     D  P1DGWG               159    164P 2
      * I :  Estimated Arrival Time
     D  P1SXNB               165    168P 0
      * I :  Actual Arrival Date
     D  P1HADT               169    172P 0
      * I :  Actual Arrival Time
     D  P1AART               173    175P 0
      * I :  Trailer IN Weight
     D  P1DHWG               176    181P 2
      * I :  Trailer OUT Weight
     D  P1DIWG               182    187P 2
      * I :  Actual Departure Date
     D  P1AQDT               188    191P 0
      * I :  Departure Time
     D  P1S6NB               192    194P 0
      * I :  Schedule Sequence Number
     D  P1T4NB               195    197P 0
      * I :  Product Temperature
     D  P1PRTM               198    200P 2
      * I :  Number Spacers Loaded
     D  P1NPSV               201    203P 0
      * I :  Car/Veh. Initials
     D  P1J8TX               204    215
      * I :  Total Load Miles
     D  P1TLMI               216    219P 0
      * I :  Recorder ID
     D  P1J9TX               220    231
      * I :  Shipping Method
     D  P1Q2CD               232    233
      * I :  Ship From Warehouse
     D  P1VPCD               234    236
      * I :  Ship To State Code
     D  P1DBCD               237    238
      * I :  Gross Weight
     D  P1GRWE               239    242P 0
      * I :  Carrier Broker
     D  P1XCCD               243    245
      * I :  Export Status
     D  P1U2ST               246    246
      * I :  Actual Ship Date
     D  P1F9DT               247    250P 0
      * I :  On Time - (Y/N)
     D  P1ONTM               251    251
      * I :  Truck Ready Date
     D  P1J4DT               252    255P 0
      * I :  Truck Ready Time
     D  P1TRTM               256    259P 0
      * I :  Spotted Date
     D  P1J5DT               260    263P 0
      * I :  Spotted Time
     D  P1SPTM               264    267P 0
      * I :  Load Finished Date
     D  P1J6DT               268    271P 0
      * I :  Load Finished Time
     D  P1LFTM               272    275P 0
      * I :  BOL Complete Date
     D  P1J7DT               276    279P 0
      * I :  BOL Complete Time
     D  P1BOTM               280    283P 0
      * I :  BOL Received Date
     D  P1J8DT               284    287P 0
      * I :  BOL Received Time
     D  P1BLTM               288    291P 0
      * I :  Truck Departure Date
     D  P1KIDT               292    295P 0
      * I :  Truck Departure Time
     D  P1ASTM               296    299P 0
      * I :  Adjusted Departure Date
     D  P1KADT               300    303P 0
      * I :  Adjusted Departure Time
     D  P1AJCM               304    307P 0
      * I :  Shipping Line
     D  P1XACD               308    310
      * I :  Port Delv Terminal
     D  P1OANA               311    330
      * I :  Vessel Name
     D  P1K4TX               331    360
      * I :  Voyage
     D  P1VOAG               361    363P 0
      * I :  Sail Date
     D  P1KBDT               364    367P 0
      * I :  Booking Number
     D  P1NBBO               368    379
      * I :  Discharge Port
     D  P1W4CD               380    399
      * I :  Arrival Date
     D  P1EFDT               400    403P 0
      * I :  Container Number
     D  P1CNTN               404    415
      * I :  Date In
     D  P1KCDT               416    419P 0
      * I :  Time In
     D  P1TMIN               420    423P 0
      * I :  Date Out
     D  P1KDDT               424    427P 0
      * I :  Time Out
     D  P1VMNB               428    431P 0
      * I :  Load Total Freight
     D  P1OCFR               432    437P 2
      * I :  Scheduled Delivery Date
     D  P1KJDT               438    441P 0
      * I :  Scheduled Delivery Time
     D  P1ATTM               442    445P 0
      * I :  LH Unused Sts
     D  P1OTRS               446    446
      * I :  LH Carrier Payment Sts
     D  P1RNST               447    447
      * I :  Bring Back Miles
     D  P1BRBK               448    451P 0
      * I :  Requested Delivery Date
     D  P1EIDT               452    455P 0
      * I :  Load Acceptance Flag
     D  P1RMST               456    456
      * I :  Warehouse Code
     D  P1AJCD               457    459
      * I :  On Yard Date
     D  P1KKDT               460    463P 0
      * I :  On Yard Time
     D  P1AVTM               464    467P 0
      * I :  Deadline Departure Date
     D  P1KZDT               468    471P 0
      * I :  Deadline Departure Time
     D  P1AXTM               472    475P 0
      * I :  Load Held Over
     D  P1LHOS               476    476
      * I :  Load Held Over Reason
     D  P1LHOR               477    477
      * I :  Load Held Over Rsn Cmt
     D  P1WNTX               478    492
      * I :  Ocean BOL Number
     D  P1OITX               493    517
      * I :  Express Mail Number
     D  P1OJTX               518    537
      * I :  Express Mail Date
     D  P1LLDT               538    541P 0
      * I :  Load Shag Flag
     D  P1LSHG               542    542
      * I :  Load Wash Flag
     D  P1YPST               543    543
      * I :  Product Complete Date
     D  P1K0DT               544    547P 0
      * I :  Product Complete Time
     D  P1AYTM               548    551P 0
      * I :  Pallets Loaded
     D  P1KNNX               552    554P 0
      * I :  Avg Pallet Tare
     D  P1ICWG               555    559P 2
      * I :  Tot Pallet Tare
     D  P1IDWG               560    564P 2
      * I :  Load Confirmed Sts
     D  P1H9SX               565    565
      * I :  Load Confirmed Contact
     D  P1WOTX               566    590
      * I :  Load Confirmation Time
     D  P1K1DT               591    594P 0
      * I :  Load Door 1
     D  P1AZTM               595    598P 0
      * I :  Override Total Load Miles
     D  P1K2DT               599    602P 0
      * I :  Load Door 2
     D  P1A0TM               603    606P 0
      * I :  Partial Load
     D  P1ROST               607    607
      * I :  Load Confirmation Fax Sts
     D  P1RPST               608    608
      * I :  Export Load USDA-OK
     D  P1RQST               609    609
      * I :  Late Delivery Email Flag
     D  P1RRST               610    610
      * I :  Load Actual Freight
     D  P1ZBVA               611    616P 2
      * I :  Hide on WW Load Sts
     D  P1WPTX               617    631
      * I :  Late Billing Email Flag
     D  P1WQTX               632    646
      * I :  Shipping Temp C/F txt
     D  P1WRTX               647    671
      * I :  LH Held Over Rsn Cmt
     D  P1WSTX               672    696
      * I :  Multi Company Load
     D  P1RVSX               697    697
      * I :  Fax Sent to SSI Carrier
     D  P1RUSX               698    698
      * I :  Schedule Pos Load Grade
     D  P1RWSX               699    699
      * I :  LH Power Only Load
     D  P1RXSX               700    700
      * I :  MG Created Load
     D  P1RYSX               701    701
      * I :  LH Unused Sts 5
     D  P1RZSX               702    702
      * I :  Load U/M
     D  P1R0SX               703    704
      * I :  TPM Shipment Status
     D  P1R1SX               705    706
      * I :  LH Unused Sts 8
     D  P1R2SX               707    708
      * I :  LH On-Time Reason Code
     D  P1R3SX               709    711
      * I :  LH Held Over Reason
     D  P1R4SX               712    714
      * I :  LH Carrier Paid Dte
     D  P1PYDT               715    718P 0
      * I :  LH Carrier Paid Time
     D  P1CKTM               719    722P 0
      * I :  LH Last Combo Prod Date
     D  P1PZDT               723    726P 0
      * I :  LH Last Combo Prod Time
     D  P1CLTM               727    730P 0
      * I :  LPT Load Plan Start Dt
     D  P1P0DT               731    734P 0
      * I :  LPT Load Plan Start Tm
     D  P1CMTM               735    738P 0
      * I :  TPM Planned Ship Date
     D  P1P1DT               739    742P 0
      * I :  LH Unused Time 4
     D  P1CNTM               743    746P 0
      * I :  LH Unused Date 5
     D  P1P2DT               747    750P 0
      * I :  LH Unused Time 5
     D  P1COTM               751    754P 0
      * I :  LH Unused Date 6
     D  P1P3DT               755    758P 0
      * I :  LH Unused Time 6
     D  P1CQTM               759    762P 0
      * I :  EDI Status 1
     D  P1UVST               763    763
      * I :  EDI Status 2
     D  P1UWST               764    764
      * I :  EDI Status 3
     D  P1UXST               765    765
      * I :  Job Time
     D  P1AATM               766    769P 0
      * I :  User Id
     D  P1AYNA               770    779
      * I :  Job Name
     D  P1A0NA               780    789
      * I :  Job Date
     D  P1AXDT               790    793P 0
     D P2PARM          DS           793
      * RCD: Load Header               Retrieval index
      * I :  Load ID
     D  P2RMNB                 1      4P 0
      * I :  Company Number
     D  P2AIC3                 5      6P 0
      * I :  Scheduled Ship Date
     D  P2AODT                 7     10P 0
      * I :  LTL Flag
     D  P2PJST                11     11
      * I :  Load Status
     D  P2PKST                12     12
      * I :  Reefer Temperature
     D  P2RNNB                13     15P 2
      * I :  Seal 1
     D  P2DMTX                16     30
      * I :  Seal 2
     D  P2DNTX                31     45
      * I :  Seal 3
     D  P2DOTX                46     60
      * I :  Seal 4
     D  P2WTTX                61     75
      * I :  Seal 2 Unused
     D  P2WUTX                76     90
      * I :  Total Load Order Weight
     D  P2RPNB                91     94P 0
      * I :  Flat Amount
     D  P2FLAM                95    100P 2
      * I :  Allocate Pounds/Miles
     D  P2XQST               101    101
      * I :  Total Stops
     D  P2RRNB               102    104P 0
      * I :  Trailer Id
     D  P2DXTX               105    124
      * I :  Transloader Carrier Code
     D  P2DYTX               125    127
      * I :  BOL Time
     D  P2SBNB               128    130P 0
      * I :  Carrier Code
     D  P2BZNA               131    133
      * I :  Truck Size
     D  P2RONB               134    140
      * I :  Ld Hdr/Ld Dtl Unused
     D  P2SQNB               141    144P 0
      * I :  Rated Freight
     D  P2R1NB               145    150P 2
      * I :  Ship Status
     D  P2VCST               151    151
      * I :  Load Type
     D  P2VDST               152    152
      * I :  Number Pallets Received
     D  P2SDNB               153    155P 0
      * I :  Number Pallets Loaded
     D  P2PAOU               156    158P 0
      * I :  Load Carrier Pay Amt
     D  P2DGWG               159    164P 2
      * I :  Estimated Arrival Time
     D  P2SXNB               165    168P 0
      * I :  Actual Arrival Date
     D  P2HADT               169    172P 0
      * I :  Actual Arrival Time
     D  P2AART               173    175P 0
      * I :  Trailer IN Weight
     D  P2DHWG               176    181P 2
      * I :  Trailer OUT Weight
     D  P2DIWG               182    187P 2
      * I :  Actual Departure Date
     D  P2AQDT               188    191P 0
      * I :  Departure Time
     D  P2S6NB               192    194P 0
      * I :  Schedule Sequence Number
     D  P2T4NB               195    197P 0
      * I :  Product Temperature
     D  P2PRTM               198    200P 2
      * I :  Number Spacers Loaded
     D  P2NPSV               201    203P 0
      * I :  Car/Veh. Initials
     D  P2J8TX               204    215
      * I :  Total Load Miles
     D  P2TLMI               216    219P 0
      * I :  Recorder ID
     D  P2J9TX               220    231
      * I :  Shipping Method
     D  P2Q2CD               232    233
      * I :  Ship From Warehouse
     D  P2VPCD               234    236
      * I :  Ship To State Code
     D  P2DBCD               237    238
      * I :  Gross Weight
     D  P2GRWE               239    242P 0
      * I :  Carrier Broker
     D  P2XCCD               243    245
      * I :  Export Status
     D  P2U2ST               246    246
      * I :  Actual Ship Date
     D  P2F9DT               247    250P 0
      * I :  On Time - (Y/N)
     D  P2ONTM               251    251
      * I :  Truck Ready Date
     D  P2J4DT               252    255P 0
      * I :  Truck Ready Time
     D  P2TRTM               256    259P 0
      * I :  Spotted Date
     D  P2J5DT               260    263P 0
      * I :  Spotted Time
     D  P2SPTM               264    267P 0
      * I :  Load Finished Date
     D  P2J6DT               268    271P 0
      * I :  Load Finished Time
     D  P2LFTM               272    275P 0
      * I :  BOL Complete Date
     D  P2J7DT               276    279P 0
      * I :  BOL Complete Time
     D  P2BOTM               280    283P 0
      * I :  BOL Received Date
     D  P2J8DT               284    287P 0
      * I :  BOL Received Time
     D  P2BLTM               288    291P 0
      * I :  Truck Departure Date
     D  P2KIDT               292    295P 0
      * I :  Truck Departure Time
     D  P2ASTM               296    299P 0
      * I :  Adjusted Departure Date
     D  P2KADT               300    303P 0
      * I :  Adjusted Departure Time
     D  P2AJCM               304    307P 0
      * I :  Shipping Line
     D  P2XACD               308    310
      * I :  Port Delv Terminal
     D  P2OANA               311    330
      * I :  Vessel Name
     D  P2K4TX               331    360
      * I :  Voyage
     D  P2VOAG               361    363P 0
      * I :  Sail Date
     D  P2KBDT               364    367P 0
      * I :  Booking Number
     D  P2NBBO               368    379
      * I :  Discharge Port
     D  P2W4CD               380    399
      * I :  Arrival Date
     D  P2EFDT               400    403P 0
      * I :  Container Number
     D  P2CNTN               404    415
      * I :  Date In
     D  P2KCDT               416    419P 0
      * I :  Time In
     D  P2TMIN               420    423P 0
      * I :  Date Out
     D  P2KDDT               424    427P 0
      * I :  Time Out
     D  P2VMNB               428    431P 0
      * I :  Load Total Freight
     D  P2OCFR               432    437P 2
      * I :  Scheduled Delivery Date
     D  P2KJDT               438    441P 0
      * I :  Scheduled Delivery Time
     D  P2ATTM               442    445P 0
      * I :  LH Unused Sts
     D  P2OTRS               446    446
      * I :  LH Carrier Payment Sts
     D  P2RNST               447    447
      * I :  Bring Back Miles
     D  P2BRBK               448    451P 0
      * I :  Requested Delivery Date
     D  P2EIDT               452    455P 0
      * I :  Load Acceptance Flag
     D  P2RMST               456    456
      * I :  Warehouse Code
     D  P2AJCD               457    459
      * I :  On Yard Date
     D  P2KKDT               460    463P 0
      * I :  On Yard Time
     D  P2AVTM               464    467P 0
      * I :  Deadline Departure Date
     D  P2KZDT               468    471P 0
      * I :  Deadline Departure Time
     D  P2AXTM               472    475P 0
      * I :  Load Held Over
     D  P2LHOS               476    476
      * I :  Load Held Over Reason
     D  P2LHOR               477    477
      * I :  Load Held Over Rsn Cmt
     D  P2WNTX               478    492
      * I :  Ocean BOL Number
     D  P2OITX               493    517
      * I :  Express Mail Number
     D  P2OJTX               518    537
      * I :  Express Mail Date
     D  P2LLDT               538    541P 0
      * I :  Load Shag Flag
     D  P2LSHG               542    542
      * I :  Load Wash Flag
     D  P2YPST               543    543
      * I :  Product Complete Date
     D  P2K0DT               544    547P 0
      * I :  Product Complete Time
     D  P2AYTM               548    551P 0
      * I :  Pallets Loaded
     D  P2KNNX               552    554P 0
      * I :  Avg Pallet Tare
     D  P2ICWG               555    559P 2
      * I :  Tot Pallet Tare
     D  P2IDWG               560    564P 2
      * I :  Load Confirmed Sts
     D  P2H9SX               565    565
      * I :  Load Confirmed Contact
     D  P2WOTX               566    590
      * I :  Load Confirmation Time
     D  P2K1DT               591    594P 0
      * I :  Load Door 1
     D  P2AZTM               595    598P 0
      * I :  Override Total Load Miles
     D  P2K2DT               599    602P 0
      * I :  Load Door 2
     D  P2A0TM               603    606P 0
      * I :  Partial Load
     D  P2ROST               607    607
      * I :  Load Confirmation Fax Sts
     D  P2RPST               608    608
      * I :  Export Load USDA-OK
     D  P2RQST               609    609
      * I :  Late Delivery Email Flag
     D  P2RRST               610    610
      * I :  Load Actual Freight
     D  P2ZBVA               611    616P 2
      * I :  Hide on WW Load Sts
     D  P2WPTX               617    631
      * I :  Late Billing Email Flag
     D  P2WQTX               632    646
      * I :  Shipping Temp C/F txt
     D  P2WRTX               647    671
      * I :  LH Held Over Rsn Cmt
     D  P2WSTX               672    696
      * I :  Multi Company Load
     D  P2RVSX               697    697
      * I :  Fax Sent to SSI Carrier
     D  P2RUSX               698    698
      * I :  Schedule Pos Load Grade
     D  P2RWSX               699    699
      * I :  LH Power Only Load
     D  P2RXSX               700    700
      * I :  MG Created Load
     D  P2RYSX               701    701
      * I :  LH Unused Sts 5
     D  P2RZSX               702    702
      * I :  Load U/M
     D  P2R0SX               703    704
      * I :  TPM Shipment Status
     D  P2R1SX               705    706
      * I :  LH Unused Sts 8
     D  P2R2SX               707    708
      * I :  LH On-Time Reason Code
     D  P2R3SX               709    711
      * I :  LH Held Over Reason
     D  P2R4SX               712    714
      * I :  LH Carrier Paid Dte
     D  P2PYDT               715    718P 0
      * I :  LH Carrier Paid Time
     D  P2CKTM               719    722P 0
      * I :  LH Last Combo Prod Date
     D  P2PZDT               723    726P 0
      * I :  LH Last Combo Prod Time
     D  P2CLTM               727    730P 0
      * I :  LPT Load Plan Start Dt
     D  P2P0DT               731    734P 0
      * I :  LPT Load Plan Start Tm
     D  P2CMTM               735    738P 0
      * I :  TPM Planned Ship Date
     D  P2P1DT               739    742P 0
      * I :  LH Unused Time 4
     D  P2CNTM               743    746P 0
      * I :  LH Unused Date 5
     D  P2P2DT               747    750P 0
      * I :  LH Unused Time 5
     D  P2COTM               751    754P 0
      * I :  LH Unused Date 6
     D  P2P3DT               755    758P 0
      * I :  LH Unused Time 6
     D  P2CQTM               759    762P 0
      * I :  EDI Status 1
     D  P2UVST               763    763
      * I :  EDI Status 2
     D  P2UWST               764    764
      * I :  EDI Status 3
     D  P2UXST               765    765
      * I :  Job Time
     D  P2AATM               766    769P 0
      * I :  User Id
     D  P2AYNA               770    779
      * I :  Job Name
     D  P2A0NA               780    789
      * I :  Job Date
     D  P2AXDT               790    793P 0
     D P3PARM          DS
      * I :  TRG Database Event
     D  P3D8SC                 1      1
     D                 DS
     D  ZAMSDA                 1    132
     I@B2CPHO
      * Load Header TRG           Update index
      * Renamed input format fields
     I              B2RMNB                      WARMNB
     I              B2A8TS                      WAA8TS
     I              B2K9SC                      WAK9SC
     I              B2LASC                      WALASC
     I              B2BPDX                      WABPDX
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
     C                   PARM                    P1PARM                         RCD: Load Heade
     C                   PARM                    P2PARM                         RCD: Load Heade
     C     P3D8SC        PARM                    WP0001                         TRG Database Ev
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Exc TRG OMFJCPP ProcessXF
      * *****************************************************************
      * ** PR1 Parms Represent Old Record Fields (Will be blank for Inser
      * ** PR2 Parms Represent New Record Fields (Will be blank for Delet
      * *****************************************************************
      * Trigger Processing for Insert Event.
      * CASE: PR3.TRG Database Event is Insert
      * Crt Load Header TRG   CR - Load Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                   IF        P3D8SC = '1'
     C                   Z-ADD     P2RMNB        WL0001                         Load ID
     C                   MOVEL(P)  P3D8SC        WL0002                         LHT TRG Databas
     C                   MOVEL(P)  '0'           WL0003                         LHT Process Sta
     C                   Z-ADD     0             WL0004                         LHT Process Dat
     C                   EXSR      SACRRC
     C                   END                                                    *FI
      * Trigger Processing for Update Event.
      * CASE: PR3.TRG Database Event is Update
     C                   IF        P3D8SC = '3'
     C                   MOVEL     'N'           YL0001                         Update Record U
      * Update If Any Non-Key Fields Have Changed.
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10ORc11ORc12ORc13ORc14OR
      *  - c15ORc16ORc17ORc18OR c19ORc20ORc21ORc22ORc23ORc24ORc25ORc26OR
      *  - c27ORc28ORc29ORc30ORc31ORc32ORc33ORc34OR c35ORc36ORc37ORc38OR
      *  - c39ORc40ORc41ORc42ORc43ORc44ORc45
      *   |- c1    : PR1.Company Number NE PR2.Company Number
      *   |- c2    : PR1.Scheduled Ship Date NE PR2.Scheduled Ship Date
      *   |- c3    : PR1.LTL Flag NE PR2.LTL Flag
      *   |- c4    : PR1.Load Status NE PR2.Load Status
      *   |- c5    : PR1.Reefer Temperature NE PR2.Reefer Temperature
      *   |- c6    : PR1.Seal 1 NE PR2.Seal 1
      *   |- c7    : PR1.Seal 2 NE PR2.Seal 2
      *   |- c8    : PR1.Seal 3 NE PR2.Seal 3
      *   |- c9    : PR1.Seal 4 NE PR2.Seal 4
      *   |- c10   : PR1.Seal 2 Unused NE PR2.Seal 2 Unused
      *   |- c11   : PR1.Total Load Order Weight NE PR2.Total Load Order
      *   |- c12   : PR1.Flat Amount NE PR2.Flat Amount
      *   |- c13   : PR1.Allocate Pounds/Miles NE PR2.Allocate Pounds/Mil
      *   |- c14   : PR1.Total Stops NE PR2.Total Stops
      *   |- c15   : PR1.Trailer Id NE PR2.Trailer Id
      *   |- c16   : PR1.Transloader Carrier Code NE PR2.Transloader Carr
      *   |- c17   : PR1.BOL Time NE PR2.BOL Time
      *   |- c18   : PR1.Carrier Code NE PR2.Carrier Code
      *   |- c19   : PR1.Truck Size NE PR2.Truck Size
      *   |- c20   : PR1.Ld Hdr/Ld Dtl Unused NE PR2.Ld Hdr/Ld Dtl Unused
      *   |- c21   : PR1.Rated Freight NE PR2.Rated Freight
      *   |- c22   : PR1.Ship Status NE PR2.Ship Status
      *   |- c23   : PR1.Load Type NE PR2.Load Type
      *   |- c24   : PR1.Number Pallets Received NE PR2.Number Pallets Re
      *   |- c25   : PR1.Number Pallets Loaded NE PR2.Number Pallets Load
      *   |- c26   : PR1.Load Carrier Pay Amt NE PR2.Load Carrier Pay Amt
      *   |- c27   : PR1.Estimated Arrival Time NE PR2.Estimated Arrival
      *   |- c28   : PR1.Actual Arrival Date NE PR2.Actual Arrival Date
      *   |- c29   : PR1.Actual Arrival Time NE PR2.Actual Arrival Time
      *   |- c30   : PR1.Trailer IN Weight NE PR2.Trailer IN Weight
      *   |- c31   : PR1.Trailer OUT Weight NE PR2.Trailer OUT Weight
      *   |- c32   : PR1.Actual Departure Date NE PR2.Actual Departure Da
      *   |- c33   : PR1.Departure Time NE PR2.Departure Time
      *   |- c34   : PR1.Schedule Sequence Number NE PR2.Schedule Sequenc
      *   |- c35   : PR1.Product Temperature NE PR2.Product Temperature
      *   |- c36   : PR1.Number Spacers Loaded NE PR2.Number Spacers Load
      *   |- c37   : PR1.Car/Veh. Initials NE PR2.Car/Veh. Initials
      *   |- c38   : PR1.Total Load Miles NE PR2.Total Load Miles
      *   |- c39   : PR1.Recorder ID NE PR2.Recorder ID
      *   |- c40   : PR1.Shipping Method NE PR2.Shipping Method
      *   |- c41   : PR1.Ship From Warehouse NE PR2.Ship From Warehouse
      *   |- c42   : PR1.Ship To State Code NE PR2.Ship To State Code
      *   |- c43   : PR1.Gross Weight NE PR2.Gross Weight
      *   |- c44   : PR1.Carrier Broker NE PR2.Carrier Broker
      *   |- c45   : PR1.Export Status NE PR2.Export Status
      *   '-
     C                   IF        P1AIC3 <> P2AIC3 OR
     C                             P1AODT <> P2AODT OR
     C                             P1PJST <> P2PJST OR
     C                             P1PKST <> P2PKST OR
     C                             P1RNNB <> P2RNNB OR
     C                             P1DMTX <> P2DMTX OR
     C                             P1DNTX <> P2DNTX OR
     C                             P1DOTX <> P2DOTX OR
     C                             P1WTTX <> P2WTTX OR
     C                             P1WUTX <> P2WUTX OR
     C                             P1RPNB <> P2RPNB OR
     C                             P1FLAM <> P2FLAM OR
     C                             P1XQST <> P2XQST OR
     C                             P1RRNB <> P2RRNB OR
     C                             P1DXTX <> P2DXTX OR
     C                             P1DYTX <> P2DYTX OR
     C                             P1SBNB <> P2SBNB OR
     C                             P1BZNA <> P2BZNA OR
     C                             P1RONB <> P2RONB OR
     C                             P1SQNB <> P2SQNB OR
     C                             P1R1NB <> P2R1NB OR
     C                             P1VCST <> P2VCST OR
     C                             P1VDST <> P2VDST OR
     C                             P1SDNB <> P2SDNB OR
     C                             P1PAOU <> P2PAOU OR
     C                             P1DGWG <> P2DGWG OR
     C                             P1SXNB <> P2SXNB OR
     C                             P1HADT <> P2HADT OR
     C                             P1AART <> P2AART OR
     C                             P1DHWG <> P2DHWG OR
     C                             P1DIWG <> P2DIWG OR
     C                             P1AQDT <> P2AQDT OR
     C                             P1S6NB <> P2S6NB OR
     C                             P1T4NB <> P2T4NB OR
     C                             P1PRTM <> P2PRTM OR
     C                             P1NPSV <> P2NPSV OR
     C                             P1J8TX <> P2J8TX OR
     C                             P1TLMI <> P2TLMI OR
     C                             P1J9TX <> P2J9TX OR
     C                             P1Q2CD <> P2Q2CD OR
     C                             P1VPCD <> P2VPCD OR
     C                             P1DBCD <> P2DBCD OR
     C                             P1GRWE <> P2GRWE OR
     C                             P1XCCD <> P2XCCD OR
     C                             P1U2ST <> P2U2ST
     C                   MOVEL     'Y'           YL0001                         Update Record U
     C                   END                                                    *FI
      * Update If Any Non-Key Fields Have Changed.
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6ORc7ORc8ORc9ORc10ORc11ORc12ORc13ORc14OR
      *  - c15ORc16ORc17ORc18OR c19ORc20ORc21ORc22ORc23ORc24ORc25ORc26OR
      *  - c27ORc28ORc29ORc30ORc31ORc32ORc33ORc34OR c35ORc36ORc37ORc38OR
      *  - c39ORc40ORc41ORc42ORc43ORc44ORc45
      *   |- c1    : PR1.Actual Ship Date NE PR2.Actual Ship Date
      *   |- c2    : PR1.On Time - (Y/N) NE PR2.On Time - (Y/N)
      *   |- c3    : PR1.Truck Ready Date NE PR2.Truck Ready Date
      *   |- c4    : PR1.Truck Ready Time NE PR2.Truck Ready Time
      *   |- c5    : PR1.Spotted Date NE PR2.Spotted Date
      *   |- c6    : PR1.Spotted Time NE PR2.Spotted Time
      *   |- c7    : PR1.Load Finished Date NE PR2.Load Finished Date
      *   |- c8    : PR1.Load Finished Time NE PR2.Load Finished Time
      *   |- c9    : PR1.BOL Complete Date NE PR2.BOL Complete Date
      *   |- c10   : PR1.BOL Complete Time NE PR2.BOL Complete Time
      *   |- c11   : PR1.BOL Received Date NE PR2.BOL Received Date
      *   |- c12   : PR1.BOL Received Time NE PR2.BOL Received Time
      *   |- c13   : PR1.Truck Departure Date NE PR2.Truck Departure Date
      *   |- c14   : PR1.Truck Departure Time NE PR2.Truck Departure Time
      *   |- c15   : PR1.Adjusted Departure Date NE PR2.Adjusted Departur
      *   |- c16   : PR1.Adjusted Departure Time NE PR2.Adjusted Departur
      *   |- c17   : PR1.Shipping Line NE PR2.Shipping Line
      *   |- c18   : PR1.Port Delv Terminal NE PR2.Port Delv Terminal
      *   |- c19   : PR1.Vessel Name NE PR2.Vessel Name
      *   |- c20   : PR1.Voyage NE PR2.Voyage
      *   |- c21   : PR1.Sail Date NE PR2.Sail Date
      *   |- c22   : PR1.Booking Number NE PR2.Booking Number
      *   |- c23   : PR1.Discharge Port NE PR2.Discharge Port
      *   |- c24   : PR1.Arrival Date NE PR2.Arrival Date
      *   |- c25   : PR1.Container Number NE PR2.Container Number
      *   |- c26   : PR1.Date In NE PR2.Date In
      *   |- c27   : PR1.Time In NE PR2.Time In
      *   |- c28   : PR1.Date Out NE PR2.Date Out
      *   |- c29   : PR1.Time Out NE PR2.Time Out
      *   |- c30   : PR1.Load Total Freight NE PR2.Load Total Freight
      *   |- c31   : PR1.Scheduled Delivery Date NE PR2.Scheduled Deliver
      *   |- c32   : PR1.Scheduled Delivery Time NE PR2.Scheduled Deliver
      *   |- c33   : PR1.LH Unused Sts NE PR2.LH Unused Sts
      *   |- c34   : PR1.LH Carrier Payment Sts NE PR2.LH Carrier Payment
      *   |- c35   : PR1.Bring Back Miles NE PR2.Bring Back Miles
      *   |- c36   : PR1.Requested Delivery Date NE PR2.Requested Deliver
      *   |- c37   : PR1.Load Acceptance Flag NE PR2.Load Acceptance Flag
      *   |- c38   : PR1.Warehouse Code NE PR2.Warehouse Code
      *   |- c39   : PR1.On Yard Date NE PR2.On Yard Date
      *   |- c40   : PR1.On Yard Time NE PR2.On Yard Time
      *   |- c41   : PR1.Deadline Departure Date NE PR2.Deadline Departur
      *   |- c42   : PR1.Deadline Departure Time NE PR2.Deadline Departur
      *   |- c43   : PR1.Load Held Over NE PR2.Load Held Over
      *   |- c44   : PR1.Load Held Over Reason NE PR2.Load Held Over Reas
      *   |- c45   : PR1.Load Held Over Rsn Cmt NE PR2.Load Held Over Rsn
      *   '-
     C                   IF        P1F9DT <> P2F9DT OR
     C                             P1ONTM <> P2ONTM OR
     C                             P1J4DT <> P2J4DT OR
     C                             P1TRTM <> P2TRTM OR
     C                             P1J5DT <> P2J5DT OR
     C                             P1SPTM <> P2SPTM OR
     C                             P1J6DT <> P2J6DT OR
     C                             P1LFTM <> P2LFTM OR
     C                             P1J7DT <> P2J7DT OR
     C                             P1BOTM <> P2BOTM OR
     C                             P1J8DT <> P2J8DT OR
     C                             P1BLTM <> P2BLTM OR
     C                             P1KIDT <> P2KIDT OR
     C                             P1ASTM <> P2ASTM OR
     C                             P1KADT <> P2KADT OR
     C                             P1AJCM <> P2AJCM OR
     C                             P1XACD <> P2XACD OR
     C                             P1OANA <> P2OANA OR
     C                             P1K4TX <> P2K4TX OR
     C                             P1VOAG <> P2VOAG OR
     C                             P1KBDT <> P2KBDT OR
     C                             P1NBBO <> P2NBBO OR
     C                             P1W4CD <> P2W4CD OR
     C                             P1EFDT <> P2EFDT OR
     C                             P1CNTN <> P2CNTN OR
     C                             P1KCDT <> P2KCDT OR
     C                             P1TMIN <> P2TMIN OR
     C                             P1KDDT <> P2KDDT OR
     C                             P1VMNB <> P2VMNB OR
     C                             P1OCFR <> P2OCFR OR
     C                             P1KJDT <> P2KJDT OR
     C                             P1ATTM <> P2ATTM OR
     C                             P1OTRS <> P2OTRS OR
     C                             P1RNST <> P2RNST OR
     C                             P1BRBK <> P2BRBK OR
     C                             P1EIDT <> P2EIDT OR
     C                             P1RMST <> P2RMST OR
     C                             P1AJCD <> P2AJCD OR
     C                             P1KKDT <> P2KKDT OR
     C                             P1AVTM <> P2AVTM OR
     C                             P1KZDT <> P2KZDT OR
     C                             P1AXTM <> P2AXTM OR
     C                             P1LHOS <> P2LHOS OR
     C                             P1LHOR <> P2LHOR OR
     C                             P1WNTX <> P2WNTX
     C                   MOVEL     'Y'           YL0001                         Update Record U
     C                   END                                                    *FI
      * Update If Any Non-Key Fields Have Changed.
      * CASE:
      *  - c1ORc2ORc3ORc4ORc5ORc6
      *   |- c1    : PR1.LH Unused Time 5 NE PR2.LH Unused Time 5
      *   |- c2    : PR1.LH Unused Date 6 NE PR2.LH Unused Date 6
      *   |- c3    : PR1.LH Unused Time 6 NE PR2.LH Unused Time 6
      *   |- c4    : PR1.EDI Status 1 NE PR2.EDI Status 1
      *   |- c5    : PR1.EDI Status 2 NE PR2.EDI Status 2
      *   |- c6    : PR1.EDI Status 3 NE PR2.EDI Status 3
      *   '-
     C                   IF        P1COTM <> P2COTM OR
     C                             P1P3DT <> P2P3DT OR
     C                             P1CQTM <> P2CQTM OR
     C                             P1UVST <> P2UVST OR
     C                             P1UWST <> P2UWST OR
     C                             P1UXST <> P2UXST
     C                   MOVEL     'Y'           YL0001                         Update Record U
     C                   END                                                    *FI
      * Update Record?
      * CASE: LCL.Update Record USR is Yes
      * Crt Load Header TRG   CR - Load Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                   IF        YL0001 = 'Y'
     C                   Z-ADD     P2RMNB        WL0001                         Load ID
     C                   MOVEL(P)  P3D8SC        WL0002                         LHT TRG Databas
     C                   MOVEL(P)  '0'           WL0003                         LHT Process Sta
     C                   Z-ADD     0             WL0004                         LHT Process Dat
     C                   EXSR      SACRRC
     C                   END                                                    *FI
     C                   END                                                    *FI
      * Trigger Processing for Delete Event.
      * CASE: PR3.TRG Database Event is Delete
      * Crt Load Header TRG   CR - Load Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                   IF        P3D8SC = '2'
     C                   Z-ADD     P1RMNB        WL0001                         Load ID
     C                   MOVEL(P)  P3D8SC        WL0002                         LHT TRG Databas
     C                   MOVEL(P)  '0'           WL0003                         LHT Process Sta
     C                   Z-ADD     0             WL0004                         LHT Process Dat
     C                   EXSR      SACRRC
     C                   END                                                    *FI
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SACRRC        BEGSR
      *================================================================
      * Crt Load Header TRG   CR - Load Header TRG  * 
      *================================================================
      *
     C                   MOVEL     XDTSDL        WN0001                         LHT Timestamp
      *
     C                   EVAL      W0RTN = ' '
      * Move all fields to @B2CPHO
     C                   Z-ADD     WL0001        WARMNB                         Load ID
     C                   MOVEL     WL0002        WAK9SC                         LHT TRG Databas
     C                   MOVEL     WL0003        WALASC                         LHT Process Sta
     C                   Z-ADD     WL0004        WABPDX                         LHT Process Dat
      *
      * USER: Processing before Data update
      * Set Timestamp TS#     IF
      * PAR.@Timestamp TS# = JOB.*System timestamp
     C                   EXSR      XSTMS
     C                   MOVEL     ##TMS         WAA8TS                         @Timestamp TS#
     C     KLCRSA        KLIST
     C                   KFLD                    WARMNB                         Load ID
     C                   KFLD                    WAA8TS                         LHT Timestamp
      * Check for duplicate primary key
     C     KLCRSA        SETLL     @B2CPHO                                90    *
     C                   IF        *IN90
     C                   MOVEL     'USR5191'     W0RTN
      * Send message 'Load Header TRG        EX'
     C                   MOVEL     'USR5191'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      SAEXIT
     C                   ENDIF
      *
     C                   WRITE     @B2CPHO                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   XSTMS         BEGSR
      *================================================================
      * Refresh System timestamp
      *================================================================
     C                   CALL      'Y2RTTSK'
     C                   PARM                    ##TMS                          System timestam
      *================================================================
     CSR   XSTMSE        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
      * If no message file specified, use default
     C                   IF        ZAMSGF = ' '
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WARMNB                         Load ID
     C                   MOVE(P)   '0'           XDTSDL
     C                   MOVEL     @CN(001)      XDTSDL
     C                   MOVEL     XDTSDL        WAA8TS                         LHT Timestamp
     C                   Z-ADD     *ZERO         WABPDX                         LHT Process Dat
      * Obtain default message file
     C     *DTAARA       DEFINE    CAMGFLA       ZADFMF
     C                   IN        ZADFMF
      * Dummy move for compiler
     C                   MOVE      '0'           @CN#(1)
     C                   MOVEL     'N'           W0PMT
      * Define local variables for subroutine SACRRC.
     C                   Z-ADD     *ZERO         WL0001
     C                   EVAL      WL0002 = ' '
     C                   EVAL      WL0003 = ' '
     C                   Z-ADD     *ZERO         WL0004
      * Define local work field Update Record USR
     C                   EVAL      YL0001 = ' '
      *================================================================
     CSR   ZZEXIT        ENDSR
** @CN
00001 0001-01-01-00.00.00.00000
