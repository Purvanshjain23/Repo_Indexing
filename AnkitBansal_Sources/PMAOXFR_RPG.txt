     H/TITLE Crt WF orderprodSortB XP  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 02/26/15  Time  : 09:43:36
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: WF OrderProd Schedule
      * I :  OPS Sequence No
     I                                    P   1   40P1NINY
      * I :  OPS Primal Group Code
     I                                        5  10 P1KEAA
      * I :  OPS Company Number
     I                                    P  11  120P1COC3
      * I :  OPS Warehouse
     I                                       13  15 P1KDAA
      * I :  OPS Schedule Ship Date
     I                                    P  16  190P1SPDT
      * I :  OPS Requested Ship Date
     I                                    P  20  230P1VQDT
      * I :  OPS Report Type
     I                                       24  24 P1APST
      * I :  OPS Order Number
     I                                    P  25  280P1EXC7
      * I :  OPS Load Id
     I                                    P  29  320P1NJNY
      * I :  OPS Customer Name
     I                                       33  62 P1TUT1
      * I :  OPS Load Schedule Seq #
     I                                    P  63  650P1NKNY
      * I :  OPS Deadline Depart Date
     I                                    P  66  690P1SODT
      * I :  OPS Deadline Depart Time
     I                                    P  70  730P1NLNY
      * I :  OPS Item Code
     I                                    P  74  770P1EYC7
      * I :  OPS Item Description
     I                                       78 107 P1S1NA
      * I :  OPS Quantity Ordered
     I                                    P 108 1132P1PIQT
      * O :  OPS Sort Break
     I                                      114 163 P1TWT1
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1NINY    PARM           WP0001  70       OPS Sequence No
     C           P1KEAA    PARM           WP0002  6        OPS Primal Grou
     C           P1COC3    PARM           WP0003  30       OPS Company Num
     C           P1KDAA    PARM           WP0004  3        OPS Warehouse
     C           P1SPDT    PARM           WP0005  70       OPS Schedule Sh
     C           P1VQDT    PARM           WP0006  70       OPS Requested S
     C           P1APST    PARM           WP0007  1        OPS Report Type
     C           P1EXC7    PARM           WP0008  70       OPS Order Numbe
     C           P1NJNY    PARM           WP0009  70       OPS Load Id
     C           P1TUT1    PARM           WP0010 30        OPS Customer Na
     C           P1NKNY    PARM           WP0011  50       OPS Load Schedu
     C           P1SODT    PARM           WP0012  70       OPS Deadline De
     C           P1NLNY    PARM           WP0013  60       OPS Deadline De
     C           P1EYC7    PARM           WP0014  70       OPS Item Code
     C           P1S1NA    PARM           WP0015 30        OPS Item Descri
     C           P1PIQT    PARM           WP0016 112       OPS Quantity Or
     C           P1TWT1    PARM P1TWT1    WP0017 50        OPS Sort Break
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Crt WF orderprodSortB XP
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
     C                     MOVELP1NKNY    YL0001           Ops Load Schedu
     C                     MOVEL*BLANK    YL0002           OPS Dl Depart D
     C                     MOVELP1SODT    YL0002           OPS Dl Depart D
     C                     MOVEL*BLANK    YL0003           OPS Dl Depart T
     C                     MOVELP1NLNY    YL0003           OPS Dl Depart T
     C                     MOVELP1NJNY    YL0004           OPS Load Id Alp
     C                     MOVEL*BLANK    YL0005           OPS Order Numbe
     C                     MOVELP1EXC7    YL0005           OPS Order Numbe
     C                     MOVEL*BLANK    YL0006           OPS Item Code A
     C                     MOVELP1EYC7    YL0006           OPS Item Code A
      * E3796 JJH 02/23/15 - Convert OPS Requested Ship Date to Alpha
     C                     MOVEL*BLANK    YL0007           OPS RequestedSh
     C                     MOVELP1VQDT    YL0007           OPS RequestedSh
     C                     Z-ADD1         ZQ      50
     C           YL0009    CAT  YL0007:ZQ YL0008    P      OPS Sort Break
     C                     Z-ADD1         ZQ      50
     C           YL0008    CAT  YL0010:ZQ YL0008    P      OPS Sort Break
     C                     Z-ADD1         ZQ      50
     C           YL0008    CAT  YL0011:ZQ YL0008    P      OPS Sort Break
     C                     MOVELYL0008    P1TWT1           OPS Sort Break
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * E3796 JJH 02/11/15 - Add OPS Requested Ship Date to WF OrderProd
      *  Schedule - Recompiled with no logic changes.
      * E3796 JJH 02/23/15 - Add OPS Requested Ship Date to WF OrderProd
      * - Add I Parm: OPS Requested Ship Date
      * - Replace Scheduled Ship Date with Requested Ship Date in the
      *    concatenated OPS Sort Break field.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Ops Load Schedule SeqAlUs
     C                     MOVEL*BLANK    YL0001  5
      * Define local work field OPS Dl Depart Date AlUsr
     C                     MOVEL*BLANK    YL0002  7
      * Define local work field OPS Dl Depart Time AlUsr
     C                     MOVEL*BLANK    YL0003  6
      * Define local work field OPS Load Id Alpha Usr
     C                     MOVEL*BLANK    YL0004  7
      * Define local work field OPS Order Number AlphaUsr
     C                     MOVEL*BLANK    YL0005  7
      * Define local work field OPS Item Code Alpha Usr
     C                     MOVEL*BLANK    YL0006  7
      * Define local work field OPS RequestedShipDAlphUsr
     C                     MOVEL*BLANK    YL0007  7
      * Define local work field OPS Sort Break
     C                     MOVEL*BLANK    YL0008 50
      * Define local work field OPS CoNumber Alpha Usr
     C                     MOVEL*BLANK    YL0009  3
      * Define local work field OPS Warehouse
     C                     MOVEL*BLANK    YL0010  3
      * Define local work field OPS Report Type
     C                     MOVEL*BLANK    YL0011  1
      *================================================================
     CSR         ZZEXIT    ENDSR
