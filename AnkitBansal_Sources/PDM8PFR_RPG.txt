     H/TITLE PRT Cust. Credit Hist. PF Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by  : 2E  Version:  1181
     H* Function type : Print file
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISLBUSE
     H* Date          : 09/06/07  Time  : 16:30:26
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FCABBRELDIF  E           K        DISK
      * RSQ : Customer                  RSQ By Name, Ship #
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FARBCREL1IF  E           K        DISK
      * RTV : A/R Summary               Retrieval index       NV
      *
     FARBCREL5IF  E           K        DISK
      * RSQ : A/R Summary               RSQ Cust/Company       N
      *
     FPDM8PFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: PRT Cust. Credit Hist. PF Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L3         3  1
     E                    #L7         7  1
     I@BBREE9
      * Customer                  Retrieval index       NV
      * Renamed input format fields
     I              BBBKC7                          WABKC7
     I              BBAYTX                          WAAYTX
     I              BBACNA                          WAACNA
     I              BBADNA                          WAADNA
     I              BBAENA                          WAAENA
     I              BBAJNA                          WAAJNA
     I              BBBGCD                          WABGCD
     I              BBG5CD                          WAG5CD
     I              BBBTTX                          WABTTX
     I              BBBVTX                          WABVTX
     I              BBBWTX                          WABWTX
     I              BBABTX                          WAABTX
     I              BBA2NA                          WAA2NA
     I              BBCBST                          WACBST
     I              BBB0NA                          WAB0NA
     I              BBP3NB                          WAP3NB
     I              BBAXNA                          WAAXNA
     I              BBI6DT                          WAI6DT
     I              BBAYDT                          WAAYDT
     I              BBANC7                          WAANC7
     I              BBBTC7                          WABTC7
     I              BBK6ST                          WAK6ST
     I              BBUZST                          WAUZST
     I              BBKXCD                          WAKXCD
     I              BBLTCD                          WALTCD
     I              BBQNST                          WAQNST
     I              BBS2NB                          WAS2NB
     I              BBVHVA                          WAVHVA
     I              BBI7DT                          WAI7DT
     I              BBRJST                          WARJST
     I              BBRKST                          WARKST
     I              BBQWST                          WAQWST
     I              BBQXST                          WAQXST
     I              BBQYST                          WAQYST
     I              BBUNCS                          WAUNCS
     I              BBUVST                          WAUVST
     I              BBUWST                          WAUWST
     I              BBUXST                          WAUXST
     I              BBVSST                          WAVSST
     I              BBAATM                          WAAATM
     I              BBAYNA                          WAAYNA
     I              BBA0NA                          WAA0NA
     I              BBAXDT                          WAAXDT
      *
     I@BCREEC
      * A/R Summary               RSQ Cust/Company       N
      * Renamed input format fields
     I              BCAIC3                          WBAIC3
     I              BCANC7                          WBANC7
     I              BCAGVA                          WBAGVA
     I              BCACVA                          WBACVA
     I              BCADVA                          WBADVA
     I              BCAEVA                          WBAEVA
     I              BCAFVA                          WBAFVA
     I              BCAHVA                          WBAHVA
     I              BCVIVA                          WBVIVA
     I              BCVJVA                          WBVJVA
     I              BCVKVA                          WBVKVA
     I              BCVLVA                          WBVLVA
     I              BCVMVA                          WBVMVA
     I              BCVNVA                          WBVNVA
     I              BCEEVA                          WBEEVA
     I              BCAKTM                          WBAKTM
     I              BCAHDT                          WBAHDT
     I              BCANDT                          WBANDT
     I              BCANVA                          WBANVA
     I              BCALDT                          WBALDT
     I              BCAMVA                          WBAMVA
     I              BCAIDT                          WBAIDT
     I              BCALVA                          WBALVA
     I              BCDJNB                          WBDJNB
     I              BCDLNB                          WBDLNB
     I              BCDDNB                          WBDDNB
     I              BCDMNB                          WBDMNB
     I              BCDUDT                          WBDUDT
     I              BCLYNO                          WBLYNO
     I              BCLYNC                          WBLYNC
     I              BCLYNP                          WBLYNP
     I              BCLYNI                          WBLYNI
     I              BCADPM                          WBADPM
     I              BCVOVA                          WBVOVA
     I              BCBTDY                          WBBTDY
     I              BCBUDY                          WBBUDY
     I              BCVPVA                          WBVPVA
     I              BCVQVA                          WBVQVA
     I              BCBCCD                          WBBCCD
     I              BCR4CD                          WBR4CD
     I              BCCUMO                          WBCUMO
     I              BCUVST                          WBUVST
     I              BCUWST                          WBUWST
     I              BCUXST                          WBUXST
     I              BCAATM                          WBAATM
     I              BCAYNA                          WBAYNA
     I              BCA0NA                          WBA0NA
     I              BCAXDT                          WBAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: A/R Summary
      * I : MAP Company Number
     I                                    P   1   20P1AIC3
      * N :  Value of Open Orders
     I                                    P   3   82P1EEVA
      * N :  Date of First Shipment
     I                                    P   9  120P1AHDT
      * N :  Date of Last Shipment
     I                                    P  13  160P1ANDT
      * N :  Amount of Highest A/R Bal
     I                                    P  17  222P1ALVA
      * N :  Number of Payments
     I                                    P  23  250P1DMNB
      * N :  Last YTD Nbr of Payments
     I                                    P  26  280P1LYNP
      * N :  MTD Invoices Paid
     I                                    P  29  310P1ADPM
      * N :  YTD Invoices Paid
     I                                    P  32  340P1VOVA
      * N :  MTD Days Paid
     I                                    P  35  370P1BTDY
      * N :  YTD Days Paid
     I                                    P  38  400P1BUDY
      * N :  YTD Sales Invoiced
     I                                    P  41  462P1VPVA
      * N :  Last Year Sales Invoiced
     I                                    P  47  522P1VQVA
     IP2PARM      DS
      * I :  Record Status
     I                                        1   1 P2VSST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P2VSST    PARM           WP0002  1        Record Status
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PRT Cust. Credit Hist. PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$JENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * PRT Cust. Credit Hist. PF: Mainline
      *================================================================
      * Establish starting position
     C           *LOVAL    SETLL@BBREJU                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
      * USER: Null report processing
      * CLC Set for Null Rpt   US - /UT User Source  * 
     C                     MOVEL'Y'       W0AP1P
     C                     MOVEL'Y'       W0NEWP
     C                     MOVEL'Y'       WUGGST           USR Display fie
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Customer Name
     C                     MOVEL'Y'       W0AL01  1        Ship To Custome
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $I               USR Total Numbe
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDBBBKC7    $DBKC7           Ship To Custome
     C                     MOVELBBAYTX    $DAYTX           Customer Name
     C                     Z-ADDBBBTC7    $DBTC7           Parent Customer
     C                     Z-ADDBBS2NB    $DS2NB           Parent Credit L
     C                     Z-ADDBBVHVA    $DVHVA           A/R Credit Limi
      * Load related totals format
     C                     MOVELBBAYTX    $HAYTX           Customer Name
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDBBBKC7    $EBKC7           Ship To Custome
     C                     MOVELBBAYTX    $EAYTX           Customer Name
     C                     MOVELBBACNA    $EACNA           Address Line 1
     C                     MOVELBBADNA    $EADNA           Address Line 2
     C                     MOVELBBAENA    $EAENA           Address Line 3
     C                     MOVELBBAJNA    $EAJNA           City
     C                     MOVELBBBGCD    $EBGCD           State Code
     C                     MOVELBBG5CD    $EG5CD           County Code
     C                     MOVELBBBTTX    $EBTTX           Zip/Postal Code
     C                     MOVELBBBVTX    $EBVTX           Telephone Numbe
     C                     MOVELBBBWTX    $EBWTX           Fax Number FF
     C                     MOVELBBABTX    $EABTX           Alpha Search
     C                     MOVELBBA2NA    $EA2NA           Federal Tax Id.
     C                     MOVELBBCBST    $ECBST           New Customer St
     C                     MOVELBBB0NA    $EB0NA           SIC Number
     C                     Z-ADDBBP3NB    $EP3NB           D & B Number
     C                     MOVELBBAXNA    $EAXNA           D & B Rating
     C                     Z-ADDBBI6DT    $EI6DT           Date of D & B R
     C                     Z-ADDBBAYDT    $EAYDT           Credit Line Exp
     C                     Z-ADDBBANC7    $EANC7           A/R Customer Nu
     C                     Z-ADDBBBTC7    $EBTC7           Parent Customer
     C                     MOVEL*BLANK    $EK2TX           USR Parent Name
     C                     MOVELBBK6ST    $EK6ST           Credit Check A/
     C                     MOVELBBUZST    $EUZST           Credit Check Pa
     C                     MOVELBBKXCD    $EKXCD           Country Code
     C                     MOVELBBLTCD    $ELTCD           EDI Invoice Sts
     C                     MOVELBBQNST    $EQNST           Order Entry Hol
     C                     Z-ADDBBS2NB    $ES2NB           Parent Credit L
     C                     Z-ADDBBVHVA    $EVHVA           A/R Credit Limi
     C                     MOVEL*BLANK    $EIXTX           Condition Name
     C                     MOVEL*BLANK    $EKOTX           Hold Descriptio
     C                     Z-ADDBBI7DT    $EI7DT           Order Entry Hol
     C                     MOVELBBRJST    $ERJST           Ship To Custome
     C                     MOVELBBRKST    $ERKST           Secured Terms F
     C                     MOVELBBQWST    $EQWST           Email When Orde
     C                     MOVELBBQXST    $EQXST           Print Invoice S
     C                     MOVELBBQYST    $EQYST           Item Reference
     C                     MOVELBBUNCS    $EUNCS           Statement Print
     C                     MOVELBBUVST    $EUVST           EDI Status 1
     C                     MOVELBBUWST    $EUWST           EDI Status 2
     C                     MOVELBBUXST    $EUXST           EDI Status 3
     C                     MOVELBBVSST    $EVSST           Record Status
     C                     Z-ADDBBAATM    $EAATM           Job Time
     C                     MOVELBBAYNA    $EAYNA           User Id
     C                     MOVELBBA0NA    $EA0NA           Job Name
     C                     Z-ADDBBAXDT    $EAXDT           Job Date
      * Load related totals format
     C                     Z-ADDBBBKC7    $GBKC7           Ship To Custome
     C                     MOVELBBAYTX    $GAYTX           Customer Name
     C                     MOVELBBACNA    $GACNA           Address Line 1
     C                     MOVELBBADNA    $GADNA           Address Line 2
     C                     MOVELBBAENA    $GAENA           Address Line 3
     C                     MOVELBBAJNA    $GAJNA           City
     C                     MOVELBBBGCD    $GBGCD           State Code
     C                     MOVELBBG5CD    $GG5CD           County Code
     C                     MOVELBBBTTX    $GBTTX           Zip/Postal Code
     C                     MOVELBBBVTX    $GBVTX           Telephone Numbe
     C                     MOVELBBBWTX    $GBWTX           Fax Number FF
     C                     MOVELBBABTX    $GABTX           Alpha Search
     C                     MOVELBBA2NA    $GA2NA           Federal Tax Id.
     C                     MOVELBBCBST    $GCBST           New Customer St
     C                     MOVELBBB0NA    $GB0NA           SIC Number
     C                     Z-ADDBBP3NB    $GP3NB           D & B Number
     C                     MOVELBBAXNA    $GAXNA           D & B Rating
     C                     Z-ADDBBI6DT    $GI6DT           Date of D & B R
     C                     Z-ADDBBAYDT    $GAYDT           Credit Line Exp
     C                     Z-ADDBBANC7    $GANC7           A/R Customer Nu
     C                     Z-ADDBBBTC7    $GBTC7           Parent Customer
     C                     MOVELBBK6ST    $GK6ST           Credit Check A/
     C                     MOVELBBUZST    $GUZST           Credit Check Pa
     C                     MOVELBBKXCD    $GKXCD           Country Code
     C                     MOVELBBLTCD    $GLTCD           EDI Invoice Sts
     C                     MOVELBBQNST    $GQNST           Order Entry Hol
     C                     Z-ADDBBS2NB    $GS2NB           Parent Credit L
     C                     Z-ADDBBVHVA    $GVHVA           A/R Credit Limi
     C                     Z-ADDBBI7DT    $GI7DT           Order Entry Hol
     C                     MOVELBBRJST    $GRJST           Ship To Custome
     C                     MOVELBBRKST    $GRKST           Secured Terms F
     C                     MOVELBBQWST    $GQWST           Email When Orde
     C                     MOVELBBQXST    $GQXST           Print Invoice S
     C                     MOVELBBQYST    $GQYST           Item Reference
     C                     MOVELBBUNCS    $GUNCS           Statement Print
     C                     MOVELBBUVST    $GUVST           EDI Status 1
     C                     MOVELBBUWST    $GUWST           EDI Status 2
     C                     MOVELBBUXST    $GUXST           EDI Status 3
     C                     MOVELBBVSST    $GVSST           Record Status
     C                     Z-ADDBBAATM    $GAATM           Job Time
     C                     MOVELBBAYNA    $GAYNA           User Id
     C                     MOVELBBA0NA    $GA0NA           Job Name
     C                     Z-ADDBBAXDT    $GAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADD*ZERO     $FAHDT           Date of First S
     C                     Z-ADD*ZERO     $FANDT           Date of Last Sh
     C                     Z-ADD*ZERO     $FXADT           Last Shipment D
     C                     Z-ADD*ZERO     $FALVA           Amount of Highe
     C                     Z-ADD*ZERO     $FEJPC           MTD Avg Days to
     C                     Z-ADD*ZERO     $FEKPC           YTD Avg Days to
     C                     Z-ADD*ZERO     $FDMNB           Number of Payme
     C                     Z-ADD*ZERO     $FELPC           MTD Avg Days to
     C                     Z-ADD*ZERO     $FVOVA           YTD Invoices Pa
     C                     Z-ADD*ZERO     $FEMPC           YTD Avg Days to
     C                     Z-ADD*ZERO     $FLYNP           Last YTD Nbr of
     C                     Z-ADD*ZERO     $FVPVA           YTD Sales Invoi
     C                     Z-ADD*ZERO     $FVQVA           Last Year Sales
     C                     Z-ADDBBBKC7    $FBKC7           Ship To Custome
     C                     MOVELBBAYTX    $FAYTX           Customer Name
     C                     MOVELBBACNA    $FACNA           Address Line 1
     C                     MOVELBBADNA    $FADNA           Address Line 2
     C                     MOVELBBAENA    $FAENA           Address Line 3
     C                     MOVELBBAJNA    $FAJNA           City
     C                     MOVELBBBGCD    $FBGCD           State Code
     C                     MOVELBBG5CD    $FG5CD           County Code
     C                     MOVELBBBTTX    $FBTTX           Zip/Postal Code
     C                     MOVELBBBVTX    $FBVTX           Telephone Numbe
     C                     MOVELBBBWTX    $FBWTX           Fax Number FF
     C                     MOVELBBABTX    $FABTX           Alpha Search
     C                     MOVELBBA2NA    $FA2NA           Federal Tax Id.
     C                     MOVELBBCBST    $FCBST           New Customer St
     C                     MOVELBBB0NA    $FB0NA           SIC Number
     C                     Z-ADDBBP3NB    $FP3NB           D & B Number
     C                     MOVELBBAXNA    $FAXNA           D & B Rating
     C                     Z-ADDBBI6DT    $FI6DT           Date of D & B R
     C                     Z-ADDBBAYDT    $FAYDT           Credit Line Exp
     C                     Z-ADDBBANC7    $FANC7           A/R Customer Nu
     C                     Z-ADDBBBTC7    $FBTC7           Parent Customer
     C                     MOVELBBK6ST    $FK6ST           Credit Check A/
     C                     MOVELBBUZST    $FUZST           Credit Check Pa
     C                     MOVELBBKXCD    $FKXCD           Country Code
     C                     MOVELBBLTCD    $FLTCD           EDI Invoice Sts
     C                     MOVELBBQNST    $FQNST           Order Entry Hol
     C                     Z-ADDBBS2NB    $FS2NB           Parent Credit L
     C                     Z-ADDBBVHVA    $FVHVA           A/R Credit Limi
     C                     Z-ADDBBI7DT    $FI7DT           Order Entry Hol
     C                     MOVELBBRJST    $FRJST           Ship To Custome
     C                     MOVELBBRKST    $FRKST           Secured Terms F
     C                     MOVELBBQWST    $FQWST           Email When Orde
     C                     MOVELBBQXST    $FQXST           Print Invoice S
     C                     MOVELBBQYST    $FQYST           Item Reference
     C                     MOVELBBUNCS    $FUNCS           Statement Print
     C                     MOVELBBUVST    $FUVST           EDI Status 1
     C                     MOVELBBUWST    $FUWST           EDI Status 2
     C                     MOVELBBUXST    $FUXST           EDI Status 3
     C                     MOVELBBVSST    $FVSST           Record Status
     C                     Z-ADDBBAATM    $FAATM           Job Time
     C                     MOVELBBAYNA    $FAYNA           User Id
     C                     MOVELBBA0NA    $FA0NA           Job Name
     C                     Z-ADDBBAXDT    $FAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN BBAYTX    WZA001           Customer Name
     C                     MOVELBBAYTX    WZA001
     C           *LIKE     DEFN BBBKC7    WZA002           Ship To Custome
     C                     Z-ADDBBBKC7    WZA002
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C                     READ @BBREJU                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * CASE: DB1.Ship To Customer EQ DB1.A/R Customer Number
     C           BBBKC7    IFEQ BBANC7                     *IF
      * ** Check for Co#.                               9/06/2007 LJB FP1
      * CASE: PAR.Company Number is not equal to zero
     C           P1AIC3    IFNE *ZERO                      *IF
      * ** Retrieve for one company (co# is not zeros). 9/06/2007 LJB FP1
      * RTV Credit Info        RT - A/R Summary  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0005           Company Number
     C                     Z-ADDBBANC7    WL0006           A/R Customer Nu
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0007    P1EEVA           Value of Open O
     C                     Z-ADDWL0008    P1AHDT           Date of First S
     C                     Z-ADDWL0009    P1ANDT           Date of Last Sh
     C                     Z-ADDWL0010    P1ALVA           Amount of Highe
     C                     Z-ADDWL0011    P1DMNB           Number of Payme
     C                     Z-ADDWL0012    P1LYNP           Last YTD Nbr of
     C                     Z-ADDWL0013    P1ADPM           MTD Invoices Pa
     C                     Z-ADDWL0014    P1VOVA           YTD Invoices Pa
     C                     Z-ADDWL0015    P1BTDY           MTD Days Paid
     C                     Z-ADDWL0016    P1BUDY           YTD Days Paid
     C                     Z-ADDWL0017    P1VPVA           YTD Sales Invoi
     C                     Z-ADDWL0018    P1VQVA           Last Year Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Retrieve for all companies (co# is zeros).   9/06/2007 LJB FP1
      * RTV Credit Info-Custmr RT - A/R Summary  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0019           Company Number
     C                     Z-ADDBBANC7    WL0020           A/R Customer Nu
     C                     Z-ADDYL0001    WL0021           Age $ Due - Cur
     C                     Z-ADDYL0002    WL0022           Age $ Due - Agi
     C                     Z-ADDYL0003    WL0023           Age $ Due - Agi
     C                     Z-ADDYL0004    WL0024           Age $ Due - Agi
     C                     Z-ADDYL0005    WL0025           Age $ Due - Agi
     C                     Z-ADDYL0006    WL0026           Age $ Due - Agi
     C                     Z-ADDYL0007    WL0027           Age $ Due-Curre
     C                     Z-ADDYL0008    WL0028           Age $ Due-Aging
     C                     Z-ADDYL0009    WL0029           Age $ Due-Aging
     C                     Z-ADDYL0010    WL0030           Age $ Due-Aging
     C                     Z-ADDYL0011    WL0031           Age $ Due-Aging
     C                     Z-ADDYL0012    WL0032           Age $ Due-Aging
     C                     Z-ADDP1EEVA    WL0033           Value of Open O
     C                     Z-ADDYL0013    WL0034           Time of Last Ag
     C                     Z-ADDP1AHDT    WL0035           Date of First S
     C                     Z-ADDP1ANDT    WL0036           Date of Last Sh
     C                     Z-ADDYL0014    WL0037           Amount of Last
     C                     Z-ADDYL0015    WL0038           Date of Last Pa
     C                     Z-ADDYL0016    WL0039           Amount of Last
     C                     Z-ADDYL0017    WL0040           Date of Highest
     C                     Z-ADDP1ALVA    WL0041           Amount of Highe
     C                     Z-ADDYL0018    WL0042           Number of Invoi
     C                     Z-ADDYL0019    WL0043           Number of Order
     C                     Z-ADDYL0020    WL0044           Number of Credi
     C                     Z-ADDP1DMNB    WL0045           Number of Payme
     C                     Z-ADDYL0021    WL0046           Date of Last Ag
     C                     Z-ADDYL0022    WL0047           Last YTD Nbr of
     C                     Z-ADDYL0023    WL0048           Last YTD Nbr of
     C                     Z-ADDP1LYNP    WL0049           Last YTD Nbr of
     C                     Z-ADDYL0024    WL0050           Last YTD Nbr of
     C                     Z-ADDP1ADPM    WL0051           MTD Invoices Pa
     C                     Z-ADDP1VOVA    WL0052           YTD Invoices Pa
     C                     Z-ADDP1BTDY    WL0053           MTD Days Paid
     C                     Z-ADDP1BUDY    WL0054           YTD Days Paid
     C                     Z-ADDP1VPVA    WL0055           YTD Sales Invoi
     C                     Z-ADDP1VQVA    WL0056           Last Year Sales
     C                     Z-ADDYL0025    WL0057           Current Month
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0021    YL0001           Age $ Due - Cur
     C                     Z-ADDWL0022    YL0002           Age $ Due - Agi
     C                     Z-ADDWL0023    YL0003           Age $ Due - Agi
     C                     Z-ADDWL0024    YL0004           Age $ Due - Agi
     C                     Z-ADDWL0025    YL0005           Age $ Due - Agi
     C                     Z-ADDWL0026    YL0006           Age $ Due - Agi
     C                     Z-ADDWL0027    YL0007           Age $ Due-Curre
     C                     Z-ADDWL0028    YL0008           Age $ Due-Aging
     C                     Z-ADDWL0029    YL0009           Age $ Due-Aging
     C                     Z-ADDWL0030    YL0010           Age $ Due-Aging
     C                     Z-ADDWL0031    YL0011           Age $ Due-Aging
     C                     Z-ADDWL0032    YL0012           Age $ Due-Aging
     C                     Z-ADDWL0033    P1EEVA           Value of Open O
     C                     Z-ADDWL0034    YL0013           Time of Last Ag
     C                     Z-ADDWL0035    P1AHDT           Date of First S
     C                     Z-ADDWL0036    P1ANDT           Date of Last Sh
     C                     Z-ADDWL0037    YL0014           Amount of Last
     C                     Z-ADDWL0038    YL0015           Date of Last Pa
     C                     Z-ADDWL0039    YL0016           Amount of Last
     C                     Z-ADDWL0040    YL0017           Date of Highest
     C                     Z-ADDWL0041    P1ALVA           Amount of Highe
     C                     Z-ADDWL0042    YL0018           Number of Invoi
     C                     Z-ADDWL0043    YL0019           Number of Order
     C                     Z-ADDWL0044    YL0020           Number of Credi
     C                     Z-ADDWL0045    P1DMNB           Number of Payme
     C                     Z-ADDWL0046    YL0021           Date of Last Ag
     C                     Z-ADDWL0047    YL0022           Last YTD Nbr of
     C                     Z-ADDWL0048    YL0023           Last YTD Nbr of
     C                     Z-ADDWL0049    P1LYNP           Last YTD Nbr of
     C                     Z-ADDWL0050    YL0024           Last YTD Nbr of
     C                     Z-ADDWL0051    P1ADPM           MTD Invoices Pa
     C                     Z-ADDWL0052    P1VOVA           YTD Invoices Pa
     C                     Z-ADDWL0053    P1BTDY           MTD Days Paid
     C                     Z-ADDWL0054    P1BUDY           YTD Days Paid
     C                     Z-ADDWL0055    P1VPVA           YTD Sales Invoi
     C                     Z-ADDWL0056    P1VQVA           Last Year Sales
     C                     Z-ADDWL0057    YL0025           Current Month
     C                     END                             *FI
      * ** check record status if record exists
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * Select Record Status                 8/26/02  RMC
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Record Status is Valid Entries
      *   |- c2    : PAR.Record Status NE DB1.Record Status
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2VSST    IFEQ 'A'                        *IF
     C           P2VSST    OREQ 'D'
     C           P2VSST    OREQ 'I'
     C           P2VSST    IFNE BBVSST                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Customer Name
     C                     MOVEL*BLANK    W0AL01  1        Ship To Custome
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Customer Name
     C                     MOVEL'Y'       W0AL01  1        Ship To Custome
     C                     ELSE
      * Next record - Detect level breaks
     C           BBAYTX    IFNE WZA001                     Customer Name
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           BBBKC7    IFNE WZA002                     Ship To Custome
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL01    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$GKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 1
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$HKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of final totals format
     C                     Z-ADDWU        $I               USR Total Numbe
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$IFINTTL
     C                     END
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of PRT Cust. Credit Hist. PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of PRT Cust. Credit Hist. PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of first page format
      * ** Move all 1pg to top format              09/06/2007 LJB FP1122
     C           W0PFM     IFEQ 'Y'
     C                     MOVEL'0'       *IN79
     C           WUGGST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$C1STPAG
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Customer Name of PRT Cust. Credit Hist. PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$DKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print Ship To Customer of PRT Cust. Credit Hist. PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Ship To Customer format
      * IF DELETED AND INACTIVE
      * CASE: DB1.Record Status is Deleted & Inactive
     C           BBVSST    IFEQ 'D'                        *IF
     C           BBVSST    OREQ 'I'
      * CUR.Condition Name 10 USR = Condition name of DB1.Record Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1255478   Y2LSNO  70       List number
     C                     PARM BBVSST    W0INVL 25        Record Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $EIXTX    PARM           W0CNNM 25        Condition Name
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $EIXTX           Condition Name
     C                     END                             *FI
      * RTV Customer Name      RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$EBTC7    WL0003           Ship To Custome
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    $EK2TX    P      Customer Name
      * RTV Customer Name      RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$EBKC7    WL0003           Ship To Custome
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    WUAYTX    P      Customer Name
      * ORDER ENTRY HOLD  Y/N
      * CASE: DB1.Order Entry Hold is New Order Hold
     C           BBQNST    IFEQ 'Y'                        *IF
     C                     MOVEL'*Hold*'  $EKOTX           Hold Descriptio
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $EKOTX           Hold Descriptio
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Ship To Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $EBKC7    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$EBKC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VEBKC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VEBKC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Parent Customer to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $EBTC7    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$EBTC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VEBTC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VEBTC7           CD7 Ext Numeric
     C                     END                             *FI
      * Print format
     C                     WRITE$EKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print detail line. of PRT Cust. Credit Hist. PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * ** 09/06/2007 LJB FP1122 - Calc report fields based on whether
      * ** all companies or just one company is being processed.
      * ** Process for single company or for all companies
      * CASE: PAR.Company Number is not equal to zero
     C           P1AIC3    IFNE *ZERO                      *IF
      * RTV Credit Info        RT - A/R Summary  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0005           Company Number
     C                     Z-ADD$FANC7    WL0006           A/R Customer Nu
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0007    P1EEVA           Value of Open O
     C                     Z-ADDWL0008    $FAHDT           Date of First S
     C                     Z-ADDWL0009    $FANDT           Date of Last Sh
     C                     Z-ADDWL0010    $FALVA           Amount of Highe
     C                     Z-ADDWL0011    $FDMNB           Number of Payme
     C                     Z-ADDWL0012    $FLYNP           Last YTD Nbr of
     C                     Z-ADDWL0013    P1ADPM           MTD Invoices Pa
     C                     Z-ADDWL0014    P1VOVA           YTD Invoices Pa
     C                     Z-ADDWL0015    P1BTDY           MTD Days Paid
     C                     Z-ADDWL0016    P1BUDY           YTD Days Paid
     C                     Z-ADDWL0017    $FVPVA           YTD Sales Invoi
     C                     Z-ADDWL0018    $FVQVA           Last Year Sales
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Credit Info-Custmr RT - A/R Summary  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0019           Company Number
     C                     Z-ADD$FANC7    WL0020           A/R Customer Nu
     C                     Z-ADDYL0001    WL0021           Age $ Due - Cur
     C                     Z-ADDYL0002    WL0022           Age $ Due - Agi
     C                     Z-ADDYL0003    WL0023           Age $ Due - Agi
     C                     Z-ADDYL0004    WL0024           Age $ Due - Agi
     C                     Z-ADDYL0005    WL0025           Age $ Due - Agi
     C                     Z-ADDYL0006    WL0026           Age $ Due - Agi
     C                     Z-ADDYL0007    WL0027           Age $ Due-Curre
     C                     Z-ADDYL0008    WL0028           Age $ Due-Aging
     C                     Z-ADDYL0009    WL0029           Age $ Due-Aging
     C                     Z-ADDYL0010    WL0030           Age $ Due-Aging
     C                     Z-ADDYL0011    WL0031           Age $ Due-Aging
     C                     Z-ADDYL0012    WL0032           Age $ Due-Aging
     C                     Z-ADDP1EEVA    WL0033           Value of Open O
     C                     Z-ADDYL0013    WL0034           Time of Last Ag
     C                     Z-ADD$FAHDT    WL0035           Date of First S
     C                     Z-ADD$FANDT    WL0036           Date of Last Sh
     C                     Z-ADDYL0014    WL0037           Amount of Last
     C                     Z-ADDYL0015    WL0038           Date of Last Pa
     C                     Z-ADDYL0016    WL0039           Amount of Last
     C                     Z-ADDYL0017    WL0040           Date of Highest
     C                     Z-ADD$FALVA    WL0041           Amount of Highe
     C                     Z-ADDYL0018    WL0042           Number of Invoi
     C                     Z-ADDYL0019    WL0043           Number of Order
     C                     Z-ADDYL0020    WL0044           Number of Credi
     C                     Z-ADD$FDMNB    WL0045           Number of Payme
     C                     Z-ADDYL0021    WL0046           Date of Last Ag
     C                     Z-ADDYL0022    WL0047           Last YTD Nbr of
     C                     Z-ADDYL0023    WL0048           Last YTD Nbr of
     C                     Z-ADD$FLYNP    WL0049           Last YTD Nbr of
     C                     Z-ADDYL0024    WL0050           Last YTD Nbr of
     C                     Z-ADDP1ADPM    WL0051           MTD Invoices Pa
     C                     Z-ADDP1VOVA    WL0052           YTD Invoices Pa
     C                     Z-ADDP1BTDY    WL0053           MTD Days Paid
     C                     Z-ADDP1BUDY    WL0054           YTD Days Paid
     C                     Z-ADD$FVPVA    WL0055           YTD Sales Invoi
     C                     Z-ADD$FVQVA    WL0056           Last Year Sales
     C                     Z-ADDYL0025    WL0057           Current Month
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0021    YL0001           Age $ Due - Cur
     C                     Z-ADDWL0022    YL0002           Age $ Due - Agi
     C                     Z-ADDWL0023    YL0003           Age $ Due - Agi
     C                     Z-ADDWL0024    YL0004           Age $ Due - Agi
     C                     Z-ADDWL0025    YL0005           Age $ Due - Agi
     C                     Z-ADDWL0026    YL0006           Age $ Due - Agi
     C                     Z-ADDWL0027    YL0007           Age $ Due-Curre
     C                     Z-ADDWL0028    YL0008           Age $ Due-Aging
     C                     Z-ADDWL0029    YL0009           Age $ Due-Aging
     C                     Z-ADDWL0030    YL0010           Age $ Due-Aging
     C                     Z-ADDWL0031    YL0011           Age $ Due-Aging
     C                     Z-ADDWL0032    YL0012           Age $ Due-Aging
     C                     Z-ADDWL0033    P1EEVA           Value of Open O
     C                     Z-ADDWL0034    YL0013           Time of Last Ag
     C                     Z-ADDWL0035    $FAHDT           Date of First S
     C                     Z-ADDWL0036    $FANDT           Date of Last Sh
     C                     Z-ADDWL0037    YL0014           Amount of Last
     C                     Z-ADDWL0038    YL0015           Date of Last Pa
     C                     Z-ADDWL0039    YL0016           Amount of Last
     C                     Z-ADDWL0040    YL0017           Date of Highest
     C                     Z-ADDWL0041    $FALVA           Amount of Highe
     C                     Z-ADDWL0042    YL0018           Number of Invoi
     C                     Z-ADDWL0043    YL0019           Number of Order
     C                     Z-ADDWL0044    YL0020           Number of Credi
     C                     Z-ADDWL0045    $FDMNB           Number of Payme
     C                     Z-ADDWL0046    YL0021           Date of Last Ag
     C                     Z-ADDWL0047    YL0022           Last YTD Nbr of
     C                     Z-ADDWL0048    YL0023           Last YTD Nbr of
     C                     Z-ADDWL0049    $FLYNP           Last YTD Nbr of
     C                     Z-ADDWL0050    YL0024           Last YTD Nbr of
     C                     Z-ADDWL0051    P1ADPM           MTD Invoices Pa
     C                     Z-ADDWL0052    P1VOVA           YTD Invoices Pa
     C                     Z-ADDWL0053    P1BTDY           MTD Days Paid
     C                     Z-ADDWL0054    P1BUDY           YTD Days Paid
     C                     Z-ADDWL0055    $FVPVA           YTD Sales Invoi
     C                     Z-ADDWL0056    $FVQVA           Last Year Sales
     C                     Z-ADDWL0057    YL0025           Current Month
     C                     END                             *FI
      * CLC Avg Days to Pay    XF - A/R Summary  * 
     C                     CALL 'PDNAXFR'              90  CLC Avg Days to
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1ADPM    WQ0001  50       MTD Invoices Pa
     C                     PARM P1VOVA    WQ0002  50       YTD Invoices Pa
     C                     PARM P1BTDY    WQ0003  50       MTD Days Paid
     C                     PARM P1BUDY    WQ0004  50       YTD Days Paid
     C           $FEJPC    PARM *ZERO     WQ0005  52       MTD Avg Days to
     C           $FEKPC    PARM *ZERO     WQ0006  52       YTD Avg Days to
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDNAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ADD  1         WU               USR Total Numbe
     C                     MOVEL'N'       WUQKST           Display Flag
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Date of First Shipment to display format
      * Convert date
     C           1000000   ADD  $FAHDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VFAHDT
      * Convert Date of Last Shipment to display format
      * Convert date
     C           1000000   ADD  $FANDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VFANDT
      * Convert Credit Line Expire Date to display format
      * Convert date
     C           1000000   ADD  $FAYDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VFAYDT
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$FCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$FDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of PRT Cust. Credit Hist. PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * Customer Name of PRT Cust. Credit Hist. PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Ship To Customer of PRT Cust. Credit Hist. PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * detail line. of PRT Cust. Credit Hist. PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
     C                     Z-ADDP1AIC3    $BAIC3           Company Number
      * ** *All or Company Name                      9/06/2007 LJB FP1122
      * CASE: PAR.Company Number is Equal to zero
     C           P1AIC3    IFEQ *ZERO                      *IF
     C                     MOVEL*BLANK    $BADTX           Name
     C                     MOVEL'*All'    $BADTX           Name
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$BAIC3    WL0001           Company Number
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    $BADTX    P      Name
     C                     END                             *FI
     C                     MOVELP2VSST    $BVSST           Record Status
      * ** *All or Record Status name
      * CASE: TOP.Record Status is *blank
     C           $BVSST    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $BHLTX           Condition Desc.
     C                     MOVEL'*All'    $BHLTX           Condition Desc.
     C                     ELSE
      * CASE: *OTHERWISE
      * TOP.Condition Desc. 1  USR = Condition name of TOP.Record Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1255478   Y2LSNO  70       List number
     C                     PARM $BVSST    W0INVL 25        Record Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BHLTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     END                             *FI
      * Convert fields to external form
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $BAIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$BAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VBAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBAIC3           CD3 Ext Numeric
     C                     END                             *FI
     C                     MOVEL'0'       *IN79
     C           WUQKST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSA01           Application Cod
     C                     MOVEL'A/R'     WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0001    ABAIC3           Company Number
      * Establish starting position
     C           KRSSC     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Name
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    WL0002           Name
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Customer Name      RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WABKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0003    WABKC7           Ship To Custome
      * Establish starting position
     C           KRSSD     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0004           Customer Name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAAYTX    WL0004           Customer Name
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Credit Info        RT - A/R Summary  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           BCAIC3           Company Number
     C                     KFLD           BCANC7           A/R Customer Nu
      * Setup key
     C                     Z-ADDWL0005    BCAIC3           Company Number
     C                     Z-ADDWL0006    BCANC7           A/R Customer Nu
      * Establish starting position
     C           KRSSE     CHAIN@BCREFE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0172' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0007           Value of Open O
     C                     Z-ADD*ZERO     WL0008           Date of First S
     C                     Z-ADD*ZERO     WL0009           Date of Last Sh
     C                     Z-ADD*ZERO     WL0010           Amount of Highe
     C                     Z-ADD*ZERO     WL0011           Number of Payme
     C                     Z-ADD*ZERO     WL0012           Last YTD Nbr of
     C                     Z-ADD*ZERO     WL0013           MTD Invoices Pa
     C                     Z-ADD*ZERO     WL0014           YTD Invoices Pa
     C                     Z-ADD*ZERO     WL0015           MTD Days Paid
     C                     Z-ADD*ZERO     WL0016           YTD Days Paid
     C                     Z-ADD*ZERO     WL0017           YTD Sales Invoi
     C                     Z-ADD*ZERO     WL0018           Last Year Sales
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBCEEVA    WL0007           Value of Open O
     C                     Z-ADDBCAHDT    WL0008           Date of First S
     C                     Z-ADDBCANDT    WL0009           Date of Last Sh
     C                     Z-ADDBCALVA    WL0010           Amount of Highe
     C                     Z-ADDBCDMNB    WL0011           Number of Payme
     C                     Z-ADDBCLYNP    WL0012           Last YTD Nbr of
     C                     Z-ADDBCADPM    WL0013           MTD Invoices Pa
     C                     Z-ADDBCVOVA    WL0014           YTD Invoices Pa
     C                     Z-ADDBCBTDY    WL0015           MTD Days Paid
     C                     Z-ADDBCBUDY    WL0016           YTD Days Paid
     C                     Z-ADDBCVPVA    WL0017           YTD Sales Invoi
     C                     Z-ADDBCVQVA    WL0018           Last Year Sales
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Credit Info-Custmr RT - A/R Summary  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUJHNB           Company count
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBANC7    WQSF01           A/R Customer Nu
      * Define keylist
     C           KPSSF     KLIST
     C                     KFLD           WQSF01           A/R Customer Nu
     C                     KFLD           WBAIC3           Company Number
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           A/R Customer Nu
      * Setup key
     C                     Z-ADDWL0020    WQSF01           A/R Customer Nu
     C                     Z-ADDWL0019    WBAIC3           Company Number
      * Establish starting position
     C           KPSSF     SETLL@BCREEC                    *
     C           KRSSF     READE@BCREEC                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0172' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0021           Age $ Due - Cur
     C                     Z-ADD*ZERO     WL0022           Age $ Due - Agi
     C                     Z-ADD*ZERO     WL0023           Age $ Due - Agi
     C                     Z-ADD*ZERO     WL0024           Age $ Due - Agi
     C                     Z-ADD*ZERO     WL0025           Age $ Due - Agi
     C                     Z-ADD*ZERO     WL0026           Age $ Due - Agi
     C                     Z-ADD*ZERO     WL0027           Age $ Due-Curre
     C                     Z-ADD*ZERO     WL0028           Age $ Due-Aging
     C                     Z-ADD*ZERO     WL0029           Age $ Due-Aging
     C                     Z-ADD*ZERO     WL0030           Age $ Due-Aging
     C                     Z-ADD*ZERO     WL0031           Age $ Due-Aging
     C                     Z-ADD*ZERO     WL0032           Age $ Due-Aging
     C                     Z-ADD*ZERO     WL0033           Value of Open O
     C                     Z-ADD*ZERO     WL0034           Time of Last Ag
     C                     Z-ADD*ZERO     WL0035           Date of First S
     C                     Z-ADD*ZERO     WL0036           Date of Last Sh
     C                     Z-ADD*ZERO     WL0037           Amount of Last
     C                     Z-ADD*ZERO     WL0038           Date of Last Pa
     C                     Z-ADD*ZERO     WL0039           Amount of Last
     C                     Z-ADD*ZERO     WL0040           Date of Highest
     C                     Z-ADD*ZERO     WL0041           Amount of Highe
     C                     Z-ADD*ZERO     WL0042           Number of Invoi
     C                     Z-ADD*ZERO     WL0043           Number of Order
     C                     Z-ADD*ZERO     WL0044           Number of Credi
     C                     Z-ADD*ZERO     WL0045           Number of Payme
     C                     Z-ADD*ZERO     WL0046           Date of Last Ag
     C                     Z-ADD*ZERO     WL0047           Last YTD Nbr of
     C                     Z-ADD*ZERO     WL0048           Last YTD Nbr of
     C                     Z-ADD*ZERO     WL0049           Last YTD Nbr of
     C                     Z-ADD*ZERO     WL0050           Last YTD Nbr of
     C                     Z-ADD*ZERO     WL0051           MTD Invoices Pa
     C                     Z-ADD*ZERO     WL0052           YTD Invoices Pa
     C                     Z-ADD*ZERO     WL0053           MTD Days Paid
     C                     Z-ADD*ZERO     WL0054           YTD Days Paid
     C                     Z-ADD*ZERO     WL0055           YTD Sales Invoi
     C                     Z-ADD*ZERO     WL0056           Last Year Sales
     C                     Z-ADD*ZERO     WL0057           Current Month
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * ** Skip out if company passed in and db1.company doesn't match
      * CASE: PAR.Company Number is not equal to zero
     C           WL0019    IFNE *ZERO                      *IF
      * CASE: DB1.Company Number NE PAR.Company Number
     C           WBAIC3    IFNE WL0019                     *IF
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * ** For 'All' companies, determine 1st and last dates for display.
      * ** Determine Date of Last Aging across companies
      * CASE: DB1.Date of Last Aging GT PAR.Date of Last Aging
     C           WBDUDT    IFGT WL0046                     *IF
     C                     Z-ADDWBDUDT    WL0046           Date of Last Ag
     C                     END                             *FI
      * ** Determine Time of Last Aging across companies
      * CASE: DB1.Time of Last Aging GT PAR.Time of Last Aging
     C           WBAKTM    IFGT WL0034                     *IF
     C                     Z-ADDWBAKTM    WL0034           Time of Last Ag
     C                     END                             *FI
      * ** Determine Date of First Sale across companies
      * CASE: PAR.Date of First Shipment is not entered
     C           WL0035    IFEQ *ZERO                      *IF
     C                     Z-ADDWBAHDT    WL0035           Date of First S
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Determine if this date is earlier than a previous date
      * CASE: DB1.Date of First Shipment is entered
     C           WBAHDT    IFNE *ZERO                      *IF
      * CASE: DB1.Date of First Shipment LT PAR.Date of First Shipment
     C           WBAHDT    IFLT WL0035                     *IF
     C                     Z-ADDWBAHDT    WL0035           Date of First S
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
     C                     END                             *FI
      * ** Determine Date and Amount of Last Sale across companies
      * CASE: DB1.Date of Last Shipment GT PAR.Date of Last Shipment
     C           WBANDT    IFGT WL0036                     *IF
     C                     Z-ADDWBANDT    WL0036           Date of Last Sh
     C                     Z-ADDWBANVA    WL0037           Amount of Last
     C                     END                             *FI
      * ** Determine Date and Amount of Last Payment across companies
      * CASE: DB1.Date of Last Payment GT PAR.Date of Last Payment
     C           WBALDT    IFGT WL0038                     *IF
     C                     Z-ADDWBALDT    WL0038           Date of Last Pa
     C                     Z-ADDWBAMVA    WL0039           Amount of Last
     C                     END                             *FI
      * ** Determine Amount of Highest A/R Balance across companies
      * CASE: DB1.Amount of Highest A/R Bal GT PAR.Amount of Highest A/R
     C           WBALVA    IFGT WL0041                     *IF
     C                     Z-ADDWBAIDT    WL0040           Date of Highest
     C                     Z-ADDWBALVA    WL0041           Amount of Highe
     C                     END                             *FI
      * ** Accumulate number of invoices, etc.
     C                     ADD  WBDJNB    WL0042           Number of Invoi
     C                     ADD  WBDLNB    WL0043           Number of Order
     C                     ADD  WBDDNB    WL0044           Number of Credi
     C                     ADD  WBDMNB    WL0045           Number of Payme
     C                     ADD  WBEEVA    WL0033           Value of Open O
     C                     ADD  WBLYNO    WL0047           Last YTD Nbr of
     C                     ADD  WBLYNC    WL0048           Last YTD Nbr of
     C                     ADD  WBLYNP    WL0049           Last YTD Nbr of
     C                     ADD  WBLYNI    WL0050           Last YTD Nbr of
     C                     ADD  WBADPM    WL0051           MTD Invoices Pa
     C                     ADD  WBVOVA    WL0052           YTD Invoices Pa
     C                     ADD  WBBTDY    WL0053           MTD Days Paid
     C                     ADD  WBBUDY    WL0054           YTD Days Paid
     C                     ADD  WBVQVA    WL0056           Last Year Sales
     C                     ADD  WBVPVA    WL0055           YTD Sales Invoi
     C                     Z-ADDWBCUMO    WL0057           Current Month
      * ** Sum Aging Due $
     C                     EXSR UBSUBR                     ** Sum Aging Du
     C                     ADD  1         WUJHNB           Company count
     C           KRSSF     READE@BCREEC                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * *****
      * ** 09/06/2007 LJB FP1122
      * **   Add logic to calculate report fields based on either one
      * ** company or all companies. This requires 2 different RTV's from
      * ** the A/R Summary file.
      * **   Remove column headings above every customer and place them
      * ** at top of page only. Change selection criteria to print at top
      * ** of first page only.
      * *****
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * ** Sum Aging Due $
      *================================================================
     C                     ADD  WBAGVA    WL0021           Age $ Due - Cur
     C                     ADD  WBACVA    WL0022           Age $ Due - Agi
     C                     ADD  WBADVA    WL0023           Age $ Due - Agi
     C                     ADD  WBAEVA    WL0024           Age $ Due - Agi
     C                     ADD  WBAFVA    WL0025           Age $ Due - Agi
     C                     ADD  WBAHVA    WL0026           Age $ Due - Agi
     C                     ADD  WBVIVA    WL0027           Age $ Due-Curre
     C                     ADD  WBVJVA    WL0028           Age $ Due-Aging
     C                     ADD  WBVKVA    WL0029           Age $ Due-Aging
     C                     ADD  WBVLVA    WL0030           Age $ Due-Aging
     C                     ADD  WBVMVA    WL0031           Age $ Due-Aging
     C                     ADD  WBVNVA    WL0032           Age $ Due-Aging
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Reclaim resources of called programs
     C                     CALL 'Y2RCRSC'
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1EEVA           Value of Open O
     C                     Z-ADD*ZERO     P1AHDT           Date of First S
     C                     Z-ADD*ZERO     P1ANDT           Date of Last Sh
     C                     Z-ADD*ZERO     P1ALVA           Amount of Highe
     C                     Z-ADD*ZERO     P1DMNB           Number of Payme
     C                     Z-ADD*ZERO     P1LYNP           Last YTD Nbr of
     C                     Z-ADD*ZERO     P1ADPM           MTD Invoices Pa
     C                     Z-ADD*ZERO     P1VOVA           YTD Invoices Pa
     C                     Z-ADD*ZERO     P1BTDY           MTD Days Paid
     C                     Z-ADD*ZERO     P1BUDY           YTD Days Paid
     C                     Z-ADD*ZERO     P1VPVA           YTD Sales Invoi
     C                     Z-ADD*ZERO     P1VQVA           Last Year Sales
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field USR Total Number Records
     C                     Z-ADD*ZERO     WU      70
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field USR Display field
     C                     MOVEL*BLANK    WUGGST  1
      * Define work field Display Flag
     C                     MOVEL*BLANK    WUQKST  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    BBAYTX           Customer Name
     C                     MOVEL*LOVAL    BBBKC7           Ship To Custome
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAP3NB           D & B Number
     C                     Z-ADD*ZERO     WAI6DT           Date of D & B R
     C                     Z-ADD*ZERO     WAAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABTC7           Parent Customer
     C                     Z-ADD*ZERO     WAS2NB           Parent Credit L
     C                     Z-ADD*ZERO     WAVHVA           A/R Credit Limi
     C                     Z-ADD*ZERO     WAI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Customer Name
     C                     MOVEL*BLANK    WUAYTX 30
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBAGVA           Age $ Due - Cur
     C                     Z-ADD*ZERO     WBACVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WBADVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WBAEVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WBAFVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WBAHVA           Age $ Due - Agi
     C                     Z-ADD*ZERO     WBVIVA           Age $ Due-Curre
     C                     Z-ADD*ZERO     WBVJVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WBVKVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WBVLVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WBVMVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WBVNVA           Age $ Due-Aging
     C                     Z-ADD*ZERO     WBEEVA           Value of Open O
     C                     Z-ADD*ZERO     WBAKTM           Time of Last Ag
     C                     Z-ADD*ZERO     WBAHDT           Date of First S
     C                     Z-ADD*ZERO     WBANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WBANVA           Amount of Last
     C                     Z-ADD*ZERO     WBALDT           Date of Last Pa
     C                     Z-ADD*ZERO     WBAMVA           Amount of Last
     C                     Z-ADD*ZERO     WBAIDT           Date of Highest
     C                     Z-ADD*ZERO     WBALVA           Amount of Highe
     C                     Z-ADD*ZERO     WBDJNB           Number of Invoi
     C                     Z-ADD*ZERO     WBDLNB           Number of Order
     C                     Z-ADD*ZERO     WBDDNB           Number of Credi
     C                     Z-ADD*ZERO     WBDMNB           Number of Payme
     C                     Z-ADD*ZERO     WBDUDT           Date of Last Ag
     C                     Z-ADD*ZERO     WBLYNO           Last YTD Nbr of
     C                     Z-ADD*ZERO     WBLYNC           Last YTD Nbr of
     C                     Z-ADD*ZERO     WBLYNP           Last YTD Nbr of
     C                     Z-ADD*ZERO     WBLYNI           Last YTD Nbr of
     C                     Z-ADD*ZERO     WBADPM           MTD Invoices Pa
     C                     Z-ADD*ZERO     WBVOVA           YTD Invoices Pa
     C                     Z-ADD*ZERO     WBBTDY           MTD Days Paid
     C                     Z-ADD*ZERO     WBBUDY           YTD Days Paid
     C                     Z-ADD*ZERO     WBVPVA           YTD Sales Invoi
     C                     Z-ADD*ZERO     WBVQVA           Last Year Sales
     C                     Z-ADD*ZERO     WBCUMO           Current Month
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Company count
     C                     Z-ADD*ZERO     WUJHNB  50
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002 30
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0003  70
     C                     MOVEL*BLANK    WL0004 30
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0005  30
     C                     Z-ADD*ZERO     WL0006  70
     C                     Z-ADD*ZERO     WL0007 112
     C                     Z-ADD*ZERO     WL0008  70
     C                     Z-ADD*ZERO     WL0009  70
     C                     Z-ADD*ZERO     WL0010 112
     C                     Z-ADD*ZERO     WL0011  50
     C                     Z-ADD*ZERO     WL0012  50
     C                     Z-ADD*ZERO     WL0013  50
     C                     Z-ADD*ZERO     WL0014  50
     C                     Z-ADD*ZERO     WL0015  50
     C                     Z-ADD*ZERO     WL0016  50
     C                     Z-ADD*ZERO     WL0017 112
     C                     Z-ADD*ZERO     WL0018 112
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0019  30
     C                     Z-ADD*ZERO     WL0020  70
     C                     Z-ADD*ZERO     WL0021 112
     C                     Z-ADD*ZERO     WL0022 112
     C                     Z-ADD*ZERO     WL0023 112
     C                     Z-ADD*ZERO     WL0024 112
     C                     Z-ADD*ZERO     WL0025 112
     C                     Z-ADD*ZERO     WL0026 112
     C                     Z-ADD*ZERO     WL0027 112
     C                     Z-ADD*ZERO     WL0028 112
     C                     Z-ADD*ZERO     WL0029 112
     C                     Z-ADD*ZERO     WL0030 112
     C                     Z-ADD*ZERO     WL0031 112
     C                     Z-ADD*ZERO     WL0032 112
     C                     Z-ADD*ZERO     WL0033 112
     C                     Z-ADD*ZERO     WL0034  60
     C                     Z-ADD*ZERO     WL0035  70
     C                     Z-ADD*ZERO     WL0036  70
     C                     Z-ADD*ZERO     WL0037 112
     C                     Z-ADD*ZERO     WL0038  70
     C                     Z-ADD*ZERO     WL0039 112
     C                     Z-ADD*ZERO     WL0040  70
     C                     Z-ADD*ZERO     WL0041 112
     C                     Z-ADD*ZERO     WL0042  50
     C                     Z-ADD*ZERO     WL0043  50
     C                     Z-ADD*ZERO     WL0044  50
     C                     Z-ADD*ZERO     WL0045  50
     C                     Z-ADD*ZERO     WL0046  70
     C                     Z-ADD*ZERO     WL0047  50
     C                     Z-ADD*ZERO     WL0048  50
     C                     Z-ADD*ZERO     WL0049  50
     C                     Z-ADD*ZERO     WL0050  50
     C                     Z-ADD*ZERO     WL0051  50
     C                     Z-ADD*ZERO     WL0052  50
     C                     Z-ADD*ZERO     WL0053  50
     C                     Z-ADD*ZERO     WL0054  50
     C                     Z-ADD*ZERO     WL0055 112
     C                     Z-ADD*ZERO     WL0056 112
     C                     Z-ADD*ZERO     WL0057  20
      * Define local work field Age $ Due - Current - CB
     C                     Z-ADD*ZERO     YL0001 112
      * Define local work field Age $ Due - Aging 1 - CB
     C                     Z-ADD*ZERO     YL0002 112
      * Define local work field Age $ Due - Aging 2 - CB
     C                     Z-ADD*ZERO     YL0003 112
      * Define local work field Age $ Due - Aging 3 - CB
     C                     Z-ADD*ZERO     YL0004 112
      * Define local work field Age $ Due - Aging 4 - CB
     C                     Z-ADD*ZERO     YL0005 112
      * Define local work field Age $ Due - Aging 5 - CB
     C                     Z-ADD*ZERO     YL0006 112
      * Define local work field Age $ Due-Current-W/O CB
     C                     Z-ADD*ZERO     YL0007 112
      * Define local work field Age $ Due-Aging 1-W/O CB
     C                     Z-ADD*ZERO     YL0008 112
      * Define local work field Age $ Due-Aging 2-W/O CB
     C                     Z-ADD*ZERO     YL0009 112
      * Define local work field Age $ Due-Aging 3-W/O CB
     C                     Z-ADD*ZERO     YL0010 112
      * Define local work field Age $ Due-Aging 4-W/O CB
     C                     Z-ADD*ZERO     YL0011 112
      * Define local work field Age $ Due-Aging 5-W/O CB
     C                     Z-ADD*ZERO     YL0012 112
      * Define local work field Time of Last Aging
     C                     Z-ADD*ZERO     YL0013  60
      * Define local work field Amount of Last Shipment
     C                     Z-ADD*ZERO     YL0014 112
      * Define local work field Date of Last Payment
     C                     Z-ADD*ZERO     YL0015  70
      * Define local work field Amount of Last Payment
     C                     Z-ADD*ZERO     YL0016 112
      * Define local work field Date of Highest A/R Bal.
     C                     Z-ADD*ZERO     YL0017  70
      * Define local work field Number of Invoices YTD
     C                     Z-ADD*ZERO     YL0018  50
      * Define local work field Number of Orders YTD
     C                     Z-ADD*ZERO     YL0019  50
      * Define local work field Number of Credits YTD
     C                     Z-ADD*ZERO     YL0020  50
      * Define local work field Date of Last Aging
     C                     Z-ADD*ZERO     YL0021  70
      * Define local work field Last YTD Nbr of Orders
     C                     Z-ADD*ZERO     YL0022  50
      * Define local work field Last YTD Nbr of Credits
     C                     Z-ADD*ZERO     YL0023  50
      * Define local work field Last YTD Nbr of Invoices
     C                     Z-ADD*ZERO     YL0024  50
      * Define local work field Current Month
     C                     Z-ADD*ZERO     YL0025  20
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
     C                     Z-ADD*ZERO     WU               USR Total Numbe
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
     C                     MOVEL'N'       WUGGST           USR Display fie
     C                     MOVEL'Y'       WUQKST           Display Flag
      * ***** Change Log and Comments
     C                     EXSR UASUBR                     ***** Change Lo
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
