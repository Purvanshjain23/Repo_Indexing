     H/TITLE Prg Prod Comparison   XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 01:04:53
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKD5CPL0IF  E           K        DISK
      * RTV : Producer Comp Selection   Retrieval index
      *
     FPKETCPL1IF  E           K        DISK
      * RTV : Producer Comp Sel Tattoo  Retrieval index
      *
     FPKD6CPL1IF  E           K        DISK
      * RTV : Producer Comp Detail      Retrieval index
      *
     FPKETCPL0UF  E           K        DISK
      * UPD : Producer Comp Sel Tattoo  Update index
      *
     FPKD6CPL8UF  E           K        DISK
      * UPD : Producer Comp Detail      Update index for purge
      *
     FPKD6CPL0UF  E           K        DISK
      * UPD : Producer Comp Detail      Update index
      *
     FPKD5CPL1UF  E           K        DISK
      * UPD : Producer Comp Selection   Update index
      *
     I@D5CPY6
      * Producer Comp Selection   Retrieval index
      * Renamed input format fields
     I              D5HONB                          WAHONB
     I              D5G6CD                          WAG6CD
     I              D5NETX                          WANETX
     I              D5RHST                          WARHST
     I              D5DGDT                          WADGDT
     I              D5DHDT                          WADHDT
     I              D5G7CD                          WAG7CD
     I              D5G8CD                          WAG8CD
     I              D5NFPR                          WANFPR
     I              D5NGPR                          WANGPR
     I              D5NFTX                          WANFTX
     I              D5QXST                          WAQXST
     I              D5G9CD                          WAG9CD
     I              D5QYST                          WAQYST
     I              D5QZST                          WAQZST
     I              D5Q0ST                          WAQ0ST
     I              D5Q1ST                          WAQ1ST
     I              D5N4PR                          WAN4PR
     I              D5HCCD                          WAHCCD
     I              D5Q3ST                          WAQ3ST
     I              D5Q4ST                          WAQ4ST
     I              D5Q5ST                          WAQ5ST
     I              D5Q6ST                          WAQ6ST
     I              D5Q7ST                          WAQ7ST
     I              D5AACD                          WAAACD
     I              D5ABCD                          WAABCD
     I              D5AAVN                          WAAAVN
     I              D5AADT                          WAAADT
     I              D5AMTM                          WAAMTM
     I              D5AJST                          WAAJST
     I              D5AHVN                          WAAHVN
     I              D5AGVN                          WAAGVN
     I              D5ABVN                          WAABVN
     I              D5ABDT                          WAABDT
     I              D5ABTM                          WAABTM
      *
     I@ETCPDK
      * Producer Comp Sel Tattoo  Retrieval index
      * Renamed input format fields
     I              ETHONB                          WBHONB
     I              ETG6CD                          WBG6CD
     I              ETHMNB                          WBHMNB
     I              ETBNNB                          WBBNNB
     I              ETBONB                          WBBONB
     I              ETCVNB                          WBCVNB
     I              ETB0DT                          WBB0DT
      *
     I@ETCPDJ
      * Producer Comp Sel Tattoo  Update index
      * Renamed input format fields
     I              ETHONB                          WCHONB
     I              ETG6CD                          WCG6CD
     I              ETHMNB                          WCHMNB
     I              ETBNNB                          WCBNNB
     I              ETBONB                          WCBONB
     I              ETCVNB                          WCCVNB
     I              ETB0DT                          WCB0DT
      *
     I@D6CPY9
      * Producer Comp Detail      Retrieval index
      * Renamed input format fields
     I              D6HONB                          WDHONB
     I              D6G6CD                          WDG6CD
     I              D6HMNB                          WDHMNB
     I              D6BNNB                          WDBNNB
     I              D6BONB                          WDBONB
     I              D6CVNB                          WDCVNB
     I              D6B0DT                          WDB0DT
     I              D6PCHD                          WDPCHD
     I              D6PCHK                          WDPCHK
     I              D6PCJA                          WDPCJA
     I              D6PCLW                          WDPCLW
     I              D6PCAL                          WDPCAL
     I              D6PCHW                          WDPCHW
     I              D6PCAW                          WDPCAW
     I              D6PCAH                          WDPCAH
     I              D6GIPC                          WDGIPC
     I              D6PCAB                          WDPCAB
     I              D6PFPC                          WDPFPC
     I              D6GHPC                          WDGHPC
     I              D6GGPC                          WDGGPC
     I              D6NHPR                          WDNHPR
     I              D6OYPR                          WDOYPR
     I              D6OZPR                          WDOZPR
     I              D6O0PR                          WDO0PR
     I              D6O1PR                          WDO1PR
     I              D6O2PR                          WDO2PR
     I              D6O3PR                          WDO3PR
     I              D6O4PR                          WDO4PR
     I              D6O5PR                          WDO5PR
     I              D6O6PR                          WDO6PR
     I              D6O7PR                          WDO7PR
     I              D6O8PR                          WDO8PR
     I              D6O9PR                          WDO9PR
     I              D6NIPR                          WDNIPR
     I              D6NJPR                          WDNJPR
     I              D6N5PR                          WDN5PR
     I              D6NKPR                          WDNKPR
     I              D6NLPR                          WDNLPR
     I              D6NMPR                          WDNMPR
     I              D6NNPR                          WDNNPR
     I              D6NXPR                          WDNXPR
     I              D6NPPR                          WDNPPR
     I              D6NQPR                          WDNQPR
     I              D6NRPR                          WDNRPR
     I              D6NSPR                          WDNSPR
     I              D6OMPR                          WDOMPR
     I              D6ONPR                          WDONPR
     I              D6OOPR                          WDOOPR
     I              D6OPPR                          WDOPPR
     I              D6OQPR                          WDOQPR
     I              D6ORPR                          WDORPR
     I              D6OSPR                          WDOSPR
     I              D6OTPR                          WDOTPR
     I              D6OUPR                          WDOUPR
     I              D6OVPR                          WDOVPR
     I              D6OWPR                          WDOWPR
     I              D6OXPR                          WDOXPR
     I              D6NTPR                          WDNTPR
     I              D6NUPR                          WDNUPR
     I              D6N6PR                          WDN6PR
     I              D6NVPR                          WDNVPR
     I              D6NWPR                          WDNWPR
     I              D6NYPR                          WDNYPR
     I              D6NZPR                          WDNZPR
     I              D6N0PR                          WDN0PR
     I              D6N1PR                          WDN1PR
     I              D6N2PR                          WDN2PR
     I              D6N3PR                          WDN3PR
     I              D6N7PR                          WDN7PR
     I              D6N8PR                          WDN8PR
     I              D6N9PR                          WDN9PR
     I              D6Q8ST                          WDQ8ST
     I              D6Q9ST                          WDQ9ST
     I              D6PCCY                          WDPCCY
     I              D6RAST                          WDRAST
     I              D6HBCD                          WDHBCD
     I              D6HACD                          WDHACD
     I              D6RBST                          WDRBST
     I              D6RCST                          WDRCST
     I              D6RDST                          WDRDST
     I              D6REST                          WDREST
     I              D6RFST                          WDRFST
     I              D6PDFM                          WDPDFM
     I              D6HQCD                          WDHQCD
     I              D6ABCD                          WDABCD
     I              D6AECD                          WDAECD
     I              D6AACD                          WDAACD
     I              D6ACCD                          WDACCD
     I              D6AAVN                          WDAAVN
     I              D6AADT                          WDAADT
     I              D6AMTM                          WDAMTM
     I              D6AJST                          WDAJST
     I              D6AHVN                          WDAHVN
     I              D6AGVN                          WDAGVN
     I              D6ABVN                          WDABVN
     I              D6ABDT                          WDABDT
     I              D6ABTM                          WDABTM
      *
     I@D6CPZY
      * Producer Comp Detail      Update index for purge
      * Renamed input format fields
     I              D6HONB                          WEHONB
     I              D6G6CD                          WEG6CD
     I              D6HMNB                          WEHMNB
     I              D6BNNB                          WEBNNB
     I              D6BONB                          WEBONB
     I              D6CVNB                          WECVNB
     I              D6B0DT                          WEB0DT
     I              D6PCHD                          WEPCHD
     I              D6PCHK                          WEPCHK
     I              D6PCJA                          WEPCJA
     I              D6PCLW                          WEPCLW
     I              D6PCAL                          WEPCAL
     I              D6PCHW                          WEPCHW
     I              D6PCAW                          WEPCAW
     I              D6PCAH                          WEPCAH
     I              D6GIPC                          WEGIPC
     I              D6PCAB                          WEPCAB
     I              D6PFPC                          WEPFPC
     I              D6GHPC                          WEGHPC
     I              D6GGPC                          WEGGPC
     I              D6NHPR                          WENHPR
     I              D6OYPR                          WEOYPR
     I              D6OZPR                          WEOZPR
     I              D6O0PR                          WEO0PR
     I              D6O1PR                          WEO1PR
     I              D6O2PR                          WEO2PR
     I              D6O3PR                          WEO3PR
     I              D6O4PR                          WEO4PR
     I              D6O5PR                          WEO5PR
     I              D6O6PR                          WEO6PR
     I              D6O7PR                          WEO7PR
     I              D6O8PR                          WEO8PR
     I              D6O9PR                          WEO9PR
     I              D6NIPR                          WENIPR
     I              D6NJPR                          WENJPR
     I              D6N5PR                          WEN5PR
     I              D6NKPR                          WENKPR
     I              D6NLPR                          WENLPR
     I              D6NMPR                          WENMPR
     I              D6NNPR                          WENNPR
     I              D6NXPR                          WENXPR
     I              D6NPPR                          WENPPR
     I              D6NQPR                          WENQPR
     I              D6NRPR                          WENRPR
     I              D6NSPR                          WENSPR
     I              D6OMPR                          WEOMPR
     I              D6ONPR                          WEONPR
     I              D6OOPR                          WEOOPR
     I              D6OPPR                          WEOPPR
     I              D6OQPR                          WEOQPR
     I              D6ORPR                          WEORPR
     I              D6OSPR                          WEOSPR
     I              D6OTPR                          WEOTPR
     I              D6OUPR                          WEOUPR
     I              D6OVPR                          WEOVPR
     I              D6OWPR                          WEOWPR
     I              D6OXPR                          WEOXPR
     I              D6NTPR                          WENTPR
     I              D6NUPR                          WENUPR
     I              D6N6PR                          WEN6PR
     I              D6NVPR                          WENVPR
     I              D6NWPR                          WENWPR
     I              D6NYPR                          WENYPR
     I              D6NZPR                          WENZPR
     I              D6N0PR                          WEN0PR
     I              D6N1PR                          WEN1PR
     I              D6N2PR                          WEN2PR
     I              D6N3PR                          WEN3PR
     I              D6N7PR                          WEN7PR
     I              D6N8PR                          WEN8PR
     I              D6N9PR                          WEN9PR
     I              D6Q8ST                          WEQ8ST
     I              D6Q9ST                          WEQ9ST
     I              D6PCCY                          WEPCCY
     I              D6RAST                          WERAST
     I              D6HBCD                          WEHBCD
     I              D6HACD                          WEHACD
     I              D6RBST                          WERBST
     I              D6RCST                          WERCST
     I              D6RDST                          WERDST
     I              D6REST                          WEREST
     I              D6RFST                          WERFST
     I              D6PDFM                          WEPDFM
     I              D6HQCD                          WEHQCD
     I              D6ABCD                          WEABCD
     I              D6AECD                          WEAECD
     I              D6AACD                          WEAACD
     I              D6ACCD                          WEACCD
     I              D6AAVN                          WEAAVN
     I              D6AADT                          WEAADT
     I              D6AMTM                          WEAMTM
     I              D6AJST                          WEAJST
     I              D6AHVN                          WEAHVN
     I              D6AGVN                          WEAGVN
     I              D6ABVN                          WEABVN
     I              D6ABDT                          WEABDT
     I              D6ABTM                          WEABTM
      *
     I@D6CPY5
      * Producer Comp Detail      Update index
      * Renamed input format fields
     I              D6HONB                          WFHONB
     I              D6G6CD                          WFG6CD
     I              D6HMNB                          WFHMNB
     I              D6BNNB                          WFBNNB
     I              D6BONB                          WFBONB
     I              D6CVNB                          WFCVNB
     I              D6B0DT                          WFB0DT
     I              D6PCHD                          WFPCHD
     I              D6PCHK                          WFPCHK
     I              D6PCJA                          WFPCJA
     I              D6PCLW                          WFPCLW
     I              D6PCAL                          WFPCAL
     I              D6PCHW                          WFPCHW
     I              D6PCAW                          WFPCAW
     I              D6PCAH                          WFPCAH
     I              D6GIPC                          WFGIPC
     I              D6PCAB                          WFPCAB
     I              D6PFPC                          WFPFPC
     I              D6GHPC                          WFGHPC
     I              D6GGPC                          WFGGPC
     I              D6NHPR                          WFNHPR
     I              D6OYPR                          WFOYPR
     I              D6OZPR                          WFOZPR
     I              D6O0PR                          WFO0PR
     I              D6O1PR                          WFO1PR
     I              D6O2PR                          WFO2PR
     I              D6O3PR                          WFO3PR
     I              D6O4PR                          WFO4PR
     I              D6O5PR                          WFO5PR
     I              D6O6PR                          WFO6PR
     I              D6O7PR                          WFO7PR
     I              D6O8PR                          WFO8PR
     I              D6O9PR                          WFO9PR
     I              D6NIPR                          WFNIPR
     I              D6NJPR                          WFNJPR
     I              D6N5PR                          WFN5PR
     I              D6NKPR                          WFNKPR
     I              D6NLPR                          WFNLPR
     I              D6NMPR                          WFNMPR
     I              D6NNPR                          WFNNPR
     I              D6NXPR                          WFNXPR
     I              D6NPPR                          WFNPPR
     I              D6NQPR                          WFNQPR
     I              D6NRPR                          WFNRPR
     I              D6NSPR                          WFNSPR
     I              D6OMPR                          WFOMPR
     I              D6ONPR                          WFONPR
     I              D6OOPR                          WFOOPR
     I              D6OPPR                          WFOPPR
     I              D6OQPR                          WFOQPR
     I              D6ORPR                          WFORPR
     I              D6OSPR                          WFOSPR
     I              D6OTPR                          WFOTPR
     I              D6OUPR                          WFOUPR
     I              D6OVPR                          WFOVPR
     I              D6OWPR                          WFOWPR
     I              D6OXPR                          WFOXPR
     I              D6NTPR                          WFNTPR
     I              D6NUPR                          WFNUPR
     I              D6N6PR                          WFN6PR
     I              D6NVPR                          WFNVPR
     I              D6NWPR                          WFNWPR
     I              D6NYPR                          WFNYPR
     I              D6NZPR                          WFNZPR
     I              D6N0PR                          WFN0PR
     I              D6N1PR                          WFN1PR
     I              D6N2PR                          WFN2PR
     I              D6N3PR                          WFN3PR
     I              D6N7PR                          WFN7PR
     I              D6N8PR                          WFN8PR
     I              D6N9PR                          WFN9PR
     I              D6Q8ST                          WFQ8ST
     I              D6Q9ST                          WFQ9ST
     I              D6PCCY                          WFPCCY
     I              D6RAST                          WFRAST
     I              D6HBCD                          WFHBCD
     I              D6HACD                          WFHACD
     I              D6RBST                          WFRBST
     I              D6RCST                          WFRCST
     I              D6RDST                          WFRDST
     I              D6REST                          WFREST
     I              D6RFST                          WFRFST
     I              D6PDFM                          WFPDFM
     I              D6HQCD                          WFHQCD
     I              D6ABCD                          WFABCD
     I              D6AECD                          WFAECD
     I              D6AACD                          WFAACD
     I              D6ACCD                          WFACCD
     I              D6AAVN                          WFAAVN
     I              D6AADT                          WFAADT
     I              D6AMTM                          WFAMTM
     I              D6AJST                          WFAJST
     I              D6AHVN                          WFAHVN
     I              D6AGVN                          WFAGVN
     I              D6ABVN                          WFABVN
     I              D6ABDT                          WFABDT
     I              D6ABTM                          WFABTM
      *
     I@D5CPY7
      * Producer Comp Selection   Update index
      * Renamed input format fields
     I              D5HONB                          WGHONB
     I              D5G6CD                          WGG6CD
     I              D5NETX                          WGNETX
     I              D5RHST                          WGRHST
     I              D5DGDT                          WGDGDT
     I              D5DHDT                          WGDHDT
     I              D5G7CD                          WGG7CD
     I              D5G8CD                          WGG8CD
     I              D5NFPR                          WGNFPR
     I              D5NGPR                          WGNGPR
     I              D5NFTX                          WGNFTX
     I              D5QXST                          WGQXST
     I              D5G9CD                          WGG9CD
     I              D5QYST                          WGQYST
     I              D5QZST                          WGQZST
     I              D5Q0ST                          WGQ0ST
     I              D5Q1ST                          WGQ1ST
     I              D5N4PR                          WGN4PR
     I              D5HCCD                          WGHCCD
     I              D5Q3ST                          WGQ3ST
     I              D5Q4ST                          WGQ4ST
     I              D5Q5ST                          WGQ5ST
     I              D5Q6ST                          WGQ6ST
     I              D5Q7ST                          WGQ7ST
     I              D5AACD                          WGAACD
     I              D5ABCD                          WGABCD
     I              D5AAVN                          WGAAVN
     I              D5AADT                          WGAADT
     I              D5AMTM                          WGAMTM
     I              D5AJST                          WGAJST
     I              D5AHVN                          WGAHVN
     I              D5AGVN                          WGAGVN
     I              D5ABVN                          WGABVN
     I              D5ABDT                          WGABDT
     I              D5ABTM                          WGABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKET1    E DSPKETCPL0
      * UPD : Producer Comp Sel Tattoo  Update index
      * Renamed input format fields
     I              ETHONB                          WCHONB
     I              ETG6CD                          WCG6CD
     I              ETHMNB                          WCHMNB
     I              ETBNNB                          WCBNNB
     I              ETBONB                          WCBONB
     I              ETCVNB                          WCCVNB
     I              ETB0DT                          WCB0DT
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKD61    E DSPKD6CPL8
      * UPD : Producer Comp Detail      Update index for purge
      * Renamed input format fields
     I              D6HONB                          WEHONB
     I              D6G6CD                          WEG6CD
     I              D6HMNB                          WEHMNB
     I              D6BNNB                          WEBNNB
     I              D6BONB                          WEBONB
     I              D6CVNB                          WECVNB
     I              D6B0DT                          WEB0DT
     I              D6PCHD                          WEPCHD
     I              D6PCHK                          WEPCHK
     I              D6PCJA                          WEPCJA
     I              D6PCLW                          WEPCLW
     I              D6PCAL                          WEPCAL
     I              D6PCHW                          WEPCHW
     I              D6PCAW                          WEPCAW
     I              D6PCAH                          WEPCAH
     I              D6GIPC                          WEGIPC
     I              D6PCAB                          WEPCAB
     I              D6PFPC                          WEPFPC
     I              D6GHPC                          WEGHPC
     I              D6GGPC                          WEGGPC
     I              D6NHPR                          WENHPR
     I              D6OYPR                          WEOYPR
     I              D6OZPR                          WEOZPR
     I              D6O0PR                          WEO0PR
     I              D6O1PR                          WEO1PR
     I              D6O2PR                          WEO2PR
     I              D6O3PR                          WEO3PR
     I              D6O4PR                          WEO4PR
     I              D6O5PR                          WEO5PR
     I              D6O6PR                          WEO6PR
     I              D6O7PR                          WEO7PR
     I              D6O8PR                          WEO8PR
     I              D6O9PR                          WEO9PR
     I              D6NIPR                          WENIPR
     I              D6NJPR                          WENJPR
     I              D6N5PR                          WEN5PR
     I              D6NKPR                          WENKPR
     I              D6NLPR                          WENLPR
     I              D6NMPR                          WENMPR
     I              D6NNPR                          WENNPR
     I              D6NXPR                          WENXPR
     I              D6NPPR                          WENPPR
     I              D6NQPR                          WENQPR
     I              D6NRPR                          WENRPR
     I              D6NSPR                          WENSPR
     I              D6OMPR                          WEOMPR
     I              D6ONPR                          WEONPR
     I              D6OOPR                          WEOOPR
     I              D6OPPR                          WEOPPR
     I              D6OQPR                          WEOQPR
     I              D6ORPR                          WEORPR
     I              D6OSPR                          WEOSPR
     I              D6OTPR                          WEOTPR
     I              D6OUPR                          WEOUPR
     I              D6OVPR                          WEOVPR
     I              D6OWPR                          WEOWPR
     I              D6OXPR                          WEOXPR
     I              D6NTPR                          WENTPR
     I              D6NUPR                          WENUPR
     I              D6N6PR                          WEN6PR
     I              D6NVPR                          WENVPR
     I              D6NWPR                          WENWPR
     I              D6NYPR                          WENYPR
     I              D6NZPR                          WENZPR
     I              D6N0PR                          WEN0PR
     I              D6N1PR                          WEN1PR
     I              D6N2PR                          WEN2PR
     I              D6N3PR                          WEN3PR
     I              D6N7PR                          WEN7PR
     I              D6N8PR                          WEN8PR
     I              D6N9PR                          WEN9PR
     I              D6Q8ST                          WEQ8ST
     I              D6Q9ST                          WEQ9ST
     I              D6PCCY                          WEPCCY
     I              D6RAST                          WERAST
     I              D6HBCD                          WEHBCD
     I              D6HACD                          WEHACD
     I              D6RBST                          WERBST
     I              D6RCST                          WERCST
     I              D6RDST                          WERDST
     I              D6REST                          WEREST
     I              D6RFST                          WERFST
     I              D6PDFM                          WEPDFM
     I              D6HQCD                          WEHQCD
     I              D6ABCD                          WEABCD
     I              D6AECD                          WEAECD
     I              D6AACD                          WEAACD
     I              D6ACCD                          WEACCD
     I              D6AAVN                          WEAAVN
     I              D6AADT                          WEAADT
     I              D6AMTM                          WEAMTM
     I              D6AJST                          WEAJST
     I              D6AHVN                          WEAHVN
     I              D6AGVN                          WEAGVN
     I              D6ABVN                          WEABVN
     I              D6ABDT                          WEABDT
     I              D6ABTM                          WEABTM
      *
     IYARDCS      DS                            356
     IQPKD62    E DSPKD6CPL0
      * UPD : Producer Comp Detail      Update index
      * Renamed input format fields
     I              D6HONB                          WFHONB
     I              D6G6CD                          WFG6CD
     I              D6HMNB                          WFHMNB
     I              D6BNNB                          WFBNNB
     I              D6BONB                          WFBONB
     I              D6CVNB                          WFCVNB
     I              D6B0DT                          WFB0DT
     I              D6PCHD                          WFPCHD
     I              D6PCHK                          WFPCHK
     I              D6PCJA                          WFPCJA
     I              D6PCLW                          WFPCLW
     I              D6PCAL                          WFPCAL
     I              D6PCHW                          WFPCHW
     I              D6PCAW                          WFPCAW
     I              D6PCAH                          WFPCAH
     I              D6GIPC                          WFGIPC
     I              D6PCAB                          WFPCAB
     I              D6PFPC                          WFPFPC
     I              D6GHPC                          WFGHPC
     I              D6GGPC                          WFGGPC
     I              D6NHPR                          WFNHPR
     I              D6OYPR                          WFOYPR
     I              D6OZPR                          WFOZPR
     I              D6O0PR                          WFO0PR
     I              D6O1PR                          WFO1PR
     I              D6O2PR                          WFO2PR
     I              D6O3PR                          WFO3PR
     I              D6O4PR                          WFO4PR
     I              D6O5PR                          WFO5PR
     I              D6O6PR                          WFO6PR
     I              D6O7PR                          WFO7PR
     I              D6O8PR                          WFO8PR
     I              D6O9PR                          WFO9PR
     I              D6NIPR                          WFNIPR
     I              D6NJPR                          WFNJPR
     I              D6N5PR                          WFN5PR
     I              D6NKPR                          WFNKPR
     I              D6NLPR                          WFNLPR
     I              D6NMPR                          WFNMPR
     I              D6NNPR                          WFNNPR
     I              D6NXPR                          WFNXPR
     I              D6NPPR                          WFNPPR
     I              D6NQPR                          WFNQPR
     I              D6NRPR                          WFNRPR
     I              D6NSPR                          WFNSPR
     I              D6OMPR                          WFOMPR
     I              D6ONPR                          WFONPR
     I              D6OOPR                          WFOOPR
     I              D6OPPR                          WFOPPR
     I              D6OQPR                          WFOQPR
     I              D6ORPR                          WFORPR
     I              D6OSPR                          WFOSPR
     I              D6OTPR                          WFOTPR
     I              D6OUPR                          WFOUPR
     I              D6OVPR                          WFOVPR
     I              D6OWPR                          WFOWPR
     I              D6OXPR                          WFOXPR
     I              D6NTPR                          WFNTPR
     I              D6NUPR                          WFNUPR
     I              D6N6PR                          WFN6PR
     I              D6NVPR                          WFNVPR
     I              D6NWPR                          WFNWPR
     I              D6NYPR                          WFNYPR
     I              D6NZPR                          WFNZPR
     I              D6N0PR                          WFN0PR
     I              D6N1PR                          WFN1PR
     I              D6N2PR                          WFN2PR
     I              D6N3PR                          WFN3PR
     I              D6N7PR                          WFN7PR
     I              D6N8PR                          WFN8PR
     I              D6N9PR                          WFN9PR
     I              D6Q8ST                          WFQ8ST
     I              D6Q9ST                          WFQ9ST
     I              D6PCCY                          WFPCCY
     I              D6RAST                          WFRAST
     I              D6HBCD                          WFHBCD
     I              D6HACD                          WFHACD
     I              D6RBST                          WFRBST
     I              D6RCST                          WFRCST
     I              D6RDST                          WFRDST
     I              D6REST                          WFREST
     I              D6RFST                          WFRFST
     I              D6PDFM                          WFPDFM
     I              D6HQCD                          WFHQCD
     I              D6ABCD                          WFABCD
     I              D6AECD                          WFAECD
     I              D6AACD                          WFAACD
     I              D6ACCD                          WFACCD
     I              D6AAVN                          WFAAVN
     I              D6AADT                          WFAADT
     I              D6AMTM                          WFAMTM
     I              D6AJST                          WFAJST
     I              D6AHVN                          WFAHVN
     I              D6AGVN                          WFAGVN
     I              D6ABVN                          WFABVN
     I              D6ABDT                          WFABDT
     I              D6ABTM                          WFABTM
      *
     IQPKD51    E DSPKD5CPL1
      * UPD : Producer Comp Selection   Update index
      * Renamed input format fields
     I              D5HONB                          WGHONB
     I              D5G6CD                          WGG6CD
     I              D5NETX                          WGNETX
     I              D5RHST                          WGRHST
     I              D5DGDT                          WGDGDT
     I              D5DHDT                          WGDHDT
     I              D5G7CD                          WGG7CD
     I              D5G8CD                          WGG8CD
     I              D5NFPR                          WGNFPR
     I              D5NGPR                          WGNGPR
     I              D5NFTX                          WGNFTX
     I              D5QXST                          WGQXST
     I              D5G9CD                          WGG9CD
     I              D5QYST                          WGQYST
     I              D5QZST                          WGQZST
     I              D5Q0ST                          WGQ0ST
     I              D5Q1ST                          WGQ1ST
     I              D5N4PR                          WGN4PR
     I              D5HCCD                          WGHCCD
     I              D5Q3ST                          WGQ3ST
     I              D5Q4ST                          WGQ4ST
     I              D5Q5ST                          WGQ5ST
     I              D5Q6ST                          WGQ6ST
     I              D5Q7ST                          WGQ7ST
     I              D5AACD                          WGAACD
     I              D5ABCD                          WGABCD
     I              D5AAVN                          WGAAVN
     I              D5AADT                          WGAADT
     I              D5AMTM                          WGAMTM
     I              D5AJST                          WGAJST
     I              D5AHVN                          WGAHVN
     I              D5AGVN                          WGAGVN
     I              D5ABVN                          WGABVN
     I              D5ABDT                          WGABDT
     I              D5ABTM                          WGABTM
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Producer Comp Selection
      * I :  CC Company Number
     I                                    P   1   20P1HONB
      * I :  PCS Code
     I                                        3  12 P1G6CD
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HONB    PARM           WP0001  30       CC Company Numb
     C           P1G6CD    PARM           WP0002 10        PCS Code
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prg Prod Comparison   XF
      * H16853 ISE 11/05/2020-Recompiled due to change in Buy Order Numbe
      * Prg Prod Comparison   RT - Producer Comp Selection  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Prg Prod Comparison   RT - Producer Comp Selection  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAHONB           CC Company Numb
     C                     KFLD           WAG6CD           PCS Code
      * Setup key
     C                     Z-ADDP1HONB    WAHONB           CC Company Numb
     C                     MOVELP1G6CD    WAG6CD           PCS Code
      * Establish starting position
     C           KRSSA     CHAIN@D5CPY6              90    *
      * Data record not found
     C   90                MOVEL'PRK0766' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Prg Prod Comp Sel     RT - Producer Comp Sel Tattoo  * 
     C                     EXSR SBRVGN
      * Prg Prod Comp Detail  RT - Producer Comp Detail  * 
     C                     EXSR SDRVGN
      * Del Prd Comp Sel      DL - Producer Comp Selection  * 
     C                     EXSR SGDLRC
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Prg Prod Comp Sel     RT - Producer Comp Sel Tattoo  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHONB    WQSB01           CC Company Numb
     C           *LIKE     DEFN WBG6CD    WQSB02           PCS Code
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           CC Company Numb
     C                     KFLD           WQSB02           PCS Code
      * Setup key
     C                     Z-ADDWAHONB    WQSB01           CC Company Numb
     C                     MOVELWAG6CD    WQSB02           PCS Code
      * Establish starting position
     C           KRSSB     SETLL@ETCPDK                    *
     C           KRSSB     READE@ETCPDK                  90*
      * Data record not found
     C   90                MOVEL'PRK0901' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Delete Producer Comp Sel - Producer Comp Sel Tattoo  * 
     C                     EXSR SCDLRC
     C           KRSSB     READE@ETCPDK                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCDLRC    BEGSR
      *================================================================
      * Delete Producer Comp Sel - Producer Comp Sel Tattoo  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @ETCPDJ
     C                     Z-ADDWBHONB    WCHONB           CC Company Numb
     C                     MOVELWBG6CD    WCG6CD           PCS Code
     C                     Z-ADDWBHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WCBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WCB0DT           TH Kill Date
      *
     C           KLDLSC    KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C                     KFLD           WCG6CD           PCS Code
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C           KLDLSC    CHAIN@ETCPDJ              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKETCPL0'MDACP
     C                     MOVEL'@ETCPDJ' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@ETCPDJ                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Prg Prod Comp Detail  RT - Producer Comp Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHONB    WQSD01           CC Company Numb
     C           *LIKE     DEFN WDG6CD    WQSD02           PCS Code
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           CC Company Numb
     C                     KFLD           WQSD02           PCS Code
      * Setup key
     C                     Z-ADDWAHONB    WQSD01           CC Company Numb
     C                     MOVELWAG6CD    WQSD02           PCS Code
      * Establish starting position
     C           KRSSD     SETLL@D6CPY9                    *
     C           KRSSD     READE@D6CPY9                  90*
      * Data record not found
     C   90                MOVEL'PRK0769' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CRT Prdcr Comp Dtl Purge - Producer Comp Detail  * 
     C                     EXSR SECHRC
      * Del Prod Comp Detail  DL - Producer Comp Detail  * 
     C                     EXSR SFDLRC
     C           KRSSD     READE@D6CPY9                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECHRC    BEGSR
      *================================================================
      * CRT Prdcr Comp Dtl Purge - Producer Comp Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @D6CPZY
     C                     Z-ADDWDHONB    WEHONB           CC Company Numb
     C                     MOVELWDG6CD    WEG6CD    P      PCS Code
     C                     Z-ADDWDHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WEBONB           BOL Load Number
     C                     Z-ADDWDCVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WEB0DT           TH Kill Date
      *
     C           KLCHSE    KLIST
     C                     KFLD           WEHONB           CC Company Numb
     C                     KFLD           WEG6CD           PCS Code
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
     C           KLCHSE    CHAIN@D6CPZY              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKD6CPL8'MDACP
     C                     MOVEL'@D6CPZY' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKD61    YARDCS
      * Move non-key fields to @D6CPZY
     C                     Z-ADDWDPCHD    WEPCHD           PCD Head Receiv
     C                     Z-ADDWDPCHK    WEPCHK           PCD Head Killed
     C                     Z-ADDWDPCJA    WEPCJA           PCD Head Analyz
     C                     Z-ADDWDPCLW    WEPCLW           PCD Live Wgt
     C                     Z-ADDWDPCAL    WEPCAL           PCD Adj Live Wg
     C                     Z-ADDWDPCHW    WEPCHW           PCD Hot Wgt
     C                     Z-ADDWDPCAW    WEPCAW           PCD Avg Live Wg
     C                     Z-ADDWDPCAH    WEPCAH           PCD Avg Hot Wgt
     C                     Z-ADDWDGIPC    WEGIPC           PCD Actual Yiel
     C                     Z-ADDWDPCAB    WEPCAB           PCD Avg Backfat
     C                     Z-ADDWDPFPC    WEPFPC           PCD Avg Loin Ey
     C                     Z-ADDWDGHPC    WEGHPC           PCD Avg Lean %
     C                     Z-ADDWDGGPC    WEGGPC           PCD Head Analyz
     C                     Z-ADDWDNHPR    WENHPR           PCD Actual Base
     C                     Z-ADDWDOYPR    WEOYPR           PCD Act Base Am
     C                     Z-ADDWDOZPR    WEOZPR           PCD Act Base /L
     C                     Z-ADDWDO0PR    WEO0PR           PCD Act Base /C
     C                     Z-ADDWDO1PR    WEO1PR           PCD Act Sort Am
     C                     Z-ADDWDO2PR    WEO2PR           PCD Act Sort /L
     C                     Z-ADDWDO3PR    WEO3PR           PCD Act Sort /C
     C                     Z-ADDWDO4PR    WEO4PR           PCD Act Yld Amt
     C                     Z-ADDWDO5PR    WEO5PR           PCD Act Yld /Li
     C                     Z-ADDWDO6PR    WEO6PR           PCD Act Yld /Ca
     C                     Z-ADDWDO7PR    WEO7PR           PCD Act Lean Am
     C                     Z-ADDWDO8PR    WEO8PR           PCD Act Lean /L
     C                     Z-ADDWDO9PR    WEO9PR           PCD Act Lean /C
     C                     Z-ADDWDNIPR    WENIPR           PCD Act Gross A
     C                     Z-ADDWDNJPR    WENJPR           PCD Act Add Cos
     C                     Z-ADDWDN5PR    WEN5PR           PCD Act Cost Am
     C                     Z-ADDWDNKPR    WENKPR           PCD Act Cost /H
     C                     Z-ADDWDNLPR    WENLPR           PCD Act Cost /L
     C                     Z-ADDWDNMPR    WENMPR           PCD Act Cost /C
     C                     Z-ADDWDNNPR    WENNPR           PCD Act Kill Va
     C                     Z-ADDWDNXPR    WENXPR           PCD Act Rend Va
     C                     Z-ADDWDNPPR    WENPPR           PCD Act Cut Val
     C                     Z-ADDWDNQPR    WENQPR           PCD Act Cutout
     C                     Z-ADDWDNRPR    WENRPR           PCD Act Gross M
     C                     Z-ADDWDNSPR    WENSPR           PCD Comp Base P
     C                     Z-ADDWDOMPR    WEOMPR           PCD Comp Base A
     C                     Z-ADDWDONPR    WEONPR           PCD Comp Base /
     C                     Z-ADDWDOOPR    WEOOPR           PCD Comp Base /
     C                     Z-ADDWDOPPR    WEOPPR           PCD Comp Sort A
     C                     Z-ADDWDOQPR    WEOQPR           PCD Comp Sort /
     C                     Z-ADDWDORPR    WEORPR           PCD Comp Sort /
     C                     Z-ADDWDOSPR    WEOSPR           PCD Comp Yld Am
     C                     Z-ADDWDOTPR    WEOTPR           PCD Comp Yld /L
     C                     Z-ADDWDOUPR    WEOUPR           PCD Comp Yld /C
     C                     Z-ADDWDOVPR    WEOVPR           PCD Comp Lean A
     C                     Z-ADDWDOWPR    WEOWPR           PCD Comp Lean /
     C                     Z-ADDWDOXPR    WEOXPR           PCD Comp Lean /
     C                     Z-ADDWDNTPR    WENTPR           PCD Comp Gross
     C                     Z-ADDWDNUPR    WENUPR           PCD Comp Add Co
     C                     Z-ADDWDN6PR    WEN6PR           PCD Comp Cost A
     C                     Z-ADDWDNVPR    WENVPR           PCD Comp Cost /
     C                     Z-ADDWDNWPR    WENWPR           PCD Comp Cost /
     C                     Z-ADDWDNYPR    WENYPR           PCD Comp Cost /
     C                     Z-ADDWDNZPR    WENZPR           PCD Comp Kill V
     C                     Z-ADDWDN0PR    WEN0PR           PCD Comp Rend V
     C                     Z-ADDWDN1PR    WEN1PR           PCD Comp Cut Va
     C                     Z-ADDWDN2PR    WEN2PR           PCD Comp Cutout
     C                     Z-ADDWDN3PR    WEN3PR           PCD Comp Gross
     C                     Z-ADDWDN7PR    WEN7PR           PCD Act-Comp /H
     C                     Z-ADDWDN8PR    WEN8PR           PCD Act-Comp /L
     C                     Z-ADDWDN9PR    WEN9PR           PCD Act-Comp /C
     C                     MOVELWDQ8ST    WEQ8ST    P      PCD Source Type
     C                     MOVELWDQ9ST    WEQ9ST    P      PCD Payment Typ
     C                     Z-ADDWDPCCY    WEPCCY           PCD Calendar Ye
     C                     MOVELWDRAST    WERAST    P      PCD Calendar Qu
     C                     MOVELWDHBCD    WEHBCD    P      PCD Commodity M
     C                     MOVELWDHACD    WEHACD    P      PCD Commodity G
     C                     MOVELWDRBST    WERBST    P      PCD Unused Sts
     C                     MOVELWDRCST    WERCST    P      PCD Unused Sts
     C                     MOVELWDRDST    WERDST    P      PCD Unused Sts
     C                     MOVELWDREST    WEREST    P      PCD Unused Sts
     C                     MOVELWDRFST    WERFST    P      PCD Unused Sts
     C                     MOVELWDPDFM    WEPDFM    P      PCD Farm Site
     C                     MOVELWDHQCD    WEHQCD    P      PCD Tattoo Grou
     C                     MOVELWDABCD    WEABCD    P      PD Producer Cod
     C                     MOVELWDAECD    WEAECD    P      PL Location Cod
     C                     MOVELWDAACD    WEAACD    P      SR Source Code
     C                     MOVELWDACCD    WEACCD    P      HB Buyer Code
     C                     MOVELWDAAVN    WEAAVN    P      RS User Changed
     C                     Z-ADDWDAADT    WEAADT           RS Date Changed
     C                     Z-ADDWDAMTM    WEAMTM           RS Time Changed
     C                     MOVELWDAJST    WEAJST    P      RS Record Statu
     C                     MOVELWDAHVN    WEAHVN    P      RS Job
     C                     MOVELWDAGVN    WEAGVN    P      RS Program
     C                     MOVELWDABVN    WEABVN    P      RS User Added
     C                     Z-ADDWDABDT    WEABDT           RS Date Added
     C                     Z-ADDWDABTM    WEABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKD61    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@D6CPZY                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKD6CPL8               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFDLRC    BEGSR
      *================================================================
      * Del Prod Comp Detail  DL - Producer Comp Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @D6CPY5
     C                     Z-ADDWDHONB    WFHONB           CC Company Numb
     C                     MOVELWDG6CD    WFG6CD           PCS Code
     C                     Z-ADDWDHMNB    WFHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WFBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WFBONB           BOL Load Number
     C                     Z-ADDWDCVNB    WFCVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WFB0DT           TH Kill Date
      *
     C           KLDLSF    KLIST
     C                     KFLD           WFHONB           CC Company Numb
     C                     KFLD           WFG6CD           PCS Code
     C                     KFLD           WFHMNB           BOH Company Num
     C                     KFLD           WFBNNB           BOH Buy Order N
     C                     KFLD           WFBONB           BOL Load Number
     C                     KFLD           WFCVNB           TH Tattoo Numbe
     C                     KFLD           WFB0DT           TH Kill Date
     C           KLDLSF    CHAIN@D6CPY5              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKD6CPL0'MDACP
     C                     MOVEL'@D6CPY5' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@D6CPY5                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGDLRC    BEGSR
      *================================================================
      * Del Prd Comp Sel      DL - Producer Comp Selection  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @D5CPY7
     C                     Z-ADDWAHONB    WGHONB           CC Company Numb
     C                     MOVELWAG6CD    WGG6CD           PCS Code
      *
     C           KLDLSG    KLIST
     C                     KFLD           WGHONB           CC Company Numb
     C                     KFLD           WGG6CD           PCS Code
     C           KLDLSG    CHAIN@D5CPY7              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKD5CPL1'MDACP
     C                     MOVEL'@D5CPY7' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@D5CPY7                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHONB           CC Company Numb
     C                     Z-ADD*ZERO     WADGDT           PCS From Kill D
     C                     Z-ADD*ZERO     WADHDT           PCS To Kill Dat
     C                     Z-ADD*ZERO     WANFPR           PCS Market Add/
     C                     Z-ADD*ZERO     WANGPR           PCS Market Pric
     C                     Z-ADD*ZERO     WAN4PR           PCS Gross +/- /
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHONB           CC Company Numb
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBBONB           BOL Load Number
     C                     Z-ADD*ZERO     WBCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WBB0DT           TH Kill Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHONB           CC Company Numb
     C                     Z-ADD*ZERO     WDHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WDBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WDBONB           BOL Load Number
     C                     Z-ADD*ZERO     WDCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WDB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WDPCHD           PCD Head Receiv
     C                     Z-ADD*ZERO     WDPCHK           PCD Head Killed
     C                     Z-ADD*ZERO     WDPCJA           PCD Head Analyz
     C                     Z-ADD*ZERO     WDPCLW           PCD Live Wgt
     C                     Z-ADD*ZERO     WDPCAL           PCD Adj Live Wg
     C                     Z-ADD*ZERO     WDPCHW           PCD Hot Wgt
     C                     Z-ADD*ZERO     WDPCAW           PCD Avg Live Wg
     C                     Z-ADD*ZERO     WDPCAH           PCD Avg Hot Wgt
     C                     Z-ADD*ZERO     WDGIPC           PCD Actual Yiel
     C                     Z-ADD*ZERO     WDPCAB           PCD Avg Backfat
     C                     Z-ADD*ZERO     WDPFPC           PCD Avg Loin Ey
     C                     Z-ADD*ZERO     WDGHPC           PCD Avg Lean %
     C                     Z-ADD*ZERO     WDGGPC           PCD Head Analyz
     C                     Z-ADD*ZERO     WDNHPR           PCD Actual Base
     C                     Z-ADD*ZERO     WDOYPR           PCD Act Base Am
     C                     Z-ADD*ZERO     WDOZPR           PCD Act Base /L
     C                     Z-ADD*ZERO     WDO0PR           PCD Act Base /C
     C                     Z-ADD*ZERO     WDO1PR           PCD Act Sort Am
     C                     Z-ADD*ZERO     WDO2PR           PCD Act Sort /L
     C                     Z-ADD*ZERO     WDO3PR           PCD Act Sort /C
     C                     Z-ADD*ZERO     WDO4PR           PCD Act Yld Amt
     C                     Z-ADD*ZERO     WDO5PR           PCD Act Yld /Li
     C                     Z-ADD*ZERO     WDO6PR           PCD Act Yld /Ca
     C                     Z-ADD*ZERO     WDO7PR           PCD Act Lean Am
     C                     Z-ADD*ZERO     WDO8PR           PCD Act Lean /L
     C                     Z-ADD*ZERO     WDO9PR           PCD Act Lean /C
     C                     Z-ADD*ZERO     WDNIPR           PCD Act Gross A
     C                     Z-ADD*ZERO     WDNJPR           PCD Act Add Cos
     C                     Z-ADD*ZERO     WDN5PR           PCD Act Cost Am
     C                     Z-ADD*ZERO     WDNKPR           PCD Act Cost /H
     C                     Z-ADD*ZERO     WDNLPR           PCD Act Cost /L
     C                     Z-ADD*ZERO     WDNMPR           PCD Act Cost /C
     C                     Z-ADD*ZERO     WDNNPR           PCD Act Kill Va
     C                     Z-ADD*ZERO     WDNXPR           PCD Act Rend Va
     C                     Z-ADD*ZERO     WDNPPR           PCD Act Cut Val
     C                     Z-ADD*ZERO     WDNQPR           PCD Act Cutout
     C                     Z-ADD*ZERO     WDNRPR           PCD Act Gross M
     C                     Z-ADD*ZERO     WDNSPR           PCD Comp Base P
     C                     Z-ADD*ZERO     WDOMPR           PCD Comp Base A
     C                     Z-ADD*ZERO     WDONPR           PCD Comp Base /
     C                     Z-ADD*ZERO     WDOOPR           PCD Comp Base /
     C                     Z-ADD*ZERO     WDOPPR           PCD Comp Sort A
     C                     Z-ADD*ZERO     WDOQPR           PCD Comp Sort /
     C                     Z-ADD*ZERO     WDORPR           PCD Comp Sort /
     C                     Z-ADD*ZERO     WDOSPR           PCD Comp Yld Am
     C                     Z-ADD*ZERO     WDOTPR           PCD Comp Yld /L
     C                     Z-ADD*ZERO     WDOUPR           PCD Comp Yld /C
     C                     Z-ADD*ZERO     WDOVPR           PCD Comp Lean A
     C                     Z-ADD*ZERO     WDOWPR           PCD Comp Lean /
     C                     Z-ADD*ZERO     WDOXPR           PCD Comp Lean /
     C                     Z-ADD*ZERO     WDNTPR           PCD Comp Gross
     C                     Z-ADD*ZERO     WDNUPR           PCD Comp Add Co
     C                     Z-ADD*ZERO     WDN6PR           PCD Comp Cost A
     C                     Z-ADD*ZERO     WDNVPR           PCD Comp Cost /
     C                     Z-ADD*ZERO     WDNWPR           PCD Comp Cost /
     C                     Z-ADD*ZERO     WDNYPR           PCD Comp Cost /
     C                     Z-ADD*ZERO     WDNZPR           PCD Comp Kill V
     C                     Z-ADD*ZERO     WDN0PR           PCD Comp Rend V
     C                     Z-ADD*ZERO     WDN1PR           PCD Comp Cut Va
     C                     Z-ADD*ZERO     WDN2PR           PCD Comp Cutout
     C                     Z-ADD*ZERO     WDN3PR           PCD Comp Gross
     C                     Z-ADD*ZERO     WDN7PR           PCD Act-Comp /H
     C                     Z-ADD*ZERO     WDN8PR           PCD Act-Comp /L
     C                     Z-ADD*ZERO     WDN9PR           PCD Act-Comp /C
     C                     Z-ADD*ZERO     WDPCCY           PCD Calendar Ye
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
