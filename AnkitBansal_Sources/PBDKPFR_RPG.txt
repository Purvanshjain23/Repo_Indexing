     H/TITLE Prt Prd Schedule PrmOrdPF Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJHIGH
     H* Date          : 03/03/15  Time  : 10:18:14
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPMEUCPL8IF  E           K        DISK
      * RSQ : WF OrderProd Schedule    Co/Wh/Rq/Sh/Z/DD/Ld/Od/It
      *
     FPDI8CPLQIF  E           K        DISK
      * RSQ : PS Prod Item Schedule     Co/Typ/Dte/Dept/Itm/PWhs
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FPDI5REL1IF  E           K        DISK
      * RTV : PS Production Department  Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FPDJIREL0IF  E           K        DISK
      * RTV : Item Category             Retrieval index
      *
     FPOBHREL0IF  E           K        DISK
      * RTV : Item Category Type        Retrieval index
      *
     FPDIOREL1IF  E           K        DISK
      * RTV : Item Bill Of Material     Retrieval index
      *
     FCABZRELMIF  E           K        DISK
      * RTV : Company Item              ItmTyp=PS & PkgTyp=B
      *
     FPDJDCPL1IF  E           K        DISK
      * RTV : PS Production Detail Com  Retrieval index
      *
     FPOAZCPL4IF  E           K        DISK
      * RSQ : Packaging BOM             Co/Item/Sel Bag Types
      *
     FPOARREL1IF  E           K        DISK
      * RTV : Packaging Item            Retrieval index
      *
     FPMEUCPL9IF  E           K        DISK
      * RSQ : WF OrderProd Schedule     Co/UMSEQ/PrGrp/Item
      *
     FCAB0RELCIF  E           K        DISK
      * RSQ : Item Balance              Co/Whse/Item
      *
     FOPCOCPL1IF  E           K        DISK
      * RTV : Order Comment             Retrieval index       NV
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FPBAHCPL0IF  E           K        DISK                      A
      * UPD : PS Prod Item Sch Sum Rpt  Update index
      *
     FPBANCPL0IF  E           K        DISK                      A
      * UPD : PS Prod Item Sch Dtl Rpt  Update index
      *
     FPBDKPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Prt Prd Schedule PrmOrdPF Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L7         7  1
     E                    #L3         3  1
      * Long constants
     E                    @CN#    1  07  6   @CN    25
     I@BZREG0
      * Company Item              ItmTyp=PS & PkgTyp=B
      * Renamed input format fields
     I              BZAIC3                          WAAIC3
     I              BZHGCD                          WAHGCD
     I              BZAVNA                          WAAVNA
     I              BZAWNA                          WAAWNA
     I              BZL7NA                          WAL7NA
     I              BZL8NA                          WAL8NA
     I              BZL6NA                          WAL6NA
     I              BZMFNA                          WAMFNA
     I              BZADCD                          WAADCD
     I              BZAWPC                          WAAWPC
     I              BZLXST                          WALXST
     I              BZAECD                          WAAECD
     I              BZAXPC                          WAAXPC
     I              BZLYST                          WALYST
     I              BZAFCD                          WAAFCD
     I              BZAICD                          WAAICD
     I              BZAIWG                          WAAIWG
     I              BZHICD                          WAHICD
     I              BZRBCD                          WARBCD
     I              BZFZST                          WAFZST
     I              BZAVST                          WAAVST
     I              BZCZWG                          WACZWG
     I              BZC0WG                          WAC0WG
     I              BZURTN                          WAURTN
     I              BZAJC8                          WAAJC8
     I              BZRINB                          WARINB
     I              BZRHNB                          WARHNB
     I              BZRGNB                          WARGNB
     I              BZLNCD                          WALNCD
     I              BZTFNB                          WATFNB
     I              BZN0CD                          WAN0CD
     I              BZX4ST                          WAX4ST
     I              BZTMVA                          WATMVA
     I              BZTNVA                          WATNVA
     I              BZBLPR                          WABLPR
     I              BZBMPR                          WABMPR
     I              BZLRCD                          WALRCD
     I              BZU9ST                          WAU9ST
     I              BZCMCO                          WACMCO
     I              BZQ1CD                          WAQ1CD
     I              BZQ8CD                          WAQ8CD
     I              BZCHTM                          WACHTM
     I              BZQZCD                          WAQZCD
     I              BZXWST                          WAXWST
     I              BZXXST                          WAXXST
     I              BZVMST                          WAVMST
     I              BZSWGH                          WASWGH
     I              BZPPHE                          WAPPHE
     I              BZR3CD                          WAR3CD
     I              BZSDCD                          WASDCD
     I              BZICN1                          WAICN1
     I              BZSVCD                          WASVCD
     I              BZICN2                          WAICN2
     I              BZSWCD                          WASWCD
     I              BZV2NB                          WAV2NB
     I              BZSXCD                          WASXCD
     I              BZITCN                          WAITCN
     I              BZSYCD                          WASYCD
     I              BZITC5                          WAITC5
     I              BZSZCD                          WASZCD
     I              BZICN6                          WAICN6
     I              BZS0CD                          WAS0CD
     I              BZICN7                          WAICN7
     I              BZS1CD                          WAS1CD
     I              BZICN8                          WAICN8
     I              BZS2CD                          WAS2CD
     I              BZICN9                          WAICN9
     I              BZS3CD                          WAS3CD
     I              BZICN0                          WAICN0
     I              BZS4CD                          WAS4CD
     I              BZSFNB                          WASFNB
     I              BZA3WG                          WAA3WG
     I              BZSJNB                          WASJNB
     I              BZLLCD                          WALLCD
     I              BZLMCD                          WALMCD
     I              BZP3ST                          WAP3ST
     I              BZSKNB                          WASKNB
     I              BZSLNB                          WASLNB
     I              BZSMNB                          WASMNB
     I              BZP4ST                          WAP4ST
     I              BZCFNB                          WACFNB
     I              BZCGNB                          WACGNB
     I              BZILNB                          WAILNB
     I              BZCHNB                          WACHNB
     I              BZCINB                          WACINB
     I              BZCJNB                          WACJNB
     I              BZCMNB                          WACMNB
     I              BZCNNB                          WACNNB
     I              BZCRNB                          WACRNB
     I              BZCSNB                          WACSNB
     I              BZCVNB                          WACVNB
     I              BZCWNB                          WACWNB
     I              BZCXNB                          WACXNB
     I              BZCZNB                          WACZNB
     I              BZC0NB                          WAC0NB
     I              BZN1CD                          WAN1CD
     I              BZB4NB                          WAB4NB
     I              BZB5NB                          WAB5NB
     I              BZX5ST                          WAX5ST
     I              BZX6ST                          WAX6ST
     I              BZX7ST                          WAX7ST
     I              BZPCCT                          WAPCCT
     I              BZBDNB                          WABDNB
     I              BZBJNB                          WABJNB
     I              BZSUST                          WASUST
     I              BZSVST                          WASVST
     I              BZSYST                          WASYST
     I              BZSZST                          WASZST
     I              BZS1ST                          WAS1ST
     I              BZXRCD                          WAXRCD
     I              BZXTCD                          WAXTCD
     I              BZXUCD                          WAXUCD
     I              BZF5WG                          WAF5WG
     I              BZF6WG                          WAF6WG
     I              BZF7WG                          WAF7WG
     I              BZBLNB                          WABLNB
     I              BZBNNB                          WABNNB
     I              BZS2ST                          WAS2ST
     I              BZS4ST                          WAS4ST
     I              BZS5ST                          WAS5ST
     I              BZS6ST                          WAS6ST
     I              BZS8ST                          WAS8ST
     I              BZS9ST                          WAS9ST
     I              BZTCST                          WATCST
     I              BZTDST                          WATDST
     I              BZUVST                          WAUVST
     I              BZUWST                          WAUWST
     I              BZUXST                          WAUXST
     I              BZVSST                          WAVSST
     I              BZAATM                          WAAATM
     I              BZAYNA                          WAAYNA
     I              BZA0NA                          WAA0NA
     I              BZAXDT                          WAAXDT
      *
     I@EUCPNV
      * WF OrderProd Schedule     Co/UMSEQ/PrGrp/Item
      * Renamed input format fields
     I              EUNINY                          WBNINY
     I              EUKEAA                          WBKEAA
     I              EUCOC3                          WBCOC3
     I              EUKDAA                          WBKDAA
     I              EUSPDT                          WBSPDT
     I              EUVQDT                          WBVQDT
     I              EUAPST                          WBAPST
     I              EUEXC7                          WBEXC7
     I              EUNJNY                          WBNJNY
     I              EUTUT1                          WBTUT1
     I              EUNKNY                          WBNKNY
     I              EUSODT                          WBSODT
     I              EUNLNY                          WBNLNY
     I              EUEYC7                          WBEYC7
     I              EUS1NA                          WBS1NA
     I              EUPIQT                          WBPIQT
     I              EUTWT1                          WBTWT1
     I              EURINY                          WBRINY
     I              EUTIDT                          WBTIDT
     I              EUTJDT                          WBTJDT
     I              EUTNDT                          WBTNDT
     I              EUTODT                          WBTODT
     I              EUOLST                          WBOLST
     I              EUPLAA                          WBPLAA
     I              EUVTNY                          WBVTNY
     I              EUOQST                          WBOQST
     I              EUOSST                          WBOSST
     I              EUICN6                          WBICN6
     I              EUS0CD                          WBS0CD
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      * Outward parameters
     IPARC        DS                             13
      * KEY : Order Detail              Co/Item/Whse/ReqShpDt
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Item Code
     I                                    P   3   60PAHGCD
      * I :  Warehouse Code
     I                                        7   9 PAAJCD
      * I :  Requested Ship Date
     I                                    P  10  130PAA5DT
      *
     IQPBAH1    E DSPBAHCPL0
      * UPD : PS Prod Item Sch Sum Rpt  Update index
      *
     IQPBAN1    E DSPBANCPL0
      * UPD : PS Prod Item Sch Dtl Rpt  Update index
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * I :  Warehouse Code
     I                                        1   3 P1AJCD
      * I :  Company Number
     I                                    P   4   50P1AIC3
      * I :  Requested Ship Date
     I                                    P   6   90P1A5DT
      * I :  Print Comments Usr
     I                                       10  10 P1ARST
     IP2PARM      DS
      * I :  Print HoldOvers Usr
     I                                        1   1 P2BLST
     IP3PARM      DS
      * I :  Next Production Day Usr
     I                                    P   1   40P3SRDT
     IP4PARM      DS
      * I :  Next Production Day Usr2
     I                                    P   1   40P4T3DT
     IP5PARM      DS
      * I :  Summary Selected Usr
     I                                        1   1 P5ETST
     IP6PARM      DS
      * I :  Item Primal Sched Report
     I                                        1   3 P6S0CD
     IP7PARM      DS
      * I :  Description
     I                                        1  30 P7AUNA
     IP8PARM      DS
      * FLD: PS Prod Item Sch Sum Rpt
      * I : MAP PSP Prod Run Sequence
     I                                    P   1   40P8FOC7
     IP9PARM      DS
      * I :  Base or Not Based Usr
     I                                        1   1 P9SCAA
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AJCD    PARM           WP0001  3        Warehouse Code
     C           P1AIC3    PARM           WP0002  30       Company Number
     C           P1A5DT    PARM           WP0003  70       Requested Ship
     C           P1ARST    PARM           WP0004  1        Print Comments
     C           P2BLST    PARM           WP0005  1        Print HoldOvers
     C           P3SRDT    PARM           WP0006  70       Next Production
     C           P4T3DT    PARM           WP0007  70       Next Production
     C           P5ETST    PARM           WP0008  1        Summary Selecte
     C           P6S0CD    PARM           WP0009  3        Item Primal Sch
     C           P7AUNA    PARM           WP0010 30        Description
     C           P8FOC7    PARM           WP0011  70       PSP Prod Run Se
     C           P9SCAA    PARM           WP0012  1        Base or Not Bas
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prt Prd Schedule PrmOrdPF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$VENDRPT
      * USER: On print of end of report format
      * CASE: PAR.PSP Prod Run Sequence is Not equal to zeros
     C           P8FOC7    IFNE *ZERO                      *IF
      * E3796 JJH 02/25/15 - Use Requested Ship Date
      * Crt PS Prod Item Sch SXF - PS Prod Item Sch Sum Rpt  * 
     C                     CALL 'PBE6XFR'              90  Crt PS Prod Ite
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0075  30       Company Number
     C                     PARM 06        WQ0076  20       Item Category N
     C                     PARM P6S0CD    WQ0077  3        Item Primal Sch
     C                     PARM P8FOC7    WQ0078  70       PSP Prod Run Se
     C                     PARM P6S0CD    WQ0079  3        PSP Primal Grou
     C           WUU8NY    PARM WUU8NY    WQ0080  50       PSP Report Sequ
     C                     PARM WUETVN    WQ0081 10        PSP Report ID
     C                     PARM WUUKDT    WQ0082  70       PSP Report Date
     C                     PARM WUDVTM    WQ0083  60       PSP Report Time
     C                     PARM P1AIC3    WQ0084  30       PSP Company Num
     C                     PARM P1A5DT    WQ0085  70       PSP Production
     C                     PARM P1AJCD    WQ0086  3        PSP Production
     C                     PARM WUVHDT    WQ0087  70       Date 0 RGF
     C                     PARM WURWDT    WQ0088  70       Date 1 RGF
     C                     PARM WURYDT    WQ0089  70       Date 2 RGF
     C                     PARM WUR0DT    WQ0090  70       Date 3 RGF
     C                     PARM WUR1DT    WQ0091  70       Date 3 RGT
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBE6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Prt Prd Schedule PrmOrdPF: Mainline
      *================================================================
      * Establish starting position
     C           *LOVAL    SETLL@EUCPNU                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
      * USER: Null report processing
      * CLC Set for Null Rpt   US - /UT User Source  * 
     C                     MOVEL'Y'       W0AP1P
     C                     MOVEL'Y'       W0NEWP
     C                     MOVEL'Y'       WUGGST           USR Display fie
      * At this time user source is being used due to need the print obje
      * object of the production to print regardless of records in
      * the work file
      * Prt Prd Schedule PrmOrdUS - WF OrderProd Schedule  * 
      * Embedded PRTOBJ : Prt Prd Schedule      PO
      * Excute print object in the null portion of the action diagram
      * using user source.  if this subr name is changed then this function
      * will also have to be changed
     C                     EXSR UBSUBR                     Embedded PRTOBJ
      * CASE: PAR.PSP Prod Run Sequence is Not equal to zeros
     C           P8FOC7    IFNE *ZERO                      *IF
      * E3796 JJH 02/25/15 - Use Requested Ship Date
      * Crt PS Prod Item Sch SXF - PS Prod Item Sch Sum Rpt  * 
     C                     CALL 'PBE6XFR'              90  Crt PS Prod Ite
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0011  30       Company Number
     C                     PARM 06        WQ0012  20       Item Category N
     C                     PARM P6S0CD    WQ0013  3        Item Primal Sch
     C                     PARM P8FOC7    WQ0014  70       PSP Prod Run Se
     C                     PARM WUPOAA    WQ0015  3        PSP Primal Grou
     C           WUU8NY    PARM WUU8NY    WQ0016  50       PSP Report Sequ
     C                     PARM WUETVN    WQ0017 10        PSP Report ID
     C                     PARM WUUKDT    WQ0018  70       PSP Report Date
     C                     PARM WUDVTM    WQ0019  60       PSP Report Time
     C                     PARM P1AIC3    WQ0020  30       PSP Company Num
     C                     PARM P1A5DT    WQ0021  70       PSP Production
     C                     PARM P1AJCD    WQ0022  3        PSP Production
     C                     PARM WUVHDT    WQ0023  70       Date 0 RGF
     C                     PARM WURWDT    WQ0024  70       Date 1 RGF
     C                     PARM WURYDT    WQ0025  70       Date 2 RGF
     C                     PARM WUR0DT    WQ0026  70       Date 3 RGF
     C                     PARM WUR1DT    WQ0027  70       Date 3 RGT
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBE6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        OPS Company Num
     C                     MOVEL'Y'       W0AL01  1        OPS Warehouse
     C                     MOVEL'Y'       W0AL02  1        OPS Requested S
     C                     MOVEL'Y'       W0AL03  1        OPS Schedule Sh
     C                     MOVEL'Y'       W0AL04  1        OPS Load Schedu
     C                     MOVEL'Y'       W0AL05  1        OPS Deadline De
     C                     MOVEL'Y'       W0AL06  1        OPS Deadline De
     C                     MOVEL'Y'       W0AL07  1        OPS Load Id
     C                     MOVEL'Y'       W0AL08  1        OPS Order Numbe
     C                     MOVEL'Y'       W0AL09  1        OPS Item Code
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDEUCOC3    $CCOC3           OPS Company Num
     C                     MOVEL*BLANK    $CUAT1           Blank for 3
     C                     Z-ADD*ZERO     $CFOC7           PSP Prod Run Se
      * USER: Process before print of OPS Company Number format
     C           8         MULT 1         WUXGNX           Count Records
     C                     Z-ADDWUFOC7    $CFOC7           PSP Prod Run Se
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
      * PRTOBJ calls after print of OPS Company Number format
      * Embedded PRTOBJ : Prt Prd Schedule      PO
     C                     EXSR UBSUBR                     Embedded PRTOBJ
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Load key header format
     C                     Z-ADD*ZERO     $IBNC3           Company
     C                     MOVEL*BLANK    $IAJCD           Warehouse Code
     C                     Z-ADD*ZERO     $IAODT           Scheduled Ship
     C                     Z-ADD*ZERO     $ISRDT           Next Production
     C                     Z-ADD*ZERO     $IT3DT           Next Production
     C                     MOVEL*BLANK    $IOTTX           Blank for 4
     C                     Z-ADDEUNINY    $ININY           OPS Sequence No
     C                     MOVELEUKEAA    $IKEAA           OPS Primal Grou
     C                     Z-ADDEUCOC3    $ICOC3           OPS Company Num
     C                     MOVELEUKDAA    $IKDAA           OPS Warehouse
      * USER: Process before print of OPS Warehouse format
     C                     Z-ADDP1AIC3    $IBNC3           Company
     C                     MOVELP1AJCD    $IAJCD           Warehouse Code
      * E3796 JJH 02/25/15 - Use Requested Ship Date
     C                     Z-ADDP1A5DT    $IAODT           Scheduled Ship
     C                     Z-ADDP3SRDT    $ISRDT           Next Production
     C                     Z-ADDP4T3DT    $IT3DT           Next Production
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
      * PRTOBJ calls after print of OPS Warehouse format
      * Embedded PRTOBJ : Prt Sel Prd SchItm-All2PO
     C                     EXSR UHSUBR                     Embedded PRTOBJ
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDEUCOC3    $PCOC3           OPS Company Num
     C                     MOVELEUKDAA    $PKDAA           OPS Warehouse
     C                     Z-ADDEUVQDT    $PVQDT           OPS Requested S
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Load key header format
     C                     MOVELEUKEAA    $QKEAA           OPS Primal Grou
     C                     Z-ADDEUCOC3    $QCOC3           OPS Company Num
     C                     MOVELEUKDAA    $QKDAA           OPS Warehouse
     C                     Z-ADDEUSPDT    $QSPDT           OPS Schedule Sh
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP03  1
     C                     END
      *
     C           W0AL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP04  1
     C                     END
      *
     C           W0AL05    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP05  1
     C                     END
      *
     C           W0AL06    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP06  1
     C                     END
      *
     C           W0AL07    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP07  1
     C                     END
      *
     C           W0AL08    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDEUNINY    $RNINY           OPS Sequence No
     C                     MOVEL*BLANK    $RT3T1           Usr Text 70 A
     C                     MOVELEUTUT1    $RTUT1           OPS Customer Na
     C                     Z-ADD*ZERO     $RJKNX           Count Ahead USR
     C                     MOVELEUKEAA    $RKEAA           OPS Primal Grou
     C                     Z-ADDEUNKNY    $RNKNY           OPS Load Schedu
     C                     Z-ADDEUCOC3    $RCOC3           OPS Company Num
     C                     MOVELEUKDAA    $RKDAA           OPS Warehouse
     C                     Z-ADDEUSPDT    $RSPDT           OPS Schedule Sh
     C                     MOVELEUAPST    $RAPST           OPS Report Type
     C                     Z-ADDEUEXC7    $REXC7           OPS Order Numbe
     C                     Z-ADDEUNJNY    $RNJNY           OPS Load Id
     C                     Z-ADDEUSODT    $RSODT           OPS Deadline De
     C                     Z-ADDEUNLNY    $RNLNY           OPS Deadline De
     C                     Z-ADDEUEYC7    $REYC7           OPS Item Code
     C                     MOVELEUS1NA    $RS1NA           OPS Item Descri
     C                     Z-ADDEUPIQT    $RPIQT           OPS Quantity Or
     C                     MOVELEUTWT1    $RTWT1           OPS Sort Break
      * Load related totals format
     C                     MOVEL*BLANK    $TVTT1           Est Prd Ready T
     C                     Z-ADD*ZERO     $TK0DT           Product Complet
     C                     MOVEL*BLANK    $TT6T1           Flag Held Over
     C                     MOVEL*BLANK    $TULTX           Day of the Week
     C                     MOVELEUKEAA    $TKEAA           OPS Primal Grou
     C                     Z-ADDEUCOC3    $TCOC3           OPS Company Num
     C                     MOVELEUKDAA    $TKDAA           OPS Warehouse
     C                     Z-ADDEUEXC7    $TEXC7           OPS Order Numbe
     C                     Z-ADDEUNJNY    $TNJNY           OPS Load Id
     C                     Z-ADDEUNKNY    $TNKNY           OPS Load Schedu
     C                     Z-ADDEUSODT    $TSODT           OPS Deadline De
     C                     Z-ADD*ZERO     $TYBNB           Deadline Depart
     C                     Z-ADDEUNLNY    $TNLNY           OPS Deadline De
     C                     MOVEL*BLANK    $TUITX           USR Text 70
      * USER: Process before print of OPS Order Number format
      * Figure out the breaking on look ahead lines
     C                     Z-ADDWUXGNX    WUJKNX           Count Ahead USR
      * Count the number of items for this break
     C                     Z-ADD00000     WUNVNY           Count Items Rec
      * Cnt Ord Prd Schedule  XF - WF OrderProd Schedule  * 
     C                     CALL 'PMA6XFR'              90  Cnt Ord Prd Sch
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $RKEAA    WQ0043  6        OPS Primal Grou
     C                     PARM $RCOC3    WQ0044  30       OPS Company Num
     C                     PARM $RKDAA    WQ0045  3        OPS Warehouse
     C                     PARM $RSPDT    WQ0046  70       OPS Schedule Sh
     C                     PARM $REXC7    WQ0047  70       OPS Order Numbe
     C                     PARM $RNJNY    WQ0048  70       OPS Load Id
     C                     PARM $RNKNY    WQ0049  50       OPS Load Schedu
     C                     PARM $RSODT    WQ0050  70       OPS Deadline De
     C                     PARM $RNLNY    WQ0051  60       OPS Deadline De
     C           WUNVNY    PARM WUNVNY    WQ0052  50       Count Items Rec
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMA6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ADD  WUNVNY    WUJKNX           Count Ahead USR
      * order comments on invoice 1 line  if found
      * RTV First 70char       RT - Order Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$RCOC3    WL0081           Company Number
     C                     Z-ADD$REXC7    WL0082           Order Number
     C                     MOVEL'IN'      WL0083    P      Comment Type
     C                     MOVELYL0038    WL0084    P      USR Text 70
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0084    YL0038    P      USR Text 70
      * CASE: LCL.USR Text 70 is Blank
     C           YL0038    IFEQ *BLANK                     *IF
      * Do not count the invoice comment line field is blank
     C                     ELSE
      * CASE: *OTHERWISE
      * Do count the invoice comment line
     C                     ADD  00001     WUJKNX           Count Ahead USR
     C                     END                             *FI
      * Add 2 lines for total   data line and dash
     C                     ADD  00002     WUJKNX           Count Ahead USR
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Count Ahead USR is GT 80
      *   |- c2    : WRK.Page Control Usr is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUJKNX    IFGT 80                         *IF
     C           WUPGST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       W0NEWP           *new page flag
     C                     END                             *FI
     C                     Z-ADDWUJKNX    $RJKNX           Count Ahead USR
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP08  1
     C                     END
      *
     C           W0AL09    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP09  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDEUNINY    $SNINY           OPS Sequence No
     C                     MOVELEUKEAA    $SKEAA           OPS Primal Grou
     C                     Z-ADDEUCOC3    $SCOC3           OPS Company Num
     C                     MOVELEUKDAA    $SKDAA           OPS Warehouse
     C                     MOVELEUAPST    $SAPST           OPS Report Type
     C                     Z-ADDEUEXC7    $SEXC7           OPS Order Numbe
     C                     Z-ADDEUNJNY    $SNJNY           OPS Load Id
     C                     MOVELEUTUT1    $STUT1           OPS Customer Na
     C                     Z-ADDEUNKNY    $SNKNY           OPS Load Schedu
     C                     Z-ADDEUSODT    $SSODT           OPS Deadline De
     C                     Z-ADDEUNLNY    $SNLNY           OPS Deadline De
     C                     Z-ADDEUEYC7    $SEYC7           OPS Item Code
     C                     MOVELEUS1NA    $SS1NA           OPS Item Descri
     C                     Z-ADDEUSPDT    $SSPDT           OPS Schedule Sh
     C                     Z-ADDEUVQDT    $SVQDT           OPS Requested S
     C                     Z-ADDEUPIQT    $SPIQT           OPS Quantity Or
     C                     Z-ADD*ZERO     $SN1NY           OPS QTY SHIP PR
     C                     Z-ADDEUTNDT    $STNDT           Production AgeD
     C                     MOVELEUTWT1    $STWT1           OPS Sort Break
     C                     Z-ADDEURINY    $SRINY           Item Age Days
     C                     Z-ADDEUTIDT    $STIDT           Production Ovr
     C                     Z-ADDEUTJDT    $STJDT           Production Ovr
     C                     Z-ADDEUTODT    $STODT           Production AgeD
     C                     MOVELEUOLST    $SOLST           OPS Print on De
     C                     MOVELEUPLAA    $SPLAA           OPS U/M Primary
     C                     Z-ADDEUVTNY    $SVTNY           OPS U/M Sequenc
     C                     MOVELEUOQST    $SOQST           OPS Status 1
     C                     MOVELEUOSST    $SOSST           OPS Status 2
     C                     Z-ADDEUICN6    $SICN6           Item Category N
     C                     MOVELEUS0CD    $SS0CD           Item Primal Sch
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN EUCOC3    WZA001           OPS Company Num
     C                     Z-ADDEUCOC3    WZA001
     C           *LIKE     DEFN EUKDAA    WZA002           OPS Warehouse
     C                     MOVELEUKDAA    WZA002
     C           *LIKE     DEFN EUVQDT    WZA003           OPS Requested S
     C                     Z-ADDEUVQDT    WZA003
     C           *LIKE     DEFN EUSPDT    WZA004           OPS Schedule Sh
     C                     Z-ADDEUSPDT    WZA004
     C           *LIKE     DEFN EUNKNY    WZA005           OPS Load Schedu
     C                     Z-ADDEUNKNY    WZA005
     C           *LIKE     DEFN EUSODT    WZA006           OPS Deadline De
     C                     Z-ADDEUSODT    WZA006
     C           *LIKE     DEFN EUNLNY    WZA007           OPS Deadline De
     C                     Z-ADDEUNLNY    WZA007
     C           *LIKE     DEFN EUNJNY    WZA008           OPS Load Id
     C                     Z-ADDEUNJNY    WZA008
     C           *LIKE     DEFN EUEXC7    WZA009           OPS Order Numbe
     C                     Z-ADDEUEXC7    WZA009
     C           *LIKE     DEFN EUEYC7    WZA010           OPS Item Code
     C                     Z-ADDEUEYC7    WZA010
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C                     READ @EUCPNU                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
     C                     MOVEL'N'       W0RSL            *Record selecte
      * CASE: DB1.OPS Print on Detail Sch is yes
     C           EUOLST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ADD  1         WUXGNX           Count Records
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        OPS Company Num
     C                     MOVEL*BLANK    W0AL01  1        OPS Warehouse
     C                     MOVEL*BLANK    W0AL02  1        OPS Requested S
     C                     MOVEL*BLANK    W0AL03  1        OPS Schedule Sh
     C                     MOVEL*BLANK    W0AL04  1        OPS Load Schedu
     C                     MOVEL*BLANK    W0AL05  1        OPS Deadline De
     C                     MOVEL*BLANK    W0AL06  1        OPS Deadline De
     C                     MOVEL*BLANK    W0AL07  1        OPS Load Id
     C                     MOVEL*BLANK    W0AL08  1        OPS Order Numbe
     C                     MOVEL*BLANK    W0AL09  1        OPS Item Code
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        OPS Company Num
     C                     MOVEL'Y'       W0AL01  1        OPS Warehouse
     C                     MOVEL'Y'       W0AL02  1        OPS Requested S
     C                     MOVEL'Y'       W0AL03  1        OPS Schedule Sh
     C                     MOVEL'Y'       W0AL04  1        OPS Load Schedu
     C                     MOVEL'Y'       W0AL05  1        OPS Deadline De
     C                     MOVEL'Y'       W0AL06  1        OPS Deadline De
     C                     MOVEL'Y'       W0AL07  1        OPS Load Id
     C                     MOVEL'Y'       W0AL08  1        OPS Order Numbe
     C                     MOVEL'Y'       W0AL09  1        OPS Item Code
     C                     ELSE
      * Next record - Detect level breaks
     C           EUCOC3    IFNE WZA001                     OPS Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           EUKDAA    IFNE WZA002                     OPS Warehouse
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           EUVQDT    IFNE WZA003                     OPS Requested S
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C           EUSPDT    IFNE WZA004                     OPS Schedule Sh
     C           W0AL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL03
     C                     END
     C           EUNKNY    IFNE WZA005                     OPS Load Schedu
     C           W0AL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL04
     C                     END
     C           EUSODT    IFNE WZA006                     OPS Deadline De
     C           W0AL04    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL05
     C                     END
     C           EUNLNY    IFNE WZA007                     OPS Deadline De
     C           W0AL05    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL06
     C                     END
     C           EUNJNY    IFNE WZA008                     OPS Load Id
     C           W0AL06    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL07
     C                     END
     C           EUEXC7    IFNE WZA009                     OPS Order Numbe
     C           W0AL07    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL08
     C                     END
     C           EUEYC7    IFNE WZA010                     OPS Item Code
     C           W0AL08    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL09
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL09    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP09
     C                     END
      *
     C           W0AL08    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of OPS Order Number format
      * E3796 JJH 02/25/15 - Use Requested Ship Date
      * CASE: PAR.Requested Ship Date GT JOB.*Job date
     C           P1A5DT    IFGT ##JDT                      *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * Order break add 1 to line counter
     C                     ADD  1         WUXGNX           Count Records
     C                     MOVELWUULTX    $TULTX           Day of the Week
     C                     Z-ADDWUYBNB    $TYBNB           Deadline Depart
     C                     MOVELWUT6T1    $TT6T1           Flag Held Over
      * RTV First 70char       RT - Order Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$TCOC3    WL0081           Company Number
     C                     Z-ADD$TEXC7    WL0082           Order Number
     C                     MOVEL'IN'      WL0083    P      Comment Type
     C                     MOVEL$TUITX    WL0084    P      USR Text 70
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0084    $TUITX    P      USR Text 70
      * If comments  will be printed then add 1 line
      * CASE: CUR.USR Text 70 is Blank
     C           $TUITX    IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUHDSX           Display Ord Dtl
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUHDSX           Display Ord Dtl
     C                     ADD  1         WUXGNX           Count Records
     C                     END                             *FI
      * Print Order information add 1 to line counter
     C                     ADD  1         WUXGNX           Count Records
      * Print Order information dash line
     C                     ADD  1         WUXGNX           Count Records
     C                     MOVEL*BLANK    $TVTT1           Est Prd Ready T
      * Rtv ProdInfm          Rt - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$TNJNY    WL0085           Load ID
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0086    YL0039           Product Tempera
     C                     Z-ADDWL0087    YL0040           Product Complet
     C                     Z-ADDWL0088    YL0041           Product Complet
      * Build Est Product Ready Time from Product Completed Date
      * CASE: LCL.Product Complete Date is Entered
     C           YL0040    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    YL0042           Date (Alpha) US
     C                     MOVELYL0040    YL0042           Date (Alpha) US
     C                     MOVEL*BLANK    YL0043           Time Alpha usr
     C                     MOVELYL0041    YL0043           Time Alpha usr
      * Mov DteTme MM dd YY.etcXF - /UT Functions  * 
     C                     CALL 'PNI4XFR'              90  Mov DteTme MM d
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0042    WQ0066  7        Date (Alpha) US
     C                     PARM YL0043    WQ0067  6        Time Alpha usr
     C           WUT5TX    PARM *BLANK    WQ0068  2        Month (Char) US
     C           WUT6TX    PARM *BLANK    WQ0069  2        Day   (Char) US
     C           WUVQT1    PARM *BLANK    WQ0070  2        Century Usr TXT
     C           WUT4TX    PARM *BLANK    WQ0071  2        Year  (Char) US
     C           WUVDCD    PARM *BLANK    WQ0072  2        Hours  2A
     C           WUVECD    PARM *BLANK    WQ0073  2        Minutes  2A
     C           WUY6CD    PARM *BLANK    WQ0074  2        Seconds 2A
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNI4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * format date to field and underline field
      * mm/
     C                     Z-ADD*ZERO     ZQ      50
     C           WUT5TX    CAT  '/':ZQ    $TVTT1    P      Est Prd Ready T
      * dd
     C                     Z-ADD*ZERO     ZQ      50
     C           $TVTT1    CAT  WUT6TX:ZQ $TVTT1    P      Est Prd Ready T
      * /
     C                     Z-ADD*ZERO     ZQ      50
     C           $TVTT1    CAT  '/':ZQ    $TVTT1    P      Est Prd Ready T
      * year
     C                     Z-ADD*ZERO     ZQ      50
     C           $TVTT1    CAT  WUT4TX:ZQ $TVTT1    P      Est Prd Ready T
      * /
     C                     Z-ADD1         ZQ      50
     C           $TVTT1    CAT  '/':ZQ    $TVTT1    P      Est Prd Ready T
      * Hours
     C                     Z-ADD1         ZQ      50
     C           $TVTT1    CAT  WUVDCD:ZQ $TVTT1    P      Est Prd Ready T
      * :
     C                     Z-ADD*ZERO     ZQ      50
     C           $TVTT1    CAT  ':':ZQ    $TVTT1    P      Est Prd Ready T
      * min
     C                     Z-ADD*ZERO     ZQ      50
     C           $TVTT1    CAT  WUVECD:ZQ $TVTT1    P      Est Prd Ready T
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 4
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Convert OPS Deadline Depart Date to display format
      * Convert date
     C           1000000   ADD  $TSODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VTSODT
     C                     MOVEL'0'       *IN79
     C           YL0002    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WUHDSX    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      * Print format
     C                     WRITE$TKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP08
     C                     END
      *
     C           W0AL07    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP07
     C                     END
      *
     C           W0AL06    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP06
     C                     END
      *
     C           W0AL05    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP05
     C                     END
      *
     C           W0AL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP04
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP03
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
     C                     MOVEL'0'       *IN79
     C           WUGGST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$UFINTTL
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * Prt Prd Schedule PrmPsPO: Mainline
      *================================================================
      * Prt Prd Schedule PrmPsPO: Initialise
     C                     EXSR ZBINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN I8AIC3    WQKB01           Company Number
     C           *LIKE     DEFN I8V5ST    WQKB02           Production Type
     C           *LIKE     DEFN I8ELDT    WQKB03           Production Date
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           Company Number
     C                     KFLD           WQKB02           Production Type
     C                     KFLD           WQKB03           Production Date
      * Setup key
     C                     Z-ADDP1AIC3    WQKB01           Company Number
     C                     MOVELWUFCST    WQKB02           Production Type
     C                     Z-ADDP1A5DT    WQKB03           Production Date
      * Establish starting position
     C           KRSB      SETLL@I8CPAD                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Production Type
     C                     MOVEL'Y'       W0BL02  1        Production Date
     C                     MOVEL'Y'       W0BL03  1        Department Code
     C                     MOVEL'Y'       W0BL04  1        Item Code
     C                     MOVEL'Y'       W0BL05  1        PS Production W
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDI8AIC3    $DAIC3           Company Number
     C                     MOVEL*BLANK    $DSQTX           Company Name DR
     C                     Z-ADDI8ELDT    $DELDT           Production Date
     C                     MOVEL*BLANK    $DHLTX           Condition Desc.
     C                     MOVELI8B7ST    $DB7ST           PS Production W
     C                     MOVELI8AJCD    $DAJCD           Warehouse Code
     C                     MOVEL*BLANK    $DO6NA           Warehouse Desc
     C                     Z-ADD*ZERO     $DFOC7           PSP Prod Run Se
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDI8AIC3    $EAIC3           Company Number
     C                     MOVELI8V5ST    $EV5ST           Production Type
     C                     Z-ADDI8ELDT    $EELDT           Production Date
     C                     MOVELI8R3CD    $ER3CD           Department Code
     C                     MOVEL*BLANK    $EMYNA           Department Desc
      * USER: Process before print of Department Code format
      * Rtv Prod Dept Name    RT - PS Production Department  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$EAIC3    WL0003           Company Number
     C                     MOVEL$ER3CD    WL0004    P      Department Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    $EMYNA    P      Department Desc
     C                     MOVEL$ER3CD    WUO6AA           PSP Department
     C                     MOVEL$EMYNA    WUT5NA           PSP Department
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP03  1
     C                     END
      *
     C           W0BL04    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDI8AIC3    $GAIC3           Company Number
     C                     MOVELI8V5ST    $GV5ST           Production Type
     C                     Z-ADDI8ELDT    $GELDT           Production Date
     C                     Z-ADDI8HGCD    $GHGCD           Item Code
     C                     MOVEL*BLANK    $GPFTX           Text 1 Length U
     C                     MOVEL*BLANK    $GQZCD           Base/Conv/Loss
     C                     MOVEL*BLANK    $GAVNA           Description Lin
     C                     Z-ADD*ZERO     $GQBQT           Qty Production
     C                     MOVEL*BLANK    $GADCD           U/M - Primary
     C                     MOVEL*BLANK    $GNYNA           Box Description
     C                     MOVEL*BLANK    $GBRAA           Packaging Item
     C                     MOVEL*BLANK    $GALNA           Comment Line 1
     C                     MOVEL*BLANK    $GXITX           Pckg Item Descr
     C                     MOVEL*BLANK    $GSHTX           Text USR 40
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP04  1
      * USER: Process after print of Item Code format
      * slm 050514 - New request for packaging.
      * write out the  WF record for this total
     C                     END
      *
     C           W0BL05    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP05  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDI8AIC3    $FAIC3           Company Number
     C                     MOVELI8V5ST    $FV5ST           Production Type
     C                     Z-ADDI8ELDT    $FELDT           Production Date
     C                     MOVEL*BLANK    $FI6TX           Description 14A
     C                     Z-ADDI8HGCD    $FHGCD           Item Code
     C                     MOVEL*BLANK    $FAVNA           Description Lin
     C                     Z-ADD*ZERO     $FWPRD           Quantity Produc
     C                     MOVEL*BLANK    $FADCD           U/M - Primary
     C                     MOVEL*BLANK    $FNYNA           Box Description
     C                     MOVEL*BLANK    $FBRAA           Packaging Item
     C                     MOVEL*BLANK    $FALNA           Comment Line 1
     C                     MOVEL*BLANK    $FXITX           Pckg Item Descr
     C                     MOVELI8AJCD    $FAJCD           Warehouse Code
     C                     Z-ADD*ZERO     $FHNQT           Qty Sched To Pr
     C                     MOVELI8B7ST    $FB7ST           PS Production W
     C                     Z-ADD*ZERO     $FCNNB           WIP Item Code
     C                     Z-ADD*ZERO     $FF2WG           Weight Sched Pr
     C                     Z-ADD*ZERO     $FPIAC           Pieces Schedule
     C                     Z-ADDI8DVWG    $FDVWG           PS Weight Order
     C                     Z-ADDI8D7NB    $FD7NB           PS Pieces Order
     C                     Z-ADDI8FCAD    $FFCAD           PS Weight FC Ad
     C                     Z-ADDI8D9NB    $FD9NB           PS Pieces FC Ad
     C                     Z-ADDI8DWWG    $FDWWG           PS Weight FX Ad
     C                     Z-ADDI8EANB    $FEANB           PS Pieces FX Ad
     C                     Z-ADDI8AVWT    $FAVWT           PS Weight Avail
     C                     Z-ADDI8ECNB    $FECNB           PS Pieces Avail
     C                     Z-ADDI8WTON    $FWTON           PS Weight Produ
     C                     Z-ADDI8EDNB    $FEDNB           PS Pieces Produ
     C                     Z-ADDI8WTCN    $FWTCN           PS Weight Conve
     C                     Z-ADDI8PSCV    $FPSCV           PS Pieces Conve
     C                     Z-ADDI8FNWT    $FFNWT           PS Weight Fab N
     C                     Z-ADDI8EENB    $FEENB           PS Pieces Fab N
     C                     Z-ADDI8DXWG    $FDXWG           PS Weight Stand
     C                     Z-ADDI8B2NB    $FB2NB           PS Pieces Stand
     C                     Z-ADDI8QTSP    $FQTSP           PS Pieces Plann
     C                     Z-ADDI8WAIO    $FWAIO           PS Weight Sched
     C                     Z-ADDI8EGNB    $FEGNB           PS Pieces Sched
     C                     Z-ADDI8UNW2    $FUNW2           PS Weight Inv A
     C                     Z-ADDI8CENB    $FCENB           PS Pieces Inv A
     C                     Z-ADDI8F9WG    $FF9WG           PS Unit Weight
     C                     Z-ADDI8BPNB    $FBPNB           PS Pieces Whse
     C                     Z-ADDI8GAWG    $FGAWG           PS Weight Whse
     C                     Z-ADDI8BQNB    $FBQNB           PS Pieces Unuse
     C                     Z-ADDI8GBWG    $FGBWG           PS Weight Unuse
     C                     Z-ADDI8BRNB    $FBRNB           PS Pieces Unuse
     C                     Z-ADDI8GCWG    $FGCWG           PS Weight Unuse
     C                     Z-ADDI8BSNB    $FBSNB           PS Pieces Unuse
     C                     Z-ADDI8GDWG    $FGDWG           PS Weight Unuse
     C                     Z-ADDI8BWNB    $FBWNB           PS Pieces Unuse
     C                     Z-ADDI8GEWG    $FGEWG           PS Weight Unuse
     C                     Z-ADDI8PS6U    $FPS6U           PS Pieces Unuse
     C                     Z-ADDI8E0WG    $FE0WG           PS Weight Ship
     C                     Z-ADDI8D6NB    $FD6NB           PS Pieces Ship
     C                     Z-ADDI8WTSP    $FWTSP           PS Weight Plann
     C                     Z-ADDI8WTIN    $FWTIN           PS Weight Inv O
     C                     Z-ADDI8D5NB    $FD5NB           PS Pieces Inv O
     C                     Z-ADDI8SHWT    $FSHWT           PS Weight Sched
     C                     Z-ADDI8EBNB    $FEBNB           PS Pieces Sched
     C                     Z-ADDI8DJPC    $FDJPC           PS % of Carcass
     C                     Z-ADDI8F8WG    $FF8WG           PS Avg Piece Wg
     C                     Z-ADDI8GPDT    $FGPDT           PS Available Sh
     C                     Z-ADDI8QTAS    $FQTAS           PS Weight Sched
     C                     Z-ADDI8EFNB    $FEFNB           PS Pieces Sched
     C                     Z-ADDI8OAWT    $FOAWT           PS Weight Prod
     C                     Z-ADDI8CDNB    $FCDNB           PS Pieces Prod
     C                     Z-ADDI8SAWT    $FSAWT           PS Weight Shipp
     C                     Z-ADDI8B9NB    $FB9NB           PS Pieces Shipp
     C                     Z-ADDI8D1WG    $FD1WG           PS Weight Prod
     C                     Z-ADDI8CBNB    $FCBNB           PS Pieces Prod
     C                     Z-ADDI8EZWG    $FEZWG           PS Weight Inv A
     C                     Z-ADDI8CCNB    $FCCNB           PS Pieces Inv A
     C                     MOVELI8WCST    $FWCST           PS Item Id
     C                     MOVELI8WPST    $FWPST           Warehouse Type
     C                     MOVELI8B5ST    $FB5ST           PS Lock Status
     C                     MOVELI8TFST    $FTFST           PS Export/Domes
     C                     MOVELI8TEST    $FTEST           PS Print On Sch
     C                     MOVELI8THST    $FTHST           PS Piece Count
     C                     MOVELI8UDST    $FUDST           PS Unused Sts 1
     C                     MOVELI8UFST    $FUFST           PS Unused Sts 2
     C                     MOVELI8UGST    $FUGST           PS Unused Sts 3
     C                     MOVELI8UHST    $FUHST           PS Unused Sts 4
     C                     MOVELI8B6ST    $FB6ST           PS Item Sched N
     C                     MOVELI8R3CD    $FR3CD           Department Code
     C                     Z-ADDI8RGNB    $FRGNB           Item Structure
     C                     Z-ADDI8RHNB    $FRHNB           Item Structure
     C                     Z-ADDI8RINB    $FRINB           Item Structure
     C                     MOVELI8XRCD    $FXRCD           Primal Group Co
     C                     MOVELI8UVST    $FUVST           EDI Status 1
     C                     MOVELI8UWST    $FUWST           EDI Status 2
     C                     MOVELI8UXST    $FUXST           EDI Status 3
     C                     MOVELI8VSST    $FVSST           Record Status
     C                     Z-ADDI8AATM    $FAATM           Job Time
     C                     MOVELI8AYNA    $FAYNA           User Id
     C                     MOVELI8A0NA    $FA0NA           Job Name
     C                     Z-ADDI8AXDT    $FAXDT           Job Date
      * USER: Process before print of detail format
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN I8AIC3    WZB001           Company Number
     C                     Z-ADDI8AIC3    WZB001
     C           *LIKE     DEFN I8V5ST    WZB002           Production Type
     C                     MOVELI8V5ST    WZB002
     C           *LIKE     DEFN I8ELDT    WZB003           Production Date
     C                     Z-ADDI8ELDT    WZB003
     C           *LIKE     DEFN I8R3CD    WZB004           Department Code
     C                     MOVELI8R3CD    WZB004
     C           *LIKE     DEFN I8HGCD    WZB005           Item Code
     C                     Z-ADDI8HGCD    WZB005
     C           *LIKE     DEFN I8B7ST    WZB006           PS Production W
     C                     MOVELI8B7ST    WZB006
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@I8CPAD                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * Select warehouse (Production warehouse)
      * CASE: PAR.PS Production Warehouse is Entered
     C           P1AJCD    IFNE *BLANK                     *IF
      * CASE: PAR.PS Production Warehouse NE DB1.PS Production Warehouse
     C           P1AJCD    IFNE I8B7ST                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Prd Sch Info   PS3RT - Company Item  * 
     C                     EXSR SFRVGN
      * Selection - Additional -Print on Schedule=N & eq to Report Sel
      * CASE: PAR.Print On Schedule is yes
     C           WN0006    IFEQ 'Y'                        *IF
      * Item category 06 = to user selection
      * Primal Group  only print ones that the print schedule = N
      * only print category 6 primal report request
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: WRK.Item Primal Sched Report NE PAR.Item Primal Sched Repor
     C           WUS0CD    IFNE P6S0CD                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Rtv PrimSchGrp Desc   RT - Item Category  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0006           Company Number
     C                     Z-ADD06        WL0007           Item Category N
     C                     MOVELP6S0CD    WL0008    P      Item Category C
     C                     MOVELYL0003    WL0009    P      Description
     C                     MOVELYL0005    WL0011    P      Item Category T
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0009    YL0003    P      Description
     C                     MOVELWL0010    YL0004    P      EDI Status 3
     C                     MOVELWL0011    YL0005    P      Item Category T
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Addition sel boxes  IF SND to carlisle bx, and combos else bx onl
     C                     EXSR UDSUBR                     Addition sel bo
     C                     END                             *FI
     C                     Z-ADDI8EFNB    WUVZNY           PSP Pieces Sche
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * CASE: WRK.Base/Conv/Loss Item is Base
     C           WUQZCD    IFEQ 'B'                        *IF
     C                     Z-ADDI8OAWT    WUF2WG           Weight Sched Pr
     C                     Z-ADDI8CDNB    WUPIAC           Pieces Schedule
     C                     ELSE
      * CASE: *OTHERWISE
      * Weight Schedule production
     C                     EXSR UESUBR                     Weight Schedule
      * Pieces Scheduled
     C                     EXSR UFSUBR                     Pieces Schedule
     C                     END                             *FI
      * correction on divide by zero
     C                     MOVEL*BLANK    WUEJST           Item Piece Coun
      * Quantity Production
      * CASE: DB1.PS Piece Count Item is yes
     C           I8THST    IFEQ 'Y'                        *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Pieces Per Bag is EQ Zero
      *   |- c2    : PAR.Bags Per Unit is EQ Zero
      *   '-
     C           WN0004    IFEQ *ZERO                      *IF
     C           WN0005    OREQ *ZERO                      *OR
     C                     Z-ADD*ZERO     WUWPRD           Quantity Produc
     C                     MOVEL'Y'       WUEJST           Item Piece Coun
     C                     ELSE
      * CASE: *OTHERWISE
      * Quantity Production
      * WRK.Quantity Production USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : WRK.Pieces Scheduled
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *
      * x3    : PAR.Bags Per Unit
     C           WN0004    MULT WN0005    W0WJ01           *Synon (15,0) w
     C           WUPIAC    DIV  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WUWPRD           Quantity Produc
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Unit Weight is Equal to zero
     C           WN0002    IFEQ *ZERO                      *IF
     C                     Z-ADD*ZERO     WUWPRD           Quantity Produc
     C                     ELSE
      * CASE: *OTHERWISE
      * Quantity Production
      * WRK.Quantity Production USR =
      *    *COMPUTE (x1 / x2)
      * x1    : WRK.Weight Sched Prod USR
      * /     : PGM.*Synon (15,0) work field *
      * x2    : PAR.Unit Weight
     C           WUF2WG    DIV  WN0002    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WUWPRD           Quantity Produc
     C                     END                             *FI
     C                     END                             *FI
      * Dont print -0- qty, do print 0 for Base items, except some
      * CASE:
      *  - c1AND c2
      *   |- c1    : WRK.Quantity Production USR is Less than/equal to Ze
      *   |- c2    : WRK.Weight Production USR is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUWPRD    IFLE *ZERO                      *IF
     C           WUFUWG    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: WRK.Base/Conv/Loss Item is Not Base
     C           WUQZCD    IFEQ *BLANK                     *IF
     C           WUQZCD    OREQ 'C'
     C           WUQZCD    OREQ 'F'
     C           WUQZCD    OREQ 'L'
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
      * E2073 6/25/12 RMC Dont print -0- qty for base items with:
      * CASE:
      *  - c1ORc3ORc4ORc5ORc6ORc7
      *   |- c1    : WRK.Item Structure Type Code is Sausage
      *   |- c3    : WRK.Item Structure Type Code is Trim
      *   |- c4    : WRK.Item Structure Type Code is eq 740
      *   |- c5    : WRK.Item Structure Group Code is eq 707
      *   |- c6    : WRK.Item Structure Class Code is eq 551
      *   |- c7    : WRK.Export/Domestic is Export
      *   '-
     C           WURGNB    IFEQ 400                        *IF
     C           WURGNB    OREQ 720                        *OR
     C           WURGNB    OREQ 740                        *OR
     C           WURHNB    OREQ 707                        *OR
     C           WURINB    OREQ 551                        *OR
     C           WUSUST    OREQ 'E'                        *OR
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PGM.*Record selected is *NO
     C           W0RSL     IFEQ 'N'                        *IF
     C                     Z-ADD*ZERO     WUWPRD           Quantity Produc
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        Company Number
     C                     MOVEL*BLANK    W0BL01  1        Production Type
     C                     MOVEL*BLANK    W0BL02  1        Production Date
     C                     MOVEL*BLANK    W0BL03  1        Department Code
     C                     MOVEL*BLANK    W0BL04  1        Item Code
     C                     MOVEL*BLANK    W0BL05  1        PS Production W
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        Company Number
     C                     MOVEL'Y'       W0BL01  1        Production Type
     C                     MOVEL'Y'       W0BL02  1        Production Date
     C                     MOVEL'Y'       W0BL03  1        Department Code
     C                     MOVEL'Y'       W0BL04  1        Item Code
     C                     MOVEL'Y'       W0BL05  1        PS Production W
     C                     ELSE
      * Next record - Detect level breaks
     C           I8AIC3    IFNE WZB001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           I8V5ST    IFNE WZB002                     Production Type
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           I8ELDT    IFNE WZB003                     Production Date
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C           I8R3CD    IFNE WZB004                     Department Code
     C           W0BL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL03
     C                     END
     C           I8HGCD    IFNE WZB005                     Item Code
     C           W0BL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL04
     C                     END
     C           I8B7ST    IFNE WZB006                     PS Production W
     C           W0BL04    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL05
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL05    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP05
     C                     END
      *
     C           W0BL04    IFEQ 'Y'
      * USER: Process before print of Item Code format
      * Rtv Prd Sch Info   PS4RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$GAIC3    WL0012           Company Number
     C                     Z-ADD$GHGCD    WL0013           Item Code
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    $GAVNA    P      Description Lin
     C                     MOVELWL0015    $GADCD    P      U/M - Primary
     C                     Z-ADDWL0016    WN0002           Unit Weight
     C                     Z-ADDWL0017    WURINB           Item Structure
     C                     Z-ADDWL0018    WURHNB           Item Structure
     C                     Z-ADDWL0019    WURGNB           Item Structure
     C                     MOVELWL0020    WUN0CD    P      Item Type Code
     C                     MOVELWL0021    WUQ1CD    P      Default Warehou
     C                     Z-ADDWL0022    WUCHTM           Fresh Chilling
     C                     MOVELWL0023    $GQZCD    P      Base/Conv/Loss
     C                     MOVELWL0024    WUXWST    P      Variety/Rendere
     C                     MOVELWL0025    WUVMST    P      Credit Item Sta
     C                     Z-ADDWL0026    WUSWGH           Std Weight/Head
     C                     Z-ADDWL0027    WUPPHE           Pieces Per Head
     C                     MOVELWL0028    WUR3CD    P      Department Code
     C                     MOVELWL0029    WUSDCD    P      Group for Packa
     C                     Z-ADDWL0030    WUCNNB           WIP Item Code
     C                     MOVELWL0031    WUX5ST    P      Seconds Item
     C                     MOVELWL0032    WN0003    P      Piece Count Ite
     C                     Z-ADDWL0033    WN0004           Pieces Per Bag
     C                     Z-ADDWL0034    WN0005           Bags Per Unit
     C                     MOVELWL0035    WUSUST    P      Export/Domestic
     C                     MOVELWL0036    WN0006    P      Print On Schedu
     C                     MOVELWL0037    WUSYST    P      Fresh Inv Alloc
     C                     MOVELWL0038    WUSZST    P      Fresh Sched As
     C                     MOVELWL0039    WUS1ST    P      Frozen Inv Allo
     C                     MOVELWL0040    WUXRCD    P      Primal Group Co
     C                     MOVELWL0041    WUS8ST    P      Label Type
      * Rtv Prod Dept Name    RT - PS Production Department  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$GAIC3    WL0003           Company Number
     C                     MOVELWUR3CD    WL0004    P      Department Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    WUMYNA    P      Department Desc
     C                     MOVEL$GQZCD    YL0006           Base/Conv/Loss
      * CASE: CUR.Base/Conv/Loss Item is Base
     C           $GQZCD    IFEQ 'B'                        *IF
     C                     MOVEL'*'       $GPFTX           Text 1 Length U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $GPFTX           Text 1 Length U
     C                     END                             *FI
     C                     MOVEL$GAVNA    WUT6NA           PSO Item Descri
      * RTV BOX ID FOR ITEM    RT - Item Bill Of Material  * 
     C                     EXSR SJRVGN
      * Rtv Comment line 1    RT - PS Production Detail Com  * 
     C                     EXSR SLRVGN
      * RTV Itm Bag Code      RT - Packaging BOM  * 
     C                     EXSR SMRVGN
      * RTV Packaging Item    RT - Packaging Item  * 
     C                     EXSR SNRVGN
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Item Code format
     C                     Z-ADDWUQBQT    $GQBQT           Qty Production
      * CASE:
      *  - c1ANDc2
      *   |- c1    : CUR.Qty Production Total Usr is Less or Equal to zer
      *   |- c2    : CUR.Base/Conv/Loss Item is Not Base
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $GQBQT    IFLE *ZERO                      *IF
     C           $GQZCD    IFEQ *BLANK                     *IF
     C           $GQZCD    OREQ 'C'
     C           $GQZCD    OREQ 'F'
     C           $GQZCD    OREQ 'L'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $GSHTX           Text USR 40
      * correction on divide by zero
      * CASE: WRK.Item Piece Count Flag Chg is yes
     C           WUEJST    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    $GSHTX           Text USR 40
     C                     MOVEL@CN,006   $GSHTX           Text USR 40
     C                     Z-ADD1         ZQ      50
     C           $GSHTX    CAT  @CN,007:ZQ$GSHTX    P      Text USR 40
     C                     END                             *FI
     C                     END                             *FI
      * capture the information from this report and place in work file
     C                     Z-ADD*ZERO     YL0007           PSP Total Piece
      * E2746 * If this item are boxes
      * then populate then day 0, day 1, day 2
     C                     Z-ADD*ZERO     YL0008           PSP Day 0
     C                     Z-ADD*ZERO     YL0009           PSP Day 1
     C                     Z-ADD*ZERO     YL0010           PSP Day 2
     C                     Z-ADD*ZERO     YL0011           PSP Week Ending
      * If Run Sequence is greater then zero then create records
      * CASE: PAR.PSP Prod Run Sequence is Greater then zero
     C           P8FOC7    IFGT *ZERO                      *IF
      * Run # greater then zero say interface but do we need the future d
      * Rtv PrimSchGrp Desc   RT - Item Category  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0006           Company Number
     C                     Z-ADD06        WL0007           Item Category N
     C                     MOVELP6S0CD    WL0008    P      Item Category C
     C                     MOVELYL0003    WL0009    P      Description
     C                     MOVELYL0005    WL0011    P      Item Category T
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0009    YL0003    P      Description
     C                     MOVELWL0010    YL0004    P      EDI Status 3
     C                     MOVELWL0011    YL0005    P      Item Category T
      * Only do this process if the Run Sequence is > zero
      * but only on base/conv/loss item that are base
      * Allow Qty Production total usr less then or equal to zero
      * Calculate Total Pieces
      * CASE: PAR.Piece Count Item is yes
     C           WN0003    IFEQ 'Y'                        *IF
      * Calculate Total pieces
      * LCL.PSP Total Pieces =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x2    : PAR.Bags Per Unit
      * *     : PGM.*Synon (17,7) work field *
      * x3    : WRK.Qty Production Total Usr
     C           WN0004    MULT WN0005    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT WUQBQT    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0007           PSP Total Piece
     C                     END                             *FI
      * Place this in the PSP consumed item
      * Rtv First Consumed Itm XF - Item Bill Of Material  * 
     C                     CALL 'POP1XFR'              90  Rtv First Consu
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0028  30       Company Number
     C                     PARM $GHGCD    WQ0029  70       Item Code
     C           YL0012    PARM *ZERO     WQ0030  70       Component Item
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POP1XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ADD  1         WUU8NY           PSP Report Sequ
      * E2746 * If this item are boxes
      * then populate then day 0, day 1, day 2
     C                     Z-ADD*ZERO     YL0008           PSP Day 0
     C                     Z-ADD*ZERO     YL0009           PSP Day 1
     C                     Z-ADD*ZERO     YL0010           PSP Day 2
     C                     Z-ADD*ZERO     YL0011           PSP Week Ending
      * CASE: Boxes and F= Get Future data
      *  - c1 AND c2
      *   |- c1    : CUR.U/M - Primary is EQ Boxes
      *   |- c2    : LCL.Carlisle Interface Usr is Intr/Future Qty(Carlis
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $GADCD    IFEQ 'BX'                       *IF
     C           YL0004    IFEQ 'F'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Perform routine to get shipping totals for addition days
      * starting with day 0 the day 1 then day2 and rest in summary
      * only if the interface to carlisle = F  "F" means get
      * the future days
      * E2746 Susan add new program.
      * E3796 JJH 03/02/15 - Changed I Parm from Scheduled Ship Date to
      *  Requested Ship Date.
      * Rtv Day0,Day1...Etc   XF - Order Detail  * 
     C                     CLEARPARC
     C                     Z-ADD$GAIC3    PAAIC3           Company Number
     C                     Z-ADD$GHGCD    PAHGCD           Item Code
     C                     MOVELP1AJCD    PAAJCD    P      Warehouse Code
     C                     Z-ADDWUVHDT    PAA5DT           Requested Ship
      *
     C                     CALL 'PBJ0XFR'              90  Rtv Day0,Day1..
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Order Deta
     C                     PARM WUVHDT    WQ0031  70       Date 0 RGF
     C                     PARM WURWDT    WQ0032  70       Date 1 RGF
     C                     PARM WURYDT    WQ0033  70       Date 2 RGF
     C                     PARM WUR0DT    WQ0034  70       Date 3 RGF
     C                     PARM WUR1DT    WQ0035  70       Date 3 RGT
     C           YL0008    PARM YL0008    WQ0036  70       PSP Day 0
     C           YL0009    PARM YL0009    WQ0037  70       PSP Day 1
     C           YL0010    PARM YL0010    WQ0038  70       PSP Day 2
     C           YL0011    PARM YL0011    WQ0039  70       PSP Week Ending
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBJ0XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * slm 11/12/13
      * PSP DAY 0
      * CASE: LCL.PSP Day 0 is LT Zero
     C           YL0008    IFLT *ZERO                      *IF
     C                     Z-ADD*ZERO     YL0008           PSP Day 0
     C                     END                             *FI
      * PSP DAY 1
      * CASE: LCL.PSP Day 1 is LT Zero
     C           YL0009    IFLT *ZERO                      *IF
     C                     Z-ADD*ZERO     YL0009           PSP Day 1
     C                     END                             *FI
      * PSP DAY 2
      * CASE: LCL.PSP Day 2 is LT Zero
     C           YL0010    IFLT *ZERO                      *IF
     C                     Z-ADD*ZERO     YL0010           PSP Day 2
     C                     END                             *FI
      * Weekend total zero out if negative
      * CASE: LCL.PSP Week Ending Summary is LT Zero
     C           YL0011    IFLT *ZERO                      *IF
     C                     Z-ADD*ZERO     YL0011           PSP Week Ending
     C                     END                             *FI
      * quantity filled on   cur
      * CASE: CUR.Qty Production Total Usr is Less or Equal to zero
     C           $GQBQT    IFLE *ZERO                      *IF
     C                     Z-ADD*ZERO     $GQBQT           Qty Production
     C                     END                             *FI
      * Crt PS Prod Item Sch SCR - PS Prod Item Sch Sum Rpt  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP8FOC7    WL0042           PSP Prod Run Se
     C                     MOVELP6S0CD    WL0043    P      PSP Primal Grou
     C                     Z-ADDWUU8NY    WL0044           PSP Report Sequ
     C                     MOVELWUETVN    WL0045    P      PSP Report ID
     C                     Z-ADDWUUKDT    WL0046           PSP Report Date
     C                     Z-ADDWUDVTM    WL0047           PSP Report Time
     C                     Z-ADDP1AIC3    WL0048           PSP Company Num
     C                     Z-ADDP1A5DT    WL0049           PSP Production
     C                     MOVELP1AJCD    WL0050    P      PSP Production
     C                     MOVELWUR3CD    WL0051    P      PSP Department
     C                     MOVELWUMYNA    WL0052    P      PSP Department
     C                     Z-ADDYL0012    WL0053           PSP Consumed It
     C                     Z-ADD$GHGCD    WL0054           PSP Item Code
     C                     MOVEL$GAVNA    WL0055    P      PSO Item Descri
     C                     Z-ADD$GQBQT    WL0056           PSP Qty Product
     C                     MOVELWN0003    WL0057    P      PSP Piece Count
     C                     Z-ADDWN0004    WL0058           PSP Pieces Per
     C                     Z-ADDWN0005    WL0059           PSP Bags Per Un
     C                     Z-ADDYL0007    WL0060           PSP Total Piece
     C                     MOVEL$GBRAA    WL0061    P      PSP Packaging I
     C                     MOVEL$GADCD    WL0062    P      PSP U/M Primary
     C                     MOVEL$GNYNA    WL0063    P      PSP BOX Desript
     C                     MOVEL$GXITX    WL0064    P      PSP Packaging I
     C                     MOVELYL0013    WL0065    P      PSP Comment Lin
     C                     MOVELYL0014    WL0066    P      PSP Text
     C                     MOVELWUXRCD    WL0067    P      PSP Primal Grou
     C                     MOVEL'R'       WL0068    P      PSP Sent Outsid
     C                     Z-ADDWUCNNB    WL0069           PSP WIP Item Co
     C                     MOVELYL0015    WL0070    P      PSP Shift/Prior
     C                     Z-ADDYL0016    WL0071           PSP Pieces Sche
     C                     MOVELWUS8ST    WL0072    P      PSP Label Type
     C                     Z-ADDYL0008    WL0073           PSP Day 0
     C                     Z-ADDYL0009    WL0074           PSP Day 1
     C                     Z-ADDYL0010    WL0075           PSP Day 2
     C                     Z-ADDYL0011    WL0076           PSP Week Ending
     C                     EXSR SOCRRC
     C                     END                             *FI
     C                     MOVEL*BLANK    WUEJST           Item Piece Coun
     C                     Z-ADD*ZERO     WUQBQT           Qty Production
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 3
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $GHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$GHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VGHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VGHGCD           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL'0'       *IN79
     C           WUEJST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$GKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP04
      * PRTOBJ calls after print of Item Code format
      * Embedded PRTOBJ : Prt Item Comments     PO
     C                     EXSR UGSUBR                     Embedded PRTOBJ
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP03
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         C0MAIN    BEGSR
      *================================================================
      * Prt Item Comments     PO: Mainline
      *================================================================
      * Prt Item Comments     PO: Initialise
     C                     EXSR ZCINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN JDAIC3    WQKC01           Company Number
     C           *LIKE     DEFN JDV5ST    WQKC02           Production Type
     C           *LIKE     DEFN JDELDT    WQKC03           Production Date
     C           *LIKE     DEFN JDHGCD    WQKC04           Item Code
     C           *LIKE     DEFN JDAJCD    WQKC05           Warehouse Code
      * Define keylist
     C           KRSC      KLIST
     C                     KFLD           WQKC01           Company Number
     C                     KFLD           WQKC02           Production Type
     C                     KFLD           WQKC03           Production Date
     C                     KFLD           WQKC04           Item Code
     C                     KFLD           WQKC05           Warehouse Code
      * Setup key
     C                     Z-ADD$GAIC3    WQKC01           Company Number
     C                     MOVEL$GV5ST    WQKC02           Production Type
     C                     Z-ADD$GELDT    WQKC03           Production Date
     C                     Z-ADD$GHGCD    WQKC04           Item Code
     C                     MOVELP1AJCD    WQKC05           Warehouse Code
      * Establish starting position
     C           KRSC      SETLL@JDCPU7                    *
      * Read first record with user selection
     C                     EXSR C3READ
     C           W0EOFC    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0CL1P  1        First page
     C                     MOVEL'Y'       W0CL00  1        Company Number
     C                     MOVEL'Y'       W0CL01  1        Production Type
     C                     MOVEL'Y'       W0CL02  1        Production Date
     C                     MOVEL'Y'       W0CL03  1        Item Code
     C                     MOVEL'Y'       W0CL04  1        Warehouse Code
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      * Print report body
     C           W0EOFC    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR C1PHDR
      * Print report detail line
     C                     EXSR C2PDTL
      * Read next record with user selection
     C                     EXSR C3READ
      * Print totals
     C                     EXSR C4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         C0EXIT    ENDSR
      /EJECT
     CSR         C1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0CL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP1P  1
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP00  1
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP01  1
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP02  1
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP03  1
     C                     END
      *
     C           W0CL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP04  1
     C                     END
      *
      *================================================================
     CSR         C1EXIT    ENDSR
      /EJECT
     CSR         C2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDJDAIC3    $HAIC3           Company Number
     C                     MOVELJDV5ST    $HV5ST           Production Type
     C                     Z-ADDJDELDT    $HELDT           Production Date
     C                     Z-ADDJDHGCD    $HHGCD           Item Code
     C                     MOVELJDAJCD    $HAJCD           Warehouse Code
     C                     Z-ADDJDDXNB    $HDXNB           Sequence Number
     C                     MOVELJDGXTX    $HGXTX           Comment Line
     C                     MOVELJDUVST    $HUVST           EDI Status 1
     C                     MOVELJDUWST    $HUWST           EDI Status 2
     C                     MOVELJDUXST    $HUXST           EDI Status 3
     C                     MOVELJDVSST    $HVSST           Record Status
     C                     Z-ADDJDAATM    $HAATM           Job Time
     C                     MOVELJDAYNA    $HAYNA           User Id
     C                     MOVELJDA0NA    $HA0NA           Job Name
     C                     Z-ADDJDAXDT    $HAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         C2EXIT    ENDSR
      /EJECT
     CSR         C3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN JDAIC3    WZC001           Company Number
     C                     Z-ADDJDAIC3    WZC001
     C           *LIKE     DEFN JDV5ST    WZC002           Production Type
     C                     MOVELJDV5ST    WZC002
     C           *LIKE     DEFN JDELDT    WZC003           Production Date
     C                     Z-ADDJDELDT    WZC003
     C           *LIKE     DEFN JDHGCD    WZC004           Item Code
     C                     Z-ADDJDHGCD    WZC004
     C           *LIKE     DEFN JDAJCD    WZC005           Warehouse Code
     C                     MOVELJDAJCD    WZC005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFC    OREQ '1'
     C           KRSC      READE@JDCPU7                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFC  1
      * Quit if no record read
     C           W0EOFC    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * CASE: WRK.First Time Flag is Yes
     C           WUTAST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     MOVEL'N'       WUTAST           First Time Flag
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0CL00  1        Company Number
     C                     MOVEL*BLANK    W0CL01  1        Production Type
     C                     MOVEL*BLANK    W0CL02  1        Production Date
     C                     MOVEL*BLANK    W0CL03  1        Item Code
     C                     MOVEL*BLANK    W0CL04  1        Warehouse Code
     C           W0EOFC    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0CL00  1        Company Number
     C                     MOVEL'Y'       W0CL01  1        Production Type
     C                     MOVEL'Y'       W0CL02  1        Production Date
     C                     MOVEL'Y'       W0CL03  1        Item Code
     C                     MOVEL'Y'       W0CL04  1        Warehouse Code
     C                     ELSE
      * Next record - Detect level breaks
     C           JDAIC3    IFNE WZC001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL00
     C                     END
     C           JDV5ST    IFNE WZC002                     Production Type
     C           W0CL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL01
     C                     END
     C           JDELDT    IFNE WZC003                     Production Date
     C           W0CL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL02
     C                     END
     C           JDHGCD    IFNE WZC004                     Item Code
     C           W0CL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL03
     C                     END
     C           JDAJCD    IFNE WZC005                     Warehouse Code
     C           W0CL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL04
     C                     END
     C                     END
      *================================================================
     CSR         C3EXIT    ENDSR
      /EJECT
     CSR         C4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0CL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP04
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP03
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP02
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP01
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP00
     C                     END
      *
     C           W0EOFC    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         C4EXIT    ENDSR
      /EJECT
     CSR         D0MAIN    BEGSR
      *================================================================
      * Prt Prd Schedule PrmOrdPO: Mainline
      *================================================================
      * Prt Prd Schedule PrmOrdPO: Initialise
     C                     EXSR ZDINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBCOC3    WQKD01           OPS Company Num
      * Define keylist
     C           KRSD      KLIST
     C                     KFLD           WQKD01           OPS Company Num
      * Setup key
     C                     Z-ADDP1AIC3    WQKD01           OPS Company Num
      * Establish starting position
     C           KRSD      SETLL@EUCPNV                    *
      * Read first record with user selection
     C                     EXSR D3READ
     C           W0EOFD    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0DL1P  1        First page
     C                     MOVEL'Y'       W0DL00  1        OPS Company Num
     C                     MOVEL'Y'       W0DL01  1        OPS U/M Sequenc
     C                     MOVEL'Y'       W0DL02  1        OPS Primal Grou
     C                     MOVEL'Y'       W0DL03  1        OPS Item Code
      * Set column headings flag
     C                     MOVE 'Y'       W0DCDT
      * Print report body
     C           W0EOFD    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR D1PHDR
      * Print report detail line
     C                     EXSR D2PDTL
      * Read next record with user selection
     C                     EXSR D3READ
      * Print totals
     C                     EXSR D4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         D0EXIT    ENDSR
      /EJECT
     CSR         D1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0DL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP1P  1
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDWBCOC3    $KCOC3           OPS Company Num
      * Load related totals format
     C                     Z-ADD*ZERO     $OXGNX           Count Records
     C                     MOVEL*BLANK    $OTCTX           Byte
     C                     Z-ADD*ZERO     $OPUQT           Total Amount 1
     C                     Z-ADD*ZERO     $OPVQT           Total Amount 2
     C                     Z-ADD*ZERO     $OPWQT           Total Amount 3
     C                     Z-ADD*ZERO     $OPXQT           Total Amount 4
     C                     Z-ADD*ZERO     $OQHQT           Total Amount 5
     C                     Z-ADDWBCOC3    $OCOC3           OPS Company Num
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP00  1
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP01  1
     C                     END
      *
     C           W0DL02    IFEQ 'Y'
      * Load related totals format
     C                     MOVEL*BLANK    $NTCTX           Byte
     C                     MOVELWBKEAA    $NKEAA           OPS Primal Grou
     C                     MOVEL*BLANK    $NH7AA           UOM To USR
     C                     Z-ADD*ZERO     $NXGNX           Count Records
     C                     Z-ADD*ZERO     $NPUQT           Total Amount 1
     C                     Z-ADD*ZERO     $NPVQT           Total Amount 2
     C                     Z-ADD*ZERO     $NPWQT           Total Amount 3
     C                     Z-ADD*ZERO     $NPXQT           Total Amount 4
     C                     Z-ADD*ZERO     $NQHQT           Total Amount 5
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP02  1
     C                     END
      *
     C           W0DL03    IFEQ 'Y'
      * Load related totals format
     C                     MOVELWBKEAA    $MKEAA           OPS Primal Grou
     C                     MOVEL*BLANK    $MT6T1           Flag Held Over
     C                     Z-ADDWBEYC7    $MEYC7           OPS Item Code
     C                     MOVELWBS1NA    $MS1NA           OPS Item Descri
     C                     Z-ADD*ZERO     $MPYQT           Total Qty 1 3/0
     C                     Z-ADD*ZERO     $MPZQT           Total Qty 2 3/0
     C                     Z-ADD*ZERO     $MP0QT           Total Qty 3 3/0
     C                     Z-ADD*ZERO     $MP1QT           Total Qty 4 3/0
     C                     Z-ADD*ZERO     $MQGQT           Total Qty 5 3/0
     C                     Z-ADDWBVTNY    $MVTNY           OPS U/M Sequenc
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP03  1
     C                     END
      *
      *================================================================
     CSR         D1EXIT    ENDSR
      /EJECT
     CSR         D2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADD*ZERO     $LZ7VA           Total Inv for C
     C                     Z-ADD*ZERO     $LMEQT           Total Quantity
     C                     Z-ADDWBNINY    $LNINY           OPS Sequence No
     C                     MOVELWBKEAA    $LKEAA           OPS Primal Grou
     C                     Z-ADDWBCOC3    $LCOC3           OPS Company Num
     C                     MOVELWBKDAA    $LKDAA           OPS Warehouse
     C                     Z-ADDWBSPDT    $LSPDT           OPS Schedule Sh
     C                     Z-ADDWBVQDT    $LVQDT           OPS Requested S
     C                     MOVELWBAPST    $LAPST           OPS Report Type
     C                     Z-ADDWBEXC7    $LEXC7           OPS Order Numbe
     C                     Z-ADDWBNJNY    $LNJNY           OPS Load Id
     C                     MOVELWBTUT1    $LTUT1           OPS Customer Na
     C                     Z-ADDWBNKNY    $LNKNY           OPS Load Schedu
     C                     Z-ADDWBSODT    $LSODT           OPS Deadline De
     C                     Z-ADDWBNLNY    $LNLNY           OPS Deadline De
     C                     Z-ADDWBEYC7    $LEYC7           OPS Item Code
     C                     MOVELWBS1NA    $LS1NA           OPS Item Descri
     C                     Z-ADDWBPIQT    $LPIQT           OPS Quantity Or
     C                     MOVELWBTWT1    $LTWT1           OPS Sort Break
     C                     Z-ADDWBRINY    $LRINY           Item Age Days
     C                     Z-ADDWBTIDT    $LTIDT           Production Ovr
     C                     Z-ADDWBTJDT    $LTJDT           Production Ovr
     C                     Z-ADDWBTNDT    $LTNDT           Production AgeD
     C                     Z-ADDWBTODT    $LTODT           Production AgeD
     C                     MOVELWBOLST    $LOLST           OPS Print on De
     C                     MOVELWBPLAA    $LPLAA           OPS U/M Primary
     C                     Z-ADDWBVTNY    $LVTNY           OPS U/M Sequenc
     C                     MOVELWBOQST    $LOQST           OPS Status 1
     C                     MOVELWBOSST    $LOSST           OPS Status 2
     C                     Z-ADDWBICN6    $LICN6           Item Category N
     C                     MOVELWBS0CD    $LS0CD           Item Primal Sch
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         D2EXIT    ENDSR
      /EJECT
     CSR         D3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WBCOC3    WZD001           OPS Company Num
     C                     Z-ADDWBCOC3    WZD001
     C           *LIKE     DEFN WBVTNY    WZD002           OPS U/M Sequenc
     C                     Z-ADDWBVTNY    WZD002
     C           *LIKE     DEFN WBKEAA    WZD003           OPS Primal Grou
     C                     MOVELWBKEAA    WZD003
     C           *LIKE     DEFN WBEYC7    WZD004           OPS Item Code
     C                     Z-ADDWBEYC7    WZD004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFD    OREQ '1'
     C           KRSD      READE@EUCPNV                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFD  1
      * Quit if no record read
     C           W0EOFD    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0DL00  1        OPS Company Num
     C                     MOVEL*BLANK    W0DL01  1        OPS U/M Sequenc
     C                     MOVEL*BLANK    W0DL02  1        OPS Primal Grou
     C                     MOVEL*BLANK    W0DL03  1        OPS Item Code
     C           W0EOFD    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0DL00  1        OPS Company Num
     C                     MOVEL'Y'       W0DL01  1        OPS U/M Sequenc
     C                     MOVEL'Y'       W0DL02  1        OPS Primal Grou
     C                     MOVEL'Y'       W0DL03  1        OPS Item Code
     C                     ELSE
      * Next record - Detect level breaks
     C           WBCOC3    IFNE WZD001                     OPS Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL00
     C                     END
     C           WBVTNY    IFNE WZD002                     OPS U/M Sequenc
     C           W0DL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL01
     C                     END
     C           WBKEAA    IFNE WZD003                     OPS Primal Grou
     C           W0DL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL02
     C                     END
     C           WBEYC7    IFNE WZD004                     OPS Item Code
     C           W0DL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL03
     C                     END
     C                     END
      *================================================================
     CSR         D3EXIT    ENDSR
      /EJECT
     CSR         D4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0DL03    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of OPS Item Code format
      * add 2 lines
     C                     ADD  2         WUXGNX           Count Records
     C                     MOVELWUT6T1    $MT6T1           Flag Held Over
     C           WUZ7VA    ADD  *ZERO     $MPYQT           Total Qty 1 3/0
     C           WUMEQT    ADD  *ZERO     $MPZQT           Total Qty 2 3/0
      * This make is calculated
      * Calculate the make based on the sum of the item
      * CASE: WRK.Total Inv for Chk     USR LT WRK.Total Quantity Ship  U
     C           WUZ7VA    IFLT WUMEQT                     *IF
     C           WUMEQT    SUB  WUZ7VA    WUPJQT           Total Quantity
     C           WUPJQT    ADD  *ZERO     $MP0QT           Total Qty 3 3/0
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     $MP0QT           Total Qty 3 3/0
     C                     Z-ADD*ZERO     WUPJQT           Total Quantity
     C                     END                             *FI
     C           WUP2QT    ADD  *ZERO     $MP1QT           Total Qty 4 3/0
     C           WUQIQT    ADD  *ZERO     $MQGQT           Total Qty 5 3/0
      * Accumulate totals for UOM and Primal Group
     C                     EXSR UJSUBR                     Accumulate tota
      * capture the infor. from this report for PS PROD ITEM SCH SUM
     C                     Z-ADD*ZERO     YL0017           PSP Total Piece
      * If print then create the work file based on this print line
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Print format is Print format
      *   |- c2    : PAR.PSP Prod Run Sequence is Greater then zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0PFM     IFEQ 'Y'                        *IF
     C           P8FOC7    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Prd Sch Info   PS4RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0012           Company Number
     C                     Z-ADD$MEYC7    WL0013           Item Code
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    YN0002    P      Description Lin
     C                     MOVELWL0015    YL0018    P      U/M - Primary
     C                     Z-ADDWL0016    YL0019           Unit Weight
     C                     Z-ADDWL0017    YN0003           Item Structure
     C                     Z-ADDWL0018    YN0004           Item Structure
     C                     Z-ADDWL0019    YN0005           Item Structure
     C                     MOVELWL0020    YN0006    P      Item Type Code
     C                     MOVELWL0021    YN0007    P      Default Warehou
     C                     Z-ADDWL0022    YN0008           Fresh Chilling
     C                     MOVELWL0023    YN0009    P      Base/Conv/Loss
     C                     MOVELWL0024    YN0010    P      Variety/Rendere
     C                     MOVELWL0025    YN0011    P      Credit Item Sta
     C                     Z-ADDWL0026    YN0012           Std Weight/Head
     C                     Z-ADDWL0027    YL0020           Pieces Per Head
     C                     MOVELWL0028    YL0021    P      Department Code
     C                     MOVELWL0029    YN0013    P      Group for Packa
     C                     Z-ADDWL0030    YL0022           WIP Item Code
     C                     MOVELWL0031    YN0014    P      Seconds Item
     C                     MOVELWL0032    YL0023    P      Piece Count Ite
     C                     Z-ADDWL0033    YL0024           Pieces Per Bag
     C                     Z-ADDWL0034    YL0025           Bags Per Unit
     C                     MOVELWL0035    YN0015    P      Export/Domestic
     C                     MOVELWL0036    YL0026    P      Print On Schedu
     C                     MOVELWL0037    YN0016    P      Fresh Inv Alloc
     C                     MOVELWL0038    YN0017    P      Fresh Sched As
     C                     MOVELWL0039    YN0018    P      Frozen Inv Allo
     C                     MOVELWL0040    YL0027    P      Primal Group Co
     C                     MOVELWL0041    YL0028    P      Label Type
      * Rtv Prod Dept Name    RT - PS Production Department  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0003           Company Number
     C                     MOVELYL0021    WL0004    P      Department Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    YL0029    P      Department Desc
      * Calculate Total Pieces
      * CASE: LCL.Piece Count Item is yes
     C           YL0023    IFEQ 'Y'                        *IF
      * Calculate Total pieces
      * LCL.PSP Total Pieces =
      *    *COMPUTE (x1 * x2 * x3)
      * x1    : LCL.Pieces Per Bag
      * *     : PGM.*Synon (17,7) work field *
      * x2    : LCL.Bags Per Unit
      * *     : PGM.*Synon (17,7) work field *
      * x3    : CUR.Total Qty 3 3/0
     C           YL0024    MULT YL0025    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT $MP0QT    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0017           PSP Total Piece
     C                     END                             *FI
      * Place this in the PSP consumed item
      * Rtv First Consumed Itm XF - Item Bill Of Material  * 
     C                     CALL 'POP1XFR'              90  Rtv First Consu
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0040  30       Company Number
     C                     PARM $MEYC7    WQ0041  70       Item Code
     C           YL0030    PARM *ZERO     WQ0042  70       Component Item
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POP1XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ADD  1         WUU8NY           PSP Report Sequ
      * E2746 - at this time just zero out
      * The WF - Order file is used for items that are not boxes
      * so at this time the e2746 is only for boxes
      * The fields day 0, 1 , 2 , wk summ should be zero here
      * Crt PS Prod Item Sch SCR - PS Prod Item Sch Sum Rpt  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP8FOC7    WL0042           PSP Prod Run Se
     C                     MOVELP6S0CD    WL0043    P      PSP Primal Grou
     C                     Z-ADDWUU8NY    WL0044           PSP Report Sequ
     C                     MOVELWUETVN    WL0045    P      PSP Report ID
     C                     Z-ADDWUUKDT    WL0046           PSP Report Date
     C                     Z-ADDWUDVTM    WL0047           PSP Report Time
     C                     Z-ADDP1AIC3    WL0048           PSP Company Num
     C                     Z-ADDP1A5DT    WL0049           PSP Production
     C                     MOVELP1AJCD    WL0050    P      PSP Production
     C                     MOVELYL0021    WL0051    P      PSP Department
     C                     MOVELYL0029    WL0052    P      PSP Department
     C                     Z-ADDYL0030    WL0053           PSP Consumed It
     C                     Z-ADD$MEYC7    WL0054           PSP Item Code
     C                     MOVEL$MS1NA    WL0055    P      PSO Item Descri
     C                     Z-ADD$MP0QT    WL0056           PSP Qty Product
     C                     MOVELYL0023    WL0057    P      PSP Piece Count
     C                     Z-ADDYL0024    WL0058           PSP Pieces Per
     C                     Z-ADDYL0025    WL0059           PSP Bags Per Un
     C                     Z-ADDYL0017    WL0060           PSP Total Piece
     C                     MOVELYL0031    WL0061    P      PSP Packaging I
     C                     MOVELYL0018    WL0062    P      PSP U/M Primary
     C                     MOVELYL0032    WL0063    P      PSP BOX Desript
     C                     MOVELYL0033    WL0064    P      PSP Packaging I
     C                     MOVELYL0034    WL0065    P      PSP Comment Lin
     C                     MOVELYL0035    WL0066    P      PSP Text
     C                     MOVELYL0027    WL0067    P      PSP Primal Grou
     C                     MOVEL'R'       WL0068    P      PSP Sent Outsid
     C                     Z-ADDYL0022    WL0069           PSP WIP Item Co
     C                     MOVELYL0036    WL0070    P      PSP Shift/Prior
     C                     Z-ADDYL0037    WL0071           PSP Pieces Sche
     C                     MOVELYL0028    WL0072    P      PSP Label Type
     C                     Z-ADDWUR8AA    WL0073           PSP Day 0
     C                     Z-ADDWUR9AA    WL0074           PSP Day 1
     C                     Z-ADDWUSAAA    WL0075           PSP Day 2
     C                     Z-ADDWUSBAA    WL0076           PSP Week Ending
     C                     EXSR SOCRRC
     C                     END                             *FI
     C                     Z-ADD*ZERO     WUQBQT           Qty Production
      * NOW ZERO OUT THE DETAIL ACCUMULATIONS
     C                     Z-ADD*ZERO     WUZ7VA           Total Inv for C
     C                     Z-ADD*ZERO     WUMEQT           Total Quantity
     C                     Z-ADD*ZERO     WUPJQT           Total Quantity
     C                     Z-ADD*ZERO     WUDWNX           Quantity Prod A
     C                     Z-ADD*ZERO     WUP2QT           Total Work Ahea
     C                     Z-ADD*ZERO     WUQIQT           Total Work Ahea
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Convert OPS Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $MEYC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$MEYC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VMEYC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VMEYC7           CD7 Ext Numeric
     C                     END                             *FI
      * Print format
     C                     WRITE$MKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP03
      * USER: Process after print of OPS Item Code format
     C                     MOVEL*BLANK    WUT6T1           Flag Held Over
     C                     END
      *
     C           W0DL02    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of OPS Primal Group Code format
     C                     MOVELWUH7AA    $NH7AA           UOM To USR
     C                     Z-ADDWUPUQT    $NPUQT           Total Amount 1
     C                     Z-ADDWUPVQT    $NPVQT           Total Amount 2
     C                     Z-ADDWUPWQT    $NPWQT           Total Amount 3
     C                     Z-ADDWUPXQT    $NPXQT           Total Amount 4
     C                     Z-ADDWUQHQT    $NQHQT           Total Amount 5
     C                     Z-ADD*ZERO     WUPUQT           Total Amount 1
     C                     Z-ADD*ZERO     WUPVQT           Total Amount 2
     C                     Z-ADD*ZERO     WUPWQT           Total Amount 3
     C                     Z-ADD*ZERO     WUPXQT           Total Amount 4
     C                     Z-ADD*ZERO     WUQHQT           Total Amount 5
      * Add 2 to count
     C                     ADD  2         WUXGNX           Count Records
     C                     Z-ADDWUXGNX    $NXGNX           Count Records
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 3
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$NKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP02
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
      * USER: On print of OPS U/M Sequence format
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP01
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * USER: On print of OPS Company Number format
     C                     Z-ADDWUPUQT    $OPUQT           Total Amount 1
     C                     Z-ADDWUPVQT    $OPVQT           Total Amount 2
     C                     Z-ADDWUPWQT    $OPWQT           Total Amount 3
     C                     Z-ADDWUPXQT    $OPXQT           Total Amount 4
     C                     Z-ADDWUQHQT    $OQHQT           Total Amount 5
     C                     Z-ADD*ZERO     WUPUQT           Total Amount 1
     C                     Z-ADD*ZERO     WUPVQT           Total Amount 2
     C                     Z-ADD*ZERO     WUPWQT           Total Amount 3
     C                     Z-ADD*ZERO     WUPXQT           Total Amount 4
     C                     Z-ADD*ZERO     WUQHQT           Total Amount 5
      * Add 2 to count
     C                     ADD  2         WUXGNX           Count Records
     C                     Z-ADDWUXGNX    $OXGNX           Count Records
      * Mention hidden format
     C   99N99             WRITE$OKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP00
     C                     END
      *
     C           W0EOFD    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         D4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of Prt Prd Schedule PrmOrdPF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Prt Prd Schedule PrmOrdPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print OPS Company Number of Prt Prd Schedule PrmOrdPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Print format
     C                     WRITE$CKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print First Page Format of Prt Prd Schedule PrmPsPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print Company Number of Prt Prd Schedule PrmPsPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Accounting Company Number format
     C                     MOVEL*BLANK    $DSQTX           Company Name DR
      * Company Name DRV
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SCRVGN
      * Production warehouse
     C                     MOVEL*BLANK    $DO6NA           Warehouse Desc
      * Warehouse Desc DRV
      * RTV Whse Descrip       RT - Warehouse  * 
     C                     EXSR SDRVGN
     C                     Z-ADDP1A5DT    $DELDT           Production Date
      * CUR.Condition Desc. 1  USR = Condition name of PAR.Production Typ
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1261823   Y2LSNO  70       List number
     C                     PARM WUFCST    W0INVL 25        Production Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $DHLTX    PARM           W0CNNM 25        Condition Desc.
      *
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $DAIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$DAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VDAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Production Date to display format
      * Convert date
     C           1000000   ADD  $DELDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDELDT
      * Print format
     C                     WRITE$DKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE 'P'       W0BP00
     C                     END                             FI
      * Print Production Type of Prt Prd Schedule PrmPsPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print Production Date of Prt Prd Schedule PrmPsPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print Department Code of Prt Prd Schedule PrmPsPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP03    ANDEQ'P'
      * Print format
     C                     WRITE$EKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BP03
     C                     END                             FI
      * Print Item Code of Prt Prd Schedule PrmPsPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP04
     C                     END                             FI
      * Print PS Production Warehouse of Prt Prd Schedule PrmPsPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP05    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP05    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP05
     C                     END                             FI
      * Print Detail line. of Prt Prd Schedule PrmPsPO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     ADD  WUWPRD    WUQBQT           Qty Production
     C                     MOVEL'N'       WUTAST           First Time Flag
     C                     MOVEL'N'       W0PFM            *Print format
     C           W0PFM     IFEQ 'Y'
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$FCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$FDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print First Page Format of Prt Item Comments     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0CL1P
     C                     END                             FI
      * Print Company Number of Prt Item Comments     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP00
     C                     END                             FI
      * Print Production Type of Prt Item Comments     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP01
     C                     END                             FI
      * Print Production Date of Prt Item Comments     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP02
     C                     END                             FI
      * Print Item Code of Prt Item Comments     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP03
     C                     END                             FI
      * Print Warehouse Code of Prt Item Comments     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP04
     C                     END                             FI
      * Print Detail line. of Prt Item Comments     PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0CCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CPDT    ANDEQ'P'
      * Print column headings if required
     C           W0CCDT    IFEQ 'Y'
     C                     WRITE$HCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0CCDT
     C                     END                             FI
      * Print format
     C                     WRITE$HDTLRCD
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CPDT
     C                     END                             FI
      * Print OPS Warehouse of Prt Prd Schedule PrmOrdPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Convert fields to external form
      * Convert Company to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $IBNC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$IBNC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VIBNC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VIBNC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  $IAODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VIAODT
      * Convert Next Production Day Usr to display format
      * Convert date
     C           1000000   ADD  $ISRDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VISRDT
      * Convert Next Production Day Usr2 to display format
      * Convert date
     C           1000000   ADD  $IT3DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VIT3DT
      * Print format
     C                     WRITE$IKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      *
      * Reset format print flag
     C                     MOVE 'P'       W0AP01
     C                     END                             FI
      * Print First Page Format of Prt Prd Schedule PrmOrdPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP1P    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$J1STPAG
      * Reset format print flag
     C                     MOVE *BLANK    W0DP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0DL1P
     C                     END                             FI
      * Print OPS Company Number of Prt Prd Schedule PrmOrdPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP00    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of OPS Company Number format
      * Line 12
     C           12        MULT 1         WUXGNX           Count Records
     C           W0PFM     IFEQ 'Y'
      * Print format
     C                     WRITE$KKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0DCDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0DP00
     C                     END                             FI
      * Print OPS U/M Sequence of Prt Prd Schedule PrmOrdPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP01    ANDEQ'P'
      * USER: On print of OPS U/M Sequence format
     C                     MOVELWBPLAA    WUH7AA           UOM To USR
      * Reset format print flag
     C                     MOVE *BLANK    W0DP01
     C                     END                             FI
      * Print OPS Primal Group Code of Prt Prd Schedule PrmOrdPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP02
     C                     END                             FI
      * Print OPS Item Code of Prt Prd Schedule PrmOrdPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP03    ANDEQ'P'
      * USER: On print of OPS Item Code format
      * E3796 JJH 03/03/15 - Use Requested Ship Date on Production Schedu
      * CASE: PAR.Requested Ship Date NE PAR.Next Production Day Usr
     C           P1A5DT    IFNE P3SRDT                     *IF
      * on hand
      * RTV On Hand Qty       RT - Item Balance  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBCOC3    WL0077           Company Number
     C                     Z-ADDWBEYC7    WL0078           Item Code
     C                     MOVELWBKDAA    WL0079    P      Warehouse Code
     C                     Z-ADDWUDDQT    WL0080           On Hand U/M1 Su
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0080    WUDDQT           On Hand U/M1 Su
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUDDQT           On Hand U/M1 Su
     C                     END                             *FI
     C                     Z-ADDWUDDQT    WUZ7VA           Total Inv for C
      * Reset format print flag
     C                     MOVE *BLANK    W0DP03
     C                     END                             FI
      * Print Detail line. of Prt Prd Schedule PrmOrdPO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0DCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DPDT    ANDEQ'P'
      * USER: On print of detail format
      * E3796 JJH 03/03/15 - Use OPS Requested Ship Date
      * CASE: DB1.OPS Requested Ship Date EQ PAR.Next Production Day Usr
     C           WBVQDT    IFEQ P3SRDT                     *IF
     C                     ADD  WBPIQT    WUP2QT           Total Work Ahea
     C                     ELSE
      * CASE: DB1.OPS Requested Ship Date EQ PAR.Next Production Day Usr2
     C           WBVQDT    IFEQ P4T3DT                     *IF
     C                     ADD  WBPIQT    WUQIQT           Total Work Ahea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  WBPIQT    WUMEQT           Total Quantity
     C                     END                             *FI
     C                     END                             *FI
      * ship
      * was ne to ship date but now that future date is allowed must be l
      * E3796 JJH 03/03/15 - Use OPS Requested Ship Date
      * CASE: DB1.OPS Requested Ship Date LT PAR.Requested Ship Date
     C           WBVQDT    IFLT P1A5DT                     *IF
     C                     MOVEL*BLANK    WUT6T1           Flag Held Over
     C                     MOVEL'HO'      WUT6T1           Flag Held Over
      * Set On Indicator 03    US - /UT User Source  * 
     C                     SETON                     03    SETON INDICATOR
     C                     END                             *FI
      * Mention hidden format
     C   99N99             WRITE$LDTLRCD
      * Reset format print flag
     C                     MOVE *BLANK    W0DPDT
     C                     END                             FI
      * Print OPS Requested Ship Date of Prt Prd Schedule PrmOrdPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$PKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print OPS Schedule Ship Date of Prt Prd Schedule PrmOrdPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP03    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$QKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0AP03
     C                     END                             FI
      * Print OPS Load Schedule Seq # of Prt Prd Schedule PrmOrdPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP04
     C                     END                             FI
      * Print OPS Deadline Depart Date of Prt Prd Schedule PrmOrdPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP05    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP05    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP05
     C                     END                             FI
      * Print OPS Deadline Depart Time of Prt Prd Schedule PrmOrdPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP06    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP06    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP06
     C                     END                             FI
      * Print OPS Load Id of Prt Prd Schedule PrmOrdPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP07    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP07    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP07
     C                     END                             FI
      * Print OPS Order Number of Prt Prd Schedule PrmOrdPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP08    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP08    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of OPS Order Number format
      * E3796 JJH 02/25/15 - Use Requested Ship Date
      * CASE: PAR.Requested Ship Date GT JOB.*Job date
     C           P1A5DT    IFGT ##JDT                      *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * CLC Day of Week        XF - /UT Functions  * 
     C                     CALL 'PDXIXFR'              90  CLC Day of Week
     C                     PARM *BLANK    W0RTN   7
     C                     PARM EUSPDT    WQ0053  70       Date In
     C           WUULTX    PARM *BLANK    WQ0054  9        Day of the Week
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C           EUNLNY    DIV  100       WUYBNB           Deadline Depart
     C                     MOVEL*BLANK    WUT6T1           Flag Held Over
      * E3796 JJH 02/25/15 - Use Requested Ship Date
      * CASE: DB1.OPS Requested Ship Date LT PAR.Requested Ship Date
     C           EUVQDT    IFLT P1A5DT                     *IF
     C                     MOVEL*BLANK    WUT6T1           Flag Held Over
     C                     MOVEL'HO'      WUT6T1           Flag Held Over
      * Set On Indicator 02    US - /UT User Source  * 
     C                     SETON                     02    SETON INDICATOR
     C                     END                             *FI
      * CASE: PAR.Print Comments Usr is yes
     C           P1ARST    IFEQ 'Y'                        *IF
      * RTV First 70char       RT - Order Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDEUCOC3    WL0081           Company Number
     C                     Z-ADDEUEXC7    WL0082           Order Number
     C                     MOVEL'PS'      WL0083    P      Comment Type
     C                     MOVEL$RT3T1    WL0084    P      USR Text 70
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0084    $RT3T1    P      USR Text 70
     C                     ADD  00001     WUXGNX           Count Records
     C                     END                             *FI
     C                     ADD  00002     WUXGNX           Count Records
     C                     ADD  00002     WUXGNX           Count Records
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert OPS Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $REXC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$REXC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VREXC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VREXC7           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL'0'       *IN79
     C           P1ARST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$RKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP08
     C                     END                             FI
      * Print OPS Item Code of Prt Prd Schedule PrmOrdPF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP09    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP09    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP09
     C                     END                             FI
      * Print Detail line. of Prt Prd Schedule PrmOrdPF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * E3796 JJH 02/25/15 - Use Requested Ship Date
      * CASE: PAR.Requested Ship Date GT JOB.*Job date
     C           P1A5DT    IFGT ##JDT                      *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * CASE: DB1.OPS Order Number is Equal to zeros
     C           EUEXC7    IFEQ *ZERO                      *IF
     C                     MOVEL'Y'       WUGGST           USR Display fie
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * CUR = DB1 By name
     C                     Z-ADDEUNINY    $SNINY           OPS Sequence No
     C                     MOVELEUKEAA    $SKEAA           OPS Primal Grou
     C                     Z-ADDEUCOC3    $SCOC3           OPS Company Num
     C                     MOVELEUKDAA    $SKDAA           OPS Warehouse
     C                     MOVELEUAPST    $SAPST           OPS Report Type
     C                     Z-ADDEUEXC7    $SEXC7           OPS Order Numbe
     C                     Z-ADDEUNJNY    $SNJNY           OPS Load Id
     C                     MOVELEUTUT1    $STUT1           OPS Customer Na
     C                     Z-ADDEUNKNY    $SNKNY           OPS Load Schedu
     C                     Z-ADDEUSODT    $SSODT           OPS Deadline De
     C                     Z-ADDEUNLNY    $SNLNY           OPS Deadline De
     C                     Z-ADDEUEYC7    $SEYC7           OPS Item Code
     C                     MOVELEUS1NA    $SS1NA           OPS Item Descri
     C                     Z-ADDEUSPDT    $SSPDT           OPS Schedule Sh
     C                     Z-ADDEUVQDT    $SVQDT           OPS Requested S
     C                     Z-ADDEUPIQT    $SPIQT           OPS Quantity Or
     C                     Z-ADDEUTNDT    $STNDT           Production AgeD
     C                     MOVELEUTWT1    $STWT1           OPS Sort Break
     C                     Z-ADDEURINY    $SRINY           Item Age Days
     C                     Z-ADDEUTIDT    $STIDT           Production Ovr
     C                     Z-ADDEUTJDT    $STJDT           Production Ovr
     C                     Z-ADDEUTODT    $STODT           Production AgeD
     C                     MOVELEUOLST    $SOLST           OPS Print on De
     C                     MOVELEUPLAA    $SPLAA           OPS U/M Primary
     C                     Z-ADDEUVTNY    $SVTNY           OPS U/M Sequenc
     C                     MOVELEUOQST    $SOQST           OPS Status 1
     C                     MOVELEUOSST    $SOSST           OPS Status 2
     C                     Z-ADDEUICN6    $SICN6           Item Category N
     C                     MOVELEUS0CD    $SS0CD           Item Primal Sch
     C           EUPIQT    MULT 1         $SN1NY           OPS QTY SHIP PR
     C                     ADD  1         WUXGNX           Count Records
      * Create the PS Prod Item Sch Detail data
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Print format is Print format
      *   |- c2    : PAR.PSP Prod Run Sequence is Greater then zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0PFM     IFEQ 'Y'                        *IF
     C           P8FOC7    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CLC Day of Week        XF - /UT Functions  * 
     C                     CALL 'PDXIXFR'              90  CLC Day of Week
     C                     PARM *BLANK    W0RTN   7
     C                     PARM EUSPDT    WQ0055  70       Date In
     C           WUULTX    PARM *BLANK    WQ0056  9        Day of the Week
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL*BLANK    WUT6T1           Flag Held Over
      * E3796 JJH 02/25/15 - Use Requested Ship Date
      * CASE: DB1.OPS Requested Ship Date LT PAR.Requested Ship Date
     C           EUVQDT    IFLT P1A5DT                     *IF
     C                     MOVEL*BLANK    WUT6T1           Flag Held Over
     C                     MOVEL'HO'      WUT6T1           Flag Held Over
     C                     END                             *FI
     C                     MOVEL*BLANK    WUVTT1           Est Prd Ready T
      * Rtv ProdInfm          Rt - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDEUNJNY    WL0085           Load ID
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0086    YL0039           Product Tempera
     C                     Z-ADDWL0087    YL0040           Product Complet
     C                     Z-ADDWL0088    YL0041           Product Complet
      * Build Est Product Ready Time from Product Completed Date
      * CASE: LCL.Product Complete Date is Entered
     C           YL0040    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    YL0042           Date (Alpha) US
     C                     MOVELYL0040    YL0042           Date (Alpha) US
     C                     MOVEL*BLANK    YL0043           Time Alpha usr
     C                     MOVELYL0041    YL0043           Time Alpha usr
      * Mov DteTme MM dd YY.etcXF - /UT Functions  * 
     C                     CALL 'PNI4XFR'              90  Mov DteTme MM d
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0042    WQ0057  7        Date (Alpha) US
     C                     PARM YL0043    WQ0058  6        Time Alpha usr
     C           WUT5TX    PARM *BLANK    WQ0059  2        Month (Char) US
     C           WUT6TX    PARM *BLANK    WQ0060  2        Day   (Char) US
     C           WUVQT1    PARM *BLANK    WQ0061  2        Century Usr TXT
     C           WUT4TX    PARM *BLANK    WQ0062  2        Year  (Char) US
     C           WUVDCD    PARM *BLANK    WQ0063  2        Hours  2A
     C           WUVECD    PARM *BLANK    WQ0064  2        Minutes  2A
     C           WUY6CD    PARM *BLANK    WQ0065  2        Seconds 2A
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNI4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * format date to field and underline field
      * mm/
     C                     Z-ADD*ZERO     ZQ      50
     C           WUT5TX    CAT  '/':ZQ    WUVTT1    P      Est Prd Ready T
      * dd
     C                     Z-ADD*ZERO     ZQ      50
     C           WUVTT1    CAT  WUT6TX:ZQ WUVTT1    P      Est Prd Ready T
      * /
     C                     Z-ADD*ZERO     ZQ      50
     C           WUVTT1    CAT  '/':ZQ    WUVTT1    P      Est Prd Ready T
      * year
     C                     Z-ADD*ZERO     ZQ      50
     C           WUVTT1    CAT  WUT4TX:ZQ WUVTT1    P      Est Prd Ready T
      * /
     C                     Z-ADD1         ZQ      50
     C           WUVTT1    CAT  '/':ZQ    WUVTT1    P      Est Prd Ready T
      * Hours
     C                     Z-ADD1         ZQ      50
     C           WUVTT1    CAT  WUVDCD:ZQ WUVTT1    P      Est Prd Ready T
      * :
     C                     Z-ADD*ZERO     ZQ      50
     C           WUVTT1    CAT  ':':ZQ    WUVTT1    P      Est Prd Ready T
      * min
     C                     Z-ADD*ZERO     ZQ      50
     C           WUVTT1    CAT  WUVECD:ZQ WUVTT1    P      Est Prd Ready T
     C                     END                             *FI
     C                     MOVELWUVTT1    YL0044           PSO Est Prd Rea
     C                     ADD  1         WUVWNY           PSO Report Sequ
      * Crt PS Prod Item Sch DCR - PS Prod Item Sch Dtl Rpt  * 
     C                     EXSR SSCRRC
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert OPS Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $SEYC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$SEYC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VSEYC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VSEYC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert OPS Requested Ship Date to display format
      * Convert date
     C           1000000   ADD  $SVQDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VSVQDT
      * Convert Production AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  $STNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VSTNDT
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$SCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$SDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     MOVEL*BLANK    W0SKP   1
      * Cascade skip to new page requests upwards
     C           W0AP01    IFEQ 'Y'
     C                     MOVEL'Y'       W0SKP
     C                     END
      * Request all headings higher than this one
     C           W0SKP     IFEQ 'Y'
     C           W0AP00    ANDEQ*BLANK
     C                     MOVEL'P'       W0AP00
     C                     END
      * Request new page if required
     C           W0SKP     IFEQ 'Y'                        IF
     C                     MOVE 'Y'       W0NEWP
     C                     END                             FI
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of Prt Prd Schedule PrmOrdPF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * OPS Company Number of Prt Prd Schedule PrmOrdPF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * OPS Warehouse of Prt Prd Schedule PrmOrdPF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  6         W0FSUM
     C                     END                             FI
      *
      * * OPS Requested Ship Date of Prt Prd Schedule PrmOrdPF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * OPS Schedule Ship Date of Prt Prd Schedule PrmOrdPF
     C           W0AP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * OPS Load Schedule Seq # of Prt Prd Schedule PrmOrdPF
     C           W0AP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * OPS Deadline Depart Date of Prt Prd Schedule PrmOrdPF
     C           W0AP05    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * OPS Deadline Depart Time of Prt Prd Schedule PrmOrdPF
     C           W0AP06    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * OPS Load Id of Prt Prd Schedule PrmOrdPF
     C           W0AP07    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * OPS Order Number of Prt Prd Schedule PrmOrdPF
     C           W0AP08    IFEQ 'Y'
     C                     ADD  3         W0FSUM
     C                     END                             FI
      *
      * * OPS Item Code of Prt Prd Schedule PrmOrdPF
     C           W0AP09    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Prd Schedule PrmOrdPF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Prd Schedule PrmPsPO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of Prt Prd Schedule PrmPsPO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  6         W0FSUM
     C                     END                             FI
      *
      * * Production Type of Prt Prd Schedule PrmPsPO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Production Date of Prt Prd Schedule PrmPsPO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Department Code of Prt Prd Schedule PrmPsPO
     C           W0BP03    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * Item Code of Prt Prd Schedule PrmPsPO
     C           W0BP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * PS Production Warehouse of Prt Prd Schedule PrmPsPO
     C           W0BP05    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Prd Schedule PrmPsPO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Item Comments     PO
     C           W0CP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Company Number of Prt Item Comments     PO
     C           W0CP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Production Type of Prt Item Comments     PO
     C           W0CP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Production Date of Prt Item Comments     PO
     C           W0CP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Item Code of Prt Item Comments     PO
     C           W0CP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Warehouse Code of Prt Item Comments     PO
     C           W0CP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Item Comments     PO
     C           W0CPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0CCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Prd Schedule PrmOrdPO
     C           W0DP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * OPS Company Number of Prt Prd Schedule PrmOrdPO
     C           W0DP00    IFEQ 'Y'
     C                     ADD  4         W0FSUM
     C                     END                             FI
      *
      * * OPS U/M Sequence of Prt Prd Schedule PrmOrdPO
     C           W0DP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * OPS Primal Group Code of Prt Prd Schedule PrmOrdPO
     C           W0DP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * OPS Item Code of Prt Prd Schedule PrmOrdPO
     C           W0DP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Prd Schedule PrmOrdPO
     C           W0DPDT    IFEQ 'Y'
     C                     Z-ADD0         W0DTLN
     C           W0DCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
      * Top of page should be  6 print lines
      * Set On Indicator 01    US - /UT User Source  * 
     C                     SETON                     01    SETON INDICATOR
     C           6         MULT 1         WUXGNX           Count Records
     C                     Z-ADD2         ZQ      50
     C           P7AUNA    CAT  @CN,002:ZQ$BA2T1    P      Text Usr 50
     C                     Z-ADD1         ZQ      50
     C           $BA2T1    CAT  P6S0CD:ZQ $BA2T1    P      Text Usr 50
     C                     Z-ADDP8FOC7    $BFOC7           PSP Prod Run Se
     C                     MOVEL*BLANK    $BA6U1           Interface to In
     C                     MOVEL*BLANK    $BA7U1           Send Base Line
      * CASE: TOP.PSP Prod Run Sequence is Equal to zeros
     C           $BFOC7    IFEQ *ZERO                      *IF
     C                     MOVEL@CN,003   $BA6U1           Interface to In
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL@CN,004   $BA6U1           Interface to In
     C                     END                             *FI
      * CASE: PAR.Base or Not Based Usr is Yes
     C           P9SCAA    IFEQ 'Y'                        *IF
     C                     MOVEL@CN,005   $BA7U1           Send Base Line
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
      * Convert fields to external form
      * Convert PSP Prod Run Sequence to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $BFOC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$BFOC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VBFOC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBFOC7           CD7 Ext Numeric
     C                     END                             *FI
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVELWL0001    WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WL0002           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WL0002           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD$DAIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSC     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $DSQTX           Name
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    $DSQTX           Name
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Whse Descrip       RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELI8B7ST    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSD     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    $DO6NA           Warehouse Descr
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELADF8NA    $DO6NA           Warehouse Descr
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Prod Dept Name    RT - PS Production Department  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           I5AIC3           Company Number
     C                     KFLD           I5R3CD           Department Code
      * Setup key
     C                     Z-ADDWL0003    I5AIC3           Company Number
     C                     MOVELWL0004    I5R3CD           Department Code
      * Establish starting position
     C           KRSSE     CHAIN@I5REUJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1757' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0005           Department Desc
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELI5MYNA    WL0005           Department Desc
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Prd Sch Info   PS3RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDI8AIC3    BZAIC3           Company Number
     C                     Z-ADDI8HGCD    BZHGCD           Item Code
      * Establish starting position
     C           KRSSF     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0001           Description Lin
     C                     MOVEL*BLANK    WUADCD           U/M - Primary
     C                     Z-ADD*ZERO     WN0002           Unit Weight
     C                     Z-ADD*ZERO     WURINB           Item Structure
     C                     Z-ADD*ZERO     WURHNB           Item Structure
     C                     Z-ADD*ZERO     WURGNB           Item Structure
     C                     MOVEL*BLANK    WUN0CD           Item Type Code
     C                     MOVEL*BLANK    WUQ1CD           Default Warehou
     C                     Z-ADD*ZERO     WUCHTM           Fresh Chilling
     C                     MOVEL*BLANK    WUQZCD           Base/Conv/Loss
     C                     MOVEL*BLANK    WUXWST           Variety/Rendere
     C                     MOVEL*BLANK    WUVMST           Credit Item Sta
     C                     Z-ADD*ZERO     WUSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WUPPHE           Pieces Per Head
     C                     MOVEL*BLANK    WUR3CD           Department Code
     C                     MOVEL*BLANK    WUSDCD           Group for Packa
     C                     Z-ADD*ZERO     WUICN6           Item Category N
     C                     MOVEL*BLANK    WUS0CD           Item Primal Sch
     C                     Z-ADD*ZERO     WUCNNB           WIP Item Code
     C                     MOVEL*BLANK    WUX5ST           Seconds Item
     C                     MOVEL*BLANK    WN0003           Piece Count Ite
     C                     Z-ADD*ZERO     WN0004           Pieces Per Bag
     C                     Z-ADD*ZERO     WN0005           Bags Per Unit
     C                     MOVEL*BLANK    WUSUST           Export/Domestic
     C                     MOVEL*BLANK    WN0006           Print On Schedu
     C                     MOVEL*BLANK    WUSYST           Fresh Inv Alloc
     C                     MOVEL*BLANK    WUSZST           Fresh Sched As
     C                     MOVEL*BLANK    WUS1ST           Frozen Inv Allo
     C                     MOVEL*BLANK    WUXRCD           Primal Group Co
     C                     MOVEL*BLANK    WUS8ST           Label Type
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAVNA    WN0001           Description Lin
     C                     MOVELBZADCD    WUADCD           U/M - Primary
     C                     Z-ADDBZAIWG    WN0002           Unit Weight
     C                     Z-ADDBZRINB    WURINB           Item Structure
     C                     Z-ADDBZRHNB    WURHNB           Item Structure
     C                     Z-ADDBZRGNB    WURGNB           Item Structure
     C                     MOVELBZN0CD    WUN0CD           Item Type Code
     C                     MOVELBZQ1CD    WUQ1CD           Default Warehou
     C                     Z-ADDBZCHTM    WUCHTM           Fresh Chilling
     C                     MOVELBZQZCD    WUQZCD           Base/Conv/Loss
     C                     MOVELBZXWST    WUXWST           Variety/Rendere
     C                     MOVELBZVMST    WUVMST           Credit Item Sta
     C                     Z-ADDBZSWGH    WUSWGH           Std Weight/Head
     C                     Z-ADDBZPPHE    WUPPHE           Pieces Per Head
     C                     MOVELBZR3CD    WUR3CD           Department Code
     C                     MOVELBZSDCD    WUSDCD           Group for Packa
     C                     Z-ADDBZICN6    WUICN6           Item Category N
     C                     MOVELBZS0CD    WUS0CD           Item Primal Sch
     C                     Z-ADDBZCNNB    WUCNNB           WIP Item Code
     C                     MOVELBZX5ST    WUX5ST           Seconds Item
     C                     MOVELBZPCCT    WN0003           Piece Count Ite
     C                     Z-ADDBZBDNB    WN0004           Pieces Per Bag
     C                     Z-ADDBZBJNB    WN0005           Bags Per Unit
     C                     MOVELBZSUST    WUSUST           Export/Domestic
     C                     MOVELBZSVST    WN0006           Print On Schedu
     C                     MOVELBZSYST    WUSYST           Fresh Inv Alloc
     C                     MOVELBZSZST    WUSZST           Fresh Sched As
     C                     MOVELBZS1ST    WUS1ST           Frozen Inv Allo
     C                     MOVELBZXRCD    WUXRCD           Primal Group Co
     C                     MOVELBZS8ST    WUS8ST           Label Type
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv PrimSchGrp Desc   RT - Item Category  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           JIAIC3           Company Number
     C                     KFLD           JIUSNB           Item Category N
     C                     KFLD           JISLCD           Item Category C
      * Setup key
     C                     Z-ADDWL0006    JIAIC3           Company Number
     C                     Z-ADDWL0007    JIUSNB           Item Category N
     C                     MOVELWL0008    JISLCD           Item Category C
      * Establish starting position
     C           KRSSG     CHAIN@JIREXX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1854' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0009           Description
     C                     MOVEL*BLANK    WL0010           EDI Status 3
     C                     MOVEL*BLANK    WL0011           Item Category T
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJIAUNA    WL0009           Description
     C                     MOVELJIUXST    WL0010           EDI Status 3
      * Rtv Description       RT - Item Category Type  * 
     C                     EXSR SHRVGN
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Description       RT - Item Category Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           BHOHNX           Item Category T
     C                     KFLD           BHCNAA           Item Category T
      * Setup key
     C                     Z-ADDJIOHNX    BHOHNX           Item Category T
     C                     MOVELJICNAA    BHCNAA           Item Category T
      * Establish starting position
     C           KRSSH     CHAIN@BHREKT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3079' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0011           Item Category T
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBHPPNA    WL0011           Item Category T
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Prd Sch Info   PS4RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0012    BZAIC3           Company Number
     C                     Z-ADDWL0013    BZHGCD           Item Code
      * Establish starting position
     C           KRSSI     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0014           Description Lin
     C                     MOVEL*BLANK    WL0015           U/M - Primary
     C                     Z-ADD*ZERO     WL0016           Unit Weight
     C                     Z-ADD*ZERO     WL0017           Item Structure
     C                     Z-ADD*ZERO     WL0018           Item Structure
     C                     Z-ADD*ZERO     WL0019           Item Structure
     C                     MOVEL*BLANK    WL0020           Item Type Code
     C                     MOVEL*BLANK    WL0021           Default Warehou
     C                     Z-ADD*ZERO     WL0022           Fresh Chilling
     C                     MOVEL*BLANK    WL0023           Base/Conv/Loss
     C                     MOVEL*BLANK    WL0024           Variety/Rendere
     C                     MOVEL*BLANK    WL0025           Credit Item Sta
     C                     Z-ADD*ZERO     WL0026           Std Weight/Head
     C                     Z-ADD*ZERO     WL0027           Pieces Per Head
     C                     MOVEL*BLANK    WL0028           Department Code
     C                     MOVEL*BLANK    WL0029           Group for Packa
     C                     Z-ADD*ZERO     WL0030           WIP Item Code
     C                     MOVEL*BLANK    WL0031           Seconds Item
     C                     MOVEL*BLANK    WL0032           Piece Count Ite
     C                     Z-ADD*ZERO     WL0033           Pieces Per Bag
     C                     Z-ADD*ZERO     WL0034           Bags Per Unit
     C                     MOVEL*BLANK    WL0035           Export/Domestic
     C                     MOVEL*BLANK    WL0036           Print On Schedu
     C                     MOVEL*BLANK    WL0037           Fresh Inv Alloc
     C                     MOVEL*BLANK    WL0038           Fresh Sched As
     C                     MOVEL*BLANK    WL0039           Frozen Inv Allo
     C                     MOVEL*BLANK    WL0040           Primal Group Co
     C                     MOVEL*BLANK    WL0041           Label Type
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAVNA    WL0014           Description Lin
     C                     MOVELBZADCD    WL0015           U/M - Primary
     C                     Z-ADDBZAIWG    WL0016           Unit Weight
     C                     Z-ADDBZRINB    WL0017           Item Structure
     C                     Z-ADDBZRHNB    WL0018           Item Structure
     C                     Z-ADDBZRGNB    WL0019           Item Structure
     C                     MOVELBZN0CD    WL0020           Item Type Code
     C                     MOVELBZQ1CD    WL0021           Default Warehou
     C                     Z-ADDBZCHTM    WL0022           Fresh Chilling
     C                     MOVELBZQZCD    WL0023           Base/Conv/Loss
     C                     MOVELBZXWST    WL0024           Variety/Rendere
     C                     MOVELBZVMST    WL0025           Credit Item Sta
     C                     Z-ADDBZSWGH    WL0026           Std Weight/Head
     C                     Z-ADDBZPPHE    WL0027           Pieces Per Head
     C                     MOVELBZR3CD    WL0028           Department Code
     C                     MOVELBZSDCD    WL0029           Group for Packa
     C                     Z-ADDBZCNNB    WL0030           WIP Item Code
     C                     MOVELBZX5ST    WL0031           Seconds Item
     C                     MOVELBZPCCT    WL0032           Piece Count Ite
     C                     Z-ADDBZBDNB    WL0033           Pieces Per Bag
     C                     Z-ADDBZBJNB    WL0034           Bags Per Unit
     C                     MOVELBZSUST    WL0035           Export/Domestic
     C                     MOVELBZSVST    WL0036           Print On Schedu
     C                     MOVELBZSYST    WL0037           Fresh Inv Alloc
     C                     MOVELBZSZST    WL0038           Fresh Sched As
     C                     MOVELBZS1ST    WL0039           Frozen Inv Allo
     C                     MOVELBZXRCD    WL0040           Primal Group Co
     C                     MOVELBZS8ST    WL0041           Label Type
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV BOX ID FOR ITEM    RT - Item Bill Of Material  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0007  1        Package Type Co
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUC9NB           Box iD
     C                     MOVEL*BLANK    WN0007           Package Type Co
     C                     MOVEL*BLANK    $GNYNA           Box Description
      * Declare restrictor key work fields
     C           *LIKE     DEFN IOAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN IOHGCD    WQSJ02           Item Code
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Item Code
      * Setup key
     C                     Z-ADD$GAIC3    WQSJ01           Company Number
     C                     Z-ADD$GHGCD    WQSJ02           Item Code
      * Establish starting position
     C           KRSSJ     SETLL@IORETI                    *
     C           KRSSJ     READE@IORETI                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1679' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUC9NB           Box iD
     C                     MOVEL*BLANK    WN0007           Package Type Co
     C                     MOVEL*BLANK    $GNYNA           Box Description
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD0         WUAIWG           Unit Weight
      * RTV Item Type & PckCD  RT - Company/Item  * 
     C                     EXSR SKRVGN
      * CASE: PAR.Package Type Code is Box
     C           WN0007    IFEQ 'B'                        *IF
     C                     MOVELWUAVNA    $GNYNA           Box Description
     C                     Z-ADDWUAIWG    YN0001           Unit Weight
     C           IOC9NB    MULT 1         WUC9NB           Box iD
     C                     GOTO SJEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSJ     READE@IORETI                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Item Type & PckCD  RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAHGCD           Item Code
      * Setup key
     C                     Z-ADDIOAIC3    WAAIC3           Company Number
     C                     Z-ADDIOC9NB    WAHGCD           Item Code
      * Establish starting position
     C           KRSSK     CHAIN@BZREG0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAVNA           Description Lin
     C                     Z-ADD*ZERO     WUAIWG           Unit Weight
     C                     MOVEL*BLANK    WUN0CD           Item Type Code
     C                     MOVEL*BLANK    WN0007           Package Type Co
     C                     Z-ADD*ZERO     WUSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WUA3WG           Misc Tare Weigh
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAAVNA    WUAVNA           Description Lin
     C                     Z-ADDWAAIWG    WUAIWG           Unit Weight
     C                     MOVELWAN0CD    WUN0CD           Item Type Code
     C                     MOVELWAX4ST    WN0007           Package Type Co
     C                     Z-ADDWASFNB    WUSFNB           Pallet Tare Wei
     C                     Z-ADDWAA3WG    WUA3WG           Misc Tare Weigh
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Comment line 1    RT - PS Production Detail Com  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN JDAIC3    WQSL01           Company Number
     C           *LIKE     DEFN JDV5ST    WQSL02           Production Type
     C           *LIKE     DEFN JDELDT    WQSL03           Production Date
     C           *LIKE     DEFN JDHGCD    WQSL04           Item Code
     C           *LIKE     DEFN JDAJCD    WQSL05           Warehouse Code
      * Define keylist
     C           KPSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Production Type
     C                     KFLD           WQSL03           Production Date
     C                     KFLD           WQSL04           Item Code
     C                     KFLD           WQSL05           Warehouse Code
     C                     KFLD           JDDXNB           Sequence Number
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Production Type
     C                     KFLD           WQSL03           Production Date
     C                     KFLD           WQSL04           Item Code
     C                     KFLD           WQSL05           Warehouse Code
      * Setup key
     C                     Z-ADD$GAIC3    WQSL01           Company Number
     C                     MOVEL$GV5ST    WQSL02           Production Type
     C                     Z-ADD$GELDT    WQSL03           Production Date
     C                     Z-ADD$GHGCD    WQSL04           Item Code
     C                     MOVELP1AJCD    WQSL05           Warehouse Code
     C                     Z-ADD1         JDDXNB           Sequence Number
      * Establish starting position
     C           KPSSL     SETLL@JDCPU7                    *
     C           KRSSL     READE@JDCPU7                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1797' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $GALNA           Comment Line
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJDGXTX    $GALNA           Comment Line
     C                     GOTO SLEXIT                     *QUIT
     C           KRSSL     READE@JDCPU7                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Itm Bag Code      RT - Packaging BOM  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AZAIC3    WQSM01           Company Number
     C           *LIKE     DEFN AZHGCD    WQSM02           Item Code
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Item Code
      * Setup key
     C                     Z-ADD$GAIC3    WQSM01           Company Number
     C                     Z-ADD$GHGCD    WQSM02           Item Code
      * Establish starting position
     C           KRSSM     SETLL@AZCPPC                    *
     C           KRSSM     READE@AZCPPC                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $GBRAA           Packaging Item
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAZBRAA    $GBRAA           Packaging Item
     C                     GOTO SMEXIT                     *QUIT
     C           KRSSM     READE@AZCPPC                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Packaging Item    RT - Packaging Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           ARAIC3           Company Number
     C                     KFLD           ARBRAA           Packaging Item
      * Setup key
     C                     Z-ADD$GAIC3    ARAIC3           Company Number
     C                     MOVEL$GBRAA    ARBRAA           Packaging Item
      * Establish starting position
     C           KRSSN     CHAIN@ARREGL              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2982' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $GXITX           Pckg Item Descr
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELARXITX    $GXITX           Pckg Item Descr
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCRRC    BEGSR
      *================================================================
      * Crt PS Prod Item Sch SCR - PS Prod Item Sch Sum Rpt  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0008  1        Record Status
     C                     Z-ADD*ZERO     WN0009  70       Create Date
     C                     Z-ADD*ZERO     WN0010  60       Create Time
     C                     MOVEL*BLANK    WN0011 10        Create User
     C                     MOVEL*BLANK    WN0012 10        Create Program
     C                     Z-ADD*ZERO     WN0013  70       Change Date
     C                     Z-ADD*ZERO     WN0014  60       Change Time
     C                     MOVEL*BLANK    WN0015 10        Change User
     C                     MOVEL*BLANK    WN0016 10        Change Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AHCPM2
     C                     Z-ADDWL0042    AHFOC7           PSP Prod Run Se
     C                     MOVELWL0043    AHPOAA           PSP Primal Grou
     C                     Z-ADDWL0044    AHU8NY           PSP Report Sequ
     C                     MOVELWL0045    AHETVN           PSP Report ID
     C                     Z-ADDWL0046    AHUKDT           PSP Report Date
     C                     Z-ADDWL0047    AHDVTM           PSP Report Time
     C                     Z-ADDWL0048    AHCZC3           PSP Company Num
     C                     Z-ADDWL0049    AHUJDT           PSP Production
     C                     MOVELWL0050    AHO5AA           PSP Production
     C                     MOVELWL0051    AHO6AA           PSP Department
     C                     MOVELWL0052    AHT5NA           PSP Department
     C                     Z-ADDWL0053    AHFMC7           PSP Consumed It
     C                     Z-ADDWL0054    AHFJC7           PSP Item Code
     C                     MOVELWL0055    AHT6NA           PSO Item Descri
     C                     Z-ADDWL0056    AHQNQT           PSP Qty Product
     C                     MOVELWL0057    AHN4ST           PSP Piece Count
     C                     Z-ADDWL0058    AHVMNY           PSP Pieces Per
     C                     Z-ADDWL0059    AHVONY           PSP Bags Per Un
     C                     Z-ADDWL0060    AHVNNY           PSP Total Piece
     C                     MOVELWL0061    AHO8AA           PSP Packaging I
     C                     MOVELWL0062    AHO7AA           PSP U/M Primary
     C                     MOVELWL0063    AHT7NA           PSP BOX Desript
     C                     MOVELWL0064    AHYQT1           PSP Packaging I
     C                     MOVELWL0065    AHT8NA           PSP Comment Lin
     C                     MOVELWL0066    AHYPT1           PSP Text
     C                     MOVELWL0067    AHPPAA           PSP Primal Grou
     C                     MOVELWL0068    AHY3T1           PSP Sent Outsid
     C                     Z-ADDWL0069    AHFQC7           PSP WIP Item Co
     C                     MOVELWL0070    AHPVAA           PSP Shift/Prior
     C                     Z-ADDWL0071    AHVZNY           PSP Pieces Sche
     C                     MOVELWL0072    AHPBST           PSP Label Type
     C                     Z-ADDWL0073    AHR8AA           PSP Day 0
     C                     Z-ADDWL0074    AHR9AA           PSP Day 1
     C                     Z-ADDWL0075    AHSAAA           PSP Day 2
     C                     Z-ADDWL0076    AHSBAA           PSP Week Ending
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       AHVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     AHMJDT           Create Date
     C                     Z-ADD##JTM     AHBETM           Create Time
     C                     MOVEL##USR     AHCCVN           Create User
     C                     MOVEL##PGM     AHCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD0         AHMKDT           Change Date
     C                     Z-ADD0         AHBFTM           Change Time
     C                     MOVEL*BLANK    AHCEVN           Change User
     C                     MOVEL*BLANK    AHCFVN           Change Program
     C           KLCRSO    KLIST
     C                     KFLD           AHFOC7           PSP Prod Run Se
     C                     KFLD           AHPOAA           PSP Primal Grou
     C                     KFLD           AHU8NY           PSP Report Sequ
      * Check for duplicate primary key
     C           KLCRSO    SETLL@AHCPM2                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR4491' W0RTN   7
      * Send message 'PS Prod Item Sch Sum R EX'
     C                     MOVEL'USR4491' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C                     WRITE@AHCPM2                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV On Hand Qty       RT - Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0080           On Hand U/M1 Su
      * Declare restrictor key work fields
     C           *LIKE     DEFN B0AIC3    WQSP01           Company Number
     C           *LIKE     DEFN B0AJCD    WQSP02           Warehouse Code
     C           *LIKE     DEFN B0HGCD    WQSP03           Item Code
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Company Number
     C                     KFLD           WQSP02           Warehouse Code
     C                     KFLD           WQSP03           Item Code
      * Setup key
     C                     Z-ADDWL0077    WQSP01           Company Number
     C                     MOVELWL0079    WQSP02           Warehouse Code
     C                     Z-ADDWL0078    WQSP03           Item Code
      * Establish starting position
     C           KRSSP     SETLL@B0REHD                    *
     C           KRSSP     READE@B0REHD                  90*
      * Data record not found
     C   90                MOVEL'USR0328' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  B0DDQT    WL0080           On Hand U/M1 Su
     C           KRSSP     READE@B0REHD                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV First 70char       RT - Order Comment  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0017  50       Count USR
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    WL0084           USR Text 70
     C                     Z-ADD0         WN0017           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN COAIC3    WQSQ01           Company Number
     C           *LIKE     DEFN COC4NB    WQSQ02           Order Number
     C           *LIKE     DEFN COI1SX    WQSQ03           Comment Type
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Company Number
     C                     KFLD           WQSQ02           Order Number
     C                     KFLD           WQSQ03           Comment Type
      * Setup key
     C                     Z-ADDWL0081    WQSQ01           Company Number
     C                     Z-ADDWL0082    WQSQ02           Order Number
     C                     MOVELWL0083    WQSQ03           Comment Type
      * Establish starting position
     C           KRSSQ     SETLL@COCPNU                    *
     C           KRSSQ     READE@COCPNU                  90*
      * Data record not found
     C   90                MOVEL'USR0486' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WN0017           Count USR
      * CASE: PAR.Count USR is One
     C           WN0017    IFEQ 1                          *IF
     C                     MOVEL*BLANK    WL0084           USR Text 70
     C                     MOVELCOG4NA    WL0084           USR Text 70
     C                     ELSE
      * CASE: PAR.Count USR is LE 3
     C           WN0017    IFLE 3                          *IF
     C                     Z-ADD1         ZQ      50
     C           WL0084    CAT  COG4NA:ZQ WL0084    P      USR Text 70
     C                     ELSE
      * CASE: *OTHERWISE
     C                     GOTO SQEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSQ     READE@COCPNU                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv ProdInfm          Rt - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0085    FJRMNB           Load ID
      * Establish starting position
     C           KRSSR     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0086           Product Tempera
     C                     Z-ADD*ZERO     WL0087           Product Complet
     C                     Z-ADD*ZERO     WL0088           Product Complet
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJPRTM    WL0086           Product Tempera
     C                     Z-ADDFJK0DT    WL0087           Product Complet
     C                     Z-ADDFJAYTM    WL0088           Product Complet
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCRRC    BEGSR
      *================================================================
      * Crt PS Prod Item Sch DCR - PS Prod Item Sch Dtl Rpt  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0018  1        Record Status
     C                     Z-ADD*ZERO     WN0019  70       Create Date
     C                     Z-ADD*ZERO     WN0020  60       Create Time
     C                     MOVEL*BLANK    WN0021 10        Create User
     C                     MOVEL*BLANK    WN0022 10        Create Program
     C                     Z-ADD*ZERO     WN0023  70       Change Date
     C                     Z-ADD*ZERO     WN0024  60       Change Time
     C                     MOVEL*BLANK    WN0025 10        Change User
     C                     MOVEL*BLANK    WN0026 10        Change Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @ANCPOA
     C                     Z-ADDP8FOC7    ANFPC7           PSO Prod Run Se
     C                     MOVELP6S0CD    ANPRAA           PSO Primal Grou
     C                     Z-ADDWUVWNY    ANVWNY           PSO Report Sequ
     C                     MOVELWUETVN    ANEZVN           PSO Report ID
     C                     Z-ADDWUUKDT    ANUQDT           PSO Report Date
     C                     Z-ADDWUDVTM    AND0TM           PSO Report Time
     C                     Z-ADDEUCOC3    ANC1C3           PSO Company Num
     C                     Z-ADDEUSPDT    ANURDT           PSO Production
     C                     MOVELEUKDAA    ANPSAA           PSO Production
     C                     MOVELEUTUT1    ANZQT1           PSO Customer Na
     C                     Z-ADDEUNKNY    ANV2NY           PSO Load Schedu
     C                     Z-ADDEUEXC7    ANFSC7           PSO Order Numbe
     C                     Z-ADDEUNJNY    ANV1NY           PSO Load Id
     C                     Z-ADDEUEYC7    ANFTC7           PSO Item Code
     C                     MOVELEUS1NA    ANT6NA           PSO Item Descri
     C                     Z-ADDEUSPDT    ANUVDT           PSO Schedule Sh
     C                     Z-ADD$SN1NY    ANV4NY           PSO Qty
     C                     Z-ADDEUTNDT    ANUWDT           PSO Production
     C                     MOVELYL0044    ANZRT1           PSO Est Prd Rea
     C                     MOVELWUT6T1    ANZST1           PSO Flag Held O
     C                     MOVELWUULTX    ANZTT1           PSO Day of the
     C                     Z-ADDEUSODT    ANUXDT           PSO Deadline De
     C                     Z-ADDEUNLNY    AND1TM           PSO Deadline De
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       ANVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     ANMJDT           Create Date
     C                     Z-ADD##JTM     ANBETM           Create Time
     C                     MOVEL##USR     ANCCVN           Create User
     C                     MOVEL##PGM     ANCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD0         ANMKDT           Change Date
     C                     Z-ADD0         ANBFTM           Change Time
     C                     MOVEL*BLANK    ANCEVN           Change User
     C                     MOVEL*BLANK    ANCFVN           Change Program
     C           KLCRSS    KLIST
     C                     KFLD           ANFPC7           PSO Prod Run Se
     C                     KFLD           ANPRAA           PSO Primal Grou
     C                     KFLD           ANVWNY           PSO Report Sequ
      * Check for duplicate primary key
     C           KLCRSS    SETLL@ANCPOA                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR4534' W0RTN   7
      * Send message 'PS Prod Item Sch Dtl R EX'
     C                     MOVEL'USR4534' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C                     WRITE@ANCPOA                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modification History
      *================================================================
      * slm 08/2012 installed
      * New Print report was greated on the E02098 enhancement.
      * slm 08/28/2012 going to write records to
      * PS Prod Item Sched Summary, and also to the PS Prod Item Sched De
      * then these files will be used later for additional reporting
      * to the Carlisle and/or the new Web application
      * only write these records if the production run sequence is
      * greater the zero
      * E3796 JJH 02/11/15 - Add OPS Requested Ship Date to WF OrderProd
      *  Schedule - Recompiled with no logic changes.
      * E3796 JJH 02/25/15 - Use Requested Ship Date instead of Schedule
      *  Ship Date.
      * - Change I Parm from Scheduled Ship Date to Requested Ship Date
      * - Changed all field values from Sheduled Ship Date to Requested
      *   to Requested Ship Date
      * - Use Company Value "PRDPRTDDT" to set to Y or N to print the
      *   Depature Date/Time.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Prd Schedule      PO
      *================================================================
      * If this program changes verify the name of the subr that is
      * being used here due to also executing the subr in the
      * null processing due to if no records in files also need
      * this print object to execute there on the null area of this
      * action diagram.
      * E3796 JJH 02/25/15 - Use Requested Ship Date
      * CASE: PAR.Requested Ship Date EQ JOB.*Job date
     C           P1A5DT    IFEQ ##JDT                      *IF
     C                     MOVEL'S'       WUFCST           Production Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'P'       WUFCST           Production Type
     C                     END                             *FI
      * E3796 JJH 02/25/15 - Use Requested Ship Date
      *
     C                     MOVEL*BLANK    WN0001 30        Description Lin
     C                     Z-ADD*ZERO     WN0002 112       Unit Weight
     C                     MOVEL*BLANK    WN0003  1        Piece Count Ite
     C                     Z-ADD*ZERO     WN0004  70       Pieces Per Bag
     C                     Z-ADD*ZERO     WN0005  70       Bags Per Unit
     C                     MOVEL*BLANK    WN0006  1        Print On Schedu
      *
      * Prt Prd Schedule PrmPsPO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Modification History
      *================================================================
      * ** 05/29/2012 SLM Clone print file to a print object
      * ** this function will not create spread sheet as the other
      * ** production schedule will, this print object will be used
      * ** for the Belly, Trim, and the Picnic Schedule
      * E3796 JJH 03/02/15 - Requested Ship Date for Production Schedule
      * - Changed I Parm from Scheduled Ship Date to Requested Ship Date
      *   Rtv Day0,Day1...Etc   XF - Order Detail.
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Addition sel boxes  IF SND to carlisle bx, and combos else bx on
      *================================================================
      * IF SEND TO CARLISLE COMBO/BOXES IF NOT SEND TO CARLISLE BOXES ONL
      * CASE: LCL.Carlisle Interface Usr is Send to Carlisle
     C           YL0004    IFEQ 'C'                        *IF
     C           YL0004    OREQ 'F'
      * CASE: WRK.U/M - Primary is Combos
     C           WUADCD    IFEQ 'CB'                       *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: WRK.U/M - Primary is EQ Boxes
     C           WUADCD    IFEQ 'BX'                       *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.U/M - Primary is NE Boxes
     C           WUADCD    IFNE 'BX'                       *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Weight Schedule production
      *================================================================
      * Weight Scheduled
      * WRK.Weight Sched Prod USR =
      *    *COMPUTE (x1 + x2 - x3 - x4)
      * x1    : DB1.PS Weight Standard
      * +     : PGM.*Synon (15,2) work field
      * x2    : DB1.PS Weight Prod Adj
      * -     : PGM.*Synon (15,2) work field
      * x3    : DB1.PS Weight Converted
      * -     : PGM.*Synon (15,2) work field
      * x4    : DB1.PS Weight Whse Tfr Adj
     C           I8DXWG    ADD  I8D1WG    W0WA02           *Synon (15,2) w
     C           W0WA02    SUB  I8WTCN    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  I8GAWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUF2WG           Weight Sched Pr
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Pieces Scheduled
      *================================================================
      * Pieces Scheduled
      * WRK.Pieces Scheduled =
      *    *COMPUTE (x1 + x2 - x3 - x4)
      * x1    : DB1.PS Pieces Standard
      * +     : PGM.*Synon (15,2) work field
      * x2    : DB1.PS Pieces Prod Adj
      * -     : PGM.*Synon (15,2) work field
      * x3    : DB1.PS Pieces Converted
      * -     : PGM.*Synon (15,2) work field
      * x4    : DB1.PS Pieces Whse Tfr Adj
     C           I8B2NB    ADD  I8CBNB    W0WA02           *Synon (15,2) w
     C           W0WA02    SUB  I8PSCV    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  I8BPNB    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUPIAC           Pieces Schedule
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Item Comments     PO
      *================================================================
      * Prt Item Comments     PO: Mainline
     C                     EXSR C0MAIN
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Sel Prd SchItm-All2PO
      *================================================================
      * CASE: DB1.OPS Order Number is Equal to zeros
     C           EUEXC7    IFEQ *ZERO                      *IF
     C                     GOTO UHEXIT                     *QUIT
     C                     ELSE
      * CASE: PAR.Summary Selected Usr is no
     C           P5ETST    IFEQ 'N'                        *IF
     C                     GOTO UHEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * E3796 JJH 02/25/15 - Use Requested Ship Date
      * Prt Prd Schedule PrmOrdPO: Mainline
     C                     EXSR D0MAIN
     C                     ADD  4         WUXGNX           Count Records
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Modificaitons and Comments
      *================================================================
      * E1819 RMC 11/30/11
      * New to count all item in workfile in qtemp -- dont break on prima
      * E3796 JJH 02/11/15 - Add OPS Requested Ship Date to WF OrderProd
      *  Schedule - Recompiled with no logic changes.
      * E3796 JJH 03/03/15 - Change I Parm from Scheduled Ship Date to
      *  Requested Ship Date.
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * Accumulate totals for UOM and Primal Group
      *================================================================
      * Total Inv for Chk , Total Quantity Ship  USR
      * Total Quantity to MakeUsr, Total Work Ahead Usr
      * Total Work Ahead Usr2
      * UOM Totals - Total Inv for Chk
     C                     ADD  WUZ7VA    WUQRQT           Total Amount 11
     C                     ADD  WUMEQT    WUQTQT           Total Amount 12
     C                     ADD  WUPJQT    WUQUQT           Total Amount 13
     C                     ADD  WUP2QT    WUQVQT           Total Amount 14
     C                     ADD  WUQIQT    WUQWQT           Total Amount 15
      * Primal Group
     C                     ADD  WUZ7VA    WUPUQT           Total Amount 1
     C                     ADD  WUMEQT    WUPVQT           Total Amount 2
     C                     ADD  WUPJQT    WUPWQT           Total Amount 3
     C                     ADD  WUP2QT    WUPXQT           Total Amount 4
     C                     ADD  WUQIQT    WUQHQT           Total Amount 5
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZBINIT    BEGSR
      *================================================================
      * Prt Prd Schedule PrmPsPO: Initialise
      *================================================================
      * USER: Initialize program
      * Modification History
     C                     EXSR UCSUBR                     Modification Hi
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL'P/S'     WL0001    P      Application Cod
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    WUAUNA    P      Description
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
     C                     MOVEL'Y'       WUTAST           First Time Flag
      *================================================================
     CSR         ZBEXIT    ENDSR
      /EJECT
     CSR         ZCINIT    BEGSR
      *================================================================
      * Prt Item Comments     PO: Initialise
      *================================================================
      * USER: Initialize program
     C                     MOVEL'Y'       WUTAST           First Time Flag
      *================================================================
     CSR         ZCEXIT    ENDSR
      /EJECT
     CSR         ZDINIT    BEGSR
      *================================================================
      * Prt Prd Schedule PrmOrdPO: Initialise
      *================================================================
      * USER: Initialize program
      * Modificaitons and Comments
     C                     EXSR UISUBR                     Modificaitons a
     C                     MOVEL*BLANK    WUT6T1           Flag Held Over
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUCNTU  50
      * Define work field Count 2 USR
     C                     Z-ADD*ZERO     WUA7NX  50
      * Define work field Count USR 3
     C                     Z-ADD*ZERO     WUNLNX  50
      * Define work field Print Date            USR
     C                     MOVEL*BLANK    WUB2SX  1
      * Define work field Page Control Usr
     C                     MOVEL*BLANK    WUPGST  1
      * Define work field PSP Report ID
     C                     MOVEL*BLANK    WUETVN 10
      * Define work field PSP Report Date
     C                     Z-ADD*ZERO     WUUKDT  70
      * Define work field PSP Report Time
     C                     Z-ADD*ZERO     WUDVTM  60
      * Define work field PSP Prod Run Sequence
     C                     Z-ADD*ZERO     WUFOC7  70
      * Define work field Date 0 RGF
     C                     Z-ADD*ZERO     WUVHDT  70
      * Define work field Date 1 RGF
     C                     Z-ADD*ZERO     WURWDT  70
      * Define work field Date 2 RGF
     C                     Z-ADD*ZERO     WURYDT  70
      * Define work field Date 3 RGF
     C                     Z-ADD*ZERO     WUR0DT  70
      * Define work field Date 3 RGT
     C                     Z-ADD*ZERO     WUR1DT  70
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    EUCOC3           OPS Company Num
     C                     MOVEL*LOVAL    EUKDAA           OPS Warehouse
     C                     MOVEL*LOVAL    EUVQDT           OPS Requested S
     C                     MOVEL*LOVAL    EUSPDT           OPS Schedule Sh
     C                     MOVEL*LOVAL    EUNKNY           OPS Load Schedu
     C                     MOVEL*LOVAL    EUSODT           OPS Deadline De
     C                     MOVEL*LOVAL    EUNLNY           OPS Deadline De
     C                     MOVEL*LOVAL    EUNJNY           OPS Load Id
     C                     MOVEL*LOVAL    EUEXC7           OPS Order Numbe
     C                     MOVEL*LOVAL    EUEYC7           OPS Item Code
      * Define work field USR Display field
     C                     MOVEL*BLANK    WUGGST  1
      * Define work field PSP Primal Group Rpt
     C                     MOVEL*BLANK    WUPOAA  3
      * Define work field PSP Report Sequence
     C                     Z-ADD*ZERO     WUU8NY  50
      * Define work field Count Records        USR
     C                     Z-ADD*ZERO     WUXGNX  50
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field Production Type USR
     C                     MOVEL*BLANK    WUFCST  1
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    I8AIC3           Company Number
     C                     MOVEL*LOVAL    I8V5ST           Production Type
     C                     MOVEL*LOVAL    I8ELDT           Production Date
     C                     MOVEL*LOVAL    I8R3CD           Department Code
     C                     MOVEL*LOVAL    I8HGCD           Item Code
     C                     MOVEL*LOVAL    I8B7ST           PS Production W
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field PSP Department Code
     C                     MOVEL*BLANK    WUO6AA  6
      * Define work field PSP Department Dscrptn
     C                     MOVEL*BLANK    WUT5NA 30
      * Define work field Qty Production Total Usr
     C                     Z-ADD*ZERO     WUQBQT  61
      * Define work field Quantity Production USR
     C                     Z-ADD*ZERO     WUWPRD  61
      * Define work field U/M - Primary
     C                     MOVEL*BLANK    WUADCD  2
      * Define work field Item Structure Class Code
     C                     Z-ADD*ZERO     WURINB  30
      * Define work field Item Structure Group Code
     C                     Z-ADD*ZERO     WURHNB  30
      * Define work field Item Structure Type Code
     C                     Z-ADD*ZERO     WURGNB  30
      * Define work field Item Type Code
     C                     MOVEL*BLANK    WUN0CD  3
      * Define work field Default Warehouse
     C                     MOVEL*BLANK    WUQ1CD  3
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Define work field Base/Conv/Loss Item
     C                     MOVEL*BLANK    WUQZCD  2
      * Define work field Variety/Rendered/Cut
     C                     MOVEL*BLANK    WUXWST  1
      * Define work field Credit Item Status
     C                     MOVEL*BLANK    WUVMST  1
      * Define work field Std Weight/Head (Var/Ren)
     C                     Z-ADD*ZERO     WUSWGH 112
      * Define work field Pieces Per Head
     C                     Z-ADD*ZERO     WUPPHE  70
      * Define work field Department Code
     C                     MOVEL*BLANK    WUR3CD  6
      * Define work field Group for Packaging
     C                     MOVEL*BLANK    WUSDCD  1
      * Define work field Item Category Number 6
     C                     Z-ADD*ZERO     WUICN6  20
      * Define work field Item Primal Sched Report
     C                     MOVEL*BLANK    WUS0CD  3
      * Define work field WIP Item Code
     C                     Z-ADD*ZERO     WUCNNB  70
      * Define work field Seconds Item
     C                     MOVEL*BLANK    WUX5ST  1
      * Define work field Export/Domestic
     C                     MOVEL*BLANK    WUSUST  1
      * Define work field Fresh Inv Allocation Seq
     C                     MOVEL*BLANK    WUSYST  1
      * Define work field Fresh Sched As Ordered
     C                     MOVEL*BLANK    WUSZST  1
      * Define work field Frozen Inv Allocation Seq
     C                     MOVEL*BLANK    WUS1ST  1
      * Define work field Primal Group Code
     C                     MOVEL*BLANK    WUXRCD  6
      * Define work field Label Type
     C                     MOVEL*BLANK    WUS8ST  2
      * Define work field PSP Pieces Schedule
     C                     Z-ADD*ZERO     WUVZNY  50
      * Define work field Weight Sched Prod USR
     C                     Z-ADD*ZERO     WUF2WG  92
      * Define work field Pieces Scheduled
     C                     Z-ADD*ZERO     WUPIAC  70
      * Define work field Item Piece Count Flag Chg
     C                     MOVEL*BLANK    WUEJST  1
      * Define work field Weight Production USR
     C                     Z-ADD*ZERO     WUFUWG  92
      * Define work field Department Description
     C                     MOVEL*BLANK    WUMYNA 30
      * Define work field PSO Item Description
     C                     MOVEL*BLANK    WUT6NA 30
      * Define work field Component Item Code
     C                     Z-ADD*ZERO     WUC9NB  70
      * Define work field Unit Weight
     C                     Z-ADD*ZERO     WUAIWG 112
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field Pallet Tare Weight
     C                     Z-ADD*ZERO     WUSFNB  52
      * Define work field Misc Tare Weight
     C                     Z-ADD*ZERO     WUA3WG  52
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WAAIWG           Unit Weight
     C                     Z-ADD*ZERO     WACZWG           Minimum Weight
     C                     Z-ADD*ZERO     WAC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WAURTN           Number Cases On
     C                     Z-ADD*ZERO     WAAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WATFNB           Transportation
     C                     Z-ADD*ZERO     WATMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WATNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WABLPR           Market Overage
     C                     Z-ADD*ZERO     WABMPR           Standard Overag
     C                     Z-ADD*ZERO     WACMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WACHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WASWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WAPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WAICN1           Item Category N
     C                     Z-ADD*ZERO     WAICN2           Item Category N
     C                     Z-ADD*ZERO     WAV2NB           Item Category N
     C                     Z-ADD*ZERO     WAITCN           Item Category N
     C                     Z-ADD*ZERO     WAITC5           Item Category N
     C                     Z-ADD*ZERO     WAICN6           Item Category N
     C                     Z-ADD*ZERO     WAICN7           Item Category N
     C                     Z-ADD*ZERO     WAICN8           Item Category N
     C                     Z-ADD*ZERO     WAICN9           Item Category N
     C                     Z-ADD*ZERO     WAICN0           Item Category N
     C                     Z-ADD*ZERO     WASFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WAA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WASJNB           Production Lead
     C                     Z-ADD*ZERO     WASKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WASLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WASMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WACFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WACGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WAILNB           Packages per ca
     C                     Z-ADD*ZERO     WACHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WACINB           PM Batch Size
     C                     Z-ADD*ZERO     WACJNB           Package Level s
     C                     Z-ADD*ZERO     WACMNB           Partial Item Co
     C                     Z-ADD*ZERO     WACNNB           WIP Item Code
     C                     Z-ADD*ZERO     WACRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WACSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WACVNB           FP Std Green We
     C                     Z-ADD*ZERO     WACWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WACXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WACZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WAC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WAB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WAB5NB           PM Line Number
     C                     Z-ADD*ZERO     WABDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WABJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WAF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WAF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WAF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WABLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WABNNB           Production Qty
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Clear all neither parameters
      * Crt PS Prod Item Sch SCR - PS Prod Item Sch Sum Rpt  * 
     C                     Z-ADD*ZERO     AHMJDT           Create Date
     C                     Z-ADD*ZERO     AHBETM           Create Time
     C                     Z-ADD*ZERO     AHMKDT           Change Date
     C                     Z-ADD*ZERO     AHBFTM           Change Time
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    JDAIC3           Company Number
     C                     MOVEL*LOVAL    JDV5ST           Production Type
     C                     MOVEL*LOVAL    JDELDT           Production Date
     C                     MOVEL*LOVAL    JDHGCD           Item Code
     C                     MOVEL*LOVAL    JDAJCD           Warehouse Code
     C                     MOVEL*LOVAL    JDDXNB           Sequence Number
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBNINY           OPS Sequence No
     C                     Z-ADD*ZERO     WBCOC3           OPS Company Num
     C                     Z-ADD*ZERO     WBSPDT           OPS Schedule Sh
     C                     Z-ADD*ZERO     WBVQDT           OPS Requested S
     C                     Z-ADD*ZERO     WBEXC7           OPS Order Numbe
     C                     Z-ADD*ZERO     WBNJNY           OPS Load Id
     C                     Z-ADD*ZERO     WBNKNY           OPS Load Schedu
     C                     Z-ADD*ZERO     WBSODT           OPS Deadline De
     C                     Z-ADD*ZERO     WBNLNY           OPS Deadline De
     C                     Z-ADD*ZERO     WBEYC7           OPS Item Code
     C                     Z-ADD*ZERO     WBPIQT           OPS Quantity Or
     C                     Z-ADD*ZERO     WBRINY           Item Age Days
     C                     Z-ADD*ZERO     WBTIDT           Production Ovr
     C                     Z-ADD*ZERO     WBTJDT           Production Ovr
     C                     Z-ADD*ZERO     WBTNDT           Production AgeD
     C                     Z-ADD*ZERO     WBTODT           Production AgeD
     C                     Z-ADD*ZERO     WBVTNY           OPS U/M Sequenc
     C                     Z-ADD*ZERO     WBICN6           Item Category N
      * Define work field Flag Held Over Usr
     C                     MOVEL*BLANK    WUT6T1  3
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WBCOC3           OPS Company Num
     C                     MOVEL*LOVAL    WBVTNY           OPS U/M Sequenc
     C                     MOVEL*LOVAL    WBKEAA           OPS Primal Grou
     C                     MOVEL*LOVAL    WBEYC7           OPS Item Code
      * Define work field UOM To USR
     C                     MOVEL*BLANK    WUH7AA  2
      * Define work field On Hand U/M1 Summary
     C                     Z-ADD*ZERO     WUDDQT 112
      * Define work field Total Inv for Chk     USR
     C                     Z-ADD*ZERO     WUZ7VA 112
      * Define work field Total Work Ahead Usr
     C                     Z-ADD*ZERO     WUP2QT 112
      * Define work field Total Work Ahead Usr2
     C                     Z-ADD*ZERO     WUQIQT 112
      * Define work field Total Quantity Ship  USR
     C                     Z-ADD*ZERO     WUMEQT 112
      * Define work field Total Quantity to MakeUsr
     C                     Z-ADD*ZERO     WUPJQT 112
      * Define work field Total Amount 11 3/0 Usr
     C                     Z-ADD*ZERO     WUQRQT  30
      * Define work field Total Amount 12 3/0 Usr
     C                     Z-ADD*ZERO     WUQTQT  30
      * Define work field Total Amount 13 3/0 Usr
     C                     Z-ADD*ZERO     WUQUQT  30
      * Define work field Total Amount 14 3/0 Usr
     C                     Z-ADD*ZERO     WUQVQT  30
      * Define work field Total Amount 15 3/0 Usr
     C                     Z-ADD*ZERO     WUQWQT  30
      * Define work field Total Amount 1 3/0 Usr
     C                     Z-ADD*ZERO     WUPUQT  30
      * Define work field Total Amount 2 3/0 Usr
     C                     Z-ADD*ZERO     WUPVQT  30
      * Define work field Total Amount 3 3/0 Usr
     C                     Z-ADD*ZERO     WUPWQT  30
      * Define work field Total Amount 4 3/0 Usr
     C                     Z-ADD*ZERO     WUPXQT  30
      * Define work field Total Amount 5 3/0 Usr
     C                     Z-ADD*ZERO     WUQHQT  30
      * Define work field PSP Day 0
     C                     Z-ADD*ZERO     WUR8AA  70
      * Define work field PSP Day 1
     C                     Z-ADD*ZERO     WUR9AA  70
      * Define work field PSP Day 2
     C                     Z-ADD*ZERO     WUSAAA  70
      * Define work field PSP Week Ending Summary
     C                     Z-ADD*ZERO     WUSBAA  70
      * Define work field Quantity Prod Avail USR
     C                     Z-ADD*ZERO     WUDWNX  61
      * Define work field Count Ahead USR
     C                     Z-ADD*ZERO     WUJKNX  50
      * Define work field Count Items Records Usr
     C                     Z-ADD*ZERO     WUNVNY  50
      * Define work field Day of the Week USR
     C                     MOVEL*BLANK    WUULTX  9
      * Define work field Deadline Depart Time 4,0
     C                     Z-ADD*ZERO     WUYBNB  40
      * Define work field Est Prd Ready Time Usr
     C                     MOVEL*BLANK    WUVTT1 25
      * Define work field Month (Char) USR
     C                     MOVEL*BLANK    WUT5TX  2
      * Define work field Day   (Char) USR
     C                     MOVEL*BLANK    WUT6TX  2
      * Define work field Century Usr TXT
     C                     MOVEL*BLANK    WUVQT1  2
      * Define work field Year  (Char) USR
     C                     MOVEL*BLANK    WUT4TX  2
      * Define work field Hours  2A            USR
     C                     MOVEL*BLANK    WUVDCD  2
      * Define work field Minutes  2A          USR
     C                     MOVEL*BLANK    WUVECD  2
      * Define work field Seconds 2A            USR
     C                     MOVEL*BLANK    WUY6CD  2
      * Define work field PSO Report Sequence
     C                     Z-ADD*ZERO     WUVWNY  50
      * Clear all neither parameters
      * Crt PS Prod Item Sch DCR - PS Prod Item Sch Dtl Rpt  * 
     C                     Z-ADD*ZERO     ANMJDT           Create Date
     C                     Z-ADD*ZERO     ANBETM           Create Time
     C                     Z-ADD*ZERO     ANMKDT           Change Date
     C                     Z-ADD*ZERO     ANBFTM           Change Time
      * Define work field Display Ord Dtl Cmnts USR
     C                     MOVEL*BLANK    WUHDSX  1
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WA02 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WJ01 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     MOVEL*BLANK    WL0001  6
     C                     MOVEL*BLANK    WL0002 30
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0003  30
     C                     MOVEL*BLANK    WL0004  6
     C                     MOVEL*BLANK    WL0005 30
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  20
     C                     MOVEL*BLANK    WL0008  3
     C                     MOVEL*BLANK    WL0009 30
     C                     MOVEL*BLANK    WL0010  1
     C                     MOVEL*BLANK    WL0011 30
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0012  30
     C                     Z-ADD*ZERO     WL0013  70
     C                     MOVEL*BLANK    WL0014 30
     C                     MOVEL*BLANK    WL0015  2
     C                     Z-ADD*ZERO     WL0016 112
     C                     Z-ADD*ZERO     WL0017  30
     C                     Z-ADD*ZERO     WL0018  30
     C                     Z-ADD*ZERO     WL0019  30
     C                     MOVEL*BLANK    WL0020  3
     C                     MOVEL*BLANK    WL0021  3
     C                     Z-ADD*ZERO     WL0022  52
     C                     MOVEL*BLANK    WL0023  2
     C                     MOVEL*BLANK    WL0024  1
     C                     MOVEL*BLANK    WL0025  1
     C                     Z-ADD*ZERO     WL0026 112
     C                     Z-ADD*ZERO     WL0027  70
     C                     MOVEL*BLANK    WL0028  6
     C                     MOVEL*BLANK    WL0029  1
     C                     Z-ADD*ZERO     WL0030  70
     C                     MOVEL*BLANK    WL0031  1
     C                     MOVEL*BLANK    WL0032  1
     C                     Z-ADD*ZERO     WL0033  70
     C                     Z-ADD*ZERO     WL0034  70
     C                     MOVEL*BLANK    WL0035  1
     C                     MOVEL*BLANK    WL0036  1
     C                     MOVEL*BLANK    WL0037  1
     C                     MOVEL*BLANK    WL0038  1
     C                     MOVEL*BLANK    WL0039  1
     C                     MOVEL*BLANK    WL0040  6
     C                     MOVEL*BLANK    WL0041  2
      * Define local variables for subroutine SOCRRC.
     C                     Z-ADD*ZERO     WL0042  70
     C                     MOVEL*BLANK    WL0043  3
     C                     Z-ADD*ZERO     WL0044  50
     C                     MOVEL*BLANK    WL0045 10
     C                     Z-ADD*ZERO     WL0046  70
     C                     Z-ADD*ZERO     WL0047  60
     C                     Z-ADD*ZERO     WL0048  30
     C                     Z-ADD*ZERO     WL0049  70
     C                     MOVEL*BLANK    WL0050  3
     C                     MOVEL*BLANK    WL0051  6
     C                     MOVEL*BLANK    WL0052 30
     C                     Z-ADD*ZERO     WL0053  70
     C                     Z-ADD*ZERO     WL0054  70
     C                     MOVEL*BLANK    WL0055 30
     C                     Z-ADD*ZERO     WL0056  61
     C                     MOVEL*BLANK    WL0057  1
     C                     Z-ADD*ZERO     WL0058  70
     C                     Z-ADD*ZERO     WL0059  70
     C                     Z-ADD*ZERO     WL0060  70
     C                     MOVEL*BLANK    WL0061 25
     C                     MOVEL*BLANK    WL0062  2
     C                     MOVEL*BLANK    WL0063 30
     C                     MOVEL*BLANK    WL0064 50
     C                     MOVEL*BLANK    WL0065 30
     C                     MOVEL*BLANK    WL0066 40
     C                     MOVEL*BLANK    WL0067  6
     C                     MOVEL*BLANK    WL0068  1
     C                     Z-ADD*ZERO     WL0069  70
     C                     MOVEL*BLANK    WL0070  3
     C                     Z-ADD*ZERO     WL0071  50
     C                     MOVEL*BLANK    WL0072  2
     C                     Z-ADD*ZERO     WL0073  70
     C                     Z-ADD*ZERO     WL0074  70
     C                     Z-ADD*ZERO     WL0075  70
     C                     Z-ADD*ZERO     WL0076  70
      * Define local variables for subroutine SPRVGN.
     C                     Z-ADD*ZERO     WL0077  30
     C                     Z-ADD*ZERO     WL0078  70
     C                     MOVEL*BLANK    WL0079  3
     C                     Z-ADD*ZERO     WL0080 112
      * Define local variables for subroutine SQRVGN.
     C                     Z-ADD*ZERO     WL0081  30
     C                     Z-ADD*ZERO     WL0082  70
     C                     MOVEL*BLANK    WL0083  2
     C                     MOVEL*BLANK    WL0084 70
      * Define local variables for subroutine SRRVGN.
     C                     Z-ADD*ZERO     WL0085  70
     C                     Z-ADD*ZERO     WL0086  52
     C                     Z-ADD*ZERO     WL0087  70
     C                     Z-ADD*ZERO     WL0088  60
      * Define local work field System Value Alpha
     C                     MOVEL*BLANK    YL0001 40
      * Define local work field Print Dead Depart Dt/Tm
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field Text USR 20
     C                     MOVEL*BLANK    YL0003 20
      * Define local work field Carlisle Interface Usr
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Text USR 23
     C                     MOVEL*BLANK    YL0005 23
      * Define local work field Base/Conv/Loss Item
     C                     MOVEL*BLANK    YL0006  2
      * Define null work field Unit Weight
     C                     Z-ADD*ZERO     YN0001 112
      * Define local work field PSP Total Pieces
     C                     Z-ADD*ZERO     YL0007  70
      * Define local work field PSP Day 0
     C                     Z-ADD*ZERO     YL0008  70
      * Define local work field PSP Day 1
     C                     Z-ADD*ZERO     YL0009  70
      * Define local work field PSP Day 2
     C                     Z-ADD*ZERO     YL0010  70
      * Define local work field PSP Week Ending Summary
     C                     Z-ADD*ZERO     YL0011  70
      * Define local work field PSP Consumed Item Code
     C                     Z-ADD*ZERO     YL0012  70
      * Define local work field PSP Comment Line 1
     C                     MOVEL*BLANK    YL0013 30
      * Define local work field PSP Text
     C                     MOVEL*BLANK    YL0014 40
      * Define local work field PSP Shift/Priority Code
     C                     MOVEL*BLANK    YL0015  3
      * Define local work field PSP Pieces Schedule
     C                     Z-ADD*ZERO     YL0016  50
      * Define local work field PSP Total Pieces
     C                     Z-ADD*ZERO     YL0017  70
      * Define null work field Description Line One
     C                     MOVEL*BLANK    YN0002 30
      * Define local work field U/M - Primary
     C                     MOVEL*BLANK    YL0018  2
      * Define local work field Unit Weight
     C                     Z-ADD*ZERO     YL0019 112
      * Define null work field Item Structure Class Code
     C                     Z-ADD*ZERO     YN0003  30
      * Define null work field Item Structure Group Code
     C                     Z-ADD*ZERO     YN0004  30
      * Define null work field Item Structure Type Code
     C                     Z-ADD*ZERO     YN0005  30
      * Define null work field Item Type Code
     C                     MOVEL*BLANK    YN0006  3
      * Define null work field Default Warehouse
     C                     MOVEL*BLANK    YN0007  3
      * Define null work field Fresh Chilling Time
     C                     Z-ADD*ZERO     YN0008  52
      * Define null work field Base/Conv/Loss Item
     C                     MOVEL*BLANK    YN0009  2
      * Define null work field Variety/Rendered/Cut
     C                     MOVEL*BLANK    YN0010  1
      * Define null work field Credit Item Status
     C                     MOVEL*BLANK    YN0011  1
      * Define null work field Std Weight/Head (Var/Ren)
     C                     Z-ADD*ZERO     YN0012 112
      * Define local work field Pieces Per Head
     C                     Z-ADD*ZERO     YL0020  70
      * Define local work field Department Code
     C                     MOVEL*BLANK    YL0021  6
      * Define null work field Group for Packaging
     C                     MOVEL*BLANK    YN0013  1
      * Define local work field WIP Item Code
     C                     Z-ADD*ZERO     YL0022  70
      * Define null work field Seconds Item
     C                     MOVEL*BLANK    YN0014  1
      * Define local work field Piece Count Item
     C                     MOVEL*BLANK    YL0023  1
      * Define local work field Pieces Per Bag
     C                     Z-ADD*ZERO     YL0024  70
      * Define local work field Bags Per Unit
     C                     Z-ADD*ZERO     YL0025  70
      * Define null work field Export/Domestic
     C                     MOVEL*BLANK    YN0015  1
      * Define local work field Print On Schedule
     C                     MOVEL*BLANK    YL0026  1
      * Define null work field Fresh Inv Allocation Seq
     C                     MOVEL*BLANK    YN0016  1
      * Define null work field Fresh Sched As Ordered
     C                     MOVEL*BLANK    YN0017  1
      * Define null work field Frozen Inv Allocation Seq
     C                     MOVEL*BLANK    YN0018  1
      * Define local work field Primal Group Code
     C                     MOVEL*BLANK    YL0027  6
      * Define local work field Label Type
     C                     MOVEL*BLANK    YL0028  2
      * Define local work field Department Description
     C                     MOVEL*BLANK    YL0029 30
      * Define local work field Consumed Item Code
     C                     Z-ADD*ZERO     YL0030  70
      * Define local work field PSP Packaging Item Code
     C                     MOVEL*BLANK    YL0031 25
      * Define local work field PSP BOX Desription
     C                     MOVEL*BLANK    YL0032 30
      * Define local work field PSP Packaging Item Desc
     C                     MOVEL*BLANK    YL0033 50
      * Define local work field PSP Comment Line 1
     C                     MOVEL*BLANK    YL0034 30
      * Define local work field PSP Text
     C                     MOVEL*BLANK    YL0035 40
      * Define local work field PSP Shift/Priority Code
     C                     MOVEL*BLANK    YL0036  3
      * Define local work field PSP Pieces Schedule
     C                     Z-ADD*ZERO     YL0037  50
      * Define local work field USR Text 70
     C                     MOVEL*BLANK    YL0038 70
      * Define local work field Product Temperature
     C                     Z-ADD*ZERO     YL0039  52
      * Define local work field Product Complete Date
     C                     Z-ADD*ZERO     YL0040  70
      * Define local work field Product Complete Time
     C                     Z-ADD*ZERO     YL0041  60
      * Define local work field Date (Alpha) USR
     C                     MOVEL*BLANK    YL0042  7
      * Define local work field Time Alpha usr 6
     C                     MOVEL*BLANK    YL0043  6
      * Define local work field PSO Est Prd Ready Time
     C                     MOVEL*BLANK    YL0044 25
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * Modification History
     C                     EXSR UASUBR                     Modification Hi
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL'OMS'     WL0001    P      Application Cod
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    WUAUNA    P      Description
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
     C                     Z-ADD*ZERO     WUCNTU           Count USR
     C                     Z-ADD*ZERO     WUA7NX           Count 2 USR
     C                     Z-ADD*ZERO     WUNLNX           Count USR 3
     C                     MOVEL'Y'       WUB2SX           Print Date
     C                     MOVEL'Y'       WUPGST           Page Control Us
      * E3796 JJH 02/25/15 - Use Requested Ship Date
      * CASE: PAR.Requested Ship Date EQ PAR.Next Production Day Usr
     C           P1A5DT    IFEQ P3SRDT                     *IF
      * User has selected date in the future
     C                     MOVEL'N'       WUB2SX           Print Date
      * Will only be printing the summary no need for page control
     C                     MOVEL'N'       WUPGST           Page Control Us
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
     C                     MOVEL##PGM     WUETVN           PSP Report ID
     C                     Z-ADD##JDT     WUUKDT           PSP Report Date
     C                     Z-ADD##JTM     WUDVTM           PSP Report Time
     C                     Z-ADDP8FOC7    WUFOC7           PSP Prod Run Se
      * slm 09/09/2013 E2746 PPS QTY1, QTY2, QTY3 wk end
      * E3796 JJH 02/25/15 - Use Requested Ship Date
      * Clc PFS DAY0,1,2etc   XF - Calendar  * 
     C                     CALL 'PBJYXFR'              90  Clc PFS DAY0,1,
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0001  30       Company Number
     C                     PARM P1A5DT    WQ0002  70       Scheduled Ship
     C           WUVHDT    PARM WUVHDT    WQ0003  70       Date 0 RGF
     C           WURWDT    PARM WURWDT    WQ0004  70       Date 1 RGF
     C           WURYDT    PARM WURYDT    WQ0005  70       Date 2 RGF
     C           WUR0DT    PARM WUR0DT    WQ0006  70       Date 3 RGF
     C           WUR1DT    PARM WUR1DT    WQ0007  70       Date 3 RGT
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBJYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * E3796 JJH 02/25/15 - Get Company Value "PRDPRTDDT"
      * Rtv Alpha Value       XF - Company Values  * PRDPRTDDT
     C                     CALL 'POMTXFR'              90  Rtv Alpha Value
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0008  30       Company Number
     C                     PARM @CN,001   WQ0009 10        Company Value C
     C           YL0001    PARM *BLANK    WQ0010 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.System Value Alpha is Equal to Y
     C           YL0001    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       YL0002           Print Dead Depa
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0002           Print Dead Depa
     C                     END                             *FI
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 PRDPRTDDT
00002 Primal Grp Rpt -
00003 Not Sent to Carlisle
00004 Send to Carlisle
00005 *** BASE LINE ***
00006 Warning: Piece Count Item
00007 Flag Modified
