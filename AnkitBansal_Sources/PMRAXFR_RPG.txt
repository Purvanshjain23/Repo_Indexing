     H/TITLE Bld Contact DB        XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : 2E  Version:  1181
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 12/31/07  Time  : 09:40:59
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPOC5REL0IF  E           K        DISK
      * RTV : Broker                    Retrieval index
      *
     FCAD0REL4IF  E           K        DISK
      * RSQ : Contact                   Contact Number(d)
      *
     FOMHOREL6IF  E           K        DISK
      * RSQ : Customer Accrual          Broker/Ship To
      *
     FCAEMCPL4IF  E           K        DISK
      * RSQ : Contact Attach Customer   ShipTo/Seq(d)
      *
     FCAD0REL1IF  E           K        DISK                      A
      * UPD : Contact                   Update index
      *
     FCAEMCPL0IF  E           K        DISK                      A
      * UPD : Contact Attach Customer   Update index
      *
     I@C5RESJ
      * Broker                    Retrieval index
      * Renamed input format fields
     I              C5HHAA                          WAHHAA
     I              C5C4T1                          WAC4T1
     I              C5QMNA                          WAQMNA
     I              C5QNNA                          WAQNNA
     I              C5QONA                          WAQONA
     I              C5QPNA                          WAQPNA
     I              C5C5T1                          WAC5T1
     I              C5C6T1                          WAC6T1
     I              C5C7T1                          WAC7T1
     I              C5C8T1                          WAC8T1
     I              C5C9T1                          WAC9T1
     I              C5DAT1                          WADAT1
     I              C5DBT1                          WADBT1
     I              C5DCT1                          WADCT1
     I              C5DDT1                          WADDT1
     I              C5PWSX                          WAPWSX
     I              C5PXSX                          WAPXSX
     I              C5PYSX                          WAPYSX
     I              C5PZSX                          WAPZSX
     I              C5BCCD                          WABCCD
     I              C5UVST                          WAUVST
     I              C5UWST                          WAUWST
     I              C5UXST                          WAUXST
     I              C5VSST                          WAVSST
     I              C5AATM                          WAAATM
     I              C5AYNA                          WAAYNA
     I              C5A0NA                          WAA0NA
     I              C5AXDT                          WAAXDT
      *
     I@D0REQM
      * Contact                   Contact Number(d)
      * Renamed input format fields
     I              D0AAC7                          WBAAC7
     I              D0BGNA                          WBBGNA
     I              D0BINA                          WBBINA
     I              D0BENA                          WBBENA
     I              D0BVTX                          WBBVTX
     I              D0DUTX                          WBDUTX
     I              D0ACNA                          WBACNA
     I              D0ADNA                          WBADNA
     I              D0AENA                          WBAENA
     I              D0AJNA                          WBAJNA
     I              D0BTTX                          WBBTTX
     I              D0UVST                          WBUVST
     I              D0UWST                          WBUWST
     I              D0UXST                          WBUXST
     I              D0AATM                          WBAATM
     I              D0AYNA                          WBAYNA
     I              D0A0NA                          WBA0NA
     I              D0AXDT                          WBAXDT
      *
     I@D0REUI
      * Contact                   Update index
      * Renamed input format fields
     I              D0AAC7                          WCAAC7
     I              D0BGNA                          WCBGNA
     I              D0BINA                          WCBINA
     I              D0BENA                          WCBENA
     I              D0BVTX                          WCBVTX
     I              D0ACNA                          WCACNA
     I              D0ADNA                          WCADNA
     I              D0AENA                          WCAENA
     I              D0AJNA                          WCAJNA
     I              D0BTTX                          WCBTTX
     I              D0UVST                          WCUVST
     I              D0UWST                          WCUWST
     I              D0UXST                          WCUXST
     I              D0AATM                          WCAATM
     I              D0AYNA                          WCAYNA
     I              D0A0NA                          WCA0NA
     I              D0AXDT                          WCAXDT
      *
     I@HOREKB
      * Customer Accrual          Broker/Ship To
      * Renamed input format fields
     I              HOBKC7                          WDBKC7
     I              HOOJCD                          WDOJCD
     I              HOGUNY                          WDGUNY
     I              HOBFDT                          WDBFDT
     I              HOA2DT                          WDA2DT
     I              HOBKPR                          WDBKPR
     I              HOTTST                          WDTTST
     I              HOSHSX                          WDSHSX
     I              HOQDSX                          WDQDSX
     I              HOPJDT                          WDPJDT
     I              HOPKDT                          WDPKDT
     I              HOECVL                          WDECVL
     I              HOQESX                          WDQESX
     I              HOQFSX                          WDQFSX
     I              HOHHAA                          WDHHAA
     I              HOHQVL                          WDHQVL
     I              HOQGSX                          WDQGSX
     I              HOQHSX                          WDQHSX
     I              HOQISX                          WDQISX
     I              HOQJSX                          WDQJSX
     I              HOUVST                          WDUVST
     I              HOUWST                          WDUWST
     I              HOUXST                          WDUXST
     I              HOAATM                          WDAATM
     I              HOAYNA                          WDAYNA
     I              HOA0NA                          WDA0NA
     I              HOAXDT                          WDAXDT
      *
     I@EMCPQO
      * Contact Attach Customer   ShipTo/Seq(d)
      * Renamed input format fields
     I              EMBKC7                          WEBKC7
     I              EMOCNB                          WEOCNB
     I              EMG7CD                          WEG7CD
     I              EMAAC7                          WEAAC7
     I              EMHHAA                          WEHHAA
     I              EMUVST                          WEUVST
     I              EMUWST                          WEUWST
     I              EMUXST                          WEUXST
     I              EMAATM                          WEAATM
     I              EMAYNA                          WEAYNA
     I              EMA0NA                          WEA0NA
     I              EMAXDT                          WEAXDT
      *
     I@EMCPXF
      * Contact Attach Customer   Update index
      * Renamed input format fields
     I              EMBKC7                          WFBKC7
     I              EMOCNB                          WFOCNB
     I              EMG7CD                          WFG7CD
     I              EMAAC7                          WFAAC7
     I              EMHHAA                          WFHHAA
     I              EMUVST                          WFUVST
     I              EMUWST                          WFUWST
     I              EMUXST                          WFUXST
     I              EMAATM                          WFAATM
     I              EMAYNA                          WFAYNA
     I              EMA0NA                          WFA0NA
     I              EMAXDT                          WFAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQCAD01    E DSCAD0REL1
      * UPD : Contact                   Update index
      * Renamed input format fields
     I              D0AAC7                          WCAAC7
     I              D0BGNA                          WCBGNA
     I              D0BINA                          WCBINA
     I              D0BENA                          WCBENA
     I              D0BVTX                          WCBVTX
     I              D0ACNA                          WCACNA
     I              D0ADNA                          WCADNA
     I              D0AENA                          WCAENA
     I              D0AJNA                          WCAJNA
     I              D0BTTX                          WCBTTX
     I              D0UVST                          WCUVST
     I              D0UWST                          WCUWST
     I              D0UXST                          WCUXST
     I              D0AATM                          WCAATM
     I              D0AYNA                          WCAYNA
     I              D0A0NA                          WCA0NA
     I              D0AXDT                          WCAXDT
      *
     IQCAEM1    E DSCAEMCPL0
      * UPD : Contact Attach Customer   Update index
      * Renamed input format fields
     I              EMBKC7                          WFBKC7
     I              EMOCNB                          WFOCNB
     I              EMG7CD                          WFG7CD
     I              EMAAC7                          WFAAC7
     I              EMHHAA                          WFHHAA
     I              EMUVST                          WFUVST
     I              EMUWST                          WFUWST
     I              EMUXST                          WFUXST
     I              EMAATM                          WFAATM
     I              EMAYNA                          WFAYNA
     I              EMA0NA                          WFA0NA
     I              EMAXDT                          WFAXDT
      *
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Bld Contact DB        XF
      * Bld Contact DB        RT - Broker  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Bld Contact DB        RT - Broker  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@C5RESJ                    *
     C                     READ @C5RESJ                  90*
      * Data record not found
     C   90                MOVEL'USR3288' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WAVSST    IFEQ 'A'                        *IF
      *
     C                     MOVEL*BLANK    WN0001  1        EDI Status 1
     C                     MOVEL*BLANK    WN0002  1        EDI Status 2
     C                     MOVEL*BLANK    WN0003  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0004  60       Job Time
     C                     MOVEL*BLANK    WN0005 10        User Id
     C                     MOVEL*BLANK    WN0006 10        Job Name
     C                     Z-ADD*ZERO     WN0007  70       Job Date
      *
      * Crt Contact           IF
      * Rtv Next Contact#     RT - Contact Name  * 
     C                     EXSR SBRVGN
      * CRT Contact Name       CR - Contact Name  * 
     C                     EXSR SCCRRC
      * Bld Cust Contact      RT - Customer Accrual  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
     C                     READ @C5RESJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Next Contact#     RT - Contact Name  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *HIVAL    SETLL@D0REQM                    *
     C                     READ @D0REQM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0803' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         YL0001           Contact Number
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WBAAC7    ADD  1         YL0001           Contact Number
     C                     GOTO SBEXIT                     *QUIT
     C                     READ @D0REQM                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCRRC    BEGSR
      *================================================================
      * CRT Contact Name       CR - Contact Name  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0008  60       Job Time
     C                     MOVEL*BLANK    WN0009 10        User Id
     C                     MOVEL*BLANK    WN0010 10        Job Name
     C                     Z-ADD*ZERO     WN0011  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @D0REUI
     C                     Z-ADDYL0001    WCAAC7           Contact Number
     C                     MOVELWAC4T1    WCBGNA           Primary Contact
     C                     MOVEL*BLANK    WCBINA           Primary Contact
     C                     MOVEL*BLANK    WCBENA           Primary Contact
     C                     MOVELWAC7T1    WCBVTX           Telephone Numbe
     C                     MOVELWAQMNA    WCACNA           Address Line 1
     C                     MOVELWAQNNA    WCADNA           Address Line 2
     C                     MOVEL*BLANK    WCAENA           Address Line 3
     C                     MOVELWAQONA    WCAJNA           City
     C                     MOVELWAQPNA    WCBTTX           Zip/Postal Code
     C                     MOVELWN0001    WCUVST           EDI Status 1
     C                     MOVELWN0002    WCUWST           EDI Status 2
     C                     MOVELWN0003    WCUXST           EDI Status 3
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##JOB     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
     C           KLCRSC    KLIST
     C                     KFLD           WCAAC7           Contact Number
      * Check for duplicate primary key
     C           KLCRSC    SETLL@D0REUI                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0804' W0RTN   7
      * Send message 'Contact                EX'
     C                     MOVEL'USR0804' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C                     WRITE@D0REUI                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * Move @D0REUI fields back
     C                     Z-ADDWCAAC7    YL0001           Contact Number
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Bld Cust Contact      RT - Customer Accrual  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHHAA    WQSD01           Broker Code
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Broker Code
      * Setup key
     C                     MOVELWAHHAA    WQSD01           Broker Code
      * Establish starting position
     C           KRSSD     SETLL@HOREKB                    *
     C           KRSSD     READE@HOREKB                  90*
      * Data record not found
     C   90                MOVEL'USR1520' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : JOB.*Job date GE DB1.Period Beginning Date
      *   |- c2    : JOB.*Job date LE DB1.Period Ending Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           ##JDT     IFGE WDBFDT                     *IF
     C           ##JDT     IFLE WDA2DT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: PAR.Payee Type is Broker
     C           WAPYSX    IFEQ 'BR'                       *IF
     C                     MOVEL'BROKER'  YL0002           Contact Type Co
     C                     ELSE
      * CASE: PAR.Payee Type is Buyer Group
     C           WAPYSX    IFEQ 'BG'                       *IF
     C                     MOVEL'BUYGRP'  YL0002           Contact Type Co
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0012  50       Contact Sequenc
     C                     MOVEL*BLANK    WN0013  1        EDI Status 1
     C                     MOVEL*BLANK    WN0014  1        EDI Status 2
     C                     MOVEL*BLANK    WN0015  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0016  60       Job Time
     C                     MOVEL*BLANK    WN0017 10        User Id
     C                     MOVEL*BLANK    WN0018 10        Job Name
     C                     Z-ADD*ZERO     WN0019  70       Job Date
      *
      * Crt Customer Contact  IF
      * RTV Next Sequence #   RT - Contact Attach Customer  * 
     C                     EXSR SERVGN
      * Crt Customer Contact  CR - Contact Attach Customer  * 
     C                     EXSR SFCRRC
     C                     END                             *FI
     C           KRSSD     READE@HOREKB                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Next Sequence #   RT - Contact Attach Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEBKC7    WQSE01           Ship To Custome
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Ship To Custome
      * Setup key
     C                     Z-ADDWDBKC7    WQSE01           Ship To Custome
      * Establish starting position
     C           KRSSE     SETLL@EMCPQO                    *
     C           KRSSE     READE@EMCPQO                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1003' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WN0012           Contact Sequenc
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WEOCNB    ADD  1         WN0012           Contact Sequenc
     C                     GOTO SEEXIT                     *QUIT
     C           KRSSE     READE@EMCPQO                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCRRC    BEGSR
      *================================================================
      * Crt Customer Contact  CR - Contact Attach Customer  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0020  60       Job Time
     C                     MOVEL*BLANK    WN0021 10        User Id
     C                     MOVEL*BLANK    WN0022 10        Job Name
     C                     Z-ADD*ZERO     WN0023  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EMCPXF
     C                     Z-ADDWDBKC7    WFBKC7           Ship To Custome
     C                     Z-ADDWN0012    WFOCNB           Contact Sequenc
     C                     MOVELYL0002    WFG7CD           Contact Type Co
     C                     Z-ADDYL0001    WFAAC7           Contact Number
     C                     MOVELWDHHAA    WFHHAA           Broker Code
     C                     MOVELWN0013    WFUVST           EDI Status 1
     C                     MOVELWN0014    WFUWST           EDI Status 2
     C                     MOVELWN0015    WFUXST           EDI Status 3
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##JOB     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
     C           KLCRSF    KLIST
     C                     KFLD           WFBKC7           Ship To Custome
     C                     KFLD           WFOCNB           Contact Sequenc
      * Check for duplicate primary key
     C           KLCRSF    SETLL@EMCPXF                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1004' W0RTN   7
      * Send message 'Contact Attach Custome EX'
     C                     MOVEL'USR1004' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C                     WRITE@EMCPXF                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WADAT1           Broker G/L Vend
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAAC7           Contact Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Clear all neither parameters
      * CRT Contact Name       CR - Contact Name  * 
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDGUNY           CAH Sequence No
     C                     Z-ADD*ZERO     WDBFDT           Period Beginnin
     C                     Z-ADD*ZERO     WDA2DT           Period Ending D
     C                     Z-ADD*ZERO     WDBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WDPJDT           CAH Unused Date
     C                     Z-ADD*ZERO     WDPKDT           CAH Unused Date
     C                     Z-ADD*ZERO     WDECVL           Comm Min Amt /P
     C                     Z-ADD*ZERO     WDHQVL           Max Accrual Amo
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEOCNB           Contact Sequenc
     C                     Z-ADD*ZERO     WEAAC7           Contact Number
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Clear all neither parameters
      * Crt Customer Contact  CR - Contact Attach Customer  * 
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Contact Number
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field Contact Type Code
     C                     MOVEL*BLANK    YL0002  6
      *================================================================
     CSR         ZZEXIT    ENDSR
