/********************************************************************/
/*                                                                   */
/*  SYNOPSIS -  PRINT BANK LETTER OF CREDIT FEES REPORT              */
/*                                                                   */
/*  SYSTEM    - ORDER MANAGEMENT SYSTEM                              */
/*  DATE      - 11/06/2006                                           */
/*                                                                   */
/*      PARAMETERS:                                                  */
/*                                                                   */
/*     I    &BANK       - BANK CODE                                  */
/*     I    &APPLIC     - APPLICATION CODE                           */
/*     I    &OUTQ       - OUTPUT QUEUE                               */
/*     I    &HOLD       - HOLD STATUS                                */
/*     I    &SAVE       - SAVE STATUS                                */
/*     I    &NQSTS      - NIGHT QUEUE STATUS                         */
/*     I    &NQ         - NIGHT QUEUE                                */
/*     I    &YEARN      - FISCAL YEAR - PASS                         */
/*     I    &FPERN      - FROM FISCAL PERIOD PASS                    */
/*     I    &TPERN      - THRU FISCAL PERIOD PASS                    */
/*     I    &FYEARN     - FROM FISCAL YEAR - PASS                    */
/*     I    &TYEARN     - THRU FISCAL DATE - PASS                    */
/*     I    &COPYN      - NO. OF COPIES (PASSED)                     */
/*     I    &DTLSUM     - DETAIL OR SUMMARY FLAG                     */
/*     I    &EMAIL      - EMAIL ADDRESS                              */
/*     I    &EMAILFMT   - EMAIL FORMAT                               */
/*                                                                   */
/*********************************************************************/
 PMB4UPC:    PGM        PARM(&BANK &APPLIC &OUTQ &HOLD &SAVE &NQSYS +
                          &NQ &YEARN &FPERN &TPERN &FYEARN &TYEARN +
                          &COPYN &DTLSUM &EMAIL &EMAILFMT)

/* PARMS                                                             */
        DCL    &BANK       *CHAR   (6)           /* BANK CODE        */
        DCL    &APPLIC     *CHAR   (10)          /* APPLICATION CODE */
        DCL    &OUTQ       *CHAR   (10)          /* Output Queue     */
        DCL    &HOLD       *CHAR   (4)           /* Hold Status      */
        DCL    &SAVE       *CHAR   (4)           /* Save Status      */
        DCL    &NQSYS      *CHAR   (1)           /* NQ RUN STATUS    */
        DCL    &NQ         *CHAR   (7)           /* NIGHT QUEUE      */
        DCL    &YEARN      *DEC                  /* FISCAL YEAR PASS */
        DCL    &FPERN      *DEC                  /* FROM PERD PASS   */
        DCL    &TPERN      *DEC                  /* TO PERIOD PASS   */
        DCL    &FYEARN     *DEC                  /* FROM YEAR PASS   */
        DCL    &TYEARN     *DEC                  /* TO YEAR PASS     */
        DCL    &COPYN      *DEC                  /* # COPIES PASS    */
        DCL    &DTLSUM     *CHAR   (1)           /* NQ RUN STATUS    */
        DCL    &EMAILFMT   *CHAR   (5)           /* EMAIL FORMAT     */
        DCL    &EMAIL      *CHAR   (50)          /* EMAIL ADDRESS    */

/* ERROR MESSAGE FIELDS                                              */
        DCL    &MSG        *CHAR   (512)         /* message          */
        DCL    &MSGID      *CHAR   (7)           /* message id       */
        DCL    &MSGL       *DEC    (5 0)

/*********************************************************************/
/*   MONITOR FOR ALL MESSAGES AT PROGRAM LEVEL                       */
/*********************************************************************/
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(MSGTRAP))

/********************************************************************/
/*   CALL PRINT                                                     */
/********************************************************************/
             SBMJOB     CMD(CALL PGM(PMB5UPC) PARM(&BANK &APPLIC +
                          &OUTQ &HOLD &SAVE &NQSYS &NQ &YEARN +
                          &FPERN &TPERN &FYEARN &TYEARN &COPYN +
                          &DTLSUM &EMAILFMT &EMAIL)) JOB(BANKLOCF)

             GOTO       CMDLBL(END)

/*----------------------RECEIVE MESSAGES----------------------------*/

 MSGTRAP:    RCVMSG     MSGTYPE(*EXCP) MSGDTA(&MSG) MSGDTALEN(&MSGL) +
                          MSGID(&MSGID)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))

             SNDPGMMSG  MSGID(&MSGID) MSGF(QCPFMSG) MSGDTA(%SST(&MSG +
                          1 &MSGL)) MSGTYPE(*ESCAPE)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))

 END:        ENDPGM

